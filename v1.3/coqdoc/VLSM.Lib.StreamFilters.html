<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">

<head>
<meta http-equiv="Content-Type" content="text/html;charset=utf-8" />
<link href="coqdoc.css" rel="stylesheet" type="text/css" />
<link href="coqdocjs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="config.js"></script>
<script type="text/javascript" src="coqdocjs.js"></script>
</head>

<body onload="document.getElementById('content').focus()">
  <div id="header">
    <span class="left">
      <span class="modulename">
	<script>
	  if (document.title === "Table of Contents") {
	      document.write("<a href='map.svg'>File dependency graph</a>");
	  } else if (document.title !== "Index") {
              document.write("<a href='" + document.title + ".svg'>" + document.title + " dependency graph</a>");
	  }
	</script>
      </span>
    </span>

    <span class="button" id="toggle-proofs"></span>

    <span class="right">
      <a href="./../..">Project Website</a>
      <a href="./indexpage.html">Index</a>
      <a href="./toc.html">Table of Contents</a>
    </span>
</div>
    <div id="content" tabindex="-1" onblur="document.getElementById('content').focus()">
    <div id="main">
<div class="code">
<span class="id" title="keyword">From</span> <span class="id" title="var">stdpp</span> <span class="id" title="keyword">Require</span> <span class="id" title="keyword">Import</span> <span class="id" title="library">prelude</span>.<br/>
<span class="id" title="keyword">From</span> <span class="id" title="var">Coq</span> <span class="id" title="keyword">Require</span> <span class="id" title="keyword">Import</span> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Lists.Streams.html#"><span class="id" title="library">Streams</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Sorting.Sorted.html#"><span class="id" title="library">Sorted</span></a>.<br/>
<span class="id" title="keyword">From</span> <span class="id" title="var">VLSM.Lib</span> <span class="id" title="keyword">Require</span> <span class="id" title="keyword">Import</span> <a class="idref" href="VLSM.Lib.Preamble.html#"><span class="id" title="library">Preamble</span></a> <a class="idref" href="VLSM.Lib.StreamExtras.html#"><span class="id" title="library">StreamExtras</span></a> <a class="idref" href="VLSM.Lib.SortedLists.html#"><span class="id" title="library">SortedLists</span></a>.<br/>
<span class="id" title="keyword">From</span> <span class="id" title="var">VLSM.Lib</span> <span class="id" title="keyword">Require</span> <span class="id" title="keyword">Import</span> <a class="idref" href="VLSM.Lib.ListExtras.html#"><span class="id" title="library">ListExtras</span></a> <a class="idref" href="VLSM.Lib.StdppExtras.html#"><span class="id" title="library">StdppExtras</span></a> <a class="idref" href="VLSM.Lib.NeList.html#"><span class="id" title="library">NeList</span></a>.<br/>

<br/>
</div>

<div class="doc">
<a id="lab52"></a><h1 class="section">Utility: Stream Filters</h1>

<div class="paragraph"> </div>


<div class="paragraph"> </div>

  Given a predicate <code>P</code> and a stream <code>s</code>, a stream of naturals <code>ns</code>
  determines a <span class="inlinecode"><a class="idref" href="VLSM.Lib.StreamFilters.html#filtering_subsequence"><span class="id" title="definition">filtering_subsequence</span></a></span> for <code>P</code> on <code>s</code> if it corresponds to
  the list of positions in <code>ss</code> where <code>P</code> holds, increasingly ordered.

</div>
<div class="code">
<span class="id" title="keyword">Definition</span> <a id="filtering_subsequence" class="idref" href="#filtering_subsequence"><span class="id" title="definition">filtering_subsequence</span></a><br/>
&nbsp;&nbsp;{<a id="A:1" class="idref" href="#A:1"><span class="id" title="binder">A</span></a> : <span class="id" title="keyword">Type</span>}<br/>
&nbsp;&nbsp;(<a id="P:2" class="idref" href="#P:2"><span class="id" title="binder">P</span></a> : <a class="idref" href="VLSM.Lib.StreamFilters.html#A:1"><span class="id" title="variable">A</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x"><span class="id" title="notation">-&gt;</span></a> <span class="id" title="keyword">Prop</span>)<br/>
&nbsp;&nbsp;(<a id="s:3" class="idref" href="#s:3"><span class="id" title="binder">s</span></a> : <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Lists.Streams.html#Stream"><span class="id" title="inductive">Stream</span></a> <a class="idref" href="VLSM.Lib.StreamFilters.html#A:1"><span class="id" title="variable">A</span></a>)<br/>
&nbsp;&nbsp;(<a id="ns:4" class="idref" href="#ns:4"><span class="id" title="binder">ns</span></a> : <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Lists.Streams.html#Stream"><span class="id" title="inductive">Stream</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Datatypes.html#nat"><span class="id" title="inductive">nat</span></a>)<br/>
&nbsp;&nbsp;: <span class="id" title="keyword">Prop</span><br/>
&nbsp;&nbsp;:= <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Logic.html#ba2b0e492d2b4675a0acf3ea92aabadd"><span class="id" title="notation">(</span></a><span class="id" title="notation">forall</span> <a id="i:5" class="idref" href="#i:5"><span class="id" title="binder">i</span></a><span class="id" title="notation">,</span> <a class="idref" href="VLSM.Lib.StreamFilters.html#i:5"><span class="id" title="variable">i</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Peano.html#::nat_scope:x_'&lt;'_x"><span class="id" title="notation">&lt;</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Lists.Streams.html#hd"><span class="id" title="definition">hd</span></a> <a class="idref" href="VLSM.Lib.StreamFilters.html#ns:4"><span class="id" title="variable">ns</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x"><span class="id" title="notation">-&gt;</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Logic.html#63a68285c81db8f9bc456233bb9ed181"><span class="id" title="notation">~</span></a> <a class="idref" href="VLSM.Lib.StreamFilters.html#P:2"><span class="id" title="variable">P</span></a> (<a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Lists.Streams.html#Str_nth"><span class="id" title="definition">Str_nth</span></a> <a class="idref" href="VLSM.Lib.StreamFilters.html#i:5"><span class="id" title="variable">i</span></a> <a class="idref" href="VLSM.Lib.StreamFilters.html#s:3"><span class="id" title="variable">s</span></a>)<a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Logic.html#ba2b0e492d2b4675a0acf3ea92aabadd"><span class="id" title="notation">)</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Logic.html#ba2b0e492d2b4675a0acf3ea92aabadd"><span class="id" title="notation">/\</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="VLSM.Lib.StreamExtras.html#ForAll2"><span class="id" title="definition">ForAll2</span></a> (<span class="id" title="keyword">fun</span> <a id="m:6" class="idref" href="#m:6"><span class="id" title="binder">m</span></a> <a id="n:7" class="idref" href="#n:7"><span class="id" title="binder">n</span></a> =&gt; <a class="idref" href="VLSM.Lib.StreamFilters.html#P:2"><span class="id" title="variable">P</span></a> (<a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Lists.Streams.html#Str_nth"><span class="id" title="definition">Str_nth</span></a> <a class="idref" href="VLSM.Lib.StreamFilters.html#m:6"><span class="id" title="variable">m</span></a> <a class="idref" href="VLSM.Lib.StreamFilters.html#s:3"><span class="id" title="variable">s</span></a>) <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Logic.html#ba2b0e492d2b4675a0acf3ea92aabadd"><span class="id" title="notation">/\</span></a> <a class="idref" href="VLSM.Lib.StreamFilters.html#m:6"><span class="id" title="variable">m</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Peano.html#::nat_scope:x_'&lt;'_x"><span class="id" title="notation">&lt;</span></a> <a class="idref" href="VLSM.Lib.StreamFilters.html#n:7"><span class="id" title="variable">n</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Logic.html#ba2b0e492d2b4675a0acf3ea92aabadd"><span class="id" title="notation">/\</span></a> <span class="id" title="notation">forall</span> <a id="i:8" class="idref" href="#i:8"><span class="id" title="binder">i</span></a><span class="id" title="notation">,</span> <a class="idref" href="VLSM.Lib.StreamFilters.html#m:6"><span class="id" title="variable">m</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Peano.html#::nat_scope:x_'&lt;'_x_'&lt;'_x"><span class="id" title="notation">&lt;</span></a> <a class="idref" href="VLSM.Lib.StreamFilters.html#i:8"><span class="id" title="variable">i</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Peano.html#::nat_scope:x_'&lt;'_x_'&lt;'_x"><span class="id" title="notation">&lt;</span></a> <a class="idref" href="VLSM.Lib.StreamFilters.html#n:7"><span class="id" title="variable">n</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x"><span class="id" title="notation">-&gt;</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Logic.html#63a68285c81db8f9bc456233bb9ed181"><span class="id" title="notation">~</span></a> <a class="idref" href="VLSM.Lib.StreamFilters.html#P:2"><span class="id" title="variable">P</span></a> (<a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Lists.Streams.html#Str_nth"><span class="id" title="definition">Str_nth</span></a> <a class="idref" href="VLSM.Lib.StreamFilters.html#i:8"><span class="id" title="variable">i</span></a> <a class="idref" href="VLSM.Lib.StreamFilters.html#s:3"><span class="id" title="variable">s</span></a>)) <a class="idref" href="VLSM.Lib.StreamFilters.html#ns:4"><span class="id" title="variable">ns</span></a>.<br/>

<br/>
</div>

<div class="doc">
  A more intuitive statement of the <span class="inlinecode"><a class="idref" href="VLSM.Lib.StreamFilters.html#filtering_subsequence"><span class="id" title="definition">filtering_subsequence</span></a></span> property.
  See <span class="inlinecode"><a class="idref" href="VLSM.Lib.StreamFilters.html#FilteringSubsequence_iff"><span class="id" title="lemma">FilteringSubsequence_iff</span></a></span> for the equivalence result.

</div>
<div class="code">
<span class="id" title="keyword">Record</span> <a id="FilteringSubsequence" class="idref" href="#FilteringSubsequence"><span class="id" title="record">FilteringSubsequence</span></a><br/>
&nbsp;&nbsp;{<a id="A:9" class="idref" href="#A:9"><span class="id" title="binder">A</span></a> : <span class="id" title="keyword">Type</span>}<br/>
&nbsp;&nbsp;(<a id="P:10" class="idref" href="#P:10"><span class="id" title="binder">P</span></a> : <a class="idref" href="VLSM.Lib.StreamFilters.html#A:9"><span class="id" title="variable">A</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x"><span class="id" title="notation">-&gt;</span></a> <span class="id" title="keyword">Prop</span>)<br/>
&nbsp;&nbsp;(<a id="s:11" class="idref" href="#s:11"><span class="id" title="binder">s</span></a> : <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Lists.Streams.html#Stream"><span class="id" title="inductive">Stream</span></a> <a class="idref" href="VLSM.Lib.StreamFilters.html#A:9"><span class="id" title="variable">A</span></a>)<br/>
&nbsp;&nbsp;(<a id="ns:12" class="idref" href="#ns:12"><span class="id" title="binder">ns</span></a> : <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Lists.Streams.html#Stream"><span class="id" title="inductive">Stream</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Datatypes.html#nat"><span class="id" title="inductive">nat</span></a>)<br/>
&nbsp;&nbsp;: <span class="id" title="keyword">Prop</span> :=<br/>
{<br/>
&nbsp;&nbsp;<a id="fs_monotone" class="idref" href="#fs_monotone"><span class="id" title="projection">fs_monotone</span></a> : <a class="idref" href="VLSM.Lib.StreamExtras.html#monotone_nat_stream_prop"><span class="id" title="definition">monotone_nat_stream_prop</span></a> <a class="idref" href="VLSM.Lib.StreamFilters.html#ns:12"><span class="id" title="variable">ns</span></a>;<br/>
&nbsp;&nbsp;<a id="fs_is_filter" class="idref" href="#fs_is_filter"><span class="id" title="projection">fs_is_filter</span></a> : <span class="id" title="notation">forall</span> <a id="n:15" class="idref" href="#n:15"><span class="id" title="binder">n</span></a><span class="id" title="notation">,</span> <a class="idref" href="VLSM.Lib.StreamFilters.html#P:10"><span class="id" title="variable">P</span></a> (<a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Lists.Streams.html#Str_nth"><span class="id" title="definition">Str_nth</span></a> <a class="idref" href="VLSM.Lib.StreamFilters.html#n:15"><span class="id" title="variable">n</span></a> <a class="idref" href="VLSM.Lib.StreamFilters.html#s:11"><span class="id" title="variable">s</span></a>) <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Logic.html#::type_scope:x_'&lt;-&gt;'_x"><span class="id" title="notation">&lt;-&gt;</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Logic.html#a883bdd010993579f99d60b3775bcf54"><span class="id" title="notation">exists</span></a> <a id="k:16" class="idref" href="#k:16"><span class="id" title="binder">k</span></a><a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Logic.html#a883bdd010993579f99d60b3775bcf54"><span class="id" title="notation">,</span></a> <a class="idref" href="VLSM.Lib.StreamFilters.html#n:15"><span class="id" title="variable">n</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">=</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Lists.Streams.html#Str_nth"><span class="id" title="definition">Str_nth</span></a> <a class="idref" href="VLSM.Lib.StreamFilters.html#k:16"><span class="id" title="variable">k</span></a> <a class="idref" href="VLSM.Lib.StreamFilters.html#ns:12"><span class="id" title="variable">ns</span></a>;<br/>
}.<br/>

<br/>
<span class="id" title="keyword">Lemma</span> <a id="filtering_subsequence_sorted" class="idref" href="#filtering_subsequence_sorted"><span class="id" title="lemma">filtering_subsequence_sorted</span></a><br/>
&nbsp;&nbsp;{<a id="A:18" class="idref" href="#A:18"><span class="id" title="binder">A</span></a> : <span class="id" title="keyword">Type</span>}<br/>
&nbsp;&nbsp;(<a id="P:19" class="idref" href="#P:19"><span class="id" title="binder">P</span></a> : <a class="idref" href="VLSM.Lib.StreamFilters.html#A:18"><span class="id" title="variable">A</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x"><span class="id" title="notation">-&gt;</span></a> <span class="id" title="keyword">Prop</span>)<br/>
&nbsp;&nbsp;(<a id="s:20" class="idref" href="#s:20"><span class="id" title="binder">s</span></a> : <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Lists.Streams.html#Stream"><span class="id" title="inductive">Stream</span></a> <a class="idref" href="VLSM.Lib.StreamFilters.html#A:18"><span class="id" title="variable">A</span></a>)<br/>
&nbsp;&nbsp;(<a id="ns:21" class="idref" href="#ns:21"><span class="id" title="binder">ns</span></a> : <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Lists.Streams.html#Stream"><span class="id" title="inductive">Stream</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Datatypes.html#nat"><span class="id" title="inductive">nat</span></a>)<br/>
&nbsp;&nbsp;(<a id="Hfs:22" class="idref" href="#Hfs:22"><span class="id" title="binder">Hfs</span></a> : <a class="idref" href="VLSM.Lib.StreamFilters.html#filtering_subsequence"><span class="id" title="definition">filtering_subsequence</span></a> <a class="idref" href="VLSM.Lib.StreamFilters.html#P:19"><span class="id" title="variable">P</span></a> <a class="idref" href="VLSM.Lib.StreamFilters.html#s:20"><span class="id" title="variable">s</span></a> <a class="idref" href="VLSM.Lib.StreamFilters.html#ns:21"><span class="id" title="variable">ns</span></a>)<br/>
&nbsp;&nbsp;: <a class="idref" href="VLSM.Lib.StreamExtras.html#ForAll2"><span class="id" title="definition">ForAll2</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Peano.html#lt"><span class="id" title="definition">lt</span></a> <a class="idref" href="VLSM.Lib.StreamFilters.html#ns:21"><span class="id" title="variable">ns</span></a>.<br/>
<span class="id" title="keyword">Proof</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">destruct</span> <span class="id" title="var">Hfs</span> <span class="id" title="keyword">as</span> [<span class="id" title="var">_</span> <span class="id" title="var">Hfs</span>].<br/>
&nbsp;&nbsp;<span class="id" title="var">revert</span> <span class="id" title="var">Hfs</span>; <span class="id" title="tactic">apply</span> <a class="idref" href="VLSM.Lib.StreamExtras.html#ForAll2_subsumption"><span class="id" title="lemma">ForAll2_subsumption</span></a>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">by</span> <span class="id" title="tactic">intros</span> <span class="id" title="var">a</span> <span class="id" title="var">b</span> <span class="id" title="var">H</span>; <span class="id" title="tactic">apply</span> <span class="id" title="var">H</span>.<br/>
<span class="id" title="keyword">Qed</span>.<br/>

<br/>
<span class="id" title="keyword">Lemma</span> <a id="filtering_subsequence_prefix_sorted" class="idref" href="#filtering_subsequence_prefix_sorted"><span class="id" title="lemma">filtering_subsequence_prefix_sorted</span></a><br/>
&nbsp;&nbsp;{<a id="A:23" class="idref" href="#A:23"><span class="id" title="binder">A</span></a> : <span class="id" title="keyword">Type</span>}<br/>
&nbsp;&nbsp;(<a id="P:24" class="idref" href="#P:24"><span class="id" title="binder">P</span></a> : <a class="idref" href="VLSM.Lib.StreamFilters.html#A:23"><span class="id" title="variable">A</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x"><span class="id" title="notation">-&gt;</span></a> <span class="id" title="keyword">Prop</span>)<br/>
&nbsp;&nbsp;(<a id="s:25" class="idref" href="#s:25"><span class="id" title="binder">s</span></a> : <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Lists.Streams.html#Stream"><span class="id" title="inductive">Stream</span></a> <a class="idref" href="VLSM.Lib.StreamFilters.html#A:23"><span class="id" title="variable">A</span></a>)<br/>
&nbsp;&nbsp;(<a id="ns:26" class="idref" href="#ns:26"><span class="id" title="binder">ns</span></a> : <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Lists.Streams.html#Stream"><span class="id" title="inductive">Stream</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Datatypes.html#nat"><span class="id" title="inductive">nat</span></a>)<br/>
&nbsp;&nbsp;(<a id="Hfs:27" class="idref" href="#Hfs:27"><span class="id" title="binder">Hfs</span></a> : <a class="idref" href="VLSM.Lib.StreamFilters.html#filtering_subsequence"><span class="id" title="definition">filtering_subsequence</span></a> <a class="idref" href="VLSM.Lib.StreamFilters.html#P:24"><span class="id" title="variable">P</span></a> <a class="idref" href="VLSM.Lib.StreamFilters.html#s:25"><span class="id" title="variable">s</span></a> <a class="idref" href="VLSM.Lib.StreamFilters.html#ns:26"><span class="id" title="variable">ns</span></a>)<br/>
&nbsp;&nbsp;: <span class="id" title="notation">forall</span> <a id="n:28" class="idref" href="#n:28"><span class="id" title="binder">n</span></a><span class="id" title="notation">,</span> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Sorting.Sorted.html#LocallySorted"><span class="id" title="inductive">LocallySorted</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Peano.html#lt"><span class="id" title="definition">lt</span></a> (<a class="idref" href="VLSM.Lib.StreamExtras.html#stream_prefix"><span class="id" title="definition">stream_prefix</span></a> <a class="idref" href="VLSM.Lib.StreamFilters.html#ns:26"><span class="id" title="variable">ns</span></a> <a class="idref" href="VLSM.Lib.StreamFilters.html#n:28"><span class="id" title="variable">n</span></a>).<br/>
<span class="id" title="keyword">Proof</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">intro</span> <span class="id" title="var">n</span>. <span class="id" title="tactic">apply</span> <a class="idref" href="VLSM.Lib.SortedLists.html#LocallySorted_ForAll2"><span class="id" title="lemma">LocallySorted_ForAll2</span></a>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">apply</span> <a class="idref" href="VLSM.Lib.StreamExtras.html#stream_prefix_ForAll2"><span class="id" title="lemma">stream_prefix_ForAll2</span></a>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">by</span> <span class="id" title="tactic">apply</span> <a class="idref" href="VLSM.Lib.StreamFilters.html#filtering_subsequence_sorted"><span class="id" title="lemma">filtering_subsequence_sorted</span></a> <span class="id" title="tactic">in</span> <span class="id" title="var">Hfs</span>.<br/>
<span class="id" title="keyword">Qed</span>.<br/>

<br/>
<span class="id" title="keyword">Lemma</span> <a id="filtering_subsequence_iff" class="idref" href="#filtering_subsequence_iff"><span class="id" title="lemma">filtering_subsequence_iff</span></a><br/>
&nbsp;&nbsp;{<a id="A:29" class="idref" href="#A:29"><span class="id" title="binder">A</span></a> : <span class="id" title="keyword">Type</span>}<br/>
&nbsp;&nbsp;(<a id="P:30" class="idref" href="#P:30"><span class="id" title="binder">P</span></a> <a id="Q:31" class="idref" href="#Q:31"><span class="id" title="binder">Q</span></a> : <a class="idref" href="VLSM.Lib.StreamFilters.html#A:29"><span class="id" title="variable">A</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x"><span class="id" title="notation">-&gt;</span></a> <span class="id" title="keyword">Prop</span>)<br/>
&nbsp;&nbsp;(<a id="HPQ:33" class="idref" href="#HPQ:33"><span class="id" title="binder">HPQ</span></a> : <span class="id" title="notation">forall</span> <a id="a:32" class="idref" href="#a:32"><span class="id" title="binder">a</span></a><span class="id" title="notation">,</span> <a class="idref" href="VLSM.Lib.StreamFilters.html#P:30"><span class="id" title="variable">P</span></a> <a class="idref" href="VLSM.Lib.StreamFilters.html#a:32"><span class="id" title="variable">a</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Logic.html#::type_scope:x_'&lt;-&gt;'_x"><span class="id" title="notation">&lt;-&gt;</span></a> <a class="idref" href="VLSM.Lib.StreamFilters.html#Q:31"><span class="id" title="variable">Q</span></a> <a class="idref" href="VLSM.Lib.StreamFilters.html#a:32"><span class="id" title="variable">a</span></a>)<br/>
&nbsp;&nbsp;(<a id="s:34" class="idref" href="#s:34"><span class="id" title="binder">s</span></a> : <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Lists.Streams.html#Stream"><span class="id" title="inductive">Stream</span></a> <a class="idref" href="VLSM.Lib.StreamFilters.html#A:29"><span class="id" title="variable">A</span></a>)<br/>
&nbsp;&nbsp;(<a id="ss:35" class="idref" href="#ss:35"><span class="id" title="binder">ss</span></a> : <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Lists.Streams.html#Stream"><span class="id" title="inductive">Stream</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Datatypes.html#nat"><span class="id" title="inductive">nat</span></a>)<br/>
&nbsp;&nbsp;: <a class="idref" href="VLSM.Lib.StreamFilters.html#filtering_subsequence"><span class="id" title="definition">filtering_subsequence</span></a> <a class="idref" href="VLSM.Lib.StreamFilters.html#P:30"><span class="id" title="variable">P</span></a> <a class="idref" href="VLSM.Lib.StreamFilters.html#s:34"><span class="id" title="variable">s</span></a> <a class="idref" href="VLSM.Lib.StreamFilters.html#ss:35"><span class="id" title="variable">ss</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Logic.html#::type_scope:x_'&lt;-&gt;'_x"><span class="id" title="notation">&lt;-&gt;</span></a> <a class="idref" href="VLSM.Lib.StreamFilters.html#filtering_subsequence"><span class="id" title="definition">filtering_subsequence</span></a> <a class="idref" href="VLSM.Lib.StreamFilters.html#Q:31"><span class="id" title="variable">Q</span></a> <a class="idref" href="VLSM.Lib.StreamFilters.html#s:34"><span class="id" title="variable">s</span></a> <a class="idref" href="VLSM.Lib.StreamFilters.html#ss:35"><span class="id" title="variable">ss</span></a>.<br/>
<span class="id" title="keyword">Proof</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">unfold</span> <a class="idref" href="VLSM.Lib.StreamFilters.html#filtering_subsequence"><span class="id" title="definition">filtering_subsequence</span></a>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> !<a class="idref" href="VLSM.Lib.StreamExtras.html#ForAll2_forall"><span class="id" title="lemma">ForAll2_forall</span></a>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">by</span> <span class="id" title="tactic">setoid_rewrite</span> &lt;- <span class="id" title="var">HPQ</span>.<br/>
<span class="id" title="keyword">Qed</span>.<br/>

<br/>
</div>

<div class="doc">
  Each element in a <span class="inlinecode"><a class="idref" href="VLSM.Lib.StreamFilters.html#filtering_subsequence"><span class="id" title="definition">filtering_subsequence</span></a></span> is a position in the base
  stream for which the predicate holds.

</div>
<div class="code">
<span class="id" title="keyword">Lemma</span> <a id="filtering_subsequence_witness" class="idref" href="#filtering_subsequence_witness"><span class="id" title="lemma">filtering_subsequence_witness</span></a><br/>
&nbsp;&nbsp;{<a id="A:36" class="idref" href="#A:36"><span class="id" title="binder">A</span></a> : <span class="id" title="keyword">Type</span>}<br/>
&nbsp;&nbsp;(<a id="P:37" class="idref" href="#P:37"><span class="id" title="binder">P</span></a> : <a class="idref" href="VLSM.Lib.StreamFilters.html#A:36"><span class="id" title="variable">A</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x"><span class="id" title="notation">-&gt;</span></a> <span class="id" title="keyword">Prop</span>)<br/>
&nbsp;&nbsp;(<a id="s:38" class="idref" href="#s:38"><span class="id" title="binder">s</span></a> : <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Lists.Streams.html#Stream"><span class="id" title="inductive">Stream</span></a> <a class="idref" href="VLSM.Lib.StreamFilters.html#A:36"><span class="id" title="variable">A</span></a>)<br/>
&nbsp;&nbsp;(<a id="ss:39" class="idref" href="#ss:39"><span class="id" title="binder">ss</span></a> : <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Lists.Streams.html#Stream"><span class="id" title="inductive">Stream</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Datatypes.html#nat"><span class="id" title="inductive">nat</span></a>)<br/>
&nbsp;&nbsp;(<a id="Hfs:40" class="idref" href="#Hfs:40"><span class="id" title="binder">Hfs</span></a> : <a class="idref" href="VLSM.Lib.StreamFilters.html#filtering_subsequence"><span class="id" title="definition">filtering_subsequence</span></a> <a class="idref" href="VLSM.Lib.StreamFilters.html#P:37"><span class="id" title="variable">P</span></a> <a class="idref" href="VLSM.Lib.StreamFilters.html#s:38"><span class="id" title="variable">s</span></a> <a class="idref" href="VLSM.Lib.StreamFilters.html#ss:39"><span class="id" title="variable">ss</span></a>)<br/>
&nbsp;&nbsp;(<a id="k:41" class="idref" href="#k:41"><span class="id" title="binder">k</span></a> : <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Datatypes.html#nat"><span class="id" title="inductive">nat</span></a>)<br/>
&nbsp;&nbsp;: <a class="idref" href="VLSM.Lib.StreamFilters.html#P:37"><span class="id" title="variable">P</span></a> (<a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Lists.Streams.html#Str_nth"><span class="id" title="definition">Str_nth</span></a> (<a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Lists.Streams.html#Str_nth"><span class="id" title="definition">Str_nth</span></a> <a class="idref" href="VLSM.Lib.StreamFilters.html#k:41"><span class="id" title="variable">k</span></a> <a class="idref" href="VLSM.Lib.StreamFilters.html#ss:39"><span class="id" title="variable">ss</span></a>) <a class="idref" href="VLSM.Lib.StreamFilters.html#s:38"><span class="id" title="variable">s</span></a>).<br/>
<span class="id" title="keyword">Proof</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">destruct</span> <span class="id" title="var">Hfs</span> <span class="id" title="keyword">as</span> [<span class="id" title="var">_</span> <span class="id" title="var">Hfs</span>].<br/>
&nbsp;&nbsp;<span class="id" title="tactic">by</span> <span class="id" title="tactic">rewrite</span> <a class="idref" href="VLSM.Lib.StreamExtras.html#ForAll2_forall"><span class="id" title="lemma">ForAll2_forall</span></a> <span class="id" title="tactic">in</span> <span class="id" title="var">Hfs</span>; <span class="id" title="tactic">apply</span> <span class="id" title="var">Hfs</span>.<br/>
<span class="id" title="keyword">Qed</span>.<br/>

<br/>
</div>

<div class="doc">
  For each position in the base stream for which the predicate holds is
  present in the <span class="inlinecode"><a class="idref" href="VLSM.Lib.StreamFilters.html#filtering_subsequence"><span class="id" title="definition">filtering_subsequence</span></a></span>.

</div>
<div class="code">
<span class="id" title="keyword">Lemma</span> <a id="filtering_subsequence_witness_rev" class="idref" href="#filtering_subsequence_witness_rev"><span class="id" title="lemma">filtering_subsequence_witness_rev</span></a><br/>
&nbsp;&nbsp;{<a id="A:42" class="idref" href="#A:42"><span class="id" title="binder">A</span></a> : <span class="id" title="keyword">Type</span>}<br/>
&nbsp;&nbsp;(<a id="P:43" class="idref" href="#P:43"><span class="id" title="binder">P</span></a> : <a class="idref" href="VLSM.Lib.StreamFilters.html#A:42"><span class="id" title="variable">A</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x"><span class="id" title="notation">-&gt;</span></a> <span class="id" title="keyword">Prop</span>)<br/>
&nbsp;&nbsp;(<a id="s:44" class="idref" href="#s:44"><span class="id" title="binder">s</span></a> : <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Lists.Streams.html#Stream"><span class="id" title="inductive">Stream</span></a> <a class="idref" href="VLSM.Lib.StreamFilters.html#A:42"><span class="id" title="variable">A</span></a>)<br/>
&nbsp;&nbsp;(<a id="ss:45" class="idref" href="#ss:45"><span class="id" title="binder">ss</span></a> : <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Lists.Streams.html#Stream"><span class="id" title="inductive">Stream</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Datatypes.html#nat"><span class="id" title="inductive">nat</span></a>)<br/>
&nbsp;&nbsp;(<a id="Hfs:46" class="idref" href="#Hfs:46"><span class="id" title="binder">Hfs</span></a> : <a class="idref" href="VLSM.Lib.StreamFilters.html#filtering_subsequence"><span class="id" title="definition">filtering_subsequence</span></a> <a class="idref" href="VLSM.Lib.StreamFilters.html#P:43"><span class="id" title="variable">P</span></a> <a class="idref" href="VLSM.Lib.StreamFilters.html#s:44"><span class="id" title="variable">s</span></a> <a class="idref" href="VLSM.Lib.StreamFilters.html#ss:45"><span class="id" title="variable">ss</span></a>)<br/>
&nbsp;&nbsp;(<a id="n:47" class="idref" href="#n:47"><span class="id" title="binder">n</span></a> : <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Datatypes.html#nat"><span class="id" title="inductive">nat</span></a>)<br/>
&nbsp;&nbsp;(<a id="Hn:48" class="idref" href="#Hn:48"><span class="id" title="binder">Hn</span></a> : <a class="idref" href="VLSM.Lib.StreamFilters.html#P:43"><span class="id" title="variable">P</span></a> (<a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Lists.Streams.html#Str_nth"><span class="id" title="definition">Str_nth</span></a> <a class="idref" href="VLSM.Lib.StreamFilters.html#n:47"><span class="id" title="variable">n</span></a> <a class="idref" href="VLSM.Lib.StreamFilters.html#s:44"><span class="id" title="variable">s</span></a>))<br/>
&nbsp;&nbsp;: <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Logic.html#a883bdd010993579f99d60b3775bcf54"><span class="id" title="notation">exists</span></a> <a id="k:49" class="idref" href="#k:49"><span class="id" title="binder">k</span></a><a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Logic.html#a883bdd010993579f99d60b3775bcf54"><span class="id" title="notation">,</span></a> <a class="idref" href="VLSM.Lib.StreamFilters.html#n:47"><span class="id" title="variable">n</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">=</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Lists.Streams.html#Str_nth"><span class="id" title="definition">Str_nth</span></a> <a class="idref" href="VLSM.Lib.StreamFilters.html#k:49"><span class="id" title="variable">k</span></a> <a class="idref" href="VLSM.Lib.StreamFilters.html#ss:45"><span class="id" title="variable">ss</span></a>.<br/>
<span class="id" title="keyword">Proof</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">apply</span> <a class="idref" href="VLSM.Lib.StreamFilters.html#filtering_subsequence_sorted"><span class="id" title="lemma">filtering_subsequence_sorted</span></a> <span class="id" title="tactic">in</span> <span class="id" title="var">Hfs</span> <span class="id" title="keyword">as</span> <span class="id" title="var">Hss_sorted</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">apply</span> <a class="idref" href="VLSM.Lib.StreamExtras.html#monotone_nat_stream_prop_from_successor"><span class="id" title="lemma">monotone_nat_stream_prop_from_successor</span></a> <span class="id" title="tactic">in</span> <span class="id" title="var">Hss_sorted</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">apply</span> <a class="idref" href="VLSM.Lib.StreamExtras.html#monotone_nat_stream_find"><span class="id" title="lemma">monotone_nat_stream_find</span></a> <span class="id" title="keyword">with</span> (<span class="id" title="var">n</span> := <span class="id" title="var">n</span>) <span class="id" title="tactic">in</span> <span class="id" title="var">Hss_sorted</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">destruct</span> <span class="id" title="var">Hss_sorted</span>  <span class="id" title="keyword">as</span> [<span class="id" title="var">Hlt</span> | [<span class="id" title="var">k</span> <span class="id" title="var">Hk</span>]].<br/>
&nbsp;&nbsp;- <span class="id" title="tactic">by</span> <span class="id" title="tactic">destruct</span> <span class="id" title="var">Hfs</span> <span class="id" title="keyword">as</span> [<span class="id" title="var">Hfs</span> <span class="id" title="var">_</span>]; <span class="id" title="tactic">elim</span> (<span class="id" title="var">Hfs</span> <span class="id" title="var">n</span>).<br/>
&nbsp;&nbsp;- <span class="id" title="tactic">destruct</span> <span class="id" title="var">Hk</span> <span class="id" title="keyword">as</span> [<span class="id" title="var">Heq</span> | <span class="id" title="var">Hk</span>]; <span class="id" title="tactic">subst</span>; [<span class="id" title="tactic">by</span> <span class="id" title="tactic">exists</span> <span class="id" title="var">k</span> |].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">exfalso</span>. <span class="id" title="tactic">apply</span> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Logic.html#proj2"><span class="id" title="lemma">proj2</span></a> <span class="id" title="tactic">in</span> <span class="id" title="var">Hfs</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> <a class="idref" href="VLSM.Lib.StreamExtras.html#ForAll2_forall"><span class="id" title="lemma">ForAll2_forall</span></a> <span class="id" title="tactic">in</span> <span class="id" title="var">Hfs</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">specialize</span> (<span class="id" title="var">Hfs</span> <span class="id" title="var">k</span>) <span class="id" title="keyword">as</span> [<span class="id" title="var">_</span> [<span class="id" title="var">_</span> <span class="id" title="var">Hfs</span>]].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">by</span> <span class="id" title="tactic">elim</span> (<span class="id" title="var">Hfs</span> <span class="id" title="var">n</span>).<br/>
<span class="id" title="keyword">Qed</span>.<br/>

<br/>
<span class="id" title="keyword">Lemma</span> <a id="FilteringSubsequence_iff" class="idref" href="#FilteringSubsequence_iff"><span class="id" title="lemma">FilteringSubsequence_iff</span></a><br/>
&nbsp;&nbsp;{<a id="A:50" class="idref" href="#A:50"><span class="id" title="binder">A</span></a> : <span class="id" title="keyword">Type</span>}<br/>
&nbsp;&nbsp;(<a id="P:51" class="idref" href="#P:51"><span class="id" title="binder">P</span></a> : <a class="idref" href="VLSM.Lib.StreamFilters.html#A:50"><span class="id" title="variable">A</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x"><span class="id" title="notation">-&gt;</span></a> <span class="id" title="keyword">Prop</span>)<br/>
&nbsp;&nbsp;(<a id="s:52" class="idref" href="#s:52"><span class="id" title="binder">s</span></a> : <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Lists.Streams.html#Stream"><span class="id" title="inductive">Stream</span></a> <a class="idref" href="VLSM.Lib.StreamFilters.html#A:50"><span class="id" title="variable">A</span></a>)<br/>
&nbsp;&nbsp;(<a id="ss:53" class="idref" href="#ss:53"><span class="id" title="binder">ss</span></a> : <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Lists.Streams.html#Stream"><span class="id" title="inductive">Stream</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Datatypes.html#nat"><span class="id" title="inductive">nat</span></a>)<br/>
&nbsp;&nbsp;: <a class="idref" href="VLSM.Lib.StreamFilters.html#FilteringSubsequence"><span class="id" title="record">FilteringSubsequence</span></a> <a class="idref" href="VLSM.Lib.StreamFilters.html#P:51"><span class="id" title="variable">P</span></a> <a class="idref" href="VLSM.Lib.StreamFilters.html#s:52"><span class="id" title="variable">s</span></a> <a class="idref" href="VLSM.Lib.StreamFilters.html#ss:53"><span class="id" title="variable">ss</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Logic.html#::type_scope:x_'&lt;-&gt;'_x"><span class="id" title="notation">&lt;-&gt;</span></a> <a class="idref" href="VLSM.Lib.StreamFilters.html#filtering_subsequence"><span class="id" title="definition">filtering_subsequence</span></a> <a class="idref" href="VLSM.Lib.StreamFilters.html#P:51"><span class="id" title="variable">P</span></a> <a class="idref" href="VLSM.Lib.StreamFilters.html#s:52"><span class="id" title="variable">s</span></a> <a class="idref" href="VLSM.Lib.StreamFilters.html#ss:53"><span class="id" title="variable">ss</span></a>.<br/>
<span class="id" title="keyword">Proof</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">split</span>.<br/>
&nbsp;&nbsp;- <span class="id" title="tactic">intros</span> []; <span class="id" title="tactic">split</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="id" title="tactic">setoid_rewrite</span> <span class="id" title="var">fs_is_filter0</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">intros</span> <span class="id" title="var">i</span> <span class="id" title="var">Hi</span> [? -&gt;].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">apply</span> (<span class="id" title="var">fs_monotone0</span> <span class="id" title="var">x</span> 0) <span class="id" title="tactic">in</span> <span class="id" title="var">Hi</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">by</span> <span class="id" title="var">lia</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="id" title="tactic">apply</span> <a class="idref" href="VLSM.Lib.StreamExtras.html#ForAll2_forall"><span class="id" title="lemma">ForAll2_forall</span></a>; <span class="id" title="tactic">intros</span> <span class="id" title="var">n</span>; <span class="id" title="var">split_and</span>!.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;* <span class="id" title="tactic">by</span> <span class="id" title="tactic">apply</span> <span class="id" title="var">fs_is_filter0</span>; <span class="id" title="tactic">eexists</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;* <span class="id" title="tactic">by</span> <span class="id" title="tactic">apply</span> (<span class="id" title="var">fs_monotone0</span> <span class="id" title="var">n</span> (<a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Datatypes.html#S"><span class="id" title="constructor">S</span></a> <span class="id" title="var">n</span>)); <span class="id" title="var">lia</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;* <span class="id" title="tactic">setoid_rewrite</span> <span class="id" title="var">fs_is_filter0</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">intros</span> <span class="id" title="var">i</span> [<span class="id" title="var">Hni</span> <span class="id" title="var">Hni'</span>] [? -&gt;].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">by</span> <span class="id" title="tactic">apply</span> <span class="id" title="var">fs_monotone0</span> <span class="id" title="tactic">in</span> <span class="id" title="var">Hni</span>, <span class="id" title="var">Hni'</span>; <span class="id" title="var">lia</span>.<br/>
&nbsp;&nbsp;- <span class="id" title="tactic">constructor</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="id" title="tactic">by</span> <span class="id" title="tactic">eapply</span> <a class="idref" href="VLSM.Lib.StreamExtras.html#monotone_nat_stream_prop_from_successor"><span class="id" title="lemma">monotone_nat_stream_prop_from_successor</span></a>, <a class="idref" href="VLSM.Lib.StreamFilters.html#filtering_subsequence_sorted"><span class="id" title="lemma">filtering_subsequence_sorted</span></a>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="id" title="tactic">split</span>; [<span class="id" title="tactic">by</span> <span class="id" title="tactic">apply</span> <a class="idref" href="VLSM.Lib.StreamFilters.html#filtering_subsequence_witness_rev"><span class="id" title="lemma">filtering_subsequence_witness_rev</span></a> |].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">by</span> <span class="id" title="tactic">intros</span> [? -&gt;]; <span class="id" title="tactic">apply</span> <a class="idref" href="VLSM.Lib.StreamFilters.html#filtering_subsequence_witness"><span class="id" title="lemma">filtering_subsequence_witness</span></a>.<br/>
<span class="id" title="keyword">Qed</span>.<br/>

<br/>
</div>

<div class="doc">
Prefixes of the filtering subsequence expressed as filters. 
</div>
<div class="code">
<span class="id" title="keyword">Lemma</span> <a id="filtering_subsequence_prefix_is_filter" class="idref" href="#filtering_subsequence_prefix_is_filter"><span class="id" title="lemma">filtering_subsequence_prefix_is_filter</span></a><br/>
&nbsp;&nbsp;{<a id="A:54" class="idref" href="#A:54"><span class="id" title="binder">A</span></a> : <span class="id" title="keyword">Type</span>}<br/>
&nbsp;&nbsp;(<a id="P:55" class="idref" href="#P:55"><span class="id" title="binder">P</span></a> : <a class="idref" href="VLSM.Lib.StreamFilters.html#A:54"><span class="id" title="variable">A</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x"><span class="id" title="notation">-&gt;</span></a> <span class="id" title="keyword">Prop</span>)<br/>
&nbsp;&nbsp;{<a id="Pdec:57" class="idref" href="#Pdec:57"><span class="id" title="binder">Pdec</span></a> : <span class="id" title="notation">forall</span> <a id="a:56" class="idref" href="#a:56"><span class="id" title="binder">a</span></a><span class="id" title="notation">,</span> <span class="id" title="class">Decision</span> (<a class="idref" href="VLSM.Lib.StreamFilters.html#P:55"><span class="id" title="variable">P</span></a> <a class="idref" href="VLSM.Lib.StreamFilters.html#a:56"><span class="id" title="variable">a</span></a>)}<br/>
&nbsp;&nbsp;(<a id="s:58" class="idref" href="#s:58"><span class="id" title="binder">s</span></a> : <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Lists.Streams.html#Stream"><span class="id" title="inductive">Stream</span></a> <a class="idref" href="VLSM.Lib.StreamFilters.html#A:54"><span class="id" title="variable">A</span></a>)<br/>
&nbsp;&nbsp;(<a id="ss:59" class="idref" href="#ss:59"><span class="id" title="binder">ss</span></a> : <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Lists.Streams.html#Stream"><span class="id" title="inductive">Stream</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Datatypes.html#nat"><span class="id" title="inductive">nat</span></a>)<br/>
&nbsp;&nbsp;(<a id="Hfs:60" class="idref" href="#Hfs:60"><span class="id" title="binder">Hfs</span></a> : <a class="idref" href="VLSM.Lib.StreamFilters.html#filtering_subsequence"><span class="id" title="definition">filtering_subsequence</span></a> <a class="idref" href="VLSM.Lib.StreamFilters.html#P:55"><span class="id" title="variable">P</span></a> <a class="idref" href="VLSM.Lib.StreamFilters.html#s:58"><span class="id" title="variable">s</span></a> <a class="idref" href="VLSM.Lib.StreamFilters.html#ss:59"><span class="id" title="variable">ss</span></a>)<br/>
&nbsp;&nbsp;: <span class="id" title="notation">forall</span> <span class="id" title="notation">(</span><a id="k:61" class="idref" href="#k:61"><span class="id" title="binder">k</span></a> : <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Datatypes.html#nat"><span class="id" title="inductive">nat</span></a><span class="id" title="notation">),</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="VLSM.Lib.StreamExtras.html#stream_prefix"><span class="id" title="definition">stream_prefix</span></a> <a class="idref" href="VLSM.Lib.StreamFilters.html#ss:59"><span class="id" title="variable">ss</span></a> (<a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Datatypes.html#S"><span class="id" title="constructor">S</span></a> <a class="idref" href="VLSM.Lib.StreamFilters.html#k:61"><span class="id" title="variable">k</span></a>) <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">=</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="definition">filter</span> (<span class="id" title="keyword">fun</span> <a id="i:62" class="idref" href="#i:62"><span class="id" title="binder">i</span></a> =&gt; <a class="idref" href="VLSM.Lib.StreamFilters.html#P:55"><span class="id" title="variable">P</span></a> (<a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Lists.Streams.html#Str_nth"><span class="id" title="definition">Str_nth</span></a> <a class="idref" href="VLSM.Lib.StreamFilters.html#i:62"><span class="id" title="variable">i</span></a> <a class="idref" href="VLSM.Lib.StreamFilters.html#s:58"><span class="id" title="variable">s</span></a>)) (<a class="idref" href="VLSM.Lib.StreamExtras.html#stream_prefix"><span class="id" title="definition">stream_prefix</span></a> <a class="idref" href="VLSM.Lib.StreamExtras.html#nat_sequence"><span class="id" title="definition">nat_sequence</span></a> (<a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Datatypes.html#S"><span class="id" title="constructor">S</span></a> (<a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Lists.Streams.html#Str_nth"><span class="id" title="definition">Str_nth</span></a> <a class="idref" href="VLSM.Lib.StreamFilters.html#k:61"><span class="id" title="variable">k</span></a> <a class="idref" href="VLSM.Lib.StreamFilters.html#ss:59"><span class="id" title="variable">ss</span></a>))).<br/>
<span class="id" title="keyword">Proof</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">intro</span> <span class="id" title="var">k</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">apply</span> (@<a class="idref" href="VLSM.Lib.SortedLists.html#set_equality_predicate"><span class="id" title="lemma">set_equality_predicate</span></a> <span class="id" title="var">_</span> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Peano.html#lt"><span class="id" title="definition">lt</span></a> <span class="id" title="var">_</span>).<br/>
&nbsp;&nbsp;- <span class="id" title="tactic">by</span> <span class="id" title="tactic">apply</span> <a class="idref" href="VLSM.Lib.StreamFilters.html#filtering_subsequence_prefix_sorted"><span class="id" title="lemma">filtering_subsequence_prefix_sorted</span></a> <span class="id" title="keyword">with</span> <span class="id" title="var">P</span> <span class="id" title="var">s</span>.<br/>
&nbsp;&nbsp;- <span class="id" title="tactic">apply</span> <a class="idref" href="VLSM.Lib.SortedLists.html#LocallySorted_filter"><span class="id" title="lemma">LocallySorted_filter</span></a>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="id" title="tactic">by</span> <span class="id" title="var">typeclasses</span> <span class="id" title="tactic">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="id" title="tactic">by</span> <span class="id" title="tactic">apply</span> <a class="idref" href="VLSM.Lib.StreamExtras.html#nat_sequence_prefix_sorted"><span class="id" title="definition">nat_sequence_prefix_sorted</span></a>.<br/>
&nbsp;&nbsp;- <span class="id" title="tactic">unfold</span> <a class="idref" href="VLSM.Lib.ListSetExtras.html#set_eq"><span class="id" title="definition">ListSetExtras.set_eq</span></a>, <span class="id" title="definition">subseteq</span>, <span class="id" title="instance">list_subseteq</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">setoid_rewrite</span> <span class="id" title="lemma">elem_of_list_filter</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">setoid_rewrite</span> <a class="idref" href="VLSM.Lib.StreamExtras.html#elem_of_stream_prefix"><span class="id" title="lemma">elem_of_stream_prefix</span></a>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">setoid_rewrite</span> <a class="idref" href="VLSM.Lib.StreamExtras.html#nat_sequence_nth"><span class="id" title="lemma">nat_sequence_nth</span></a>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">split</span>; <span class="id" title="tactic">intros</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="id" title="tactic">destruct</span> <span class="id" title="var">H</span> <span class="id" title="keyword">as</span> [<span class="id" title="var">i</span> [<span class="id" title="var">Hi</span> <span class="id" title="var">Ha</span>]].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">subst</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">split</span>; [<span class="id" title="tactic">by</span> <span class="id" title="tactic">apply</span> <a class="idref" href="VLSM.Lib.StreamFilters.html#filtering_subsequence_witness"><span class="id" title="lemma">filtering_subsequence_witness</span></a> |].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">eexists</span>; <span class="id" title="tactic">split</span>; [| <span class="id" title="var">done</span>].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">destruct</span> (<span class="id" title="definition">decide</span> (<span class="id" title="var">i</span> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">=</span></a> <span class="id" title="var">k</span>)); [<span class="id" title="tactic">subst</span>; <span class="id" title="var">lia</span> |].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">cut</span> (<a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Lists.Streams.html#Str_nth"><span class="id" title="definition">Str_nth</span></a> <span class="id" title="var">i</span> <span class="id" title="var">ss</span> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Peano.html#::nat_scope:x_'&lt;'_x"><span class="id" title="notation">&lt;</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Lists.Streams.html#Str_nth"><span class="id" title="definition">Str_nth</span></a> <span class="id" title="var">k</span> <span class="id" title="var">ss</span>); [<span class="id" title="var">lia</span> |].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">apply</span> <a class="idref" href="VLSM.Lib.StreamExtras.html#ForAll2_transitive_lookup"><span class="id" title="lemma">ForAll2_transitive_lookup</span></a>; [<span class="id" title="tactic">by</span> <span class="id" title="var">typeclasses</span> <span class="id" title="tactic">eauto</span> | | <span class="id" title="var">lia</span>].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">by</span> <span class="id" title="tactic">apply</span> <a class="idref" href="VLSM.Lib.StreamFilters.html#filtering_subsequence_sorted"><span class="id" title="lemma">filtering_subsequence_sorted</span></a> <span class="id" title="tactic">in</span> <span class="id" title="var">Hfs</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="id" title="tactic">destruct</span> <span class="id" title="var">H</span> <span class="id" title="keyword">as</span> [<span class="id" title="var">Hpa</span> [<span class="id" title="var">_a</span> [<span class="id" title="var">Hlt</span> <span class="id" title="var">H_a</span>]]].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">subst</span> <span class="id" title="var">_a</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">destruct</span> (<a class="idref" href="VLSM.Lib.StreamFilters.html#filtering_subsequence_witness_rev"><span class="id" title="lemma">filtering_subsequence_witness_rev</span></a> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">Hfs</span> <span class="id" title="var">_</span> <span class="id" title="var">Hpa</span>) <span class="id" title="keyword">as</span> [<span class="id" title="var">k'</span> -&gt;].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">exists</span> <span class="id" title="var">k'</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">split</span>; [| <span class="id" title="var">done</span>].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">apply</span> <a class="idref" href="VLSM.Lib.StreamFilters.html#filtering_subsequence_sorted"><span class="id" title="lemma">filtering_subsequence_sorted</span></a> <span class="id" title="tactic">in</span> <span class="id" title="var">Hfs</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">apply</span> <a class="idref" href="VLSM.Lib.StreamExtras.html#monotone_nat_stream_prop_from_successor"><span class="id" title="lemma">monotone_nat_stream_prop_from_successor</span></a> <span class="id" title="tactic">in</span> <span class="id" title="var">Hfs</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">specialize</span> (<a class="idref" href="VLSM.Lib.StreamExtras.html#monotone_nat_stream_rev"><span class="id" title="lemma">monotone_nat_stream_rev</span></a> <span class="id" title="var">_</span> <span class="id" title="var">Hfs</span> <span class="id" title="var">k'</span> <span class="id" title="var">k</span>) <span class="id" title="keyword">as</span> <span class="id" title="var">Hle</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">by</span> <span class="id" title="var">lia</span>.<br/>
<span class="id" title="keyword">Qed</span>.<br/>

<br/>
<span class="id" title="keyword">Lemma</span> <a id="filtering_subsequence_prefix_length" class="idref" href="#filtering_subsequence_prefix_length"><span class="id" title="lemma">filtering_subsequence_prefix_length</span></a><br/>
&nbsp;&nbsp;{<a id="A:63" class="idref" href="#A:63"><span class="id" title="binder">A</span></a> : <span class="id" title="keyword">Type</span>}<br/>
&nbsp;&nbsp;(<a id="P:64" class="idref" href="#P:64"><span class="id" title="binder">P</span></a> : <a class="idref" href="VLSM.Lib.StreamFilters.html#A:63"><span class="id" title="variable">A</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x"><span class="id" title="notation">-&gt;</span></a> <span class="id" title="keyword">Prop</span>)<br/>
&nbsp;&nbsp;{<a id="Pdec:66" class="idref" href="#Pdec:66"><span class="id" title="binder">Pdec</span></a> : <span class="id" title="notation">forall</span> <a id="a:65" class="idref" href="#a:65"><span class="id" title="binder">a</span></a><span class="id" title="notation">,</span> <span class="id" title="class">Decision</span> (<a class="idref" href="VLSM.Lib.StreamFilters.html#P:64"><span class="id" title="variable">P</span></a> <a class="idref" href="VLSM.Lib.StreamFilters.html#a:65"><span class="id" title="variable">a</span></a>)}<br/>
&nbsp;&nbsp;(<a id="s:67" class="idref" href="#s:67"><span class="id" title="binder">s</span></a> : <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Lists.Streams.html#Stream"><span class="id" title="inductive">Stream</span></a> <a class="idref" href="VLSM.Lib.StreamFilters.html#A:63"><span class="id" title="variable">A</span></a>)<br/>
&nbsp;&nbsp;(<a id="ss:68" class="idref" href="#ss:68"><span class="id" title="binder">ss</span></a> : <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Lists.Streams.html#Stream"><span class="id" title="inductive">Stream</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Datatypes.html#nat"><span class="id" title="inductive">nat</span></a>)<br/>
&nbsp;&nbsp;(<a id="Hfs:69" class="idref" href="#Hfs:69"><span class="id" title="binder">Hfs</span></a> : <a class="idref" href="VLSM.Lib.StreamFilters.html#filtering_subsequence"><span class="id" title="definition">filtering_subsequence</span></a> <a class="idref" href="VLSM.Lib.StreamFilters.html#P:64"><span class="id" title="variable">P</span></a> <a class="idref" href="VLSM.Lib.StreamFilters.html#s:67"><span class="id" title="variable">s</span></a> <a class="idref" href="VLSM.Lib.StreamFilters.html#ss:68"><span class="id" title="variable">ss</span></a>)<br/>
&nbsp;&nbsp;(<a id="m:70" class="idref" href="#m:70"><span class="id" title="binder">m</span></a> : <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Datatypes.html#nat"><span class="id" title="inductive">nat</span></a>)<br/>
&nbsp;&nbsp;: <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Datatypes.html#length"><span class="id" title="definition">length</span></a> (<span class="id" title="definition">filter</span> <a class="idref" href="VLSM.Lib.StreamFilters.html#P:64"><span class="id" title="variable">P</span></a> (<a class="idref" href="VLSM.Lib.StreamExtras.html#stream_prefix"><span class="id" title="definition">stream_prefix</span></a> <a class="idref" href="VLSM.Lib.StreamFilters.html#s:67"><span class="id" title="variable">s</span></a> (<a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Datatypes.html#S"><span class="id" title="constructor">S</span></a> (<a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Lists.Streams.html#Str_nth"><span class="id" title="definition">Str_nth</span></a> <a class="idref" href="VLSM.Lib.StreamFilters.html#m:70"><span class="id" title="variable">m</span></a> <a class="idref" href="VLSM.Lib.StreamFilters.html#ss:68"><span class="id" title="variable">ss</span></a>)))) <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">=</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Datatypes.html#S"><span class="id" title="constructor">S</span></a> <a class="idref" href="VLSM.Lib.StreamFilters.html#m:70"><span class="id" title="variable">m</span></a>.<br/>
<span class="id" title="keyword">Proof</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">specialize</span> (<a class="idref" href="VLSM.Lib.StreamFilters.html#filtering_subsequence_prefix_is_filter"><span class="id" title="lemma">filtering_subsequence_prefix_is_filter</span></a> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">Hfs</span> <span class="id" title="var">m</span>) <span class="id" title="keyword">as</span> <span class="id" title="var">Hfilter</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">apply</span> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Logic.html#f_equal"><span class="id" title="lemma">f_equal</span></a> <span class="id" title="keyword">with</span> (<span class="id" title="var">f</span> := <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Datatypes.html#length"><span class="id" title="definition">length</span></a>) <span class="id" title="tactic">in</span> <span class="id" title="var">Hfilter</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> <a class="idref" href="VLSM.Lib.StreamExtras.html#stream_prefix_length"><span class="id" title="lemma">stream_prefix_length</span></a> <span class="id" title="tactic">in</span> <span class="id" title="var">Hfilter</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span>! <a class="idref" href="VLSM.Lib.StreamExtras.html#stream_prefix_S"><span class="id" title="lemma">stream_prefix_S</span></a>, <span class="id" title="lemma">filter_app</span> <span class="id" title="tactic">in</span> <span class="id" title="var">Hfilter</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">unfold</span> <span class="id" title="definition">filter</span> <span class="id" title="tactic">at</span> 2 <span class="id" title="tactic">in</span> <span class="id" title="var">Hfilter</span>. <span class="id" title="tactic">simpl</span> <span class="id" title="tactic">in</span> <span class="id" title="var">Hfilter</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> <a class="idref" href="VLSM.Lib.StreamExtras.html#nat_sequence_nth"><span class="id" title="lemma">nat_sequence_nth</span></a> <span class="id" title="tactic">in</span> <span class="id" title="var">Hfilter</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> <a class="idref" href="VLSM.Lib.StreamExtras.html#stream_prefix_S"><span class="id" title="lemma">stream_prefix_S</span></a>, <span class="id" title="lemma">filter_app</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">unfold</span> <span class="id" title="definition">filter</span> <span class="id" title="tactic">at</span> 2. <span class="id" title="tactic">simpl</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">specialize</span> (<a class="idref" href="VLSM.Lib.StreamFilters.html#filtering_subsequence_witness"><span class="id" title="lemma">filtering_subsequence_witness</span></a> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">Hfs</span> <span class="id" title="var">m</span>) <span class="id" title="keyword">as</span> <span class="id" title="var">Hm</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> <span class="id" title="lemma">decide_True</span> <span class="id" title="tactic">in</span> <span class="id" title="var">Hfilter</span> <span class="id" title="tactic">by</span> <span class="id" title="var">done</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> <span class="id" title="lemma">decide_True</span> <span class="id" title="tactic">by</span> <span class="id" title="var">done</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Lists.List.html#app_length"><span class="id" title="lemma">app_length</span></a>, <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Numbers.Natural.Peano.NPeano.html#Nat.add_comm"><span class="id" title="lemma">Nat.add_comm</span></a> <span class="id" title="tactic">in</span> <span class="id" title="var">Hfilter</span>. <span class="id" title="tactic">simpl</span> <span class="id" title="tactic">in</span> <span class="id" title="var">Hfilter</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Lists.List.html#app_length"><span class="id" title="lemma">app_length</span></a>, <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Numbers.Natural.Peano.NPeano.html#Nat.add_comm"><span class="id" title="lemma">Nat.add_comm</span></a>. <span class="id" title="tactic">simpl</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> <span class="id" title="var">Hfilter</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">f_equal</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">clear</span> -<span class="id" title="var">Hfs</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">generalize</span> (<a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Lists.Streams.html#Str_nth"><span class="id" title="definition">Str_nth</span></a> <span class="id" title="var">m</span> <span class="id" title="var">ss</span>).<br/>
&nbsp;&nbsp;<span class="id" title="tactic">induction</span> <span class="id" title="var">n</span>; [<span class="id" title="var">done</span> |].<br/>
&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> !<a class="idref" href="VLSM.Lib.StreamExtras.html#stream_prefix_S"><span class="id" title="lemma">stream_prefix_S</span></a>, !<span class="id" title="lemma">filter_app</span>, !<a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Lists.List.html#app_length"><span class="id" title="lemma">app_length</span></a>, <span class="id" title="var">IHn</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">f_equal</span>. <span class="id" title="tactic">rewrite</span> <a class="idref" href="VLSM.Lib.StreamExtras.html#nat_sequence_nth"><span class="id" title="lemma">nat_sequence_nth</span></a>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">by</span> <span class="id" title="var">cbn</span>; <span class="id" title="var">case_decide</span>.<br/>
<span class="id" title="keyword">Qed</span>.<br/>

<br/>
<span class="id" title="keyword">Lemma</span> <a id="filtering_subsequence_prefix_is_filter_last" class="idref" href="#filtering_subsequence_prefix_is_filter_last"><span class="id" title="lemma">filtering_subsequence_prefix_is_filter_last</span></a><br/>
&nbsp;&nbsp;{<a id="A:71" class="idref" href="#A:71"><span class="id" title="binder">A</span></a> : <span class="id" title="keyword">Type</span>}<br/>
&nbsp;&nbsp;(<a id="P:72" class="idref" href="#P:72"><span class="id" title="binder">P</span></a> : <a class="idref" href="VLSM.Lib.StreamFilters.html#A:71"><span class="id" title="variable">A</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x"><span class="id" title="notation">-&gt;</span></a> <span class="id" title="keyword">Prop</span>)<br/>
&nbsp;&nbsp;{<a id="Pdec:74" class="idref" href="#Pdec:74"><span class="id" title="binder">Pdec</span></a> : <span class="id" title="notation">forall</span> <a id="a:73" class="idref" href="#a:73"><span class="id" title="binder">a</span></a><span class="id" title="notation">,</span> <span class="id" title="class">Decision</span> (<a class="idref" href="VLSM.Lib.StreamFilters.html#P:72"><span class="id" title="variable">P</span></a> <a class="idref" href="VLSM.Lib.StreamFilters.html#a:73"><span class="id" title="variable">a</span></a>)}<br/>
&nbsp;&nbsp;(<a id="s:75" class="idref" href="#s:75"><span class="id" title="binder">s</span></a> : <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Lists.Streams.html#Stream"><span class="id" title="inductive">Stream</span></a> <a class="idref" href="VLSM.Lib.StreamFilters.html#A:71"><span class="id" title="variable">A</span></a>)<br/>
&nbsp;&nbsp;(<a id="ss:76" class="idref" href="#ss:76"><span class="id" title="binder">ss</span></a> : <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Lists.Streams.html#Stream"><span class="id" title="inductive">Stream</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Datatypes.html#nat"><span class="id" title="inductive">nat</span></a>)<br/>
&nbsp;&nbsp;(<a id="Hfs:77" class="idref" href="#Hfs:77"><span class="id" title="binder">Hfs</span></a> : <a class="idref" href="VLSM.Lib.StreamFilters.html#filtering_subsequence"><span class="id" title="definition">filtering_subsequence</span></a> <a class="idref" href="VLSM.Lib.StreamFilters.html#P:72"><span class="id" title="variable">P</span></a> <a class="idref" href="VLSM.Lib.StreamFilters.html#s:75"><span class="id" title="variable">s</span></a> <a class="idref" href="VLSM.Lib.StreamFilters.html#ss:76"><span class="id" title="variable">ss</span></a>)<br/>
&nbsp;&nbsp;(<a id="n:78" class="idref" href="#n:78"><span class="id" title="binder">n</span></a> : <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Datatypes.html#nat"><span class="id" title="inductive">nat</span></a>)<br/>
&nbsp;&nbsp;(<a id="Hn:79" class="idref" href="#Hn:79"><span class="id" title="binder">Hn</span></a> : <a class="idref" href="VLSM.Lib.StreamFilters.html#P:72"><span class="id" title="variable">P</span></a> (<a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Lists.Streams.html#Str_nth"><span class="id" title="definition">Str_nth</span></a> <a class="idref" href="VLSM.Lib.StreamFilters.html#n:78"><span class="id" title="variable">n</span></a> <a class="idref" href="VLSM.Lib.StreamFilters.html#s:75"><span class="id" title="variable">s</span></a>))<br/>
&nbsp;&nbsp;: <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Lists.Streams.html#Str_nth"><span class="id" title="definition">Str_nth</span></a> (<a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Datatypes.html#length"><span class="id" title="definition">length</span></a> (<span class="id" title="definition">filter</span> <a class="idref" href="VLSM.Lib.StreamFilters.html#P:72"><span class="id" title="variable">P</span></a> (<a class="idref" href="VLSM.Lib.StreamExtras.html#stream_prefix"><span class="id" title="definition">stream_prefix</span></a> <a class="idref" href="VLSM.Lib.StreamFilters.html#s:75"><span class="id" title="variable">s</span></a> <a class="idref" href="VLSM.Lib.StreamFilters.html#n:78"><span class="id" title="variable">n</span></a>))) <a class="idref" href="VLSM.Lib.StreamFilters.html#ss:76"><span class="id" title="variable">ss</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">=</span></a> <a class="idref" href="VLSM.Lib.StreamFilters.html#n:78"><span class="id" title="variable">n</span></a>.<br/>
<span class="id" title="keyword">Proof</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">specialize</span> (<a class="idref" href="VLSM.Lib.StreamFilters.html#filtering_subsequence_witness_rev"><span class="id" title="lemma">filtering_subsequence_witness_rev</span></a> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">Hfs</span> <span class="id" title="var">_</span> <span class="id" title="var">Hn</span>) <span class="id" title="keyword">as</span> [<span class="id" title="var">k</span> <span class="id" title="var">Heqn</span>].<br/>
&nbsp;&nbsp;<span class="id" title="tactic">replace</span> (<a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Datatypes.html#length"><span class="id" title="definition">length</span></a> <span class="id" title="var">_</span>) <span class="id" title="keyword">with</span> <span class="id" title="var">k</span>; [<span class="id" title="tactic">by</span> <span class="id" title="tactic">subst</span> |].<br/>
&nbsp;&nbsp;<span class="id" title="tactic">specialize</span> (<a class="idref" href="VLSM.Lib.StreamFilters.html#filtering_subsequence_prefix_length"><span class="id" title="lemma">filtering_subsequence_prefix_length</span></a> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">Hfs</span> <span class="id" title="var">k</span>) <span class="id" title="keyword">as</span> <span class="id" title="var">Hlength</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span>! <a class="idref" href="VLSM.Lib.StreamExtras.html#stream_prefix_S"><span class="id" title="lemma">stream_prefix_S</span></a>, <span class="id" title="lemma">filter_app</span> <span class="id" title="tactic">in</span> <span class="id" title="var">Hlength</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">unfold</span> <span class="id" title="definition">filter</span> <span class="id" title="tactic">at</span> 2 <span class="id" title="tactic">in</span> <span class="id" title="var">Hlength</span>. <span class="id" title="tactic">simpl</span> <span class="id" title="tactic">in</span> <span class="id" title="var">Hlength</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> <span class="id" title="lemma">decide_True</span> <span class="id" title="tactic">in</span> <span class="id" title="var">Hlength</span> <span class="id" title="tactic">by</span> (<span class="id" title="tactic">subst</span>; <span class="id" title="var">done</span>).<br/>
&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Lists.List.html#app_length"><span class="id" title="lemma">app_length</span></a>, <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Numbers.Natural.Peano.NPeano.html#Nat.add_comm"><span class="id" title="lemma">Nat.add_comm</span></a> <span class="id" title="tactic">in</span> <span class="id" title="var">Hlength</span>. <span class="id" title="tactic">simpl</span> <span class="id" title="tactic">in</span> <span class="id" title="var">Hlength</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">by</span> <span class="id" title="tactic">inversion</span> <span class="id" title="var">Hlength</span>; <span class="id" title="tactic">subst</span>.<br/>
<span class="id" title="keyword">Qed</span>.<br/>

<br/>
</div>

<div class="doc">
  Given a <span class="inlinecode"><a class="idref" href="VLSM.Lib.StreamFilters.html#filtering_subsequence"><span class="id" title="definition">filtering_subsequence</span></a></span> for property <code>P</code> over a stream <code>s</code> and
  a function <code>f</code> transforming elements with property <code>P</code>, we can define the
  filtering of <code>s</code> by <code>P</code> mapped through the function <code>f</code>.

</div>
<div class="code">
<span class="id" title="keyword">Definition</span> <a id="filtering_subsequence_stream_filter_map" class="idref" href="#filtering_subsequence_stream_filter_map"><span class="id" title="definition">filtering_subsequence_stream_filter_map</span></a><br/>
&nbsp;&nbsp;{<a id="A:80" class="idref" href="#A:80"><span class="id" title="binder">A</span></a> <a id="B:81" class="idref" href="#B:81"><span class="id" title="binder">B</span></a> : <span class="id" title="keyword">Type</span>}<br/>
&nbsp;&nbsp;(<a id="P:82" class="idref" href="#P:82"><span class="id" title="binder">P</span></a> : <a class="idref" href="VLSM.Lib.StreamFilters.html#A:80"><span class="id" title="variable">A</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x"><span class="id" title="notation">-&gt;</span></a> <span class="id" title="keyword">Prop</span>)<br/>
&nbsp;&nbsp;{<a id="Pdec:84" class="idref" href="#Pdec:84"><span class="id" title="binder">Pdec</span></a> : <span class="id" title="notation">forall</span> <a id="a:83" class="idref" href="#a:83"><span class="id" title="binder">a</span></a><span class="id" title="notation">,</span> <span class="id" title="class">Decision</span> (<a class="idref" href="VLSM.Lib.StreamFilters.html#P:82"><span class="id" title="variable">P</span></a> <a class="idref" href="VLSM.Lib.StreamFilters.html#a:83"><span class="id" title="variable">a</span></a>)}<br/>
&nbsp;&nbsp;(<a id="f:85" class="idref" href="#f:85"><span class="id" title="binder">f</span></a> : <span class="id" title="definition">dsig</span> <a class="idref" href="VLSM.Lib.StreamFilters.html#P:82"><span class="id" title="variable">P</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x"><span class="id" title="notation">-&gt;</span></a> <a class="idref" href="VLSM.Lib.StreamFilters.html#B:81"><span class="id" title="variable">B</span></a>)<br/>
&nbsp;&nbsp;(<a id="s:86" class="idref" href="#s:86"><span class="id" title="binder">s</span></a> : <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Lists.Streams.html#Stream"><span class="id" title="inductive">Stream</span></a> <a class="idref" href="VLSM.Lib.StreamFilters.html#A:80"><span class="id" title="variable">A</span></a>)<br/>
&nbsp;&nbsp;(<a id="ss:87" class="idref" href="#ss:87"><span class="id" title="binder">ss</span></a> : <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Lists.Streams.html#Stream"><span class="id" title="inductive">Stream</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Datatypes.html#nat"><span class="id" title="inductive">nat</span></a>)<br/>
&nbsp;&nbsp;(<a id="Hfs:88" class="idref" href="#Hfs:88"><span class="id" title="binder">Hfs</span></a> : <a class="idref" href="VLSM.Lib.StreamFilters.html#filtering_subsequence"><span class="id" title="definition">filtering_subsequence</span></a> <a class="idref" href="VLSM.Lib.StreamFilters.html#P:82"><span class="id" title="variable">P</span></a> <a class="idref" href="VLSM.Lib.StreamFilters.html#s:86"><span class="id" title="variable">s</span></a> <a class="idref" href="VLSM.Lib.StreamFilters.html#ss:87"><span class="id" title="variable">ss</span></a>)<br/>
&nbsp;&nbsp;: <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Lists.Streams.html#Stream"><span class="id" title="inductive">Stream</span></a> <a class="idref" href="VLSM.Lib.StreamFilters.html#B:81"><span class="id" title="variable">B</span></a><br/>
&nbsp;&nbsp;:= <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Lists.Streams.html#map"><span class="id" title="definition">map</span></a> (<span class="id" title="keyword">fun</span> <a id="k:89" class="idref" href="#k:89"><span class="id" title="binder">k</span></a> =&gt; <a class="idref" href="VLSM.Lib.StreamFilters.html#f:85"><span class="id" title="variable">f</span></a> (<span class="id" title="definition">dexist</span> <span class="id" title="var">_</span> (<a class="idref" href="VLSM.Lib.StreamFilters.html#filtering_subsequence_witness"><span class="id" title="lemma">filtering_subsequence_witness</span></a> <a class="idref" href="VLSM.Lib.StreamFilters.html#P:82"><span class="id" title="variable">P</span></a> <a class="idref" href="VLSM.Lib.StreamFilters.html#s:86"><span class="id" title="variable">s</span></a> <a class="idref" href="VLSM.Lib.StreamFilters.html#ss:87"><span class="id" title="variable">ss</span></a> <a class="idref" href="VLSM.Lib.StreamFilters.html#Hfs:88"><span class="id" title="variable">Hfs</span></a> <a class="idref" href="VLSM.Lib.StreamFilters.html#k:89"><span class="id" title="variable">k</span></a>))) <a class="idref" href="VLSM.Lib.StreamExtras.html#nat_sequence"><span class="id" title="definition">nat_sequence</span></a>.<br/>

<br/>
</div>

<div class="doc">
  Connecting prefixes of <span class="inlinecode"><a class="idref" href="VLSM.Lib.StreamFilters.html#filtering_subsequence_stream_filter_map"><span class="id" title="definition">filtering_subsequence_stream_filter_map</span></a></span> with
  <span class="inlinecode"><a class="idref" href="VLSM.Lib.ListExtras.html#list_filter_map"><span class="id" title="definition">list_filter_map</span></a></span>s on prefixes.

</div>
<div class="code">
<span class="id" title="keyword">Lemma</span> <a id="fitering_subsequence_stream_filter_map_prefix" class="idref" href="#fitering_subsequence_stream_filter_map_prefix"><span class="id" title="lemma">fitering_subsequence_stream_filter_map_prefix</span></a><br/>
&nbsp;&nbsp;{<a id="A:90" class="idref" href="#A:90"><span class="id" title="binder">A</span></a> <a id="B:91" class="idref" href="#B:91"><span class="id" title="binder">B</span></a> : <span class="id" title="keyword">Type</span>}<br/>
&nbsp;&nbsp;(<a id="P:92" class="idref" href="#P:92"><span class="id" title="binder">P</span></a> : <a class="idref" href="VLSM.Lib.StreamFilters.html#A:90"><span class="id" title="variable">A</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x"><span class="id" title="notation">-&gt;</span></a> <span class="id" title="keyword">Prop</span>)<br/>
&nbsp;&nbsp;{<a id="Pdec:94" class="idref" href="#Pdec:94"><span class="id" title="binder">Pdec</span></a> : <span class="id" title="notation">forall</span> <a id="a:93" class="idref" href="#a:93"><span class="id" title="binder">a</span></a><span class="id" title="notation">,</span> <span class="id" title="class">Decision</span> (<a class="idref" href="VLSM.Lib.StreamFilters.html#P:92"><span class="id" title="variable">P</span></a> <a class="idref" href="VLSM.Lib.StreamFilters.html#a:93"><span class="id" title="variable">a</span></a>)}<br/>
&nbsp;&nbsp;(<a id="f:95" class="idref" href="#f:95"><span class="id" title="binder">f</span></a> : <span class="id" title="definition">dsig</span> <a class="idref" href="VLSM.Lib.StreamFilters.html#P:92"><span class="id" title="variable">P</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x"><span class="id" title="notation">-&gt;</span></a> <a class="idref" href="VLSM.Lib.StreamFilters.html#B:91"><span class="id" title="variable">B</span></a>)<br/>
&nbsp;&nbsp;(<a id="s:96" class="idref" href="#s:96"><span class="id" title="binder">s</span></a> : <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Lists.Streams.html#Stream"><span class="id" title="inductive">Stream</span></a> <a class="idref" href="VLSM.Lib.StreamFilters.html#A:90"><span class="id" title="variable">A</span></a>)<br/>
&nbsp;&nbsp;(<a id="ss:97" class="idref" href="#ss:97"><span class="id" title="binder">ss</span></a> : <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Lists.Streams.html#Stream"><span class="id" title="inductive">Stream</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Datatypes.html#nat"><span class="id" title="inductive">nat</span></a>)<br/>
&nbsp;&nbsp;(<a id="Hfs:98" class="idref" href="#Hfs:98"><span class="id" title="binder">Hfs</span></a> : <a class="idref" href="VLSM.Lib.StreamFilters.html#filtering_subsequence"><span class="id" title="definition">filtering_subsequence</span></a> <a class="idref" href="VLSM.Lib.StreamFilters.html#P:92"><span class="id" title="variable">P</span></a> <a class="idref" href="VLSM.Lib.StreamFilters.html#s:96"><span class="id" title="variable">s</span></a> <a class="idref" href="VLSM.Lib.StreamFilters.html#ss:97"><span class="id" title="variable">ss</span></a>)<br/>
&nbsp;&nbsp;(<a id="n:99" class="idref" href="#n:99"><span class="id" title="binder">n</span></a> : <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Datatypes.html#nat"><span class="id" title="inductive">nat</span></a>)<br/>
&nbsp;&nbsp;(<a id="pre_filter_map:100" class="idref" href="#pre_filter_map:100"><span class="id" title="binder">pre_filter_map</span></a> := <a class="idref" href="VLSM.Lib.ListExtras.html#list_filter_map"><span class="id" title="definition">list_filter_map</span></a> <a class="idref" href="VLSM.Lib.StreamFilters.html#P:92"><span class="id" title="variable">P</span></a> <a class="idref" href="VLSM.Lib.StreamFilters.html#f:95"><span class="id" title="variable">f</span></a> (<a class="idref" href="VLSM.Lib.StreamExtras.html#stream_prefix"><span class="id" title="definition">stream_prefix</span></a> <a class="idref" href="VLSM.Lib.StreamFilters.html#s:96"><span class="id" title="variable">s</span></a> <a class="idref" href="VLSM.Lib.StreamFilters.html#n:99"><span class="id" title="variable">n</span></a>))<br/>
&nbsp;&nbsp;(<a id="m:101" class="idref" href="#m:101"><span class="id" title="binder">m</span></a> := <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Datatypes.html#length"><span class="id" title="definition">length</span></a> <a class="idref" href="VLSM.Lib.StreamFilters.html#pre_filter_map:100"><span class="id" title="variable">pre_filter_map</span></a>)<br/>
&nbsp;&nbsp;: <a class="idref" href="VLSM.Lib.StreamExtras.html#stream_prefix"><span class="id" title="definition">stream_prefix</span></a> (<a class="idref" href="VLSM.Lib.StreamFilters.html#filtering_subsequence_stream_filter_map"><span class="id" title="definition">filtering_subsequence_stream_filter_map</span></a> <a class="idref" href="VLSM.Lib.StreamFilters.html#P:92"><span class="id" title="variable">P</span></a> <a class="idref" href="VLSM.Lib.StreamFilters.html#f:95"><span class="id" title="variable">f</span></a> <a class="idref" href="VLSM.Lib.StreamFilters.html#s:96"><span class="id" title="variable">s</span></a> <a class="idref" href="VLSM.Lib.StreamFilters.html#ss:97"><span class="id" title="variable">ss</span></a> <a class="idref" href="VLSM.Lib.StreamFilters.html#Hfs:98"><span class="id" title="variable">Hfs</span></a>) <a class="idref" href="VLSM.Lib.StreamFilters.html#m:101"><span class="id" title="variable">m</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">=</span></a> <a class="idref" href="VLSM.Lib.StreamFilters.html#pre_filter_map:100"><span class="id" title="variable">pre_filter_map</span></a>.<br/>
<span class="id" title="keyword">Proof</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">subst</span> <span class="id" title="var">m</span> <span class="id" title="var">pre_filter_map</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">induction</span> <span class="id" title="var">n</span>; [<span class="id" title="var">done</span> |].<br/>
&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> <a class="idref" href="VLSM.Lib.StreamExtras.html#stream_prefix_S"><span class="id" title="lemma">stream_prefix_S</span></a>, <a class="idref" href="VLSM.Lib.ListExtras.html#list_filter_map_app"><span class="id" title="lemma">list_filter_map_app</span></a>, <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Lists.List.html#app_length"><span class="id" title="lemma">app_length</span></a>.<br/>
&nbsp;&nbsp;<span class="id" title="var">remember</span> (<a class="idref" href="VLSM.Lib.ListExtras.html#list_filter_map"><span class="id" title="definition">list_filter_map</span></a> <span class="id" title="var">P</span> <span class="id" title="var">f</span> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Lists.List.html#ddd65c2f7ee73ecec433744948d846bb"><span class="id" title="notation">[</span></a><a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Lists.Streams.html#Str_nth"><span class="id" title="definition">Str_nth</span></a> <span class="id" title="var">n</span> <span class="id" title="var">s</span><a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Lists.List.html#ddd65c2f7ee73ecec433744948d846bb"><span class="id" title="notation">]</span></a>) <span class="id" title="keyword">as</span> <span class="id" title="var">lst</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">unfold</span> <a class="idref" href="VLSM.Lib.ListExtras.html#list_filter_map"><span class="id" title="definition">list_filter_map</span></a> <span class="id" title="tactic">in</span> <span class="id" title="var">Heqlst</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> <a class="idref" href="VLSM.Lib.ListExtras.html#filter_annotate_unroll"><span class="id" title="lemma">filter_annotate_unroll</span></a> <span class="id" title="tactic">in</span> <span class="id" title="var">Heqlst</span>. <span class="id" title="tactic">simpl</span> <span class="id" title="tactic">in</span> <span class="id" title="var">Heqlst</span>.<br/>
&nbsp;&nbsp;<span class="id" title="var">case_decide</span>; <span class="id" title="tactic">subst</span> <span class="id" title="var">lst</span>; <span class="id" title="tactic">simpl</span>; [| <span class="id" title="tactic">by</span> <span class="id" title="tactic">rewrite</span> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Numbers.Natural.Peano.NPeano.html#Nat.add_comm"><span class="id" title="lemma">Nat.add_comm</span></a>, <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Lists.List.html#app_nil_r"><span class="id" title="lemma">app_nil_r</span></a>].<br/>
&nbsp;&nbsp;<span class="id" title="tactic">replace</span> (<a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Datatypes.html#length"><span class="id" title="definition">length</span></a> (<a class="idref" href="VLSM.Lib.ListExtras.html#list_filter_map"><span class="id" title="definition">list_filter_map</span></a> <span class="id" title="var">P</span> <span class="id" title="var">f</span> (<a class="idref" href="VLSM.Lib.StreamExtras.html#stream_prefix"><span class="id" title="definition">stream_prefix</span></a> <span class="id" title="var">s</span> <span class="id" title="var">n</span>)) <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Peano.html#0dacc1786c5ba797d47dd85006231633"><span class="id" title="notation">+</span></a> 1)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">with</span> (<a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Datatypes.html#S"><span class="id" title="constructor">S</span></a> (<a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Datatypes.html#length"><span class="id" title="definition">length</span></a> (<a class="idref" href="VLSM.Lib.ListExtras.html#list_filter_map"><span class="id" title="definition">list_filter_map</span></a> <span class="id" title="var">P</span> <span class="id" title="var">f</span> (<a class="idref" href="VLSM.Lib.StreamExtras.html#stream_prefix"><span class="id" title="definition">stream_prefix</span></a> <span class="id" title="var">s</span> <span class="id" title="var">n</span>))))<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">by</span> <span class="id" title="var">lia</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> <a class="idref" href="VLSM.Lib.StreamExtras.html#stream_prefix_S"><span class="id" title="lemma">stream_prefix_S</span></a>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> <span class="id" title="var">IHn</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">f_equal</span>. <span class="id" title="tactic">f_equal</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">unfold</span> <a class="idref" href="VLSM.Lib.StreamFilters.html#filtering_subsequence_stream_filter_map"><span class="id" title="definition">filtering_subsequence_stream_filter_map</span></a>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Lists.Streams.html#Str_nth_map"><span class="id" title="lemma">Str_nth_map</span></a>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">f_equal</span>. <span class="id" title="tactic">apply</span> <span class="id" title="lemma">dsig_eq</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">simpl</span>. <span class="id" title="tactic">rewrite</span> <a class="idref" href="VLSM.Lib.StreamExtras.html#nat_sequence_nth"><span class="id" title="lemma">nat_sequence_nth</span></a>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">f_equal</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">unfold</span> <a class="idref" href="VLSM.Lib.ListExtras.html#list_filter_map"><span class="id" title="definition">list_filter_map</span></a>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Lists.List.html#map_length"><span class="id" title="lemma">map_length</span></a>. <span class="id" title="tactic">rewrite</span> <a class="idref" href="VLSM.Lib.ListExtras.html#filter_annotate_length"><span class="id" title="lemma">filter_annotate_length</span></a>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">by</span> <span class="id" title="tactic">apply</span> <a class="idref" href="VLSM.Lib.StreamFilters.html#filtering_subsequence_prefix_is_filter_last"><span class="id" title="lemma">filtering_subsequence_prefix_is_filter_last</span></a>.<br/>
<span class="id" title="keyword">Qed</span>.<br/>

<br/>
<span class="id" title="keyword">Program Definition</span> <a id="fitering_subsequence_stream_filter_map_prefix_ex" class="idref" href="#fitering_subsequence_stream_filter_map_prefix_ex"><span class="id" title="definition">fitering_subsequence_stream_filter_map_prefix_ex</span></a><br/>
&nbsp;&nbsp;{<a id="A:102" class="idref" href="#A:102"><span class="id" title="binder">A</span></a> <a id="B:103" class="idref" href="#B:103"><span class="id" title="binder">B</span></a> : <span class="id" title="keyword">Type</span>}<br/>
&nbsp;&nbsp;(<a id="P:104" class="idref" href="#P:104"><span class="id" title="binder">P</span></a> : <a class="idref" href="VLSM.Lib.StreamFilters.html#A:102"><span class="id" title="variable">A</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x"><span class="id" title="notation">-&gt;</span></a> <span class="id" title="keyword">Prop</span>)<br/>
&nbsp;&nbsp;{<a id="Pdec:106" class="idref" href="#Pdec:106"><span class="id" title="binder">Pdec</span></a> : <span class="id" title="notation">forall</span> <a id="a:105" class="idref" href="#a:105"><span class="id" title="binder">a</span></a><span class="id" title="notation">,</span> <span class="id" title="class">Decision</span> (<a class="idref" href="VLSM.Lib.StreamFilters.html#P:104"><span class="id" title="variable">P</span></a> <a class="idref" href="VLSM.Lib.StreamFilters.html#a:105"><span class="id" title="variable">a</span></a>)}<br/>
&nbsp;&nbsp;(<a id="f:107" class="idref" href="#f:107"><span class="id" title="binder">f</span></a> : <span class="id" title="definition">dsig</span> <a class="idref" href="VLSM.Lib.StreamFilters.html#P:104"><span class="id" title="variable">P</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x"><span class="id" title="notation">-&gt;</span></a> <a class="idref" href="VLSM.Lib.StreamFilters.html#B:103"><span class="id" title="variable">B</span></a>)<br/>
&nbsp;&nbsp;(<a id="s:108" class="idref" href="#s:108"><span class="id" title="binder">s</span></a> : <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Lists.Streams.html#Stream"><span class="id" title="inductive">Stream</span></a> <a class="idref" href="VLSM.Lib.StreamFilters.html#A:102"><span class="id" title="variable">A</span></a>)<br/>
&nbsp;&nbsp;(<a id="ss:109" class="idref" href="#ss:109"><span class="id" title="binder">ss</span></a> : <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Lists.Streams.html#Stream"><span class="id" title="inductive">Stream</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Datatypes.html#nat"><span class="id" title="inductive">nat</span></a>)<br/>
&nbsp;&nbsp;(<a id="Hfs:110" class="idref" href="#Hfs:110"><span class="id" title="binder">Hfs</span></a> : <a class="idref" href="VLSM.Lib.StreamFilters.html#filtering_subsequence"><span class="id" title="definition">filtering_subsequence</span></a> <a class="idref" href="VLSM.Lib.StreamFilters.html#P:104"><span class="id" title="variable">P</span></a> <a class="idref" href="VLSM.Lib.StreamFilters.html#s:108"><span class="id" title="variable">s</span></a> <a class="idref" href="VLSM.Lib.StreamFilters.html#ss:109"><span class="id" title="variable">ss</span></a>)<br/>
&nbsp;&nbsp;(<a id="m:111" class="idref" href="#m:111"><span class="id" title="binder">m</span></a> : <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Datatypes.html#nat"><span class="id" title="inductive">nat</span></a>)<br/>
&nbsp;&nbsp;: <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Specif.html#6556914db359db999889decec6a4a562"><span class="id" title="notation">{</span></a><a id="n:112" class="idref" href="#n:112"><span class="id" title="binder">n</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Specif.html#6556914db359db999889decec6a4a562"><span class="id" title="notation">:</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Datatypes.html#nat"><span class="id" title="inductive">nat</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Specif.html#6556914db359db999889decec6a4a562"><span class="id" title="notation">|</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="VLSM.Lib.StreamExtras.html#stream_prefix"><span class="id" title="definition">stream_prefix</span></a> (<a class="idref" href="VLSM.Lib.StreamFilters.html#filtering_subsequence_stream_filter_map"><span class="id" title="definition">filtering_subsequence_stream_filter_map</span></a> <a class="idref" href="VLSM.Lib.StreamFilters.html#P:104"><span class="id" title="variable">P</span></a> <a class="idref" href="VLSM.Lib.StreamFilters.html#f:107"><span class="id" title="variable">f</span></a> <a class="idref" href="VLSM.Lib.StreamFilters.html#s:108"><span class="id" title="variable">s</span></a> <a class="idref" href="VLSM.Lib.StreamFilters.html#ss:109"><span class="id" title="variable">ss</span></a> <a class="idref" href="VLSM.Lib.StreamFilters.html#Hfs:110"><span class="id" title="variable">Hfs</span></a>) <a class="idref" href="VLSM.Lib.StreamFilters.html#m:111"><span class="id" title="variable">m</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">=</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="VLSM.Lib.ListExtras.html#list_filter_map"><span class="id" title="definition">list_filter_map</span></a> <a class="idref" href="VLSM.Lib.StreamFilters.html#P:104"><span class="id" title="variable">P</span></a> <a class="idref" href="VLSM.Lib.StreamFilters.html#f:107"><span class="id" title="variable">f</span></a> (<a class="idref" href="VLSM.Lib.StreamExtras.html#stream_prefix"><span class="id" title="definition">stream_prefix</span></a> <a class="idref" href="VLSM.Lib.StreamFilters.html#s:108"><span class="id" title="variable">s</span></a> <a class="idref" href="VLSM.Lib.StreamFilters.html#n:112"><span class="id" title="variable">n</span></a>)<a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Specif.html#6556914db359db999889decec6a4a562"><span class="id" title="notation">}</span></a><br/>
&nbsp;&nbsp;:=<br/>
&nbsp;&nbsp;<span class="id" title="keyword">match</span> <a class="idref" href="VLSM.Lib.StreamFilters.html#m:111"><span class="id" title="variable">m</span></a> <span class="id" title="keyword">with</span><br/>
&nbsp;&nbsp;| 0 =&gt; <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Specif.html#exist"><span class="id" title="constructor">exist</span></a> <span class="id" title="var">_</span> 0 <span class="id" title="var">_</span><br/>
&nbsp;&nbsp;| <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Datatypes.html#S"><span class="id" title="constructor">S</span></a> <span class="id" title="var">m</span> =&gt; <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Specif.html#exist"><span class="id" title="constructor">exist</span></a> <span class="id" title="var">_</span> (<a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Datatypes.html#S"><span class="id" title="constructor">S</span></a> (<a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Lists.Streams.html#Str_nth"><span class="id" title="definition">Str_nth</span></a> <a class="idref" href="VLSM.Lib.StreamFilters.html#m:111"><span class="id" title="variable">m</span></a> <a class="idref" href="VLSM.Lib.StreamFilters.html#ss:109"><span class="id" title="variable">ss</span></a>)) <span class="id" title="var">_</span><br/>
&nbsp;&nbsp;<span class="id" title="keyword">end</span>.<br/>
<span class="id" title="keyword">Next</span> <span class="id" title="keyword">Obligation</span>.<br/>
<span class="id" title="keyword">Proof</span>. <span class="id" title="var">done</span>. <span class="id" title="keyword">Qed</span>.<br/>
<span class="id" title="keyword">Next</span> <span class="id" title="keyword">Obligation</span>.<br/>
<span class="id" title="keyword">Proof</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">intros</span>. <span class="id" title="tactic">subst</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">specialize</span> (<a class="idref" href="VLSM.Lib.StreamFilters.html#fitering_subsequence_stream_filter_map_prefix"><span class="id" title="lemma">fitering_subsequence_stream_filter_map_prefix</span></a> <span class="id" title="var">P</span> <span class="id" title="var">f</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">Hfs</span> (<a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Datatypes.html#S"><span class="id" title="constructor">S</span></a> (<a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Lists.Streams.html#Str_nth"><span class="id" title="definition">Str_nth</span></a> <span class="id" title="var">m</span> <span class="id" title="var">ss</span>))) <span class="id" title="keyword">as</span> <span class="id" title="var">Heq</span>.<br/>
&nbsp;&nbsp;<span class="id" title="var">remember</span> (<a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Datatypes.html#S"><span class="id" title="constructor">S</span></a> <span class="id" title="var">m</span>) <span class="id" title="keyword">as</span> <span class="id" title="var">Sm</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">simpl</span> <span class="id" title="tactic">in</span> *.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> &lt;- <span class="id" title="var">Heq</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">f_equal</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">unfold</span> <a class="idref" href="VLSM.Lib.ListExtras.html#list_filter_map"><span class="id" title="definition">list_filter_map</span></a>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Lists.List.html#map_length"><span class="id" title="lemma">map_length</span></a>. <span class="id" title="tactic">rewrite</span> <a class="idref" href="VLSM.Lib.ListExtras.html#filter_annotate_length"><span class="id" title="lemma">filter_annotate_length</span></a>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">symmetry</span>. <span class="id" title="tactic">subst</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">by</span> <span class="id" title="tactic">apply</span> <a class="idref" href="VLSM.Lib.StreamFilters.html#filtering_subsequence_prefix_length"><span class="id" title="lemma">filtering_subsequence_prefix_length</span></a>.<br/>
<span class="id" title="keyword">Qed</span>.<br/>

<br/>
<span class="id" title="keyword">Lemma</span> <a id="stream_filter_Forall" class="idref" href="#stream_filter_Forall"><span class="id" title="lemma">stream_filter_Forall</span></a><br/>
&nbsp;&nbsp;{<a id="A:114" class="idref" href="#A:114"><span class="id" title="binder">A</span></a> : <span class="id" title="keyword">Type</span>}<br/>
&nbsp;&nbsp;(<a id="P:115" class="idref" href="#P:115"><span class="id" title="binder">P</span></a> : <a class="idref" href="VLSM.Lib.StreamFilters.html#A:114"><span class="id" title="variable">A</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x"><span class="id" title="notation">-&gt;</span></a> <span class="id" title="keyword">Prop</span>)<br/>
&nbsp;&nbsp;(<a id="s:116" class="idref" href="#s:116"><span class="id" title="binder">s</span></a> : <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Lists.Streams.html#Stream"><span class="id" title="inductive">Stream</span></a> <a class="idref" href="VLSM.Lib.StreamFilters.html#A:114"><span class="id" title="variable">A</span></a>)<br/>
&nbsp;&nbsp;(<a id="ss:117" class="idref" href="#ss:117"><span class="id" title="binder">ss</span></a> : <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Lists.Streams.html#Stream"><span class="id" title="inductive">Stream</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Datatypes.html#nat"><span class="id" title="inductive">nat</span></a>)<br/>
&nbsp;&nbsp;(<a id="s':118" class="idref" href="#s':118"><span class="id" title="binder">s'</span></a> := <a class="idref" href="VLSM.Lib.StreamExtras.html#stream_subsequence"><span class="id" title="definition">stream_subsequence</span></a> <a class="idref" href="VLSM.Lib.StreamFilters.html#s:116"><span class="id" title="variable">s</span></a> <a class="idref" href="VLSM.Lib.StreamFilters.html#ss:117"><span class="id" title="variable">ss</span></a>)<br/>
&nbsp;&nbsp;(<a id="Hfs:119" class="idref" href="#Hfs:119"><span class="id" title="binder">Hfs</span></a> : <a class="idref" href="VLSM.Lib.StreamFilters.html#filtering_subsequence"><span class="id" title="definition">filtering_subsequence</span></a> <a class="idref" href="VLSM.Lib.StreamFilters.html#P:115"><span class="id" title="variable">P</span></a> <a class="idref" href="VLSM.Lib.StreamFilters.html#s:116"><span class="id" title="variable">s</span></a> <a class="idref" href="VLSM.Lib.StreamFilters.html#ss:117"><span class="id" title="variable">ss</span></a>)<br/>
&nbsp;&nbsp;: <a class="idref" href="VLSM.Lib.StreamExtras.html#ForAll1"><span class="id" title="definition">ForAll1</span></a> <a class="idref" href="VLSM.Lib.StreamFilters.html#P:115"><span class="id" title="variable">P</span></a> <a class="idref" href="VLSM.Lib.StreamFilters.html#s':118"><span class="id" title="variable">s'</span></a>.<br/>
<span class="id" title="keyword">Proof</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">apply</span> <a class="idref" href="VLSM.Lib.StreamExtras.html#ForAll1_forall"><span class="id" title="lemma">ForAll1_forall</span></a>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">intro</span> <span class="id" title="var">n</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">unfold</span> <span class="id" title="var">s'</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">unfold</span> <a class="idref" href="VLSM.Lib.StreamExtras.html#stream_subsequence"><span class="id" title="definition">stream_subsequence</span></a>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Lists.Streams.html#Str_nth_map"><span class="id" title="lemma">Str_nth_map</span></a>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">by</span> <span class="id" title="tactic">apply</span> <a class="idref" href="VLSM.Lib.StreamFilters.html#filtering_subsequence_witness"><span class="id" title="lemma">filtering_subsequence_witness</span></a>.<br/>
<span class="id" title="keyword">Qed</span>.<br/>

<br/>
</div>

<div class="doc">
<a id="lab53"></a><h2 class="section">Obtaining <span class="inlinecode"><span class="id" title="var">filtering_sequences</span></span> for streams</h2>


<div class="paragraph"> </div>

  Given a stream, a decidable predicate on its elements, and a guarantee that the
  predicates holds <span class="inlinecode"><a class="idref" href="VLSM.Lib.StreamExtras.html#InfinitelyOften"><span class="id" title="definition">InfinitelyOften</span></a></span> on the elements of the stream, we can
  (coinductively) obtain a <span class="inlinecode"><span class="id" title="var">filtering_sequence</span></span>.

<div class="paragraph"> </div>

  The approach below follows closely the one proposed by the following paper,
  except that instead of obtaining the filtered sequence itself we obtain the
  stream of all positions corresponding to the filtered sequence.

<div class="paragraph"> </div>

  Yves Bertot. Filters on Co-Inductive streams: an application to Eratosthenes sieve.
  RR-5343, INRIA. 2004, pp.21. ffinria-00070658 https://hal.inria.fr/inria-00070658/document

</div>
<div class="code">

<br/>
<span class="id" title="keyword">Section</span> <a id="sec_stream_filter_positions" class="idref" href="#sec_stream_filter_positions"><span class="id" title="section">sec_stream_filter_positions</span></a>.<br/>

<br/>
<span class="id" title="keyword">Context</span><br/>
&nbsp;&nbsp;[<a id="A:120" class="idref" href="#A:120"><span class="id" title="binder">A</span></a> : <span class="id" title="keyword">Type</span>]<br/>
&nbsp;&nbsp;(<a id="P:121" class="idref" href="#P:121"><span class="id" title="binder">P</span></a> : <a class="idref" href="VLSM.Lib.StreamFilters.html#A:120"><span class="id" title="variable">A</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x"><span class="id" title="notation">-&gt;</span></a> <span class="id" title="keyword">Prop</span>)<br/>
&nbsp;&nbsp;{<a id="Pdec:123" class="idref" href="#Pdec:123"><span class="id" title="binder">Pdec</span></a> : <span class="id" title="notation">forall</span> <a id="a:122" class="idref" href="#a:122"><span class="id" title="binder">a</span></a><span class="id" title="notation">,</span> <span class="id" title="class">Decision</span> (<a class="idref" href="VLSM.Lib.StreamFilters.html#P:121"><span class="id" title="variable">P</span></a> <a class="idref" href="VLSM.Lib.StreamFilters.html#a:122"><span class="id" title="variable">a</span></a>)}<br/>
&nbsp;&nbsp;.<br/>

<br/>
</div>

<div class="doc">
  Given a stream <code>s</code> and a proof that there exists an element of <code>s</code> for
  which <code>P</code> holds, computes the first position of <code>s</code> in which <code>P</code> holds
  (shifted by the given argument <code>n</code>) and the remainder of <code>s</code> after that
  position.

<div class="paragraph"> </div>

  The definition iterates looking for the first position in which <code>P</code> holds,
  termination being ensured by the fact that <span class="inlinecode"><a class="idref" href="VLSM.Lib.StreamExtras.html#Exists1"><span class="id" title="definition">Exists1</span></a></span> is inductive.

</div>
<div class="code">
<span class="id" title="keyword">Fixpoint</span> <a id="stream_filter_fst_pos" class="idref" href="#stream_filter_fst_pos"><span class="id" title="definition">stream_filter_fst_pos</span></a><br/>
&nbsp;&nbsp;(<a id="s:124" class="idref" href="#s:124"><span class="id" title="binder">s</span></a> : <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Lists.Streams.html#Stream"><span class="id" title="inductive">Stream</span></a> <a class="idref" href="VLSM.Lib.StreamFilters.html#sec_stream_filter_positions.A"><span class="id" title="variable">A</span></a>)<br/>
&nbsp;&nbsp;(<a id="Hev:125" class="idref" href="#Hev:125"><span class="id" title="binder">Hev</span></a> : <a class="idref" href="VLSM.Lib.StreamExtras.html#Exists1"><span class="id" title="definition">Exists1</span></a> <a class="idref" href="VLSM.Lib.StreamFilters.html#sec_stream_filter_positions.P"><span class="id" title="variable">P</span></a> <a class="idref" href="VLSM.Lib.StreamFilters.html#s:124"><span class="id" title="variable">s</span></a>)<br/>
&nbsp;&nbsp;(<a id="n:126" class="idref" href="#n:126"><span class="id" title="binder">n</span></a> : <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Datatypes.html#nat"><span class="id" title="inductive">nat</span></a>)<br/>
&nbsp;&nbsp;{<span class="id" title="keyword">struct</span> <span class="id" title="var">Hev</span>}<br/>
&nbsp;&nbsp;: <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Datatypes.html#nat"><span class="id" title="inductive">nat</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Datatypes.html#11c698c8685bb8ab1cf725545c085ac4"><span class="id" title="notation">*</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Lists.Streams.html#Stream"><span class="id" title="inductive">Stream</span></a> <a class="idref" href="VLSM.Lib.StreamFilters.html#sec_stream_filter_positions.A"><span class="id" title="variable">A</span></a>.<br/>
<span class="id" title="keyword">Proof</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">refine</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id" title="keyword">match</span> <span class="id" title="definition">decide</span> (<a class="idref" href="VLSM.Lib.StreamFilters.html#sec_stream_filter_positions.P"><span class="id" title="variable">P</span></a> (<a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Lists.Streams.html#hd"><span class="id" title="definition">hd</span></a> <span class="id" title="var">s</span>)) <span class="id" title="keyword">with</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Specif.html#left"><span class="id" title="constructor">left</span></a> <span class="id" title="var">p</span> =&gt; <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">(</span></a><span class="id" title="var">n</span><a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">,</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Lists.Streams.html#tl"><span class="id" title="definition">tl</span></a> <span class="id" title="var">s</span><a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">)</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Specif.html#right"><span class="id" title="constructor">right</span></a> <span class="id" title="var">_</span> =&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">stream_filter_fst_pos</span> (<a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Lists.Streams.html#tl"><span class="id" title="definition">tl</span></a> <span class="id" title="var">s</span>) <span class="id" title="var">_</span> (<a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Datatypes.html#S"><span class="id" title="constructor">S</span></a> <span class="id" title="var">n</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">end</span>).<br/>
&nbsp;&nbsp;<span class="id" title="tactic">by</span> <span class="id" title="tactic">destruct</span> <span class="id" title="var">Hev</span>.<br/>
<span class="id" title="keyword">Defined</span>.<br/>

<br/>
<span class="id" title="keyword">Lemma</span> <a id="stream_filter_fst_pos_characterization" class="idref" href="#stream_filter_fst_pos_characterization"><span class="id" title="lemma">stream_filter_fst_pos_characterization</span></a><br/>
&nbsp;&nbsp;(<a id="s:128" class="idref" href="#s:128"><span class="id" title="binder">s</span></a> : <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Lists.Streams.html#Stream"><span class="id" title="inductive">Stream</span></a> <a class="idref" href="VLSM.Lib.StreamFilters.html#sec_stream_filter_positions.A"><span class="id" title="variable">A</span></a>)<br/>
&nbsp;&nbsp;(<a id="Hev:129" class="idref" href="#Hev:129"><span class="id" title="binder">Hev</span></a> : <a class="idref" href="VLSM.Lib.StreamExtras.html#Exists1"><span class="id" title="definition">Exists1</span></a> <a class="idref" href="VLSM.Lib.StreamFilters.html#sec_stream_filter_positions.P"><span class="id" title="variable">P</span></a> <a class="idref" href="VLSM.Lib.StreamFilters.html#s:128"><span class="id" title="variable">s</span></a>)<br/>
&nbsp;&nbsp;(<a id="n:130" class="idref" href="#n:130"><span class="id" title="binder">n</span></a> : <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Datatypes.html#nat"><span class="id" title="inductive">nat</span></a>)<br/>
&nbsp;&nbsp;: <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Logic.html#a883bdd010993579f99d60b3775bcf54"><span class="id" title="notation">exists</span></a> <a id="k:131" class="idref" href="#k:131"><span class="id" title="binder">k</span></a><a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Logic.html#a883bdd010993579f99d60b3775bcf54"><span class="id" title="notation">,</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="VLSM.Lib.StreamFilters.html#stream_filter_fst_pos"><span class="id" title="definition">stream_filter_fst_pos</span></a> <a class="idref" href="VLSM.Lib.StreamFilters.html#s:128"><span class="id" title="variable">s</span></a> <a class="idref" href="VLSM.Lib.StreamFilters.html#Hev:129"><span class="id" title="variable">Hev</span></a> <a class="idref" href="VLSM.Lib.StreamFilters.html#n:130"><span class="id" title="variable">n</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">=</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">(</span></a><a class="idref" href="VLSM.Lib.StreamFilters.html#n:130"><span class="id" title="variable">n</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Peano.html#0dacc1786c5ba797d47dd85006231633"><span class="id" title="notation">+</span></a> <a class="idref" href="VLSM.Lib.StreamFilters.html#k:131"><span class="id" title="variable">k</span></a><a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">,</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Lists.Streams.html#Str_nth_tl"><span class="id" title="definition">Str_nth_tl</span></a> (<a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Datatypes.html#S"><span class="id" title="constructor">S</span></a> <a class="idref" href="VLSM.Lib.StreamFilters.html#k:131"><span class="id" title="variable">k</span></a>) <a class="idref" href="VLSM.Lib.StreamFilters.html#s:128"><span class="id" title="variable">s</span></a><a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">)</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Logic.html#ba2b0e492d2b4675a0acf3ea92aabadd"><span class="id" title="notation">/\</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="VLSM.Lib.StreamFilters.html#sec_stream_filter_positions.P"><span class="id" title="variable">P</span></a> (<a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Lists.Streams.html#Str_nth"><span class="id" title="definition">Str_nth</span></a> <a class="idref" href="VLSM.Lib.StreamFilters.html#k:131"><span class="id" title="variable">k</span></a> <a class="idref" href="VLSM.Lib.StreamFilters.html#s:128"><span class="id" title="variable">s</span></a>) <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Logic.html#ba2b0e492d2b4675a0acf3ea92aabadd"><span class="id" title="notation">/\</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Logic.html#ba2b0e492d2b4675a0acf3ea92aabadd"><span class="id" title="notation">(</span></a><span class="id" title="notation">forall</span> <a id="i:132" class="idref" href="#i:132"><span class="id" title="binder">i</span></a><span class="id" title="notation">,</span> <a class="idref" href="VLSM.Lib.StreamFilters.html#i:132"><span class="id" title="variable">i</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Peano.html#::nat_scope:x_'&lt;'_x"><span class="id" title="notation">&lt;</span></a> <a class="idref" href="VLSM.Lib.StreamFilters.html#k:131"><span class="id" title="variable">k</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x"><span class="id" title="notation">-&gt;</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Logic.html#63a68285c81db8f9bc456233bb9ed181"><span class="id" title="notation">~</span></a> <a class="idref" href="VLSM.Lib.StreamFilters.html#sec_stream_filter_positions.P"><span class="id" title="variable">P</span></a> (<a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Lists.Streams.html#Str_nth"><span class="id" title="definition">Str_nth</span></a> <a class="idref" href="VLSM.Lib.StreamFilters.html#i:132"><span class="id" title="variable">i</span></a> <a class="idref" href="VLSM.Lib.StreamFilters.html#s:128"><span class="id" title="variable">s</span></a>)<a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Logic.html#ba2b0e492d2b4675a0acf3ea92aabadd"><span class="id" title="notation">)</span></a>.<br/>
<span class="id" title="keyword">Proof</span>.<br/>
&nbsp;&nbsp;<span class="id" title="var">revert</span> <span class="id" title="var">s</span> <span class="id" title="var">Hev</span> <span class="id" title="var">n</span>.<br/>
&nbsp;&nbsp;<span class="id" title="keyword">fix</span> <span class="id" title="var">H</span> 2.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">intros</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">destruct</span> <span class="id" title="var">Hev</span>; <span class="id" title="tactic">simpl</span>.<br/>
&nbsp;&nbsp;- <span class="id" title="tactic">destruct</span> (<span class="id" title="definition">decide</span> <span class="id" title="var">_</span>); [| <span class="id" title="var">done</span>].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">by</span> <span class="id" title="tactic">exists</span> 0; <span class="id" title="var">split_and</span>!; <span class="id" title="tactic">f_equal</span>; [<span class="id" title="var">lia</span> | | <span class="id" title="var">lia</span>].<br/>
&nbsp;&nbsp;- <span class="id" title="tactic">destruct</span> (<span class="id" title="definition">decide</span> <span class="id" title="var">_</span>); <span class="id" title="tactic">simpl</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="id" title="tactic">by</span> <span class="id" title="tactic">exists</span> 0; <span class="id" title="var">split_and</span>!; <span class="id" title="tactic">f_equal</span>; [<span class="id" title="var">lia</span> | | <span class="id" title="var">lia</span>].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="id" title="tactic">specialize</span> (<span class="id" title="var">H</span> (<a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Lists.Streams.html#tl"><span class="id" title="definition">tl</span></a> <span class="id" title="var">s</span>) <span class="id" title="var">Hev</span> (<a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Datatypes.html#S"><span class="id" title="constructor">S</span></a> <span class="id" title="var">n</span>)) <span class="id" title="keyword">as</span> (<span class="id" title="var">k</span> &amp; <span class="id" title="var">Heq</span> &amp; <span class="id" title="var">Hp</span> &amp; <span class="id" title="var">Hnp</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">exists</span> (<a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Datatypes.html#S"><span class="id" title="constructor">S</span></a> <span class="id" title="var">k</span>). <span class="id" title="tactic">rewrite</span> <span class="id" title="var">Heq</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">split</span>; [<span class="id" title="tactic">f_equal</span>; <span class="id" title="var">lia</span> |].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">split</span>; [<span class="id" title="var">done</span> |].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">intros</span>. <span class="id" title="tactic">destruct</span> <span class="id" title="var">i</span>; [<span class="id" title="var">done</span> |].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">by</span> <span class="id" title="tactic">apply</span> <span class="id" title="var">Hnp</span>; <span class="id" title="var">lia</span>.<br/>
<span class="id" title="keyword">Qed</span>.<br/>

<br/>
<span class="id" title="keyword">Lemma</span> <a id="stream_filter_fst_pos_infinitely_often" class="idref" href="#stream_filter_fst_pos_infinitely_often"><span class="id" title="lemma">stream_filter_fst_pos_infinitely_often</span></a><br/>
&nbsp;&nbsp;(<a id="s:133" class="idref" href="#s:133"><span class="id" title="binder">s</span></a> : <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Lists.Streams.html#Stream"><span class="id" title="inductive">Stream</span></a> <a class="idref" href="VLSM.Lib.StreamFilters.html#sec_stream_filter_positions.A"><span class="id" title="variable">A</span></a>)<br/>
&nbsp;&nbsp;(<a id="Hev:134" class="idref" href="#Hev:134"><span class="id" title="binder">Hev</span></a> : <a class="idref" href="VLSM.Lib.StreamExtras.html#Exists1"><span class="id" title="definition">Exists1</span></a> <a class="idref" href="VLSM.Lib.StreamFilters.html#sec_stream_filter_positions.P"><span class="id" title="variable">P</span></a> <a class="idref" href="VLSM.Lib.StreamFilters.html#s:133"><span class="id" title="variable">s</span></a>)<br/>
&nbsp;&nbsp;(<a id="n:135" class="idref" href="#n:135"><span class="id" title="binder">n</span></a> : <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Datatypes.html#nat"><span class="id" title="inductive">nat</span></a>)<br/>
&nbsp;&nbsp;: <a class="idref" href="VLSM.Lib.StreamExtras.html#InfinitelyOften"><span class="id" title="definition">InfinitelyOften</span></a> <a class="idref" href="VLSM.Lib.StreamFilters.html#sec_stream_filter_positions.P"><span class="id" title="variable">P</span></a> <a class="idref" href="VLSM.Lib.StreamFilters.html#s:133"><span class="id" title="variable">s</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x"><span class="id" title="notation">-&gt;</span></a> <a class="idref" href="VLSM.Lib.StreamExtras.html#InfinitelyOften"><span class="id" title="definition">InfinitelyOften</span></a> <a class="idref" href="VLSM.Lib.StreamFilters.html#sec_stream_filter_positions.P"><span class="id" title="variable">P</span></a> <span class="id" title="notation">(</span><a class="idref" href="VLSM.Lib.StreamFilters.html#stream_filter_fst_pos"><span class="id" title="definition">stream_filter_fst_pos</span></a> <a class="idref" href="VLSM.Lib.StreamFilters.html#s:133"><span class="id" title="variable">s</span></a> <a class="idref" href="VLSM.Lib.StreamFilters.html#Hev:134"><span class="id" title="variable">Hev</span></a> <a class="idref" href="VLSM.Lib.StreamFilters.html#n:135"><span class="id" title="variable">n</span></a><span class="id" title="notation">).2</span>.<br/>
<span class="id" title="keyword">Proof</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">destruct</span> (<a class="idref" href="VLSM.Lib.StreamFilters.html#stream_filter_fst_pos_characterization"><span class="id" title="lemma">stream_filter_fst_pos_characterization</span></a> <span class="id" title="var">s</span> <span class="id" title="var">Hev</span> <span class="id" title="var">n</span>) <span class="id" title="keyword">as</span> (<span class="id" title="var">k</span> &amp; -&gt; &amp; <span class="id" title="var">_</span>).<br/>
&nbsp;&nbsp;<span class="id" title="tactic">by</span> <span class="id" title="tactic">apply</span> <a class="idref" href="VLSM.Lib.StreamExtras.html#InfinitelyOften_nth_tl"><span class="id" title="definition">InfinitelyOften_nth_tl</span></a>.<br/>
<span class="id" title="keyword">Qed</span>.<br/>

<br/>
<span class="id" title="keyword">Lemma</span> <a id="stream_filter_fst_pos_le" class="idref" href="#stream_filter_fst_pos_le"><span class="id" title="lemma">stream_filter_fst_pos_le</span></a><br/>
&nbsp;&nbsp;(<a id="s:136" class="idref" href="#s:136"><span class="id" title="binder">s</span></a> : <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Lists.Streams.html#Stream"><span class="id" title="inductive">Stream</span></a> <a class="idref" href="VLSM.Lib.StreamFilters.html#sec_stream_filter_positions.A"><span class="id" title="variable">A</span></a>)<br/>
&nbsp;&nbsp;(<a id="Hev:137" class="idref" href="#Hev:137"><span class="id" title="binder">Hev</span></a> : <a class="idref" href="VLSM.Lib.StreamExtras.html#Exists1"><span class="id" title="definition">Exists1</span></a> <a class="idref" href="VLSM.Lib.StreamFilters.html#sec_stream_filter_positions.P"><span class="id" title="variable">P</span></a> <a class="idref" href="VLSM.Lib.StreamFilters.html#s:136"><span class="id" title="variable">s</span></a>)<br/>
&nbsp;&nbsp;(<a id="n:138" class="idref" href="#n:138"><span class="id" title="binder">n</span></a> : <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Datatypes.html#nat"><span class="id" title="inductive">nat</span></a>)<br/>
&nbsp;&nbsp;: <a class="idref" href="VLSM.Lib.StreamFilters.html#n:138"><span class="id" title="variable">n</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Peano.html#cb53cf0ee22c036a03b4a9281c68b5a3"><span class="id" title="notation">&lt;=</span></a> <span class="id" title="notation">(</span><a class="idref" href="VLSM.Lib.StreamFilters.html#stream_filter_fst_pos"><span class="id" title="definition">stream_filter_fst_pos</span></a> <a class="idref" href="VLSM.Lib.StreamFilters.html#s:136"><span class="id" title="variable">s</span></a> <a class="idref" href="VLSM.Lib.StreamFilters.html#Hev:137"><span class="id" title="variable">Hev</span></a> <a class="idref" href="VLSM.Lib.StreamFilters.html#n:138"><span class="id" title="variable">n</span></a><span class="id" title="notation">).1</span>.<br/>
<span class="id" title="keyword">Proof</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">destruct</span> (<a class="idref" href="VLSM.Lib.StreamFilters.html#stream_filter_fst_pos_characterization"><span class="id" title="lemma">stream_filter_fst_pos_characterization</span></a> <span class="id" title="var">s</span> <span class="id" title="var">Hev</span> <span class="id" title="var">n</span>) <span class="id" title="keyword">as</span> (<span class="id" title="var">k</span> &amp; -&gt; &amp; <span class="id" title="var">_</span>).<br/>
&nbsp;&nbsp;<span class="id" title="tactic">by</span> <span class="id" title="var">cbn</span>; <span class="id" title="var">lia</span>.<br/>
<span class="id" title="keyword">Qed</span>.<br/>

<br/>
<span class="id" title="keyword">Lemma</span> <a id="stream_filter_fst_pos_nth_tl_has_property" class="idref" href="#stream_filter_fst_pos_nth_tl_has_property"><span class="id" title="lemma">stream_filter_fst_pos_nth_tl_has_property</span></a><br/>
&nbsp;&nbsp;(<a id="s:139" class="idref" href="#s:139"><span class="id" title="binder">s</span></a> : <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Lists.Streams.html#Stream"><span class="id" title="inductive">Stream</span></a> <a class="idref" href="VLSM.Lib.StreamFilters.html#sec_stream_filter_positions.A"><span class="id" title="variable">A</span></a>)<br/>
&nbsp;&nbsp;(<a id="n:140" class="idref" href="#n:140"><span class="id" title="binder">n</span></a> : <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Datatypes.html#nat"><span class="id" title="inductive">nat</span></a>)<br/>
&nbsp;&nbsp;(<a id="sn:141" class="idref" href="#sn:141"><span class="id" title="binder">sn</span></a> := <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Lists.Streams.html#Str_nth_tl"><span class="id" title="definition">Str_nth_tl</span></a> <a class="idref" href="VLSM.Lib.StreamFilters.html#n:140"><span class="id" title="variable">n</span></a> <a class="idref" href="VLSM.Lib.StreamFilters.html#s:139"><span class="id" title="variable">s</span></a>)<br/>
&nbsp;&nbsp;(<a id="Hev:142" class="idref" href="#Hev:142"><span class="id" title="binder">Hev</span></a> : <a class="idref" href="VLSM.Lib.StreamExtras.html#Exists1"><span class="id" title="definition">Exists1</span></a> <a class="idref" href="VLSM.Lib.StreamFilters.html#sec_stream_filter_positions.P"><span class="id" title="variable">P</span></a> <a class="idref" href="VLSM.Lib.StreamFilters.html#sn:141"><span class="id" title="variable">sn</span></a>)<br/>
&nbsp;&nbsp;(<a id="fpair:143" class="idref" href="#fpair:143"><span class="id" title="binder">fpair</span></a> := <a class="idref" href="VLSM.Lib.StreamFilters.html#stream_filter_fst_pos"><span class="id" title="definition">stream_filter_fst_pos</span></a> (<a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Lists.Streams.html#Str_nth_tl"><span class="id" title="definition">Str_nth_tl</span></a> <a class="idref" href="VLSM.Lib.StreamFilters.html#n:140"><span class="id" title="variable">n</span></a> <a class="idref" href="VLSM.Lib.StreamFilters.html#s:139"><span class="id" title="variable">s</span></a>) <a class="idref" href="VLSM.Lib.StreamFilters.html#Hev:142"><span class="id" title="variable">Hev</span></a> <a class="idref" href="VLSM.Lib.StreamFilters.html#n:140"><span class="id" title="variable">n</span></a>)<br/>
&nbsp;&nbsp;: <a class="idref" href="VLSM.Lib.StreamFilters.html#sec_stream_filter_positions.P"><span class="id" title="variable">P</span></a> (<a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Lists.Streams.html#Str_nth"><span class="id" title="definition">Str_nth</span></a> <a class="idref" href="VLSM.Lib.StreamFilters.html#fpair:143"><span class="id" title="variable">fpair</span></a><span class="id" title="notation">.1</span> <a class="idref" href="VLSM.Lib.StreamFilters.html#s:139"><span class="id" title="variable">s</span></a>) <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Logic.html#ba2b0e492d2b4675a0acf3ea92aabadd"><span class="id" title="notation">/\</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="notation">forall</span> <a id="i:144" class="idref" href="#i:144"><span class="id" title="binder">i</span></a><span class="id" title="notation">,</span> <a class="idref" href="VLSM.Lib.StreamFilters.html#n:140"><span class="id" title="variable">n</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Peano.html#ea090076ab3dcdee0cfd3882c88b993f"><span class="id" title="notation">&lt;=</span></a> <a class="idref" href="VLSM.Lib.StreamFilters.html#i:144"><span class="id" title="variable">i</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Peano.html#ea090076ab3dcdee0cfd3882c88b993f"><span class="id" title="notation">&lt;</span></a> <a class="idref" href="VLSM.Lib.StreamFilters.html#fpair:143"><span class="id" title="variable">fpair</span></a><span class="id" title="notation">.1</span> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x"><span class="id" title="notation">-&gt;</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Logic.html#63a68285c81db8f9bc456233bb9ed181"><span class="id" title="notation">~</span></a> <a class="idref" href="VLSM.Lib.StreamFilters.html#sec_stream_filter_positions.P"><span class="id" title="variable">P</span></a> (<a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Lists.Streams.html#Str_nth"><span class="id" title="definition">Str_nth</span></a> <a class="idref" href="VLSM.Lib.StreamFilters.html#i:144"><span class="id" title="variable">i</span></a> <a class="idref" href="VLSM.Lib.StreamFilters.html#s:139"><span class="id" title="variable">s</span></a>).<br/>
<span class="id" title="keyword">Proof</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">specialize</span> (<a class="idref" href="VLSM.Lib.StreamFilters.html#stream_filter_fst_pos_characterization"><span class="id" title="lemma">stream_filter_fst_pos_characterization</span></a> <span class="id" title="var">sn</span> <span class="id" title="var">Hev</span> <span class="id" title="var">n</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">as</span> [<span class="id" title="var">k</span> [<span class="id" title="var">Heq</span> [<span class="id" title="var">Hp</span> <span class="id" title="var">Hnp</span>]]].<br/>
&nbsp;&nbsp;<span class="id" title="tactic">subst</span> <span class="id" title="var">sn</span> <span class="id" title="var">fpair</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> <span class="id" title="var">Heq</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">clear</span> -<span class="id" title="var">Hp</span> <span class="id" title="var">Hnp</span>. <span class="id" title="tactic">rewrite</span> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Lists.Streams.html#Str_nth_plus"><span class="id" title="lemma">Str_nth_plus</span></a>, <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Numbers.Natural.Peano.NPeano.html#Nat.add_comm"><span class="id" title="lemma">Nat.add_comm</span></a> <span class="id" title="tactic">in</span> <span class="id" title="var">Hp</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">split</span>; [<span class="id" title="var">done</span> |].<br/>
&nbsp;&nbsp;<span class="id" title="tactic">intros</span> <span class="id" title="var">i</span> [<span class="id" title="var">Hlt_i</span> <span class="id" title="var">Hilt</span>].<br/>
&nbsp;&nbsp;<span class="id" title="tactic">apply</span> <a class="idref" href="VLSM.Lib.StdppExtras.html#stdpp_nat_le_sum"><span class="id" title="lemma">stdpp_nat_le_sum</span></a> <span class="id" title="tactic">in</span> <span class="id" title="var">Hlt_i</span> <span class="id" title="keyword">as</span> [<span class="id" title="var">i'</span> -&gt;].<br/>
&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Numbers.Natural.Peano.NPeano.html#Nat.add_comm"><span class="id" title="lemma">Nat.add_comm</span></a>, &lt;- <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Lists.Streams.html#Str_nth_plus"><span class="id" title="lemma">Str_nth_plus</span></a>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">by</span> <span class="id" title="tactic">apply</span> <span class="id" title="var">Hnp</span>; <span class="id" title="var">cbn</span> <span class="id" title="tactic">in</span> *; <span class="id" title="var">lia</span>.<br/>
<span class="id" title="keyword">Qed</span>.<br/>

<br/>
</div>

<div class="doc">
  Given as stream <code>s</code> for which predicate <code>P</code> holds <span class="inlinecode"><a class="idref" href="VLSM.Lib.StreamExtras.html#InfinitelyOften"><span class="id" title="definition">InfinitelyOften</span></a></span>
  produces the streams of all its position at which <code>P</code> holds in a strictly
  increasing order (shifted by the given argument <code>n</code>).

</div>
<div class="code">
<span class="id" title="keyword">CoFixpoint</span> <a id="stream_filter_positions" class="idref" href="#stream_filter_positions"><span class="id" title="definition">stream_filter_positions</span></a><br/>
&nbsp;&nbsp;(<a id="s:145" class="idref" href="#s:145"><span class="id" title="binder">s</span></a> : <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Lists.Streams.html#Stream"><span class="id" title="inductive">Stream</span></a> <a class="idref" href="VLSM.Lib.StreamFilters.html#sec_stream_filter_positions.A"><span class="id" title="variable">A</span></a>) (<a id="Hinf:146" class="idref" href="#Hinf:146"><span class="id" title="binder">Hinf</span></a> : <a class="idref" href="VLSM.Lib.StreamExtras.html#InfinitelyOften"><span class="id" title="definition">InfinitelyOften</span></a> <a class="idref" href="VLSM.Lib.StreamFilters.html#sec_stream_filter_positions.P"><span class="id" title="variable">P</span></a> <a class="idref" href="VLSM.Lib.StreamFilters.html#s:145"><span class="id" title="variable">s</span></a>) (<a id="n:147" class="idref" href="#n:147"><span class="id" title="binder">n</span></a> : <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Datatypes.html#nat"><span class="id" title="inductive">nat</span></a>) : <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Lists.Streams.html#Stream"><span class="id" title="inductive">Stream</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Datatypes.html#nat"><span class="id" title="inductive">nat</span></a> :=<br/>
&nbsp;&nbsp;<span class="id" title="keyword">let</span> <a id="fpair:149" class="idref" href="#fpair:149"><span class="id" title="binder">fpair</span></a> := <a class="idref" href="VLSM.Lib.StreamFilters.html#stream_filter_fst_pos"><span class="id" title="definition">stream_filter_fst_pos</span></a> <span class="id" title="var">_</span> (<a class="idref" href="VLSM.Lib.StreamExtras.html#fHere"><span class="id" title="lemma">fHere</span></a> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <a class="idref" href="VLSM.Lib.StreamFilters.html#Hinf:146"><span class="id" title="variable">Hinf</span></a>) <a class="idref" href="VLSM.Lib.StreamFilters.html#n:147"><span class="id" title="variable">n</span></a> <span class="id" title="tactic">in</span><br/>
&nbsp;&nbsp;<a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Lists.Streams.html#Cons"><span class="id" title="constructor">Cons</span></a> <a class="idref" href="VLSM.Lib.StreamFilters.html#fpair:149"><span class="id" title="variable">fpair</span></a><span class="id" title="notation">.1</span> (<a class="idref" href="VLSM.Lib.StreamFilters.html#stream_filter_positions:148"><span class="id" title="definition">stream_filter_positions</span></a> <a class="idref" href="VLSM.Lib.StreamFilters.html#fpair:149"><span class="id" title="variable">fpair</span></a><span class="id" title="notation">.2</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;(<a class="idref" href="VLSM.Lib.StreamFilters.html#stream_filter_fst_pos_infinitely_often"><span class="id" title="lemma">stream_filter_fst_pos_infinitely_often</span></a> <span class="id" title="var">_</span> (<a class="idref" href="VLSM.Lib.StreamExtras.html#fHere"><span class="id" title="lemma">fHere</span></a> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <a class="idref" href="VLSM.Lib.StreamFilters.html#Hinf:146"><span class="id" title="variable">Hinf</span></a>) <a class="idref" href="VLSM.Lib.StreamFilters.html#n:147"><span class="id" title="variable">n</span></a> <a class="idref" href="VLSM.Lib.StreamFilters.html#Hinf:146"><span class="id" title="variable">Hinf</span></a>)  (<a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Datatypes.html#S"><span class="id" title="constructor">S</span></a> <a class="idref" href="VLSM.Lib.StreamFilters.html#fpair:149"><span class="id" title="variable">fpair</span></a><span class="id" title="notation">.1</span>)).<br/>

<br/>
<span class="id" title="keyword">Lemma</span> <a id="stream_filter_positions_unroll" class="idref" href="#stream_filter_positions_unroll"><span class="id" title="lemma">stream_filter_positions_unroll</span></a> (<a id="s:150" class="idref" href="#s:150"><span class="id" title="binder">s</span></a> : <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Lists.Streams.html#Stream"><span class="id" title="inductive">Stream</span></a> <a class="idref" href="VLSM.Lib.StreamFilters.html#sec_stream_filter_positions.A"><span class="id" title="variable">A</span></a>) (<a id="Hinf:151" class="idref" href="#Hinf:151"><span class="id" title="binder">Hinf</span></a> : <a class="idref" href="VLSM.Lib.StreamExtras.html#InfinitelyOften"><span class="id" title="definition">InfinitelyOften</span></a> <a class="idref" href="VLSM.Lib.StreamFilters.html#sec_stream_filter_positions.P"><span class="id" title="variable">P</span></a> <a class="idref" href="VLSM.Lib.StreamFilters.html#s:150"><span class="id" title="variable">s</span></a>) (<a id="n:152" class="idref" href="#n:152"><span class="id" title="binder">n</span></a> : <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Datatypes.html#nat"><span class="id" title="inductive">nat</span></a>)<br/>
&nbsp;&nbsp;(<a id="fpair:153" class="idref" href="#fpair:153"><span class="id" title="binder">fpair</span></a> := <a class="idref" href="VLSM.Lib.StreamFilters.html#stream_filter_fst_pos"><span class="id" title="definition">stream_filter_fst_pos</span></a> <span class="id" title="var">_</span> (<a class="idref" href="VLSM.Lib.StreamExtras.html#fHere"><span class="id" title="lemma">fHere</span></a> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <a class="idref" href="VLSM.Lib.StreamFilters.html#Hinf:151"><span class="id" title="variable">Hinf</span></a>) <a class="idref" href="VLSM.Lib.StreamFilters.html#n:152"><span class="id" title="variable">n</span></a>)<br/>
&nbsp;&nbsp;: <a class="idref" href="VLSM.Lib.StreamFilters.html#stream_filter_positions"><span class="id" title="definition">stream_filter_positions</span></a> <a class="idref" href="VLSM.Lib.StreamFilters.html#s:150"><span class="id" title="variable">s</span></a> <a class="idref" href="VLSM.Lib.StreamFilters.html#Hinf:151"><span class="id" title="variable">Hinf</span></a> <a class="idref" href="VLSM.Lib.StreamFilters.html#n:152"><span class="id" title="variable">n</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">=</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Lists.Streams.html#Cons"><span class="id" title="constructor">Cons</span></a> <a class="idref" href="VLSM.Lib.StreamFilters.html#fpair:153"><span class="id" title="variable">fpair</span></a><span class="id" title="notation">.1</span> (<a class="idref" href="VLSM.Lib.StreamFilters.html#stream_filter_positions"><span class="id" title="definition">stream_filter_positions</span></a> <a class="idref" href="VLSM.Lib.StreamFilters.html#fpair:153"><span class="id" title="variable">fpair</span></a><span class="id" title="notation">.2</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<a class="idref" href="VLSM.Lib.StreamFilters.html#stream_filter_fst_pos_infinitely_often"><span class="id" title="lemma">stream_filter_fst_pos_infinitely_often</span></a> <span class="id" title="var">_</span> (<a class="idref" href="VLSM.Lib.StreamExtras.html#fHere"><span class="id" title="lemma">fHere</span></a> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <a class="idref" href="VLSM.Lib.StreamFilters.html#Hinf:151"><span class="id" title="variable">Hinf</span></a>) <a class="idref" href="VLSM.Lib.StreamFilters.html#n:152"><span class="id" title="variable">n</span></a> <a class="idref" href="VLSM.Lib.StreamFilters.html#Hinf:151"><span class="id" title="variable">Hinf</span></a>)  (<a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Datatypes.html#S"><span class="id" title="constructor">S</span></a> <a class="idref" href="VLSM.Lib.StreamFilters.html#fpair:153"><span class="id" title="variable">fpair</span></a><span class="id" title="notation">.1</span>)).<br/>
<span class="id" title="keyword">Proof</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">by</span> <span class="id" title="tactic">rewrite</span> &lt;- <a class="idref" href="VLSM.Lib.StreamExtras.html#recons"><span class="id" title="lemma">recons</span></a> <span class="id" title="tactic">at</span> 1.<br/>
<span class="id" title="keyword">Qed</span>.<br/>

<br/>
<span class="id" title="keyword">Lemma</span> <a id="stream_filter_positions_Str_nth_tl" class="idref" href="#stream_filter_positions_Str_nth_tl"><span class="id" title="lemma">stream_filter_positions_Str_nth_tl</span></a><br/>
&nbsp;&nbsp;(<a id="s:154" class="idref" href="#s:154"><span class="id" title="binder">s</span></a> : <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Lists.Streams.html#Stream"><span class="id" title="inductive">Stream</span></a> <a class="idref" href="VLSM.Lib.StreamFilters.html#sec_stream_filter_positions.A"><span class="id" title="variable">A</span></a>) (<a id="Hinf:155" class="idref" href="#Hinf:155"><span class="id" title="binder">Hinf</span></a> : <a class="idref" href="VLSM.Lib.StreamExtras.html#InfinitelyOften"><span class="id" title="definition">InfinitelyOften</span></a> <a class="idref" href="VLSM.Lib.StreamFilters.html#sec_stream_filter_positions.P"><span class="id" title="variable">P</span></a> <a class="idref" href="VLSM.Lib.StreamFilters.html#s:154"><span class="id" title="variable">s</span></a>) (<a id="n0:156" class="idref" href="#n0:156"><span class="id" title="binder">n0</span></a> : <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Datatypes.html#nat"><span class="id" title="inductive">nat</span></a>) (<a id="n:157" class="idref" href="#n:157"><span class="id" title="binder">n</span></a> : <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Datatypes.html#nat"><span class="id" title="inductive">nat</span></a>)<br/>
&nbsp;&nbsp;: <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Logic.html#a883bdd010993579f99d60b3775bcf54"><span class="id" title="notation">exists</span></a> <a id="kn:158" class="idref" href="#kn:158"><span class="id" title="binder">kn</span></a> (<a id="Hinf':159" class="idref" href="#Hinf':159"><span class="id" title="binder">Hinf'</span></a> : <a class="idref" href="VLSM.Lib.StreamExtras.html#InfinitelyOften"><span class="id" title="definition">InfinitelyOften</span></a> <a class="idref" href="VLSM.Lib.StreamFilters.html#sec_stream_filter_positions.P"><span class="id" title="variable">P</span></a> (<a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Lists.Streams.html#Str_nth_tl"><span class="id" title="definition">Str_nth_tl</span></a> (<a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Datatypes.html#S"><span class="id" title="constructor">S</span></a> <a class="idref" href="VLSM.Lib.StreamFilters.html#kn:158"><span class="id" title="variable">kn</span></a>) <a class="idref" href="VLSM.Lib.StreamFilters.html#s:154"><span class="id" title="variable">s</span></a>)<a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Logic.html#a883bdd010993579f99d60b3775bcf54"><span class="id" title="notation">),</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Lists.Streams.html#Str_nth_tl"><span class="id" title="definition">Str_nth_tl</span></a> <a class="idref" href="VLSM.Lib.StreamFilters.html#n:157"><span class="id" title="variable">n</span></a> (<a class="idref" href="VLSM.Lib.StreamFilters.html#stream_filter_positions"><span class="id" title="definition">stream_filter_positions</span></a> <a class="idref" href="VLSM.Lib.StreamFilters.html#s:154"><span class="id" title="variable">s</span></a> <a class="idref" href="VLSM.Lib.StreamFilters.html#Hinf:155"><span class="id" title="variable">Hinf</span></a> <a class="idref" href="VLSM.Lib.StreamFilters.html#n0:156"><span class="id" title="variable">n0</span></a>) <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">=</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Lists.Streams.html#Cons"><span class="id" title="constructor">Cons</span></a> (<a class="idref" href="VLSM.Lib.StreamFilters.html#n0:156"><span class="id" title="variable">n0</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Peano.html#0dacc1786c5ba797d47dd85006231633"><span class="id" title="notation">+</span></a> <a class="idref" href="VLSM.Lib.StreamFilters.html#kn:158"><span class="id" title="variable">kn</span></a>) (<a class="idref" href="VLSM.Lib.StreamFilters.html#stream_filter_positions"><span class="id" title="definition">stream_filter_positions</span></a> (<a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Lists.Streams.html#Str_nth_tl"><span class="id" title="definition">Str_nth_tl</span></a> (<a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Datatypes.html#S"><span class="id" title="constructor">S</span></a> <a class="idref" href="VLSM.Lib.StreamFilters.html#kn:158"><span class="id" title="variable">kn</span></a>) <a class="idref" href="VLSM.Lib.StreamFilters.html#s:154"><span class="id" title="variable">s</span></a>) <a class="idref" href="VLSM.Lib.StreamFilters.html#Hinf':159"><span class="id" title="variable">Hinf'</span></a> (<a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Datatypes.html#S"><span class="id" title="constructor">S</span></a> (<a class="idref" href="VLSM.Lib.StreamFilters.html#n0:156"><span class="id" title="variable">n0</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Peano.html#0dacc1786c5ba797d47dd85006231633"><span class="id" title="notation">+</span></a> <a class="idref" href="VLSM.Lib.StreamFilters.html#kn:158"><span class="id" title="variable">kn</span></a>))) <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Logic.html#ba2b0e492d2b4675a0acf3ea92aabadd"><span class="id" title="notation">/\</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="VLSM.Lib.StreamFilters.html#sec_stream_filter_positions.P"><span class="id" title="variable">P</span></a> (<a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Lists.Streams.html#Str_nth"><span class="id" title="definition">Str_nth</span></a> <a class="idref" href="VLSM.Lib.StreamFilters.html#kn:158"><span class="id" title="variable">kn</span></a> <a class="idref" href="VLSM.Lib.StreamFilters.html#s:154"><span class="id" title="variable">s</span></a>).<br/>
<span class="id" title="keyword">Proof</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">induction</span> <span class="id" title="var">n</span>.<br/>
&nbsp;&nbsp;- <span class="id" title="tactic">simpl</span>. <span class="id" title="tactic">rewrite</span> (<a class="idref" href="VLSM.Lib.StreamFilters.html#stream_filter_positions_unroll"><span class="id" title="lemma">stream_filter_positions_unroll</span></a> <span class="id" title="var">s</span> <span class="id" title="var">Hinf</span> <span class="id" title="var">n0</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">specialize</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<a class="idref" href="VLSM.Lib.StreamFilters.html#stream_filter_fst_pos_characterization"><span class="id" title="lemma">stream_filter_fst_pos_characterization</span></a> <span class="id" title="var">s</span> (<a class="idref" href="VLSM.Lib.StreamExtras.html#fHere"><span class="id" title="lemma">fHere</span></a> <span class="id" title="var">_</span> <span class="id" title="var">s</span> <span class="id" title="var">Hinf</span>) <span class="id" title="var">n0</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">as</span> [<span class="id" title="var">k</span> [<span class="id" title="var">Heq</span> [<span class="id" title="var">Hp</span> <span class="id" title="var">_</span>]]].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">assert</span> (<span class="id" title="var">Hk</span> : <span class="id" title="notation">(</span><a class="idref" href="VLSM.Lib.StreamFilters.html#stream_filter_fst_pos"><span class="id" title="definition">stream_filter_fst_pos</span></a> <span class="id" title="var">s</span> (<a class="idref" href="VLSM.Lib.StreamExtras.html#fHere"><span class="id" title="lemma">fHere</span></a> (<a class="idref" href="VLSM.Lib.StreamExtras.html#Exists1"><span class="id" title="definition">Exists1</span></a> <a class="idref" href="VLSM.Lib.StreamFilters.html#sec_stream_filter_positions.P"><span class="id" title="variable">P</span></a>) <span class="id" title="var">s</span> <span class="id" title="var">Hinf</span>) <span class="id" title="var">n0</span><span class="id" title="notation">).1</span> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">=</span></a> <span class="id" title="var">n0</span> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Peano.html#0dacc1786c5ba797d47dd85006231633"><span class="id" title="notation">+</span></a> <span class="id" title="var">k</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;{ <span class="id" title="tactic">by</span> <span class="id" title="tactic">rewrite</span> <span class="id" title="var">Heq</span>. }<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">assert</span> (<span class="id" title="var">Htl</span> : <span class="id" title="notation">(</span><a class="idref" href="VLSM.Lib.StreamFilters.html#stream_filter_fst_pos"><span class="id" title="definition">stream_filter_fst_pos</span></a> <span class="id" title="var">s</span> (<a class="idref" href="VLSM.Lib.StreamExtras.html#fHere"><span class="id" title="lemma">fHere</span></a> (<a class="idref" href="VLSM.Lib.StreamExtras.html#Exists1"><span class="id" title="definition">Exists1</span></a> <a class="idref" href="VLSM.Lib.StreamFilters.html#sec_stream_filter_positions.P"><span class="id" title="variable">P</span></a>) <span class="id" title="var">s</span> <span class="id" title="var">Hinf</span>) <span class="id" title="var">n0</span><span class="id" title="notation">).2</span> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">=</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Lists.Streams.html#Str_nth_tl"><span class="id" title="definition">Str_nth_tl</span></a> (<a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Datatypes.html#S"><span class="id" title="constructor">S</span></a> <span class="id" title="var">k</span>) <span class="id" title="var">s</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;{ <span class="id" title="tactic">by</span> <span class="id" title="tactic">rewrite</span> <span class="id" title="var">Heq</span>. }<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">exists</span> <span class="id" title="var">k</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">by</span> <span class="id" title="tactic">rewrite</span> <span class="id" title="var">Hk</span>; <span class="id" title="var">cbn</span> <span class="id" title="tactic">in</span> *; <span class="id" title="tactic">rewrite</span> &lt;- <span class="id" title="var">Htl</span>; <span class="id" title="tactic">eauto</span>.<br/>
&nbsp;&nbsp;- <span class="id" title="tactic">replace</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Lists.Streams.html#Str_nth_tl"><span class="id" title="definition">Str_nth_tl</span></a> (<a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Datatypes.html#S"><span class="id" title="constructor">S</span></a> <span class="id" title="var">n</span>) (<a class="idref" href="VLSM.Lib.StreamFilters.html#stream_filter_positions"><span class="id" title="definition">stream_filter_positions</span></a> <span class="id" title="var">s</span> <span class="id" title="var">Hinf</span> <span class="id" title="var">n0</span>))<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">with</span> (<a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Lists.Streams.html#tl"><span class="id" title="definition">tl</span></a> (<a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Lists.Streams.html#Str_nth_tl"><span class="id" title="definition">Str_nth_tl</span></a> <span class="id" title="var">n</span> (<a class="idref" href="VLSM.Lib.StreamFilters.html#stream_filter_positions"><span class="id" title="definition">stream_filter_positions</span></a> <span class="id" title="var">s</span> <span class="id" title="var">Hinf</span> <span class="id" title="var">n0</span>)))<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">by</span> <span class="id" title="tactic">apply</span> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Lists.Streams.html#tl_nth_tl"><span class="id" title="lemma">tl_nth_tl</span></a>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">destruct</span> <span class="id" title="var">IHn</span> <span class="id" title="keyword">as</span> [<span class="id" title="var">kn</span> [<span class="id" title="var">Hinfn</span> [<span class="id" title="var">Hsn</span> <span class="id" title="var">Hpn</span>]]].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> <span class="id" title="var">Hsn</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">simpl</span>. <span class="id" title="tactic">rewrite</span> (<a class="idref" href="VLSM.Lib.StreamFilters.html#stream_filter_positions_unroll"><span class="id" title="lemma">stream_filter_positions_unroll</span></a> (<a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Lists.Streams.html#Str_nth_tl"><span class="id" title="definition">Str_nth_tl</span></a> <span class="id" title="var">kn</span> (<a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Lists.Streams.html#tl"><span class="id" title="definition">tl</span></a> <span class="id" title="var">s</span>)) <span class="id" title="var">Hinfn</span> (<a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Datatypes.html#S"><span class="id" title="constructor">S</span></a> (<span class="id" title="var">n0</span> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Peano.html#0dacc1786c5ba797d47dd85006231633"><span class="id" title="notation">+</span></a> <span class="id" title="var">kn</span>))).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">specialize</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<a class="idref" href="VLSM.Lib.StreamFilters.html#stream_filter_fst_pos_characterization"><span class="id" title="lemma">stream_filter_fst_pos_characterization</span></a> (<a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Lists.Streams.html#Str_nth_tl"><span class="id" title="definition">Str_nth_tl</span></a> <span class="id" title="var">kn</span> (<a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Lists.Streams.html#tl"><span class="id" title="definition">tl</span></a> <span class="id" title="var">s</span>)) (<a class="idref" href="VLSM.Lib.StreamExtras.html#fHere"><span class="id" title="lemma">fHere</span></a> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">Hinfn</span>) (<a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Datatypes.html#S"><span class="id" title="constructor">S</span></a> (<span class="id" title="var">n0</span> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Peano.html#0dacc1786c5ba797d47dd85006231633"><span class="id" title="notation">+</span></a> <span class="id" title="var">kn</span>)))<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">as</span> [<span class="id" title="var">k</span> [<span class="id" title="var">Heq</span> [<span class="id" title="var">Hp</span> <span class="id" title="var">_</span>]]].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">exists</span> (<a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Datatypes.html#S"><span class="id" title="constructor">S</span></a> (<span class="id" title="var">k</span> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Peano.html#0dacc1786c5ba797d47dd85006231633"><span class="id" title="notation">+</span></a> <span class="id" title="var">kn</span>)).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">cbn</span> <span class="id" title="tactic">in</span> <span class="id" title="var">Heq</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">apply</span> (<a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Logic.html#f_equal"><span class="id" title="lemma">f_equal</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Datatypes.html#fst"><span class="id" title="definition">fst</span></a>) <span class="id" title="tactic">in</span> <span class="id" title="var">Heq</span> <span class="id" title="keyword">as</span> <span class="id" title="var">Hk</span>; <span class="id" title="tactic">rewrite</span> <span class="id" title="var">Hk</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">apply</span> (<a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Logic.html#f_equal"><span class="id" title="lemma">f_equal</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Datatypes.html#snd"><span class="id" title="definition">snd</span></a>) <span class="id" title="tactic">in</span> <span class="id" title="var">Heq</span> <span class="id" title="keyword">as</span> <span class="id" title="var">Htl</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">simpl</span> <span class="id" title="tactic">in</span> <span class="id" title="var">Htl</span> |- *.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Lists.Streams.html#tl_nth_tl"><span class="id" title="lemma">tl_nth_tl</span></a>, <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Lists.Streams.html#Str_nth_tl_plus"><span class="id" title="lemma">Str_nth_tl_plus</span></a> <span class="id" title="tactic">in</span> <span class="id" title="var">Htl</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Lists.Streams.html#Str_nth_plus"><span class="id" title="lemma">Str_nth_plus</span></a> <span class="id" title="tactic">in</span> <span class="id" title="var">Hp</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> &lt;- <span class="id" title="var">Htl</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">by</span> <span class="id" title="tactic">replace</span> (<span class="id" title="var">n0</span> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Peano.html#0dacc1786c5ba797d47dd85006231633"><span class="id" title="notation">+</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Datatypes.html#S"><span class="id" title="constructor">S</span></a> (<span class="id" title="var">k</span> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Peano.html#0dacc1786c5ba797d47dd85006231633"><span class="id" title="notation">+</span></a> <span class="id" title="var">kn</span>)) <span class="id" title="keyword">with</span> (<a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Datatypes.html#S"><span class="id" title="constructor">S</span></a> (<span class="id" title="var">n0</span> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Peano.html#0dacc1786c5ba797d47dd85006231633"><span class="id" title="notation">+</span></a> <span class="id" title="var">kn</span> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Peano.html#0dacc1786c5ba797d47dd85006231633"><span class="id" title="notation">+</span></a> <span class="id" title="var">k</span>)) <span class="id" title="tactic">by</span> <span class="id" title="var">lia</span>; <span class="id" title="tactic">eauto</span>.<br/>
<span class="id" title="keyword">Qed</span>.<br/>

<br/>
<span class="id" title="keyword">Lemma</span> <a id="stream_filter_positions_monotone" class="idref" href="#stream_filter_positions_monotone"><span class="id" title="lemma">stream_filter_positions_monotone</span></a><br/>
&nbsp;&nbsp;(<a id="s:160" class="idref" href="#s:160"><span class="id" title="binder">s</span></a> : <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Lists.Streams.html#Stream"><span class="id" title="inductive">Stream</span></a> <a class="idref" href="VLSM.Lib.StreamFilters.html#sec_stream_filter_positions.A"><span class="id" title="variable">A</span></a>) (<a id="Hinf:161" class="idref" href="#Hinf:161"><span class="id" title="binder">Hinf</span></a> : <a class="idref" href="VLSM.Lib.StreamExtras.html#InfinitelyOften"><span class="id" title="definition">InfinitelyOften</span></a> <a class="idref" href="VLSM.Lib.StreamFilters.html#sec_stream_filter_positions.P"><span class="id" title="variable">P</span></a> <a class="idref" href="VLSM.Lib.StreamFilters.html#s:160"><span class="id" title="variable">s</span></a>) (<a id="n:162" class="idref" href="#n:162"><span class="id" title="binder">n</span></a> : <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Datatypes.html#nat"><span class="id" title="inductive">nat</span></a>)<br/>
&nbsp;&nbsp;: <a class="idref" href="VLSM.Lib.StreamExtras.html#monotone_nat_stream_prop"><span class="id" title="definition">monotone_nat_stream_prop</span></a> (<a class="idref" href="VLSM.Lib.StreamFilters.html#stream_filter_positions"><span class="id" title="definition">stream_filter_positions</span></a> <a class="idref" href="VLSM.Lib.StreamFilters.html#s:160"><span class="id" title="variable">s</span></a> <a class="idref" href="VLSM.Lib.StreamFilters.html#Hinf:161"><span class="id" title="variable">Hinf</span></a> <a class="idref" href="VLSM.Lib.StreamFilters.html#n:162"><span class="id" title="variable">n</span></a>).<br/>
<span class="id" title="keyword">Proof</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">apply</span> <a class="idref" href="VLSM.Lib.StreamExtras.html#monotone_nat_stream_prop_from_successor"><span class="id" title="lemma">monotone_nat_stream_prop_from_successor</span></a>.<br/>
&nbsp;&nbsp;<span class="id" title="var">revert</span> <span class="id" title="var">s</span> <span class="id" title="var">Hinf</span> <span class="id" title="var">n</span>.<br/>
&nbsp;&nbsp;<span class="id" title="keyword">cofix</span> <span class="id" title="var">H</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">intros</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">constructor</span>; <span class="id" title="tactic">simpl</span>; [| <span class="id" title="tactic">by</span> <span class="id" title="tactic">apply</span> <span class="id" title="var">H</span>].<br/>
&nbsp;&nbsp;<span class="id" title="tactic">by</span> <span class="id" title="tactic">apply</span> <a class="idref" href="VLSM.Lib.StreamFilters.html#stream_filter_fst_pos_le"><span class="id" title="lemma">stream_filter_fst_pos_le</span></a>.<br/>
<span class="id" title="keyword">Qed</span>.<br/>

<br/>
</div>

<div class="doc">
<span class="inlinecode"><a class="idref" href="VLSM.Lib.StreamFilters.html#stream_filter_positions"><span class="id" title="definition">stream_filter_positions</span></a></span> produces a <span class="inlinecode"><span class="id" title="var">filtering_sequence</span></span>. 
</div>
<div class="code">
<span class="id" title="keyword">Lemma</span> <a id="stream_filter_positions_filtering_subsequence" class="idref" href="#stream_filter_positions_filtering_subsequence"><span class="id" title="lemma">stream_filter_positions_filtering_subsequence</span></a><br/>
&nbsp;&nbsp;(<a id="s:163" class="idref" href="#s:163"><span class="id" title="binder">s</span></a> : <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Lists.Streams.html#Stream"><span class="id" title="inductive">Stream</span></a> <a class="idref" href="VLSM.Lib.StreamFilters.html#sec_stream_filter_positions.A"><span class="id" title="variable">A</span></a>) (<a id="Hinf:164" class="idref" href="#Hinf:164"><span class="id" title="binder">Hinf</span></a> : <a class="idref" href="VLSM.Lib.StreamExtras.html#InfinitelyOften"><span class="id" title="definition">InfinitelyOften</span></a> <a class="idref" href="VLSM.Lib.StreamFilters.html#sec_stream_filter_positions.P"><span class="id" title="variable">P</span></a> <a class="idref" href="VLSM.Lib.StreamFilters.html#s:163"><span class="id" title="variable">s</span></a>)<br/>
&nbsp;&nbsp;: <a class="idref" href="VLSM.Lib.StreamFilters.html#filtering_subsequence"><span class="id" title="definition">filtering_subsequence</span></a> <a class="idref" href="VLSM.Lib.StreamFilters.html#sec_stream_filter_positions.P"><span class="id" title="variable">P</span></a> <a class="idref" href="VLSM.Lib.StreamFilters.html#s:163"><span class="id" title="variable">s</span></a> (<a class="idref" href="VLSM.Lib.StreamFilters.html#stream_filter_positions"><span class="id" title="definition">stream_filter_positions</span></a> <a class="idref" href="VLSM.Lib.StreamFilters.html#s:163"><span class="id" title="variable">s</span></a> <a class="idref" href="VLSM.Lib.StreamFilters.html#Hinf:164"><span class="id" title="variable">Hinf</span></a> 0).<br/>
<span class="id" title="keyword">Proof</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">split</span>.<br/>
&nbsp;&nbsp;- <span class="id" title="tactic">specialize</span> (<a class="idref" href="VLSM.Lib.StreamFilters.html#stream_filter_fst_pos_characterization"><span class="id" title="lemma">stream_filter_fst_pos_characterization</span></a> <span class="id" title="var">s</span> (<a class="idref" href="VLSM.Lib.StreamExtras.html#fHere"><span class="id" title="lemma">fHere</span></a> (<a class="idref" href="VLSM.Lib.StreamExtras.html#Exists1"><span class="id" title="definition">Exists1</span></a> <a class="idref" href="VLSM.Lib.StreamFilters.html#sec_stream_filter_positions.P"><span class="id" title="variable">P</span></a>) <span class="id" title="var">s</span> <span class="id" title="var">Hinf</span>) 0)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">as</span> [<span class="id" title="var">k</span> [<span class="id" title="var">Heq</span> [<span class="id" title="var">Hpk</span> <span class="id" title="var">Hnp</span>]]].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">simpl</span> <span class="id" title="tactic">in</span> <span class="id" title="var">Heq</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">by</span> <span class="id" title="tactic">rewrite</span> <a class="idref" href="VLSM.Lib.StreamFilters.html#stream_filter_positions_unroll"><span class="id" title="lemma">stream_filter_positions_unroll</span></a>; <span class="id" title="var">cbn</span>; <span class="id" title="tactic">rewrite</span> <span class="id" title="var">Heq</span>.<br/>
&nbsp;&nbsp;- <span class="id" title="tactic">apply</span> <a class="idref" href="VLSM.Lib.StreamExtras.html#ForAll2_forall"><span class="id" title="lemma">ForAll2_forall</span></a>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">intro</span> <span class="id" title="var">n</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">specialize</span> (<a class="idref" href="VLSM.Lib.StreamFilters.html#stream_filter_positions_Str_nth_tl"><span class="id" title="lemma">stream_filter_positions_Str_nth_tl</span></a> <span class="id" title="var">s</span> <span class="id" title="var">Hinf</span> 0 <span class="id" title="var">n</span>) <span class="id" title="keyword">as</span> <span class="id" title="var">Hnth_tl</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">simpl</span> <span class="id" title="tactic">in</span> <span class="id" title="var">Hnth_tl</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">remember</span> (<a class="idref" href="VLSM.Lib.StreamFilters.html#stream_filter_positions"><span class="id" title="definition">stream_filter_positions</span></a> <span class="id" title="var">s</span> <span class="id" title="var">Hinf</span> 0).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">destruct</span> <span class="id" title="var">Hnth_tl</span> <span class="id" title="keyword">as</span> [<span class="id" title="var">kn</span> [<span class="id" title="var">Hnth_inf</span> [<span class="id" title="var">Hnth</span> <span class="id" title="var">Hnth_p</span>]]].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">unfold</span> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Lists.Streams.html#Str_nth"><span class="id" title="definition">Str_nth</span></a>. <span class="id" title="tactic">simpl</span>. <span class="id" title="tactic">rewrite</span> &lt;- <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Lists.Streams.html#tl_nth_tl"><span class="id" title="lemma">tl_nth_tl</span></a>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> <a class="idref" href="VLSM.Lib.StreamFilters.html#stream_filter_positions_unroll"><span class="id" title="lemma">stream_filter_positions_unroll</span></a> <span class="id" title="tactic">in</span> <span class="id" title="var">Hnth</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">specialize</span> (<a class="idref" href="VLSM.Lib.StreamFilters.html#stream_filter_fst_pos_characterization"><span class="id" title="lemma">stream_filter_fst_pos_characterization</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Lists.Streams.html#Str_nth_tl"><span class="id" title="definition">Str_nth_tl</span></a> <span class="id" title="var">kn</span> (<a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Lists.Streams.html#tl"><span class="id" title="definition">tl</span></a> <span class="id" title="var">s</span>)) (<a class="idref" href="VLSM.Lib.StreamExtras.html#fHere"><span class="id" title="lemma">fHere</span></a> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">Hnth_inf</span>) (<a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Datatypes.html#S"><span class="id" title="constructor">S</span></a> <span class="id" title="var">kn</span>))<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">as</span> [<span class="id" title="var">k</span> [<span class="id" title="var">Heq</span> [<span class="id" title="var">Hpk</span> <span class="id" title="var">Hnp</span>]]].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> <span class="id" title="var">Hnth</span>; <span class="id" title="tactic">simpl</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">split</span>; [<span class="id" title="var">done</span> |].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> <span class="id" title="var">Heq</span>. <span class="id" title="tactic">simpl</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">split</span>; [<span class="id" title="var">lia</span> |].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">intros</span> <span class="id" title="var">i</span> [<span class="id" title="var">Hle</span> <span class="id" title="var">Hlt</span>].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">apply</span> <a class="idref" href="VLSM.Lib.StdppExtras.html#stdpp_nat_le_sum"><span class="id" title="lemma">stdpp_nat_le_sum</span></a> <span class="id" title="tactic">in</span> <span class="id" title="var">Hle</span> <span class="id" title="keyword">as</span> [<span class="id" title="var">k'</span> -&gt;].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Numbers.Natural.Peano.NPeano.html#Nat.add_comm"><span class="id" title="lemma">Nat.add_comm</span></a>, &lt;- <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Lists.Streams.html#Str_nth_tl_plus"><span class="id" title="lemma">Str_nth_tl_plus</span></a>. <span class="id" title="tactic">simpl</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">by</span> <span class="id" title="tactic">apply</span> <span class="id" title="var">Hnp</span>; <span class="id" title="var">lia</span>.<br/>
<span class="id" title="keyword">Qed</span>.<br/>

<br/>
</div>

<div class="doc">
  A restatement of <span class="inlinecode"><a class="idref" href="VLSM.Lib.StreamFilters.html#filtering_subsequence_stream_filter_map"><span class="id" title="definition">filtering_subsequence_stream_filter_map</span></a></span> based on the
  <span class="inlinecode"><a class="idref" href="VLSM.Lib.StreamExtras.html#InfinitelyOften"><span class="id" title="definition">InfinitelyOften</span></a></span> predicate, using the <span class="inlinecode"><a class="idref" href="VLSM.Lib.StreamFilters.html#stream_filter_positions_filtering_subsequence"><span class="id" title="lemma">stream_filter_positions_filtering_subsequence</span></a></span>.

</div>
<div class="code">
<span class="id" title="keyword">Definition</span> <a id="stream_filter_map" class="idref" href="#stream_filter_map"><span class="id" title="definition">stream_filter_map</span></a><br/>
&nbsp;&nbsp;[<a id="B:165" class="idref" href="#B:165"><span class="id" title="binder">B</span></a> : <span class="id" title="keyword">Type</span>]<br/>
&nbsp;&nbsp;(<a id="f:166" class="idref" href="#f:166"><span class="id" title="binder">f</span></a> : <span class="id" title="definition">dsig</span> <a class="idref" href="VLSM.Lib.StreamFilters.html#sec_stream_filter_positions.P"><span class="id" title="variable">P</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x"><span class="id" title="notation">-&gt;</span></a> <a class="idref" href="VLSM.Lib.StreamFilters.html#B:165"><span class="id" title="variable">B</span></a>)<br/>
&nbsp;&nbsp;(<a id="s:167" class="idref" href="#s:167"><span class="id" title="binder">s</span></a> : <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Lists.Streams.html#Stream"><span class="id" title="inductive">Stream</span></a> <a class="idref" href="VLSM.Lib.StreamFilters.html#sec_stream_filter_positions.A"><span class="id" title="variable">A</span></a>)<br/>
&nbsp;&nbsp;(<a id="Hinf:168" class="idref" href="#Hinf:168"><span class="id" title="binder">Hinf</span></a> : <a class="idref" href="VLSM.Lib.StreamExtras.html#InfinitelyOften"><span class="id" title="definition">InfinitelyOften</span></a> <a class="idref" href="VLSM.Lib.StreamFilters.html#sec_stream_filter_positions.P"><span class="id" title="variable">P</span></a> <a class="idref" href="VLSM.Lib.StreamFilters.html#s:167"><span class="id" title="variable">s</span></a>)<br/>
&nbsp;&nbsp;: <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Lists.Streams.html#Stream"><span class="id" title="inductive">Stream</span></a> <a class="idref" href="VLSM.Lib.StreamFilters.html#B:165"><span class="id" title="variable">B</span></a> :=<br/>
&nbsp;&nbsp;<a class="idref" href="VLSM.Lib.StreamFilters.html#filtering_subsequence_stream_filter_map"><span class="id" title="definition">filtering_subsequence_stream_filter_map</span></a> <a class="idref" href="VLSM.Lib.StreamFilters.html#sec_stream_filter_positions.P"><span class="id" title="variable">P</span></a> <a class="idref" href="VLSM.Lib.StreamFilters.html#f:166"><span class="id" title="variable">f</span></a> <span class="id" title="var">_</span> <span class="id" title="var">_</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;(<a class="idref" href="VLSM.Lib.StreamFilters.html#stream_filter_positions_filtering_subsequence"><span class="id" title="lemma">stream_filter_positions_filtering_subsequence</span></a> <a class="idref" href="VLSM.Lib.StreamFilters.html#s:167"><span class="id" title="variable">s</span></a> <a class="idref" href="VLSM.Lib.StreamFilters.html#Hinf:168"><span class="id" title="variable">Hinf</span></a>).<br/>

<br/>
</div>

<div class="doc">
Stream filtering is obtained as a specialization of <span class="inlinecode"><a class="idref" href="VLSM.Lib.StreamFilters.html#stream_filter_map"><span class="id" title="definition">stream_filter_map</span></a></span>. 
</div>
<div class="code">
<span class="id" title="keyword">Definition</span> <a id="stream_filter" class="idref" href="#stream_filter"><span class="id" title="definition">stream_filter</span></a><br/>
&nbsp;&nbsp;(<a id="s:169" class="idref" href="#s:169"><span class="id" title="binder">s</span></a> : <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Lists.Streams.html#Stream"><span class="id" title="inductive">Stream</span></a> <a class="idref" href="VLSM.Lib.StreamFilters.html#sec_stream_filter_positions.A"><span class="id" title="variable">A</span></a>)<br/>
&nbsp;&nbsp;(<a id="Hinf:170" class="idref" href="#Hinf:170"><span class="id" title="binder">Hinf</span></a> : <a class="idref" href="VLSM.Lib.StreamExtras.html#InfinitelyOften"><span class="id" title="definition">InfinitelyOften</span></a> <a class="idref" href="VLSM.Lib.StreamFilters.html#sec_stream_filter_positions.P"><span class="id" title="variable">P</span></a> <a class="idref" href="VLSM.Lib.StreamFilters.html#s:169"><span class="id" title="variable">s</span></a>)<br/>
&nbsp;&nbsp;: <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Lists.Streams.html#Stream"><span class="id" title="inductive">Stream</span></a> <a class="idref" href="VLSM.Lib.StreamFilters.html#sec_stream_filter_positions.A"><span class="id" title="variable">A</span></a> :=<br/>
&nbsp;&nbsp;<a class="idref" href="VLSM.Lib.StreamFilters.html#stream_filter_map"><span class="id" title="definition">stream_filter_map</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Specif.html#proj1_sig"><span class="id" title="definition">proj1_sig</span></a> <a class="idref" href="VLSM.Lib.StreamFilters.html#s:169"><span class="id" title="variable">s</span></a> <a class="idref" href="VLSM.Lib.StreamFilters.html#Hinf:170"><span class="id" title="variable">Hinf</span></a>.<br/>

<br/>
<span class="id" title="keyword">End</span> <a class="idref" href="VLSM.Lib.StreamFilters.html#sec_stream_filter_positions"><span class="id" title="section">sec_stream_filter_positions</span></a>.<br/>

<br/>
<span class="id" title="keyword">Section</span> <a id="sec_stream_map_option" class="idref" href="#sec_stream_map_option"><span class="id" title="section">sec_stream_map_option</span></a>.<br/>

<br/>
</div>

<div class="doc">
<a id="lab54"></a><h2 class="section">Mapping a partial function on a stream</h2>


<div class="paragraph"> </div>

  Given a partial function <code>f</code> which is <span class="inlinecode"><a class="idref" href="VLSM.Lib.StreamExtras.html#InfinitelyOften"><span class="id" title="definition">InfinitelyOften</span></a></span> defined on the
  elements of a stream <code>s</code>, we can define the stream of the defined mapped
  values of <code>s</code> through <code>f</code> as a particular <span class="inlinecode"><a class="idref" href="VLSM.Lib.StreamFilters.html#stream_filter_map"><span class="id" title="definition">stream_filter_map</span></a></span>.

</div>
<div class="code">

<br/>
<span class="id" title="keyword">Context</span><br/>
&nbsp;&nbsp;[<a id="A:171" class="idref" href="#A:171"><span class="id" title="binder">A</span></a> <a id="B:172" class="idref" href="#B:172"><span class="id" title="binder">B</span></a> : <span class="id" title="keyword">Type</span>]<br/>
&nbsp;&nbsp;(<a id="f:173" class="idref" href="#f:173"><span class="id" title="binder">f</span></a> : <a class="idref" href="VLSM.Lib.StreamFilters.html#A:171"><span class="id" title="variable">A</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x"><span class="id" title="notation">-&gt;</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Datatypes.html#option"><span class="id" title="inductive">option</span></a> <a class="idref" href="VLSM.Lib.StreamFilters.html#B:172"><span class="id" title="variable">B</span></a>)<br/>
&nbsp;&nbsp;(<a id="P:174" class="idref" href="#P:174"><span class="id" title="binder">P</span></a> : <a class="idref" href="VLSM.Lib.StreamFilters.html#A:171"><span class="id" title="variable">A</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x"><span class="id" title="notation">-&gt;</span></a> <span class="id" title="keyword">Prop</span> := <span class="id" title="definition">is_Some</span> <span class="id" title="notation"></span> <a class="idref" href="VLSM.Lib.StreamFilters.html#f:173"><span class="id" title="variable">f</span></a>)<br/>
&nbsp;&nbsp;(<a id="s:175" class="idref" href="#s:175"><span class="id" title="binder">s</span></a> : <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Lists.Streams.html#Stream"><span class="id" title="inductive">Stream</span></a> <a class="idref" href="VLSM.Lib.StreamFilters.html#A:171"><span class="id" title="variable">A</span></a>)<br/>
&nbsp;&nbsp;.<br/>

<br/>
<span class="id" title="keyword">Definition</span> <a id="stream_map_option" class="idref" href="#stream_map_option"><span class="id" title="definition">stream_map_option</span></a><br/>
&nbsp;&nbsp;(<a id="Hinf:176" class="idref" href="#Hinf:176"><span class="id" title="binder">Hinf</span></a> : <a class="idref" href="VLSM.Lib.StreamExtras.html#InfinitelyOften"><span class="id" title="definition">InfinitelyOften</span></a> <a class="idref" href="VLSM.Lib.StreamFilters.html#sec_stream_map_option.P"><span class="id" title="variable">P</span></a> <a class="idref" href="VLSM.Lib.StreamFilters.html#sec_stream_map_option.s"><span class="id" title="variable">s</span></a>)<br/>
&nbsp;&nbsp;: <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Lists.Streams.html#Stream"><span class="id" title="inductive">Stream</span></a> <a class="idref" href="VLSM.Lib.StreamFilters.html#sec_stream_map_option.B"><span class="id" title="variable">B</span></a> :=<br/>
&nbsp;&nbsp;<a class="idref" href="VLSM.Lib.StreamFilters.html#stream_filter_map"><span class="id" title="definition">stream_filter_map</span></a> <a class="idref" href="VLSM.Lib.StreamFilters.html#sec_stream_map_option.P"><span class="id" title="variable">P</span></a> (<span class="id" title="keyword">fun</span> <a id="k:177" class="idref" href="#k:177"><span class="id" title="binder">k</span></a> : <span class="id" title="definition">dsig</span> <a class="idref" href="VLSM.Lib.StreamFilters.html#sec_stream_map_option.P"><span class="id" title="variable">P</span></a> =&gt; <span class="id" title="definition">is_Some_proj</span> (<span class="id" title="definition">proj2_dsig</span> <a class="idref" href="VLSM.Lib.StreamFilters.html#k:177"><span class="id" title="variable">k</span></a>)) <a class="idref" href="VLSM.Lib.StreamFilters.html#sec_stream_map_option.s"><span class="id" title="variable">s</span></a> <a class="idref" href="VLSM.Lib.StreamFilters.html#Hinf:176"><span class="id" title="variable">Hinf</span></a>.<br/>

<br/>
<span class="id" title="keyword">Lemma</span> <a id="stream_map_option_prefix" class="idref" href="#stream_map_option_prefix"><span class="id" title="lemma">stream_map_option_prefix</span></a><br/>
&nbsp;&nbsp;(<a id="Hinf:178" class="idref" href="#Hinf:178"><span class="id" title="binder">Hinf</span></a> : <a class="idref" href="VLSM.Lib.StreamExtras.html#InfinitelyOften"><span class="id" title="definition">InfinitelyOften</span></a> <a class="idref" href="VLSM.Lib.StreamFilters.html#sec_stream_map_option.P"><span class="id" title="variable">P</span></a> <a class="idref" href="VLSM.Lib.StreamFilters.html#sec_stream_map_option.s"><span class="id" title="variable">s</span></a>)<br/>
&nbsp;&nbsp;(<a id="n:179" class="idref" href="#n:179"><span class="id" title="binder">n</span></a> : <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Datatypes.html#nat"><span class="id" title="inductive">nat</span></a>)<br/>
&nbsp;&nbsp;(<a id="map_opt_pre:180" class="idref" href="#map_opt_pre:180"><span class="id" title="binder">map_opt_pre</span></a> := <span class="id" title="definition">omap</span> <a class="idref" href="VLSM.Lib.StreamFilters.html#sec_stream_map_option.f"><span class="id" title="variable">f</span></a> (<a class="idref" href="VLSM.Lib.StreamExtras.html#stream_prefix"><span class="id" title="definition">stream_prefix</span></a> <a class="idref" href="VLSM.Lib.StreamFilters.html#sec_stream_map_option.s"><span class="id" title="variable">s</span></a> <a class="idref" href="VLSM.Lib.StreamFilters.html#n:179"><span class="id" title="variable">n</span></a>))<br/>
&nbsp;&nbsp;(<a id="m:181" class="idref" href="#m:181"><span class="id" title="binder">m</span></a> := <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Datatypes.html#length"><span class="id" title="definition">length</span></a> <a class="idref" href="VLSM.Lib.StreamFilters.html#map_opt_pre:180"><span class="id" title="variable">map_opt_pre</span></a>)<br/>
&nbsp;&nbsp;: <a class="idref" href="VLSM.Lib.StreamExtras.html#stream_prefix"><span class="id" title="definition">stream_prefix</span></a> (<a class="idref" href="VLSM.Lib.StreamFilters.html#stream_map_option"><span class="id" title="definition">stream_map_option</span></a> <a class="idref" href="VLSM.Lib.StreamFilters.html#Hinf:178"><span class="id" title="variable">Hinf</span></a>) <a class="idref" href="VLSM.Lib.StreamFilters.html#m:181"><span class="id" title="variable">m</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">=</span></a> <a class="idref" href="VLSM.Lib.StreamFilters.html#map_opt_pre:180"><span class="id" title="variable">map_opt_pre</span></a>.<br/>
<span class="id" title="keyword">Proof</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">subst</span> <span class="id" title="var">map_opt_pre</span> <span class="id" title="var">m</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> !(<a class="idref" href="VLSM.Lib.ListExtras.html#omap_as_filter"><span class="id" title="lemma">omap_as_filter</span></a> <a class="idref" href="VLSM.Lib.StreamFilters.html#sec_stream_map_option.f"><span class="id" title="variable">f</span></a> (<a class="idref" href="VLSM.Lib.StreamExtras.html#stream_prefix"><span class="id" title="definition">stream_prefix</span></a> <a class="idref" href="VLSM.Lib.StreamFilters.html#sec_stream_map_option.s"><span class="id" title="variable">s</span></a> <span class="id" title="var">n</span>)).<br/>
&nbsp;&nbsp;<span class="id" title="tactic">by</span> <span class="id" title="tactic">apply</span> <a class="idref" href="VLSM.Lib.StreamFilters.html#fitering_subsequence_stream_filter_map_prefix"><span class="id" title="lemma">fitering_subsequence_stream_filter_map_prefix</span></a>.<br/>
<span class="id" title="keyword">Qed</span>.<br/>

<br/>
<span class="id" title="keyword">Program Definition</span> <a id="stream_map_option_prefix_ex" class="idref" href="#stream_map_option_prefix_ex"><span class="id" title="definition">stream_map_option_prefix_ex</span></a><br/>
&nbsp;&nbsp;(<a id="Hinf:182" class="idref" href="#Hinf:182"><span class="id" title="binder">Hinf</span></a> : <a class="idref" href="VLSM.Lib.StreamExtras.html#InfinitelyOften"><span class="id" title="definition">InfinitelyOften</span></a> <a class="idref" href="VLSM.Lib.StreamFilters.html#sec_stream_map_option.P"><span class="id" title="variable">P</span></a> <a class="idref" href="VLSM.Lib.StreamFilters.html#sec_stream_map_option.s"><span class="id" title="variable">s</span></a>)<br/>
&nbsp;&nbsp;(<a id="Hfs:183" class="idref" href="#Hfs:183"><span class="id" title="binder">Hfs</span></a> := <a class="idref" href="VLSM.Lib.StreamFilters.html#stream_filter_positions_filtering_subsequence"><span class="id" title="lemma">stream_filter_positions_filtering_subsequence</span></a> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <a class="idref" href="VLSM.Lib.StreamFilters.html#Hinf:182"><span class="id" title="variable">Hinf</span></a>)<br/>
&nbsp;&nbsp;(<a id="k:184" class="idref" href="#k:184"><span class="id" title="binder">k</span></a> : <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Datatypes.html#nat"><span class="id" title="inductive">nat</span></a>)<br/>
&nbsp;&nbsp;: <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Specif.html#bc4528e836ab0e91ea7e942fb09e898f"><span class="id" title="notation">{</span></a> <a id="n:185" class="idref" href="#n:185"><span class="id" title="binder">n</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Specif.html#bc4528e836ab0e91ea7e942fb09e898f"><span class="id" title="notation">|</span></a> <a class="idref" href="VLSM.Lib.StreamExtras.html#stream_prefix"><span class="id" title="definition">stream_prefix</span></a> (<a class="idref" href="VLSM.Lib.StreamFilters.html#stream_map_option"><span class="id" title="definition">stream_map_option</span></a> <a class="idref" href="VLSM.Lib.StreamFilters.html#Hinf:182"><span class="id" title="variable">Hinf</span></a>) <a class="idref" href="VLSM.Lib.StreamFilters.html#k:184"><span class="id" title="variable">k</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">=</span></a> <span class="id" title="definition">omap</span> <a class="idref" href="VLSM.Lib.StreamFilters.html#sec_stream_map_option.f"><span class="id" title="variable">f</span></a> (<a class="idref" href="VLSM.Lib.StreamExtras.html#stream_prefix"><span class="id" title="definition">stream_prefix</span></a> <a class="idref" href="VLSM.Lib.StreamFilters.html#sec_stream_map_option.s"><span class="id" title="variable">s</span></a> <a class="idref" href="VLSM.Lib.StreamFilters.html#n:185"><span class="id" title="variable">n</span></a>)<a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Specif.html#bc4528e836ab0e91ea7e942fb09e898f"><span class="id" title="notation">}</span></a> :=<br/>
&nbsp;&nbsp;<span class="id" title="keyword">let</span> (<a id="n:187" class="idref" href="#n:187"><span class="id" title="binder">n</span></a>, <a id="Heq:188" class="idref" href="#Heq:188"><span class="id" title="binder">Heq</span></a>) := (<a class="idref" href="VLSM.Lib.StreamFilters.html#fitering_subsequence_stream_filter_map_prefix_ex"><span class="id" title="definition">fitering_subsequence_stream_filter_map_prefix_ex</span></a> <a class="idref" href="VLSM.Lib.StreamFilters.html#sec_stream_map_option.P"><span class="id" title="variable">P</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id" title="keyword">fun</span> <a id="k:186" class="idref" href="#k:186"><span class="id" title="binder">k</span></a> =&gt; <span class="id" title="definition">is_Some_proj</span> (<span class="id" title="definition">proj2_dsig</span> <a class="idref" href="VLSM.Lib.StreamFilters.html#k:186"><span class="id" title="variable">k</span></a>)) <span class="id" title="var">_</span> <span class="id" title="var">_</span> <a class="idref" href="VLSM.Lib.StreamFilters.html#Hfs:183"><span class="id" title="variable">Hfs</span></a> <a class="idref" href="VLSM.Lib.StreamFilters.html#k:184"><span class="id" title="variable">k</span></a>)<br/>
&nbsp;&nbsp;<span class="id" title="tactic">in</span> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Specif.html#exist"><span class="id" title="constructor">exist</span></a> <span class="id" title="var">_</span> <a class="idref" href="VLSM.Lib.StreamFilters.html#n:187"><span class="id" title="variable">n</span></a> <span class="id" title="var">_</span>.<br/>
<span class="id" title="keyword">Next</span> <span class="id" title="keyword">Obligation</span>.<br/>
<span class="id" title="keyword">Proof</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">by</span> <span class="id" title="tactic">intros</span>; <span class="id" title="var">cbn</span>; <span class="id" title="tactic">rewrite</span> !<a class="idref" href="VLSM.Lib.ListExtras.html#omap_as_filter"><span class="id" title="lemma">omap_as_filter</span></a>.<br/>
<span class="id" title="keyword">Qed</span>.<br/>

<br/>
<span class="id" title="keyword">Definition</span> <a id="bounded_stream_map_option" class="idref" href="#bounded_stream_map_option"><span class="id" title="definition">bounded_stream_map_option</span></a><br/>
&nbsp;&nbsp;(<a id="Hfin:189" class="idref" href="#Hfin:189"><span class="id" title="binder">Hfin</span></a> : <a class="idref" href="VLSM.Lib.StreamExtras.html#FinitelyManyBound"><span class="id" title="definition">FinitelyManyBound</span></a> <a class="idref" href="VLSM.Lib.StreamFilters.html#sec_stream_map_option.P"><span class="id" title="variable">P</span></a> <a class="idref" href="VLSM.Lib.StreamFilters.html#sec_stream_map_option.s"><span class="id" title="variable">s</span></a>)<br/>
&nbsp;&nbsp;: <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Datatypes.html#list"><span class="id" title="inductive">list</span></a> <a class="idref" href="VLSM.Lib.StreamFilters.html#sec_stream_map_option.B"><span class="id" title="variable">B</span></a> :=<br/>
&nbsp;&nbsp;<span class="id" title="definition">omap</span> <a class="idref" href="VLSM.Lib.StreamFilters.html#sec_stream_map_option.f"><span class="id" title="variable">f</span></a> (<a class="idref" href="VLSM.Lib.StreamExtras.html#stream_prefix"><span class="id" title="definition">stream_prefix</span></a> <a class="idref" href="VLSM.Lib.StreamFilters.html#sec_stream_map_option.s"><span class="id" title="variable">s</span></a> (<span class="id" title="notation">`</span> <a class="idref" href="VLSM.Lib.StreamFilters.html#Hfin:189"><span class="id" title="variable">Hfin</span></a>)).<br/>

<br/>
<span class="id" title="keyword">End</span> <a class="idref" href="VLSM.Lib.StreamFilters.html#sec_stream_map_option"><span class="id" title="section">sec_stream_map_option</span></a>.<br/>

<br/>
<span class="id" title="keyword">Section</span> <a id="sec_stream_concat_map" class="idref" href="#sec_stream_concat_map"><span class="id" title="section">sec_stream_concat_map</span></a>.<br/>

<br/>
</div>

<div class="doc">
<a id="lab55"></a><h2 class="section">Mapping a function expanding elements to lists of elements on a stream</h2>


<div class="paragraph"> </div>

  Given a function <code>f</code> which <span class="inlinecode"><a class="idref" href="VLSM.Lib.StreamExtras.html#InfinitelyOften"><span class="id" title="definition">InfinitelyOften</span></a></span> produces non-empty lists from
  the elements of a stream <code>s</code>, we can define the stream obtained by
  concatenating the values of <code>s</code> through <code>f</code>.

</div>
<div class="code">

<br/>
<span class="id" title="keyword">Context</span><br/>
&nbsp;&nbsp;[<a id="A:190" class="idref" href="#A:190"><span class="id" title="binder">A</span></a> <a id="B:191" class="idref" href="#B:191"><span class="id" title="binder">B</span></a> : <span class="id" title="keyword">Type</span>]<br/>
&nbsp;&nbsp;(<a id="f:192" class="idref" href="#f:192"><span class="id" title="binder">f</span></a> : <a class="idref" href="VLSM.Lib.StreamFilters.html#A:190"><span class="id" title="variable">A</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x"><span class="id" title="notation">-&gt;</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Datatypes.html#list"><span class="id" title="inductive">list</span></a> <a class="idref" href="VLSM.Lib.StreamFilters.html#B:191"><span class="id" title="variable">B</span></a>)<br/>
&nbsp;&nbsp;(<a id="FNonEmpty:194" class="idref" href="#FNonEmpty:194"><span class="id" title="binder">FNonEmpty</span></a> : <a class="idref" href="VLSM.Lib.StreamFilters.html#A:190"><span class="id" title="variable">A</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x"><span class="id" title="notation">-&gt;</span></a> <span class="id" title="keyword">Prop</span> := <span class="id" title="keyword">fun</span> <a id="a:193" class="idref" href="#a:193"><span class="id" title="binder">a</span></a> =&gt; <a class="idref" href="VLSM.Lib.StreamFilters.html#f:192"><span class="id" title="variable">f</span></a> <a class="idref" href="VLSM.Lib.StreamFilters.html#a:193"><span class="id" title="variable">a</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Logic.html#::type_scope:x_'&lt;&gt;'_x"><span class="id" title="notation">&lt;&gt;</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Lists.List.html#ae9a5e1034e143b218b09d8e454472bd"><span class="id" title="notation">[]</span></a>)<br/>
&nbsp;&nbsp;(<a id="s:195" class="idref" href="#s:195"><span class="id" title="binder">s</span></a> : <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Lists.Streams.html#Stream"><span class="id" title="inductive">Stream</span></a> <a class="idref" href="VLSM.Lib.StreamFilters.html#A:190"><span class="id" title="variable">A</span></a>)<br/>
&nbsp;&nbsp;.<br/>

<br/>
<span class="id" title="keyword">Definition</span> <a id="stream_concat_map" class="idref" href="#stream_concat_map"><span class="id" title="definition">stream_concat_map</span></a><br/>
&nbsp;&nbsp;(<a id="Hinf:196" class="idref" href="#Hinf:196"><span class="id" title="binder">Hinf</span></a> : <a class="idref" href="VLSM.Lib.StreamExtras.html#InfinitelyOften"><span class="id" title="definition">InfinitelyOften</span></a> <a class="idref" href="VLSM.Lib.StreamFilters.html#sec_stream_concat_map.FNonEmpty"><span class="id" title="variable">FNonEmpty</span></a> <a class="idref" href="VLSM.Lib.StreamFilters.html#sec_stream_concat_map.s"><span class="id" title="variable">s</span></a>)<br/>
&nbsp;&nbsp;: <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Lists.Streams.html#Stream"><span class="id" title="inductive">Stream</span></a> <a class="idref" href="VLSM.Lib.StreamFilters.html#sec_stream_concat_map.B"><span class="id" title="variable">B</span></a> :=<br/>
&nbsp;&nbsp;<a class="idref" href="VLSM.Lib.StreamExtras.html#stream_concat"><span class="id" title="definition">stream_concat</span></a> (<a class="idref" href="VLSM.Lib.StreamFilters.html#stream_filter_map"><span class="id" title="definition">stream_filter_map</span></a> <a class="idref" href="VLSM.Lib.StreamFilters.html#sec_stream_concat_map.FNonEmpty"><span class="id" title="variable">FNonEmpty</span></a> (<a class="idref" href="VLSM.Lib.NeList.html#list_function_restriction"><span class="id" title="definition">list_function_restriction</span></a> <a class="idref" href="VLSM.Lib.StreamFilters.html#sec_stream_concat_map.f"><span class="id" title="variable">f</span></a>) <a class="idref" href="VLSM.Lib.StreamFilters.html#sec_stream_concat_map.s"><span class="id" title="variable">s</span></a> <a class="idref" href="VLSM.Lib.StreamFilters.html#Hinf:196"><span class="id" title="variable">Hinf</span></a>).<br/>

<br/>
<span class="id" title="keyword">Lemma</span> <a id="stream_concat_map_prefix" class="idref" href="#stream_concat_map_prefix"><span class="id" title="lemma">stream_concat_map_prefix</span></a><br/>
&nbsp;&nbsp;(<a id="Hinf:197" class="idref" href="#Hinf:197"><span class="id" title="binder">Hinf</span></a> : <a class="idref" href="VLSM.Lib.StreamExtras.html#InfinitelyOften"><span class="id" title="definition">InfinitelyOften</span></a> <a class="idref" href="VLSM.Lib.StreamFilters.html#sec_stream_concat_map.FNonEmpty"><span class="id" title="variable">FNonEmpty</span></a> <a class="idref" href="VLSM.Lib.StreamFilters.html#sec_stream_concat_map.s"><span class="id" title="variable">s</span></a>)<br/>
&nbsp;&nbsp;(<a id="n:198" class="idref" href="#n:198"><span class="id" title="binder">n</span></a> : <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Datatypes.html#nat"><span class="id" title="inductive">nat</span></a>)<br/>
&nbsp;&nbsp;(<a id="mbind_prefix:199" class="idref" href="#mbind_prefix:199"><span class="id" title="binder">mbind_prefix</span></a> := <span class="id" title="definition">mbind</span> <a class="idref" href="VLSM.Lib.StreamFilters.html#sec_stream_concat_map.f"><span class="id" title="variable">f</span></a> (<a class="idref" href="VLSM.Lib.StreamExtras.html#stream_prefix"><span class="id" title="definition">stream_prefix</span></a> <a class="idref" href="VLSM.Lib.StreamFilters.html#sec_stream_concat_map.s"><span class="id" title="variable">s</span></a> <a class="idref" href="VLSM.Lib.StreamFilters.html#n:198"><span class="id" title="variable">n</span></a>))<br/>
&nbsp;&nbsp;(<a id="m:200" class="idref" href="#m:200"><span class="id" title="binder">m</span></a> := <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Datatypes.html#length"><span class="id" title="definition">length</span></a> <a class="idref" href="VLSM.Lib.StreamFilters.html#mbind_prefix:199"><span class="id" title="variable">mbind_prefix</span></a>)<br/>
&nbsp;&nbsp;: <a class="idref" href="VLSM.Lib.StreamExtras.html#stream_prefix"><span class="id" title="definition">stream_prefix</span></a> (<a class="idref" href="VLSM.Lib.StreamFilters.html#stream_concat_map"><span class="id" title="definition">stream_concat_map</span></a> <a class="idref" href="VLSM.Lib.StreamFilters.html#Hinf:197"><span class="id" title="variable">Hinf</span></a>) <a class="idref" href="VLSM.Lib.StreamFilters.html#m:200"><span class="id" title="variable">m</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">=</span></a> <a class="idref" href="VLSM.Lib.StreamFilters.html#mbind_prefix:199"><span class="id" title="variable">mbind_prefix</span></a>.<br/>
<span class="id" title="keyword">Proof</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">subst</span> <span class="id" title="var">mbind_prefix</span> <span class="id" title="var">m</span>; <span class="id" title="tactic">unfold</span> <a class="idref" href="VLSM.Lib.StreamFilters.html#stream_concat_map"><span class="id" title="definition">stream_concat_map</span></a>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">cut</span> (<span class="id" title="definition">mjoin</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;(<a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Lists.List.html#map"><span class="id" title="definition">List.map</span></a> <a class="idref" href="VLSM.Lib.NeList.html#ne_list_to_list"><span class="id" title="definition">ne_list_to_list</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<a class="idref" href="VLSM.Lib.ListExtras.html#list_filter_map"><span class="id" title="definition">list_filter_map</span></a> (<span class="id" title="keyword">fun</span> <a id="a:201" class="idref" href="#a:201"><span class="id" title="binder"><span id="a:202" class="id">a</span></span></a> : <a class="idref" href="VLSM.Lib.StreamFilters.html#sec_stream_concat_map.A"><span class="id" title="variable">A</span></a> =&gt; <a class="idref" href="VLSM.Lib.StreamFilters.html#sec_stream_concat_map.f"><span class="id" title="variable">f</span></a> <a class="idref" href="VLSM.Lib.StreamFilters.html#a:201"><span class="id" title="variable">a</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Logic.html#::type_scope:x_'&lt;&gt;'_x"><span class="id" title="notation">&lt;&gt;</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Lists.List.html#ae9a5e1034e143b218b09d8e454472bd"><span class="id" title="notation">[]</span></a>) (<a class="idref" href="VLSM.Lib.NeList.html#list_function_restriction"><span class="id" title="definition">list_function_restriction</span></a> <a class="idref" href="VLSM.Lib.StreamFilters.html#sec_stream_concat_map.f"><span class="id" title="variable">f</span></a>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<a class="idref" href="VLSM.Lib.StreamExtras.html#stream_prefix"><span class="id" title="definition">stream_prefix</span></a> <a class="idref" href="VLSM.Lib.StreamFilters.html#sec_stream_concat_map.s"><span class="id" title="variable">s</span></a> <span class="id" title="var">n</span>))) <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">=</span></a> <span class="id" title="definition">mbind</span> <a class="idref" href="VLSM.Lib.StreamFilters.html#sec_stream_concat_map.f"><span class="id" title="variable">f</span></a> (<a class="idref" href="VLSM.Lib.StreamExtras.html#stream_prefix"><span class="id" title="definition">stream_prefix</span></a> <a class="idref" href="VLSM.Lib.StreamFilters.html#sec_stream_concat_map.s"><span class="id" title="variable">s</span></a> <span class="id" title="var">n</span>)).<br/>
&nbsp;&nbsp;{<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">intros</span> &lt;-.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">by</span> <span class="id" title="var">erewrite</span> <a class="idref" href="VLSM.Lib.StreamExtras.html#stream_concat_prefix"><span class="id" title="lemma">stream_concat_prefix</span></a>;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">unfold</span> <a class="idref" href="VLSM.Lib.StreamFilters.html#stream_filter_map"><span class="id" title="definition">stream_filter_map</span></a>;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> <a class="idref" href="VLSM.Lib.StreamFilters.html#fitering_subsequence_stream_filter_map_prefix"><span class="id" title="lemma">fitering_subsequence_stream_filter_map_prefix</span></a>.<br/>
&nbsp;&nbsp;}<br/>
&nbsp;&nbsp;<span class="id" title="tactic">by</span> <span class="id" title="tactic">apply</span> <a class="idref" href="VLSM.Lib.NeList.html#list_filter_map_mbind"><span class="id" title="lemma">list_filter_map_mbind</span></a>.<br/>
<span class="id" title="keyword">Qed</span>.<br/>

<br/>
<span class="id" title="keyword">Program Definition</span> <a id="stream_concat_map_ex_prefix" class="idref" href="#stream_concat_map_ex_prefix"><span class="id" title="definition">stream_concat_map_ex_prefix</span></a><br/>
&nbsp;&nbsp;(<a id="Hinf:203" class="idref" href="#Hinf:203"><span class="id" title="binder">Hinf</span></a> : <a class="idref" href="VLSM.Lib.StreamExtras.html#InfinitelyOften"><span class="id" title="definition">InfinitelyOften</span></a> <a class="idref" href="VLSM.Lib.StreamFilters.html#sec_stream_concat_map.FNonEmpty"><span class="id" title="variable">FNonEmpty</span></a> <a class="idref" href="VLSM.Lib.StreamFilters.html#sec_stream_concat_map.s"><span class="id" title="variable">s</span></a>)<br/>
&nbsp;&nbsp;(<a id="Hfs:204" class="idref" href="#Hfs:204"><span class="id" title="binder">Hfs</span></a> := <a class="idref" href="VLSM.Lib.StreamFilters.html#stream_filter_positions_filtering_subsequence"><span class="id" title="lemma">stream_filter_positions_filtering_subsequence</span></a> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <a class="idref" href="VLSM.Lib.StreamFilters.html#Hinf:203"><span class="id" title="variable">Hinf</span></a>)<br/>
&nbsp;&nbsp;(<a id="k:205" class="idref" href="#k:205"><span class="id" title="binder">k</span></a> : <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Datatypes.html#nat"><span class="id" title="inductive">nat</span></a>)<br/>
&nbsp;&nbsp;: <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Specif.html#6556914db359db999889decec6a4a562"><span class="id" title="notation">{</span></a><a id="n:206" class="idref" href="#n:206"><span class="id" title="binder">n</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Specif.html#6556914db359db999889decec6a4a562"><span class="id" title="notation">:</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Datatypes.html#nat"><span class="id" title="inductive">nat</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Specif.html#6556914db359db999889decec6a4a562"><span class="id" title="notation">|</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="VLSM.Lib.StreamExtras.html#stream_prefix"><span class="id" title="definition">stream_prefix</span></a> (<a class="idref" href="VLSM.Lib.StreamFilters.html#stream_concat_map"><span class="id" title="definition">stream_concat_map</span></a> <a class="idref" href="VLSM.Lib.StreamFilters.html#Hinf:203"><span class="id" title="variable">Hinf</span></a>) <a class="idref" href="VLSM.Lib.StreamFilters.html#k:205"><span class="id" title="variable">k</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="notation">`</span><span class="id" title="notation">prefix_of</span><span class="id" title="notation">`</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="definition">mbind</span> <a class="idref" href="VLSM.Lib.StreamFilters.html#sec_stream_concat_map.f"><span class="id" title="variable">f</span></a> (<a class="idref" href="VLSM.Lib.StreamExtras.html#stream_prefix"><span class="id" title="definition">stream_prefix</span></a> <a class="idref" href="VLSM.Lib.StreamFilters.html#sec_stream_concat_map.s"><span class="id" title="variable">s</span></a> <a class="idref" href="VLSM.Lib.StreamFilters.html#n:206"><span class="id" title="variable">n</span></a>)<a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Specif.html#6556914db359db999889decec6a4a562"><span class="id" title="notation">}</span></a><br/>
&nbsp;&nbsp;:=<br/>
&nbsp;&nbsp;<span class="id" title="keyword">let</span> (<a id="n:207" class="idref" href="#n:207"><span class="id" title="binder">n</span></a>, <a id="Heq:208" class="idref" href="#Heq:208"><span class="id" title="binder">Heq</span></a>) :=<br/>
&nbsp;&nbsp;&nbsp;&nbsp;(<a class="idref" href="VLSM.Lib.StreamFilters.html#fitering_subsequence_stream_filter_map_prefix_ex"><span class="id" title="definition">fitering_subsequence_stream_filter_map_prefix_ex</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="VLSM.Lib.StreamFilters.html#sec_stream_concat_map.FNonEmpty"><span class="id" title="variable">FNonEmpty</span></a> (<a class="idref" href="VLSM.Lib.NeList.html#list_function_restriction"><span class="id" title="definition">list_function_restriction</span></a> <a class="idref" href="VLSM.Lib.StreamFilters.html#sec_stream_concat_map.f"><span class="id" title="variable">f</span></a>) <span class="id" title="var">_</span> <span class="id" title="var">_</span> <a class="idref" href="VLSM.Lib.StreamFilters.html#Hfs:204"><span class="id" title="variable">Hfs</span></a> <a class="idref" href="VLSM.Lib.StreamFilters.html#k:205"><span class="id" title="variable">k</span></a>)<br/>
&nbsp;&nbsp;<span class="id" title="tactic">in</span> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Specif.html#exist"><span class="id" title="constructor">exist</span></a> <span class="id" title="var">_</span> <a class="idref" href="VLSM.Lib.StreamFilters.html#n:207"><span class="id" title="variable">n</span></a> <span class="id" title="var">_</span>.<br/>
<span class="id" title="keyword">Next</span> <span class="id" title="keyword">Obligation</span>.<br/>
<span class="id" title="keyword">Proof</span>.<br/>
&nbsp;&nbsp;<span class="id" title="var">cbn</span>; <span class="id" title="tactic">intros</span> <span class="id" title="var">Hinf</span> <span class="id" title="var">k</span> <span class="id" title="var">n</span> <span class="id" title="var">Heq</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> &lt;- (<a class="idref" href="VLSM.Lib.StreamFilters.html#stream_concat_map_prefix"><span class="id" title="lemma">stream_concat_map_prefix</span></a> <span class="id" title="var">Hinf</span>).<br/>
&nbsp;&nbsp;<span class="id" title="tactic">apply</span> <a class="idref" href="VLSM.Lib.StreamExtras.html#stream_prefix_of"><span class="id" title="lemma">stream_prefix_of</span></a>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> &lt;- <a class="idref" href="VLSM.Lib.NeList.html#list_filter_map_mbind"><span class="id" title="lemma">list_filter_map_mbind</span></a>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">replace</span> <span class="id" title="var">k</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">with</span> (<a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Datatypes.html#length"><span class="id" title="definition">length</span></a> (<a class="idref" href="VLSM.Lib.ListExtras.html#list_filter_map"><span class="id" title="definition">list_filter_map</span></a> <a class="idref" href="VLSM.Lib.StreamFilters.html#sec_stream_concat_map.FNonEmpty"><span class="id" title="variable">FNonEmpty</span></a> (<a class="idref" href="VLSM.Lib.NeList.html#list_function_restriction"><span class="id" title="definition">list_function_restriction</span></a> <a class="idref" href="VLSM.Lib.StreamFilters.html#sec_stream_concat_map.f"><span class="id" title="variable">f</span></a>) (<a class="idref" href="VLSM.Lib.StreamExtras.html#stream_prefix"><span class="id" title="definition">stream_prefix</span></a> <a class="idref" href="VLSM.Lib.StreamFilters.html#sec_stream_concat_map.s"><span class="id" title="variable">s</span></a> <span class="id" title="var">n</span>)))<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">by</span> (<span class="id" title="tactic">rewrite</span> &lt;- <span class="id" title="var">Heq</span>; <span class="id" title="tactic">apply</span> <a class="idref" href="VLSM.Lib.StreamExtras.html#stream_prefix_length"><span class="id" title="lemma">stream_prefix_length</span></a>).<br/>
&nbsp;&nbsp;<span class="id" title="tactic">by</span> <span class="id" title="tactic">apply</span> <a class="idref" href="VLSM.Lib.NeList.html#ne_list_concat_min_length"><span class="id" title="lemma">ne_list_concat_min_length</span></a>.<br/>
<span class="id" title="keyword">Qed</span>.<br/>

<br/>
<span class="id" title="keyword">Program Definition</span> <a id="stream_concat_map_ex_min_prefix" class="idref" href="#stream_concat_map_ex_min_prefix"><span class="id" title="definition">stream_concat_map_ex_min_prefix</span></a><br/>
&nbsp;&nbsp;`{<a id="EqDecision0:209" class="idref" href="#EqDecision0:209"><span class="id" title="binder">EqDecision</span></a> <a id="EqDecision0:209" class="idref" href="#EqDecision0:209"><span class="id" title="binder">B</span></a>}<br/>
&nbsp;&nbsp;(<a id="Hinf:210" class="idref" href="#Hinf:210"><span class="id" title="binder">Hinf</span></a> : <a class="idref" href="VLSM.Lib.StreamExtras.html#InfinitelyOften"><span class="id" title="definition">InfinitelyOften</span></a> <a class="idref" href="VLSM.Lib.StreamFilters.html#sec_stream_concat_map.FNonEmpty"><span class="id" title="variable">FNonEmpty</span></a> <a class="idref" href="VLSM.Lib.StreamFilters.html#sec_stream_concat_map.s"><span class="id" title="variable">s</span></a>)<br/>
&nbsp;&nbsp;(<a id="k:211" class="idref" href="#k:211"><span class="id" title="binder">k</span></a> : <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Datatypes.html#nat"><span class="id" title="inductive">nat</span></a>)<br/>
&nbsp;&nbsp;(<a id="Ppre:213" class="idref" href="#Ppre:213"><span class="id" title="binder">Ppre</span></a> := <span class="id" title="keyword">fun</span> <a id="m:212" class="idref" href="#m:212"><span class="id" title="binder">m</span></a> =&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="VLSM.Lib.StreamExtras.html#stream_prefix"><span class="id" title="definition">stream_prefix</span></a> (<a class="idref" href="VLSM.Lib.StreamFilters.html#stream_concat_map"><span class="id" title="definition">stream_concat_map</span></a> <a class="idref" href="VLSM.Lib.StreamFilters.html#Hinf:210"><span class="id" title="variable">Hinf</span></a>) <a class="idref" href="VLSM.Lib.StreamFilters.html#k:211"><span class="id" title="variable">k</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="notation">`</span><span class="id" title="notation">prefix_of</span><span class="id" title="notation">`</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="definition">mbind</span> <a class="idref" href="VLSM.Lib.StreamFilters.html#sec_stream_concat_map.f"><span class="id" title="variable">f</span></a> (<a class="idref" href="VLSM.Lib.StreamExtras.html#stream_prefix"><span class="id" title="definition">stream_prefix</span></a> <a class="idref" href="VLSM.Lib.StreamFilters.html#sec_stream_concat_map.s"><span class="id" title="variable">s</span></a> <a class="idref" href="VLSM.Lib.StreamFilters.html#m:212"><span class="id" title="variable">m</span></a>))<br/>
&nbsp;&nbsp;: <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Specif.html#6556914db359db999889decec6a4a562"><span class="id" title="notation">{</span></a><a id="n:214" class="idref" href="#n:214"><span class="id" title="binder">n</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Specif.html#6556914db359db999889decec6a4a562"><span class="id" title="notation">:</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Datatypes.html#nat"><span class="id" title="inductive">nat</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Specif.html#6556914db359db999889decec6a4a562"><span class="id" title="notation">|</span></a> <a class="idref" href="VLSM.Lib.Preamble.html#minimal_among"><span class="id" title="definition">minimal_among</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Peano.html#le"><span class="id" title="inductive">le</span></a> <a class="idref" href="VLSM.Lib.StreamFilters.html#Ppre:213"><span class="id" title="variable">Ppre</span></a> <a class="idref" href="VLSM.Lib.StreamFilters.html#n:214"><span class="id" title="variable">n</span></a><a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Specif.html#6556914db359db999889decec6a4a562"><span class="id" title="notation">}</span></a><br/>
&nbsp;&nbsp;:=<br/>
&nbsp;&nbsp;<span class="id" title="keyword">let</span> (<a id="n:215" class="idref" href="#n:215"><span class="id" title="binder">n</span></a>, <a id="Hpre:216" class="idref" href="#Hpre:216"><span class="id" title="binder">Hpre</span></a>) :=  <a class="idref" href="VLSM.Lib.StreamFilters.html#stream_concat_map_ex_prefix"><span class="id" title="definition">stream_concat_map_ex_prefix</span></a> <a class="idref" href="VLSM.Lib.StreamFilters.html#Hinf:210"><span class="id" title="variable">Hinf</span></a> <a class="idref" href="VLSM.Lib.StreamFilters.html#k:211"><span class="id" title="variable">k</span></a> <span class="id" title="tactic">in</span><br/>
&nbsp;&nbsp;<a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Specif.html#exist"><span class="id" title="constructor">exist</span></a> <span class="id" title="var">_</span> (<a class="idref" href="VLSM.Lib.Preamble.html#find_least_among"><span class="id" title="definition">find_least_among</span></a> <a class="idref" href="VLSM.Lib.StreamFilters.html#Ppre:213"><span class="id" title="variable">Ppre</span></a> <a class="idref" href="VLSM.Lib.StreamFilters.html#n:215"><span class="id" title="variable">n</span></a>) <span class="id" title="var">_</span>.<br/>
<span class="id" title="keyword">Next</span> <span class="id" title="keyword">Obligation</span>.<br/>
<span class="id" title="keyword">Proof</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">by</span> <span class="id" title="tactic">intros</span>; <span class="id" title="tactic">apply</span> <a class="idref" href="VLSM.Lib.Preamble.html#find_least_among_is_minimal"><span class="id" title="lemma">find_least_among_is_minimal</span></a>.<br/>
<span class="id" title="keyword">Qed</span>.<br/>

<br/>
<span class="id" title="keyword">Definition</span> <a id="bounded_stream_concat_map" class="idref" href="#bounded_stream_concat_map"><span class="id" title="definition">bounded_stream_concat_map</span></a><br/>
&nbsp;&nbsp;(<a id="Hfin:217" class="idref" href="#Hfin:217"><span class="id" title="binder">Hfin</span></a> : <a class="idref" href="VLSM.Lib.StreamExtras.html#FinitelyManyBound"><span class="id" title="definition">FinitelyManyBound</span></a> <a class="idref" href="VLSM.Lib.StreamFilters.html#sec_stream_concat_map.FNonEmpty"><span class="id" title="variable">FNonEmpty</span></a> <a class="idref" href="VLSM.Lib.StreamFilters.html#sec_stream_concat_map.s"><span class="id" title="variable">s</span></a>)<br/>
&nbsp;&nbsp;: <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Datatypes.html#list"><span class="id" title="inductive">list</span></a> <a class="idref" href="VLSM.Lib.StreamFilters.html#sec_stream_concat_map.B"><span class="id" title="variable">B</span></a> :=<br/>
&nbsp;&nbsp;<span class="id" title="definition">mbind</span> <a class="idref" href="VLSM.Lib.StreamFilters.html#sec_stream_concat_map.f"><span class="id" title="variable">f</span></a> (<a class="idref" href="VLSM.Lib.StreamExtras.html#stream_prefix"><span class="id" title="definition">stream_prefix</span></a> <a class="idref" href="VLSM.Lib.StreamFilters.html#sec_stream_concat_map.s"><span class="id" title="variable">s</span></a> (<span class="id" title="notation">`</span> <a class="idref" href="VLSM.Lib.StreamFilters.html#Hfin:217"><span class="id" title="variable">Hfin</span></a>)).<br/>

<br/>
<span class="id" title="keyword">End</span> <a class="idref" href="VLSM.Lib.StreamFilters.html#sec_stream_concat_map"><span class="id" title="section">sec_stream_concat_map</span></a>.<br/>

<br/>
</div>

<div class="doc">
  For a totally defined function, <span class="inlinecode"><a class="idref" href="VLSM.Lib.StreamFilters.html#stream_map_option"><span class="id" title="definition">stream_map_option</span></a></span> corresponds to the
  regular <span class="inlinecode"><a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Lists.List.html#map"><span class="id" title="definition">map</span></a></span> on streams.

</div>
<div class="code">
<span class="id" title="keyword">Lemma</span> <a id="stream_map_option_EqSt" class="idref" href="#stream_map_option_EqSt"><span class="id" title="lemma">stream_map_option_EqSt</span></a> [<a id="A:218" class="idref" href="#A:218"><span class="id" title="binder">A</span></a> <a id="B:219" class="idref" href="#B:219"><span class="id" title="binder">B</span></a> : <span class="id" title="keyword">Type</span>] (<a id="f:220" class="idref" href="#f:220"><span class="id" title="binder">f</span></a> : <a class="idref" href="VLSM.Lib.StreamFilters.html#A:218"><span class="id" title="variable">A</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x"><span class="id" title="notation">-&gt;</span></a> <a class="idref" href="VLSM.Lib.StreamFilters.html#B:219"><span class="id" title="variable">B</span></a>)<br/>
&nbsp;&nbsp;: <span class="id" title="notation">forall</span> <a id="s:221" class="idref" href="#s:221"><span class="id" title="binder">s</span></a> (<a id="Hinf:222" class="idref" href="#Hinf:222"><span class="id" title="binder">Hinf</span></a> : <a class="idref" href="VLSM.Lib.StreamExtras.html#InfinitelyOften"><span class="id" title="definition">InfinitelyOften</span></a> (<span class="id" title="definition">is_Some</span> <span class="id" title="notation"></span> <span class="id" title="notation">(</span><a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Datatypes.html#Some"><span class="id" title="constructor">Some</span></a> <span class="id" title="notation"></span> <a class="idref" href="VLSM.Lib.StreamFilters.html#f:220"><span class="id" title="variable">f</span></a><span class="id" title="notation">)</span>) <a class="idref" href="VLSM.Lib.StreamFilters.html#s:221"><span class="id" title="variable">s</span></a><span class="id" title="notation">),</span><br/>
&nbsp;&nbsp;<a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Lists.Streams.html#EqSt"><span class="id" title="inductive">EqSt</span></a> (<a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Lists.Streams.html#map"><span class="id" title="definition">map</span></a> <a class="idref" href="VLSM.Lib.StreamFilters.html#f:220"><span class="id" title="variable">f</span></a> <a class="idref" href="VLSM.Lib.StreamFilters.html#s:221"><span class="id" title="variable">s</span></a>) (<a class="idref" href="VLSM.Lib.StreamFilters.html#stream_map_option"><span class="id" title="definition">stream_map_option</span></a> (<a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Datatypes.html#Some"><span class="id" title="constructor">Some</span></a> <span class="id" title="notation"></span> <a class="idref" href="VLSM.Lib.StreamFilters.html#f:220"><span class="id" title="variable">f</span></a>) <a class="idref" href="VLSM.Lib.StreamFilters.html#s:221"><span class="id" title="variable">s</span></a> <a class="idref" href="VLSM.Lib.StreamFilters.html#Hinf:222"><span class="id" title="variable">Hinf</span></a>).<br/>
<span class="id" title="keyword">Proof</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">intros</span>. <span class="id" title="tactic">apply</span> <a class="idref" href="VLSM.Lib.StreamExtras.html#EqSt_stream_prefix"><span class="id" title="lemma">EqSt_stream_prefix</span></a>. <span class="id" title="tactic">intro</span> <span class="id" title="var">n</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">destruct</span> <span class="id" title="var">n</span>; [<span class="id" title="var">done</span> |].<br/>
&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> &lt;- <a class="idref" href="VLSM.Lib.StreamExtras.html#stream_prefix_map"><span class="id" title="lemma">stream_prefix_map</span></a>.<br/>

<br/>
&nbsp;&nbsp;<span class="id" title="tactic">pose</span> (<a class="idref" href="VLSM.Lib.StreamFilters.html#stream_map_option_prefix_ex"><span class="id" title="definition">stream_map_option_prefix_ex</span></a> (<a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Datatypes.html#Some"><span class="id" title="constructor">Some</span></a> <span class="id" title="notation"></span> <span class="id" title="var">f</span>) <span class="id" title="var">s</span> <span class="id" title="var">Hinf</span> (<a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Datatypes.html#S"><span class="id" title="constructor">S</span></a> <span class="id" title="var">n</span>)) <span class="id" title="keyword">as</span> <span class="id" title="var">Hrew</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> (<a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Specif.html#proj2_sig"><span class="id" title="definition">proj2_sig</span></a> <span class="id" title="var">Hrew</span>).<br/>
&nbsp;&nbsp;<span class="id" title="tactic">replace</span> (<span class="id" title="notation">`</span> <span class="id" title="var">Hrew</span>) <span class="id" title="keyword">with</span> (<a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Datatypes.html#S"><span class="id" title="constructor">S</span></a> <span class="id" title="var">n</span>); [<span class="id" title="var">done</span> |].<br/>
&nbsp;&nbsp;<span class="id" title="tactic">simpl</span>. <span class="id" title="tactic">f_equal</span>. <span class="id" title="tactic">clear</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">cut</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id" title="notation">forall</span> <a id="k:223" class="idref" href="#k:223"><span class="id" title="binder"><span id="k:224" class="id">k</span></span></a><span class="id" title="notation">,</span> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Lists.Streams.html#Str_nth"><span class="id" title="definition">Streams.Str_nth</span></a> <span class="id" title="var">n</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<a class="idref" href="VLSM.Lib.StreamFilters.html#stream_filter_positions"><span class="id" title="definition">stream_filter_positions</span></a> (<span class="id" title="definition">is_Some</span> <span class="id" title="notation"></span> <span class="id" title="notation">(</span><a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Datatypes.html#Some"><span class="id" title="constructor">Some</span></a> <span class="id" title="notation"></span> <span class="id" title="var">f</span><span class="id" title="notation">)</span>) <span class="id" title="var">s</span> <span class="id" title="var">Hinf</span> <a class="idref" href="VLSM.Lib.StreamFilters.html#k:223"><span class="id" title="variable">k</span></a>) <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">=</span></a> <a class="idref" href="VLSM.Lib.StreamFilters.html#k:223"><span class="id" title="variable">k</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Peano.html#0dacc1786c5ba797d47dd85006231633"><span class="id" title="notation">+</span></a> <span class="id" title="var">n</span>).<br/>
&nbsp;&nbsp;{ <span class="id" title="tactic">intros</span> <span class="id" title="var">Hk</span>. <span class="id" title="tactic">specialize</span> (<span class="id" title="var">Hk</span> 0). <span class="id" title="tactic">simpl</span> <span class="id" title="tactic">in</span> <span class="id" title="var">Hk</span>. <span class="id" title="tactic">congruence</span>. }<br/>
&nbsp;&nbsp;<span class="id" title="var">revert</span> <span class="id" title="var">s</span> <span class="id" title="var">Hinf</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">assert</span> (<span class="id" title="var">Hfirst</span> : <span class="id" title="notation">forall</span> <a id="s:225" class="idref" href="#s:225"><span class="id" title="binder"><span id="s:228" class="id">s</span></span></a> <a id="Hinf:226" class="idref" href="#Hinf:226"><span class="id" title="binder"><span id="Hinf:229" class="id">Hinf</span></span></a> <a id="k:227" class="idref" href="#k:227"><span class="id" title="binder"><span id="k:230" class="id">k</span></span></a><span class="id" title="notation">,</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="notation">(</span><a class="idref" href="VLSM.Lib.StreamFilters.html#stream_filter_fst_pos"><span class="id" title="definition">stream_filter_fst_pos</span></a> (<span class="id" title="definition">is_Some</span> <span class="id" title="notation"></span> <span class="id" title="notation">(</span><a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Datatypes.html#Some"><span class="id" title="constructor">Some</span></a> <span class="id" title="notation"></span> <span class="id" title="var">f</span><span class="id" title="notation">)</span>) <a class="idref" href="VLSM.Lib.StreamFilters.html#s:225"><span class="id" title="variable">s</span></a> (<a class="idref" href="VLSM.Lib.StreamExtras.html#fHere"><span class="id" title="lemma">fHere</span></a> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <a class="idref" href="VLSM.Lib.StreamFilters.html#Hinf:226"><span class="id" title="variable">Hinf</span></a>) <a class="idref" href="VLSM.Lib.StreamFilters.html#k:227"><span class="id" title="variable">k</span></a><span class="id" title="notation">).1</span> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">=</span></a> <a class="idref" href="VLSM.Lib.StreamFilters.html#k:227"><span class="id" title="variable">k</span></a>).<br/>
&nbsp;&nbsp;{<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">intros</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">edestruct</span> <a class="idref" href="VLSM.Lib.StreamFilters.html#stream_filter_fst_pos_characterization"><span class="id" title="lemma">stream_filter_fst_pos_characterization</span></a> <span class="id" title="keyword">as</span> (<span class="id" title="var">_k</span> &amp; -&gt; &amp; <span class="id" title="var">_</span> &amp; <span class="id" title="var">H_k</span>); <span class="id" title="var">cbn</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">destruct</span> <span class="id" title="var">_k</span>; [<span class="id" title="var">lia</span> |].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">by</span> <span class="id" title="var">exfalso</span>; <span class="id" title="tactic">apply</span> (<span class="id" title="var">H_k</span> 0); [<span class="id" title="var">lia</span> | <span class="id" title="tactic">eexists</span>].<br/>
&nbsp;&nbsp;}<br/>
&nbsp;&nbsp;<span class="id" title="tactic">induction</span> <span class="id" title="var">n</span>; <span class="id" title="tactic">intros</span>; <span class="id" title="tactic">rewrite</span> <a class="idref" href="VLSM.Lib.StreamFilters.html#stream_filter_positions_unroll"><span class="id" title="lemma">stream_filter_positions_unroll</span></a>; <span class="id" title="tactic">unfold</span> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Lists.Streams.html#Str_nth"><span class="id" title="definition">Streams.Str_nth</span></a>; <span class="id" title="tactic">simpl</span>.<br/>
&nbsp;&nbsp;- <span class="id" title="tactic">by</span> <span class="id" title="tactic">rewrite</span> <span class="id" title="var">Hfirst</span>; <span class="id" title="var">lia</span>.<br/>
&nbsp;&nbsp;- <span class="id" title="tactic">unfold</span> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Lists.Streams.html#Str_nth"><span class="id" title="definition">Streams.Str_nth</span></a> <span class="id" title="tactic">in</span> <span class="id" title="var">IHn</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">by</span> <span class="id" title="tactic">rewrite</span> <span class="id" title="var">IHn</span>, <span class="id" title="var">Hfirst</span>; <span class="id" title="var">lia</span>.<br/>
<span class="id" title="keyword">Qed</span>.<br/>
</div>
</div>
<div id="footer">
  Generated by <a href="http://coq.inria.fr">coqdoc</a> and improved with <a href="https://github.com/palmskog/coqdocjs">CoqdocJS</a> as adapted for <a href="https://github.com/coq-community">coq-community</a>
</div>
</div>
</body>

</html>
