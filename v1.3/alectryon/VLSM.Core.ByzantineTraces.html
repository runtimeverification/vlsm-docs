<!DOCTYPE html>
<html class="alectryon-standalone"><head><title>ByzantineTraces.v</title><meta charset="utf-8"><meta content="Alectryon" name="generator"><meta name="viewport" content="width=device-width, initial-scale=1"><link href="alectryon.css" rel="stylesheet"><link href="pygments.css" rel="stylesheet">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/IBM-type/0.5.4/css/ibm-type.min.css" integrity="sha512-sky5cf9Ts6FY1kstGOBHSybfKqdHR41M0Ldb0BjNiv3ifltoQIsg0zIaQ+wwdwgQ0w9vKFW7Js50lxH9vqNSSw==" crossorigin="anonymous" />
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/firacode/5.2.0/fira_code.min.css" integrity="sha512-MbysAYimH1hH2xYzkkMHB6MqxBqfP0megxsCLknbYqHVwXTCg9IqHbk+ZP/vnhO8UEW6PaXAkKe2vQ+SWACxxA==" crossorigin="anonymous" /><script src="alectryon.js"></script></head><body><article class="alectryon-root alectryon-windowed alectryon-coqdoc"><div class="alectryon-banner">Built with <a href="https://github.com/cpitclaudel/alectryon/">Alectryon</a>, running Coq+SerAPI v8.18.0+0.18.1. Bubbles (<span class="alectryon-bubble"></span>) indicate interactive fragments: hover for details, tap to reveal contents. Use <kbd>Ctrl+‚Üë</kbd> <kbd>Ctrl+‚Üì</kbd> to navigate, <kbd>Ctrl+üñ±Ô∏è</kbd> to focus. On Mac, use <kbd>‚åò</kbd> instead of <kbd>Ctrl</kbd>.</div><pre class="alectryon-io highlight"><!-- Generator: Alectryon --><span class="alectryon-sentence"><input class="alectryon-toggle" id="ByzantineTraces-v-chk0" style="display: none" type="checkbox"><label class="alectryon-input" for="ByzantineTraces-v-chk0"><span class="kn">From</span> stdpp <span class="kn">Require Import</span> prelude.</label><small class="alectryon-output"><div><div class="alectryon-messages"><blockquote class="alectryon-message">[Loading ML file ring_plugin.cmxs (<span class="nb">using</span> legacy method) ... <span class="bp">done</span>]</blockquote><blockquote class="alectryon-message">[Loading ML file zify_plugin.cmxs (<span class="nb">using</span> legacy method) ... <span class="bp">done</span>]</blockquote><blockquote class="alectryon-message">[Loading ML file micromega_plugin.cmxs (<span class="nb">using</span> legacy method) ... <span class="bp">done</span>]</blockquote><blockquote class="alectryon-message">[Loading ML file btauto_plugin.cmxs (<span class="nb">using</span> legacy method) ... <span class="bp">done</span>]</blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">From</span> VLSM.Lib <span class="kn">Require Import</span> Preamble.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="ByzantineTraces-v-chk1" style="display: none" type="checkbox"><label class="alectryon-input" for="ByzantineTraces-v-chk1"><span class="kn">From</span> VLSM.Core <span class="kn">Require Import</span> VLSM VLSMProjections Composition ProjectionTraces Validator.</label><small class="alectryon-output"><div><div class="alectryon-messages"><blockquote class="alectryon-message">[Loading ML file coq-itauto.plugin ... <span class="bp">done</span>]</blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">From</span> VLSM.Core <span class="kn">Require Import</span> PreloadedVLSM.</span></span></pre><div class="doc">
<a id="lab1"></a><h1 class="section">Core: VLSM Byzantine Traces</h1>
<div class="paragraph"> </div>

  In this section, we introduce two definitions of Byzantine traces,
  prove that they are equivalent (lemma <span class="inlinecode"><span class="id" title="var">byzantine_alt_byzantine_iff</span></span>),
  and then prove that both definitions are equivalent with the definition
  of a valid trace in the corresponding preloaded VLSM
  (lemmas <span class="inlinecode"><span class="id" title="var">byzantine_preloaded_with_all_messages</span></span> and
  <span class="inlinecode"><span class="id" title="var">preloaded_with_all_messages_alt_eq</span></span>).

<div class="paragraph"> </div>

  Note that, contrary to what one might think, the byzantine trace property
  does not only capture traces exhibiting byzantine behavior, but also all
  valid traces (consequence of lemma <span class="inlinecode"><span class="id" title="var">vlsm_incl_preloaded_with_all_messages_vlsm</span></span>).
  Therefore to avoid confusion we will call <i>proper byzantine traces</i>,
  or <i>traces exhibiting byzantine behavior</i> the collection of traces with
  the byzantine trace property but without the valid trace property.

<div class="paragraph"> </div>

  In the remainder of this section, we fix a VLSM <code>M</code>.

</div><pre class="alectryon-io highlight"><!-- Generator: Alectryon --></pre><div class="doc">
<a id="lab2"></a><h2 class="section">Definition and basic properties</h2>
</div><pre class="alectryon-io highlight"><!-- Generator: Alectryon --><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Section</span> <span class="nf">sec_byzantine_traces</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
</span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Context</span>
  {<span class="nv">message</span> : <span class="kt">Type</span>}
  (<span class="nv">M</span> : VLSM message)
  .</span></span></pre><div class="doc">
  The first definition says that a trace has the byzantine trace property
  if it is the projection of a trace which can be obtained by freely composing
  <code>M</code> with an arbitrary VLSM <code>M'</code> (over the same set of messages).

<div class="paragraph"> </div>

  Below, <span class="inlinecode"><span class="id" title="var">binary_free_composition_fst</span></span> represents the projection of
  the free composition of <code>M</code> and <code>M'</code> to the component corresponding
  to <code>M</code>.

</div><pre class="alectryon-io highlight"><!-- Generator: Alectryon --><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Definition</span> <span class="nf">byzantine_trace_prop</span> (<span class="nv">tr</span> : Trace M) : <span class="kt">Prop</span> :=
  <span class="kr">exists</span> (<span class="nv">M&#39;</span> : VLSM message),
    valid_trace_prop (binary_free_composition_fst M M&#39;) tr.</span></span></pre><div class="doc">
  The first result says that all traces with the byzantine trace property
  for a VLSM <code>M</code> are traces of the <span class="inlinecode"><span class="id" title="var">preloaded_with_all_messages_vlsm</span></span>
  associated to <code>M</code>.

</div><pre class="alectryon-io highlight"><!-- Generator: Alectryon --><span class="alectryon-sentence"><input class="alectryon-toggle" id="ByzantineTraces-v-chk2" style="display: none" type="checkbox"><label class="alectryon-input" for="ByzantineTraces-v-chk2"><span class="kn">Lemma</span> <span class="nf">byzantine_preloaded_with_all_messages</span> :
  <span class="kr">forall</span> (<span class="nv">tr</span> : Trace M),
    byzantine_trace_prop tr -&gt;
    constrained_trace_prop M tr.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>message</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>M</var><span class="hyp-type"><b>: </b><span>VLSM message</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="kr">‚àÄ</span> <span class="nv">tr</span> : Trace,
  byzantine_trace_prop tr
  ‚Üí constrained_trace_prop M tr</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="ByzantineTraces-v-chk3" style="display: none" type="checkbox"><label class="alectryon-input" for="ByzantineTraces-v-chk3"><span class="kn">Proof</span>.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>message</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>M</var><span class="hyp-type"><b>: </b><span>VLSM message</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="kr">‚àÄ</span> <span class="nv">tr</span> : Trace,
  byzantine_trace_prop tr
  ‚Üí constrained_trace_prop M tr</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="ByzantineTraces-v-chk4" style="display: none" type="checkbox"><label class="alectryon-input" for="ByzantineTraces-v-chk4"><span class="nb">intros</span> tr [M&#39; Htr]; <span class="nb">cbn</span> <span class="kr">in</span> Htr.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>message</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>M</var><span class="hyp-type"><b>: </b><span>VLSM message</span></span></span><br><span><var>tr</var><span class="hyp-type"><b>: </b><span>Trace</span></span></span><br><span><var>M'</var><span class="hyp-type"><b>: </b><span>VLSM message</span></span></span><br><span><var>Htr</var><span class="hyp-type"><b>: </b><span>valid_trace_prop
  (binary_free_composition_fst M M&#39;) tr</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">constrained_trace_prop M tr</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><span class="alectryon-input"><span class="bp">by</span> <span class="nb">apply</span> proj_preloaded_with_all_messages_incl <span class="kr">in</span> Htr.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Qed</span>.</span></span></pre><div class="doc">
<a id="lab3"></a><h2 class="section">An alternative definition</h2>
<div class="paragraph"> </div>

  The alternative definition of byzantine trace property relies on the
  composition of the VLSM with a special VLSM which can produce all messages.

<div class="paragraph"> </div>

  We will define its type (<span class="inlinecode"><span class="id" title="var">emit_any_message_vlsm_type</span></span>) and the VLSM itself
  (<span class="inlinecode"><span class="id" title="var">emit_any_message_vlsm</span></span>) below.

<div class="paragraph"> </div>

  The labels of <span class="inlinecode"><span class="id" title="var">emit_any_message_vlsm</span></span> are its messages and there is a single
  state.

</div><pre class="alectryon-io highlight"><!-- Generator: Alectryon --><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Definition</span> <span class="nf">emit_any_message_vlsm_type</span> : VLSMType message :=
{|
  label := message;
  state := unit;
|}.</span></span></pre><div class="doc">
  To define the VLSM, we need to prove that the type of states is inhabited,
  since we need an initial state.

</div><pre class="alectryon-io highlight"><!-- Generator: Alectryon --><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Program Definition</span> <span class="nf">emit_any_message_vlsm_s0</span> : {_ : state emit_any_message_vlsm_type | <span class="kt">True</span>} :=
  exist _ tt _.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="ByzantineTraces-v-chk5" style="display: none" type="checkbox"><label class="alectryon-input" for="ByzantineTraces-v-chk5"><span class="kn">Next Obligation</span>.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>message</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>M</var><span class="hyp-type"><b>: </b><span>VLSM message</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">(<span class="kr">Œª</span> <span class="nv">_</span> : state emit_any_message_vlsm_type, <span class="kt">True</span>) ()</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="ByzantineTraces-v-chk6" style="display: none" type="checkbox"><label class="alectryon-input" for="ByzantineTraces-v-chk6"><span class="kn">Proof</span>.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>message</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>M</var><span class="hyp-type"><b>: </b><span>VLSM message</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">(<span class="kr">Œª</span> <span class="nv">_</span> : state emit_any_message_vlsm_type, <span class="kt">True</span>) ()</div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="bp">done</span>.</span><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Defined</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
</span><span class="alectryon-sentence"><span class="alectryon-input">#[export] <span class="kn">Instance</span> <span class="nf">emit_any_message_vlsm_state_inh</span> :
  Inhabited {_ : state emit_any_message_vlsm_type | <span class="kt">True</span>} :=
    populate emit_any_message_vlsm_s0.</span></span></pre><div class="doc">
  The definition of <span class="inlinecode"><span class="id" title="var">emit_any_message_vlsm_machine</span></span> says that:
<ul class="doclist">
<li> all states are initial

</li>
<li> no messages are initial

</li>
<li> the single state is the initial state

</li>
<li> the <span class="inlinecode"><span class="id" title="var">transition</span></span> function generates the message given as the label

</li>
<li> all transitions are valid

</li>
</ul>
</div><pre class="alectryon-io highlight"><!-- Generator: Alectryon --><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Definition</span> <span class="nf">emit_any_message_vlsm_machine</span> : VLSMMachine emit_any_message_vlsm_type :=
{|
  initial_state_prop := <span class="kr">fun</span> <span class="nv">_</span> =&gt; <span class="kt">True</span>;
  initial_message_prop := <span class="kr">fun</span> <span class="nv">_</span> =&gt; <span class="kt">False</span>;
  s0 := emit_any_message_vlsm_state_inh;
  transition := <span class="kr">fun</span> <span class="nv">l</span> <span class="nv">_</span> =&gt; (tt, Some l);
  valid := <span class="kr">fun</span> <span class="nv">_</span> <span class="nv">_</span> =&gt; <span class="kt">True</span>;
|}.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
</span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Definition</span> <span class="nf">emit_any_message_vlsm</span> : VLSM message :=
  mk_vlsm emit_any_message_vlsm_machine.</span></span></pre><div class="doc">
  Using the VLSM defined above, we can define the alternative byzantine
  trace property of a trace <code>tr</code> for the VLSM <code>M</code> as being a trace
  in the projection of the free composition between <code>M</code> and the
  <span class="inlinecode"><span class="id" title="var">emit_any_message_vlsm</span></span>, to the component corresponding to <code>M</code>.

</div><pre class="alectryon-io highlight"><!-- Generator: Alectryon --><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Definition</span> <span class="nf">alternate_byzantine_trace_prop</span> (<span class="nv">tr</span> : Trace M) : <span class="kt">Prop</span> :=
  valid_trace_prop (binary_free_composition_fst M emit_any_message_vlsm) tr.</span></span></pre><div class="doc">
  Since the byzantine trace property was referring to the free composition
  with any other VLSM, we can instantiate that definition to the
  <span class="inlinecode"><span class="id" title="var">emit_any_message_vlsm</span></span> to derive that a trace with the
  alternative byzantine trace property also has the byzantine trace property.

</div><pre class="alectryon-io highlight"><!-- Generator: Alectryon --><span class="alectryon-sentence"><input class="alectryon-toggle" id="ByzantineTraces-v-chk7" style="display: none" type="checkbox"><label class="alectryon-input" for="ByzantineTraces-v-chk7"><span class="kn">Lemma</span> <span class="nf">byzantine_alt_byzantine</span> :
  <span class="kr">forall</span> (<span class="nv">tr</span> : Trace M),
    alternate_byzantine_trace_prop tr -&gt;
    byzantine_trace_prop tr.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>message</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>M</var><span class="hyp-type"><b>: </b><span>VLSM message</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="kr">‚àÄ</span> <span class="nv">tr</span> : Trace,
  alternate_byzantine_trace_prop tr
  ‚Üí byzantine_trace_prop tr</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="ByzantineTraces-v-chk8" style="display: none" type="checkbox"><label class="alectryon-input" for="ByzantineTraces-v-chk8"><span class="kn">Proof</span>.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>message</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>M</var><span class="hyp-type"><b>: </b><span>VLSM message</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="kr">‚àÄ</span> <span class="nv">tr</span> : Trace,
  alternate_byzantine_trace_prop tr
  ‚Üí byzantine_trace_prop tr</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><span class="alectryon-input"><span class="bp">by</span> <span class="kr">exists</span> <span class="nv">emit_any_message_vlsm</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Qed</span>.</span></span></pre><div class="doc">
<a id="lab4"></a><h2 class="section">Equivalence between the two Byzantine trace definitions</h2>
<div class="paragraph"> </div>

  In this section we prove that the <span class="inlinecode"><span class="id" title="var">alternate_byzantine_trace_prop</span></span> is
  equivalent to <span class="inlinecode"><span class="id" title="var">byzantine_trace_prop</span></span>.

<div class="paragraph"> </div>

  Since we have already proven that <span class="inlinecode"><span class="id" title="var">alternate_byzantine_trace_prop</span></span>
  implies <span class="inlinecode"><span class="id" title="var">byzantine_trace_prop</span></span> (lemma <span class="inlinecode"><span class="id" title="var">byzantine_alt_byzantine</span></span>),
  and since we know that the traces satisfying <span class="inlinecode"><span class="id" title="var">byzantine_trace_prop</span></span>
  are valid traces for the <span class="inlinecode"><span class="id" title="var">preloaded_with_all_messages_vlsm</span></span>, to
  prove the equivalence it is enough to close the circle by proving the
  VLSM inclusion between the <span class="inlinecode"><span class="id" title="var">preloaded_with_all_messages_vlsm</span></span> and the
  projection VLSM used to define <span class="inlinecode"><span class="id" title="var">alternate_byzantine_trace_prop</span></span>.

</div><pre class="alectryon-io highlight"><!-- Generator: Alectryon --><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Section</span> <span class="nf">sec_preloaded_with_all_messages_byzantine_alt</span>.</span></span></pre><div class="doc">
  Let <code>Alt</code> denote the free composition of <code>M</code> with the <span class="inlinecode"><span class="id" title="var">emit_any_message_vlsm</span></span>,
  and let <code>Alt1</code> denote the projection of <code>Alt</code> to the component of <code>M</code>.

</div><pre class="alectryon-io highlight"><!-- Generator: Alectryon --><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Context</span>
  (<span class="nv">Alt1</span> := binary_free_composition_fst M emit_any_message_vlsm)
  (<span class="nv">Alt</span> := binary_free_composition M emit_any_message_vlsm)
  .</span></span></pre><div class="doc">
  First, note that using the results above it is easy to prove the inclusion
  of <code>Alt1</code> into <code>Preloaded</code>.

</div><pre class="alectryon-io highlight"><!-- Generator: Alectryon --><span class="alectryon-sentence"><input class="alectryon-toggle" id="ByzantineTraces-v-chk9" style="display: none" type="checkbox"><label class="alectryon-input" for="ByzantineTraces-v-chk9"><span class="kn">Lemma</span> <span class="nf">alt_preloaded_with_all_messages_incl</span> :
  VLSM_incl Alt1 (preloaded_with_all_messages_vlsm M).</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>message</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>M</var><span class="hyp-type"><b>: </b><span>VLSM message</span></span></span><br><span><var>Alt1</var><span><span class="hyp-body"><b>:= </b><span>binary_free_composition_fst M
  emit_any_message_vlsm</span></span><span class="hyp-type"><b>: </b><span>VLSM message</span></span></span></span><br><span><var>Alt</var><span><span class="hyp-body"><b>:= </b><span>binary_free_composition M emit_any_message_vlsm</span></span><span class="hyp-type"><b>: </b><span>VLSM message</span></span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">VLSM_incl Alt1 (preloaded_with_all_messages_vlsm M)</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="ByzantineTraces-v-chka" style="display: none" type="checkbox"><label class="alectryon-input" for="ByzantineTraces-v-chka"><span class="kn">Proof</span>.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>message</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>M</var><span class="hyp-type"><b>: </b><span>VLSM message</span></span></span><br><span><var>Alt1</var><span><span class="hyp-body"><b>:= </b><span>binary_free_composition_fst M
  emit_any_message_vlsm</span></span><span class="hyp-type"><b>: </b><span>VLSM message</span></span></span></span><br><span><var>Alt</var><span><span class="hyp-body"><b>:= </b><span>binary_free_composition M emit_any_message_vlsm</span></span><span class="hyp-type"><b>: </b><span>VLSM message</span></span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">VLSM_incl Alt1 (preloaded_with_all_messages_vlsm M)</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><span class="alectryon-input"><span class="bp">by</span> <span class="nb">intros</span> t Hvt; <span class="nb">apply</span> byzantine_preloaded_with_all_messages, byzantine_alt_byzantine.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Qed</span>.</span></span></pre><div class="doc">
  To prove the reverse inclusion (between preloaded <code>M</code> and <code>Alt1</code>) we will use the
  <span class="inlinecode"><span class="id" title="var">basic_VLSM_incl</span></span> meta-result about proving inclusions between
  VLSMs which states that:

<div class="paragraph"> </div>
<ul class="doclist">
<li> if all valid messages in the first are valid messages in the second, and

</li>
<li> if all valid states in the first are also valid states in the second, and

</li>
<li> if all <span class="inlinecode"><span class="id" title="var">input_valid_transition</span></span>s in the first are also
    <span class="inlinecode"><span class="id" title="var">input_valid_transition</span></span>s in the second, then

</li>
<li> the first VLSM is included in the second.

</li>
</ul>
<div class="paragraph"> </div>

  First note that <i>all</i> messages are valid for <code>Alt</code>, as
  <span class="inlinecode"><span class="id" title="var">emit_any_message_vlsm</span></span> can generate any message without changing state.

</div><pre class="alectryon-io highlight"><!-- Generator: Alectryon --><span class="alectryon-sentence"><input class="alectryon-toggle" id="ByzantineTraces-v-chkb" style="display: none" type="checkbox"><label class="alectryon-input" for="ByzantineTraces-v-chkb"><span class="kn">Lemma</span> <span class="nf">alt_option_valid_message</span> :
  <span class="kr">forall</span> (<span class="nv">om</span> : option message),
    option_valid_message_prop Alt om.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>message</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>M</var><span class="hyp-type"><b>: </b><span>VLSM message</span></span></span><br><span><var>Alt1</var><span><span class="hyp-body"><b>:= </b><span>binary_free_composition_fst M
  emit_any_message_vlsm</span></span><span class="hyp-type"><b>: </b><span>VLSM message</span></span></span></span><br><span><var>Alt</var><span><span class="hyp-body"><b>:= </b><span>binary_free_composition M emit_any_message_vlsm</span></span><span class="hyp-type"><b>: </b><span>VLSM message</span></span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="kr">‚àÄ</span> <span class="nv">om</span> : option message,
  option_valid_message_prop Alt om</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="ByzantineTraces-v-chkc" style="display: none" type="checkbox"><label class="alectryon-input" for="ByzantineTraces-v-chkc"><span class="kn">Proof</span>.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>message</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>M</var><span class="hyp-type"><b>: </b><span>VLSM message</span></span></span><br><span><var>Alt1</var><span><span class="hyp-body"><b>:= </b><span>binary_free_composition_fst M
  emit_any_message_vlsm</span></span><span class="hyp-type"><b>: </b><span>VLSM message</span></span></span></span><br><span><var>Alt</var><span><span class="hyp-body"><b>:= </b><span>binary_free_composition M emit_any_message_vlsm</span></span><span class="hyp-type"><b>: </b><span>VLSM message</span></span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="kr">‚àÄ</span> <span class="nv">om</span> : option message,
  option_valid_message_prop Alt om</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="ByzantineTraces-v-chkd" style="display: none" type="checkbox"><label class="alectryon-input" for="ByzantineTraces-v-chkd"><span class="nb">intros</span> [m |]; [| <span class="bp">by</span> <span class="nb">apply</span> option_valid_message_None].</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>message</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>M</var><span class="hyp-type"><b>: </b><span>VLSM message</span></span></span><br><span><var>Alt1</var><span><span class="hyp-body"><b>:= </b><span>binary_free_composition_fst M
  emit_any_message_vlsm</span></span><span class="hyp-type"><b>: </b><span>VLSM message</span></span></span></span><br><span><var>Alt</var><span><span class="hyp-body"><b>:= </b><span>binary_free_composition M emit_any_message_vlsm</span></span><span class="hyp-type"><b>: </b><span>VLSM message</span></span></span></span><br><span><var>m</var><span class="hyp-type"><b>: </b><span>message</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">option_valid_message_prop Alt (Some m)</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="ByzantineTraces-v-chke" style="display: none" type="checkbox"><label class="alectryon-input" for="ByzantineTraces-v-chke"><span class="nb">pose</span> (s := ``(vs0 Alt)).</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>message</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>M</var><span class="hyp-type"><b>: </b><span>VLSM message</span></span></span><br><span><var>Alt1</var><span><span class="hyp-body"><b>:= </b><span>binary_free_composition_fst M
  emit_any_message_vlsm</span></span><span class="hyp-type"><b>: </b><span>VLSM message</span></span></span></span><br><span><var>Alt</var><span><span class="hyp-body"><b>:= </b><span>binary_free_composition M emit_any_message_vlsm</span></span><span class="hyp-type"><b>: </b><span>VLSM message</span></span></span></span><br><span><var>m</var><span class="hyp-type"><b>: </b><span>message</span></span></span><br><span><var>s</var><span><span class="hyp-body"><b>:= </b><span>`(vs0 Alt)</span></span><span class="hyp-type"><b>: </b><span>state Alt</span></span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">option_valid_message_prop Alt (Some m)</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="ByzantineTraces-v-chkf" style="display: none" type="checkbox"><label class="alectryon-input" for="ByzantineTraces-v-chkf"><span class="kr">exists</span> <span class="nv">s</span>.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>message</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>M</var><span class="hyp-type"><b>: </b><span>VLSM message</span></span></span><br><span><var>Alt1</var><span><span class="hyp-body"><b>:= </b><span>binary_free_composition_fst M
  emit_any_message_vlsm</span></span><span class="hyp-type"><b>: </b><span>VLSM message</span></span></span></span><br><span><var>Alt</var><span><span class="hyp-body"><b>:= </b><span>binary_free_composition M emit_any_message_vlsm</span></span><span class="hyp-type"><b>: </b><span>VLSM message</span></span></span></span><br><span><var>m</var><span class="hyp-type"><b>: </b><span>message</span></span></span><br><span><var>s</var><span><span class="hyp-body"><b>:= </b><span>`(vs0 Alt)</span></span><span class="hyp-type"><b>: </b><span>state Alt</span></span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">valid_state_message_prop Alt s (Some m)</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="ByzantineTraces-v-chk10" style="display: none" type="checkbox"><label class="alectryon-input" for="ByzantineTraces-v-chk10"><span class="nb">eapply</span> (valid_generated_state_message Alt)
    <span class="kr">with</span> s None s None (existT second _);
    [<span class="bp">by</span> <span class="nb">apply</span> valid_initial_state, proj2_sig.. | <span class="bp">by</span> <span class="nb">split</span> |].</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>message</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>M</var><span class="hyp-type"><b>: </b><span>VLSM message</span></span></span><br><span><var>Alt1</var><span><span class="hyp-body"><b>:= </b><span>binary_free_composition_fst M
  emit_any_message_vlsm</span></span><span class="hyp-type"><b>: </b><span>VLSM message</span></span></span></span><br><span><var>Alt</var><span><span class="hyp-body"><b>:= </b><span>binary_free_composition M emit_any_message_vlsm</span></span><span class="hyp-type"><b>: </b><span>VLSM message</span></span></span></span><br><span><var>m</var><span class="hyp-type"><b>: </b><span>message</span></span></span><br><span><var>s</var><span><span class="hyp-body"><b>:= </b><span>`(vs0 Alt)</span></span><span class="hyp-type"><b>: </b><span>state Alt</span></span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">transition (existT second <span class="nl">?Goal</span>) (s, None) =
(s, Some m)</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><span class="alectryon-input"><span class="bp">by</span> <span class="nb">cbn</span>; state_update_simpl.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Qed</span>.</span></span></pre><div class="doc">
In the projection, all messages are valid. 
</div><pre class="alectryon-io highlight"><!-- Generator: Alectryon --><span class="alectryon-sentence"><input class="alectryon-toggle" id="ByzantineTraces-v-chk11" style="display: none" type="checkbox"><label class="alectryon-input" for="ByzantineTraces-v-chk11"><span class="kn">Lemma</span> <span class="nf">alt_proj_option_valid_message</span> :
  <span class="kr">forall</span> (<span class="nv">m</span> : option message),
    option_valid_message_prop Alt1 m.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>message</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>M</var><span class="hyp-type"><b>: </b><span>VLSM message</span></span></span><br><span><var>Alt1</var><span><span class="hyp-body"><b>:= </b><span>binary_free_composition_fst M
  emit_any_message_vlsm</span></span><span class="hyp-type"><b>: </b><span>VLSM message</span></span></span></span><br><span><var>Alt</var><span><span class="hyp-body"><b>:= </b><span>binary_free_composition M emit_any_message_vlsm</span></span><span class="hyp-type"><b>: </b><span>VLSM message</span></span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="kr">‚àÄ</span> <span class="nv">m</span> : option message, option_valid_message_prop Alt1 m</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="ByzantineTraces-v-chk12" style="display: none" type="checkbox"><label class="alectryon-input" for="ByzantineTraces-v-chk12"><span class="kn">Proof</span>.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>message</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>M</var><span class="hyp-type"><b>: </b><span>VLSM message</span></span></span><br><span><var>Alt1</var><span><span class="hyp-body"><b>:= </b><span>binary_free_composition_fst M
  emit_any_message_vlsm</span></span><span class="hyp-type"><b>: </b><span>VLSM message</span></span></span></span><br><span><var>Alt</var><span><span class="hyp-body"><b>:= </b><span>binary_free_composition M emit_any_message_vlsm</span></span><span class="hyp-type"><b>: </b><span>VLSM message</span></span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="kr">‚àÄ</span> <span class="nv">m</span> : option message, option_valid_message_prop Alt1 m</div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="bp">by</span> <span class="nb">apply</span> any_message_is_valid_in_preloaded.</span><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Qed</span>.</span></span></pre><div class="doc">
  Next we define the "lifting" of a state <code>s</code> from <code>M</code> to <code>Alt</code>,
  by simply setting to <code>s</code> the  corresponding component of the initial
  (composite) state <code>s0</code> of <code>Alt</code>.

</div><pre class="alectryon-io highlight"><!-- Generator: Alectryon --><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Definition</span> <span class="nf">lifted_alt_state</span> (<span class="nv">s</span> : state M) : state Alt :=
  lift_to_composite_state&#39; (binary_IM M emit_any_message_vlsm) <span class="kp">first</span> s.</span></span></pre><div class="doc">
Lifting a constrained state of <code>M</code> we obtain a valid state of <code>Alt</code>. 
</div><pre class="alectryon-io highlight"><!-- Generator: Alectryon --><span class="alectryon-sentence"><input class="alectryon-toggle" id="ByzantineTraces-v-chk13" style="display: none" type="checkbox"><label class="alectryon-input" for="ByzantineTraces-v-chk13"><span class="kn">Lemma</span> <span class="nf">preloaded_alt_valid_state</span> :
  <span class="kr">forall</span> (<span class="nv">sj</span> : state M) (<span class="nv">om</span> : option message),
    constrained_state_message_prop M sj om -&gt;
    valid_state_prop Alt (lifted_alt_state sj).</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>message</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>M</var><span class="hyp-type"><b>: </b><span>VLSM message</span></span></span><br><span><var>Alt1</var><span><span class="hyp-body"><b>:= </b><span>binary_free_composition_fst M
  emit_any_message_vlsm</span></span><span class="hyp-type"><b>: </b><span>VLSM message</span></span></span></span><br><span><var>Alt</var><span><span class="hyp-body"><b>:= </b><span>binary_free_composition M emit_any_message_vlsm</span></span><span class="hyp-type"><b>: </b><span>VLSM message</span></span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="kr">‚àÄ</span> (<span class="nv">sj</span> : state M) (<span class="nv">om</span> : option message),
  constrained_state_message_prop M sj om
  ‚Üí valid_state_prop Alt (lifted_alt_state sj)</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="ByzantineTraces-v-chk14" style="display: none" type="checkbox"><label class="alectryon-input" for="ByzantineTraces-v-chk14"><span class="kn">Proof</span>.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>message</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>M</var><span class="hyp-type"><b>: </b><span>VLSM message</span></span></span><br><span><var>Alt1</var><span><span class="hyp-body"><b>:= </b><span>binary_free_composition_fst M
  emit_any_message_vlsm</span></span><span class="hyp-type"><b>: </b><span>VLSM message</span></span></span></span><br><span><var>Alt</var><span><span class="hyp-body"><b>:= </b><span>binary_free_composition M emit_any_message_vlsm</span></span><span class="hyp-type"><b>: </b><span>VLSM message</span></span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="kr">‚àÄ</span> (<span class="nv">sj</span> : state M) (<span class="nv">om</span> : option message),
  constrained_state_message_prop M sj om
  ‚Üí valid_state_prop Alt (lifted_alt_state sj)</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="ByzantineTraces-v-chk15" style="display: none" type="checkbox"><label class="alectryon-input" for="ByzantineTraces-v-chk15"><span class="nb">intros</span> sj om Hp.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>message</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>M</var><span class="hyp-type"><b>: </b><span>VLSM message</span></span></span><br><span><var>Alt1</var><span><span class="hyp-body"><b>:= </b><span>binary_free_composition_fst M
  emit_any_message_vlsm</span></span><span class="hyp-type"><b>: </b><span>VLSM message</span></span></span></span><br><span><var>Alt</var><span><span class="hyp-body"><b>:= </b><span>binary_free_composition M emit_any_message_vlsm</span></span><span class="hyp-type"><b>: </b><span>VLSM message</span></span></span></span><br><span><var>sj</var><span class="hyp-type"><b>: </b><span>state M</span></span></span><br><span><var>om</var><span class="hyp-type"><b>: </b><span>option message</span></span></span><br><span><var>Hp</var><span class="hyp-type"><b>: </b><span>constrained_state_message_prop M sj om</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">valid_state_prop Alt (lifted_alt_state sj)</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="ByzantineTraces-v-chk16" style="display: none" type="checkbox"><label class="alectryon-input" for="ByzantineTraces-v-chk16"><span class="nb">assert</span> (Hsj : constrained_state_prop M sj)
    <span class="bp">by</span> (<span class="kr">exists</span> <span class="nv">om</span>; <span class="bp">done</span>); <span class="nb">clear</span> Hp.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>message</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>M</var><span class="hyp-type"><b>: </b><span>VLSM message</span></span></span><br><span><var>Alt1</var><span><span class="hyp-body"><b>:= </b><span>binary_free_composition_fst M
  emit_any_message_vlsm</span></span><span class="hyp-type"><b>: </b><span>VLSM message</span></span></span></span><br><span><var>Alt</var><span><span class="hyp-body"><b>:= </b><span>binary_free_composition M emit_any_message_vlsm</span></span><span class="hyp-type"><b>: </b><span>VLSM message</span></span></span></span><br><span><var>sj</var><span class="hyp-type"><b>: </b><span>state M</span></span></span><br><span><var>om</var><span class="hyp-type"><b>: </b><span>option message</span></span></span><br><span><var>Hsj</var><span class="hyp-type"><b>: </b><span>constrained_state_prop M sj</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">valid_state_prop Alt (lifted_alt_state sj)</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="ByzantineTraces-v-chk17" style="display: none" type="checkbox"><label class="alectryon-input" for="ByzantineTraces-v-chk17"><span class="nb">induction</span> Hsj <span class="nb">using</span> valid_state_prop_ind;
    [<span class="bp">by</span> <span class="nb">apply</span> initial_state_is_valid; <span class="nb">intros</span> [] |].</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>message</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>M</var><span class="hyp-type"><b>: </b><span>VLSM message</span></span></span><br><span><var>Alt1</var><span><span class="hyp-body"><b>:= </b><span>binary_free_composition_fst M
  emit_any_message_vlsm</span></span><span class="hyp-type"><b>: </b><span>VLSM message</span></span></span></span><br><span><var>Alt</var><span><span class="hyp-body"><b>:= </b><span>binary_free_composition M emit_any_message_vlsm</span></span><span class="hyp-type"><b>: </b><span>VLSM message</span></span></span></span><br><span><var>om</var><span class="hyp-type"><b>: </b><span>option message</span></span></span><br><span><var>s'</var><span class="hyp-type"><b>: </b><span>state (preloaded_with_all_messages_vlsm M)</span></span></span><br><span><var>l</var><span class="hyp-type"><b>: </b><span>label (preloaded_with_all_messages_vlsm M)</span></span></span><br><span><var>om0, om'</var><span class="hyp-type"><b>: </b><span>option message</span></span></span><br><span><var>s</var><span class="hyp-type"><b>: </b><span>state (preloaded_with_all_messages_vlsm M)</span></span></span><br><span><var>Ht</var><span class="hyp-type"><b>: </b><span>input_valid_transition
  (preloaded_with_all_messages_vlsm M) l (
  s, om0) (s&#39;, om&#39;)</span></span></span><br><span><var>IHHsj</var><span class="hyp-type"><b>: </b><span>valid_state_prop Alt (lifted_alt_state s)</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">valid_state_prop Alt (lifted_alt_state s&#39;)</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="ByzantineTraces-v-chk18" style="display: none" type="checkbox"><label class="alectryon-input" for="ByzantineTraces-v-chk18"><span class="kr">exists</span> <span class="nv">om&#39;</span>.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>message</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>M</var><span class="hyp-type"><b>: </b><span>VLSM message</span></span></span><br><span><var>Alt1</var><span><span class="hyp-body"><b>:= </b><span>binary_free_composition_fst M
  emit_any_message_vlsm</span></span><span class="hyp-type"><b>: </b><span>VLSM message</span></span></span></span><br><span><var>Alt</var><span><span class="hyp-body"><b>:= </b><span>binary_free_composition M emit_any_message_vlsm</span></span><span class="hyp-type"><b>: </b><span>VLSM message</span></span></span></span><br><span><var>om</var><span class="hyp-type"><b>: </b><span>option message</span></span></span><br><span><var>s'</var><span class="hyp-type"><b>: </b><span>state (preloaded_with_all_messages_vlsm M)</span></span></span><br><span><var>l</var><span class="hyp-type"><b>: </b><span>label (preloaded_with_all_messages_vlsm M)</span></span></span><br><span><var>om0, om'</var><span class="hyp-type"><b>: </b><span>option message</span></span></span><br><span><var>s</var><span class="hyp-type"><b>: </b><span>state (preloaded_with_all_messages_vlsm M)</span></span></span><br><span><var>Ht</var><span class="hyp-type"><b>: </b><span>input_valid_transition
  (preloaded_with_all_messages_vlsm M) l (
  s, om0) (s&#39;, om&#39;)</span></span></span><br><span><var>IHHsj</var><span class="hyp-type"><b>: </b><span>valid_state_prop Alt (lifted_alt_state s)</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">valid_state_message_prop Alt (lifted_alt_state s&#39;) om&#39;</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="ByzantineTraces-v-chk19" style="display: none" type="checkbox"><label class="alectryon-input" for="ByzantineTraces-v-chk19"><span class="nb">eapply</span> (@input_valid_transition_outputs_valid_state_message _ Alt (existT <span class="kp">first</span> l)
    (lifted_alt_state s) (lifted_alt_state s&#39;) om0).</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>message</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>M</var><span class="hyp-type"><b>: </b><span>VLSM message</span></span></span><br><span><var>Alt1</var><span><span class="hyp-body"><b>:= </b><span>binary_free_composition_fst M
  emit_any_message_vlsm</span></span><span class="hyp-type"><b>: </b><span>VLSM message</span></span></span></span><br><span><var>Alt</var><span><span class="hyp-body"><b>:= </b><span>binary_free_composition M emit_any_message_vlsm</span></span><span class="hyp-type"><b>: </b><span>VLSM message</span></span></span></span><br><span><var>om</var><span class="hyp-type"><b>: </b><span>option message</span></span></span><br><span><var>s'</var><span class="hyp-type"><b>: </b><span>state (preloaded_with_all_messages_vlsm M)</span></span></span><br><span><var>l</var><span class="hyp-type"><b>: </b><span>label (preloaded_with_all_messages_vlsm M)</span></span></span><br><span><var>om0, om'</var><span class="hyp-type"><b>: </b><span>option message</span></span></span><br><span><var>s</var><span class="hyp-type"><b>: </b><span>state (preloaded_with_all_messages_vlsm M)</span></span></span><br><span><var>Ht</var><span class="hyp-type"><b>: </b><span>input_valid_transition
  (preloaded_with_all_messages_vlsm M) l (
  s, om0) (s&#39;, om&#39;)</span></span></span><br><span><var>IHHsj</var><span class="hyp-type"><b>: </b><span>valid_state_prop Alt (lifted_alt_state s)</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">input_valid_transition Alt (existT <span class="kp">first</span> l)
  (lifted_alt_state s, om0) (lifted_alt_state s&#39;, om&#39;)</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="ByzantineTraces-v-chk1a" style="display: none" type="checkbox"><label class="alectryon-input" for="ByzantineTraces-v-chk1a"><span class="kp">repeat</span> <span class="nb">split</span>; <span class="nb">cbn</span>; [<span class="bp">by</span> <span class="nb">apply</span> IHHsj | <span class="bp">by</span> <span class="nb">apply</span> alt_option_valid_message | <span class="bp">by</span> <span class="nb">apply</span> Ht |].</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>message</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>M</var><span class="hyp-type"><b>: </b><span>VLSM message</span></span></span><br><span><var>Alt1</var><span><span class="hyp-body"><b>:= </b><span>binary_free_composition_fst M
  emit_any_message_vlsm</span></span><span class="hyp-type"><b>: </b><span>VLSM message</span></span></span></span><br><span><var>Alt</var><span><span class="hyp-body"><b>:= </b><span>binary_free_composition M emit_any_message_vlsm</span></span><span class="hyp-type"><b>: </b><span>VLSM message</span></span></span></span><br><span><var>om</var><span class="hyp-type"><b>: </b><span>option message</span></span></span><br><span><var>s'</var><span class="hyp-type"><b>: </b><span>state (preloaded_with_all_messages_vlsm M)</span></span></span><br><span><var>l</var><span class="hyp-type"><b>: </b><span>label (preloaded_with_all_messages_vlsm M)</span></span></span><br><span><var>om0, om'</var><span class="hyp-type"><b>: </b><span>option message</span></span></span><br><span><var>s</var><span class="hyp-type"><b>: </b><span>state (preloaded_with_all_messages_vlsm M)</span></span></span><br><span><var>Ht</var><span class="hyp-type"><b>: </b><span>input_valid_transition
  (preloaded_with_all_messages_vlsm M) l (
  s, om0) (s&#39;, om&#39;)</span></span></span><br><span><var>IHHsj</var><span class="hyp-type"><b>: </b><span>valid_state_prop Alt (lifted_alt_state s)</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">(<span class="kr">let</span> (<span class="nv">si&#39;</span>, om&#39;) :=
   transition l (lifted_alt_state s <span class="kp">first</span>, om0) <span class="kr">in</span>
 (state_update (binary_IM M emit_any_message_vlsm)
    (lifted_alt_state s) <span class="kp">first</span> si&#39;, om&#39;)) =
(lifted_alt_state s&#39;, om&#39;)</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="ByzantineTraces-v-chk1b" style="display: none" type="checkbox"><label class="alectryon-input" for="ByzantineTraces-v-chk1b"><span class="nb">unfold</span> lifted_alt_state, lift_to_composite_state&#39;, lift_to_composite_state.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>message</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>M</var><span class="hyp-type"><b>: </b><span>VLSM message</span></span></span><br><span><var>Alt1</var><span><span class="hyp-body"><b>:= </b><span>binary_free_composition_fst M
  emit_any_message_vlsm</span></span><span class="hyp-type"><b>: </b><span>VLSM message</span></span></span></span><br><span><var>Alt</var><span><span class="hyp-body"><b>:= </b><span>binary_free_composition M emit_any_message_vlsm</span></span><span class="hyp-type"><b>: </b><span>VLSM message</span></span></span></span><br><span><var>om</var><span class="hyp-type"><b>: </b><span>option message</span></span></span><br><span><var>s'</var><span class="hyp-type"><b>: </b><span>state (preloaded_with_all_messages_vlsm M)</span></span></span><br><span><var>l</var><span class="hyp-type"><b>: </b><span>label (preloaded_with_all_messages_vlsm M)</span></span></span><br><span><var>om0, om'</var><span class="hyp-type"><b>: </b><span>option message</span></span></span><br><span><var>s</var><span class="hyp-type"><b>: </b><span>state (preloaded_with_all_messages_vlsm M)</span></span></span><br><span><var>Ht</var><span class="hyp-type"><b>: </b><span>input_valid_transition
  (preloaded_with_all_messages_vlsm M) l (
  s, om0) (s&#39;, om&#39;)</span></span></span><br><span><var>IHHsj</var><span class="hyp-type"><b>: </b><span>valid_state_prop Alt (lifted_alt_state s)</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">(<span class="kr">let</span> (<span class="nv">si&#39;</span>, om&#39;) :=
   transition l
     (state_update (binary_IM M emit_any_message_vlsm)
        (`(composite_s0
             (binary_IM M emit_any_message_vlsm)))
        <span class="kp">first</span> s <span class="kp">first</span>, om0) <span class="kr">in</span>
 (state_update (binary_IM M emit_any_message_vlsm)
    (state_update (binary_IM M emit_any_message_vlsm)
       (`(composite_s0
            (binary_IM M emit_any_message_vlsm)))
       <span class="kp">first</span> s) <span class="kp">first</span> si&#39;, om&#39;)) =
(state_update (binary_IM M emit_any_message_vlsm)
   (`(composite_s0 (binary_IM M emit_any_message_vlsm)))
   <span class="kp">first</span> s&#39;, om&#39;)</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="ByzantineTraces-v-chk1c" style="display: none" type="checkbox"><label class="alectryon-input" for="ByzantineTraces-v-chk1c">state_update_simpl; <span class="nb">cbn</span> <span class="kr">in</span> *.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>message</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>M</var><span class="hyp-type"><b>: </b><span>VLSM message</span></span></span><br><span><var>Alt1</var><span><span class="hyp-body"><b>:= </b><span>binary_free_composition_fst M
  emit_any_message_vlsm</span></span><span class="hyp-type"><b>: </b><span>VLSM message</span></span></span></span><br><span><var>Alt</var><span><span class="hyp-body"><b>:= </b><span>binary_free_composition M emit_any_message_vlsm</span></span><span class="hyp-type"><b>: </b><span>VLSM message</span></span></span></span><br><span><var>om</var><span class="hyp-type"><b>: </b><span>option message</span></span></span><br><span><var>s'</var><span class="hyp-type"><b>: </b><span>state M</span></span></span><br><span><var>l</var><span class="hyp-type"><b>: </b><span>label M</span></span></span><br><span><var>om0, om'</var><span class="hyp-type"><b>: </b><span>option message</span></span></span><br><span><var>s</var><span class="hyp-type"><b>: </b><span>state M</span></span></span><br><span><var>Ht</var><span class="hyp-type"><b>: </b><span>input_valid_transition
  (preloaded_with_all_messages_vlsm M) l (
  s, om0) (s&#39;, om&#39;)</span></span></span><br><span><var>IHHsj</var><span class="hyp-type"><b>: </b><span>valid_state_prop Alt (lifted_alt_state s)</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">(<span class="kr">let</span> (<span class="nv">si&#39;</span>, om&#39;) := transition l (s, om0) <span class="kr">in</span>
 (state_update (binary_IM M emit_any_message_vlsm)
    (state_update (binary_IM M emit_any_message_vlsm)
       (<span class="kr">Œª</span> <span class="nv">n</span> : binary_index,
          `(vs0 (binary_IM M emit_any_message_vlsm n)))
       <span class="kp">first</span> s) <span class="kp">first</span> si&#39;, om&#39;)) =
(state_update (binary_IM M emit_any_message_vlsm)
   (<span class="kr">Œª</span> <span class="nv">n</span> : binary_index,
      `(vs0 (binary_IM M emit_any_message_vlsm n)))
   <span class="kp">first</span> s&#39;, om&#39;)</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="ByzantineTraces-v-chk1d" style="display: none" type="checkbox"><label class="alectryon-input" for="ByzantineTraces-v-chk1d"><span class="nb">destruct</span> Ht <span class="kr">as</span> [_ Ht]; <span class="nb">cbn</span> <span class="kr">in</span> Ht; <span class="nb">rewrite</span> Ht.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>message</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>M</var><span class="hyp-type"><b>: </b><span>VLSM message</span></span></span><br><span><var>Alt1</var><span><span class="hyp-body"><b>:= </b><span>binary_free_composition_fst M
  emit_any_message_vlsm</span></span><span class="hyp-type"><b>: </b><span>VLSM message</span></span></span></span><br><span><var>Alt</var><span><span class="hyp-body"><b>:= </b><span>binary_free_composition M emit_any_message_vlsm</span></span><span class="hyp-type"><b>: </b><span>VLSM message</span></span></span></span><br><span><var>om</var><span class="hyp-type"><b>: </b><span>option message</span></span></span><br><span><var>s'</var><span class="hyp-type"><b>: </b><span>state M</span></span></span><br><span><var>l</var><span class="hyp-type"><b>: </b><span>label M</span></span></span><br><span><var>om0, om'</var><span class="hyp-type"><b>: </b><span>option message</span></span></span><br><span><var>s</var><span class="hyp-type"><b>: </b><span>state M</span></span></span><br><span><var>Ht</var><span class="hyp-type"><b>: </b><span>transition l (s, om0) = (s&#39;, om&#39;)</span></span></span><br><span><var>IHHsj</var><span class="hyp-type"><b>: </b><span>valid_state_prop Alt (lifted_alt_state s)</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">(state_update (binary_IM M emit_any_message_vlsm)
   (state_update (binary_IM M emit_any_message_vlsm)
      (<span class="kr">Œª</span> <span class="nv">n</span> : binary_index,
         `(vs0 (binary_IM M emit_any_message_vlsm n)))
      <span class="kp">first</span> s) <span class="kp">first</span> s&#39;, om&#39;) =
(state_update (binary_IM M emit_any_message_vlsm)
   (<span class="kr">Œª</span> <span class="nv">n</span> : binary_index,
      `(vs0 (binary_IM M emit_any_message_vlsm n)))
   <span class="kp">first</span> s&#39;, om&#39;)</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><span class="alectryon-input"><span class="bp">by</span> <span class="nb">rewrite</span> state_update_twice.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Qed</span>.</span></span></pre><div class="doc">
  Finally, we can use <span class="inlinecode"><span class="id" title="var">basic_VLSM_incl</span></span> together with the
  results above to show that <code>Preloaded</code> is included in <code>Alt1</code>.

</div><pre class="alectryon-io highlight"><!-- Generator: Alectryon --><span class="alectryon-sentence"><input class="alectryon-toggle" id="ByzantineTraces-v-chk1e" style="display: none" type="checkbox"><label class="alectryon-input" for="ByzantineTraces-v-chk1e"><span class="kn">Lemma</span> <span class="nf">preloaded_with_all_messages_alt_incl</span> :
  VLSM_incl (preloaded_with_all_messages_vlsm M) Alt1.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>message</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>M</var><span class="hyp-type"><b>: </b><span>VLSM message</span></span></span><br><span><var>Alt1</var><span><span class="hyp-body"><b>:= </b><span>binary_free_composition_fst M
  emit_any_message_vlsm</span></span><span class="hyp-type"><b>: </b><span>VLSM message</span></span></span></span><br><span><var>Alt</var><span><span class="hyp-body"><b>:= </b><span>binary_free_composition M emit_any_message_vlsm</span></span><span class="hyp-type"><b>: </b><span>VLSM message</span></span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">VLSM_incl (preloaded_with_all_messages_vlsm M) Alt1</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="ByzantineTraces-v-chk1f" style="display: none" type="checkbox"><label class="alectryon-input" for="ByzantineTraces-v-chk1f"><span class="kn">Proof</span>.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>message</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>M</var><span class="hyp-type"><b>: </b><span>VLSM message</span></span></span><br><span><var>Alt1</var><span><span class="hyp-body"><b>:= </b><span>binary_free_composition_fst M
  emit_any_message_vlsm</span></span><span class="hyp-type"><b>: </b><span>VLSM message</span></span></span></span><br><span><var>Alt</var><span><span class="hyp-body"><b>:= </b><span>binary_free_composition M emit_any_message_vlsm</span></span><span class="hyp-type"><b>: </b><span>VLSM message</span></span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">VLSM_incl (preloaded_with_all_messages_vlsm M) Alt1</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="ByzantineTraces-v-chk20" style="display: none" type="checkbox"><label class="alectryon-input" for="ByzantineTraces-v-chk20"><span class="nb">apply</span> (basic_VLSM_incl _ Alt1); <span class="nb">intro</span>; <span class="nb">intros</span>;
    [<span class="bp">done</span> | <span class="bp">by</span> <span class="nb">apply</span> alt_proj_option_valid_message | | <span class="bp">by</span> <span class="nb">apply</span> H].</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>message</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>M</var><span class="hyp-type"><b>: </b><span>VLSM message</span></span></span><br><span><var>Alt1</var><span><span class="hyp-body"><b>:= </b><span>binary_free_composition_fst M
  emit_any_message_vlsm</span></span><span class="hyp-type"><b>: </b><span>VLSM message</span></span></span></span><br><span><var>Alt</var><span><span class="hyp-body"><b>:= </b><span>binary_free_composition M emit_any_message_vlsm</span></span><span class="hyp-type"><b>: </b><span>VLSM message</span></span></span></span><br><span><var>l</var><span class="hyp-type"><b>: </b><span>label
  {|
    vlsm_type := Alt1;
    vlsm_machine :=
      preloaded_vlsm_machine M
        (<span class="kr">Œª</span> <span class="nv">_</span> : message, <span class="kt">True</span>)
  |}</span></span></span><br><span><var>s</var><span class="hyp-type"><b>: </b><span>state
  {|
    vlsm_type := Alt1;
    vlsm_machine :=
      preloaded_vlsm_machine M
        (<span class="kr">Œª</span> <span class="nv">_</span> : message, <span class="kt">True</span>)
  |}</span></span></span><br><span><var>om</var><span class="hyp-type"><b>: </b><span>option message</span></span></span><br><span><var>Hv</var><span class="hyp-type"><b>: </b><span>input_valid
  {|
    vlsm_type := Alt1;
    vlsm_machine :=
      preloaded_vlsm_machine M
        (<span class="kr">Œª</span> <span class="nv">_</span> : message, <span class="kt">True</span>)
  |} l (s, om)</span></span></span><br><span><var>HsY</var><span class="hyp-type"><b>: </b><span>valid_state_prop
  {| vlsm_type := Alt1; vlsm_machine := Alt1 |}
  (id s)</span></span></span><br><span><var>HomY</var><span class="hyp-type"><b>: </b><span>option_valid_message_prop
  {| vlsm_type := Alt1; vlsm_machine := Alt1 |}
  om</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">valid (id l) (id s, om)</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="ByzantineTraces-v-chk21" style="display: none" type="checkbox"><label class="alectryon-input" for="ByzantineTraces-v-chk21"><span class="kr">exists</span> (<span class="nv">lifted_alt_state</span> <span class="nv">s</span>).</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>message</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>M</var><span class="hyp-type"><b>: </b><span>VLSM message</span></span></span><br><span><var>Alt1</var><span><span class="hyp-body"><b>:= </b><span>binary_free_composition_fst M
  emit_any_message_vlsm</span></span><span class="hyp-type"><b>: </b><span>VLSM message</span></span></span></span><br><span><var>Alt</var><span><span class="hyp-body"><b>:= </b><span>binary_free_composition M emit_any_message_vlsm</span></span><span class="hyp-type"><b>: </b><span>VLSM message</span></span></span></span><br><span><var>l</var><span class="hyp-type"><b>: </b><span>label
  {|
    vlsm_type := Alt1;
    vlsm_machine :=
      preloaded_vlsm_machine M
        (<span class="kr">Œª</span> <span class="nv">_</span> : message, <span class="kt">True</span>)
  |}</span></span></span><br><span><var>s</var><span class="hyp-type"><b>: </b><span>state
  {|
    vlsm_type := Alt1;
    vlsm_machine :=
      preloaded_vlsm_machine M
        (<span class="kr">Œª</span> <span class="nv">_</span> : message, <span class="kt">True</span>)
  |}</span></span></span><br><span><var>om</var><span class="hyp-type"><b>: </b><span>option message</span></span></span><br><span><var>Hv</var><span class="hyp-type"><b>: </b><span>input_valid
  {|
    vlsm_type := Alt1;
    vlsm_machine :=
      preloaded_vlsm_machine M
        (<span class="kr">Œª</span> <span class="nv">_</span> : message, <span class="kt">True</span>)
  |} l (s, om)</span></span></span><br><span><var>HsY</var><span class="hyp-type"><b>: </b><span>valid_state_prop
  {| vlsm_type := Alt1; vlsm_machine := Alt1 |}
  (id s)</span></span></span><br><span><var>HomY</var><span class="hyp-type"><b>: </b><span>option_valid_message_prop
  {| vlsm_type := Alt1; vlsm_machine := Alt1 |}
  om</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">lifted_alt_state s <span class="kp">first</span> = id s
‚àß input_valid
    (composite_vlsm
       (binary_IM M emit_any_message_vlsm)
       (free_constraint
          (binary_IM M emit_any_message_vlsm)))
    (existT <span class="kp">first</span> (id l)) (lifted_alt_state s, om)</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="ByzantineTraces-v-chk22" style="display: none" type="checkbox"><label class="alectryon-input" for="ByzantineTraces-v-chk22"><span class="nb">split</span>; [<span class="bp">done</span> |].</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>message</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>M</var><span class="hyp-type"><b>: </b><span>VLSM message</span></span></span><br><span><var>Alt1</var><span><span class="hyp-body"><b>:= </b><span>binary_free_composition_fst M
  emit_any_message_vlsm</span></span><span class="hyp-type"><b>: </b><span>VLSM message</span></span></span></span><br><span><var>Alt</var><span><span class="hyp-body"><b>:= </b><span>binary_free_composition M emit_any_message_vlsm</span></span><span class="hyp-type"><b>: </b><span>VLSM message</span></span></span></span><br><span><var>l</var><span class="hyp-type"><b>: </b><span>label
  {|
    vlsm_type := Alt1;
    vlsm_machine :=
      preloaded_vlsm_machine M
        (<span class="kr">Œª</span> <span class="nv">_</span> : message, <span class="kt">True</span>)
  |}</span></span></span><br><span><var>s</var><span class="hyp-type"><b>: </b><span>state
  {|
    vlsm_type := Alt1;
    vlsm_machine :=
      preloaded_vlsm_machine M
        (<span class="kr">Œª</span> <span class="nv">_</span> : message, <span class="kt">True</span>)
  |}</span></span></span><br><span><var>om</var><span class="hyp-type"><b>: </b><span>option message</span></span></span><br><span><var>Hv</var><span class="hyp-type"><b>: </b><span>input_valid
  {|
    vlsm_type := Alt1;
    vlsm_machine :=
      preloaded_vlsm_machine M
        (<span class="kr">Œª</span> <span class="nv">_</span> : message, <span class="kt">True</span>)
  |} l (s, om)</span></span></span><br><span><var>HsY</var><span class="hyp-type"><b>: </b><span>valid_state_prop
  {| vlsm_type := Alt1; vlsm_machine := Alt1 |}
  (id s)</span></span></span><br><span><var>HomY</var><span class="hyp-type"><b>: </b><span>option_valid_message_prop
  {| vlsm_type := Alt1; vlsm_machine := Alt1 |}
  om</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">input_valid
  (composite_vlsm (binary_IM M emit_any_message_vlsm)
     (free_constraint
        (binary_IM M emit_any_message_vlsm)))
  (existT <span class="kp">first</span> (id l)) (lifted_alt_state s, om)</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="ByzantineTraces-v-chk23" style="display: none" type="checkbox"><label class="alectryon-input" for="ByzantineTraces-v-chk23"><span class="nb">destruct</span> Hv <span class="kr">as</span> [[_om Hps] [Hpm Hv]].</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>message</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>M</var><span class="hyp-type"><b>: </b><span>VLSM message</span></span></span><br><span><var>Alt1</var><span><span class="hyp-body"><b>:= </b><span>binary_free_composition_fst M
  emit_any_message_vlsm</span></span><span class="hyp-type"><b>: </b><span>VLSM message</span></span></span></span><br><span><var>Alt</var><span><span class="hyp-body"><b>:= </b><span>binary_free_composition M emit_any_message_vlsm</span></span><span class="hyp-type"><b>: </b><span>VLSM message</span></span></span></span><br><span><var>l</var><span class="hyp-type"><b>: </b><span>label
  {|
    vlsm_type := Alt1;
    vlsm_machine :=
      preloaded_vlsm_machine M
        (<span class="kr">Œª</span> <span class="nv">_</span> : message, <span class="kt">True</span>)
  |}</span></span></span><br><span><var>s</var><span class="hyp-type"><b>: </b><span>state
  {|
    vlsm_type := Alt1;
    vlsm_machine :=
      preloaded_vlsm_machine M
        (<span class="kr">Œª</span> <span class="nv">_</span> : message, <span class="kt">True</span>)
  |}</span></span></span><br><span><var>om, _om</var><span class="hyp-type"><b>: </b><span>option message</span></span></span><br><span><var>Hps</var><span class="hyp-type"><b>: </b><span>valid_state_message_prop
  {|
    vlsm_type := Alt1;
    vlsm_machine :=
      preloaded_vlsm_machine M
        (<span class="kr">Œª</span> <span class="nv">_</span> : message, <span class="kt">True</span>)
  |} s _om</span></span></span><br><span><var>Hpm</var><span class="hyp-type"><b>: </b><span>option_valid_message_prop
  {|
    vlsm_type := Alt1;
    vlsm_machine :=
      preloaded_vlsm_machine M
        (<span class="kr">Œª</span> <span class="nv">_</span> : message, <span class="kt">True</span>)
  |} om</span></span></span><br><span><var>Hv</var><span class="hyp-type"><b>: </b><span>valid l (s, om)</span></span></span><br><span><var>HsY</var><span class="hyp-type"><b>: </b><span>valid_state_prop
  {| vlsm_type := Alt1; vlsm_machine := Alt1 |}
  (id s)</span></span></span><br><span><var>HomY</var><span class="hyp-type"><b>: </b><span>option_valid_message_prop
  {| vlsm_type := Alt1; vlsm_machine := Alt1 |}
  om</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">input_valid
  (composite_vlsm (binary_IM M emit_any_message_vlsm)
     (free_constraint
        (binary_IM M emit_any_message_vlsm)))
  (existT <span class="kp">first</span> (id l)) (lifted_alt_state s, om)</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="ByzantineTraces-v-chk24" style="display: none" type="checkbox"><label class="alectryon-input" for="ByzantineTraces-v-chk24">split_and!; [| | <span class="bp">done</span>].</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>message</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>M</var><span class="hyp-type"><b>: </b><span>VLSM message</span></span></span><br><span><var>Alt1</var><span><span class="hyp-body"><b>:= </b><span>binary_free_composition_fst M
  emit_any_message_vlsm</span></span><span class="hyp-type"><b>: </b><span>VLSM message</span></span></span></span><br><span><var>Alt</var><span><span class="hyp-body"><b>:= </b><span>binary_free_composition M emit_any_message_vlsm</span></span><span class="hyp-type"><b>: </b><span>VLSM message</span></span></span></span><br><span><var>l</var><span class="hyp-type"><b>: </b><span>label
  {|
    vlsm_type := Alt1;
    vlsm_machine :=
      preloaded_vlsm_machine M
        (<span class="kr">Œª</span> <span class="nv">_</span> : message, <span class="kt">True</span>)
  |}</span></span></span><br><span><var>s</var><span class="hyp-type"><b>: </b><span>state
  {|
    vlsm_type := Alt1;
    vlsm_machine :=
      preloaded_vlsm_machine M
        (<span class="kr">Œª</span> <span class="nv">_</span> : message, <span class="kt">True</span>)
  |}</span></span></span><br><span><var>om, _om</var><span class="hyp-type"><b>: </b><span>option message</span></span></span><br><span><var>Hps</var><span class="hyp-type"><b>: </b><span>valid_state_message_prop
  {|
    vlsm_type := Alt1;
    vlsm_machine :=
      preloaded_vlsm_machine M
        (<span class="kr">Œª</span> <span class="nv">_</span> : message, <span class="kt">True</span>)
  |} s _om</span></span></span><br><span><var>Hpm</var><span class="hyp-type"><b>: </b><span>option_valid_message_prop
  {|
    vlsm_type := Alt1;
    vlsm_machine :=
      preloaded_vlsm_machine M
        (<span class="kr">Œª</span> <span class="nv">_</span> : message, <span class="kt">True</span>)
  |} om</span></span></span><br><span><var>Hv</var><span class="hyp-type"><b>: </b><span>valid l (s, om)</span></span></span><br><span><var>HsY</var><span class="hyp-type"><b>: </b><span>valid_state_prop
  {| vlsm_type := Alt1; vlsm_machine := Alt1 |}
  (id s)</span></span></span><br><span><var>HomY</var><span class="hyp-type"><b>: </b><span>option_valid_message_prop
  {| vlsm_type := Alt1; vlsm_machine := Alt1 |}
  om</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">valid_state_prop
  (composite_vlsm (binary_IM M emit_any_message_vlsm)
     (free_constraint
        (binary_IM M emit_any_message_vlsm)))
  (lifted_alt_state s)</div></blockquote><div class="alectryon-extra-goals"><input class="alectryon-extra-goal-toggle" id="ByzantineTraces-v-chk25" style="display: none" type="checkbox"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>message</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>M</var><span class="hyp-type"><b>: </b><span>VLSM message</span></span></span><br><span><var>Alt1</var><span><span class="hyp-body"><b>:= </b><span>binary_free_composition_fst M
  emit_any_message_vlsm</span></span><span class="hyp-type"><b>: </b><span>VLSM message</span></span></span></span><br><span><var>Alt</var><span><span class="hyp-body"><b>:= </b><span>binary_free_composition M emit_any_message_vlsm</span></span><span class="hyp-type"><b>: </b><span>VLSM message</span></span></span></span><br><span><var>l</var><span class="hyp-type"><b>: </b><span>label
  {|
    vlsm_type := Alt1;
    vlsm_machine :=
      preloaded_vlsm_machine M
        (<span class="kr">Œª</span> <span class="nv">_</span> : message, <span class="kt">True</span>)
  |}</span></span></span><br><span><var>s</var><span class="hyp-type"><b>: </b><span>state
  {|
    vlsm_type := Alt1;
    vlsm_machine :=
      preloaded_vlsm_machine M
        (<span class="kr">Œª</span> <span class="nv">_</span> : message, <span class="kt">True</span>)
  |}</span></span></span><br><span><var>om, _om</var><span class="hyp-type"><b>: </b><span>option message</span></span></span><br><span><var>Hps</var><span class="hyp-type"><b>: </b><span>valid_state_message_prop
  {|
    vlsm_type := Alt1;
    vlsm_machine :=
      preloaded_vlsm_machine M
        (<span class="kr">Œª</span> <span class="nv">_</span> : message, <span class="kt">True</span>)
  |} s _om</span></span></span><br><span><var>Hpm</var><span class="hyp-type"><b>: </b><span>option_valid_message_prop
  {|
    vlsm_type := Alt1;
    vlsm_machine :=
      preloaded_vlsm_machine M
        (<span class="kr">Œª</span> <span class="nv">_</span> : message, <span class="kt">True</span>)
  |} om</span></span></span><br><span><var>Hv</var><span class="hyp-type"><b>: </b><span>valid l (s, om)</span></span></span><br><span><var>HsY</var><span class="hyp-type"><b>: </b><span>valid_state_prop
  {| vlsm_type := Alt1; vlsm_machine := Alt1 |}
  (id s)</span></span></span><br><span><var>HomY</var><span class="hyp-type"><b>: </b><span>option_valid_message_prop
  {| vlsm_type := Alt1; vlsm_machine := Alt1 |}
  om</span></span></span><br></div><label class="goal-separator" for="ByzantineTraces-v-chk25"><hr></label><div class="goal-conclusion">option_valid_message_prop
  (composite_vlsm (binary_IM M emit_any_message_vlsm)
     (free_constraint
        (binary_IM M emit_any_message_vlsm))) om</div></blockquote></div></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="ByzantineTraces-v-chk26" style="display: none" type="checkbox"><label class="alectryon-input" for="ByzantineTraces-v-chk26">-</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>message</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>M</var><span class="hyp-type"><b>: </b><span>VLSM message</span></span></span><br><span><var>Alt1</var><span><span class="hyp-body"><b>:= </b><span>binary_free_composition_fst M
  emit_any_message_vlsm</span></span><span class="hyp-type"><b>: </b><span>VLSM message</span></span></span></span><br><span><var>Alt</var><span><span class="hyp-body"><b>:= </b><span>binary_free_composition M emit_any_message_vlsm</span></span><span class="hyp-type"><b>: </b><span>VLSM message</span></span></span></span><br><span><var>l</var><span class="hyp-type"><b>: </b><span>label
  {|
    vlsm_type := Alt1;
    vlsm_machine :=
      preloaded_vlsm_machine M
        (<span class="kr">Œª</span> <span class="nv">_</span> : message, <span class="kt">True</span>)
  |}</span></span></span><br><span><var>s</var><span class="hyp-type"><b>: </b><span>state
  {|
    vlsm_type := Alt1;
    vlsm_machine :=
      preloaded_vlsm_machine M
        (<span class="kr">Œª</span> <span class="nv">_</span> : message, <span class="kt">True</span>)
  |}</span></span></span><br><span><var>om, _om</var><span class="hyp-type"><b>: </b><span>option message</span></span></span><br><span><var>Hps</var><span class="hyp-type"><b>: </b><span>valid_state_message_prop
  {|
    vlsm_type := Alt1;
    vlsm_machine :=
      preloaded_vlsm_machine M
        (<span class="kr">Œª</span> <span class="nv">_</span> : message, <span class="kt">True</span>)
  |} s _om</span></span></span><br><span><var>Hpm</var><span class="hyp-type"><b>: </b><span>option_valid_message_prop
  {|
    vlsm_type := Alt1;
    vlsm_machine :=
      preloaded_vlsm_machine M
        (<span class="kr">Œª</span> <span class="nv">_</span> : message, <span class="kt">True</span>)
  |} om</span></span></span><br><span><var>Hv</var><span class="hyp-type"><b>: </b><span>valid l (s, om)</span></span></span><br><span><var>HsY</var><span class="hyp-type"><b>: </b><span>valid_state_prop
  {| vlsm_type := Alt1; vlsm_machine := Alt1 |}
  (id s)</span></span></span><br><span><var>HomY</var><span class="hyp-type"><b>: </b><span>option_valid_message_prop
  {| vlsm_type := Alt1; vlsm_machine := Alt1 |}
  om</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">valid_state_prop
  (composite_vlsm (binary_IM M emit_any_message_vlsm)
     (free_constraint
        (binary_IM M emit_any_message_vlsm)))
  (lifted_alt_state s)</div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="bp">by</span> <span class="nb">apply</span> preloaded_alt_valid_state <span class="kr">in</span> Hps.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="ByzantineTraces-v-chk27" style="display: none" type="checkbox"><label class="alectryon-input" for="ByzantineTraces-v-chk27">-</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>message</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>M</var><span class="hyp-type"><b>: </b><span>VLSM message</span></span></span><br><span><var>Alt1</var><span><span class="hyp-body"><b>:= </b><span>binary_free_composition_fst M
  emit_any_message_vlsm</span></span><span class="hyp-type"><b>: </b><span>VLSM message</span></span></span></span><br><span><var>Alt</var><span><span class="hyp-body"><b>:= </b><span>binary_free_composition M emit_any_message_vlsm</span></span><span class="hyp-type"><b>: </b><span>VLSM message</span></span></span></span><br><span><var>l</var><span class="hyp-type"><b>: </b><span>label
  {|
    vlsm_type := Alt1;
    vlsm_machine :=
      preloaded_vlsm_machine M
        (<span class="kr">Œª</span> <span class="nv">_</span> : message, <span class="kt">True</span>)
  |}</span></span></span><br><span><var>s</var><span class="hyp-type"><b>: </b><span>state
  {|
    vlsm_type := Alt1;
    vlsm_machine :=
      preloaded_vlsm_machine M
        (<span class="kr">Œª</span> <span class="nv">_</span> : message, <span class="kt">True</span>)
  |}</span></span></span><br><span><var>om, _om</var><span class="hyp-type"><b>: </b><span>option message</span></span></span><br><span><var>Hps</var><span class="hyp-type"><b>: </b><span>valid_state_message_prop
  {|
    vlsm_type := Alt1;
    vlsm_machine :=
      preloaded_vlsm_machine M
        (<span class="kr">Œª</span> <span class="nv">_</span> : message, <span class="kt">True</span>)
  |} s _om</span></span></span><br><span><var>Hpm</var><span class="hyp-type"><b>: </b><span>option_valid_message_prop
  {|
    vlsm_type := Alt1;
    vlsm_machine :=
      preloaded_vlsm_machine M
        (<span class="kr">Œª</span> <span class="nv">_</span> : message, <span class="kt">True</span>)
  |} om</span></span></span><br><span><var>Hv</var><span class="hyp-type"><b>: </b><span>valid l (s, om)</span></span></span><br><span><var>HsY</var><span class="hyp-type"><b>: </b><span>valid_state_prop
  {| vlsm_type := Alt1; vlsm_machine := Alt1 |}
  (id s)</span></span></span><br><span><var>HomY</var><span class="hyp-type"><b>: </b><span>option_valid_message_prop
  {| vlsm_type := Alt1; vlsm_machine := Alt1 |}
  om</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">option_valid_message_prop
  (composite_vlsm (binary_IM M emit_any_message_vlsm)
     (free_constraint
        (binary_IM M emit_any_message_vlsm))) om</div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="bp">by</span> <span class="nb">apply</span> alt_option_valid_message.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Qed</span>.</span></span></pre><div class="doc">
Hence, <code>Preloaded</code> and <code>Alt1</code> are actually trace-equivalent. 
</div><pre class="alectryon-io highlight"><!-- Generator: Alectryon --><span class="alectryon-sentence"><input class="alectryon-toggle" id="ByzantineTraces-v-chk28" style="display: none" type="checkbox"><label class="alectryon-input" for="ByzantineTraces-v-chk28"><span class="kn">Lemma</span> <span class="nf">preloaded_with_all_messages_alt_eq</span> :
  VLSM_eq (preloaded_with_all_messages_vlsm M) Alt1.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>message</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>M</var><span class="hyp-type"><b>: </b><span>VLSM message</span></span></span><br><span><var>Alt1</var><span><span class="hyp-body"><b>:= </b><span>binary_free_composition_fst M
  emit_any_message_vlsm</span></span><span class="hyp-type"><b>: </b><span>VLSM message</span></span></span></span><br><span><var>Alt</var><span><span class="hyp-body"><b>:= </b><span>binary_free_composition M emit_any_message_vlsm</span></span><span class="hyp-type"><b>: </b><span>VLSM message</span></span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">VLSM_eq (preloaded_with_all_messages_vlsm M) Alt1</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="ByzantineTraces-v-chk29" style="display: none" type="checkbox"><label class="alectryon-input" for="ByzantineTraces-v-chk29"><span class="kn">Proof</span>.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>message</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>M</var><span class="hyp-type"><b>: </b><span>VLSM message</span></span></span><br><span><var>Alt1</var><span><span class="hyp-body"><b>:= </b><span>binary_free_composition_fst M
  emit_any_message_vlsm</span></span><span class="hyp-type"><b>: </b><span>VLSM message</span></span></span></span><br><span><var>Alt</var><span><span class="hyp-body"><b>:= </b><span>binary_free_composition M emit_any_message_vlsm</span></span><span class="hyp-type"><b>: </b><span>VLSM message</span></span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">VLSM_eq (preloaded_with_all_messages_vlsm M) Alt1</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="ByzantineTraces-v-chk2a" style="display: none" type="checkbox"><label class="alectryon-input" for="ByzantineTraces-v-chk2a"><span class="nb">split</span>.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>message</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>M</var><span class="hyp-type"><b>: </b><span>VLSM message</span></span></span><br><span><var>Alt1</var><span><span class="hyp-body"><b>:= </b><span>binary_free_composition_fst M
  emit_any_message_vlsm</span></span><span class="hyp-type"><b>: </b><span>VLSM message</span></span></span></span><br><span><var>Alt</var><span><span class="hyp-body"><b>:= </b><span>binary_free_composition M emit_any_message_vlsm</span></span><span class="hyp-type"><b>: </b><span>VLSM message</span></span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">VLSM_incl
  {|
    vlsm_type := preloaded_with_all_messages_vlsm M;
    vlsm_machine := preloaded_with_all_messages_vlsm M
  |}
  {|
    vlsm_type := preloaded_with_all_messages_vlsm M;
    vlsm_machine := Alt1
  |}</div></blockquote><div class="alectryon-extra-goals"><input class="alectryon-extra-goal-toggle" id="ByzantineTraces-v-chk2b" style="display: none" type="checkbox"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>message</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>M</var><span class="hyp-type"><b>: </b><span>VLSM message</span></span></span><br><span><var>Alt1</var><span><span class="hyp-body"><b>:= </b><span>binary_free_composition_fst M
  emit_any_message_vlsm</span></span><span class="hyp-type"><b>: </b><span>VLSM message</span></span></span></span><br><span><var>Alt</var><span><span class="hyp-body"><b>:= </b><span>binary_free_composition M emit_any_message_vlsm</span></span><span class="hyp-type"><b>: </b><span>VLSM message</span></span></span></span><br></div><label class="goal-separator" for="ByzantineTraces-v-chk2b"><hr></label><div class="goal-conclusion">VLSM_incl
  {|
    vlsm_type := preloaded_with_all_messages_vlsm M;
    vlsm_machine := Alt1
  |}
  {|
    vlsm_type := preloaded_with_all_messages_vlsm M;
    vlsm_machine := preloaded_with_all_messages_vlsm M
  |}</div></blockquote></div></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="ByzantineTraces-v-chk2c" style="display: none" type="checkbox"><label class="alectryon-input" for="ByzantineTraces-v-chk2c">-</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>message</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>M</var><span class="hyp-type"><b>: </b><span>VLSM message</span></span></span><br><span><var>Alt1</var><span><span class="hyp-body"><b>:= </b><span>binary_free_composition_fst M
  emit_any_message_vlsm</span></span><span class="hyp-type"><b>: </b><span>VLSM message</span></span></span></span><br><span><var>Alt</var><span><span class="hyp-body"><b>:= </b><span>binary_free_composition M emit_any_message_vlsm</span></span><span class="hyp-type"><b>: </b><span>VLSM message</span></span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">VLSM_incl
  {|
    vlsm_type := preloaded_with_all_messages_vlsm M;
    vlsm_machine := preloaded_with_all_messages_vlsm M
  |}
  {|
    vlsm_type := preloaded_with_all_messages_vlsm M;
    vlsm_machine := Alt1
  |}</div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="bp">by</span> <span class="nb">apply</span> preloaded_with_all_messages_alt_incl.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="ByzantineTraces-v-chk2d" style="display: none" type="checkbox"><label class="alectryon-input" for="ByzantineTraces-v-chk2d">-</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>message</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>M</var><span class="hyp-type"><b>: </b><span>VLSM message</span></span></span><br><span><var>Alt1</var><span><span class="hyp-body"><b>:= </b><span>binary_free_composition_fst M
  emit_any_message_vlsm</span></span><span class="hyp-type"><b>: </b><span>VLSM message</span></span></span></span><br><span><var>Alt</var><span><span class="hyp-body"><b>:= </b><span>binary_free_composition M emit_any_message_vlsm</span></span><span class="hyp-type"><b>: </b><span>VLSM message</span></span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">VLSM_incl
  {|
    vlsm_type := preloaded_with_all_messages_vlsm M;
    vlsm_machine := Alt1
  |}
  {|
    vlsm_type := preloaded_with_all_messages_vlsm M;
    vlsm_machine := preloaded_with_all_messages_vlsm M
  |}</div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="bp">by</span> <span class="nb">apply</span> alt_preloaded_with_all_messages_incl.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Qed</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
</span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">End</span> <span class="nf">sec_preloaded_with_all_messages_byzantine_alt</span>.</span></span></pre><div class="doc">
  Finally, we can conclude that the two definitions for byzantine traces are
  equivalent.

</div><pre class="alectryon-io highlight"><!-- Generator: Alectryon --><span class="alectryon-sentence"><input class="alectryon-toggle" id="ByzantineTraces-v-chk2e" style="display: none" type="checkbox"><label class="alectryon-input" for="ByzantineTraces-v-chk2e"><span class="kn">Lemma</span> <span class="nf">byzantine_alt_byzantine_iff</span> :
  <span class="kr">forall</span> (<span class="nv">tr</span> : Trace M),
    alternate_byzantine_trace_prop tr &lt;-&gt; byzantine_trace_prop tr.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>message</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>M</var><span class="hyp-type"><b>: </b><span>VLSM message</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="kr">‚àÄ</span> <span class="nv">tr</span> : Trace,
  alternate_byzantine_trace_prop tr
  ‚Üî byzantine_trace_prop tr</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="ByzantineTraces-v-chk2f" style="display: none" type="checkbox"><label class="alectryon-input" for="ByzantineTraces-v-chk2f"><span class="kn">Proof</span>.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>message</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>M</var><span class="hyp-type"><b>: </b><span>VLSM message</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="kr">‚àÄ</span> <span class="nv">tr</span> : Trace,
  alternate_byzantine_trace_prop tr
  ‚Üî byzantine_trace_prop tr</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="ByzantineTraces-v-chk30" style="display: none" type="checkbox"><label class="alectryon-input" for="ByzantineTraces-v-chk30"><span class="nb">split</span>; <span class="nb">intros</span>.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>message</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>M</var><span class="hyp-type"><b>: </b><span>VLSM message</span></span></span><br><span><var>tr</var><span class="hyp-type"><b>: </b><span>Trace</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>alternate_byzantine_trace_prop tr</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">byzantine_trace_prop tr</div></blockquote><div class="alectryon-extra-goals"><input class="alectryon-extra-goal-toggle" id="ByzantineTraces-v-chk31" style="display: none" type="checkbox"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>message</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>M</var><span class="hyp-type"><b>: </b><span>VLSM message</span></span></span><br><span><var>tr</var><span class="hyp-type"><b>: </b><span>Trace</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>byzantine_trace_prop tr</span></span></span><br></div><label class="goal-separator" for="ByzantineTraces-v-chk31"><hr></label><div class="goal-conclusion">alternate_byzantine_trace_prop tr</div></blockquote></div></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="ByzantineTraces-v-chk32" style="display: none" type="checkbox"><label class="alectryon-input" for="ByzantineTraces-v-chk32">-</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>message</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>M</var><span class="hyp-type"><b>: </b><span>VLSM message</span></span></span><br><span><var>tr</var><span class="hyp-type"><b>: </b><span>Trace</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>alternate_byzantine_trace_prop tr</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">byzantine_trace_prop tr</div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="bp">by</span> <span class="nb">apply</span> byzantine_alt_byzantine.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="ByzantineTraces-v-chk33" style="display: none" type="checkbox"><label class="alectryon-input" for="ByzantineTraces-v-chk33">-</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>message</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>M</var><span class="hyp-type"><b>: </b><span>VLSM message</span></span></span><br><span><var>tr</var><span class="hyp-type"><b>: </b><span>Trace</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>byzantine_trace_prop tr</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">alternate_byzantine_trace_prop tr</div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="bp">by</span> <span class="nb">apply</span> preloaded_with_all_messages_alt_incl, byzantine_preloaded_with_all_messages.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Qed</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
</span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">End</span> <span class="nf">sec_byzantine_traces</span>.</span></span></pre><div class="doc">
<a id="lab5"></a><h2 class="section">Byzantine fault tolerance for a single validator</h2>
<div class="paragraph"> </div>

  Given that projections of composition of validator VLSMs
  are equivalent to their corresponding VLSM preloaded with all
  messages (<span class="inlinecode"><span class="id" title="var">preloaded_with_all_messages_validating_proj_eq</span></span>),
  we can derive that for validators, all their byzantine traces are
  included in the valid traces of their projection from the composition.

</div><pre class="alectryon-io highlight"><!-- Generator: Alectryon --><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Section</span> <span class="nf">sec_single_validator_byzantine_traces</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
</span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Context</span>
  {<span class="nv">message</span> : <span class="kt">Type</span>}
  `{EqDecision index}
  (IM : index -&gt; VLSM message)
  (constraint : composite_label IM -&gt; composite_state IM  * option message -&gt; <span class="kt">Prop</span>)
  (i : index)
  (Hvalidator : component_projection_validator_prop IM constraint i)
  .</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
</span><span class="alectryon-sentence"><input class="alectryon-toggle" id="ByzantineTraces-v-chk34" style="display: none" type="checkbox"><label class="alectryon-input" for="ByzantineTraces-v-chk34"><span class="kn">Lemma</span> <span class="nf">validator_component_byzantine_fault_tolerance</span> :
  <span class="kr">forall</span> (<span class="nv">tr</span> : Trace),
    byzantine_trace_prop (IM i) tr -&gt;
    valid_trace_prop (pre_composite_vlsm_induced_projection_validator IM constraint i) tr.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>message, index</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>EqDecision0</var><span class="hyp-type"><b>: </b><span>EqDecision index</span></span></span><br><span><var>IM</var><span class="hyp-type"><b>: </b><span>index ‚Üí VLSM message</span></span></span><br><span><var>constraint</var><span class="hyp-type"><b>: </b><span>composite_label IM
‚Üí composite_state IM * option message
  ‚Üí <span class="kt">Prop</span></span></span></span><br><span><var>i</var><span class="hyp-type"><b>: </b><span>index</span></span></span><br><span><var>Hvalidator</var><span class="hyp-type"><b>: </b><span>component_projection_validator_prop IM
  constraint i</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="kr">‚àÄ</span> <span class="nv">tr</span> : Trace,
  byzantine_trace_prop (IM i) tr
  ‚Üí valid_trace_prop
      (pre_composite_vlsm_induced_projection_validator
         IM constraint i) tr</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="ByzantineTraces-v-chk35" style="display: none" type="checkbox"><label class="alectryon-input" for="ByzantineTraces-v-chk35"><span class="kn">Proof</span>.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>message, index</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>EqDecision0</var><span class="hyp-type"><b>: </b><span>EqDecision index</span></span></span><br><span><var>IM</var><span class="hyp-type"><b>: </b><span>index ‚Üí VLSM message</span></span></span><br><span><var>constraint</var><span class="hyp-type"><b>: </b><span>composite_label IM
‚Üí composite_state IM * option message
  ‚Üí <span class="kt">Prop</span></span></span></span><br><span><var>i</var><span class="hyp-type"><b>: </b><span>index</span></span></span><br><span><var>Hvalidator</var><span class="hyp-type"><b>: </b><span>component_projection_validator_prop IM
  constraint i</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="kr">‚àÄ</span> <span class="nv">tr</span> : Trace,
  byzantine_trace_prop (IM i) tr
  ‚Üí valid_trace_prop
      (pre_composite_vlsm_induced_projection_validator
         IM constraint i) tr</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="ByzantineTraces-v-chk36" style="display: none" type="checkbox"><label class="alectryon-input" for="ByzantineTraces-v-chk36"><span class="nb">intros</span> tr Htr.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>message, index</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>EqDecision0</var><span class="hyp-type"><b>: </b><span>EqDecision index</span></span></span><br><span><var>IM</var><span class="hyp-type"><b>: </b><span>index ‚Üí VLSM message</span></span></span><br><span><var>constraint</var><span class="hyp-type"><b>: </b><span>composite_label IM
‚Üí composite_state IM * option message
  ‚Üí <span class="kt">Prop</span></span></span></span><br><span><var>i</var><span class="hyp-type"><b>: </b><span>index</span></span></span><br><span><var>Hvalidator</var><span class="hyp-type"><b>: </b><span>component_projection_validator_prop IM
  constraint i</span></span></span><br><span><var>tr</var><span class="hyp-type"><b>: </b><span>Trace</span></span></span><br><span><var>Htr</var><span class="hyp-type"><b>: </b><span>byzantine_trace_prop (IM i) tr</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">valid_trace_prop
  (pre_composite_vlsm_induced_projection_validator IM
     constraint i) tr</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="ByzantineTraces-v-chk37" style="display: none" type="checkbox"><label class="alectryon-input" for="ByzantineTraces-v-chk37"><span class="nb">eapply</span> VLSM_incl_valid_trace.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>message, index</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>EqDecision0</var><span class="hyp-type"><b>: </b><span>EqDecision index</span></span></span><br><span><var>IM</var><span class="hyp-type"><b>: </b><span>index ‚Üí VLSM message</span></span></span><br><span><var>constraint</var><span class="hyp-type"><b>: </b><span>composite_label IM
‚Üí composite_state IM * option message
  ‚Üí <span class="kt">Prop</span></span></span></span><br><span><var>i</var><span class="hyp-type"><b>: </b><span>index</span></span></span><br><span><var>Hvalidator</var><span class="hyp-type"><b>: </b><span>component_projection_validator_prop IM
  constraint i</span></span></span><br><span><var>tr</var><span class="hyp-type"><b>: </b><span>Trace</span></span></span><br><span><var>Htr</var><span class="hyp-type"><b>: </b><span>byzantine_trace_prop (IM i) tr</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">VLSM_incl_part <span class="nl">?MX</span>
  (preloaded_vlsm_machine
     (composite_vlsm_induced_projection_validator IM
        constraint i) (<span class="kr">Œª</span> <span class="nv">_</span> : message, <span class="kt">True</span>))</div></blockquote><div class="alectryon-extra-goals"><input class="alectryon-extra-goal-toggle" id="ByzantineTraces-v-chk38" style="display: none" type="checkbox"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>message, index</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>EqDecision0</var><span class="hyp-type"><b>: </b><span>EqDecision index</span></span></span><br><span><var>IM</var><span class="hyp-type"><b>: </b><span>index ‚Üí VLSM message</span></span></span><br><span><var>constraint</var><span class="hyp-type"><b>: </b><span>composite_label IM
‚Üí composite_state IM * option message
  ‚Üí <span class="kt">Prop</span></span></span></span><br><span><var>i</var><span class="hyp-type"><b>: </b><span>index</span></span></span><br><span><var>Hvalidator</var><span class="hyp-type"><b>: </b><span>component_projection_validator_prop IM
  constraint i</span></span></span><br><span><var>tr</var><span class="hyp-type"><b>: </b><span>Trace</span></span></span><br><span><var>Htr</var><span class="hyp-type"><b>: </b><span>byzantine_trace_prop (IM i) tr</span></span></span><br></div><label class="goal-separator" for="ByzantineTraces-v-chk38"><hr></label><div class="goal-conclusion">valid_trace_prop
  {|
    vlsm_type :=
      composite_vlsm_induced_projection_validator IM
        constraint i;
    vlsm_machine := <span class="nl">?MX</span>
  |} tr</div></blockquote></div></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="ByzantineTraces-v-chk39" style="display: none" type="checkbox"><label class="alectryon-input" for="ByzantineTraces-v-chk39">-</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>message, index</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>EqDecision0</var><span class="hyp-type"><b>: </b><span>EqDecision index</span></span></span><br><span><var>IM</var><span class="hyp-type"><b>: </b><span>index ‚Üí VLSM message</span></span></span><br><span><var>constraint</var><span class="hyp-type"><b>: </b><span>composite_label IM
‚Üí composite_state IM * option message
  ‚Üí <span class="kt">Prop</span></span></span></span><br><span><var>i</var><span class="hyp-type"><b>: </b><span>index</span></span></span><br><span><var>Hvalidator</var><span class="hyp-type"><b>: </b><span>component_projection_validator_prop IM
  constraint i</span></span></span><br><span><var>tr</var><span class="hyp-type"><b>: </b><span>Trace</span></span></span><br><span><var>Htr</var><span class="hyp-type"><b>: </b><span>byzantine_trace_prop (IM i) tr</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">VLSM_incl_part <span class="nl">?MX</span>
  (preloaded_vlsm_machine
     (composite_vlsm_induced_projection_validator IM
        constraint i) (<span class="kr">Œª</span> <span class="nv">_</span> : message, <span class="kt">True</span>))</div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="bp">by</span> <span class="nb">apply</span> preloaded_with_all_messages_validator_component_proj_incl.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="ByzantineTraces-v-chk3a" style="display: none" type="checkbox"><label class="alectryon-input" for="ByzantineTraces-v-chk3a">-</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>message, index</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>EqDecision0</var><span class="hyp-type"><b>: </b><span>EqDecision index</span></span></span><br><span><var>IM</var><span class="hyp-type"><b>: </b><span>index ‚Üí VLSM message</span></span></span><br><span><var>constraint</var><span class="hyp-type"><b>: </b><span>composite_label IM
‚Üí composite_state IM * option message
  ‚Üí <span class="kt">Prop</span></span></span></span><br><span><var>i</var><span class="hyp-type"><b>: </b><span>index</span></span></span><br><span><var>Hvalidator</var><span class="hyp-type"><b>: </b><span>component_projection_validator_prop IM
  constraint i</span></span></span><br><span><var>tr</var><span class="hyp-type"><b>: </b><span>Trace</span></span></span><br><span><var>Htr</var><span class="hyp-type"><b>: </b><span>byzantine_trace_prop (IM i) tr</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">valid_trace_prop
  {|
    vlsm_type :=
      composite_vlsm_induced_projection_validator IM
        constraint i;
    vlsm_machine :=
      preloaded_with_all_messages_vlsm (IM i)
  |} tr</div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="bp">by</span> <span class="nb">apply</span> byzantine_preloaded_with_all_messages <span class="kr">in</span> Htr.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Qed</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
</span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">End</span> <span class="nf">sec_single_validator_byzantine_traces</span>.</span></span></pre><div class="doc">
<a id="lab6"></a><h2 class="section">Byzantine fault tolerance for a composition of validators</h2>
<div class="paragraph"> </div>

  In this section we show that if all components of a composite VLSM <code>X</code>
  satisfy <span class="inlinecode"><span class="id" title="var">projection_validator_prop</span></span>, then its byzantine traces (that is,
  traces obtained upon placing this composition in any, possibly adversarial,
  context) are valid traces of <code>X</code>.

</div><pre class="alectryon-io highlight"><!-- Generator: Alectryon --><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Section</span> <span class="nf">sec_composite_validator_byzantine_traces</span>.</span></span></pre><div class="doc">
  Let us fix an indexed set of VLSMs <code>IM</code> and their
  constrained composition <code>X</code>, and let <code>PreloadedX</code> be
  the <span class="inlinecode"><span class="id" title="var">preloaded_with_all_messages_vlsm</span></span> associated to <code>X</code>.

</div><pre class="alectryon-io highlight"><!-- Generator: Alectryon --><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Context</span>
  {<span class="nv">message</span> : <span class="kt">Type</span>}
  `{EqDecision index}
  (IM : index -&gt; VLSM message)
  (constraint : composite_label IM -&gt; composite_state IM  * option message -&gt; <span class="kt">Prop</span>)
  (X := composite_vlsm IM constraint)
  (Hvalidator : <span class="kr">forall</span> <span class="nv">i</span> : index, component_message_validator_prop IM constraint i)
  .</span></span></pre><div class="doc">
  Since we know that preloaded <code>X</code> contains precisely the byzantine traces
  of <code>X</code>, we just need to show that preloaded <code>X</code> is included in <code>X</code> to
  prove our main result.

</div><pre class="alectryon-io highlight"><!-- Generator: Alectryon --><span class="alectryon-sentence"><input class="alectryon-toggle" id="ByzantineTraces-v-chk3b" style="display: none" type="checkbox"><label class="alectryon-input" for="ByzantineTraces-v-chk3b"><span class="kn">Lemma</span> <span class="nf">validator_preloaded_with_all_messages_incl</span> :
  VLSM_incl (preloaded_with_all_messages_vlsm X) X.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>message, index</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>EqDecision0</var><span class="hyp-type"><b>: </b><span>EqDecision index</span></span></span><br><span><var>IM</var><span class="hyp-type"><b>: </b><span>index ‚Üí VLSM message</span></span></span><br><span><var>constraint</var><span class="hyp-type"><b>: </b><span>composite_label IM
‚Üí composite_state IM * option message
  ‚Üí <span class="kt">Prop</span></span></span></span><br><span><var>X</var><span><span class="hyp-body"><b>:= </b><span>composite_vlsm IM constraint</span></span><span class="hyp-type"><b>: </b><span>VLSM message</span></span></span></span><br><span><var>Hvalidator</var><span class="hyp-type"><b>: </b><span><span class="kr">‚àÄ</span> <span class="nv">i</span> : index,
  component_message_validator_prop IM
    constraint i</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">VLSM_incl (preloaded_with_all_messages_vlsm X) X</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="ByzantineTraces-v-chk3c" style="display: none" type="checkbox"><label class="alectryon-input" for="ByzantineTraces-v-chk3c"><span class="kn">Proof</span>.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>message, index</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>EqDecision0</var><span class="hyp-type"><b>: </b><span>EqDecision index</span></span></span><br><span><var>IM</var><span class="hyp-type"><b>: </b><span>index ‚Üí VLSM message</span></span></span><br><span><var>constraint</var><span class="hyp-type"><b>: </b><span>composite_label IM
‚Üí composite_state IM * option message
  ‚Üí <span class="kt">Prop</span></span></span></span><br><span><var>X</var><span><span class="hyp-body"><b>:= </b><span>composite_vlsm IM constraint</span></span><span class="hyp-type"><b>: </b><span>VLSM message</span></span></span></span><br><span><var>Hvalidator</var><span class="hyp-type"><b>: </b><span><span class="kr">‚àÄ</span> <span class="nv">i</span> : index,
  component_message_validator_prop IM
    constraint i</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">VLSM_incl (preloaded_with_all_messages_vlsm X) X</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="ByzantineTraces-v-chk3d" style="display: none" type="checkbox"><label class="alectryon-input" for="ByzantineTraces-v-chk3d"><span class="nb">apply</span> VLSM_incl_finite_traces_characterization.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>message, index</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>EqDecision0</var><span class="hyp-type"><b>: </b><span>EqDecision index</span></span></span><br><span><var>IM</var><span class="hyp-type"><b>: </b><span>index ‚Üí VLSM message</span></span></span><br><span><var>constraint</var><span class="hyp-type"><b>: </b><span>composite_label IM
‚Üí composite_state IM * option message
  ‚Üí <span class="kt">Prop</span></span></span></span><br><span><var>X</var><span><span class="hyp-body"><b>:= </b><span>composite_vlsm IM constraint</span></span><span class="hyp-type"><b>: </b><span>VLSM message</span></span></span></span><br><span><var>Hvalidator</var><span class="hyp-type"><b>: </b><span><span class="kr">‚àÄ</span> <span class="nv">i</span> : index,
  component_message_validator_prop IM
    constraint i</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="kr">‚àÄ</span> (<span class="nv">s</span> : state
         {|
           vlsm_type :=
             preloaded_with_all_messages_vlsm X;
           vlsm_machine :=
             preloaded_vlsm_machine X
               (<span class="kr">Œª</span> <span class="nv">_</span> : message, <span class="kt">True</span>)
         |}) (<span class="nv">tr</span> : list transition_item),
  finite_valid_trace
    {|
      vlsm_type := preloaded_with_all_messages_vlsm X;
      vlsm_machine :=
        preloaded_vlsm_machine X (<span class="kr">Œª</span> <span class="nv">_</span> : message, <span class="kt">True</span>)
    |} s tr
  ‚Üí finite_valid_trace
      {|
        vlsm_type :=
          preloaded_with_all_messages_vlsm X;
        vlsm_machine :=
          ConstrainedVLSM.constrained_vlsm_machine
            (free_composite_vlsm IM) constraint
      |} s tr</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="ByzantineTraces-v-chk3e" style="display: none" type="checkbox"><label class="alectryon-input" for="ByzantineTraces-v-chk3e"><span class="nb">intros</span> s tr Htr.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>message, index</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>EqDecision0</var><span class="hyp-type"><b>: </b><span>EqDecision index</span></span></span><br><span><var>IM</var><span class="hyp-type"><b>: </b><span>index ‚Üí VLSM message</span></span></span><br><span><var>constraint</var><span class="hyp-type"><b>: </b><span>composite_label IM
‚Üí composite_state IM * option message
  ‚Üí <span class="kt">Prop</span></span></span></span><br><span><var>X</var><span><span class="hyp-body"><b>:= </b><span>composite_vlsm IM constraint</span></span><span class="hyp-type"><b>: </b><span>VLSM message</span></span></span></span><br><span><var>Hvalidator</var><span class="hyp-type"><b>: </b><span><span class="kr">‚àÄ</span> <span class="nv">i</span> : index,
  component_message_validator_prop IM
    constraint i</span></span></span><br><span><var>s</var><span class="hyp-type"><b>: </b><span>state
  {|
    vlsm_type :=
      preloaded_with_all_messages_vlsm X;
    vlsm_machine :=
      preloaded_vlsm_machine X
        (<span class="kr">Œª</span> <span class="nv">_</span> : message, <span class="kt">True</span>)
  |}</span></span></span><br><span><var>tr</var><span class="hyp-type"><b>: </b><span>list transition_item</span></span></span><br><span><var>Htr</var><span class="hyp-type"><b>: </b><span>finite_valid_trace
  {|
    vlsm_type :=
      preloaded_with_all_messages_vlsm X;
    vlsm_machine :=
      preloaded_vlsm_machine X
        (<span class="kr">Œª</span> <span class="nv">_</span> : message, <span class="kt">True</span>)
  |} s tr</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">finite_valid_trace
  {|
    vlsm_type := preloaded_with_all_messages_vlsm X;
    vlsm_machine :=
      ConstrainedVLSM.constrained_vlsm_machine
        (free_composite_vlsm IM) constraint
  |} s tr</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="ByzantineTraces-v-chk3f" style="display: none" type="checkbox"><label class="alectryon-input" for="ByzantineTraces-v-chk3f"><span class="nb">split</span>; [| <span class="bp">by</span> <span class="nb">apply</span> Htr].</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>message, index</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>EqDecision0</var><span class="hyp-type"><b>: </b><span>EqDecision index</span></span></span><br><span><var>IM</var><span class="hyp-type"><b>: </b><span>index ‚Üí VLSM message</span></span></span><br><span><var>constraint</var><span class="hyp-type"><b>: </b><span>composite_label IM
‚Üí composite_state IM * option message
  ‚Üí <span class="kt">Prop</span></span></span></span><br><span><var>X</var><span><span class="hyp-body"><b>:= </b><span>composite_vlsm IM constraint</span></span><span class="hyp-type"><b>: </b><span>VLSM message</span></span></span></span><br><span><var>Hvalidator</var><span class="hyp-type"><b>: </b><span><span class="kr">‚àÄ</span> <span class="nv">i</span> : index,
  component_message_validator_prop IM
    constraint i</span></span></span><br><span><var>s</var><span class="hyp-type"><b>: </b><span>state
  {|
    vlsm_type :=
      preloaded_with_all_messages_vlsm X;
    vlsm_machine :=
      preloaded_vlsm_machine X
        (<span class="kr">Œª</span> <span class="nv">_</span> : message, <span class="kt">True</span>)
  |}</span></span></span><br><span><var>tr</var><span class="hyp-type"><b>: </b><span>list transition_item</span></span></span><br><span><var>Htr</var><span class="hyp-type"><b>: </b><span>finite_valid_trace
  {|
    vlsm_type :=
      preloaded_with_all_messages_vlsm X;
    vlsm_machine :=
      preloaded_vlsm_machine X
        (<span class="kr">Œª</span> <span class="nv">_</span> : message, <span class="kt">True</span>)
  |} s tr</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">finite_valid_trace_from
  {|
    vlsm_type := preloaded_with_all_messages_vlsm X;
    vlsm_machine :=
      ConstrainedVLSM.constrained_vlsm_machine
        (free_composite_vlsm IM) constraint
  |} s tr</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="ByzantineTraces-v-chk40" style="display: none" type="checkbox"><label class="alectryon-input" for="ByzantineTraces-v-chk40"><span class="nb">destruct</span> Htr <span class="kr">as</span> [Htr Hs].</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>message, index</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>EqDecision0</var><span class="hyp-type"><b>: </b><span>EqDecision index</span></span></span><br><span><var>IM</var><span class="hyp-type"><b>: </b><span>index ‚Üí VLSM message</span></span></span><br><span><var>constraint</var><span class="hyp-type"><b>: </b><span>composite_label IM
‚Üí composite_state IM * option message
  ‚Üí <span class="kt">Prop</span></span></span></span><br><span><var>X</var><span><span class="hyp-body"><b>:= </b><span>composite_vlsm IM constraint</span></span><span class="hyp-type"><b>: </b><span>VLSM message</span></span></span></span><br><span><var>Hvalidator</var><span class="hyp-type"><b>: </b><span><span class="kr">‚àÄ</span> <span class="nv">i</span> : index,
  component_message_validator_prop IM
    constraint i</span></span></span><br><span><var>s</var><span class="hyp-type"><b>: </b><span>state
  {|
    vlsm_type :=
      preloaded_with_all_messages_vlsm X;
    vlsm_machine :=
      preloaded_vlsm_machine X
        (<span class="kr">Œª</span> <span class="nv">_</span> : message, <span class="kt">True</span>)
  |}</span></span></span><br><span><var>tr</var><span class="hyp-type"><b>: </b><span>list transition_item</span></span></span><br><span><var>Htr</var><span class="hyp-type"><b>: </b><span>finite_valid_trace_from
  {|
    vlsm_type :=
      preloaded_with_all_messages_vlsm X;
    vlsm_machine :=
      preloaded_vlsm_machine X
        (<span class="kr">Œª</span> <span class="nv">_</span> : message, <span class="kt">True</span>)
  |} s tr</span></span></span><br><span><var>Hs</var><span class="hyp-type"><b>: </b><span>initial_state_prop s</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">finite_valid_trace_from
  {|
    vlsm_type := preloaded_with_all_messages_vlsm X;
    vlsm_machine :=
      ConstrainedVLSM.constrained_vlsm_machine
        (free_composite_vlsm IM) constraint
  |} s tr</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="ByzantineTraces-v-chk41" style="display: none" type="checkbox"><label class="alectryon-input" for="ByzantineTraces-v-chk41"><span class="nb">induction</span> Htr <span class="nb">using</span> finite_valid_trace_from_rev_ind;
    [<span class="bp">by</span> <span class="nb">apply</span> (finite_valid_trace_from_empty X), initial_state_is_valid |].</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>message, index</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>EqDecision0</var><span class="hyp-type"><b>: </b><span>EqDecision index</span></span></span><br><span><var>IM</var><span class="hyp-type"><b>: </b><span>index ‚Üí VLSM message</span></span></span><br><span><var>constraint</var><span class="hyp-type"><b>: </b><span>composite_label IM
‚Üí composite_state IM * option message
  ‚Üí <span class="kt">Prop</span></span></span></span><br><span><var>X</var><span><span class="hyp-body"><b>:= </b><span>composite_vlsm IM constraint</span></span><span class="hyp-type"><b>: </b><span>VLSM message</span></span></span></span><br><span><var>Hvalidator</var><span class="hyp-type"><b>: </b><span><span class="kr">‚àÄ</span> <span class="nv">i</span> : index,
  component_message_validator_prop IM
    constraint i</span></span></span><br><span><var>s</var><span class="hyp-type"><b>: </b><span>state
  {|
    vlsm_type :=
      preloaded_with_all_messages_vlsm X;
    vlsm_machine :=
      preloaded_vlsm_machine X
        (<span class="kr">Œª</span> <span class="nv">_</span> : message, <span class="kt">True</span>)
  |}</span></span></span><br><span><var>tr</var><span class="hyp-type"><b>: </b><span>list transition_item</span></span></span><br><span><var>Htr</var><span class="hyp-type"><b>: </b><span>finite_valid_trace_from
  {|
    vlsm_type :=
      preloaded_with_all_messages_vlsm X;
    vlsm_machine :=
      preloaded_vlsm_machine X
        (<span class="kr">Œª</span> <span class="nv">_</span> : message, <span class="kt">True</span>)
  |} s tr</span></span></span><br><span><var>sf</var><span class="hyp-type"><b>: </b><span>state
  {|
    vlsm_type :=
      preloaded_with_all_messages_vlsm X;
    vlsm_machine :=
      preloaded_vlsm_machine X
        (<span class="kr">Œª</span> <span class="nv">_</span> : message, <span class="kt">True</span>)
  |}</span></span></span><br><span><var>iom, oom</var><span class="hyp-type"><b>: </b><span>option message</span></span></span><br><span><var>l</var><span class="hyp-type"><b>: </b><span>label
  {|
    vlsm_type :=
      preloaded_with_all_messages_vlsm X;
    vlsm_machine :=
      preloaded_vlsm_machine X
        (<span class="kr">Œª</span> <span class="nv">_</span> : message, <span class="kt">True</span>)
  |}</span></span></span><br><span><var>Hx</var><span class="hyp-type"><b>: </b><span>input_valid_transition
  {|
    vlsm_type :=
      preloaded_with_all_messages_vlsm X;
    vlsm_machine :=
      preloaded_vlsm_machine X
        (<span class="kr">Œª</span> <span class="nv">_</span> : message, <span class="kt">True</span>)
  |} l (finite_trace_last s tr, iom) (
  sf, oom)</span></span></span><br><span><var>x</var><span><span class="hyp-body"><b>:= </b><span>{|
  l := l;
  input := iom;
  destination := sf;
  output := oom
|}</span></span><span class="hyp-type"><b>: </b><span>transition_item</span></span></span></span><br><span><var>Hs</var><span class="hyp-type"><b>: </b><span>initial_state_prop s</span></span></span><br><span><var>IHHtr</var><span class="hyp-type"><b>: </b><span>initial_state_prop s
‚Üí finite_valid_trace_from
    {|
      vlsm_type :=
        preloaded_with_all_messages_vlsm X;
      vlsm_machine :=
        ConstrainedVLSM.constrained_vlsm_machine
          (free_composite_vlsm IM) constraint
    |} s tr</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">finite_valid_trace_from
  {|
    vlsm_type := preloaded_with_all_messages_vlsm X;
    vlsm_machine :=
      ConstrainedVLSM.constrained_vlsm_machine
        (free_composite_vlsm IM) constraint
  |} s (tr ++ [x])</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="ByzantineTraces-v-chk42" style="display: none" type="checkbox"><label class="alectryon-input" for="ByzantineTraces-v-chk42"><span class="nb">apply</span> (extend_right_finite_trace_from X); [<span class="bp">by</span> <span class="nb">apply</span> IHHtr |].</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>message, index</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>EqDecision0</var><span class="hyp-type"><b>: </b><span>EqDecision index</span></span></span><br><span><var>IM</var><span class="hyp-type"><b>: </b><span>index ‚Üí VLSM message</span></span></span><br><span><var>constraint</var><span class="hyp-type"><b>: </b><span>composite_label IM
‚Üí composite_state IM * option message
  ‚Üí <span class="kt">Prop</span></span></span></span><br><span><var>X</var><span><span class="hyp-body"><b>:= </b><span>composite_vlsm IM constraint</span></span><span class="hyp-type"><b>: </b><span>VLSM message</span></span></span></span><br><span><var>Hvalidator</var><span class="hyp-type"><b>: </b><span><span class="kr">‚àÄ</span> <span class="nv">i</span> : index,
  component_message_validator_prop IM
    constraint i</span></span></span><br><span><var>s</var><span class="hyp-type"><b>: </b><span>state
  {|
    vlsm_type :=
      preloaded_with_all_messages_vlsm X;
    vlsm_machine :=
      preloaded_vlsm_machine X
        (<span class="kr">Œª</span> <span class="nv">_</span> : message, <span class="kt">True</span>)
  |}</span></span></span><br><span><var>tr</var><span class="hyp-type"><b>: </b><span>list transition_item</span></span></span><br><span><var>Htr</var><span class="hyp-type"><b>: </b><span>finite_valid_trace_from
  {|
    vlsm_type :=
      preloaded_with_all_messages_vlsm X;
    vlsm_machine :=
      preloaded_vlsm_machine X
        (<span class="kr">Œª</span> <span class="nv">_</span> : message, <span class="kt">True</span>)
  |} s tr</span></span></span><br><span><var>sf</var><span class="hyp-type"><b>: </b><span>state
  {|
    vlsm_type :=
      preloaded_with_all_messages_vlsm X;
    vlsm_machine :=
      preloaded_vlsm_machine X
        (<span class="kr">Œª</span> <span class="nv">_</span> : message, <span class="kt">True</span>)
  |}</span></span></span><br><span><var>iom, oom</var><span class="hyp-type"><b>: </b><span>option message</span></span></span><br><span><var>l</var><span class="hyp-type"><b>: </b><span>label
  {|
    vlsm_type :=
      preloaded_with_all_messages_vlsm X;
    vlsm_machine :=
      preloaded_vlsm_machine X
        (<span class="kr">Œª</span> <span class="nv">_</span> : message, <span class="kt">True</span>)
  |}</span></span></span><br><span><var>Hx</var><span class="hyp-type"><b>: </b><span>input_valid_transition
  {|
    vlsm_type :=
      preloaded_with_all_messages_vlsm X;
    vlsm_machine :=
      preloaded_vlsm_machine X
        (<span class="kr">Œª</span> <span class="nv">_</span> : message, <span class="kt">True</span>)
  |} l (finite_trace_last s tr, iom) (
  sf, oom)</span></span></span><br><span><var>x</var><span><span class="hyp-body"><b>:= </b><span>{|
  l := l;
  input := iom;
  destination := sf;
  output := oom
|}</span></span><span class="hyp-type"><b>: </b><span>transition_item</span></span></span></span><br><span><var>Hs</var><span class="hyp-type"><b>: </b><span>initial_state_prop s</span></span></span><br><span><var>IHHtr</var><span class="hyp-type"><b>: </b><span>initial_state_prop s
‚Üí finite_valid_trace_from
    {|
      vlsm_type :=
        preloaded_with_all_messages_vlsm X;
      vlsm_machine :=
        ConstrainedVLSM.constrained_vlsm_machine
          (free_composite_vlsm IM) constraint
    |} s tr</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">input_valid_transition X l
  (finite_trace_last s tr, iom) (sf, oom)</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="ByzantineTraces-v-chk43" style="display: none" type="checkbox"><label class="alectryon-input" for="ByzantineTraces-v-chk43"><span class="nb">destruct</span> Hx <span class="kr">as</span> [Hvx Htx].</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>message, index</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>EqDecision0</var><span class="hyp-type"><b>: </b><span>EqDecision index</span></span></span><br><span><var>IM</var><span class="hyp-type"><b>: </b><span>index ‚Üí VLSM message</span></span></span><br><span><var>constraint</var><span class="hyp-type"><b>: </b><span>composite_label IM
‚Üí composite_state IM * option message
  ‚Üí <span class="kt">Prop</span></span></span></span><br><span><var>X</var><span><span class="hyp-body"><b>:= </b><span>composite_vlsm IM constraint</span></span><span class="hyp-type"><b>: </b><span>VLSM message</span></span></span></span><br><span><var>Hvalidator</var><span class="hyp-type"><b>: </b><span><span class="kr">‚àÄ</span> <span class="nv">i</span> : index,
  component_message_validator_prop IM
    constraint i</span></span></span><br><span><var>s</var><span class="hyp-type"><b>: </b><span>state
  {|
    vlsm_type :=
      preloaded_with_all_messages_vlsm X;
    vlsm_machine :=
      preloaded_vlsm_machine X
        (<span class="kr">Œª</span> <span class="nv">_</span> : message, <span class="kt">True</span>)
  |}</span></span></span><br><span><var>tr</var><span class="hyp-type"><b>: </b><span>list transition_item</span></span></span><br><span><var>Htr</var><span class="hyp-type"><b>: </b><span>finite_valid_trace_from
  {|
    vlsm_type :=
      preloaded_with_all_messages_vlsm X;
    vlsm_machine :=
      preloaded_vlsm_machine X
        (<span class="kr">Œª</span> <span class="nv">_</span> : message, <span class="kt">True</span>)
  |} s tr</span></span></span><br><span><var>sf</var><span class="hyp-type"><b>: </b><span>state
  {|
    vlsm_type :=
      preloaded_with_all_messages_vlsm X;
    vlsm_machine :=
      preloaded_vlsm_machine X
        (<span class="kr">Œª</span> <span class="nv">_</span> : message, <span class="kt">True</span>)
  |}</span></span></span><br><span><var>iom, oom</var><span class="hyp-type"><b>: </b><span>option message</span></span></span><br><span><var>l</var><span class="hyp-type"><b>: </b><span>label
  {|
    vlsm_type :=
      preloaded_with_all_messages_vlsm X;
    vlsm_machine :=
      preloaded_vlsm_machine X
        (<span class="kr">Œª</span> <span class="nv">_</span> : message, <span class="kt">True</span>)
  |}</span></span></span><br><span><var>Hvx</var><span class="hyp-type"><b>: </b><span>input_valid
  {|
    vlsm_type :=
      preloaded_with_all_messages_vlsm X;
    vlsm_machine :=
      preloaded_vlsm_machine X
        (<span class="kr">Œª</span> <span class="nv">_</span> : message, <span class="kt">True</span>)
  |} l (finite_trace_last s tr, iom)</span></span></span><br><span><var>Htx</var><span class="hyp-type"><b>: </b><span>transition l (finite_trace_last s tr, iom) =
(sf, oom)</span></span></span><br><span><var>x</var><span><span class="hyp-body"><b>:= </b><span>{|
  l := l;
  input := iom;
  destination := sf;
  output := oom
|}</span></span><span class="hyp-type"><b>: </b><span>transition_item</span></span></span></span><br><span><var>Hs</var><span class="hyp-type"><b>: </b><span>initial_state_prop s</span></span></span><br><span><var>IHHtr</var><span class="hyp-type"><b>: </b><span>initial_state_prop s
‚Üí finite_valid_trace_from
    {|
      vlsm_type :=
        preloaded_with_all_messages_vlsm X;
      vlsm_machine :=
        ConstrainedVLSM.constrained_vlsm_machine
          (free_composite_vlsm IM) constraint
    |} s tr</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">input_valid_transition X l
  (finite_trace_last s tr, iom) (sf, oom)</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="ByzantineTraces-v-chk44" style="display: none" type="checkbox"><label class="alectryon-input" for="ByzantineTraces-v-chk44"><span class="nb">split</span>; [| <span class="bp">done</span>].</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>message, index</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>EqDecision0</var><span class="hyp-type"><b>: </b><span>EqDecision index</span></span></span><br><span><var>IM</var><span class="hyp-type"><b>: </b><span>index ‚Üí VLSM message</span></span></span><br><span><var>constraint</var><span class="hyp-type"><b>: </b><span>composite_label IM
‚Üí composite_state IM * option message
  ‚Üí <span class="kt">Prop</span></span></span></span><br><span><var>X</var><span><span class="hyp-body"><b>:= </b><span>composite_vlsm IM constraint</span></span><span class="hyp-type"><b>: </b><span>VLSM message</span></span></span></span><br><span><var>Hvalidator</var><span class="hyp-type"><b>: </b><span><span class="kr">‚àÄ</span> <span class="nv">i</span> : index,
  component_message_validator_prop IM
    constraint i</span></span></span><br><span><var>s</var><span class="hyp-type"><b>: </b><span>state
  {|
    vlsm_type :=
      preloaded_with_all_messages_vlsm X;
    vlsm_machine :=
      preloaded_vlsm_machine X
        (<span class="kr">Œª</span> <span class="nv">_</span> : message, <span class="kt">True</span>)
  |}</span></span></span><br><span><var>tr</var><span class="hyp-type"><b>: </b><span>list transition_item</span></span></span><br><span><var>Htr</var><span class="hyp-type"><b>: </b><span>finite_valid_trace_from
  {|
    vlsm_type :=
      preloaded_with_all_messages_vlsm X;
    vlsm_machine :=
      preloaded_vlsm_machine X
        (<span class="kr">Œª</span> <span class="nv">_</span> : message, <span class="kt">True</span>)
  |} s tr</span></span></span><br><span><var>sf</var><span class="hyp-type"><b>: </b><span>state
  {|
    vlsm_type :=
      preloaded_with_all_messages_vlsm X;
    vlsm_machine :=
      preloaded_vlsm_machine X
        (<span class="kr">Œª</span> <span class="nv">_</span> : message, <span class="kt">True</span>)
  |}</span></span></span><br><span><var>iom, oom</var><span class="hyp-type"><b>: </b><span>option message</span></span></span><br><span><var>l</var><span class="hyp-type"><b>: </b><span>label
  {|
    vlsm_type :=
      preloaded_with_all_messages_vlsm X;
    vlsm_machine :=
      preloaded_vlsm_machine X
        (<span class="kr">Œª</span> <span class="nv">_</span> : message, <span class="kt">True</span>)
  |}</span></span></span><br><span><var>Hvx</var><span class="hyp-type"><b>: </b><span>input_valid
  {|
    vlsm_type :=
      preloaded_with_all_messages_vlsm X;
    vlsm_machine :=
      preloaded_vlsm_machine X
        (<span class="kr">Œª</span> <span class="nv">_</span> : message, <span class="kt">True</span>)
  |} l (finite_trace_last s tr, iom)</span></span></span><br><span><var>Htx</var><span class="hyp-type"><b>: </b><span>transition l (finite_trace_last s tr, iom) =
(sf, oom)</span></span></span><br><span><var>x</var><span><span class="hyp-body"><b>:= </b><span>{|
  l := l;
  input := iom;
  destination := sf;
  output := oom
|}</span></span><span class="hyp-type"><b>: </b><span>transition_item</span></span></span></span><br><span><var>Hs</var><span class="hyp-type"><b>: </b><span>initial_state_prop s</span></span></span><br><span><var>IHHtr</var><span class="hyp-type"><b>: </b><span>initial_state_prop s
‚Üí finite_valid_trace_from
    {|
      vlsm_type :=
        preloaded_with_all_messages_vlsm X;
      vlsm_machine :=
        ConstrainedVLSM.constrained_vlsm_machine
          (free_composite_vlsm IM) constraint
    |} s tr</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">input_valid X l (finite_trace_last s tr, iom)</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="ByzantineTraces-v-chk45" style="display: none" type="checkbox"><label class="alectryon-input" for="ByzantineTraces-v-chk45"><span class="nb">apply</span> finite_valid_trace_last_pstate <span class="kr">in</span> IHHtr; [| <span class="bp">done</span>].</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>message, index</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>EqDecision0</var><span class="hyp-type"><b>: </b><span>EqDecision index</span></span></span><br><span><var>IM</var><span class="hyp-type"><b>: </b><span>index ‚Üí VLSM message</span></span></span><br><span><var>constraint</var><span class="hyp-type"><b>: </b><span>composite_label IM
‚Üí composite_state IM * option message
  ‚Üí <span class="kt">Prop</span></span></span></span><br><span><var>X</var><span><span class="hyp-body"><b>:= </b><span>composite_vlsm IM constraint</span></span><span class="hyp-type"><b>: </b><span>VLSM message</span></span></span></span><br><span><var>Hvalidator</var><span class="hyp-type"><b>: </b><span><span class="kr">‚àÄ</span> <span class="nv">i</span> : index,
  component_message_validator_prop IM
    constraint i</span></span></span><br><span><var>s</var><span class="hyp-type"><b>: </b><span>state
  {|
    vlsm_type :=
      preloaded_with_all_messages_vlsm X;
    vlsm_machine :=
      preloaded_vlsm_machine X
        (<span class="kr">Œª</span> <span class="nv">_</span> : message, <span class="kt">True</span>)
  |}</span></span></span><br><span><var>tr</var><span class="hyp-type"><b>: </b><span>list transition_item</span></span></span><br><span><var>Htr</var><span class="hyp-type"><b>: </b><span>finite_valid_trace_from
  {|
    vlsm_type :=
      preloaded_with_all_messages_vlsm X;
    vlsm_machine :=
      preloaded_vlsm_machine X
        (<span class="kr">Œª</span> <span class="nv">_</span> : message, <span class="kt">True</span>)
  |} s tr</span></span></span><br><span><var>sf</var><span class="hyp-type"><b>: </b><span>state
  {|
    vlsm_type :=
      preloaded_with_all_messages_vlsm X;
    vlsm_machine :=
      preloaded_vlsm_machine X
        (<span class="kr">Œª</span> <span class="nv">_</span> : message, <span class="kt">True</span>)
  |}</span></span></span><br><span><var>iom, oom</var><span class="hyp-type"><b>: </b><span>option message</span></span></span><br><span><var>l</var><span class="hyp-type"><b>: </b><span>label
  {|
    vlsm_type :=
      preloaded_with_all_messages_vlsm X;
    vlsm_machine :=
      preloaded_vlsm_machine X
        (<span class="kr">Œª</span> <span class="nv">_</span> : message, <span class="kt">True</span>)
  |}</span></span></span><br><span><var>Hvx</var><span class="hyp-type"><b>: </b><span>input_valid
  {|
    vlsm_type :=
      preloaded_with_all_messages_vlsm X;
    vlsm_machine :=
      preloaded_vlsm_machine X
        (<span class="kr">Œª</span> <span class="nv">_</span> : message, <span class="kt">True</span>)
  |} l (finite_trace_last s tr, iom)</span></span></span><br><span><var>Htx</var><span class="hyp-type"><b>: </b><span>transition l (finite_trace_last s tr, iom) =
(sf, oom)</span></span></span><br><span><var>x</var><span><span class="hyp-body"><b>:= </b><span>{|
  l := l;
  input := iom;
  destination := sf;
  output := oom
|}</span></span><span class="hyp-type"><b>: </b><span>transition_item</span></span></span></span><br><span><var>Hs</var><span class="hyp-type"><b>: </b><span>initial_state_prop s</span></span></span><br><span><var>IHHtr</var><span class="hyp-type"><b>: </b><span>valid_state_prop
  {|
    vlsm_type :=
      preloaded_with_all_messages_vlsm X;
    vlsm_machine :=
      ConstrainedVLSM.constrained_vlsm_machine
        (free_composite_vlsm IM) constraint
  |} (finite_trace_last s tr)</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">input_valid X l (finite_trace_last s tr, iom)</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="ByzantineTraces-v-chk46" style="display: none" type="checkbox"><label class="alectryon-input" for="ByzantineTraces-v-chk46"><span class="kp">repeat</span> <span class="nb">split</span>; [<span class="bp">done</span> | | <span class="bp">by</span> <span class="nb">apply</span> Hvx..].</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>message, index</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>EqDecision0</var><span class="hyp-type"><b>: </b><span>EqDecision index</span></span></span><br><span><var>IM</var><span class="hyp-type"><b>: </b><span>index ‚Üí VLSM message</span></span></span><br><span><var>constraint</var><span class="hyp-type"><b>: </b><span>composite_label IM
‚Üí composite_state IM * option message
  ‚Üí <span class="kt">Prop</span></span></span></span><br><span><var>X</var><span><span class="hyp-body"><b>:= </b><span>composite_vlsm IM constraint</span></span><span class="hyp-type"><b>: </b><span>VLSM message</span></span></span></span><br><span><var>Hvalidator</var><span class="hyp-type"><b>: </b><span><span class="kr">‚àÄ</span> <span class="nv">i</span> : index,
  component_message_validator_prop IM
    constraint i</span></span></span><br><span><var>s</var><span class="hyp-type"><b>: </b><span>state
  {|
    vlsm_type :=
      preloaded_with_all_messages_vlsm X;
    vlsm_machine :=
      preloaded_vlsm_machine X
        (<span class="kr">Œª</span> <span class="nv">_</span> : message, <span class="kt">True</span>)
  |}</span></span></span><br><span><var>tr</var><span class="hyp-type"><b>: </b><span>list transition_item</span></span></span><br><span><var>Htr</var><span class="hyp-type"><b>: </b><span>finite_valid_trace_from
  {|
    vlsm_type :=
      preloaded_with_all_messages_vlsm X;
    vlsm_machine :=
      preloaded_vlsm_machine X
        (<span class="kr">Œª</span> <span class="nv">_</span> : message, <span class="kt">True</span>)
  |} s tr</span></span></span><br><span><var>sf</var><span class="hyp-type"><b>: </b><span>state
  {|
    vlsm_type :=
      preloaded_with_all_messages_vlsm X;
    vlsm_machine :=
      preloaded_vlsm_machine X
        (<span class="kr">Œª</span> <span class="nv">_</span> : message, <span class="kt">True</span>)
  |}</span></span></span><br><span><var>iom, oom</var><span class="hyp-type"><b>: </b><span>option message</span></span></span><br><span><var>l</var><span class="hyp-type"><b>: </b><span>label
  {|
    vlsm_type :=
      preloaded_with_all_messages_vlsm X;
    vlsm_machine :=
      preloaded_vlsm_machine X
        (<span class="kr">Œª</span> <span class="nv">_</span> : message, <span class="kt">True</span>)
  |}</span></span></span><br><span><var>Hvx</var><span class="hyp-type"><b>: </b><span>input_valid
  {|
    vlsm_type :=
      preloaded_with_all_messages_vlsm X;
    vlsm_machine :=
      preloaded_vlsm_machine X
        (<span class="kr">Œª</span> <span class="nv">_</span> : message, <span class="kt">True</span>)
  |} l (finite_trace_last s tr, iom)</span></span></span><br><span><var>Htx</var><span class="hyp-type"><b>: </b><span>transition l (finite_trace_last s tr, iom) =
(sf, oom)</span></span></span><br><span><var>x</var><span><span class="hyp-body"><b>:= </b><span>{|
  l := l;
  input := iom;
  destination := sf;
  output := oom
|}</span></span><span class="hyp-type"><b>: </b><span>transition_item</span></span></span></span><br><span><var>Hs</var><span class="hyp-type"><b>: </b><span>initial_state_prop s</span></span></span><br><span><var>IHHtr</var><span class="hyp-type"><b>: </b><span>valid_state_prop
  {|
    vlsm_type :=
      preloaded_with_all_messages_vlsm X;
    vlsm_machine :=
      ConstrainedVLSM.constrained_vlsm_machine
        (free_composite_vlsm IM) constraint
  |} (finite_trace_last s tr)</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">option_valid_message_prop X iom</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="ByzantineTraces-v-chk47" style="display: none" type="checkbox"><label class="alectryon-input" for="ByzantineTraces-v-chk47"><span class="nb">destruct</span> Hvx <span class="kr">as</span> (Hlst &amp; _ &amp; Hv &amp; _).</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>message, index</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>EqDecision0</var><span class="hyp-type"><b>: </b><span>EqDecision index</span></span></span><br><span><var>IM</var><span class="hyp-type"><b>: </b><span>index ‚Üí VLSM message</span></span></span><br><span><var>constraint</var><span class="hyp-type"><b>: </b><span>composite_label IM
‚Üí composite_state IM * option message
  ‚Üí <span class="kt">Prop</span></span></span></span><br><span><var>X</var><span><span class="hyp-body"><b>:= </b><span>composite_vlsm IM constraint</span></span><span class="hyp-type"><b>: </b><span>VLSM message</span></span></span></span><br><span><var>Hvalidator</var><span class="hyp-type"><b>: </b><span><span class="kr">‚àÄ</span> <span class="nv">i</span> : index,
  component_message_validator_prop IM
    constraint i</span></span></span><br><span><var>s</var><span class="hyp-type"><b>: </b><span>state
  {|
    vlsm_type :=
      preloaded_with_all_messages_vlsm X;
    vlsm_machine :=
      preloaded_vlsm_machine X
        (<span class="kr">Œª</span> <span class="nv">_</span> : message, <span class="kt">True</span>)
  |}</span></span></span><br><span><var>tr</var><span class="hyp-type"><b>: </b><span>list transition_item</span></span></span><br><span><var>Htr</var><span class="hyp-type"><b>: </b><span>finite_valid_trace_from
  {|
    vlsm_type :=
      preloaded_with_all_messages_vlsm X;
    vlsm_machine :=
      preloaded_vlsm_machine X
        (<span class="kr">Œª</span> <span class="nv">_</span> : message, <span class="kt">True</span>)
  |} s tr</span></span></span><br><span><var>sf</var><span class="hyp-type"><b>: </b><span>state
  {|
    vlsm_type :=
      preloaded_with_all_messages_vlsm X;
    vlsm_machine :=
      preloaded_vlsm_machine X
        (<span class="kr">Œª</span> <span class="nv">_</span> : message, <span class="kt">True</span>)
  |}</span></span></span><br><span><var>iom, oom</var><span class="hyp-type"><b>: </b><span>option message</span></span></span><br><span><var>l</var><span class="hyp-type"><b>: </b><span>label
  {|
    vlsm_type :=
      preloaded_with_all_messages_vlsm X;
    vlsm_machine :=
      preloaded_vlsm_machine X
        (<span class="kr">Œª</span> <span class="nv">_</span> : message, <span class="kt">True</span>)
  |}</span></span></span><br><span><var>Hlst</var><span class="hyp-type"><b>: </b><span>valid_state_prop
  {|
    vlsm_type :=
      preloaded_with_all_messages_vlsm X;
    vlsm_machine :=
      preloaded_vlsm_machine X
        (<span class="kr">Œª</span> <span class="nv">_</span> : message, <span class="kt">True</span>)
  |} (finite_trace_last s tr)</span></span></span><br><span><var>Hv</var><span class="hyp-type"><b>: </b><span>valid l (finite_trace_last s tr, iom)</span></span></span><br><span><var>Htx</var><span class="hyp-type"><b>: </b><span>transition l (finite_trace_last s tr, iom) =
(sf, oom)</span></span></span><br><span><var>x</var><span><span class="hyp-body"><b>:= </b><span>{|
  l := l;
  input := iom;
  destination := sf;
  output := oom
|}</span></span><span class="hyp-type"><b>: </b><span>transition_item</span></span></span></span><br><span><var>Hs</var><span class="hyp-type"><b>: </b><span>initial_state_prop s</span></span></span><br><span><var>IHHtr</var><span class="hyp-type"><b>: </b><span>valid_state_prop
  {|
    vlsm_type :=
      preloaded_with_all_messages_vlsm X;
    vlsm_machine :=
      ConstrainedVLSM.constrained_vlsm_machine
        (free_composite_vlsm IM) constraint
  |} (finite_trace_last s tr)</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">option_valid_message_prop X iom</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="ByzantineTraces-v-chk48" style="display: none" type="checkbox"><label class="alectryon-input" for="ByzantineTraces-v-chk48"><span class="nb">destruct</span> l <span class="kr">as</span> [i li].</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>message, index</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>EqDecision0</var><span class="hyp-type"><b>: </b><span>EqDecision index</span></span></span><br><span><var>IM</var><span class="hyp-type"><b>: </b><span>index ‚Üí VLSM message</span></span></span><br><span><var>constraint</var><span class="hyp-type"><b>: </b><span>composite_label IM
‚Üí composite_state IM * option message
  ‚Üí <span class="kt">Prop</span></span></span></span><br><span><var>X</var><span><span class="hyp-body"><b>:= </b><span>composite_vlsm IM constraint</span></span><span class="hyp-type"><b>: </b><span>VLSM message</span></span></span></span><br><span><var>Hvalidator</var><span class="hyp-type"><b>: </b><span><span class="kr">‚àÄ</span> <span class="nv">i</span> : index,
  component_message_validator_prop IM
    constraint i</span></span></span><br><span><var>s</var><span class="hyp-type"><b>: </b><span>state
  {|
    vlsm_type :=
      preloaded_with_all_messages_vlsm X;
    vlsm_machine :=
      preloaded_vlsm_machine X
        (<span class="kr">Œª</span> <span class="nv">_</span> : message, <span class="kt">True</span>)
  |}</span></span></span><br><span><var>tr</var><span class="hyp-type"><b>: </b><span>list transition_item</span></span></span><br><span><var>Htr</var><span class="hyp-type"><b>: </b><span>finite_valid_trace_from
  {|
    vlsm_type :=
      preloaded_with_all_messages_vlsm X;
    vlsm_machine :=
      preloaded_vlsm_machine X
        (<span class="kr">Œª</span> <span class="nv">_</span> : message, <span class="kt">True</span>)
  |} s tr</span></span></span><br><span><var>sf</var><span class="hyp-type"><b>: </b><span>state
  {|
    vlsm_type :=
      preloaded_with_all_messages_vlsm X;
    vlsm_machine :=
      preloaded_vlsm_machine X
        (<span class="kr">Œª</span> <span class="nv">_</span> : message, <span class="kt">True</span>)
  |}</span></span></span><br><span><var>iom, oom</var><span class="hyp-type"><b>: </b><span>option message</span></span></span><br><span><var>i</var><span class="hyp-type"><b>: </b><span>index</span></span></span><br><span><var>li</var><span class="hyp-type"><b>: </b><span>label (IM i)</span></span></span><br><span><var>Hlst</var><span class="hyp-type"><b>: </b><span>valid_state_prop
  {|
    vlsm_type :=
      preloaded_with_all_messages_vlsm X;
    vlsm_machine :=
      preloaded_vlsm_machine X
        (<span class="kr">Œª</span> <span class="nv">_</span> : message, <span class="kt">True</span>)
  |} (finite_trace_last s tr)</span></span></span><br><span><var>Hv</var><span class="hyp-type"><b>: </b><span>valid (existT i li) (finite_trace_last s tr, iom)</span></span></span><br><span><var>Htx</var><span class="hyp-type"><b>: </b><span>transition (existT i li)
  (finite_trace_last s tr, iom) = (
sf, oom)</span></span></span><br><span><var>x</var><span><span class="hyp-body"><b>:= </b><span>{|
  l := existT i li;
  input := iom;
  destination := sf;
  output := oom
|}</span></span><span class="hyp-type"><b>: </b><span>transition_item</span></span></span></span><br><span><var>Hs</var><span class="hyp-type"><b>: </b><span>initial_state_prop s</span></span></span><br><span><var>IHHtr</var><span class="hyp-type"><b>: </b><span>valid_state_prop
  {|
    vlsm_type :=
      preloaded_with_all_messages_vlsm X;
    vlsm_machine :=
      ConstrainedVLSM.constrained_vlsm_machine
        (free_composite_vlsm IM) constraint
  |} (finite_trace_last s tr)</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">option_valid_message_prop X iom</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="ByzantineTraces-v-chk49" style="display: none" type="checkbox"><label class="alectryon-input" for="ByzantineTraces-v-chk49"><span class="nb">destruct</span> iom <span class="kr">as</span> [im |]; [| <span class="bp">by</span> <span class="nb">apply</span> option_valid_message_None].</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>message, index</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>EqDecision0</var><span class="hyp-type"><b>: </b><span>EqDecision index</span></span></span><br><span><var>IM</var><span class="hyp-type"><b>: </b><span>index ‚Üí VLSM message</span></span></span><br><span><var>constraint</var><span class="hyp-type"><b>: </b><span>composite_label IM
‚Üí composite_state IM * option message
  ‚Üí <span class="kt">Prop</span></span></span></span><br><span><var>X</var><span><span class="hyp-body"><b>:= </b><span>composite_vlsm IM constraint</span></span><span class="hyp-type"><b>: </b><span>VLSM message</span></span></span></span><br><span><var>Hvalidator</var><span class="hyp-type"><b>: </b><span><span class="kr">‚àÄ</span> <span class="nv">i</span> : index,
  component_message_validator_prop IM
    constraint i</span></span></span><br><span><var>s</var><span class="hyp-type"><b>: </b><span>state
  {|
    vlsm_type :=
      preloaded_with_all_messages_vlsm X;
    vlsm_machine :=
      preloaded_vlsm_machine X
        (<span class="kr">Œª</span> <span class="nv">_</span> : message, <span class="kt">True</span>)
  |}</span></span></span><br><span><var>tr</var><span class="hyp-type"><b>: </b><span>list transition_item</span></span></span><br><span><var>Htr</var><span class="hyp-type"><b>: </b><span>finite_valid_trace_from
  {|
    vlsm_type :=
      preloaded_with_all_messages_vlsm X;
    vlsm_machine :=
      preloaded_vlsm_machine X
        (<span class="kr">Œª</span> <span class="nv">_</span> : message, <span class="kt">True</span>)
  |} s tr</span></span></span><br><span><var>sf</var><span class="hyp-type"><b>: </b><span>state
  {|
    vlsm_type :=
      preloaded_with_all_messages_vlsm X;
    vlsm_machine :=
      preloaded_vlsm_machine X
        (<span class="kr">Œª</span> <span class="nv">_</span> : message, <span class="kt">True</span>)
  |}</span></span></span><br><span><var>im</var><span class="hyp-type"><b>: </b><span>message</span></span></span><br><span><var>oom</var><span class="hyp-type"><b>: </b><span>option message</span></span></span><br><span><var>i</var><span class="hyp-type"><b>: </b><span>index</span></span></span><br><span><var>li</var><span class="hyp-type"><b>: </b><span>label (IM i)</span></span></span><br><span><var>Hlst</var><span class="hyp-type"><b>: </b><span>valid_state_prop
  {|
    vlsm_type :=
      preloaded_with_all_messages_vlsm X;
    vlsm_machine :=
      preloaded_vlsm_machine X
        (<span class="kr">Œª</span> <span class="nv">_</span> : message, <span class="kt">True</span>)
  |} (finite_trace_last s tr)</span></span></span><br><span><var>Hv</var><span class="hyp-type"><b>: </b><span>valid (existT i li)
  (finite_trace_last s tr, Some im)</span></span></span><br><span><var>Htx</var><span class="hyp-type"><b>: </b><span>transition (existT i li)
  (finite_trace_last s tr, Some im) = (
sf, oom)</span></span></span><br><span><var>x</var><span><span class="hyp-body"><b>:= </b><span>{|
  l := existT i li;
  input := Some im;
  destination := sf;
  output := oom
|}</span></span><span class="hyp-type"><b>: </b><span>transition_item</span></span></span></span><br><span><var>Hs</var><span class="hyp-type"><b>: </b><span>initial_state_prop s</span></span></span><br><span><var>IHHtr</var><span class="hyp-type"><b>: </b><span>valid_state_prop
  {|
    vlsm_type :=
      preloaded_with_all_messages_vlsm X;
    vlsm_machine :=
      ConstrainedVLSM.constrained_vlsm_machine
        (free_composite_vlsm IM) constraint
  |} (finite_trace_last s tr)</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">option_valid_message_prop X (Some im)</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="ByzantineTraces-v-chk4a" style="display: none" type="checkbox"><label class="alectryon-input" for="ByzantineTraces-v-chk4a"><span class="nb">eapply</span> Hvalidator.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>message, index</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>EqDecision0</var><span class="hyp-type"><b>: </b><span>EqDecision index</span></span></span><br><span><var>IM</var><span class="hyp-type"><b>: </b><span>index ‚Üí VLSM message</span></span></span><br><span><var>constraint</var><span class="hyp-type"><b>: </b><span>composite_label IM
‚Üí composite_state IM * option message
  ‚Üí <span class="kt">Prop</span></span></span></span><br><span><var>X</var><span><span class="hyp-body"><b>:= </b><span>composite_vlsm IM constraint</span></span><span class="hyp-type"><b>: </b><span>VLSM message</span></span></span></span><br><span><var>Hvalidator</var><span class="hyp-type"><b>: </b><span><span class="kr">‚àÄ</span> <span class="nv">i</span> : index,
  component_message_validator_prop IM
    constraint i</span></span></span><br><span><var>s</var><span class="hyp-type"><b>: </b><span>state
  {|
    vlsm_type :=
      preloaded_with_all_messages_vlsm X;
    vlsm_machine :=
      preloaded_vlsm_machine X
        (<span class="kr">Œª</span> <span class="nv">_</span> : message, <span class="kt">True</span>)
  |}</span></span></span><br><span><var>tr</var><span class="hyp-type"><b>: </b><span>list transition_item</span></span></span><br><span><var>Htr</var><span class="hyp-type"><b>: </b><span>finite_valid_trace_from
  {|
    vlsm_type :=
      preloaded_with_all_messages_vlsm X;
    vlsm_machine :=
      preloaded_vlsm_machine X
        (<span class="kr">Œª</span> <span class="nv">_</span> : message, <span class="kt">True</span>)
  |} s tr</span></span></span><br><span><var>sf</var><span class="hyp-type"><b>: </b><span>state
  {|
    vlsm_type :=
      preloaded_with_all_messages_vlsm X;
    vlsm_machine :=
      preloaded_vlsm_machine X
        (<span class="kr">Œª</span> <span class="nv">_</span> : message, <span class="kt">True</span>)
  |}</span></span></span><br><span><var>im</var><span class="hyp-type"><b>: </b><span>message</span></span></span><br><span><var>oom</var><span class="hyp-type"><b>: </b><span>option message</span></span></span><br><span><var>i</var><span class="hyp-type"><b>: </b><span>index</span></span></span><br><span><var>li</var><span class="hyp-type"><b>: </b><span>label (IM i)</span></span></span><br><span><var>Hlst</var><span class="hyp-type"><b>: </b><span>valid_state_prop
  {|
    vlsm_type :=
      preloaded_with_all_messages_vlsm X;
    vlsm_machine :=
      preloaded_vlsm_machine X
        (<span class="kr">Œª</span> <span class="nv">_</span> : message, <span class="kt">True</span>)
  |} (finite_trace_last s tr)</span></span></span><br><span><var>Hv</var><span class="hyp-type"><b>: </b><span>valid (existT i li)
  (finite_trace_last s tr, Some im)</span></span></span><br><span><var>Htx</var><span class="hyp-type"><b>: </b><span>transition (existT i li)
  (finite_trace_last s tr, Some im) = (
sf, oom)</span></span></span><br><span><var>x</var><span><span class="hyp-body"><b>:= </b><span>{|
  l := existT i li;
  input := Some im;
  destination := sf;
  output := oom
|}</span></span><span class="hyp-type"><b>: </b><span>transition_item</span></span></span></span><br><span><var>Hs</var><span class="hyp-type"><b>: </b><span>initial_state_prop s</span></span></span><br><span><var>IHHtr</var><span class="hyp-type"><b>: </b><span>valid_state_prop
  {|
    vlsm_type :=
      preloaded_with_all_messages_vlsm X;
    vlsm_machine :=
      ConstrainedVLSM.constrained_vlsm_machine
        (free_composite_vlsm IM) constraint
  |} (finite_trace_last s tr)</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">input_constrained (IM <span class="nl">?i</span>) <span class="nl">?li</span> (<span class="nl">?si</span>, Some im)</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="ByzantineTraces-v-chk4b" style="display: none" type="checkbox"><label class="alectryon-input" for="ByzantineTraces-v-chk4b">split_and!; [| | <span class="bp">by</span> <span class="nb">cbn</span>; <span class="nb">apply</span> Hv].</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>message, index</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>EqDecision0</var><span class="hyp-type"><b>: </b><span>EqDecision index</span></span></span><br><span><var>IM</var><span class="hyp-type"><b>: </b><span>index ‚Üí VLSM message</span></span></span><br><span><var>constraint</var><span class="hyp-type"><b>: </b><span>composite_label IM
‚Üí composite_state IM * option message
  ‚Üí <span class="kt">Prop</span></span></span></span><br><span><var>X</var><span><span class="hyp-body"><b>:= </b><span>composite_vlsm IM constraint</span></span><span class="hyp-type"><b>: </b><span>VLSM message</span></span></span></span><br><span><var>Hvalidator</var><span class="hyp-type"><b>: </b><span><span class="kr">‚àÄ</span> <span class="nv">i</span> : index,
  component_message_validator_prop IM
    constraint i</span></span></span><br><span><var>s</var><span class="hyp-type"><b>: </b><span>state
  {|
    vlsm_type :=
      preloaded_with_all_messages_vlsm X;
    vlsm_machine :=
      preloaded_vlsm_machine X
        (<span class="kr">Œª</span> <span class="nv">_</span> : message, <span class="kt">True</span>)
  |}</span></span></span><br><span><var>tr</var><span class="hyp-type"><b>: </b><span>list transition_item</span></span></span><br><span><var>Htr</var><span class="hyp-type"><b>: </b><span>finite_valid_trace_from
  {|
    vlsm_type :=
      preloaded_with_all_messages_vlsm X;
    vlsm_machine :=
      preloaded_vlsm_machine X
        (<span class="kr">Œª</span> <span class="nv">_</span> : message, <span class="kt">True</span>)
  |} s tr</span></span></span><br><span><var>sf</var><span class="hyp-type"><b>: </b><span>state
  {|
    vlsm_type :=
      preloaded_with_all_messages_vlsm X;
    vlsm_machine :=
      preloaded_vlsm_machine X
        (<span class="kr">Œª</span> <span class="nv">_</span> : message, <span class="kt">True</span>)
  |}</span></span></span><br><span><var>im</var><span class="hyp-type"><b>: </b><span>message</span></span></span><br><span><var>oom</var><span class="hyp-type"><b>: </b><span>option message</span></span></span><br><span><var>i</var><span class="hyp-type"><b>: </b><span>index</span></span></span><br><span><var>li</var><span class="hyp-type"><b>: </b><span>label (IM i)</span></span></span><br><span><var>Hlst</var><span class="hyp-type"><b>: </b><span>valid_state_prop
  {|
    vlsm_type :=
      preloaded_with_all_messages_vlsm X;
    vlsm_machine :=
      preloaded_vlsm_machine X
        (<span class="kr">Œª</span> <span class="nv">_</span> : message, <span class="kt">True</span>)
  |} (finite_trace_last s tr)</span></span></span><br><span><var>Hv</var><span class="hyp-type"><b>: </b><span>valid (existT i li)
  (finite_trace_last s tr, Some im)</span></span></span><br><span><var>Htx</var><span class="hyp-type"><b>: </b><span>transition (existT i li)
  (finite_trace_last s tr, Some im) = (
sf, oom)</span></span></span><br><span><var>x</var><span><span class="hyp-body"><b>:= </b><span>{|
  l := existT i li;
  input := Some im;
  destination := sf;
  output := oom
|}</span></span><span class="hyp-type"><b>: </b><span>transition_item</span></span></span></span><br><span><var>Hs</var><span class="hyp-type"><b>: </b><span>initial_state_prop s</span></span></span><br><span><var>IHHtr</var><span class="hyp-type"><b>: </b><span>valid_state_prop
  {|
    vlsm_type :=
      preloaded_with_all_messages_vlsm X;
    vlsm_machine :=
      ConstrainedVLSM.constrained_vlsm_machine
        (free_composite_vlsm IM) constraint
  |} (finite_trace_last s tr)</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">valid_state_prop
  (preloaded_with_all_messages_vlsm (IM i))
  (finite_trace_last s tr i)</div></blockquote><div class="alectryon-extra-goals"><input class="alectryon-extra-goal-toggle" id="ByzantineTraces-v-chk4c" style="display: none" type="checkbox"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>message, index</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>EqDecision0</var><span class="hyp-type"><b>: </b><span>EqDecision index</span></span></span><br><span><var>IM</var><span class="hyp-type"><b>: </b><span>index ‚Üí VLSM message</span></span></span><br><span><var>constraint</var><span class="hyp-type"><b>: </b><span>composite_label IM
‚Üí composite_state IM * option message
  ‚Üí <span class="kt">Prop</span></span></span></span><br><span><var>X</var><span><span class="hyp-body"><b>:= </b><span>composite_vlsm IM constraint</span></span><span class="hyp-type"><b>: </b><span>VLSM message</span></span></span></span><br><span><var>Hvalidator</var><span class="hyp-type"><b>: </b><span><span class="kr">‚àÄ</span> <span class="nv">i</span> : index,
  component_message_validator_prop IM
    constraint i</span></span></span><br><span><var>s</var><span class="hyp-type"><b>: </b><span>state
  {|
    vlsm_type :=
      preloaded_with_all_messages_vlsm X;
    vlsm_machine :=
      preloaded_vlsm_machine X
        (<span class="kr">Œª</span> <span class="nv">_</span> : message, <span class="kt">True</span>)
  |}</span></span></span><br><span><var>tr</var><span class="hyp-type"><b>: </b><span>list transition_item</span></span></span><br><span><var>Htr</var><span class="hyp-type"><b>: </b><span>finite_valid_trace_from
  {|
    vlsm_type :=
      preloaded_with_all_messages_vlsm X;
    vlsm_machine :=
      preloaded_vlsm_machine X
        (<span class="kr">Œª</span> <span class="nv">_</span> : message, <span class="kt">True</span>)
  |} s tr</span></span></span><br><span><var>sf</var><span class="hyp-type"><b>: </b><span>state
  {|
    vlsm_type :=
      preloaded_with_all_messages_vlsm X;
    vlsm_machine :=
      preloaded_vlsm_machine X
        (<span class="kr">Œª</span> <span class="nv">_</span> : message, <span class="kt">True</span>)
  |}</span></span></span><br><span><var>im</var><span class="hyp-type"><b>: </b><span>message</span></span></span><br><span><var>oom</var><span class="hyp-type"><b>: </b><span>option message</span></span></span><br><span><var>i</var><span class="hyp-type"><b>: </b><span>index</span></span></span><br><span><var>li</var><span class="hyp-type"><b>: </b><span>label (IM i)</span></span></span><br><span><var>Hlst</var><span class="hyp-type"><b>: </b><span>valid_state_prop
  {|
    vlsm_type :=
      preloaded_with_all_messages_vlsm X;
    vlsm_machine :=
      preloaded_vlsm_machine X
        (<span class="kr">Œª</span> <span class="nv">_</span> : message, <span class="kt">True</span>)
  |} (finite_trace_last s tr)</span></span></span><br><span><var>Hv</var><span class="hyp-type"><b>: </b><span>valid (existT i li)
  (finite_trace_last s tr, Some im)</span></span></span><br><span><var>Htx</var><span class="hyp-type"><b>: </b><span>transition (existT i li)
  (finite_trace_last s tr, Some im) = (
sf, oom)</span></span></span><br><span><var>x</var><span><span class="hyp-body"><b>:= </b><span>{|
  l := existT i li;
  input := Some im;
  destination := sf;
  output := oom
|}</span></span><span class="hyp-type"><b>: </b><span>transition_item</span></span></span></span><br><span><var>Hs</var><span class="hyp-type"><b>: </b><span>initial_state_prop s</span></span></span><br><span><var>IHHtr</var><span class="hyp-type"><b>: </b><span>valid_state_prop
  {|
    vlsm_type :=
      preloaded_with_all_messages_vlsm X;
    vlsm_machine :=
      ConstrainedVLSM.constrained_vlsm_machine
        (free_composite_vlsm IM) constraint
  |} (finite_trace_last s tr)</span></span></span><br></div><label class="goal-separator" for="ByzantineTraces-v-chk4c"><hr></label><div class="goal-conclusion">option_valid_message_prop
  (preloaded_with_all_messages_vlsm (IM i)) 
  (Some im)</div></blockquote></div></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="ByzantineTraces-v-chk4d" style="display: none" type="checkbox"><label class="alectryon-input" for="ByzantineTraces-v-chk4d">-</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>message, index</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>EqDecision0</var><span class="hyp-type"><b>: </b><span>EqDecision index</span></span></span><br><span><var>IM</var><span class="hyp-type"><b>: </b><span>index ‚Üí VLSM message</span></span></span><br><span><var>constraint</var><span class="hyp-type"><b>: </b><span>composite_label IM
‚Üí composite_state IM * option message
  ‚Üí <span class="kt">Prop</span></span></span></span><br><span><var>X</var><span><span class="hyp-body"><b>:= </b><span>composite_vlsm IM constraint</span></span><span class="hyp-type"><b>: </b><span>VLSM message</span></span></span></span><br><span><var>Hvalidator</var><span class="hyp-type"><b>: </b><span><span class="kr">‚àÄ</span> <span class="nv">i</span> : index,
  component_message_validator_prop IM
    constraint i</span></span></span><br><span><var>s</var><span class="hyp-type"><b>: </b><span>state
  {|
    vlsm_type :=
      preloaded_with_all_messages_vlsm X;
    vlsm_machine :=
      preloaded_vlsm_machine X
        (<span class="kr">Œª</span> <span class="nv">_</span> : message, <span class="kt">True</span>)
  |}</span></span></span><br><span><var>tr</var><span class="hyp-type"><b>: </b><span>list transition_item</span></span></span><br><span><var>Htr</var><span class="hyp-type"><b>: </b><span>finite_valid_trace_from
  {|
    vlsm_type :=
      preloaded_with_all_messages_vlsm X;
    vlsm_machine :=
      preloaded_vlsm_machine X
        (<span class="kr">Œª</span> <span class="nv">_</span> : message, <span class="kt">True</span>)
  |} s tr</span></span></span><br><span><var>sf</var><span class="hyp-type"><b>: </b><span>state
  {|
    vlsm_type :=
      preloaded_with_all_messages_vlsm X;
    vlsm_machine :=
      preloaded_vlsm_machine X
        (<span class="kr">Œª</span> <span class="nv">_</span> : message, <span class="kt">True</span>)
  |}</span></span></span><br><span><var>im</var><span class="hyp-type"><b>: </b><span>message</span></span></span><br><span><var>oom</var><span class="hyp-type"><b>: </b><span>option message</span></span></span><br><span><var>i</var><span class="hyp-type"><b>: </b><span>index</span></span></span><br><span><var>li</var><span class="hyp-type"><b>: </b><span>label (IM i)</span></span></span><br><span><var>Hlst</var><span class="hyp-type"><b>: </b><span>valid_state_prop
  {|
    vlsm_type :=
      preloaded_with_all_messages_vlsm X;
    vlsm_machine :=
      preloaded_vlsm_machine X
        (<span class="kr">Œª</span> <span class="nv">_</span> : message, <span class="kt">True</span>)
  |} (finite_trace_last s tr)</span></span></span><br><span><var>Hv</var><span class="hyp-type"><b>: </b><span>valid (existT i li)
  (finite_trace_last s tr, Some im)</span></span></span><br><span><var>Htx</var><span class="hyp-type"><b>: </b><span>transition (existT i li)
  (finite_trace_last s tr, Some im) = (
sf, oom)</span></span></span><br><span><var>x</var><span><span class="hyp-body"><b>:= </b><span>{|
  l := existT i li;
  input := Some im;
  destination := sf;
  output := oom
|}</span></span><span class="hyp-type"><b>: </b><span>transition_item</span></span></span></span><br><span><var>Hs</var><span class="hyp-type"><b>: </b><span>initial_state_prop s</span></span></span><br><span><var>IHHtr</var><span class="hyp-type"><b>: </b><span>valid_state_prop
  {|
    vlsm_type :=
      preloaded_with_all_messages_vlsm X;
    vlsm_machine :=
      ConstrainedVLSM.constrained_vlsm_machine
        (free_composite_vlsm IM) constraint
  |} (finite_trace_last s tr)</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">valid_state_prop
  (preloaded_with_all_messages_vlsm (IM i))
  (finite_trace_last s tr i)</div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="bp">by</span> <span class="nb">eapply</span> valid_state_project_preloaded_to_preloaded <span class="kr">in</span> Hlst.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="ByzantineTraces-v-chk4e" style="display: none" type="checkbox"><label class="alectryon-input" for="ByzantineTraces-v-chk4e">-</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>message, index</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>EqDecision0</var><span class="hyp-type"><b>: </b><span>EqDecision index</span></span></span><br><span><var>IM</var><span class="hyp-type"><b>: </b><span>index ‚Üí VLSM message</span></span></span><br><span><var>constraint</var><span class="hyp-type"><b>: </b><span>composite_label IM
‚Üí composite_state IM * option message
  ‚Üí <span class="kt">Prop</span></span></span></span><br><span><var>X</var><span><span class="hyp-body"><b>:= </b><span>composite_vlsm IM constraint</span></span><span class="hyp-type"><b>: </b><span>VLSM message</span></span></span></span><br><span><var>Hvalidator</var><span class="hyp-type"><b>: </b><span><span class="kr">‚àÄ</span> <span class="nv">i</span> : index,
  component_message_validator_prop IM
    constraint i</span></span></span><br><span><var>s</var><span class="hyp-type"><b>: </b><span>state
  {|
    vlsm_type :=
      preloaded_with_all_messages_vlsm X;
    vlsm_machine :=
      preloaded_vlsm_machine X
        (<span class="kr">Œª</span> <span class="nv">_</span> : message, <span class="kt">True</span>)
  |}</span></span></span><br><span><var>tr</var><span class="hyp-type"><b>: </b><span>list transition_item</span></span></span><br><span><var>Htr</var><span class="hyp-type"><b>: </b><span>finite_valid_trace_from
  {|
    vlsm_type :=
      preloaded_with_all_messages_vlsm X;
    vlsm_machine :=
      preloaded_vlsm_machine X
        (<span class="kr">Œª</span> <span class="nv">_</span> : message, <span class="kt">True</span>)
  |} s tr</span></span></span><br><span><var>sf</var><span class="hyp-type"><b>: </b><span>state
  {|
    vlsm_type :=
      preloaded_with_all_messages_vlsm X;
    vlsm_machine :=
      preloaded_vlsm_machine X
        (<span class="kr">Œª</span> <span class="nv">_</span> : message, <span class="kt">True</span>)
  |}</span></span></span><br><span><var>im</var><span class="hyp-type"><b>: </b><span>message</span></span></span><br><span><var>oom</var><span class="hyp-type"><b>: </b><span>option message</span></span></span><br><span><var>i</var><span class="hyp-type"><b>: </b><span>index</span></span></span><br><span><var>li</var><span class="hyp-type"><b>: </b><span>label (IM i)</span></span></span><br><span><var>Hlst</var><span class="hyp-type"><b>: </b><span>valid_state_prop
  {|
    vlsm_type :=
      preloaded_with_all_messages_vlsm X;
    vlsm_machine :=
      preloaded_vlsm_machine X
        (<span class="kr">Œª</span> <span class="nv">_</span> : message, <span class="kt">True</span>)
  |} (finite_trace_last s tr)</span></span></span><br><span><var>Hv</var><span class="hyp-type"><b>: </b><span>valid (existT i li)
  (finite_trace_last s tr, Some im)</span></span></span><br><span><var>Htx</var><span class="hyp-type"><b>: </b><span>transition (existT i li)
  (finite_trace_last s tr, Some im) = (
sf, oom)</span></span></span><br><span><var>x</var><span><span class="hyp-body"><b>:= </b><span>{|
  l := existT i li;
  input := Some im;
  destination := sf;
  output := oom
|}</span></span><span class="hyp-type"><b>: </b><span>transition_item</span></span></span></span><br><span><var>Hs</var><span class="hyp-type"><b>: </b><span>initial_state_prop s</span></span></span><br><span><var>IHHtr</var><span class="hyp-type"><b>: </b><span>valid_state_prop
  {|
    vlsm_type :=
      preloaded_with_all_messages_vlsm X;
    vlsm_machine :=
      ConstrainedVLSM.constrained_vlsm_machine
        (free_composite_vlsm IM) constraint
  |} (finite_trace_last s tr)</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">option_valid_message_prop
  (preloaded_with_all_messages_vlsm (IM i)) (Some im)</div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="ByzantineTraces-v-chk4f" style="display: none" type="checkbox"><label class="alectryon-input" for="ByzantineTraces-v-chk4f"><span class="nb">eexists</span> _.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>message, index</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>EqDecision0</var><span class="hyp-type"><b>: </b><span>EqDecision index</span></span></span><br><span><var>IM</var><span class="hyp-type"><b>: </b><span>index ‚Üí VLSM message</span></span></span><br><span><var>constraint</var><span class="hyp-type"><b>: </b><span>composite_label IM
‚Üí composite_state IM * option message
  ‚Üí <span class="kt">Prop</span></span></span></span><br><span><var>X</var><span><span class="hyp-body"><b>:= </b><span>composite_vlsm IM constraint</span></span><span class="hyp-type"><b>: </b><span>VLSM message</span></span></span></span><br><span><var>Hvalidator</var><span class="hyp-type"><b>: </b><span><span class="kr">‚àÄ</span> <span class="nv">i</span> : index,
  component_message_validator_prop IM
    constraint i</span></span></span><br><span><var>s</var><span class="hyp-type"><b>: </b><span>state
  {|
    vlsm_type :=
      preloaded_with_all_messages_vlsm X;
    vlsm_machine :=
      preloaded_vlsm_machine X
        (<span class="kr">Œª</span> <span class="nv">_</span> : message, <span class="kt">True</span>)
  |}</span></span></span><br><span><var>tr</var><span class="hyp-type"><b>: </b><span>list transition_item</span></span></span><br><span><var>Htr</var><span class="hyp-type"><b>: </b><span>finite_valid_trace_from
  {|
    vlsm_type :=
      preloaded_with_all_messages_vlsm X;
    vlsm_machine :=
      preloaded_vlsm_machine X
        (<span class="kr">Œª</span> <span class="nv">_</span> : message, <span class="kt">True</span>)
  |} s tr</span></span></span><br><span><var>sf</var><span class="hyp-type"><b>: </b><span>state
  {|
    vlsm_type :=
      preloaded_with_all_messages_vlsm X;
    vlsm_machine :=
      preloaded_vlsm_machine X
        (<span class="kr">Œª</span> <span class="nv">_</span> : message, <span class="kt">True</span>)
  |}</span></span></span><br><span><var>im</var><span class="hyp-type"><b>: </b><span>message</span></span></span><br><span><var>oom</var><span class="hyp-type"><b>: </b><span>option message</span></span></span><br><span><var>i</var><span class="hyp-type"><b>: </b><span>index</span></span></span><br><span><var>li</var><span class="hyp-type"><b>: </b><span>label (IM i)</span></span></span><br><span><var>Hlst</var><span class="hyp-type"><b>: </b><span>valid_state_prop
  {|
    vlsm_type :=
      preloaded_with_all_messages_vlsm X;
    vlsm_machine :=
      preloaded_vlsm_machine X
        (<span class="kr">Œª</span> <span class="nv">_</span> : message, <span class="kt">True</span>)
  |} (finite_trace_last s tr)</span></span></span><br><span><var>Hv</var><span class="hyp-type"><b>: </b><span>valid (existT i li)
  (finite_trace_last s tr, Some im)</span></span></span><br><span><var>Htx</var><span class="hyp-type"><b>: </b><span>transition (existT i li)
  (finite_trace_last s tr, Some im) = (
sf, oom)</span></span></span><br><span><var>x</var><span><span class="hyp-body"><b>:= </b><span>{|
  l := existT i li;
  input := Some im;
  destination := sf;
  output := oom
|}</span></span><span class="hyp-type"><b>: </b><span>transition_item</span></span></span></span><br><span><var>Hs</var><span class="hyp-type"><b>: </b><span>initial_state_prop s</span></span></span><br><span><var>IHHtr</var><span class="hyp-type"><b>: </b><span>valid_state_prop
  {|
    vlsm_type :=
      preloaded_with_all_messages_vlsm X;
    vlsm_machine :=
      ConstrainedVLSM.constrained_vlsm_machine
        (free_composite_vlsm IM) constraint
  |} (finite_trace_last s tr)</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">valid_state_message_prop
  (preloaded_with_all_messages_vlsm (IM i)) <span class="nl">?Goal</span>
  (Some im)</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><span class="alectryon-input"><span class="bp">by</span> <span class="nb">apply</span> preloaded_with_all_messages_message_valid_initial_state_message.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Qed</span>.</span></span></pre><div class="doc">
  Finally, we can conclude that a composition of validator components can
  resist any kind of external influence.

</div><pre class="alectryon-io highlight"><!-- Generator: Alectryon --><span class="alectryon-sentence"><input class="alectryon-toggle" id="ByzantineTraces-v-chk50" style="display: none" type="checkbox"><label class="alectryon-input" for="ByzantineTraces-v-chk50"><span class="kn">Lemma</span> <span class="nf">composite_validator_byzantine_traces_are_not_byzantine</span> :
  <span class="kr">forall</span> (<span class="nv">tr</span> : Trace X),
    byzantine_trace_prop X tr -&gt;
    valid_trace_prop X tr.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>message, index</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>EqDecision0</var><span class="hyp-type"><b>: </b><span>EqDecision index</span></span></span><br><span><var>IM</var><span class="hyp-type"><b>: </b><span>index ‚Üí VLSM message</span></span></span><br><span><var>constraint</var><span class="hyp-type"><b>: </b><span>composite_label IM
‚Üí composite_state IM * option message
  ‚Üí <span class="kt">Prop</span></span></span></span><br><span><var>X</var><span><span class="hyp-body"><b>:= </b><span>composite_vlsm IM constraint</span></span><span class="hyp-type"><b>: </b><span>VLSM message</span></span></span></span><br><span><var>Hvalidator</var><span class="hyp-type"><b>: </b><span><span class="kr">‚àÄ</span> <span class="nv">i</span> : index,
  component_message_validator_prop IM
    constraint i</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="kr">‚àÄ</span> <span class="nv">tr</span> : Trace,
  byzantine_trace_prop X tr ‚Üí valid_trace_prop X tr</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="ByzantineTraces-v-chk51" style="display: none" type="checkbox"><label class="alectryon-input" for="ByzantineTraces-v-chk51"><span class="kn">Proof</span>.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>message, index</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>EqDecision0</var><span class="hyp-type"><b>: </b><span>EqDecision index</span></span></span><br><span><var>IM</var><span class="hyp-type"><b>: </b><span>index ‚Üí VLSM message</span></span></span><br><span><var>constraint</var><span class="hyp-type"><b>: </b><span>composite_label IM
‚Üí composite_state IM * option message
  ‚Üí <span class="kt">Prop</span></span></span></span><br><span><var>X</var><span><span class="hyp-body"><b>:= </b><span>composite_vlsm IM constraint</span></span><span class="hyp-type"><b>: </b><span>VLSM message</span></span></span></span><br><span><var>Hvalidator</var><span class="hyp-type"><b>: </b><span><span class="kr">‚àÄ</span> <span class="nv">i</span> : index,
  component_message_validator_prop IM
    constraint i</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="kr">‚àÄ</span> <span class="nv">tr</span> : Trace,
  byzantine_trace_prop X tr ‚Üí valid_trace_prop X tr</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="ByzantineTraces-v-chk52" style="display: none" type="checkbox"><label class="alectryon-input" for="ByzantineTraces-v-chk52"><span class="nb">intros</span> tr Hbyz.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>message, index</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>EqDecision0</var><span class="hyp-type"><b>: </b><span>EqDecision index</span></span></span><br><span><var>IM</var><span class="hyp-type"><b>: </b><span>index ‚Üí VLSM message</span></span></span><br><span><var>constraint</var><span class="hyp-type"><b>: </b><span>composite_label IM
‚Üí composite_state IM * option message
  ‚Üí <span class="kt">Prop</span></span></span></span><br><span><var>X</var><span><span class="hyp-body"><b>:= </b><span>composite_vlsm IM constraint</span></span><span class="hyp-type"><b>: </b><span>VLSM message</span></span></span></span><br><span><var>Hvalidator</var><span class="hyp-type"><b>: </b><span><span class="kr">‚àÄ</span> <span class="nv">i</span> : index,
  component_message_validator_prop IM
    constraint i</span></span></span><br><span><var>tr</var><span class="hyp-type"><b>: </b><span>Trace</span></span></span><br><span><var>Hbyz</var><span class="hyp-type"><b>: </b><span>byzantine_trace_prop X tr</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">valid_trace_prop X tr</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="ByzantineTraces-v-chk53" style="display: none" type="checkbox"><label class="alectryon-input" for="ByzantineTraces-v-chk53"><span class="nb">apply</span> validator_preloaded_with_all_messages_incl.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>message, index</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>EqDecision0</var><span class="hyp-type"><b>: </b><span>EqDecision index</span></span></span><br><span><var>IM</var><span class="hyp-type"><b>: </b><span>index ‚Üí VLSM message</span></span></span><br><span><var>constraint</var><span class="hyp-type"><b>: </b><span>composite_label IM
‚Üí composite_state IM * option message
  ‚Üí <span class="kt">Prop</span></span></span></span><br><span><var>X</var><span><span class="hyp-body"><b>:= </b><span>composite_vlsm IM constraint</span></span><span class="hyp-type"><b>: </b><span>VLSM message</span></span></span></span><br><span><var>Hvalidator</var><span class="hyp-type"><b>: </b><span><span class="kr">‚àÄ</span> <span class="nv">i</span> : index,
  component_message_validator_prop IM
    constraint i</span></span></span><br><span><var>tr</var><span class="hyp-type"><b>: </b><span>Trace</span></span></span><br><span><var>Hbyz</var><span class="hyp-type"><b>: </b><span>byzantine_trace_prop X tr</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">valid_trace_prop
  {|
    vlsm_type := preloaded_with_all_messages_vlsm X;
    vlsm_machine := preloaded_with_all_messages_vlsm X
  |} tr</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><span class="alectryon-input"><span class="bp">by</span> <span class="nb">apply</span> byzantine_alt_byzantine_iff, alt_preloaded_with_all_messages_incl <span class="kr">in</span> Hbyz.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Qed</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
</span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">End</span> <span class="nf">sec_composite_validator_byzantine_traces</span>.</span></span></pre></article></body></html>