<!DOCTYPE html>
<html class="alectryon-standalone"><head><title>Composition.v</title><meta charset="utf-8"><meta content="Alectryon" name="generator"><meta name="viewport" content="width=device-width, initial-scale=1"><link href="alectryon.css" rel="stylesheet"><link href="pygments.css" rel="stylesheet">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/IBM-type/0.5.4/css/ibm-type.min.css" integrity="sha512-sky5cf9Ts6FY1kstGOBHSybfKqdHR41M0Ldb0BjNiv3ifltoQIsg0zIaQ+wwdwgQ0w9vKFW7Js50lxH9vqNSSw==" crossorigin="anonymous" />
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/firacode/5.2.0/fira_code.min.css" integrity="sha512-MbysAYimH1hH2xYzkkMHB6MqxBqfP0megxsCLknbYqHVwXTCg9IqHbk+ZP/vnhO8UEW6PaXAkKe2vQ+SWACxxA==" crossorigin="anonymous" /><script src="alectryon.js"></script></head><body><article class="alectryon-root alectryon-windowed alectryon-coqdoc"><div class="alectryon-banner">Built with <a href="https://github.com/cpitclaudel/alectryon/">Alectryon</a>, running Coq+SerAPI v8.18.0+0.18.1. Bubbles (<span class="alectryon-bubble"></span>) indicate interactive fragments: hover for details, tap to reveal contents. Use <kbd>Ctrl+‚Üë</kbd> <kbd>Ctrl+‚Üì</kbd> to navigate, <kbd>Ctrl+üñ±Ô∏è</kbd> to focus. On Mac, use <kbd>‚åò</kbd> instead of <kbd>Ctrl</kbd>.</div><pre class="alectryon-io highlight"><!-- Generator: Alectryon --><span class="alectryon-sentence"><input class="alectryon-toggle" id="Composition-v-chk0" style="display: none" type="checkbox"><label class="alectryon-input" for="Composition-v-chk0"><span class="kn">From</span> VLSM.Lib <span class="kn">Require Import</span> Itauto.</label><small class="alectryon-output"><div><div class="alectryon-messages"><blockquote class="alectryon-message">[Loading ML file ring_plugin.cmxs (<span class="nb">using</span> legacy method) ... <span class="bp">done</span>]</blockquote><blockquote class="alectryon-message">[Loading ML file zify_plugin.cmxs (<span class="nb">using</span> legacy method) ... <span class="bp">done</span>]</blockquote><blockquote class="alectryon-message">[Loading ML file micromega_plugin.cmxs (<span class="nb">using</span> legacy method) ... <span class="bp">done</span>]</blockquote><blockquote class="alectryon-message">[Loading ML file btauto_plugin.cmxs (<span class="nb">using</span> legacy method) ... <span class="bp">done</span>]</blockquote><blockquote class="alectryon-message">[Loading ML file coq-itauto.plugin ... <span class="bp">done</span>]</blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">From</span> stdpp <span class="kn">Require Import</span> prelude finite.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">From</span> Coq <span class="kn">Require Import</span> Streams FunctionalExtensionality Eqdep_dec.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">From</span> VLSM.Lib <span class="kn">Require Import</span> Preamble ListExtras.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">From</span> VLSM.Core <span class="kn">Require Import</span> VLSM Plans VLSMProjections.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">From</span> VLSM.Core <span class="kn">Require Import</span> PreloadedVLSM ConstrainedVLSM.</span></span></pre><div class="doc">
<a id="lab1"></a><h1 class="section">Core: VLSM Composition</h1>
<div class="paragraph"> </div>

  This module provides Coq definitions for composite VLSMs and their projections
  to components.

</div><pre class="alectryon-io highlight"><!-- Generator: Alectryon --><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Section</span> <span class="nf">sec_VLSM_composition</span>.</span></span></pre><div class="doc">
  Let us fix a type for <code>message</code>s, and an <code>index</code> type for the VLSM components
  such that equality on <code>index</code> is decidable and let IM be a family of VLSMs
  indexed by <code>index</code>. Note that all <span class="inlinecode"><span class="id" title="var">VLSM</span></span>s share the same type of <code>message</code>s.

</div><pre class="alectryon-io highlight"><!-- Generator: Alectryon --><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Context</span>
  {<span class="nv">message</span> : <span class="kt">Type</span>}
  `{EqDecision index}
  (IM : index -&gt; VLSM message)
  .</span></span></pre><div class="doc">
<a id="lab2"></a><h2 class="section">Free VLSM composition</h2>
</div><pre class="alectryon-io highlight"><!-- Generator: Alectryon --><span class="alectryon-wsp"><span class="c">(*</span>
<span class="c">  A [composite_state] is an indexed family of [state]s, yielding for each</span>
<span class="c">  index &lt;&lt;n&gt;&gt; a [state] of [type] &lt;&lt;IT n&gt;&gt;, the [VLSMType] corresponding to</span>
<span class="c">  machine &lt;&lt;n&gt;&gt;.</span>

<span class="c">  Note that the [composite_state] type is the dependent product type of the</span>
<span class="c">  family of [state] types corresponding to each index.</span>
<span class="c">*)</span>
</span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Definition</span> <span class="nf">composite_state</span> : <span class="kt">Type</span> :=
  <span class="kr">forall</span> <span class="nv">n</span> : index, state (IM n).</span></span></pre><div class="doc">
  A <span class="inlinecode"><span class="id" title="var">composite_label</span></span> is a pair between an index <code>N</code> and a <span class="inlinecode"><span class="id" title="var">label</span></span> of <code>IT n</code>.

<div class="paragraph"> </div>

  Note that the <span class="inlinecode"><span class="id" title="var">composite_label</span></span> type is the dependent sum of the family of
  types <code>[label (IT n) | n &lt;- index]</code>.

</div><pre class="alectryon-io highlight"><!-- Generator: Alectryon --><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Definition</span> <span class="nf">composite_label</span> : <span class="kt">Type</span> :=
  {n : index &amp; label (IM n)}.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
<span class="c">(*</span>
<span class="c">  Declaring this a &quot;canonical structure&quot; will make type checking</span>
<span class="c">  guess that a VLSMType should be composite_type instead of just</span>
<span class="c">  failing, if it has to compare composite_state with state or</span>
<span class="c">  state of an unsolved VLSMType or VLSM.</span>
<span class="c">*)</span>
</span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Canonical Structure</span> <span class="nf">composite_type</span> : VLSMType message :=
{|
  state := composite_state;
  label := composite_label;
|}.</span></span></pre><div class="doc">
  A <span class="inlinecode"><span class="id" title="var">composite_state</span></span> has the <span class="inlinecode"><span class="id" title="var">initial_state_prop</span></span>erty if all of its component
  states have the <span class="inlinecode"><span class="id" title="var">initial_state_prop</span></span>erty in the corresponding component signature.

</div><pre class="alectryon-io highlight"><!-- Generator: Alectryon --><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Definition</span> <span class="nf">composite_initial_state_prop</span> (<span class="nv">s</span> : composite_state) : <span class="kt">Prop</span> :=
  <span class="kr">forall</span> <span class="nv">n</span> : index, initial_state_prop (IM n) (s n).</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
</span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Definition</span> <span class="nf">composite_initial_state</span> : <span class="kt">Type</span> :=
  {s : composite_state | composite_initial_state_prop s}.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
</span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Program Definition</span> <span class="nf">composite_s0</span> : composite_initial_state :=
  exist _ (<span class="kr">fun</span> (<span class="nv">n</span> : index) =&gt; `(vs0 (IM n))) _.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="Composition-v-chk1" style="display: none" type="checkbox"><label class="alectryon-input" for="Composition-v-chk1"><span class="kn">Next Obligation</span>.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>message, index</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>EqDecision0</var><span class="hyp-type"><b>: </b><span>EqDecision index</span></span></span><br><span><var>IM</var><span class="hyp-type"><b>: </b><span>index ‚Üí VLSM message</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">(<span class="kr">Œª</span> <span class="nv">s</span> : composite_state, composite_initial_state_prop s)
  (<span class="kr">Œª</span> <span class="nv">n</span> : index, `(vs0 (IM n)))</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="Composition-v-chk2" style="display: none" type="checkbox"><label class="alectryon-input" for="Composition-v-chk2"><span class="kn">Proof</span>.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>message, index</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>EqDecision0</var><span class="hyp-type"><b>: </b><span>EqDecision index</span></span></span><br><span><var>IM</var><span class="hyp-type"><b>: </b><span>index ‚Üí VLSM message</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">(<span class="kr">Œª</span> <span class="nv">s</span> : composite_state, composite_initial_state_prop s)
  (<span class="kr">Œª</span> <span class="nv">n</span> : index, `(vs0 (IM n)))</div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="bp">by</span> <span class="nb">intros</span> i; <span class="nb">destruct</span> (vs0 (IM i)).</span><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Defined</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
</span><span class="alectryon-sentence"><span class="alectryon-input">#[export] <span class="kn">Instance</span> <span class="nf">composite_initial_state_inh</span> : Inhabited composite_initial_state :=
  populate composite_s0.</span></span></pre><div class="doc">
  A message has the <span class="inlinecode"><span class="id" title="var">initial_message_prop</span></span>erty in the composite
  iff it has the <span class="inlinecode"><span class="id" title="var">initial_message_prop</span></span>erty in any of the components.

</div><pre class="alectryon-io highlight"><!-- Generator: Alectryon --><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Definition</span> <span class="nf">composite_initial_message_prop</span> (<span class="nv">m</span> : message) : <span class="kt">Prop</span> :=
  <span class="kr">exists</span> (<span class="nv">n</span> : index) (<span class="nv">mi</span> : initial_message (IM n)), proj1_sig mi = m.</span></span></pre><div class="doc">
  A very useful operation on <span class="inlinecode"><span class="id" title="var">composite_state</span></span>s is updating the state corresponding
  to a component.

</div><pre class="alectryon-io highlight"><!-- Generator: Alectryon --><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Definition</span> <span class="nf">state_update</span>
  (<span class="nv">s</span> : composite_state) (<span class="nv">i</span> : index) (<span class="nv">si</span> : state (IM i)) (<span class="nv">j</span> : index) : state (IM j) :=
  <span class="kr">match</span> decide (j = i) <span class="kr">with</span>
  | <span class="nb">left</span> e =&gt; eq_rect_r (<span class="kr">fun</span> <span class="nv">i</span> =&gt; state (IM i)) si e
  | _ =&gt; s j
  <span class="kr">end</span>.</span></span></pre><div class="doc">
  The <span class="inlinecode"><span class="id" title="var">transition</span></span> function for the <span class="inlinecode"><span class="id" title="var">composite_vlsm</span></span> takes a transition in
  the component selected by the index in the given <span class="inlinecode"><span class="id" title="var">composite_label</span></span>
  with the contained label, and returns the produced message together with
  the state updated on that component.

</div><pre class="alectryon-io highlight"><!-- Generator: Alectryon --><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Definition</span> <span class="nf">composite_transition</span>
  (<span class="nv">l</span> : composite_label) (<span class="nv">som</span> : composite_state * option message)
  : composite_state * option message :=
  <span class="kr">let</span> (<span class="nv">s</span>, om) := som <span class="kr">in</span>
  <span class="kr">let</span> (<span class="nv">i</span>, li) := l <span class="kr">in</span>
  <span class="kr">let</span> (<span class="nv">si&#39;</span>, om&#39;) := transition (IM i) li (s i, om) <span class="kr">in</span>
    (state_update s i si&#39;,  om&#39;).</span></span></pre><div class="doc">
  Given a <span class="inlinecode"><span class="id" title="var">composite_label</span></span> <code>(i, li)</code> and a <span class="inlinecode"><span class="id" title="var">composite_state</span></span>-message
  pair <code>(s, om)</code>, <span class="inlinecode"><span class="id" title="var">composite_valid</span></span>ity is defined as <span class="inlinecode"><span class="id" title="var">valid</span></span>ity in
  the <code>i</code>th component <code>IM i</code>.

</div><pre class="alectryon-io highlight"><!-- Generator: Alectryon --><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Definition</span> <span class="nf">composite_valid</span>
  (<span class="nv">l</span> : composite_label) (<span class="nv">som</span> : composite_state * option message) : <span class="kt">Prop</span> :=
  <span class="kr">let</span> (<span class="nv">s</span>, om) := som <span class="kr">in</span>
  <span class="kr">let</span> (<span class="nv">i</span>, li) := l <span class="kr">in</span>
    valid (IM i) li (s i, om).</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
</span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Definition</span> <span class="nf">free_composite_vlsm_machine</span> : VLSMMachine composite_type :=
{|
  initial_state_prop := composite_initial_state_prop;
  initial_message_prop := composite_initial_message_prop;
  transition := composite_transition;
  valid := composite_valid;
|}.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
</span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Definition</span> <span class="nf">free_composite_vlsm</span> : VLSM message :=
  mk_vlsm free_composite_vlsm_machine.</span></span></pre><div class="doc">
  Composite versions for <span class="inlinecode"><span class="id" title="var">transition_item</span></span>, <span class="inlinecode"><span class="id" title="var">option_initial_message_prop</span></span> and
  things related to plans and plan items.

</div><pre class="alectryon-io highlight"><!-- Generator: Alectryon --><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Definition</span> <span class="nf">composite_transition_item</span> : <span class="kt">Type</span> := transition_item composite_type.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
</span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Definition</span> <span class="nf">option_composite_initial_message_prop</span> : option message -&gt; <span class="kt">Prop</span> :=
  from_option composite_initial_message_prop <span class="kt">True</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
</span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Definition</span> <span class="nf">composite_plan_item</span> : <span class="kt">Type</span> := plan_item composite_type.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
</span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Definition</span> <span class="nf">composite_plan</span> : <span class="kt">Type</span> := list composite_plan_item.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
</span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Definition</span> <span class="nf">composite_apply_plan</span> := (@_apply_plan _ composite_type composite_transition).</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
</span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Definition</span> <span class="nf">composite_apply_plan_app</span>
  (<span class="nv">start</span> : composite_state)
  (<span class="nv">a</span> <span class="nv">a&#39;</span> : list plan_item)
  : composite_apply_plan start (a ++ a&#39;) =
    <span class="kr">let</span> (<span class="nv">aitems</span>, afinal) := composite_apply_plan start a <span class="kr">in</span>
    <span class="kr">let</span> (<span class="nv">a&#39;items</span>, a&#39;final) := composite_apply_plan afinal a&#39; <span class="kr">in</span>
     (aitems ++ a&#39;items, a&#39;final)
  := (@_apply_plan_app _ composite_type composite_transition start a a&#39;).</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
</span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Definition</span> <span class="nf">composite_apply_plan_last</span>
  (<span class="nv">start</span> : composite_state)
  (<span class="nv">a</span> : list plan_item)
  (<span class="nv">after_a</span> := composite_apply_plan start a)
  : finite_trace_last start (fst after_a) = snd after_a
  := (@_apply_plan_last _ composite_type composite_transition start a).</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
</span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Definition</span> <span class="nf">composite_trace_to_plan</span> := (@_trace_to_plan _ composite_type).</span></span></pre><div class="doc">
<a id="lab3"></a><h2 class="section">Constrained VLSM composition</h2>
<div class="paragraph"> </div>

  A constrained VLSM composition is a free composition which is further
  constrained with an additional validity constraint.

</div><pre class="alectryon-io highlight"><!-- Generator: Alectryon --><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Definition</span> <span class="nf">composite_vlsm</span>
  (<span class="nv">constraint</span> : composite_label -&gt; composite_state * option message -&gt; <span class="kt">Prop</span>) : VLSM message :=
    constrained_vlsm free_composite_vlsm constraint.</span></span></pre><div class="doc">
<span class="inlinecode"><span class="id" title="var">free_constraint</span></span> is the constraint that is always true. 
</div><pre class="alectryon-io highlight"><!-- Generator: Alectryon --><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Definition</span> <span class="nf">free_constraint</span> : composite_label -&gt; composite_state * option message -&gt; <span class="kt">Prop</span> :=
  <span class="kr">fun</span> <span class="nv">_</span> <span class="nv">_</span> =&gt; <span class="kt">True</span>.</span></span></pre><div class="doc">
<span class="inlinecode"><span class="id" title="var">free_composite_vlsm</span></span> is equivalent to a <span class="inlinecode"><span class="id" title="var">composite_vlsm</span></span> with a free
  constraint.

</div><pre class="alectryon-io highlight"><!-- Generator: Alectryon --><span class="alectryon-sentence"><input class="alectryon-toggle" id="Composition-v-chk3" style="display: none" type="checkbox"><label class="alectryon-input" for="Composition-v-chk3"><span class="kn">Lemma</span> <span class="nf">free_composite_vlsm_spec</span> :
  VLSM_eq free_composite_vlsm (composite_vlsm free_constraint).</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>message, index</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>EqDecision0</var><span class="hyp-type"><b>: </b><span>EqDecision index</span></span></span><br><span><var>IM</var><span class="hyp-type"><b>: </b><span>index ‚Üí VLSM message</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">VLSM_eq free_composite_vlsm
  (composite_vlsm free_constraint)</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="Composition-v-chk4" style="display: none" type="checkbox"><label class="alectryon-input" for="Composition-v-chk4"><span class="kn">Proof</span>.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>message, index</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>EqDecision0</var><span class="hyp-type"><b>: </b><span>EqDecision index</span></span></span><br><span><var>IM</var><span class="hyp-type"><b>: </b><span>index ‚Üí VLSM message</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">VLSM_eq free_composite_vlsm
  (composite_vlsm free_constraint)</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="Composition-v-chk5" style="display: none" type="checkbox"><label class="alectryon-input" for="Composition-v-chk5"><span class="nb">split</span>.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>message, index</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>EqDecision0</var><span class="hyp-type"><b>: </b><span>EqDecision index</span></span></span><br><span><var>IM</var><span class="hyp-type"><b>: </b><span>index ‚Üí VLSM message</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">VLSM_incl
  {|
    vlsm_type := free_composite_vlsm;
    vlsm_machine := free_composite_vlsm
  |}
  {|
    vlsm_type := free_composite_vlsm;
    vlsm_machine := composite_vlsm free_constraint
  |}</div></blockquote><div class="alectryon-extra-goals"><input class="alectryon-extra-goal-toggle" id="Composition-v-chk6" style="display: none" type="checkbox"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>message, index</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>EqDecision0</var><span class="hyp-type"><b>: </b><span>EqDecision index</span></span></span><br><span><var>IM</var><span class="hyp-type"><b>: </b><span>index ‚Üí VLSM message</span></span></span><br></div><label class="goal-separator" for="Composition-v-chk6"><hr></label><div class="goal-conclusion">VLSM_incl
  {|
    vlsm_type := free_composite_vlsm;
    vlsm_machine := composite_vlsm free_constraint
  |}
  {|
    vlsm_type := free_composite_vlsm;
    vlsm_machine := free_composite_vlsm
  |}</div></blockquote></div></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="Composition-v-chk7" style="display: none" type="checkbox"><label class="alectryon-input" for="Composition-v-chk7">-</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>message, index</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>EqDecision0</var><span class="hyp-type"><b>: </b><span>EqDecision index</span></span></span><br><span><var>IM</var><span class="hyp-type"><b>: </b><span>index ‚Üí VLSM message</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">VLSM_incl
  {|
    vlsm_type := free_composite_vlsm;
    vlsm_machine := free_composite_vlsm
  |}
  {|
    vlsm_type := free_composite_vlsm;
    vlsm_machine := composite_vlsm free_constraint
  |}</div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="Composition-v-chk8" style="display: none" type="checkbox"><label class="alectryon-input" for="Composition-v-chk8"><span class="nb">apply</span> (VLSM_incl_embedding_iff); <span class="nb">cbn</span>.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>message, index</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>EqDecision0</var><span class="hyp-type"><b>: </b><span>EqDecision index</span></span></span><br><span><var>IM</var><span class="hyp-type"><b>: </b><span>index ‚Üí VLSM message</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">VLSM_embedding
  {|
    vlsm_type := composite_type;
    vlsm_machine := free_composite_vlsm_machine
  |}
  {|
    vlsm_type := composite_type;
    vlsm_machine :=
      constrained_vlsm_machine free_composite_vlsm
        free_constraint
  |} id id</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><span class="alectryon-input"><span class="bp">by</span> <span class="nb">apply</span> basic_VLSM_strong_embedding; <span class="nb">red</span>; <span class="nb">cbn</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="Composition-v-chk9" style="display: none" type="checkbox"><label class="alectryon-input" for="Composition-v-chk9">-</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>message, index</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>EqDecision0</var><span class="hyp-type"><b>: </b><span>EqDecision index</span></span></span><br><span><var>IM</var><span class="hyp-type"><b>: </b><span>index ‚Üí VLSM message</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">VLSM_incl
  {|
    vlsm_type := free_composite_vlsm;
    vlsm_machine := composite_vlsm free_constraint
  |}
  {|
    vlsm_type := free_composite_vlsm;
    vlsm_machine := free_composite_vlsm
  |}</div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="Composition-v-chka" style="display: none" type="checkbox"><label class="alectryon-input" for="Composition-v-chka"><span class="nb">apply</span> (VLSM_incl_embedding_iff); <span class="nb">cbn</span>.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>message, index</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>EqDecision0</var><span class="hyp-type"><b>: </b><span>EqDecision index</span></span></span><br><span><var>IM</var><span class="hyp-type"><b>: </b><span>index ‚Üí VLSM message</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">VLSM_embedding
  {|
    vlsm_type := composite_type;
    vlsm_machine :=
      constrained_vlsm_machine free_composite_vlsm
        free_constraint
  |}
  {|
    vlsm_type := composite_type;
    vlsm_machine := free_composite_vlsm_machine
  |} id id</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="Composition-v-chkb" style="display: none" type="checkbox"><label class="alectryon-input" for="Composition-v-chkb"><span class="nb">apply</span> basic_VLSM_strong_embedding; <span class="nb">red</span>; <span class="nb">cbn</span>; [| <span class="bp">done</span>..].</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>message, index</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>EqDecision0</var><span class="hyp-type"><b>: </b><span>EqDecision index</span></span></span><br><span><var>IM</var><span class="hyp-type"><b>: </b><span>index ‚Üí VLSM message</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="kr">‚àÄ</span> (<span class="nv">l</span> : composite_label) (<span class="nv">s</span> : composite_state) (<span class="nv">om</span> : 
                                               option
                                                 message),
  (<span class="kr">let</span> (<span class="nv">i</span>, li) := l <span class="kr">in</span> valid li (s i, om))
  ‚àß free_constraint l (s, om)
  ‚Üí <span class="kr">let</span> (<span class="nv">i</span>, li) := l <span class="kr">in</span> valid li (s i, om)</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><span class="alectryon-input"><span class="bp">by</span> itauto.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Qed</span>.</span></span></pre><div class="doc">
<span class="inlinecode"><span class="id" title="var">free_composite_vlsm</span></span> is equivalent to <span class="inlinecode"><span class="id" title="var">composite_vlsm</span></span> with free constraint
  also when preloaded with messages.

</div><pre class="alectryon-io highlight"><!-- Generator: Alectryon --><span class="alectryon-sentence"><input class="alectryon-toggle" id="Composition-v-chkc" style="display: none" type="checkbox"><label class="alectryon-input" for="Composition-v-chkc"><span class="kn">Lemma</span> <span class="nf">preloaded_free_composite_vlsm_spec</span> :
  <span class="kr">forall</span> (<span class="nv">initial</span> : message -&gt; <span class="kt">Prop</span>),
    VLSM_eq
      (preloaded_vlsm free_composite_vlsm initial)
      (preloaded_vlsm (composite_vlsm free_constraint) initial).</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>message, index</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>EqDecision0</var><span class="hyp-type"><b>: </b><span>EqDecision index</span></span></span><br><span><var>IM</var><span class="hyp-type"><b>: </b><span>index ‚Üí VLSM message</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="kr">‚àÄ</span> <span class="nv">initial</span> : message ‚Üí <span class="kt">Prop</span>,
  VLSM_eq (preloaded_vlsm free_composite_vlsm initial)
    (preloaded_vlsm (composite_vlsm free_constraint)
       initial)</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="Composition-v-chkd" style="display: none" type="checkbox"><label class="alectryon-input" for="Composition-v-chkd"><span class="kn">Proof</span>.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>message, index</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>EqDecision0</var><span class="hyp-type"><b>: </b><span>EqDecision index</span></span></span><br><span><var>IM</var><span class="hyp-type"><b>: </b><span>index ‚Üí VLSM message</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="kr">‚àÄ</span> <span class="nv">initial</span> : message ‚Üí <span class="kt">Prop</span>,
  VLSM_eq (preloaded_vlsm free_composite_vlsm initial)
    (preloaded_vlsm (composite_vlsm free_constraint)
       initial)</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="Composition-v-chke" style="display: none" type="checkbox"><label class="alectryon-input" for="Composition-v-chke"><span class="nb">split</span>.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>message, index</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>EqDecision0</var><span class="hyp-type"><b>: </b><span>EqDecision index</span></span></span><br><span><var>IM</var><span class="hyp-type"><b>: </b><span>index ‚Üí VLSM message</span></span></span><br><span><var>initial</var><span class="hyp-type"><b>: </b><span>message ‚Üí <span class="kt">Prop</span></span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">VLSM_incl
  {|
    vlsm_type :=
      preloaded_vlsm free_composite_vlsm initial;
    vlsm_machine :=
      preloaded_vlsm free_composite_vlsm initial
  |}
  {|
    vlsm_type :=
      preloaded_vlsm free_composite_vlsm initial;
    vlsm_machine :=
      preloaded_vlsm (composite_vlsm free_constraint)
        initial
  |}</div></blockquote><div class="alectryon-extra-goals"><input class="alectryon-extra-goal-toggle" id="Composition-v-chkf" style="display: none" type="checkbox"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>message, index</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>EqDecision0</var><span class="hyp-type"><b>: </b><span>EqDecision index</span></span></span><br><span><var>IM</var><span class="hyp-type"><b>: </b><span>index ‚Üí VLSM message</span></span></span><br><span><var>initial</var><span class="hyp-type"><b>: </b><span>message ‚Üí <span class="kt">Prop</span></span></span></span><br></div><label class="goal-separator" for="Composition-v-chkf"><hr></label><div class="goal-conclusion">VLSM_incl
  {|
    vlsm_type :=
      preloaded_vlsm free_composite_vlsm initial;
    vlsm_machine :=
      preloaded_vlsm (composite_vlsm free_constraint)
        initial
  |}
  {|
    vlsm_type :=
      preloaded_vlsm free_composite_vlsm initial;
    vlsm_machine :=
      preloaded_vlsm free_composite_vlsm initial
  |}</div></blockquote></div></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="Composition-v-chk10" style="display: none" type="checkbox"><label class="alectryon-input" for="Composition-v-chk10">-</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>message, index</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>EqDecision0</var><span class="hyp-type"><b>: </b><span>EqDecision index</span></span></span><br><span><var>IM</var><span class="hyp-type"><b>: </b><span>index ‚Üí VLSM message</span></span></span><br><span><var>initial</var><span class="hyp-type"><b>: </b><span>message ‚Üí <span class="kt">Prop</span></span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">VLSM_incl
  {|
    vlsm_type :=
      preloaded_vlsm free_composite_vlsm initial;
    vlsm_machine :=
      preloaded_vlsm free_composite_vlsm initial
  |}
  {|
    vlsm_type :=
      preloaded_vlsm free_composite_vlsm initial;
    vlsm_machine :=
      preloaded_vlsm (composite_vlsm free_constraint)
        initial
  |}</div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="Composition-v-chk11" style="display: none" type="checkbox"><label class="alectryon-input" for="Composition-v-chk11"><span class="nb">apply</span> (VLSM_incl_embedding_iff); <span class="nb">cbn</span>.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>message, index</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>EqDecision0</var><span class="hyp-type"><b>: </b><span>EqDecision index</span></span></span><br><span><var>IM</var><span class="hyp-type"><b>: </b><span>index ‚Üí VLSM message</span></span></span><br><span><var>initial</var><span class="hyp-type"><b>: </b><span>message ‚Üí <span class="kt">Prop</span></span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">VLSM_embedding
  {|
    vlsm_type := composite_type;
    vlsm_machine :=
      preloaded_vlsm_machine free_composite_vlsm
        initial
  |}
  {|
    vlsm_type := composite_type;
    vlsm_machine :=
      preloaded_vlsm_machine
        (composite_vlsm free_constraint) initial
  |} id id</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><span class="alectryon-input"><span class="bp">by</span> <span class="nb">apply</span> basic_VLSM_strong_embedding; <span class="nb">red</span>; <span class="nb">cbn</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="Composition-v-chk12" style="display: none" type="checkbox"><label class="alectryon-input" for="Composition-v-chk12">-</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>message, index</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>EqDecision0</var><span class="hyp-type"><b>: </b><span>EqDecision index</span></span></span><br><span><var>IM</var><span class="hyp-type"><b>: </b><span>index ‚Üí VLSM message</span></span></span><br><span><var>initial</var><span class="hyp-type"><b>: </b><span>message ‚Üí <span class="kt">Prop</span></span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">VLSM_incl
  {|
    vlsm_type :=
      preloaded_vlsm free_composite_vlsm initial;
    vlsm_machine :=
      preloaded_vlsm (composite_vlsm free_constraint)
        initial
  |}
  {|
    vlsm_type :=
      preloaded_vlsm free_composite_vlsm initial;
    vlsm_machine :=
      preloaded_vlsm free_composite_vlsm initial
  |}</div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="Composition-v-chk13" style="display: none" type="checkbox"><label class="alectryon-input" for="Composition-v-chk13"><span class="nb">apply</span> (VLSM_incl_embedding_iff); <span class="nb">cbn</span>.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>message, index</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>EqDecision0</var><span class="hyp-type"><b>: </b><span>EqDecision index</span></span></span><br><span><var>IM</var><span class="hyp-type"><b>: </b><span>index ‚Üí VLSM message</span></span></span><br><span><var>initial</var><span class="hyp-type"><b>: </b><span>message ‚Üí <span class="kt">Prop</span></span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">VLSM_embedding
  {|
    vlsm_type := composite_type;
    vlsm_machine :=
      preloaded_vlsm_machine
        (composite_vlsm free_constraint) initial
  |}
  {|
    vlsm_type := composite_type;
    vlsm_machine :=
      preloaded_vlsm_machine free_composite_vlsm
        initial
  |} id id</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="Composition-v-chk14" style="display: none" type="checkbox"><label class="alectryon-input" for="Composition-v-chk14"><span class="nb">apply</span> basic_VLSM_strong_embedding; <span class="nb">red</span>; <span class="nb">cbn</span>; [| <span class="bp">done</span>..].</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>message, index</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>EqDecision0</var><span class="hyp-type"><b>: </b><span>EqDecision index</span></span></span><br><span><var>IM</var><span class="hyp-type"><b>: </b><span>index ‚Üí VLSM message</span></span></span><br><span><var>initial</var><span class="hyp-type"><b>: </b><span>message ‚Üí <span class="kt">Prop</span></span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="kr">‚àÄ</span> (<span class="nv">l</span> : composite_label) (<span class="nv">s</span> : composite_state) (<span class="nv">om</span> : 
                                               option
                                                 message),
  (<span class="kr">let</span> (<span class="nv">i</span>, li) := l <span class="kr">in</span> valid li (s i, om))
  ‚àß free_constraint l (s, om)
  ‚Üí <span class="kr">let</span> (<span class="nv">i</span>, li) := l <span class="kr">in</span> valid li (s i, om)</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><span class="alectryon-input"><span class="bp">by</span> itauto.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Qed</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
</span><span class="alectryon-sentence"><input class="alectryon-toggle" id="Composition-v-chk15" style="display: none" type="checkbox"><label class="alectryon-input" for="Composition-v-chk15"><span class="kn">Lemma</span> <span class="nf">preloaded_with_all_messages_free_composite_vlsm_spec</span> :
  VLSM_eq
    (preloaded_with_all_messages_vlsm free_composite_vlsm)
    (preloaded_with_all_messages_vlsm (composite_vlsm free_constraint)).</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>message, index</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>EqDecision0</var><span class="hyp-type"><b>: </b><span>EqDecision index</span></span></span><br><span><var>IM</var><span class="hyp-type"><b>: </b><span>index ‚Üí VLSM message</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">VLSM_eq
  (preloaded_with_all_messages_vlsm
     free_composite_vlsm)
  (preloaded_with_all_messages_vlsm
     (composite_vlsm free_constraint))</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="Composition-v-chk16" style="display: none" type="checkbox"><label class="alectryon-input" for="Composition-v-chk16"><span class="kn">Proof</span>.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>message, index</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>EqDecision0</var><span class="hyp-type"><b>: </b><span>EqDecision index</span></span></span><br><span><var>IM</var><span class="hyp-type"><b>: </b><span>index ‚Üí VLSM message</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">VLSM_eq
  (preloaded_with_all_messages_vlsm
     free_composite_vlsm)
  (preloaded_with_all_messages_vlsm
     (composite_vlsm free_constraint))</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="Composition-v-chk17" style="display: none" type="checkbox"><label class="alectryon-input" for="Composition-v-chk17"><span class="nb">split</span>.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>message, index</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>EqDecision0</var><span class="hyp-type"><b>: </b><span>EqDecision index</span></span></span><br><span><var>IM</var><span class="hyp-type"><b>: </b><span>index ‚Üí VLSM message</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">VLSM_incl
  {|
    vlsm_type :=
      preloaded_with_all_messages_vlsm
        free_composite_vlsm;
    vlsm_machine :=
      preloaded_with_all_messages_vlsm
        free_composite_vlsm
  |}
  {|
    vlsm_type :=
      preloaded_with_all_messages_vlsm
        free_composite_vlsm;
    vlsm_machine :=
      preloaded_with_all_messages_vlsm
        (composite_vlsm free_constraint)
  |}</div></blockquote><div class="alectryon-extra-goals"><input class="alectryon-extra-goal-toggle" id="Composition-v-chk18" style="display: none" type="checkbox"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>message, index</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>EqDecision0</var><span class="hyp-type"><b>: </b><span>EqDecision index</span></span></span><br><span><var>IM</var><span class="hyp-type"><b>: </b><span>index ‚Üí VLSM message</span></span></span><br></div><label class="goal-separator" for="Composition-v-chk18"><hr></label><div class="goal-conclusion">VLSM_incl
  {|
    vlsm_type :=
      preloaded_with_all_messages_vlsm
        free_composite_vlsm;
    vlsm_machine :=
      preloaded_with_all_messages_vlsm
        (composite_vlsm free_constraint)
  |}
  {|
    vlsm_type :=
      preloaded_with_all_messages_vlsm
        free_composite_vlsm;
    vlsm_machine :=
      preloaded_with_all_messages_vlsm
        free_composite_vlsm
  |}</div></blockquote></div></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="Composition-v-chk19" style="display: none" type="checkbox"><label class="alectryon-input" for="Composition-v-chk19">-</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>message, index</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>EqDecision0</var><span class="hyp-type"><b>: </b><span>EqDecision index</span></span></span><br><span><var>IM</var><span class="hyp-type"><b>: </b><span>index ‚Üí VLSM message</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">VLSM_incl
  {|
    vlsm_type :=
      preloaded_with_all_messages_vlsm
        free_composite_vlsm;
    vlsm_machine :=
      preloaded_with_all_messages_vlsm
        free_composite_vlsm
  |}
  {|
    vlsm_type :=
      preloaded_with_all_messages_vlsm
        free_composite_vlsm;
    vlsm_machine :=
      preloaded_with_all_messages_vlsm
        (composite_vlsm free_constraint)
  |}</div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="Composition-v-chk1a" style="display: none" type="checkbox"><label class="alectryon-input" for="Composition-v-chk1a"><span class="nb">apply</span> (VLSM_incl_embedding_iff); <span class="nb">cbn</span>.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>message, index</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>EqDecision0</var><span class="hyp-type"><b>: </b><span>EqDecision index</span></span></span><br><span><var>IM</var><span class="hyp-type"><b>: </b><span>index ‚Üí VLSM message</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">VLSM_embedding
  {|
    vlsm_type := composite_type;
    vlsm_machine :=
      preloaded_vlsm_machine free_composite_vlsm
        (<span class="kr">Œª</span> <span class="nv">_</span> : message, <span class="kt">True</span>)
  |}
  {|
    vlsm_type := composite_type;
    vlsm_machine :=
      preloaded_vlsm_machine
        (composite_vlsm free_constraint)
        (<span class="kr">Œª</span> <span class="nv">_</span> : message, <span class="kt">True</span>)
  |} id id</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><span class="alectryon-input"><span class="bp">by</span> <span class="nb">apply</span> basic_VLSM_strong_embedding; <span class="nb">red</span>; <span class="nb">cbn</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="Composition-v-chk1b" style="display: none" type="checkbox"><label class="alectryon-input" for="Composition-v-chk1b">-</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>message, index</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>EqDecision0</var><span class="hyp-type"><b>: </b><span>EqDecision index</span></span></span><br><span><var>IM</var><span class="hyp-type"><b>: </b><span>index ‚Üí VLSM message</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">VLSM_incl
  {|
    vlsm_type :=
      preloaded_with_all_messages_vlsm
        free_composite_vlsm;
    vlsm_machine :=
      preloaded_with_all_messages_vlsm
        (composite_vlsm free_constraint)
  |}
  {|
    vlsm_type :=
      preloaded_with_all_messages_vlsm
        free_composite_vlsm;
    vlsm_machine :=
      preloaded_with_all_messages_vlsm
        free_composite_vlsm
  |}</div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="Composition-v-chk1c" style="display: none" type="checkbox"><label class="alectryon-input" for="Composition-v-chk1c"><span class="nb">apply</span> (VLSM_incl_embedding_iff); <span class="nb">cbn</span>.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>message, index</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>EqDecision0</var><span class="hyp-type"><b>: </b><span>EqDecision index</span></span></span><br><span><var>IM</var><span class="hyp-type"><b>: </b><span>index ‚Üí VLSM message</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">VLSM_embedding
  {|
    vlsm_type := composite_type;
    vlsm_machine :=
      preloaded_vlsm_machine
        (composite_vlsm free_constraint)
        (<span class="kr">Œª</span> <span class="nv">_</span> : message, <span class="kt">True</span>)
  |}
  {|
    vlsm_type := composite_type;
    vlsm_machine :=
      preloaded_vlsm_machine free_composite_vlsm
        (<span class="kr">Œª</span> <span class="nv">_</span> : message, <span class="kt">True</span>)
  |} id id</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="Composition-v-chk1d" style="display: none" type="checkbox"><label class="alectryon-input" for="Composition-v-chk1d"><span class="nb">apply</span> basic_VLSM_strong_embedding; <span class="nb">red</span>; <span class="nb">cbn</span>; [| <span class="bp">done</span>..].</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>message, index</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>EqDecision0</var><span class="hyp-type"><b>: </b><span>EqDecision index</span></span></span><br><span><var>IM</var><span class="hyp-type"><b>: </b><span>index ‚Üí VLSM message</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="kr">‚àÄ</span> (<span class="nv">l</span> : composite_label) (<span class="nv">s</span> : composite_state) (<span class="nv">om</span> : 
                                               option
                                                 message),
  (<span class="kr">let</span> (<span class="nv">i</span>, li) := l <span class="kr">in</span> valid li (s i, om))
  ‚àß free_constraint l (s, om)
  ‚Üí <span class="kr">let</span> (<span class="nv">i</span>, li) := l <span class="kr">in</span> valid li (s i, om)</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><span class="alectryon-input"><span class="bp">by</span> itauto.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Qed</span>.</span></span></pre><div class="doc">
<a id="lab4"></a><h2 class="section">Lemmas about state_update</h2>
<div class="paragraph"> </div>

  The next few results describe several properties of the <span class="inlinecode"><span class="id" title="var">state_update</span></span> operation.

</div><pre class="alectryon-io highlight"><!-- Generator: Alectryon --><span class="alectryon-sentence"><input class="alectryon-toggle" id="Composition-v-chk1e" style="display: none" type="checkbox"><label class="alectryon-input" for="Composition-v-chk1e"><span class="kn">Lemma</span> <span class="nf">state_update_neq</span> :
  <span class="kr">forall</span> (<span class="nv">s</span> : composite_state) (<span class="nv">i</span> : index) (<span class="nv">si</span> : state (IM i)) (<span class="nv">j</span> : index) (<span class="nv">Hneq</span> : j &lt;&gt; i),
    state_update s i si j = s j.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>message, index</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>EqDecision0</var><span class="hyp-type"><b>: </b><span>EqDecision index</span></span></span><br><span><var>IM</var><span class="hyp-type"><b>: </b><span>index ‚Üí VLSM message</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="kr">‚àÄ</span> (<span class="nv">s</span> : composite_state) (<span class="nv">i</span> : index) (<span class="nv">si</span> : state (IM i)) 
  (<span class="nv">j</span> : index), j ‚â† i ‚Üí state_update s i si j = s j</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="Composition-v-chk1f" style="display: none" type="checkbox"><label class="alectryon-input" for="Composition-v-chk1f"><span class="kn">Proof</span>.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>message, index</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>EqDecision0</var><span class="hyp-type"><b>: </b><span>EqDecision index</span></span></span><br><span><var>IM</var><span class="hyp-type"><b>: </b><span>index ‚Üí VLSM message</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="kr">‚àÄ</span> (<span class="nv">s</span> : composite_state) (<span class="nv">i</span> : index) (<span class="nv">si</span> : state (IM i)) 
  (<span class="nv">j</span> : index), j ‚â† i ‚Üí state_update s i si j = s j</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><span class="alectryon-input"><span class="bp">by</span> <span class="nb">intros</span>; <span class="nb">unfold</span> state_update; case_decide.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Qed</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
</span><span class="alectryon-sentence"><input class="alectryon-toggle" id="Composition-v-chk20" style="display: none" type="checkbox"><label class="alectryon-input" for="Composition-v-chk20"><span class="kn">Lemma</span> <span class="nf">state_update_eq</span> :
  <span class="kr">forall</span> (<span class="nv">s</span> : composite_state) (<span class="nv">i</span> : index) (<span class="nv">si</span> : state (IM i)),
    state_update s i si i = si.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>message, index</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>EqDecision0</var><span class="hyp-type"><b>: </b><span>EqDecision index</span></span></span><br><span><var>IM</var><span class="hyp-type"><b>: </b><span>index ‚Üí VLSM message</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="kr">‚àÄ</span> (<span class="nv">s</span> : composite_state) (<span class="nv">i</span> : index) (<span class="nv">si</span> : state (IM i)),
  state_update s i si i = si</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="Composition-v-chk21" style="display: none" type="checkbox"><label class="alectryon-input" for="Composition-v-chk21"><span class="kn">Proof</span>.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>message, index</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>EqDecision0</var><span class="hyp-type"><b>: </b><span>EqDecision index</span></span></span><br><span><var>IM</var><span class="hyp-type"><b>: </b><span>index ‚Üí VLSM message</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="kr">‚àÄ</span> (<span class="nv">s</span> : composite_state) (<span class="nv">i</span> : index) (<span class="nv">si</span> : state (IM i)),
  state_update s i si i = si</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="Composition-v-chk22" style="display: none" type="checkbox"><label class="alectryon-input" for="Composition-v-chk22"><span class="nb">unfold</span> state_update.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>message, index</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>EqDecision0</var><span class="hyp-type"><b>: </b><span>EqDecision index</span></span></span><br><span><var>IM</var><span class="hyp-type"><b>: </b><span>index ‚Üí VLSM message</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="kr">‚àÄ</span> (<span class="nv">s</span> : composite_state) (<span class="nv">i</span> : index) (<span class="nv">si</span> : state (IM i)),
  <span class="kr">match</span> decide (i = i) <span class="kr">with</span>
  | <span class="nb">left</span> e =&gt;
      eq_rect_r (<span class="kr">Œª</span> <span class="nv">i0</span> : index, state (IM i0)) si e
  | <span class="nb">right</span> _ =&gt; s i
  <span class="kr">end</span> = si</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="Composition-v-chk23" style="display: none" type="checkbox"><label class="alectryon-input" for="Composition-v-chk23"><span class="nb">intros</span>.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>message, index</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>EqDecision0</var><span class="hyp-type"><b>: </b><span>EqDecision index</span></span></span><br><span><var>IM</var><span class="hyp-type"><b>: </b><span>index ‚Üí VLSM message</span></span></span><br><span><var>s</var><span class="hyp-type"><b>: </b><span>composite_state</span></span></span><br><span><var>i</var><span class="hyp-type"><b>: </b><span>index</span></span></span><br><span><var>si</var><span class="hyp-type"><b>: </b><span>state (IM i)</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="kr">match</span> decide (i = i) <span class="kr">with</span>
| <span class="nb">left</span> e =&gt; eq_rect_r (<span class="kr">Œª</span> <span class="nv">i</span> : index, state (IM i)) si e
| <span class="nb">right</span> _ =&gt; s i
<span class="kr">end</span> = si</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="Composition-v-chk24" style="display: none" type="checkbox"><label class="alectryon-input" for="Composition-v-chk24">case_decide; [| <span class="bp">done</span>].</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>message, index</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>EqDecision0</var><span class="hyp-type"><b>: </b><span>EqDecision index</span></span></span><br><span><var>IM</var><span class="hyp-type"><b>: </b><span>index ‚Üí VLSM message</span></span></span><br><span><var>s</var><span class="hyp-type"><b>: </b><span>composite_state</span></span></span><br><span><var>i</var><span class="hyp-type"><b>: </b><span>index</span></span></span><br><span><var>si</var><span class="hyp-type"><b>: </b><span>state (IM i)</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>i = i</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">eq_rect_r (<span class="kr">Œª</span> <span class="nv">i</span> : index, state (IM i)) si H = si</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><span class="alectryon-input"><span class="bp">by</span> <span class="nb">replace</span> H <span class="kr">with</span> (eq_refl i) <span class="bp">by</span> (<span class="nb">apply</span> K_dec_type; <span class="bp">done</span>).</span><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Qed</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
</span><span class="alectryon-sentence"><input class="alectryon-toggle" id="Composition-v-chk25" style="display: none" type="checkbox"><label class="alectryon-input" for="Composition-v-chk25"><span class="kn">Lemma</span> <span class="nf">state_update_id</span> :
  <span class="kr">forall</span> (<span class="nv">s</span> : composite_state) (<span class="nv">i</span> : index) (<span class="nv">si</span> : state (IM i)) (<span class="nv">Heq</span> : s i = si),
    state_update s i si = s.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>message, index</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>EqDecision0</var><span class="hyp-type"><b>: </b><span>EqDecision index</span></span></span><br><span><var>IM</var><span class="hyp-type"><b>: </b><span>index ‚Üí VLSM message</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="kr">‚àÄ</span> (<span class="nv">s</span> : composite_state) (<span class="nv">i</span> : index) (<span class="nv">si</span> : state (IM i)),
  s i = si ‚Üí state_update s i si = s</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="Composition-v-chk26" style="display: none" type="checkbox"><label class="alectryon-input" for="Composition-v-chk26"><span class="kn">Proof</span>.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>message, index</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>EqDecision0</var><span class="hyp-type"><b>: </b><span>EqDecision index</span></span></span><br><span><var>IM</var><span class="hyp-type"><b>: </b><span>index ‚Üí VLSM message</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="kr">‚àÄ</span> (<span class="nv">s</span> : composite_state) (<span class="nv">i</span> : index) (<span class="nv">si</span> : state (IM i)),
  s i = si ‚Üí state_update s i si = s</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="Composition-v-chk27" style="display: none" type="checkbox"><label class="alectryon-input" for="Composition-v-chk27"><span class="nb">intros</span>.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>message, index</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>EqDecision0</var><span class="hyp-type"><b>: </b><span>EqDecision index</span></span></span><br><span><var>IM</var><span class="hyp-type"><b>: </b><span>index ‚Üí VLSM message</span></span></span><br><span><var>s</var><span class="hyp-type"><b>: </b><span>composite_state</span></span></span><br><span><var>i</var><span class="hyp-type"><b>: </b><span>index</span></span></span><br><span><var>si</var><span class="hyp-type"><b>: </b><span>state (IM i)</span></span></span><br><span><var>Heq</var><span class="hyp-type"><b>: </b><span>s i = si</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">state_update s i si = s</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="Composition-v-chk28" style="display: none" type="checkbox"><label class="alectryon-input" for="Composition-v-chk28"><span class="nb">apply</span> functional_extensionality_dep_good.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>message, index</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>EqDecision0</var><span class="hyp-type"><b>: </b><span>EqDecision index</span></span></span><br><span><var>IM</var><span class="hyp-type"><b>: </b><span>index ‚Üí VLSM message</span></span></span><br><span><var>s</var><span class="hyp-type"><b>: </b><span>composite_state</span></span></span><br><span><var>i</var><span class="hyp-type"><b>: </b><span>index</span></span></span><br><span><var>si</var><span class="hyp-type"><b>: </b><span>state (IM i)</span></span></span><br><span><var>Heq</var><span class="hyp-type"><b>: </b><span>s i = si</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="kr">‚àÄ</span> <span class="nv">x</span> : index, state_update s i si x = s x</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="Composition-v-chk29" style="display: none" type="checkbox"><label class="alectryon-input" for="Composition-v-chk29"><span class="nb">intro</span> j.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>message, index</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>EqDecision0</var><span class="hyp-type"><b>: </b><span>EqDecision index</span></span></span><br><span><var>IM</var><span class="hyp-type"><b>: </b><span>index ‚Üí VLSM message</span></span></span><br><span><var>s</var><span class="hyp-type"><b>: </b><span>composite_state</span></span></span><br><span><var>i</var><span class="hyp-type"><b>: </b><span>index</span></span></span><br><span><var>si</var><span class="hyp-type"><b>: </b><span>state (IM i)</span></span></span><br><span><var>Heq</var><span class="hyp-type"><b>: </b><span>s i = si</span></span></span><br><span><var>j</var><span class="hyp-type"><b>: </b><span>index</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">state_update s i si j = s j</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="Composition-v-chk2a" style="display: none" type="checkbox"><label class="alectryon-input" for="Composition-v-chk2a"><span class="nb">destruct</span> (decide (j = i)); <span class="nb">subst</span>.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>message, index</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>EqDecision0</var><span class="hyp-type"><b>: </b><span>EqDecision index</span></span></span><br><span><var>IM</var><span class="hyp-type"><b>: </b><span>index ‚Üí VLSM message</span></span></span><br><span><var>s</var><span class="hyp-type"><b>: </b><span>composite_state</span></span></span><br><span><var>i</var><span class="hyp-type"><b>: </b><span>index</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">state_update s i (s i) i = s i</div></blockquote><div class="alectryon-extra-goals"><input class="alectryon-extra-goal-toggle" id="Composition-v-chk2b" style="display: none" type="checkbox"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>message, index</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>EqDecision0</var><span class="hyp-type"><b>: </b><span>EqDecision index</span></span></span><br><span><var>IM</var><span class="hyp-type"><b>: </b><span>index ‚Üí VLSM message</span></span></span><br><span><var>s</var><span class="hyp-type"><b>: </b><span>composite_state</span></span></span><br><span><var>i, j</var><span class="hyp-type"><b>: </b><span>index</span></span></span><br><span><var>n</var><span class="hyp-type"><b>: </b><span>j ‚â† i</span></span></span><br></div><label class="goal-separator" for="Composition-v-chk2b"><hr></label><div class="goal-conclusion">state_update s i (s i) j = s j</div></blockquote></div></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="Composition-v-chk2c" style="display: none" type="checkbox"><label class="alectryon-input" for="Composition-v-chk2c">-</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>message, index</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>EqDecision0</var><span class="hyp-type"><b>: </b><span>EqDecision index</span></span></span><br><span><var>IM</var><span class="hyp-type"><b>: </b><span>index ‚Üí VLSM message</span></span></span><br><span><var>s</var><span class="hyp-type"><b>: </b><span>composite_state</span></span></span><br><span><var>i</var><span class="hyp-type"><b>: </b><span>index</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">state_update s i (s i) i = s i</div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="bp">by</span> <span class="nb">apply</span> state_update_eq.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="Composition-v-chk2d" style="display: none" type="checkbox"><label class="alectryon-input" for="Composition-v-chk2d">-</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>message, index</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>EqDecision0</var><span class="hyp-type"><b>: </b><span>EqDecision index</span></span></span><br><span><var>IM</var><span class="hyp-type"><b>: </b><span>index ‚Üí VLSM message</span></span></span><br><span><var>s</var><span class="hyp-type"><b>: </b><span>composite_state</span></span></span><br><span><var>i, j</var><span class="hyp-type"><b>: </b><span>index</span></span></span><br><span><var>n</var><span class="hyp-type"><b>: </b><span>j ‚â† i</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">state_update s i (s i) j = s j</div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="bp">by</span> <span class="nb">apply</span> state_update_neq.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Qed</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
</span><span class="alectryon-sentence"><input class="alectryon-toggle" id="Composition-v-chk2e" style="display: none" type="checkbox"><label class="alectryon-input" for="Composition-v-chk2e"><span class="kn">Lemma</span> <span class="nf">state_update_twice</span> :
  <span class="kr">forall</span> (<span class="nv">s</span> : composite_state) (<span class="nv">i</span> : index) (<span class="nv">si</span> <span class="nv">si&#39;</span> : state (IM i)),
    state_update (state_update s i si) i si&#39; = state_update s i si&#39;.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>message, index</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>EqDecision0</var><span class="hyp-type"><b>: </b><span>EqDecision index</span></span></span><br><span><var>IM</var><span class="hyp-type"><b>: </b><span>index ‚Üí VLSM message</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="kr">‚àÄ</span> (<span class="nv">s</span> : composite_state) (<span class="nv">i</span> : index) (<span class="nv">si</span>
                                     <span class="nv">si&#39;</span> : state
                                             (IM i)),
  state_update (state_update s i si) i si&#39; =
  state_update s i si&#39;</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="Composition-v-chk2f" style="display: none" type="checkbox"><label class="alectryon-input" for="Composition-v-chk2f"><span class="kn">Proof</span>.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>message, index</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>EqDecision0</var><span class="hyp-type"><b>: </b><span>EqDecision index</span></span></span><br><span><var>IM</var><span class="hyp-type"><b>: </b><span>index ‚Üí VLSM message</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="kr">‚àÄ</span> (<span class="nv">s</span> : composite_state) (<span class="nv">i</span> : index) (<span class="nv">si</span>
                                     <span class="nv">si&#39;</span> : state
                                             (IM i)),
  state_update (state_update s i si) i si&#39; =
  state_update s i si&#39;</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="Composition-v-chk30" style="display: none" type="checkbox"><label class="alectryon-input" for="Composition-v-chk30"><span class="nb">intros</span>.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>message, index</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>EqDecision0</var><span class="hyp-type"><b>: </b><span>EqDecision index</span></span></span><br><span><var>IM</var><span class="hyp-type"><b>: </b><span>index ‚Üí VLSM message</span></span></span><br><span><var>s</var><span class="hyp-type"><b>: </b><span>composite_state</span></span></span><br><span><var>i</var><span class="hyp-type"><b>: </b><span>index</span></span></span><br><span><var>si, si'</var><span class="hyp-type"><b>: </b><span>state (IM i)</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">state_update (state_update s i si) i si&#39; =
state_update s i si&#39;</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="Composition-v-chk31" style="display: none" type="checkbox"><label class="alectryon-input" for="Composition-v-chk31"><span class="nb">apply</span> functional_extensionality_dep_good.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>message, index</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>EqDecision0</var><span class="hyp-type"><b>: </b><span>EqDecision index</span></span></span><br><span><var>IM</var><span class="hyp-type"><b>: </b><span>index ‚Üí VLSM message</span></span></span><br><span><var>s</var><span class="hyp-type"><b>: </b><span>composite_state</span></span></span><br><span><var>i</var><span class="hyp-type"><b>: </b><span>index</span></span></span><br><span><var>si, si'</var><span class="hyp-type"><b>: </b><span>state (IM i)</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="kr">‚àÄ</span> <span class="nv">x</span> : index,
  state_update (state_update s i si) i si&#39; x =
  state_update s i si&#39; x</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="Composition-v-chk32" style="display: none" type="checkbox"><label class="alectryon-input" for="Composition-v-chk32"><span class="nb">intro</span> j.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>message, index</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>EqDecision0</var><span class="hyp-type"><b>: </b><span>EqDecision index</span></span></span><br><span><var>IM</var><span class="hyp-type"><b>: </b><span>index ‚Üí VLSM message</span></span></span><br><span><var>s</var><span class="hyp-type"><b>: </b><span>composite_state</span></span></span><br><span><var>i</var><span class="hyp-type"><b>: </b><span>index</span></span></span><br><span><var>si, si'</var><span class="hyp-type"><b>: </b><span>state (IM i)</span></span></span><br><span><var>j</var><span class="hyp-type"><b>: </b><span>index</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">state_update (state_update s i si) i si&#39; j =
state_update s i si&#39; j</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="Composition-v-chk33" style="display: none" type="checkbox"><label class="alectryon-input" for="Composition-v-chk33"><span class="nb">destruct</span> (decide (j = i)).</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>message, index</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>EqDecision0</var><span class="hyp-type"><b>: </b><span>EqDecision index</span></span></span><br><span><var>IM</var><span class="hyp-type"><b>: </b><span>index ‚Üí VLSM message</span></span></span><br><span><var>s</var><span class="hyp-type"><b>: </b><span>composite_state</span></span></span><br><span><var>i</var><span class="hyp-type"><b>: </b><span>index</span></span></span><br><span><var>si, si'</var><span class="hyp-type"><b>: </b><span>state (IM i)</span></span></span><br><span><var>j</var><span class="hyp-type"><b>: </b><span>index</span></span></span><br><span><var>e</var><span class="hyp-type"><b>: </b><span>j = i</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">state_update (state_update s i si) i si&#39; j =
state_update s i si&#39; j</div></blockquote><div class="alectryon-extra-goals"><input class="alectryon-extra-goal-toggle" id="Composition-v-chk34" style="display: none" type="checkbox"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>message, index</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>EqDecision0</var><span class="hyp-type"><b>: </b><span>EqDecision index</span></span></span><br><span><var>IM</var><span class="hyp-type"><b>: </b><span>index ‚Üí VLSM message</span></span></span><br><span><var>s</var><span class="hyp-type"><b>: </b><span>composite_state</span></span></span><br><span><var>i</var><span class="hyp-type"><b>: </b><span>index</span></span></span><br><span><var>si, si'</var><span class="hyp-type"><b>: </b><span>state (IM i)</span></span></span><br><span><var>j</var><span class="hyp-type"><b>: </b><span>index</span></span></span><br><span><var>n</var><span class="hyp-type"><b>: </b><span>j ‚â† i</span></span></span><br></div><label class="goal-separator" for="Composition-v-chk34"><hr></label><div class="goal-conclusion">state_update (state_update s i si) i si&#39; j =
state_update s i si&#39; j</div></blockquote></div></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="Composition-v-chk35" style="display: none" type="checkbox"><label class="alectryon-input" for="Composition-v-chk35">-</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>message, index</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>EqDecision0</var><span class="hyp-type"><b>: </b><span>EqDecision index</span></span></span><br><span><var>IM</var><span class="hyp-type"><b>: </b><span>index ‚Üí VLSM message</span></span></span><br><span><var>s</var><span class="hyp-type"><b>: </b><span>composite_state</span></span></span><br><span><var>i</var><span class="hyp-type"><b>: </b><span>index</span></span></span><br><span><var>si, si'</var><span class="hyp-type"><b>: </b><span>state (IM i)</span></span></span><br><span><var>j</var><span class="hyp-type"><b>: </b><span>index</span></span></span><br><span><var>e</var><span class="hyp-type"><b>: </b><span>j = i</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">state_update (state_update s i si) i si&#39; j =
state_update s i si&#39; j</div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="bp">by</span> <span class="nb">subst</span>; <span class="nb">rewrite</span> state_update_eq; <span class="nb">symmetry</span>; <span class="nb">apply</span> state_update_eq.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="Composition-v-chk36" style="display: none" type="checkbox"><label class="alectryon-input" for="Composition-v-chk36">-</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>message, index</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>EqDecision0</var><span class="hyp-type"><b>: </b><span>EqDecision index</span></span></span><br><span><var>IM</var><span class="hyp-type"><b>: </b><span>index ‚Üí VLSM message</span></span></span><br><span><var>s</var><span class="hyp-type"><b>: </b><span>composite_state</span></span></span><br><span><var>i</var><span class="hyp-type"><b>: </b><span>index</span></span></span><br><span><var>si, si'</var><span class="hyp-type"><b>: </b><span>state (IM i)</span></span></span><br><span><var>j</var><span class="hyp-type"><b>: </b><span>index</span></span></span><br><span><var>n</var><span class="hyp-type"><b>: </b><span>j ‚â† i</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">state_update (state_update s i si) i si&#39; j =
state_update s i si&#39; j</div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="bp">by</span> <span class="nb">rewrite</span> !state_update_neq.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Qed</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
</span><span class="alectryon-sentence"><input class="alectryon-toggle" id="Composition-v-chk37" style="display: none" type="checkbox"><label class="alectryon-input" for="Composition-v-chk37"><span class="kn">Lemma</span> <span class="nf">state_update_twice_neq</span> :
  <span class="kr">forall</span> (<span class="nv">s</span> : composite_state) (<span class="nv">i</span> <span class="nv">j</span> : index) (<span class="nv">si</span> : state (IM i)) (<span class="nv">sj</span> : state (IM j)) (<span class="nv">Hij</span> : j &lt;&gt; i),
    state_update (state_update s i si) j sj = state_update (state_update s j sj) i si.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>message, index</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>EqDecision0</var><span class="hyp-type"><b>: </b><span>EqDecision index</span></span></span><br><span><var>IM</var><span class="hyp-type"><b>: </b><span>index ‚Üí VLSM message</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="kr">‚àÄ</span> (<span class="nv">s</span> : composite_state) (<span class="nv">i</span> <span class="nv">j</span> : index) (<span class="nv">si</span> : state
                                              (IM i)) 
  (<span class="nv">sj</span> : state (IM j)),
  j ‚â† i
  ‚Üí state_update (state_update s i si) j sj =
    state_update (state_update s j sj) i si</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="Composition-v-chk38" style="display: none" type="checkbox"><label class="alectryon-input" for="Composition-v-chk38"><span class="kn">Proof</span>.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>message, index</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>EqDecision0</var><span class="hyp-type"><b>: </b><span>EqDecision index</span></span></span><br><span><var>IM</var><span class="hyp-type"><b>: </b><span>index ‚Üí VLSM message</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="kr">‚àÄ</span> (<span class="nv">s</span> : composite_state) (<span class="nv">i</span> <span class="nv">j</span> : index) (<span class="nv">si</span> : state
                                              (IM i)) 
  (<span class="nv">sj</span> : state (IM j)),
  j ‚â† i
  ‚Üí state_update (state_update s i si) j sj =
    state_update (state_update s j sj) i si</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="Composition-v-chk39" style="display: none" type="checkbox"><label class="alectryon-input" for="Composition-v-chk39"><span class="nb">intros</span>.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>message, index</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>EqDecision0</var><span class="hyp-type"><b>: </b><span>EqDecision index</span></span></span><br><span><var>IM</var><span class="hyp-type"><b>: </b><span>index ‚Üí VLSM message</span></span></span><br><span><var>s</var><span class="hyp-type"><b>: </b><span>composite_state</span></span></span><br><span><var>i, j</var><span class="hyp-type"><b>: </b><span>index</span></span></span><br><span><var>si</var><span class="hyp-type"><b>: </b><span>state (IM i)</span></span></span><br><span><var>sj</var><span class="hyp-type"><b>: </b><span>state (IM j)</span></span></span><br><span><var>Hij</var><span class="hyp-type"><b>: </b><span>j ‚â† i</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">state_update (state_update s i si) j sj =
state_update (state_update s j sj) i si</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="Composition-v-chk3a" style="display: none" type="checkbox"><label class="alectryon-input" for="Composition-v-chk3a"><span class="nb">apply</span> functional_extensionality_dep_good.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>message, index</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>EqDecision0</var><span class="hyp-type"><b>: </b><span>EqDecision index</span></span></span><br><span><var>IM</var><span class="hyp-type"><b>: </b><span>index ‚Üí VLSM message</span></span></span><br><span><var>s</var><span class="hyp-type"><b>: </b><span>composite_state</span></span></span><br><span><var>i, j</var><span class="hyp-type"><b>: </b><span>index</span></span></span><br><span><var>si</var><span class="hyp-type"><b>: </b><span>state (IM i)</span></span></span><br><span><var>sj</var><span class="hyp-type"><b>: </b><span>state (IM j)</span></span></span><br><span><var>Hij</var><span class="hyp-type"><b>: </b><span>j ‚â† i</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="kr">‚àÄ</span> <span class="nv">x</span> : index,
  state_update (state_update s i si) j sj x =
  state_update (state_update s j sj) i si x</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="Composition-v-chk3b" style="display: none" type="checkbox"><label class="alectryon-input" for="Composition-v-chk3b"><span class="nb">intro</span> k.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>message, index</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>EqDecision0</var><span class="hyp-type"><b>: </b><span>EqDecision index</span></span></span><br><span><var>IM</var><span class="hyp-type"><b>: </b><span>index ‚Üí VLSM message</span></span></span><br><span><var>s</var><span class="hyp-type"><b>: </b><span>composite_state</span></span></span><br><span><var>i, j</var><span class="hyp-type"><b>: </b><span>index</span></span></span><br><span><var>si</var><span class="hyp-type"><b>: </b><span>state (IM i)</span></span></span><br><span><var>sj</var><span class="hyp-type"><b>: </b><span>state (IM j)</span></span></span><br><span><var>Hij</var><span class="hyp-type"><b>: </b><span>j ‚â† i</span></span></span><br><span><var>k</var><span class="hyp-type"><b>: </b><span>index</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">state_update (state_update s i si) j sj k =
state_update (state_update s j sj) i si k</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="Composition-v-chk3c" style="display: none" type="checkbox"><label class="alectryon-input" for="Composition-v-chk3c"><span class="nb">destruct</span> (decide (k = j)); <span class="nb">destruct</span> (decide (k = i)); <span class="nb">subst</span>
  ; <span class="kp">repeat</span> (<span class="nb">rewrite</span> state_update_eq ; <span class="kp">try</span> (<span class="nb">rewrite</span> state_update_neq; <span class="kp">try</span> <span class="bp">done</span>))
  ; <span class="kp">try</span> <span class="bp">done</span>.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>message, index</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>EqDecision0</var><span class="hyp-type"><b>: </b><span>EqDecision index</span></span></span><br><span><var>IM</var><span class="hyp-type"><b>: </b><span>index ‚Üí VLSM message</span></span></span><br><span><var>s</var><span class="hyp-type"><b>: </b><span>composite_state</span></span></span><br><span><var>i, j</var><span class="hyp-type"><b>: </b><span>index</span></span></span><br><span><var>si</var><span class="hyp-type"><b>: </b><span>state (IM i)</span></span></span><br><span><var>sj</var><span class="hyp-type"><b>: </b><span>state (IM j)</span></span></span><br><span><var>Hij</var><span class="hyp-type"><b>: </b><span>j ‚â† i</span></span></span><br><span><var>k</var><span class="hyp-type"><b>: </b><span>index</span></span></span><br><span><var>n</var><span class="hyp-type"><b>: </b><span>k ‚â† j</span></span></span><br><span><var>n0</var><span class="hyp-type"><b>: </b><span>k ‚â† i</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">state_update (state_update s i si) j sj k =
state_update (state_update s j sj) i si k</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><span class="alectryon-input"><span class="bp">by</span> <span class="nb">rewrite</span> !state_update_neq.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Qed</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
</span><span class="alectryon-sentence"><input class="alectryon-toggle" id="Composition-v-chk3d" style="display: none" type="checkbox"><label class="alectryon-input" for="Composition-v-chk3d"><span class="kn">Lemma</span> <span class="nf">composite_transition_state_neq</span>
  (<span class="nv">l</span> : composite_label)
  (<span class="nv">s</span> <span class="nv">s&#39;</span> : composite_state)
  (<span class="nv">om</span> <span class="nv">om&#39;</span> : option message)
  (<span class="nv">Ht</span> : composite_transition l (s, om) = (s&#39;, om&#39;))
  (<span class="nv">i</span> : index)
  (<span class="nv">Hi</span> : i &lt;&gt; projT1 l)
  : s&#39; i = s i.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>message, index</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>EqDecision0</var><span class="hyp-type"><b>: </b><span>EqDecision index</span></span></span><br><span><var>IM</var><span class="hyp-type"><b>: </b><span>index ‚Üí VLSM message</span></span></span><br><span><var>l</var><span class="hyp-type"><b>: </b><span>composite_label</span></span></span><br><span><var>s, s'</var><span class="hyp-type"><b>: </b><span>composite_state</span></span></span><br><span><var>om, om'</var><span class="hyp-type"><b>: </b><span>option message</span></span></span><br><span><var>Ht</var><span class="hyp-type"><b>: </b><span>composite_transition l (s, om) = (s&#39;, om&#39;)</span></span></span><br><span><var>i</var><span class="hyp-type"><b>: </b><span>index</span></span></span><br><span><var>Hi</var><span class="hyp-type"><b>: </b><span>i ‚â† projT1 l</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">s&#39; i = s i</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="Composition-v-chk3e" style="display: none" type="checkbox"><label class="alectryon-input" for="Composition-v-chk3e"><span class="kn">Proof</span>.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>message, index</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>EqDecision0</var><span class="hyp-type"><b>: </b><span>EqDecision index</span></span></span><br><span><var>IM</var><span class="hyp-type"><b>: </b><span>index ‚Üí VLSM message</span></span></span><br><span><var>l</var><span class="hyp-type"><b>: </b><span>composite_label</span></span></span><br><span><var>s, s'</var><span class="hyp-type"><b>: </b><span>composite_state</span></span></span><br><span><var>om, om'</var><span class="hyp-type"><b>: </b><span>option message</span></span></span><br><span><var>Ht</var><span class="hyp-type"><b>: </b><span>composite_transition l (s, om) = (s&#39;, om&#39;)</span></span></span><br><span><var>i</var><span class="hyp-type"><b>: </b><span>index</span></span></span><br><span><var>Hi</var><span class="hyp-type"><b>: </b><span>i ‚â† projT1 l</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">s&#39; i = s i</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="Composition-v-chk3f" style="display: none" type="checkbox"><label class="alectryon-input" for="Composition-v-chk3f"><span class="nb">destruct</span> l; <span class="nb">cbn</span> <span class="kr">in</span> Ht; <span class="nb">destruct</span> (transition _ _ _).</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>message, index</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>EqDecision0</var><span class="hyp-type"><b>: </b><span>EqDecision index</span></span></span><br><span><var>IM</var><span class="hyp-type"><b>: </b><span>index ‚Üí VLSM message</span></span></span><br><span><var>x</var><span class="hyp-type"><b>: </b><span>index</span></span></span><br><span><var>l</var><span class="hyp-type"><b>: </b><span>label (IM x)</span></span></span><br><span><var>s, s'</var><span class="hyp-type"><b>: </b><span>composite_state</span></span></span><br><span><var>om, om'</var><span class="hyp-type"><b>: </b><span>option message</span></span></span><br><span><var>s0</var><span class="hyp-type"><b>: </b><span>state (IM x)</span></span></span><br><span><var>o</var><span class="hyp-type"><b>: </b><span>option message</span></span></span><br><span><var>Ht</var><span class="hyp-type"><b>: </b><span>(state_update s x s0, o) = (s&#39;, om&#39;)</span></span></span><br><span><var>i</var><span class="hyp-type"><b>: </b><span>index</span></span></span><br><span><var>Hi</var><span class="hyp-type"><b>: </b><span>i ‚â† projT1 (existT x l)</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">s&#39; i = s i</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><span class="alectryon-input"><span class="bp">by</span> <span class="nb">inversion</span> Ht; <span class="nb">apply</span> state_update_neq.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Qed</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
</span><span class="alectryon-sentence"><input class="alectryon-toggle" id="Composition-v-chk40" style="display: none" type="checkbox"><label class="alectryon-input" for="Composition-v-chk40"><span class="kn">Lemma</span> <span class="nf">composite_transition_state_eq</span>
  (<span class="nv">i</span> : index)
  (<span class="nv">li</span> : label (IM i))
  (<span class="nv">s</span> <span class="nv">s&#39;</span> : composite_state)
  (<span class="nv">om</span> <span class="nv">om&#39;</span> : option message)
  (<span class="nv">Ht</span> : composite_transition (existT i li) (s, om) = (s&#39;, om&#39;))
  : s&#39; i = fst (transition (IM i) li (s i, om)).</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>message, index</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>EqDecision0</var><span class="hyp-type"><b>: </b><span>EqDecision index</span></span></span><br><span><var>IM</var><span class="hyp-type"><b>: </b><span>index ‚Üí VLSM message</span></span></span><br><span><var>i</var><span class="hyp-type"><b>: </b><span>index</span></span></span><br><span><var>li</var><span class="hyp-type"><b>: </b><span>label (IM i)</span></span></span><br><span><var>s, s'</var><span class="hyp-type"><b>: </b><span>composite_state</span></span></span><br><span><var>om, om'</var><span class="hyp-type"><b>: </b><span>option message</span></span></span><br><span><var>Ht</var><span class="hyp-type"><b>: </b><span>composite_transition (existT i li) (s, om) =
(s&#39;, om&#39;)</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">s&#39; i = (transition li (s i, om)).<span class="mi">1</span></div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="Composition-v-chk41" style="display: none" type="checkbox"><label class="alectryon-input" for="Composition-v-chk41"><span class="kn">Proof</span>.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>message, index</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>EqDecision0</var><span class="hyp-type"><b>: </b><span>EqDecision index</span></span></span><br><span><var>IM</var><span class="hyp-type"><b>: </b><span>index ‚Üí VLSM message</span></span></span><br><span><var>i</var><span class="hyp-type"><b>: </b><span>index</span></span></span><br><span><var>li</var><span class="hyp-type"><b>: </b><span>label (IM i)</span></span></span><br><span><var>s, s'</var><span class="hyp-type"><b>: </b><span>composite_state</span></span></span><br><span><var>om, om'</var><span class="hyp-type"><b>: </b><span>option message</span></span></span><br><span><var>Ht</var><span class="hyp-type"><b>: </b><span>composite_transition (existT i li) (s, om) =
(s&#39;, om&#39;)</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">s&#39; i = (transition li (s i, om)).<span class="mi">1</span></div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><span class="alectryon-input"><span class="bp">by</span> <span class="nb">cbn</span> <span class="kr">in</span> Ht; <span class="nb">destruct</span> (transition _ _ _); <span class="nb">inversion</span> Ht; <span class="nb">apply</span> state_update_eq.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Qed</span>.</span></span></pre><div class="doc">
  Updating a composite initial state with a component initial state
  yields a composite initial state.

</div><pre class="alectryon-io highlight"><!-- Generator: Alectryon --><span class="alectryon-sentence"><input class="alectryon-toggle" id="Composition-v-chk42" style="display: none" type="checkbox"><label class="alectryon-input" for="Composition-v-chk42"><span class="kn">Lemma</span> <span class="nf">composite_update_initial_state_with_initial</span>
  (<span class="nv">s</span> : composite_state)
  (<span class="nv">Hs</span> : composite_initial_state_prop s)
  (<span class="nv">i</span> : index)
  (<span class="nv">si</span> : state (IM i))
  (<span class="nv">Hsi</span> : initial_state_prop (IM i) si)
  : composite_initial_state_prop (state_update s i si).</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>message, index</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>EqDecision0</var><span class="hyp-type"><b>: </b><span>EqDecision index</span></span></span><br><span><var>IM</var><span class="hyp-type"><b>: </b><span>index ‚Üí VLSM message</span></span></span><br><span><var>s</var><span class="hyp-type"><b>: </b><span>composite_state</span></span></span><br><span><var>Hs</var><span class="hyp-type"><b>: </b><span>composite_initial_state_prop s</span></span></span><br><span><var>i</var><span class="hyp-type"><b>: </b><span>index</span></span></span><br><span><var>si</var><span class="hyp-type"><b>: </b><span>state (IM i)</span></span></span><br><span><var>Hsi</var><span class="hyp-type"><b>: </b><span>initial_state_prop si</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">composite_initial_state_prop (state_update s i si)</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="Composition-v-chk43" style="display: none" type="checkbox"><label class="alectryon-input" for="Composition-v-chk43"><span class="kn">Proof</span>.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>message, index</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>EqDecision0</var><span class="hyp-type"><b>: </b><span>EqDecision index</span></span></span><br><span><var>IM</var><span class="hyp-type"><b>: </b><span>index ‚Üí VLSM message</span></span></span><br><span><var>s</var><span class="hyp-type"><b>: </b><span>composite_state</span></span></span><br><span><var>Hs</var><span class="hyp-type"><b>: </b><span>composite_initial_state_prop s</span></span></span><br><span><var>i</var><span class="hyp-type"><b>: </b><span>index</span></span></span><br><span><var>si</var><span class="hyp-type"><b>: </b><span>state (IM i)</span></span></span><br><span><var>Hsi</var><span class="hyp-type"><b>: </b><span>initial_state_prop si</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">composite_initial_state_prop (state_update s i si)</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="Composition-v-chk44" style="display: none" type="checkbox"><label class="alectryon-input" for="Composition-v-chk44"><span class="nb">intro</span> j.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>message, index</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>EqDecision0</var><span class="hyp-type"><b>: </b><span>EqDecision index</span></span></span><br><span><var>IM</var><span class="hyp-type"><b>: </b><span>index ‚Üí VLSM message</span></span></span><br><span><var>s</var><span class="hyp-type"><b>: </b><span>composite_state</span></span></span><br><span><var>Hs</var><span class="hyp-type"><b>: </b><span>composite_initial_state_prop s</span></span></span><br><span><var>i</var><span class="hyp-type"><b>: </b><span>index</span></span></span><br><span><var>si</var><span class="hyp-type"><b>: </b><span>state (IM i)</span></span></span><br><span><var>Hsi</var><span class="hyp-type"><b>: </b><span>initial_state_prop si</span></span></span><br><span><var>j</var><span class="hyp-type"><b>: </b><span>index</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">initial_state_prop (state_update s i si j)</div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="Composition-v-chk45" style="display: none" type="checkbox"><label class="alectryon-input" for="Composition-v-chk45"><span class="nb">destruct</span> (decide (j = i)); <span class="nb">subst</span>.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>message, index</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>EqDecision0</var><span class="hyp-type"><b>: </b><span>EqDecision index</span></span></span><br><span><var>IM</var><span class="hyp-type"><b>: </b><span>index ‚Üí VLSM message</span></span></span><br><span><var>s</var><span class="hyp-type"><b>: </b><span>composite_state</span></span></span><br><span><var>Hs</var><span class="hyp-type"><b>: </b><span>composite_initial_state_prop s</span></span></span><br><span><var>i</var><span class="hyp-type"><b>: </b><span>index</span></span></span><br><span><var>si</var><span class="hyp-type"><b>: </b><span>state (IM i)</span></span></span><br><span><var>Hsi</var><span class="hyp-type"><b>: </b><span>initial_state_prop si</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">initial_state_prop (state_update s i si i)</div></blockquote><div class="alectryon-extra-goals"><input class="alectryon-extra-goal-toggle" id="Composition-v-chk46" style="display: none" type="checkbox"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>message, index</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>EqDecision0</var><span class="hyp-type"><b>: </b><span>EqDecision index</span></span></span><br><span><var>IM</var><span class="hyp-type"><b>: </b><span>index ‚Üí VLSM message</span></span></span><br><span><var>s</var><span class="hyp-type"><b>: </b><span>composite_state</span></span></span><br><span><var>Hs</var><span class="hyp-type"><b>: </b><span>composite_initial_state_prop s</span></span></span><br><span><var>i</var><span class="hyp-type"><b>: </b><span>index</span></span></span><br><span><var>si</var><span class="hyp-type"><b>: </b><span>state (IM i)</span></span></span><br><span><var>Hsi</var><span class="hyp-type"><b>: </b><span>initial_state_prop si</span></span></span><br><span><var>j</var><span class="hyp-type"><b>: </b><span>index</span></span></span><br><span><var>n</var><span class="hyp-type"><b>: </b><span>j ‚â† i</span></span></span><br></div><label class="goal-separator" for="Composition-v-chk46"><hr></label><div class="goal-conclusion">initial_state_prop (state_update s i si j)</div></blockquote></div></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="Composition-v-chk47" style="display: none" type="checkbox"><label class="alectryon-input" for="Composition-v-chk47">-</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>message, index</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>EqDecision0</var><span class="hyp-type"><b>: </b><span>EqDecision index</span></span></span><br><span><var>IM</var><span class="hyp-type"><b>: </b><span>index ‚Üí VLSM message</span></span></span><br><span><var>s</var><span class="hyp-type"><b>: </b><span>composite_state</span></span></span><br><span><var>Hs</var><span class="hyp-type"><b>: </b><span>composite_initial_state_prop s</span></span></span><br><span><var>i</var><span class="hyp-type"><b>: </b><span>index</span></span></span><br><span><var>si</var><span class="hyp-type"><b>: </b><span>state (IM i)</span></span></span><br><span><var>Hsi</var><span class="hyp-type"><b>: </b><span>initial_state_prop si</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">initial_state_prop (state_update s i si i)</div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="bp">by</span> <span class="nb">rewrite</span> state_update_eq.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="Composition-v-chk48" style="display: none" type="checkbox"><label class="alectryon-input" for="Composition-v-chk48">-</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>message, index</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>EqDecision0</var><span class="hyp-type"><b>: </b><span>EqDecision index</span></span></span><br><span><var>IM</var><span class="hyp-type"><b>: </b><span>index ‚Üí VLSM message</span></span></span><br><span><var>s</var><span class="hyp-type"><b>: </b><span>composite_state</span></span></span><br><span><var>Hs</var><span class="hyp-type"><b>: </b><span>composite_initial_state_prop s</span></span></span><br><span><var>i</var><span class="hyp-type"><b>: </b><span>index</span></span></span><br><span><var>si</var><span class="hyp-type"><b>: </b><span>state (IM i)</span></span></span><br><span><var>Hsi</var><span class="hyp-type"><b>: </b><span>initial_state_prop si</span></span></span><br><span><var>j</var><span class="hyp-type"><b>: </b><span>index</span></span></span><br><span><var>n</var><span class="hyp-type"><b>: </b><span>j ‚â† i</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">initial_state_prop (state_update s i si j)</div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="bp">by</span> <span class="nb">rewrite</span> state_update_neq.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Qed</span>.</span></span></pre><div class="doc">
<a id="lab5"></a><h2 class="section">Lifting functions</h2>
<div class="paragraph"> </div>

  This section contains definitions of functions which lift labels, states,
  etc. from a single component to the composition, and lemmas about these
  functions.

</div><pre class="alectryon-io highlight"><!-- Generator: Alectryon --></pre><div class="doc">
  We can always "lift" state <code>sj</code> from component <code>j</code> to a composite state by
  updating an given composite state to <code>sj</code> on component <code>j</code>.

</div><pre class="alectryon-io highlight"><!-- Generator: Alectryon --><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Definition</span> <span class="nf">lift_to_composite_state</span>
  (<span class="nv">s</span> : composite_state) (<span class="nv">j</span> : index) (<span class="nv">sj</span> : state (IM j)) : composite_state :=
    state_update s j sj.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
</span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Definition</span> <span class="nf">lift_to_composite_label</span> (<span class="nv">j</span> : index) (<span class="nv">lj</span> : label (IM j)) : composite_label :=
  existT j lj.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
</span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Definition</span> <span class="nf">lift_to_composite_transition_item</span>
  (<span class="nv">s</span> : composite_state) (<span class="nv">j</span> : index) : transition_item (IM j) -&gt; composite_transition_item :=
    pre_VLSM_embedding_transition_item_project (IM j) composite_type
      (lift_to_composite_label j) (lift_to_composite_state s j).</span></span></pre><div class="doc">
  A specialized version of <span class="inlinecode"><span class="id" title="var">lift_to_composite_state</span></span> using the initial composite
  state as the base for lifting.

</div><pre class="alectryon-io highlight"><!-- Generator: Alectryon --><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Definition</span> <span class="nf">lift_to_composite_state&#39;</span> : <span class="kr">forall</span> <span class="nv">j</span> : index, state (IM j) -&gt; composite_state :=
  lift_to_composite_state (proj1_sig composite_s0).</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
</span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Definition</span> <span class="nf">lift_to_composite_transition_item&#39;</span> :
  <span class="kr">forall</span> <span class="nv">j</span> : index, transition_item -&gt; composite_transition_item :=
    lift_to_composite_transition_item (proj1_sig composite_s0).</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
</span><span class="alectryon-sentence"><input class="alectryon-toggle" id="Composition-v-chk49" style="display: none" type="checkbox"><label class="alectryon-input" for="Composition-v-chk49"><span class="kn">Definition</span> <span class="nf">lift_to_composite_plan_item</span>
  (<span class="nv">i</span> : index) (<span class="nv">a</span> : plan_item (IM i)) : composite_plan_item.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>message, index</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>EqDecision0</var><span class="hyp-type"><b>: </b><span>EqDecision index</span></span></span><br><span><var>IM</var><span class="hyp-type"><b>: </b><span>index ‚Üí VLSM message</span></span></span><br><span><var>i</var><span class="hyp-type"><b>: </b><span>index</span></span></span><br><span><var>a</var><span class="hyp-type"><b>: </b><span>plan_item</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">composite_plan_item</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="Composition-v-chk4a" style="display: none" type="checkbox"><label class="alectryon-input" for="Composition-v-chk4a"><span class="kn">Proof</span>.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>message, index</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>EqDecision0</var><span class="hyp-type"><b>: </b><span>EqDecision index</span></span></span><br><span><var>IM</var><span class="hyp-type"><b>: </b><span>index ‚Üí VLSM message</span></span></span><br><span><var>i</var><span class="hyp-type"><b>: </b><span>index</span></span></span><br><span><var>a</var><span class="hyp-type"><b>: </b><span>plan_item</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">composite_plan_item</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="Composition-v-chk4b" style="display: none" type="checkbox"><label class="alectryon-input" for="Composition-v-chk4b"><span class="nb">destruct</span> a.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>message, index</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>EqDecision0</var><span class="hyp-type"><b>: </b><span>EqDecision index</span></span></span><br><span><var>IM</var><span class="hyp-type"><b>: </b><span>index ‚Üí VLSM message</span></span></span><br><span><var>i</var><span class="hyp-type"><b>: </b><span>index</span></span></span><br><span><var>label_a</var><span class="hyp-type"><b>: </b><span>label (IM i)</span></span></span><br><span><var>input_a</var><span class="hyp-type"><b>: </b><span>option message</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">composite_plan_item</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="Composition-v-chk4c" style="display: none" type="checkbox"><label class="alectryon-input" for="Composition-v-chk4c"><span class="nb">split</span>.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>message, index</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>EqDecision0</var><span class="hyp-type"><b>: </b><span>EqDecision index</span></span></span><br><span><var>IM</var><span class="hyp-type"><b>: </b><span>index ‚Üí VLSM message</span></span></span><br><span><var>i</var><span class="hyp-type"><b>: </b><span>index</span></span></span><br><span><var>label_a</var><span class="hyp-type"><b>: </b><span>label (IM i)</span></span></span><br><span><var>input_a</var><span class="hyp-type"><b>: </b><span>option message</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">label composite_type</div></blockquote><div class="alectryon-extra-goals"><input class="alectryon-extra-goal-toggle" id="Composition-v-chk4d" style="display: none" type="checkbox"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>message, index</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>EqDecision0</var><span class="hyp-type"><b>: </b><span>EqDecision index</span></span></span><br><span><var>IM</var><span class="hyp-type"><b>: </b><span>index ‚Üí VLSM message</span></span></span><br><span><var>i</var><span class="hyp-type"><b>: </b><span>index</span></span></span><br><span><var>label_a</var><span class="hyp-type"><b>: </b><span>label (IM i)</span></span></span><br><span><var>input_a</var><span class="hyp-type"><b>: </b><span>option message</span></span></span><br></div><label class="goal-separator" for="Composition-v-chk4d"><hr></label><div class="goal-conclusion">option message</div></blockquote></div></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="Composition-v-chk4e" style="display: none" type="checkbox"><label class="alectryon-input" for="Composition-v-chk4e">-</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>message, index</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>EqDecision0</var><span class="hyp-type"><b>: </b><span>EqDecision index</span></span></span><br><span><var>IM</var><span class="hyp-type"><b>: </b><span>index ‚Üí VLSM message</span></span></span><br><span><var>i</var><span class="hyp-type"><b>: </b><span>index</span></span></span><br><span><var>label_a</var><span class="hyp-type"><b>: </b><span>label (IM i)</span></span></span><br><span><var>input_a</var><span class="hyp-type"><b>: </b><span>option message</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">label composite_type</div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="bp">exact</span> (existT i label_a).</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="Composition-v-chk4f" style="display: none" type="checkbox"><label class="alectryon-input" for="Composition-v-chk4f">-</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>message, index</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>EqDecision0</var><span class="hyp-type"><b>: </b><span>EqDecision index</span></span></span><br><span><var>IM</var><span class="hyp-type"><b>: </b><span>index ‚Üí VLSM message</span></span></span><br><span><var>i</var><span class="hyp-type"><b>: </b><span>index</span></span></span><br><span><var>label_a</var><span class="hyp-type"><b>: </b><span>label (IM i)</span></span></span><br><span><var>input_a</var><span class="hyp-type"><b>: </b><span>option message</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">option message</div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="bp">exact</span> input_a.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Defined</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
</span><span class="alectryon-sentence"><input class="alectryon-toggle" id="Composition-v-chk50" style="display: none" type="checkbox"><label class="alectryon-input" for="Composition-v-chk50"><span class="kn">Lemma</span> <span class="nf">composite_initial_state_prop_lift</span> :
  <span class="kr">forall</span> (<span class="nv">j</span> : index) (<span class="nv">sj</span> : state (IM j)) (<span class="nv">Hinitj</span> : initial_state_prop (IM j) sj),
    composite_initial_state_prop (lift_to_composite_state&#39; j sj).</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>message, index</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>EqDecision0</var><span class="hyp-type"><b>: </b><span>EqDecision index</span></span></span><br><span><var>IM</var><span class="hyp-type"><b>: </b><span>index ‚Üí VLSM message</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="kr">‚àÄ</span> (<span class="nv">j</span> : index) (<span class="nv">sj</span> : state (IM j)),
  initial_state_prop sj
  ‚Üí composite_initial_state_prop
      (lift_to_composite_state&#39; j sj)</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="Composition-v-chk51" style="display: none" type="checkbox"><label class="alectryon-input" for="Composition-v-chk51"><span class="kn">Proof</span>.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>message, index</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>EqDecision0</var><span class="hyp-type"><b>: </b><span>EqDecision index</span></span></span><br><span><var>IM</var><span class="hyp-type"><b>: </b><span>index ‚Üí VLSM message</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="kr">‚àÄ</span> (<span class="nv">j</span> : index) (<span class="nv">sj</span> : state (IM j)),
  initial_state_prop sj
  ‚Üí composite_initial_state_prop
      (lift_to_composite_state&#39; j sj)</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="Composition-v-chk52" style="display: none" type="checkbox"><label class="alectryon-input" for="Composition-v-chk52"><span class="nb">intros</span> j sj Hinitj i.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>message, index</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>EqDecision0</var><span class="hyp-type"><b>: </b><span>EqDecision index</span></span></span><br><span><var>IM</var><span class="hyp-type"><b>: </b><span>index ‚Üí VLSM message</span></span></span><br><span><var>j</var><span class="hyp-type"><b>: </b><span>index</span></span></span><br><span><var>sj</var><span class="hyp-type"><b>: </b><span>state (IM j)</span></span></span><br><span><var>Hinitj</var><span class="hyp-type"><b>: </b><span>initial_state_prop sj</span></span></span><br><span><var>i</var><span class="hyp-type"><b>: </b><span>index</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">initial_state_prop (lift_to_composite_state&#39; j sj i)</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="Composition-v-chk53" style="display: none" type="checkbox"><label class="alectryon-input" for="Composition-v-chk53"><span class="nb">unfold</span> lift_to_composite_state&#39;.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>message, index</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>EqDecision0</var><span class="hyp-type"><b>: </b><span>EqDecision index</span></span></span><br><span><var>IM</var><span class="hyp-type"><b>: </b><span>index ‚Üí VLSM message</span></span></span><br><span><var>j</var><span class="hyp-type"><b>: </b><span>index</span></span></span><br><span><var>sj</var><span class="hyp-type"><b>: </b><span>state (IM j)</span></span></span><br><span><var>Hinitj</var><span class="hyp-type"><b>: </b><span>initial_state_prop sj</span></span></span><br><span><var>i</var><span class="hyp-type"><b>: </b><span>index</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">initial_state_prop
  (lift_to_composite_state (`composite_s0) j sj i)</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="Composition-v-chk54" style="display: none" type="checkbox"><label class="alectryon-input" for="Composition-v-chk54"><span class="nb">destruct</span> (decide (i = j)); <span class="nb">subst</span>.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>message, index</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>EqDecision0</var><span class="hyp-type"><b>: </b><span>EqDecision index</span></span></span><br><span><var>IM</var><span class="hyp-type"><b>: </b><span>index ‚Üí VLSM message</span></span></span><br><span><var>j</var><span class="hyp-type"><b>: </b><span>index</span></span></span><br><span><var>sj</var><span class="hyp-type"><b>: </b><span>state (IM j)</span></span></span><br><span><var>Hinitj</var><span class="hyp-type"><b>: </b><span>initial_state_prop sj</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">initial_state_prop
  (lift_to_composite_state (`composite_s0) j sj j)</div></blockquote><div class="alectryon-extra-goals"><input class="alectryon-extra-goal-toggle" id="Composition-v-chk55" style="display: none" type="checkbox"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>message, index</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>EqDecision0</var><span class="hyp-type"><b>: </b><span>EqDecision index</span></span></span><br><span><var>IM</var><span class="hyp-type"><b>: </b><span>index ‚Üí VLSM message</span></span></span><br><span><var>j</var><span class="hyp-type"><b>: </b><span>index</span></span></span><br><span><var>sj</var><span class="hyp-type"><b>: </b><span>state (IM j)</span></span></span><br><span><var>Hinitj</var><span class="hyp-type"><b>: </b><span>initial_state_prop sj</span></span></span><br><span><var>i</var><span class="hyp-type"><b>: </b><span>index</span></span></span><br><span><var>n</var><span class="hyp-type"><b>: </b><span>i ‚â† j</span></span></span><br></div><label class="goal-separator" for="Composition-v-chk55"><hr></label><div class="goal-conclusion">initial_state_prop
  (lift_to_composite_state (`composite_s0) j sj i)</div></blockquote></div></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="Composition-v-chk56" style="display: none" type="checkbox"><label class="alectryon-input" for="Composition-v-chk56">-</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>message, index</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>EqDecision0</var><span class="hyp-type"><b>: </b><span>EqDecision index</span></span></span><br><span><var>IM</var><span class="hyp-type"><b>: </b><span>index ‚Üí VLSM message</span></span></span><br><span><var>j</var><span class="hyp-type"><b>: </b><span>index</span></span></span><br><span><var>sj</var><span class="hyp-type"><b>: </b><span>state (IM j)</span></span></span><br><span><var>Hinitj</var><span class="hyp-type"><b>: </b><span>initial_state_prop sj</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">initial_state_prop
  (lift_to_composite_state (`composite_s0) j sj j)</div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="bp">by</span> <span class="nb">rewrite</span> state_update_eq.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="Composition-v-chk57" style="display: none" type="checkbox"><label class="alectryon-input" for="Composition-v-chk57">-</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>message, index</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>EqDecision0</var><span class="hyp-type"><b>: </b><span>EqDecision index</span></span></span><br><span><var>IM</var><span class="hyp-type"><b>: </b><span>index ‚Üí VLSM message</span></span></span><br><span><var>j</var><span class="hyp-type"><b>: </b><span>index</span></span></span><br><span><var>sj</var><span class="hyp-type"><b>: </b><span>state (IM j)</span></span></span><br><span><var>Hinitj</var><span class="hyp-type"><b>: </b><span>initial_state_prop sj</span></span></span><br><span><var>i</var><span class="hyp-type"><b>: </b><span>index</span></span></span><br><span><var>n</var><span class="hyp-type"><b>: </b><span>i ‚â† j</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">initial_state_prop
  (lift_to_composite_state (`composite_s0) j sj i)</div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="Composition-v-chk58" style="display: none" type="checkbox"><label class="alectryon-input" for="Composition-v-chk58"><span class="nb">rewrite</span> state_update_neq; <span class="nb">cbn</span>; [| <span class="bp">done</span>].</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>message, index</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>EqDecision0</var><span class="hyp-type"><b>: </b><span>EqDecision index</span></span></span><br><span><var>IM</var><span class="hyp-type"><b>: </b><span>index ‚Üí VLSM message</span></span></span><br><span><var>j</var><span class="hyp-type"><b>: </b><span>index</span></span></span><br><span><var>sj</var><span class="hyp-type"><b>: </b><span>state (IM j)</span></span></span><br><span><var>Hinitj</var><span class="hyp-type"><b>: </b><span>initial_state_prop sj</span></span></span><br><span><var>i</var><span class="hyp-type"><b>: </b><span>index</span></span></span><br><span><var>n</var><span class="hyp-type"><b>: </b><span>i ‚â† j</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">initial_state_prop (`(vs0 (IM i)))</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><span class="alectryon-input"><span class="bp">by</span> <span class="nb">destruct</span> (vs0 _) <span class="kr">as</span> [s Hs].</span><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Qed</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
</span><span class="alectryon-sentence"><input class="alectryon-toggle" id="Composition-v-chk59" style="display: none" type="checkbox"><label class="alectryon-input" for="Composition-v-chk59"><span class="kn">Lemma</span> <span class="nf">lift_to_composite_VLSM_embedding</span> <span class="nv">j</span> :
  VLSM_embedding (IM j) free_composite_vlsm
    (lift_to_composite_label j) (lift_to_composite_state&#39; j).</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>message, index</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>EqDecision0</var><span class="hyp-type"><b>: </b><span>EqDecision index</span></span></span><br><span><var>IM</var><span class="hyp-type"><b>: </b><span>index ‚Üí VLSM message</span></span></span><br><span><var>j</var><span class="hyp-type"><b>: </b><span>index</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">VLSM_embedding (IM j) free_composite_vlsm
  (lift_to_composite_label j)
  (lift_to_composite_state&#39; j)</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="Composition-v-chk5a" style="display: none" type="checkbox"><label class="alectryon-input" for="Composition-v-chk5a"><span class="kn">Proof</span>.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>message, index</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>EqDecision0</var><span class="hyp-type"><b>: </b><span>EqDecision index</span></span></span><br><span><var>IM</var><span class="hyp-type"><b>: </b><span>index ‚Üí VLSM message</span></span></span><br><span><var>j</var><span class="hyp-type"><b>: </b><span>index</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">VLSM_embedding (IM j) free_composite_vlsm
  (lift_to_composite_label j)
  (lift_to_composite_state&#39; j)</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="Composition-v-chk5b" style="display: none" type="checkbox"><label class="alectryon-input" for="Composition-v-chk5b"><span class="nb">apply</span> basic_VLSM_strong_embedding; <span class="nb">intro</span>; <span class="nb">intros</span>.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>message, index</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>EqDecision0</var><span class="hyp-type"><b>: </b><span>EqDecision index</span></span></span><br><span><var>IM</var><span class="hyp-type"><b>: </b><span>index ‚Üí VLSM message</span></span></span><br><span><var>j</var><span class="hyp-type"><b>: </b><span>index</span></span></span><br><span><var>l</var><span class="hyp-type"><b>: </b><span>label (IM j)</span></span></span><br><span><var>s</var><span class="hyp-type"><b>: </b><span>state (IM j)</span></span></span><br><span><var>om</var><span class="hyp-type"><b>: </b><span>option message</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>valid l (s, om)</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">valid (lift_to_composite_label j l)
  (lift_to_composite_state&#39; j s, om)</div></blockquote><div class="alectryon-extra-goals"><input class="alectryon-extra-goal-toggle" id="Composition-v-chk5c" style="display: none" type="checkbox"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>message, index</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>EqDecision0</var><span class="hyp-type"><b>: </b><span>EqDecision index</span></span></span><br><span><var>IM</var><span class="hyp-type"><b>: </b><span>index ‚Üí VLSM message</span></span></span><br><span><var>j</var><span class="hyp-type"><b>: </b><span>index</span></span></span><br><span><var>l</var><span class="hyp-type"><b>: </b><span>label (IM j)</span></span></span><br><span><var>s</var><span class="hyp-type"><b>: </b><span>state (IM j)</span></span></span><br><span><var>om</var><span class="hyp-type"><b>: </b><span>option message</span></span></span><br><span><var>s'</var><span class="hyp-type"><b>: </b><span>state (IM j)</span></span></span><br><span><var>om'</var><span class="hyp-type"><b>: </b><span>option message</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>transition l (s, om) = (s&#39;, om&#39;)</span></span></span><br></div><label class="goal-separator" for="Composition-v-chk5c"><hr></label><div class="goal-conclusion">transition (lift_to_composite_label j l)
  (lift_to_composite_state&#39; j s, om) =
(lift_to_composite_state&#39; j s&#39;, om&#39;)</div></blockquote><input class="alectryon-extra-goal-toggle" id="Composition-v-chk5d" style="display: none" type="checkbox"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>message, index</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>EqDecision0</var><span class="hyp-type"><b>: </b><span>EqDecision index</span></span></span><br><span><var>IM</var><span class="hyp-type"><b>: </b><span>index ‚Üí VLSM message</span></span></span><br><span><var>j</var><span class="hyp-type"><b>: </b><span>index</span></span></span><br><span><var>s</var><span class="hyp-type"><b>: </b><span>state (IM j)</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>initial_state_prop s</span></span></span><br></div><label class="goal-separator" for="Composition-v-chk5d"><hr></label><div class="goal-conclusion">initial_state_prop (lift_to_composite_state&#39; j s)</div></blockquote><input class="alectryon-extra-goal-toggle" id="Composition-v-chk5e" style="display: none" type="checkbox"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>message, index</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>EqDecision0</var><span class="hyp-type"><b>: </b><span>EqDecision index</span></span></span><br><span><var>IM</var><span class="hyp-type"><b>: </b><span>index ‚Üí VLSM message</span></span></span><br><span><var>j</var><span class="hyp-type"><b>: </b><span>index</span></span></span><br><span><var>m</var><span class="hyp-type"><b>: </b><span>message</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>initial_message_prop m</span></span></span><br></div><label class="goal-separator" for="Composition-v-chk5e"><hr></label><div class="goal-conclusion">initial_message_prop m</div></blockquote></div></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="Composition-v-chk5f" style="display: none" type="checkbox"><label class="alectryon-input" for="Composition-v-chk5f">-</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>message, index</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>EqDecision0</var><span class="hyp-type"><b>: </b><span>EqDecision index</span></span></span><br><span><var>IM</var><span class="hyp-type"><b>: </b><span>index ‚Üí VLSM message</span></span></span><br><span><var>j</var><span class="hyp-type"><b>: </b><span>index</span></span></span><br><span><var>l</var><span class="hyp-type"><b>: </b><span>label (IM j)</span></span></span><br><span><var>s</var><span class="hyp-type"><b>: </b><span>state (IM j)</span></span></span><br><span><var>om</var><span class="hyp-type"><b>: </b><span>option message</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>valid l (s, om)</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">valid (lift_to_composite_label j l)
  (lift_to_composite_state&#39; j s, om)</div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="Composition-v-chk60" style="display: none" type="checkbox"><label class="alectryon-input" for="Composition-v-chk60"><span class="nb">cbn</span>; <span class="nb">unfold</span> lift_to_composite_state&#39;.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>message, index</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>EqDecision0</var><span class="hyp-type"><b>: </b><span>EqDecision index</span></span></span><br><span><var>IM</var><span class="hyp-type"><b>: </b><span>index ‚Üí VLSM message</span></span></span><br><span><var>j</var><span class="hyp-type"><b>: </b><span>index</span></span></span><br><span><var>l</var><span class="hyp-type"><b>: </b><span>label (IM j)</span></span></span><br><span><var>s</var><span class="hyp-type"><b>: </b><span>state (IM j)</span></span></span><br><span><var>om</var><span class="hyp-type"><b>: </b><span>option message</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>valid l (s, om)</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">valid l
  (lift_to_composite_state (`composite_s0) j s j, om)</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><span class="alectryon-input"><span class="bp">by</span> <span class="nb">rewrite</span> state_update_eq.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="Composition-v-chk61" style="display: none" type="checkbox"><label class="alectryon-input" for="Composition-v-chk61">-</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>message, index</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>EqDecision0</var><span class="hyp-type"><b>: </b><span>EqDecision index</span></span></span><br><span><var>IM</var><span class="hyp-type"><b>: </b><span>index ‚Üí VLSM message</span></span></span><br><span><var>j</var><span class="hyp-type"><b>: </b><span>index</span></span></span><br><span><var>l</var><span class="hyp-type"><b>: </b><span>label (IM j)</span></span></span><br><span><var>s</var><span class="hyp-type"><b>: </b><span>state (IM j)</span></span></span><br><span><var>om</var><span class="hyp-type"><b>: </b><span>option message</span></span></span><br><span><var>s'</var><span class="hyp-type"><b>: </b><span>state (IM j)</span></span></span><br><span><var>om'</var><span class="hyp-type"><b>: </b><span>option message</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>transition l (s, om) = (s&#39;, om&#39;)</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">transition (lift_to_composite_label j l)
  (lift_to_composite_state&#39; j s, om) =
(lift_to_composite_state&#39; j s&#39;, om&#39;)</div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="Composition-v-chk62" style="display: none" type="checkbox"><label class="alectryon-input" for="Composition-v-chk62"><span class="nb">cbn</span>; <span class="nb">unfold</span> lift_to_composite_state&#39; <span class="nb">at</span> <span class="mi">1</span>.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>message, index</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>EqDecision0</var><span class="hyp-type"><b>: </b><span>EqDecision index</span></span></span><br><span><var>IM</var><span class="hyp-type"><b>: </b><span>index ‚Üí VLSM message</span></span></span><br><span><var>j</var><span class="hyp-type"><b>: </b><span>index</span></span></span><br><span><var>l</var><span class="hyp-type"><b>: </b><span>label (IM j)</span></span></span><br><span><var>s</var><span class="hyp-type"><b>: </b><span>state (IM j)</span></span></span><br><span><var>om</var><span class="hyp-type"><b>: </b><span>option message</span></span></span><br><span><var>s'</var><span class="hyp-type"><b>: </b><span>state (IM j)</span></span></span><br><span><var>om'</var><span class="hyp-type"><b>: </b><span>option message</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>transition l (s, om) = (s&#39;, om&#39;)</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">(<span class="kr">let</span> (<span class="nv">si&#39;</span>, om&#39;) :=
   transition l
     (lift_to_composite_state (`composite_s0) j s j,
      om) <span class="kr">in</span>
 (state_update (lift_to_composite_state&#39; j s) j si&#39;,
  om&#39;)) = (lift_to_composite_state&#39; j s&#39;, om&#39;)</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="Composition-v-chk63" style="display: none" type="checkbox"><label class="alectryon-input" for="Composition-v-chk63"><span class="nb">rewrite</span> state_update_eq.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>message, index</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>EqDecision0</var><span class="hyp-type"><b>: </b><span>EqDecision index</span></span></span><br><span><var>IM</var><span class="hyp-type"><b>: </b><span>index ‚Üí VLSM message</span></span></span><br><span><var>j</var><span class="hyp-type"><b>: </b><span>index</span></span></span><br><span><var>l</var><span class="hyp-type"><b>: </b><span>label (IM j)</span></span></span><br><span><var>s</var><span class="hyp-type"><b>: </b><span>state (IM j)</span></span></span><br><span><var>om</var><span class="hyp-type"><b>: </b><span>option message</span></span></span><br><span><var>s'</var><span class="hyp-type"><b>: </b><span>state (IM j)</span></span></span><br><span><var>om'</var><span class="hyp-type"><b>: </b><span>option message</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>transition l (s, om) = (s&#39;, om&#39;)</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">(<span class="kr">let</span> (<span class="nv">si&#39;</span>, om&#39;) := transition l (s, om) <span class="kr">in</span>
 (state_update (lift_to_composite_state&#39; j s) j si&#39;,
  om&#39;)) = (lift_to_composite_state&#39; j s&#39;, om&#39;)</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="Composition-v-chk64" style="display: none" type="checkbox"><label class="alectryon-input" for="Composition-v-chk64"><span class="nb">replace</span> (transition _ _ _) <span class="kr">with</span> (s&#39;, om&#39;).</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>message, index</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>EqDecision0</var><span class="hyp-type"><b>: </b><span>EqDecision index</span></span></span><br><span><var>IM</var><span class="hyp-type"><b>: </b><span>index ‚Üí VLSM message</span></span></span><br><span><var>j</var><span class="hyp-type"><b>: </b><span>index</span></span></span><br><span><var>l</var><span class="hyp-type"><b>: </b><span>label (IM j)</span></span></span><br><span><var>s</var><span class="hyp-type"><b>: </b><span>state (IM j)</span></span></span><br><span><var>om</var><span class="hyp-type"><b>: </b><span>option message</span></span></span><br><span><var>s'</var><span class="hyp-type"><b>: </b><span>state (IM j)</span></span></span><br><span><var>om'</var><span class="hyp-type"><b>: </b><span>option message</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>transition l (s, om) = (s&#39;, om&#39;)</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">(state_update (lift_to_composite_state&#39; j s) j s&#39;, om&#39;) =
(lift_to_composite_state&#39; j s&#39;, om&#39;)</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="Composition-v-chk65" style="display: none" type="checkbox"><label class="alectryon-input" for="Composition-v-chk65"><span class="nb">unfold</span> lift_to_composite_state&#39;.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>message, index</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>EqDecision0</var><span class="hyp-type"><b>: </b><span>EqDecision index</span></span></span><br><span><var>IM</var><span class="hyp-type"><b>: </b><span>index ‚Üí VLSM message</span></span></span><br><span><var>j</var><span class="hyp-type"><b>: </b><span>index</span></span></span><br><span><var>l</var><span class="hyp-type"><b>: </b><span>label (IM j)</span></span></span><br><span><var>s</var><span class="hyp-type"><b>: </b><span>state (IM j)</span></span></span><br><span><var>om</var><span class="hyp-type"><b>: </b><span>option message</span></span></span><br><span><var>s'</var><span class="hyp-type"><b>: </b><span>state (IM j)</span></span></span><br><span><var>om'</var><span class="hyp-type"><b>: </b><span>option message</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>transition l (s, om) = (s&#39;, om&#39;)</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">(state_update
   (lift_to_composite_state (`composite_s0) j s) j s&#39;,
 om&#39;) =
(lift_to_composite_state (`composite_s0) j s&#39;, om&#39;)</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><span class="alectryon-input"><span class="bp">by</span> <span class="nb">rewrite</span> state_update_twice.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="Composition-v-chk66" style="display: none" type="checkbox"><label class="alectryon-input" for="Composition-v-chk66">-</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>message, index</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>EqDecision0</var><span class="hyp-type"><b>: </b><span>EqDecision index</span></span></span><br><span><var>IM</var><span class="hyp-type"><b>: </b><span>index ‚Üí VLSM message</span></span></span><br><span><var>j</var><span class="hyp-type"><b>: </b><span>index</span></span></span><br><span><var>s</var><span class="hyp-type"><b>: </b><span>state (IM j)</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>initial_state_prop s</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">initial_state_prop (lift_to_composite_state&#39; j s)</div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="bp">by</span> <span class="nb">cbn</span>; <span class="nb">apply</span> composite_initial_state_prop_lift.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="Composition-v-chk67" style="display: none" type="checkbox"><label class="alectryon-input" for="Composition-v-chk67">-</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>message, index</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>EqDecision0</var><span class="hyp-type"><b>: </b><span>EqDecision index</span></span></span><br><span><var>IM</var><span class="hyp-type"><b>: </b><span>index ‚Üí VLSM message</span></span></span><br><span><var>j</var><span class="hyp-type"><b>: </b><span>index</span></span></span><br><span><var>m</var><span class="hyp-type"><b>: </b><span>message</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>initial_message_prop m</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">initial_message_prop m</div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="bp">by</span> <span class="kr">exists</span> <span class="nv">j</span>, (exist _ _ H).</span><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Qed</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
</span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Definition</span> <span class="nf">lift_to_composite_finite_trace</span>
  (<span class="nv">j</span> : index) : list (transition_item (IM j)) -&gt; list composite_transition_item :=
    VLSM_embedding_finite_trace_project (lift_to_composite_VLSM_embedding j).</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
</span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Definition</span> <span class="nf">lift_to_composite_finite_trace_last</span> (<span class="nv">j</span> : index) :=
  VLSM_embedding_finite_trace_last (lift_to_composite_VLSM_embedding j).</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
</span><span class="alectryon-sentence"><input class="alectryon-toggle" id="Composition-v-chk68" style="display: none" type="checkbox"><label class="alectryon-input" for="Composition-v-chk68"><span class="kn">Lemma</span> <span class="nf">lift_to_composite_generalized_preloaded_VLSM_embedding</span>
  (<span class="nv">P</span> <span class="nv">Q</span> : message -&gt; <span class="kt">Prop</span>)
  (<span class="nv">PimpliesQ</span> : <span class="kr">forall</span> <span class="nv">m</span>, P m -&gt; Q m)
  (<span class="nv">j</span> : index)
  : VLSM_embedding
      (preloaded_vlsm (IM j) P) (preloaded_vlsm free_composite_vlsm Q)
      (lift_to_composite_label j) (lift_to_composite_state&#39; j).</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>message, index</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>EqDecision0</var><span class="hyp-type"><b>: </b><span>EqDecision index</span></span></span><br><span><var>IM</var><span class="hyp-type"><b>: </b><span>index ‚Üí VLSM message</span></span></span><br><span><var>P, Q</var><span class="hyp-type"><b>: </b><span>message ‚Üí <span class="kt">Prop</span></span></span></span><br><span><var>PimpliesQ</var><span class="hyp-type"><b>: </b><span><span class="kr">‚àÄ</span> <span class="nv">m</span> : message, P m ‚Üí Q m</span></span></span><br><span><var>j</var><span class="hyp-type"><b>: </b><span>index</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">VLSM_embedding (preloaded_vlsm (IM j) P)
  (preloaded_vlsm free_composite_vlsm Q)
  (lift_to_composite_label j)
  (lift_to_composite_state&#39; j)</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="Composition-v-chk69" style="display: none" type="checkbox"><label class="alectryon-input" for="Composition-v-chk69"><span class="kn">Proof</span>.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>message, index</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>EqDecision0</var><span class="hyp-type"><b>: </b><span>EqDecision index</span></span></span><br><span><var>IM</var><span class="hyp-type"><b>: </b><span>index ‚Üí VLSM message</span></span></span><br><span><var>P, Q</var><span class="hyp-type"><b>: </b><span>message ‚Üí <span class="kt">Prop</span></span></span></span><br><span><var>PimpliesQ</var><span class="hyp-type"><b>: </b><span><span class="kr">‚àÄ</span> <span class="nv">m</span> : message, P m ‚Üí Q m</span></span></span><br><span><var>j</var><span class="hyp-type"><b>: </b><span>index</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">VLSM_embedding (preloaded_vlsm (IM j) P)
  (preloaded_vlsm free_composite_vlsm Q)
  (lift_to_composite_label j)
  (lift_to_composite_state&#39; j)</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="Composition-v-chk6a" style="display: none" type="checkbox"><label class="alectryon-input" for="Composition-v-chk6a"><span class="nb">apply</span> basic_VLSM_embedding_preloaded_with; <span class="nb">intro</span>; <span class="nb">intros</span>.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>message, index</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>EqDecision0</var><span class="hyp-type"><b>: </b><span>EqDecision index</span></span></span><br><span><var>IM</var><span class="hyp-type"><b>: </b><span>index ‚Üí VLSM message</span></span></span><br><span><var>P, Q</var><span class="hyp-type"><b>: </b><span>message ‚Üí <span class="kt">Prop</span></span></span></span><br><span><var>PimpliesQ</var><span class="hyp-type"><b>: </b><span><span class="kr">‚àÄ</span> <span class="nv">m</span> : message, P m ‚Üí Q m</span></span></span><br><span><var>j</var><span class="hyp-type"><b>: </b><span>index</span></span></span><br><span><var>m</var><span class="hyp-type"><b>: </b><span>message</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>P m</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">Q m</div></blockquote><div class="alectryon-extra-goals"><input class="alectryon-extra-goal-toggle" id="Composition-v-chk6b" style="display: none" type="checkbox"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>message, index</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>EqDecision0</var><span class="hyp-type"><b>: </b><span>EqDecision index</span></span></span><br><span><var>IM</var><span class="hyp-type"><b>: </b><span>index ‚Üí VLSM message</span></span></span><br><span><var>P, Q</var><span class="hyp-type"><b>: </b><span>message ‚Üí <span class="kt">Prop</span></span></span></span><br><span><var>PimpliesQ</var><span class="hyp-type"><b>: </b><span><span class="kr">‚àÄ</span> <span class="nv">m</span> : message, P m ‚Üí Q m</span></span></span><br><span><var>j</var><span class="hyp-type"><b>: </b><span>index</span></span></span><br><span><var>l</var><span class="hyp-type"><b>: </b><span>label (IM j)</span></span></span><br><span><var>s</var><span class="hyp-type"><b>: </b><span>state (IM j)</span></span></span><br><span><var>om</var><span class="hyp-type"><b>: </b><span>option message</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>valid l (s, om)</span></span></span><br></div><label class="goal-separator" for="Composition-v-chk6b"><hr></label><div class="goal-conclusion">valid (lift_to_composite_label j l)
  (lift_to_composite_state&#39; j s, om)</div></blockquote><input class="alectryon-extra-goal-toggle" id="Composition-v-chk6c" style="display: none" type="checkbox"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>message, index</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>EqDecision0</var><span class="hyp-type"><b>: </b><span>EqDecision index</span></span></span><br><span><var>IM</var><span class="hyp-type"><b>: </b><span>index ‚Üí VLSM message</span></span></span><br><span><var>P, Q</var><span class="hyp-type"><b>: </b><span>message ‚Üí <span class="kt">Prop</span></span></span></span><br><span><var>PimpliesQ</var><span class="hyp-type"><b>: </b><span><span class="kr">‚àÄ</span> <span class="nv">m</span> : message, P m ‚Üí Q m</span></span></span><br><span><var>j</var><span class="hyp-type"><b>: </b><span>index</span></span></span><br><span><var>l</var><span class="hyp-type"><b>: </b><span>label (IM j)</span></span></span><br><span><var>s</var><span class="hyp-type"><b>: </b><span>state (IM j)</span></span></span><br><span><var>om</var><span class="hyp-type"><b>: </b><span>option message</span></span></span><br><span><var>s'</var><span class="hyp-type"><b>: </b><span>state (IM j)</span></span></span><br><span><var>om'</var><span class="hyp-type"><b>: </b><span>option message</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>transition l (s, om) = (s&#39;, om&#39;)</span></span></span><br></div><label class="goal-separator" for="Composition-v-chk6c"><hr></label><div class="goal-conclusion">transition (lift_to_composite_label j l)
  (lift_to_composite_state&#39; j s, om) =
(lift_to_composite_state&#39; j s&#39;, om&#39;)</div></blockquote><input class="alectryon-extra-goal-toggle" id="Composition-v-chk6d" style="display: none" type="checkbox"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>message, index</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>EqDecision0</var><span class="hyp-type"><b>: </b><span>EqDecision index</span></span></span><br><span><var>IM</var><span class="hyp-type"><b>: </b><span>index ‚Üí VLSM message</span></span></span><br><span><var>P, Q</var><span class="hyp-type"><b>: </b><span>message ‚Üí <span class="kt">Prop</span></span></span></span><br><span><var>PimpliesQ</var><span class="hyp-type"><b>: </b><span><span class="kr">‚àÄ</span> <span class="nv">m</span> : message, P m ‚Üí Q m</span></span></span><br><span><var>j</var><span class="hyp-type"><b>: </b><span>index</span></span></span><br><span><var>s</var><span class="hyp-type"><b>: </b><span>state (IM j)</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>initial_state_prop s</span></span></span><br></div><label class="goal-separator" for="Composition-v-chk6d"><hr></label><div class="goal-conclusion">initial_state_prop (lift_to_composite_state&#39; j s)</div></blockquote><input class="alectryon-extra-goal-toggle" id="Composition-v-chk6e" style="display: none" type="checkbox"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>message, index</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>EqDecision0</var><span class="hyp-type"><b>: </b><span>EqDecision index</span></span></span><br><span><var>IM</var><span class="hyp-type"><b>: </b><span>index ‚Üí VLSM message</span></span></span><br><span><var>P, Q</var><span class="hyp-type"><b>: </b><span>message ‚Üí <span class="kt">Prop</span></span></span></span><br><span><var>PimpliesQ</var><span class="hyp-type"><b>: </b><span><span class="kr">‚àÄ</span> <span class="nv">m</span> : message, P m ‚Üí Q m</span></span></span><br><span><var>j</var><span class="hyp-type"><b>: </b><span>index</span></span></span><br><span><var>m</var><span class="hyp-type"><b>: </b><span>message</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>initial_message_prop m</span></span></span><br></div><label class="goal-separator" for="Composition-v-chk6e"><hr></label><div class="goal-conclusion">initial_message_prop m</div></blockquote></div></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="Composition-v-chk6f" style="display: none" type="checkbox"><label class="alectryon-input" for="Composition-v-chk6f">-</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>message, index</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>EqDecision0</var><span class="hyp-type"><b>: </b><span>EqDecision index</span></span></span><br><span><var>IM</var><span class="hyp-type"><b>: </b><span>index ‚Üí VLSM message</span></span></span><br><span><var>P, Q</var><span class="hyp-type"><b>: </b><span>message ‚Üí <span class="kt">Prop</span></span></span></span><br><span><var>PimpliesQ</var><span class="hyp-type"><b>: </b><span><span class="kr">‚àÄ</span> <span class="nv">m</span> : message, P m ‚Üí Q m</span></span></span><br><span><var>j</var><span class="hyp-type"><b>: </b><span>index</span></span></span><br><span><var>m</var><span class="hyp-type"><b>: </b><span>message</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>P m</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">Q m</div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="bp">by</span> <span class="nb">apply</span> PimpliesQ.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="Composition-v-chk70" style="display: none" type="checkbox"><label class="alectryon-input" for="Composition-v-chk70">-</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>message, index</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>EqDecision0</var><span class="hyp-type"><b>: </b><span>EqDecision index</span></span></span><br><span><var>IM</var><span class="hyp-type"><b>: </b><span>index ‚Üí VLSM message</span></span></span><br><span><var>P, Q</var><span class="hyp-type"><b>: </b><span>message ‚Üí <span class="kt">Prop</span></span></span></span><br><span><var>PimpliesQ</var><span class="hyp-type"><b>: </b><span><span class="kr">‚àÄ</span> <span class="nv">m</span> : message, P m ‚Üí Q m</span></span></span><br><span><var>j</var><span class="hyp-type"><b>: </b><span>index</span></span></span><br><span><var>l</var><span class="hyp-type"><b>: </b><span>label (IM j)</span></span></span><br><span><var>s</var><span class="hyp-type"><b>: </b><span>state (IM j)</span></span></span><br><span><var>om</var><span class="hyp-type"><b>: </b><span>option message</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>valid l (s, om)</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">valid (lift_to_composite_label j l)
  (lift_to_composite_state&#39; j s, om)</div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="bp">by</span> <span class="nb">cbn</span>; <span class="nb">unfold</span> lift_to_composite_state&#39;; <span class="nb">rewrite</span> state_update_eq.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="Composition-v-chk71" style="display: none" type="checkbox"><label class="alectryon-input" for="Composition-v-chk71">-</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>message, index</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>EqDecision0</var><span class="hyp-type"><b>: </b><span>EqDecision index</span></span></span><br><span><var>IM</var><span class="hyp-type"><b>: </b><span>index ‚Üí VLSM message</span></span></span><br><span><var>P, Q</var><span class="hyp-type"><b>: </b><span>message ‚Üí <span class="kt">Prop</span></span></span></span><br><span><var>PimpliesQ</var><span class="hyp-type"><b>: </b><span><span class="kr">‚àÄ</span> <span class="nv">m</span> : message, P m ‚Üí Q m</span></span></span><br><span><var>j</var><span class="hyp-type"><b>: </b><span>index</span></span></span><br><span><var>l</var><span class="hyp-type"><b>: </b><span>label (IM j)</span></span></span><br><span><var>s</var><span class="hyp-type"><b>: </b><span>state (IM j)</span></span></span><br><span><var>om</var><span class="hyp-type"><b>: </b><span>option message</span></span></span><br><span><var>s'</var><span class="hyp-type"><b>: </b><span>state (IM j)</span></span></span><br><span><var>om'</var><span class="hyp-type"><b>: </b><span>option message</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>transition l (s, om) = (s&#39;, om&#39;)</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">transition (lift_to_composite_label j l)
  (lift_to_composite_state&#39; j s, om) =
(lift_to_composite_state&#39; j s&#39;, om&#39;)</div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="Composition-v-chk72" style="display: none" type="checkbox"><label class="alectryon-input" for="Composition-v-chk72"><span class="nb">cbn</span>; <span class="nb">unfold</span> lift_to_composite_state&#39; <span class="nb">at</span> <span class="mi">1</span>.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>message, index</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>EqDecision0</var><span class="hyp-type"><b>: </b><span>EqDecision index</span></span></span><br><span><var>IM</var><span class="hyp-type"><b>: </b><span>index ‚Üí VLSM message</span></span></span><br><span><var>P, Q</var><span class="hyp-type"><b>: </b><span>message ‚Üí <span class="kt">Prop</span></span></span></span><br><span><var>PimpliesQ</var><span class="hyp-type"><b>: </b><span><span class="kr">‚àÄ</span> <span class="nv">m</span> : message, P m ‚Üí Q m</span></span></span><br><span><var>j</var><span class="hyp-type"><b>: </b><span>index</span></span></span><br><span><var>l</var><span class="hyp-type"><b>: </b><span>label (IM j)</span></span></span><br><span><var>s</var><span class="hyp-type"><b>: </b><span>state (IM j)</span></span></span><br><span><var>om</var><span class="hyp-type"><b>: </b><span>option message</span></span></span><br><span><var>s'</var><span class="hyp-type"><b>: </b><span>state (IM j)</span></span></span><br><span><var>om'</var><span class="hyp-type"><b>: </b><span>option message</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>transition l (s, om) = (s&#39;, om&#39;)</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">(<span class="kr">let</span> (<span class="nv">si&#39;</span>, om&#39;) :=
   transition l
     (lift_to_composite_state (`composite_s0) j s j,
      om) <span class="kr">in</span>
 (state_update (lift_to_composite_state&#39; j s) j si&#39;,
  om&#39;)) = (lift_to_composite_state&#39; j s&#39;, om&#39;)</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="Composition-v-chk73" style="display: none" type="checkbox"><label class="alectryon-input" for="Composition-v-chk73"><span class="nb">rewrite</span> state_update_eq.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>message, index</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>EqDecision0</var><span class="hyp-type"><b>: </b><span>EqDecision index</span></span></span><br><span><var>IM</var><span class="hyp-type"><b>: </b><span>index ‚Üí VLSM message</span></span></span><br><span><var>P, Q</var><span class="hyp-type"><b>: </b><span>message ‚Üí <span class="kt">Prop</span></span></span></span><br><span><var>PimpliesQ</var><span class="hyp-type"><b>: </b><span><span class="kr">‚àÄ</span> <span class="nv">m</span> : message, P m ‚Üí Q m</span></span></span><br><span><var>j</var><span class="hyp-type"><b>: </b><span>index</span></span></span><br><span><var>l</var><span class="hyp-type"><b>: </b><span>label (IM j)</span></span></span><br><span><var>s</var><span class="hyp-type"><b>: </b><span>state (IM j)</span></span></span><br><span><var>om</var><span class="hyp-type"><b>: </b><span>option message</span></span></span><br><span><var>s'</var><span class="hyp-type"><b>: </b><span>state (IM j)</span></span></span><br><span><var>om'</var><span class="hyp-type"><b>: </b><span>option message</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>transition l (s, om) = (s&#39;, om&#39;)</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">(<span class="kr">let</span> (<span class="nv">si&#39;</span>, om&#39;) := transition l (s, om) <span class="kr">in</span>
 (state_update (lift_to_composite_state&#39; j s) j si&#39;,
  om&#39;)) = (lift_to_composite_state&#39; j s&#39;, om&#39;)</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="Composition-v-chk74" style="display: none" type="checkbox"><label class="alectryon-input" for="Composition-v-chk74"><span class="nb">replace</span> (transition (IM j) l _) <span class="kr">with</span> (s&#39;, om&#39;).</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>message, index</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>EqDecision0</var><span class="hyp-type"><b>: </b><span>EqDecision index</span></span></span><br><span><var>IM</var><span class="hyp-type"><b>: </b><span>index ‚Üí VLSM message</span></span></span><br><span><var>P, Q</var><span class="hyp-type"><b>: </b><span>message ‚Üí <span class="kt">Prop</span></span></span></span><br><span><var>PimpliesQ</var><span class="hyp-type"><b>: </b><span><span class="kr">‚àÄ</span> <span class="nv">m</span> : message, P m ‚Üí Q m</span></span></span><br><span><var>j</var><span class="hyp-type"><b>: </b><span>index</span></span></span><br><span><var>l</var><span class="hyp-type"><b>: </b><span>label (IM j)</span></span></span><br><span><var>s</var><span class="hyp-type"><b>: </b><span>state (IM j)</span></span></span><br><span><var>om</var><span class="hyp-type"><b>: </b><span>option message</span></span></span><br><span><var>s'</var><span class="hyp-type"><b>: </b><span>state (IM j)</span></span></span><br><span><var>om'</var><span class="hyp-type"><b>: </b><span>option message</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>transition l (s, om) = (s&#39;, om&#39;)</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">(state_update (lift_to_composite_state&#39; j s) j s&#39;, om&#39;) =
(lift_to_composite_state&#39; j s&#39;, om&#39;)</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="Composition-v-chk75" style="display: none" type="checkbox"><label class="alectryon-input" for="Composition-v-chk75"><span class="nb">unfold</span> lift_to_composite_state&#39;.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>message, index</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>EqDecision0</var><span class="hyp-type"><b>: </b><span>EqDecision index</span></span></span><br><span><var>IM</var><span class="hyp-type"><b>: </b><span>index ‚Üí VLSM message</span></span></span><br><span><var>P, Q</var><span class="hyp-type"><b>: </b><span>message ‚Üí <span class="kt">Prop</span></span></span></span><br><span><var>PimpliesQ</var><span class="hyp-type"><b>: </b><span><span class="kr">‚àÄ</span> <span class="nv">m</span> : message, P m ‚Üí Q m</span></span></span><br><span><var>j</var><span class="hyp-type"><b>: </b><span>index</span></span></span><br><span><var>l</var><span class="hyp-type"><b>: </b><span>label (IM j)</span></span></span><br><span><var>s</var><span class="hyp-type"><b>: </b><span>state (IM j)</span></span></span><br><span><var>om</var><span class="hyp-type"><b>: </b><span>option message</span></span></span><br><span><var>s'</var><span class="hyp-type"><b>: </b><span>state (IM j)</span></span></span><br><span><var>om'</var><span class="hyp-type"><b>: </b><span>option message</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>transition l (s, om) = (s&#39;, om&#39;)</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">(state_update
   (lift_to_composite_state (`composite_s0) j s) j s&#39;,
 om&#39;) =
(lift_to_composite_state (`composite_s0) j s&#39;, om&#39;)</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><span class="alectryon-input"><span class="bp">by</span> <span class="nb">rewrite</span> state_update_twice.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="Composition-v-chk76" style="display: none" type="checkbox"><label class="alectryon-input" for="Composition-v-chk76">-</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>message, index</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>EqDecision0</var><span class="hyp-type"><b>: </b><span>EqDecision index</span></span></span><br><span><var>IM</var><span class="hyp-type"><b>: </b><span>index ‚Üí VLSM message</span></span></span><br><span><var>P, Q</var><span class="hyp-type"><b>: </b><span>message ‚Üí <span class="kt">Prop</span></span></span></span><br><span><var>PimpliesQ</var><span class="hyp-type"><b>: </b><span><span class="kr">‚àÄ</span> <span class="nv">m</span> : message, P m ‚Üí Q m</span></span></span><br><span><var>j</var><span class="hyp-type"><b>: </b><span>index</span></span></span><br><span><var>s</var><span class="hyp-type"><b>: </b><span>state (IM j)</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>initial_state_prop s</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">initial_state_prop (lift_to_composite_state&#39; j s)</div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="bp">by</span> <span class="nb">cbn</span>; <span class="nb">apply</span> composite_initial_state_prop_lift.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="Composition-v-chk77" style="display: none" type="checkbox"><label class="alectryon-input" for="Composition-v-chk77">-</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>message, index</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>EqDecision0</var><span class="hyp-type"><b>: </b><span>EqDecision index</span></span></span><br><span><var>IM</var><span class="hyp-type"><b>: </b><span>index ‚Üí VLSM message</span></span></span><br><span><var>P, Q</var><span class="hyp-type"><b>: </b><span>message ‚Üí <span class="kt">Prop</span></span></span></span><br><span><var>PimpliesQ</var><span class="hyp-type"><b>: </b><span><span class="kr">‚àÄ</span> <span class="nv">m</span> : message, P m ‚Üí Q m</span></span></span><br><span><var>j</var><span class="hyp-type"><b>: </b><span>index</span></span></span><br><span><var>m</var><span class="hyp-type"><b>: </b><span>message</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>initial_message_prop m</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">initial_message_prop m</div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="bp">by</span> <span class="kr">exists</span> <span class="nv">j</span>, (exist _ _ H).</span><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Qed</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
</span><span class="alectryon-sentence"><input class="alectryon-toggle" id="Composition-v-chk78" style="display: none" type="checkbox"><label class="alectryon-input" for="Composition-v-chk78"><span class="kn">Lemma</span> <span class="nf">lift_to_composite_preloaded_VLSM_embedding</span> (<span class="nv">j</span> : index) :
  VLSM_embedding
    (preloaded_with_all_messages_vlsm (IM j))
    (preloaded_with_all_messages_vlsm free_composite_vlsm)
    (lift_to_composite_label j)
    (lift_to_composite_state&#39; j).</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>message, index</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>EqDecision0</var><span class="hyp-type"><b>: </b><span>EqDecision index</span></span></span><br><span><var>IM</var><span class="hyp-type"><b>: </b><span>index ‚Üí VLSM message</span></span></span><br><span><var>j</var><span class="hyp-type"><b>: </b><span>index</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">VLSM_embedding
  (preloaded_with_all_messages_vlsm (IM j))
  (preloaded_with_all_messages_vlsm
     free_composite_vlsm) (lift_to_composite_label j)
  (lift_to_composite_state&#39; j)</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="Composition-v-chk79" style="display: none" type="checkbox"><label class="alectryon-input" for="Composition-v-chk79"><span class="kn">Proof</span>.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>message, index</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>EqDecision0</var><span class="hyp-type"><b>: </b><span>EqDecision index</span></span></span><br><span><var>IM</var><span class="hyp-type"><b>: </b><span>index ‚Üí VLSM message</span></span></span><br><span><var>j</var><span class="hyp-type"><b>: </b><span>index</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">VLSM_embedding
  (preloaded_with_all_messages_vlsm (IM j))
  (preloaded_with_all_messages_vlsm
     free_composite_vlsm) (lift_to_composite_label j)
  (lift_to_composite_state&#39; j)</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="Composition-v-chk7a" style="display: none" type="checkbox"><label class="alectryon-input" for="Composition-v-chk7a"><span class="nb">apply</span> basic_VLSM_embedding_preloaded.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>message, index</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>EqDecision0</var><span class="hyp-type"><b>: </b><span>EqDecision index</span></span></span><br><span><var>IM</var><span class="hyp-type"><b>: </b><span>index ‚Üí VLSM message</span></span></span><br><span><var>j</var><span class="hyp-type"><b>: </b><span>index</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">strong_embedding_valid_preservation (IM j)
  free_composite_vlsm (lift_to_composite_label j)
  (lift_to_composite_state&#39; j)</div></blockquote><div class="alectryon-extra-goals"><input class="alectryon-extra-goal-toggle" id="Composition-v-chk7b" style="display: none" type="checkbox"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>message, index</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>EqDecision0</var><span class="hyp-type"><b>: </b><span>EqDecision index</span></span></span><br><span><var>IM</var><span class="hyp-type"><b>: </b><span>index ‚Üí VLSM message</span></span></span><br><span><var>j</var><span class="hyp-type"><b>: </b><span>index</span></span></span><br></div><label class="goal-separator" for="Composition-v-chk7b"><hr></label><div class="goal-conclusion">strong_embedding_transition_preservation 
  (IM j) free_composite_vlsm
  (lift_to_composite_label j)
  (lift_to_composite_state&#39; j)</div></blockquote><input class="alectryon-extra-goal-toggle" id="Composition-v-chk7c" style="display: none" type="checkbox"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>message, index</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>EqDecision0</var><span class="hyp-type"><b>: </b><span>EqDecision index</span></span></span><br><span><var>IM</var><span class="hyp-type"><b>: </b><span>index ‚Üí VLSM message</span></span></span><br><span><var>j</var><span class="hyp-type"><b>: </b><span>index</span></span></span><br></div><label class="goal-separator" for="Composition-v-chk7c"><hr></label><div class="goal-conclusion">strong_projection_initial_state_preservation 
  (IM j) free_composite_vlsm
  (lift_to_composite_state&#39; j)</div></blockquote></div></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="Composition-v-chk7d" style="display: none" type="checkbox"><label class="alectryon-input" for="Composition-v-chk7d">-</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>message, index</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>EqDecision0</var><span class="hyp-type"><b>: </b><span>EqDecision index</span></span></span><br><span><var>IM</var><span class="hyp-type"><b>: </b><span>index ‚Üí VLSM message</span></span></span><br><span><var>j</var><span class="hyp-type"><b>: </b><span>index</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">strong_embedding_valid_preservation (IM j)
  free_composite_vlsm (lift_to_composite_label j)
  (lift_to_composite_state&#39; j)</div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="Composition-v-chk7e" style="display: none" type="checkbox"><label class="alectryon-input" for="Composition-v-chk7e"><span class="nb">intro</span>; <span class="nb">intros</span>.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>message, index</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>EqDecision0</var><span class="hyp-type"><b>: </b><span>EqDecision index</span></span></span><br><span><var>IM</var><span class="hyp-type"><b>: </b><span>index ‚Üí VLSM message</span></span></span><br><span><var>j</var><span class="hyp-type"><b>: </b><span>index</span></span></span><br><span><var>l</var><span class="hyp-type"><b>: </b><span>label (IM j)</span></span></span><br><span><var>s</var><span class="hyp-type"><b>: </b><span>state (IM j)</span></span></span><br><span><var>om</var><span class="hyp-type"><b>: </b><span>option message</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>valid l (s, om)</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">valid (lift_to_composite_label j l)
  (lift_to_composite_state&#39; j s, om)</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="Composition-v-chk7f" style="display: none" type="checkbox"><label class="alectryon-input" for="Composition-v-chk7f"><span class="nb">cbn</span>; <span class="nb">unfold</span> lift_to_composite_state&#39;; <span class="nb">cbn</span>.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>message, index</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>EqDecision0</var><span class="hyp-type"><b>: </b><span>EqDecision index</span></span></span><br><span><var>IM</var><span class="hyp-type"><b>: </b><span>index ‚Üí VLSM message</span></span></span><br><span><var>j</var><span class="hyp-type"><b>: </b><span>index</span></span></span><br><span><var>l</var><span class="hyp-type"><b>: </b><span>label (IM j)</span></span></span><br><span><var>s</var><span class="hyp-type"><b>: </b><span>state (IM j)</span></span></span><br><span><var>om</var><span class="hyp-type"><b>: </b><span>option message</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>valid l (s, om)</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">valid l
  (lift_to_composite_state
     (<span class="kr">Œª</span> <span class="nv">n</span> : index, `(vs0 (IM n))) j s j, om)</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><span class="alectryon-input"><span class="bp">by</span> <span class="nb">rewrite</span> state_update_eq.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="Composition-v-chk80" style="display: none" type="checkbox"><label class="alectryon-input" for="Composition-v-chk80">-</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>message, index</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>EqDecision0</var><span class="hyp-type"><b>: </b><span>EqDecision index</span></span></span><br><span><var>IM</var><span class="hyp-type"><b>: </b><span>index ‚Üí VLSM message</span></span></span><br><span><var>j</var><span class="hyp-type"><b>: </b><span>index</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">strong_embedding_transition_preservation (IM j)
  free_composite_vlsm (lift_to_composite_label j)
  (lift_to_composite_state&#39; j)</div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="Composition-v-chk81" style="display: none" type="checkbox"><label class="alectryon-input" for="Composition-v-chk81"><span class="nb">intro</span>; <span class="nb">intros</span>; <span class="nb">cbn</span>.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>message, index</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>EqDecision0</var><span class="hyp-type"><b>: </b><span>EqDecision index</span></span></span><br><span><var>IM</var><span class="hyp-type"><b>: </b><span>index ‚Üí VLSM message</span></span></span><br><span><var>j</var><span class="hyp-type"><b>: </b><span>index</span></span></span><br><span><var>l</var><span class="hyp-type"><b>: </b><span>label (IM j)</span></span></span><br><span><var>s</var><span class="hyp-type"><b>: </b><span>state (IM j)</span></span></span><br><span><var>om</var><span class="hyp-type"><b>: </b><span>option message</span></span></span><br><span><var>s'</var><span class="hyp-type"><b>: </b><span>state (IM j)</span></span></span><br><span><var>om'</var><span class="hyp-type"><b>: </b><span>option message</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>transition l (s, om) = (s&#39;, om&#39;)</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">(<span class="kr">let</span> (<span class="nv">si&#39;</span>, om&#39;) :=
   transition l (lift_to_composite_state&#39; j s j, om) <span class="kr">in</span>
 (state_update (lift_to_composite_state&#39; j s) j si&#39;,
  om&#39;)) = (lift_to_composite_state&#39; j s&#39;, om&#39;)</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="Composition-v-chk82" style="display: none" type="checkbox"><label class="alectryon-input" for="Composition-v-chk82"><span class="nb">cbn</span>; <span class="nb">unfold</span> lift_to_composite_state&#39; <span class="nb">at</span> <span class="mi">1</span>.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>message, index</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>EqDecision0</var><span class="hyp-type"><b>: </b><span>EqDecision index</span></span></span><br><span><var>IM</var><span class="hyp-type"><b>: </b><span>index ‚Üí VLSM message</span></span></span><br><span><var>j</var><span class="hyp-type"><b>: </b><span>index</span></span></span><br><span><var>l</var><span class="hyp-type"><b>: </b><span>label (IM j)</span></span></span><br><span><var>s</var><span class="hyp-type"><b>: </b><span>state (IM j)</span></span></span><br><span><var>om</var><span class="hyp-type"><b>: </b><span>option message</span></span></span><br><span><var>s'</var><span class="hyp-type"><b>: </b><span>state (IM j)</span></span></span><br><span><var>om'</var><span class="hyp-type"><b>: </b><span>option message</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>transition l (s, om) = (s&#39;, om&#39;)</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">(<span class="kr">let</span> (<span class="nv">si&#39;</span>, om&#39;) :=
   transition l
     (lift_to_composite_state (`composite_s0) j s j,
      om) <span class="kr">in</span>
 (state_update (lift_to_composite_state&#39; j s) j si&#39;,
  om&#39;)) = (lift_to_composite_state&#39; j s&#39;, om&#39;)</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="Composition-v-chk83" style="display: none" type="checkbox"><label class="alectryon-input" for="Composition-v-chk83"><span class="nb">rewrite</span> state_update_eq.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>message, index</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>EqDecision0</var><span class="hyp-type"><b>: </b><span>EqDecision index</span></span></span><br><span><var>IM</var><span class="hyp-type"><b>: </b><span>index ‚Üí VLSM message</span></span></span><br><span><var>j</var><span class="hyp-type"><b>: </b><span>index</span></span></span><br><span><var>l</var><span class="hyp-type"><b>: </b><span>label (IM j)</span></span></span><br><span><var>s</var><span class="hyp-type"><b>: </b><span>state (IM j)</span></span></span><br><span><var>om</var><span class="hyp-type"><b>: </b><span>option message</span></span></span><br><span><var>s'</var><span class="hyp-type"><b>: </b><span>state (IM j)</span></span></span><br><span><var>om'</var><span class="hyp-type"><b>: </b><span>option message</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>transition l (s, om) = (s&#39;, om&#39;)</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">(<span class="kr">let</span> (<span class="nv">si&#39;</span>, om&#39;) := transition l (s, om) <span class="kr">in</span>
 (state_update (lift_to_composite_state&#39; j s) j si&#39;,
  om&#39;)) = (lift_to_composite_state&#39; j s&#39;, om&#39;)</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="Composition-v-chk84" style="display: none" type="checkbox"><label class="alectryon-input" for="Composition-v-chk84"><span class="nb">replace</span> (transition l _) <span class="kr">with</span> (s&#39;, om&#39;).</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>message, index</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>EqDecision0</var><span class="hyp-type"><b>: </b><span>EqDecision index</span></span></span><br><span><var>IM</var><span class="hyp-type"><b>: </b><span>index ‚Üí VLSM message</span></span></span><br><span><var>j</var><span class="hyp-type"><b>: </b><span>index</span></span></span><br><span><var>l</var><span class="hyp-type"><b>: </b><span>label (IM j)</span></span></span><br><span><var>s</var><span class="hyp-type"><b>: </b><span>state (IM j)</span></span></span><br><span><var>om</var><span class="hyp-type"><b>: </b><span>option message</span></span></span><br><span><var>s'</var><span class="hyp-type"><b>: </b><span>state (IM j)</span></span></span><br><span><var>om'</var><span class="hyp-type"><b>: </b><span>option message</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>transition l (s, om) = (s&#39;, om&#39;)</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">(state_update (lift_to_composite_state&#39; j s) j s&#39;, om&#39;) =
(lift_to_composite_state&#39; j s&#39;, om&#39;)</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="Composition-v-chk85" style="display: none" type="checkbox"><label class="alectryon-input" for="Composition-v-chk85"><span class="nb">unfold</span> lift_to_composite_state&#39;.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>message, index</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>EqDecision0</var><span class="hyp-type"><b>: </b><span>EqDecision index</span></span></span><br><span><var>IM</var><span class="hyp-type"><b>: </b><span>index ‚Üí VLSM message</span></span></span><br><span><var>j</var><span class="hyp-type"><b>: </b><span>index</span></span></span><br><span><var>l</var><span class="hyp-type"><b>: </b><span>label (IM j)</span></span></span><br><span><var>s</var><span class="hyp-type"><b>: </b><span>state (IM j)</span></span></span><br><span><var>om</var><span class="hyp-type"><b>: </b><span>option message</span></span></span><br><span><var>s'</var><span class="hyp-type"><b>: </b><span>state (IM j)</span></span></span><br><span><var>om'</var><span class="hyp-type"><b>: </b><span>option message</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>transition l (s, om) = (s&#39;, om&#39;)</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">(state_update
   (lift_to_composite_state (`composite_s0) j s) j s&#39;,
 om&#39;) =
(lift_to_composite_state (`composite_s0) j s&#39;, om&#39;)</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><span class="alectryon-input"><span class="bp">by</span> <span class="nb">rewrite</span> state_update_twice.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="Composition-v-chk86" style="display: none" type="checkbox"><label class="alectryon-input" for="Composition-v-chk86">-</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>message, index</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>EqDecision0</var><span class="hyp-type"><b>: </b><span>EqDecision index</span></span></span><br><span><var>IM</var><span class="hyp-type"><b>: </b><span>index ‚Üí VLSM message</span></span></span><br><span><var>j</var><span class="hyp-type"><b>: </b><span>index</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">strong_projection_initial_state_preservation (IM j)
  free_composite_vlsm (lift_to_composite_state&#39; j)</div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="bp">by</span>  <span class="nb">intros</span> s H; <span class="nb">cbn</span>; <span class="nb">apply</span> composite_initial_state_prop_lift.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Qed</span>.</span></span></pre><div class="doc">
  If all messages described by a predicate <code>P</code> are valid for the free
  composition preloaded with messages described by a predicate <code>Q</code>, then
  any message which can be emitted by a component preloaded with <code>P</code> can
  also be emitted by the free composition preloaded with <code>Q</code>.

</div><pre class="alectryon-io highlight"><!-- Generator: Alectryon --><span class="alectryon-sentence"><input class="alectryon-toggle" id="Composition-v-chk87" style="display: none" type="checkbox"><label class="alectryon-input" for="Composition-v-chk87"><span class="kn">Lemma</span> <span class="nf">valid_preloaded_lifts_can_be_emitted</span>
  (<span class="nv">P</span> <span class="nv">Q</span> : message -&gt; <span class="kt">Prop</span>)
  (<span class="nv">HPvalid</span> : <span class="kr">forall</span> <span class="nv">dm</span>, P dm -&gt; valid_message_prop (preloaded_vlsm free_composite_vlsm Q) dm)
  : <span class="kr">forall</span> <span class="nv">j</span> <span class="nv">m</span>, can_emit (preloaded_vlsm (IM j) P) m -&gt;
    can_emit (preloaded_vlsm free_composite_vlsm Q) m.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>message, index</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>EqDecision0</var><span class="hyp-type"><b>: </b><span>EqDecision index</span></span></span><br><span><var>IM</var><span class="hyp-type"><b>: </b><span>index ‚Üí VLSM message</span></span></span><br><span><var>P, Q</var><span class="hyp-type"><b>: </b><span>message ‚Üí <span class="kt">Prop</span></span></span></span><br><span><var>HPvalid</var><span class="hyp-type"><b>: </b><span><span class="kr">‚àÄ</span> <span class="nv">dm</span> : message,
  P dm
  ‚Üí valid_message_prop
      (preloaded_vlsm free_composite_vlsm Q)
      dm</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="kr">‚àÄ</span> (<span class="nv">j</span> : index) (<span class="nv">m</span> : message),
  can_emit (preloaded_vlsm (IM j) P) m
  ‚Üí can_emit (preloaded_vlsm free_composite_vlsm Q) m</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="Composition-v-chk88" style="display: none" type="checkbox"><label class="alectryon-input" for="Composition-v-chk88"><span class="kn">Proof</span>.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>message, index</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>EqDecision0</var><span class="hyp-type"><b>: </b><span>EqDecision index</span></span></span><br><span><var>IM</var><span class="hyp-type"><b>: </b><span>index ‚Üí VLSM message</span></span></span><br><span><var>P, Q</var><span class="hyp-type"><b>: </b><span>message ‚Üí <span class="kt">Prop</span></span></span></span><br><span><var>HPvalid</var><span class="hyp-type"><b>: </b><span><span class="kr">‚àÄ</span> <span class="nv">dm</span> : message,
  P dm
  ‚Üí valid_message_prop
      (preloaded_vlsm free_composite_vlsm Q)
      dm</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="kr">‚àÄ</span> (<span class="nv">j</span> : index) (<span class="nv">m</span> : message),
  can_emit (preloaded_vlsm (IM j) P) m
  ‚Üí can_emit (preloaded_vlsm free_composite_vlsm Q) m</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="Composition-v-chk89" style="display: none" type="checkbox"><label class="alectryon-input" for="Composition-v-chk89"><span class="nb">intros</span> j m Hm.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>message, index</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>EqDecision0</var><span class="hyp-type"><b>: </b><span>EqDecision index</span></span></span><br><span><var>IM</var><span class="hyp-type"><b>: </b><span>index ‚Üí VLSM message</span></span></span><br><span><var>P, Q</var><span class="hyp-type"><b>: </b><span>message ‚Üí <span class="kt">Prop</span></span></span></span><br><span><var>HPvalid</var><span class="hyp-type"><b>: </b><span><span class="kr">‚àÄ</span> <span class="nv">dm</span> : message,
  P dm
  ‚Üí valid_message_prop
      (preloaded_vlsm free_composite_vlsm Q)
      dm</span></span></span><br><span><var>j</var><span class="hyp-type"><b>: </b><span>index</span></span></span><br><span><var>m</var><span class="hyp-type"><b>: </b><span>message</span></span></span><br><span><var>Hm</var><span class="hyp-type"><b>: </b><span>can_emit (preloaded_vlsm (IM j) P) m</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">can_emit (preloaded_vlsm free_composite_vlsm Q) m</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="Composition-v-chk8a" style="display: none" type="checkbox"><label class="alectryon-input" for="Composition-v-chk8a"><span class="nb">eapply</span> VLSM_incl_can_emit.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>message, index</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>EqDecision0</var><span class="hyp-type"><b>: </b><span>EqDecision index</span></span></span><br><span><var>IM</var><span class="hyp-type"><b>: </b><span>index ‚Üí VLSM message</span></span></span><br><span><var>P, Q</var><span class="hyp-type"><b>: </b><span>message ‚Üí <span class="kt">Prop</span></span></span></span><br><span><var>HPvalid</var><span class="hyp-type"><b>: </b><span><span class="kr">‚àÄ</span> <span class="nv">dm</span> : message,
  P dm
  ‚Üí valid_message_prop
      (preloaded_vlsm free_composite_vlsm Q)
      dm</span></span></span><br><span><var>j</var><span class="hyp-type"><b>: </b><span>index</span></span></span><br><span><var>m</var><span class="hyp-type"><b>: </b><span>message</span></span></span><br><span><var>Hm</var><span class="hyp-type"><b>: </b><span>can_emit (preloaded_vlsm (IM j) P) m</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">VLSM_incl_part <span class="nl">?MX</span>
  (preloaded_vlsm_machine free_composite_vlsm Q)</div></blockquote><div class="alectryon-extra-goals"><input class="alectryon-extra-goal-toggle" id="Composition-v-chk8b" style="display: none" type="checkbox"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>message, index</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>EqDecision0</var><span class="hyp-type"><b>: </b><span>EqDecision index</span></span></span><br><span><var>IM</var><span class="hyp-type"><b>: </b><span>index ‚Üí VLSM message</span></span></span><br><span><var>P, Q</var><span class="hyp-type"><b>: </b><span>message ‚Üí <span class="kt">Prop</span></span></span></span><br><span><var>HPvalid</var><span class="hyp-type"><b>: </b><span><span class="kr">‚àÄ</span> <span class="nv">dm</span> : message,
  P dm
  ‚Üí valid_message_prop
      (preloaded_vlsm free_composite_vlsm Q)
      dm</span></span></span><br><span><var>j</var><span class="hyp-type"><b>: </b><span>index</span></span></span><br><span><var>m</var><span class="hyp-type"><b>: </b><span>message</span></span></span><br><span><var>Hm</var><span class="hyp-type"><b>: </b><span>can_emit (preloaded_vlsm (IM j) P) m</span></span></span><br></div><label class="goal-separator" for="Composition-v-chk8b"><hr></label><div class="goal-conclusion">can_emit
  {|
    vlsm_type := free_composite_vlsm;
    vlsm_machine := <span class="nl">?MX</span>
  |} m</div></blockquote></div></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="Composition-v-chk8c" style="display: none" type="checkbox"><label class="alectryon-input" for="Composition-v-chk8c">-</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>message, index</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>EqDecision0</var><span class="hyp-type"><b>: </b><span>EqDecision index</span></span></span><br><span><var>IM</var><span class="hyp-type"><b>: </b><span>index ‚Üí VLSM message</span></span></span><br><span><var>P, Q</var><span class="hyp-type"><b>: </b><span>message ‚Üí <span class="kt">Prop</span></span></span></span><br><span><var>HPvalid</var><span class="hyp-type"><b>: </b><span><span class="kr">‚àÄ</span> <span class="nv">dm</span> : message,
  P dm
  ‚Üí valid_message_prop
      (preloaded_vlsm free_composite_vlsm Q)
      dm</span></span></span><br><span><var>j</var><span class="hyp-type"><b>: </b><span>index</span></span></span><br><span><var>m</var><span class="hyp-type"><b>: </b><span>message</span></span></span><br><span><var>Hm</var><span class="hyp-type"><b>: </b><span>can_emit (preloaded_vlsm (IM j) P) m</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">VLSM_incl_part <span class="nl">?MX</span>
  (preloaded_vlsm_machine free_composite_vlsm Q)</div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="Composition-v-chk8d" style="display: none" type="checkbox"><label class="alectryon-input" for="Composition-v-chk8d"><span class="nb">apply</span> (preloaded_vlsm_incl_relaxed _ (<span class="kr">fun</span> <span class="nv">m</span> =&gt; Q m \/ P m)).</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>message, index</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>EqDecision0</var><span class="hyp-type"><b>: </b><span>EqDecision index</span></span></span><br><span><var>IM</var><span class="hyp-type"><b>: </b><span>index ‚Üí VLSM message</span></span></span><br><span><var>P, Q</var><span class="hyp-type"><b>: </b><span>message ‚Üí <span class="kt">Prop</span></span></span></span><br><span><var>HPvalid</var><span class="hyp-type"><b>: </b><span><span class="kr">‚àÄ</span> <span class="nv">dm</span> : message,
  P dm
  ‚Üí valid_message_prop
      (preloaded_vlsm free_composite_vlsm Q)
      dm</span></span></span><br><span><var>j</var><span class="hyp-type"><b>: </b><span>index</span></span></span><br><span><var>m</var><span class="hyp-type"><b>: </b><span>message</span></span></span><br><span><var>Hm</var><span class="hyp-type"><b>: </b><span>can_emit (preloaded_vlsm (IM j) P) m</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="kr">‚àÄ</span> <span class="nv">m</span> : message,
  Q m ‚à® P m
  ‚Üí Q m
    ‚à® valid_message_prop
        (preloaded_vlsm free_composite_vlsm Q) m</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><span class="alectryon-input"><span class="bp">by</span> itauto.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="Composition-v-chk8e" style="display: none" type="checkbox"><label class="alectryon-input" for="Composition-v-chk8e">-</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>message, index</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>EqDecision0</var><span class="hyp-type"><b>: </b><span>EqDecision index</span></span></span><br><span><var>IM</var><span class="hyp-type"><b>: </b><span>index ‚Üí VLSM message</span></span></span><br><span><var>P, Q</var><span class="hyp-type"><b>: </b><span>message ‚Üí <span class="kt">Prop</span></span></span></span><br><span><var>HPvalid</var><span class="hyp-type"><b>: </b><span><span class="kr">‚àÄ</span> <span class="nv">dm</span> : message,
  P dm
  ‚Üí valid_message_prop
      (preloaded_vlsm free_composite_vlsm Q)
      dm</span></span></span><br><span><var>j</var><span class="hyp-type"><b>: </b><span>index</span></span></span><br><span><var>m</var><span class="hyp-type"><b>: </b><span>message</span></span></span><br><span><var>Hm</var><span class="hyp-type"><b>: </b><span>can_emit (preloaded_vlsm (IM j) P) m</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">can_emit
  {|
    vlsm_type := free_composite_vlsm;
    vlsm_machine :=
      preloaded_vlsm free_composite_vlsm
        (<span class="kr">Œª</span> <span class="nv">m</span> : message, Q m ‚à® P m)
  |} m</div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="Composition-v-chk8f" style="display: none" type="checkbox"><label class="alectryon-input" for="Composition-v-chk8f"><span class="nb">eapply</span> VLSM_embedding_can_emit; [| <span class="bp">done</span>].</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>message, index</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>EqDecision0</var><span class="hyp-type"><b>: </b><span>EqDecision index</span></span></span><br><span><var>IM</var><span class="hyp-type"><b>: </b><span>index ‚Üí VLSM message</span></span></span><br><span><var>P, Q</var><span class="hyp-type"><b>: </b><span>message ‚Üí <span class="kt">Prop</span></span></span></span><br><span><var>HPvalid</var><span class="hyp-type"><b>: </b><span><span class="kr">‚àÄ</span> <span class="nv">dm</span> : message,
  P dm
  ‚Üí valid_message_prop
      (preloaded_vlsm free_composite_vlsm Q)
      dm</span></span></span><br><span><var>j</var><span class="hyp-type"><b>: </b><span>index</span></span></span><br><span><var>m</var><span class="hyp-type"><b>: </b><span>message</span></span></span><br><span><var>Hm</var><span class="hyp-type"><b>: </b><span>can_emit (preloaded_vlsm (IM j) P) m</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">VLSM_embedding (preloaded_vlsm (IM j) P)
  {|
    vlsm_type := free_composite_vlsm;
    vlsm_machine :=
      preloaded_vlsm free_composite_vlsm
        (<span class="kr">Œª</span> <span class="nv">m</span> : message, Q m ‚à® P m)
  |} <span class="nl">?label_project</span> <span class="nl">?state_project</span></div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="Composition-v-chk90" style="display: none" type="checkbox"><label class="alectryon-input" for="Composition-v-chk90"><span class="nb">apply</span> lift_to_composite_generalized_preloaded_VLSM_embedding.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>message, index</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>EqDecision0</var><span class="hyp-type"><b>: </b><span>EqDecision index</span></span></span><br><span><var>IM</var><span class="hyp-type"><b>: </b><span>index ‚Üí VLSM message</span></span></span><br><span><var>P, Q</var><span class="hyp-type"><b>: </b><span>message ‚Üí <span class="kt">Prop</span></span></span></span><br><span><var>HPvalid</var><span class="hyp-type"><b>: </b><span><span class="kr">‚àÄ</span> <span class="nv">dm</span> : message,
  P dm
  ‚Üí valid_message_prop
      (preloaded_vlsm free_composite_vlsm Q)
      dm</span></span></span><br><span><var>j</var><span class="hyp-type"><b>: </b><span>index</span></span></span><br><span><var>m</var><span class="hyp-type"><b>: </b><span>message</span></span></span><br><span><var>Hm</var><span class="hyp-type"><b>: </b><span>can_emit (preloaded_vlsm (IM j) P) m</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="kr">‚àÄ</span> <span class="nv">m</span> : message, P m ‚Üí Q m ‚à® P m</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><span class="alectryon-input"><span class="bp">by</span> itauto.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Qed</span>.</span></span></pre><div class="doc">
  As a specialization of <span class="inlinecode"><span class="id" title="var">valid_preloaded_lifts_can_be_emitted</span></span>, if all
  messages described by a predicate <code>P</code> are valid for the free composition,
  then any message which can be emitted by a component preloaded with <code>P</code>
  can also be emitted by the free composition.

</div><pre class="alectryon-io highlight"><!-- Generator: Alectryon --><span class="alectryon-sentence"><input class="alectryon-toggle" id="Composition-v-chk91" style="display: none" type="checkbox"><label class="alectryon-input" for="Composition-v-chk91"><span class="kn">Lemma</span> <span class="nf">free_valid_preloaded_lifts_can_be_emitted</span>
  (<span class="nv">P</span> : message -&gt; <span class="kt">Prop</span>)
  (<span class="nv">Hdeps</span> : <span class="kr">forall</span> <span class="nv">dm</span>, P dm -&gt; valid_message_prop free_composite_vlsm dm)
  : <span class="kr">forall</span> <span class="nv">i</span> <span class="nv">m</span>, can_emit (preloaded_vlsm (IM i) P) m -&gt;
    can_emit free_composite_vlsm m.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>message, index</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>EqDecision0</var><span class="hyp-type"><b>: </b><span>EqDecision index</span></span></span><br><span><var>IM</var><span class="hyp-type"><b>: </b><span>index ‚Üí VLSM message</span></span></span><br><span><var>P</var><span class="hyp-type"><b>: </b><span>message ‚Üí <span class="kt">Prop</span></span></span></span><br><span><var>Hdeps</var><span class="hyp-type"><b>: </b><span><span class="kr">‚àÄ</span> <span class="nv">dm</span> : message,
  P dm
  ‚Üí valid_message_prop free_composite_vlsm dm</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="kr">‚àÄ</span> (<span class="nv">i</span> : index) (<span class="nv">m</span> : message),
  can_emit (preloaded_vlsm (IM i) P) m
  ‚Üí can_emit free_composite_vlsm m</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="Composition-v-chk92" style="display: none" type="checkbox"><label class="alectryon-input" for="Composition-v-chk92"><span class="kn">Proof</span>.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>message, index</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>EqDecision0</var><span class="hyp-type"><b>: </b><span>EqDecision index</span></span></span><br><span><var>IM</var><span class="hyp-type"><b>: </b><span>index ‚Üí VLSM message</span></span></span><br><span><var>P</var><span class="hyp-type"><b>: </b><span>message ‚Üí <span class="kt">Prop</span></span></span></span><br><span><var>Hdeps</var><span class="hyp-type"><b>: </b><span><span class="kr">‚àÄ</span> <span class="nv">dm</span> : message,
  P dm
  ‚Üí valid_message_prop free_composite_vlsm dm</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="kr">‚àÄ</span> (<span class="nv">i</span> : index) (<span class="nv">m</span> : message),
  can_emit (preloaded_vlsm (IM i) P) m
  ‚Üí can_emit free_composite_vlsm m</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="Composition-v-chk93" style="display: none" type="checkbox"><label class="alectryon-input" for="Composition-v-chk93"><span class="nb">intros</span>.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>message, index</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>EqDecision0</var><span class="hyp-type"><b>: </b><span>EqDecision index</span></span></span><br><span><var>IM</var><span class="hyp-type"><b>: </b><span>index ‚Üí VLSM message</span></span></span><br><span><var>P</var><span class="hyp-type"><b>: </b><span>message ‚Üí <span class="kt">Prop</span></span></span></span><br><span><var>Hdeps</var><span class="hyp-type"><b>: </b><span><span class="kr">‚àÄ</span> <span class="nv">dm</span> : message,
  P dm
  ‚Üí valid_message_prop free_composite_vlsm dm</span></span></span><br><span><var>i</var><span class="hyp-type"><b>: </b><span>index</span></span></span><br><span><var>m</var><span class="hyp-type"><b>: </b><span>message</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>can_emit (preloaded_vlsm (IM i) P) m</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">can_emit free_composite_vlsm m</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="Composition-v-chk94" style="display: none" type="checkbox"><label class="alectryon-input" for="Composition-v-chk94"><span class="nb">eapply</span> VLSM_incl_can_emit.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>message, index</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>EqDecision0</var><span class="hyp-type"><b>: </b><span>EqDecision index</span></span></span><br><span><var>IM</var><span class="hyp-type"><b>: </b><span>index ‚Üí VLSM message</span></span></span><br><span><var>P</var><span class="hyp-type"><b>: </b><span>message ‚Üí <span class="kt">Prop</span></span></span></span><br><span><var>Hdeps</var><span class="hyp-type"><b>: </b><span><span class="kr">‚àÄ</span> <span class="nv">dm</span> : message,
  P dm
  ‚Üí valid_message_prop free_composite_vlsm dm</span></span></span><br><span><var>i</var><span class="hyp-type"><b>: </b><span>index</span></span></span><br><span><var>m</var><span class="hyp-type"><b>: </b><span>message</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>can_emit (preloaded_vlsm (IM i) P) m</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">VLSM_incl_part <span class="nl">?MX</span> free_composite_vlsm_machine</div></blockquote><div class="alectryon-extra-goals"><input class="alectryon-extra-goal-toggle" id="Composition-v-chk95" style="display: none" type="checkbox"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>message, index</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>EqDecision0</var><span class="hyp-type"><b>: </b><span>EqDecision index</span></span></span><br><span><var>IM</var><span class="hyp-type"><b>: </b><span>index ‚Üí VLSM message</span></span></span><br><span><var>P</var><span class="hyp-type"><b>: </b><span>message ‚Üí <span class="kt">Prop</span></span></span></span><br><span><var>Hdeps</var><span class="hyp-type"><b>: </b><span><span class="kr">‚àÄ</span> <span class="nv">dm</span> : message,
  P dm
  ‚Üí valid_message_prop free_composite_vlsm dm</span></span></span><br><span><var>i</var><span class="hyp-type"><b>: </b><span>index</span></span></span><br><span><var>m</var><span class="hyp-type"><b>: </b><span>message</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>can_emit (preloaded_vlsm (IM i) P) m</span></span></span><br></div><label class="goal-separator" for="Composition-v-chk95"><hr></label><div class="goal-conclusion">can_emit
  {|
    vlsm_type := composite_type; vlsm_machine := <span class="nl">?MX</span>
  |} m</div></blockquote></div></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="Composition-v-chk96" style="display: none" type="checkbox"><label class="alectryon-input" for="Composition-v-chk96">-</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>message, index</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>EqDecision0</var><span class="hyp-type"><b>: </b><span>EqDecision index</span></span></span><br><span><var>IM</var><span class="hyp-type"><b>: </b><span>index ‚Üí VLSM message</span></span></span><br><span><var>P</var><span class="hyp-type"><b>: </b><span>message ‚Üí <span class="kt">Prop</span></span></span></span><br><span><var>Hdeps</var><span class="hyp-type"><b>: </b><span><span class="kr">‚àÄ</span> <span class="nv">dm</span> : message,
  P dm
  ‚Üí valid_message_prop free_composite_vlsm dm</span></span></span><br><span><var>i</var><span class="hyp-type"><b>: </b><span>index</span></span></span><br><span><var>m</var><span class="hyp-type"><b>: </b><span>message</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>can_emit (preloaded_vlsm (IM i) P) m</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">VLSM_incl_part <span class="nl">?MX</span> free_composite_vlsm_machine</div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="bp">by</span> <span class="nb">eapply</span> (vlsm_is_preloaded_with_False free_composite_vlsm).</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="Composition-v-chk97" style="display: none" type="checkbox"><label class="alectryon-input" for="Composition-v-chk97">-</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>message, index</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>EqDecision0</var><span class="hyp-type"><b>: </b><span>EqDecision index</span></span></span><br><span><var>IM</var><span class="hyp-type"><b>: </b><span>index ‚Üí VLSM message</span></span></span><br><span><var>P</var><span class="hyp-type"><b>: </b><span>message ‚Üí <span class="kt">Prop</span></span></span></span><br><span><var>Hdeps</var><span class="hyp-type"><b>: </b><span><span class="kr">‚àÄ</span> <span class="nv">dm</span> : message,
  P dm
  ‚Üí valid_message_prop free_composite_vlsm dm</span></span></span><br><span><var>i</var><span class="hyp-type"><b>: </b><span>index</span></span></span><br><span><var>m</var><span class="hyp-type"><b>: </b><span>message</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>can_emit (preloaded_vlsm (IM i) P) m</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">can_emit
  {|
    vlsm_type := composite_type;
    vlsm_machine :=
      {|
        vlsm_type := free_composite_vlsm;
        vlsm_machine :=
          preloaded_vlsm free_composite_vlsm
            (<span class="kr">Œª</span> <span class="nv">_</span> : message, <span class="kt">False</span>)
      |}
  |} m</div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="Composition-v-chk98" style="display: none" type="checkbox"><label class="alectryon-input" for="Composition-v-chk98"><span class="nb">eapply</span> valid_preloaded_lifts_can_be_emitted; [| <span class="bp">done</span>].</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>message, index</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>EqDecision0</var><span class="hyp-type"><b>: </b><span>EqDecision index</span></span></span><br><span><var>IM</var><span class="hyp-type"><b>: </b><span>index ‚Üí VLSM message</span></span></span><br><span><var>P</var><span class="hyp-type"><b>: </b><span>message ‚Üí <span class="kt">Prop</span></span></span></span><br><span><var>Hdeps</var><span class="hyp-type"><b>: </b><span><span class="kr">‚àÄ</span> <span class="nv">dm</span> : message,
  P dm
  ‚Üí valid_message_prop free_composite_vlsm dm</span></span></span><br><span><var>i</var><span class="hyp-type"><b>: </b><span>index</span></span></span><br><span><var>m</var><span class="hyp-type"><b>: </b><span>message</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>can_emit (preloaded_vlsm (IM i) P) m</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="kr">‚àÄ</span> <span class="nv">dm</span> : message,
  P dm
  ‚Üí valid_message_prop
      (preloaded_vlsm free_composite_vlsm
         (<span class="kr">Œª</span> <span class="nv">_</span> : message, <span class="kt">False</span>)) dm</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="Composition-v-chk99" style="display: none" type="checkbox"><label class="alectryon-input" for="Composition-v-chk99"><span class="nb">intros</span> dm Hdm.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>message, index</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>EqDecision0</var><span class="hyp-type"><b>: </b><span>EqDecision index</span></span></span><br><span><var>IM</var><span class="hyp-type"><b>: </b><span>index ‚Üí VLSM message</span></span></span><br><span><var>P</var><span class="hyp-type"><b>: </b><span>message ‚Üí <span class="kt">Prop</span></span></span></span><br><span><var>Hdeps</var><span class="hyp-type"><b>: </b><span><span class="kr">‚àÄ</span> <span class="nv">dm</span> : message,
  P dm
  ‚Üí valid_message_prop free_composite_vlsm dm</span></span></span><br><span><var>i</var><span class="hyp-type"><b>: </b><span>index</span></span></span><br><span><var>m</var><span class="hyp-type"><b>: </b><span>message</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>can_emit (preloaded_vlsm (IM i) P) m</span></span></span><br><span><var>dm</var><span class="hyp-type"><b>: </b><span>message</span></span></span><br><span><var>Hdm</var><span class="hyp-type"><b>: </b><span>P dm</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">valid_message_prop
  (preloaded_vlsm free_composite_vlsm
     (<span class="kr">Œª</span> <span class="nv">_</span> : message, <span class="kt">False</span>)) dm</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="Composition-v-chk9a" style="display: none" type="checkbox"><label class="alectryon-input" for="Composition-v-chk9a"><span class="nb">eapply</span> VLSM_incl_valid_message.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>message, index</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>EqDecision0</var><span class="hyp-type"><b>: </b><span>EqDecision index</span></span></span><br><span><var>IM</var><span class="hyp-type"><b>: </b><span>index ‚Üí VLSM message</span></span></span><br><span><var>P</var><span class="hyp-type"><b>: </b><span>message ‚Üí <span class="kt">Prop</span></span></span></span><br><span><var>Hdeps</var><span class="hyp-type"><b>: </b><span><span class="kr">‚àÄ</span> <span class="nv">dm</span> : message,
  P dm
  ‚Üí valid_message_prop free_composite_vlsm dm</span></span></span><br><span><var>i</var><span class="hyp-type"><b>: </b><span>index</span></span></span><br><span><var>m</var><span class="hyp-type"><b>: </b><span>message</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>can_emit (preloaded_vlsm (IM i) P) m</span></span></span><br><span><var>dm</var><span class="hyp-type"><b>: </b><span>message</span></span></span><br><span><var>Hdm</var><span class="hyp-type"><b>: </b><span>P dm</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">VLSM_incl_part <span class="nl">?MX</span>
  (preloaded_vlsm_machine free_composite_vlsm
     (<span class="kr">Œª</span> <span class="nv">_</span> : message, <span class="kt">False</span>))</div></blockquote><div class="alectryon-extra-goals"><input class="alectryon-extra-goal-toggle" id="Composition-v-chk9b" style="display: none" type="checkbox"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>message, index</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>EqDecision0</var><span class="hyp-type"><b>: </b><span>EqDecision index</span></span></span><br><span><var>IM</var><span class="hyp-type"><b>: </b><span>index ‚Üí VLSM message</span></span></span><br><span><var>P</var><span class="hyp-type"><b>: </b><span>message ‚Üí <span class="kt">Prop</span></span></span></span><br><span><var>Hdeps</var><span class="hyp-type"><b>: </b><span><span class="kr">‚àÄ</span> <span class="nv">dm</span> : message,
  P dm
  ‚Üí valid_message_prop free_composite_vlsm dm</span></span></span><br><span><var>i</var><span class="hyp-type"><b>: </b><span>index</span></span></span><br><span><var>m</var><span class="hyp-type"><b>: </b><span>message</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>can_emit (preloaded_vlsm (IM i) P) m</span></span></span><br><span><var>dm</var><span class="hyp-type"><b>: </b><span>message</span></span></span><br><span><var>Hdm</var><span class="hyp-type"><b>: </b><span>P dm</span></span></span><br></div><label class="goal-separator" for="Composition-v-chk9b"><hr></label><div class="goal-conclusion">strong_incl_initial_message_preservation 
  <span class="nl">?MX</span>
  (preloaded_vlsm_machine free_composite_vlsm
     (<span class="kr">Œª</span> <span class="nv">_</span> : message, <span class="kt">False</span>))</div></blockquote><input class="alectryon-extra-goal-toggle" id="Composition-v-chk9c" style="display: none" type="checkbox"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>message, index</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>EqDecision0</var><span class="hyp-type"><b>: </b><span>EqDecision index</span></span></span><br><span><var>IM</var><span class="hyp-type"><b>: </b><span>index ‚Üí VLSM message</span></span></span><br><span><var>P</var><span class="hyp-type"><b>: </b><span>message ‚Üí <span class="kt">Prop</span></span></span></span><br><span><var>Hdeps</var><span class="hyp-type"><b>: </b><span><span class="kr">‚àÄ</span> <span class="nv">dm</span> : message,
  P dm
  ‚Üí valid_message_prop free_composite_vlsm dm</span></span></span><br><span><var>i</var><span class="hyp-type"><b>: </b><span>index</span></span></span><br><span><var>m</var><span class="hyp-type"><b>: </b><span>message</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>can_emit (preloaded_vlsm (IM i) P) m</span></span></span><br><span><var>dm</var><span class="hyp-type"><b>: </b><span>message</span></span></span><br><span><var>Hdm</var><span class="hyp-type"><b>: </b><span>P dm</span></span></span><br></div><label class="goal-separator" for="Composition-v-chk9c"><hr></label><div class="goal-conclusion">valid_message_prop
  {|
    vlsm_type := free_composite_vlsm;
    vlsm_machine := <span class="nl">?MX</span>
  |} dm</div></blockquote></div></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="Composition-v-chk9d" style="display: none" type="checkbox"><label class="alectryon-input" for="Composition-v-chk9d">+</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>message, index</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>EqDecision0</var><span class="hyp-type"><b>: </b><span>EqDecision index</span></span></span><br><span><var>IM</var><span class="hyp-type"><b>: </b><span>index ‚Üí VLSM message</span></span></span><br><span><var>P</var><span class="hyp-type"><b>: </b><span>message ‚Üí <span class="kt">Prop</span></span></span></span><br><span><var>Hdeps</var><span class="hyp-type"><b>: </b><span><span class="kr">‚àÄ</span> <span class="nv">dm</span> : message,
  P dm
  ‚Üí valid_message_prop free_composite_vlsm dm</span></span></span><br><span><var>i</var><span class="hyp-type"><b>: </b><span>index</span></span></span><br><span><var>m</var><span class="hyp-type"><b>: </b><span>message</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>can_emit (preloaded_vlsm (IM i) P) m</span></span></span><br><span><var>dm</var><span class="hyp-type"><b>: </b><span>message</span></span></span><br><span><var>Hdm</var><span class="hyp-type"><b>: </b><span>P dm</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">VLSM_incl_part <span class="nl">?MX</span>
  (preloaded_vlsm_machine free_composite_vlsm
     (<span class="kr">Œª</span> <span class="nv">_</span> : message, <span class="kt">False</span>))</div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="bp">by</span> <span class="nb">apply</span> (vlsm_is_preloaded_with_False free_composite_vlsm).</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="Composition-v-chk9e" style="display: none" type="checkbox"><label class="alectryon-input" for="Composition-v-chk9e">+</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>message, index</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>EqDecision0</var><span class="hyp-type"><b>: </b><span>EqDecision index</span></span></span><br><span><var>IM</var><span class="hyp-type"><b>: </b><span>index ‚Üí VLSM message</span></span></span><br><span><var>P</var><span class="hyp-type"><b>: </b><span>message ‚Üí <span class="kt">Prop</span></span></span></span><br><span><var>Hdeps</var><span class="hyp-type"><b>: </b><span><span class="kr">‚àÄ</span> <span class="nv">dm</span> : message,
  P dm
  ‚Üí valid_message_prop free_composite_vlsm dm</span></span></span><br><span><var>i</var><span class="hyp-type"><b>: </b><span>index</span></span></span><br><span><var>m</var><span class="hyp-type"><b>: </b><span>message</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>can_emit (preloaded_vlsm (IM i) P) m</span></span></span><br><span><var>dm</var><span class="hyp-type"><b>: </b><span>message</span></span></span><br><span><var>Hdm</var><span class="hyp-type"><b>: </b><span>P dm</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">strong_incl_initial_message_preservation
  {|
    vlsm_type := free_composite_vlsm;
    vlsm_machine := free_composite_vlsm
  |}
  (preloaded_vlsm_machine free_composite_vlsm
     (<span class="kr">Œª</span> <span class="nv">_</span> : message, <span class="kt">False</span>))</div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="bp">by</span> <span class="nb">cbv</span>; itauto.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="Composition-v-chk9f" style="display: none" type="checkbox"><label class="alectryon-input" for="Composition-v-chk9f">+</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>message, index</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>EqDecision0</var><span class="hyp-type"><b>: </b><span>EqDecision index</span></span></span><br><span><var>IM</var><span class="hyp-type"><b>: </b><span>index ‚Üí VLSM message</span></span></span><br><span><var>P</var><span class="hyp-type"><b>: </b><span>message ‚Üí <span class="kt">Prop</span></span></span></span><br><span><var>Hdeps</var><span class="hyp-type"><b>: </b><span><span class="kr">‚àÄ</span> <span class="nv">dm</span> : message,
  P dm
  ‚Üí valid_message_prop free_composite_vlsm dm</span></span></span><br><span><var>i</var><span class="hyp-type"><b>: </b><span>index</span></span></span><br><span><var>m</var><span class="hyp-type"><b>: </b><span>message</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>can_emit (preloaded_vlsm (IM i) P) m</span></span></span><br><span><var>dm</var><span class="hyp-type"><b>: </b><span>message</span></span></span><br><span><var>Hdm</var><span class="hyp-type"><b>: </b><span>P dm</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">valid_message_prop
  {|
    vlsm_type := free_composite_vlsm;
    vlsm_machine :=
      {|
        vlsm_type := free_composite_vlsm;
        vlsm_machine := free_composite_vlsm
      |}
  |} dm</div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="bp">by</span> <span class="nb">apply</span> Hdeps.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Qed</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
</span><span class="alectryon-sentence"><input class="alectryon-toggle" id="Composition-v-chka0" style="display: none" type="checkbox"><label class="alectryon-input" for="Composition-v-chka0"><span class="kn">Lemma</span> <span class="nf">valid_state_preloaded_composite_free_lift</span>
  (<span class="nv">j</span> : index)
  (<span class="nv">sj</span> : state (IM j))
  (<span class="nv">Hp</span> : constrained_state_prop (IM j) sj)
  : constrained_state_prop free_composite_vlsm (lift_to_composite_state&#39; j sj).</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>message, index</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>EqDecision0</var><span class="hyp-type"><b>: </b><span>EqDecision index</span></span></span><br><span><var>IM</var><span class="hyp-type"><b>: </b><span>index ‚Üí VLSM message</span></span></span><br><span><var>j</var><span class="hyp-type"><b>: </b><span>index</span></span></span><br><span><var>sj</var><span class="hyp-type"><b>: </b><span>state (IM j)</span></span></span><br><span><var>Hp</var><span class="hyp-type"><b>: </b><span>constrained_state_prop (IM j) sj</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">constrained_state_prop free_composite_vlsm
  (lift_to_composite_state&#39; j sj)</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="Composition-v-chka1" style="display: none" type="checkbox"><label class="alectryon-input" for="Composition-v-chka1"><span class="kn">Proof</span>.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>message, index</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>EqDecision0</var><span class="hyp-type"><b>: </b><span>EqDecision index</span></span></span><br><span><var>IM</var><span class="hyp-type"><b>: </b><span>index ‚Üí VLSM message</span></span></span><br><span><var>j</var><span class="hyp-type"><b>: </b><span>index</span></span></span><br><span><var>sj</var><span class="hyp-type"><b>: </b><span>state (IM j)</span></span></span><br><span><var>Hp</var><span class="hyp-type"><b>: </b><span>constrained_state_prop (IM j) sj</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">constrained_state_prop free_composite_vlsm
  (lift_to_composite_state&#39; j sj)</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><span class="alectryon-input"><span class="bp">by</span> <span class="nb">apply</span> (VLSM_embedding_valid_state (lift_to_composite_preloaded_VLSM_embedding j)).</span><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Qed</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
</span><span class="alectryon-sentence"><input class="alectryon-toggle" id="Composition-v-chka2" style="display: none" type="checkbox"><label class="alectryon-input" for="Composition-v-chka2"><span class="kn">Lemma</span> <span class="nf">can_emit_composite_free_lift</span>
  (<span class="nv">P</span> <span class="nv">Q</span> : message -&gt; <span class="kt">Prop</span>)
  (<span class="nv">PimpliesQ</span> : <span class="kr">forall</span> <span class="nv">m</span>, P m -&gt; Q m)
  (<span class="nv">j</span> : index)
  (<span class="nv">m</span> : message)
  (<span class="nv">Htrj</span> : can_emit (preloaded_vlsm (IM j) P) m)
  : can_emit (preloaded_vlsm free_composite_vlsm Q) m.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>message, index</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>EqDecision0</var><span class="hyp-type"><b>: </b><span>EqDecision index</span></span></span><br><span><var>IM</var><span class="hyp-type"><b>: </b><span>index ‚Üí VLSM message</span></span></span><br><span><var>P, Q</var><span class="hyp-type"><b>: </b><span>message ‚Üí <span class="kt">Prop</span></span></span></span><br><span><var>PimpliesQ</var><span class="hyp-type"><b>: </b><span><span class="kr">‚àÄ</span> <span class="nv">m</span> : message, P m ‚Üí Q m</span></span></span><br><span><var>j</var><span class="hyp-type"><b>: </b><span>index</span></span></span><br><span><var>m</var><span class="hyp-type"><b>: </b><span>message</span></span></span><br><span><var>Htrj</var><span class="hyp-type"><b>: </b><span>can_emit (preloaded_vlsm (IM j) P) m</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">can_emit (preloaded_vlsm free_composite_vlsm Q) m</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="Composition-v-chka3" style="display: none" type="checkbox"><label class="alectryon-input" for="Composition-v-chka3"><span class="kn">Proof</span>.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>message, index</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>EqDecision0</var><span class="hyp-type"><b>: </b><span>EqDecision index</span></span></span><br><span><var>IM</var><span class="hyp-type"><b>: </b><span>index ‚Üí VLSM message</span></span></span><br><span><var>P, Q</var><span class="hyp-type"><b>: </b><span>message ‚Üí <span class="kt">Prop</span></span></span></span><br><span><var>PimpliesQ</var><span class="hyp-type"><b>: </b><span><span class="kr">‚àÄ</span> <span class="nv">m</span> : message, P m ‚Üí Q m</span></span></span><br><span><var>j</var><span class="hyp-type"><b>: </b><span>index</span></span></span><br><span><var>m</var><span class="hyp-type"><b>: </b><span>message</span></span></span><br><span><var>Htrj</var><span class="hyp-type"><b>: </b><span>can_emit (preloaded_vlsm (IM j) P) m</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">can_emit (preloaded_vlsm free_composite_vlsm Q) m</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="Composition-v-chka4" style="display: none" type="checkbox"><label class="alectryon-input" for="Composition-v-chka4"><span class="nb">eapply</span> VLSM_embedding_can_emit; [| <span class="bp">done</span>].</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>message, index</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>EqDecision0</var><span class="hyp-type"><b>: </b><span>EqDecision index</span></span></span><br><span><var>IM</var><span class="hyp-type"><b>: </b><span>index ‚Üí VLSM message</span></span></span><br><span><var>P, Q</var><span class="hyp-type"><b>: </b><span>message ‚Üí <span class="kt">Prop</span></span></span></span><br><span><var>PimpliesQ</var><span class="hyp-type"><b>: </b><span><span class="kr">‚àÄ</span> <span class="nv">m</span> : message, P m ‚Üí Q m</span></span></span><br><span><var>j</var><span class="hyp-type"><b>: </b><span>index</span></span></span><br><span><var>m</var><span class="hyp-type"><b>: </b><span>message</span></span></span><br><span><var>Htrj</var><span class="hyp-type"><b>: </b><span>can_emit (preloaded_vlsm (IM j) P) m</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">VLSM_embedding (preloaded_vlsm (IM j) P)
  (preloaded_vlsm free_composite_vlsm Q)
  <span class="nl">?label_project</span> <span class="nl">?state_project</span></div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><span class="alectryon-input"><span class="bp">by</span> <span class="nb">apply</span> lift_to_composite_generalized_preloaded_VLSM_embedding.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Qed</span>.</span></span></pre><div class="doc">
  Updating a composite <span class="inlinecode"><span class="id" title="var">valid_state</span></span> for the free composition with
  a component initial state yields a composite <span class="inlinecode"><span class="id" title="var">valid_state</span></span>.

</div><pre class="alectryon-io highlight"><!-- Generator: Alectryon --><span class="alectryon-sentence"><input class="alectryon-toggle" id="Composition-v-chka5" style="display: none" type="checkbox"><label class="alectryon-input" for="Composition-v-chka5"><span class="kn">Lemma</span> <span class="nf">pre_composite_free_update_state_with_initial</span>
  (<span class="nv">P</span> : message -&gt; <span class="kt">Prop</span>)
  (<span class="nv">s</span> : composite_state)
  (<span class="nv">Hs</span> : valid_state_prop (preloaded_vlsm free_composite_vlsm P) s)
  (<span class="nv">i</span> : index)
  (<span class="nv">si</span> : state (IM i))
  (<span class="nv">Hsi</span> : initial_state_prop (IM i) si)
  : valid_state_prop (preloaded_vlsm free_composite_vlsm P) (state_update s i si).</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>message, index</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>EqDecision0</var><span class="hyp-type"><b>: </b><span>EqDecision index</span></span></span><br><span><var>IM</var><span class="hyp-type"><b>: </b><span>index ‚Üí VLSM message</span></span></span><br><span><var>P</var><span class="hyp-type"><b>: </b><span>message ‚Üí <span class="kt">Prop</span></span></span></span><br><span><var>s</var><span class="hyp-type"><b>: </b><span>composite_state</span></span></span><br><span><var>Hs</var><span class="hyp-type"><b>: </b><span>valid_state_prop
  (preloaded_vlsm free_composite_vlsm P) s</span></span></span><br><span><var>i</var><span class="hyp-type"><b>: </b><span>index</span></span></span><br><span><var>si</var><span class="hyp-type"><b>: </b><span>state (IM i)</span></span></span><br><span><var>Hsi</var><span class="hyp-type"><b>: </b><span>initial_state_prop si</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">valid_state_prop
  (preloaded_vlsm free_composite_vlsm P)
  (state_update s i si)</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="Composition-v-chka6" style="display: none" type="checkbox"><label class="alectryon-input" for="Composition-v-chka6"><span class="kn">Proof</span>.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>message, index</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>EqDecision0</var><span class="hyp-type"><b>: </b><span>EqDecision index</span></span></span><br><span><var>IM</var><span class="hyp-type"><b>: </b><span>index ‚Üí VLSM message</span></span></span><br><span><var>P</var><span class="hyp-type"><b>: </b><span>message ‚Üí <span class="kt">Prop</span></span></span></span><br><span><var>s</var><span class="hyp-type"><b>: </b><span>composite_state</span></span></span><br><span><var>Hs</var><span class="hyp-type"><b>: </b><span>valid_state_prop
  (preloaded_vlsm free_composite_vlsm P) s</span></span></span><br><span><var>i</var><span class="hyp-type"><b>: </b><span>index</span></span></span><br><span><var>si</var><span class="hyp-type"><b>: </b><span>state (IM i)</span></span></span><br><span><var>Hsi</var><span class="hyp-type"><b>: </b><span>initial_state_prop si</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">valid_state_prop
  (preloaded_vlsm free_composite_vlsm P)
  (state_update s i si)</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="Composition-v-chka7" style="display: none" type="checkbox"><label class="alectryon-input" for="Composition-v-chka7"><span class="nb">induction</span> Hs <span class="nb">using</span> valid_state_prop_ind.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>message, index</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>EqDecision0</var><span class="hyp-type"><b>: </b><span>EqDecision index</span></span></span><br><span><var>IM</var><span class="hyp-type"><b>: </b><span>index ‚Üí VLSM message</span></span></span><br><span><var>P</var><span class="hyp-type"><b>: </b><span>message ‚Üí <span class="kt">Prop</span></span></span></span><br><span><var>s</var><span class="hyp-type"><b>: </b><span>state (preloaded_vlsm free_composite_vlsm P)</span></span></span><br><span><var>Hs</var><span class="hyp-type"><b>: </b><span>initial_state_prop s</span></span></span><br><span><var>i</var><span class="hyp-type"><b>: </b><span>index</span></span></span><br><span><var>si</var><span class="hyp-type"><b>: </b><span>state (IM i)</span></span></span><br><span><var>Hsi</var><span class="hyp-type"><b>: </b><span>initial_state_prop si</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">valid_state_prop
  (preloaded_vlsm free_composite_vlsm P)
  (state_update s i si)</div></blockquote><div class="alectryon-extra-goals"><input class="alectryon-extra-goal-toggle" id="Composition-v-chka8" style="display: none" type="checkbox"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>message, index</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>EqDecision0</var><span class="hyp-type"><b>: </b><span>EqDecision index</span></span></span><br><span><var>IM</var><span class="hyp-type"><b>: </b><span>index ‚Üí VLSM message</span></span></span><br><span><var>P</var><span class="hyp-type"><b>: </b><span>message ‚Üí <span class="kt">Prop</span></span></span></span><br><span><var>s'</var><span class="hyp-type"><b>: </b><span>state (preloaded_vlsm free_composite_vlsm P)</span></span></span><br><span><var>l</var><span class="hyp-type"><b>: </b><span>label (preloaded_vlsm free_composite_vlsm P)</span></span></span><br><span><var>om, om'</var><span class="hyp-type"><b>: </b><span>option message</span></span></span><br><span><var>s</var><span class="hyp-type"><b>: </b><span>state (preloaded_vlsm free_composite_vlsm P)</span></span></span><br><span><var>Ht</var><span class="hyp-type"><b>: </b><span>input_valid_transition
  (preloaded_vlsm free_composite_vlsm P) l
  (s, om) (s&#39;, om&#39;)</span></span></span><br><span><var>i</var><span class="hyp-type"><b>: </b><span>index</span></span></span><br><span><var>si</var><span class="hyp-type"><b>: </b><span>state (IM i)</span></span></span><br><span><var>Hsi</var><span class="hyp-type"><b>: </b><span>initial_state_prop si</span></span></span><br><span><var>IHHs</var><span class="hyp-type"><b>: </b><span>valid_state_prop
  (preloaded_vlsm free_composite_vlsm P)
  (state_update s i si)</span></span></span><br></div><label class="goal-separator" for="Composition-v-chka8"><hr></label><div class="goal-conclusion">valid_state_prop
  (preloaded_vlsm free_composite_vlsm P)
  (state_update s&#39; i si)</div></blockquote></div></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="Composition-v-chka9" style="display: none" type="checkbox"><label class="alectryon-input" for="Composition-v-chka9">-</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>message, index</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>EqDecision0</var><span class="hyp-type"><b>: </b><span>EqDecision index</span></span></span><br><span><var>IM</var><span class="hyp-type"><b>: </b><span>index ‚Üí VLSM message</span></span></span><br><span><var>P</var><span class="hyp-type"><b>: </b><span>message ‚Üí <span class="kt">Prop</span></span></span></span><br><span><var>s</var><span class="hyp-type"><b>: </b><span>state (preloaded_vlsm free_composite_vlsm P)</span></span></span><br><span><var>Hs</var><span class="hyp-type"><b>: </b><span>initial_state_prop s</span></span></span><br><span><var>i</var><span class="hyp-type"><b>: </b><span>index</span></span></span><br><span><var>si</var><span class="hyp-type"><b>: </b><span>state (IM i)</span></span></span><br><span><var>Hsi</var><span class="hyp-type"><b>: </b><span>initial_state_prop si</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">valid_state_prop
  (preloaded_vlsm free_composite_vlsm P)
  (state_update s i si)</div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="Composition-v-chkaa" style="display: none" type="checkbox"><label class="alectryon-input" for="Composition-v-chkaa"><span class="nb">apply</span> initial_state_is_valid; <span class="nb">cbn</span>.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>message, index</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>EqDecision0</var><span class="hyp-type"><b>: </b><span>EqDecision index</span></span></span><br><span><var>IM</var><span class="hyp-type"><b>: </b><span>index ‚Üí VLSM message</span></span></span><br><span><var>P</var><span class="hyp-type"><b>: </b><span>message ‚Üí <span class="kt">Prop</span></span></span></span><br><span><var>s</var><span class="hyp-type"><b>: </b><span>state (preloaded_vlsm free_composite_vlsm P)</span></span></span><br><span><var>Hs</var><span class="hyp-type"><b>: </b><span>initial_state_prop s</span></span></span><br><span><var>i</var><span class="hyp-type"><b>: </b><span>index</span></span></span><br><span><var>si</var><span class="hyp-type"><b>: </b><span>state (IM i)</span></span></span><br><span><var>Hsi</var><span class="hyp-type"><b>: </b><span>initial_state_prop si</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">composite_initial_state_prop (state_update s i si)</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><span class="alectryon-input"><span class="bp">by</span> <span class="nb">apply</span> composite_update_initial_state_with_initial.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="Composition-v-chkab" style="display: none" type="checkbox"><label class="alectryon-input" for="Composition-v-chkab">-</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>message, index</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>EqDecision0</var><span class="hyp-type"><b>: </b><span>EqDecision index</span></span></span><br><span><var>IM</var><span class="hyp-type"><b>: </b><span>index ‚Üí VLSM message</span></span></span><br><span><var>P</var><span class="hyp-type"><b>: </b><span>message ‚Üí <span class="kt">Prop</span></span></span></span><br><span><var>s'</var><span class="hyp-type"><b>: </b><span>state (preloaded_vlsm free_composite_vlsm P)</span></span></span><br><span><var>l</var><span class="hyp-type"><b>: </b><span>label (preloaded_vlsm free_composite_vlsm P)</span></span></span><br><span><var>om, om'</var><span class="hyp-type"><b>: </b><span>option message</span></span></span><br><span><var>s</var><span class="hyp-type"><b>: </b><span>state (preloaded_vlsm free_composite_vlsm P)</span></span></span><br><span><var>Ht</var><span class="hyp-type"><b>: </b><span>input_valid_transition
  (preloaded_vlsm free_composite_vlsm P) l
  (s, om) (s&#39;, om&#39;)</span></span></span><br><span><var>i</var><span class="hyp-type"><b>: </b><span>index</span></span></span><br><span><var>si</var><span class="hyp-type"><b>: </b><span>state (IM i)</span></span></span><br><span><var>Hsi</var><span class="hyp-type"><b>: </b><span>initial_state_prop si</span></span></span><br><span><var>IHHs</var><span class="hyp-type"><b>: </b><span>valid_state_prop
  (preloaded_vlsm free_composite_vlsm P)
  (state_update s i si)</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">valid_state_prop
  (preloaded_vlsm free_composite_vlsm P)
  (state_update s&#39; i si)</div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="Composition-v-chkac" style="display: none" type="checkbox"><label class="alectryon-input" for="Composition-v-chkac"><span class="nb">destruct</span> Ht <span class="kr">as</span> [[Hps [Hom Hv]] Ht]; <span class="nb">cbn</span> <span class="kr">in</span> Ht, Hv.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>message, index</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>EqDecision0</var><span class="hyp-type"><b>: </b><span>EqDecision index</span></span></span><br><span><var>IM</var><span class="hyp-type"><b>: </b><span>index ‚Üí VLSM message</span></span></span><br><span><var>P</var><span class="hyp-type"><b>: </b><span>message ‚Üí <span class="kt">Prop</span></span></span></span><br><span><var>s'</var><span class="hyp-type"><b>: </b><span>state (preloaded_vlsm free_composite_vlsm P)</span></span></span><br><span><var>l</var><span class="hyp-type"><b>: </b><span>label (preloaded_vlsm free_composite_vlsm P)</span></span></span><br><span><var>om, om'</var><span class="hyp-type"><b>: </b><span>option message</span></span></span><br><span><var>s</var><span class="hyp-type"><b>: </b><span>state (preloaded_vlsm free_composite_vlsm P)</span></span></span><br><span><var>Hps</var><span class="hyp-type"><b>: </b><span>valid_state_prop
  (preloaded_vlsm free_composite_vlsm P) s</span></span></span><br><span><var>Hom</var><span class="hyp-type"><b>: </b><span>option_valid_message_prop
  (preloaded_vlsm free_composite_vlsm P) om</span></span></span><br><span><var>Hv</var><span class="hyp-type"><b>: </b><span><span class="kr">let</span> (<span class="nv">i</span>, li) := l <span class="kr">in</span> valid li (s i, om)</span></span></span><br><span><var>Ht</var><span class="hyp-type"><b>: </b><span>(<span class="kr">let</span> (<span class="nv">i</span>, li) := l <span class="kr">in</span>
 <span class="kr">let</span> (<span class="nv">si&#39;</span>, om&#39;) := transition li (s i, om) <span class="kr">in</span>
 (state_update s i si&#39;, om&#39;)) = (
s&#39;, om&#39;)</span></span></span><br><span><var>i</var><span class="hyp-type"><b>: </b><span>index</span></span></span><br><span><var>si</var><span class="hyp-type"><b>: </b><span>state (IM i)</span></span></span><br><span><var>Hsi</var><span class="hyp-type"><b>: </b><span>initial_state_prop si</span></span></span><br><span><var>IHHs</var><span class="hyp-type"><b>: </b><span>valid_state_prop
  (preloaded_vlsm free_composite_vlsm P)
  (state_update s i si)</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">valid_state_prop
  (preloaded_vlsm free_composite_vlsm P)
  (state_update s&#39; i si)</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="Composition-v-chkad" style="display: none" type="checkbox"><label class="alectryon-input" for="Composition-v-chkad"><span class="nb">destruct</span> l <span class="kr">as</span> [j lj].</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>message, index</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>EqDecision0</var><span class="hyp-type"><b>: </b><span>EqDecision index</span></span></span><br><span><var>IM</var><span class="hyp-type"><b>: </b><span>index ‚Üí VLSM message</span></span></span><br><span><var>P</var><span class="hyp-type"><b>: </b><span>message ‚Üí <span class="kt">Prop</span></span></span></span><br><span><var>s'</var><span class="hyp-type"><b>: </b><span>state (preloaded_vlsm free_composite_vlsm P)</span></span></span><br><span><var>j</var><span class="hyp-type"><b>: </b><span>index</span></span></span><br><span><var>lj</var><span class="hyp-type"><b>: </b><span>label (IM j)</span></span></span><br><span><var>om, om'</var><span class="hyp-type"><b>: </b><span>option message</span></span></span><br><span><var>s</var><span class="hyp-type"><b>: </b><span>state (preloaded_vlsm free_composite_vlsm P)</span></span></span><br><span><var>Hps</var><span class="hyp-type"><b>: </b><span>valid_state_prop
  (preloaded_vlsm free_composite_vlsm P) s</span></span></span><br><span><var>Hom</var><span class="hyp-type"><b>: </b><span>option_valid_message_prop
  (preloaded_vlsm free_composite_vlsm P) om</span></span></span><br><span><var>Hv</var><span class="hyp-type"><b>: </b><span>valid lj (s j, om)</span></span></span><br><span><var>Ht</var><span class="hyp-type"><b>: </b><span>(<span class="kr">let</span> (<span class="nv">si&#39;</span>, om&#39;) := transition lj (s j, om) <span class="kr">in</span>
 (state_update s j si&#39;, om&#39;)) = (
s&#39;, om&#39;)</span></span></span><br><span><var>i</var><span class="hyp-type"><b>: </b><span>index</span></span></span><br><span><var>si</var><span class="hyp-type"><b>: </b><span>state (IM i)</span></span></span><br><span><var>Hsi</var><span class="hyp-type"><b>: </b><span>initial_state_prop si</span></span></span><br><span><var>IHHs</var><span class="hyp-type"><b>: </b><span>valid_state_prop
  (preloaded_vlsm free_composite_vlsm P)
  (state_update s i si)</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">valid_state_prop
  (preloaded_vlsm free_composite_vlsm P)
  (state_update s&#39; i si)</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="Composition-v-chkae" style="display: none" type="checkbox"><label class="alectryon-input" for="Composition-v-chkae"><span class="nb">destruct</span> (transition _ _ _) <span class="kr">as</span> [sj&#39; omj&#39;] <span class="nb">eqn</span>: Htj.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>message, index</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>EqDecision0</var><span class="hyp-type"><b>: </b><span>EqDecision index</span></span></span><br><span><var>IM</var><span class="hyp-type"><b>: </b><span>index ‚Üí VLSM message</span></span></span><br><span><var>P</var><span class="hyp-type"><b>: </b><span>message ‚Üí <span class="kt">Prop</span></span></span></span><br><span><var>s'</var><span class="hyp-type"><b>: </b><span>state (preloaded_vlsm free_composite_vlsm P)</span></span></span><br><span><var>j</var><span class="hyp-type"><b>: </b><span>index</span></span></span><br><span><var>lj</var><span class="hyp-type"><b>: </b><span>label (IM j)</span></span></span><br><span><var>om, om'</var><span class="hyp-type"><b>: </b><span>option message</span></span></span><br><span><var>s</var><span class="hyp-type"><b>: </b><span>state (preloaded_vlsm free_composite_vlsm P)</span></span></span><br><span><var>Hps</var><span class="hyp-type"><b>: </b><span>valid_state_prop
  (preloaded_vlsm free_composite_vlsm P) s</span></span></span><br><span><var>Hom</var><span class="hyp-type"><b>: </b><span>option_valid_message_prop
  (preloaded_vlsm free_composite_vlsm P) om</span></span></span><br><span><var>Hv</var><span class="hyp-type"><b>: </b><span>valid lj (s j, om)</span></span></span><br><span><var>sj'</var><span class="hyp-type"><b>: </b><span>state (IM j)</span></span></span><br><span><var>omj'</var><span class="hyp-type"><b>: </b><span>option message</span></span></span><br><span><var>Htj</var><span class="hyp-type"><b>: </b><span>transition lj (s j, om) = (sj&#39;, omj&#39;)</span></span></span><br><span><var>Ht</var><span class="hyp-type"><b>: </b><span>(state_update s j sj&#39;, omj&#39;) = (s&#39;, om&#39;)</span></span></span><br><span><var>i</var><span class="hyp-type"><b>: </b><span>index</span></span></span><br><span><var>si</var><span class="hyp-type"><b>: </b><span>state (IM i)</span></span></span><br><span><var>Hsi</var><span class="hyp-type"><b>: </b><span>initial_state_prop si</span></span></span><br><span><var>IHHs</var><span class="hyp-type"><b>: </b><span>valid_state_prop
  (preloaded_vlsm free_composite_vlsm P)
  (state_update s i si)</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">valid_state_prop
  (preloaded_vlsm free_composite_vlsm P)
  (state_update s&#39; i si)</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="Composition-v-chkaf" style="display: none" type="checkbox"><label class="alectryon-input" for="Composition-v-chkaf"><span class="nb">inversion_clear</span> Ht.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>message, index</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>EqDecision0</var><span class="hyp-type"><b>: </b><span>EqDecision index</span></span></span><br><span><var>IM</var><span class="hyp-type"><b>: </b><span>index ‚Üí VLSM message</span></span></span><br><span><var>P</var><span class="hyp-type"><b>: </b><span>message ‚Üí <span class="kt">Prop</span></span></span></span><br><span><var>s'</var><span class="hyp-type"><b>: </b><span>state (preloaded_vlsm free_composite_vlsm P)</span></span></span><br><span><var>j</var><span class="hyp-type"><b>: </b><span>index</span></span></span><br><span><var>lj</var><span class="hyp-type"><b>: </b><span>label (IM j)</span></span></span><br><span><var>om, om'</var><span class="hyp-type"><b>: </b><span>option message</span></span></span><br><span><var>s</var><span class="hyp-type"><b>: </b><span>state (preloaded_vlsm free_composite_vlsm P)</span></span></span><br><span><var>Hps</var><span class="hyp-type"><b>: </b><span>valid_state_prop
  (preloaded_vlsm free_composite_vlsm P) s</span></span></span><br><span><var>Hom</var><span class="hyp-type"><b>: </b><span>option_valid_message_prop
  (preloaded_vlsm free_composite_vlsm P) om</span></span></span><br><span><var>Hv</var><span class="hyp-type"><b>: </b><span>valid lj (s j, om)</span></span></span><br><span><var>sj'</var><span class="hyp-type"><b>: </b><span>state (IM j)</span></span></span><br><span><var>omj'</var><span class="hyp-type"><b>: </b><span>option message</span></span></span><br><span><var>Htj</var><span class="hyp-type"><b>: </b><span>transition lj (s j, om) = (sj&#39;, omj&#39;)</span></span></span><br><span><var>i</var><span class="hyp-type"><b>: </b><span>index</span></span></span><br><span><var>si</var><span class="hyp-type"><b>: </b><span>state (IM i)</span></span></span><br><span><var>Hsi</var><span class="hyp-type"><b>: </b><span>initial_state_prop si</span></span></span><br><span><var>IHHs</var><span class="hyp-type"><b>: </b><span>valid_state_prop
  (preloaded_vlsm free_composite_vlsm P)
  (state_update s i si)</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">valid_state_prop
  (preloaded_vlsm free_composite_vlsm P)
  (state_update (state_update s j sj&#39;) i si)</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="Composition-v-chkb0" style="display: none" type="checkbox"><label class="alectryon-input" for="Composition-v-chkb0"><span class="nb">destruct</span> (decide (i = j)).</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>message, index</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>EqDecision0</var><span class="hyp-type"><b>: </b><span>EqDecision index</span></span></span><br><span><var>IM</var><span class="hyp-type"><b>: </b><span>index ‚Üí VLSM message</span></span></span><br><span><var>P</var><span class="hyp-type"><b>: </b><span>message ‚Üí <span class="kt">Prop</span></span></span></span><br><span><var>s'</var><span class="hyp-type"><b>: </b><span>state (preloaded_vlsm free_composite_vlsm P)</span></span></span><br><span><var>j</var><span class="hyp-type"><b>: </b><span>index</span></span></span><br><span><var>lj</var><span class="hyp-type"><b>: </b><span>label (IM j)</span></span></span><br><span><var>om, om'</var><span class="hyp-type"><b>: </b><span>option message</span></span></span><br><span><var>s</var><span class="hyp-type"><b>: </b><span>state (preloaded_vlsm free_composite_vlsm P)</span></span></span><br><span><var>Hps</var><span class="hyp-type"><b>: </b><span>valid_state_prop
  (preloaded_vlsm free_composite_vlsm P) s</span></span></span><br><span><var>Hom</var><span class="hyp-type"><b>: </b><span>option_valid_message_prop
  (preloaded_vlsm free_composite_vlsm P) om</span></span></span><br><span><var>Hv</var><span class="hyp-type"><b>: </b><span>valid lj (s j, om)</span></span></span><br><span><var>sj'</var><span class="hyp-type"><b>: </b><span>state (IM j)</span></span></span><br><span><var>omj'</var><span class="hyp-type"><b>: </b><span>option message</span></span></span><br><span><var>Htj</var><span class="hyp-type"><b>: </b><span>transition lj (s j, om) = (sj&#39;, omj&#39;)</span></span></span><br><span><var>i</var><span class="hyp-type"><b>: </b><span>index</span></span></span><br><span><var>si</var><span class="hyp-type"><b>: </b><span>state (IM i)</span></span></span><br><span><var>Hsi</var><span class="hyp-type"><b>: </b><span>initial_state_prop si</span></span></span><br><span><var>IHHs</var><span class="hyp-type"><b>: </b><span>valid_state_prop
  (preloaded_vlsm free_composite_vlsm P)
  (state_update s i si)</span></span></span><br><span><var>e</var><span class="hyp-type"><b>: </b><span>i = j</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">valid_state_prop
  (preloaded_vlsm free_composite_vlsm P)
  (state_update (state_update s j sj&#39;) i si)</div></blockquote><div class="alectryon-extra-goals"><input class="alectryon-extra-goal-toggle" id="Composition-v-chkb1" style="display: none" type="checkbox"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>message, index</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>EqDecision0</var><span class="hyp-type"><b>: </b><span>EqDecision index</span></span></span><br><span><var>IM</var><span class="hyp-type"><b>: </b><span>index ‚Üí VLSM message</span></span></span><br><span><var>P</var><span class="hyp-type"><b>: </b><span>message ‚Üí <span class="kt">Prop</span></span></span></span><br><span><var>s'</var><span class="hyp-type"><b>: </b><span>state (preloaded_vlsm free_composite_vlsm P)</span></span></span><br><span><var>j</var><span class="hyp-type"><b>: </b><span>index</span></span></span><br><span><var>lj</var><span class="hyp-type"><b>: </b><span>label (IM j)</span></span></span><br><span><var>om, om'</var><span class="hyp-type"><b>: </b><span>option message</span></span></span><br><span><var>s</var><span class="hyp-type"><b>: </b><span>state (preloaded_vlsm free_composite_vlsm P)</span></span></span><br><span><var>Hps</var><span class="hyp-type"><b>: </b><span>valid_state_prop
  (preloaded_vlsm free_composite_vlsm P) s</span></span></span><br><span><var>Hom</var><span class="hyp-type"><b>: </b><span>option_valid_message_prop
  (preloaded_vlsm free_composite_vlsm P) om</span></span></span><br><span><var>Hv</var><span class="hyp-type"><b>: </b><span>valid lj (s j, om)</span></span></span><br><span><var>sj'</var><span class="hyp-type"><b>: </b><span>state (IM j)</span></span></span><br><span><var>omj'</var><span class="hyp-type"><b>: </b><span>option message</span></span></span><br><span><var>Htj</var><span class="hyp-type"><b>: </b><span>transition lj (s j, om) = (sj&#39;, omj&#39;)</span></span></span><br><span><var>i</var><span class="hyp-type"><b>: </b><span>index</span></span></span><br><span><var>si</var><span class="hyp-type"><b>: </b><span>state (IM i)</span></span></span><br><span><var>Hsi</var><span class="hyp-type"><b>: </b><span>initial_state_prop si</span></span></span><br><span><var>IHHs</var><span class="hyp-type"><b>: </b><span>valid_state_prop
  (preloaded_vlsm free_composite_vlsm P)
  (state_update s i si)</span></span></span><br><span><var>n</var><span class="hyp-type"><b>: </b><span>i ‚â† j</span></span></span><br></div><label class="goal-separator" for="Composition-v-chkb1"><hr></label><div class="goal-conclusion">valid_state_prop
  (preloaded_vlsm free_composite_vlsm P)
  (state_update (state_update s j sj&#39;) i si)</div></blockquote></div></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="Composition-v-chkb2" style="display: none" type="checkbox"><label class="alectryon-input" for="Composition-v-chkb2">+</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>message, index</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>EqDecision0</var><span class="hyp-type"><b>: </b><span>EqDecision index</span></span></span><br><span><var>IM</var><span class="hyp-type"><b>: </b><span>index ‚Üí VLSM message</span></span></span><br><span><var>P</var><span class="hyp-type"><b>: </b><span>message ‚Üí <span class="kt">Prop</span></span></span></span><br><span><var>s'</var><span class="hyp-type"><b>: </b><span>state (preloaded_vlsm free_composite_vlsm P)</span></span></span><br><span><var>j</var><span class="hyp-type"><b>: </b><span>index</span></span></span><br><span><var>lj</var><span class="hyp-type"><b>: </b><span>label (IM j)</span></span></span><br><span><var>om, om'</var><span class="hyp-type"><b>: </b><span>option message</span></span></span><br><span><var>s</var><span class="hyp-type"><b>: </b><span>state (preloaded_vlsm free_composite_vlsm P)</span></span></span><br><span><var>Hps</var><span class="hyp-type"><b>: </b><span>valid_state_prop
  (preloaded_vlsm free_composite_vlsm P) s</span></span></span><br><span><var>Hom</var><span class="hyp-type"><b>: </b><span>option_valid_message_prop
  (preloaded_vlsm free_composite_vlsm P) om</span></span></span><br><span><var>Hv</var><span class="hyp-type"><b>: </b><span>valid lj (s j, om)</span></span></span><br><span><var>sj'</var><span class="hyp-type"><b>: </b><span>state (IM j)</span></span></span><br><span><var>omj'</var><span class="hyp-type"><b>: </b><span>option message</span></span></span><br><span><var>Htj</var><span class="hyp-type"><b>: </b><span>transition lj (s j, om) = (sj&#39;, omj&#39;)</span></span></span><br><span><var>i</var><span class="hyp-type"><b>: </b><span>index</span></span></span><br><span><var>si</var><span class="hyp-type"><b>: </b><span>state (IM i)</span></span></span><br><span><var>Hsi</var><span class="hyp-type"><b>: </b><span>initial_state_prop si</span></span></span><br><span><var>IHHs</var><span class="hyp-type"><b>: </b><span>valid_state_prop
  (preloaded_vlsm free_composite_vlsm P)
  (state_update s i si)</span></span></span><br><span><var>e</var><span class="hyp-type"><b>: </b><span>i = j</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">valid_state_prop
  (preloaded_vlsm free_composite_vlsm P)
  (state_update (state_update s j sj&#39;) i si)</div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="bp">by</span> <span class="nb">subst</span>; <span class="nb">rewrite</span> state_update_twice.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="Composition-v-chkb3" style="display: none" type="checkbox"><label class="alectryon-input" for="Composition-v-chkb3">+</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>message, index</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>EqDecision0</var><span class="hyp-type"><b>: </b><span>EqDecision index</span></span></span><br><span><var>IM</var><span class="hyp-type"><b>: </b><span>index ‚Üí VLSM message</span></span></span><br><span><var>P</var><span class="hyp-type"><b>: </b><span>message ‚Üí <span class="kt">Prop</span></span></span></span><br><span><var>s'</var><span class="hyp-type"><b>: </b><span>state (preloaded_vlsm free_composite_vlsm P)</span></span></span><br><span><var>j</var><span class="hyp-type"><b>: </b><span>index</span></span></span><br><span><var>lj</var><span class="hyp-type"><b>: </b><span>label (IM j)</span></span></span><br><span><var>om, om'</var><span class="hyp-type"><b>: </b><span>option message</span></span></span><br><span><var>s</var><span class="hyp-type"><b>: </b><span>state (preloaded_vlsm free_composite_vlsm P)</span></span></span><br><span><var>Hps</var><span class="hyp-type"><b>: </b><span>valid_state_prop
  (preloaded_vlsm free_composite_vlsm P) s</span></span></span><br><span><var>Hom</var><span class="hyp-type"><b>: </b><span>option_valid_message_prop
  (preloaded_vlsm free_composite_vlsm P) om</span></span></span><br><span><var>Hv</var><span class="hyp-type"><b>: </b><span>valid lj (s j, om)</span></span></span><br><span><var>sj'</var><span class="hyp-type"><b>: </b><span>state (IM j)</span></span></span><br><span><var>omj'</var><span class="hyp-type"><b>: </b><span>option message</span></span></span><br><span><var>Htj</var><span class="hyp-type"><b>: </b><span>transition lj (s j, om) = (sj&#39;, omj&#39;)</span></span></span><br><span><var>i</var><span class="hyp-type"><b>: </b><span>index</span></span></span><br><span><var>si</var><span class="hyp-type"><b>: </b><span>state (IM i)</span></span></span><br><span><var>Hsi</var><span class="hyp-type"><b>: </b><span>initial_state_prop si</span></span></span><br><span><var>IHHs</var><span class="hyp-type"><b>: </b><span>valid_state_prop
  (preloaded_vlsm free_composite_vlsm P)
  (state_update s i si)</span></span></span><br><span><var>n</var><span class="hyp-type"><b>: </b><span>i ‚â† j</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">valid_state_prop
  (preloaded_vlsm free_composite_vlsm P)
  (state_update (state_update s j sj&#39;) i si)</div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="Composition-v-chkb4" style="display: none" type="checkbox"><label class="alectryon-input" for="Composition-v-chkb4"><span class="nb">rewrite</span> state_update_twice_neq <span class="bp">by</span> <span class="bp">done</span>.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>message, index</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>EqDecision0</var><span class="hyp-type"><b>: </b><span>EqDecision index</span></span></span><br><span><var>IM</var><span class="hyp-type"><b>: </b><span>index ‚Üí VLSM message</span></span></span><br><span><var>P</var><span class="hyp-type"><b>: </b><span>message ‚Üí <span class="kt">Prop</span></span></span></span><br><span><var>s'</var><span class="hyp-type"><b>: </b><span>state (preloaded_vlsm free_composite_vlsm P)</span></span></span><br><span><var>j</var><span class="hyp-type"><b>: </b><span>index</span></span></span><br><span><var>lj</var><span class="hyp-type"><b>: </b><span>label (IM j)</span></span></span><br><span><var>om, om'</var><span class="hyp-type"><b>: </b><span>option message</span></span></span><br><span><var>s</var><span class="hyp-type"><b>: </b><span>state (preloaded_vlsm free_composite_vlsm P)</span></span></span><br><span><var>Hps</var><span class="hyp-type"><b>: </b><span>valid_state_prop
  (preloaded_vlsm free_composite_vlsm P) s</span></span></span><br><span><var>Hom</var><span class="hyp-type"><b>: </b><span>option_valid_message_prop
  (preloaded_vlsm free_composite_vlsm P) om</span></span></span><br><span><var>Hv</var><span class="hyp-type"><b>: </b><span>valid lj (s j, om)</span></span></span><br><span><var>sj'</var><span class="hyp-type"><b>: </b><span>state (IM j)</span></span></span><br><span><var>omj'</var><span class="hyp-type"><b>: </b><span>option message</span></span></span><br><span><var>Htj</var><span class="hyp-type"><b>: </b><span>transition lj (s j, om) = (sj&#39;, omj&#39;)</span></span></span><br><span><var>i</var><span class="hyp-type"><b>: </b><span>index</span></span></span><br><span><var>si</var><span class="hyp-type"><b>: </b><span>state (IM i)</span></span></span><br><span><var>Hsi</var><span class="hyp-type"><b>: </b><span>initial_state_prop si</span></span></span><br><span><var>IHHs</var><span class="hyp-type"><b>: </b><span>valid_state_prop
  (preloaded_vlsm free_composite_vlsm P)
  (state_update s i si)</span></span></span><br><span><var>n</var><span class="hyp-type"><b>: </b><span>i ‚â† j</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">valid_state_prop
  (preloaded_vlsm free_composite_vlsm P)
  (state_update (state_update s i si) j sj&#39;)</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">      </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="Composition-v-chkb5" style="display: none" type="checkbox"><label class="alectryon-input" for="Composition-v-chkb5"><span class="nb">apply</span> input_valid_transition_destination <span class="kr">with</span> (existT j lj) (state_update s i si) om omj&#39;.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>message, index</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>EqDecision0</var><span class="hyp-type"><b>: </b><span>EqDecision index</span></span></span><br><span><var>IM</var><span class="hyp-type"><b>: </b><span>index ‚Üí VLSM message</span></span></span><br><span><var>P</var><span class="hyp-type"><b>: </b><span>message ‚Üí <span class="kt">Prop</span></span></span></span><br><span><var>s'</var><span class="hyp-type"><b>: </b><span>state (preloaded_vlsm free_composite_vlsm P)</span></span></span><br><span><var>j</var><span class="hyp-type"><b>: </b><span>index</span></span></span><br><span><var>lj</var><span class="hyp-type"><b>: </b><span>label (IM j)</span></span></span><br><span><var>om, om'</var><span class="hyp-type"><b>: </b><span>option message</span></span></span><br><span><var>s</var><span class="hyp-type"><b>: </b><span>state (preloaded_vlsm free_composite_vlsm P)</span></span></span><br><span><var>Hps</var><span class="hyp-type"><b>: </b><span>valid_state_prop
  (preloaded_vlsm free_composite_vlsm P) s</span></span></span><br><span><var>Hom</var><span class="hyp-type"><b>: </b><span>option_valid_message_prop
  (preloaded_vlsm free_composite_vlsm P) om</span></span></span><br><span><var>Hv</var><span class="hyp-type"><b>: </b><span>valid lj (s j, om)</span></span></span><br><span><var>sj'</var><span class="hyp-type"><b>: </b><span>state (IM j)</span></span></span><br><span><var>omj'</var><span class="hyp-type"><b>: </b><span>option message</span></span></span><br><span><var>Htj</var><span class="hyp-type"><b>: </b><span>transition lj (s j, om) = (sj&#39;, omj&#39;)</span></span></span><br><span><var>i</var><span class="hyp-type"><b>: </b><span>index</span></span></span><br><span><var>si</var><span class="hyp-type"><b>: </b><span>state (IM i)</span></span></span><br><span><var>Hsi</var><span class="hyp-type"><b>: </b><span>initial_state_prop si</span></span></span><br><span><var>IHHs</var><span class="hyp-type"><b>: </b><span>valid_state_prop
  (preloaded_vlsm free_composite_vlsm P)
  (state_update s i si)</span></span></span><br><span><var>n</var><span class="hyp-type"><b>: </b><span>i ‚â† j</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">input_valid_transition
  (preloaded_vlsm free_composite_vlsm P) (existT j lj)
  (state_update s i si, om)
  (state_update (state_update s i si) j sj&#39;, omj&#39;)</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">      </span><span class="alectryon-sentence"><span class="alectryon-input"><span class="bp">by</span> <span class="kp">repeat</span> <span class="nb">split</span>; [<span class="bp">done</span> | <span class="bp">done</span> | ..]; <span class="nb">cbn</span>; <span class="nb">rewrite</span> state_update_neq;
        [.. | <span class="nb">rewrite</span> Htj |].</span><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Qed</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
</span><span class="alectryon-sentence"><input class="alectryon-toggle" id="Composition-v-chkb6" style="display: none" type="checkbox"><label class="alectryon-input" for="Composition-v-chkb6"><span class="kn">Lemma</span> <span class="nf">lift_to_composite_valid_preservation</span> :
  <span class="kr">forall</span> (<span class="nv">i</span> : index) (<span class="nv">cs</span> : composite_state),
  <span class="kr">forall</span> <span class="nv">l</span> <span class="nv">s</span> <span class="nv">om</span>, valid (IM i) l (s, om) -&gt;
    composite_valid (lift_to_composite_label i l)
      (lift_to_composite_state cs i s, om).</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>message, index</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>EqDecision0</var><span class="hyp-type"><b>: </b><span>EqDecision index</span></span></span><br><span><var>IM</var><span class="hyp-type"><b>: </b><span>index ‚Üí VLSM message</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="kr">‚àÄ</span> (<span class="nv">i</span> : index) (<span class="nv">cs</span> : composite_state) (<span class="nv">l</span> : label (IM i)) 
  (<span class="nv">s</span> : state (IM i)) (<span class="nv">om</span> : option message),
  valid l (s, om)
  ‚Üí composite_valid (lift_to_composite_label i l)
      (lift_to_composite_state cs i s, om)</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="Composition-v-chkb7" style="display: none" type="checkbox"><label class="alectryon-input" for="Composition-v-chkb7"><span class="kn">Proof</span>.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>message, index</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>EqDecision0</var><span class="hyp-type"><b>: </b><span>EqDecision index</span></span></span><br><span><var>IM</var><span class="hyp-type"><b>: </b><span>index ‚Üí VLSM message</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="kr">‚àÄ</span> (<span class="nv">i</span> : index) (<span class="nv">cs</span> : composite_state) (<span class="nv">l</span> : label (IM i)) 
  (<span class="nv">s</span> : state (IM i)) (<span class="nv">om</span> : option message),
  valid l (s, om)
  ‚Üí composite_valid (lift_to_composite_label i l)
      (lift_to_composite_state cs i s, om)</div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="bp">by</span> <span class="nb">intros</span>; <span class="nb">cbn</span>; <span class="nb">rewrite</span> state_update_eq.</span><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Qed</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
</span><span class="alectryon-sentence"><input class="alectryon-toggle" id="Composition-v-chkb8" style="display: none" type="checkbox"><label class="alectryon-input" for="Composition-v-chkb8"><span class="kn">Lemma</span> <span class="nf">lift_to_composite_transition_preservation</span> :
  <span class="kr">forall</span> (<span class="nv">i</span> : index) (<span class="nv">cs</span> : composite_state),
  <span class="kr">forall</span> <span class="nv">l</span> <span class="nv">s</span> <span class="nv">om</span> <span class="nv">s&#39;</span> <span class="nv">om&#39;</span>, transition (IM i) l (s, om) = (s&#39;, om&#39;) -&gt;
    composite_transition (lift_to_composite_label i l)
      (lift_to_composite_state cs i s, om)
        =
      (lift_to_composite_state cs i s&#39;, om&#39;).</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>message, index</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>EqDecision0</var><span class="hyp-type"><b>: </b><span>EqDecision index</span></span></span><br><span><var>IM</var><span class="hyp-type"><b>: </b><span>index ‚Üí VLSM message</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="kr">‚àÄ</span> (<span class="nv">i</span> : index) (<span class="nv">cs</span> : composite_state) (<span class="nv">l</span> : label (IM i)) 
  (<span class="nv">s</span> : state (IM i)) (<span class="nv">om</span> : option message) (<span class="nv">s&#39;</span> : state
                                                 (IM i)) 
  (<span class="nv">om&#39;</span> : option message),
  transition l (s, om) = (s&#39;, om&#39;)
  ‚Üí composite_transition (lift_to_composite_label i l)
      (lift_to_composite_state cs i s, om) =
    (lift_to_composite_state cs i s&#39;, om&#39;)</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="Composition-v-chkb9" style="display: none" type="checkbox"><label class="alectryon-input" for="Composition-v-chkb9"><span class="kn">Proof</span>.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>message, index</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>EqDecision0</var><span class="hyp-type"><b>: </b><span>EqDecision index</span></span></span><br><span><var>IM</var><span class="hyp-type"><b>: </b><span>index ‚Üí VLSM message</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="kr">‚àÄ</span> (<span class="nv">i</span> : index) (<span class="nv">cs</span> : composite_state) (<span class="nv">l</span> : label (IM i)) 
  (<span class="nv">s</span> : state (IM i)) (<span class="nv">om</span> : option message) (<span class="nv">s&#39;</span> : state
                                                 (IM i)) 
  (<span class="nv">om&#39;</span> : option message),
  transition l (s, om) = (s&#39;, om&#39;)
  ‚Üí composite_transition (lift_to_composite_label i l)
      (lift_to_composite_state cs i s, om) =
    (lift_to_composite_state cs i s&#39;, om&#39;)</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="Composition-v-chkba" style="display: none" type="checkbox"><label class="alectryon-input" for="Composition-v-chkba"><span class="nb">intros</span>; <span class="nb">cbn</span>.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>message, index</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>EqDecision0</var><span class="hyp-type"><b>: </b><span>EqDecision index</span></span></span><br><span><var>IM</var><span class="hyp-type"><b>: </b><span>index ‚Üí VLSM message</span></span></span><br><span><var>i</var><span class="hyp-type"><b>: </b><span>index</span></span></span><br><span><var>cs</var><span class="hyp-type"><b>: </b><span>composite_state</span></span></span><br><span><var>l</var><span class="hyp-type"><b>: </b><span>label (IM i)</span></span></span><br><span><var>s</var><span class="hyp-type"><b>: </b><span>state (IM i)</span></span></span><br><span><var>om</var><span class="hyp-type"><b>: </b><span>option message</span></span></span><br><span><var>s'</var><span class="hyp-type"><b>: </b><span>state (IM i)</span></span></span><br><span><var>om'</var><span class="hyp-type"><b>: </b><span>option message</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>transition l (s, om) = (s&#39;, om&#39;)</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">(<span class="kr">let</span> (<span class="nv">si&#39;</span>, om&#39;) :=
   transition l (lift_to_composite_state cs i s i, om) <span class="kr">in</span>
 (state_update (lift_to_composite_state cs i s) i si&#39;,
  om&#39;)) = (lift_to_composite_state cs i s&#39;, om&#39;)</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="Composition-v-chkbb" style="display: none" type="checkbox"><label class="alectryon-input" for="Composition-v-chkbb"><span class="nb">unfold</span> lift_to_composite_state; <span class="nb">rewrite</span> state_update_eq.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>message, index</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>EqDecision0</var><span class="hyp-type"><b>: </b><span>EqDecision index</span></span></span><br><span><var>IM</var><span class="hyp-type"><b>: </b><span>index ‚Üí VLSM message</span></span></span><br><span><var>i</var><span class="hyp-type"><b>: </b><span>index</span></span></span><br><span><var>cs</var><span class="hyp-type"><b>: </b><span>composite_state</span></span></span><br><span><var>l</var><span class="hyp-type"><b>: </b><span>label (IM i)</span></span></span><br><span><var>s</var><span class="hyp-type"><b>: </b><span>state (IM i)</span></span></span><br><span><var>om</var><span class="hyp-type"><b>: </b><span>option message</span></span></span><br><span><var>s'</var><span class="hyp-type"><b>: </b><span>state (IM i)</span></span></span><br><span><var>om'</var><span class="hyp-type"><b>: </b><span>option message</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>transition l (s, om) = (s&#39;, om&#39;)</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">(<span class="kr">let</span> (<span class="nv">si&#39;</span>, om&#39;) := transition l (s, om) <span class="kr">in</span>
 (state_update (state_update cs i s) i si&#39;, om&#39;)) =
(state_update cs i s&#39;, om&#39;)</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><span class="alectryon-input"><span class="bp">by</span> <span class="nb">replace</span> (transition _ _ _) <span class="kr">with</span> (s&#39;, om&#39;); <span class="nb">rewrite</span> state_update_twice.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Qed</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
</span><span class="alectryon-sentence"><input class="alectryon-toggle" id="Composition-v-chkbc" style="display: none" type="checkbox"><label class="alectryon-input" for="Composition-v-chkbc"><span class="kn">Lemma</span> <span class="nf">lift_to_composite_initial_message_preservation</span> :
  <span class="kr">forall</span> (<span class="nv">i</span> : index),
      <span class="kr">forall</span> <span class="nv">m</span>, initial_message_prop (IM i) m -&gt;
      composite_initial_message_prop m.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>message, index</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>EqDecision0</var><span class="hyp-type"><b>: </b><span>EqDecision index</span></span></span><br><span><var>IM</var><span class="hyp-type"><b>: </b><span>index ‚Üí VLSM message</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="kr">‚àÄ</span> (<span class="nv">i</span> : index) (<span class="nv">m</span> : message),
  initial_message_prop m
  ‚Üí composite_initial_message_prop m</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="Composition-v-chkbd" style="display: none" type="checkbox"><label class="alectryon-input" for="Composition-v-chkbd"><span class="kn">Proof</span>.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>message, index</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>EqDecision0</var><span class="hyp-type"><b>: </b><span>EqDecision index</span></span></span><br><span><var>IM</var><span class="hyp-type"><b>: </b><span>index ‚Üí VLSM message</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="kr">‚àÄ</span> (<span class="nv">i</span> : index) (<span class="nv">m</span> : message),
  initial_message_prop m
  ‚Üí composite_initial_message_prop m</div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="bp">by</span> <span class="nb">intros</span> i m Hm; <span class="kr">exists</span> <span class="nv">i</span>, (exist _ _ Hm).</span><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Qed</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
</span><span class="alectryon-sentence"><input class="alectryon-toggle" id="Composition-v-chkbe" style="display: none" type="checkbox"><label class="alectryon-input" for="Composition-v-chkbe"><span class="kn">Lemma</span> <span class="nf">pre_lift_to_free_weak_embedding</span> :
  <span class="kr">forall</span> (<span class="nv">i</span> : index) (<span class="nv">cs</span> : composite_state) (<span class="nv">P</span> : message -&gt; <span class="kt">Prop</span>),
    valid_state_prop (preloaded_vlsm free_composite_vlsm P) cs -&gt;
    VLSM_weak_embedding
      (preloaded_vlsm (IM i) P) (preloaded_vlsm free_composite_vlsm P)
      (lift_to_composite_label i) (lift_to_composite_state cs i).</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>message, index</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>EqDecision0</var><span class="hyp-type"><b>: </b><span>EqDecision index</span></span></span><br><span><var>IM</var><span class="hyp-type"><b>: </b><span>index ‚Üí VLSM message</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="kr">‚àÄ</span> (<span class="nv">i</span> : index) (<span class="nv">cs</span> : composite_state) (<span class="nv">P</span> : message
                                          ‚Üí <span class="kt">Prop</span>),
  valid_state_prop
    (preloaded_vlsm free_composite_vlsm P) cs
  ‚Üí VLSM_weak_embedding (preloaded_vlsm (IM i) P)
      (preloaded_vlsm free_composite_vlsm P)
      (lift_to_composite_label i)
      (lift_to_composite_state cs i)</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="Composition-v-chkbf" style="display: none" type="checkbox"><label class="alectryon-input" for="Composition-v-chkbf"><span class="kn">Proof</span>.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>message, index</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>EqDecision0</var><span class="hyp-type"><b>: </b><span>EqDecision index</span></span></span><br><span><var>IM</var><span class="hyp-type"><b>: </b><span>index ‚Üí VLSM message</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="kr">‚àÄ</span> (<span class="nv">i</span> : index) (<span class="nv">cs</span> : composite_state) (<span class="nv">P</span> : message
                                          ‚Üí <span class="kt">Prop</span>),
  valid_state_prop
    (preloaded_vlsm free_composite_vlsm P) cs
  ‚Üí VLSM_weak_embedding (preloaded_vlsm (IM i) P)
      (preloaded_vlsm free_composite_vlsm P)
      (lift_to_composite_label i)
      (lift_to_composite_state cs i)</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="Composition-v-chkc0" style="display: none" type="checkbox"><label class="alectryon-input" for="Composition-v-chkc0"><span class="nb">intros</span> i cs P Hvsp.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>message, index</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>EqDecision0</var><span class="hyp-type"><b>: </b><span>EqDecision index</span></span></span><br><span><var>IM</var><span class="hyp-type"><b>: </b><span>index ‚Üí VLSM message</span></span></span><br><span><var>i</var><span class="hyp-type"><b>: </b><span>index</span></span></span><br><span><var>cs</var><span class="hyp-type"><b>: </b><span>composite_state</span></span></span><br><span><var>P</var><span class="hyp-type"><b>: </b><span>message ‚Üí <span class="kt">Prop</span></span></span></span><br><span><var>Hvsp</var><span class="hyp-type"><b>: </b><span>valid_state_prop
  (preloaded_vlsm free_composite_vlsm P) cs</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">VLSM_weak_embedding (preloaded_vlsm (IM i) P)
  (preloaded_vlsm free_composite_vlsm P)
  (lift_to_composite_label i)
  (lift_to_composite_state cs i)</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="Composition-v-chkc1" style="display: none" type="checkbox"><label class="alectryon-input" for="Composition-v-chkc1"><span class="nb">apply</span> basic_VLSM_weak_embedding.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>message, index</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>EqDecision0</var><span class="hyp-type"><b>: </b><span>EqDecision index</span></span></span><br><span><var>IM</var><span class="hyp-type"><b>: </b><span>index ‚Üí VLSM message</span></span></span><br><span><var>i</var><span class="hyp-type"><b>: </b><span>index</span></span></span><br><span><var>cs</var><span class="hyp-type"><b>: </b><span>composite_state</span></span></span><br><span><var>P</var><span class="hyp-type"><b>: </b><span>message ‚Üí <span class="kt">Prop</span></span></span></span><br><span><var>Hvsp</var><span class="hyp-type"><b>: </b><span>valid_state_prop
  (preloaded_vlsm free_composite_vlsm P) cs</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">weak_embedding_valid_preservation
  (preloaded_vlsm (IM i) P)
  (preloaded_vlsm free_composite_vlsm P)
  (lift_to_composite_label i)
  (lift_to_composite_state cs i)</div></blockquote><div class="alectryon-extra-goals"><input class="alectryon-extra-goal-toggle" id="Composition-v-chkc2" style="display: none" type="checkbox"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>message, index</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>EqDecision0</var><span class="hyp-type"><b>: </b><span>EqDecision index</span></span></span><br><span><var>IM</var><span class="hyp-type"><b>: </b><span>index ‚Üí VLSM message</span></span></span><br><span><var>i</var><span class="hyp-type"><b>: </b><span>index</span></span></span><br><span><var>cs</var><span class="hyp-type"><b>: </b><span>composite_state</span></span></span><br><span><var>P</var><span class="hyp-type"><b>: </b><span>message ‚Üí <span class="kt">Prop</span></span></span></span><br><span><var>Hvsp</var><span class="hyp-type"><b>: </b><span>valid_state_prop
  (preloaded_vlsm free_composite_vlsm P) cs</span></span></span><br></div><label class="goal-separator" for="Composition-v-chkc2"><hr></label><div class="goal-conclusion">weak_embedding_transition_preservation
  (preloaded_vlsm (IM i) P)
  (preloaded_vlsm free_composite_vlsm P)
  (lift_to_composite_label i)
  (lift_to_composite_state cs i)</div></blockquote><input class="alectryon-extra-goal-toggle" id="Composition-v-chkc3" style="display: none" type="checkbox"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>message, index</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>EqDecision0</var><span class="hyp-type"><b>: </b><span>EqDecision index</span></span></span><br><span><var>IM</var><span class="hyp-type"><b>: </b><span>index ‚Üí VLSM message</span></span></span><br><span><var>i</var><span class="hyp-type"><b>: </b><span>index</span></span></span><br><span><var>cs</var><span class="hyp-type"><b>: </b><span>composite_state</span></span></span><br><span><var>P</var><span class="hyp-type"><b>: </b><span>message ‚Üí <span class="kt">Prop</span></span></span></span><br><span><var>Hvsp</var><span class="hyp-type"><b>: </b><span>valid_state_prop
  (preloaded_vlsm free_composite_vlsm P) cs</span></span></span><br></div><label class="goal-separator" for="Composition-v-chkc3"><hr></label><div class="goal-conclusion">weak_projection_initial_state_preservation
  (preloaded_vlsm (IM i) P)
  (preloaded_vlsm free_composite_vlsm P)
  (lift_to_composite_state cs i)</div></blockquote><input class="alectryon-extra-goal-toggle" id="Composition-v-chkc4" style="display: none" type="checkbox"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>message, index</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>EqDecision0</var><span class="hyp-type"><b>: </b><span>EqDecision index</span></span></span><br><span><var>IM</var><span class="hyp-type"><b>: </b><span>index ‚Üí VLSM message</span></span></span><br><span><var>i</var><span class="hyp-type"><b>: </b><span>index</span></span></span><br><span><var>cs</var><span class="hyp-type"><b>: </b><span>composite_state</span></span></span><br><span><var>P</var><span class="hyp-type"><b>: </b><span>message ‚Üí <span class="kt">Prop</span></span></span></span><br><span><var>Hvsp</var><span class="hyp-type"><b>: </b><span>valid_state_prop
  (preloaded_vlsm free_composite_vlsm P) cs</span></span></span><br></div><label class="goal-separator" for="Composition-v-chkc4"><hr></label><div class="goal-conclusion">weak_embedding_initial_message_preservation
  (preloaded_vlsm (IM i) P)
  (preloaded_vlsm free_composite_vlsm P)
  (lift_to_composite_state cs i)</div></blockquote></div></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="Composition-v-chkc5" style="display: none" type="checkbox"><label class="alectryon-input" for="Composition-v-chkc5">-</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>message, index</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>EqDecision0</var><span class="hyp-type"><b>: </b><span>EqDecision index</span></span></span><br><span><var>IM</var><span class="hyp-type"><b>: </b><span>index ‚Üí VLSM message</span></span></span><br><span><var>i</var><span class="hyp-type"><b>: </b><span>index</span></span></span><br><span><var>cs</var><span class="hyp-type"><b>: </b><span>composite_state</span></span></span><br><span><var>P</var><span class="hyp-type"><b>: </b><span>message ‚Üí <span class="kt">Prop</span></span></span></span><br><span><var>Hvsp</var><span class="hyp-type"><b>: </b><span>valid_state_prop
  (preloaded_vlsm free_composite_vlsm P) cs</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">weak_embedding_valid_preservation
  (preloaded_vlsm (IM i) P)
  (preloaded_vlsm free_composite_vlsm P)
  (lift_to_composite_label i)
  (lift_to_composite_state cs i)</div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="Composition-v-chkc6" style="display: none" type="checkbox"><label class="alectryon-input" for="Composition-v-chkc6"><span class="nb">intros</span> l s om (_ &amp; _ &amp; Hv) _ _.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>message, index</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>EqDecision0</var><span class="hyp-type"><b>: </b><span>EqDecision index</span></span></span><br><span><var>IM</var><span class="hyp-type"><b>: </b><span>index ‚Üí VLSM message</span></span></span><br><span><var>i</var><span class="hyp-type"><b>: </b><span>index</span></span></span><br><span><var>cs</var><span class="hyp-type"><b>: </b><span>composite_state</span></span></span><br><span><var>P</var><span class="hyp-type"><b>: </b><span>message ‚Üí <span class="kt">Prop</span></span></span></span><br><span><var>Hvsp</var><span class="hyp-type"><b>: </b><span>valid_state_prop
  (preloaded_vlsm free_composite_vlsm P) cs</span></span></span><br><span><var>l</var><span class="hyp-type"><b>: </b><span>label (preloaded_vlsm (IM i) P)</span></span></span><br><span><var>s</var><span class="hyp-type"><b>: </b><span>state (preloaded_vlsm (IM i) P)</span></span></span><br><span><var>om</var><span class="hyp-type"><b>: </b><span>option message</span></span></span><br><span><var>Hv</var><span class="hyp-type"><b>: </b><span>valid l (s, om)</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">valid (lift_to_composite_label i l)
  (lift_to_composite_state cs i s, om)</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><span class="alectryon-input"><span class="bp">by</span> <span class="nb">cbn</span>; <span class="nb">apply</span> lift_to_composite_valid_preservation.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="Composition-v-chkc7" style="display: none" type="checkbox"><label class="alectryon-input" for="Composition-v-chkc7">-</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>message, index</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>EqDecision0</var><span class="hyp-type"><b>: </b><span>EqDecision index</span></span></span><br><span><var>IM</var><span class="hyp-type"><b>: </b><span>index ‚Üí VLSM message</span></span></span><br><span><var>i</var><span class="hyp-type"><b>: </b><span>index</span></span></span><br><span><var>cs</var><span class="hyp-type"><b>: </b><span>composite_state</span></span></span><br><span><var>P</var><span class="hyp-type"><b>: </b><span>message ‚Üí <span class="kt">Prop</span></span></span></span><br><span><var>Hvsp</var><span class="hyp-type"><b>: </b><span>valid_state_prop
  (preloaded_vlsm free_composite_vlsm P) cs</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">weak_embedding_transition_preservation
  (preloaded_vlsm (IM i) P)
  (preloaded_vlsm free_composite_vlsm P)
  (lift_to_composite_label i)
  (lift_to_composite_state cs i)</div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="bp">by</span> <span class="nb">inversion</span> <span class="mi">1</span>; <span class="nb">cbn</span>; <span class="nb">apply</span> lift_to_composite_transition_preservation.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="Composition-v-chkc8" style="display: none" type="checkbox"><label class="alectryon-input" for="Composition-v-chkc8">-</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>message, index</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>EqDecision0</var><span class="hyp-type"><b>: </b><span>EqDecision index</span></span></span><br><span><var>IM</var><span class="hyp-type"><b>: </b><span>index ‚Üí VLSM message</span></span></span><br><span><var>i</var><span class="hyp-type"><b>: </b><span>index</span></span></span><br><span><var>cs</var><span class="hyp-type"><b>: </b><span>composite_state</span></span></span><br><span><var>P</var><span class="hyp-type"><b>: </b><span>message ‚Üí <span class="kt">Prop</span></span></span></span><br><span><var>Hvsp</var><span class="hyp-type"><b>: </b><span>valid_state_prop
  (preloaded_vlsm free_composite_vlsm P) cs</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">weak_projection_initial_state_preservation
  (preloaded_vlsm (IM i) P)
  (preloaded_vlsm free_composite_vlsm P)
  (lift_to_composite_state cs i)</div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="bp">by</span> <span class="nb">intros</span> s Hs; <span class="nb">apply</span> pre_composite_free_update_state_with_initial.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="Composition-v-chkc9" style="display: none" type="checkbox"><label class="alectryon-input" for="Composition-v-chkc9">-</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>message, index</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>EqDecision0</var><span class="hyp-type"><b>: </b><span>EqDecision index</span></span></span><br><span><var>IM</var><span class="hyp-type"><b>: </b><span>index ‚Üí VLSM message</span></span></span><br><span><var>i</var><span class="hyp-type"><b>: </b><span>index</span></span></span><br><span><var>cs</var><span class="hyp-type"><b>: </b><span>composite_state</span></span></span><br><span><var>P</var><span class="hyp-type"><b>: </b><span>message ‚Üí <span class="kt">Prop</span></span></span></span><br><span><var>Hvsp</var><span class="hyp-type"><b>: </b><span>valid_state_prop
  (preloaded_vlsm free_composite_vlsm P) cs</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">weak_embedding_initial_message_preservation
  (preloaded_vlsm (IM i) P)
  (preloaded_vlsm free_composite_vlsm P)
  (lift_to_composite_state cs i)</div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="Composition-v-chkca" style="display: none" type="checkbox"><label class="alectryon-input" for="Composition-v-chkca"><span class="nb">intros</span> _ _ m _ _ [Hm | Hp]; <span class="nb">apply</span> initial_message_is_valid; [<span class="nb">left</span> | <span class="bp">by</span> <span class="nb">right</span>].</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>message, index</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>EqDecision0</var><span class="hyp-type"><b>: </b><span>EqDecision index</span></span></span><br><span><var>IM</var><span class="hyp-type"><b>: </b><span>index ‚Üí VLSM message</span></span></span><br><span><var>i</var><span class="hyp-type"><b>: </b><span>index</span></span></span><br><span><var>cs</var><span class="hyp-type"><b>: </b><span>composite_state</span></span></span><br><span><var>P</var><span class="hyp-type"><b>: </b><span>message ‚Üí <span class="kt">Prop</span></span></span></span><br><span><var>Hvsp</var><span class="hyp-type"><b>: </b><span>valid_state_prop
  (preloaded_vlsm free_composite_vlsm P) cs</span></span></span><br><span><var>m</var><span class="hyp-type"><b>: </b><span>message</span></span></span><br><span><var>Hm</var><span class="hyp-type"><b>: </b><span>initial_message_prop m</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">initial_message_prop m</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><span class="alectryon-input"><span class="bp">by</span> <span class="nb">cbn</span>; <span class="nb">eapply</span> lift_to_composite_initial_message_preservation.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Qed</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
</span><span class="alectryon-sentence"><input class="alectryon-toggle" id="Composition-v-chkcb" style="display: none" type="checkbox"><label class="alectryon-input" for="Composition-v-chkcb"><span class="kn">Lemma</span> <span class="nf">lift_to_free_weak_embedding</span> :
  <span class="kr">forall</span> (<span class="nv">i</span> : index) (<span class="nv">cs</span> : composite_state),
      valid_state_prop free_composite_vlsm cs -&gt;
      VLSM_weak_embedding (IM i) free_composite_vlsm
        (lift_to_composite_label i) (lift_to_composite_state cs i).</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>message, index</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>EqDecision0</var><span class="hyp-type"><b>: </b><span>EqDecision index</span></span></span><br><span><var>IM</var><span class="hyp-type"><b>: </b><span>index ‚Üí VLSM message</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="kr">‚àÄ</span> (<span class="nv">i</span> : index) (<span class="nv">cs</span> : composite_state),
  valid_state_prop free_composite_vlsm cs
  ‚Üí VLSM_weak_embedding (IM i) free_composite_vlsm
      (lift_to_composite_label i)
      (lift_to_composite_state cs i)</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="Composition-v-chkcc" style="display: none" type="checkbox"><label class="alectryon-input" for="Composition-v-chkcc"><span class="kn">Proof</span>.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>message, index</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>EqDecision0</var><span class="hyp-type"><b>: </b><span>EqDecision index</span></span></span><br><span><var>IM</var><span class="hyp-type"><b>: </b><span>index ‚Üí VLSM message</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="kr">‚àÄ</span> (<span class="nv">i</span> : index) (<span class="nv">cs</span> : composite_state),
  valid_state_prop free_composite_vlsm cs
  ‚Üí VLSM_weak_embedding (IM i) free_composite_vlsm
      (lift_to_composite_label i)
      (lift_to_composite_state cs i)</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="Composition-v-chkcd" style="display: none" type="checkbox"><label class="alectryon-input" for="Composition-v-chkcd"><span class="nb">constructor</span>; <span class="nb">intros</span>.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>message, index</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>EqDecision0</var><span class="hyp-type"><b>: </b><span>EqDecision index</span></span></span><br><span><var>IM</var><span class="hyp-type"><b>: </b><span>index ‚Üí VLSM message</span></span></span><br><span><var>i</var><span class="hyp-type"><b>: </b><span>index</span></span></span><br><span><var>cs</var><span class="hyp-type"><b>: </b><span>composite_state</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>valid_state_prop free_composite_vlsm cs</span></span></span><br><span><var>sX</var><span class="hyp-type"><b>: </b><span>state (IM i)</span></span></span><br><span><var>trX</var><span class="hyp-type"><b>: </b><span>list transition_item</span></span></span><br><span><var>H0</var><span class="hyp-type"><b>: </b><span>finite_valid_trace_from (IM i) sX trX</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">finite_valid_trace_from free_composite_vlsm
  (lift_to_composite_state cs i sX)
  (pre_VLSM_embedding_finite_trace_project (IM i)
     free_composite_vlsm (lift_to_composite_label i)
     (lift_to_composite_state cs i) trX)</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="Composition-v-chkce" style="display: none" type="checkbox"><label class="alectryon-input" for="Composition-v-chkce"><span class="nb">apply</span> (VLSM_eq_finite_valid_trace_from (vlsm_is_preloaded_with_False free_composite_vlsm)),
    pre_lift_to_free_weak_embedding.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>message, index</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>EqDecision0</var><span class="hyp-type"><b>: </b><span>EqDecision index</span></span></span><br><span><var>IM</var><span class="hyp-type"><b>: </b><span>index ‚Üí VLSM message</span></span></span><br><span><var>i</var><span class="hyp-type"><b>: </b><span>index</span></span></span><br><span><var>cs</var><span class="hyp-type"><b>: </b><span>composite_state</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>valid_state_prop free_composite_vlsm cs</span></span></span><br><span><var>sX</var><span class="hyp-type"><b>: </b><span>state (IM i)</span></span></span><br><span><var>trX</var><span class="hyp-type"><b>: </b><span>list transition_item</span></span></span><br><span><var>H0</var><span class="hyp-type"><b>: </b><span>finite_valid_trace_from (IM i) sX trX</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">valid_state_prop
  (preloaded_vlsm free_composite_vlsm
     (<span class="kr">Œª</span> <span class="nv">_</span> : message, <span class="kt">False</span>)) cs</div></blockquote><div class="alectryon-extra-goals"><input class="alectryon-extra-goal-toggle" id="Composition-v-chkcf" style="display: none" type="checkbox"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>message, index</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>EqDecision0</var><span class="hyp-type"><b>: </b><span>EqDecision index</span></span></span><br><span><var>IM</var><span class="hyp-type"><b>: </b><span>index ‚Üí VLSM message</span></span></span><br><span><var>i</var><span class="hyp-type"><b>: </b><span>index</span></span></span><br><span><var>cs</var><span class="hyp-type"><b>: </b><span>composite_state</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>valid_state_prop free_composite_vlsm cs</span></span></span><br><span><var>sX</var><span class="hyp-type"><b>: </b><span>state (IM i)</span></span></span><br><span><var>trX</var><span class="hyp-type"><b>: </b><span>list transition_item</span></span></span><br><span><var>H0</var><span class="hyp-type"><b>: </b><span>finite_valid_trace_from (IM i) sX trX</span></span></span><br></div><label class="goal-separator" for="Composition-v-chkcf"><hr></label><div class="goal-conclusion">finite_valid_trace_from
  (preloaded_vlsm (IM i) (<span class="kr">Œª</span> <span class="nv">_</span> : message, <span class="kt">False</span>)) sX
  trX</div></blockquote></div></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="Composition-v-chkd0" style="display: none" type="checkbox"><label class="alectryon-input" for="Composition-v-chkd0">-</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>message, index</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>EqDecision0</var><span class="hyp-type"><b>: </b><span>EqDecision index</span></span></span><br><span><var>IM</var><span class="hyp-type"><b>: </b><span>index ‚Üí VLSM message</span></span></span><br><span><var>i</var><span class="hyp-type"><b>: </b><span>index</span></span></span><br><span><var>cs</var><span class="hyp-type"><b>: </b><span>composite_state</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>valid_state_prop free_composite_vlsm cs</span></span></span><br><span><var>sX</var><span class="hyp-type"><b>: </b><span>state (IM i)</span></span></span><br><span><var>trX</var><span class="hyp-type"><b>: </b><span>list transition_item</span></span></span><br><span><var>H0</var><span class="hyp-type"><b>: </b><span>finite_valid_trace_from (IM i) sX trX</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">valid_state_prop
  (preloaded_vlsm free_composite_vlsm
     (<span class="kr">Œª</span> <span class="nv">_</span> : message, <span class="kt">False</span>)) cs</div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="bp">by</span> <span class="nb">apply</span> (VLSM_eq_valid_state (vlsm_is_preloaded_with_False free_composite_vlsm)).</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="Composition-v-chkd1" style="display: none" type="checkbox"><label class="alectryon-input" for="Composition-v-chkd1">-</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>message, index</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>EqDecision0</var><span class="hyp-type"><b>: </b><span>EqDecision index</span></span></span><br><span><var>IM</var><span class="hyp-type"><b>: </b><span>index ‚Üí VLSM message</span></span></span><br><span><var>i</var><span class="hyp-type"><b>: </b><span>index</span></span></span><br><span><var>cs</var><span class="hyp-type"><b>: </b><span>composite_state</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>valid_state_prop free_composite_vlsm cs</span></span></span><br><span><var>sX</var><span class="hyp-type"><b>: </b><span>state (IM i)</span></span></span><br><span><var>trX</var><span class="hyp-type"><b>: </b><span>list transition_item</span></span></span><br><span><var>H0</var><span class="hyp-type"><b>: </b><span>finite_valid_trace_from (IM i) sX trX</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">finite_valid_trace_from
  (preloaded_vlsm (IM i) (<span class="kr">Œª</span> <span class="nv">_</span> : message, <span class="kt">False</span>)) sX
  trX</div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="Composition-v-chkd2" style="display: none" type="checkbox"><label class="alectryon-input" for="Composition-v-chkd2"><span class="nb">apply</span> (VLSM_eq_finite_valid_trace_from (vlsm_is_preloaded_with_False (IM i))).</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>message, index</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>EqDecision0</var><span class="hyp-type"><b>: </b><span>EqDecision index</span></span></span><br><span><var>IM</var><span class="hyp-type"><b>: </b><span>index ‚Üí VLSM message</span></span></span><br><span><var>i</var><span class="hyp-type"><b>: </b><span>index</span></span></span><br><span><var>cs</var><span class="hyp-type"><b>: </b><span>composite_state</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>valid_state_prop free_composite_vlsm cs</span></span></span><br><span><var>sX</var><span class="hyp-type"><b>: </b><span>state (IM i)</span></span></span><br><span><var>trX</var><span class="hyp-type"><b>: </b><span>list transition_item</span></span></span><br><span><var>H0</var><span class="hyp-type"><b>: </b><span>finite_valid_trace_from (IM i) sX trX</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">finite_valid_trace_from
  {| vlsm_type := IM i; vlsm_machine := IM i |} sX trX</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><span class="alectryon-input"><span class="bp">by</span> <span class="nb">destruct</span> (IM i).</span><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Qed</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
</span><span class="alectryon-sentence"><input class="alectryon-toggle" id="Composition-v-chkd3" style="display: none" type="checkbox"><label class="alectryon-input" for="Composition-v-chkd3"><span class="kn">Lemma</span> <span class="nf">lift_to_preloaded_free_weak_embedding</span> :
  <span class="kr">forall</span> (<span class="nv">i</span> : index) (<span class="nv">cs</span> : composite_state),
    constrained_state_prop free_composite_vlsm cs -&gt;
    VLSM_weak_embedding
      (preloaded_with_all_messages_vlsm (IM i))
      (preloaded_with_all_messages_vlsm free_composite_vlsm)
      (lift_to_composite_label i)
      (lift_to_composite_state cs i).</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>message, index</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>EqDecision0</var><span class="hyp-type"><b>: </b><span>EqDecision index</span></span></span><br><span><var>IM</var><span class="hyp-type"><b>: </b><span>index ‚Üí VLSM message</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="kr">‚àÄ</span> (<span class="nv">i</span> : index) (<span class="nv">cs</span> : composite_state),
  constrained_state_prop free_composite_vlsm cs
  ‚Üí VLSM_weak_embedding
      (preloaded_with_all_messages_vlsm (IM i))
      (preloaded_with_all_messages_vlsm
         free_composite_vlsm)
      (lift_to_composite_label i)
      (lift_to_composite_state cs i)</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="Composition-v-chkd4" style="display: none" type="checkbox"><label class="alectryon-input" for="Composition-v-chkd4"><span class="kn">Proof</span>.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>message, index</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>EqDecision0</var><span class="hyp-type"><b>: </b><span>EqDecision index</span></span></span><br><span><var>IM</var><span class="hyp-type"><b>: </b><span>index ‚Üí VLSM message</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="kr">‚àÄ</span> (<span class="nv">i</span> : index) (<span class="nv">cs</span> : composite_state),
  constrained_state_prop free_composite_vlsm cs
  ‚Üí VLSM_weak_embedding
      (preloaded_with_all_messages_vlsm (IM i))
      (preloaded_with_all_messages_vlsm
         free_composite_vlsm)
      (lift_to_composite_label i)
      (lift_to_composite_state cs i)</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="Composition-v-chkd5" style="display: none" type="checkbox"><label class="alectryon-input" for="Composition-v-chkd5"><span class="nb">constructor</span>; <span class="nb">intros</span>.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>message, index</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>EqDecision0</var><span class="hyp-type"><b>: </b><span>EqDecision index</span></span></span><br><span><var>IM</var><span class="hyp-type"><b>: </b><span>index ‚Üí VLSM message</span></span></span><br><span><var>i</var><span class="hyp-type"><b>: </b><span>index</span></span></span><br><span><var>cs</var><span class="hyp-type"><b>: </b><span>composite_state</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>constrained_state_prop free_composite_vlsm cs</span></span></span><br><span><var>sX</var><span class="hyp-type"><b>: </b><span>state (preloaded_with_all_messages_vlsm (IM i))</span></span></span><br><span><var>trX</var><span class="hyp-type"><b>: </b><span>list transition_item</span></span></span><br><span><var>H0</var><span class="hyp-type"><b>: </b><span>finite_valid_trace_from
  (preloaded_with_all_messages_vlsm (IM i)) sX
  trX</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">finite_valid_trace_from
  (preloaded_with_all_messages_vlsm
     free_composite_vlsm)
  (lift_to_composite_state cs i sX)
  (pre_VLSM_embedding_finite_trace_project
     (preloaded_with_all_messages_vlsm (IM i))
     (preloaded_with_all_messages_vlsm
        free_composite_vlsm)
     (lift_to_composite_label i)
     (lift_to_composite_state cs i) trX)</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="Composition-v-chkd6" style="display: none" type="checkbox"><label class="alectryon-input" for="Composition-v-chkd6"><span class="nb">apply</span> pre_lift_to_free_weak_embedding; [<span class="bp">done</span> |].</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>message, index</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>EqDecision0</var><span class="hyp-type"><b>: </b><span>EqDecision index</span></span></span><br><span><var>IM</var><span class="hyp-type"><b>: </b><span>index ‚Üí VLSM message</span></span></span><br><span><var>i</var><span class="hyp-type"><b>: </b><span>index</span></span></span><br><span><var>cs</var><span class="hyp-type"><b>: </b><span>composite_state</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>constrained_state_prop free_composite_vlsm cs</span></span></span><br><span><var>sX</var><span class="hyp-type"><b>: </b><span>state (preloaded_with_all_messages_vlsm (IM i))</span></span></span><br><span><var>trX</var><span class="hyp-type"><b>: </b><span>list transition_item</span></span></span><br><span><var>H0</var><span class="hyp-type"><b>: </b><span>finite_valid_trace_from
  (preloaded_with_all_messages_vlsm (IM i)) sX
  trX</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">finite_valid_trace_from
  (preloaded_vlsm (IM i) (<span class="kr">Œª</span> <span class="nv">_</span> : message, <span class="kt">True</span>)) sX trX</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><span class="alectryon-input"><span class="bp">by</span> <span class="nb">destruct</span> (IM i).</span><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Qed</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
</span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">End</span> <span class="nf">sec_VLSM_composition</span>.</span></span></pre><div class="doc">
<a id="lab6"></a><h2 class="section">A tactic for working with the state_update function</h2>
<div class="paragraph"> </div>

  Hint database and tactic for dealing with updates and lifting via <span class="inlinecode"><span class="id" title="var">state_update</span></span>.

</div><pre class="alectryon-io highlight"><!-- Generator: Alectryon --><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Create HintDb</span> state_update.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
</span><span class="alectryon-sentence"><span class="alectryon-input">#[export] <span class="kn">Hint Rewrite</span> @state_update_neq <span class="nb">using</span> <span class="bp">done</span> : state_update.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><span class="alectryon-input">#[export] <span class="kn">Hint Rewrite</span> @state_update_id <span class="nb">using</span> <span class="bp">done</span> : state_update.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><span class="alectryon-input">#[export] <span class="kn">Hint Rewrite</span> @state_update_eq : state_update.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
</span><span class="alectryon-sentence"><span class="alectryon-input">#[export] <span class="kn">Hint Unfold</span> lift_to_composite_state : state_update.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><span class="alectryon-input">#[export] <span class="kn">Hint Unfold</span> lift_to_composite_state&#39; : state_update.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
</span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Ltac</span> <span class="nf">state_update_simpl</span> :=
  <span class="nb">autounfold with</span> state_update <span class="kr">in</span> *; <span class="nb">autorewrite with</span> state_update <span class="kr">in</span> *.</span></span></pre><div class="doc">
<a id="lab7"></a><h2 class="section">Basic projection lemmas</h2>
<div class="paragraph"> </div>

  These basic projection lemmas relate
  the <span class="inlinecode"><span class="id" title="var">valid_state_prop</span></span> and <span class="inlinecode"><span class="id" title="var">input_valid_transition</span></span> of
  a composite VLSM back to those conditions holding
  over projections to individual components of the state.

<div class="paragraph"> </div>

  Because the composition may have validly produced
  messages that are not valid for an individual
  component (by interaction between components),
  We cannot just use properties <span class="inlinecode"><span class="id" title="var">valid_state_message_prop</span></span> <span class="inlinecode">(<span class="id" title="var">IM</span></span> <span class="inlinecode"><span class="id" title="var">i</span>)</span>
  or <span class="inlinecode"><span class="id" title="var">input_valid_transition</span></span> <span class="inlinecode">(<span class="id" title="var">IM</span></span> <span class="inlinecode"><span class="id" title="var">i</span>)</span>.
  For simplicity these lemmas use
  <span class="inlinecode"><span class="id" title="var">preloaded_with_all_messages_vlsm</span></span> <span class="inlinecode">(<span class="id" title="var">IM</span></span> <span class="inlinecode"><span class="id" title="var">i</span>)</span>.

<div class="paragraph"> </div>

  This does not precisely reflect the set of
  messages and transitions that can actually be
  seen in projections of transitions of the composite VLSM,
  but seems to be the best we can do with a result
  type that doesn't mention the other components or
  the composition constraint of the composite.

<div class="paragraph"> </div>

  Later in this file a
  <span class="inlinecode"><span class="id" title="var">composite_constrained_projection_vlsm</span></span> is defined
  that shares the states of <span class="inlinecode"><span class="id" title="var">IM</span></span> <span class="inlinecode"><span class="id" title="var">i</span></span> which is more
  precise.

</div><pre class="alectryon-io highlight"><!-- Generator: Alectryon --></pre><div class="doc">
  We call a <span class="inlinecode"><span class="id" title="var">composite_state</span></span> constrained if it is constrained for the
  <span class="inlinecode"><span class="id" title="var">free_composite_vlsm</span></span>.

</div><pre class="alectryon-io highlight"><!-- Generator: Alectryon --><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Definition</span> <span class="nf">composite_constrained_state_prop</span>
  {<span class="nv">message</span> : <span class="kt">Type</span>} `{EqDecision index}
  (IM : index -&gt; VLSM message) (s : composite_state IM) : <span class="kt">Prop</span> :=
    constrained_state_prop (free_composite_vlsm IM) s.</span></span></pre><div class="doc">
If a composite state is constrained, so are all of its component states. 
</div><pre class="alectryon-io highlight"><!-- Generator: Alectryon --><span class="alectryon-sentence"><input class="alectryon-toggle" id="Composition-v-chkd7" style="display: none" type="checkbox"><label class="alectryon-input" for="Composition-v-chkd7"><span class="kn">Lemma</span> <span class="nf">composite_constrained_state_project</span>
  {<span class="nv">message</span> : <span class="kt">Type</span>} `{EqDecision index} (IM : index -&gt; VLSM message)
  (s : composite_state IM) i :
    composite_constrained_state_prop IM s -&gt;
    constrained_state_prop (IM i) (s i).</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>message, index</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>EqDecision0</var><span class="hyp-type"><b>: </b><span>EqDecision index</span></span></span><br><span><var>IM</var><span class="hyp-type"><b>: </b><span>index ‚Üí VLSM message</span></span></span><br><span><var>s</var><span class="hyp-type"><b>: </b><span>composite_state IM</span></span></span><br><span><var>i</var><span class="hyp-type"><b>: </b><span>index</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">composite_constrained_state_prop IM s
‚Üí constrained_state_prop (IM i) (s i)</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="Composition-v-chkd8" style="display: none" type="checkbox"><label class="alectryon-input" for="Composition-v-chkd8"><span class="kn">Proof</span>.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>message, index</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>EqDecision0</var><span class="hyp-type"><b>: </b><span>EqDecision index</span></span></span><br><span><var>IM</var><span class="hyp-type"><b>: </b><span>index ‚Üí VLSM message</span></span></span><br><span><var>s</var><span class="hyp-type"><b>: </b><span>composite_state IM</span></span></span><br><span><var>i</var><span class="hyp-type"><b>: </b><span>index</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">composite_constrained_state_prop IM s
‚Üí constrained_state_prop (IM i) (s i)</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="Composition-v-chkd9" style="display: none" type="checkbox"><label class="alectryon-input" for="Composition-v-chkd9"><span class="nb">intros</span> [om Hproto].</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>message, index</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>EqDecision0</var><span class="hyp-type"><b>: </b><span>EqDecision index</span></span></span><br><span><var>IM</var><span class="hyp-type"><b>: </b><span>index ‚Üí VLSM message</span></span></span><br><span><var>s</var><span class="hyp-type"><b>: </b><span>composite_state IM</span></span></span><br><span><var>i</var><span class="hyp-type"><b>: </b><span>index</span></span></span><br><span><var>om</var><span class="hyp-type"><b>: </b><span>option message</span></span></span><br><span><var>Hproto</var><span class="hyp-type"><b>: </b><span>valid_state_message_prop
  (preloaded_with_all_messages_vlsm
     (free_composite_vlsm IM)) s om</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">constrained_state_prop (IM i) (s i)</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="Composition-v-chkda" style="display: none" type="checkbox"><label class="alectryon-input" for="Composition-v-chkda"><span class="nb">induction</span> Hproto; [<span class="bp">by</span> <span class="nb">apply</span> initial_state_is_valid; <span class="nb">cbn</span> |].</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>message, index</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>EqDecision0</var><span class="hyp-type"><b>: </b><span>EqDecision index</span></span></span><br><span><var>IM</var><span class="hyp-type"><b>: </b><span>index ‚Üí VLSM message</span></span></span><br><span><var>i</var><span class="hyp-type"><b>: </b><span>index</span></span></span><br><span><var>s</var><span class="hyp-type"><b>: </b><span>state
  (preloaded_with_all_messages_vlsm
     (free_composite_vlsm IM))</span></span></span><br><span><var>_om</var><span class="hyp-type"><b>: </b><span>option message</span></span></span><br><span><var>Hproto1</var><span class="hyp-type"><b>: </b><span>valid_state_message_prop
  (preloaded_with_all_messages_vlsm
     (free_composite_vlsm IM)) s _om</span></span></span><br><span><var>_s</var><span class="hyp-type"><b>: </b><span>state
  (preloaded_with_all_messages_vlsm
     (free_composite_vlsm IM))</span></span></span><br><span><var>om</var><span class="hyp-type"><b>: </b><span>option message</span></span></span><br><span><var>Hproto2</var><span class="hyp-type"><b>: </b><span>valid_state_message_prop
  (preloaded_with_all_messages_vlsm
     (free_composite_vlsm IM)) _s om</span></span></span><br><span><var>l</var><span class="hyp-type"><b>: </b><span>label
  (preloaded_with_all_messages_vlsm
     (free_composite_vlsm IM))</span></span></span><br><span><var>Hv</var><span class="hyp-type"><b>: </b><span>valid l (s, om)</span></span></span><br><span><var>s'</var><span class="hyp-type"><b>: </b><span>state
  (preloaded_with_all_messages_vlsm
     (free_composite_vlsm IM))</span></span></span><br><span><var>om'</var><span class="hyp-type"><b>: </b><span>option message</span></span></span><br><span><var>Ht</var><span class="hyp-type"><b>: </b><span>transition l (s, om) = (s&#39;, om&#39;)</span></span></span><br><span><var>IHHproto1</var><span class="hyp-type"><b>: </b><span>constrained_state_prop (IM i) (s i)</span></span></span><br><span><var>IHHproto2</var><span class="hyp-type"><b>: </b><span>constrained_state_prop (IM i) (_s i)</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">constrained_state_prop (IM i) (s&#39; i)</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="Composition-v-chkdb" style="display: none" type="checkbox"><label class="alectryon-input" for="Composition-v-chkdb"><span class="nb">destruct</span> l <span class="kr">as</span> [j lj]; <span class="nb">cbn</span> <span class="kr">in</span> Ht, Hv.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>message, index</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>EqDecision0</var><span class="hyp-type"><b>: </b><span>EqDecision index</span></span></span><br><span><var>IM</var><span class="hyp-type"><b>: </b><span>index ‚Üí VLSM message</span></span></span><br><span><var>i</var><span class="hyp-type"><b>: </b><span>index</span></span></span><br><span><var>s</var><span class="hyp-type"><b>: </b><span>state
  (preloaded_with_all_messages_vlsm
     (free_composite_vlsm IM))</span></span></span><br><span><var>_om</var><span class="hyp-type"><b>: </b><span>option message</span></span></span><br><span><var>Hproto1</var><span class="hyp-type"><b>: </b><span>valid_state_message_prop
  (preloaded_with_all_messages_vlsm
     (free_composite_vlsm IM)) s _om</span></span></span><br><span><var>_s</var><span class="hyp-type"><b>: </b><span>state
  (preloaded_with_all_messages_vlsm
     (free_composite_vlsm IM))</span></span></span><br><span><var>om</var><span class="hyp-type"><b>: </b><span>option message</span></span></span><br><span><var>Hproto2</var><span class="hyp-type"><b>: </b><span>valid_state_message_prop
  (preloaded_with_all_messages_vlsm
     (free_composite_vlsm IM)) _s om</span></span></span><br><span><var>j</var><span class="hyp-type"><b>: </b><span>index</span></span></span><br><span><var>lj</var><span class="hyp-type"><b>: </b><span>label (IM j)</span></span></span><br><span><var>Hv</var><span class="hyp-type"><b>: </b><span>valid lj (s j, om)</span></span></span><br><span><var>s'</var><span class="hyp-type"><b>: </b><span>state
  (preloaded_with_all_messages_vlsm
     (free_composite_vlsm IM))</span></span></span><br><span><var>om'</var><span class="hyp-type"><b>: </b><span>option message</span></span></span><br><span><var>Ht</var><span class="hyp-type"><b>: </b><span>(<span class="kr">let</span> (<span class="nv">si&#39;</span>, om&#39;) := transition lj (s j, om) <span class="kr">in</span>
 (state_update IM s j si&#39;, om&#39;)) = (
s&#39;, om&#39;)</span></span></span><br><span><var>IHHproto1</var><span class="hyp-type"><b>: </b><span>constrained_state_prop (IM i) (s i)</span></span></span><br><span><var>IHHproto2</var><span class="hyp-type"><b>: </b><span>constrained_state_prop (IM i) (_s i)</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">constrained_state_prop (IM i) (s&#39; i)</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="Composition-v-chkdc" style="display: none" type="checkbox"><label class="alectryon-input" for="Composition-v-chkdc"><span class="nb">destruct</span> (transition lj (s j, om)) <span class="nb">eqn</span>: Heq.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>message, index</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>EqDecision0</var><span class="hyp-type"><b>: </b><span>EqDecision index</span></span></span><br><span><var>IM</var><span class="hyp-type"><b>: </b><span>index ‚Üí VLSM message</span></span></span><br><span><var>i</var><span class="hyp-type"><b>: </b><span>index</span></span></span><br><span><var>s</var><span class="hyp-type"><b>: </b><span>state
  (preloaded_with_all_messages_vlsm
     (free_composite_vlsm IM))</span></span></span><br><span><var>_om</var><span class="hyp-type"><b>: </b><span>option message</span></span></span><br><span><var>Hproto1</var><span class="hyp-type"><b>: </b><span>valid_state_message_prop
  (preloaded_with_all_messages_vlsm
     (free_composite_vlsm IM)) s _om</span></span></span><br><span><var>_s</var><span class="hyp-type"><b>: </b><span>state
  (preloaded_with_all_messages_vlsm
     (free_composite_vlsm IM))</span></span></span><br><span><var>om</var><span class="hyp-type"><b>: </b><span>option message</span></span></span><br><span><var>Hproto2</var><span class="hyp-type"><b>: </b><span>valid_state_message_prop
  (preloaded_with_all_messages_vlsm
     (free_composite_vlsm IM)) _s om</span></span></span><br><span><var>j</var><span class="hyp-type"><b>: </b><span>index</span></span></span><br><span><var>lj</var><span class="hyp-type"><b>: </b><span>label (IM j)</span></span></span><br><span><var>Hv</var><span class="hyp-type"><b>: </b><span>valid lj (s j, om)</span></span></span><br><span><var>s'</var><span class="hyp-type"><b>: </b><span>state
  (preloaded_with_all_messages_vlsm
     (free_composite_vlsm IM))</span></span></span><br><span><var>om'</var><span class="hyp-type"><b>: </b><span>option message</span></span></span><br><span><var>s0</var><span class="hyp-type"><b>: </b><span>state (IM j)</span></span></span><br><span><var>o</var><span class="hyp-type"><b>: </b><span>option message</span></span></span><br><span><var>Heq</var><span class="hyp-type"><b>: </b><span>transition lj (s j, om) = (s0, o)</span></span></span><br><span><var>Ht</var><span class="hyp-type"><b>: </b><span>(state_update IM s j s0, o) = (s&#39;, om&#39;)</span></span></span><br><span><var>IHHproto1</var><span class="hyp-type"><b>: </b><span>constrained_state_prop (IM i) (s i)</span></span></span><br><span><var>IHHproto2</var><span class="hyp-type"><b>: </b><span>constrained_state_prop (IM i) (_s i)</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">constrained_state_prop (IM i) (s&#39; i)</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="Composition-v-chkdd" style="display: none" type="checkbox"><label class="alectryon-input" for="Composition-v-chkdd"><span class="nb">inversion</span> Ht; <span class="nb">subst</span>; <span class="nb">clear</span> Ht.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>message, index</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>EqDecision0</var><span class="hyp-type"><b>: </b><span>EqDecision index</span></span></span><br><span><var>IM</var><span class="hyp-type"><b>: </b><span>index ‚Üí VLSM message</span></span></span><br><span><var>i</var><span class="hyp-type"><b>: </b><span>index</span></span></span><br><span><var>s</var><span class="hyp-type"><b>: </b><span>state
  (preloaded_with_all_messages_vlsm
     (free_composite_vlsm IM))</span></span></span><br><span><var>_om</var><span class="hyp-type"><b>: </b><span>option message</span></span></span><br><span><var>Hproto1</var><span class="hyp-type"><b>: </b><span>valid_state_message_prop
  (preloaded_with_all_messages_vlsm
     (free_composite_vlsm IM)) s _om</span></span></span><br><span><var>_s</var><span class="hyp-type"><b>: </b><span>state
  (preloaded_with_all_messages_vlsm
     (free_composite_vlsm IM))</span></span></span><br><span><var>om</var><span class="hyp-type"><b>: </b><span>option message</span></span></span><br><span><var>Hproto2</var><span class="hyp-type"><b>: </b><span>valid_state_message_prop
  (preloaded_with_all_messages_vlsm
     (free_composite_vlsm IM)) _s om</span></span></span><br><span><var>j</var><span class="hyp-type"><b>: </b><span>index</span></span></span><br><span><var>lj</var><span class="hyp-type"><b>: </b><span>label (IM j)</span></span></span><br><span><var>Hv</var><span class="hyp-type"><b>: </b><span>valid lj (s j, om)</span></span></span><br><span><var>om'</var><span class="hyp-type"><b>: </b><span>option message</span></span></span><br><span><var>s0</var><span class="hyp-type"><b>: </b><span>state (IM j)</span></span></span><br><span><var>Heq</var><span class="hyp-type"><b>: </b><span>transition lj (s j, om) = (s0, om&#39;)</span></span></span><br><span><var>IHHproto1</var><span class="hyp-type"><b>: </b><span>constrained_state_prop (IM i) (s i)</span></span></span><br><span><var>IHHproto2</var><span class="hyp-type"><b>: </b><span>constrained_state_prop (IM i) (_s i)</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">constrained_state_prop (IM i)
  (state_update IM s j s0 i)</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="Composition-v-chkde" style="display: none" type="checkbox"><label class="alectryon-input" for="Composition-v-chkde"><span class="nb">destruct</span> (decide (j = i)); <span class="nb">subst</span>; state_update_simpl; [| <span class="bp">done</span>].</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>message, index</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>EqDecision0</var><span class="hyp-type"><b>: </b><span>EqDecision index</span></span></span><br><span><var>IM</var><span class="hyp-type"><b>: </b><span>index ‚Üí VLSM message</span></span></span><br><span><var>i</var><span class="hyp-type"><b>: </b><span>index</span></span></span><br><span><var>s</var><span class="hyp-type"><b>: </b><span>state
  (preloaded_with_all_messages_vlsm
     (free_composite_vlsm IM))</span></span></span><br><span><var>_om</var><span class="hyp-type"><b>: </b><span>option message</span></span></span><br><span><var>Hproto1</var><span class="hyp-type"><b>: </b><span>valid_state_message_prop
  (preloaded_with_all_messages_vlsm
     (free_composite_vlsm IM)) s _om</span></span></span><br><span><var>_s</var><span class="hyp-type"><b>: </b><span>state
  (preloaded_with_all_messages_vlsm
     (free_composite_vlsm IM))</span></span></span><br><span><var>om</var><span class="hyp-type"><b>: </b><span>option message</span></span></span><br><span><var>Hproto2</var><span class="hyp-type"><b>: </b><span>valid_state_message_prop
  (preloaded_with_all_messages_vlsm
     (free_composite_vlsm IM)) _s om</span></span></span><br><span><var>lj</var><span class="hyp-type"><b>: </b><span>label (IM i)</span></span></span><br><span><var>Hv</var><span class="hyp-type"><b>: </b><span>valid lj (s i, om)</span></span></span><br><span><var>om'</var><span class="hyp-type"><b>: </b><span>option message</span></span></span><br><span><var>s0</var><span class="hyp-type"><b>: </b><span>state (IM i)</span></span></span><br><span><var>Heq</var><span class="hyp-type"><b>: </b><span>transition lj (s i, om) = (s0, om&#39;)</span></span></span><br><span><var>IHHproto1</var><span class="hyp-type"><b>: </b><span>constrained_state_prop (IM i) (s i)</span></span></span><br><span><var>IHHproto2</var><span class="hyp-type"><b>: </b><span>constrained_state_prop (IM i) (_s i)</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">constrained_state_prop (IM i) s0</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="Composition-v-chkdf" style="display: none" type="checkbox"><label class="alectryon-input" for="Composition-v-chkdf"><span class="nb">destruct</span> IHHproto1 <span class="kr">as</span> [om&#39;&#39; Hovmp].</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>message, index</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>EqDecision0</var><span class="hyp-type"><b>: </b><span>EqDecision index</span></span></span><br><span><var>IM</var><span class="hyp-type"><b>: </b><span>index ‚Üí VLSM message</span></span></span><br><span><var>i</var><span class="hyp-type"><b>: </b><span>index</span></span></span><br><span><var>s</var><span class="hyp-type"><b>: </b><span>state
  (preloaded_with_all_messages_vlsm
     (free_composite_vlsm IM))</span></span></span><br><span><var>_om</var><span class="hyp-type"><b>: </b><span>option message</span></span></span><br><span><var>Hproto1</var><span class="hyp-type"><b>: </b><span>valid_state_message_prop
  (preloaded_with_all_messages_vlsm
     (free_composite_vlsm IM)) s _om</span></span></span><br><span><var>_s</var><span class="hyp-type"><b>: </b><span>state
  (preloaded_with_all_messages_vlsm
     (free_composite_vlsm IM))</span></span></span><br><span><var>om</var><span class="hyp-type"><b>: </b><span>option message</span></span></span><br><span><var>Hproto2</var><span class="hyp-type"><b>: </b><span>valid_state_message_prop
  (preloaded_with_all_messages_vlsm
     (free_composite_vlsm IM)) _s om</span></span></span><br><span><var>lj</var><span class="hyp-type"><b>: </b><span>label (IM i)</span></span></span><br><span><var>Hv</var><span class="hyp-type"><b>: </b><span>valid lj (s i, om)</span></span></span><br><span><var>om'</var><span class="hyp-type"><b>: </b><span>option message</span></span></span><br><span><var>s0</var><span class="hyp-type"><b>: </b><span>state (IM i)</span></span></span><br><span><var>Heq</var><span class="hyp-type"><b>: </b><span>transition lj (s i, om) = (s0, om&#39;)</span></span></span><br><span><var>om''</var><span class="hyp-type"><b>: </b><span>option message</span></span></span><br><span><var>Hovmp</var><span class="hyp-type"><b>: </b><span>valid_state_message_prop
  (preloaded_with_all_messages_vlsm (IM i))
  (s i) om&#39;&#39;</span></span></span><br><span><var>IHHproto2</var><span class="hyp-type"><b>: </b><span>constrained_state_prop (IM i) (_s i)</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">constrained_state_prop (IM i) s0</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="Composition-v-chke0" style="display: none" type="checkbox"><label class="alectryon-input" for="Composition-v-chke0"><span class="kr">exists</span> <span class="nv">om&#39;</span>.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>message, index</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>EqDecision0</var><span class="hyp-type"><b>: </b><span>EqDecision index</span></span></span><br><span><var>IM</var><span class="hyp-type"><b>: </b><span>index ‚Üí VLSM message</span></span></span><br><span><var>i</var><span class="hyp-type"><b>: </b><span>index</span></span></span><br><span><var>s</var><span class="hyp-type"><b>: </b><span>state
  (preloaded_with_all_messages_vlsm
     (free_composite_vlsm IM))</span></span></span><br><span><var>_om</var><span class="hyp-type"><b>: </b><span>option message</span></span></span><br><span><var>Hproto1</var><span class="hyp-type"><b>: </b><span>valid_state_message_prop
  (preloaded_with_all_messages_vlsm
     (free_composite_vlsm IM)) s _om</span></span></span><br><span><var>_s</var><span class="hyp-type"><b>: </b><span>state
  (preloaded_with_all_messages_vlsm
     (free_composite_vlsm IM))</span></span></span><br><span><var>om</var><span class="hyp-type"><b>: </b><span>option message</span></span></span><br><span><var>Hproto2</var><span class="hyp-type"><b>: </b><span>valid_state_message_prop
  (preloaded_with_all_messages_vlsm
     (free_composite_vlsm IM)) _s om</span></span></span><br><span><var>lj</var><span class="hyp-type"><b>: </b><span>label (IM i)</span></span></span><br><span><var>Hv</var><span class="hyp-type"><b>: </b><span>valid lj (s i, om)</span></span></span><br><span><var>om'</var><span class="hyp-type"><b>: </b><span>option message</span></span></span><br><span><var>s0</var><span class="hyp-type"><b>: </b><span>state (IM i)</span></span></span><br><span><var>Heq</var><span class="hyp-type"><b>: </b><span>transition lj (s i, om) = (s0, om&#39;)</span></span></span><br><span><var>om''</var><span class="hyp-type"><b>: </b><span>option message</span></span></span><br><span><var>Hovmp</var><span class="hyp-type"><b>: </b><span>valid_state_message_prop
  (preloaded_with_all_messages_vlsm (IM i))
  (s i) om&#39;&#39;</span></span></span><br><span><var>IHHproto2</var><span class="hyp-type"><b>: </b><span>constrained_state_prop (IM i) (_s i)</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">valid_state_message_prop
  (preloaded_with_all_messages_vlsm (IM i)) s0 om&#39;</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="Composition-v-chke1" style="display: none" type="checkbox"><label class="alectryon-input" for="Composition-v-chke1"><span class="nb">eapply</span> input_valid_transition_outputs_valid_state_message.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>message, index</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>EqDecision0</var><span class="hyp-type"><b>: </b><span>EqDecision index</span></span></span><br><span><var>IM</var><span class="hyp-type"><b>: </b><span>index ‚Üí VLSM message</span></span></span><br><span><var>i</var><span class="hyp-type"><b>: </b><span>index</span></span></span><br><span><var>s</var><span class="hyp-type"><b>: </b><span>state
  (preloaded_with_all_messages_vlsm
     (free_composite_vlsm IM))</span></span></span><br><span><var>_om</var><span class="hyp-type"><b>: </b><span>option message</span></span></span><br><span><var>Hproto1</var><span class="hyp-type"><b>: </b><span>valid_state_message_prop
  (preloaded_with_all_messages_vlsm
     (free_composite_vlsm IM)) s _om</span></span></span><br><span><var>_s</var><span class="hyp-type"><b>: </b><span>state
  (preloaded_with_all_messages_vlsm
     (free_composite_vlsm IM))</span></span></span><br><span><var>om</var><span class="hyp-type"><b>: </b><span>option message</span></span></span><br><span><var>Hproto2</var><span class="hyp-type"><b>: </b><span>valid_state_message_prop
  (preloaded_with_all_messages_vlsm
     (free_composite_vlsm IM)) _s om</span></span></span><br><span><var>lj</var><span class="hyp-type"><b>: </b><span>label (IM i)</span></span></span><br><span><var>Hv</var><span class="hyp-type"><b>: </b><span>valid lj (s i, om)</span></span></span><br><span><var>om'</var><span class="hyp-type"><b>: </b><span>option message</span></span></span><br><span><var>s0</var><span class="hyp-type"><b>: </b><span>state (IM i)</span></span></span><br><span><var>Heq</var><span class="hyp-type"><b>: </b><span>transition lj (s i, om) = (s0, om&#39;)</span></span></span><br><span><var>om''</var><span class="hyp-type"><b>: </b><span>option message</span></span></span><br><span><var>Hovmp</var><span class="hyp-type"><b>: </b><span>valid_state_message_prop
  (preloaded_with_all_messages_vlsm (IM i))
  (s i) om&#39;&#39;</span></span></span><br><span><var>IHHproto2</var><span class="hyp-type"><b>: </b><span>constrained_state_prop (IM i) (_s i)</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">input_valid_transition
  (preloaded_with_all_messages_vlsm (IM i)) <span class="nl">?l</span>
  (<span class="nl">?s</span>, <span class="nl">?om</span>) (s0, om&#39;)</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="Composition-v-chke2" style="display: none" type="checkbox"><label class="alectryon-input" for="Composition-v-chke2"><span class="kp">repeat</span> <span class="nb">split</span>; [<span class="bp">by</span> <span class="kr">exists</span> <span class="nv">om&#39;&#39;</span> | | <span class="bp">done</span>..].</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>message, index</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>EqDecision0</var><span class="hyp-type"><b>: </b><span>EqDecision index</span></span></span><br><span><var>IM</var><span class="hyp-type"><b>: </b><span>index ‚Üí VLSM message</span></span></span><br><span><var>i</var><span class="hyp-type"><b>: </b><span>index</span></span></span><br><span><var>s</var><span class="hyp-type"><b>: </b><span>state
  (preloaded_with_all_messages_vlsm
     (free_composite_vlsm IM))</span></span></span><br><span><var>_om</var><span class="hyp-type"><b>: </b><span>option message</span></span></span><br><span><var>Hproto1</var><span class="hyp-type"><b>: </b><span>valid_state_message_prop
  (preloaded_with_all_messages_vlsm
     (free_composite_vlsm IM)) s _om</span></span></span><br><span><var>_s</var><span class="hyp-type"><b>: </b><span>state
  (preloaded_with_all_messages_vlsm
     (free_composite_vlsm IM))</span></span></span><br><span><var>om</var><span class="hyp-type"><b>: </b><span>option message</span></span></span><br><span><var>Hproto2</var><span class="hyp-type"><b>: </b><span>valid_state_message_prop
  (preloaded_with_all_messages_vlsm
     (free_composite_vlsm IM)) _s om</span></span></span><br><span><var>lj</var><span class="hyp-type"><b>: </b><span>label (IM i)</span></span></span><br><span><var>Hv</var><span class="hyp-type"><b>: </b><span>valid lj (s i, om)</span></span></span><br><span><var>om'</var><span class="hyp-type"><b>: </b><span>option message</span></span></span><br><span><var>s0</var><span class="hyp-type"><b>: </b><span>state (IM i)</span></span></span><br><span><var>Heq</var><span class="hyp-type"><b>: </b><span>transition lj (s i, om) = (s0, om&#39;)</span></span></span><br><span><var>om''</var><span class="hyp-type"><b>: </b><span>option message</span></span></span><br><span><var>Hovmp</var><span class="hyp-type"><b>: </b><span>valid_state_message_prop
  (preloaded_with_all_messages_vlsm (IM i))
  (s i) om&#39;&#39;</span></span></span><br><span><var>IHHproto2</var><span class="hyp-type"><b>: </b><span>constrained_state_prop (IM i) (_s i)</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">option_valid_message_prop
  (preloaded_with_all_messages_vlsm (IM i)) om</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><span class="alectryon-input"><span class="bp">by</span> <span class="nb">apply</span> any_message_is_valid_in_preloaded.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Qed</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
</span><span class="alectryon-sentence"><input class="alectryon-toggle" id="Composition-v-chke3" style="display: none" type="checkbox"><label class="alectryon-input" for="Composition-v-chke3"><span class="kn">Lemma</span> <span class="nf">valid_state_project_preloaded_to_preloaded</span>
  <span class="nv">message</span> `{EqDecision index} (IM : index -&gt; VLSM message) constraint
  (X := composite_vlsm IM constraint)
  (s : state (preloaded_with_all_messages_vlsm X)) i :
  constrained_state_prop X s -&gt;
  constrained_state_prop (IM i) (s i).</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>message, index</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>EqDecision0</var><span class="hyp-type"><b>: </b><span>EqDecision index</span></span></span><br><span><var>IM</var><span class="hyp-type"><b>: </b><span>index ‚Üí VLSM message</span></span></span><br><span><var>constraint</var><span class="hyp-type"><b>: </b><span>composite_label IM
‚Üí composite_state IM * option message
  ‚Üí <span class="kt">Prop</span></span></span></span><br><span><var>X</var><span><span class="hyp-body"><b>:= </b><span>composite_vlsm IM constraint</span></span><span class="hyp-type"><b>: </b><span>VLSM message</span></span></span></span><br><span><var>s</var><span class="hyp-type"><b>: </b><span>state (preloaded_with_all_messages_vlsm X)</span></span></span><br><span><var>i</var><span class="hyp-type"><b>: </b><span>index</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">constrained_state_prop X s
‚Üí constrained_state_prop (IM i) (s i)</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="Composition-v-chke4" style="display: none" type="checkbox"><label class="alectryon-input" for="Composition-v-chke4"><span class="kn">Proof</span>.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>message, index</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>EqDecision0</var><span class="hyp-type"><b>: </b><span>EqDecision index</span></span></span><br><span><var>IM</var><span class="hyp-type"><b>: </b><span>index ‚Üí VLSM message</span></span></span><br><span><var>constraint</var><span class="hyp-type"><b>: </b><span>composite_label IM
‚Üí composite_state IM * option message
  ‚Üí <span class="kt">Prop</span></span></span></span><br><span><var>X</var><span><span class="hyp-body"><b>:= </b><span>composite_vlsm IM constraint</span></span><span class="hyp-type"><b>: </b><span>VLSM message</span></span></span></span><br><span><var>s</var><span class="hyp-type"><b>: </b><span>state (preloaded_with_all_messages_vlsm X)</span></span></span><br><span><var>i</var><span class="hyp-type"><b>: </b><span>index</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">constrained_state_prop X s
‚Üí constrained_state_prop (IM i) (s i)</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="Composition-v-chke5" style="display: none" type="checkbox"><label class="alectryon-input" for="Composition-v-chke5"><span class="nb">intros</span>.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>message, index</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>EqDecision0</var><span class="hyp-type"><b>: </b><span>EqDecision index</span></span></span><br><span><var>IM</var><span class="hyp-type"><b>: </b><span>index ‚Üí VLSM message</span></span></span><br><span><var>constraint</var><span class="hyp-type"><b>: </b><span>composite_label IM
‚Üí composite_state IM * option message
  ‚Üí <span class="kt">Prop</span></span></span></span><br><span><var>X</var><span><span class="hyp-body"><b>:= </b><span>composite_vlsm IM constraint</span></span><span class="hyp-type"><b>: </b><span>VLSM message</span></span></span></span><br><span><var>s</var><span class="hyp-type"><b>: </b><span>state (preloaded_with_all_messages_vlsm X)</span></span></span><br><span><var>i</var><span class="hyp-type"><b>: </b><span>index</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>constrained_state_prop X s</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">constrained_state_prop (IM i) (s i)</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="Composition-v-chke6" style="display: none" type="checkbox"><label class="alectryon-input" for="Composition-v-chke6"><span class="nb">eapply</span> composite_constrained_state_project.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>message, index</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>EqDecision0</var><span class="hyp-type"><b>: </b><span>EqDecision index</span></span></span><br><span><var>IM</var><span class="hyp-type"><b>: </b><span>index ‚Üí VLSM message</span></span></span><br><span><var>constraint</var><span class="hyp-type"><b>: </b><span>composite_label IM
‚Üí composite_state IM * option message
  ‚Üí <span class="kt">Prop</span></span></span></span><br><span><var>X</var><span><span class="hyp-body"><b>:= </b><span>composite_vlsm IM constraint</span></span><span class="hyp-type"><b>: </b><span>VLSM message</span></span></span></span><br><span><var>s</var><span class="hyp-type"><b>: </b><span>state (preloaded_with_all_messages_vlsm X)</span></span></span><br><span><var>i</var><span class="hyp-type"><b>: </b><span>index</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>constrained_state_prop X s</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">composite_constrained_state_prop IM s</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="Composition-v-chke7" style="display: none" type="checkbox"><label class="alectryon-input" for="Composition-v-chke7"><span class="nb">apply</span> VLSM_incl_valid_state; [| <span class="bp">done</span>].</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>message, index</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>EqDecision0</var><span class="hyp-type"><b>: </b><span>EqDecision index</span></span></span><br><span><var>IM</var><span class="hyp-type"><b>: </b><span>index ‚Üí VLSM message</span></span></span><br><span><var>constraint</var><span class="hyp-type"><b>: </b><span>composite_label IM
‚Üí composite_state IM * option message
  ‚Üí <span class="kt">Prop</span></span></span></span><br><span><var>X</var><span><span class="hyp-body"><b>:= </b><span>composite_vlsm IM constraint</span></span><span class="hyp-type"><b>: </b><span>VLSM message</span></span></span></span><br><span><var>s</var><span class="hyp-type"><b>: </b><span>state (preloaded_with_all_messages_vlsm X)</span></span></span><br><span><var>i</var><span class="hyp-type"><b>: </b><span>index</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>constrained_state_prop X s</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">VLSM_incl_part
  (preloaded_vlsm_machine X (<span class="kr">Œª</span> <span class="nv">_</span> : message, <span class="kt">True</span>))
  (preloaded_vlsm_machine (free_composite_vlsm IM)
     (<span class="kr">Œª</span> <span class="nv">_</span> : message, <span class="kt">True</span>))</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><span class="alectryon-input"><span class="bp">by</span> <span class="nb">apply</span> constrained_preloaded_vlsm_incl_preloaded_with_all_messages.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Qed</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
</span><span class="alectryon-sentence"><input class="alectryon-toggle" id="Composition-v-chke8" style="display: none" type="checkbox"><label class="alectryon-input" for="Composition-v-chke8"><span class="kn">Lemma</span> <span class="nf">valid_state_project_preloaded</span>
      <span class="nv">message</span> `{EqDecision index} (IM : index -&gt; VLSM message) constraint
      (X := composite_vlsm IM constraint)
      (s : state X) i :
  valid_state_prop X s -&gt;
  constrained_state_prop (IM i) (s i).</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>message, index</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>EqDecision0</var><span class="hyp-type"><b>: </b><span>EqDecision index</span></span></span><br><span><var>IM</var><span class="hyp-type"><b>: </b><span>index ‚Üí VLSM message</span></span></span><br><span><var>constraint</var><span class="hyp-type"><b>: </b><span>composite_label IM
‚Üí composite_state IM * option message
  ‚Üí <span class="kt">Prop</span></span></span></span><br><span><var>X</var><span><span class="hyp-body"><b>:= </b><span>composite_vlsm IM constraint</span></span><span class="hyp-type"><b>: </b><span>VLSM message</span></span></span></span><br><span><var>s</var><span class="hyp-type"><b>: </b><span>state X</span></span></span><br><span><var>i</var><span class="hyp-type"><b>: </b><span>index</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">valid_state_prop X s
‚Üí constrained_state_prop (IM i) (s i)</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="Composition-v-chke9" style="display: none" type="checkbox"><label class="alectryon-input" for="Composition-v-chke9"><span class="kn">Proof</span>.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>message, index</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>EqDecision0</var><span class="hyp-type"><b>: </b><span>EqDecision index</span></span></span><br><span><var>IM</var><span class="hyp-type"><b>: </b><span>index ‚Üí VLSM message</span></span></span><br><span><var>constraint</var><span class="hyp-type"><b>: </b><span>composite_label IM
‚Üí composite_state IM * option message
  ‚Üí <span class="kt">Prop</span></span></span></span><br><span><var>X</var><span><span class="hyp-body"><b>:= </b><span>composite_vlsm IM constraint</span></span><span class="hyp-type"><b>: </b><span>VLSM message</span></span></span></span><br><span><var>s</var><span class="hyp-type"><b>: </b><span>state X</span></span></span><br><span><var>i</var><span class="hyp-type"><b>: </b><span>index</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">valid_state_prop X s
‚Üí constrained_state_prop (IM i) (s i)</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><span class="alectryon-input"><span class="bp">by</span> <span class="nb">intros</span>; <span class="nb">apply</span> valid_state_project_preloaded_to_preloaded,
    preloaded_with_all_messages_valid_state_prop.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Qed</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
</span><span class="alectryon-sentence"><input class="alectryon-toggle" id="Composition-v-chkea" style="display: none" type="checkbox"><label class="alectryon-input" for="Composition-v-chkea"><span class="kn">Lemma</span> <span class="nf">composite_transition_project_active</span>
  <span class="nv">message</span> `{EqDecision index} (IM : index -&gt; VLSM message) :
  <span class="kr">forall</span> (<span class="nv">l</span> : composite_label IM) (<span class="nv">s</span> : composite_state IM) (<span class="nv">im</span> : option message)
    (<span class="nv">s&#39;</span> : composite_state IM) (<span class="nv">om</span> : option message),
      composite_transition IM l (s, im) = (s&#39;, om) -&gt;
      transition (IM (projT1 l)) (projT2 l) (s (projT1 l), im) = (s&#39; (projT1 l), om).</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>message, index</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>EqDecision0</var><span class="hyp-type"><b>: </b><span>EqDecision index</span></span></span><br><span><var>IM</var><span class="hyp-type"><b>: </b><span>index ‚Üí VLSM message</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="kr">‚àÄ</span> (<span class="nv">l</span> : composite_label IM) (<span class="nv">s</span> : composite_state IM) 
  (<span class="nv">im</span> : option message) (<span class="nv">s&#39;</span> : composite_state IM) 
  (<span class="nv">om</span> : option message),
  composite_transition IM l (s, im) = (s&#39;, om)
  ‚Üí transition (projT2 l) (s (projT1 l), im) =
    (s&#39; (projT1 l), om)</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="Composition-v-chkeb" style="display: none" type="checkbox"><label class="alectryon-input" for="Composition-v-chkeb"><span class="kn">Proof</span>.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>message, index</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>EqDecision0</var><span class="hyp-type"><b>: </b><span>EqDecision index</span></span></span><br><span><var>IM</var><span class="hyp-type"><b>: </b><span>index ‚Üí VLSM message</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="kr">‚àÄ</span> (<span class="nv">l</span> : composite_label IM) (<span class="nv">s</span> : composite_state IM) 
  (<span class="nv">im</span> : option message) (<span class="nv">s&#39;</span> : composite_state IM) 
  (<span class="nv">om</span> : option message),
  composite_transition IM l (s, im) = (s&#39;, om)
  ‚Üí transition (projT2 l) (s (projT1 l), im) =
    (s&#39; (projT1 l), om)</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="Composition-v-chkec" style="display: none" type="checkbox"><label class="alectryon-input" for="Composition-v-chkec"><span class="nb">intros</span> [x l]; <span class="nb">cbn</span>; <span class="nb">intros</span>.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>message, index</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>EqDecision0</var><span class="hyp-type"><b>: </b><span>EqDecision index</span></span></span><br><span><var>IM</var><span class="hyp-type"><b>: </b><span>index ‚Üí VLSM message</span></span></span><br><span><var>x</var><span class="hyp-type"><b>: </b><span>index</span></span></span><br><span><var>l</var><span class="hyp-type"><b>: </b><span>label (IM x)</span></span></span><br><span><var>s</var><span class="hyp-type"><b>: </b><span>composite_state IM</span></span></span><br><span><var>im</var><span class="hyp-type"><b>: </b><span>option message</span></span></span><br><span><var>s'</var><span class="hyp-type"><b>: </b><span>composite_state IM</span></span></span><br><span><var>om</var><span class="hyp-type"><b>: </b><span>option message</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>(<span class="kr">let</span> (<span class="nv">si&#39;</span>, om&#39;) := transition l (s x, im) <span class="kr">in</span>
 (state_update IM s x si&#39;, om&#39;)) = (
s&#39;, om)</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">transition l (s x, im) = (s&#39; x, om)</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="Composition-v-chked" style="display: none" type="checkbox"><label class="alectryon-input" for="Composition-v-chked"><span class="nb">destruct</span> (transition (IM x) l (s x, im)).</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>message, index</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>EqDecision0</var><span class="hyp-type"><b>: </b><span>EqDecision index</span></span></span><br><span><var>IM</var><span class="hyp-type"><b>: </b><span>index ‚Üí VLSM message</span></span></span><br><span><var>x</var><span class="hyp-type"><b>: </b><span>index</span></span></span><br><span><var>l</var><span class="hyp-type"><b>: </b><span>label (IM x)</span></span></span><br><span><var>s</var><span class="hyp-type"><b>: </b><span>composite_state IM</span></span></span><br><span><var>im</var><span class="hyp-type"><b>: </b><span>option message</span></span></span><br><span><var>s'</var><span class="hyp-type"><b>: </b><span>composite_state IM</span></span></span><br><span><var>om</var><span class="hyp-type"><b>: </b><span>option message</span></span></span><br><span><var>s0</var><span class="hyp-type"><b>: </b><span>state (IM x)</span></span></span><br><span><var>o</var><span class="hyp-type"><b>: </b><span>option message</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>(state_update IM s x s0, o) = (s&#39;, om)</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">(s0, o) = (s&#39; x, om)</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="Composition-v-chkee" style="display: none" type="checkbox"><label class="alectryon-input" for="Composition-v-chkee"><span class="nb">inversion</span> H.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>message, index</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>EqDecision0</var><span class="hyp-type"><b>: </b><span>EqDecision index</span></span></span><br><span><var>IM</var><span class="hyp-type"><b>: </b><span>index ‚Üí VLSM message</span></span></span><br><span><var>x</var><span class="hyp-type"><b>: </b><span>index</span></span></span><br><span><var>l</var><span class="hyp-type"><b>: </b><span>label (IM x)</span></span></span><br><span><var>s</var><span class="hyp-type"><b>: </b><span>composite_state IM</span></span></span><br><span><var>im</var><span class="hyp-type"><b>: </b><span>option message</span></span></span><br><span><var>s'</var><span class="hyp-type"><b>: </b><span>composite_state IM</span></span></span><br><span><var>om</var><span class="hyp-type"><b>: </b><span>option message</span></span></span><br><span><var>s0</var><span class="hyp-type"><b>: </b><span>state (IM x)</span></span></span><br><span><var>o</var><span class="hyp-type"><b>: </b><span>option message</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>(state_update IM s x s0, o) = (s&#39;, om)</span></span></span><br><span><var>H1</var><span class="hyp-type"><b>: </b><span>state_update IM s x s0 = s&#39;</span></span></span><br><span><var>H2</var><span class="hyp-type"><b>: </b><span>o = om</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">(s0, om) = (state_update IM s x s0 x, om)</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="Composition-v-chkef" style="display: none" type="checkbox"><label class="alectryon-input" for="Composition-v-chkef"><span class="nb">f_equal</span>.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>message, index</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>EqDecision0</var><span class="hyp-type"><b>: </b><span>EqDecision index</span></span></span><br><span><var>IM</var><span class="hyp-type"><b>: </b><span>index ‚Üí VLSM message</span></span></span><br><span><var>x</var><span class="hyp-type"><b>: </b><span>index</span></span></span><br><span><var>l</var><span class="hyp-type"><b>: </b><span>label (IM x)</span></span></span><br><span><var>s</var><span class="hyp-type"><b>: </b><span>composite_state IM</span></span></span><br><span><var>im</var><span class="hyp-type"><b>: </b><span>option message</span></span></span><br><span><var>s'</var><span class="hyp-type"><b>: </b><span>composite_state IM</span></span></span><br><span><var>om</var><span class="hyp-type"><b>: </b><span>option message</span></span></span><br><span><var>s0</var><span class="hyp-type"><b>: </b><span>state (IM x)</span></span></span><br><span><var>o</var><span class="hyp-type"><b>: </b><span>option message</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>(state_update IM s x s0, o) = (s&#39;, om)</span></span></span><br><span><var>H1</var><span class="hyp-type"><b>: </b><span>state_update IM s x s0 = s&#39;</span></span></span><br><span><var>H2</var><span class="hyp-type"><b>: </b><span>o = om</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">s0 = state_update IM s x s0 x</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><span class="alectryon-input"><span class="bp">by</span> state_update_simpl.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Qed</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
</span><span class="alectryon-sentence"><input class="alectryon-toggle" id="Composition-v-chkf0" style="display: none" type="checkbox"><label class="alectryon-input" for="Composition-v-chkf0"><span class="kn">Lemma</span> <span class="nf">input_valid_transition_preloaded_project_active_free</span>
  {<span class="nv">message</span>} `{EqDecision V} {IM : V -&gt; VLSM message}
  (X := free_composite_vlsm IM)
  l s im s&#39; om :
  input_constrained_transition X l (s, im) (s&#39;, om) -&gt;
  input_constrained_transition (IM (projT1 l)) (projT2 l)
    (s (projT1 l), im) (s&#39; (projT1 l), om).</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>message, V</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>EqDecision0</var><span class="hyp-type"><b>: </b><span>EqDecision V</span></span></span><br><span><var>IM</var><span class="hyp-type"><b>: </b><span>V ‚Üí VLSM message</span></span></span><br><span><var>X</var><span><span class="hyp-body"><b>:= </b><span>free_composite_vlsm IM</span></span><span class="hyp-type"><b>: </b><span>VLSM message</span></span></span></span><br><span><var>l</var><span class="hyp-type"><b>: </b><span>label (preloaded_with_all_messages_vlsm X)</span></span></span><br><span><var>s</var><span class="hyp-type"><b>: </b><span>state (preloaded_with_all_messages_vlsm X)</span></span></span><br><span><var>im</var><span class="hyp-type"><b>: </b><span>option message</span></span></span><br><span><var>s'</var><span class="hyp-type"><b>: </b><span>state (preloaded_with_all_messages_vlsm X)</span></span></span><br><span><var>om</var><span class="hyp-type"><b>: </b><span>option message</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">input_constrained_transition X l (s, im) (s&#39;, om)
‚Üí input_constrained_transition (IM (projT1 l))
    (projT2 l) (s (projT1 l), im) (s&#39; (projT1 l), om)</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="Composition-v-chkf1" style="display: none" type="checkbox"><label class="alectryon-input" for="Composition-v-chkf1"><span class="kn">Proof</span>.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>message, V</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>EqDecision0</var><span class="hyp-type"><b>: </b><span>EqDecision V</span></span></span><br><span><var>IM</var><span class="hyp-type"><b>: </b><span>V ‚Üí VLSM message</span></span></span><br><span><var>X</var><span><span class="hyp-body"><b>:= </b><span>free_composite_vlsm IM</span></span><span class="hyp-type"><b>: </b><span>VLSM message</span></span></span></span><br><span><var>l</var><span class="hyp-type"><b>: </b><span>label (preloaded_with_all_messages_vlsm X)</span></span></span><br><span><var>s</var><span class="hyp-type"><b>: </b><span>state (preloaded_with_all_messages_vlsm X)</span></span></span><br><span><var>im</var><span class="hyp-type"><b>: </b><span>option message</span></span></span><br><span><var>s'</var><span class="hyp-type"><b>: </b><span>state (preloaded_with_all_messages_vlsm X)</span></span></span><br><span><var>om</var><span class="hyp-type"><b>: </b><span>option message</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">input_constrained_transition X l (s, im) (s&#39;, om)
‚Üí input_constrained_transition (IM (projT1 l))
    (projT2 l) (s (projT1 l), im) (s&#39; (projT1 l), om)</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="Composition-v-chkf2" style="display: none" type="checkbox"><label class="alectryon-input" for="Composition-v-chkf2"><span class="nb">intro</span> Hptrans.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>message, V</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>EqDecision0</var><span class="hyp-type"><b>: </b><span>EqDecision V</span></span></span><br><span><var>IM</var><span class="hyp-type"><b>: </b><span>V ‚Üí VLSM message</span></span></span><br><span><var>X</var><span><span class="hyp-body"><b>:= </b><span>free_composite_vlsm IM</span></span><span class="hyp-type"><b>: </b><span>VLSM message</span></span></span></span><br><span><var>l</var><span class="hyp-type"><b>: </b><span>label (preloaded_with_all_messages_vlsm X)</span></span></span><br><span><var>s</var><span class="hyp-type"><b>: </b><span>state (preloaded_with_all_messages_vlsm X)</span></span></span><br><span><var>im</var><span class="hyp-type"><b>: </b><span>option message</span></span></span><br><span><var>s'</var><span class="hyp-type"><b>: </b><span>state (preloaded_with_all_messages_vlsm X)</span></span></span><br><span><var>om</var><span class="hyp-type"><b>: </b><span>option message</span></span></span><br><span><var>Hptrans</var><span class="hyp-type"><b>: </b><span>input_constrained_transition X l (
  s, im) (s&#39;, om)</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">input_constrained_transition (IM (projT1 l))
  (projT2 l) (s (projT1 l), im) (s&#39; (projT1 l), om)</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="Composition-v-chkf3" style="display: none" type="checkbox"><label class="alectryon-input" for="Composition-v-chkf3"><span class="nb">destruct</span> Hptrans <span class="kr">as</span> [[Hproto_s [_ Hcvalid]] Htrans].</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>message, V</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>EqDecision0</var><span class="hyp-type"><b>: </b><span>EqDecision V</span></span></span><br><span><var>IM</var><span class="hyp-type"><b>: </b><span>V ‚Üí VLSM message</span></span></span><br><span><var>X</var><span><span class="hyp-body"><b>:= </b><span>free_composite_vlsm IM</span></span><span class="hyp-type"><b>: </b><span>VLSM message</span></span></span></span><br><span><var>l</var><span class="hyp-type"><b>: </b><span>label (preloaded_with_all_messages_vlsm X)</span></span></span><br><span><var>s</var><span class="hyp-type"><b>: </b><span>state (preloaded_with_all_messages_vlsm X)</span></span></span><br><span><var>im</var><span class="hyp-type"><b>: </b><span>option message</span></span></span><br><span><var>s'</var><span class="hyp-type"><b>: </b><span>state (preloaded_with_all_messages_vlsm X)</span></span></span><br><span><var>om</var><span class="hyp-type"><b>: </b><span>option message</span></span></span><br><span><var>Hproto_s</var><span class="hyp-type"><b>: </b><span>valid_state_prop
  (preloaded_with_all_messages_vlsm X) s</span></span></span><br><span><var>Hcvalid</var><span class="hyp-type"><b>: </b><span>valid l (s, im)</span></span></span><br><span><var>Htrans</var><span class="hyp-type"><b>: </b><span>transition l (s, im) = (s&#39;, om)</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">input_constrained_transition (IM (projT1 l))
  (projT2 l) (s (projT1 l), im) (s&#39; (projT1 l), om)</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="Composition-v-chkf4" style="display: none" type="checkbox"><label class="alectryon-input" for="Composition-v-chkf4"><span class="nb">split</span>; [| <span class="bp">by</span> <span class="nb">eapply</span> composite_transition_project_active].</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>message, V</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>EqDecision0</var><span class="hyp-type"><b>: </b><span>EqDecision V</span></span></span><br><span><var>IM</var><span class="hyp-type"><b>: </b><span>V ‚Üí VLSM message</span></span></span><br><span><var>X</var><span><span class="hyp-body"><b>:= </b><span>free_composite_vlsm IM</span></span><span class="hyp-type"><b>: </b><span>VLSM message</span></span></span></span><br><span><var>l</var><span class="hyp-type"><b>: </b><span>label (preloaded_with_all_messages_vlsm X)</span></span></span><br><span><var>s</var><span class="hyp-type"><b>: </b><span>state (preloaded_with_all_messages_vlsm X)</span></span></span><br><span><var>im</var><span class="hyp-type"><b>: </b><span>option message</span></span></span><br><span><var>s'</var><span class="hyp-type"><b>: </b><span>state (preloaded_with_all_messages_vlsm X)</span></span></span><br><span><var>om</var><span class="hyp-type"><b>: </b><span>option message</span></span></span><br><span><var>Hproto_s</var><span class="hyp-type"><b>: </b><span>valid_state_prop
  (preloaded_with_all_messages_vlsm X) s</span></span></span><br><span><var>Hcvalid</var><span class="hyp-type"><b>: </b><span>valid l (s, im)</span></span></span><br><span><var>Htrans</var><span class="hyp-type"><b>: </b><span>transition l (s, im) = (s&#39;, om)</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">input_valid
  (preloaded_with_all_messages_vlsm (IM (projT1 l)))
  (projT2 l) (s (projT1 l), im)</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="Composition-v-chkf5" style="display: none" type="checkbox"><label class="alectryon-input" for="Composition-v-chkf5"><span class="nb">split</span>; [| <span class="nb">split</span>].</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>message, V</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>EqDecision0</var><span class="hyp-type"><b>: </b><span>EqDecision V</span></span></span><br><span><var>IM</var><span class="hyp-type"><b>: </b><span>V ‚Üí VLSM message</span></span></span><br><span><var>X</var><span><span class="hyp-body"><b>:= </b><span>free_composite_vlsm IM</span></span><span class="hyp-type"><b>: </b><span>VLSM message</span></span></span></span><br><span><var>l</var><span class="hyp-type"><b>: </b><span>label (preloaded_with_all_messages_vlsm X)</span></span></span><br><span><var>s</var><span class="hyp-type"><b>: </b><span>state (preloaded_with_all_messages_vlsm X)</span></span></span><br><span><var>im</var><span class="hyp-type"><b>: </b><span>option message</span></span></span><br><span><var>s'</var><span class="hyp-type"><b>: </b><span>state (preloaded_with_all_messages_vlsm X)</span></span></span><br><span><var>om</var><span class="hyp-type"><b>: </b><span>option message</span></span></span><br><span><var>Hproto_s</var><span class="hyp-type"><b>: </b><span>valid_state_prop
  (preloaded_with_all_messages_vlsm X) s</span></span></span><br><span><var>Hcvalid</var><span class="hyp-type"><b>: </b><span>valid l (s, im)</span></span></span><br><span><var>Htrans</var><span class="hyp-type"><b>: </b><span>transition l (s, im) = (s&#39;, om)</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">valid_state_prop
  (preloaded_with_all_messages_vlsm (IM (projT1 l)))
  (s (projT1 l))</div></blockquote><div class="alectryon-extra-goals"><input class="alectryon-extra-goal-toggle" id="Composition-v-chkf6" style="display: none" type="checkbox"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>message, V</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>EqDecision0</var><span class="hyp-type"><b>: </b><span>EqDecision V</span></span></span><br><span><var>IM</var><span class="hyp-type"><b>: </b><span>V ‚Üí VLSM message</span></span></span><br><span><var>X</var><span><span class="hyp-body"><b>:= </b><span>free_composite_vlsm IM</span></span><span class="hyp-type"><b>: </b><span>VLSM message</span></span></span></span><br><span><var>l</var><span class="hyp-type"><b>: </b><span>label (preloaded_with_all_messages_vlsm X)</span></span></span><br><span><var>s</var><span class="hyp-type"><b>: </b><span>state (preloaded_with_all_messages_vlsm X)</span></span></span><br><span><var>im</var><span class="hyp-type"><b>: </b><span>option message</span></span></span><br><span><var>s'</var><span class="hyp-type"><b>: </b><span>state (preloaded_with_all_messages_vlsm X)</span></span></span><br><span><var>om</var><span class="hyp-type"><b>: </b><span>option message</span></span></span><br><span><var>Hproto_s</var><span class="hyp-type"><b>: </b><span>valid_state_prop
  (preloaded_with_all_messages_vlsm X) s</span></span></span><br><span><var>Hcvalid</var><span class="hyp-type"><b>: </b><span>valid l (s, im)</span></span></span><br><span><var>Htrans</var><span class="hyp-type"><b>: </b><span>transition l (s, im) = (s&#39;, om)</span></span></span><br></div><label class="goal-separator" for="Composition-v-chkf6"><hr></label><div class="goal-conclusion">option_valid_message_prop
  (preloaded_with_all_messages_vlsm (IM (projT1 l)))
  im</div></blockquote><input class="alectryon-extra-goal-toggle" id="Composition-v-chkf7" style="display: none" type="checkbox"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>message, V</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>EqDecision0</var><span class="hyp-type"><b>: </b><span>EqDecision V</span></span></span><br><span><var>IM</var><span class="hyp-type"><b>: </b><span>V ‚Üí VLSM message</span></span></span><br><span><var>X</var><span><span class="hyp-body"><b>:= </b><span>free_composite_vlsm IM</span></span><span class="hyp-type"><b>: </b><span>VLSM message</span></span></span></span><br><span><var>l</var><span class="hyp-type"><b>: </b><span>label (preloaded_with_all_messages_vlsm X)</span></span></span><br><span><var>s</var><span class="hyp-type"><b>: </b><span>state (preloaded_with_all_messages_vlsm X)</span></span></span><br><span><var>im</var><span class="hyp-type"><b>: </b><span>option message</span></span></span><br><span><var>s'</var><span class="hyp-type"><b>: </b><span>state (preloaded_with_all_messages_vlsm X)</span></span></span><br><span><var>om</var><span class="hyp-type"><b>: </b><span>option message</span></span></span><br><span><var>Hproto_s</var><span class="hyp-type"><b>: </b><span>valid_state_prop
  (preloaded_with_all_messages_vlsm X) s</span></span></span><br><span><var>Hcvalid</var><span class="hyp-type"><b>: </b><span>valid l (s, im)</span></span></span><br><span><var>Htrans</var><span class="hyp-type"><b>: </b><span>transition l (s, im) = (s&#39;, om)</span></span></span><br></div><label class="goal-separator" for="Composition-v-chkf7"><hr></label><div class="goal-conclusion">valid (projT2 l) (s (projT1 l), im)</div></blockquote></div></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="Composition-v-chkf8" style="display: none" type="checkbox"><label class="alectryon-input" for="Composition-v-chkf8">-</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>message, V</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>EqDecision0</var><span class="hyp-type"><b>: </b><span>EqDecision V</span></span></span><br><span><var>IM</var><span class="hyp-type"><b>: </b><span>V ‚Üí VLSM message</span></span></span><br><span><var>X</var><span><span class="hyp-body"><b>:= </b><span>free_composite_vlsm IM</span></span><span class="hyp-type"><b>: </b><span>VLSM message</span></span></span></span><br><span><var>l</var><span class="hyp-type"><b>: </b><span>label (preloaded_with_all_messages_vlsm X)</span></span></span><br><span><var>s</var><span class="hyp-type"><b>: </b><span>state (preloaded_with_all_messages_vlsm X)</span></span></span><br><span><var>im</var><span class="hyp-type"><b>: </b><span>option message</span></span></span><br><span><var>s'</var><span class="hyp-type"><b>: </b><span>state (preloaded_with_all_messages_vlsm X)</span></span></span><br><span><var>om</var><span class="hyp-type"><b>: </b><span>option message</span></span></span><br><span><var>Hproto_s</var><span class="hyp-type"><b>: </b><span>valid_state_prop
  (preloaded_with_all_messages_vlsm X) s</span></span></span><br><span><var>Hcvalid</var><span class="hyp-type"><b>: </b><span>valid l (s, im)</span></span></span><br><span><var>Htrans</var><span class="hyp-type"><b>: </b><span>transition l (s, im) = (s&#39;, om)</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">valid_state_prop
  (preloaded_with_all_messages_vlsm (IM (projT1 l)))
  (s (projT1 l))</div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="bp">by</span> <span class="nb">eapply</span> composite_constrained_state_project.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="Composition-v-chkf9" style="display: none" type="checkbox"><label class="alectryon-input" for="Composition-v-chkf9">-</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>message, V</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>EqDecision0</var><span class="hyp-type"><b>: </b><span>EqDecision V</span></span></span><br><span><var>IM</var><span class="hyp-type"><b>: </b><span>V ‚Üí VLSM message</span></span></span><br><span><var>X</var><span><span class="hyp-body"><b>:= </b><span>free_composite_vlsm IM</span></span><span class="hyp-type"><b>: </b><span>VLSM message</span></span></span></span><br><span><var>l</var><span class="hyp-type"><b>: </b><span>label (preloaded_with_all_messages_vlsm X)</span></span></span><br><span><var>s</var><span class="hyp-type"><b>: </b><span>state (preloaded_with_all_messages_vlsm X)</span></span></span><br><span><var>im</var><span class="hyp-type"><b>: </b><span>option message</span></span></span><br><span><var>s'</var><span class="hyp-type"><b>: </b><span>state (preloaded_with_all_messages_vlsm X)</span></span></span><br><span><var>om</var><span class="hyp-type"><b>: </b><span>option message</span></span></span><br><span><var>Hproto_s</var><span class="hyp-type"><b>: </b><span>valid_state_prop
  (preloaded_with_all_messages_vlsm X) s</span></span></span><br><span><var>Hcvalid</var><span class="hyp-type"><b>: </b><span>valid l (s, im)</span></span></span><br><span><var>Htrans</var><span class="hyp-type"><b>: </b><span>transition l (s, im) = (s&#39;, om)</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">option_valid_message_prop
  (preloaded_with_all_messages_vlsm (IM (projT1 l)))
  im</div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="bp">by</span> <span class="nb">apply</span> any_message_is_valid_in_preloaded.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="Composition-v-chkfa" style="display: none" type="checkbox"><label class="alectryon-input" for="Composition-v-chkfa">-</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>message, V</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>EqDecision0</var><span class="hyp-type"><b>: </b><span>EqDecision V</span></span></span><br><span><var>IM</var><span class="hyp-type"><b>: </b><span>V ‚Üí VLSM message</span></span></span><br><span><var>X</var><span><span class="hyp-body"><b>:= </b><span>free_composite_vlsm IM</span></span><span class="hyp-type"><b>: </b><span>VLSM message</span></span></span></span><br><span><var>l</var><span class="hyp-type"><b>: </b><span>label (preloaded_with_all_messages_vlsm X)</span></span></span><br><span><var>s</var><span class="hyp-type"><b>: </b><span>state (preloaded_with_all_messages_vlsm X)</span></span></span><br><span><var>im</var><span class="hyp-type"><b>: </b><span>option message</span></span></span><br><span><var>s'</var><span class="hyp-type"><b>: </b><span>state (preloaded_with_all_messages_vlsm X)</span></span></span><br><span><var>om</var><span class="hyp-type"><b>: </b><span>option message</span></span></span><br><span><var>Hproto_s</var><span class="hyp-type"><b>: </b><span>valid_state_prop
  (preloaded_with_all_messages_vlsm X) s</span></span></span><br><span><var>Hcvalid</var><span class="hyp-type"><b>: </b><span>valid l (s, im)</span></span></span><br><span><var>Htrans</var><span class="hyp-type"><b>: </b><span>transition l (s, im) = (s&#39;, om)</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">valid (projT2 l) (s (projT1 l), im)</div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="bp">by</span> <span class="nb">destruct</span> l; <span class="nb">apply</span> Hcvalid.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Qed</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
</span><span class="alectryon-sentence"><input class="alectryon-toggle" id="Composition-v-chkfb" style="display: none" type="checkbox"><label class="alectryon-input" for="Composition-v-chkfb"><span class="kn">Lemma</span> <span class="nf">input_valid_transition_preloaded_project_active</span>
  {<span class="nv">message</span>} `{EqDecision V} {IM : V -&gt; VLSM message} {constraint}
  (X := composite_vlsm IM constraint)
  l s im s&#39; om :
  input_constrained_transition X l (s, im) (s&#39;, om) -&gt;
  input_constrained_transition (IM (projT1 l)) (projT2 l)
    (s (projT1 l), im) (s&#39; (projT1 l), om).</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>message, V</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>EqDecision0</var><span class="hyp-type"><b>: </b><span>EqDecision V</span></span></span><br><span><var>IM</var><span class="hyp-type"><b>: </b><span>V ‚Üí VLSM message</span></span></span><br><span><var>constraint</var><span class="hyp-type"><b>: </b><span>composite_label IM
‚Üí composite_state IM * option message
  ‚Üí <span class="kt">Prop</span></span></span></span><br><span><var>X</var><span><span class="hyp-body"><b>:= </b><span>composite_vlsm IM constraint</span></span><span class="hyp-type"><b>: </b><span>VLSM message</span></span></span></span><br><span><var>l</var><span class="hyp-type"><b>: </b><span>label (preloaded_with_all_messages_vlsm X)</span></span></span><br><span><var>s</var><span class="hyp-type"><b>: </b><span>state (preloaded_with_all_messages_vlsm X)</span></span></span><br><span><var>im</var><span class="hyp-type"><b>: </b><span>option message</span></span></span><br><span><var>s'</var><span class="hyp-type"><b>: </b><span>state (preloaded_with_all_messages_vlsm X)</span></span></span><br><span><var>om</var><span class="hyp-type"><b>: </b><span>option message</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">input_constrained_transition X l (s, im) (s&#39;, om)
‚Üí input_constrained_transition (IM (projT1 l))
    (projT2 l) (s (projT1 l), im) (s&#39; (projT1 l), om)</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="Composition-v-chkfc" style="display: none" type="checkbox"><label class="alectryon-input" for="Composition-v-chkfc"><span class="kn">Proof</span>.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>message, V</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>EqDecision0</var><span class="hyp-type"><b>: </b><span>EqDecision V</span></span></span><br><span><var>IM</var><span class="hyp-type"><b>: </b><span>V ‚Üí VLSM message</span></span></span><br><span><var>constraint</var><span class="hyp-type"><b>: </b><span>composite_label IM
‚Üí composite_state IM * option message
  ‚Üí <span class="kt">Prop</span></span></span></span><br><span><var>X</var><span><span class="hyp-body"><b>:= </b><span>composite_vlsm IM constraint</span></span><span class="hyp-type"><b>: </b><span>VLSM message</span></span></span></span><br><span><var>l</var><span class="hyp-type"><b>: </b><span>label (preloaded_with_all_messages_vlsm X)</span></span></span><br><span><var>s</var><span class="hyp-type"><b>: </b><span>state (preloaded_with_all_messages_vlsm X)</span></span></span><br><span><var>im</var><span class="hyp-type"><b>: </b><span>option message</span></span></span><br><span><var>s'</var><span class="hyp-type"><b>: </b><span>state (preloaded_with_all_messages_vlsm X)</span></span></span><br><span><var>om</var><span class="hyp-type"><b>: </b><span>option message</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">input_constrained_transition X l (s, im) (s&#39;, om)
‚Üí input_constrained_transition (IM (projT1 l))
    (projT2 l) (s (projT1 l), im) (s&#39; (projT1 l), om)</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="Composition-v-chkfd" style="display: none" type="checkbox"><label class="alectryon-input" for="Composition-v-chkfd"><span class="nb">intros</span>.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>message, V</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>EqDecision0</var><span class="hyp-type"><b>: </b><span>EqDecision V</span></span></span><br><span><var>IM</var><span class="hyp-type"><b>: </b><span>V ‚Üí VLSM message</span></span></span><br><span><var>constraint</var><span class="hyp-type"><b>: </b><span>composite_label IM
‚Üí composite_state IM * option message
  ‚Üí <span class="kt">Prop</span></span></span></span><br><span><var>X</var><span><span class="hyp-body"><b>:= </b><span>composite_vlsm IM constraint</span></span><span class="hyp-type"><b>: </b><span>VLSM message</span></span></span></span><br><span><var>l</var><span class="hyp-type"><b>: </b><span>label (preloaded_with_all_messages_vlsm X)</span></span></span><br><span><var>s</var><span class="hyp-type"><b>: </b><span>state (preloaded_with_all_messages_vlsm X)</span></span></span><br><span><var>im</var><span class="hyp-type"><b>: </b><span>option message</span></span></span><br><span><var>s'</var><span class="hyp-type"><b>: </b><span>state (preloaded_with_all_messages_vlsm X)</span></span></span><br><span><var>om</var><span class="hyp-type"><b>: </b><span>option message</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>input_constrained_transition X l (s, im) (s&#39;, om)</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">input_constrained_transition (IM (projT1 l))
  (projT2 l) (s (projT1 l), im) (s&#39; (projT1 l), om)</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="Composition-v-chkfe" style="display: none" type="checkbox"><label class="alectryon-input" for="Composition-v-chkfe"><span class="nb">apply</span> input_valid_transition_preloaded_project_active_free.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>message, V</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>EqDecision0</var><span class="hyp-type"><b>: </b><span>EqDecision V</span></span></span><br><span><var>IM</var><span class="hyp-type"><b>: </b><span>V ‚Üí VLSM message</span></span></span><br><span><var>constraint</var><span class="hyp-type"><b>: </b><span>composite_label IM
‚Üí composite_state IM * option message
  ‚Üí <span class="kt">Prop</span></span></span></span><br><span><var>X</var><span><span class="hyp-body"><b>:= </b><span>composite_vlsm IM constraint</span></span><span class="hyp-type"><b>: </b><span>VLSM message</span></span></span></span><br><span><var>l</var><span class="hyp-type"><b>: </b><span>label (preloaded_with_all_messages_vlsm X)</span></span></span><br><span><var>s</var><span class="hyp-type"><b>: </b><span>state (preloaded_with_all_messages_vlsm X)</span></span></span><br><span><var>im</var><span class="hyp-type"><b>: </b><span>option message</span></span></span><br><span><var>s'</var><span class="hyp-type"><b>: </b><span>state (preloaded_with_all_messages_vlsm X)</span></span></span><br><span><var>om</var><span class="hyp-type"><b>: </b><span>option message</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>input_constrained_transition X l (s, im) (s&#39;, om)</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">input_constrained_transition (free_composite_vlsm IM)
  l (s, im) (s&#39;, om)</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="Composition-v-chkff" style="display: none" type="checkbox"><label class="alectryon-input" for="Composition-v-chkff"><span class="nb">apply</span> (@VLSM_incl_input_valid_transition _ _ (preloaded_with_all_messages_vlsm X)); [| <span class="bp">done</span>].</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>message, V</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>EqDecision0</var><span class="hyp-type"><b>: </b><span>EqDecision V</span></span></span><br><span><var>IM</var><span class="hyp-type"><b>: </b><span>V ‚Üí VLSM message</span></span></span><br><span><var>constraint</var><span class="hyp-type"><b>: </b><span>composite_label IM
‚Üí composite_state IM * option message
  ‚Üí <span class="kt">Prop</span></span></span></span><br><span><var>X</var><span><span class="hyp-body"><b>:= </b><span>composite_vlsm IM constraint</span></span><span class="hyp-type"><b>: </b><span>VLSM message</span></span></span></span><br><span><var>l</var><span class="hyp-type"><b>: </b><span>label (preloaded_with_all_messages_vlsm X)</span></span></span><br><span><var>s</var><span class="hyp-type"><b>: </b><span>state (preloaded_with_all_messages_vlsm X)</span></span></span><br><span><var>im</var><span class="hyp-type"><b>: </b><span>option message</span></span></span><br><span><var>s'</var><span class="hyp-type"><b>: </b><span>state (preloaded_with_all_messages_vlsm X)</span></span></span><br><span><var>om</var><span class="hyp-type"><b>: </b><span>option message</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>input_constrained_transition X l (s, im) (s&#39;, om)</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">VLSM_incl_part (preloaded_with_all_messages_vlsm X)
  (preloaded_vlsm_machine (free_composite_vlsm IM)
     (<span class="kr">Œª</span> <span class="nv">_</span> : message, <span class="kt">True</span>))</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><span class="alectryon-input"><span class="bp">by</span> <span class="nb">apply</span> constrained_preloaded_vlsm_incl_preloaded_with_all_messages.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Qed</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
</span><span class="alectryon-sentence"><input class="alectryon-toggle" id="Composition-v-chk100" style="display: none" type="checkbox"><label class="alectryon-input" for="Composition-v-chk100"><span class="kn">Lemma</span> <span class="nf">input_valid_transition_project_active</span>
  {<span class="nv">message</span>} `{EqDecision V} {IM : V -&gt; VLSM message} {constraint}
  (X := composite_vlsm IM constraint)
  l s im s&#39; om :
  input_valid_transition X l (s, im) (s&#39;, om) -&gt;
  input_constrained_transition (IM (projT1 l)) (projT2 l)
    (s (projT1 l), im) (s&#39; (projT1 l), om).</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>message, V</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>EqDecision0</var><span class="hyp-type"><b>: </b><span>EqDecision V</span></span></span><br><span><var>IM</var><span class="hyp-type"><b>: </b><span>V ‚Üí VLSM message</span></span></span><br><span><var>constraint</var><span class="hyp-type"><b>: </b><span>composite_label IM
‚Üí composite_state IM * option message
  ‚Üí <span class="kt">Prop</span></span></span></span><br><span><var>X</var><span><span class="hyp-body"><b>:= </b><span>composite_vlsm IM constraint</span></span><span class="hyp-type"><b>: </b><span>VLSM message</span></span></span></span><br><span><var>l</var><span class="hyp-type"><b>: </b><span>label X</span></span></span><br><span><var>s</var><span class="hyp-type"><b>: </b><span>state X</span></span></span><br><span><var>im</var><span class="hyp-type"><b>: </b><span>option message</span></span></span><br><span><var>s'</var><span class="hyp-type"><b>: </b><span>state X</span></span></span><br><span><var>om</var><span class="hyp-type"><b>: </b><span>option message</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">input_valid_transition X l (s, im) (s&#39;, om)
‚Üí input_constrained_transition (IM (projT1 l))
    (projT2 l) (s (projT1 l), im) (s&#39; (projT1 l), om)</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="Composition-v-chk101" style="display: none" type="checkbox"><label class="alectryon-input" for="Composition-v-chk101"><span class="kn">Proof</span>.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>message, V</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>EqDecision0</var><span class="hyp-type"><b>: </b><span>EqDecision V</span></span></span><br><span><var>IM</var><span class="hyp-type"><b>: </b><span>V ‚Üí VLSM message</span></span></span><br><span><var>constraint</var><span class="hyp-type"><b>: </b><span>composite_label IM
‚Üí composite_state IM * option message
  ‚Üí <span class="kt">Prop</span></span></span></span><br><span><var>X</var><span><span class="hyp-body"><b>:= </b><span>composite_vlsm IM constraint</span></span><span class="hyp-type"><b>: </b><span>VLSM message</span></span></span></span><br><span><var>l</var><span class="hyp-type"><b>: </b><span>label X</span></span></span><br><span><var>s</var><span class="hyp-type"><b>: </b><span>state X</span></span></span><br><span><var>im</var><span class="hyp-type"><b>: </b><span>option message</span></span></span><br><span><var>s'</var><span class="hyp-type"><b>: </b><span>state X</span></span></span><br><span><var>om</var><span class="hyp-type"><b>: </b><span>option message</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">input_valid_transition X l (s, im) (s&#39;, om)
‚Üí input_constrained_transition (IM (projT1 l))
    (projT2 l) (s (projT1 l), im) (s&#39; (projT1 l), om)</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="Composition-v-chk102" style="display: none" type="checkbox"><label class="alectryon-input" for="Composition-v-chk102"><span class="nb">intro</span> Hptrans.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>message, V</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>EqDecision0</var><span class="hyp-type"><b>: </b><span>EqDecision V</span></span></span><br><span><var>IM</var><span class="hyp-type"><b>: </b><span>V ‚Üí VLSM message</span></span></span><br><span><var>constraint</var><span class="hyp-type"><b>: </b><span>composite_label IM
‚Üí composite_state IM * option message
  ‚Üí <span class="kt">Prop</span></span></span></span><br><span><var>X</var><span><span class="hyp-body"><b>:= </b><span>composite_vlsm IM constraint</span></span><span class="hyp-type"><b>: </b><span>VLSM message</span></span></span></span><br><span><var>l</var><span class="hyp-type"><b>: </b><span>label X</span></span></span><br><span><var>s</var><span class="hyp-type"><b>: </b><span>state X</span></span></span><br><span><var>im</var><span class="hyp-type"><b>: </b><span>option message</span></span></span><br><span><var>s'</var><span class="hyp-type"><b>: </b><span>state X</span></span></span><br><span><var>om</var><span class="hyp-type"><b>: </b><span>option message</span></span></span><br><span><var>Hptrans</var><span class="hyp-type"><b>: </b><span>input_valid_transition X l (s, im) (s&#39;, om)</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">input_constrained_transition (IM (projT1 l))
  (projT2 l) (s (projT1 l), im) (s&#39; (projT1 l), om)</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="Composition-v-chk103" style="display: none" type="checkbox"><label class="alectryon-input" for="Composition-v-chk103"><span class="nb">apply</span> preloaded_weaken_input_valid_transition <span class="kr">in</span> Hptrans.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>message, V</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>EqDecision0</var><span class="hyp-type"><b>: </b><span>EqDecision V</span></span></span><br><span><var>IM</var><span class="hyp-type"><b>: </b><span>V ‚Üí VLSM message</span></span></span><br><span><var>constraint</var><span class="hyp-type"><b>: </b><span>composite_label IM
‚Üí composite_state IM * option message
  ‚Üí <span class="kt">Prop</span></span></span></span><br><span><var>X</var><span><span class="hyp-body"><b>:= </b><span>composite_vlsm IM constraint</span></span><span class="hyp-type"><b>: </b><span>VLSM message</span></span></span></span><br><span><var>l</var><span class="hyp-type"><b>: </b><span>label X</span></span></span><br><span><var>s</var><span class="hyp-type"><b>: </b><span>state X</span></span></span><br><span><var>im</var><span class="hyp-type"><b>: </b><span>option message</span></span></span><br><span><var>s'</var><span class="hyp-type"><b>: </b><span>state X</span></span></span><br><span><var>om</var><span class="hyp-type"><b>: </b><span>option message</span></span></span><br><span><var>Hptrans</var><span class="hyp-type"><b>: </b><span>input_constrained_transition X l (
  s, im) (s&#39;, om)</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">input_constrained_transition (IM (projT1 l))
  (projT2 l) (s (projT1 l), im) (s&#39; (projT1 l), om)</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><span class="alectryon-input"><span class="bp">by</span> <span class="nb">revert</span> Hptrans; <span class="nb">apply</span> input_valid_transition_preloaded_project_active.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Qed</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
</span><span class="alectryon-sentence"><input class="alectryon-toggle" id="Composition-v-chk104" style="display: none" type="checkbox"><label class="alectryon-input" for="Composition-v-chk104"><span class="kn">Lemma</span> <span class="nf">input_valid_transition_preloaded_project_any_free</span>
  {<span class="nv">V</span> : <span class="kt">Type</span>} (<span class="nv">i</span> : V)
  {<span class="nv">message</span> : <span class="kt">Type</span>} `{EqDecision V} {IM : V -&gt; VLSM message}
  (X := free_composite_vlsm IM)
  (l : label X) s im s&#39; om :
  input_constrained_transition X l (s, im) (s&#39;, om) -&gt;
    s i = s&#39; i \/
    <span class="kr">exists</span> <span class="nv">li</span> : label (IM i),
      l = existT i li /\
     input_constrained_transition (IM i) li (s i, im) (s&#39; i, om).</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>V</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>i</var><span class="hyp-type"><b>: </b><span>V</span></span></span><br><span><var>message</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>EqDecision0</var><span class="hyp-type"><b>: </b><span>EqDecision V</span></span></span><br><span><var>IM</var><span class="hyp-type"><b>: </b><span>V ‚Üí VLSM message</span></span></span><br><span><var>X</var><span><span class="hyp-body"><b>:= </b><span>free_composite_vlsm IM</span></span><span class="hyp-type"><b>: </b><span>VLSM message</span></span></span></span><br><span><var>l</var><span class="hyp-type"><b>: </b><span>label X</span></span></span><br><span><var>s</var><span class="hyp-type"><b>: </b><span>state (preloaded_with_all_messages_vlsm X)</span></span></span><br><span><var>im</var><span class="hyp-type"><b>: </b><span>option message</span></span></span><br><span><var>s'</var><span class="hyp-type"><b>: </b><span>state (preloaded_with_all_messages_vlsm X)</span></span></span><br><span><var>om</var><span class="hyp-type"><b>: </b><span>option message</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">input_constrained_transition X l (s, im) (s&#39;, om)
‚Üí s i = s&#39; i
  ‚à® (<span class="kr">‚àÉ</span> <span class="nv">li</span> : label (IM i),
       l = existT i li
       ‚àß input_constrained_transition (IM i) li
           (s i, im) (s&#39; i, om))</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="Composition-v-chk105" style="display: none" type="checkbox"><label class="alectryon-input" for="Composition-v-chk105"><span class="kn">Proof</span>.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>V</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>i</var><span class="hyp-type"><b>: </b><span>V</span></span></span><br><span><var>message</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>EqDecision0</var><span class="hyp-type"><b>: </b><span>EqDecision V</span></span></span><br><span><var>IM</var><span class="hyp-type"><b>: </b><span>V ‚Üí VLSM message</span></span></span><br><span><var>X</var><span><span class="hyp-body"><b>:= </b><span>free_composite_vlsm IM</span></span><span class="hyp-type"><b>: </b><span>VLSM message</span></span></span></span><br><span><var>l</var><span class="hyp-type"><b>: </b><span>label X</span></span></span><br><span><var>s</var><span class="hyp-type"><b>: </b><span>state (preloaded_with_all_messages_vlsm X)</span></span></span><br><span><var>im</var><span class="hyp-type"><b>: </b><span>option message</span></span></span><br><span><var>s'</var><span class="hyp-type"><b>: </b><span>state (preloaded_with_all_messages_vlsm X)</span></span></span><br><span><var>om</var><span class="hyp-type"><b>: </b><span>option message</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">input_constrained_transition X l (s, im) (s&#39;, om)
‚Üí s i = s&#39; i
  ‚à® (<span class="kr">‚àÉ</span> <span class="nv">li</span> : label (IM i),
       l = existT i li
       ‚àß input_constrained_transition (IM i) li
           (s i, im) (s&#39; i, om))</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="Composition-v-chk106" style="display: none" type="checkbox"><label class="alectryon-input" for="Composition-v-chk106"><span class="nb">intro</span> Hptrans.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>V</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>i</var><span class="hyp-type"><b>: </b><span>V</span></span></span><br><span><var>message</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>EqDecision0</var><span class="hyp-type"><b>: </b><span>EqDecision V</span></span></span><br><span><var>IM</var><span class="hyp-type"><b>: </b><span>V ‚Üí VLSM message</span></span></span><br><span><var>X</var><span><span class="hyp-body"><b>:= </b><span>free_composite_vlsm IM</span></span><span class="hyp-type"><b>: </b><span>VLSM message</span></span></span></span><br><span><var>l</var><span class="hyp-type"><b>: </b><span>label X</span></span></span><br><span><var>s</var><span class="hyp-type"><b>: </b><span>state (preloaded_with_all_messages_vlsm X)</span></span></span><br><span><var>im</var><span class="hyp-type"><b>: </b><span>option message</span></span></span><br><span><var>s'</var><span class="hyp-type"><b>: </b><span>state (preloaded_with_all_messages_vlsm X)</span></span></span><br><span><var>om</var><span class="hyp-type"><b>: </b><span>option message</span></span></span><br><span><var>Hptrans</var><span class="hyp-type"><b>: </b><span>input_constrained_transition X l (
  s, im) (s&#39;, om)</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">s i = s&#39; i
‚à® (<span class="kr">‚àÉ</span> <span class="nv">li</span> : label (IM i),
     l = existT i li
     ‚àß input_constrained_transition (IM i) li
         (s i, im) (s&#39; i, om))</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="Composition-v-chk107" style="display: none" type="checkbox"><label class="alectryon-input" for="Composition-v-chk107"><span class="nb">destruct</span> l <span class="kr">as</span> [j lj].</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>V</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>i</var><span class="hyp-type"><b>: </b><span>V</span></span></span><br><span><var>message</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>EqDecision0</var><span class="hyp-type"><b>: </b><span>EqDecision V</span></span></span><br><span><var>IM</var><span class="hyp-type"><b>: </b><span>V ‚Üí VLSM message</span></span></span><br><span><var>X</var><span><span class="hyp-body"><b>:= </b><span>free_composite_vlsm IM</span></span><span class="hyp-type"><b>: </b><span>VLSM message</span></span></span></span><br><span><var>j</var><span class="hyp-type"><b>: </b><span>V</span></span></span><br><span><var>lj</var><span class="hyp-type"><b>: </b><span>label (IM j)</span></span></span><br><span><var>s</var><span class="hyp-type"><b>: </b><span>state (preloaded_with_all_messages_vlsm X)</span></span></span><br><span><var>im</var><span class="hyp-type"><b>: </b><span>option message</span></span></span><br><span><var>s'</var><span class="hyp-type"><b>: </b><span>state (preloaded_with_all_messages_vlsm X)</span></span></span><br><span><var>om</var><span class="hyp-type"><b>: </b><span>option message</span></span></span><br><span><var>Hptrans</var><span class="hyp-type"><b>: </b><span>input_constrained_transition X 
  (existT j lj) (s, im) (
  s&#39;, om)</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">s i = s&#39; i
‚à® (<span class="kr">‚àÉ</span> <span class="nv">li</span> : label (IM i),
     existT j lj = existT i li
     ‚àß input_constrained_transition (IM i) li
         (s i, im) (s&#39; i, om))</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="Composition-v-chk108" style="display: none" type="checkbox"><label class="alectryon-input" for="Composition-v-chk108"><span class="nb">destruct</span> (decide (i = j)); <span class="nb">subst</span>.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>V, message</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>EqDecision0</var><span class="hyp-type"><b>: </b><span>EqDecision V</span></span></span><br><span><var>IM</var><span class="hyp-type"><b>: </b><span>V ‚Üí VLSM message</span></span></span><br><span><var>X</var><span><span class="hyp-body"><b>:= </b><span>free_composite_vlsm IM</span></span><span class="hyp-type"><b>: </b><span>VLSM message</span></span></span></span><br><span><var>j</var><span class="hyp-type"><b>: </b><span>V</span></span></span><br><span><var>lj</var><span class="hyp-type"><b>: </b><span>label (IM j)</span></span></span><br><span><var>s</var><span class="hyp-type"><b>: </b><span>state (preloaded_with_all_messages_vlsm X)</span></span></span><br><span><var>im</var><span class="hyp-type"><b>: </b><span>option message</span></span></span><br><span><var>s'</var><span class="hyp-type"><b>: </b><span>state (preloaded_with_all_messages_vlsm X)</span></span></span><br><span><var>om</var><span class="hyp-type"><b>: </b><span>option message</span></span></span><br><span><var>Hptrans</var><span class="hyp-type"><b>: </b><span>input_constrained_transition X 
  (existT j lj) (s, im) (
  s&#39;, om)</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">s j = s&#39; j
‚à® (<span class="kr">‚àÉ</span> <span class="nv">li</span> : label (IM j),
     existT j lj = existT j li
     ‚àß input_constrained_transition (IM j) li
         (s j, im) (s&#39; j, om))</div></blockquote><div class="alectryon-extra-goals"><input class="alectryon-extra-goal-toggle" id="Composition-v-chk109" style="display: none" type="checkbox"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>V</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>i</var><span class="hyp-type"><b>: </b><span>V</span></span></span><br><span><var>message</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>EqDecision0</var><span class="hyp-type"><b>: </b><span>EqDecision V</span></span></span><br><span><var>IM</var><span class="hyp-type"><b>: </b><span>V ‚Üí VLSM message</span></span></span><br><span><var>X</var><span><span class="hyp-body"><b>:= </b><span>free_composite_vlsm IM</span></span><span class="hyp-type"><b>: </b><span>VLSM message</span></span></span></span><br><span><var>j</var><span class="hyp-type"><b>: </b><span>V</span></span></span><br><span><var>lj</var><span class="hyp-type"><b>: </b><span>label (IM j)</span></span></span><br><span><var>s</var><span class="hyp-type"><b>: </b><span>state (preloaded_with_all_messages_vlsm X)</span></span></span><br><span><var>im</var><span class="hyp-type"><b>: </b><span>option message</span></span></span><br><span><var>s'</var><span class="hyp-type"><b>: </b><span>state (preloaded_with_all_messages_vlsm X)</span></span></span><br><span><var>om</var><span class="hyp-type"><b>: </b><span>option message</span></span></span><br><span><var>Hptrans</var><span class="hyp-type"><b>: </b><span>input_constrained_transition X 
  (existT j lj) (s, im) (
  s&#39;, om)</span></span></span><br><span><var>n</var><span class="hyp-type"><b>: </b><span>i ‚â† j</span></span></span><br></div><label class="goal-separator" for="Composition-v-chk109"><hr></label><div class="goal-conclusion">s i = s&#39; i
‚à® (<span class="kr">‚àÉ</span> <span class="nv">li</span> : label (IM i),
     existT j lj = existT i li
     ‚àß input_constrained_transition 
         (IM i) li (s i, im) (
         s&#39; i, om))</div></blockquote></div></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="Composition-v-chk10a" style="display: none" type="checkbox"><label class="alectryon-input" for="Composition-v-chk10a">-</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>V, message</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>EqDecision0</var><span class="hyp-type"><b>: </b><span>EqDecision V</span></span></span><br><span><var>IM</var><span class="hyp-type"><b>: </b><span>V ‚Üí VLSM message</span></span></span><br><span><var>X</var><span><span class="hyp-body"><b>:= </b><span>free_composite_vlsm IM</span></span><span class="hyp-type"><b>: </b><span>VLSM message</span></span></span></span><br><span><var>j</var><span class="hyp-type"><b>: </b><span>V</span></span></span><br><span><var>lj</var><span class="hyp-type"><b>: </b><span>label (IM j)</span></span></span><br><span><var>s</var><span class="hyp-type"><b>: </b><span>state (preloaded_with_all_messages_vlsm X)</span></span></span><br><span><var>im</var><span class="hyp-type"><b>: </b><span>option message</span></span></span><br><span><var>s'</var><span class="hyp-type"><b>: </b><span>state (preloaded_with_all_messages_vlsm X)</span></span></span><br><span><var>om</var><span class="hyp-type"><b>: </b><span>option message</span></span></span><br><span><var>Hptrans</var><span class="hyp-type"><b>: </b><span>input_constrained_transition X 
  (existT j lj) (s, im) (
  s&#39;, om)</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">s j = s&#39; j
‚à® (<span class="kr">‚àÉ</span> <span class="nv">li</span> : label (IM j),
     existT j lj = existT j li
     ‚àß input_constrained_transition (IM j) li
         (s j, im) (s&#39; j, om))</div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="Composition-v-chk10b" style="display: none" type="checkbox"><label class="alectryon-input" for="Composition-v-chk10b"><span class="nb">right</span>.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>V, message</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>EqDecision0</var><span class="hyp-type"><b>: </b><span>EqDecision V</span></span></span><br><span><var>IM</var><span class="hyp-type"><b>: </b><span>V ‚Üí VLSM message</span></span></span><br><span><var>X</var><span><span class="hyp-body"><b>:= </b><span>free_composite_vlsm IM</span></span><span class="hyp-type"><b>: </b><span>VLSM message</span></span></span></span><br><span><var>j</var><span class="hyp-type"><b>: </b><span>V</span></span></span><br><span><var>lj</var><span class="hyp-type"><b>: </b><span>label (IM j)</span></span></span><br><span><var>s</var><span class="hyp-type"><b>: </b><span>state (preloaded_with_all_messages_vlsm X)</span></span></span><br><span><var>im</var><span class="hyp-type"><b>: </b><span>option message</span></span></span><br><span><var>s'</var><span class="hyp-type"><b>: </b><span>state (preloaded_with_all_messages_vlsm X)</span></span></span><br><span><var>om</var><span class="hyp-type"><b>: </b><span>option message</span></span></span><br><span><var>Hptrans</var><span class="hyp-type"><b>: </b><span>input_constrained_transition X 
  (existT j lj) (s, im) (
  s&#39;, om)</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="kr">‚àÉ</span> <span class="nv">li</span> : label (IM j),
  existT j lj = existT j li
  ‚àß input_constrained_transition (IM j) li (s j, im)
      (s&#39; j, om)</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="Composition-v-chk10c" style="display: none" type="checkbox"><label class="alectryon-input" for="Composition-v-chk10c"><span class="kr">exists</span> <span class="nv">lj</span>.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>V, message</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>EqDecision0</var><span class="hyp-type"><b>: </b><span>EqDecision V</span></span></span><br><span><var>IM</var><span class="hyp-type"><b>: </b><span>V ‚Üí VLSM message</span></span></span><br><span><var>X</var><span><span class="hyp-body"><b>:= </b><span>free_composite_vlsm IM</span></span><span class="hyp-type"><b>: </b><span>VLSM message</span></span></span></span><br><span><var>j</var><span class="hyp-type"><b>: </b><span>V</span></span></span><br><span><var>lj</var><span class="hyp-type"><b>: </b><span>label (IM j)</span></span></span><br><span><var>s</var><span class="hyp-type"><b>: </b><span>state (preloaded_with_all_messages_vlsm X)</span></span></span><br><span><var>im</var><span class="hyp-type"><b>: </b><span>option message</span></span></span><br><span><var>s'</var><span class="hyp-type"><b>: </b><span>state (preloaded_with_all_messages_vlsm X)</span></span></span><br><span><var>om</var><span class="hyp-type"><b>: </b><span>option message</span></span></span><br><span><var>Hptrans</var><span class="hyp-type"><b>: </b><span>input_constrained_transition X 
  (existT j lj) (s, im) (
  s&#39;, om)</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">existT j lj = existT j lj
‚àß input_constrained_transition (IM j) lj (s j, im)
    (s&#39; j, om)</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="Composition-v-chk10d" style="display: none" type="checkbox"><label class="alectryon-input" for="Composition-v-chk10d"><span class="nb">split</span>; [<span class="bp">done</span> |].</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>V, message</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>EqDecision0</var><span class="hyp-type"><b>: </b><span>EqDecision V</span></span></span><br><span><var>IM</var><span class="hyp-type"><b>: </b><span>V ‚Üí VLSM message</span></span></span><br><span><var>X</var><span><span class="hyp-body"><b>:= </b><span>free_composite_vlsm IM</span></span><span class="hyp-type"><b>: </b><span>VLSM message</span></span></span></span><br><span><var>j</var><span class="hyp-type"><b>: </b><span>V</span></span></span><br><span><var>lj</var><span class="hyp-type"><b>: </b><span>label (IM j)</span></span></span><br><span><var>s</var><span class="hyp-type"><b>: </b><span>state (preloaded_with_all_messages_vlsm X)</span></span></span><br><span><var>im</var><span class="hyp-type"><b>: </b><span>option message</span></span></span><br><span><var>s'</var><span class="hyp-type"><b>: </b><span>state (preloaded_with_all_messages_vlsm X)</span></span></span><br><span><var>om</var><span class="hyp-type"><b>: </b><span>option message</span></span></span><br><span><var>Hptrans</var><span class="hyp-type"><b>: </b><span>input_constrained_transition X 
  (existT j lj) (s, im) (
  s&#39;, om)</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">input_constrained_transition (IM j) lj (s j, im)
  (s&#39; j, om)</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><span class="alectryon-input"><span class="bp">by</span> <span class="nb">revert</span> Hptrans; <span class="nb">apply</span> input_valid_transition_preloaded_project_active_free.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="Composition-v-chk10e" style="display: none" type="checkbox"><label class="alectryon-input" for="Composition-v-chk10e">-</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>V</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>i</var><span class="hyp-type"><b>: </b><span>V</span></span></span><br><span><var>message</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>EqDecision0</var><span class="hyp-type"><b>: </b><span>EqDecision V</span></span></span><br><span><var>IM</var><span class="hyp-type"><b>: </b><span>V ‚Üí VLSM message</span></span></span><br><span><var>X</var><span><span class="hyp-body"><b>:= </b><span>free_composite_vlsm IM</span></span><span class="hyp-type"><b>: </b><span>VLSM message</span></span></span></span><br><span><var>j</var><span class="hyp-type"><b>: </b><span>V</span></span></span><br><span><var>lj</var><span class="hyp-type"><b>: </b><span>label (IM j)</span></span></span><br><span><var>s</var><span class="hyp-type"><b>: </b><span>state (preloaded_with_all_messages_vlsm X)</span></span></span><br><span><var>im</var><span class="hyp-type"><b>: </b><span>option message</span></span></span><br><span><var>s'</var><span class="hyp-type"><b>: </b><span>state (preloaded_with_all_messages_vlsm X)</span></span></span><br><span><var>om</var><span class="hyp-type"><b>: </b><span>option message</span></span></span><br><span><var>Hptrans</var><span class="hyp-type"><b>: </b><span>input_constrained_transition X 
  (existT j lj) (s, im) (
  s&#39;, om)</span></span></span><br><span><var>n</var><span class="hyp-type"><b>: </b><span>i ‚â† j</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">s i = s&#39; i
‚à® (<span class="kr">‚àÉ</span> <span class="nv">li</span> : label (IM i),
     existT j lj = existT i li
     ‚àß input_constrained_transition (IM i) li
         (s i, im) (s&#39; i, om))</div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="Composition-v-chk10f" style="display: none" type="checkbox"><label class="alectryon-input" for="Composition-v-chk10f"><span class="nb">left</span>.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>V</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>i</var><span class="hyp-type"><b>: </b><span>V</span></span></span><br><span><var>message</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>EqDecision0</var><span class="hyp-type"><b>: </b><span>EqDecision V</span></span></span><br><span><var>IM</var><span class="hyp-type"><b>: </b><span>V ‚Üí VLSM message</span></span></span><br><span><var>X</var><span><span class="hyp-body"><b>:= </b><span>free_composite_vlsm IM</span></span><span class="hyp-type"><b>: </b><span>VLSM message</span></span></span></span><br><span><var>j</var><span class="hyp-type"><b>: </b><span>V</span></span></span><br><span><var>lj</var><span class="hyp-type"><b>: </b><span>label (IM j)</span></span></span><br><span><var>s</var><span class="hyp-type"><b>: </b><span>state (preloaded_with_all_messages_vlsm X)</span></span></span><br><span><var>im</var><span class="hyp-type"><b>: </b><span>option message</span></span></span><br><span><var>s'</var><span class="hyp-type"><b>: </b><span>state (preloaded_with_all_messages_vlsm X)</span></span></span><br><span><var>om</var><span class="hyp-type"><b>: </b><span>option message</span></span></span><br><span><var>Hptrans</var><span class="hyp-type"><b>: </b><span>input_constrained_transition X 
  (existT j lj) (s, im) (
  s&#39;, om)</span></span></span><br><span><var>n</var><span class="hyp-type"><b>: </b><span>i ‚â† j</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">s i = s&#39; i</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="Composition-v-chk110" style="display: none" type="checkbox"><label class="alectryon-input" for="Composition-v-chk110"><span class="nb">destruct</span> Hptrans <span class="kr">as</span> [Hpvalid Htrans]; <span class="nb">cbn</span> <span class="kr">in</span> Htrans.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>V</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>i</var><span class="hyp-type"><b>: </b><span>V</span></span></span><br><span><var>message</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>EqDecision0</var><span class="hyp-type"><b>: </b><span>EqDecision V</span></span></span><br><span><var>IM</var><span class="hyp-type"><b>: </b><span>V ‚Üí VLSM message</span></span></span><br><span><var>X</var><span><span class="hyp-body"><b>:= </b><span>free_composite_vlsm IM</span></span><span class="hyp-type"><b>: </b><span>VLSM message</span></span></span></span><br><span><var>j</var><span class="hyp-type"><b>: </b><span>V</span></span></span><br><span><var>lj</var><span class="hyp-type"><b>: </b><span>label (IM j)</span></span></span><br><span><var>s</var><span class="hyp-type"><b>: </b><span>state (preloaded_with_all_messages_vlsm X)</span></span></span><br><span><var>im</var><span class="hyp-type"><b>: </b><span>option message</span></span></span><br><span><var>s'</var><span class="hyp-type"><b>: </b><span>state (preloaded_with_all_messages_vlsm X)</span></span></span><br><span><var>om</var><span class="hyp-type"><b>: </b><span>option message</span></span></span><br><span><var>Hpvalid</var><span class="hyp-type"><b>: </b><span>input_valid
  (preloaded_with_all_messages_vlsm X)
  (existT j lj) (s, im)</span></span></span><br><span><var>Htrans</var><span class="hyp-type"><b>: </b><span>(<span class="kr">let</span> (<span class="nv">si&#39;</span>, om&#39;) := transition lj (s j, im) <span class="kr">in</span>
 (state_update IM s j si&#39;, om&#39;)) = (
s&#39;, om)</span></span></span><br><span><var>n</var><span class="hyp-type"><b>: </b><span>i ‚â† j</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">s i = s&#39; i</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="Composition-v-chk111" style="display: none" type="checkbox"><label class="alectryon-input" for="Composition-v-chk111"><span class="nb">destruct</span> (transition (IM j) lj (s j, im)); <span class="nb">inversion_clear</span> Htrans.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>V</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>i</var><span class="hyp-type"><b>: </b><span>V</span></span></span><br><span><var>message</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>EqDecision0</var><span class="hyp-type"><b>: </b><span>EqDecision V</span></span></span><br><span><var>IM</var><span class="hyp-type"><b>: </b><span>V ‚Üí VLSM message</span></span></span><br><span><var>X</var><span><span class="hyp-body"><b>:= </b><span>free_composite_vlsm IM</span></span><span class="hyp-type"><b>: </b><span>VLSM message</span></span></span></span><br><span><var>j</var><span class="hyp-type"><b>: </b><span>V</span></span></span><br><span><var>lj</var><span class="hyp-type"><b>: </b><span>label (IM j)</span></span></span><br><span><var>s</var><span class="hyp-type"><b>: </b><span>state (preloaded_with_all_messages_vlsm X)</span></span></span><br><span><var>im</var><span class="hyp-type"><b>: </b><span>option message</span></span></span><br><span><var>s'</var><span class="hyp-type"><b>: </b><span>state (preloaded_with_all_messages_vlsm X)</span></span></span><br><span><var>om</var><span class="hyp-type"><b>: </b><span>option message</span></span></span><br><span><var>Hpvalid</var><span class="hyp-type"><b>: </b><span>input_valid
  (preloaded_with_all_messages_vlsm X)
  (existT j lj) (s, im)</span></span></span><br><span><var>s0</var><span class="hyp-type"><b>: </b><span>state (IM j)</span></span></span><br><span><var>o</var><span class="hyp-type"><b>: </b><span>option message</span></span></span><br><span><var>n</var><span class="hyp-type"><b>: </b><span>i ‚â† j</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">s i = state_update IM s j s0 i</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><span class="alectryon-input"><span class="bp">by</span> state_update_simpl.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Qed</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
</span><span class="alectryon-sentence"><input class="alectryon-toggle" id="Composition-v-chk112" style="display: none" type="checkbox"><label class="alectryon-input" for="Composition-v-chk112"><span class="kn">Lemma</span> <span class="nf">input_valid_transition_preloaded_project_any</span>
  {<span class="nv">V</span> : <span class="kt">Type</span>} (<span class="nv">i</span> : V)
  {<span class="nv">message</span> : <span class="kt">Type</span>} `{EqDecision V} {IM : V -&gt; VLSM message} {constraint}
  (X := composite_vlsm IM constraint)
  (l : label X) s im s&#39; om :
  input_constrained_transition X l (s, im) (s&#39;, om) -&gt;
    s i = s&#39; i \/
    <span class="kr">exists</span> <span class="nv">li</span> : label (IM i),
      l = existT i li /\
      input_constrained_transition (IM i) li (s i, im) (s&#39; i, om).</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>V</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>i</var><span class="hyp-type"><b>: </b><span>V</span></span></span><br><span><var>message</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>EqDecision0</var><span class="hyp-type"><b>: </b><span>EqDecision V</span></span></span><br><span><var>IM</var><span class="hyp-type"><b>: </b><span>V ‚Üí VLSM message</span></span></span><br><span><var>constraint</var><span class="hyp-type"><b>: </b><span>composite_label IM
‚Üí composite_state IM * option message
  ‚Üí <span class="kt">Prop</span></span></span></span><br><span><var>X</var><span><span class="hyp-body"><b>:= </b><span>composite_vlsm IM constraint</span></span><span class="hyp-type"><b>: </b><span>VLSM message</span></span></span></span><br><span><var>l</var><span class="hyp-type"><b>: </b><span>label X</span></span></span><br><span><var>s</var><span class="hyp-type"><b>: </b><span>state (preloaded_with_all_messages_vlsm X)</span></span></span><br><span><var>im</var><span class="hyp-type"><b>: </b><span>option message</span></span></span><br><span><var>s'</var><span class="hyp-type"><b>: </b><span>state (preloaded_with_all_messages_vlsm X)</span></span></span><br><span><var>om</var><span class="hyp-type"><b>: </b><span>option message</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">input_constrained_transition X l (s, im) (s&#39;, om)
‚Üí s i = s&#39; i
  ‚à® (<span class="kr">‚àÉ</span> <span class="nv">li</span> : label (IM i),
       l = existT i li
       ‚àß input_constrained_transition (IM i) li
           (s i, im) (s&#39; i, om))</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="Composition-v-chk113" style="display: none" type="checkbox"><label class="alectryon-input" for="Composition-v-chk113"><span class="kn">Proof</span>.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>V</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>i</var><span class="hyp-type"><b>: </b><span>V</span></span></span><br><span><var>message</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>EqDecision0</var><span class="hyp-type"><b>: </b><span>EqDecision V</span></span></span><br><span><var>IM</var><span class="hyp-type"><b>: </b><span>V ‚Üí VLSM message</span></span></span><br><span><var>constraint</var><span class="hyp-type"><b>: </b><span>composite_label IM
‚Üí composite_state IM * option message
  ‚Üí <span class="kt">Prop</span></span></span></span><br><span><var>X</var><span><span class="hyp-body"><b>:= </b><span>composite_vlsm IM constraint</span></span><span class="hyp-type"><b>: </b><span>VLSM message</span></span></span></span><br><span><var>l</var><span class="hyp-type"><b>: </b><span>label X</span></span></span><br><span><var>s</var><span class="hyp-type"><b>: </b><span>state (preloaded_with_all_messages_vlsm X)</span></span></span><br><span><var>im</var><span class="hyp-type"><b>: </b><span>option message</span></span></span><br><span><var>s'</var><span class="hyp-type"><b>: </b><span>state (preloaded_with_all_messages_vlsm X)</span></span></span><br><span><var>om</var><span class="hyp-type"><b>: </b><span>option message</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">input_constrained_transition X l (s, im) (s&#39;, om)
‚Üí s i = s&#39; i
  ‚à® (<span class="kr">‚àÉ</span> <span class="nv">li</span> : label (IM i),
       l = existT i li
       ‚àß input_constrained_transition (IM i) li
           (s i, im) (s&#39; i, om))</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="Composition-v-chk114" style="display: none" type="checkbox"><label class="alectryon-input" for="Composition-v-chk114"><span class="nb">intros</span>.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>V</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>i</var><span class="hyp-type"><b>: </b><span>V</span></span></span><br><span><var>message</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>EqDecision0</var><span class="hyp-type"><b>: </b><span>EqDecision V</span></span></span><br><span><var>IM</var><span class="hyp-type"><b>: </b><span>V ‚Üí VLSM message</span></span></span><br><span><var>constraint</var><span class="hyp-type"><b>: </b><span>composite_label IM
‚Üí composite_state IM * option message
  ‚Üí <span class="kt">Prop</span></span></span></span><br><span><var>X</var><span><span class="hyp-body"><b>:= </b><span>composite_vlsm IM constraint</span></span><span class="hyp-type"><b>: </b><span>VLSM message</span></span></span></span><br><span><var>l</var><span class="hyp-type"><b>: </b><span>label X</span></span></span><br><span><var>s</var><span class="hyp-type"><b>: </b><span>state (preloaded_with_all_messages_vlsm X)</span></span></span><br><span><var>im</var><span class="hyp-type"><b>: </b><span>option message</span></span></span><br><span><var>s'</var><span class="hyp-type"><b>: </b><span>state (preloaded_with_all_messages_vlsm X)</span></span></span><br><span><var>om</var><span class="hyp-type"><b>: </b><span>option message</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>input_constrained_transition X l (s, im) (s&#39;, om)</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">s i = s&#39; i
‚à® (<span class="kr">‚àÉ</span> <span class="nv">li</span> : label (IM i),
     l = existT i li
     ‚àß input_constrained_transition (IM i) li
         (s i, im) (s&#39; i, om))</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="Composition-v-chk115" style="display: none" type="checkbox"><label class="alectryon-input" for="Composition-v-chk115"><span class="nb">apply</span> input_valid_transition_preloaded_project_any_free.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>V</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>i</var><span class="hyp-type"><b>: </b><span>V</span></span></span><br><span><var>message</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>EqDecision0</var><span class="hyp-type"><b>: </b><span>EqDecision V</span></span></span><br><span><var>IM</var><span class="hyp-type"><b>: </b><span>V ‚Üí VLSM message</span></span></span><br><span><var>constraint</var><span class="hyp-type"><b>: </b><span>composite_label IM
‚Üí composite_state IM * option message
  ‚Üí <span class="kt">Prop</span></span></span></span><br><span><var>X</var><span><span class="hyp-body"><b>:= </b><span>composite_vlsm IM constraint</span></span><span class="hyp-type"><b>: </b><span>VLSM message</span></span></span></span><br><span><var>l</var><span class="hyp-type"><b>: </b><span>label X</span></span></span><br><span><var>s</var><span class="hyp-type"><b>: </b><span>state (preloaded_with_all_messages_vlsm X)</span></span></span><br><span><var>im</var><span class="hyp-type"><b>: </b><span>option message</span></span></span><br><span><var>s'</var><span class="hyp-type"><b>: </b><span>state (preloaded_with_all_messages_vlsm X)</span></span></span><br><span><var>om</var><span class="hyp-type"><b>: </b><span>option message</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>input_constrained_transition X l (s, im) (s&#39;, om)</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">input_constrained_transition (free_composite_vlsm IM)
  l (s, im) (s&#39;, om)</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="Composition-v-chk116" style="display: none" type="checkbox"><label class="alectryon-input" for="Composition-v-chk116"><span class="nb">apply</span> (@VLSM_incl_input_valid_transition _ _ (preloaded_with_all_messages_vlsm X)); [| <span class="bp">done</span>].</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>V</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>i</var><span class="hyp-type"><b>: </b><span>V</span></span></span><br><span><var>message</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>EqDecision0</var><span class="hyp-type"><b>: </b><span>EqDecision V</span></span></span><br><span><var>IM</var><span class="hyp-type"><b>: </b><span>V ‚Üí VLSM message</span></span></span><br><span><var>constraint</var><span class="hyp-type"><b>: </b><span>composite_label IM
‚Üí composite_state IM * option message
  ‚Üí <span class="kt">Prop</span></span></span></span><br><span><var>X</var><span><span class="hyp-body"><b>:= </b><span>composite_vlsm IM constraint</span></span><span class="hyp-type"><b>: </b><span>VLSM message</span></span></span></span><br><span><var>l</var><span class="hyp-type"><b>: </b><span>label X</span></span></span><br><span><var>s</var><span class="hyp-type"><b>: </b><span>state (preloaded_with_all_messages_vlsm X)</span></span></span><br><span><var>im</var><span class="hyp-type"><b>: </b><span>option message</span></span></span><br><span><var>s'</var><span class="hyp-type"><b>: </b><span>state (preloaded_with_all_messages_vlsm X)</span></span></span><br><span><var>om</var><span class="hyp-type"><b>: </b><span>option message</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>input_constrained_transition X l (s, im) (s&#39;, om)</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">VLSM_incl_part (preloaded_with_all_messages_vlsm X)
  (preloaded_vlsm_machine (free_composite_vlsm IM)
     (<span class="kr">Œª</span> <span class="nv">_</span> : message, <span class="kt">True</span>))</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><span class="alectryon-input"><span class="bp">by</span> <span class="nb">apply</span> constrained_preloaded_vlsm_incl_preloaded_with_all_messages.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Qed</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
</span><span class="alectryon-sentence"><input class="alectryon-toggle" id="Composition-v-chk117" style="display: none" type="checkbox"><label class="alectryon-input" for="Composition-v-chk117"><span class="kn">Lemma</span> <span class="nf">input_valid_transition_project_any</span>
  {<span class="nv">V</span> : <span class="kt">Type</span>} (<span class="nv">i</span> : V)
  {<span class="nv">message</span> : <span class="kt">Type</span>} `{EqDecision V} {IM : V -&gt; VLSM message} {constraint}
  (X := composite_vlsm IM constraint)
  (l : label X) s im s&#39; om :
  input_valid_transition X l (s, im) (s&#39;, om) -&gt;
    s i = s&#39; i \/
    <span class="kr">exists</span> <span class="nv">li</span> : label (IM i),
      l = existT i li /\
      input_constrained_transition (IM i) li (s i, im) (s&#39; i, om).</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>V</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>i</var><span class="hyp-type"><b>: </b><span>V</span></span></span><br><span><var>message</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>EqDecision0</var><span class="hyp-type"><b>: </b><span>EqDecision V</span></span></span><br><span><var>IM</var><span class="hyp-type"><b>: </b><span>V ‚Üí VLSM message</span></span></span><br><span><var>constraint</var><span class="hyp-type"><b>: </b><span>composite_label IM
‚Üí composite_state IM * option message
  ‚Üí <span class="kt">Prop</span></span></span></span><br><span><var>X</var><span><span class="hyp-body"><b>:= </b><span>composite_vlsm IM constraint</span></span><span class="hyp-type"><b>: </b><span>VLSM message</span></span></span></span><br><span><var>l</var><span class="hyp-type"><b>: </b><span>label X</span></span></span><br><span><var>s</var><span class="hyp-type"><b>: </b><span>state X</span></span></span><br><span><var>im</var><span class="hyp-type"><b>: </b><span>option message</span></span></span><br><span><var>s'</var><span class="hyp-type"><b>: </b><span>state X</span></span></span><br><span><var>om</var><span class="hyp-type"><b>: </b><span>option message</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">input_valid_transition X l (s, im) (s&#39;, om)
‚Üí s i = s&#39; i
  ‚à® (<span class="kr">‚àÉ</span> <span class="nv">li</span> : label (IM i),
       l = existT i li
       ‚àß input_constrained_transition (IM i) li
           (s i, im) (s&#39; i, om))</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="Composition-v-chk118" style="display: none" type="checkbox"><label class="alectryon-input" for="Composition-v-chk118"><span class="kn">Proof</span>.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>V</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>i</var><span class="hyp-type"><b>: </b><span>V</span></span></span><br><span><var>message</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>EqDecision0</var><span class="hyp-type"><b>: </b><span>EqDecision V</span></span></span><br><span><var>IM</var><span class="hyp-type"><b>: </b><span>V ‚Üí VLSM message</span></span></span><br><span><var>constraint</var><span class="hyp-type"><b>: </b><span>composite_label IM
‚Üí composite_state IM * option message
  ‚Üí <span class="kt">Prop</span></span></span></span><br><span><var>X</var><span><span class="hyp-body"><b>:= </b><span>composite_vlsm IM constraint</span></span><span class="hyp-type"><b>: </b><span>VLSM message</span></span></span></span><br><span><var>l</var><span class="hyp-type"><b>: </b><span>label X</span></span></span><br><span><var>s</var><span class="hyp-type"><b>: </b><span>state X</span></span></span><br><span><var>im</var><span class="hyp-type"><b>: </b><span>option message</span></span></span><br><span><var>s'</var><span class="hyp-type"><b>: </b><span>state X</span></span></span><br><span><var>om</var><span class="hyp-type"><b>: </b><span>option message</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">input_valid_transition X l (s, im) (s&#39;, om)
‚Üí s i = s&#39; i
  ‚à® (<span class="kr">‚àÉ</span> <span class="nv">li</span> : label (IM i),
       l = existT i li
       ‚àß input_constrained_transition (IM i) li
           (s i, im) (s&#39; i, om))</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="Composition-v-chk119" style="display: none" type="checkbox"><label class="alectryon-input" for="Composition-v-chk119"><span class="nb">intro</span> Hproto.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>V</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>i</var><span class="hyp-type"><b>: </b><span>V</span></span></span><br><span><var>message</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>EqDecision0</var><span class="hyp-type"><b>: </b><span>EqDecision V</span></span></span><br><span><var>IM</var><span class="hyp-type"><b>: </b><span>V ‚Üí VLSM message</span></span></span><br><span><var>constraint</var><span class="hyp-type"><b>: </b><span>composite_label IM
‚Üí composite_state IM * option message
  ‚Üí <span class="kt">Prop</span></span></span></span><br><span><var>X</var><span><span class="hyp-body"><b>:= </b><span>composite_vlsm IM constraint</span></span><span class="hyp-type"><b>: </b><span>VLSM message</span></span></span></span><br><span><var>l</var><span class="hyp-type"><b>: </b><span>label X</span></span></span><br><span><var>s</var><span class="hyp-type"><b>: </b><span>state X</span></span></span><br><span><var>im</var><span class="hyp-type"><b>: </b><span>option message</span></span></span><br><span><var>s'</var><span class="hyp-type"><b>: </b><span>state X</span></span></span><br><span><var>om</var><span class="hyp-type"><b>: </b><span>option message</span></span></span><br><span><var>Hproto</var><span class="hyp-type"><b>: </b><span>input_valid_transition X l (s, im) (s&#39;, om)</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">s i = s&#39; i
‚à® (<span class="kr">‚àÉ</span> <span class="nv">li</span> : label (IM i),
     l = existT i li
     ‚àß input_constrained_transition (IM i) li
         (s i, im) (s&#39; i, om))</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="Composition-v-chk11a" style="display: none" type="checkbox"><label class="alectryon-input" for="Composition-v-chk11a"><span class="nb">apply</span> preloaded_weaken_input_valid_transition <span class="kr">in</span> Hproto.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>V</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>i</var><span class="hyp-type"><b>: </b><span>V</span></span></span><br><span><var>message</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>EqDecision0</var><span class="hyp-type"><b>: </b><span>EqDecision V</span></span></span><br><span><var>IM</var><span class="hyp-type"><b>: </b><span>V ‚Üí VLSM message</span></span></span><br><span><var>constraint</var><span class="hyp-type"><b>: </b><span>composite_label IM
‚Üí composite_state IM * option message
  ‚Üí <span class="kt">Prop</span></span></span></span><br><span><var>X</var><span><span class="hyp-body"><b>:= </b><span>composite_vlsm IM constraint</span></span><span class="hyp-type"><b>: </b><span>VLSM message</span></span></span></span><br><span><var>l</var><span class="hyp-type"><b>: </b><span>label X</span></span></span><br><span><var>s</var><span class="hyp-type"><b>: </b><span>state X</span></span></span><br><span><var>im</var><span class="hyp-type"><b>: </b><span>option message</span></span></span><br><span><var>s'</var><span class="hyp-type"><b>: </b><span>state X</span></span></span><br><span><var>om</var><span class="hyp-type"><b>: </b><span>option message</span></span></span><br><span><var>Hproto</var><span class="hyp-type"><b>: </b><span>input_constrained_transition X l (
  s, im) (s&#39;, om)</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">s i = s&#39; i
‚à® (<span class="kr">‚àÉ</span> <span class="nv">li</span> : label (IM i),
     l = existT i li
     ‚àß input_constrained_transition (IM i) li
         (s i, im) (s&#39; i, om))</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><span class="alectryon-input"><span class="bp">by</span> <span class="nb">revert</span> Hproto; <span class="nb">apply</span> input_valid_transition_preloaded_project_any.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Qed</span>.</span></span></pre><div class="doc">
  If a message can be emitted by a composition, then it can be emitted by one of the
  components.

</div><pre class="alectryon-io highlight"><!-- Generator: Alectryon --><span class="alectryon-sentence"><input class="alectryon-toggle" id="Composition-v-chk11b" style="display: none" type="checkbox"><label class="alectryon-input" for="Composition-v-chk11b"><span class="kn">Lemma</span> <span class="nf">can_emit_free_composite_project</span>
  {<span class="nv">message</span> : <span class="kt">Type</span>} `{EqDecision V} {IM : V -&gt; VLSM message}
  (X := free_composite_vlsm IM)
  (m : message)
  (Hemit : can_emit (preloaded_with_all_messages_vlsm X) m) :
    <span class="kr">exists</span> (<span class="nv">j</span> : V), can_emit (preloaded_with_all_messages_vlsm (IM j)) m.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>message, V</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>EqDecision0</var><span class="hyp-type"><b>: </b><span>EqDecision V</span></span></span><br><span><var>IM</var><span class="hyp-type"><b>: </b><span>V ‚Üí VLSM message</span></span></span><br><span><var>X</var><span><span class="hyp-body"><b>:= </b><span>free_composite_vlsm IM</span></span><span class="hyp-type"><b>: </b><span>VLSM message</span></span></span></span><br><span><var>m</var><span class="hyp-type"><b>: </b><span>message</span></span></span><br><span><var>Hemit</var><span class="hyp-type"><b>: </b><span>can_emit (preloaded_with_all_messages_vlsm X)
  m</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="kr">‚àÉ</span> <span class="nv">j</span> : V,
  can_emit (preloaded_with_all_messages_vlsm (IM j)) m</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="Composition-v-chk11c" style="display: none" type="checkbox"><label class="alectryon-input" for="Composition-v-chk11c"><span class="kn">Proof</span>.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>message, V</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>EqDecision0</var><span class="hyp-type"><b>: </b><span>EqDecision V</span></span></span><br><span><var>IM</var><span class="hyp-type"><b>: </b><span>V ‚Üí VLSM message</span></span></span><br><span><var>X</var><span><span class="hyp-body"><b>:= </b><span>free_composite_vlsm IM</span></span><span class="hyp-type"><b>: </b><span>VLSM message</span></span></span></span><br><span><var>m</var><span class="hyp-type"><b>: </b><span>message</span></span></span><br><span><var>Hemit</var><span class="hyp-type"><b>: </b><span>can_emit (preloaded_with_all_messages_vlsm X)
  m</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="kr">‚àÉ</span> <span class="nv">j</span> : V,
  can_emit (preloaded_with_all_messages_vlsm (IM j)) m</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="Composition-v-chk11d" style="display: none" type="checkbox"><label class="alectryon-input" for="Composition-v-chk11d"><span class="nb">apply</span> can_emit_iff <span class="kr">in</span> Hemit <span class="kr">as</span> (s2 &amp; [s1 oim] &amp; l &amp; Ht).</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>message, V</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>EqDecision0</var><span class="hyp-type"><b>: </b><span>EqDecision V</span></span></span><br><span><var>IM</var><span class="hyp-type"><b>: </b><span>V ‚Üí VLSM message</span></span></span><br><span><var>X</var><span><span class="hyp-body"><b>:= </b><span>free_composite_vlsm IM</span></span><span class="hyp-type"><b>: </b><span>VLSM message</span></span></span></span><br><span><var>m</var><span class="hyp-type"><b>: </b><span>message</span></span></span><br><span><var>s2, s1</var><span class="hyp-type"><b>: </b><span>state (preloaded_with_all_messages_vlsm X)</span></span></span><br><span><var>oim</var><span class="hyp-type"><b>: </b><span>option message</span></span></span><br><span><var>l</var><span class="hyp-type"><b>: </b><span>label (preloaded_with_all_messages_vlsm X)</span></span></span><br><span><var>Ht</var><span class="hyp-type"><b>: </b><span>input_valid_transition
  (preloaded_with_all_messages_vlsm X) l
  (s1, oim) (s2, Some m)</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="kr">‚àÉ</span> <span class="nv">j</span> : V,
  can_emit (preloaded_with_all_messages_vlsm (IM j)) m</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="Composition-v-chk11e" style="display: none" type="checkbox"><label class="alectryon-input" for="Composition-v-chk11e"><span class="kr">exists</span> (<span class="nv">projT1</span> <span class="nv">l</span>).</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>message, V</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>EqDecision0</var><span class="hyp-type"><b>: </b><span>EqDecision V</span></span></span><br><span><var>IM</var><span class="hyp-type"><b>: </b><span>V ‚Üí VLSM message</span></span></span><br><span><var>X</var><span><span class="hyp-body"><b>:= </b><span>free_composite_vlsm IM</span></span><span class="hyp-type"><b>: </b><span>VLSM message</span></span></span></span><br><span><var>m</var><span class="hyp-type"><b>: </b><span>message</span></span></span><br><span><var>s2, s1</var><span class="hyp-type"><b>: </b><span>state (preloaded_with_all_messages_vlsm X)</span></span></span><br><span><var>oim</var><span class="hyp-type"><b>: </b><span>option message</span></span></span><br><span><var>l</var><span class="hyp-type"><b>: </b><span>label (preloaded_with_all_messages_vlsm X)</span></span></span><br><span><var>Ht</var><span class="hyp-type"><b>: </b><span>input_valid_transition
  (preloaded_with_all_messages_vlsm X) l
  (s1, oim) (s2, Some m)</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">can_emit
  (preloaded_with_all_messages_vlsm (IM (projT1 l))) m</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="Composition-v-chk11f" style="display: none" type="checkbox"><label class="alectryon-input" for="Composition-v-chk11f"><span class="nb">apply</span> can_emit_iff.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>message, V</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>EqDecision0</var><span class="hyp-type"><b>: </b><span>EqDecision V</span></span></span><br><span><var>IM</var><span class="hyp-type"><b>: </b><span>V ‚Üí VLSM message</span></span></span><br><span><var>X</var><span><span class="hyp-body"><b>:= </b><span>free_composite_vlsm IM</span></span><span class="hyp-type"><b>: </b><span>VLSM message</span></span></span></span><br><span><var>m</var><span class="hyp-type"><b>: </b><span>message</span></span></span><br><span><var>s2, s1</var><span class="hyp-type"><b>: </b><span>state (preloaded_with_all_messages_vlsm X)</span></span></span><br><span><var>oim</var><span class="hyp-type"><b>: </b><span>option message</span></span></span><br><span><var>l</var><span class="hyp-type"><b>: </b><span>label (preloaded_with_all_messages_vlsm X)</span></span></span><br><span><var>Ht</var><span class="hyp-type"><b>: </b><span>input_valid_transition
  (preloaded_with_all_messages_vlsm X) l
  (s1, oim) (s2, Some m)</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="kr">‚àÉ</span> <span class="nv">s</span> : state
        (preloaded_with_all_messages_vlsm
           (IM (projT1 l))),
  can_produce
    (preloaded_with_all_messages_vlsm (IM (projT1 l)))
    s m</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="Composition-v-chk120" style="display: none" type="checkbox"><label class="alectryon-input" for="Composition-v-chk120"><span class="kr">exists</span> (<span class="nv">s2</span> (projT1 l)), (s1 (projT1 l), oim), (projT2 l).</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>message, V</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>EqDecision0</var><span class="hyp-type"><b>: </b><span>EqDecision V</span></span></span><br><span><var>IM</var><span class="hyp-type"><b>: </b><span>V ‚Üí VLSM message</span></span></span><br><span><var>X</var><span><span class="hyp-body"><b>:= </b><span>free_composite_vlsm IM</span></span><span class="hyp-type"><b>: </b><span>VLSM message</span></span></span></span><br><span><var>m</var><span class="hyp-type"><b>: </b><span>message</span></span></span><br><span><var>s2, s1</var><span class="hyp-type"><b>: </b><span>state (preloaded_with_all_messages_vlsm X)</span></span></span><br><span><var>oim</var><span class="hyp-type"><b>: </b><span>option message</span></span></span><br><span><var>l</var><span class="hyp-type"><b>: </b><span>label (preloaded_with_all_messages_vlsm X)</span></span></span><br><span><var>Ht</var><span class="hyp-type"><b>: </b><span>input_valid_transition
  (preloaded_with_all_messages_vlsm X) l
  (s1, oim) (s2, Some m)</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">input_valid_transition
  (preloaded_with_all_messages_vlsm (IM (projT1 l)))
  (projT2 l) (s1 (projT1 l), oim)
  (s2 (projT1 l), Some m)</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><span class="alectryon-input"><span class="bp">by</span> <span class="nb">eapply</span> input_valid_transition_preloaded_project_active_free.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Qed</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
</span><span class="alectryon-sentence"><input class="alectryon-toggle" id="Composition-v-chk121" style="display: none" type="checkbox"><label class="alectryon-input" for="Composition-v-chk121"><span class="kn">Lemma</span> <span class="nf">can_emit_composite_project</span>
  {<span class="nv">message</span> : <span class="kt">Type</span>} `{EqDecision V} {IM : V -&gt; VLSM message} {constraint}
  (X := composite_vlsm IM constraint)
  (m : message)
  (Hemit : can_emit (preloaded_with_all_messages_vlsm X) m) :
    <span class="kr">exists</span> (<span class="nv">j</span> : V), can_emit (preloaded_with_all_messages_vlsm (IM j)) m.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>message, V</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>EqDecision0</var><span class="hyp-type"><b>: </b><span>EqDecision V</span></span></span><br><span><var>IM</var><span class="hyp-type"><b>: </b><span>V ‚Üí VLSM message</span></span></span><br><span><var>constraint</var><span class="hyp-type"><b>: </b><span>composite_label IM
‚Üí composite_state IM * option message
  ‚Üí <span class="kt">Prop</span></span></span></span><br><span><var>X</var><span><span class="hyp-body"><b>:= </b><span>composite_vlsm IM constraint</span></span><span class="hyp-type"><b>: </b><span>VLSM message</span></span></span></span><br><span><var>m</var><span class="hyp-type"><b>: </b><span>message</span></span></span><br><span><var>Hemit</var><span class="hyp-type"><b>: </b><span>can_emit (preloaded_with_all_messages_vlsm X)
  m</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="kr">‚àÉ</span> <span class="nv">j</span> : V,
  can_emit (preloaded_with_all_messages_vlsm (IM j)) m</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="Composition-v-chk122" style="display: none" type="checkbox"><label class="alectryon-input" for="Composition-v-chk122"><span class="kn">Proof</span>.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>message, V</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>EqDecision0</var><span class="hyp-type"><b>: </b><span>EqDecision V</span></span></span><br><span><var>IM</var><span class="hyp-type"><b>: </b><span>V ‚Üí VLSM message</span></span></span><br><span><var>constraint</var><span class="hyp-type"><b>: </b><span>composite_label IM
‚Üí composite_state IM * option message
  ‚Üí <span class="kt">Prop</span></span></span></span><br><span><var>X</var><span><span class="hyp-body"><b>:= </b><span>composite_vlsm IM constraint</span></span><span class="hyp-type"><b>: </b><span>VLSM message</span></span></span></span><br><span><var>m</var><span class="hyp-type"><b>: </b><span>message</span></span></span><br><span><var>Hemit</var><span class="hyp-type"><b>: </b><span>can_emit (preloaded_with_all_messages_vlsm X)
  m</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="kr">‚àÉ</span> <span class="nv">j</span> : V,
  can_emit (preloaded_with_all_messages_vlsm (IM j)) m</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="Composition-v-chk123" style="display: none" type="checkbox"><label class="alectryon-input" for="Composition-v-chk123"><span class="nb">apply</span> can_emit_free_composite_project.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>message, V</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>EqDecision0</var><span class="hyp-type"><b>: </b><span>EqDecision V</span></span></span><br><span><var>IM</var><span class="hyp-type"><b>: </b><span>V ‚Üí VLSM message</span></span></span><br><span><var>constraint</var><span class="hyp-type"><b>: </b><span>composite_label IM
‚Üí composite_state IM * option message
  ‚Üí <span class="kt">Prop</span></span></span></span><br><span><var>X</var><span><span class="hyp-body"><b>:= </b><span>composite_vlsm IM constraint</span></span><span class="hyp-type"><b>: </b><span>VLSM message</span></span></span></span><br><span><var>m</var><span class="hyp-type"><b>: </b><span>message</span></span></span><br><span><var>Hemit</var><span class="hyp-type"><b>: </b><span>can_emit (preloaded_with_all_messages_vlsm X)
  m</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">can_emit
  (preloaded_with_all_messages_vlsm
     (free_composite_vlsm IM)) m</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="Composition-v-chk124" style="display: none" type="checkbox"><label class="alectryon-input" for="Composition-v-chk124"><span class="nb">eapply</span> VLSM_incl_can_emit; [| <span class="bp">done</span>].</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>message, V</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>EqDecision0</var><span class="hyp-type"><b>: </b><span>EqDecision V</span></span></span><br><span><var>IM</var><span class="hyp-type"><b>: </b><span>V ‚Üí VLSM message</span></span></span><br><span><var>constraint</var><span class="hyp-type"><b>: </b><span>composite_label IM
‚Üí composite_state IM * option message
  ‚Üí <span class="kt">Prop</span></span></span></span><br><span><var>X</var><span><span class="hyp-body"><b>:= </b><span>composite_vlsm IM constraint</span></span><span class="hyp-type"><b>: </b><span>VLSM message</span></span></span></span><br><span><var>m</var><span class="hyp-type"><b>: </b><span>message</span></span></span><br><span><var>Hemit</var><span class="hyp-type"><b>: </b><span>can_emit (preloaded_with_all_messages_vlsm X)
  m</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">VLSM_incl_part
  (preloaded_vlsm_machine X (<span class="kr">Œª</span> <span class="nv">_</span> : message, <span class="kt">True</span>))
  (preloaded_vlsm_machine (free_composite_vlsm IM)
     (<span class="kr">Œª</span> <span class="nv">_</span> : message, <span class="kt">True</span>))</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><span class="alectryon-input"><span class="bp">by</span> <span class="nb">apply</span> constrained_preloaded_vlsm_incl_preloaded_with_all_messages.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Qed</span>.</span></span></pre><div class="doc">
<a id="lab8"></a><h2 class="section">Binary free composition</h2>
<div class="paragraph"> </div>

  This serves an example of how composition can be built, but is also being
  used in defining the <span class="inlinecode"><span class="id" title="var">byzantine_trace_prop</span></span>erties.

<div class="paragraph"> </div>

  This instantiates the regular composition using the <span class="inlinecode"><span class="id" title="var">bool</span></span> type as an <code>index</code>.

</div><pre class="alectryon-io highlight"><!-- Generator: Alectryon --><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Section</span> <span class="nf">sec_binary_free_composition</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
</span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Context</span>
  {<span class="nv">message</span> : <span class="kt">Type</span>}
  (<span class="nv">M1</span> <span class="nv">M2</span> : VLSM message)
  .</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
</span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Definition</span> <span class="nf">binary_index</span> : <span class="kt">Set</span> := bool.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
</span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Definition</span> <span class="nf">first</span> : binary_index := true.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Definition</span> <span class="nf">second</span> : binary_index := false.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
</span><span class="alectryon-sentence"><span class="alectryon-input">#[export] <span class="kn">Instance</span> <span class="nf">binary_index_dec</span> :  EqDecision binary_index := _.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><span class="alectryon-input">#[export] <span class="kn">Instance</span> <span class="nf">binary_index_inhabited</span> : Inhabited binary_index := populate <span class="kp">first</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
</span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Definition</span> <span class="nf">binary_IM</span>
  (<span class="nv">i</span> : binary_index)
  : VLSM message
  :=
  <span class="kr">match</span> i <span class="kr">with</span>
  | true =&gt; M1
  | false =&gt; M2
  <span class="kr">end</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
</span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Definition</span> <span class="nf">binary_free_composition</span> : VLSM message :=
  composite_vlsm binary_IM (free_constraint binary_IM).</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
</span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">End</span> <span class="nf">sec_binary_free_composition</span>.</span></span></pre><div class="doc">
<a id="lab9"></a><h2 class="section">Composite decidable initial message</h2>
<div class="paragraph"> </div>

  Here we show that if the <span class="inlinecode"><span class="id" title="var">initial_message_prop</span></span>erty is decidable for every
  component, then it is decidable for a finite composition as well.

</div><pre class="alectryon-io highlight"><!-- Generator: Alectryon --><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Section</span> <span class="nf">sec_composite_decidable_initial_message</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
</span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Context</span>
  {<span class="nv">message</span> : <span class="kt">Type</span>}
  `{finite.Finite index}
  (IM : index -&gt; VLSM message)
  (constraint : composite_label IM -&gt; composite_state IM * option message -&gt; <span class="kt">Prop</span>)
  .</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
</span><span class="alectryon-sentence"><input class="alectryon-toggle" id="Composition-v-chk125" style="display: none" type="checkbox"><label class="alectryon-input" for="Composition-v-chk125"><span class="kn">Lemma</span> <span class="nf">composite_decidable_initial_message</span>
  (<span class="nv">Hdec_init</span> : <span class="kr">forall</span> <span class="nv">i</span>, decidable_initial_messages_prop (IM i))
  : decidable_initial_messages_prop (composite_vlsm IM constraint).</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>message, index</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>EqDecision0</var><span class="hyp-type"><b>: </b><span>EqDecision index</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>finite.Finite index</span></span></span><br><span><var>IM</var><span class="hyp-type"><b>: </b><span>index ‚Üí VLSM message</span></span></span><br><span><var>constraint</var><span class="hyp-type"><b>: </b><span>composite_label IM
‚Üí composite_state IM * option message
  ‚Üí <span class="kt">Prop</span></span></span></span><br><span><var>Hdec_init</var><span class="hyp-type"><b>: </b><span><span class="kr">‚àÄ</span> <span class="nv">i</span> : index,
  decidable_initial_messages_prop (IM i)</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">decidable_initial_messages_prop
  (composite_vlsm IM constraint)</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="Composition-v-chk126" style="display: none" type="checkbox"><label class="alectryon-input" for="Composition-v-chk126"><span class="kn">Proof</span>.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>message, index</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>EqDecision0</var><span class="hyp-type"><b>: </b><span>EqDecision index</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>finite.Finite index</span></span></span><br><span><var>IM</var><span class="hyp-type"><b>: </b><span>index ‚Üí VLSM message</span></span></span><br><span><var>constraint</var><span class="hyp-type"><b>: </b><span>composite_label IM
‚Üí composite_state IM * option message
  ‚Üí <span class="kt">Prop</span></span></span></span><br><span><var>Hdec_init</var><span class="hyp-type"><b>: </b><span><span class="kr">‚àÄ</span> <span class="nv">i</span> : index,
  decidable_initial_messages_prop (IM i)</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">decidable_initial_messages_prop
  (composite_vlsm IM constraint)</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="Composition-v-chk127" style="display: none" type="checkbox"><label class="alectryon-input" for="Composition-v-chk127"><span class="nb">intro</span> m.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>message, index</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>EqDecision0</var><span class="hyp-type"><b>: </b><span>EqDecision index</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>finite.Finite index</span></span></span><br><span><var>IM</var><span class="hyp-type"><b>: </b><span>index ‚Üí VLSM message</span></span></span><br><span><var>constraint</var><span class="hyp-type"><b>: </b><span>composite_label IM
‚Üí composite_state IM * option message
  ‚Üí <span class="kt">Prop</span></span></span></span><br><span><var>Hdec_init</var><span class="hyp-type"><b>: </b><span><span class="kr">‚àÄ</span> <span class="nv">i</span> : index,
  decidable_initial_messages_prop (IM i)</span></span></span><br><span><var>m</var><span class="hyp-type"><b>: </b><span>message</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">Decision (initial_message_prop m)</div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="Composition-v-chk128" style="display: none" type="checkbox"><label class="alectryon-input" for="Composition-v-chk128"><span class="nb">simpl</span>.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>message, index</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>EqDecision0</var><span class="hyp-type"><b>: </b><span>EqDecision index</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>finite.Finite index</span></span></span><br><span><var>IM</var><span class="hyp-type"><b>: </b><span>index ‚Üí VLSM message</span></span></span><br><span><var>constraint</var><span class="hyp-type"><b>: </b><span>composite_label IM
‚Üí composite_state IM * option message
  ‚Üí <span class="kt">Prop</span></span></span></span><br><span><var>Hdec_init</var><span class="hyp-type"><b>: </b><span><span class="kr">‚àÄ</span> <span class="nv">i</span> : index,
  decidable_initial_messages_prop (IM i)</span></span></span><br><span><var>m</var><span class="hyp-type"><b>: </b><span>message</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">Decision (composite_initial_message_prop IM m)</div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="Composition-v-chk129" style="display: none" type="checkbox"><label class="alectryon-input" for="Composition-v-chk129"><span class="nb">unfold</span> composite_initial_message_prop.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>message, index</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>EqDecision0</var><span class="hyp-type"><b>: </b><span>EqDecision index</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>finite.Finite index</span></span></span><br><span><var>IM</var><span class="hyp-type"><b>: </b><span>index ‚Üí VLSM message</span></span></span><br><span><var>constraint</var><span class="hyp-type"><b>: </b><span>composite_label IM
‚Üí composite_state IM * option message
  ‚Üí <span class="kt">Prop</span></span></span></span><br><span><var>Hdec_init</var><span class="hyp-type"><b>: </b><span><span class="kr">‚àÄ</span> <span class="nv">i</span> : index,
  decidable_initial_messages_prop (IM i)</span></span></span><br><span><var>m</var><span class="hyp-type"><b>: </b><span>message</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">Decision
  (<span class="kr">‚àÉ</span> (<span class="nv">n</span> : index) (<span class="nv">mi</span> : initial_message (IM n)),
     `mi = m)</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="Composition-v-chk12a" style="display: none" type="checkbox"><label class="alectryon-input" for="Composition-v-chk12a"><span class="nb">apply</span>
    (Decision_iff
      (P := List.Exists (<span class="kr">fun</span> <span class="nv">i</span> =&gt; initial_message_prop (IM i) m) (enum index))).</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>message, index</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>EqDecision0</var><span class="hyp-type"><b>: </b><span>EqDecision index</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>finite.Finite index</span></span></span><br><span><var>IM</var><span class="hyp-type"><b>: </b><span>index ‚Üí VLSM message</span></span></span><br><span><var>constraint</var><span class="hyp-type"><b>: </b><span>composite_label IM
‚Üí composite_state IM * option message
  ‚Üí <span class="kt">Prop</span></span></span></span><br><span><var>Hdec_init</var><span class="hyp-type"><b>: </b><span><span class="kr">‚àÄ</span> <span class="nv">i</span> : index,
  decidable_initial_messages_prop (IM i)</span></span></span><br><span><var>m</var><span class="hyp-type"><b>: </b><span>message</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">List.Exists (<span class="kr">Œª</span> <span class="nv">i</span> : index, initial_message_prop m)
  (enum index)
‚Üî (<span class="kr">‚àÉ</span> (<span class="nv">n</span> : index) (<span class="nv">mi</span> : initial_message (IM n)),
     `mi = m)</div></blockquote><div class="alectryon-extra-goals"><input class="alectryon-extra-goal-toggle" id="Composition-v-chk12b" style="display: none" type="checkbox"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>message, index</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>EqDecision0</var><span class="hyp-type"><b>: </b><span>EqDecision index</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>finite.Finite index</span></span></span><br><span><var>IM</var><span class="hyp-type"><b>: </b><span>index ‚Üí VLSM message</span></span></span><br><span><var>constraint</var><span class="hyp-type"><b>: </b><span>composite_label IM
‚Üí composite_state IM * option message
  ‚Üí <span class="kt">Prop</span></span></span></span><br><span><var>Hdec_init</var><span class="hyp-type"><b>: </b><span><span class="kr">‚àÄ</span> <span class="nv">i</span> : index,
  decidable_initial_messages_prop (IM i)</span></span></span><br><span><var>m</var><span class="hyp-type"><b>: </b><span>message</span></span></span><br></div><label class="goal-separator" for="Composition-v-chk12b"><hr></label><div class="goal-conclusion">Decision
  (List.Exists (<span class="kr">Œª</span> <span class="nv">i</span> : index, initial_message_prop m)
     (enum index))</div></blockquote></div></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="Composition-v-chk12c" style="display: none" type="checkbox"><label class="alectryon-input" for="Composition-v-chk12c">-</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>message, index</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>EqDecision0</var><span class="hyp-type"><b>: </b><span>EqDecision index</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>finite.Finite index</span></span></span><br><span><var>IM</var><span class="hyp-type"><b>: </b><span>index ‚Üí VLSM message</span></span></span><br><span><var>constraint</var><span class="hyp-type"><b>: </b><span>composite_label IM
‚Üí composite_state IM * option message
  ‚Üí <span class="kt">Prop</span></span></span></span><br><span><var>Hdec_init</var><span class="hyp-type"><b>: </b><span><span class="kr">‚àÄ</span> <span class="nv">i</span> : index,
  decidable_initial_messages_prop (IM i)</span></span></span><br><span><var>m</var><span class="hyp-type"><b>: </b><span>message</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">List.Exists (<span class="kr">Œª</span> <span class="nv">i</span> : index, initial_message_prop m)
  (enum index)
‚Üî (<span class="kr">‚àÉ</span> (<span class="nv">n</span> : index) (<span class="nv">mi</span> : initial_message (IM n)),
     `mi = m)</div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="Composition-v-chk12d" style="display: none" type="checkbox"><label class="alectryon-input" for="Composition-v-chk12d"><span class="nb">rewrite</span> Exists_finite.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>message, index</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>EqDecision0</var><span class="hyp-type"><b>: </b><span>EqDecision index</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>finite.Finite index</span></span></span><br><span><var>IM</var><span class="hyp-type"><b>: </b><span>index ‚Üí VLSM message</span></span></span><br><span><var>constraint</var><span class="hyp-type"><b>: </b><span>composite_label IM
‚Üí composite_state IM * option message
  ‚Üí <span class="kt">Prop</span></span></span></span><br><span><var>Hdec_init</var><span class="hyp-type"><b>: </b><span><span class="kr">‚àÄ</span> <span class="nv">i</span> : index,
  decidable_initial_messages_prop (IM i)</span></span></span><br><span><var>m</var><span class="hyp-type"><b>: </b><span>message</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">(<span class="kr">‚àÉ</span> <span class="nv">x</span> : index, initial_message_prop m)
‚Üî (<span class="kr">‚àÉ</span> (<span class="nv">n</span> : index) (<span class="nv">mi</span> : initial_message (IM n)),
     `mi = m)</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="Composition-v-chk12e" style="display: none" type="checkbox"><label class="alectryon-input" for="Composition-v-chk12e"><span class="nb">split</span>; <span class="nb">intros</span> [i Hm]; <span class="kr">exists</span> <span class="nv">i</span>.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>message, index</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>EqDecision0</var><span class="hyp-type"><b>: </b><span>EqDecision index</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>finite.Finite index</span></span></span><br><span><var>IM</var><span class="hyp-type"><b>: </b><span>index ‚Üí VLSM message</span></span></span><br><span><var>constraint</var><span class="hyp-type"><b>: </b><span>composite_label IM
‚Üí composite_state IM * option message
  ‚Üí <span class="kt">Prop</span></span></span></span><br><span><var>Hdec_init</var><span class="hyp-type"><b>: </b><span><span class="kr">‚àÄ</span> <span class="nv">i</span> : index,
  decidable_initial_messages_prop (IM i)</span></span></span><br><span><var>m</var><span class="hyp-type"><b>: </b><span>message</span></span></span><br><span><var>i</var><span class="hyp-type"><b>: </b><span>index</span></span></span><br><span><var>Hm</var><span class="hyp-type"><b>: </b><span>initial_message_prop m</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="kr">‚àÉ</span> <span class="nv">mi</span> : initial_message (IM i), `mi = m</div></blockquote><div class="alectryon-extra-goals"><input class="alectryon-extra-goal-toggle" id="Composition-v-chk12f" style="display: none" type="checkbox"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>message, index</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>EqDecision0</var><span class="hyp-type"><b>: </b><span>EqDecision index</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>finite.Finite index</span></span></span><br><span><var>IM</var><span class="hyp-type"><b>: </b><span>index ‚Üí VLSM message</span></span></span><br><span><var>constraint</var><span class="hyp-type"><b>: </b><span>composite_label IM
‚Üí composite_state IM * option message
  ‚Üí <span class="kt">Prop</span></span></span></span><br><span><var>Hdec_init</var><span class="hyp-type"><b>: </b><span><span class="kr">‚àÄ</span> <span class="nv">i</span> : index,
  decidable_initial_messages_prop (IM i)</span></span></span><br><span><var>m</var><span class="hyp-type"><b>: </b><span>message</span></span></span><br><span><var>i</var><span class="hyp-type"><b>: </b><span>index</span></span></span><br><span><var>Hm</var><span class="hyp-type"><b>: </b><span><span class="kr">‚àÉ</span> <span class="nv">mi</span> : initial_message (IM i), `mi = m</span></span></span><br></div><label class="goal-separator" for="Composition-v-chk12f"><hr></label><div class="goal-conclusion">initial_message_prop m</div></blockquote></div></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="Composition-v-chk130" style="display: none" type="checkbox"><label class="alectryon-input" for="Composition-v-chk130">+</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>message, index</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>EqDecision0</var><span class="hyp-type"><b>: </b><span>EqDecision index</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>finite.Finite index</span></span></span><br><span><var>IM</var><span class="hyp-type"><b>: </b><span>index ‚Üí VLSM message</span></span></span><br><span><var>constraint</var><span class="hyp-type"><b>: </b><span>composite_label IM
‚Üí composite_state IM * option message
  ‚Üí <span class="kt">Prop</span></span></span></span><br><span><var>Hdec_init</var><span class="hyp-type"><b>: </b><span><span class="kr">‚àÄ</span> <span class="nv">i</span> : index,
  decidable_initial_messages_prop (IM i)</span></span></span><br><span><var>m</var><span class="hyp-type"><b>: </b><span>message</span></span></span><br><span><var>i</var><span class="hyp-type"><b>: </b><span>index</span></span></span><br><span><var>Hm</var><span class="hyp-type"><b>: </b><span>initial_message_prop m</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="kr">‚àÉ</span> <span class="nv">mi</span> : initial_message (IM i), `mi = m</div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="bp">by</span> <span class="kr">exists</span> (<span class="nv">exist</span> <span class="nv">_</span> <span class="nv">_</span> <span class="nv">Hm</span>).</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="Composition-v-chk131" style="display: none" type="checkbox"><label class="alectryon-input" for="Composition-v-chk131">+</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>message, index</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>EqDecision0</var><span class="hyp-type"><b>: </b><span>EqDecision index</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>finite.Finite index</span></span></span><br><span><var>IM</var><span class="hyp-type"><b>: </b><span>index ‚Üí VLSM message</span></span></span><br><span><var>constraint</var><span class="hyp-type"><b>: </b><span>composite_label IM
‚Üí composite_state IM * option message
  ‚Üí <span class="kt">Prop</span></span></span></span><br><span><var>Hdec_init</var><span class="hyp-type"><b>: </b><span><span class="kr">‚àÄ</span> <span class="nv">i</span> : index,
  decidable_initial_messages_prop (IM i)</span></span></span><br><span><var>m</var><span class="hyp-type"><b>: </b><span>message</span></span></span><br><span><var>i</var><span class="hyp-type"><b>: </b><span>index</span></span></span><br><span><var>Hm</var><span class="hyp-type"><b>: </b><span><span class="kr">‚àÉ</span> <span class="nv">mi</span> : initial_message (IM i), `mi = m</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">initial_message_prop m</div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="bp">by</span> <span class="nb">destruct</span> Hm <span class="kr">as</span> [[im Hinit] [= -&gt;]].</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="Composition-v-chk132" style="display: none" type="checkbox"><label class="alectryon-input" for="Composition-v-chk132">-</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>message, index</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>EqDecision0</var><span class="hyp-type"><b>: </b><span>EqDecision index</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>finite.Finite index</span></span></span><br><span><var>IM</var><span class="hyp-type"><b>: </b><span>index ‚Üí VLSM message</span></span></span><br><span><var>constraint</var><span class="hyp-type"><b>: </b><span>composite_label IM
‚Üí composite_state IM * option message
  ‚Üí <span class="kt">Prop</span></span></span></span><br><span><var>Hdec_init</var><span class="hyp-type"><b>: </b><span><span class="kr">‚àÄ</span> <span class="nv">i</span> : index,
  decidable_initial_messages_prop (IM i)</span></span></span><br><span><var>m</var><span class="hyp-type"><b>: </b><span>message</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">Decision
  (List.Exists (<span class="kr">Œª</span> <span class="nv">i</span> : index, initial_message_prop m)
     (enum index))</div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="bp">by</span> <span class="nb">apply</span> @Exists_dec; <span class="nb">intro</span> i; <span class="nb">apply</span> Hdec_init.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Qed</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
</span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">End</span> <span class="nf">sec_composite_decidable_initial_message</span>.</span></span></pre><div class="doc">
<a id="lab10"></a><h2 class="section">Composite plan properties</h2>
<div class="paragraph"> </div>

  The following results concern facts about applying a <span class="inlinecode"><span class="id" title="var">plan</span></span> <span class="inlinecode"><span class="id" title="var">Free</span></span> <code>P</code>
  to a <span class="inlinecode"><span class="id" title="var">state</span></span> <span class="inlinecode"><span class="id" title="var">Free</span></span> <code>s'</code>, knowing its effects on a different <span class="inlinecode"><span class="id" title="var">state</span></span> <span class="inlinecode"><span class="id" title="var">Free</span></span> <code>s</code>
  which shares some relevant features with <code>s'</code>.

</div><pre class="alectryon-io highlight"><!-- Generator: Alectryon --><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Section</span> <span class="nf">sec_composite_plan_properties</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
</span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Context</span>
  {<span class="nv">message</span> : <span class="kt">Type</span>}
  {<span class="nv">index</span> : <span class="kt">Type</span>}
  `{EqDecision index}
  (IM : index -&gt; VLSM message)
  (Free := free_composite_vlsm IM)
  .</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
<span class="c">(* A transition on component &lt;&lt;i&gt;&gt; is [input_valid] from &lt;&lt;s&#39;&gt;&gt; if it is</span>
<span class="c">   [input_valid] from &lt;&lt;s&gt;&gt; and their &lt;&lt;i&gt;&gt;&#39;th components are equal. *)</span>

</span><span class="alectryon-sentence"><input class="alectryon-toggle" id="Composition-v-chk133" style="display: none" type="checkbox"><label class="alectryon-input" for="Composition-v-chk133"><span class="kn">Lemma</span> <span class="nf">relevant_component_transition_free</span>
  (<span class="nv">s</span> <span class="nv">s&#39;</span> : state Free)
  (<span class="nv">l</span> : label Free)
  (<span class="nv">input</span> : option message)
  (<span class="nv">i</span> := projT1 l)
  (<span class="nv">Heq</span> : (s i) = (s&#39; i))
  (<span class="nv">Hprs</span> : valid_state_prop Free s&#39;)
  (<span class="nv">Hiv</span> : input_valid Free l (s, input)) :
  input_valid Free l (s&#39;, input).</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>message, index</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>EqDecision0</var><span class="hyp-type"><b>: </b><span>EqDecision index</span></span></span><br><span><var>IM</var><span class="hyp-type"><b>: </b><span>index ‚Üí VLSM message</span></span></span><br><span><var>Free</var><span><span class="hyp-body"><b>:= </b><span>free_composite_vlsm IM</span></span><span class="hyp-type"><b>: </b><span>VLSM message</span></span></span></span><br><span><var>s, s'</var><span class="hyp-type"><b>: </b><span>state Free</span></span></span><br><span><var>l</var><span class="hyp-type"><b>: </b><span>label Free</span></span></span><br><span><var>input</var><span class="hyp-type"><b>: </b><span>option message</span></span></span><br><span><var>i</var><span><span class="hyp-body"><b>:= </b><span>projT1 l</span></span><span class="hyp-type"><b>: </b><span>index</span></span></span></span><br><span><var>Heq</var><span class="hyp-type"><b>: </b><span>s i = s&#39; i</span></span></span><br><span><var>Hprs</var><span class="hyp-type"><b>: </b><span>valid_state_prop Free s&#39;</span></span></span><br><span><var>Hiv</var><span class="hyp-type"><b>: </b><span>input_valid Free l (s, input)</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">input_valid Free l (s&#39;, input)</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="Composition-v-chk134" style="display: none" type="checkbox"><label class="alectryon-input" for="Composition-v-chk134"><span class="kn">Proof</span>.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>message, index</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>EqDecision0</var><span class="hyp-type"><b>: </b><span>EqDecision index</span></span></span><br><span><var>IM</var><span class="hyp-type"><b>: </b><span>index ‚Üí VLSM message</span></span></span><br><span><var>Free</var><span><span class="hyp-body"><b>:= </b><span>free_composite_vlsm IM</span></span><span class="hyp-type"><b>: </b><span>VLSM message</span></span></span></span><br><span><var>s, s'</var><span class="hyp-type"><b>: </b><span>state Free</span></span></span><br><span><var>l</var><span class="hyp-type"><b>: </b><span>label Free</span></span></span><br><span><var>input</var><span class="hyp-type"><b>: </b><span>option message</span></span></span><br><span><var>i</var><span><span class="hyp-body"><b>:= </b><span>projT1 l</span></span><span class="hyp-type"><b>: </b><span>index</span></span></span></span><br><span><var>Heq</var><span class="hyp-type"><b>: </b><span>s i = s&#39; i</span></span></span><br><span><var>Hprs</var><span class="hyp-type"><b>: </b><span>valid_state_prop Free s&#39;</span></span></span><br><span><var>Hiv</var><span class="hyp-type"><b>: </b><span>input_valid Free l (s, input)</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">input_valid Free l (s&#39;, input)</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="Composition-v-chk135" style="display: none" type="checkbox"><label class="alectryon-input" for="Composition-v-chk135">split_and!; [<span class="bp">done</span> | <span class="bp">by</span> <span class="nb">apply</span> Hiv |].</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>message, index</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>EqDecision0</var><span class="hyp-type"><b>: </b><span>EqDecision index</span></span></span><br><span><var>IM</var><span class="hyp-type"><b>: </b><span>index ‚Üí VLSM message</span></span></span><br><span><var>Free</var><span><span class="hyp-body"><b>:= </b><span>free_composite_vlsm IM</span></span><span class="hyp-type"><b>: </b><span>VLSM message</span></span></span></span><br><span><var>s, s'</var><span class="hyp-type"><b>: </b><span>state Free</span></span></span><br><span><var>l</var><span class="hyp-type"><b>: </b><span>label Free</span></span></span><br><span><var>input</var><span class="hyp-type"><b>: </b><span>option message</span></span></span><br><span><var>i</var><span><span class="hyp-body"><b>:= </b><span>projT1 l</span></span><span class="hyp-type"><b>: </b><span>index</span></span></span></span><br><span><var>Heq</var><span class="hyp-type"><b>: </b><span>s i = s&#39; i</span></span></span><br><span><var>Hprs</var><span class="hyp-type"><b>: </b><span>valid_state_prop Free s&#39;</span></span></span><br><span><var>Hiv</var><span class="hyp-type"><b>: </b><span>input_valid Free l (s, input)</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">valid l (s&#39;, input)</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="Composition-v-chk136" style="display: none" type="checkbox"><label class="alectryon-input" for="Composition-v-chk136"><span class="nb">cbn</span> <span class="kr">in</span> Hiv |- *.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>message, index</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>EqDecision0</var><span class="hyp-type"><b>: </b><span>EqDecision index</span></span></span><br><span><var>IM</var><span class="hyp-type"><b>: </b><span>index ‚Üí VLSM message</span></span></span><br><span><var>Free</var><span><span class="hyp-body"><b>:= </b><span>free_composite_vlsm IM</span></span><span class="hyp-type"><b>: </b><span>VLSM message</span></span></span></span><br><span><var>s, s'</var><span class="hyp-type"><b>: </b><span>state Free</span></span></span><br><span><var>l</var><span class="hyp-type"><b>: </b><span>label Free</span></span></span><br><span><var>input</var><span class="hyp-type"><b>: </b><span>option message</span></span></span><br><span><var>i</var><span><span class="hyp-body"><b>:= </b><span>projT1 l</span></span><span class="hyp-type"><b>: </b><span>index</span></span></span></span><br><span><var>Heq</var><span class="hyp-type"><b>: </b><span>s i = s&#39; i</span></span></span><br><span><var>Hprs</var><span class="hyp-type"><b>: </b><span>valid_state_prop Free s&#39;</span></span></span><br><span><var>Hiv</var><span class="hyp-type"><b>: </b><span>valid_state_prop Free s
‚àß option_valid_message_prop Free input
  ‚àß (<span class="kr">let</span> (<span class="nv">i</span>, li) := l <span class="kr">in</span> valid li (s i, input))</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="kr">let</span> (<span class="nv">i</span>, li) := l <span class="kr">in</span> valid li (s&#39; i, input)</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="Composition-v-chk137" style="display: none" type="checkbox"><label class="alectryon-input" for="Composition-v-chk137"><span class="nb">destruct</span> l.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>message, index</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>EqDecision0</var><span class="hyp-type"><b>: </b><span>EqDecision index</span></span></span><br><span><var>IM</var><span class="hyp-type"><b>: </b><span>index ‚Üí VLSM message</span></span></span><br><span><var>Free</var><span><span class="hyp-body"><b>:= </b><span>free_composite_vlsm IM</span></span><span class="hyp-type"><b>: </b><span>VLSM message</span></span></span></span><br><span><var>s, s'</var><span class="hyp-type"><b>: </b><span>state Free</span></span></span><br><span><var>x</var><span class="hyp-type"><b>: </b><span>index</span></span></span><br><span><var>l</var><span class="hyp-type"><b>: </b><span>label (IM x)</span></span></span><br><span><var>input</var><span class="hyp-type"><b>: </b><span>option message</span></span></span><br><span><var>i</var><span><span class="hyp-body"><b>:= </b><span>projT1 (existT x l)</span></span><span class="hyp-type"><b>: </b><span>index</span></span></span></span><br><span><var>Heq</var><span class="hyp-type"><b>: </b><span>s i = s&#39; i</span></span></span><br><span><var>Hprs</var><span class="hyp-type"><b>: </b><span>valid_state_prop Free s&#39;</span></span></span><br><span><var>Hiv</var><span class="hyp-type"><b>: </b><span>valid_state_prop Free s
‚àß option_valid_message_prop Free input
  ‚àß valid l (s x, input)</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">valid l (s&#39; x, input)</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="Composition-v-chk138" style="display: none" type="checkbox"><label class="alectryon-input" for="Composition-v-chk138"><span class="nb">simpl</span> <span class="kr">in</span> i.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>message, index</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>EqDecision0</var><span class="hyp-type"><b>: </b><span>EqDecision index</span></span></span><br><span><var>IM</var><span class="hyp-type"><b>: </b><span>index ‚Üí VLSM message</span></span></span><br><span><var>Free</var><span><span class="hyp-body"><b>:= </b><span>free_composite_vlsm IM</span></span><span class="hyp-type"><b>: </b><span>VLSM message</span></span></span></span><br><span><var>s, s'</var><span class="hyp-type"><b>: </b><span>state Free</span></span></span><br><span><var>x</var><span class="hyp-type"><b>: </b><span>index</span></span></span><br><span><var>l</var><span class="hyp-type"><b>: </b><span>label (IM x)</span></span></span><br><span><var>input</var><span class="hyp-type"><b>: </b><span>option message</span></span></span><br><span><var>i</var><span><span class="hyp-body"><b>:= </b><span>x</span></span><span class="hyp-type"><b>: </b><span>index</span></span></span></span><br><span><var>Heq</var><span class="hyp-type"><b>: </b><span>s i = s&#39; i</span></span></span><br><span><var>Hprs</var><span class="hyp-type"><b>: </b><span>valid_state_prop Free s&#39;</span></span></span><br><span><var>Hiv</var><span class="hyp-type"><b>: </b><span>valid_state_prop Free s
‚àß option_valid_message_prop Free input
  ‚àß valid l (s x, input)</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">valid l (s&#39; x, input)</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="Composition-v-chk139" style="display: none" type="checkbox"><label class="alectryon-input" for="Composition-v-chk139"><span class="nb">unfold</span> i <span class="kr">in</span> Heq.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>message, index</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>EqDecision0</var><span class="hyp-type"><b>: </b><span>EqDecision index</span></span></span><br><span><var>IM</var><span class="hyp-type"><b>: </b><span>index ‚Üí VLSM message</span></span></span><br><span><var>Free</var><span><span class="hyp-body"><b>:= </b><span>free_composite_vlsm IM</span></span><span class="hyp-type"><b>: </b><span>VLSM message</span></span></span></span><br><span><var>s, s'</var><span class="hyp-type"><b>: </b><span>state Free</span></span></span><br><span><var>x</var><span class="hyp-type"><b>: </b><span>index</span></span></span><br><span><var>l</var><span class="hyp-type"><b>: </b><span>label (IM x)</span></span></span><br><span><var>input</var><span class="hyp-type"><b>: </b><span>option message</span></span></span><br><span><var>i</var><span><span class="hyp-body"><b>:= </b><span>x</span></span><span class="hyp-type"><b>: </b><span>index</span></span></span></span><br><span><var>Heq</var><span class="hyp-type"><b>: </b><span>s x = s&#39; x</span></span></span><br><span><var>Hprs</var><span class="hyp-type"><b>: </b><span>valid_state_prop Free s&#39;</span></span></span><br><span><var>Hiv</var><span class="hyp-type"><b>: </b><span>valid_state_prop Free s
‚àß option_valid_message_prop Free input
  ‚àß valid l (s x, input)</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">valid l (s&#39; x, input)</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="Composition-v-chk13a" style="display: none" type="checkbox"><label class="alectryon-input" for="Composition-v-chk13a"><span class="nb">rewrite</span> &lt;- Heq.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>message, index</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>EqDecision0</var><span class="hyp-type"><b>: </b><span>EqDecision index</span></span></span><br><span><var>IM</var><span class="hyp-type"><b>: </b><span>index ‚Üí VLSM message</span></span></span><br><span><var>Free</var><span><span class="hyp-body"><b>:= </b><span>free_composite_vlsm IM</span></span><span class="hyp-type"><b>: </b><span>VLSM message</span></span></span></span><br><span><var>s, s'</var><span class="hyp-type"><b>: </b><span>state Free</span></span></span><br><span><var>x</var><span class="hyp-type"><b>: </b><span>index</span></span></span><br><span><var>l</var><span class="hyp-type"><b>: </b><span>label (IM x)</span></span></span><br><span><var>input</var><span class="hyp-type"><b>: </b><span>option message</span></span></span><br><span><var>i</var><span><span class="hyp-body"><b>:= </b><span>x</span></span><span class="hyp-type"><b>: </b><span>index</span></span></span></span><br><span><var>Heq</var><span class="hyp-type"><b>: </b><span>s x = s&#39; x</span></span></span><br><span><var>Hprs</var><span class="hyp-type"><b>: </b><span>valid_state_prop Free s&#39;</span></span></span><br><span><var>Hiv</var><span class="hyp-type"><b>: </b><span>valid_state_prop Free s
‚àß option_valid_message_prop Free input
  ‚àß valid l (s x, input)</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">valid l (s x, input)</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><span class="alectryon-input"><span class="bp">by</span> itauto.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Qed</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
<span class="c">(* The effect of the transition is also the same. *)</span>

</span><span class="alectryon-sentence"><input class="alectryon-toggle" id="Composition-v-chk13b" style="display: none" type="checkbox"><label class="alectryon-input" for="Composition-v-chk13b"><span class="kn">Lemma</span> <span class="nf">relevant_component_transition2_free</span>
  (<span class="nv">s</span> <span class="nv">s&#39;</span> : state Free)
  (<span class="nv">l</span> : label Free)
  (<span class="nv">input</span> : option message)
  (<span class="nv">i</span> := projT1 l)
  (<span class="nv">Heq</span> : (s i) = (s&#39; i))
  (<span class="nv">Hprs</span> : valid_state_prop Free s&#39;) :
  <span class="kr">let</span> (<span class="nv">dest</span>, output) := transition Free l (s, input) <span class="kr">in</span>
  <span class="kr">let</span> (<span class="nv">dest&#39;</span>, output&#39;) := transition Free l (s&#39;, input) <span class="kr">in</span>
  output = output&#39; /\ (dest i) = (dest&#39; i).</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>message, index</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>EqDecision0</var><span class="hyp-type"><b>: </b><span>EqDecision index</span></span></span><br><span><var>IM</var><span class="hyp-type"><b>: </b><span>index ‚Üí VLSM message</span></span></span><br><span><var>Free</var><span><span class="hyp-body"><b>:= </b><span>free_composite_vlsm IM</span></span><span class="hyp-type"><b>: </b><span>VLSM message</span></span></span></span><br><span><var>s, s'</var><span class="hyp-type"><b>: </b><span>state Free</span></span></span><br><span><var>l</var><span class="hyp-type"><b>: </b><span>label Free</span></span></span><br><span><var>input</var><span class="hyp-type"><b>: </b><span>option message</span></span></span><br><span><var>i</var><span><span class="hyp-body"><b>:= </b><span>projT1 l</span></span><span class="hyp-type"><b>: </b><span>index</span></span></span></span><br><span><var>Heq</var><span class="hyp-type"><b>: </b><span>s i = s&#39; i</span></span></span><br><span><var>Hprs</var><span class="hyp-type"><b>: </b><span>valid_state_prop Free s&#39;</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="kr">let</span> (<span class="nv">dest</span>, output) := transition l (s, input) <span class="kr">in</span>
<span class="kr">let</span> (<span class="nv">dest&#39;</span>, output&#39;) := transition l (s&#39;, input) <span class="kr">in</span>
output = output&#39; ‚àß dest i = dest&#39; i</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="Composition-v-chk13c" style="display: none" type="checkbox"><label class="alectryon-input" for="Composition-v-chk13c"><span class="kn">Proof</span>.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>message, index</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>EqDecision0</var><span class="hyp-type"><b>: </b><span>EqDecision index</span></span></span><br><span><var>IM</var><span class="hyp-type"><b>: </b><span>index ‚Üí VLSM message</span></span></span><br><span><var>Free</var><span><span class="hyp-body"><b>:= </b><span>free_composite_vlsm IM</span></span><span class="hyp-type"><b>: </b><span>VLSM message</span></span></span></span><br><span><var>s, s'</var><span class="hyp-type"><b>: </b><span>state Free</span></span></span><br><span><var>l</var><span class="hyp-type"><b>: </b><span>label Free</span></span></span><br><span><var>input</var><span class="hyp-type"><b>: </b><span>option message</span></span></span><br><span><var>i</var><span><span class="hyp-body"><b>:= </b><span>projT1 l</span></span><span class="hyp-type"><b>: </b><span>index</span></span></span></span><br><span><var>Heq</var><span class="hyp-type"><b>: </b><span>s i = s&#39; i</span></span></span><br><span><var>Hprs</var><span class="hyp-type"><b>: </b><span>valid_state_prop Free s&#39;</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="kr">let</span> (<span class="nv">dest</span>, output) := transition l (s, input) <span class="kr">in</span>
<span class="kr">let</span> (<span class="nv">dest&#39;</span>, output&#39;) := transition l (s&#39;, input) <span class="kr">in</span>
output = output&#39; ‚àß dest i = dest&#39; i</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="Composition-v-chk13d" style="display: none" type="checkbox"><label class="alectryon-input" for="Composition-v-chk13d"><span class="nb">destruct</span> l <span class="kr">as</span> [x l]; <span class="nb">simpl</span> <span class="kr">in</span> i |- *.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>message, index</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>EqDecision0</var><span class="hyp-type"><b>: </b><span>EqDecision index</span></span></span><br><span><var>IM</var><span class="hyp-type"><b>: </b><span>index ‚Üí VLSM message</span></span></span><br><span><var>Free</var><span><span class="hyp-body"><b>:= </b><span>free_composite_vlsm IM</span></span><span class="hyp-type"><b>: </b><span>VLSM message</span></span></span></span><br><span><var>s, s'</var><span class="hyp-type"><b>: </b><span>state Free</span></span></span><br><span><var>x</var><span class="hyp-type"><b>: </b><span>index</span></span></span><br><span><var>l</var><span class="hyp-type"><b>: </b><span>label (IM x)</span></span></span><br><span><var>input</var><span class="hyp-type"><b>: </b><span>option message</span></span></span><br><span><var>i</var><span><span class="hyp-body"><b>:= </b><span>x</span></span><span class="hyp-type"><b>: </b><span>index</span></span></span></span><br><span><var>Heq</var><span class="hyp-type"><b>: </b><span>s i = s&#39; i</span></span></span><br><span><var>Hprs</var><span class="hyp-type"><b>: </b><span>valid_state_prop Free s&#39;</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="kr">let</span> (<span class="nv">dest</span>, output) :=
  <span class="kr">let</span> (<span class="nv">si&#39;</span>, om&#39;) := transition l (s x, input) <span class="kr">in</span>
  (state_update IM s x si&#39;, om&#39;) <span class="kr">in</span>
<span class="kr">let</span> (<span class="nv">dest&#39;</span>, output&#39;) :=
  <span class="kr">let</span> (<span class="nv">si&#39;</span>, om&#39;) := transition l (s&#39; x, input) <span class="kr">in</span>
  (state_update IM s&#39; x si&#39;, om&#39;) <span class="kr">in</span>
output = output&#39; ‚àß dest i = dest&#39; i</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="Composition-v-chk13e" style="display: none" type="checkbox"><label class="alectryon-input" for="Composition-v-chk13e"><span class="nb">unfold</span> i <span class="kr">in</span> Heq; <span class="nb">rewrite</span> Heq.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>message, index</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>EqDecision0</var><span class="hyp-type"><b>: </b><span>EqDecision index</span></span></span><br><span><var>IM</var><span class="hyp-type"><b>: </b><span>index ‚Üí VLSM message</span></span></span><br><span><var>Free</var><span><span class="hyp-body"><b>:= </b><span>free_composite_vlsm IM</span></span><span class="hyp-type"><b>: </b><span>VLSM message</span></span></span></span><br><span><var>s, s'</var><span class="hyp-type"><b>: </b><span>state Free</span></span></span><br><span><var>x</var><span class="hyp-type"><b>: </b><span>index</span></span></span><br><span><var>l</var><span class="hyp-type"><b>: </b><span>label (IM x)</span></span></span><br><span><var>input</var><span class="hyp-type"><b>: </b><span>option message</span></span></span><br><span><var>i</var><span><span class="hyp-body"><b>:= </b><span>x</span></span><span class="hyp-type"><b>: </b><span>index</span></span></span></span><br><span><var>Heq</var><span class="hyp-type"><b>: </b><span>s x = s&#39; x</span></span></span><br><span><var>Hprs</var><span class="hyp-type"><b>: </b><span>valid_state_prop Free s&#39;</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="kr">let</span> (<span class="nv">dest</span>, output) :=
  <span class="kr">let</span> (<span class="nv">si&#39;</span>, om&#39;) := transition l (s&#39; x, input) <span class="kr">in</span>
  (state_update IM s x si&#39;, om&#39;) <span class="kr">in</span>
<span class="kr">let</span> (<span class="nv">dest&#39;</span>, output&#39;) :=
  <span class="kr">let</span> (<span class="nv">si&#39;</span>, om&#39;) := transition l (s&#39; x, input) <span class="kr">in</span>
  (state_update IM s&#39; x si&#39;, om&#39;) <span class="kr">in</span>
output = output&#39; ‚àß dest i = dest&#39; i</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="Composition-v-chk13f" style="display: none" type="checkbox"><label class="alectryon-input" for="Composition-v-chk13f"><span class="nb">destruct</span> (transition (IM x) l (s&#39; x, input)).</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>message, index</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>EqDecision0</var><span class="hyp-type"><b>: </b><span>EqDecision index</span></span></span><br><span><var>IM</var><span class="hyp-type"><b>: </b><span>index ‚Üí VLSM message</span></span></span><br><span><var>Free</var><span><span class="hyp-body"><b>:= </b><span>free_composite_vlsm IM</span></span><span class="hyp-type"><b>: </b><span>VLSM message</span></span></span></span><br><span><var>s, s'</var><span class="hyp-type"><b>: </b><span>state Free</span></span></span><br><span><var>x</var><span class="hyp-type"><b>: </b><span>index</span></span></span><br><span><var>l</var><span class="hyp-type"><b>: </b><span>label (IM x)</span></span></span><br><span><var>input</var><span class="hyp-type"><b>: </b><span>option message</span></span></span><br><span><var>i</var><span><span class="hyp-body"><b>:= </b><span>x</span></span><span class="hyp-type"><b>: </b><span>index</span></span></span></span><br><span><var>Heq</var><span class="hyp-type"><b>: </b><span>s x = s&#39; x</span></span></span><br><span><var>Hprs</var><span class="hyp-type"><b>: </b><span>valid_state_prop Free s&#39;</span></span></span><br><span><var>s0</var><span class="hyp-type"><b>: </b><span>state (IM x)</span></span></span><br><span><var>o</var><span class="hyp-type"><b>: </b><span>option message</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">o = o
‚àß state_update IM s x s0 i = state_update IM s&#39; x s0 i</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><span class="alectryon-input"><span class="bp">by</span> state_update_simpl.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Qed</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
</span><span class="alectryon-sentence"><input class="alectryon-toggle" id="Composition-v-chk140" style="display: none" type="checkbox"><label class="alectryon-input" for="Composition-v-chk140"><span class="kn">Lemma</span> <span class="nf">relevant_components_one_free</span>
  (<span class="nv">s</span> <span class="nv">s&#39;</span> : state Free)
  (<span class="nv">Hprs&#39;</span> : valid_state_prop Free s&#39;)
  (<span class="nv">ai</span> : plan_item Free)
  (<span class="nv">i</span> := projT1 (label_a ai))
  (<span class="nv">Heq</span> : (s i) = (s&#39; i))
  (<span class="nv">Hpr</span> : finite_valid_plan_from Free s [ai]) :
  <span class="kr">let</span> <span class="nv">res&#39;</span> := snd (apply_plan Free s&#39; [ai]) <span class="kr">in</span>
  <span class="kr">let</span> <span class="nv">res</span> := snd (apply_plan Free s [ai]) <span class="kr">in</span>
  finite_valid_plan_from Free s&#39; [ai] /\
  (res&#39; i) = res i.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>message, index</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>EqDecision0</var><span class="hyp-type"><b>: </b><span>EqDecision index</span></span></span><br><span><var>IM</var><span class="hyp-type"><b>: </b><span>index ‚Üí VLSM message</span></span></span><br><span><var>Free</var><span><span class="hyp-body"><b>:= </b><span>free_composite_vlsm IM</span></span><span class="hyp-type"><b>: </b><span>VLSM message</span></span></span></span><br><span><var>s, s'</var><span class="hyp-type"><b>: </b><span>state Free</span></span></span><br><span><var>Hprs'</var><span class="hyp-type"><b>: </b><span>valid_state_prop Free s&#39;</span></span></span><br><span><var>ai</var><span class="hyp-type"><b>: </b><span>plan_item</span></span></span><br><span><var>i</var><span><span class="hyp-body"><b>:= </b><span>projT1 (label_a ai)</span></span><span class="hyp-type"><b>: </b><span>index</span></span></span></span><br><span><var>Heq</var><span class="hyp-type"><b>: </b><span>s i = s&#39; i</span></span></span><br><span><var>Hpr</var><span class="hyp-type"><b>: </b><span>finite_valid_plan_from Free s [ai]</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="kr">let</span> <span class="nv">res&#39;</span> := (apply_plan Free s&#39; [ai]).<span class="mi">2</span> <span class="kr">in</span>
<span class="kr">let</span> <span class="nv">res</span> := (apply_plan Free s [ai]).<span class="mi">2</span> <span class="kr">in</span>
finite_valid_plan_from Free s&#39; [ai] ‚àß res&#39; i = res i</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="Composition-v-chk141" style="display: none" type="checkbox"><label class="alectryon-input" for="Composition-v-chk141"><span class="kn">Proof</span>.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>message, index</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>EqDecision0</var><span class="hyp-type"><b>: </b><span>EqDecision index</span></span></span><br><span><var>IM</var><span class="hyp-type"><b>: </b><span>index ‚Üí VLSM message</span></span></span><br><span><var>Free</var><span><span class="hyp-body"><b>:= </b><span>free_composite_vlsm IM</span></span><span class="hyp-type"><b>: </b><span>VLSM message</span></span></span></span><br><span><var>s, s'</var><span class="hyp-type"><b>: </b><span>state Free</span></span></span><br><span><var>Hprs'</var><span class="hyp-type"><b>: </b><span>valid_state_prop Free s&#39;</span></span></span><br><span><var>ai</var><span class="hyp-type"><b>: </b><span>plan_item</span></span></span><br><span><var>i</var><span><span class="hyp-body"><b>:= </b><span>projT1 (label_a ai)</span></span><span class="hyp-type"><b>: </b><span>index</span></span></span></span><br><span><var>Heq</var><span class="hyp-type"><b>: </b><span>s i = s&#39; i</span></span></span><br><span><var>Hpr</var><span class="hyp-type"><b>: </b><span>finite_valid_plan_from Free s [ai]</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="kr">let</span> <span class="nv">res&#39;</span> := (apply_plan Free s&#39; [ai]).<span class="mi">2</span> <span class="kr">in</span>
<span class="kr">let</span> <span class="nv">res</span> := (apply_plan Free s [ai]).<span class="mi">2</span> <span class="kr">in</span>
finite_valid_plan_from Free s&#39; [ai] ‚àß res&#39; i = res i</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="Composition-v-chk142" style="display: none" type="checkbox"><label class="alectryon-input" for="Composition-v-chk142"><span class="nb">simpl</span>.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>message, index</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>EqDecision0</var><span class="hyp-type"><b>: </b><span>EqDecision index</span></span></span><br><span><var>IM</var><span class="hyp-type"><b>: </b><span>index ‚Üí VLSM message</span></span></span><br><span><var>Free</var><span><span class="hyp-body"><b>:= </b><span>free_composite_vlsm IM</span></span><span class="hyp-type"><b>: </b><span>VLSM message</span></span></span></span><br><span><var>s, s'</var><span class="hyp-type"><b>: </b><span>state Free</span></span></span><br><span><var>Hprs'</var><span class="hyp-type"><b>: </b><span>valid_state_prop Free s&#39;</span></span></span><br><span><var>ai</var><span class="hyp-type"><b>: </b><span>plan_item</span></span></span><br><span><var>i</var><span><span class="hyp-body"><b>:= </b><span>projT1 (label_a ai)</span></span><span class="hyp-type"><b>: </b><span>index</span></span></span></span><br><span><var>Heq</var><span class="hyp-type"><b>: </b><span>s i = s&#39; i</span></span></span><br><span><var>Hpr</var><span class="hyp-type"><b>: </b><span>finite_valid_plan_from Free s [ai]</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">finite_valid_plan_from Free s&#39; [ai]
‚àß (apply_plan Free s&#39; [ai]).<span class="mi">2</span> i =
  (apply_plan Free s [ai]).<span class="mi">2</span> i</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="Composition-v-chk143" style="display: none" type="checkbox"><label class="alectryon-input" for="Composition-v-chk143"><span class="nb">unfold</span> finite_valid_plan_from, apply_plan, _apply_plan <span class="kr">in</span> *.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>message, index</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>EqDecision0</var><span class="hyp-type"><b>: </b><span>EqDecision index</span></span></span><br><span><var>IM</var><span class="hyp-type"><b>: </b><span>index ‚Üí VLSM message</span></span></span><br><span><var>Free</var><span><span class="hyp-body"><b>:= </b><span>free_composite_vlsm IM</span></span><span class="hyp-type"><b>: </b><span>VLSM message</span></span></span></span><br><span><var>s, s'</var><span class="hyp-type"><b>: </b><span>state Free</span></span></span><br><span><var>Hprs'</var><span class="hyp-type"><b>: </b><span>valid_state_prop Free s&#39;</span></span></span><br><span><var>ai</var><span class="hyp-type"><b>: </b><span>plan_item</span></span></span><br><span><var>i</var><span><span class="hyp-body"><b>:= </b><span>projT1 (label_a ai)</span></span><span class="hyp-type"><b>: </b><span>index</span></span></span></span><br><span><var>Heq</var><span class="hyp-type"><b>: </b><span>s i = s&#39; i</span></span></span><br><span><var>Hpr</var><span class="hyp-type"><b>: </b><span>finite_valid_trace_from Free s
  (<span class="kr">let</span> (<span class="nv">final</span>, items) :=
     foldr _apply_plan_folder (s, []) (rev [ai]) <span class="kr">in</span>
   (rev items, final)).<span class="mi">1</span></span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">finite_valid_trace_from Free s&#39;
  (<span class="kr">let</span> (<span class="nv">final</span>, items) :=
     foldr _apply_plan_folder (s&#39;, []) (rev [ai]) <span class="kr">in</span>
   (rev items, final)).<span class="mi">1</span>
‚àß (<span class="kr">let</span> (<span class="nv">final</span>, items) :=
     foldr _apply_plan_folder (s&#39;, []) (rev [ai]) <span class="kr">in</span>
   (rev items, final)).<span class="mi">2</span> i =
  (<span class="kr">let</span> (<span class="nv">final</span>, items) :=
     foldr _apply_plan_folder (s, []) (rev [ai]) <span class="kr">in</span>
   (rev items, final)).<span class="mi">2</span> i</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="Composition-v-chk144" style="display: none" type="checkbox"><label class="alectryon-input" for="Composition-v-chk144"><span class="nb">destruct</span> ai; <span class="nb">simpl</span> <span class="kr">in</span> *.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>message, index</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>EqDecision0</var><span class="hyp-type"><b>: </b><span>EqDecision index</span></span></span><br><span><var>IM</var><span class="hyp-type"><b>: </b><span>index ‚Üí VLSM message</span></span></span><br><span><var>Free</var><span><span class="hyp-body"><b>:= </b><span>free_composite_vlsm IM</span></span><span class="hyp-type"><b>: </b><span>VLSM message</span></span></span></span><br><span><var>s, s'</var><span class="hyp-type"><b>: </b><span>composite_state IM</span></span></span><br><span><var>Hprs'</var><span class="hyp-type"><b>: </b><span>valid_state_prop Free s&#39;</span></span></span><br><span><var>label_a</var><span class="hyp-type"><b>: </b><span>composite_label IM</span></span></span><br><span><var>input_a</var><span class="hyp-type"><b>: </b><span>option message</span></span></span><br><span><var>i</var><span><span class="hyp-body"><b>:= </b><span>projT1 label_a</span></span><span class="hyp-type"><b>: </b><span>index</span></span></span></span><br><span><var>Heq</var><span class="hyp-type"><b>: </b><span>s i = s&#39; i</span></span></span><br><span><var>Hpr</var><span class="hyp-type"><b>: </b><span>finite_valid_trace_from Free s
  (<span class="kr">let</span> (<span class="nv">final</span>, items) :=
     <span class="kr">let</span> (<span class="nv">dest</span>, out) :=
       <span class="kr">let</span> (<span class="nv">i</span>, li) := label_a <span class="kr">in</span>
       <span class="kr">let</span> (<span class="nv">si&#39;</span>, om&#39;) :=
         transition li (s i, input_a) <span class="kr">in</span>
       (state_update IM s i si&#39;, om&#39;) <span class="kr">in</span>
     (dest,
      [{|
         l := label_a;
         input := input_a;
         destination := dest;
         output := out
       |}]) <span class="kr">in</span>
   (rev items, final)).<span class="mi">1</span></span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">finite_valid_trace_from Free s&#39;
  (<span class="kr">let</span> (<span class="nv">final</span>, items) :=
     <span class="kr">let</span> (<span class="nv">dest</span>, out) :=
       <span class="kr">let</span> (<span class="nv">i</span>, li) := label_a <span class="kr">in</span>
       <span class="kr">let</span> (<span class="nv">si&#39;</span>, om&#39;) :=
         transition li (s&#39; i, input_a) <span class="kr">in</span>
       (state_update IM s&#39; i si&#39;, om&#39;) <span class="kr">in</span>
     (dest,
      [{|
         l := label_a;
         input := input_a;
         destination := dest;
         output := out
       |}]) <span class="kr">in</span>
   (rev items, final)).<span class="mi">1</span>
‚àß (<span class="kr">let</span> (<span class="nv">final</span>, items) :=
     <span class="kr">let</span> (<span class="nv">dest</span>, out) :=
       <span class="kr">let</span> (<span class="nv">i</span>, li) := label_a <span class="kr">in</span>
       <span class="kr">let</span> (<span class="nv">si&#39;</span>, om&#39;) :=
         transition li (s&#39; i, input_a) <span class="kr">in</span>
       (state_update IM s&#39; i si&#39;, om&#39;) <span class="kr">in</span>
     (dest,
      [{|
         l := label_a;
         input := input_a;
         destination := dest;
         output := out
       |}]) <span class="kr">in</span>
   (rev items, final)).<span class="mi">2</span> i =
  (<span class="kr">let</span> (<span class="nv">final</span>, items) :=
     <span class="kr">let</span> (<span class="nv">dest</span>, out) :=
       <span class="kr">let</span> (<span class="nv">i</span>, li) := label_a <span class="kr">in</span>
       <span class="kr">let</span> (<span class="nv">si&#39;</span>, om&#39;) :=
         transition li (s i, input_a) <span class="kr">in</span>
       (state_update IM s i si&#39;, om&#39;) <span class="kr">in</span>
     (dest,
      [{|
         l := label_a;
         input := input_a;
         destination := dest;
         output := out
       |}]) <span class="kr">in</span>
   (rev items, final)).<span class="mi">2</span> i</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="Composition-v-chk145" style="display: none" type="checkbox"><label class="alectryon-input" for="Composition-v-chk145"><span class="kr">match goal with</span>
  |- <span class="kp">context</span> [<span class="kr">let</span> (<span class="nv">_</span>, _) := <span class="kr">let</span> (<span class="nv">_</span>, _) := <span class="nl">?t</span> <span class="kr">in</span> _ <span class="kr">in</span> _] =&gt;
    <span class="nb">destruct</span> t <span class="nb">eqn</span>: eq_trans&#39;
  <span class="kr">end</span>.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>message, index</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>EqDecision0</var><span class="hyp-type"><b>: </b><span>EqDecision index</span></span></span><br><span><var>IM</var><span class="hyp-type"><b>: </b><span>index ‚Üí VLSM message</span></span></span><br><span><var>Free</var><span><span class="hyp-body"><b>:= </b><span>free_composite_vlsm IM</span></span><span class="hyp-type"><b>: </b><span>VLSM message</span></span></span></span><br><span><var>s, s'</var><span class="hyp-type"><b>: </b><span>composite_state IM</span></span></span><br><span><var>Hprs'</var><span class="hyp-type"><b>: </b><span>valid_state_prop Free s&#39;</span></span></span><br><span><var>label_a</var><span class="hyp-type"><b>: </b><span>composite_label IM</span></span></span><br><span><var>input_a</var><span class="hyp-type"><b>: </b><span>option message</span></span></span><br><span><var>i</var><span><span class="hyp-body"><b>:= </b><span>projT1 label_a</span></span><span class="hyp-type"><b>: </b><span>index</span></span></span></span><br><span><var>Heq</var><span class="hyp-type"><b>: </b><span>s i = s&#39; i</span></span></span><br><span><var>Hpr</var><span class="hyp-type"><b>: </b><span>finite_valid_trace_from Free s
  (<span class="kr">let</span> (<span class="nv">final</span>, items) :=
     <span class="kr">let</span> (<span class="nv">dest</span>, out) :=
       <span class="kr">let</span> (<span class="nv">i</span>, li) := label_a <span class="kr">in</span>
       <span class="kr">let</span> (<span class="nv">si&#39;</span>, om&#39;) :=
         transition li (s i, input_a) <span class="kr">in</span>
       (state_update IM s i si&#39;, om&#39;) <span class="kr">in</span>
     (dest,
      [{|
         l := label_a;
         input := input_a;
         destination := dest;
         output := out
       |}]) <span class="kr">in</span>
   (rev items, final)).<span class="mi">1</span></span></span></span><br><span><var>c</var><span class="hyp-type"><b>: </b><span>composite_state IM</span></span></span><br><span><var>o</var><span class="hyp-type"><b>: </b><span>option message</span></span></span><br><span><var>eq_trans'</var><span class="hyp-type"><b>: </b><span>(<span class="kr">let</span> (<span class="nv">i</span>, li) := label_a <span class="kr">in</span>
 <span class="kr">let</span> (<span class="nv">si&#39;</span>, om&#39;) :=
   transition li (s&#39; i, input_a) <span class="kr">in</span>
 (state_update IM s&#39; i si&#39;, om&#39;)) = (
c, o)</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">finite_valid_trace_from Free s&#39;
  (rev
     [{|
        l := label_a;
        input := input_a;
        destination := c;
        output := o
      |}], c).<span class="mi">1</span>
‚àß (rev
     [{|
        l := label_a;
        input := input_a;
        destination := c;
        output := o
      |}], c).<span class="mi">2</span> i =
  (<span class="kr">let</span> (<span class="nv">final</span>, items) :=
     <span class="kr">let</span> (<span class="nv">dest</span>, out) :=
       <span class="kr">let</span> (<span class="nv">i</span>, li) := label_a <span class="kr">in</span>
       <span class="kr">let</span> (<span class="nv">si&#39;</span>, om&#39;) :=
         transition li (s i, input_a) <span class="kr">in</span>
       (state_update IM s i si&#39;, om&#39;) <span class="kr">in</span>
     (dest,
      [{|
         l := label_a;
         input := input_a;
         destination := dest;
         output := out
       |}]) <span class="kr">in</span>
   (rev items, final)).<span class="mi">2</span> i</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="Composition-v-chk146" style="display: none" type="checkbox"><label class="alectryon-input" for="Composition-v-chk146"><span class="kr">match goal with</span>
  |- <span class="kp">context</span> [<span class="kr">let</span> (<span class="nv">_</span>, _) := <span class="kr">let</span> (<span class="nv">_</span>, _) := <span class="nl">?t</span> <span class="kr">in</span> _ <span class="kr">in</span> _] =&gt;
    <span class="nb">destruct</span> t <span class="nb">eqn</span>: eq_trans
  <span class="kr">end</span>.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>message, index</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>EqDecision0</var><span class="hyp-type"><b>: </b><span>EqDecision index</span></span></span><br><span><var>IM</var><span class="hyp-type"><b>: </b><span>index ‚Üí VLSM message</span></span></span><br><span><var>Free</var><span><span class="hyp-body"><b>:= </b><span>free_composite_vlsm IM</span></span><span class="hyp-type"><b>: </b><span>VLSM message</span></span></span></span><br><span><var>s, s'</var><span class="hyp-type"><b>: </b><span>composite_state IM</span></span></span><br><span><var>Hprs'</var><span class="hyp-type"><b>: </b><span>valid_state_prop Free s&#39;</span></span></span><br><span><var>label_a</var><span class="hyp-type"><b>: </b><span>composite_label IM</span></span></span><br><span><var>input_a</var><span class="hyp-type"><b>: </b><span>option message</span></span></span><br><span><var>i</var><span><span class="hyp-body"><b>:= </b><span>projT1 label_a</span></span><span class="hyp-type"><b>: </b><span>index</span></span></span></span><br><span><var>Heq</var><span class="hyp-type"><b>: </b><span>s i = s&#39; i</span></span></span><br><span><var>c0</var><span class="hyp-type"><b>: </b><span>composite_state IM</span></span></span><br><span><var>o0</var><span class="hyp-type"><b>: </b><span>option message</span></span></span><br><span><var>eq_trans</var><span class="hyp-type"><b>: </b><span>(<span class="kr">let</span> (<span class="nv">i</span>, li) := label_a <span class="kr">in</span>
 <span class="kr">let</span> (<span class="nv">si&#39;</span>, om&#39;) :=
   transition li (s i, input_a) <span class="kr">in</span>
 (state_update IM s i si&#39;, om&#39;)) = (
c0, o0)</span></span></span><br><span><var>Hpr</var><span class="hyp-type"><b>: </b><span>finite_valid_trace_from Free s
  (rev
     [{|
        l := label_a;
        input := input_a;
        destination := c0;
        output := o0
      |}], c0).<span class="mi">1</span></span></span></span><br><span><var>c</var><span class="hyp-type"><b>: </b><span>composite_state IM</span></span></span><br><span><var>o</var><span class="hyp-type"><b>: </b><span>option message</span></span></span><br><span><var>eq_trans'</var><span class="hyp-type"><b>: </b><span>(<span class="kr">let</span> (<span class="nv">i</span>, li) := label_a <span class="kr">in</span>
 <span class="kr">let</span> (<span class="nv">si&#39;</span>, om&#39;) :=
   transition li (s&#39; i, input_a) <span class="kr">in</span>
 (state_update IM s&#39; i si&#39;, om&#39;)) = (
c, o)</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">finite_valid_trace_from Free s&#39;
  (rev
     [{|
        l := label_a;
        input := input_a;
        destination := c;
        output := o
      |}], c).<span class="mi">1</span>
‚àß (rev
     [{|
        l := label_a;
        input := input_a;
        destination := c;
        output := o
      |}], c).<span class="mi">2</span> i =
  (rev
     [{|
        l := label_a;
        input := input_a;
        destination := c0;
        output := o0
      |}], c0).<span class="mi">2</span> i</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="Composition-v-chk147" style="display: none" type="checkbox"><label class="alectryon-input" for="Composition-v-chk147"><span class="nb">inversion</span> Hpr; <span class="nb">subst</span>.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>message, index</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>EqDecision0</var><span class="hyp-type"><b>: </b><span>EqDecision index</span></span></span><br><span><var>IM</var><span class="hyp-type"><b>: </b><span>index ‚Üí VLSM message</span></span></span><br><span><var>Free</var><span><span class="hyp-body"><b>:= </b><span>free_composite_vlsm IM</span></span><span class="hyp-type"><b>: </b><span>VLSM message</span></span></span></span><br><span><var>s, s'</var><span class="hyp-type"><b>: </b><span>composite_state IM</span></span></span><br><span><var>Hprs'</var><span class="hyp-type"><b>: </b><span>valid_state_prop Free s&#39;</span></span></span><br><span><var>label_a</var><span class="hyp-type"><b>: </b><span>composite_label IM</span></span></span><br><span><var>input_a</var><span class="hyp-type"><b>: </b><span>option message</span></span></span><br><span><var>i</var><span><span class="hyp-body"><b>:= </b><span>projT1 label_a</span></span><span class="hyp-type"><b>: </b><span>index</span></span></span></span><br><span><var>Heq</var><span class="hyp-type"><b>: </b><span>s i = s&#39; i</span></span></span><br><span><var>c0</var><span class="hyp-type"><b>: </b><span>composite_state IM</span></span></span><br><span><var>o0</var><span class="hyp-type"><b>: </b><span>option message</span></span></span><br><span><var>eq_trans</var><span class="hyp-type"><b>: </b><span>(<span class="kr">let</span> (<span class="nv">i</span>, li) := label_a <span class="kr">in</span>
 <span class="kr">let</span> (<span class="nv">si&#39;</span>, om&#39;) :=
   transition li (s i, input_a) <span class="kr">in</span>
 (state_update IM s i si&#39;, om&#39;)) = (
c0, o0)</span></span></span><br><span><var>Hpr</var><span class="hyp-type"><b>: </b><span>finite_valid_trace_from Free s
  (rev
     [{|
        l := label_a;
        input := input_a;
        destination := c0;
        output := o0
      |}], c0).<span class="mi">1</span></span></span></span><br><span><var>c</var><span class="hyp-type"><b>: </b><span>composite_state IM</span></span></span><br><span><var>o</var><span class="hyp-type"><b>: </b><span>option message</span></span></span><br><span><var>eq_trans'</var><span class="hyp-type"><b>: </b><span>(<span class="kr">let</span> (<span class="nv">i</span>, li) := label_a <span class="kr">in</span>
 <span class="kr">let</span> (<span class="nv">si&#39;</span>, om&#39;) :=
   transition li (s&#39; i, input_a) <span class="kr">in</span>
 (state_update IM s&#39; i si&#39;, om&#39;)) = (
c, o)</span></span></span><br><span><var>Htl</var><span class="hyp-type"><b>: </b><span>finite_valid_trace_from Free c0 []</span></span></span><br><span><var>Ht</var><span class="hyp-type"><b>: </b><span>input_valid_transition Free label_a (
  s, input_a) (c0, o0)</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">finite_valid_trace_from Free s&#39;
  (rev
     [{|
        l := label_a;
        input := input_a;
        destination := c;
        output := o
      |}], c).<span class="mi">1</span>
‚àß (rev
     [{|
        l := label_a;
        input := input_a;
        destination := c;
        output := o
      |}], c).<span class="mi">2</span> i =
  (rev
     [{|
        l := label_a;
        input := input_a;
        destination := c0;
        output := o0
      |}], c0).<span class="mi">2</span> i</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="Composition-v-chk148" style="display: none" type="checkbox"><label class="alectryon-input" for="Composition-v-chk148"><span class="nb">split</span>.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>message, index</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>EqDecision0</var><span class="hyp-type"><b>: </b><span>EqDecision index</span></span></span><br><span><var>IM</var><span class="hyp-type"><b>: </b><span>index ‚Üí VLSM message</span></span></span><br><span><var>Free</var><span><span class="hyp-body"><b>:= </b><span>free_composite_vlsm IM</span></span><span class="hyp-type"><b>: </b><span>VLSM message</span></span></span></span><br><span><var>s, s'</var><span class="hyp-type"><b>: </b><span>composite_state IM</span></span></span><br><span><var>Hprs'</var><span class="hyp-type"><b>: </b><span>valid_state_prop Free s&#39;</span></span></span><br><span><var>label_a</var><span class="hyp-type"><b>: </b><span>composite_label IM</span></span></span><br><span><var>input_a</var><span class="hyp-type"><b>: </b><span>option message</span></span></span><br><span><var>i</var><span><span class="hyp-body"><b>:= </b><span>projT1 label_a</span></span><span class="hyp-type"><b>: </b><span>index</span></span></span></span><br><span><var>Heq</var><span class="hyp-type"><b>: </b><span>s i = s&#39; i</span></span></span><br><span><var>c0</var><span class="hyp-type"><b>: </b><span>composite_state IM</span></span></span><br><span><var>o0</var><span class="hyp-type"><b>: </b><span>option message</span></span></span><br><span><var>eq_trans</var><span class="hyp-type"><b>: </b><span>(<span class="kr">let</span> (<span class="nv">i</span>, li) := label_a <span class="kr">in</span>
 <span class="kr">let</span> (<span class="nv">si&#39;</span>, om&#39;) :=
   transition li (s i, input_a) <span class="kr">in</span>
 (state_update IM s i si&#39;, om&#39;)) = (
c0, o0)</span></span></span><br><span><var>Hpr</var><span class="hyp-type"><b>: </b><span>finite_valid_trace_from Free s
  (rev
     [{|
        l := label_a;
        input := input_a;
        destination := c0;
        output := o0
      |}], c0).<span class="mi">1</span></span></span></span><br><span><var>c</var><span class="hyp-type"><b>: </b><span>composite_state IM</span></span></span><br><span><var>o</var><span class="hyp-type"><b>: </b><span>option message</span></span></span><br><span><var>eq_trans'</var><span class="hyp-type"><b>: </b><span>(<span class="kr">let</span> (<span class="nv">i</span>, li) := label_a <span class="kr">in</span>
 <span class="kr">let</span> (<span class="nv">si&#39;</span>, om&#39;) :=
   transition li (s&#39; i, input_a) <span class="kr">in</span>
 (state_update IM s&#39; i si&#39;, om&#39;)) = (
c, o)</span></span></span><br><span><var>Htl</var><span class="hyp-type"><b>: </b><span>finite_valid_trace_from Free c0 []</span></span></span><br><span><var>Ht</var><span class="hyp-type"><b>: </b><span>input_valid_transition Free label_a (
  s, input_a) (c0, o0)</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">finite_valid_trace_from Free s&#39;
  (rev
     [{|
        l := label_a;
        input := input_a;
        destination := c;
        output := o
      |}], c).<span class="mi">1</span></div></blockquote><div class="alectryon-extra-goals"><input class="alectryon-extra-goal-toggle" id="Composition-v-chk149" style="display: none" type="checkbox"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>message, index</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>EqDecision0</var><span class="hyp-type"><b>: </b><span>EqDecision index</span></span></span><br><span><var>IM</var><span class="hyp-type"><b>: </b><span>index ‚Üí VLSM message</span></span></span><br><span><var>Free</var><span><span class="hyp-body"><b>:= </b><span>free_composite_vlsm IM</span></span><span class="hyp-type"><b>: </b><span>VLSM message</span></span></span></span><br><span><var>s, s'</var><span class="hyp-type"><b>: </b><span>composite_state IM</span></span></span><br><span><var>Hprs'</var><span class="hyp-type"><b>: </b><span>valid_state_prop Free s&#39;</span></span></span><br><span><var>label_a</var><span class="hyp-type"><b>: </b><span>composite_label IM</span></span></span><br><span><var>input_a</var><span class="hyp-type"><b>: </b><span>option message</span></span></span><br><span><var>i</var><span><span class="hyp-body"><b>:= </b><span>projT1 label_a</span></span><span class="hyp-type"><b>: </b><span>index</span></span></span></span><br><span><var>Heq</var><span class="hyp-type"><b>: </b><span>s i = s&#39; i</span></span></span><br><span><var>c0</var><span class="hyp-type"><b>: </b><span>composite_state IM</span></span></span><br><span><var>o0</var><span class="hyp-type"><b>: </b><span>option message</span></span></span><br><span><var>eq_trans</var><span class="hyp-type"><b>: </b><span>(<span class="kr">let</span> (<span class="nv">i</span>, li) := label_a <span class="kr">in</span>
 <span class="kr">let</span> (<span class="nv">si&#39;</span>, om&#39;) :=
   transition li (s i, input_a) <span class="kr">in</span>
 (state_update IM s i si&#39;, om&#39;)) = (
c0, o0)</span></span></span><br><span><var>Hpr</var><span class="hyp-type"><b>: </b><span>finite_valid_trace_from Free s
  (rev
     [{|
        l := label_a;
        input := input_a;
        destination := c0;
        output := o0
      |}], c0).<span class="mi">1</span></span></span></span><br><span><var>c</var><span class="hyp-type"><b>: </b><span>composite_state IM</span></span></span><br><span><var>o</var><span class="hyp-type"><b>: </b><span>option message</span></span></span><br><span><var>eq_trans'</var><span class="hyp-type"><b>: </b><span>(<span class="kr">let</span> (<span class="nv">i</span>, li) := label_a <span class="kr">in</span>
 <span class="kr">let</span> (<span class="nv">si&#39;</span>, om&#39;) :=
   transition li (s&#39; i, input_a) <span class="kr">in</span>
 (state_update IM s&#39; i si&#39;, om&#39;)) = (
c, o)</span></span></span><br><span><var>Htl</var><span class="hyp-type"><b>: </b><span>finite_valid_trace_from Free c0 []</span></span></span><br><span><var>Ht</var><span class="hyp-type"><b>: </b><span>input_valid_transition Free label_a (
  s, input_a) (c0, o0)</span></span></span><br></div><label class="goal-separator" for="Composition-v-chk149"><hr></label><div class="goal-conclusion">(rev
   [{|
      l := label_a;
      input := input_a;
      destination := c;
      output := o
    |}], c).<span class="mi">2</span> i =
(rev
   [{|
      l := label_a;
      input := input_a;
      destination := c0;
      output := o0
    |}], c0).<span class="mi">2</span> i</div></blockquote></div></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="Composition-v-chk14a" style="display: none" type="checkbox"><label class="alectryon-input" for="Composition-v-chk14a">-</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>message, index</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>EqDecision0</var><span class="hyp-type"><b>: </b><span>EqDecision index</span></span></span><br><span><var>IM</var><span class="hyp-type"><b>: </b><span>index ‚Üí VLSM message</span></span></span><br><span><var>Free</var><span><span class="hyp-body"><b>:= </b><span>free_composite_vlsm IM</span></span><span class="hyp-type"><b>: </b><span>VLSM message</span></span></span></span><br><span><var>s, s'</var><span class="hyp-type"><b>: </b><span>composite_state IM</span></span></span><br><span><var>Hprs'</var><span class="hyp-type"><b>: </b><span>valid_state_prop Free s&#39;</span></span></span><br><span><var>label_a</var><span class="hyp-type"><b>: </b><span>composite_label IM</span></span></span><br><span><var>input_a</var><span class="hyp-type"><b>: </b><span>option message</span></span></span><br><span><var>i</var><span><span class="hyp-body"><b>:= </b><span>projT1 label_a</span></span><span class="hyp-type"><b>: </b><span>index</span></span></span></span><br><span><var>Heq</var><span class="hyp-type"><b>: </b><span>s i = s&#39; i</span></span></span><br><span><var>c0</var><span class="hyp-type"><b>: </b><span>composite_state IM</span></span></span><br><span><var>o0</var><span class="hyp-type"><b>: </b><span>option message</span></span></span><br><span><var>eq_trans</var><span class="hyp-type"><b>: </b><span>(<span class="kr">let</span> (<span class="nv">i</span>, li) := label_a <span class="kr">in</span>
 <span class="kr">let</span> (<span class="nv">si&#39;</span>, om&#39;) :=
   transition li (s i, input_a) <span class="kr">in</span>
 (state_update IM s i si&#39;, om&#39;)) = (
c0, o0)</span></span></span><br><span><var>Hpr</var><span class="hyp-type"><b>: </b><span>finite_valid_trace_from Free s
  (rev
     [{|
        l := label_a;
        input := input_a;
        destination := c0;
        output := o0
      |}], c0).<span class="mi">1</span></span></span></span><br><span><var>c</var><span class="hyp-type"><b>: </b><span>composite_state IM</span></span></span><br><span><var>o</var><span class="hyp-type"><b>: </b><span>option message</span></span></span><br><span><var>eq_trans'</var><span class="hyp-type"><b>: </b><span>(<span class="kr">let</span> (<span class="nv">i</span>, li) := label_a <span class="kr">in</span>
 <span class="kr">let</span> (<span class="nv">si&#39;</span>, om&#39;) :=
   transition li (s&#39; i, input_a) <span class="kr">in</span>
 (state_update IM s&#39; i si&#39;, om&#39;)) = (
c, o)</span></span></span><br><span><var>Htl</var><span class="hyp-type"><b>: </b><span>finite_valid_trace_from Free c0 []</span></span></span><br><span><var>Ht</var><span class="hyp-type"><b>: </b><span>input_valid_transition Free label_a (
  s, input_a) (c0, o0)</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">finite_valid_trace_from Free s&#39;
  (rev
     [{|
        l := label_a;
        input := input_a;
        destination := c;
        output := o
      |}], c).<span class="mi">1</span></div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="Composition-v-chk14b" style="display: none" type="checkbox"><label class="alectryon-input" for="Composition-v-chk14b"><span class="nb">assert</span> (Ht&#39; : input_valid_transition Free label_a (s&#39;, input_a) (c, o)).</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>message, index</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>EqDecision0</var><span class="hyp-type"><b>: </b><span>EqDecision index</span></span></span><br><span><var>IM</var><span class="hyp-type"><b>: </b><span>index ‚Üí VLSM message</span></span></span><br><span><var>Free</var><span><span class="hyp-body"><b>:= </b><span>free_composite_vlsm IM</span></span><span class="hyp-type"><b>: </b><span>VLSM message</span></span></span></span><br><span><var>s, s'</var><span class="hyp-type"><b>: </b><span>composite_state IM</span></span></span><br><span><var>Hprs'</var><span class="hyp-type"><b>: </b><span>valid_state_prop Free s&#39;</span></span></span><br><span><var>label_a</var><span class="hyp-type"><b>: </b><span>composite_label IM</span></span></span><br><span><var>input_a</var><span class="hyp-type"><b>: </b><span>option message</span></span></span><br><span><var>i</var><span><span class="hyp-body"><b>:= </b><span>projT1 label_a</span></span><span class="hyp-type"><b>: </b><span>index</span></span></span></span><br><span><var>Heq</var><span class="hyp-type"><b>: </b><span>s i = s&#39; i</span></span></span><br><span><var>c0</var><span class="hyp-type"><b>: </b><span>composite_state IM</span></span></span><br><span><var>o0</var><span class="hyp-type"><b>: </b><span>option message</span></span></span><br><span><var>eq_trans</var><span class="hyp-type"><b>: </b><span>(<span class="kr">let</span> (<span class="nv">i</span>, li) := label_a <span class="kr">in</span>
 <span class="kr">let</span> (<span class="nv">si&#39;</span>, om&#39;) :=
   transition li (s i, input_a) <span class="kr">in</span>
 (state_update IM s i si&#39;, om&#39;)) = (
c0, o0)</span></span></span><br><span><var>Hpr</var><span class="hyp-type"><b>: </b><span>finite_valid_trace_from Free s
  (rev
     [{|
        l := label_a;
        input := input_a;
        destination := c0;
        output := o0
      |}], c0).<span class="mi">1</span></span></span></span><br><span><var>c</var><span class="hyp-type"><b>: </b><span>composite_state IM</span></span></span><br><span><var>o</var><span class="hyp-type"><b>: </b><span>option message</span></span></span><br><span><var>eq_trans'</var><span class="hyp-type"><b>: </b><span>(<span class="kr">let</span> (<span class="nv">i</span>, li) := label_a <span class="kr">in</span>
 <span class="kr">let</span> (<span class="nv">si&#39;</span>, om&#39;) :=
   transition li (s&#39; i, input_a) <span class="kr">in</span>
 (state_update IM s&#39; i si&#39;, om&#39;)) = (
c, o)</span></span></span><br><span><var>Htl</var><span class="hyp-type"><b>: </b><span>finite_valid_trace_from Free c0 []</span></span></span><br><span><var>Ht</var><span class="hyp-type"><b>: </b><span>input_valid_transition Free label_a (
  s, input_a) (c0, o0)</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">input_valid_transition Free label_a (s&#39;, input_a)
  (c, o)</div></blockquote><div class="alectryon-extra-goals"><input class="alectryon-extra-goal-toggle" id="Composition-v-chk14c" style="display: none" type="checkbox"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>message, index</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>EqDecision0</var><span class="hyp-type"><b>: </b><span>EqDecision index</span></span></span><br><span><var>IM</var><span class="hyp-type"><b>: </b><span>index ‚Üí VLSM message</span></span></span><br><span><var>Free</var><span><span class="hyp-body"><b>:= </b><span>free_composite_vlsm IM</span></span><span class="hyp-type"><b>: </b><span>VLSM message</span></span></span></span><br><span><var>s, s'</var><span class="hyp-type"><b>: </b><span>composite_state IM</span></span></span><br><span><var>Hprs'</var><span class="hyp-type"><b>: </b><span>valid_state_prop Free s&#39;</span></span></span><br><span><var>label_a</var><span class="hyp-type"><b>: </b><span>composite_label IM</span></span></span><br><span><var>input_a</var><span class="hyp-type"><b>: </b><span>option message</span></span></span><br><span><var>i</var><span><span class="hyp-body"><b>:= </b><span>projT1 label_a</span></span><span class="hyp-type"><b>: </b><span>index</span></span></span></span><br><span><var>Heq</var><span class="hyp-type"><b>: </b><span>s i = s&#39; i</span></span></span><br><span><var>c0</var><span class="hyp-type"><b>: </b><span>composite_state IM</span></span></span><br><span><var>o0</var><span class="hyp-type"><b>: </b><span>option message</span></span></span><br><span><var>eq_trans</var><span class="hyp-type"><b>: </b><span>(<span class="kr">let</span> (<span class="nv">i</span>, li) := label_a <span class="kr">in</span>
 <span class="kr">let</span> (<span class="nv">si&#39;</span>, om&#39;) :=
   transition li (s i, input_a) <span class="kr">in</span>
 (state_update IM s i si&#39;, om&#39;)) = (
c0, o0)</span></span></span><br><span><var>Hpr</var><span class="hyp-type"><b>: </b><span>finite_valid_trace_from Free s
  (rev
     [{|
        l := label_a;
        input := input_a;
        destination := c0;
        output := o0
      |}], c0).<span class="mi">1</span></span></span></span><br><span><var>c</var><span class="hyp-type"><b>: </b><span>composite_state IM</span></span></span><br><span><var>o</var><span class="hyp-type"><b>: </b><span>option message</span></span></span><br><span><var>eq_trans'</var><span class="hyp-type"><b>: </b><span>(<span class="kr">let</span> (<span class="nv">i</span>, li) := label_a <span class="kr">in</span>
 <span class="kr">let</span> (<span class="nv">si&#39;</span>, om&#39;) :=
   transition li (s&#39; i, input_a) <span class="kr">in</span>
 (state_update IM s&#39; i si&#39;, om&#39;)) = (
c, o)</span></span></span><br><span><var>Htl</var><span class="hyp-type"><b>: </b><span>finite_valid_trace_from Free c0 []</span></span></span><br><span><var>Ht</var><span class="hyp-type"><b>: </b><span>input_valid_transition Free label_a (
  s, input_a) (c0, o0)</span></span></span><br><span><var>Ht'</var><span class="hyp-type"><b>: </b><span>input_valid_transition Free label_a
  (s&#39;, input_a) (c, o)</span></span></span><br></div><label class="goal-separator" for="Composition-v-chk14c"><hr></label><div class="goal-conclusion">finite_valid_trace_from Free s&#39;
  (rev
     [{|
        l := label_a;
        input := input_a;
        destination := c;
        output := o
      |}], c).<span class="mi">1</span></div></blockquote></div></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="Composition-v-chk14d" style="display: none" type="checkbox"><label class="alectryon-input" for="Composition-v-chk14d">{</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>message, index</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>EqDecision0</var><span class="hyp-type"><b>: </b><span>EqDecision index</span></span></span><br><span><var>IM</var><span class="hyp-type"><b>: </b><span>index ‚Üí VLSM message</span></span></span><br><span><var>Free</var><span><span class="hyp-body"><b>:= </b><span>free_composite_vlsm IM</span></span><span class="hyp-type"><b>: </b><span>VLSM message</span></span></span></span><br><span><var>s, s'</var><span class="hyp-type"><b>: </b><span>composite_state IM</span></span></span><br><span><var>Hprs'</var><span class="hyp-type"><b>: </b><span>valid_state_prop Free s&#39;</span></span></span><br><span><var>label_a</var><span class="hyp-type"><b>: </b><span>composite_label IM</span></span></span><br><span><var>input_a</var><span class="hyp-type"><b>: </b><span>option message</span></span></span><br><span><var>i</var><span><span class="hyp-body"><b>:= </b><span>projT1 label_a</span></span><span class="hyp-type"><b>: </b><span>index</span></span></span></span><br><span><var>Heq</var><span class="hyp-type"><b>: </b><span>s i = s&#39; i</span></span></span><br><span><var>c0</var><span class="hyp-type"><b>: </b><span>composite_state IM</span></span></span><br><span><var>o0</var><span class="hyp-type"><b>: </b><span>option message</span></span></span><br><span><var>eq_trans</var><span class="hyp-type"><b>: </b><span>(<span class="kr">let</span> (<span class="nv">i</span>, li) := label_a <span class="kr">in</span>
 <span class="kr">let</span> (<span class="nv">si&#39;</span>, om&#39;) :=
   transition li (s i, input_a) <span class="kr">in</span>
 (state_update IM s i si&#39;, om&#39;)) = (
c0, o0)</span></span></span><br><span><var>Hpr</var><span class="hyp-type"><b>: </b><span>finite_valid_trace_from Free s
  (rev
     [{|
        l := label_a;
        input := input_a;
        destination := c0;
        output := o0
      |}], c0).<span class="mi">1</span></span></span></span><br><span><var>c</var><span class="hyp-type"><b>: </b><span>composite_state IM</span></span></span><br><span><var>o</var><span class="hyp-type"><b>: </b><span>option message</span></span></span><br><span><var>eq_trans'</var><span class="hyp-type"><b>: </b><span>(<span class="kr">let</span> (<span class="nv">i</span>, li) := label_a <span class="kr">in</span>
 <span class="kr">let</span> (<span class="nv">si&#39;</span>, om&#39;) :=
   transition li (s&#39; i, input_a) <span class="kr">in</span>
 (state_update IM s&#39; i si&#39;, om&#39;)) = (
c, o)</span></span></span><br><span><var>Htl</var><span class="hyp-type"><b>: </b><span>finite_valid_trace_from Free c0 []</span></span></span><br><span><var>Ht</var><span class="hyp-type"><b>: </b><span>input_valid_transition Free label_a (
  s, input_a) (c0, o0)</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">input_valid_transition Free label_a (s&#39;, input_a)
  (c, o)</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">      </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="Composition-v-chk14e" style="display: none" type="checkbox"><label class="alectryon-input" for="Composition-v-chk14e"><span class="nb">unfold</span> input_valid_transition <span class="kr">in</span> *.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>message, index</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>EqDecision0</var><span class="hyp-type"><b>: </b><span>EqDecision index</span></span></span><br><span><var>IM</var><span class="hyp-type"><b>: </b><span>index ‚Üí VLSM message</span></span></span><br><span><var>Free</var><span><span class="hyp-body"><b>:= </b><span>free_composite_vlsm IM</span></span><span class="hyp-type"><b>: </b><span>VLSM message</span></span></span></span><br><span><var>s, s'</var><span class="hyp-type"><b>: </b><span>composite_state IM</span></span></span><br><span><var>Hprs'</var><span class="hyp-type"><b>: </b><span>valid_state_prop Free s&#39;</span></span></span><br><span><var>label_a</var><span class="hyp-type"><b>: </b><span>composite_label IM</span></span></span><br><span><var>input_a</var><span class="hyp-type"><b>: </b><span>option message</span></span></span><br><span><var>i</var><span><span class="hyp-body"><b>:= </b><span>projT1 label_a</span></span><span class="hyp-type"><b>: </b><span>index</span></span></span></span><br><span><var>Heq</var><span class="hyp-type"><b>: </b><span>s i = s&#39; i</span></span></span><br><span><var>c0</var><span class="hyp-type"><b>: </b><span>composite_state IM</span></span></span><br><span><var>o0</var><span class="hyp-type"><b>: </b><span>option message</span></span></span><br><span><var>eq_trans</var><span class="hyp-type"><b>: </b><span>(<span class="kr">let</span> (<span class="nv">i</span>, li) := label_a <span class="kr">in</span>
 <span class="kr">let</span> (<span class="nv">si&#39;</span>, om&#39;) :=
   transition li (s i, input_a) <span class="kr">in</span>
 (state_update IM s i si&#39;, om&#39;)) = (
c0, o0)</span></span></span><br><span><var>Hpr</var><span class="hyp-type"><b>: </b><span>finite_valid_trace_from Free s
  (rev
     [{|
        l := label_a;
        input := input_a;
        destination := c0;
        output := o0
      |}], c0).<span class="mi">1</span></span></span></span><br><span><var>c</var><span class="hyp-type"><b>: </b><span>composite_state IM</span></span></span><br><span><var>o</var><span class="hyp-type"><b>: </b><span>option message</span></span></span><br><span><var>eq_trans'</var><span class="hyp-type"><b>: </b><span>(<span class="kr">let</span> (<span class="nv">i</span>, li) := label_a <span class="kr">in</span>
 <span class="kr">let</span> (<span class="nv">si&#39;</span>, om&#39;) :=
   transition li (s&#39; i, input_a) <span class="kr">in</span>
 (state_update IM s&#39; i si&#39;, om&#39;)) = (
c, o)</span></span></span><br><span><var>Htl</var><span class="hyp-type"><b>: </b><span>finite_valid_trace_from Free c0 []</span></span></span><br><span><var>Ht</var><span class="hyp-type"><b>: </b><span>input_valid Free label_a (s, input_a)
‚àß transition label_a (s, input_a) = (c0, o0)</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">input_valid Free label_a (s&#39;, input_a)
‚àß transition label_a (s&#39;, input_a) = (c, o)</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">      </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="Composition-v-chk14f" style="display: none" type="checkbox"><label class="alectryon-input" for="Composition-v-chk14f"><span class="nb">destruct</span> Ht <span class="kr">as</span> [Hpr_valid Htrans].</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>message, index</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>EqDecision0</var><span class="hyp-type"><b>: </b><span>EqDecision index</span></span></span><br><span><var>IM</var><span class="hyp-type"><b>: </b><span>index ‚Üí VLSM message</span></span></span><br><span><var>Free</var><span><span class="hyp-body"><b>:= </b><span>free_composite_vlsm IM</span></span><span class="hyp-type"><b>: </b><span>VLSM message</span></span></span></span><br><span><var>s, s'</var><span class="hyp-type"><b>: </b><span>composite_state IM</span></span></span><br><span><var>Hprs'</var><span class="hyp-type"><b>: </b><span>valid_state_prop Free s&#39;</span></span></span><br><span><var>label_a</var><span class="hyp-type"><b>: </b><span>composite_label IM</span></span></span><br><span><var>input_a</var><span class="hyp-type"><b>: </b><span>option message</span></span></span><br><span><var>i</var><span><span class="hyp-body"><b>:= </b><span>projT1 label_a</span></span><span class="hyp-type"><b>: </b><span>index</span></span></span></span><br><span><var>Heq</var><span class="hyp-type"><b>: </b><span>s i = s&#39; i</span></span></span><br><span><var>c0</var><span class="hyp-type"><b>: </b><span>composite_state IM</span></span></span><br><span><var>o0</var><span class="hyp-type"><b>: </b><span>option message</span></span></span><br><span><var>eq_trans</var><span class="hyp-type"><b>: </b><span>(<span class="kr">let</span> (<span class="nv">i</span>, li) := label_a <span class="kr">in</span>
 <span class="kr">let</span> (<span class="nv">si&#39;</span>, om&#39;) :=
   transition li (s i, input_a) <span class="kr">in</span>
 (state_update IM s i si&#39;, om&#39;)) = (
c0, o0)</span></span></span><br><span><var>Hpr</var><span class="hyp-type"><b>: </b><span>finite_valid_trace_from Free s
  (rev
     [{|
        l := label_a;
        input := input_a;
        destination := c0;
        output := o0
      |}], c0).<span class="mi">1</span></span></span></span><br><span><var>c</var><span class="hyp-type"><b>: </b><span>composite_state IM</span></span></span><br><span><var>o</var><span class="hyp-type"><b>: </b><span>option message</span></span></span><br><span><var>eq_trans'</var><span class="hyp-type"><b>: </b><span>(<span class="kr">let</span> (<span class="nv">i</span>, li) := label_a <span class="kr">in</span>
 <span class="kr">let</span> (<span class="nv">si&#39;</span>, om&#39;) :=
   transition li (s&#39; i, input_a) <span class="kr">in</span>
 (state_update IM s&#39; i si&#39;, om&#39;)) = (
c, o)</span></span></span><br><span><var>Htl</var><span class="hyp-type"><b>: </b><span>finite_valid_trace_from Free c0 []</span></span></span><br><span><var>Hpr_valid</var><span class="hyp-type"><b>: </b><span>input_valid Free label_a (s, input_a)</span></span></span><br><span><var>Htrans</var><span class="hyp-type"><b>: </b><span>transition label_a (s, input_a) = (c0, o0)</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">input_valid Free label_a (s&#39;, input_a)
‚àß transition label_a (s&#39;, input_a) = (c, o)</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">      </span><span class="alectryon-sentence"><span class="alectryon-input"><span class="bp">by</span> <span class="nb">apply</span> relevant_component_transition_free <span class="kr">with</span> (s&#39; := s&#39;) <span class="kr">in</span> Hpr_valid; itauto.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="Composition-v-chk150" style="display: none" type="checkbox"><label class="alectryon-input" for="Composition-v-chk150">}</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>message, index</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>EqDecision0</var><span class="hyp-type"><b>: </b><span>EqDecision index</span></span></span><br><span><var>IM</var><span class="hyp-type"><b>: </b><span>index ‚Üí VLSM message</span></span></span><br><span><var>Free</var><span><span class="hyp-body"><b>:= </b><span>free_composite_vlsm IM</span></span><span class="hyp-type"><b>: </b><span>VLSM message</span></span></span></span><br><span><var>s, s'</var><span class="hyp-type"><b>: </b><span>composite_state IM</span></span></span><br><span><var>Hprs'</var><span class="hyp-type"><b>: </b><span>valid_state_prop Free s&#39;</span></span></span><br><span><var>label_a</var><span class="hyp-type"><b>: </b><span>composite_label IM</span></span></span><br><span><var>input_a</var><span class="hyp-type"><b>: </b><span>option message</span></span></span><br><span><var>i</var><span><span class="hyp-body"><b>:= </b><span>projT1 label_a</span></span><span class="hyp-type"><b>: </b><span>index</span></span></span></span><br><span><var>Heq</var><span class="hyp-type"><b>: </b><span>s i = s&#39; i</span></span></span><br><span><var>c0</var><span class="hyp-type"><b>: </b><span>composite_state IM</span></span></span><br><span><var>o0</var><span class="hyp-type"><b>: </b><span>option message</span></span></span><br><span><var>eq_trans</var><span class="hyp-type"><b>: </b><span>(<span class="kr">let</span> (<span class="nv">i</span>, li) := label_a <span class="kr">in</span>
 <span class="kr">let</span> (<span class="nv">si&#39;</span>, om&#39;) :=
   transition li (s i, input_a) <span class="kr">in</span>
 (state_update IM s i si&#39;, om&#39;)) = (
c0, o0)</span></span></span><br><span><var>Hpr</var><span class="hyp-type"><b>: </b><span>finite_valid_trace_from Free s
  (rev
     [{|
        l := label_a;
        input := input_a;
        destination := c0;
        output := o0
      |}], c0).<span class="mi">1</span></span></span></span><br><span><var>c</var><span class="hyp-type"><b>: </b><span>composite_state IM</span></span></span><br><span><var>o</var><span class="hyp-type"><b>: </b><span>option message</span></span></span><br><span><var>eq_trans'</var><span class="hyp-type"><b>: </b><span>(<span class="kr">let</span> (<span class="nv">i</span>, li) := label_a <span class="kr">in</span>
 <span class="kr">let</span> (<span class="nv">si&#39;</span>, om&#39;) :=
   transition li (s&#39; i, input_a) <span class="kr">in</span>
 (state_update IM s&#39; i si&#39;, om&#39;)) = (
c, o)</span></span></span><br><span><var>Htl</var><span class="hyp-type"><b>: </b><span>finite_valid_trace_from Free c0 []</span></span></span><br><span><var>Ht</var><span class="hyp-type"><b>: </b><span>input_valid_transition Free label_a (
  s, input_a) (c0, o0)</span></span></span><br><span><var>Ht'</var><span class="hyp-type"><b>: </b><span>input_valid_transition Free label_a
  (s&#39;, input_a) (c, o)</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">finite_valid_trace_from Free s&#39;
  (rev
     [{|
        l := label_a;
        input := input_a;
        destination := c;
        output := o
      |}], c).<span class="mi">1</span></div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="Composition-v-chk151" style="display: none" type="checkbox"><label class="alectryon-input" for="Composition-v-chk151"><span class="nb">apply</span> finite_valid_trace_from_extend; [| <span class="bp">done</span>].</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>message, index</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>EqDecision0</var><span class="hyp-type"><b>: </b><span>EqDecision index</span></span></span><br><span><var>IM</var><span class="hyp-type"><b>: </b><span>index ‚Üí VLSM message</span></span></span><br><span><var>Free</var><span><span class="hyp-body"><b>:= </b><span>free_composite_vlsm IM</span></span><span class="hyp-type"><b>: </b><span>VLSM message</span></span></span></span><br><span><var>s, s'</var><span class="hyp-type"><b>: </b><span>composite_state IM</span></span></span><br><span><var>Hprs'</var><span class="hyp-type"><b>: </b><span>valid_state_prop Free s&#39;</span></span></span><br><span><var>label_a</var><span class="hyp-type"><b>: </b><span>composite_label IM</span></span></span><br><span><var>input_a</var><span class="hyp-type"><b>: </b><span>option message</span></span></span><br><span><var>i</var><span><span class="hyp-body"><b>:= </b><span>projT1 label_a</span></span><span class="hyp-type"><b>: </b><span>index</span></span></span></span><br><span><var>Heq</var><span class="hyp-type"><b>: </b><span>s i = s&#39; i</span></span></span><br><span><var>c0</var><span class="hyp-type"><b>: </b><span>composite_state IM</span></span></span><br><span><var>o0</var><span class="hyp-type"><b>: </b><span>option message</span></span></span><br><span><var>eq_trans</var><span class="hyp-type"><b>: </b><span>(<span class="kr">let</span> (<span class="nv">i</span>, li) := label_a <span class="kr">in</span>
 <span class="kr">let</span> (<span class="nv">si&#39;</span>, om&#39;) :=
   transition li (s i, input_a) <span class="kr">in</span>
 (state_update IM s i si&#39;, om&#39;)) = (
c0, o0)</span></span></span><br><span><var>Hpr</var><span class="hyp-type"><b>: </b><span>finite_valid_trace_from Free s
  (rev
     [{|
        l := label_a;
        input := input_a;
        destination := c0;
        output := o0
      |}], c0).<span class="mi">1</span></span></span></span><br><span><var>c</var><span class="hyp-type"><b>: </b><span>composite_state IM</span></span></span><br><span><var>o</var><span class="hyp-type"><b>: </b><span>option message</span></span></span><br><span><var>eq_trans'</var><span class="hyp-type"><b>: </b><span>(<span class="kr">let</span> (<span class="nv">i</span>, li) := label_a <span class="kr">in</span>
 <span class="kr">let</span> (<span class="nv">si&#39;</span>, om&#39;) :=
   transition li (s&#39; i, input_a) <span class="kr">in</span>
 (state_update IM s&#39; i si&#39;, om&#39;)) = (
c, o)</span></span></span><br><span><var>Htl</var><span class="hyp-type"><b>: </b><span>finite_valid_trace_from Free c0 []</span></span></span><br><span><var>Ht</var><span class="hyp-type"><b>: </b><span>input_valid_transition Free label_a (
  s, input_a) (c0, o0)</span></span></span><br><span><var>Ht'</var><span class="hyp-type"><b>: </b><span>input_valid_transition Free label_a
  (s&#39;, input_a) (c, o)</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">finite_valid_trace_from Free c []</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="Composition-v-chk152" style="display: none" type="checkbox"><label class="alectryon-input" for="Composition-v-chk152"><span class="nb">apply</span> finite_valid_trace_from_empty.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>message, index</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>EqDecision0</var><span class="hyp-type"><b>: </b><span>EqDecision index</span></span></span><br><span><var>IM</var><span class="hyp-type"><b>: </b><span>index ‚Üí VLSM message</span></span></span><br><span><var>Free</var><span><span class="hyp-body"><b>:= </b><span>free_composite_vlsm IM</span></span><span class="hyp-type"><b>: </b><span>VLSM message</span></span></span></span><br><span><var>s, s'</var><span class="hyp-type"><b>: </b><span>composite_state IM</span></span></span><br><span><var>Hprs'</var><span class="hyp-type"><b>: </b><span>valid_state_prop Free s&#39;</span></span></span><br><span><var>label_a</var><span class="hyp-type"><b>: </b><span>composite_label IM</span></span></span><br><span><var>input_a</var><span class="hyp-type"><b>: </b><span>option message</span></span></span><br><span><var>i</var><span><span class="hyp-body"><b>:= </b><span>projT1 label_a</span></span><span class="hyp-type"><b>: </b><span>index</span></span></span></span><br><span><var>Heq</var><span class="hyp-type"><b>: </b><span>s i = s&#39; i</span></span></span><br><span><var>c0</var><span class="hyp-type"><b>: </b><span>composite_state IM</span></span></span><br><span><var>o0</var><span class="hyp-type"><b>: </b><span>option message</span></span></span><br><span><var>eq_trans</var><span class="hyp-type"><b>: </b><span>(<span class="kr">let</span> (<span class="nv">i</span>, li) := label_a <span class="kr">in</span>
 <span class="kr">let</span> (<span class="nv">si&#39;</span>, om&#39;) :=
   transition li (s i, input_a) <span class="kr">in</span>
 (state_update IM s i si&#39;, om&#39;)) = (
c0, o0)</span></span></span><br><span><var>Hpr</var><span class="hyp-type"><b>: </b><span>finite_valid_trace_from Free s
  (rev
     [{|
        l := label_a;
        input := input_a;
        destination := c0;
        output := o0
      |}], c0).<span class="mi">1</span></span></span></span><br><span><var>c</var><span class="hyp-type"><b>: </b><span>composite_state IM</span></span></span><br><span><var>o</var><span class="hyp-type"><b>: </b><span>option message</span></span></span><br><span><var>eq_trans'</var><span class="hyp-type"><b>: </b><span>(<span class="kr">let</span> (<span class="nv">i</span>, li) := label_a <span class="kr">in</span>
 <span class="kr">let</span> (<span class="nv">si&#39;</span>, om&#39;) :=
   transition li (s&#39; i, input_a) <span class="kr">in</span>
 (state_update IM s&#39; i si&#39;, om&#39;)) = (
c, o)</span></span></span><br><span><var>Htl</var><span class="hyp-type"><b>: </b><span>finite_valid_trace_from Free c0 []</span></span></span><br><span><var>Ht</var><span class="hyp-type"><b>: </b><span>input_valid_transition Free label_a (
  s, input_a) (c0, o0)</span></span></span><br><span><var>Ht'</var><span class="hyp-type"><b>: </b><span>input_valid_transition Free label_a
  (s&#39;, input_a) (c, o)</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">valid_state_prop Free c</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><span class="alectryon-input"><span class="bp">by</span> <span class="nb">apply</span> input_valid_transition_destination <span class="kr">in</span> Ht&#39;.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="Composition-v-chk153" style="display: none" type="checkbox"><label class="alectryon-input" for="Composition-v-chk153">-</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>message, index</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>EqDecision0</var><span class="hyp-type"><b>: </b><span>EqDecision index</span></span></span><br><span><var>IM</var><span class="hyp-type"><b>: </b><span>index ‚Üí VLSM message</span></span></span><br><span><var>Free</var><span><span class="hyp-body"><b>:= </b><span>free_composite_vlsm IM</span></span><span class="hyp-type"><b>: </b><span>VLSM message</span></span></span></span><br><span><var>s, s'</var><span class="hyp-type"><b>: </b><span>composite_state IM</span></span></span><br><span><var>Hprs'</var><span class="hyp-type"><b>: </b><span>valid_state_prop Free s&#39;</span></span></span><br><span><var>label_a</var><span class="hyp-type"><b>: </b><span>composite_label IM</span></span></span><br><span><var>input_a</var><span class="hyp-type"><b>: </b><span>option message</span></span></span><br><span><var>i</var><span><span class="hyp-body"><b>:= </b><span>projT1 label_a</span></span><span class="hyp-type"><b>: </b><span>index</span></span></span></span><br><span><var>Heq</var><span class="hyp-type"><b>: </b><span>s i = s&#39; i</span></span></span><br><span><var>c0</var><span class="hyp-type"><b>: </b><span>composite_state IM</span></span></span><br><span><var>o0</var><span class="hyp-type"><b>: </b><span>option message</span></span></span><br><span><var>eq_trans</var><span class="hyp-type"><b>: </b><span>(<span class="kr">let</span> (<span class="nv">i</span>, li) := label_a <span class="kr">in</span>
 <span class="kr">let</span> (<span class="nv">si&#39;</span>, om&#39;) :=
   transition li (s i, input_a) <span class="kr">in</span>
 (state_update IM s i si&#39;, om&#39;)) = (
c0, o0)</span></span></span><br><span><var>Hpr</var><span class="hyp-type"><b>: </b><span>finite_valid_trace_from Free s
  (rev
     [{|
        l := label_a;
        input := input_a;
        destination := c0;
        output := o0
      |}], c0).<span class="mi">1</span></span></span></span><br><span><var>c</var><span class="hyp-type"><b>: </b><span>composite_state IM</span></span></span><br><span><var>o</var><span class="hyp-type"><b>: </b><span>option message</span></span></span><br><span><var>eq_trans'</var><span class="hyp-type"><b>: </b><span>(<span class="kr">let</span> (<span class="nv">i</span>, li) := label_a <span class="kr">in</span>
 <span class="kr">let</span> (<span class="nv">si&#39;</span>, om&#39;) :=
   transition li (s&#39; i, input_a) <span class="kr">in</span>
 (state_update IM s&#39; i si&#39;, om&#39;)) = (
c, o)</span></span></span><br><span><var>Htl</var><span class="hyp-type"><b>: </b><span>finite_valid_trace_from Free c0 []</span></span></span><br><span><var>Ht</var><span class="hyp-type"><b>: </b><span>input_valid_transition Free label_a (
  s, input_a) (c0, o0)</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">(rev
   [{|
      l := label_a;
      input := input_a;
      destination := c;
      output := o
    |}], c).<span class="mi">2</span> i =
(rev
   [{|
      l := label_a;
      input := input_a;
      destination := c0;
      output := o0
    |}], c0).<span class="mi">2</span> i</div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="Composition-v-chk154" style="display: none" type="checkbox"><label class="alectryon-input" for="Composition-v-chk154"><span class="nb">specialize</span> (relevant_component_transition2_free s s&#39; label_a input_a Heq Hprs&#39;) <span class="kr">as</span> Hrel.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>message, index</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>EqDecision0</var><span class="hyp-type"><b>: </b><span>EqDecision index</span></span></span><br><span><var>IM</var><span class="hyp-type"><b>: </b><span>index ‚Üí VLSM message</span></span></span><br><span><var>Free</var><span><span class="hyp-body"><b>:= </b><span>free_composite_vlsm IM</span></span><span class="hyp-type"><b>: </b><span>VLSM message</span></span></span></span><br><span><var>s, s'</var><span class="hyp-type"><b>: </b><span>composite_state IM</span></span></span><br><span><var>Hprs'</var><span class="hyp-type"><b>: </b><span>valid_state_prop Free s&#39;</span></span></span><br><span><var>label_a</var><span class="hyp-type"><b>: </b><span>composite_label IM</span></span></span><br><span><var>input_a</var><span class="hyp-type"><b>: </b><span>option message</span></span></span><br><span><var>i</var><span><span class="hyp-body"><b>:= </b><span>projT1 label_a</span></span><span class="hyp-type"><b>: </b><span>index</span></span></span></span><br><span><var>Heq</var><span class="hyp-type"><b>: </b><span>s i = s&#39; i</span></span></span><br><span><var>c0</var><span class="hyp-type"><b>: </b><span>composite_state IM</span></span></span><br><span><var>o0</var><span class="hyp-type"><b>: </b><span>option message</span></span></span><br><span><var>eq_trans</var><span class="hyp-type"><b>: </b><span>(<span class="kr">let</span> (<span class="nv">i</span>, li) := label_a <span class="kr">in</span>
 <span class="kr">let</span> (<span class="nv">si&#39;</span>, om&#39;) :=
   transition li (s i, input_a) <span class="kr">in</span>
 (state_update IM s i si&#39;, om&#39;)) = (
c0, o0)</span></span></span><br><span><var>Hpr</var><span class="hyp-type"><b>: </b><span>finite_valid_trace_from Free s
  (rev
     [{|
        l := label_a;
        input := input_a;
        destination := c0;
        output := o0
      |}], c0).<span class="mi">1</span></span></span></span><br><span><var>c</var><span class="hyp-type"><b>: </b><span>composite_state IM</span></span></span><br><span><var>o</var><span class="hyp-type"><b>: </b><span>option message</span></span></span><br><span><var>eq_trans'</var><span class="hyp-type"><b>: </b><span>(<span class="kr">let</span> (<span class="nv">i</span>, li) := label_a <span class="kr">in</span>
 <span class="kr">let</span> (<span class="nv">si&#39;</span>, om&#39;) :=
   transition li (s&#39; i, input_a) <span class="kr">in</span>
 (state_update IM s&#39; i si&#39;, om&#39;)) = (
c, o)</span></span></span><br><span><var>Htl</var><span class="hyp-type"><b>: </b><span>finite_valid_trace_from Free c0 []</span></span></span><br><span><var>Ht</var><span class="hyp-type"><b>: </b><span>input_valid_transition Free label_a (
  s, input_a) (c0, o0)</span></span></span><br><span><var>Hrel</var><span class="hyp-type"><b>: </b><span><span class="kr">let</span> (<span class="nv">dest</span>, output) :=
  transition label_a (s, input_a) <span class="kr">in</span>
<span class="kr">let</span> (<span class="nv">dest&#39;</span>, output&#39;) :=
  transition label_a (s&#39;, input_a) <span class="kr">in</span>
output = output&#39;
‚àß dest (projT1 label_a) =
  dest&#39; (projT1 label_a)</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">(rev
   [{|
      l := label_a;
      input := input_a;
      destination := c;
      output := o
    |}], c).<span class="mi">2</span> i =
(rev
   [{|
      l := label_a;
      input := input_a;
      destination := c0;
      output := o0
    |}], c0).<span class="mi">2</span> i</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="Composition-v-chk155" style="display: none" type="checkbox"><label class="alectryon-input" for="Composition-v-chk155"><span class="nb">cbn</span> <span class="kr">in</span> *.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>message, index</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>EqDecision0</var><span class="hyp-type"><b>: </b><span>EqDecision index</span></span></span><br><span><var>IM</var><span class="hyp-type"><b>: </b><span>index ‚Üí VLSM message</span></span></span><br><span><var>Free</var><span><span class="hyp-body"><b>:= </b><span>free_composite_vlsm IM</span></span><span class="hyp-type"><b>: </b><span>VLSM message</span></span></span></span><br><span><var>s, s'</var><span class="hyp-type"><b>: </b><span>composite_state IM</span></span></span><br><span><var>Hprs'</var><span class="hyp-type"><b>: </b><span>valid_state_prop Free s&#39;</span></span></span><br><span><var>label_a</var><span class="hyp-type"><b>: </b><span>composite_label IM</span></span></span><br><span><var>input_a</var><span class="hyp-type"><b>: </b><span>option message</span></span></span><br><span><var>i</var><span><span class="hyp-body"><b>:= </b><span>projT1 label_a</span></span><span class="hyp-type"><b>: </b><span>index</span></span></span></span><br><span><var>Heq</var><span class="hyp-type"><b>: </b><span>s i = s&#39; i</span></span></span><br><span><var>c0</var><span class="hyp-type"><b>: </b><span>composite_state IM</span></span></span><br><span><var>o0</var><span class="hyp-type"><b>: </b><span>option message</span></span></span><br><span><var>eq_trans</var><span class="hyp-type"><b>: </b><span>(<span class="kr">let</span> (<span class="nv">i</span>, li) := label_a <span class="kr">in</span>
 <span class="kr">let</span> (<span class="nv">si&#39;</span>, om&#39;) :=
   transition li (s i, input_a) <span class="kr">in</span>
 (state_update IM s i si&#39;, om&#39;)) = (
c0, o0)</span></span></span><br><span><var>Hpr</var><span class="hyp-type"><b>: </b><span>finite_valid_trace_from Free s
  [{|
     l := label_a;
     input := input_a;
     destination := c0;
     output := o0
   |}]</span></span></span><br><span><var>c</var><span class="hyp-type"><b>: </b><span>composite_state IM</span></span></span><br><span><var>o</var><span class="hyp-type"><b>: </b><span>option message</span></span></span><br><span><var>eq_trans'</var><span class="hyp-type"><b>: </b><span>(<span class="kr">let</span> (<span class="nv">i</span>, li) := label_a <span class="kr">in</span>
 <span class="kr">let</span> (<span class="nv">si&#39;</span>, om&#39;) :=
   transition li (s&#39; i, input_a) <span class="kr">in</span>
 (state_update IM s&#39; i si&#39;, om&#39;)) = (
c, o)</span></span></span><br><span><var>Htl</var><span class="hyp-type"><b>: </b><span>finite_valid_trace_from Free c0 []</span></span></span><br><span><var>Ht</var><span class="hyp-type"><b>: </b><span>input_valid_transition Free label_a (
  s, input_a) (c0, o0)</span></span></span><br><span><var>Hrel</var><span class="hyp-type"><b>: </b><span><span class="kr">let</span> (<span class="nv">dest</span>, output) :=
  <span class="kr">let</span> (<span class="nv">i</span>, li) := label_a <span class="kr">in</span>
  <span class="kr">let</span> (<span class="nv">si&#39;</span>, om&#39;) :=
    transition li (s i, input_a) <span class="kr">in</span>
  (state_update IM s i si&#39;, om&#39;) <span class="kr">in</span>
<span class="kr">let</span> (<span class="nv">dest&#39;</span>, output&#39;) :=
  <span class="kr">let</span> (<span class="nv">i</span>, li) := label_a <span class="kr">in</span>
  <span class="kr">let</span> (<span class="nv">si&#39;</span>, om&#39;) :=
    transition li (s&#39; i, input_a) <span class="kr">in</span>
  (state_update IM s&#39; i si&#39;, om&#39;) <span class="kr">in</span>
output = output&#39;
‚àß dest (projT1 label_a) =
  dest&#39; (projT1 label_a)</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">c i = c0 i</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="Composition-v-chk156" style="display: none" type="checkbox"><label class="alectryon-input" for="Composition-v-chk156"><span class="kp">repeat</span> case_match.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>message, index</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>EqDecision0</var><span class="hyp-type"><b>: </b><span>EqDecision index</span></span></span><br><span><var>IM</var><span class="hyp-type"><b>: </b><span>index ‚Üí VLSM message</span></span></span><br><span><var>Free</var><span><span class="hyp-body"><b>:= </b><span>free_composite_vlsm IM</span></span><span class="hyp-type"><b>: </b><span>VLSM message</span></span></span></span><br><span><var>s, s'</var><span class="hyp-type"><b>: </b><span>composite_state IM</span></span></span><br><span><var>Hprs'</var><span class="hyp-type"><b>: </b><span>valid_state_prop Free s&#39;</span></span></span><br><span><var>label_a</var><span class="hyp-type"><b>: </b><span>composite_label IM</span></span></span><br><span><var>input_a</var><span class="hyp-type"><b>: </b><span>option message</span></span></span><br><span><var>x</var><span class="hyp-type"><b>: </b><span>index</span></span></span><br><span><var>l</var><span class="hyp-type"><b>: </b><span>label (IM x)</span></span></span><br><span><var>H1</var><span class="hyp-type"><b>: </b><span>label_a = existT x l</span></span></span><br><span><var>i</var><span><span class="hyp-body"><b>:= </b><span>projT1 (existT x l)</span></span><span class="hyp-type"><b>: </b><span>index</span></span></span></span><br><span><var>Heq</var><span class="hyp-type"><b>: </b><span>s i = s&#39; i</span></span></span><br><span><var>c0</var><span class="hyp-type"><b>: </b><span>composite_state IM</span></span></span><br><span><var>o0</var><span class="hyp-type"><b>: </b><span>option message</span></span></span><br><span><var>c1</var><span class="hyp-type"><b>: </b><span>composite_state IM</span></span></span><br><span><var>o1</var><span class="hyp-type"><b>: </b><span>option message</span></span></span><br><span><var>s1</var><span class="hyp-type"><b>: </b><span>state (IM x)</span></span></span><br><span><var>o4</var><span class="hyp-type"><b>: </b><span>option message</span></span></span><br><span><var>H3</var><span class="hyp-type"><b>: </b><span>transition l (s x, input_a) = (s1, o4)</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>(state_update IM s x s1, o4) = (c1, o1)</span></span></span><br><span><var>eq_trans</var><span class="hyp-type"><b>: </b><span>(c1, o1) = (c0, o0)</span></span></span><br><span><var>Hpr</var><span class="hyp-type"><b>: </b><span>finite_valid_trace_from Free s
  [{|
     l := existT x l;
     input := input_a;
     destination := c0;
     output := o0
   |}]</span></span></span><br><span><var>c</var><span class="hyp-type"><b>: </b><span>composite_state IM</span></span></span><br><span><var>o</var><span class="hyp-type"><b>: </b><span>option message</span></span></span><br><span><var>c2</var><span class="hyp-type"><b>: </b><span>composite_state IM</span></span></span><br><span><var>o2</var><span class="hyp-type"><b>: </b><span>option message</span></span></span><br><span><var>s0</var><span class="hyp-type"><b>: </b><span>state (IM x)</span></span></span><br><span><var>o3</var><span class="hyp-type"><b>: </b><span>option message</span></span></span><br><span><var>H2</var><span class="hyp-type"><b>: </b><span>transition l (s&#39; x, input_a) = (s0, o3)</span></span></span><br><span><var>H0</var><span class="hyp-type"><b>: </b><span>(state_update IM s&#39; x s0, o3) = (c2, o2)</span></span></span><br><span><var>eq_trans'</var><span class="hyp-type"><b>: </b><span>(c2, o2) = (c, o)</span></span></span><br><span><var>Htl</var><span class="hyp-type"><b>: </b><span>finite_valid_trace_from Free c0 []</span></span></span><br><span><var>Ht</var><span class="hyp-type"><b>: </b><span>input_valid_transition Free 
  (existT x l) (s, input_a) (
  c0, o0)</span></span></span><br><span><var>Hrel</var><span class="hyp-type"><b>: </b><span>o1 = o2
‚àß c1 (projT1 (existT x l)) =
  c2 (projT1 (existT x l))</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">c i = c0 i</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="Composition-v-chk157" style="display: none" type="checkbox"><label class="alectryon-input" for="Composition-v-chk157"><span class="nb">unfold</span> i; <span class="nb">cbn</span> <span class="kr">in</span> *.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>message, index</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>EqDecision0</var><span class="hyp-type"><b>: </b><span>EqDecision index</span></span></span><br><span><var>IM</var><span class="hyp-type"><b>: </b><span>index ‚Üí VLSM message</span></span></span><br><span><var>Free</var><span><span class="hyp-body"><b>:= </b><span>free_composite_vlsm IM</span></span><span class="hyp-type"><b>: </b><span>VLSM message</span></span></span></span><br><span><var>s, s'</var><span class="hyp-type"><b>: </b><span>composite_state IM</span></span></span><br><span><var>Hprs'</var><span class="hyp-type"><b>: </b><span>valid_state_prop Free s&#39;</span></span></span><br><span><var>label_a</var><span class="hyp-type"><b>: </b><span>composite_label IM</span></span></span><br><span><var>input_a</var><span class="hyp-type"><b>: </b><span>option message</span></span></span><br><span><var>x</var><span class="hyp-type"><b>: </b><span>index</span></span></span><br><span><var>l</var><span class="hyp-type"><b>: </b><span>label (IM x)</span></span></span><br><span><var>H1</var><span class="hyp-type"><b>: </b><span>label_a = existT x l</span></span></span><br><span><var>i</var><span><span class="hyp-body"><b>:= </b><span>x</span></span><span class="hyp-type"><b>: </b><span>index</span></span></span></span><br><span><var>Heq</var><span class="hyp-type"><b>: </b><span>s x = s&#39; x</span></span></span><br><span><var>c0</var><span class="hyp-type"><b>: </b><span>composite_state IM</span></span></span><br><span><var>o0</var><span class="hyp-type"><b>: </b><span>option message</span></span></span><br><span><var>c1</var><span class="hyp-type"><b>: </b><span>composite_state IM</span></span></span><br><span><var>o1</var><span class="hyp-type"><b>: </b><span>option message</span></span></span><br><span><var>s1</var><span class="hyp-type"><b>: </b><span>state (IM x)</span></span></span><br><span><var>o4</var><span class="hyp-type"><b>: </b><span>option message</span></span></span><br><span><var>H3</var><span class="hyp-type"><b>: </b><span>transition l (s x, input_a) = (s1, o4)</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>(state_update IM s x s1, o4) = (c1, o1)</span></span></span><br><span><var>eq_trans</var><span class="hyp-type"><b>: </b><span>(c1, o1) = (c0, o0)</span></span></span><br><span><var>Hpr</var><span class="hyp-type"><b>: </b><span>finite_valid_trace_from Free s
  [{|
     l := existT x l;
     input := input_a;
     destination := c0;
     output := o0
   |}]</span></span></span><br><span><var>c</var><span class="hyp-type"><b>: </b><span>composite_state IM</span></span></span><br><span><var>o</var><span class="hyp-type"><b>: </b><span>option message</span></span></span><br><span><var>c2</var><span class="hyp-type"><b>: </b><span>composite_state IM</span></span></span><br><span><var>o2</var><span class="hyp-type"><b>: </b><span>option message</span></span></span><br><span><var>s0</var><span class="hyp-type"><b>: </b><span>state (IM x)</span></span></span><br><span><var>o3</var><span class="hyp-type"><b>: </b><span>option message</span></span></span><br><span><var>H2</var><span class="hyp-type"><b>: </b><span>transition l (s&#39; x, input_a) = (s0, o3)</span></span></span><br><span><var>H0</var><span class="hyp-type"><b>: </b><span>(state_update IM s&#39; x s0, o3) = (c2, o2)</span></span></span><br><span><var>eq_trans'</var><span class="hyp-type"><b>: </b><span>(c2, o2) = (c, o)</span></span></span><br><span><var>Htl</var><span class="hyp-type"><b>: </b><span>finite_valid_trace_from Free c0 []</span></span></span><br><span><var>Ht</var><span class="hyp-type"><b>: </b><span>input_valid_transition Free 
  (existT x l) (s, input_a) (
  c0, o0)</span></span></span><br><span><var>Hrel</var><span class="hyp-type"><b>: </b><span>o1 = o2 ‚àß c1 x = c2 x</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">c x = c0 x</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><span class="alectryon-input"><span class="bp">by</span> itauto <span class="bp">congruence</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Qed</span>.</span></span></pre><div class="doc">
  Transitioning on some index different from <code>i</code> does not affect
  component <code>i</code>.

</div><pre class="alectryon-io highlight"><!-- Generator: Alectryon --><span class="alectryon-sentence"><input class="alectryon-toggle" id="Composition-v-chk158" style="display: none" type="checkbox"><label class="alectryon-input" for="Composition-v-chk158"><span class="kn">Lemma</span> <span class="nf">irrelevant_components_one</span>
  (<span class="nv">s</span> : state (composite_type IM))
  (<span class="nv">ai</span> : composite_plan_item IM)
  (<span class="nv">i</span> : index)
  (<span class="nv">Hdif</span> : i &lt;&gt; projT1 (label_a ai)) :
  <span class="kr">let</span> <span class="nv">res</span> := snd (composite_apply_plan IM s [ai]) <span class="kr">in</span>
  (res i) = (s i).</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>message, index</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>EqDecision0</var><span class="hyp-type"><b>: </b><span>EqDecision index</span></span></span><br><span><var>IM</var><span class="hyp-type"><b>: </b><span>index ‚Üí VLSM message</span></span></span><br><span><var>Free</var><span><span class="hyp-body"><b>:= </b><span>free_composite_vlsm IM</span></span><span class="hyp-type"><b>: </b><span>VLSM message</span></span></span></span><br><span><var>s</var><span class="hyp-type"><b>: </b><span>state (composite_type IM)</span></span></span><br><span><var>ai</var><span class="hyp-type"><b>: </b><span>composite_plan_item IM</span></span></span><br><span><var>i</var><span class="hyp-type"><b>: </b><span>index</span></span></span><br><span><var>Hdif</var><span class="hyp-type"><b>: </b><span>i ‚â† projT1 (label_a ai)</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="kr">let</span> <span class="nv">res</span> := (composite_apply_plan IM s [ai]).<span class="mi">2</span> <span class="kr">in</span>
res i = s i</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="Composition-v-chk159" style="display: none" type="checkbox"><label class="alectryon-input" for="Composition-v-chk159"><span class="kn">Proof</span>.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>message, index</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>EqDecision0</var><span class="hyp-type"><b>: </b><span>EqDecision index</span></span></span><br><span><var>IM</var><span class="hyp-type"><b>: </b><span>index ‚Üí VLSM message</span></span></span><br><span><var>Free</var><span><span class="hyp-body"><b>:= </b><span>free_composite_vlsm IM</span></span><span class="hyp-type"><b>: </b><span>VLSM message</span></span></span></span><br><span><var>s</var><span class="hyp-type"><b>: </b><span>state (composite_type IM)</span></span></span><br><span><var>ai</var><span class="hyp-type"><b>: </b><span>composite_plan_item IM</span></span></span><br><span><var>i</var><span class="hyp-type"><b>: </b><span>index</span></span></span><br><span><var>Hdif</var><span class="hyp-type"><b>: </b><span>i ‚â† projT1 (label_a ai)</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="kr">let</span> <span class="nv">res</span> := (composite_apply_plan IM s [ai]).<span class="mi">2</span> <span class="kr">in</span>
res i = s i</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="Composition-v-chk15a" style="display: none" type="checkbox"><label class="alectryon-input" for="Composition-v-chk15a"><span class="nb">unfold</span> composite_apply_plan, apply_plan, _apply_plan; <span class="nb">cbn</span>.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>message, index</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>EqDecision0</var><span class="hyp-type"><b>: </b><span>EqDecision index</span></span></span><br><span><var>IM</var><span class="hyp-type"><b>: </b><span>index ‚Üí VLSM message</span></span></span><br><span><var>Free</var><span><span class="hyp-body"><b>:= </b><span>free_composite_vlsm IM</span></span><span class="hyp-type"><b>: </b><span>VLSM message</span></span></span></span><br><span><var>s</var><span class="hyp-type"><b>: </b><span>state (composite_type IM)</span></span></span><br><span><var>ai</var><span class="hyp-type"><b>: </b><span>composite_plan_item IM</span></span></span><br><span><var>i</var><span class="hyp-type"><b>: </b><span>index</span></span></span><br><span><var>Hdif</var><span class="hyp-type"><b>: </b><span>i ‚â† projT1 (label_a ai)</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">(<span class="kr">let</span> (<span class="nv">final</span>, items) :=
   <span class="kr">match</span> ai <span class="kr">with</span>
   | {| label_a := l&#39;; input_a := input&#39; |} =&gt;
       <span class="kr">let</span> (<span class="nv">dest</span>, out) :=
         <span class="kr">let</span> (<span class="nv">i</span>, li) := l&#39; <span class="kr">in</span>
         <span class="kr">let</span> (<span class="nv">si&#39;</span>, om&#39;) :=
           transition li (s i, input&#39;) <span class="kr">in</span>
         (state_update IM s i si&#39;, om&#39;) <span class="kr">in</span>
       (dest,
        [{|
           l := l&#39;;
           input := input&#39;;
           destination := dest;
           output := out
         |}])
   <span class="kr">end</span> <span class="kr">in</span>
 (rev items, final)).<span class="mi">2</span> i = s i</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="Composition-v-chk15b" style="display: none" type="checkbox"><label class="alectryon-input" for="Composition-v-chk15b"><span class="kp">repeat</span> case_match; <span class="nb">cbn</span>.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>message, index</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>EqDecision0</var><span class="hyp-type"><b>: </b><span>EqDecision index</span></span></span><br><span><var>IM</var><span class="hyp-type"><b>: </b><span>index ‚Üí VLSM message</span></span></span><br><span><var>Free</var><span><span class="hyp-body"><b>:= </b><span>free_composite_vlsm IM</span></span><span class="hyp-type"><b>: </b><span>VLSM message</span></span></span></span><br><span><var>s</var><span class="hyp-type"><b>: </b><span>state (composite_type IM)</span></span></span><br><span><var>ai</var><span class="hyp-type"><b>: </b><span>composite_plan_item IM</span></span></span><br><span><var>i</var><span class="hyp-type"><b>: </b><span>index</span></span></span><br><span><var>label_a</var><span class="hyp-type"><b>: </b><span>label (composite_type IM)</span></span></span><br><span><var>input_a</var><span class="hyp-type"><b>: </b><span>option message</span></span></span><br><span><var>x</var><span class="hyp-type"><b>: </b><span>index</span></span></span><br><span><var>l0</var><span class="hyp-type"><b>: </b><span>label (IM x)</span></span></span><br><span><var>H2</var><span class="hyp-type"><b>: </b><span>label_a = existT x l0</span></span></span><br><span><var>H0</var><span class="hyp-type"><b>: </b><span>ai =
{| label_a := existT x l0; input_a := input_a |}</span></span></span><br><span><var>Hdif</var><span class="hyp-type"><b>: </b><span>i
‚â† projT1
    (Plans.label_a
       {|
         label_a := existT x l0;
         input_a := input_a
       |})</span></span></span><br><span><var>c</var><span class="hyp-type"><b>: </b><span>composite_state IM</span></span></span><br><span><var>l</var><span class="hyp-type"><b>: </b><span>list transition_item</span></span></span><br><span><var>c0</var><span class="hyp-type"><b>: </b><span>composite_state IM</span></span></span><br><span><var>o</var><span class="hyp-type"><b>: </b><span>option message</span></span></span><br><span><var>s0</var><span class="hyp-type"><b>: </b><span>state (IM x)</span></span></span><br><span><var>o0</var><span class="hyp-type"><b>: </b><span>option message</span></span></span><br><span><var>H3</var><span class="hyp-type"><b>: </b><span>transition l0 (s x, input_a) = (s0, o0)</span></span></span><br><span><var>H1</var><span class="hyp-type"><b>: </b><span>(state_update IM s x s0, o0) = (c0, o)</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>(c0,
 [{|
    l := existT x l0;
    input := input_a;
    destination := c0;
    output := o
  |}]) = (c, l)</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">c i = s i</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="Composition-v-chk15c" style="display: none" type="checkbox"><label class="alectryon-input" for="Composition-v-chk15c"><span class="nb">inversion</span> H; <span class="nb">inversion</span> H1; <span class="nb">subst</span>.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>message, index</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>EqDecision0</var><span class="hyp-type"><b>: </b><span>EqDecision index</span></span></span><br><span><var>IM</var><span class="hyp-type"><b>: </b><span>index ‚Üí VLSM message</span></span></span><br><span><var>Free</var><span><span class="hyp-body"><b>:= </b><span>free_composite_vlsm IM</span></span><span class="hyp-type"><b>: </b><span>VLSM message</span></span></span></span><br><span><var>s</var><span class="hyp-type"><b>: </b><span>state (composite_type IM)</span></span></span><br><span><var>i</var><span class="hyp-type"><b>: </b><span>index</span></span></span><br><span><var>input_a</var><span class="hyp-type"><b>: </b><span>option message</span></span></span><br><span><var>x</var><span class="hyp-type"><b>: </b><span>index</span></span></span><br><span><var>l0</var><span class="hyp-type"><b>: </b><span>label (IM x)</span></span></span><br><span><var>Hdif</var><span class="hyp-type"><b>: </b><span>i
‚â† projT1
    (label_a
       {|
         label_a := existT x l0;
         input_a := input_a
       |})</span></span></span><br><span><var>o</var><span class="hyp-type"><b>: </b><span>option message</span></span></span><br><span><var>s0</var><span class="hyp-type"><b>: </b><span>state (IM x)</span></span></span><br><span><var>H1</var><span class="hyp-type"><b>: </b><span>(state_update IM s x s0, o) =
(state_update IM s x s0, o)</span></span></span><br><span><var>H3</var><span class="hyp-type"><b>: </b><span>transition l0 (s x, input_a) = (s0, o)</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>(state_update IM s x s0,
 [{|
    l := existT x l0;
    input := input_a;
    destination := state_update IM s x s0;
    output := o
  |}]) =
(state_update IM s x s0,
 [{|
    l := existT x l0;
    input := input_a;
    destination := state_update IM s x s0;
    output := o
  |}])</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">state_update IM s x s0 i = s i</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><span class="alectryon-input"><span class="bp">by</span> state_update_simpl.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Qed</span>.</span></span></pre><div class="doc">
  Same as <span class="inlinecode"><span class="id" title="var">irrelevant_components_one</span></span>, but for
  multiple transitions.

</div><pre class="alectryon-io highlight"><!-- Generator: Alectryon --><span class="alectryon-sentence"><input class="alectryon-toggle" id="Composition-v-chk15d" style="display: none" type="checkbox"><label class="alectryon-input" for="Composition-v-chk15d"><span class="kn">Lemma</span> <span class="nf">irrelevant_components</span>
  (<span class="nv">s</span> : state (composite_type IM))
  (<span class="nv">a</span> : composite_plan IM)
  (<span class="nv">a_indices</span> := List.map (@projT1 _ _) (List.map (@label_a _ _) a))
  (<span class="nv">i</span> : index)
  (<span class="nv">Hdif</span> : i ‚àâ a_indices) :
  <span class="kr">let</span> <span class="nv">res</span> := snd (composite_apply_plan IM s a) <span class="kr">in</span>
  (res i) = (s i).</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>message, index</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>EqDecision0</var><span class="hyp-type"><b>: </b><span>EqDecision index</span></span></span><br><span><var>IM</var><span class="hyp-type"><b>: </b><span>index ‚Üí VLSM message</span></span></span><br><span><var>Free</var><span><span class="hyp-body"><b>:= </b><span>free_composite_vlsm IM</span></span><span class="hyp-type"><b>: </b><span>VLSM message</span></span></span></span><br><span><var>s</var><span class="hyp-type"><b>: </b><span>state (composite_type IM)</span></span></span><br><span><var>a</var><span class="hyp-type"><b>: </b><span>composite_plan IM</span></span></span><br><span><var>a_indices</var><span><span class="hyp-body"><b>:= </b><span>List.map projT1 (List.map label_a a)</span></span><span class="hyp-type"><b>: </b><span>list index</span></span></span></span><br><span><var>i</var><span class="hyp-type"><b>: </b><span>index</span></span></span><br><span><var>Hdif</var><span class="hyp-type"><b>: </b><span>i ‚àâ a_indices</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="kr">let</span> <span class="nv">res</span> := (composite_apply_plan IM s a).<span class="mi">2</span> <span class="kr">in</span>
res i = s i</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="Composition-v-chk15e" style="display: none" type="checkbox"><label class="alectryon-input" for="Composition-v-chk15e"><span class="kn">Proof</span>.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>message, index</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>EqDecision0</var><span class="hyp-type"><b>: </b><span>EqDecision index</span></span></span><br><span><var>IM</var><span class="hyp-type"><b>: </b><span>index ‚Üí VLSM message</span></span></span><br><span><var>Free</var><span><span class="hyp-body"><b>:= </b><span>free_composite_vlsm IM</span></span><span class="hyp-type"><b>: </b><span>VLSM message</span></span></span></span><br><span><var>s</var><span class="hyp-type"><b>: </b><span>state (composite_type IM)</span></span></span><br><span><var>a</var><span class="hyp-type"><b>: </b><span>composite_plan IM</span></span></span><br><span><var>a_indices</var><span><span class="hyp-body"><b>:= </b><span>List.map projT1 (List.map label_a a)</span></span><span class="hyp-type"><b>: </b><span>list index</span></span></span></span><br><span><var>i</var><span class="hyp-type"><b>: </b><span>index</span></span></span><br><span><var>Hdif</var><span class="hyp-type"><b>: </b><span>i ‚àâ a_indices</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="kr">let</span> <span class="nv">res</span> := (composite_apply_plan IM s a).<span class="mi">2</span> <span class="kr">in</span>
res i = s i</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="Composition-v-chk15f" style="display: none" type="checkbox"><label class="alectryon-input" for="Composition-v-chk15f"><span class="nb">induction</span> a <span class="nb">using</span> rev_ind.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>message, index</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>EqDecision0</var><span class="hyp-type"><b>: </b><span>EqDecision index</span></span></span><br><span><var>IM</var><span class="hyp-type"><b>: </b><span>index ‚Üí VLSM message</span></span></span><br><span><var>Free</var><span><span class="hyp-body"><b>:= </b><span>free_composite_vlsm IM</span></span><span class="hyp-type"><b>: </b><span>VLSM message</span></span></span></span><br><span><var>s</var><span class="hyp-type"><b>: </b><span>state (composite_type IM)</span></span></span><br><span><var>a_indices</var><span><span class="hyp-body"><b>:= </b><span>List.map projT1 (List.map label_a [])</span></span><span class="hyp-type"><b>: </b><span>list index</span></span></span></span><br><span><var>i</var><span class="hyp-type"><b>: </b><span>index</span></span></span><br><span><var>Hdif</var><span class="hyp-type"><b>: </b><span>i ‚àâ a_indices</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="kr">let</span> <span class="nv">res</span> := (composite_apply_plan IM s []).<span class="mi">2</span> <span class="kr">in</span>
res i = s i</div></blockquote><div class="alectryon-extra-goals"><input class="alectryon-extra-goal-toggle" id="Composition-v-chk160" style="display: none" type="checkbox"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>message, index</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>EqDecision0</var><span class="hyp-type"><b>: </b><span>EqDecision index</span></span></span><br><span><var>IM</var><span class="hyp-type"><b>: </b><span>index ‚Üí VLSM message</span></span></span><br><span><var>Free</var><span><span class="hyp-body"><b>:= </b><span>free_composite_vlsm IM</span></span><span class="hyp-type"><b>: </b><span>VLSM message</span></span></span></span><br><span><var>s</var><span class="hyp-type"><b>: </b><span>state (composite_type IM)</span></span></span><br><span><var>x</var><span class="hyp-type"><b>: </b><span>composite_plan_item IM</span></span></span><br><span><var>a</var><span class="hyp-type"><b>: </b><span>list (composite_plan_item IM)</span></span></span><br><span><var>a_indices</var><span><span class="hyp-body"><b>:= </b><span>List.map projT1
  (List.map label_a (a ++ [x]))</span></span><span class="hyp-type"><b>: </b><span>list index</span></span></span></span><br><span><var>i</var><span class="hyp-type"><b>: </b><span>index</span></span></span><br><span><var>Hdif</var><span class="hyp-type"><b>: </b><span>i ‚àâ a_indices</span></span></span><br><span><var>IHa</var><span class="hyp-type"><b>: </b><span><span class="kr">let</span> <span class="nv">a_indices</span> :=
  List.map projT1 (List.map label_a a) <span class="kr">in</span>
i ‚àâ a_indices
‚Üí <span class="kr">let</span> <span class="nv">res</span> := (composite_apply_plan IM s a).<span class="mi">2</span> <span class="kr">in</span>
  res i = s i</span></span></span><br></div><label class="goal-separator" for="Composition-v-chk160"><hr></label><div class="goal-conclusion"><span class="kr">let</span> <span class="nv">res</span> := (composite_apply_plan IM s (a ++ [x])).<span class="mi">2</span> <span class="kr">in</span>
res i = s i</div></blockquote></div></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="Composition-v-chk161" style="display: none" type="checkbox"><label class="alectryon-input" for="Composition-v-chk161">-</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>message, index</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>EqDecision0</var><span class="hyp-type"><b>: </b><span>EqDecision index</span></span></span><br><span><var>IM</var><span class="hyp-type"><b>: </b><span>index ‚Üí VLSM message</span></span></span><br><span><var>Free</var><span><span class="hyp-body"><b>:= </b><span>free_composite_vlsm IM</span></span><span class="hyp-type"><b>: </b><span>VLSM message</span></span></span></span><br><span><var>s</var><span class="hyp-type"><b>: </b><span>state (composite_type IM)</span></span></span><br><span><var>a_indices</var><span><span class="hyp-body"><b>:= </b><span>List.map projT1 (List.map label_a [])</span></span><span class="hyp-type"><b>: </b><span>list index</span></span></span></span><br><span><var>i</var><span class="hyp-type"><b>: </b><span>index</span></span></span><br><span><var>Hdif</var><span class="hyp-type"><b>: </b><span>i ‚àâ a_indices</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="kr">let</span> <span class="nv">res</span> := (composite_apply_plan IM s []).<span class="mi">2</span> <span class="kr">in</span>
res i = s i</div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="bp">by</span> <span class="nb">simpl</span>; itauto.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="Composition-v-chk162" style="display: none" type="checkbox"><label class="alectryon-input" for="Composition-v-chk162">-</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>message, index</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>EqDecision0</var><span class="hyp-type"><b>: </b><span>EqDecision index</span></span></span><br><span><var>IM</var><span class="hyp-type"><b>: </b><span>index ‚Üí VLSM message</span></span></span><br><span><var>Free</var><span><span class="hyp-body"><b>:= </b><span>free_composite_vlsm IM</span></span><span class="hyp-type"><b>: </b><span>VLSM message</span></span></span></span><br><span><var>s</var><span class="hyp-type"><b>: </b><span>state (composite_type IM)</span></span></span><br><span><var>x</var><span class="hyp-type"><b>: </b><span>composite_plan_item IM</span></span></span><br><span><var>a</var><span class="hyp-type"><b>: </b><span>list (composite_plan_item IM)</span></span></span><br><span><var>a_indices</var><span><span class="hyp-body"><b>:= </b><span>List.map projT1
  (List.map label_a (a ++ [x]))</span></span><span class="hyp-type"><b>: </b><span>list index</span></span></span></span><br><span><var>i</var><span class="hyp-type"><b>: </b><span>index</span></span></span><br><span><var>Hdif</var><span class="hyp-type"><b>: </b><span>i ‚àâ a_indices</span></span></span><br><span><var>IHa</var><span class="hyp-type"><b>: </b><span><span class="kr">let</span> <span class="nv">a_indices</span> :=
  List.map projT1 (List.map label_a a) <span class="kr">in</span>
i ‚àâ a_indices
‚Üí <span class="kr">let</span> <span class="nv">res</span> := (composite_apply_plan IM s a).<span class="mi">2</span> <span class="kr">in</span>
  res i = s i</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="kr">let</span> <span class="nv">res</span> := (composite_apply_plan IM s (a ++ [x])).<span class="mi">2</span> <span class="kr">in</span>
res i = s i</div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="Composition-v-chk163" style="display: none" type="checkbox"><label class="alectryon-input" for="Composition-v-chk163"><span class="nb">simpl</span> <span class="kr">in</span> *.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>message, index</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>EqDecision0</var><span class="hyp-type"><b>: </b><span>EqDecision index</span></span></span><br><span><var>IM</var><span class="hyp-type"><b>: </b><span>index ‚Üí VLSM message</span></span></span><br><span><var>Free</var><span><span class="hyp-body"><b>:= </b><span>free_composite_vlsm IM</span></span><span class="hyp-type"><b>: </b><span>VLSM message</span></span></span></span><br><span><var>s</var><span class="hyp-type"><b>: </b><span>composite_state IM</span></span></span><br><span><var>x</var><span class="hyp-type"><b>: </b><span>composite_plan_item IM</span></span></span><br><span><var>a</var><span class="hyp-type"><b>: </b><span>list (composite_plan_item IM)</span></span></span><br><span><var>a_indices</var><span><span class="hyp-body"><b>:= </b><span>List.map projT1
  (List.map label_a (a ++ [x]))</span></span><span class="hyp-type"><b>: </b><span>list index</span></span></span></span><br><span><var>i</var><span class="hyp-type"><b>: </b><span>index</span></span></span><br><span><var>Hdif</var><span class="hyp-type"><b>: </b><span>i ‚àâ a_indices</span></span></span><br><span><var>IHa</var><span class="hyp-type"><b>: </b><span>i ‚àâ List.map projT1 (List.map label_a a)
‚Üí (composite_apply_plan IM s a).<span class="mi">2</span> i = s i</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">(composite_apply_plan IM s (a ++ [x])).<span class="mi">2</span> i = s i</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="Composition-v-chk164" style="display: none" type="checkbox"><label class="alectryon-input" for="Composition-v-chk164"><span class="nb">rewrite</span> (composite_apply_plan_app IM).</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>message, index</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>EqDecision0</var><span class="hyp-type"><b>: </b><span>EqDecision index</span></span></span><br><span><var>IM</var><span class="hyp-type"><b>: </b><span>index ‚Üí VLSM message</span></span></span><br><span><var>Free</var><span><span class="hyp-body"><b>:= </b><span>free_composite_vlsm IM</span></span><span class="hyp-type"><b>: </b><span>VLSM message</span></span></span></span><br><span><var>s</var><span class="hyp-type"><b>: </b><span>composite_state IM</span></span></span><br><span><var>x</var><span class="hyp-type"><b>: </b><span>composite_plan_item IM</span></span></span><br><span><var>a</var><span class="hyp-type"><b>: </b><span>list (composite_plan_item IM)</span></span></span><br><span><var>a_indices</var><span><span class="hyp-body"><b>:= </b><span>List.map projT1
  (List.map label_a (a ++ [x]))</span></span><span class="hyp-type"><b>: </b><span>list index</span></span></span></span><br><span><var>i</var><span class="hyp-type"><b>: </b><span>index</span></span></span><br><span><var>Hdif</var><span class="hyp-type"><b>: </b><span>i ‚àâ a_indices</span></span></span><br><span><var>IHa</var><span class="hyp-type"><b>: </b><span>i ‚àâ List.map projT1 (List.map label_a a)
‚Üí (composite_apply_plan IM s a).<span class="mi">2</span> i = s i</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">(<span class="kr">let</span> (<span class="nv">aitems</span>, afinal) :=
   composite_apply_plan IM s a <span class="kr">in</span>
 <span class="kr">let</span> (<span class="nv">a&#39;items</span>, a&#39;final) :=
   composite_apply_plan IM afinal [x] <span class="kr">in</span>
 (aitems ++ a&#39;items, a&#39;final)).<span class="mi">2</span> i = s i</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="Composition-v-chk165" style="display: none" type="checkbox"><label class="alectryon-input" for="Composition-v-chk165"><span class="nb">destruct</span> (composite_apply_plan IM s a) <span class="kr">as</span> (tra, sa) <span class="nb">eqn</span>: eq_a; <span class="nb">simpl</span> <span class="kr">in</span> *.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>message, index</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>EqDecision0</var><span class="hyp-type"><b>: </b><span>EqDecision index</span></span></span><br><span><var>IM</var><span class="hyp-type"><b>: </b><span>index ‚Üí VLSM message</span></span></span><br><span><var>Free</var><span><span class="hyp-body"><b>:= </b><span>free_composite_vlsm IM</span></span><span class="hyp-type"><b>: </b><span>VLSM message</span></span></span></span><br><span><var>s</var><span class="hyp-type"><b>: </b><span>composite_state IM</span></span></span><br><span><var>x</var><span class="hyp-type"><b>: </b><span>composite_plan_item IM</span></span></span><br><span><var>a</var><span class="hyp-type"><b>: </b><span>list (composite_plan_item IM)</span></span></span><br><span><var>a_indices</var><span><span class="hyp-body"><b>:= </b><span>List.map projT1
  (List.map label_a (a ++ [x]))</span></span><span class="hyp-type"><b>: </b><span>list index</span></span></span></span><br><span><var>i</var><span class="hyp-type"><b>: </b><span>index</span></span></span><br><span><var>Hdif</var><span class="hyp-type"><b>: </b><span>i ‚àâ a_indices</span></span></span><br><span><var>tra</var><span class="hyp-type"><b>: </b><span>list transition_item</span></span></span><br><span><var>sa</var><span class="hyp-type"><b>: </b><span>composite_state IM</span></span></span><br><span><var>eq_a</var><span class="hyp-type"><b>: </b><span>composite_apply_plan IM s a = (tra, sa)</span></span></span><br><span><var>IHa</var><span class="hyp-type"><b>: </b><span>i ‚àâ List.map projT1 (List.map label_a a)
‚Üí sa i = s i</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">(<span class="kr">let</span> (<span class="nv">a&#39;items</span>, a&#39;final) :=
   composite_apply_plan IM sa [x] <span class="kr">in</span>
 (tra ++ a&#39;items, a&#39;final)).<span class="mi">2</span> i = s i</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="Composition-v-chk166" style="display: none" type="checkbox"><label class="alectryon-input" for="Composition-v-chk166"><span class="nb">destruct</span> (composite_apply_plan IM sa [x]) <span class="kr">as</span> (trx, sx) <span class="nb">eqn</span>: eq_x; <span class="nb">simpl</span> <span class="kr">in</span> *.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>message, index</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>EqDecision0</var><span class="hyp-type"><b>: </b><span>EqDecision index</span></span></span><br><span><var>IM</var><span class="hyp-type"><b>: </b><span>index ‚Üí VLSM message</span></span></span><br><span><var>Free</var><span><span class="hyp-body"><b>:= </b><span>free_composite_vlsm IM</span></span><span class="hyp-type"><b>: </b><span>VLSM message</span></span></span></span><br><span><var>s</var><span class="hyp-type"><b>: </b><span>composite_state IM</span></span></span><br><span><var>x</var><span class="hyp-type"><b>: </b><span>composite_plan_item IM</span></span></span><br><span><var>a</var><span class="hyp-type"><b>: </b><span>list (composite_plan_item IM)</span></span></span><br><span><var>a_indices</var><span><span class="hyp-body"><b>:= </b><span>List.map projT1
  (List.map label_a (a ++ [x]))</span></span><span class="hyp-type"><b>: </b><span>list index</span></span></span></span><br><span><var>i</var><span class="hyp-type"><b>: </b><span>index</span></span></span><br><span><var>Hdif</var><span class="hyp-type"><b>: </b><span>i ‚àâ a_indices</span></span></span><br><span><var>tra</var><span class="hyp-type"><b>: </b><span>list transition_item</span></span></span><br><span><var>sa</var><span class="hyp-type"><b>: </b><span>composite_state IM</span></span></span><br><span><var>eq_a</var><span class="hyp-type"><b>: </b><span>composite_apply_plan IM s a = (tra, sa)</span></span></span><br><span><var>IHa</var><span class="hyp-type"><b>: </b><span>i ‚àâ List.map projT1 (List.map label_a a)
‚Üí sa i = s i</span></span></span><br><span><var>trx</var><span class="hyp-type"><b>: </b><span>list transition_item</span></span></span><br><span><var>sx</var><span class="hyp-type"><b>: </b><span>composite_state IM</span></span></span><br><span><var>eq_x</var><span class="hyp-type"><b>: </b><span>composite_apply_plan IM sa [x] = (trx, sx)</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">sx i = s i</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
</span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="Composition-v-chk167" style="display: none" type="checkbox"><label class="alectryon-input" for="Composition-v-chk167"><span class="nb">unfold</span> a_indices <span class="kr">in</span> Hdif.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>message, index</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>EqDecision0</var><span class="hyp-type"><b>: </b><span>EqDecision index</span></span></span><br><span><var>IM</var><span class="hyp-type"><b>: </b><span>index ‚Üí VLSM message</span></span></span><br><span><var>Free</var><span><span class="hyp-body"><b>:= </b><span>free_composite_vlsm IM</span></span><span class="hyp-type"><b>: </b><span>VLSM message</span></span></span></span><br><span><var>s</var><span class="hyp-type"><b>: </b><span>composite_state IM</span></span></span><br><span><var>x</var><span class="hyp-type"><b>: </b><span>composite_plan_item IM</span></span></span><br><span><var>a</var><span class="hyp-type"><b>: </b><span>list (composite_plan_item IM)</span></span></span><br><span><var>a_indices</var><span><span class="hyp-body"><b>:= </b><span>List.map projT1
  (List.map label_a (a ++ [x]))</span></span><span class="hyp-type"><b>: </b><span>list index</span></span></span></span><br><span><var>i</var><span class="hyp-type"><b>: </b><span>index</span></span></span><br><span><var>Hdif</var><span class="hyp-type"><b>: </b><span>i
‚àâ List.map projT1 (List.map label_a (a ++ [x]))</span></span></span><br><span><var>tra</var><span class="hyp-type"><b>: </b><span>list transition_item</span></span></span><br><span><var>sa</var><span class="hyp-type"><b>: </b><span>composite_state IM</span></span></span><br><span><var>eq_a</var><span class="hyp-type"><b>: </b><span>composite_apply_plan IM s a = (tra, sa)</span></span></span><br><span><var>IHa</var><span class="hyp-type"><b>: </b><span>i ‚àâ List.map projT1 (List.map label_a a)
‚Üí sa i = s i</span></span></span><br><span><var>trx</var><span class="hyp-type"><b>: </b><span>list transition_item</span></span></span><br><span><var>sx</var><span class="hyp-type"><b>: </b><span>composite_state IM</span></span></span><br><span><var>eq_x</var><span class="hyp-type"><b>: </b><span>composite_apply_plan IM sa [x] = (trx, sx)</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">sx i = s i</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="Composition-v-chk168" style="display: none" type="checkbox"><label class="alectryon-input" for="Composition-v-chk168"><span class="nb">rewrite</span> map_app <span class="kr">in</span> Hdif.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>message, index</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>EqDecision0</var><span class="hyp-type"><b>: </b><span>EqDecision index</span></span></span><br><span><var>IM</var><span class="hyp-type"><b>: </b><span>index ‚Üí VLSM message</span></span></span><br><span><var>Free</var><span><span class="hyp-body"><b>:= </b><span>free_composite_vlsm IM</span></span><span class="hyp-type"><b>: </b><span>VLSM message</span></span></span></span><br><span><var>s</var><span class="hyp-type"><b>: </b><span>composite_state IM</span></span></span><br><span><var>x</var><span class="hyp-type"><b>: </b><span>composite_plan_item IM</span></span></span><br><span><var>a</var><span class="hyp-type"><b>: </b><span>list (composite_plan_item IM)</span></span></span><br><span><var>a_indices</var><span><span class="hyp-body"><b>:= </b><span>List.map projT1
  (List.map label_a (a ++ [x]))</span></span><span class="hyp-type"><b>: </b><span>list index</span></span></span></span><br><span><var>i</var><span class="hyp-type"><b>: </b><span>index</span></span></span><br><span><var>Hdif</var><span class="hyp-type"><b>: </b><span>i
‚àâ List.map projT1
    (List.map label_a a ++ List.map label_a [x])</span></span></span><br><span><var>tra</var><span class="hyp-type"><b>: </b><span>list transition_item</span></span></span><br><span><var>sa</var><span class="hyp-type"><b>: </b><span>composite_state IM</span></span></span><br><span><var>eq_a</var><span class="hyp-type"><b>: </b><span>composite_apply_plan IM s a = (tra, sa)</span></span></span><br><span><var>IHa</var><span class="hyp-type"><b>: </b><span>i ‚àâ List.map projT1 (List.map label_a a)
‚Üí sa i = s i</span></span></span><br><span><var>trx</var><span class="hyp-type"><b>: </b><span>list transition_item</span></span></span><br><span><var>sx</var><span class="hyp-type"><b>: </b><span>composite_state IM</span></span></span><br><span><var>eq_x</var><span class="hyp-type"><b>: </b><span>composite_apply_plan IM sa [x] = (trx, sx)</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">sx i = s i</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="Composition-v-chk169" style="display: none" type="checkbox"><label class="alectryon-input" for="Composition-v-chk169"><span class="nb">rewrite</span> map_app <span class="kr">in</span> Hdif.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>message, index</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>EqDecision0</var><span class="hyp-type"><b>: </b><span>EqDecision index</span></span></span><br><span><var>IM</var><span class="hyp-type"><b>: </b><span>index ‚Üí VLSM message</span></span></span><br><span><var>Free</var><span><span class="hyp-body"><b>:= </b><span>free_composite_vlsm IM</span></span><span class="hyp-type"><b>: </b><span>VLSM message</span></span></span></span><br><span><var>s</var><span class="hyp-type"><b>: </b><span>composite_state IM</span></span></span><br><span><var>x</var><span class="hyp-type"><b>: </b><span>composite_plan_item IM</span></span></span><br><span><var>a</var><span class="hyp-type"><b>: </b><span>list (composite_plan_item IM)</span></span></span><br><span><var>a_indices</var><span><span class="hyp-body"><b>:= </b><span>List.map projT1
  (List.map label_a (a ++ [x]))</span></span><span class="hyp-type"><b>: </b><span>list index</span></span></span></span><br><span><var>i</var><span class="hyp-type"><b>: </b><span>index</span></span></span><br><span><var>Hdif</var><span class="hyp-type"><b>: </b><span>i
‚àâ List.map projT1 (List.map label_a a) ++
  List.map projT1 (List.map label_a [x])</span></span></span><br><span><var>tra</var><span class="hyp-type"><b>: </b><span>list transition_item</span></span></span><br><span><var>sa</var><span class="hyp-type"><b>: </b><span>composite_state IM</span></span></span><br><span><var>eq_a</var><span class="hyp-type"><b>: </b><span>composite_apply_plan IM s a = (tra, sa)</span></span></span><br><span><var>IHa</var><span class="hyp-type"><b>: </b><span>i ‚àâ List.map projT1 (List.map label_a a)
‚Üí sa i = s i</span></span></span><br><span><var>trx</var><span class="hyp-type"><b>: </b><span>list transition_item</span></span></span><br><span><var>sx</var><span class="hyp-type"><b>: </b><span>composite_state IM</span></span></span><br><span><var>eq_x</var><span class="hyp-type"><b>: </b><span>composite_apply_plan IM sa [x] = (trx, sx)</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">sx i = s i</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
</span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="Composition-v-chk16a" style="display: none" type="checkbox"><label class="alectryon-input" for="Composition-v-chk16a">spec IHa.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>message, index</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>EqDecision0</var><span class="hyp-type"><b>: </b><span>EqDecision index</span></span></span><br><span><var>IM</var><span class="hyp-type"><b>: </b><span>index ‚Üí VLSM message</span></span></span><br><span><var>Free</var><span><span class="hyp-body"><b>:= </b><span>free_composite_vlsm IM</span></span><span class="hyp-type"><b>: </b><span>VLSM message</span></span></span></span><br><span><var>s</var><span class="hyp-type"><b>: </b><span>composite_state IM</span></span></span><br><span><var>x</var><span class="hyp-type"><b>: </b><span>composite_plan_item IM</span></span></span><br><span><var>a</var><span class="hyp-type"><b>: </b><span>list (composite_plan_item IM)</span></span></span><br><span><var>a_indices</var><span><span class="hyp-body"><b>:= </b><span>List.map projT1
  (List.map label_a (a ++ [x]))</span></span><span class="hyp-type"><b>: </b><span>list index</span></span></span></span><br><span><var>i</var><span class="hyp-type"><b>: </b><span>index</span></span></span><br><span><var>Hdif</var><span class="hyp-type"><b>: </b><span>i
‚àâ List.map projT1 (List.map label_a a) ++
  List.map projT1 (List.map label_a [x])</span></span></span><br><span><var>tra</var><span class="hyp-type"><b>: </b><span>list transition_item</span></span></span><br><span><var>sa</var><span class="hyp-type"><b>: </b><span>composite_state IM</span></span></span><br><span><var>eq_a</var><span class="hyp-type"><b>: </b><span>composite_apply_plan IM s a = (tra, sa)</span></span></span><br><span><var>IHa</var><span class="hyp-type"><b>: </b><span>i ‚àâ List.map projT1 (List.map label_a a)
‚Üí sa i = s i</span></span></span><br><span><var>trx</var><span class="hyp-type"><b>: </b><span>list transition_item</span></span></span><br><span><var>sx</var><span class="hyp-type"><b>: </b><span>composite_state IM</span></span></span><br><span><var>eq_x</var><span class="hyp-type"><b>: </b><span>composite_apply_plan IM sa [x] = (trx, sx)</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">i ‚àâ List.map projT1 (List.map label_a a)</div></blockquote><div class="alectryon-extra-goals"><input class="alectryon-extra-goal-toggle" id="Composition-v-chk16b" style="display: none" type="checkbox"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>message, index</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>EqDecision0</var><span class="hyp-type"><b>: </b><span>EqDecision index</span></span></span><br><span><var>IM</var><span class="hyp-type"><b>: </b><span>index ‚Üí VLSM message</span></span></span><br><span><var>Free</var><span><span class="hyp-body"><b>:= </b><span>free_composite_vlsm IM</span></span><span class="hyp-type"><b>: </b><span>VLSM message</span></span></span></span><br><span><var>s</var><span class="hyp-type"><b>: </b><span>composite_state IM</span></span></span><br><span><var>x</var><span class="hyp-type"><b>: </b><span>composite_plan_item IM</span></span></span><br><span><var>a</var><span class="hyp-type"><b>: </b><span>list (composite_plan_item IM)</span></span></span><br><span><var>a_indices</var><span><span class="hyp-body"><b>:= </b><span>List.map projT1
  (List.map label_a (a ++ [x]))</span></span><span class="hyp-type"><b>: </b><span>list index</span></span></span></span><br><span><var>i</var><span class="hyp-type"><b>: </b><span>index</span></span></span><br><span><var>Hdif</var><span class="hyp-type"><b>: </b><span>i
‚àâ List.map projT1 (List.map label_a a) ++
  List.map projT1 (List.map label_a [x])</span></span></span><br><span><var>tra</var><span class="hyp-type"><b>: </b><span>list transition_item</span></span></span><br><span><var>sa</var><span class="hyp-type"><b>: </b><span>composite_state IM</span></span></span><br><span><var>eq_a</var><span class="hyp-type"><b>: </b><span>composite_apply_plan IM s a = (tra, sa)</span></span></span><br><span><var>trx</var><span class="hyp-type"><b>: </b><span>list transition_item</span></span></span><br><span><var>sx</var><span class="hyp-type"><b>: </b><span>composite_state IM</span></span></span><br><span><var>eq_x</var><span class="hyp-type"><b>: </b><span>composite_apply_plan IM sa [x] = (trx, sx)</span></span></span><br><span><var>IHa</var><span class="hyp-type"><b>: </b><span>sa i = s i</span></span></span><br></div><label class="goal-separator" for="Composition-v-chk16b"><hr></label><div class="goal-conclusion">sx i = s i</div></blockquote></div></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="Composition-v-chk16c" style="display: none" type="checkbox"><label class="alectryon-input" for="Composition-v-chk16c">{</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>message, index</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>EqDecision0</var><span class="hyp-type"><b>: </b><span>EqDecision index</span></span></span><br><span><var>IM</var><span class="hyp-type"><b>: </b><span>index ‚Üí VLSM message</span></span></span><br><span><var>Free</var><span><span class="hyp-body"><b>:= </b><span>free_composite_vlsm IM</span></span><span class="hyp-type"><b>: </b><span>VLSM message</span></span></span></span><br><span><var>s</var><span class="hyp-type"><b>: </b><span>composite_state IM</span></span></span><br><span><var>x</var><span class="hyp-type"><b>: </b><span>composite_plan_item IM</span></span></span><br><span><var>a</var><span class="hyp-type"><b>: </b><span>list (composite_plan_item IM)</span></span></span><br><span><var>a_indices</var><span><span class="hyp-body"><b>:= </b><span>List.map projT1
  (List.map label_a (a ++ [x]))</span></span><span class="hyp-type"><b>: </b><span>list index</span></span></span></span><br><span><var>i</var><span class="hyp-type"><b>: </b><span>index</span></span></span><br><span><var>Hdif</var><span class="hyp-type"><b>: </b><span>i
‚àâ List.map projT1 (List.map label_a a) ++
  List.map projT1 (List.map label_a [x])</span></span></span><br><span><var>tra</var><span class="hyp-type"><b>: </b><span>list transition_item</span></span></span><br><span><var>sa</var><span class="hyp-type"><b>: </b><span>composite_state IM</span></span></span><br><span><var>eq_a</var><span class="hyp-type"><b>: </b><span>composite_apply_plan IM s a = (tra, sa)</span></span></span><br><span><var>IHa</var><span class="hyp-type"><b>: </b><span>i ‚àâ List.map projT1 (List.map label_a a)
‚Üí sa i = s i</span></span></span><br><span><var>trx</var><span class="hyp-type"><b>: </b><span>list transition_item</span></span></span><br><span><var>sx</var><span class="hyp-type"><b>: </b><span>composite_state IM</span></span></span><br><span><var>eq_x</var><span class="hyp-type"><b>: </b><span>composite_apply_plan IM sa [x] = (trx, sx)</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">i ‚àâ List.map projT1 (List.map label_a a)</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">      </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="Composition-v-chk16d" style="display: none" type="checkbox"><label class="alectryon-input" for="Composition-v-chk16d"><span class="nb">intro</span> Hin.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>message, index</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>EqDecision0</var><span class="hyp-type"><b>: </b><span>EqDecision index</span></span></span><br><span><var>IM</var><span class="hyp-type"><b>: </b><span>index ‚Üí VLSM message</span></span></span><br><span><var>Free</var><span><span class="hyp-body"><b>:= </b><span>free_composite_vlsm IM</span></span><span class="hyp-type"><b>: </b><span>VLSM message</span></span></span></span><br><span><var>s</var><span class="hyp-type"><b>: </b><span>composite_state IM</span></span></span><br><span><var>x</var><span class="hyp-type"><b>: </b><span>composite_plan_item IM</span></span></span><br><span><var>a</var><span class="hyp-type"><b>: </b><span>list (composite_plan_item IM)</span></span></span><br><span><var>a_indices</var><span><span class="hyp-body"><b>:= </b><span>List.map projT1
  (List.map label_a (a ++ [x]))</span></span><span class="hyp-type"><b>: </b><span>list index</span></span></span></span><br><span><var>i</var><span class="hyp-type"><b>: </b><span>index</span></span></span><br><span><var>Hdif</var><span class="hyp-type"><b>: </b><span>i
‚àâ List.map projT1 (List.map label_a a) ++
  List.map projT1 (List.map label_a [x])</span></span></span><br><span><var>tra</var><span class="hyp-type"><b>: </b><span>list transition_item</span></span></span><br><span><var>sa</var><span class="hyp-type"><b>: </b><span>composite_state IM</span></span></span><br><span><var>eq_a</var><span class="hyp-type"><b>: </b><span>composite_apply_plan IM s a = (tra, sa)</span></span></span><br><span><var>IHa</var><span class="hyp-type"><b>: </b><span>i ‚àâ List.map projT1 (List.map label_a a)
‚Üí sa i = s i</span></span></span><br><span><var>trx</var><span class="hyp-type"><b>: </b><span>list transition_item</span></span></span><br><span><var>sx</var><span class="hyp-type"><b>: </b><span>composite_state IM</span></span></span><br><span><var>eq_x</var><span class="hyp-type"><b>: </b><span>composite_apply_plan IM sa [x] = (trx, sx)</span></span></span><br><span><var>Hin</var><span class="hyp-type"><b>: </b><span>i ‚àà List.map projT1 (List.map label_a a)</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="kt">False</span></div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">      </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="Composition-v-chk16e" style="display: none" type="checkbox"><label class="alectryon-input" for="Composition-v-chk16e"><span class="bp">contradict</span> Hdif.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>message, index</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>EqDecision0</var><span class="hyp-type"><b>: </b><span>EqDecision index</span></span></span><br><span><var>IM</var><span class="hyp-type"><b>: </b><span>index ‚Üí VLSM message</span></span></span><br><span><var>Free</var><span><span class="hyp-body"><b>:= </b><span>free_composite_vlsm IM</span></span><span class="hyp-type"><b>: </b><span>VLSM message</span></span></span></span><br><span><var>s</var><span class="hyp-type"><b>: </b><span>composite_state IM</span></span></span><br><span><var>x</var><span class="hyp-type"><b>: </b><span>composite_plan_item IM</span></span></span><br><span><var>a</var><span class="hyp-type"><b>: </b><span>list (composite_plan_item IM)</span></span></span><br><span><var>a_indices</var><span><span class="hyp-body"><b>:= </b><span>List.map projT1
  (List.map label_a (a ++ [x]))</span></span><span class="hyp-type"><b>: </b><span>list index</span></span></span></span><br><span><var>i</var><span class="hyp-type"><b>: </b><span>index</span></span></span><br><span><var>tra</var><span class="hyp-type"><b>: </b><span>list transition_item</span></span></span><br><span><var>sa</var><span class="hyp-type"><b>: </b><span>composite_state IM</span></span></span><br><span><var>eq_a</var><span class="hyp-type"><b>: </b><span>composite_apply_plan IM s a = (tra, sa)</span></span></span><br><span><var>IHa</var><span class="hyp-type"><b>: </b><span>i ‚àâ List.map projT1 (List.map label_a a)
‚Üí sa i = s i</span></span></span><br><span><var>trx</var><span class="hyp-type"><b>: </b><span>list transition_item</span></span></span><br><span><var>sx</var><span class="hyp-type"><b>: </b><span>composite_state IM</span></span></span><br><span><var>eq_x</var><span class="hyp-type"><b>: </b><span>composite_apply_plan IM sa [x] = (trx, sx)</span></span></span><br><span><var>Hin</var><span class="hyp-type"><b>: </b><span>i ‚àà List.map projT1 (List.map label_a a)</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">i
‚àà List.map projT1 (List.map label_a a) ++
  List.map projT1 (List.map label_a [x])</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">      </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="Composition-v-chk16f" style="display: none" type="checkbox"><label class="alectryon-input" for="Composition-v-chk16f"><span class="nb">apply</span> elem_of_app.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>message, index</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>EqDecision0</var><span class="hyp-type"><b>: </b><span>EqDecision index</span></span></span><br><span><var>IM</var><span class="hyp-type"><b>: </b><span>index ‚Üí VLSM message</span></span></span><br><span><var>Free</var><span><span class="hyp-body"><b>:= </b><span>free_composite_vlsm IM</span></span><span class="hyp-type"><b>: </b><span>VLSM message</span></span></span></span><br><span><var>s</var><span class="hyp-type"><b>: </b><span>composite_state IM</span></span></span><br><span><var>x</var><span class="hyp-type"><b>: </b><span>composite_plan_item IM</span></span></span><br><span><var>a</var><span class="hyp-type"><b>: </b><span>list (composite_plan_item IM)</span></span></span><br><span><var>a_indices</var><span><span class="hyp-body"><b>:= </b><span>List.map projT1
  (List.map label_a (a ++ [x]))</span></span><span class="hyp-type"><b>: </b><span>list index</span></span></span></span><br><span><var>i</var><span class="hyp-type"><b>: </b><span>index</span></span></span><br><span><var>tra</var><span class="hyp-type"><b>: </b><span>list transition_item</span></span></span><br><span><var>sa</var><span class="hyp-type"><b>: </b><span>composite_state IM</span></span></span><br><span><var>eq_a</var><span class="hyp-type"><b>: </b><span>composite_apply_plan IM s a = (tra, sa)</span></span></span><br><span><var>IHa</var><span class="hyp-type"><b>: </b><span>i ‚àâ List.map projT1 (List.map label_a a)
‚Üí sa i = s i</span></span></span><br><span><var>trx</var><span class="hyp-type"><b>: </b><span>list transition_item</span></span></span><br><span><var>sx</var><span class="hyp-type"><b>: </b><span>composite_state IM</span></span></span><br><span><var>eq_x</var><span class="hyp-type"><b>: </b><span>composite_apply_plan IM sa [x] = (trx, sx)</span></span></span><br><span><var>Hin</var><span class="hyp-type"><b>: </b><span>i ‚àà List.map projT1 (List.map label_a a)</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">i ‚àà List.map projT1 (List.map label_a a)
‚à® i ‚àà List.map projT1 (List.map label_a [x])</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">      </span><span class="alectryon-sentence"><span class="alectryon-input"><span class="bp">by</span> <span class="nb">left</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="Composition-v-chk170" style="display: none" type="checkbox"><label class="alectryon-input" for="Composition-v-chk170">}</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>message, index</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>EqDecision0</var><span class="hyp-type"><b>: </b><span>EqDecision index</span></span></span><br><span><var>IM</var><span class="hyp-type"><b>: </b><span>index ‚Üí VLSM message</span></span></span><br><span><var>Free</var><span><span class="hyp-body"><b>:= </b><span>free_composite_vlsm IM</span></span><span class="hyp-type"><b>: </b><span>VLSM message</span></span></span></span><br><span><var>s</var><span class="hyp-type"><b>: </b><span>composite_state IM</span></span></span><br><span><var>x</var><span class="hyp-type"><b>: </b><span>composite_plan_item IM</span></span></span><br><span><var>a</var><span class="hyp-type"><b>: </b><span>list (composite_plan_item IM)</span></span></span><br><span><var>a_indices</var><span><span class="hyp-body"><b>:= </b><span>List.map projT1
  (List.map label_a (a ++ [x]))</span></span><span class="hyp-type"><b>: </b><span>list index</span></span></span></span><br><span><var>i</var><span class="hyp-type"><b>: </b><span>index</span></span></span><br><span><var>Hdif</var><span class="hyp-type"><b>: </b><span>i
‚àâ List.map projT1 (List.map label_a a) ++
  List.map projT1 (List.map label_a [x])</span></span></span><br><span><var>tra</var><span class="hyp-type"><b>: </b><span>list transition_item</span></span></span><br><span><var>sa</var><span class="hyp-type"><b>: </b><span>composite_state IM</span></span></span><br><span><var>eq_a</var><span class="hyp-type"><b>: </b><span>composite_apply_plan IM s a = (tra, sa)</span></span></span><br><span><var>trx</var><span class="hyp-type"><b>: </b><span>list transition_item</span></span></span><br><span><var>sx</var><span class="hyp-type"><b>: </b><span>composite_state IM</span></span></span><br><span><var>eq_x</var><span class="hyp-type"><b>: </b><span>composite_apply_plan IM sa [x] = (trx, sx)</span></span></span><br><span><var>IHa</var><span class="hyp-type"><b>: </b><span>sa i = s i</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">sx i = s i</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
</span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="Composition-v-chk171" style="display: none" type="checkbox"><label class="alectryon-input" for="Composition-v-chk171"><span class="nb">rewrite</span> &lt;- IHa.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>message, index</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>EqDecision0</var><span class="hyp-type"><b>: </b><span>EqDecision index</span></span></span><br><span><var>IM</var><span class="hyp-type"><b>: </b><span>index ‚Üí VLSM message</span></span></span><br><span><var>Free</var><span><span class="hyp-body"><b>:= </b><span>free_composite_vlsm IM</span></span><span class="hyp-type"><b>: </b><span>VLSM message</span></span></span></span><br><span><var>s</var><span class="hyp-type"><b>: </b><span>composite_state IM</span></span></span><br><span><var>x</var><span class="hyp-type"><b>: </b><span>composite_plan_item IM</span></span></span><br><span><var>a</var><span class="hyp-type"><b>: </b><span>list (composite_plan_item IM)</span></span></span><br><span><var>a_indices</var><span><span class="hyp-body"><b>:= </b><span>List.map projT1
  (List.map label_a (a ++ [x]))</span></span><span class="hyp-type"><b>: </b><span>list index</span></span></span></span><br><span><var>i</var><span class="hyp-type"><b>: </b><span>index</span></span></span><br><span><var>Hdif</var><span class="hyp-type"><b>: </b><span>i
‚àâ List.map projT1 (List.map label_a a) ++
  List.map projT1 (List.map label_a [x])</span></span></span><br><span><var>tra</var><span class="hyp-type"><b>: </b><span>list transition_item</span></span></span><br><span><var>sa</var><span class="hyp-type"><b>: </b><span>composite_state IM</span></span></span><br><span><var>eq_a</var><span class="hyp-type"><b>: </b><span>composite_apply_plan IM s a = (tra, sa)</span></span></span><br><span><var>trx</var><span class="hyp-type"><b>: </b><span>list transition_item</span></span></span><br><span><var>sx</var><span class="hyp-type"><b>: </b><span>composite_state IM</span></span></span><br><span><var>eq_x</var><span class="hyp-type"><b>: </b><span>composite_apply_plan IM sa [x] = (trx, sx)</span></span></span><br><span><var>IHa</var><span class="hyp-type"><b>: </b><span>sa i = s i</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">sx i = sa i</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="Composition-v-chk172" style="display: none" type="checkbox"><label class="alectryon-input" for="Composition-v-chk172"><span class="nb">replace</span> sx <span class="kr">with</span> (snd (composite_apply_plan IM sa [x])) <span class="bp">by</span> (<span class="nb">rewrite</span> eq_x; <span class="bp">done</span>).</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>message, index</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>EqDecision0</var><span class="hyp-type"><b>: </b><span>EqDecision index</span></span></span><br><span><var>IM</var><span class="hyp-type"><b>: </b><span>index ‚Üí VLSM message</span></span></span><br><span><var>Free</var><span><span class="hyp-body"><b>:= </b><span>free_composite_vlsm IM</span></span><span class="hyp-type"><b>: </b><span>VLSM message</span></span></span></span><br><span><var>s</var><span class="hyp-type"><b>: </b><span>composite_state IM</span></span></span><br><span><var>x</var><span class="hyp-type"><b>: </b><span>composite_plan_item IM</span></span></span><br><span><var>a</var><span class="hyp-type"><b>: </b><span>list (composite_plan_item IM)</span></span></span><br><span><var>a_indices</var><span><span class="hyp-body"><b>:= </b><span>List.map projT1
  (List.map label_a (a ++ [x]))</span></span><span class="hyp-type"><b>: </b><span>list index</span></span></span></span><br><span><var>i</var><span class="hyp-type"><b>: </b><span>index</span></span></span><br><span><var>Hdif</var><span class="hyp-type"><b>: </b><span>i
‚àâ List.map projT1 (List.map label_a a) ++
  List.map projT1 (List.map label_a [x])</span></span></span><br><span><var>tra</var><span class="hyp-type"><b>: </b><span>list transition_item</span></span></span><br><span><var>sa</var><span class="hyp-type"><b>: </b><span>composite_state IM</span></span></span><br><span><var>eq_a</var><span class="hyp-type"><b>: </b><span>composite_apply_plan IM s a = (tra, sa)</span></span></span><br><span><var>trx</var><span class="hyp-type"><b>: </b><span>list transition_item</span></span></span><br><span><var>sx</var><span class="hyp-type"><b>: </b><span>composite_state IM</span></span></span><br><span><var>eq_x</var><span class="hyp-type"><b>: </b><span>composite_apply_plan IM sa [x] = (trx, sx)</span></span></span><br><span><var>IHa</var><span class="hyp-type"><b>: </b><span>sa i = s i</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">(composite_apply_plan IM sa [x]).<span class="mi">2</span> i = sa i</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="Composition-v-chk173" style="display: none" type="checkbox"><label class="alectryon-input" for="Composition-v-chk173"><span class="nb">apply</span> irrelevant_components_one.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>message, index</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>EqDecision0</var><span class="hyp-type"><b>: </b><span>EqDecision index</span></span></span><br><span><var>IM</var><span class="hyp-type"><b>: </b><span>index ‚Üí VLSM message</span></span></span><br><span><var>Free</var><span><span class="hyp-body"><b>:= </b><span>free_composite_vlsm IM</span></span><span class="hyp-type"><b>: </b><span>VLSM message</span></span></span></span><br><span><var>s</var><span class="hyp-type"><b>: </b><span>composite_state IM</span></span></span><br><span><var>x</var><span class="hyp-type"><b>: </b><span>composite_plan_item IM</span></span></span><br><span><var>a</var><span class="hyp-type"><b>: </b><span>list (composite_plan_item IM)</span></span></span><br><span><var>a_indices</var><span><span class="hyp-body"><b>:= </b><span>List.map projT1
  (List.map label_a (a ++ [x]))</span></span><span class="hyp-type"><b>: </b><span>list index</span></span></span></span><br><span><var>i</var><span class="hyp-type"><b>: </b><span>index</span></span></span><br><span><var>Hdif</var><span class="hyp-type"><b>: </b><span>i
‚àâ List.map projT1 (List.map label_a a) ++
  List.map projT1 (List.map label_a [x])</span></span></span><br><span><var>tra</var><span class="hyp-type"><b>: </b><span>list transition_item</span></span></span><br><span><var>sa</var><span class="hyp-type"><b>: </b><span>composite_state IM</span></span></span><br><span><var>eq_a</var><span class="hyp-type"><b>: </b><span>composite_apply_plan IM s a = (tra, sa)</span></span></span><br><span><var>trx</var><span class="hyp-type"><b>: </b><span>list transition_item</span></span></span><br><span><var>sx</var><span class="hyp-type"><b>: </b><span>composite_state IM</span></span></span><br><span><var>eq_x</var><span class="hyp-type"><b>: </b><span>composite_apply_plan IM sa [x] = (trx, sx)</span></span></span><br><span><var>IHa</var><span class="hyp-type"><b>: </b><span>sa i = s i</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">i ‚â† projT1 (label_a x)</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="Composition-v-chk174" style="display: none" type="checkbox"><label class="alectryon-input" for="Composition-v-chk174"><span class="nb">intros</span> contra.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>message, index</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>EqDecision0</var><span class="hyp-type"><b>: </b><span>EqDecision index</span></span></span><br><span><var>IM</var><span class="hyp-type"><b>: </b><span>index ‚Üí VLSM message</span></span></span><br><span><var>Free</var><span><span class="hyp-body"><b>:= </b><span>free_composite_vlsm IM</span></span><span class="hyp-type"><b>: </b><span>VLSM message</span></span></span></span><br><span><var>s</var><span class="hyp-type"><b>: </b><span>composite_state IM</span></span></span><br><span><var>x</var><span class="hyp-type"><b>: </b><span>composite_plan_item IM</span></span></span><br><span><var>a</var><span class="hyp-type"><b>: </b><span>list (composite_plan_item IM)</span></span></span><br><span><var>a_indices</var><span><span class="hyp-body"><b>:= </b><span>List.map projT1
  (List.map label_a (a ++ [x]))</span></span><span class="hyp-type"><b>: </b><span>list index</span></span></span></span><br><span><var>i</var><span class="hyp-type"><b>: </b><span>index</span></span></span><br><span><var>Hdif</var><span class="hyp-type"><b>: </b><span>i
‚àâ List.map projT1 (List.map label_a a) ++
  List.map projT1 (List.map label_a [x])</span></span></span><br><span><var>tra</var><span class="hyp-type"><b>: </b><span>list transition_item</span></span></span><br><span><var>sa</var><span class="hyp-type"><b>: </b><span>composite_state IM</span></span></span><br><span><var>eq_a</var><span class="hyp-type"><b>: </b><span>composite_apply_plan IM s a = (tra, sa)</span></span></span><br><span><var>trx</var><span class="hyp-type"><b>: </b><span>list transition_item</span></span></span><br><span><var>sx</var><span class="hyp-type"><b>: </b><span>composite_state IM</span></span></span><br><span><var>eq_x</var><span class="hyp-type"><b>: </b><span>composite_apply_plan IM sa [x] = (trx, sx)</span></span></span><br><span><var>IHa</var><span class="hyp-type"><b>: </b><span>sa i = s i</span></span></span><br><span><var>contra</var><span class="hyp-type"><b>: </b><span>i = projT1 (label_a x)</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="kt">False</span></div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="Composition-v-chk175" style="display: none" type="checkbox"><label class="alectryon-input" for="Composition-v-chk175"><span class="nb">rewrite</span> contra <span class="kr">in</span> Hdif.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>message, index</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>EqDecision0</var><span class="hyp-type"><b>: </b><span>EqDecision index</span></span></span><br><span><var>IM</var><span class="hyp-type"><b>: </b><span>index ‚Üí VLSM message</span></span></span><br><span><var>Free</var><span><span class="hyp-body"><b>:= </b><span>free_composite_vlsm IM</span></span><span class="hyp-type"><b>: </b><span>VLSM message</span></span></span></span><br><span><var>s</var><span class="hyp-type"><b>: </b><span>composite_state IM</span></span></span><br><span><var>x</var><span class="hyp-type"><b>: </b><span>composite_plan_item IM</span></span></span><br><span><var>a</var><span class="hyp-type"><b>: </b><span>list (composite_plan_item IM)</span></span></span><br><span><var>a_indices</var><span><span class="hyp-body"><b>:= </b><span>List.map projT1
  (List.map label_a (a ++ [x]))</span></span><span class="hyp-type"><b>: </b><span>list index</span></span></span></span><br><span><var>i</var><span class="hyp-type"><b>: </b><span>index</span></span></span><br><span><var>Hdif</var><span class="hyp-type"><b>: </b><span>projT1 (label_a x)
‚àâ List.map projT1 (List.map label_a a) ++
  List.map projT1 (List.map label_a [x])</span></span></span><br><span><var>tra</var><span class="hyp-type"><b>: </b><span>list transition_item</span></span></span><br><span><var>sa</var><span class="hyp-type"><b>: </b><span>composite_state IM</span></span></span><br><span><var>eq_a</var><span class="hyp-type"><b>: </b><span>composite_apply_plan IM s a = (tra, sa)</span></span></span><br><span><var>trx</var><span class="hyp-type"><b>: </b><span>list transition_item</span></span></span><br><span><var>sx</var><span class="hyp-type"><b>: </b><span>composite_state IM</span></span></span><br><span><var>eq_x</var><span class="hyp-type"><b>: </b><span>composite_apply_plan IM sa [x] = (trx, sx)</span></span></span><br><span><var>IHa</var><span class="hyp-type"><b>: </b><span>sa i = s i</span></span></span><br><span><var>contra</var><span class="hyp-type"><b>: </b><span>i = projT1 (label_a x)</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="kt">False</span></div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
</span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="Composition-v-chk176" style="display: none" type="checkbox"><label class="alectryon-input" for="Composition-v-chk176"><span class="nb">rewrite</span> elem_of_app <span class="kr">in</span> Hdif; <span class="nb">simpl</span> <span class="kr">in</span> Hdif.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>message, index</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>EqDecision0</var><span class="hyp-type"><b>: </b><span>EqDecision index</span></span></span><br><span><var>IM</var><span class="hyp-type"><b>: </b><span>index ‚Üí VLSM message</span></span></span><br><span><var>Free</var><span><span class="hyp-body"><b>:= </b><span>free_composite_vlsm IM</span></span><span class="hyp-type"><b>: </b><span>VLSM message</span></span></span></span><br><span><var>s</var><span class="hyp-type"><b>: </b><span>composite_state IM</span></span></span><br><span><var>x</var><span class="hyp-type"><b>: </b><span>composite_plan_item IM</span></span></span><br><span><var>a</var><span class="hyp-type"><b>: </b><span>list (composite_plan_item IM)</span></span></span><br><span><var>a_indices</var><span><span class="hyp-body"><b>:= </b><span>List.map projT1
  (List.map label_a (a ++ [x]))</span></span><span class="hyp-type"><b>: </b><span>list index</span></span></span></span><br><span><var>i</var><span class="hyp-type"><b>: </b><span>index</span></span></span><br><span><var>Hdif</var><span class="hyp-type"><b>: </b><span>¬¨ (projT1 (label_a x)
   ‚àà List.map projT1 (List.map label_a a)
   ‚à® projT1 (label_a x) ‚àà [projT1 (label_a x)])</span></span></span><br><span><var>tra</var><span class="hyp-type"><b>: </b><span>list transition_item</span></span></span><br><span><var>sa</var><span class="hyp-type"><b>: </b><span>composite_state IM</span></span></span><br><span><var>eq_a</var><span class="hyp-type"><b>: </b><span>composite_apply_plan IM s a = (tra, sa)</span></span></span><br><span><var>trx</var><span class="hyp-type"><b>: </b><span>list transition_item</span></span></span><br><span><var>sx</var><span class="hyp-type"><b>: </b><span>composite_state IM</span></span></span><br><span><var>eq_x</var><span class="hyp-type"><b>: </b><span>composite_apply_plan IM sa [x] = (trx, sx)</span></span></span><br><span><var>IHa</var><span class="hyp-type"><b>: </b><span>sa i = s i</span></span></span><br><span><var>contra</var><span class="hyp-type"><b>: </b><span>i = projT1 (label_a x)</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="kt">False</span></div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="Composition-v-chk177" style="display: none" type="checkbox"><label class="alectryon-input" for="Composition-v-chk177"><span class="bp">contradict</span> Hdif.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>message, index</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>EqDecision0</var><span class="hyp-type"><b>: </b><span>EqDecision index</span></span></span><br><span><var>IM</var><span class="hyp-type"><b>: </b><span>index ‚Üí VLSM message</span></span></span><br><span><var>Free</var><span><span class="hyp-body"><b>:= </b><span>free_composite_vlsm IM</span></span><span class="hyp-type"><b>: </b><span>VLSM message</span></span></span></span><br><span><var>s</var><span class="hyp-type"><b>: </b><span>composite_state IM</span></span></span><br><span><var>x</var><span class="hyp-type"><b>: </b><span>composite_plan_item IM</span></span></span><br><span><var>a</var><span class="hyp-type"><b>: </b><span>list (composite_plan_item IM)</span></span></span><br><span><var>a_indices</var><span><span class="hyp-body"><b>:= </b><span>List.map projT1
  (List.map label_a (a ++ [x]))</span></span><span class="hyp-type"><b>: </b><span>list index</span></span></span></span><br><span><var>i</var><span class="hyp-type"><b>: </b><span>index</span></span></span><br><span><var>tra</var><span class="hyp-type"><b>: </b><span>list transition_item</span></span></span><br><span><var>sa</var><span class="hyp-type"><b>: </b><span>composite_state IM</span></span></span><br><span><var>eq_a</var><span class="hyp-type"><b>: </b><span>composite_apply_plan IM s a = (tra, sa)</span></span></span><br><span><var>trx</var><span class="hyp-type"><b>: </b><span>list transition_item</span></span></span><br><span><var>sx</var><span class="hyp-type"><b>: </b><span>composite_state IM</span></span></span><br><span><var>eq_x</var><span class="hyp-type"><b>: </b><span>composite_apply_plan IM sa [x] = (trx, sx)</span></span></span><br><span><var>IHa</var><span class="hyp-type"><b>: </b><span>sa i = s i</span></span></span><br><span><var>contra</var><span class="hyp-type"><b>: </b><span>i = projT1 (label_a x)</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">projT1 (label_a x)
‚àà List.map projT1 (List.map label_a a)
‚à® projT1 (label_a x) ‚àà [projT1 (label_a x)]</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="Composition-v-chk178" style="display: none" type="checkbox"><label class="alectryon-input" for="Composition-v-chk178"><span class="nb">subst</span>.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>message, index</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>EqDecision0</var><span class="hyp-type"><b>: </b><span>EqDecision index</span></span></span><br><span><var>IM</var><span class="hyp-type"><b>: </b><span>index ‚Üí VLSM message</span></span></span><br><span><var>Free</var><span><span class="hyp-body"><b>:= </b><span>free_composite_vlsm IM</span></span><span class="hyp-type"><b>: </b><span>VLSM message</span></span></span></span><br><span><var>s</var><span class="hyp-type"><b>: </b><span>composite_state IM</span></span></span><br><span><var>x</var><span class="hyp-type"><b>: </b><span>composite_plan_item IM</span></span></span><br><span><var>a</var><span class="hyp-type"><b>: </b><span>list (composite_plan_item IM)</span></span></span><br><span><var>a_indices</var><span><span class="hyp-body"><b>:= </b><span>List.map projT1
  (List.map label_a (a ++ [x]))</span></span><span class="hyp-type"><b>: </b><span>list index</span></span></span></span><br><span><var>tra</var><span class="hyp-type"><b>: </b><span>list transition_item</span></span></span><br><span><var>sa</var><span class="hyp-type"><b>: </b><span>composite_state IM</span></span></span><br><span><var>eq_a</var><span class="hyp-type"><b>: </b><span>composite_apply_plan IM s a = (tra, sa)</span></span></span><br><span><var>trx</var><span class="hyp-type"><b>: </b><span>list transition_item</span></span></span><br><span><var>sx</var><span class="hyp-type"><b>: </b><span>composite_state IM</span></span></span><br><span><var>eq_x</var><span class="hyp-type"><b>: </b><span>composite_apply_plan IM sa [x] = (trx, sx)</span></span></span><br><span><var>IHa</var><span class="hyp-type"><b>: </b><span>sa (projT1 (label_a x)) = s (projT1 (label_a x))</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">projT1 (label_a x)
‚àà List.map projT1 (List.map label_a a)
‚à® projT1 (label_a x) ‚àà [projT1 (label_a x)]</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><span class="alectryon-input"><span class="bp">by</span> <span class="nb">right</span>; <span class="nb">left</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Qed</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
<span class="c">(* Same as relevant_components_one but for multiple transitions. *)</span>

</span><span class="alectryon-sentence"><input class="alectryon-toggle" id="Composition-v-chk179" style="display: none" type="checkbox"><label class="alectryon-input" for="Composition-v-chk179"><span class="kn">Lemma</span> <span class="nf">relevant_components_free</span>
  (<span class="nv">s</span> <span class="nv">s&#39;</span> : state Free)
  (<span class="nv">Hprs&#39;</span> : valid_state_prop Free s&#39;)
  (<span class="nv">a</span> : plan Free)
  (<span class="nv">a_indices</span> := List.map (@projT1 _ _) (List.map (@label_a _ _) a))
  (<span class="nv">li</span> : list index)
  (<span class="nv">Heq</span> : <span class="kr">forall</span> (<span class="nv">i</span> : index), i ‚àà li -&gt; (s&#39; i) = (s i))
  (<span class="nv">Hincl</span> : a_indices ‚äÜ li)
  (<span class="nv">Hpr</span> : finite_valid_plan_from Free s a) :
  <span class="kr">let</span> <span class="nv">res&#39;</span> := snd (apply_plan Free s&#39; a) <span class="kr">in</span>
  <span class="kr">let</span> <span class="nv">res</span> := snd (apply_plan Free s a) <span class="kr">in</span>
  finite_valid_plan_from Free s&#39; a /\
  (<span class="kr">forall</span> (<span class="nv">i</span> : index), i ‚àà li -&gt; (res&#39; i) = res i).</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>message, index</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>EqDecision0</var><span class="hyp-type"><b>: </b><span>EqDecision index</span></span></span><br><span><var>IM</var><span class="hyp-type"><b>: </b><span>index ‚Üí VLSM message</span></span></span><br><span><var>Free</var><span><span class="hyp-body"><b>:= </b><span>free_composite_vlsm IM</span></span><span class="hyp-type"><b>: </b><span>VLSM message</span></span></span></span><br><span><var>s, s'</var><span class="hyp-type"><b>: </b><span>state Free</span></span></span><br><span><var>Hprs'</var><span class="hyp-type"><b>: </b><span>valid_state_prop Free s&#39;</span></span></span><br><span><var>a</var><span class="hyp-type"><b>: </b><span>plan Free</span></span></span><br><span><var>a_indices</var><span><span class="hyp-body"><b>:= </b><span>List.map projT1 (List.map label_a a)</span></span><span class="hyp-type"><b>: </b><span>list index</span></span></span></span><br><span><var>li</var><span class="hyp-type"><b>: </b><span>list index</span></span></span><br><span><var>Heq</var><span class="hyp-type"><b>: </b><span><span class="kr">‚àÄ</span> <span class="nv">i</span> : index, i ‚àà li ‚Üí s&#39; i = s i</span></span></span><br><span><var>Hincl</var><span class="hyp-type"><b>: </b><span>a_indices ‚äÜ li</span></span></span><br><span><var>Hpr</var><span class="hyp-type"><b>: </b><span>finite_valid_plan_from Free s a</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="kr">let</span> <span class="nv">res&#39;</span> := (apply_plan Free s&#39; a).<span class="mi">2</span> <span class="kr">in</span>
<span class="kr">let</span> <span class="nv">res</span> := (apply_plan Free s a).<span class="mi">2</span> <span class="kr">in</span>
finite_valid_plan_from Free s&#39; a
‚àß (<span class="kr">‚àÄ</span> <span class="nv">i</span> : index, i ‚àà li ‚Üí res&#39; i = res i)</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="Composition-v-chk17a" style="display: none" type="checkbox"><label class="alectryon-input" for="Composition-v-chk17a"><span class="kn">Proof</span>.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>message, index</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>EqDecision0</var><span class="hyp-type"><b>: </b><span>EqDecision index</span></span></span><br><span><var>IM</var><span class="hyp-type"><b>: </b><span>index ‚Üí VLSM message</span></span></span><br><span><var>Free</var><span><span class="hyp-body"><b>:= </b><span>free_composite_vlsm IM</span></span><span class="hyp-type"><b>: </b><span>VLSM message</span></span></span></span><br><span><var>s, s'</var><span class="hyp-type"><b>: </b><span>state Free</span></span></span><br><span><var>Hprs'</var><span class="hyp-type"><b>: </b><span>valid_state_prop Free s&#39;</span></span></span><br><span><var>a</var><span class="hyp-type"><b>: </b><span>plan Free</span></span></span><br><span><var>a_indices</var><span><span class="hyp-body"><b>:= </b><span>List.map projT1 (List.map label_a a)</span></span><span class="hyp-type"><b>: </b><span>list index</span></span></span></span><br><span><var>li</var><span class="hyp-type"><b>: </b><span>list index</span></span></span><br><span><var>Heq</var><span class="hyp-type"><b>: </b><span><span class="kr">‚àÄ</span> <span class="nv">i</span> : index, i ‚àà li ‚Üí s&#39; i = s i</span></span></span><br><span><var>Hincl</var><span class="hyp-type"><b>: </b><span>a_indices ‚äÜ li</span></span></span><br><span><var>Hpr</var><span class="hyp-type"><b>: </b><span>finite_valid_plan_from Free s a</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="kr">let</span> <span class="nv">res&#39;</span> := (apply_plan Free s&#39; a).<span class="mi">2</span> <span class="kr">in</span>
<span class="kr">let</span> <span class="nv">res</span> := (apply_plan Free s a).<span class="mi">2</span> <span class="kr">in</span>
finite_valid_plan_from Free s&#39; a
‚àß (<span class="kr">‚àÄ</span> <span class="nv">i</span> : index, i ‚àà li ‚Üí res&#39; i = res i)</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="Composition-v-chk17b" style="display: none" type="checkbox"><label class="alectryon-input" for="Composition-v-chk17b"><span class="nb">induction</span> a <span class="nb">using</span> rev_ind; <span class="nb">cbn</span> <span class="kr">in</span> *; [<span class="bp">by</span> <span class="nb">split</span>; [<span class="nb">constructor</span> |] |].</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>message, index</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>EqDecision0</var><span class="hyp-type"><b>: </b><span>EqDecision index</span></span></span><br><span><var>IM</var><span class="hyp-type"><b>: </b><span>index ‚Üí VLSM message</span></span></span><br><span><var>Free</var><span><span class="hyp-body"><b>:= </b><span>free_composite_vlsm IM</span></span><span class="hyp-type"><b>: </b><span>VLSM message</span></span></span></span><br><span><var>s, s'</var><span class="hyp-type"><b>: </b><span>composite_state IM</span></span></span><br><span><var>Hprs'</var><span class="hyp-type"><b>: </b><span>valid_state_prop Free s&#39;</span></span></span><br><span><var>x</var><span class="hyp-type"><b>: </b><span>plan_item</span></span></span><br><span><var>a</var><span class="hyp-type"><b>: </b><span>list plan_item</span></span></span><br><span><var>a_indices</var><span><span class="hyp-body"><b>:= </b><span>List.map projT1
  (List.map label_a (a ++ [x]))</span></span><span class="hyp-type"><b>: </b><span>list index</span></span></span></span><br><span><var>li</var><span class="hyp-type"><b>: </b><span>list index</span></span></span><br><span><var>Heq</var><span class="hyp-type"><b>: </b><span><span class="kr">‚àÄ</span> <span class="nv">i</span> : index, i ‚àà li ‚Üí s&#39; i = s i</span></span></span><br><span><var>Hincl</var><span class="hyp-type"><b>: </b><span>a_indices ‚äÜ li</span></span></span><br><span><var>Hpr</var><span class="hyp-type"><b>: </b><span>finite_valid_plan_from Free s (a ++ [x])</span></span></span><br><span><var>IHa</var><span class="hyp-type"><b>: </b><span>List.map projT1 (List.map label_a a) ‚äÜ li
‚Üí finite_valid_plan_from Free s a
  ‚Üí finite_valid_plan_from Free s&#39; a
    ‚àß (<span class="kr">‚àÄ</span> <span class="nv">i</span> : index,
         i ‚àà li
         ‚Üí (apply_plan Free s&#39; a).<span class="mi">2</span> i =
           (apply_plan Free s a).<span class="mi">2</span> i)</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">finite_valid_plan_from Free s&#39; (a ++ [x])
‚àß (<span class="kr">‚àÄ</span> <span class="nv">i</span> : index,
     i ‚àà li
     ‚Üí (apply_plan Free s&#39; (a ++ [x])).<span class="mi">2</span> i =
       (apply_plan Free s (a ++ [x])).<span class="mi">2</span> i)</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="Composition-v-chk17c" style="display: none" type="checkbox"><label class="alectryon-input" for="Composition-v-chk17c"><span class="nb">apply</span> finite_valid_plan_from_app_iff <span class="kr">in</span> Hpr <span class="kr">as</span> [Hrem Hsingle].</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>message, index</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>EqDecision0</var><span class="hyp-type"><b>: </b><span>EqDecision index</span></span></span><br><span><var>IM</var><span class="hyp-type"><b>: </b><span>index ‚Üí VLSM message</span></span></span><br><span><var>Free</var><span><span class="hyp-body"><b>:= </b><span>free_composite_vlsm IM</span></span><span class="hyp-type"><b>: </b><span>VLSM message</span></span></span></span><br><span><var>s, s'</var><span class="hyp-type"><b>: </b><span>composite_state IM</span></span></span><br><span><var>Hprs'</var><span class="hyp-type"><b>: </b><span>valid_state_prop Free s&#39;</span></span></span><br><span><var>x</var><span class="hyp-type"><b>: </b><span>plan_item</span></span></span><br><span><var>a</var><span class="hyp-type"><b>: </b><span>list plan_item</span></span></span><br><span><var>a_indices</var><span><span class="hyp-body"><b>:= </b><span>List.map projT1
  (List.map label_a (a ++ [x]))</span></span><span class="hyp-type"><b>: </b><span>list index</span></span></span></span><br><span><var>li</var><span class="hyp-type"><b>: </b><span>list index</span></span></span><br><span><var>Heq</var><span class="hyp-type"><b>: </b><span><span class="kr">‚àÄ</span> <span class="nv">i</span> : index, i ‚àà li ‚Üí s&#39; i = s i</span></span></span><br><span><var>Hincl</var><span class="hyp-type"><b>: </b><span>a_indices ‚äÜ li</span></span></span><br><span><var>Hrem</var><span class="hyp-type"><b>: </b><span>finite_valid_plan_from Free s a</span></span></span><br><span><var>Hsingle</var><span class="hyp-type"><b>: </b><span>finite_valid_plan_from Free
  (apply_plan Free s a).<span class="mi">2</span> [x]</span></span></span><br><span><var>IHa</var><span class="hyp-type"><b>: </b><span>List.map projT1 (List.map label_a a) ‚äÜ li
‚Üí finite_valid_plan_from Free s a
  ‚Üí finite_valid_plan_from Free s&#39; a
    ‚àß (<span class="kr">‚àÄ</span> <span class="nv">i</span> : index,
         i ‚àà li
         ‚Üí (apply_plan Free s&#39; a).<span class="mi">2</span> i =
           (apply_plan Free s a).<span class="mi">2</span> i)</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">finite_valid_plan_from Free s&#39; (a ++ [x])
‚àß (<span class="kr">‚àÄ</span> <span class="nv">i</span> : index,
     i ‚àà li
     ‚Üí (apply_plan Free s&#39; (a ++ [x])).<span class="mi">2</span> i =
       (apply_plan Free s (a ++ [x])).<span class="mi">2</span> i)</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="Composition-v-chk17d" style="display: none" type="checkbox"><label class="alectryon-input" for="Composition-v-chk17d">spec IHa.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>message, index</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>EqDecision0</var><span class="hyp-type"><b>: </b><span>EqDecision index</span></span></span><br><span><var>IM</var><span class="hyp-type"><b>: </b><span>index ‚Üí VLSM message</span></span></span><br><span><var>Free</var><span><span class="hyp-body"><b>:= </b><span>free_composite_vlsm IM</span></span><span class="hyp-type"><b>: </b><span>VLSM message</span></span></span></span><br><span><var>s, s'</var><span class="hyp-type"><b>: </b><span>composite_state IM</span></span></span><br><span><var>Hprs'</var><span class="hyp-type"><b>: </b><span>valid_state_prop Free s&#39;</span></span></span><br><span><var>x</var><span class="hyp-type"><b>: </b><span>plan_item</span></span></span><br><span><var>a</var><span class="hyp-type"><b>: </b><span>list plan_item</span></span></span><br><span><var>a_indices</var><span><span class="hyp-body"><b>:= </b><span>List.map projT1
  (List.map label_a (a ++ [x]))</span></span><span class="hyp-type"><b>: </b><span>list index</span></span></span></span><br><span><var>li</var><span class="hyp-type"><b>: </b><span>list index</span></span></span><br><span><var>Heq</var><span class="hyp-type"><b>: </b><span><span class="kr">‚àÄ</span> <span class="nv">i</span> : index, i ‚àà li ‚Üí s&#39; i = s i</span></span></span><br><span><var>Hincl</var><span class="hyp-type"><b>: </b><span>a_indices ‚äÜ li</span></span></span><br><span><var>Hrem</var><span class="hyp-type"><b>: </b><span>finite_valid_plan_from Free s a</span></span></span><br><span><var>Hsingle</var><span class="hyp-type"><b>: </b><span>finite_valid_plan_from Free
  (apply_plan Free s a).<span class="mi">2</span> [x]</span></span></span><br><span><var>IHa</var><span class="hyp-type"><b>: </b><span>List.map projT1 (List.map label_a a) ‚äÜ li
‚Üí finite_valid_plan_from Free s a
  ‚Üí finite_valid_plan_from Free s&#39; a
    ‚àß (<span class="kr">‚àÄ</span> <span class="nv">i</span> : index,
         i ‚àà li
         ‚Üí (apply_plan Free s&#39; a).<span class="mi">2</span> i =
           (apply_plan Free s a).<span class="mi">2</span> i)</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">List.map projT1 (List.map label_a a) ‚äÜ li</div></blockquote><div class="alectryon-extra-goals"><input class="alectryon-extra-goal-toggle" id="Composition-v-chk17e" style="display: none" type="checkbox"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>message, index</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>EqDecision0</var><span class="hyp-type"><b>: </b><span>EqDecision index</span></span></span><br><span><var>IM</var><span class="hyp-type"><b>: </b><span>index ‚Üí VLSM message</span></span></span><br><span><var>Free</var><span><span class="hyp-body"><b>:= </b><span>free_composite_vlsm IM</span></span><span class="hyp-type"><b>: </b><span>VLSM message</span></span></span></span><br><span><var>s, s'</var><span class="hyp-type"><b>: </b><span>composite_state IM</span></span></span><br><span><var>Hprs'</var><span class="hyp-type"><b>: </b><span>valid_state_prop Free s&#39;</span></span></span><br><span><var>x</var><span class="hyp-type"><b>: </b><span>plan_item</span></span></span><br><span><var>a</var><span class="hyp-type"><b>: </b><span>list plan_item</span></span></span><br><span><var>a_indices</var><span><span class="hyp-body"><b>:= </b><span>List.map projT1
  (List.map label_a (a ++ [x]))</span></span><span class="hyp-type"><b>: </b><span>list index</span></span></span></span><br><span><var>li</var><span class="hyp-type"><b>: </b><span>list index</span></span></span><br><span><var>Heq</var><span class="hyp-type"><b>: </b><span><span class="kr">‚àÄ</span> <span class="nv">i</span> : index, i ‚àà li ‚Üí s&#39; i = s i</span></span></span><br><span><var>Hincl</var><span class="hyp-type"><b>: </b><span>a_indices ‚äÜ li</span></span></span><br><span><var>Hrem</var><span class="hyp-type"><b>: </b><span>finite_valid_plan_from Free s a</span></span></span><br><span><var>Hsingle</var><span class="hyp-type"><b>: </b><span>finite_valid_plan_from Free
  (apply_plan Free s a).<span class="mi">2</span> [x]</span></span></span><br><span><var>IHa</var><span class="hyp-type"><b>: </b><span>finite_valid_plan_from Free s a
‚Üí finite_valid_plan_from Free s&#39; a
  ‚àß (<span class="kr">‚àÄ</span> <span class="nv">i</span> : index,
       i ‚àà li
       ‚Üí (apply_plan Free s&#39; a).<span class="mi">2</span> i =
         (apply_plan Free s a).<span class="mi">2</span> i)</span></span></span><br></div><label class="goal-separator" for="Composition-v-chk17e"><hr></label><div class="goal-conclusion">finite_valid_plan_from Free s&#39; (a ++ [x])
‚àß (<span class="kr">‚àÄ</span> <span class="nv">i</span> : index,
     i ‚àà li
     ‚Üí (apply_plan Free s&#39; (a ++ [x])).<span class="mi">2</span> i =
       (apply_plan Free s (a ++ [x])).<span class="mi">2</span> i)</div></blockquote></div></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="Composition-v-chk17f" style="display: none" type="checkbox"><label class="alectryon-input" for="Composition-v-chk17f">{</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>message, index</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>EqDecision0</var><span class="hyp-type"><b>: </b><span>EqDecision index</span></span></span><br><span><var>IM</var><span class="hyp-type"><b>: </b><span>index ‚Üí VLSM message</span></span></span><br><span><var>Free</var><span><span class="hyp-body"><b>:= </b><span>free_composite_vlsm IM</span></span><span class="hyp-type"><b>: </b><span>VLSM message</span></span></span></span><br><span><var>s, s'</var><span class="hyp-type"><b>: </b><span>composite_state IM</span></span></span><br><span><var>Hprs'</var><span class="hyp-type"><b>: </b><span>valid_state_prop Free s&#39;</span></span></span><br><span><var>x</var><span class="hyp-type"><b>: </b><span>plan_item</span></span></span><br><span><var>a</var><span class="hyp-type"><b>: </b><span>list plan_item</span></span></span><br><span><var>a_indices</var><span><span class="hyp-body"><b>:= </b><span>List.map projT1
  (List.map label_a (a ++ [x]))</span></span><span class="hyp-type"><b>: </b><span>list index</span></span></span></span><br><span><var>li</var><span class="hyp-type"><b>: </b><span>list index</span></span></span><br><span><var>Heq</var><span class="hyp-type"><b>: </b><span><span class="kr">‚àÄ</span> <span class="nv">i</span> : index, i ‚àà li ‚Üí s&#39; i = s i</span></span></span><br><span><var>Hincl</var><span class="hyp-type"><b>: </b><span>a_indices ‚äÜ li</span></span></span><br><span><var>Hrem</var><span class="hyp-type"><b>: </b><span>finite_valid_plan_from Free s a</span></span></span><br><span><var>Hsingle</var><span class="hyp-type"><b>: </b><span>finite_valid_plan_from Free
  (apply_plan Free s a).<span class="mi">2</span> [x]</span></span></span><br><span><var>IHa</var><span class="hyp-type"><b>: </b><span>List.map projT1 (List.map label_a a) ‚äÜ li
‚Üí finite_valid_plan_from Free s a
  ‚Üí finite_valid_plan_from Free s&#39; a
    ‚àß (<span class="kr">‚àÄ</span> <span class="nv">i</span> : index,
         i ‚àà li
         ‚Üí (apply_plan Free s&#39; a).<span class="mi">2</span> i =
           (apply_plan Free s a).<span class="mi">2</span> i)</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">List.map projT1 (List.map label_a a) ‚äÜ li</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="Composition-v-chk180" style="display: none" type="checkbox"><label class="alectryon-input" for="Composition-v-chk180"><span class="nb">remember</span> (List.map (@projT1 _ (<span class="kr">fun</span> <span class="nv">n</span> : index =&gt; label (IM n))) (List.map label_a a)) <span class="kr">as</span> small.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>message, index</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>EqDecision0</var><span class="hyp-type"><b>: </b><span>EqDecision index</span></span></span><br><span><var>IM</var><span class="hyp-type"><b>: </b><span>index ‚Üí VLSM message</span></span></span><br><span><var>Free</var><span><span class="hyp-body"><b>:= </b><span>free_composite_vlsm IM</span></span><span class="hyp-type"><b>: </b><span>VLSM message</span></span></span></span><br><span><var>s, s'</var><span class="hyp-type"><b>: </b><span>composite_state IM</span></span></span><br><span><var>Hprs'</var><span class="hyp-type"><b>: </b><span>valid_state_prop Free s&#39;</span></span></span><br><span><var>x</var><span class="hyp-type"><b>: </b><span>plan_item</span></span></span><br><span><var>a</var><span class="hyp-type"><b>: </b><span>list plan_item</span></span></span><br><span><var>a_indices</var><span><span class="hyp-body"><b>:= </b><span>List.map projT1
  (List.map label_a (a ++ [x]))</span></span><span class="hyp-type"><b>: </b><span>list index</span></span></span></span><br><span><var>li</var><span class="hyp-type"><b>: </b><span>list index</span></span></span><br><span><var>Heq</var><span class="hyp-type"><b>: </b><span><span class="kr">‚àÄ</span> <span class="nv">i</span> : index, i ‚àà li ‚Üí s&#39; i = s i</span></span></span><br><span><var>Hincl</var><span class="hyp-type"><b>: </b><span>a_indices ‚äÜ li</span></span></span><br><span><var>Hrem</var><span class="hyp-type"><b>: </b><span>finite_valid_plan_from Free s a</span></span></span><br><span><var>Hsingle</var><span class="hyp-type"><b>: </b><span>finite_valid_plan_from Free
  (apply_plan Free s a).<span class="mi">2</span> [x]</span></span></span><br><span><var>IHa</var><span class="hyp-type"><b>: </b><span>List.map projT1 (List.map label_a a) ‚äÜ li
‚Üí finite_valid_plan_from Free s a
  ‚Üí finite_valid_plan_from Free s&#39; a
    ‚àß (<span class="kr">‚àÄ</span> <span class="nv">i</span> : index,
         i ‚àà li
         ‚Üí (apply_plan Free s&#39; a).<span class="mi">2</span> i =
           (apply_plan Free s a).<span class="mi">2</span> i)</span></span></span><br><span><var>small</var><span class="hyp-type"><b>: </b><span>list index</span></span></span><br><span><var>Heqsmall</var><span class="hyp-type"><b>: </b><span>small =
List.map projT1 (List.map label_a a)</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">List.map projT1 (List.map label_a a) ‚äÜ li</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="Composition-v-chk181" style="display: none" type="checkbox"><label class="alectryon-input" for="Composition-v-chk181"><span class="nb">transitivity</span> a_indices; [| <span class="bp">done</span>].</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>message, index</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>EqDecision0</var><span class="hyp-type"><b>: </b><span>EqDecision index</span></span></span><br><span><var>IM</var><span class="hyp-type"><b>: </b><span>index ‚Üí VLSM message</span></span></span><br><span><var>Free</var><span><span class="hyp-body"><b>:= </b><span>free_composite_vlsm IM</span></span><span class="hyp-type"><b>: </b><span>VLSM message</span></span></span></span><br><span><var>s, s'</var><span class="hyp-type"><b>: </b><span>composite_state IM</span></span></span><br><span><var>Hprs'</var><span class="hyp-type"><b>: </b><span>valid_state_prop Free s&#39;</span></span></span><br><span><var>x</var><span class="hyp-type"><b>: </b><span>plan_item</span></span></span><br><span><var>a</var><span class="hyp-type"><b>: </b><span>list plan_item</span></span></span><br><span><var>a_indices</var><span><span class="hyp-body"><b>:= </b><span>List.map projT1
  (List.map label_a (a ++ [x]))</span></span><span class="hyp-type"><b>: </b><span>list index</span></span></span></span><br><span><var>li</var><span class="hyp-type"><b>: </b><span>list index</span></span></span><br><span><var>Heq</var><span class="hyp-type"><b>: </b><span><span class="kr">‚àÄ</span> <span class="nv">i</span> : index, i ‚àà li ‚Üí s&#39; i = s i</span></span></span><br><span><var>Hincl</var><span class="hyp-type"><b>: </b><span>a_indices ‚äÜ li</span></span></span><br><span><var>Hrem</var><span class="hyp-type"><b>: </b><span>finite_valid_plan_from Free s a</span></span></span><br><span><var>Hsingle</var><span class="hyp-type"><b>: </b><span>finite_valid_plan_from Free
  (apply_plan Free s a).<span class="mi">2</span> [x]</span></span></span><br><span><var>IHa</var><span class="hyp-type"><b>: </b><span>List.map projT1 (List.map label_a a) ‚äÜ li
‚Üí finite_valid_plan_from Free s a
  ‚Üí finite_valid_plan_from Free s&#39; a
    ‚àß (<span class="kr">‚àÄ</span> <span class="nv">i</span> : index,
         i ‚àà li
         ‚Üí (apply_plan Free s&#39; a).<span class="mi">2</span> i =
           (apply_plan Free s a).<span class="mi">2</span> i)</span></span></span><br><span><var>small</var><span class="hyp-type"><b>: </b><span>list index</span></span></span><br><span><var>Heqsmall</var><span class="hyp-type"><b>: </b><span>small =
List.map projT1 (List.map label_a a)</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">List.map projT1 (List.map label_a a) ‚äÜ a_indices</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="Composition-v-chk182" style="display: none" type="checkbox"><label class="alectryon-input" for="Composition-v-chk182"><span class="nb">unfold</span> a_indices.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>message, index</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>EqDecision0</var><span class="hyp-type"><b>: </b><span>EqDecision index</span></span></span><br><span><var>IM</var><span class="hyp-type"><b>: </b><span>index ‚Üí VLSM message</span></span></span><br><span><var>Free</var><span><span class="hyp-body"><b>:= </b><span>free_composite_vlsm IM</span></span><span class="hyp-type"><b>: </b><span>VLSM message</span></span></span></span><br><span><var>s, s'</var><span class="hyp-type"><b>: </b><span>composite_state IM</span></span></span><br><span><var>Hprs'</var><span class="hyp-type"><b>: </b><span>valid_state_prop Free s&#39;</span></span></span><br><span><var>x</var><span class="hyp-type"><b>: </b><span>plan_item</span></span></span><br><span><var>a</var><span class="hyp-type"><b>: </b><span>list plan_item</span></span></span><br><span><var>a_indices</var><span><span class="hyp-body"><b>:= </b><span>List.map projT1
  (List.map label_a (a ++ [x]))</span></span><span class="hyp-type"><b>: </b><span>list index</span></span></span></span><br><span><var>li</var><span class="hyp-type"><b>: </b><span>list index</span></span></span><br><span><var>Heq</var><span class="hyp-type"><b>: </b><span><span class="kr">‚àÄ</span> <span class="nv">i</span> : index, i ‚àà li ‚Üí s&#39; i = s i</span></span></span><br><span><var>Hincl</var><span class="hyp-type"><b>: </b><span>a_indices ‚äÜ li</span></span></span><br><span><var>Hrem</var><span class="hyp-type"><b>: </b><span>finite_valid_plan_from Free s a</span></span></span><br><span><var>Hsingle</var><span class="hyp-type"><b>: </b><span>finite_valid_plan_from Free
  (apply_plan Free s a).<span class="mi">2</span> [x]</span></span></span><br><span><var>IHa</var><span class="hyp-type"><b>: </b><span>List.map projT1 (List.map label_a a) ‚äÜ li
‚Üí finite_valid_plan_from Free s a
  ‚Üí finite_valid_plan_from Free s&#39; a
    ‚àß (<span class="kr">‚àÄ</span> <span class="nv">i</span> : index,
         i ‚àà li
         ‚Üí (apply_plan Free s&#39; a).<span class="mi">2</span> i =
           (apply_plan Free s a).<span class="mi">2</span> i)</span></span></span><br><span><var>small</var><span class="hyp-type"><b>: </b><span>list index</span></span></span><br><span><var>Heqsmall</var><span class="hyp-type"><b>: </b><span>small =
List.map projT1 (List.map label_a a)</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">List.map projT1 (List.map label_a a)
‚äÜ List.map projT1 (List.map label_a (a ++ [x]))</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="Composition-v-chk183" style="display: none" type="checkbox"><label class="alectryon-input" for="Composition-v-chk183"><span class="nb">intros</span> e H; <span class="nb">simpl</span>.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>message, index</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>EqDecision0</var><span class="hyp-type"><b>: </b><span>EqDecision index</span></span></span><br><span><var>IM</var><span class="hyp-type"><b>: </b><span>index ‚Üí VLSM message</span></span></span><br><span><var>Free</var><span><span class="hyp-body"><b>:= </b><span>free_composite_vlsm IM</span></span><span class="hyp-type"><b>: </b><span>VLSM message</span></span></span></span><br><span><var>s, s'</var><span class="hyp-type"><b>: </b><span>composite_state IM</span></span></span><br><span><var>Hprs'</var><span class="hyp-type"><b>: </b><span>valid_state_prop Free s&#39;</span></span></span><br><span><var>x</var><span class="hyp-type"><b>: </b><span>plan_item</span></span></span><br><span><var>a</var><span class="hyp-type"><b>: </b><span>list plan_item</span></span></span><br><span><var>a_indices</var><span><span class="hyp-body"><b>:= </b><span>List.map projT1
  (List.map label_a (a ++ [x]))</span></span><span class="hyp-type"><b>: </b><span>list index</span></span></span></span><br><span><var>li</var><span class="hyp-type"><b>: </b><span>list index</span></span></span><br><span><var>Heq</var><span class="hyp-type"><b>: </b><span><span class="kr">‚àÄ</span> <span class="nv">i</span> : index, i ‚àà li ‚Üí s&#39; i = s i</span></span></span><br><span><var>Hincl</var><span class="hyp-type"><b>: </b><span>a_indices ‚äÜ li</span></span></span><br><span><var>Hrem</var><span class="hyp-type"><b>: </b><span>finite_valid_plan_from Free s a</span></span></span><br><span><var>Hsingle</var><span class="hyp-type"><b>: </b><span>finite_valid_plan_from Free
  (apply_plan Free s a).<span class="mi">2</span> [x]</span></span></span><br><span><var>IHa</var><span class="hyp-type"><b>: </b><span>List.map projT1 (List.map label_a a) ‚äÜ li
‚Üí finite_valid_plan_from Free s a
  ‚Üí finite_valid_plan_from Free s&#39; a
    ‚àß (<span class="kr">‚àÄ</span> <span class="nv">i</span> : index,
         i ‚àà li
         ‚Üí (apply_plan Free s&#39; a).<span class="mi">2</span> i =
           (apply_plan Free s a).<span class="mi">2</span> i)</span></span></span><br><span><var>small</var><span class="hyp-type"><b>: </b><span>list index</span></span></span><br><span><var>Heqsmall</var><span class="hyp-type"><b>: </b><span>small =
List.map projT1 (List.map label_a a)</span></span></span><br><span><var>e</var><span class="hyp-type"><b>: </b><span>index</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>e ‚àà List.map projT1 (List.map label_a a)</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">e ‚àà List.map projT1 (List.map label_a (a ++ [x]))</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="Composition-v-chk184" style="display: none" type="checkbox"><label class="alectryon-input" for="Composition-v-chk184"><span class="nb">rewrite</span> <span class="mi">2</span> map_app, elem_of_app.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>message, index</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>EqDecision0</var><span class="hyp-type"><b>: </b><span>EqDecision index</span></span></span><br><span><var>IM</var><span class="hyp-type"><b>: </b><span>index ‚Üí VLSM message</span></span></span><br><span><var>Free</var><span><span class="hyp-body"><b>:= </b><span>free_composite_vlsm IM</span></span><span class="hyp-type"><b>: </b><span>VLSM message</span></span></span></span><br><span><var>s, s'</var><span class="hyp-type"><b>: </b><span>composite_state IM</span></span></span><br><span><var>Hprs'</var><span class="hyp-type"><b>: </b><span>valid_state_prop Free s&#39;</span></span></span><br><span><var>x</var><span class="hyp-type"><b>: </b><span>plan_item</span></span></span><br><span><var>a</var><span class="hyp-type"><b>: </b><span>list plan_item</span></span></span><br><span><var>a_indices</var><span><span class="hyp-body"><b>:= </b><span>List.map projT1
  (List.map label_a (a ++ [x]))</span></span><span class="hyp-type"><b>: </b><span>list index</span></span></span></span><br><span><var>li</var><span class="hyp-type"><b>: </b><span>list index</span></span></span><br><span><var>Heq</var><span class="hyp-type"><b>: </b><span><span class="kr">‚àÄ</span> <span class="nv">i</span> : index, i ‚àà li ‚Üí s&#39; i = s i</span></span></span><br><span><var>Hincl</var><span class="hyp-type"><b>: </b><span>a_indices ‚äÜ li</span></span></span><br><span><var>Hrem</var><span class="hyp-type"><b>: </b><span>finite_valid_plan_from Free s a</span></span></span><br><span><var>Hsingle</var><span class="hyp-type"><b>: </b><span>finite_valid_plan_from Free
  (apply_plan Free s a).<span class="mi">2</span> [x]</span></span></span><br><span><var>IHa</var><span class="hyp-type"><b>: </b><span>List.map projT1 (List.map label_a a) ‚äÜ li
‚Üí finite_valid_plan_from Free s a
  ‚Üí finite_valid_plan_from Free s&#39; a
    ‚àß (<span class="kr">‚àÄ</span> <span class="nv">i</span> : index,
         i ‚àà li
         ‚Üí (apply_plan Free s&#39; a).<span class="mi">2</span> i =
           (apply_plan Free s a).<span class="mi">2</span> i)</span></span></span><br><span><var>small</var><span class="hyp-type"><b>: </b><span>list index</span></span></span><br><span><var>Heqsmall</var><span class="hyp-type"><b>: </b><span>small =
List.map projT1 (List.map label_a a)</span></span></span><br><span><var>e</var><span class="hyp-type"><b>: </b><span>index</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>e ‚àà List.map projT1 (List.map label_a a)</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">e ‚àà List.map projT1 (List.map label_a a)
‚à® e ‚àà List.map projT1 (List.map label_a [x])</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><span class="alectryon-input"><span class="bp">by</span> itauto.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="Composition-v-chk185" style="display: none" type="checkbox"><label class="alectryon-input" for="Composition-v-chk185">}</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>message, index</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>EqDecision0</var><span class="hyp-type"><b>: </b><span>EqDecision index</span></span></span><br><span><var>IM</var><span class="hyp-type"><b>: </b><span>index ‚Üí VLSM message</span></span></span><br><span><var>Free</var><span><span class="hyp-body"><b>:= </b><span>free_composite_vlsm IM</span></span><span class="hyp-type"><b>: </b><span>VLSM message</span></span></span></span><br><span><var>s, s'</var><span class="hyp-type"><b>: </b><span>composite_state IM</span></span></span><br><span><var>Hprs'</var><span class="hyp-type"><b>: </b><span>valid_state_prop Free s&#39;</span></span></span><br><span><var>x</var><span class="hyp-type"><b>: </b><span>plan_item</span></span></span><br><span><var>a</var><span class="hyp-type"><b>: </b><span>list plan_item</span></span></span><br><span><var>a_indices</var><span><span class="hyp-body"><b>:= </b><span>List.map projT1
  (List.map label_a (a ++ [x]))</span></span><span class="hyp-type"><b>: </b><span>list index</span></span></span></span><br><span><var>li</var><span class="hyp-type"><b>: </b><span>list index</span></span></span><br><span><var>Heq</var><span class="hyp-type"><b>: </b><span><span class="kr">‚àÄ</span> <span class="nv">i</span> : index, i ‚àà li ‚Üí s&#39; i = s i</span></span></span><br><span><var>Hincl</var><span class="hyp-type"><b>: </b><span>a_indices ‚äÜ li</span></span></span><br><span><var>Hrem</var><span class="hyp-type"><b>: </b><span>finite_valid_plan_from Free s a</span></span></span><br><span><var>Hsingle</var><span class="hyp-type"><b>: </b><span>finite_valid_plan_from Free
  (apply_plan Free s a).<span class="mi">2</span> [x]</span></span></span><br><span><var>IHa</var><span class="hyp-type"><b>: </b><span>finite_valid_plan_from Free s a
‚Üí finite_valid_plan_from Free s&#39; a
  ‚àß (<span class="kr">‚àÄ</span> <span class="nv">i</span> : index,
       i ‚àà li
       ‚Üí (apply_plan Free s&#39; a).<span class="mi">2</span> i =
         (apply_plan Free s a).<span class="mi">2</span> i)</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">finite_valid_plan_from Free s&#39; (a ++ [x])
‚àß (<span class="kr">‚àÄ</span> <span class="nv">i</span> : index,
     i ‚àà li
     ‚Üí (apply_plan Free s&#39; (a ++ [x])).<span class="mi">2</span> i =
       (apply_plan Free s (a ++ [x])).<span class="mi">2</span> i)</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="Composition-v-chk186" style="display: none" type="checkbox"><label class="alectryon-input" for="Composition-v-chk186">spec IHa; [<span class="bp">done</span> |].</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>message, index</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>EqDecision0</var><span class="hyp-type"><b>: </b><span>EqDecision index</span></span></span><br><span><var>IM</var><span class="hyp-type"><b>: </b><span>index ‚Üí VLSM message</span></span></span><br><span><var>Free</var><span><span class="hyp-body"><b>:= </b><span>free_composite_vlsm IM</span></span><span class="hyp-type"><b>: </b><span>VLSM message</span></span></span></span><br><span><var>s, s'</var><span class="hyp-type"><b>: </b><span>composite_state IM</span></span></span><br><span><var>Hprs'</var><span class="hyp-type"><b>: </b><span>valid_state_prop Free s&#39;</span></span></span><br><span><var>x</var><span class="hyp-type"><b>: </b><span>plan_item</span></span></span><br><span><var>a</var><span class="hyp-type"><b>: </b><span>list plan_item</span></span></span><br><span><var>a_indices</var><span><span class="hyp-body"><b>:= </b><span>List.map projT1
  (List.map label_a (a ++ [x]))</span></span><span class="hyp-type"><b>: </b><span>list index</span></span></span></span><br><span><var>li</var><span class="hyp-type"><b>: </b><span>list index</span></span></span><br><span><var>Heq</var><span class="hyp-type"><b>: </b><span><span class="kr">‚àÄ</span> <span class="nv">i</span> : index, i ‚àà li ‚Üí s&#39; i = s i</span></span></span><br><span><var>Hincl</var><span class="hyp-type"><b>: </b><span>a_indices ‚äÜ li</span></span></span><br><span><var>Hrem</var><span class="hyp-type"><b>: </b><span>finite_valid_plan_from Free s a</span></span></span><br><span><var>Hsingle</var><span class="hyp-type"><b>: </b><span>finite_valid_plan_from Free
  (apply_plan Free s a).<span class="mi">2</span> [x]</span></span></span><br><span><var>IHa</var><span class="hyp-type"><b>: </b><span>finite_valid_plan_from Free s&#39; a
‚àß (<span class="kr">‚àÄ</span> <span class="nv">i</span> : index,
     i ‚àà li
     ‚Üí (apply_plan Free s&#39; a).<span class="mi">2</span> i =
       (apply_plan Free s a).<span class="mi">2</span> i)</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">finite_valid_plan_from Free s&#39; (a ++ [x])
‚àß (<span class="kr">‚àÄ</span> <span class="nv">i</span> : index,
     i ‚àà li
     ‚Üí (apply_plan Free s&#39; (a ++ [x])).<span class="mi">2</span> i =
       (apply_plan Free s (a ++ [x])).<span class="mi">2</span> i)</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="Composition-v-chk187" style="display: none" type="checkbox"><label class="alectryon-input" for="Composition-v-chk187"><span class="nb">destruct</span> IHa <span class="kr">as</span> [IHapr IHaind].</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>message, index</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>EqDecision0</var><span class="hyp-type"><b>: </b><span>EqDecision index</span></span></span><br><span><var>IM</var><span class="hyp-type"><b>: </b><span>index ‚Üí VLSM message</span></span></span><br><span><var>Free</var><span><span class="hyp-body"><b>:= </b><span>free_composite_vlsm IM</span></span><span class="hyp-type"><b>: </b><span>VLSM message</span></span></span></span><br><span><var>s, s'</var><span class="hyp-type"><b>: </b><span>composite_state IM</span></span></span><br><span><var>Hprs'</var><span class="hyp-type"><b>: </b><span>valid_state_prop Free s&#39;</span></span></span><br><span><var>x</var><span class="hyp-type"><b>: </b><span>plan_item</span></span></span><br><span><var>a</var><span class="hyp-type"><b>: </b><span>list plan_item</span></span></span><br><span><var>a_indices</var><span><span class="hyp-body"><b>:= </b><span>List.map projT1
  (List.map label_a (a ++ [x]))</span></span><span class="hyp-type"><b>: </b><span>list index</span></span></span></span><br><span><var>li</var><span class="hyp-type"><b>: </b><span>list index</span></span></span><br><span><var>Heq</var><span class="hyp-type"><b>: </b><span><span class="kr">‚àÄ</span> <span class="nv">i</span> : index, i ‚àà li ‚Üí s&#39; i = s i</span></span></span><br><span><var>Hincl</var><span class="hyp-type"><b>: </b><span>a_indices ‚äÜ li</span></span></span><br><span><var>Hrem</var><span class="hyp-type"><b>: </b><span>finite_valid_plan_from Free s a</span></span></span><br><span><var>Hsingle</var><span class="hyp-type"><b>: </b><span>finite_valid_plan_from Free
  (apply_plan Free s a).<span class="mi">2</span> [x]</span></span></span><br><span><var>IHapr</var><span class="hyp-type"><b>: </b><span>finite_valid_plan_from Free s&#39; a</span></span></span><br><span><var>IHaind</var><span class="hyp-type"><b>: </b><span><span class="kr">‚àÄ</span> <span class="nv">i</span> : index,
  i ‚àà li
  ‚Üí (apply_plan Free s&#39; a).<span class="mi">2</span> i =
    (apply_plan Free s a).<span class="mi">2</span> i</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">finite_valid_plan_from Free s&#39; (a ++ [x])
‚àß (<span class="kr">‚àÄ</span> <span class="nv">i</span> : index,
     i ‚àà li
     ‚Üí (apply_plan Free s&#39; (a ++ [x])).<span class="mi">2</span> i =
       (apply_plan Free s (a ++ [x])).<span class="mi">2</span> i)</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="Composition-v-chk188" style="display: none" type="checkbox"><label class="alectryon-input" for="Composition-v-chk188"><span class="nb">specialize</span> (relevant_components_one_free (snd (apply_plan Free s a))
    (snd (apply_plan Free s&#39; a))) <span class="kr">as</span> Hrel.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>message, index</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>EqDecision0</var><span class="hyp-type"><b>: </b><span>EqDecision index</span></span></span><br><span><var>IM</var><span class="hyp-type"><b>: </b><span>index ‚Üí VLSM message</span></span></span><br><span><var>Free</var><span><span class="hyp-body"><b>:= </b><span>free_composite_vlsm IM</span></span><span class="hyp-type"><b>: </b><span>VLSM message</span></span></span></span><br><span><var>s, s'</var><span class="hyp-type"><b>: </b><span>composite_state IM</span></span></span><br><span><var>Hprs'</var><span class="hyp-type"><b>: </b><span>valid_state_prop Free s&#39;</span></span></span><br><span><var>x</var><span class="hyp-type"><b>: </b><span>plan_item</span></span></span><br><span><var>a</var><span class="hyp-type"><b>: </b><span>list plan_item</span></span></span><br><span><var>a_indices</var><span><span class="hyp-body"><b>:= </b><span>List.map projT1
  (List.map label_a (a ++ [x]))</span></span><span class="hyp-type"><b>: </b><span>list index</span></span></span></span><br><span><var>li</var><span class="hyp-type"><b>: </b><span>list index</span></span></span><br><span><var>Heq</var><span class="hyp-type"><b>: </b><span><span class="kr">‚àÄ</span> <span class="nv">i</span> : index, i ‚àà li ‚Üí s&#39; i = s i</span></span></span><br><span><var>Hincl</var><span class="hyp-type"><b>: </b><span>a_indices ‚äÜ li</span></span></span><br><span><var>Hrem</var><span class="hyp-type"><b>: </b><span>finite_valid_plan_from Free s a</span></span></span><br><span><var>Hsingle</var><span class="hyp-type"><b>: </b><span>finite_valid_plan_from Free
  (apply_plan Free s a).<span class="mi">2</span> [x]</span></span></span><br><span><var>IHapr</var><span class="hyp-type"><b>: </b><span>finite_valid_plan_from Free s&#39; a</span></span></span><br><span><var>IHaind</var><span class="hyp-type"><b>: </b><span><span class="kr">‚àÄ</span> <span class="nv">i</span> : index,
  i ‚àà li
  ‚Üí (apply_plan Free s&#39; a).<span class="mi">2</span> i =
    (apply_plan Free s a).<span class="mi">2</span> i</span></span></span><br><span><var>Hrel</var><span class="hyp-type"><b>: </b><span>valid_state_prop Free (apply_plan Free s&#39; a).<span class="mi">2</span>
‚Üí <span class="kr">‚àÄ</span> <span class="nv">ai</span> : plan_item,
    <span class="kr">let</span> <span class="nv">i</span> := projT1 (label_a ai) <span class="kr">in</span>
    (apply_plan Free s a).<span class="mi">2</span> i =
    (apply_plan Free s&#39; a).<span class="mi">2</span> i
    ‚Üí finite_valid_plan_from Free
        (apply_plan Free s a).<span class="mi">2</span> [ai]
      ‚Üí <span class="kr">let</span> <span class="nv">res&#39;</span> :=
          (apply_plan Free
             (apply_plan Free s&#39; a).<span class="mi">2</span> [ai]).<span class="mi">2</span>
          <span class="kr">in</span>
        <span class="kr">let</span> <span class="nv">res</span> :=
          (apply_plan Free
             (apply_plan Free s a).<span class="mi">2</span> [ai]).<span class="mi">2</span> <span class="kr">in</span>
        finite_valid_plan_from Free
          (apply_plan Free s&#39; a).<span class="mi">2</span> [ai]
        ‚àß res&#39; i = res i</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">finite_valid_plan_from Free s&#39; (a ++ [x])
‚àß (<span class="kr">‚àÄ</span> <span class="nv">i</span> : index,
     i ‚àà li
     ‚Üí (apply_plan Free s&#39; (a ++ [x])).<span class="mi">2</span> i =
       (apply_plan Free s (a ++ [x])).<span class="mi">2</span> i)</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="Composition-v-chk189" style="display: none" type="checkbox"><label class="alectryon-input" for="Composition-v-chk189">spec Hrel; [<span class="bp">by</span> <span class="nb">apply</span> apply_plan_last_valid; itauto |].</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>message, index</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>EqDecision0</var><span class="hyp-type"><b>: </b><span>EqDecision index</span></span></span><br><span><var>IM</var><span class="hyp-type"><b>: </b><span>index ‚Üí VLSM message</span></span></span><br><span><var>Free</var><span><span class="hyp-body"><b>:= </b><span>free_composite_vlsm IM</span></span><span class="hyp-type"><b>: </b><span>VLSM message</span></span></span></span><br><span><var>s, s'</var><span class="hyp-type"><b>: </b><span>composite_state IM</span></span></span><br><span><var>Hprs'</var><span class="hyp-type"><b>: </b><span>valid_state_prop Free s&#39;</span></span></span><br><span><var>x</var><span class="hyp-type"><b>: </b><span>plan_item</span></span></span><br><span><var>a</var><span class="hyp-type"><b>: </b><span>list plan_item</span></span></span><br><span><var>a_indices</var><span><span class="hyp-body"><b>:= </b><span>List.map projT1
  (List.map label_a (a ++ [x]))</span></span><span class="hyp-type"><b>: </b><span>list index</span></span></span></span><br><span><var>li</var><span class="hyp-type"><b>: </b><span>list index</span></span></span><br><span><var>Heq</var><span class="hyp-type"><b>: </b><span><span class="kr">‚àÄ</span> <span class="nv">i</span> : index, i ‚àà li ‚Üí s&#39; i = s i</span></span></span><br><span><var>Hincl</var><span class="hyp-type"><b>: </b><span>a_indices ‚äÜ li</span></span></span><br><span><var>Hrem</var><span class="hyp-type"><b>: </b><span>finite_valid_plan_from Free s a</span></span></span><br><span><var>Hsingle</var><span class="hyp-type"><b>: </b><span>finite_valid_plan_from Free
  (apply_plan Free s a).<span class="mi">2</span> [x]</span></span></span><br><span><var>IHapr</var><span class="hyp-type"><b>: </b><span>finite_valid_plan_from Free s&#39; a</span></span></span><br><span><var>IHaind</var><span class="hyp-type"><b>: </b><span><span class="kr">‚àÄ</span> <span class="nv">i</span> : index,
  i ‚àà li
  ‚Üí (apply_plan Free s&#39; a).<span class="mi">2</span> i =
    (apply_plan Free s a).<span class="mi">2</span> i</span></span></span><br><span><var>Hrel</var><span class="hyp-type"><b>: </b><span><span class="kr">‚àÄ</span> <span class="nv">ai</span> : plan_item,
  <span class="kr">let</span> <span class="nv">i</span> := projT1 (label_a ai) <span class="kr">in</span>
  (apply_plan Free s a).<span class="mi">2</span> i =
  (apply_plan Free s&#39; a).<span class="mi">2</span> i
  ‚Üí finite_valid_plan_from Free
      (apply_plan Free s a).<span class="mi">2</span> [ai]
    ‚Üí <span class="kr">let</span> <span class="nv">res&#39;</span> :=
        (apply_plan Free
           (apply_plan Free s&#39; a).<span class="mi">2</span> [ai]).<span class="mi">2</span> <span class="kr">in</span>
      <span class="kr">let</span> <span class="nv">res</span> :=
        (apply_plan Free
           (apply_plan Free s a).<span class="mi">2</span> [ai]).<span class="mi">2</span> <span class="kr">in</span>
      finite_valid_plan_from Free
        (apply_plan Free s&#39; a).<span class="mi">2</span> [ai]
      ‚àß res&#39; i = res i</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">finite_valid_plan_from Free s&#39; (a ++ [x])
‚àß (<span class="kr">‚àÄ</span> <span class="nv">i</span> : index,
     i ‚àà li
     ‚Üí (apply_plan Free s&#39; (a ++ [x])).<span class="mi">2</span> i =
       (apply_plan Free s (a ++ [x])).<span class="mi">2</span> i)</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="Composition-v-chk18a" style="display: none" type="checkbox"><label class="alectryon-input" for="Composition-v-chk18a"><span class="nb">specialize</span> (Hrel x); <span class="nb">simpl</span> <span class="kr">in</span> *.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>message, index</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>EqDecision0</var><span class="hyp-type"><b>: </b><span>EqDecision index</span></span></span><br><span><var>IM</var><span class="hyp-type"><b>: </b><span>index ‚Üí VLSM message</span></span></span><br><span><var>Free</var><span><span class="hyp-body"><b>:= </b><span>free_composite_vlsm IM</span></span><span class="hyp-type"><b>: </b><span>VLSM message</span></span></span></span><br><span><var>s, s'</var><span class="hyp-type"><b>: </b><span>composite_state IM</span></span></span><br><span><var>Hprs'</var><span class="hyp-type"><b>: </b><span>valid_state_prop Free s&#39;</span></span></span><br><span><var>x</var><span class="hyp-type"><b>: </b><span>plan_item</span></span></span><br><span><var>a</var><span class="hyp-type"><b>: </b><span>list plan_item</span></span></span><br><span><var>a_indices</var><span><span class="hyp-body"><b>:= </b><span>List.map projT1
  (List.map label_a (a ++ [x]))</span></span><span class="hyp-type"><b>: </b><span>list index</span></span></span></span><br><span><var>li</var><span class="hyp-type"><b>: </b><span>list index</span></span></span><br><span><var>Heq</var><span class="hyp-type"><b>: </b><span><span class="kr">‚àÄ</span> <span class="nv">i</span> : index, i ‚àà li ‚Üí s&#39; i = s i</span></span></span><br><span><var>Hincl</var><span class="hyp-type"><b>: </b><span>a_indices ‚äÜ li</span></span></span><br><span><var>Hrem</var><span class="hyp-type"><b>: </b><span>finite_valid_plan_from Free s a</span></span></span><br><span><var>Hsingle</var><span class="hyp-type"><b>: </b><span>finite_valid_plan_from Free
  (apply_plan Free s a).<span class="mi">2</span> [x]</span></span></span><br><span><var>IHapr</var><span class="hyp-type"><b>: </b><span>finite_valid_plan_from Free s&#39; a</span></span></span><br><span><var>IHaind</var><span class="hyp-type"><b>: </b><span><span class="kr">‚àÄ</span> <span class="nv">i</span> : index,
  i ‚àà li
  ‚Üí (apply_plan Free s&#39; a).<span class="mi">2</span> i =
    (apply_plan Free s a).<span class="mi">2</span> i</span></span></span><br><span><var>Hrel</var><span class="hyp-type"><b>: </b><span>(apply_plan Free s a).<span class="mi">2</span> (projT1 (label_a x)) =
(apply_plan Free s&#39; a).<span class="mi">2</span> (projT1 (label_a x))
‚Üí finite_valid_plan_from Free
    (apply_plan Free s a).<span class="mi">2</span> [x]
  ‚Üí finite_valid_plan_from Free
      (apply_plan Free s&#39; a).<span class="mi">2</span> [x]
    ‚àß (apply_plan Free 
         (apply_plan Free s&#39; a).<span class="mi">2</span> [x]).<span class="mi">2</span>
        (projT1 (label_a x)) =
      (apply_plan Free 
         (apply_plan Free s a).<span class="mi">2</span> [x]).<span class="mi">2</span>
        (projT1 (label_a x))</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">finite_valid_plan_from Free s&#39; (a ++ [x])
‚àß (<span class="kr">‚àÄ</span> <span class="nv">i</span> : index,
     i ‚àà li
     ‚Üí (apply_plan Free s&#39; (a ++ [x])).<span class="mi">2</span> i =
       (apply_plan Free s (a ++ [x])).<span class="mi">2</span> i)</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="Composition-v-chk18b" style="display: none" type="checkbox"><label class="alectryon-input" for="Composition-v-chk18b">spec Hrel.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>message, index</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>EqDecision0</var><span class="hyp-type"><b>: </b><span>EqDecision index</span></span></span><br><span><var>IM</var><span class="hyp-type"><b>: </b><span>index ‚Üí VLSM message</span></span></span><br><span><var>Free</var><span><span class="hyp-body"><b>:= </b><span>free_composite_vlsm IM</span></span><span class="hyp-type"><b>: </b><span>VLSM message</span></span></span></span><br><span><var>s, s'</var><span class="hyp-type"><b>: </b><span>composite_state IM</span></span></span><br><span><var>Hprs'</var><span class="hyp-type"><b>: </b><span>valid_state_prop Free s&#39;</span></span></span><br><span><var>x</var><span class="hyp-type"><b>: </b><span>plan_item</span></span></span><br><span><var>a</var><span class="hyp-type"><b>: </b><span>list plan_item</span></span></span><br><span><var>a_indices</var><span><span class="hyp-body"><b>:= </b><span>List.map projT1
  (List.map label_a (a ++ [x]))</span></span><span class="hyp-type"><b>: </b><span>list index</span></span></span></span><br><span><var>li</var><span class="hyp-type"><b>: </b><span>list index</span></span></span><br><span><var>Heq</var><span class="hyp-type"><b>: </b><span><span class="kr">‚àÄ</span> <span class="nv">i</span> : index, i ‚àà li ‚Üí s&#39; i = s i</span></span></span><br><span><var>Hincl</var><span class="hyp-type"><b>: </b><span>a_indices ‚äÜ li</span></span></span><br><span><var>Hrem</var><span class="hyp-type"><b>: </b><span>finite_valid_plan_from Free s a</span></span></span><br><span><var>Hsingle</var><span class="hyp-type"><b>: </b><span>finite_valid_plan_from Free
  (apply_plan Free s a).<span class="mi">2</span> [x]</span></span></span><br><span><var>IHapr</var><span class="hyp-type"><b>: </b><span>finite_valid_plan_from Free s&#39; a</span></span></span><br><span><var>IHaind</var><span class="hyp-type"><b>: </b><span><span class="kr">‚àÄ</span> <span class="nv">i</span> : index,
  i ‚àà li
  ‚Üí (apply_plan Free s&#39; a).<span class="mi">2</span> i =
    (apply_plan Free s a).<span class="mi">2</span> i</span></span></span><br><span><var>Hrel</var><span class="hyp-type"><b>: </b><span>(apply_plan Free s a).<span class="mi">2</span> (projT1 (label_a x)) =
(apply_plan Free s&#39; a).<span class="mi">2</span> (projT1 (label_a x))
‚Üí finite_valid_plan_from Free
    (apply_plan Free s a).<span class="mi">2</span> [x]
  ‚Üí finite_valid_plan_from Free
      (apply_plan Free s&#39; a).<span class="mi">2</span> [x]
    ‚àß (apply_plan Free 
         (apply_plan Free s&#39; a).<span class="mi">2</span> [x]).<span class="mi">2</span>
        (projT1 (label_a x)) =
      (apply_plan Free 
         (apply_plan Free s a).<span class="mi">2</span> [x]).<span class="mi">2</span>
        (projT1 (label_a x))</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">(apply_plan Free s a).<span class="mi">2</span> (projT1 (label_a x)) =
(apply_plan Free s&#39; a).<span class="mi">2</span> (projT1 (label_a x))</div></blockquote><div class="alectryon-extra-goals"><input class="alectryon-extra-goal-toggle" id="Composition-v-chk18c" style="display: none" type="checkbox"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>message, index</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>EqDecision0</var><span class="hyp-type"><b>: </b><span>EqDecision index</span></span></span><br><span><var>IM</var><span class="hyp-type"><b>: </b><span>index ‚Üí VLSM message</span></span></span><br><span><var>Free</var><span><span class="hyp-body"><b>:= </b><span>free_composite_vlsm IM</span></span><span class="hyp-type"><b>: </b><span>VLSM message</span></span></span></span><br><span><var>s, s'</var><span class="hyp-type"><b>: </b><span>composite_state IM</span></span></span><br><span><var>Hprs'</var><span class="hyp-type"><b>: </b><span>valid_state_prop Free s&#39;</span></span></span><br><span><var>x</var><span class="hyp-type"><b>: </b><span>plan_item</span></span></span><br><span><var>a</var><span class="hyp-type"><b>: </b><span>list plan_item</span></span></span><br><span><var>a_indices</var><span><span class="hyp-body"><b>:= </b><span>List.map projT1
  (List.map label_a (a ++ [x]))</span></span><span class="hyp-type"><b>: </b><span>list index</span></span></span></span><br><span><var>li</var><span class="hyp-type"><b>: </b><span>list index</span></span></span><br><span><var>Heq</var><span class="hyp-type"><b>: </b><span><span class="kr">‚àÄ</span> <span class="nv">i</span> : index, i ‚àà li ‚Üí s&#39; i = s i</span></span></span><br><span><var>Hincl</var><span class="hyp-type"><b>: </b><span>a_indices ‚äÜ li</span></span></span><br><span><var>Hrem</var><span class="hyp-type"><b>: </b><span>finite_valid_plan_from Free s a</span></span></span><br><span><var>Hsingle</var><span class="hyp-type"><b>: </b><span>finite_valid_plan_from Free
  (apply_plan Free s a).<span class="mi">2</span> [x]</span></span></span><br><span><var>IHapr</var><span class="hyp-type"><b>: </b><span>finite_valid_plan_from Free s&#39; a</span></span></span><br><span><var>IHaind</var><span class="hyp-type"><b>: </b><span><span class="kr">‚àÄ</span> <span class="nv">i</span> : index,
  i ‚àà li
  ‚Üí (apply_plan Free s&#39; a).<span class="mi">2</span> i =
    (apply_plan Free s a).<span class="mi">2</span> i</span></span></span><br><span><var>Hrel</var><span class="hyp-type"><b>: </b><span>finite_valid_plan_from Free
  (apply_plan Free s a).<span class="mi">2</span> [x]
‚Üí finite_valid_plan_from Free
    (apply_plan Free s&#39; a).<span class="mi">2</span> [x]
  ‚àß (apply_plan Free (apply_plan Free s&#39; a).<span class="mi">2</span>
       [x]).<span class="mi">2</span> (projT1 (label_a x)) =
    (apply_plan Free (apply_plan Free s a).<span class="mi">2</span>
       [x]).<span class="mi">2</span> (projT1 (label_a x))</span></span></span><br></div><label class="goal-separator" for="Composition-v-chk18c"><hr></label><div class="goal-conclusion">finite_valid_plan_from Free s&#39; (a ++ [x])
‚àß (<span class="kr">‚àÄ</span> <span class="nv">i</span> : index,
     i ‚àà li
     ‚Üí (apply_plan Free s&#39; (a ++ [x])).<span class="mi">2</span> i =
       (apply_plan Free s (a ++ [x])).<span class="mi">2</span> i)</div></blockquote></div></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="Composition-v-chk18d" style="display: none" type="checkbox"><label class="alectryon-input" for="Composition-v-chk18d">{</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>message, index</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>EqDecision0</var><span class="hyp-type"><b>: </b><span>EqDecision index</span></span></span><br><span><var>IM</var><span class="hyp-type"><b>: </b><span>index ‚Üí VLSM message</span></span></span><br><span><var>Free</var><span><span class="hyp-body"><b>:= </b><span>free_composite_vlsm IM</span></span><span class="hyp-type"><b>: </b><span>VLSM message</span></span></span></span><br><span><var>s, s'</var><span class="hyp-type"><b>: </b><span>composite_state IM</span></span></span><br><span><var>Hprs'</var><span class="hyp-type"><b>: </b><span>valid_state_prop Free s&#39;</span></span></span><br><span><var>x</var><span class="hyp-type"><b>: </b><span>plan_item</span></span></span><br><span><var>a</var><span class="hyp-type"><b>: </b><span>list plan_item</span></span></span><br><span><var>a_indices</var><span><span class="hyp-body"><b>:= </b><span>List.map projT1
  (List.map label_a (a ++ [x]))</span></span><span class="hyp-type"><b>: </b><span>list index</span></span></span></span><br><span><var>li</var><span class="hyp-type"><b>: </b><span>list index</span></span></span><br><span><var>Heq</var><span class="hyp-type"><b>: </b><span><span class="kr">‚àÄ</span> <span class="nv">i</span> : index, i ‚àà li ‚Üí s&#39; i = s i</span></span></span><br><span><var>Hincl</var><span class="hyp-type"><b>: </b><span>a_indices ‚äÜ li</span></span></span><br><span><var>Hrem</var><span class="hyp-type"><b>: </b><span>finite_valid_plan_from Free s a</span></span></span><br><span><var>Hsingle</var><span class="hyp-type"><b>: </b><span>finite_valid_plan_from Free
  (apply_plan Free s a).<span class="mi">2</span> [x]</span></span></span><br><span><var>IHapr</var><span class="hyp-type"><b>: </b><span>finite_valid_plan_from Free s&#39; a</span></span></span><br><span><var>IHaind</var><span class="hyp-type"><b>: </b><span><span class="kr">‚àÄ</span> <span class="nv">i</span> : index,
  i ‚àà li
  ‚Üí (apply_plan Free s&#39; a).<span class="mi">2</span> i =
    (apply_plan Free s a).<span class="mi">2</span> i</span></span></span><br><span><var>Hrel</var><span class="hyp-type"><b>: </b><span>(apply_plan Free s a).<span class="mi">2</span> (projT1 (label_a x)) =
(apply_plan Free s&#39; a).<span class="mi">2</span> (projT1 (label_a x))
‚Üí finite_valid_plan_from Free
    (apply_plan Free s a).<span class="mi">2</span> [x]
  ‚Üí finite_valid_plan_from Free
      (apply_plan Free s&#39; a).<span class="mi">2</span> [x]
    ‚àß (apply_plan Free 
         (apply_plan Free s&#39; a).<span class="mi">2</span> [x]).<span class="mi">2</span>
        (projT1 (label_a x)) =
      (apply_plan Free 
         (apply_plan Free s a).<span class="mi">2</span> [x]).<span class="mi">2</span>
        (projT1 (label_a x))</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">(apply_plan Free s a).<span class="mi">2</span> (projT1 (label_a x)) =
(apply_plan Free s&#39; a).<span class="mi">2</span> (projT1 (label_a x))</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="Composition-v-chk18e" style="display: none" type="checkbox"><label class="alectryon-input" for="Composition-v-chk18e"><span class="nb">specialize</span> (IHaind (projT1 (label_a x))).</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>message, index</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>EqDecision0</var><span class="hyp-type"><b>: </b><span>EqDecision index</span></span></span><br><span><var>IM</var><span class="hyp-type"><b>: </b><span>index ‚Üí VLSM message</span></span></span><br><span><var>Free</var><span><span class="hyp-body"><b>:= </b><span>free_composite_vlsm IM</span></span><span class="hyp-type"><b>: </b><span>VLSM message</span></span></span></span><br><span><var>s, s'</var><span class="hyp-type"><b>: </b><span>composite_state IM</span></span></span><br><span><var>Hprs'</var><span class="hyp-type"><b>: </b><span>valid_state_prop Free s&#39;</span></span></span><br><span><var>x</var><span class="hyp-type"><b>: </b><span>plan_item</span></span></span><br><span><var>a</var><span class="hyp-type"><b>: </b><span>list plan_item</span></span></span><br><span><var>a_indices</var><span><span class="hyp-body"><b>:= </b><span>List.map projT1
  (List.map label_a (a ++ [x]))</span></span><span class="hyp-type"><b>: </b><span>list index</span></span></span></span><br><span><var>li</var><span class="hyp-type"><b>: </b><span>list index</span></span></span><br><span><var>Heq</var><span class="hyp-type"><b>: </b><span><span class="kr">‚àÄ</span> <span class="nv">i</span> : index, i ‚àà li ‚Üí s&#39; i = s i</span></span></span><br><span><var>Hincl</var><span class="hyp-type"><b>: </b><span>a_indices ‚äÜ li</span></span></span><br><span><var>Hrem</var><span class="hyp-type"><b>: </b><span>finite_valid_plan_from Free s a</span></span></span><br><span><var>Hsingle</var><span class="hyp-type"><b>: </b><span>finite_valid_plan_from Free
  (apply_plan Free s a).<span class="mi">2</span> [x]</span></span></span><br><span><var>IHapr</var><span class="hyp-type"><b>: </b><span>finite_valid_plan_from Free s&#39; a</span></span></span><br><span><var>IHaind</var><span class="hyp-type"><b>: </b><span>projT1 (label_a x) ‚àà li
‚Üí (apply_plan Free s&#39; a).<span class="mi">2</span>
    (projT1 (label_a x)) =
  (apply_plan Free s a).<span class="mi">2</span>
    (projT1 (label_a x))</span></span></span><br><span><var>Hrel</var><span class="hyp-type"><b>: </b><span>(apply_plan Free s a).<span class="mi">2</span> (projT1 (label_a x)) =
(apply_plan Free s&#39; a).<span class="mi">2</span> (projT1 (label_a x))
‚Üí finite_valid_plan_from Free
    (apply_plan Free s a).<span class="mi">2</span> [x]
  ‚Üí finite_valid_plan_from Free
      (apply_plan Free s&#39; a).<span class="mi">2</span> [x]
    ‚àß (apply_plan Free 
         (apply_plan Free s&#39; a).<span class="mi">2</span> [x]).<span class="mi">2</span>
        (projT1 (label_a x)) =
      (apply_plan Free 
         (apply_plan Free s a).<span class="mi">2</span> [x]).<span class="mi">2</span>
        (projT1 (label_a x))</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">(apply_plan Free s a).<span class="mi">2</span> (projT1 (label_a x)) =
(apply_plan Free s&#39; a).<span class="mi">2</span> (projT1 (label_a x))</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="Composition-v-chk18f" style="display: none" type="checkbox"><label class="alectryon-input" for="Composition-v-chk18f"><span class="nb">symmetry</span>.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>message, index</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>EqDecision0</var><span class="hyp-type"><b>: </b><span>EqDecision index</span></span></span><br><span><var>IM</var><span class="hyp-type"><b>: </b><span>index ‚Üí VLSM message</span></span></span><br><span><var>Free</var><span><span class="hyp-body"><b>:= </b><span>free_composite_vlsm IM</span></span><span class="hyp-type"><b>: </b><span>VLSM message</span></span></span></span><br><span><var>s, s'</var><span class="hyp-type"><b>: </b><span>composite_state IM</span></span></span><br><span><var>Hprs'</var><span class="hyp-type"><b>: </b><span>valid_state_prop Free s&#39;</span></span></span><br><span><var>x</var><span class="hyp-type"><b>: </b><span>plan_item</span></span></span><br><span><var>a</var><span class="hyp-type"><b>: </b><span>list plan_item</span></span></span><br><span><var>a_indices</var><span><span class="hyp-body"><b>:= </b><span>List.map projT1
  (List.map label_a (a ++ [x]))</span></span><span class="hyp-type"><b>: </b><span>list index</span></span></span></span><br><span><var>li</var><span class="hyp-type"><b>: </b><span>list index</span></span></span><br><span><var>Heq</var><span class="hyp-type"><b>: </b><span><span class="kr">‚àÄ</span> <span class="nv">i</span> : index, i ‚àà li ‚Üí s&#39; i = s i</span></span></span><br><span><var>Hincl</var><span class="hyp-type"><b>: </b><span>a_indices ‚äÜ li</span></span></span><br><span><var>Hrem</var><span class="hyp-type"><b>: </b><span>finite_valid_plan_from Free s a</span></span></span><br><span><var>Hsingle</var><span class="hyp-type"><b>: </b><span>finite_valid_plan_from Free
  (apply_plan Free s a).<span class="mi">2</span> [x]</span></span></span><br><span><var>IHapr</var><span class="hyp-type"><b>: </b><span>finite_valid_plan_from Free s&#39; a</span></span></span><br><span><var>IHaind</var><span class="hyp-type"><b>: </b><span>projT1 (label_a x) ‚àà li
‚Üí (apply_plan Free s&#39; a).<span class="mi">2</span>
    (projT1 (label_a x)) =
  (apply_plan Free s a).<span class="mi">2</span>
    (projT1 (label_a x))</span></span></span><br><span><var>Hrel</var><span class="hyp-type"><b>: </b><span>(apply_plan Free s a).<span class="mi">2</span> (projT1 (label_a x)) =
(apply_plan Free s&#39; a).<span class="mi">2</span> (projT1 (label_a x))
‚Üí finite_valid_plan_from Free
    (apply_plan Free s a).<span class="mi">2</span> [x]
  ‚Üí finite_valid_plan_from Free
      (apply_plan Free s&#39; a).<span class="mi">2</span> [x]
    ‚àß (apply_plan Free 
         (apply_plan Free s&#39; a).<span class="mi">2</span> [x]).<span class="mi">2</span>
        (projT1 (label_a x)) =
      (apply_plan Free 
         (apply_plan Free s a).<span class="mi">2</span> [x]).<span class="mi">2</span>
        (projT1 (label_a x))</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">(apply_plan Free s&#39; a).<span class="mi">2</span> (projT1 (label_a x)) =
(apply_plan Free s a).<span class="mi">2</span> (projT1 (label_a x))</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="Composition-v-chk190" style="display: none" type="checkbox"><label class="alectryon-input" for="Composition-v-chk190"><span class="nb">apply</span> IHaind.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>message, index</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>EqDecision0</var><span class="hyp-type"><b>: </b><span>EqDecision index</span></span></span><br><span><var>IM</var><span class="hyp-type"><b>: </b><span>index ‚Üí VLSM message</span></span></span><br><span><var>Free</var><span><span class="hyp-body"><b>:= </b><span>free_composite_vlsm IM</span></span><span class="hyp-type"><b>: </b><span>VLSM message</span></span></span></span><br><span><var>s, s'</var><span class="hyp-type"><b>: </b><span>composite_state IM</span></span></span><br><span><var>Hprs'</var><span class="hyp-type"><b>: </b><span>valid_state_prop Free s&#39;</span></span></span><br><span><var>x</var><span class="hyp-type"><b>: </b><span>plan_item</span></span></span><br><span><var>a</var><span class="hyp-type"><b>: </b><span>list plan_item</span></span></span><br><span><var>a_indices</var><span><span class="hyp-body"><b>:= </b><span>List.map projT1
  (List.map label_a (a ++ [x]))</span></span><span class="hyp-type"><b>: </b><span>list index</span></span></span></span><br><span><var>li</var><span class="hyp-type"><b>: </b><span>list index</span></span></span><br><span><var>Heq</var><span class="hyp-type"><b>: </b><span><span class="kr">‚àÄ</span> <span class="nv">i</span> : index, i ‚àà li ‚Üí s&#39; i = s i</span></span></span><br><span><var>Hincl</var><span class="hyp-type"><b>: </b><span>a_indices ‚äÜ li</span></span></span><br><span><var>Hrem</var><span class="hyp-type"><b>: </b><span>finite_valid_plan_from Free s a</span></span></span><br><span><var>Hsingle</var><span class="hyp-type"><b>: </b><span>finite_valid_plan_from Free
  (apply_plan Free s a).<span class="mi">2</span> [x]</span></span></span><br><span><var>IHapr</var><span class="hyp-type"><b>: </b><span>finite_valid_plan_from Free s&#39; a</span></span></span><br><span><var>IHaind</var><span class="hyp-type"><b>: </b><span>projT1 (label_a x) ‚àà li
‚Üí (apply_plan Free s&#39; a).<span class="mi">2</span>
    (projT1 (label_a x)) =
  (apply_plan Free s a).<span class="mi">2</span>
    (projT1 (label_a x))</span></span></span><br><span><var>Hrel</var><span class="hyp-type"><b>: </b><span>(apply_plan Free s a).<span class="mi">2</span> (projT1 (label_a x)) =
(apply_plan Free s&#39; a).<span class="mi">2</span> (projT1 (label_a x))
‚Üí finite_valid_plan_from Free
    (apply_plan Free s a).<span class="mi">2</span> [x]
  ‚Üí finite_valid_plan_from Free
      (apply_plan Free s&#39; a).<span class="mi">2</span> [x]
    ‚àß (apply_plan Free 
         (apply_plan Free s&#39; a).<span class="mi">2</span> [x]).<span class="mi">2</span>
        (projT1 (label_a x)) =
      (apply_plan Free 
         (apply_plan Free s a).<span class="mi">2</span> [x]).<span class="mi">2</span>
        (projT1 (label_a x))</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">projT1 (label_a x) ‚àà li</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="Composition-v-chk191" style="display: none" type="checkbox"><label class="alectryon-input" for="Composition-v-chk191"><span class="nb">specialize</span> (Hincl (projT1 (label_a x))).</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>message, index</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>EqDecision0</var><span class="hyp-type"><b>: </b><span>EqDecision index</span></span></span><br><span><var>IM</var><span class="hyp-type"><b>: </b><span>index ‚Üí VLSM message</span></span></span><br><span><var>Free</var><span><span class="hyp-body"><b>:= </b><span>free_composite_vlsm IM</span></span><span class="hyp-type"><b>: </b><span>VLSM message</span></span></span></span><br><span><var>s, s'</var><span class="hyp-type"><b>: </b><span>composite_state IM</span></span></span><br><span><var>Hprs'</var><span class="hyp-type"><b>: </b><span>valid_state_prop Free s&#39;</span></span></span><br><span><var>x</var><span class="hyp-type"><b>: </b><span>plan_item</span></span></span><br><span><var>a</var><span class="hyp-type"><b>: </b><span>list plan_item</span></span></span><br><span><var>a_indices</var><span><span class="hyp-body"><b>:= </b><span>List.map projT1
  (List.map label_a (a ++ [x]))</span></span><span class="hyp-type"><b>: </b><span>list index</span></span></span></span><br><span><var>li</var><span class="hyp-type"><b>: </b><span>list index</span></span></span><br><span><var>Heq</var><span class="hyp-type"><b>: </b><span><span class="kr">‚àÄ</span> <span class="nv">i</span> : index, i ‚àà li ‚Üí s&#39; i = s i</span></span></span><br><span><var>Hincl</var><span class="hyp-type"><b>: </b><span>projT1 (label_a x) ‚àà a_indices
‚Üí projT1 (label_a x) ‚àà li</span></span></span><br><span><var>Hrem</var><span class="hyp-type"><b>: </b><span>finite_valid_plan_from Free s a</span></span></span><br><span><var>Hsingle</var><span class="hyp-type"><b>: </b><span>finite_valid_plan_from Free
  (apply_plan Free s a).<span class="mi">2</span> [x]</span></span></span><br><span><var>IHapr</var><span class="hyp-type"><b>: </b><span>finite_valid_plan_from Free s&#39; a</span></span></span><br><span><var>IHaind</var><span class="hyp-type"><b>: </b><span>projT1 (label_a x) ‚àà li
‚Üí (apply_plan Free s&#39; a).<span class="mi">2</span>
    (projT1 (label_a x)) =
  (apply_plan Free s a).<span class="mi">2</span>
    (projT1 (label_a x))</span></span></span><br><span><var>Hrel</var><span class="hyp-type"><b>: </b><span>(apply_plan Free s a).<span class="mi">2</span> (projT1 (label_a x)) =
(apply_plan Free s&#39; a).<span class="mi">2</span> (projT1 (label_a x))
‚Üí finite_valid_plan_from Free
    (apply_plan Free s a).<span class="mi">2</span> [x]
  ‚Üí finite_valid_plan_from Free
      (apply_plan Free s&#39; a).<span class="mi">2</span> [x]
    ‚àß (apply_plan Free 
         (apply_plan Free s&#39; a).<span class="mi">2</span> [x]).<span class="mi">2</span>
        (projT1 (label_a x)) =
      (apply_plan Free 
         (apply_plan Free s a).<span class="mi">2</span> [x]).<span class="mi">2</span>
        (projT1 (label_a x))</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">projT1 (label_a x) ‚àà li</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="Composition-v-chk192" style="display: none" type="checkbox"><label class="alectryon-input" for="Composition-v-chk192"><span class="nb">apply</span> Hincl.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>message, index</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>EqDecision0</var><span class="hyp-type"><b>: </b><span>EqDecision index</span></span></span><br><span><var>IM</var><span class="hyp-type"><b>: </b><span>index ‚Üí VLSM message</span></span></span><br><span><var>Free</var><span><span class="hyp-body"><b>:= </b><span>free_composite_vlsm IM</span></span><span class="hyp-type"><b>: </b><span>VLSM message</span></span></span></span><br><span><var>s, s'</var><span class="hyp-type"><b>: </b><span>composite_state IM</span></span></span><br><span><var>Hprs'</var><span class="hyp-type"><b>: </b><span>valid_state_prop Free s&#39;</span></span></span><br><span><var>x</var><span class="hyp-type"><b>: </b><span>plan_item</span></span></span><br><span><var>a</var><span class="hyp-type"><b>: </b><span>list plan_item</span></span></span><br><span><var>a_indices</var><span><span class="hyp-body"><b>:= </b><span>List.map projT1
  (List.map label_a (a ++ [x]))</span></span><span class="hyp-type"><b>: </b><span>list index</span></span></span></span><br><span><var>li</var><span class="hyp-type"><b>: </b><span>list index</span></span></span><br><span><var>Heq</var><span class="hyp-type"><b>: </b><span><span class="kr">‚àÄ</span> <span class="nv">i</span> : index, i ‚àà li ‚Üí s&#39; i = s i</span></span></span><br><span><var>Hincl</var><span class="hyp-type"><b>: </b><span>projT1 (label_a x) ‚àà a_indices
‚Üí projT1 (label_a x) ‚àà li</span></span></span><br><span><var>Hrem</var><span class="hyp-type"><b>: </b><span>finite_valid_plan_from Free s a</span></span></span><br><span><var>Hsingle</var><span class="hyp-type"><b>: </b><span>finite_valid_plan_from Free
  (apply_plan Free s a).<span class="mi">2</span> [x]</span></span></span><br><span><var>IHapr</var><span class="hyp-type"><b>: </b><span>finite_valid_plan_from Free s&#39; a</span></span></span><br><span><var>IHaind</var><span class="hyp-type"><b>: </b><span>projT1 (label_a x) ‚àà li
‚Üí (apply_plan Free s&#39; a).<span class="mi">2</span>
    (projT1 (label_a x)) =
  (apply_plan Free s a).<span class="mi">2</span>
    (projT1 (label_a x))</span></span></span><br><span><var>Hrel</var><span class="hyp-type"><b>: </b><span>(apply_plan Free s a).<span class="mi">2</span> (projT1 (label_a x)) =
(apply_plan Free s&#39; a).<span class="mi">2</span> (projT1 (label_a x))
‚Üí finite_valid_plan_from Free
    (apply_plan Free s a).<span class="mi">2</span> [x]
  ‚Üí finite_valid_plan_from Free
      (apply_plan Free s&#39; a).<span class="mi">2</span> [x]
    ‚àß (apply_plan Free 
         (apply_plan Free s&#39; a).<span class="mi">2</span> [x]).<span class="mi">2</span>
        (projT1 (label_a x)) =
      (apply_plan Free 
         (apply_plan Free s a).<span class="mi">2</span> [x]).<span class="mi">2</span>
        (projT1 (label_a x))</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">projT1 (label_a x) ‚àà a_indices</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="Composition-v-chk193" style="display: none" type="checkbox"><label class="alectryon-input" for="Composition-v-chk193"><span class="nb">unfold</span> a_indices.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>message, index</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>EqDecision0</var><span class="hyp-type"><b>: </b><span>EqDecision index</span></span></span><br><span><var>IM</var><span class="hyp-type"><b>: </b><span>index ‚Üí VLSM message</span></span></span><br><span><var>Free</var><span><span class="hyp-body"><b>:= </b><span>free_composite_vlsm IM</span></span><span class="hyp-type"><b>: </b><span>VLSM message</span></span></span></span><br><span><var>s, s'</var><span class="hyp-type"><b>: </b><span>composite_state IM</span></span></span><br><span><var>Hprs'</var><span class="hyp-type"><b>: </b><span>valid_state_prop Free s&#39;</span></span></span><br><span><var>x</var><span class="hyp-type"><b>: </b><span>plan_item</span></span></span><br><span><var>a</var><span class="hyp-type"><b>: </b><span>list plan_item</span></span></span><br><span><var>a_indices</var><span><span class="hyp-body"><b>:= </b><span>List.map projT1
  (List.map label_a (a ++ [x]))</span></span><span class="hyp-type"><b>: </b><span>list index</span></span></span></span><br><span><var>li</var><span class="hyp-type"><b>: </b><span>list index</span></span></span><br><span><var>Heq</var><span class="hyp-type"><b>: </b><span><span class="kr">‚àÄ</span> <span class="nv">i</span> : index, i ‚àà li ‚Üí s&#39; i = s i</span></span></span><br><span><var>Hincl</var><span class="hyp-type"><b>: </b><span>projT1 (label_a x) ‚àà a_indices
‚Üí projT1 (label_a x) ‚àà li</span></span></span><br><span><var>Hrem</var><span class="hyp-type"><b>: </b><span>finite_valid_plan_from Free s a</span></span></span><br><span><var>Hsingle</var><span class="hyp-type"><b>: </b><span>finite_valid_plan_from Free
  (apply_plan Free s a).<span class="mi">2</span> [x]</span></span></span><br><span><var>IHapr</var><span class="hyp-type"><b>: </b><span>finite_valid_plan_from Free s&#39; a</span></span></span><br><span><var>IHaind</var><span class="hyp-type"><b>: </b><span>projT1 (label_a x) ‚àà li
‚Üí (apply_plan Free s&#39; a).<span class="mi">2</span>
    (projT1 (label_a x)) =
  (apply_plan Free s a).<span class="mi">2</span>
    (projT1 (label_a x))</span></span></span><br><span><var>Hrel</var><span class="hyp-type"><b>: </b><span>(apply_plan Free s a).<span class="mi">2</span> (projT1 (label_a x)) =
(apply_plan Free s&#39; a).<span class="mi">2</span> (projT1 (label_a x))
‚Üí finite_valid_plan_from Free
    (apply_plan Free s a).<span class="mi">2</span> [x]
  ‚Üí finite_valid_plan_from Free
      (apply_plan Free s&#39; a).<span class="mi">2</span> [x]
    ‚àß (apply_plan Free 
         (apply_plan Free s&#39; a).<span class="mi">2</span> [x]).<span class="mi">2</span>
        (projT1 (label_a x)) =
      (apply_plan Free 
         (apply_plan Free s a).<span class="mi">2</span> [x]).<span class="mi">2</span>
        (projT1 (label_a x))</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">projT1 (label_a x)
‚àà List.map projT1 (List.map label_a (a ++ [x]))</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><span class="alectryon-input"><span class="bp">by</span> <span class="nb">rewrite</span> <span class="mi">2</span> map_app, elem_of_app; <span class="nb">right</span>; <span class="nb">left</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="Composition-v-chk194" style="display: none" type="checkbox"><label class="alectryon-input" for="Composition-v-chk194">}</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>message, index</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>EqDecision0</var><span class="hyp-type"><b>: </b><span>EqDecision index</span></span></span><br><span><var>IM</var><span class="hyp-type"><b>: </b><span>index ‚Üí VLSM message</span></span></span><br><span><var>Free</var><span><span class="hyp-body"><b>:= </b><span>free_composite_vlsm IM</span></span><span class="hyp-type"><b>: </b><span>VLSM message</span></span></span></span><br><span><var>s, s'</var><span class="hyp-type"><b>: </b><span>composite_state IM</span></span></span><br><span><var>Hprs'</var><span class="hyp-type"><b>: </b><span>valid_state_prop Free s&#39;</span></span></span><br><span><var>x</var><span class="hyp-type"><b>: </b><span>plan_item</span></span></span><br><span><var>a</var><span class="hyp-type"><b>: </b><span>list plan_item</span></span></span><br><span><var>a_indices</var><span><span class="hyp-body"><b>:= </b><span>List.map projT1
  (List.map label_a (a ++ [x]))</span></span><span class="hyp-type"><b>: </b><span>list index</span></span></span></span><br><span><var>li</var><span class="hyp-type"><b>: </b><span>list index</span></span></span><br><span><var>Heq</var><span class="hyp-type"><b>: </b><span><span class="kr">‚àÄ</span> <span class="nv">i</span> : index, i ‚àà li ‚Üí s&#39; i = s i</span></span></span><br><span><var>Hincl</var><span class="hyp-type"><b>: </b><span>a_indices ‚äÜ li</span></span></span><br><span><var>Hrem</var><span class="hyp-type"><b>: </b><span>finite_valid_plan_from Free s a</span></span></span><br><span><var>Hsingle</var><span class="hyp-type"><b>: </b><span>finite_valid_plan_from Free
  (apply_plan Free s a).<span class="mi">2</span> [x]</span></span></span><br><span><var>IHapr</var><span class="hyp-type"><b>: </b><span>finite_valid_plan_from Free s&#39; a</span></span></span><br><span><var>IHaind</var><span class="hyp-type"><b>: </b><span><span class="kr">‚àÄ</span> <span class="nv">i</span> : index,
  i ‚àà li
  ‚Üí (apply_plan Free s&#39; a).<span class="mi">2</span> i =
    (apply_plan Free s a).<span class="mi">2</span> i</span></span></span><br><span><var>Hrel</var><span class="hyp-type"><b>: </b><span>finite_valid_plan_from Free
  (apply_plan Free s a).<span class="mi">2</span> [x]
‚Üí finite_valid_plan_from Free
    (apply_plan Free s&#39; a).<span class="mi">2</span> [x]
  ‚àß (apply_plan Free (apply_plan Free s&#39; a).<span class="mi">2</span>
       [x]).<span class="mi">2</span> (projT1 (label_a x)) =
    (apply_plan Free (apply_plan Free s a).<span class="mi">2</span>
       [x]).<span class="mi">2</span> (projT1 (label_a x))</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">finite_valid_plan_from Free s&#39; (a ++ [x])
‚àß (<span class="kr">‚àÄ</span> <span class="nv">i</span> : index,
     i ‚àà li
     ‚Üí (apply_plan Free s&#39; (a ++ [x])).<span class="mi">2</span> i =
       (apply_plan Free s (a ++ [x])).<span class="mi">2</span> i)</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="Composition-v-chk195" style="display: none" type="checkbox"><label class="alectryon-input" for="Composition-v-chk195"><span class="nb">specialize</span> (Hrel Hsingle).</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>message, index</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>EqDecision0</var><span class="hyp-type"><b>: </b><span>EqDecision index</span></span></span><br><span><var>IM</var><span class="hyp-type"><b>: </b><span>index ‚Üí VLSM message</span></span></span><br><span><var>Free</var><span><span class="hyp-body"><b>:= </b><span>free_composite_vlsm IM</span></span><span class="hyp-type"><b>: </b><span>VLSM message</span></span></span></span><br><span><var>s, s'</var><span class="hyp-type"><b>: </b><span>composite_state IM</span></span></span><br><span><var>Hprs'</var><span class="hyp-type"><b>: </b><span>valid_state_prop Free s&#39;</span></span></span><br><span><var>x</var><span class="hyp-type"><b>: </b><span>plan_item</span></span></span><br><span><var>a</var><span class="hyp-type"><b>: </b><span>list plan_item</span></span></span><br><span><var>a_indices</var><span><span class="hyp-body"><b>:= </b><span>List.map projT1
  (List.map label_a (a ++ [x]))</span></span><span class="hyp-type"><b>: </b><span>list index</span></span></span></span><br><span><var>li</var><span class="hyp-type"><b>: </b><span>list index</span></span></span><br><span><var>Heq</var><span class="hyp-type"><b>: </b><span><span class="kr">‚àÄ</span> <span class="nv">i</span> : index, i ‚àà li ‚Üí s&#39; i = s i</span></span></span><br><span><var>Hincl</var><span class="hyp-type"><b>: </b><span>a_indices ‚äÜ li</span></span></span><br><span><var>Hrem</var><span class="hyp-type"><b>: </b><span>finite_valid_plan_from Free s a</span></span></span><br><span><var>Hsingle</var><span class="hyp-type"><b>: </b><span>finite_valid_plan_from Free
  (apply_plan Free s a).<span class="mi">2</span> [x]</span></span></span><br><span><var>IHapr</var><span class="hyp-type"><b>: </b><span>finite_valid_plan_from Free s&#39; a</span></span></span><br><span><var>IHaind</var><span class="hyp-type"><b>: </b><span><span class="kr">‚àÄ</span> <span class="nv">i</span> : index,
  i ‚àà li
  ‚Üí (apply_plan Free s&#39; a).<span class="mi">2</span> i =
    (apply_plan Free s a).<span class="mi">2</span> i</span></span></span><br><span><var>Hrel</var><span class="hyp-type"><b>: </b><span>finite_valid_plan_from Free
  (apply_plan Free s&#39; a).<span class="mi">2</span> [x]
‚àß (apply_plan Free (apply_plan Free s&#39; a).<span class="mi">2</span> [x]).<span class="mi">2</span>
    (projT1 (label_a x)) =
  (apply_plan Free (apply_plan Free s a).<span class="mi">2</span> [x]).<span class="mi">2</span>
    (projT1 (label_a x))</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">finite_valid_plan_from Free s&#39; (a ++ [x])
‚àß (<span class="kr">‚àÄ</span> <span class="nv">i</span> : index,
     i ‚àà li
     ‚Üí (apply_plan Free s&#39; (a ++ [x])).<span class="mi">2</span> i =
       (apply_plan Free s (a ++ [x])).<span class="mi">2</span> i)</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="Composition-v-chk196" style="display: none" type="checkbox"><label class="alectryon-input" for="Composition-v-chk196"><span class="nb">destruct</span> Hrel <span class="kr">as</span> [Hrelpr Hrelind].</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>message, index</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>EqDecision0</var><span class="hyp-type"><b>: </b><span>EqDecision index</span></span></span><br><span><var>IM</var><span class="hyp-type"><b>: </b><span>index ‚Üí VLSM message</span></span></span><br><span><var>Free</var><span><span class="hyp-body"><b>:= </b><span>free_composite_vlsm IM</span></span><span class="hyp-type"><b>: </b><span>VLSM message</span></span></span></span><br><span><var>s, s'</var><span class="hyp-type"><b>: </b><span>composite_state IM</span></span></span><br><span><var>Hprs'</var><span class="hyp-type"><b>: </b><span>valid_state_prop Free s&#39;</span></span></span><br><span><var>x</var><span class="hyp-type"><b>: </b><span>plan_item</span></span></span><br><span><var>a</var><span class="hyp-type"><b>: </b><span>list plan_item</span></span></span><br><span><var>a_indices</var><span><span class="hyp-body"><b>:= </b><span>List.map projT1
  (List.map label_a (a ++ [x]))</span></span><span class="hyp-type"><b>: </b><span>list index</span></span></span></span><br><span><var>li</var><span class="hyp-type"><b>: </b><span>list index</span></span></span><br><span><var>Heq</var><span class="hyp-type"><b>: </b><span><span class="kr">‚àÄ</span> <span class="nv">i</span> : index, i ‚àà li ‚Üí s&#39; i = s i</span></span></span><br><span><var>Hincl</var><span class="hyp-type"><b>: </b><span>a_indices ‚äÜ li</span></span></span><br><span><var>Hrem</var><span class="hyp-type"><b>: </b><span>finite_valid_plan_from Free s a</span></span></span><br><span><var>Hsingle</var><span class="hyp-type"><b>: </b><span>finite_valid_plan_from Free
  (apply_plan Free s a).<span class="mi">2</span> [x]</span></span></span><br><span><var>IHapr</var><span class="hyp-type"><b>: </b><span>finite_valid_plan_from Free s&#39; a</span></span></span><br><span><var>IHaind</var><span class="hyp-type"><b>: </b><span><span class="kr">‚àÄ</span> <span class="nv">i</span> : index,
  i ‚àà li
  ‚Üí (apply_plan Free s&#39; a).<span class="mi">2</span> i =
    (apply_plan Free s a).<span class="mi">2</span> i</span></span></span><br><span><var>Hrelpr</var><span class="hyp-type"><b>: </b><span>finite_valid_plan_from Free
  (apply_plan Free s&#39; a).<span class="mi">2</span> [x]</span></span></span><br><span><var>Hrelind</var><span class="hyp-type"><b>: </b><span>(apply_plan Free (apply_plan Free s&#39; a).<span class="mi">2</span>
   [x]).<span class="mi">2</span> (projT1 (label_a x)) =
(apply_plan Free (apply_plan Free s a).<span class="mi">2</span> [x]).<span class="mi">2</span>
  (projT1 (label_a x))</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">finite_valid_plan_from Free s&#39; (a ++ [x])
‚àß (<span class="kr">‚àÄ</span> <span class="nv">i</span> : index,
     i ‚àà li
     ‚Üí (apply_plan Free s&#39; (a ++ [x])).<span class="mi">2</span> i =
       (apply_plan Free s (a ++ [x])).<span class="mi">2</span> i)</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="Composition-v-chk197" style="display: none" type="checkbox"><label class="alectryon-input" for="Composition-v-chk197"><span class="nb">split</span>; [<span class="bp">by</span> <span class="nb">apply</span> finite_valid_plan_from_app_iff; <span class="nb">split</span> |].</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>message, index</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>EqDecision0</var><span class="hyp-type"><b>: </b><span>EqDecision index</span></span></span><br><span><var>IM</var><span class="hyp-type"><b>: </b><span>index ‚Üí VLSM message</span></span></span><br><span><var>Free</var><span><span class="hyp-body"><b>:= </b><span>free_composite_vlsm IM</span></span><span class="hyp-type"><b>: </b><span>VLSM message</span></span></span></span><br><span><var>s, s'</var><span class="hyp-type"><b>: </b><span>composite_state IM</span></span></span><br><span><var>Hprs'</var><span class="hyp-type"><b>: </b><span>valid_state_prop Free s&#39;</span></span></span><br><span><var>x</var><span class="hyp-type"><b>: </b><span>plan_item</span></span></span><br><span><var>a</var><span class="hyp-type"><b>: </b><span>list plan_item</span></span></span><br><span><var>a_indices</var><span><span class="hyp-body"><b>:= </b><span>List.map projT1
  (List.map label_a (a ++ [x]))</span></span><span class="hyp-type"><b>: </b><span>list index</span></span></span></span><br><span><var>li</var><span class="hyp-type"><b>: </b><span>list index</span></span></span><br><span><var>Heq</var><span class="hyp-type"><b>: </b><span><span class="kr">‚àÄ</span> <span class="nv">i</span> : index, i ‚àà li ‚Üí s&#39; i = s i</span></span></span><br><span><var>Hincl</var><span class="hyp-type"><b>: </b><span>a_indices ‚äÜ li</span></span></span><br><span><var>Hrem</var><span class="hyp-type"><b>: </b><span>finite_valid_plan_from Free s a</span></span></span><br><span><var>Hsingle</var><span class="hyp-type"><b>: </b><span>finite_valid_plan_from Free
  (apply_plan Free s a).<span class="mi">2</span> [x]</span></span></span><br><span><var>IHapr</var><span class="hyp-type"><b>: </b><span>finite_valid_plan_from Free s&#39; a</span></span></span><br><span><var>IHaind</var><span class="hyp-type"><b>: </b><span><span class="kr">‚àÄ</span> <span class="nv">i</span> : index,
  i ‚àà li
  ‚Üí (apply_plan Free s&#39; a).<span class="mi">2</span> i =
    (apply_plan Free s a).<span class="mi">2</span> i</span></span></span><br><span><var>Hrelpr</var><span class="hyp-type"><b>: </b><span>finite_valid_plan_from Free
  (apply_plan Free s&#39; a).<span class="mi">2</span> [x]</span></span></span><br><span><var>Hrelind</var><span class="hyp-type"><b>: </b><span>(apply_plan Free (apply_plan Free s&#39; a).<span class="mi">2</span>
   [x]).<span class="mi">2</span> (projT1 (label_a x)) =
(apply_plan Free (apply_plan Free s a).<span class="mi">2</span> [x]).<span class="mi">2</span>
  (projT1 (label_a x))</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="kr">‚àÄ</span> <span class="nv">i</span> : index,
  i ‚àà li
  ‚Üí (apply_plan Free s&#39; (a ++ [x])).<span class="mi">2</span> i =
    (apply_plan Free s (a ++ [x])).<span class="mi">2</span> i</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="Composition-v-chk198" style="display: none" type="checkbox"><label class="alectryon-input" for="Composition-v-chk198"><span class="nb">intros</span> i Hi.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>message, index</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>EqDecision0</var><span class="hyp-type"><b>: </b><span>EqDecision index</span></span></span><br><span><var>IM</var><span class="hyp-type"><b>: </b><span>index ‚Üí VLSM message</span></span></span><br><span><var>Free</var><span><span class="hyp-body"><b>:= </b><span>free_composite_vlsm IM</span></span><span class="hyp-type"><b>: </b><span>VLSM message</span></span></span></span><br><span><var>s, s'</var><span class="hyp-type"><b>: </b><span>composite_state IM</span></span></span><br><span><var>Hprs'</var><span class="hyp-type"><b>: </b><span>valid_state_prop Free s&#39;</span></span></span><br><span><var>x</var><span class="hyp-type"><b>: </b><span>plan_item</span></span></span><br><span><var>a</var><span class="hyp-type"><b>: </b><span>list plan_item</span></span></span><br><span><var>a_indices</var><span><span class="hyp-body"><b>:= </b><span>List.map projT1
  (List.map label_a (a ++ [x]))</span></span><span class="hyp-type"><b>: </b><span>list index</span></span></span></span><br><span><var>li</var><span class="hyp-type"><b>: </b><span>list index</span></span></span><br><span><var>Heq</var><span class="hyp-type"><b>: </b><span><span class="kr">‚àÄ</span> <span class="nv">i</span> : index, i ‚àà li ‚Üí s&#39; i = s i</span></span></span><br><span><var>Hincl</var><span class="hyp-type"><b>: </b><span>a_indices ‚äÜ li</span></span></span><br><span><var>Hrem</var><span class="hyp-type"><b>: </b><span>finite_valid_plan_from Free s a</span></span></span><br><span><var>Hsingle</var><span class="hyp-type"><b>: </b><span>finite_valid_plan_from Free
  (apply_plan Free s a).<span class="mi">2</span> [x]</span></span></span><br><span><var>IHapr</var><span class="hyp-type"><b>: </b><span>finite_valid_plan_from Free s&#39; a</span></span></span><br><span><var>IHaind</var><span class="hyp-type"><b>: </b><span><span class="kr">‚àÄ</span> <span class="nv">i</span> : index,
  i ‚àà li
  ‚Üí (apply_plan Free s&#39; a).<span class="mi">2</span> i =
    (apply_plan Free s a).<span class="mi">2</span> i</span></span></span><br><span><var>Hrelpr</var><span class="hyp-type"><b>: </b><span>finite_valid_plan_from Free
  (apply_plan Free s&#39; a).<span class="mi">2</span> [x]</span></span></span><br><span><var>Hrelind</var><span class="hyp-type"><b>: </b><span>(apply_plan Free (apply_plan Free s&#39; a).<span class="mi">2</span>
   [x]).<span class="mi">2</span> (projT1 (label_a x)) =
(apply_plan Free (apply_plan Free s a).<span class="mi">2</span> [x]).<span class="mi">2</span>
  (projT1 (label_a x))</span></span></span><br><span><var>i</var><span class="hyp-type"><b>: </b><span>index</span></span></span><br><span><var>Hi</var><span class="hyp-type"><b>: </b><span>i ‚àà li</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">(apply_plan Free s&#39; (a ++ [x])).<span class="mi">2</span> i =
(apply_plan Free s (a ++ [x])).<span class="mi">2</span> i</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="Composition-v-chk199" style="display: none" type="checkbox"><label class="alectryon-input" for="Composition-v-chk199"><span class="nb">rewrite</span> !apply_plan_app.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>message, index</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>EqDecision0</var><span class="hyp-type"><b>: </b><span>EqDecision index</span></span></span><br><span><var>IM</var><span class="hyp-type"><b>: </b><span>index ‚Üí VLSM message</span></span></span><br><span><var>Free</var><span><span class="hyp-body"><b>:= </b><span>free_composite_vlsm IM</span></span><span class="hyp-type"><b>: </b><span>VLSM message</span></span></span></span><br><span><var>s, s'</var><span class="hyp-type"><b>: </b><span>composite_state IM</span></span></span><br><span><var>Hprs'</var><span class="hyp-type"><b>: </b><span>valid_state_prop Free s&#39;</span></span></span><br><span><var>x</var><span class="hyp-type"><b>: </b><span>plan_item</span></span></span><br><span><var>a</var><span class="hyp-type"><b>: </b><span>list plan_item</span></span></span><br><span><var>a_indices</var><span><span class="hyp-body"><b>:= </b><span>List.map projT1
  (List.map label_a (a ++ [x]))</span></span><span class="hyp-type"><b>: </b><span>list index</span></span></span></span><br><span><var>li</var><span class="hyp-type"><b>: </b><span>list index</span></span></span><br><span><var>Heq</var><span class="hyp-type"><b>: </b><span><span class="kr">‚àÄ</span> <span class="nv">i</span> : index, i ‚àà li ‚Üí s&#39; i = s i</span></span></span><br><span><var>Hincl</var><span class="hyp-type"><b>: </b><span>a_indices ‚äÜ li</span></span></span><br><span><var>Hrem</var><span class="hyp-type"><b>: </b><span>finite_valid_plan_from Free s a</span></span></span><br><span><var>Hsingle</var><span class="hyp-type"><b>: </b><span>finite_valid_plan_from Free
  (apply_plan Free s a).<span class="mi">2</span> [x]</span></span></span><br><span><var>IHapr</var><span class="hyp-type"><b>: </b><span>finite_valid_plan_from Free s&#39; a</span></span></span><br><span><var>IHaind</var><span class="hyp-type"><b>: </b><span><span class="kr">‚àÄ</span> <span class="nv">i</span> : index,
  i ‚àà li
  ‚Üí (apply_plan Free s&#39; a).<span class="mi">2</span> i =
    (apply_plan Free s a).<span class="mi">2</span> i</span></span></span><br><span><var>Hrelpr</var><span class="hyp-type"><b>: </b><span>finite_valid_plan_from Free
  (apply_plan Free s&#39; a).<span class="mi">2</span> [x]</span></span></span><br><span><var>Hrelind</var><span class="hyp-type"><b>: </b><span>(apply_plan Free (apply_plan Free s&#39; a).<span class="mi">2</span>
   [x]).<span class="mi">2</span> (projT1 (label_a x)) =
(apply_plan Free (apply_plan Free s a).<span class="mi">2</span> [x]).<span class="mi">2</span>
  (projT1 (label_a x))</span></span></span><br><span><var>i</var><span class="hyp-type"><b>: </b><span>index</span></span></span><br><span><var>Hi</var><span class="hyp-type"><b>: </b><span>i ‚àà li</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">(<span class="kr">let</span> (<span class="nv">aitems</span>, afinal) := apply_plan Free s&#39; a <span class="kr">in</span>
 <span class="kr">let</span> (<span class="nv">a&#39;items</span>, a&#39;final) :=
   apply_plan Free afinal [x] <span class="kr">in</span>
 (aitems ++ a&#39;items, a&#39;final)).<span class="mi">2</span> i =
(<span class="kr">let</span> (<span class="nv">aitems</span>, afinal) := apply_plan Free s a <span class="kr">in</span>
 <span class="kr">let</span> (<span class="nv">a&#39;items</span>, a&#39;final) :=
   apply_plan Free afinal [x] <span class="kr">in</span>
 (aitems ++ a&#39;items, a&#39;final)).<span class="mi">2</span> i</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="Composition-v-chk19a" style="display: none" type="checkbox"><label class="alectryon-input" for="Composition-v-chk19a"><span class="nb">destruct</span> (apply_plan Free s&#39; a) <span class="kr">as</span> [tra&#39; sa&#39;] <span class="nb">eqn</span>: eq_as&#39;.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>message, index</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>EqDecision0</var><span class="hyp-type"><b>: </b><span>EqDecision index</span></span></span><br><span><var>IM</var><span class="hyp-type"><b>: </b><span>index ‚Üí VLSM message</span></span></span><br><span><var>Free</var><span><span class="hyp-body"><b>:= </b><span>free_composite_vlsm IM</span></span><span class="hyp-type"><b>: </b><span>VLSM message</span></span></span></span><br><span><var>s, s'</var><span class="hyp-type"><b>: </b><span>composite_state IM</span></span></span><br><span><var>Hprs'</var><span class="hyp-type"><b>: </b><span>valid_state_prop Free s&#39;</span></span></span><br><span><var>x</var><span class="hyp-type"><b>: </b><span>plan_item</span></span></span><br><span><var>a</var><span class="hyp-type"><b>: </b><span>list plan_item</span></span></span><br><span><var>a_indices</var><span><span class="hyp-body"><b>:= </b><span>List.map projT1
  (List.map label_a (a ++ [x]))</span></span><span class="hyp-type"><b>: </b><span>list index</span></span></span></span><br><span><var>li</var><span class="hyp-type"><b>: </b><span>list index</span></span></span><br><span><var>Heq</var><span class="hyp-type"><b>: </b><span><span class="kr">‚àÄ</span> <span class="nv">i</span> : index, i ‚àà li ‚Üí s&#39; i = s i</span></span></span><br><span><var>Hincl</var><span class="hyp-type"><b>: </b><span>a_indices ‚äÜ li</span></span></span><br><span><var>Hrem</var><span class="hyp-type"><b>: </b><span>finite_valid_plan_from Free s a</span></span></span><br><span><var>Hsingle</var><span class="hyp-type"><b>: </b><span>finite_valid_plan_from Free
  (apply_plan Free s a).<span class="mi">2</span> [x]</span></span></span><br><span><var>IHapr</var><span class="hyp-type"><b>: </b><span>finite_valid_plan_from Free s&#39; a</span></span></span><br><span><var>tra'</var><span class="hyp-type"><b>: </b><span>list transition_item</span></span></span><br><span><var>sa'</var><span class="hyp-type"><b>: </b><span>state Free</span></span></span><br><span><var>eq_as'</var><span class="hyp-type"><b>: </b><span>apply_plan Free s&#39; a = (tra&#39;, sa&#39;)</span></span></span><br><span><var>IHaind</var><span class="hyp-type"><b>: </b><span><span class="kr">‚àÄ</span> <span class="nv">i</span> : index,
  i ‚àà li
  ‚Üí (tra&#39;, sa&#39;).<span class="mi">2</span> i =
    (apply_plan Free s a).<span class="mi">2</span> i</span></span></span><br><span><var>Hrelpr</var><span class="hyp-type"><b>: </b><span>finite_valid_plan_from Free (tra&#39;, sa&#39;).<span class="mi">2</span> [x]</span></span></span><br><span><var>Hrelind</var><span class="hyp-type"><b>: </b><span>(apply_plan Free (tra&#39;, sa&#39;).<span class="mi">2</span> [x]).<span class="mi">2</span>
  (projT1 (label_a x)) =
(apply_plan Free (apply_plan Free s a).<span class="mi">2</span> [x]).<span class="mi">2</span>
  (projT1 (label_a x))</span></span></span><br><span><var>i</var><span class="hyp-type"><b>: </b><span>index</span></span></span><br><span><var>Hi</var><span class="hyp-type"><b>: </b><span>i ‚àà li</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">(<span class="kr">let</span> (<span class="nv">a&#39;items</span>, a&#39;final) := apply_plan Free sa&#39; [x] <span class="kr">in</span>
 (tra&#39; ++ a&#39;items, a&#39;final)).<span class="mi">2</span> i =
(<span class="kr">let</span> (<span class="nv">aitems</span>, afinal) := apply_plan Free s a <span class="kr">in</span>
 <span class="kr">let</span> (<span class="nv">a&#39;items</span>, a&#39;final) :=
   apply_plan Free afinal [x] <span class="kr">in</span>
 (aitems ++ a&#39;items, a&#39;final)).<span class="mi">2</span> i</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="Composition-v-chk19b" style="display: none" type="checkbox"><label class="alectryon-input" for="Composition-v-chk19b"><span class="nb">destruct</span> (apply_plan Free s a) <span class="kr">as</span> [tra sa] <span class="nb">eqn</span>: eq_as.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>message, index</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>EqDecision0</var><span class="hyp-type"><b>: </b><span>EqDecision index</span></span></span><br><span><var>IM</var><span class="hyp-type"><b>: </b><span>index ‚Üí VLSM message</span></span></span><br><span><var>Free</var><span><span class="hyp-body"><b>:= </b><span>free_composite_vlsm IM</span></span><span class="hyp-type"><b>: </b><span>VLSM message</span></span></span></span><br><span><var>s, s'</var><span class="hyp-type"><b>: </b><span>composite_state IM</span></span></span><br><span><var>Hprs'</var><span class="hyp-type"><b>: </b><span>valid_state_prop Free s&#39;</span></span></span><br><span><var>x</var><span class="hyp-type"><b>: </b><span>plan_item</span></span></span><br><span><var>a</var><span class="hyp-type"><b>: </b><span>list plan_item</span></span></span><br><span><var>a_indices</var><span><span class="hyp-body"><b>:= </b><span>List.map projT1
  (List.map label_a (a ++ [x]))</span></span><span class="hyp-type"><b>: </b><span>list index</span></span></span></span><br><span><var>li</var><span class="hyp-type"><b>: </b><span>list index</span></span></span><br><span><var>Heq</var><span class="hyp-type"><b>: </b><span><span class="kr">‚àÄ</span> <span class="nv">i</span> : index, i ‚àà li ‚Üí s&#39; i = s i</span></span></span><br><span><var>Hincl</var><span class="hyp-type"><b>: </b><span>a_indices ‚äÜ li</span></span></span><br><span><var>Hrem</var><span class="hyp-type"><b>: </b><span>finite_valid_plan_from Free s a</span></span></span><br><span><var>tra</var><span class="hyp-type"><b>: </b><span>list transition_item</span></span></span><br><span><var>sa</var><span class="hyp-type"><b>: </b><span>state Free</span></span></span><br><span><var>eq_as</var><span class="hyp-type"><b>: </b><span>apply_plan Free s a = (tra, sa)</span></span></span><br><span><var>Hsingle</var><span class="hyp-type"><b>: </b><span>finite_valid_plan_from Free (tra, sa).<span class="mi">2</span> [x]</span></span></span><br><span><var>IHapr</var><span class="hyp-type"><b>: </b><span>finite_valid_plan_from Free s&#39; a</span></span></span><br><span><var>tra'</var><span class="hyp-type"><b>: </b><span>list transition_item</span></span></span><br><span><var>sa'</var><span class="hyp-type"><b>: </b><span>state Free</span></span></span><br><span><var>eq_as'</var><span class="hyp-type"><b>: </b><span>apply_plan Free s&#39; a = (tra&#39;, sa&#39;)</span></span></span><br><span><var>IHaind</var><span class="hyp-type"><b>: </b><span><span class="kr">‚àÄ</span> <span class="nv">i</span> : index,
  i ‚àà li ‚Üí (tra&#39;, sa&#39;).<span class="mi">2</span> i = (tra, sa).<span class="mi">2</span> i</span></span></span><br><span><var>Hrelpr</var><span class="hyp-type"><b>: </b><span>finite_valid_plan_from Free (tra&#39;, sa&#39;).<span class="mi">2</span> [x]</span></span></span><br><span><var>Hrelind</var><span class="hyp-type"><b>: </b><span>(apply_plan Free (tra&#39;, sa&#39;).<span class="mi">2</span> [x]).<span class="mi">2</span>
  (projT1 (label_a x)) =
(apply_plan Free (tra, sa).<span class="mi">2</span> [x]).<span class="mi">2</span>
  (projT1 (label_a x))</span></span></span><br><span><var>i</var><span class="hyp-type"><b>: </b><span>index</span></span></span><br><span><var>Hi</var><span class="hyp-type"><b>: </b><span>i ‚àà li</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">(<span class="kr">let</span> (<span class="nv">a&#39;items</span>, a&#39;final) := apply_plan Free sa&#39; [x] <span class="kr">in</span>
 (tra&#39; ++ a&#39;items, a&#39;final)).<span class="mi">2</span> i =
(<span class="kr">let</span> (<span class="nv">a&#39;items</span>, a&#39;final) := apply_plan Free sa [x] <span class="kr">in</span>
 (tra ++ a&#39;items, a&#39;final)).<span class="mi">2</span> i</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="Composition-v-chk19c" style="display: none" type="checkbox"><label class="alectryon-input" for="Composition-v-chk19c"><span class="nb">simpl</span> <span class="kr">in</span> *.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>message, index</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>EqDecision0</var><span class="hyp-type"><b>: </b><span>EqDecision index</span></span></span><br><span><var>IM</var><span class="hyp-type"><b>: </b><span>index ‚Üí VLSM message</span></span></span><br><span><var>Free</var><span><span class="hyp-body"><b>:= </b><span>free_composite_vlsm IM</span></span><span class="hyp-type"><b>: </b><span>VLSM message</span></span></span></span><br><span><var>s, s'</var><span class="hyp-type"><b>: </b><span>composite_state IM</span></span></span><br><span><var>Hprs'</var><span class="hyp-type"><b>: </b><span>valid_state_prop Free s&#39;</span></span></span><br><span><var>x</var><span class="hyp-type"><b>: </b><span>plan_item</span></span></span><br><span><var>a</var><span class="hyp-type"><b>: </b><span>list plan_item</span></span></span><br><span><var>a_indices</var><span><span class="hyp-body"><b>:= </b><span>List.map projT1
  (List.map label_a (a ++ [x]))</span></span><span class="hyp-type"><b>: </b><span>list index</span></span></span></span><br><span><var>li</var><span class="hyp-type"><b>: </b><span>list index</span></span></span><br><span><var>Heq</var><span class="hyp-type"><b>: </b><span><span class="kr">‚àÄ</span> <span class="nv">i</span> : index, i ‚àà li ‚Üí s&#39; i = s i</span></span></span><br><span><var>Hincl</var><span class="hyp-type"><b>: </b><span>a_indices ‚äÜ li</span></span></span><br><span><var>Hrem</var><span class="hyp-type"><b>: </b><span>finite_valid_plan_from Free s a</span></span></span><br><span><var>tra</var><span class="hyp-type"><b>: </b><span>list transition_item</span></span></span><br><span><var>sa</var><span class="hyp-type"><b>: </b><span>composite_state IM</span></span></span><br><span><var>eq_as</var><span class="hyp-type"><b>: </b><span>apply_plan Free s a = (tra, sa)</span></span></span><br><span><var>Hsingle</var><span class="hyp-type"><b>: </b><span>finite_valid_plan_from Free sa [x]</span></span></span><br><span><var>IHapr</var><span class="hyp-type"><b>: </b><span>finite_valid_plan_from Free s&#39; a</span></span></span><br><span><var>tra'</var><span class="hyp-type"><b>: </b><span>list transition_item</span></span></span><br><span><var>sa'</var><span class="hyp-type"><b>: </b><span>composite_state IM</span></span></span><br><span><var>eq_as'</var><span class="hyp-type"><b>: </b><span>apply_plan Free s&#39; a = (tra&#39;, sa&#39;)</span></span></span><br><span><var>IHaind</var><span class="hyp-type"><b>: </b><span><span class="kr">‚àÄ</span> <span class="nv">i</span> : index, i ‚àà li ‚Üí sa&#39; i = sa i</span></span></span><br><span><var>Hrelpr</var><span class="hyp-type"><b>: </b><span>finite_valid_plan_from Free sa&#39; [x]</span></span></span><br><span><var>Hrelind</var><span class="hyp-type"><b>: </b><span>(apply_plan Free sa&#39; [x]).<span class="mi">2</span>
  (projT1 (label_a x)) =
(apply_plan Free sa [x]).<span class="mi">2</span>
  (projT1 (label_a x))</span></span></span><br><span><var>i</var><span class="hyp-type"><b>: </b><span>index</span></span></span><br><span><var>Hi</var><span class="hyp-type"><b>: </b><span>i ‚àà li</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">(<span class="kr">let</span> (<span class="nv">a&#39;items</span>, a&#39;final) := apply_plan Free sa&#39; [x] <span class="kr">in</span>
 (tra&#39; ++ a&#39;items, a&#39;final)).<span class="mi">2</span> i =
(<span class="kr">let</span> (<span class="nv">a&#39;items</span>, a&#39;final) := apply_plan Free sa [x] <span class="kr">in</span>
 (tra ++ a&#39;items, a&#39;final)).<span class="mi">2</span> i</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="Composition-v-chk19d" style="display: none" type="checkbox"><label class="alectryon-input" for="Composition-v-chk19d"><span class="nb">destruct</span> (apply_plan Free sa [x]) <span class="kr">as</span> [trx sx] <span class="nb">eqn</span>: eq_xsa.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>message, index</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>EqDecision0</var><span class="hyp-type"><b>: </b><span>EqDecision index</span></span></span><br><span><var>IM</var><span class="hyp-type"><b>: </b><span>index ‚Üí VLSM message</span></span></span><br><span><var>Free</var><span><span class="hyp-body"><b>:= </b><span>free_composite_vlsm IM</span></span><span class="hyp-type"><b>: </b><span>VLSM message</span></span></span></span><br><span><var>s, s'</var><span class="hyp-type"><b>: </b><span>composite_state IM</span></span></span><br><span><var>Hprs'</var><span class="hyp-type"><b>: </b><span>valid_state_prop Free s&#39;</span></span></span><br><span><var>x</var><span class="hyp-type"><b>: </b><span>plan_item</span></span></span><br><span><var>a</var><span class="hyp-type"><b>: </b><span>list plan_item</span></span></span><br><span><var>a_indices</var><span><span class="hyp-body"><b>:= </b><span>List.map projT1
  (List.map label_a (a ++ [x]))</span></span><span class="hyp-type"><b>: </b><span>list index</span></span></span></span><br><span><var>li</var><span class="hyp-type"><b>: </b><span>list index</span></span></span><br><span><var>Heq</var><span class="hyp-type"><b>: </b><span><span class="kr">‚àÄ</span> <span class="nv">i</span> : index, i ‚àà li ‚Üí s&#39; i = s i</span></span></span><br><span><var>Hincl</var><span class="hyp-type"><b>: </b><span>a_indices ‚äÜ li</span></span></span><br><span><var>Hrem</var><span class="hyp-type"><b>: </b><span>finite_valid_plan_from Free s a</span></span></span><br><span><var>tra</var><span class="hyp-type"><b>: </b><span>list transition_item</span></span></span><br><span><var>sa</var><span class="hyp-type"><b>: </b><span>composite_state IM</span></span></span><br><span><var>eq_as</var><span class="hyp-type"><b>: </b><span>apply_plan Free s a = (tra, sa)</span></span></span><br><span><var>Hsingle</var><span class="hyp-type"><b>: </b><span>finite_valid_plan_from Free sa [x]</span></span></span><br><span><var>IHapr</var><span class="hyp-type"><b>: </b><span>finite_valid_plan_from Free s&#39; a</span></span></span><br><span><var>tra'</var><span class="hyp-type"><b>: </b><span>list transition_item</span></span></span><br><span><var>sa'</var><span class="hyp-type"><b>: </b><span>composite_state IM</span></span></span><br><span><var>eq_as'</var><span class="hyp-type"><b>: </b><span>apply_plan Free s&#39; a = (tra&#39;, sa&#39;)</span></span></span><br><span><var>IHaind</var><span class="hyp-type"><b>: </b><span><span class="kr">‚àÄ</span> <span class="nv">i</span> : index, i ‚àà li ‚Üí sa&#39; i = sa i</span></span></span><br><span><var>Hrelpr</var><span class="hyp-type"><b>: </b><span>finite_valid_plan_from Free sa&#39; [x]</span></span></span><br><span><var>trx</var><span class="hyp-type"><b>: </b><span>list transition_item</span></span></span><br><span><var>sx</var><span class="hyp-type"><b>: </b><span>state Free</span></span></span><br><span><var>eq_xsa</var><span class="hyp-type"><b>: </b><span>apply_plan Free sa [x] = (trx, sx)</span></span></span><br><span><var>Hrelind</var><span class="hyp-type"><b>: </b><span>(apply_plan Free sa&#39; [x]).<span class="mi">2</span>
  (projT1 (label_a x)) =
(trx, sx).<span class="mi">2</span> (projT1 (label_a x))</span></span></span><br><span><var>i</var><span class="hyp-type"><b>: </b><span>index</span></span></span><br><span><var>Hi</var><span class="hyp-type"><b>: </b><span>i ‚àà li</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">(<span class="kr">let</span> (<span class="nv">a&#39;items</span>, a&#39;final) := apply_plan Free sa&#39; [x] <span class="kr">in</span>
 (tra&#39; ++ a&#39;items, a&#39;final)).<span class="mi">2</span> i =
(tra ++ trx, sx).<span class="mi">2</span> i</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="Composition-v-chk19e" style="display: none" type="checkbox"><label class="alectryon-input" for="Composition-v-chk19e"><span class="nb">destruct</span> (apply_plan Free sa&#39; [x]) <span class="kr">as</span> [trx&#39; sx&#39;] <span class="nb">eqn</span>: eq_xsa&#39;.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>message, index</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>EqDecision0</var><span class="hyp-type"><b>: </b><span>EqDecision index</span></span></span><br><span><var>IM</var><span class="hyp-type"><b>: </b><span>index ‚Üí VLSM message</span></span></span><br><span><var>Free</var><span><span class="hyp-body"><b>:= </b><span>free_composite_vlsm IM</span></span><span class="hyp-type"><b>: </b><span>VLSM message</span></span></span></span><br><span><var>s, s'</var><span class="hyp-type"><b>: </b><span>composite_state IM</span></span></span><br><span><var>Hprs'</var><span class="hyp-type"><b>: </b><span>valid_state_prop Free s&#39;</span></span></span><br><span><var>x</var><span class="hyp-type"><b>: </b><span>plan_item</span></span></span><br><span><var>a</var><span class="hyp-type"><b>: </b><span>list plan_item</span></span></span><br><span><var>a_indices</var><span><span class="hyp-body"><b>:= </b><span>List.map projT1
  (List.map label_a (a ++ [x]))</span></span><span class="hyp-type"><b>: </b><span>list index</span></span></span></span><br><span><var>li</var><span class="hyp-type"><b>: </b><span>list index</span></span></span><br><span><var>Heq</var><span class="hyp-type"><b>: </b><span><span class="kr">‚àÄ</span> <span class="nv">i</span> : index, i ‚àà li ‚Üí s&#39; i = s i</span></span></span><br><span><var>Hincl</var><span class="hyp-type"><b>: </b><span>a_indices ‚äÜ li</span></span></span><br><span><var>Hrem</var><span class="hyp-type"><b>: </b><span>finite_valid_plan_from Free s a</span></span></span><br><span><var>tra</var><span class="hyp-type"><b>: </b><span>list transition_item</span></span></span><br><span><var>sa</var><span class="hyp-type"><b>: </b><span>composite_state IM</span></span></span><br><span><var>eq_as</var><span class="hyp-type"><b>: </b><span>apply_plan Free s a = (tra, sa)</span></span></span><br><span><var>Hsingle</var><span class="hyp-type"><b>: </b><span>finite_valid_plan_from Free sa [x]</span></span></span><br><span><var>IHapr</var><span class="hyp-type"><b>: </b><span>finite_valid_plan_from Free s&#39; a</span></span></span><br><span><var>tra'</var><span class="hyp-type"><b>: </b><span>list transition_item</span></span></span><br><span><var>sa'</var><span class="hyp-type"><b>: </b><span>composite_state IM</span></span></span><br><span><var>eq_as'</var><span class="hyp-type"><b>: </b><span>apply_plan Free s&#39; a = (tra&#39;, sa&#39;)</span></span></span><br><span><var>IHaind</var><span class="hyp-type"><b>: </b><span><span class="kr">‚àÄ</span> <span class="nv">i</span> : index, i ‚àà li ‚Üí sa&#39; i = sa i</span></span></span><br><span><var>Hrelpr</var><span class="hyp-type"><b>: </b><span>finite_valid_plan_from Free sa&#39; [x]</span></span></span><br><span><var>trx</var><span class="hyp-type"><b>: </b><span>list transition_item</span></span></span><br><span><var>sx</var><span class="hyp-type"><b>: </b><span>state Free</span></span></span><br><span><var>eq_xsa</var><span class="hyp-type"><b>: </b><span>apply_plan Free sa [x] = (trx, sx)</span></span></span><br><span><var>trx'</var><span class="hyp-type"><b>: </b><span>list transition_item</span></span></span><br><span><var>sx'</var><span class="hyp-type"><b>: </b><span>state Free</span></span></span><br><span><var>eq_xsa'</var><span class="hyp-type"><b>: </b><span>apply_plan Free sa&#39; [x] = (trx&#39;, sx&#39;)</span></span></span><br><span><var>Hrelind</var><span class="hyp-type"><b>: </b><span>(trx&#39;, sx&#39;).<span class="mi">2</span> (projT1 (label_a x)) =
(trx, sx).<span class="mi">2</span> (projT1 (label_a x))</span></span></span><br><span><var>i</var><span class="hyp-type"><b>: </b><span>index</span></span></span><br><span><var>Hi</var><span class="hyp-type"><b>: </b><span>i ‚àà li</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">(tra&#39; ++ trx&#39;, sx&#39;).<span class="mi">2</span> i = (tra ++ trx, sx).<span class="mi">2</span> i</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="Composition-v-chk19f" style="display: none" type="checkbox"><label class="alectryon-input" for="Composition-v-chk19f"><span class="nb">simpl</span> <span class="kr">in</span> *.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>message, index</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>EqDecision0</var><span class="hyp-type"><b>: </b><span>EqDecision index</span></span></span><br><span><var>IM</var><span class="hyp-type"><b>: </b><span>index ‚Üí VLSM message</span></span></span><br><span><var>Free</var><span><span class="hyp-body"><b>:= </b><span>free_composite_vlsm IM</span></span><span class="hyp-type"><b>: </b><span>VLSM message</span></span></span></span><br><span><var>s, s'</var><span class="hyp-type"><b>: </b><span>composite_state IM</span></span></span><br><span><var>Hprs'</var><span class="hyp-type"><b>: </b><span>valid_state_prop Free s&#39;</span></span></span><br><span><var>x</var><span class="hyp-type"><b>: </b><span>plan_item</span></span></span><br><span><var>a</var><span class="hyp-type"><b>: </b><span>list plan_item</span></span></span><br><span><var>a_indices</var><span><span class="hyp-body"><b>:= </b><span>List.map projT1
  (List.map label_a (a ++ [x]))</span></span><span class="hyp-type"><b>: </b><span>list index</span></span></span></span><br><span><var>li</var><span class="hyp-type"><b>: </b><span>list index</span></span></span><br><span><var>Heq</var><span class="hyp-type"><b>: </b><span><span class="kr">‚àÄ</span> <span class="nv">i</span> : index, i ‚àà li ‚Üí s&#39; i = s i</span></span></span><br><span><var>Hincl</var><span class="hyp-type"><b>: </b><span>a_indices ‚äÜ li</span></span></span><br><span><var>Hrem</var><span class="hyp-type"><b>: </b><span>finite_valid_plan_from Free s a</span></span></span><br><span><var>tra</var><span class="hyp-type"><b>: </b><span>list transition_item</span></span></span><br><span><var>sa</var><span class="hyp-type"><b>: </b><span>composite_state IM</span></span></span><br><span><var>eq_as</var><span class="hyp-type"><b>: </b><span>apply_plan Free s a = (tra, sa)</span></span></span><br><span><var>Hsingle</var><span class="hyp-type"><b>: </b><span>finite_valid_plan_from Free sa [x]</span></span></span><br><span><var>IHapr</var><span class="hyp-type"><b>: </b><span>finite_valid_plan_from Free s&#39; a</span></span></span><br><span><var>tra'</var><span class="hyp-type"><b>: </b><span>list transition_item</span></span></span><br><span><var>sa'</var><span class="hyp-type"><b>: </b><span>composite_state IM</span></span></span><br><span><var>eq_as'</var><span class="hyp-type"><b>: </b><span>apply_plan Free s&#39; a = (tra&#39;, sa&#39;)</span></span></span><br><span><var>IHaind</var><span class="hyp-type"><b>: </b><span><span class="kr">‚àÄ</span> <span class="nv">i</span> : index, i ‚àà li ‚Üí sa&#39; i = sa i</span></span></span><br><span><var>Hrelpr</var><span class="hyp-type"><b>: </b><span>finite_valid_plan_from Free sa&#39; [x]</span></span></span><br><span><var>trx</var><span class="hyp-type"><b>: </b><span>list transition_item</span></span></span><br><span><var>sx</var><span class="hyp-type"><b>: </b><span>composite_state IM</span></span></span><br><span><var>eq_xsa</var><span class="hyp-type"><b>: </b><span>apply_plan Free sa [x] = (trx, sx)</span></span></span><br><span><var>trx'</var><span class="hyp-type"><b>: </b><span>list transition_item</span></span></span><br><span><var>sx'</var><span class="hyp-type"><b>: </b><span>composite_state IM</span></span></span><br><span><var>eq_xsa'</var><span class="hyp-type"><b>: </b><span>apply_plan Free sa&#39; [x] = (trx&#39;, sx&#39;)</span></span></span><br><span><var>Hrelind</var><span class="hyp-type"><b>: </b><span>sx&#39; (projT1 (label_a x)) =
sx (projT1 (label_a x))</span></span></span><br><span><var>i</var><span class="hyp-type"><b>: </b><span>index</span></span></span><br><span><var>Hi</var><span class="hyp-type"><b>: </b><span>i ‚àà li</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">sx&#39; i = sx i</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="Composition-v-chk1a0" style="display: none" type="checkbox"><label class="alectryon-input" for="Composition-v-chk1a0"><span class="nb">destruct</span> (decide (i = (projT1 (label_a x)))); [<span class="bp">by</span> <span class="nb">rewrite</span> e |].</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>message, index</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>EqDecision0</var><span class="hyp-type"><b>: </b><span>EqDecision index</span></span></span><br><span><var>IM</var><span class="hyp-type"><b>: </b><span>index ‚Üí VLSM message</span></span></span><br><span><var>Free</var><span><span class="hyp-body"><b>:= </b><span>free_composite_vlsm IM</span></span><span class="hyp-type"><b>: </b><span>VLSM message</span></span></span></span><br><span><var>s, s'</var><span class="hyp-type"><b>: </b><span>composite_state IM</span></span></span><br><span><var>Hprs'</var><span class="hyp-type"><b>: </b><span>valid_state_prop Free s&#39;</span></span></span><br><span><var>x</var><span class="hyp-type"><b>: </b><span>plan_item</span></span></span><br><span><var>a</var><span class="hyp-type"><b>: </b><span>list plan_item</span></span></span><br><span><var>a_indices</var><span><span class="hyp-body"><b>:= </b><span>List.map projT1
  (List.map label_a (a ++ [x]))</span></span><span class="hyp-type"><b>: </b><span>list index</span></span></span></span><br><span><var>li</var><span class="hyp-type"><b>: </b><span>list index</span></span></span><br><span><var>Heq</var><span class="hyp-type"><b>: </b><span><span class="kr">‚àÄ</span> <span class="nv">i</span> : index, i ‚àà li ‚Üí s&#39; i = s i</span></span></span><br><span><var>Hincl</var><span class="hyp-type"><b>: </b><span>a_indices ‚äÜ li</span></span></span><br><span><var>Hrem</var><span class="hyp-type"><b>: </b><span>finite_valid_plan_from Free s a</span></span></span><br><span><var>tra</var><span class="hyp-type"><b>: </b><span>list transition_item</span></span></span><br><span><var>sa</var><span class="hyp-type"><b>: </b><span>composite_state IM</span></span></span><br><span><var>eq_as</var><span class="hyp-type"><b>: </b><span>apply_plan Free s a = (tra, sa)</span></span></span><br><span><var>Hsingle</var><span class="hyp-type"><b>: </b><span>finite_valid_plan_from Free sa [x]</span></span></span><br><span><var>IHapr</var><span class="hyp-type"><b>: </b><span>finite_valid_plan_from Free s&#39; a</span></span></span><br><span><var>tra'</var><span class="hyp-type"><b>: </b><span>list transition_item</span></span></span><br><span><var>sa'</var><span class="hyp-type"><b>: </b><span>composite_state IM</span></span></span><br><span><var>eq_as'</var><span class="hyp-type"><b>: </b><span>apply_plan Free s&#39; a = (tra&#39;, sa&#39;)</span></span></span><br><span><var>IHaind</var><span class="hyp-type"><b>: </b><span><span class="kr">‚àÄ</span> <span class="nv">i</span> : index, i ‚àà li ‚Üí sa&#39; i = sa i</span></span></span><br><span><var>Hrelpr</var><span class="hyp-type"><b>: </b><span>finite_valid_plan_from Free sa&#39; [x]</span></span></span><br><span><var>trx</var><span class="hyp-type"><b>: </b><span>list transition_item</span></span></span><br><span><var>sx</var><span class="hyp-type"><b>: </b><span>composite_state IM</span></span></span><br><span><var>eq_xsa</var><span class="hyp-type"><b>: </b><span>apply_plan Free sa [x] = (trx, sx)</span></span></span><br><span><var>trx'</var><span class="hyp-type"><b>: </b><span>list transition_item</span></span></span><br><span><var>sx'</var><span class="hyp-type"><b>: </b><span>composite_state IM</span></span></span><br><span><var>eq_xsa'</var><span class="hyp-type"><b>: </b><span>apply_plan Free sa&#39; [x] = (trx&#39;, sx&#39;)</span></span></span><br><span><var>Hrelind</var><span class="hyp-type"><b>: </b><span>sx&#39; (projT1 (label_a x)) =
sx (projT1 (label_a x))</span></span></span><br><span><var>i</var><span class="hyp-type"><b>: </b><span>index</span></span></span><br><span><var>Hi</var><span class="hyp-type"><b>: </b><span>i ‚àà li</span></span></span><br><span><var>n</var><span class="hyp-type"><b>: </b><span>i ‚â† projT1 (label_a x)</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">sx&#39; i = sx i</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="Composition-v-chk1a1" style="display: none" type="checkbox"><label class="alectryon-input" for="Composition-v-chk1a1"><span class="nb">apply</span> (<span class="nb">f_equal</span> snd) <span class="kr">in</span> eq_xsa, eq_xsa&#39;.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>message, index</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>EqDecision0</var><span class="hyp-type"><b>: </b><span>EqDecision index</span></span></span><br><span><var>IM</var><span class="hyp-type"><b>: </b><span>index ‚Üí VLSM message</span></span></span><br><span><var>Free</var><span><span class="hyp-body"><b>:= </b><span>free_composite_vlsm IM</span></span><span class="hyp-type"><b>: </b><span>VLSM message</span></span></span></span><br><span><var>s, s'</var><span class="hyp-type"><b>: </b><span>composite_state IM</span></span></span><br><span><var>Hprs'</var><span class="hyp-type"><b>: </b><span>valid_state_prop Free s&#39;</span></span></span><br><span><var>x</var><span class="hyp-type"><b>: </b><span>plan_item</span></span></span><br><span><var>a</var><span class="hyp-type"><b>: </b><span>list plan_item</span></span></span><br><span><var>a_indices</var><span><span class="hyp-body"><b>:= </b><span>List.map projT1
  (List.map label_a (a ++ [x]))</span></span><span class="hyp-type"><b>: </b><span>list index</span></span></span></span><br><span><var>li</var><span class="hyp-type"><b>: </b><span>list index</span></span></span><br><span><var>Heq</var><span class="hyp-type"><b>: </b><span><span class="kr">‚àÄ</span> <span class="nv">i</span> : index, i ‚àà li ‚Üí s&#39; i = s i</span></span></span><br><span><var>Hincl</var><span class="hyp-type"><b>: </b><span>a_indices ‚äÜ li</span></span></span><br><span><var>Hrem</var><span class="hyp-type"><b>: </b><span>finite_valid_plan_from Free s a</span></span></span><br><span><var>tra</var><span class="hyp-type"><b>: </b><span>list transition_item</span></span></span><br><span><var>sa</var><span class="hyp-type"><b>: </b><span>composite_state IM</span></span></span><br><span><var>eq_as</var><span class="hyp-type"><b>: </b><span>apply_plan Free s a = (tra, sa)</span></span></span><br><span><var>Hsingle</var><span class="hyp-type"><b>: </b><span>finite_valid_plan_from Free sa [x]</span></span></span><br><span><var>IHapr</var><span class="hyp-type"><b>: </b><span>finite_valid_plan_from Free s&#39; a</span></span></span><br><span><var>tra'</var><span class="hyp-type"><b>: </b><span>list transition_item</span></span></span><br><span><var>sa'</var><span class="hyp-type"><b>: </b><span>composite_state IM</span></span></span><br><span><var>eq_as'</var><span class="hyp-type"><b>: </b><span>apply_plan Free s&#39; a = (tra&#39;, sa&#39;)</span></span></span><br><span><var>IHaind</var><span class="hyp-type"><b>: </b><span><span class="kr">‚àÄ</span> <span class="nv">i</span> : index, i ‚àà li ‚Üí sa&#39; i = sa i</span></span></span><br><span><var>Hrelpr</var><span class="hyp-type"><b>: </b><span>finite_valid_plan_from Free sa&#39; [x]</span></span></span><br><span><var>trx</var><span class="hyp-type"><b>: </b><span>list transition_item</span></span></span><br><span><var>sx</var><span class="hyp-type"><b>: </b><span>composite_state IM</span></span></span><br><span><var>eq_xsa</var><span class="hyp-type"><b>: </b><span>(apply_plan Free sa [x]).<span class="mi">2</span> = (trx, sx).<span class="mi">2</span></span></span></span><br><span><var>trx'</var><span class="hyp-type"><b>: </b><span>list transition_item</span></span></span><br><span><var>sx'</var><span class="hyp-type"><b>: </b><span>composite_state IM</span></span></span><br><span><var>eq_xsa'</var><span class="hyp-type"><b>: </b><span>(apply_plan Free sa&#39; [x]).<span class="mi">2</span> = (trx&#39;, sx&#39;).<span class="mi">2</span></span></span></span><br><span><var>Hrelind</var><span class="hyp-type"><b>: </b><span>sx&#39; (projT1 (label_a x)) =
sx (projT1 (label_a x))</span></span></span><br><span><var>i</var><span class="hyp-type"><b>: </b><span>index</span></span></span><br><span><var>Hi</var><span class="hyp-type"><b>: </b><span>i ‚àà li</span></span></span><br><span><var>n</var><span class="hyp-type"><b>: </b><span>i ‚â† projT1 (label_a x)</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">sx&#39; i = sx i</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="Composition-v-chk1a2" style="display: none" type="checkbox"><label class="alectryon-input" for="Composition-v-chk1a2"><span class="nb">replace</span> sx&#39; <span class="kr">with</span> (snd (composite_apply_plan IM sa&#39; [x])).</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>message, index</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>EqDecision0</var><span class="hyp-type"><b>: </b><span>EqDecision index</span></span></span><br><span><var>IM</var><span class="hyp-type"><b>: </b><span>index ‚Üí VLSM message</span></span></span><br><span><var>Free</var><span><span class="hyp-body"><b>:= </b><span>free_composite_vlsm IM</span></span><span class="hyp-type"><b>: </b><span>VLSM message</span></span></span></span><br><span><var>s, s'</var><span class="hyp-type"><b>: </b><span>composite_state IM</span></span></span><br><span><var>Hprs'</var><span class="hyp-type"><b>: </b><span>valid_state_prop Free s&#39;</span></span></span><br><span><var>x</var><span class="hyp-type"><b>: </b><span>plan_item</span></span></span><br><span><var>a</var><span class="hyp-type"><b>: </b><span>list plan_item</span></span></span><br><span><var>a_indices</var><span><span class="hyp-body"><b>:= </b><span>List.map projT1
  (List.map label_a (a ++ [x]))</span></span><span class="hyp-type"><b>: </b><span>list index</span></span></span></span><br><span><var>li</var><span class="hyp-type"><b>: </b><span>list index</span></span></span><br><span><var>Heq</var><span class="hyp-type"><b>: </b><span><span class="kr">‚àÄ</span> <span class="nv">i</span> : index, i ‚àà li ‚Üí s&#39; i = s i</span></span></span><br><span><var>Hincl</var><span class="hyp-type"><b>: </b><span>a_indices ‚äÜ li</span></span></span><br><span><var>Hrem</var><span class="hyp-type"><b>: </b><span>finite_valid_plan_from Free s a</span></span></span><br><span><var>tra</var><span class="hyp-type"><b>: </b><span>list transition_item</span></span></span><br><span><var>sa</var><span class="hyp-type"><b>: </b><span>composite_state IM</span></span></span><br><span><var>eq_as</var><span class="hyp-type"><b>: </b><span>apply_plan Free s a = (tra, sa)</span></span></span><br><span><var>Hsingle</var><span class="hyp-type"><b>: </b><span>finite_valid_plan_from Free sa [x]</span></span></span><br><span><var>IHapr</var><span class="hyp-type"><b>: </b><span>finite_valid_plan_from Free s&#39; a</span></span></span><br><span><var>tra'</var><span class="hyp-type"><b>: </b><span>list transition_item</span></span></span><br><span><var>sa'</var><span class="hyp-type"><b>: </b><span>composite_state IM</span></span></span><br><span><var>eq_as'</var><span class="hyp-type"><b>: </b><span>apply_plan Free s&#39; a = (tra&#39;, sa&#39;)</span></span></span><br><span><var>IHaind</var><span class="hyp-type"><b>: </b><span><span class="kr">‚àÄ</span> <span class="nv">i</span> : index, i ‚àà li ‚Üí sa&#39; i = sa i</span></span></span><br><span><var>Hrelpr</var><span class="hyp-type"><b>: </b><span>finite_valid_plan_from Free sa&#39; [x]</span></span></span><br><span><var>trx</var><span class="hyp-type"><b>: </b><span>list transition_item</span></span></span><br><span><var>sx</var><span class="hyp-type"><b>: </b><span>composite_state IM</span></span></span><br><span><var>eq_xsa</var><span class="hyp-type"><b>: </b><span>(apply_plan Free sa [x]).<span class="mi">2</span> = (trx, sx).<span class="mi">2</span></span></span></span><br><span><var>trx'</var><span class="hyp-type"><b>: </b><span>list transition_item</span></span></span><br><span><var>sx'</var><span class="hyp-type"><b>: </b><span>composite_state IM</span></span></span><br><span><var>eq_xsa'</var><span class="hyp-type"><b>: </b><span>(apply_plan Free sa&#39; [x]).<span class="mi">2</span> = (trx&#39;, sx&#39;).<span class="mi">2</span></span></span></span><br><span><var>Hrelind</var><span class="hyp-type"><b>: </b><span>sx&#39; (projT1 (label_a x)) =
sx (projT1 (label_a x))</span></span></span><br><span><var>i</var><span class="hyp-type"><b>: </b><span>index</span></span></span><br><span><var>Hi</var><span class="hyp-type"><b>: </b><span>i ‚àà li</span></span></span><br><span><var>n</var><span class="hyp-type"><b>: </b><span>i ‚â† projT1 (label_a x)</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">(composite_apply_plan IM sa&#39; [x]).<span class="mi">2</span> i = sx i</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="Composition-v-chk1a3" style="display: none" type="checkbox"><label class="alectryon-input" for="Composition-v-chk1a3"><span class="nb">replace</span> sx <span class="kr">with</span> (snd (composite_apply_plan IM sa [x])).</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>message, index</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>EqDecision0</var><span class="hyp-type"><b>: </b><span>EqDecision index</span></span></span><br><span><var>IM</var><span class="hyp-type"><b>: </b><span>index ‚Üí VLSM message</span></span></span><br><span><var>Free</var><span><span class="hyp-body"><b>:= </b><span>free_composite_vlsm IM</span></span><span class="hyp-type"><b>: </b><span>VLSM message</span></span></span></span><br><span><var>s, s'</var><span class="hyp-type"><b>: </b><span>composite_state IM</span></span></span><br><span><var>Hprs'</var><span class="hyp-type"><b>: </b><span>valid_state_prop Free s&#39;</span></span></span><br><span><var>x</var><span class="hyp-type"><b>: </b><span>plan_item</span></span></span><br><span><var>a</var><span class="hyp-type"><b>: </b><span>list plan_item</span></span></span><br><span><var>a_indices</var><span><span class="hyp-body"><b>:= </b><span>List.map projT1
  (List.map label_a (a ++ [x]))</span></span><span class="hyp-type"><b>: </b><span>list index</span></span></span></span><br><span><var>li</var><span class="hyp-type"><b>: </b><span>list index</span></span></span><br><span><var>Heq</var><span class="hyp-type"><b>: </b><span><span class="kr">‚àÄ</span> <span class="nv">i</span> : index, i ‚àà li ‚Üí s&#39; i = s i</span></span></span><br><span><var>Hincl</var><span class="hyp-type"><b>: </b><span>a_indices ‚äÜ li</span></span></span><br><span><var>Hrem</var><span class="hyp-type"><b>: </b><span>finite_valid_plan_from Free s a</span></span></span><br><span><var>tra</var><span class="hyp-type"><b>: </b><span>list transition_item</span></span></span><br><span><var>sa</var><span class="hyp-type"><b>: </b><span>composite_state IM</span></span></span><br><span><var>eq_as</var><span class="hyp-type"><b>: </b><span>apply_plan Free s a = (tra, sa)</span></span></span><br><span><var>Hsingle</var><span class="hyp-type"><b>: </b><span>finite_valid_plan_from Free sa [x]</span></span></span><br><span><var>IHapr</var><span class="hyp-type"><b>: </b><span>finite_valid_plan_from Free s&#39; a</span></span></span><br><span><var>tra'</var><span class="hyp-type"><b>: </b><span>list transition_item</span></span></span><br><span><var>sa'</var><span class="hyp-type"><b>: </b><span>composite_state IM</span></span></span><br><span><var>eq_as'</var><span class="hyp-type"><b>: </b><span>apply_plan Free s&#39; a = (tra&#39;, sa&#39;)</span></span></span><br><span><var>IHaind</var><span class="hyp-type"><b>: </b><span><span class="kr">‚àÄ</span> <span class="nv">i</span> : index, i ‚àà li ‚Üí sa&#39; i = sa i</span></span></span><br><span><var>Hrelpr</var><span class="hyp-type"><b>: </b><span>finite_valid_plan_from Free sa&#39; [x]</span></span></span><br><span><var>trx</var><span class="hyp-type"><b>: </b><span>list transition_item</span></span></span><br><span><var>sx</var><span class="hyp-type"><b>: </b><span>composite_state IM</span></span></span><br><span><var>eq_xsa</var><span class="hyp-type"><b>: </b><span>(apply_plan Free sa [x]).<span class="mi">2</span> = (trx, sx).<span class="mi">2</span></span></span></span><br><span><var>trx'</var><span class="hyp-type"><b>: </b><span>list transition_item</span></span></span><br><span><var>sx'</var><span class="hyp-type"><b>: </b><span>composite_state IM</span></span></span><br><span><var>eq_xsa'</var><span class="hyp-type"><b>: </b><span>(apply_plan Free sa&#39; [x]).<span class="mi">2</span> = (trx&#39;, sx&#39;).<span class="mi">2</span></span></span></span><br><span><var>Hrelind</var><span class="hyp-type"><b>: </b><span>sx&#39; (projT1 (label_a x)) =
sx (projT1 (label_a x))</span></span></span><br><span><var>i</var><span class="hyp-type"><b>: </b><span>index</span></span></span><br><span><var>Hi</var><span class="hyp-type"><b>: </b><span>i ‚àà li</span></span></span><br><span><var>n</var><span class="hyp-type"><b>: </b><span>i ‚â† projT1 (label_a x)</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">(composite_apply_plan IM sa&#39; [x]).<span class="mi">2</span> i =
(composite_apply_plan IM sa [x]).<span class="mi">2</span> i</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="Composition-v-chk1a4" style="display: none" type="checkbox"><label class="alectryon-input" for="Composition-v-chk1a4"><span class="nb">specialize</span> (irrelevant_components_one sa x i n) <span class="kr">as</span> Hdiff.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>message, index</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>EqDecision0</var><span class="hyp-type"><b>: </b><span>EqDecision index</span></span></span><br><span><var>IM</var><span class="hyp-type"><b>: </b><span>index ‚Üí VLSM message</span></span></span><br><span><var>Free</var><span><span class="hyp-body"><b>:= </b><span>free_composite_vlsm IM</span></span><span class="hyp-type"><b>: </b><span>VLSM message</span></span></span></span><br><span><var>s, s'</var><span class="hyp-type"><b>: </b><span>composite_state IM</span></span></span><br><span><var>Hprs'</var><span class="hyp-type"><b>: </b><span>valid_state_prop Free s&#39;</span></span></span><br><span><var>x</var><span class="hyp-type"><b>: </b><span>plan_item</span></span></span><br><span><var>a</var><span class="hyp-type"><b>: </b><span>list plan_item</span></span></span><br><span><var>a_indices</var><span><span class="hyp-body"><b>:= </b><span>List.map projT1
  (List.map label_a (a ++ [x]))</span></span><span class="hyp-type"><b>: </b><span>list index</span></span></span></span><br><span><var>li</var><span class="hyp-type"><b>: </b><span>list index</span></span></span><br><span><var>Heq</var><span class="hyp-type"><b>: </b><span><span class="kr">‚àÄ</span> <span class="nv">i</span> : index, i ‚àà li ‚Üí s&#39; i = s i</span></span></span><br><span><var>Hincl</var><span class="hyp-type"><b>: </b><span>a_indices ‚äÜ li</span></span></span><br><span><var>Hrem</var><span class="hyp-type"><b>: </b><span>finite_valid_plan_from Free s a</span></span></span><br><span><var>tra</var><span class="hyp-type"><b>: </b><span>list transition_item</span></span></span><br><span><var>sa</var><span class="hyp-type"><b>: </b><span>composite_state IM</span></span></span><br><span><var>eq_as</var><span class="hyp-type"><b>: </b><span>apply_plan Free s a = (tra, sa)</span></span></span><br><span><var>Hsingle</var><span class="hyp-type"><b>: </b><span>finite_valid_plan_from Free sa [x]</span></span></span><br><span><var>IHapr</var><span class="hyp-type"><b>: </b><span>finite_valid_plan_from Free s&#39; a</span></span></span><br><span><var>tra'</var><span class="hyp-type"><b>: </b><span>list transition_item</span></span></span><br><span><var>sa'</var><span class="hyp-type"><b>: </b><span>composite_state IM</span></span></span><br><span><var>eq_as'</var><span class="hyp-type"><b>: </b><span>apply_plan Free s&#39; a = (tra&#39;, sa&#39;)</span></span></span><br><span><var>IHaind</var><span class="hyp-type"><b>: </b><span><span class="kr">‚àÄ</span> <span class="nv">i</span> : index, i ‚àà li ‚Üí sa&#39; i = sa i</span></span></span><br><span><var>Hrelpr</var><span class="hyp-type"><b>: </b><span>finite_valid_plan_from Free sa&#39; [x]</span></span></span><br><span><var>trx</var><span class="hyp-type"><b>: </b><span>list transition_item</span></span></span><br><span><var>sx</var><span class="hyp-type"><b>: </b><span>composite_state IM</span></span></span><br><span><var>eq_xsa</var><span class="hyp-type"><b>: </b><span>(apply_plan Free sa [x]).<span class="mi">2</span> = (trx, sx).<span class="mi">2</span></span></span></span><br><span><var>trx'</var><span class="hyp-type"><b>: </b><span>list transition_item</span></span></span><br><span><var>sx'</var><span class="hyp-type"><b>: </b><span>composite_state IM</span></span></span><br><span><var>eq_xsa'</var><span class="hyp-type"><b>: </b><span>(apply_plan Free sa&#39; [x]).<span class="mi">2</span> = (trx&#39;, sx&#39;).<span class="mi">2</span></span></span></span><br><span><var>Hrelind</var><span class="hyp-type"><b>: </b><span>sx&#39; (projT1 (label_a x)) =
sx (projT1 (label_a x))</span></span></span><br><span><var>i</var><span class="hyp-type"><b>: </b><span>index</span></span></span><br><span><var>Hi</var><span class="hyp-type"><b>: </b><span>i ‚àà li</span></span></span><br><span><var>n</var><span class="hyp-type"><b>: </b><span>i ‚â† projT1 (label_a x)</span></span></span><br><span><var>Hdiff</var><span class="hyp-type"><b>: </b><span><span class="kr">let</span> <span class="nv">res</span> := (composite_apply_plan IM sa [x]).<span class="mi">2</span>
  <span class="kr">in</span>
res i = sa i</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">(composite_apply_plan IM sa&#39; [x]).<span class="mi">2</span> i =
(composite_apply_plan IM sa [x]).<span class="mi">2</span> i</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="Composition-v-chk1a5" style="display: none" type="checkbox"><label class="alectryon-input" for="Composition-v-chk1a5"><span class="nb">specialize</span> (irrelevant_components_one sa&#39; x i n) <span class="kr">as</span> Hdiff0.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>message, index</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>EqDecision0</var><span class="hyp-type"><b>: </b><span>EqDecision index</span></span></span><br><span><var>IM</var><span class="hyp-type"><b>: </b><span>index ‚Üí VLSM message</span></span></span><br><span><var>Free</var><span><span class="hyp-body"><b>:= </b><span>free_composite_vlsm IM</span></span><span class="hyp-type"><b>: </b><span>VLSM message</span></span></span></span><br><span><var>s, s'</var><span class="hyp-type"><b>: </b><span>composite_state IM</span></span></span><br><span><var>Hprs'</var><span class="hyp-type"><b>: </b><span>valid_state_prop Free s&#39;</span></span></span><br><span><var>x</var><span class="hyp-type"><b>: </b><span>plan_item</span></span></span><br><span><var>a</var><span class="hyp-type"><b>: </b><span>list plan_item</span></span></span><br><span><var>a_indices</var><span><span class="hyp-body"><b>:= </b><span>List.map projT1
  (List.map label_a (a ++ [x]))</span></span><span class="hyp-type"><b>: </b><span>list index</span></span></span></span><br><span><var>li</var><span class="hyp-type"><b>: </b><span>list index</span></span></span><br><span><var>Heq</var><span class="hyp-type"><b>: </b><span><span class="kr">‚àÄ</span> <span class="nv">i</span> : index, i ‚àà li ‚Üí s&#39; i = s i</span></span></span><br><span><var>Hincl</var><span class="hyp-type"><b>: </b><span>a_indices ‚äÜ li</span></span></span><br><span><var>Hrem</var><span class="hyp-type"><b>: </b><span>finite_valid_plan_from Free s a</span></span></span><br><span><var>tra</var><span class="hyp-type"><b>: </b><span>list transition_item</span></span></span><br><span><var>sa</var><span class="hyp-type"><b>: </b><span>composite_state IM</span></span></span><br><span><var>eq_as</var><span class="hyp-type"><b>: </b><span>apply_plan Free s a = (tra, sa)</span></span></span><br><span><var>Hsingle</var><span class="hyp-type"><b>: </b><span>finite_valid_plan_from Free sa [x]</span></span></span><br><span><var>IHapr</var><span class="hyp-type"><b>: </b><span>finite_valid_plan_from Free s&#39; a</span></span></span><br><span><var>tra'</var><span class="hyp-type"><b>: </b><span>list transition_item</span></span></span><br><span><var>sa'</var><span class="hyp-type"><b>: </b><span>composite_state IM</span></span></span><br><span><var>eq_as'</var><span class="hyp-type"><b>: </b><span>apply_plan Free s&#39; a = (tra&#39;, sa&#39;)</span></span></span><br><span><var>IHaind</var><span class="hyp-type"><b>: </b><span><span class="kr">‚àÄ</span> <span class="nv">i</span> : index, i ‚àà li ‚Üí sa&#39; i = sa i</span></span></span><br><span><var>Hrelpr</var><span class="hyp-type"><b>: </b><span>finite_valid_plan_from Free sa&#39; [x]</span></span></span><br><span><var>trx</var><span class="hyp-type"><b>: </b><span>list transition_item</span></span></span><br><span><var>sx</var><span class="hyp-type"><b>: </b><span>composite_state IM</span></span></span><br><span><var>eq_xsa</var><span class="hyp-type"><b>: </b><span>(apply_plan Free sa [x]).<span class="mi">2</span> = (trx, sx).<span class="mi">2</span></span></span></span><br><span><var>trx'</var><span class="hyp-type"><b>: </b><span>list transition_item</span></span></span><br><span><var>sx'</var><span class="hyp-type"><b>: </b><span>composite_state IM</span></span></span><br><span><var>eq_xsa'</var><span class="hyp-type"><b>: </b><span>(apply_plan Free sa&#39; [x]).<span class="mi">2</span> = (trx&#39;, sx&#39;).<span class="mi">2</span></span></span></span><br><span><var>Hrelind</var><span class="hyp-type"><b>: </b><span>sx&#39; (projT1 (label_a x)) =
sx (projT1 (label_a x))</span></span></span><br><span><var>i</var><span class="hyp-type"><b>: </b><span>index</span></span></span><br><span><var>Hi</var><span class="hyp-type"><b>: </b><span>i ‚àà li</span></span></span><br><span><var>n</var><span class="hyp-type"><b>: </b><span>i ‚â† projT1 (label_a x)</span></span></span><br><span><var>Hdiff</var><span class="hyp-type"><b>: </b><span><span class="kr">let</span> <span class="nv">res</span> := (composite_apply_plan IM sa [x]).<span class="mi">2</span>
  <span class="kr">in</span>
res i = sa i</span></span></span><br><span><var>Hdiff0</var><span class="hyp-type"><b>: </b><span><span class="kr">let</span> <span class="nv">res</span> :=
  (composite_apply_plan IM sa&#39; [x]).<span class="mi">2</span> <span class="kr">in</span>
res i = sa&#39; i</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">(composite_apply_plan IM sa&#39; [x]).<span class="mi">2</span> i =
(composite_apply_plan IM sa [x]).<span class="mi">2</span> i</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="Composition-v-chk1a6" style="display: none" type="checkbox"><label class="alectryon-input" for="Composition-v-chk1a6"><span class="nb">setoid_rewrite</span> Hdiff.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>message, index</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>EqDecision0</var><span class="hyp-type"><b>: </b><span>EqDecision index</span></span></span><br><span><var>IM</var><span class="hyp-type"><b>: </b><span>index ‚Üí VLSM message</span></span></span><br><span><var>Free</var><span><span class="hyp-body"><b>:= </b><span>free_composite_vlsm IM</span></span><span class="hyp-type"><b>: </b><span>VLSM message</span></span></span></span><br><span><var>s, s'</var><span class="hyp-type"><b>: </b><span>composite_state IM</span></span></span><br><span><var>Hprs'</var><span class="hyp-type"><b>: </b><span>valid_state_prop Free s&#39;</span></span></span><br><span><var>x</var><span class="hyp-type"><b>: </b><span>plan_item</span></span></span><br><span><var>a</var><span class="hyp-type"><b>: </b><span>list plan_item</span></span></span><br><span><var>a_indices</var><span><span class="hyp-body"><b>:= </b><span>List.map projT1
  (List.map label_a (a ++ [x]))</span></span><span class="hyp-type"><b>: </b><span>list index</span></span></span></span><br><span><var>li</var><span class="hyp-type"><b>: </b><span>list index</span></span></span><br><span><var>Heq</var><span class="hyp-type"><b>: </b><span><span class="kr">‚àÄ</span> <span class="nv">i</span> : index, i ‚àà li ‚Üí s&#39; i = s i</span></span></span><br><span><var>Hincl</var><span class="hyp-type"><b>: </b><span>a_indices ‚äÜ li</span></span></span><br><span><var>Hrem</var><span class="hyp-type"><b>: </b><span>finite_valid_plan_from Free s a</span></span></span><br><span><var>tra</var><span class="hyp-type"><b>: </b><span>list transition_item</span></span></span><br><span><var>sa</var><span class="hyp-type"><b>: </b><span>composite_state IM</span></span></span><br><span><var>eq_as</var><span class="hyp-type"><b>: </b><span>apply_plan Free s a = (tra, sa)</span></span></span><br><span><var>Hsingle</var><span class="hyp-type"><b>: </b><span>finite_valid_plan_from Free sa [x]</span></span></span><br><span><var>IHapr</var><span class="hyp-type"><b>: </b><span>finite_valid_plan_from Free s&#39; a</span></span></span><br><span><var>tra'</var><span class="hyp-type"><b>: </b><span>list transition_item</span></span></span><br><span><var>sa'</var><span class="hyp-type"><b>: </b><span>composite_state IM</span></span></span><br><span><var>eq_as'</var><span class="hyp-type"><b>: </b><span>apply_plan Free s&#39; a = (tra&#39;, sa&#39;)</span></span></span><br><span><var>IHaind</var><span class="hyp-type"><b>: </b><span><span class="kr">‚àÄ</span> <span class="nv">i</span> : index, i ‚àà li ‚Üí sa&#39; i = sa i</span></span></span><br><span><var>Hrelpr</var><span class="hyp-type"><b>: </b><span>finite_valid_plan_from Free sa&#39; [x]</span></span></span><br><span><var>trx</var><span class="hyp-type"><b>: </b><span>list transition_item</span></span></span><br><span><var>sx</var><span class="hyp-type"><b>: </b><span>composite_state IM</span></span></span><br><span><var>eq_xsa</var><span class="hyp-type"><b>: </b><span>(apply_plan Free sa [x]).<span class="mi">2</span> = (trx, sx).<span class="mi">2</span></span></span></span><br><span><var>trx'</var><span class="hyp-type"><b>: </b><span>list transition_item</span></span></span><br><span><var>sx'</var><span class="hyp-type"><b>: </b><span>composite_state IM</span></span></span><br><span><var>eq_xsa'</var><span class="hyp-type"><b>: </b><span>(apply_plan Free sa&#39; [x]).<span class="mi">2</span> = (trx&#39;, sx&#39;).<span class="mi">2</span></span></span></span><br><span><var>Hrelind</var><span class="hyp-type"><b>: </b><span>sx&#39; (projT1 (label_a x)) =
sx (projT1 (label_a x))</span></span></span><br><span><var>i</var><span class="hyp-type"><b>: </b><span>index</span></span></span><br><span><var>Hi</var><span class="hyp-type"><b>: </b><span>i ‚àà li</span></span></span><br><span><var>n</var><span class="hyp-type"><b>: </b><span>i ‚â† projT1 (label_a x)</span></span></span><br><span><var>Hdiff</var><span class="hyp-type"><b>: </b><span><span class="kr">let</span> <span class="nv">res</span> := (composite_apply_plan IM sa [x]).<span class="mi">2</span>
  <span class="kr">in</span>
res i = sa i</span></span></span><br><span><var>Hdiff0</var><span class="hyp-type"><b>: </b><span><span class="kr">let</span> <span class="nv">res</span> :=
  (composite_apply_plan IM sa&#39; [x]).<span class="mi">2</span> <span class="kr">in</span>
res i = sa&#39; i</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">(composite_apply_plan IM sa&#39; [x]).<span class="mi">2</span> i = sa i</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="Composition-v-chk1a7" style="display: none" type="checkbox"><label class="alectryon-input" for="Composition-v-chk1a7"><span class="nb">setoid_rewrite</span> Hdiff0.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>message, index</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>EqDecision0</var><span class="hyp-type"><b>: </b><span>EqDecision index</span></span></span><br><span><var>IM</var><span class="hyp-type"><b>: </b><span>index ‚Üí VLSM message</span></span></span><br><span><var>Free</var><span><span class="hyp-body"><b>:= </b><span>free_composite_vlsm IM</span></span><span class="hyp-type"><b>: </b><span>VLSM message</span></span></span></span><br><span><var>s, s'</var><span class="hyp-type"><b>: </b><span>composite_state IM</span></span></span><br><span><var>Hprs'</var><span class="hyp-type"><b>: </b><span>valid_state_prop Free s&#39;</span></span></span><br><span><var>x</var><span class="hyp-type"><b>: </b><span>plan_item</span></span></span><br><span><var>a</var><span class="hyp-type"><b>: </b><span>list plan_item</span></span></span><br><span><var>a_indices</var><span><span class="hyp-body"><b>:= </b><span>List.map projT1
  (List.map label_a (a ++ [x]))</span></span><span class="hyp-type"><b>: </b><span>list index</span></span></span></span><br><span><var>li</var><span class="hyp-type"><b>: </b><span>list index</span></span></span><br><span><var>Heq</var><span class="hyp-type"><b>: </b><span><span class="kr">‚àÄ</span> <span class="nv">i</span> : index, i ‚àà li ‚Üí s&#39; i = s i</span></span></span><br><span><var>Hincl</var><span class="hyp-type"><b>: </b><span>a_indices ‚äÜ li</span></span></span><br><span><var>Hrem</var><span class="hyp-type"><b>: </b><span>finite_valid_plan_from Free s a</span></span></span><br><span><var>tra</var><span class="hyp-type"><b>: </b><span>list transition_item</span></span></span><br><span><var>sa</var><span class="hyp-type"><b>: </b><span>composite_state IM</span></span></span><br><span><var>eq_as</var><span class="hyp-type"><b>: </b><span>apply_plan Free s a = (tra, sa)</span></span></span><br><span><var>Hsingle</var><span class="hyp-type"><b>: </b><span>finite_valid_plan_from Free sa [x]</span></span></span><br><span><var>IHapr</var><span class="hyp-type"><b>: </b><span>finite_valid_plan_from Free s&#39; a</span></span></span><br><span><var>tra'</var><span class="hyp-type"><b>: </b><span>list transition_item</span></span></span><br><span><var>sa'</var><span class="hyp-type"><b>: </b><span>composite_state IM</span></span></span><br><span><var>eq_as'</var><span class="hyp-type"><b>: </b><span>apply_plan Free s&#39; a = (tra&#39;, sa&#39;)</span></span></span><br><span><var>IHaind</var><span class="hyp-type"><b>: </b><span><span class="kr">‚àÄ</span> <span class="nv">i</span> : index, i ‚àà li ‚Üí sa&#39; i = sa i</span></span></span><br><span><var>Hrelpr</var><span class="hyp-type"><b>: </b><span>finite_valid_plan_from Free sa&#39; [x]</span></span></span><br><span><var>trx</var><span class="hyp-type"><b>: </b><span>list transition_item</span></span></span><br><span><var>sx</var><span class="hyp-type"><b>: </b><span>composite_state IM</span></span></span><br><span><var>eq_xsa</var><span class="hyp-type"><b>: </b><span>(apply_plan Free sa [x]).<span class="mi">2</span> = (trx, sx).<span class="mi">2</span></span></span></span><br><span><var>trx'</var><span class="hyp-type"><b>: </b><span>list transition_item</span></span></span><br><span><var>sx'</var><span class="hyp-type"><b>: </b><span>composite_state IM</span></span></span><br><span><var>eq_xsa'</var><span class="hyp-type"><b>: </b><span>(apply_plan Free sa&#39; [x]).<span class="mi">2</span> = (trx&#39;, sx&#39;).<span class="mi">2</span></span></span></span><br><span><var>Hrelind</var><span class="hyp-type"><b>: </b><span>sx&#39; (projT1 (label_a x)) =
sx (projT1 (label_a x))</span></span></span><br><span><var>i</var><span class="hyp-type"><b>: </b><span>index</span></span></span><br><span><var>Hi</var><span class="hyp-type"><b>: </b><span>i ‚àà li</span></span></span><br><span><var>n</var><span class="hyp-type"><b>: </b><span>i ‚â† projT1 (label_a x)</span></span></span><br><span><var>Hdiff</var><span class="hyp-type"><b>: </b><span><span class="kr">let</span> <span class="nv">res</span> := (composite_apply_plan IM sa [x]).<span class="mi">2</span>
  <span class="kr">in</span>
res i = sa i</span></span></span><br><span><var>Hdiff0</var><span class="hyp-type"><b>: </b><span><span class="kr">let</span> <span class="nv">res</span> :=
  (composite_apply_plan IM sa&#39; [x]).<span class="mi">2</span> <span class="kr">in</span>
res i = sa&#39; i</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">sa&#39; i = sa i</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><span class="alectryon-input"><span class="bp">by</span> <span class="nb">apply</span> IHaind.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Qed</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
</span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">End</span> <span class="nf">sec_composite_plan_properties</span>.</span></span></pre><div class="doc">
<a id="lab11"></a><h2 class="section">Properties of the empty composition</h2>
</div><pre class="alectryon-io highlight"><!-- Generator: Alectryon --><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Section</span> <span class="nf">sec_empty_composition_properties</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
</span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Context</span>
  {<span class="nv">message</span> : <span class="kt">Type</span>}
  `{finite.Finite index}
  (IM : index -&gt; VLSM message)
  (constraint : composite_label IM -&gt; composite_state IM * option message -&gt; <span class="kt">Prop</span>)
  (X := composite_vlsm IM constraint)
  (Hempty_index : enum index = [])
  .</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
</span><span class="alectryon-sentence"><input class="alectryon-toggle" id="Composition-v-chk1a8" style="display: none" type="checkbox"><label class="alectryon-input" for="Composition-v-chk1a8"><span class="kn">Lemma</span> <span class="nf">empty_composition_no_index</span>
  (<span class="nv">i</span> : index)
  : <span class="kt">False</span>.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>message, index</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>EqDecision0</var><span class="hyp-type"><b>: </b><span>EqDecision index</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>finite.Finite index</span></span></span><br><span><var>IM</var><span class="hyp-type"><b>: </b><span>index ‚Üí VLSM message</span></span></span><br><span><var>constraint</var><span class="hyp-type"><b>: </b><span>composite_label IM
‚Üí composite_state IM * option message
  ‚Üí <span class="kt">Prop</span></span></span></span><br><span><var>X</var><span><span class="hyp-body"><b>:= </b><span>composite_vlsm IM constraint</span></span><span class="hyp-type"><b>: </b><span>VLSM message</span></span></span></span><br><span><var>Hempty_index</var><span class="hyp-type"><b>: </b><span>enum index = []</span></span></span><br><span><var>i</var><span class="hyp-type"><b>: </b><span>index</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="kt">False</span></div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="Composition-v-chk1a9" style="display: none" type="checkbox"><label class="alectryon-input" for="Composition-v-chk1a9"><span class="kn">Proof</span>.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>message, index</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>EqDecision0</var><span class="hyp-type"><b>: </b><span>EqDecision index</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>finite.Finite index</span></span></span><br><span><var>IM</var><span class="hyp-type"><b>: </b><span>index ‚Üí VLSM message</span></span></span><br><span><var>constraint</var><span class="hyp-type"><b>: </b><span>composite_label IM
‚Üí composite_state IM * option message
  ‚Üí <span class="kt">Prop</span></span></span></span><br><span><var>X</var><span><span class="hyp-body"><b>:= </b><span>composite_vlsm IM constraint</span></span><span class="hyp-type"><b>: </b><span>VLSM message</span></span></span></span><br><span><var>Hempty_index</var><span class="hyp-type"><b>: </b><span>enum index = []</span></span></span><br><span><var>i</var><span class="hyp-type"><b>: </b><span>index</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="kt">False</span></div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><span class="alectryon-input"><span class="bp">by</span> <span class="nb">specialize</span> (elem_of_enum i); <span class="nb">rewrite</span> Hempty_index; <span class="nb">apply</span> not_elem_of_nil.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Qed</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
</span><span class="alectryon-sentence"><input class="alectryon-toggle" id="Composition-v-chk1aa" style="display: none" type="checkbox"><label class="alectryon-input" for="Composition-v-chk1aa"><span class="kn">Lemma</span> <span class="nf">empty_composition_single_state</span>
  (<span class="nv">s</span> : composite_state IM)
  : s = (proj1_sig (composite_s0 IM)).</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>message, index</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>EqDecision0</var><span class="hyp-type"><b>: </b><span>EqDecision index</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>finite.Finite index</span></span></span><br><span><var>IM</var><span class="hyp-type"><b>: </b><span>index ‚Üí VLSM message</span></span></span><br><span><var>constraint</var><span class="hyp-type"><b>: </b><span>composite_label IM
‚Üí composite_state IM * option message
  ‚Üí <span class="kt">Prop</span></span></span></span><br><span><var>X</var><span><span class="hyp-body"><b>:= </b><span>composite_vlsm IM constraint</span></span><span class="hyp-type"><b>: </b><span>VLSM message</span></span></span></span><br><span><var>Hempty_index</var><span class="hyp-type"><b>: </b><span>enum index = []</span></span></span><br><span><var>s</var><span class="hyp-type"><b>: </b><span>composite_state IM</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">s = `(composite_s0 IM)</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="Composition-v-chk1ab" style="display: none" type="checkbox"><label class="alectryon-input" for="Composition-v-chk1ab"><span class="kn">Proof</span>.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>message, index</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>EqDecision0</var><span class="hyp-type"><b>: </b><span>EqDecision index</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>finite.Finite index</span></span></span><br><span><var>IM</var><span class="hyp-type"><b>: </b><span>index ‚Üí VLSM message</span></span></span><br><span><var>constraint</var><span class="hyp-type"><b>: </b><span>composite_label IM
‚Üí composite_state IM * option message
  ‚Üí <span class="kt">Prop</span></span></span></span><br><span><var>X</var><span><span class="hyp-body"><b>:= </b><span>composite_vlsm IM constraint</span></span><span class="hyp-type"><b>: </b><span>VLSM message</span></span></span></span><br><span><var>Hempty_index</var><span class="hyp-type"><b>: </b><span>enum index = []</span></span></span><br><span><var>s</var><span class="hyp-type"><b>: </b><span>composite_state IM</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">s = `(composite_s0 IM)</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><span class="alectryon-input"><span class="bp">by</span> extensionality i; <span class="nb">elim</span> (empty_composition_no_index i).</span><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Qed</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
</span><span class="alectryon-sentence"><input class="alectryon-toggle" id="Composition-v-chk1ac" style="display: none" type="checkbox"><label class="alectryon-input" for="Composition-v-chk1ac"><span class="kn">Lemma</span> <span class="nf">empty_composition_no_label</span>
  (<span class="nv">l</span> : composite_label IM)
  : <span class="kt">False</span>.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>message, index</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>EqDecision0</var><span class="hyp-type"><b>: </b><span>EqDecision index</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>finite.Finite index</span></span></span><br><span><var>IM</var><span class="hyp-type"><b>: </b><span>index ‚Üí VLSM message</span></span></span><br><span><var>constraint</var><span class="hyp-type"><b>: </b><span>composite_label IM
‚Üí composite_state IM * option message
  ‚Üí <span class="kt">Prop</span></span></span></span><br><span><var>X</var><span><span class="hyp-body"><b>:= </b><span>composite_vlsm IM constraint</span></span><span class="hyp-type"><b>: </b><span>VLSM message</span></span></span></span><br><span><var>Hempty_index</var><span class="hyp-type"><b>: </b><span>enum index = []</span></span></span><br><span><var>l</var><span class="hyp-type"><b>: </b><span>composite_label IM</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="kt">False</span></div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="Composition-v-chk1ad" style="display: none" type="checkbox"><label class="alectryon-input" for="Composition-v-chk1ad"><span class="kn">Proof</span>.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>message, index</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>EqDecision0</var><span class="hyp-type"><b>: </b><span>EqDecision index</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>finite.Finite index</span></span></span><br><span><var>IM</var><span class="hyp-type"><b>: </b><span>index ‚Üí VLSM message</span></span></span><br><span><var>constraint</var><span class="hyp-type"><b>: </b><span>composite_label IM
‚Üí composite_state IM * option message
  ‚Üí <span class="kt">Prop</span></span></span></span><br><span><var>X</var><span><span class="hyp-body"><b>:= </b><span>composite_vlsm IM constraint</span></span><span class="hyp-type"><b>: </b><span>VLSM message</span></span></span></span><br><span><var>Hempty_index</var><span class="hyp-type"><b>: </b><span>enum index = []</span></span></span><br><span><var>l</var><span class="hyp-type"><b>: </b><span>composite_label IM</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="kt">False</span></div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><span class="alectryon-input"><span class="bp">by</span> <span class="nb">destruct</span> l <span class="kr">as</span> [i _]; <span class="nb">elim</span> (empty_composition_no_index i).</span><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Qed</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
</span><span class="alectryon-sentence"><input class="alectryon-toggle" id="Composition-v-chk1ae" style="display: none" type="checkbox"><label class="alectryon-input" for="Composition-v-chk1ae"><span class="kn">Lemma</span> <span class="nf">empty_composition_no_initial_message</span>
  : <span class="kr">forall</span> <span class="nv">m</span>, ~ composite_initial_message_prop IM m.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>message, index</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>EqDecision0</var><span class="hyp-type"><b>: </b><span>EqDecision index</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>finite.Finite index</span></span></span><br><span><var>IM</var><span class="hyp-type"><b>: </b><span>index ‚Üí VLSM message</span></span></span><br><span><var>constraint</var><span class="hyp-type"><b>: </b><span>composite_label IM
‚Üí composite_state IM * option message
  ‚Üí <span class="kt">Prop</span></span></span></span><br><span><var>X</var><span><span class="hyp-body"><b>:= </b><span>composite_vlsm IM constraint</span></span><span class="hyp-type"><b>: </b><span>VLSM message</span></span></span></span><br><span><var>Hempty_index</var><span class="hyp-type"><b>: </b><span>enum index = []</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="kr">‚àÄ</span> <span class="nv">m</span> : message, ¬¨ composite_initial_message_prop IM m</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="Composition-v-chk1af" style="display: none" type="checkbox"><label class="alectryon-input" for="Composition-v-chk1af"><span class="kn">Proof</span>.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>message, index</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>EqDecision0</var><span class="hyp-type"><b>: </b><span>EqDecision index</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>finite.Finite index</span></span></span><br><span><var>IM</var><span class="hyp-type"><b>: </b><span>index ‚Üí VLSM message</span></span></span><br><span><var>constraint</var><span class="hyp-type"><b>: </b><span>composite_label IM
‚Üí composite_state IM * option message
  ‚Üí <span class="kt">Prop</span></span></span></span><br><span><var>X</var><span><span class="hyp-body"><b>:= </b><span>composite_vlsm IM constraint</span></span><span class="hyp-type"><b>: </b><span>VLSM message</span></span></span></span><br><span><var>Hempty_index</var><span class="hyp-type"><b>: </b><span>enum index = []</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="kr">‚àÄ</span> <span class="nv">m</span> : message, ¬¨ composite_initial_message_prop IM m</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><span class="alectryon-input"><span class="bp">by</span> <span class="nb">intros</span> m [i _]; <span class="nb">elim</span> (empty_composition_no_index i).</span><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Qed</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
</span><span class="alectryon-sentence"><input class="alectryon-toggle" id="Composition-v-chk1b0" style="display: none" type="checkbox"><label class="alectryon-input" for="Composition-v-chk1b0"><span class="kn">Lemma</span> <span class="nf">empty_composition_no_emit</span>
  : <span class="kr">forall</span> <span class="nv">m</span>, ~ can_emit X m.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>message, index</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>EqDecision0</var><span class="hyp-type"><b>: </b><span>EqDecision index</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>finite.Finite index</span></span></span><br><span><var>IM</var><span class="hyp-type"><b>: </b><span>index ‚Üí VLSM message</span></span></span><br><span><var>constraint</var><span class="hyp-type"><b>: </b><span>composite_label IM
‚Üí composite_state IM * option message
  ‚Üí <span class="kt">Prop</span></span></span></span><br><span><var>X</var><span><span class="hyp-body"><b>:= </b><span>composite_vlsm IM constraint</span></span><span class="hyp-type"><b>: </b><span>VLSM message</span></span></span></span><br><span><var>Hempty_index</var><span class="hyp-type"><b>: </b><span>enum index = []</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="kr">‚àÄ</span> <span class="nv">m</span> : message, ¬¨ can_emit X m</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="Composition-v-chk1b1" style="display: none" type="checkbox"><label class="alectryon-input" for="Composition-v-chk1b1"><span class="kn">Proof</span>.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>message, index</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>EqDecision0</var><span class="hyp-type"><b>: </b><span>EqDecision index</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>finite.Finite index</span></span></span><br><span><var>IM</var><span class="hyp-type"><b>: </b><span>index ‚Üí VLSM message</span></span></span><br><span><var>constraint</var><span class="hyp-type"><b>: </b><span>composite_label IM
‚Üí composite_state IM * option message
  ‚Üí <span class="kt">Prop</span></span></span></span><br><span><var>X</var><span><span class="hyp-body"><b>:= </b><span>composite_vlsm IM constraint</span></span><span class="hyp-type"><b>: </b><span>VLSM message</span></span></span></span><br><span><var>Hempty_index</var><span class="hyp-type"><b>: </b><span>enum index = []</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="kr">‚àÄ</span> <span class="nv">m</span> : message, ¬¨ can_emit X m</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><span class="alectryon-input"><span class="bp">by</span> <span class="nb">intros</span> m [s&#39; [l _]]; <span class="nb">elim</span> (empty_composition_no_label l).</span><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Qed</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
</span><span class="alectryon-sentence"><input class="alectryon-toggle" id="Composition-v-chk1b2" style="display: none" type="checkbox"><label class="alectryon-input" for="Composition-v-chk1b2"><span class="kn">Lemma</span> <span class="nf">empty_composition_no_valid_message</span>
  : <span class="kr">forall</span> <span class="nv">m</span>, ~ valid_message_prop X m.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>message, index</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>EqDecision0</var><span class="hyp-type"><b>: </b><span>EqDecision index</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>finite.Finite index</span></span></span><br><span><var>IM</var><span class="hyp-type"><b>: </b><span>index ‚Üí VLSM message</span></span></span><br><span><var>constraint</var><span class="hyp-type"><b>: </b><span>composite_label IM
‚Üí composite_state IM * option message
  ‚Üí <span class="kt">Prop</span></span></span></span><br><span><var>X</var><span><span class="hyp-body"><b>:= </b><span>composite_vlsm IM constraint</span></span><span class="hyp-type"><b>: </b><span>VLSM message</span></span></span></span><br><span><var>Hempty_index</var><span class="hyp-type"><b>: </b><span>enum index = []</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="kr">‚àÄ</span> <span class="nv">m</span> : message, ¬¨ valid_message_prop X m</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="Composition-v-chk1b3" style="display: none" type="checkbox"><label class="alectryon-input" for="Composition-v-chk1b3"><span class="kn">Proof</span>.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>message, index</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>EqDecision0</var><span class="hyp-type"><b>: </b><span>EqDecision index</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>finite.Finite index</span></span></span><br><span><var>IM</var><span class="hyp-type"><b>: </b><span>index ‚Üí VLSM message</span></span></span><br><span><var>constraint</var><span class="hyp-type"><b>: </b><span>composite_label IM
‚Üí composite_state IM * option message
  ‚Üí <span class="kt">Prop</span></span></span></span><br><span><var>X</var><span><span class="hyp-body"><b>:= </b><span>composite_vlsm IM constraint</span></span><span class="hyp-type"><b>: </b><span>VLSM message</span></span></span></span><br><span><var>Hempty_index</var><span class="hyp-type"><b>: </b><span>enum index = []</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="kr">‚àÄ</span> <span class="nv">m</span> : message, ¬¨ valid_message_prop X m</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="Composition-v-chk1b4" style="display: none" type="checkbox"><label class="alectryon-input" for="Composition-v-chk1b4"><span class="nb">intros</span> m Hm.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>message, index</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>EqDecision0</var><span class="hyp-type"><b>: </b><span>EqDecision index</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>finite.Finite index</span></span></span><br><span><var>IM</var><span class="hyp-type"><b>: </b><span>index ‚Üí VLSM message</span></span></span><br><span><var>constraint</var><span class="hyp-type"><b>: </b><span>composite_label IM
‚Üí composite_state IM * option message
  ‚Üí <span class="kt">Prop</span></span></span></span><br><span><var>X</var><span><span class="hyp-body"><b>:= </b><span>composite_vlsm IM constraint</span></span><span class="hyp-type"><b>: </b><span>VLSM message</span></span></span></span><br><span><var>Hempty_index</var><span class="hyp-type"><b>: </b><span>enum index = []</span></span></span><br><span><var>m</var><span class="hyp-type"><b>: </b><span>message</span></span></span><br><span><var>Hm</var><span class="hyp-type"><b>: </b><span>valid_message_prop X m</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="kt">False</span></div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="Composition-v-chk1b5" style="display: none" type="checkbox"><label class="alectryon-input" for="Composition-v-chk1b5"><span class="nb">apply</span> emitted_messages_are_valid_iff <span class="kr">in</span> Hm <span class="kr">as</span> [Hinit | Hemit].</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>message, index</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>EqDecision0</var><span class="hyp-type"><b>: </b><span>EqDecision index</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>finite.Finite index</span></span></span><br><span><var>IM</var><span class="hyp-type"><b>: </b><span>index ‚Üí VLSM message</span></span></span><br><span><var>constraint</var><span class="hyp-type"><b>: </b><span>composite_label IM
‚Üí composite_state IM * option message
  ‚Üí <span class="kt">Prop</span></span></span></span><br><span><var>X</var><span><span class="hyp-body"><b>:= </b><span>composite_vlsm IM constraint</span></span><span class="hyp-type"><b>: </b><span>VLSM message</span></span></span></span><br><span><var>Hempty_index</var><span class="hyp-type"><b>: </b><span>enum index = []</span></span></span><br><span><var>m</var><span class="hyp-type"><b>: </b><span>message</span></span></span><br><span><var>Hinit</var><span class="hyp-type"><b>: </b><span>initial_message_prop m</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="kt">False</span></div></blockquote><div class="alectryon-extra-goals"><input class="alectryon-extra-goal-toggle" id="Composition-v-chk1b6" style="display: none" type="checkbox"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>message, index</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>EqDecision0</var><span class="hyp-type"><b>: </b><span>EqDecision index</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>finite.Finite index</span></span></span><br><span><var>IM</var><span class="hyp-type"><b>: </b><span>index ‚Üí VLSM message</span></span></span><br><span><var>constraint</var><span class="hyp-type"><b>: </b><span>composite_label IM
‚Üí composite_state IM * option message
  ‚Üí <span class="kt">Prop</span></span></span></span><br><span><var>X</var><span><span class="hyp-body"><b>:= </b><span>composite_vlsm IM constraint</span></span><span class="hyp-type"><b>: </b><span>VLSM message</span></span></span></span><br><span><var>Hempty_index</var><span class="hyp-type"><b>: </b><span>enum index = []</span></span></span><br><span><var>m</var><span class="hyp-type"><b>: </b><span>message</span></span></span><br><span><var>Hemit</var><span class="hyp-type"><b>: </b><span>can_emit X m</span></span></span><br></div><label class="goal-separator" for="Composition-v-chk1b6"><hr></label><div class="goal-conclusion"><span class="kt">False</span></div></blockquote></div></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="Composition-v-chk1b7" style="display: none" type="checkbox"><label class="alectryon-input" for="Composition-v-chk1b7">-</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>message, index</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>EqDecision0</var><span class="hyp-type"><b>: </b><span>EqDecision index</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>finite.Finite index</span></span></span><br><span><var>IM</var><span class="hyp-type"><b>: </b><span>index ‚Üí VLSM message</span></span></span><br><span><var>constraint</var><span class="hyp-type"><b>: </b><span>composite_label IM
‚Üí composite_state IM * option message
  ‚Üí <span class="kt">Prop</span></span></span></span><br><span><var>X</var><span><span class="hyp-body"><b>:= </b><span>composite_vlsm IM constraint</span></span><span class="hyp-type"><b>: </b><span>VLSM message</span></span></span></span><br><span><var>Hempty_index</var><span class="hyp-type"><b>: </b><span>enum index = []</span></span></span><br><span><var>m</var><span class="hyp-type"><b>: </b><span>message</span></span></span><br><span><var>Hinit</var><span class="hyp-type"><b>: </b><span>initial_message_prop m</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="kt">False</span></div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="bp">by</span> <span class="nb">elim</span> (empty_composition_no_initial_message _ Hinit).</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="Composition-v-chk1b8" style="display: none" type="checkbox"><label class="alectryon-input" for="Composition-v-chk1b8">-</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>message, index</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>EqDecision0</var><span class="hyp-type"><b>: </b><span>EqDecision index</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>finite.Finite index</span></span></span><br><span><var>IM</var><span class="hyp-type"><b>: </b><span>index ‚Üí VLSM message</span></span></span><br><span><var>constraint</var><span class="hyp-type"><b>: </b><span>composite_label IM
‚Üí composite_state IM * option message
  ‚Üí <span class="kt">Prop</span></span></span></span><br><span><var>X</var><span><span class="hyp-body"><b>:= </b><span>composite_vlsm IM constraint</span></span><span class="hyp-type"><b>: </b><span>VLSM message</span></span></span></span><br><span><var>Hempty_index</var><span class="hyp-type"><b>: </b><span>enum index = []</span></span></span><br><span><var>m</var><span class="hyp-type"><b>: </b><span>message</span></span></span><br><span><var>Hemit</var><span class="hyp-type"><b>: </b><span>can_emit X m</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="kt">False</span></div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="bp">by</span> <span class="nb">elim</span> (empty_composition_no_emit _ Hemit).</span><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Qed</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
</span><span class="alectryon-sentence"><input class="alectryon-toggle" id="Composition-v-chk1b9" style="display: none" type="checkbox"><label class="alectryon-input" for="Composition-v-chk1b9"><span class="kn">Lemma</span> <span class="nf">preloaded_empty_composition_no_emit</span>
  (<span class="nv">seed</span> : message -&gt; <span class="kt">Prop</span>)
  (<span class="nv">PreX</span> := preloaded_vlsm X seed)
  : <span class="kr">forall</span> <span class="nv">m</span>, ~ can_emit PreX m.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>message, index</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>EqDecision0</var><span class="hyp-type"><b>: </b><span>EqDecision index</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>finite.Finite index</span></span></span><br><span><var>IM</var><span class="hyp-type"><b>: </b><span>index ‚Üí VLSM message</span></span></span><br><span><var>constraint</var><span class="hyp-type"><b>: </b><span>composite_label IM
‚Üí composite_state IM * option message
  ‚Üí <span class="kt">Prop</span></span></span></span><br><span><var>X</var><span><span class="hyp-body"><b>:= </b><span>composite_vlsm IM constraint</span></span><span class="hyp-type"><b>: </b><span>VLSM message</span></span></span></span><br><span><var>Hempty_index</var><span class="hyp-type"><b>: </b><span>enum index = []</span></span></span><br><span><var>seed</var><span class="hyp-type"><b>: </b><span>message ‚Üí <span class="kt">Prop</span></span></span></span><br><span><var>PreX</var><span><span class="hyp-body"><b>:= </b><span>preloaded_vlsm X seed</span></span><span class="hyp-type"><b>: </b><span>VLSM message</span></span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="kr">‚àÄ</span> <span class="nv">m</span> : message, ¬¨ can_emit PreX m</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="Composition-v-chk1ba" style="display: none" type="checkbox"><label class="alectryon-input" for="Composition-v-chk1ba"><span class="kn">Proof</span>.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>message, index</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>EqDecision0</var><span class="hyp-type"><b>: </b><span>EqDecision index</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>finite.Finite index</span></span></span><br><span><var>IM</var><span class="hyp-type"><b>: </b><span>index ‚Üí VLSM message</span></span></span><br><span><var>constraint</var><span class="hyp-type"><b>: </b><span>composite_label IM
‚Üí composite_state IM * option message
  ‚Üí <span class="kt">Prop</span></span></span></span><br><span><var>X</var><span><span class="hyp-body"><b>:= </b><span>composite_vlsm IM constraint</span></span><span class="hyp-type"><b>: </b><span>VLSM message</span></span></span></span><br><span><var>Hempty_index</var><span class="hyp-type"><b>: </b><span>enum index = []</span></span></span><br><span><var>seed</var><span class="hyp-type"><b>: </b><span>message ‚Üí <span class="kt">Prop</span></span></span></span><br><span><var>PreX</var><span><span class="hyp-body"><b>:= </b><span>preloaded_vlsm X seed</span></span><span class="hyp-type"><b>: </b><span>VLSM message</span></span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="kr">‚àÄ</span> <span class="nv">m</span> : message, ¬¨ can_emit PreX m</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><span class="alectryon-input"><span class="bp">by</span> <span class="nb">intros</span> m [s&#39; [l _]]; <span class="nb">elim</span> (empty_composition_no_label l).</span><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Qed</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
</span><span class="alectryon-sentence"><input class="alectryon-toggle" id="Composition-v-chk1bb" style="display: none" type="checkbox"><label class="alectryon-input" for="Composition-v-chk1bb"><span class="kn">Lemma</span> <span class="nf">preloaded_empty_free_composition_no_emit</span>
  (<span class="nv">seed</span> : message -&gt; <span class="kt">Prop</span>)
  (<span class="nv">PreX</span> := preloaded_vlsm (free_composite_vlsm IM) seed)
  : <span class="kr">forall</span> <span class="nv">m</span>, ~ can_emit PreX m.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>message, index</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>EqDecision0</var><span class="hyp-type"><b>: </b><span>EqDecision index</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>finite.Finite index</span></span></span><br><span><var>IM</var><span class="hyp-type"><b>: </b><span>index ‚Üí VLSM message</span></span></span><br><span><var>constraint</var><span class="hyp-type"><b>: </b><span>composite_label IM
‚Üí composite_state IM * option message
  ‚Üí <span class="kt">Prop</span></span></span></span><br><span><var>X</var><span><span class="hyp-body"><b>:= </b><span>composite_vlsm IM constraint</span></span><span class="hyp-type"><b>: </b><span>VLSM message</span></span></span></span><br><span><var>Hempty_index</var><span class="hyp-type"><b>: </b><span>enum index = []</span></span></span><br><span><var>seed</var><span class="hyp-type"><b>: </b><span>message ‚Üí <span class="kt">Prop</span></span></span></span><br><span><var>PreX</var><span><span class="hyp-body"><b>:= </b><span>preloaded_vlsm (free_composite_vlsm IM) seed</span></span><span class="hyp-type"><b>: </b><span>VLSM message</span></span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="kr">‚àÄ</span> <span class="nv">m</span> : message, ¬¨ can_emit PreX m</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="Composition-v-chk1bc" style="display: none" type="checkbox"><label class="alectryon-input" for="Composition-v-chk1bc"><span class="kn">Proof</span>.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>message, index</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>EqDecision0</var><span class="hyp-type"><b>: </b><span>EqDecision index</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>finite.Finite index</span></span></span><br><span><var>IM</var><span class="hyp-type"><b>: </b><span>index ‚Üí VLSM message</span></span></span><br><span><var>constraint</var><span class="hyp-type"><b>: </b><span>composite_label IM
‚Üí composite_state IM * option message
  ‚Üí <span class="kt">Prop</span></span></span></span><br><span><var>X</var><span><span class="hyp-body"><b>:= </b><span>composite_vlsm IM constraint</span></span><span class="hyp-type"><b>: </b><span>VLSM message</span></span></span></span><br><span><var>Hempty_index</var><span class="hyp-type"><b>: </b><span>enum index = []</span></span></span><br><span><var>seed</var><span class="hyp-type"><b>: </b><span>message ‚Üí <span class="kt">Prop</span></span></span></span><br><span><var>PreX</var><span><span class="hyp-body"><b>:= </b><span>preloaded_vlsm (free_composite_vlsm IM) seed</span></span><span class="hyp-type"><b>: </b><span>VLSM message</span></span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="kr">‚àÄ</span> <span class="nv">m</span> : message, ¬¨ can_emit PreX m</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><span class="alectryon-input"><span class="bp">by</span> <span class="nb">intros</span> m [s&#39; [l _]]; <span class="nb">elim</span> (empty_composition_no_label l).</span><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Qed</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
</span><span class="alectryon-sentence"><input class="alectryon-toggle" id="Composition-v-chk1bd" style="display: none" type="checkbox"><label class="alectryon-input" for="Composition-v-chk1bd"><span class="kn">Lemma</span> <span class="nf">preloaded_with_all_empty_composition_no_emit</span>
  : <span class="kr">forall</span> <span class="nv">m</span>, ~ can_emit (preloaded_with_all_messages_vlsm X) m.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>message, index</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>EqDecision0</var><span class="hyp-type"><b>: </b><span>EqDecision index</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>finite.Finite index</span></span></span><br><span><var>IM</var><span class="hyp-type"><b>: </b><span>index ‚Üí VLSM message</span></span></span><br><span><var>constraint</var><span class="hyp-type"><b>: </b><span>composite_label IM
‚Üí composite_state IM * option message
  ‚Üí <span class="kt">Prop</span></span></span></span><br><span><var>X</var><span><span class="hyp-body"><b>:= </b><span>composite_vlsm IM constraint</span></span><span class="hyp-type"><b>: </b><span>VLSM message</span></span></span></span><br><span><var>Hempty_index</var><span class="hyp-type"><b>: </b><span>enum index = []</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="kr">‚àÄ</span> <span class="nv">m</span> : message,
  ¬¨ can_emit (preloaded_with_all_messages_vlsm X) m</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="Composition-v-chk1be" style="display: none" type="checkbox"><label class="alectryon-input" for="Composition-v-chk1be"><span class="kn">Proof</span>.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>message, index</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>EqDecision0</var><span class="hyp-type"><b>: </b><span>EqDecision index</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>finite.Finite index</span></span></span><br><span><var>IM</var><span class="hyp-type"><b>: </b><span>index ‚Üí VLSM message</span></span></span><br><span><var>constraint</var><span class="hyp-type"><b>: </b><span>composite_label IM
‚Üí composite_state IM * option message
  ‚Üí <span class="kt">Prop</span></span></span></span><br><span><var>X</var><span><span class="hyp-body"><b>:= </b><span>composite_vlsm IM constraint</span></span><span class="hyp-type"><b>: </b><span>VLSM message</span></span></span></span><br><span><var>Hempty_index</var><span class="hyp-type"><b>: </b><span>enum index = []</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="kr">‚àÄ</span> <span class="nv">m</span> : message,
  ¬¨ can_emit (preloaded_with_all_messages_vlsm X) m</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><span class="alectryon-input"><span class="bp">by</span> <span class="nb">intros</span> m [s&#39; [l _]]; <span class="nb">elim</span> (empty_composition_no_label l).</span><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Qed</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
</span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">End</span> <span class="nf">sec_empty_composition_properties</span>.</span></span></pre><div class="doc">
<a id="lab12"></a><h2 class="section">Properties of extensionally-equal indexed compositions</h2>
<div class="paragraph"> </div>

  If two indexed sets of VLSMs are extensionally-equal, then we can establish a
  <span class="inlinecode"><span class="id" title="var">VLSM_embedding</span></span> between their compositions with subsumable constraints
  (and preloaded with the same set of messages).

</div><pre class="alectryon-io highlight"><!-- Generator: Alectryon --><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Section</span> <span class="nf">sec_same_IM_embedding</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
</span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Context</span>
  {<span class="nv">message</span> : <span class="kt">Type</span>}
  `{EqDecision index}
  (IM1 IM2 : index -&gt; VLSM message)
  (Heq : <span class="kr">forall</span> <span class="nv">i</span>, IM1 i = IM2 i)
  .</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
</span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Definition</span> <span class="nf">same_IM_label_rew</span>
  (<span class="nv">l1</span> : composite_label IM1)
  : composite_label IM2 :=
  existT (projT1 l1) (same_VLSM_label_rew (Heq (projT1 l1)) (projT2 l1)).</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
</span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Definition</span> <span class="nf">same_IM_state_rew</span>
  (<span class="nv">s1</span> : composite_state IM1)
  : composite_state IM2 :=
  <span class="kr">fun</span> <span class="nv">i</span> =&gt; same_VLSM_state_rew (Heq i) (s1 i).</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
</span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Section</span> <span class="nf">sec_preloaded_constrained</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
</span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Context</span>
  (<span class="nv">constraint1</span> : composite_label IM1 -&gt; composite_state IM1 * option message -&gt; <span class="kt">Prop</span>)
  (<span class="nv">constraint2</span> : composite_label IM2 -&gt; composite_state IM2 * option message -&gt; <span class="kt">Prop</span>)
  (<span class="nv">constraint_projection</span>
    : <span class="kr">forall</span> <span class="nv">s1</span>, constrained_state_prop (free_composite_vlsm IM1) s1 -&gt;
      <span class="kr">forall</span> <span class="nv">l1</span> <span class="nv">om</span>, constraint1 l1 (s1, om) -&gt;
    constraint2 (same_IM_label_rew l1) (same_IM_state_rew s1, om))
  (<span class="nv">seed</span> : message -&gt; <span class="kt">Prop</span>)
  .</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
</span><span class="alectryon-sentence"><input class="alectryon-toggle" id="Composition-v-chk1bf" style="display: none" type="checkbox"><label class="alectryon-input" for="Composition-v-chk1bf"><span class="kn">Lemma</span> <span class="nf">same_IM_embedding</span>
  : VLSM_embedding
    (preloaded_vlsm (composite_vlsm IM1 constraint1) seed)
    (preloaded_vlsm (composite_vlsm IM2 constraint2) seed)
    same_IM_label_rew
    same_IM_state_rew.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>message, index</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>EqDecision0</var><span class="hyp-type"><b>: </b><span>EqDecision index</span></span></span><br><span><var>IM1, IM2</var><span class="hyp-type"><b>: </b><span>index ‚Üí VLSM message</span></span></span><br><span><var>Heq</var><span class="hyp-type"><b>: </b><span><span class="kr">‚àÄ</span> <span class="nv">i</span> : index, IM1 i = IM2 i</span></span></span><br><span><var>constraint1</var><span class="hyp-type"><b>: </b><span>composite_label IM1
‚Üí composite_state IM1 * option message
  ‚Üí <span class="kt">Prop</span></span></span></span><br><span><var>constraint2</var><span class="hyp-type"><b>: </b><span>composite_label IM2
‚Üí composite_state IM2 * option message
  ‚Üí <span class="kt">Prop</span></span></span></span><br><span><var>constraint_projection</var><span class="hyp-type"><b>: </b><span><span class="kr">‚àÄ</span> <span class="nv">s1</span> : state
         (preloaded_with_all_messages_vlsm
            (free_composite_vlsm
               IM1)),
  constrained_state_prop
    (free_composite_vlsm IM1)
    s1
  ‚Üí <span class="kr">‚àÄ</span> (<span class="nv">l1</span> : composite_label
              IM1) (<span class="nv">om</span> : 
                    option
                      message),
      constraint1 l1 (s1, om)
      ‚Üí constraint2
          (same_IM_label_rew
             l1)
          (same_IM_state_rew
             s1, om)</span></span></span><br><span><var>seed</var><span class="hyp-type"><b>: </b><span>message ‚Üí <span class="kt">Prop</span></span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">VLSM_embedding
  (preloaded_vlsm (composite_vlsm IM1 constraint1)
     seed)
  (preloaded_vlsm (composite_vlsm IM2 constraint2)
     seed) same_IM_label_rew same_IM_state_rew</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="Composition-v-chk1c0" style="display: none" type="checkbox"><label class="alectryon-input" for="Composition-v-chk1c0"><span class="kn">Proof</span>.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>message, index</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>EqDecision0</var><span class="hyp-type"><b>: </b><span>EqDecision index</span></span></span><br><span><var>IM1, IM2</var><span class="hyp-type"><b>: </b><span>index ‚Üí VLSM message</span></span></span><br><span><var>Heq</var><span class="hyp-type"><b>: </b><span><span class="kr">‚àÄ</span> <span class="nv">i</span> : index, IM1 i = IM2 i</span></span></span><br><span><var>constraint1</var><span class="hyp-type"><b>: </b><span>composite_label IM1
‚Üí composite_state IM1 * option message
  ‚Üí <span class="kt">Prop</span></span></span></span><br><span><var>constraint2</var><span class="hyp-type"><b>: </b><span>composite_label IM2
‚Üí composite_state IM2 * option message
  ‚Üí <span class="kt">Prop</span></span></span></span><br><span><var>constraint_projection</var><span class="hyp-type"><b>: </b><span><span class="kr">‚àÄ</span> <span class="nv">s1</span> : state
         (preloaded_with_all_messages_vlsm
            (free_composite_vlsm
               IM1)),
  constrained_state_prop
    (free_composite_vlsm IM1)
    s1
  ‚Üí <span class="kr">‚àÄ</span> (<span class="nv">l1</span> : composite_label
              IM1) (<span class="nv">om</span> : 
                    option
                      message),
      constraint1 l1 (s1, om)
      ‚Üí constraint2
          (same_IM_label_rew
             l1)
          (same_IM_state_rew
             s1, om)</span></span></span><br><span><var>seed</var><span class="hyp-type"><b>: </b><span>message ‚Üí <span class="kt">Prop</span></span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">VLSM_embedding
  (preloaded_vlsm (composite_vlsm IM1 constraint1)
     seed)
  (preloaded_vlsm (composite_vlsm IM2 constraint2)
     seed) same_IM_label_rew same_IM_state_rew</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="Composition-v-chk1c1" style="display: none" type="checkbox"><label class="alectryon-input" for="Composition-v-chk1c1"><span class="nb">apply</span> basic_VLSM_embedding; <span class="nb">intros</span> l **.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>message, index</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>EqDecision0</var><span class="hyp-type"><b>: </b><span>EqDecision index</span></span></span><br><span><var>IM1, IM2</var><span class="hyp-type"><b>: </b><span>index ‚Üí VLSM message</span></span></span><br><span><var>Heq</var><span class="hyp-type"><b>: </b><span><span class="kr">‚àÄ</span> <span class="nv">i</span> : index, IM1 i = IM2 i</span></span></span><br><span><var>constraint1</var><span class="hyp-type"><b>: </b><span>composite_label IM1
‚Üí composite_state IM1 * option message
  ‚Üí <span class="kt">Prop</span></span></span></span><br><span><var>constraint2</var><span class="hyp-type"><b>: </b><span>composite_label IM2
‚Üí composite_state IM2 * option message
  ‚Üí <span class="kt">Prop</span></span></span></span><br><span><var>constraint_projection</var><span class="hyp-type"><b>: </b><span><span class="kr">‚àÄ</span> <span class="nv">s1</span> : state
         (preloaded_with_all_messages_vlsm
            (free_composite_vlsm
               IM1)),
  constrained_state_prop
    (free_composite_vlsm IM1)
    s1
  ‚Üí <span class="kr">‚àÄ</span> (<span class="nv">l1</span> : composite_label
              IM1) (<span class="nv">om</span> : 
                    option
                      message),
      constraint1 l1 (s1, om)
      ‚Üí constraint2
          (same_IM_label_rew
             l1)
          (same_IM_state_rew
             s1, om)</span></span></span><br><span><var>seed</var><span class="hyp-type"><b>: </b><span>message ‚Üí <span class="kt">Prop</span></span></span></span><br><span><var>l</var><span class="hyp-type"><b>: </b><span>label
  (preloaded_vlsm (composite_vlsm IM1 constraint1)
     seed)</span></span></span><br><span><var>s</var><span class="hyp-type"><b>: </b><span>state
  (preloaded_vlsm (composite_vlsm IM1 constraint1)
     seed)</span></span></span><br><span><var>om</var><span class="hyp-type"><b>: </b><span>option message</span></span></span><br><span><var>Hv</var><span class="hyp-type"><b>: </b><span>input_valid
  (preloaded_vlsm
     (composite_vlsm IM1 constraint1) seed) l
  (s, om)</span></span></span><br><span><var>HsY</var><span class="hyp-type"><b>: </b><span>valid_state_prop
  (preloaded_vlsm
     (composite_vlsm IM2 constraint2) seed)
  (same_IM_state_rew s)</span></span></span><br><span><var>HomY</var><span class="hyp-type"><b>: </b><span>option_valid_message_prop
  (preloaded_vlsm
     (composite_vlsm IM2 constraint2) seed) om</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">valid (same_IM_label_rew l) (same_IM_state_rew s, om)</div></blockquote><div class="alectryon-extra-goals"><input class="alectryon-extra-goal-toggle" id="Composition-v-chk1c2" style="display: none" type="checkbox"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>message, index</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>EqDecision0</var><span class="hyp-type"><b>: </b><span>EqDecision index</span></span></span><br><span><var>IM1, IM2</var><span class="hyp-type"><b>: </b><span>index ‚Üí VLSM message</span></span></span><br><span><var>Heq</var><span class="hyp-type"><b>: </b><span><span class="kr">‚àÄ</span> <span class="nv">i</span> : index, IM1 i = IM2 i</span></span></span><br><span><var>constraint1</var><span class="hyp-type"><b>: </b><span>composite_label IM1
‚Üí composite_state IM1 * option message
  ‚Üí <span class="kt">Prop</span></span></span></span><br><span><var>constraint2</var><span class="hyp-type"><b>: </b><span>composite_label IM2
‚Üí composite_state IM2 * option message
  ‚Üí <span class="kt">Prop</span></span></span></span><br><span><var>constraint_projection</var><span class="hyp-type"><b>: </b><span><span class="kr">‚àÄ</span> <span class="nv">s1</span> : state
         (preloaded_with_all_messages_vlsm
            (free_composite_vlsm
               IM1)),
  constrained_state_prop
    (free_composite_vlsm IM1)
    s1
  ‚Üí <span class="kr">‚àÄ</span> (<span class="nv">l1</span> : composite_label
              IM1) (<span class="nv">om</span> : 
                    option
                      message),
      constraint1 l1 (s1, om)
      ‚Üí constraint2
          (same_IM_label_rew
             l1)
          (same_IM_state_rew
             s1, om)</span></span></span><br><span><var>seed</var><span class="hyp-type"><b>: </b><span>message ‚Üí <span class="kt">Prop</span></span></span></span><br><span><var>l</var><span class="hyp-type"><b>: </b><span>label
  (preloaded_vlsm (composite_vlsm IM1 constraint1)
     seed)</span></span></span><br><span><var>s</var><span class="hyp-type"><b>: </b><span>state
  (preloaded_vlsm (composite_vlsm IM1 constraint1)
     seed)</span></span></span><br><span><var>om</var><span class="hyp-type"><b>: </b><span>option message</span></span></span><br><span><var>s'</var><span class="hyp-type"><b>: </b><span>state
  (preloaded_vlsm
     (composite_vlsm IM1 constraint1) seed)</span></span></span><br><span><var>om'</var><span class="hyp-type"><b>: </b><span>option message</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>input_valid_transition
  (preloaded_vlsm (composite_vlsm IM1 constraint1)
     seed) l (s, om) (s&#39;, om&#39;)</span></span></span><br></div><label class="goal-separator" for="Composition-v-chk1c2"><hr></label><div class="goal-conclusion">transition (same_IM_label_rew l)
  (same_IM_state_rew s, om) =
(same_IM_state_rew s&#39;, om&#39;)</div></blockquote><input class="alectryon-extra-goal-toggle" id="Composition-v-chk1c3" style="display: none" type="checkbox"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>message, index</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>EqDecision0</var><span class="hyp-type"><b>: </b><span>EqDecision index</span></span></span><br><span><var>IM1, IM2</var><span class="hyp-type"><b>: </b><span>index ‚Üí VLSM message</span></span></span><br><span><var>Heq</var><span class="hyp-type"><b>: </b><span><span class="kr">‚àÄ</span> <span class="nv">i</span> : index, IM1 i = IM2 i</span></span></span><br><span><var>constraint1</var><span class="hyp-type"><b>: </b><span>composite_label IM1
‚Üí composite_state IM1 * option message
  ‚Üí <span class="kt">Prop</span></span></span></span><br><span><var>constraint2</var><span class="hyp-type"><b>: </b><span>composite_label IM2
‚Üí composite_state IM2 * option message
  ‚Üí <span class="kt">Prop</span></span></span></span><br><span><var>constraint_projection</var><span class="hyp-type"><b>: </b><span><span class="kr">‚àÄ</span> <span class="nv">s1</span> : state
         (preloaded_with_all_messages_vlsm
            (free_composite_vlsm
               IM1)),
  constrained_state_prop
    (free_composite_vlsm IM1)
    s1
  ‚Üí <span class="kr">‚àÄ</span> (<span class="nv">l1</span> : composite_label
              IM1) (<span class="nv">om</span> : 
                    option
                      message),
      constraint1 l1 (s1, om)
      ‚Üí constraint2
          (same_IM_label_rew
             l1)
          (same_IM_state_rew
             s1, om)</span></span></span><br><span><var>seed</var><span class="hyp-type"><b>: </b><span>message ‚Üí <span class="kt">Prop</span></span></span></span><br><span><var>l</var><span class="hyp-type"><b>: </b><span>state
  (preloaded_vlsm (composite_vlsm IM1 constraint1)
     seed)</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>initial_state_prop l</span></span></span><br></div><label class="goal-separator" for="Composition-v-chk1c3"><hr></label><div class="goal-conclusion">initial_state_prop (same_IM_state_rew l)</div></blockquote><input class="alectryon-extra-goal-toggle" id="Composition-v-chk1c4" style="display: none" type="checkbox"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>message, index</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>EqDecision0</var><span class="hyp-type"><b>: </b><span>EqDecision index</span></span></span><br><span><var>IM1, IM2</var><span class="hyp-type"><b>: </b><span>index ‚Üí VLSM message</span></span></span><br><span><var>Heq</var><span class="hyp-type"><b>: </b><span><span class="kr">‚àÄ</span> <span class="nv">i</span> : index, IM1 i = IM2 i</span></span></span><br><span><var>constraint1</var><span class="hyp-type"><b>: </b><span>composite_label IM1
‚Üí composite_state IM1 * option message
  ‚Üí <span class="kt">Prop</span></span></span></span><br><span><var>constraint2</var><span class="hyp-type"><b>: </b><span>composite_label IM2
‚Üí composite_state IM2 * option message
  ‚Üí <span class="kt">Prop</span></span></span></span><br><span><var>constraint_projection</var><span class="hyp-type"><b>: </b><span><span class="kr">‚àÄ</span> <span class="nv">s1</span> : state
         (preloaded_with_all_messages_vlsm
            (free_composite_vlsm
               IM1)),
  constrained_state_prop
    (free_composite_vlsm IM1)
    s1
  ‚Üí <span class="kr">‚àÄ</span> (<span class="nv">l1</span> : composite_label
              IM1) (<span class="nv">om</span> : 
                    option
                      message),
      constraint1 l1 (s1, om)
      ‚Üí constraint2
          (same_IM_label_rew
             l1)
          (same_IM_state_rew
             s1, om)</span></span></span><br><span><var>seed</var><span class="hyp-type"><b>: </b><span>message ‚Üí <span class="kt">Prop</span></span></span></span><br><span><var>l</var><span class="hyp-type"><b>: </b><span>label
  (preloaded_vlsm (composite_vlsm IM1 constraint1)
     seed)</span></span></span><br><span><var>s</var><span class="hyp-type"><b>: </b><span>state
  (preloaded_vlsm (composite_vlsm IM1 constraint1)
     seed)</span></span></span><br><span><var>m</var><span class="hyp-type"><b>: </b><span>message</span></span></span><br><span><var>Hv</var><span class="hyp-type"><b>: </b><span>input_valid
  (preloaded_vlsm
     (composite_vlsm IM1 constraint1) seed) l
  (s, Some m)</span></span></span><br><span><var>HsY</var><span class="hyp-type"><b>: </b><span>valid_state_prop
  (preloaded_vlsm
     (composite_vlsm IM2 constraint2) seed)
  (same_IM_state_rew s)</span></span></span><br><span><var>HmX</var><span class="hyp-type"><b>: </b><span>initial_message_prop m</span></span></span><br></div><label class="goal-separator" for="Composition-v-chk1c4"><hr></label><div class="goal-conclusion">valid_message_prop
  (preloaded_vlsm (composite_vlsm IM2 constraint2)
     seed) m</div></blockquote></div></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="Composition-v-chk1c5" style="display: none" type="checkbox"><label class="alectryon-input" for="Composition-v-chk1c5">-</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>message, index</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>EqDecision0</var><span class="hyp-type"><b>: </b><span>EqDecision index</span></span></span><br><span><var>IM1, IM2</var><span class="hyp-type"><b>: </b><span>index ‚Üí VLSM message</span></span></span><br><span><var>Heq</var><span class="hyp-type"><b>: </b><span><span class="kr">‚àÄ</span> <span class="nv">i</span> : index, IM1 i = IM2 i</span></span></span><br><span><var>constraint1</var><span class="hyp-type"><b>: </b><span>composite_label IM1
‚Üí composite_state IM1 * option message
  ‚Üí <span class="kt">Prop</span></span></span></span><br><span><var>constraint2</var><span class="hyp-type"><b>: </b><span>composite_label IM2
‚Üí composite_state IM2 * option message
  ‚Üí <span class="kt">Prop</span></span></span></span><br><span><var>constraint_projection</var><span class="hyp-type"><b>: </b><span><span class="kr">‚àÄ</span> <span class="nv">s1</span> : state
         (preloaded_with_all_messages_vlsm
            (free_composite_vlsm
               IM1)),
  constrained_state_prop
    (free_composite_vlsm IM1)
    s1
  ‚Üí <span class="kr">‚àÄ</span> (<span class="nv">l1</span> : composite_label
              IM1) (<span class="nv">om</span> : 
                    option
                      message),
      constraint1 l1 (s1, om)
      ‚Üí constraint2
          (same_IM_label_rew
             l1)
          (same_IM_state_rew
             s1, om)</span></span></span><br><span><var>seed</var><span class="hyp-type"><b>: </b><span>message ‚Üí <span class="kt">Prop</span></span></span></span><br><span><var>l</var><span class="hyp-type"><b>: </b><span>label
  (preloaded_vlsm (composite_vlsm IM1 constraint1)
     seed)</span></span></span><br><span><var>s</var><span class="hyp-type"><b>: </b><span>state
  (preloaded_vlsm (composite_vlsm IM1 constraint1)
     seed)</span></span></span><br><span><var>om</var><span class="hyp-type"><b>: </b><span>option message</span></span></span><br><span><var>Hv</var><span class="hyp-type"><b>: </b><span>input_valid
  (preloaded_vlsm
     (composite_vlsm IM1 constraint1) seed) l
  (s, om)</span></span></span><br><span><var>HsY</var><span class="hyp-type"><b>: </b><span>valid_state_prop
  (preloaded_vlsm
     (composite_vlsm IM2 constraint2) seed)
  (same_IM_state_rew s)</span></span></span><br><span><var>HomY</var><span class="hyp-type"><b>: </b><span>option_valid_message_prop
  (preloaded_vlsm
     (composite_vlsm IM2 constraint2) seed) om</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">valid (same_IM_label_rew l) (same_IM_state_rew s, om)</div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="Composition-v-chk1c6" style="display: none" type="checkbox"><label class="alectryon-input" for="Composition-v-chk1c6"><span class="nb">destruct</span> Hv <span class="kr">as</span> [Hs [Hom [Hv Hc]]].</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>message, index</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>EqDecision0</var><span class="hyp-type"><b>: </b><span>EqDecision index</span></span></span><br><span><var>IM1, IM2</var><span class="hyp-type"><b>: </b><span>index ‚Üí VLSM message</span></span></span><br><span><var>Heq</var><span class="hyp-type"><b>: </b><span><span class="kr">‚àÄ</span> <span class="nv">i</span> : index, IM1 i = IM2 i</span></span></span><br><span><var>constraint1</var><span class="hyp-type"><b>: </b><span>composite_label IM1
‚Üí composite_state IM1 * option message
  ‚Üí <span class="kt">Prop</span></span></span></span><br><span><var>constraint2</var><span class="hyp-type"><b>: </b><span>composite_label IM2
‚Üí composite_state IM2 * option message
  ‚Üí <span class="kt">Prop</span></span></span></span><br><span><var>constraint_projection</var><span class="hyp-type"><b>: </b><span><span class="kr">‚àÄ</span> <span class="nv">s1</span> : state
         (preloaded_with_all_messages_vlsm
            (free_composite_vlsm
               IM1)),
  constrained_state_prop
    (free_composite_vlsm IM1)
    s1
  ‚Üí <span class="kr">‚àÄ</span> (<span class="nv">l1</span> : composite_label
              IM1) (<span class="nv">om</span> : 
                    option
                      message),
      constraint1 l1 (s1, om)
      ‚Üí constraint2
          (same_IM_label_rew
             l1)
          (same_IM_state_rew
             s1, om)</span></span></span><br><span><var>seed</var><span class="hyp-type"><b>: </b><span>message ‚Üí <span class="kt">Prop</span></span></span></span><br><span><var>l</var><span class="hyp-type"><b>: </b><span>label
  (preloaded_vlsm (composite_vlsm IM1 constraint1)
     seed)</span></span></span><br><span><var>s</var><span class="hyp-type"><b>: </b><span>state
  (preloaded_vlsm (composite_vlsm IM1 constraint1)
     seed)</span></span></span><br><span><var>om</var><span class="hyp-type"><b>: </b><span>option message</span></span></span><br><span><var>Hs</var><span class="hyp-type"><b>: </b><span>valid_state_prop
  (preloaded_vlsm
     (composite_vlsm IM1 constraint1) seed) s</span></span></span><br><span><var>Hom</var><span class="hyp-type"><b>: </b><span>option_valid_message_prop
  (preloaded_vlsm
     (composite_vlsm IM1 constraint1) seed) om</span></span></span><br><span><var>Hv</var><span class="hyp-type"><b>: </b><span>valid l (s, om)</span></span></span><br><span><var>Hc</var><span class="hyp-type"><b>: </b><span>constraint1 l (s, om)</span></span></span><br><span><var>HsY</var><span class="hyp-type"><b>: </b><span>valid_state_prop
  (preloaded_vlsm
     (composite_vlsm IM2 constraint2) seed)
  (same_IM_state_rew s)</span></span></span><br><span><var>HomY</var><span class="hyp-type"><b>: </b><span>option_valid_message_prop
  (preloaded_vlsm
     (composite_vlsm IM2 constraint2) seed) om</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">valid (same_IM_label_rew l) (same_IM_state_rew s, om)</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="Composition-v-chk1c7" style="display: none" type="checkbox"><label class="alectryon-input" for="Composition-v-chk1c7"><span class="nb">apply</span> constraint_projection <span class="kr">in</span> Hc; <span class="nb">cycle</span> <span class="mi">1</span>.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>message, index</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>EqDecision0</var><span class="hyp-type"><b>: </b><span>EqDecision index</span></span></span><br><span><var>IM1, IM2</var><span class="hyp-type"><b>: </b><span>index ‚Üí VLSM message</span></span></span><br><span><var>Heq</var><span class="hyp-type"><b>: </b><span><span class="kr">‚àÄ</span> <span class="nv">i</span> : index, IM1 i = IM2 i</span></span></span><br><span><var>constraint1</var><span class="hyp-type"><b>: </b><span>composite_label IM1
‚Üí composite_state IM1 * option message
  ‚Üí <span class="kt">Prop</span></span></span></span><br><span><var>constraint2</var><span class="hyp-type"><b>: </b><span>composite_label IM2
‚Üí composite_state IM2 * option message
  ‚Üí <span class="kt">Prop</span></span></span></span><br><span><var>constraint_projection</var><span class="hyp-type"><b>: </b><span><span class="kr">‚àÄ</span> <span class="nv">s1</span> : state
         (preloaded_with_all_messages_vlsm
            (free_composite_vlsm
               IM1)),
  constrained_state_prop
    (free_composite_vlsm IM1)
    s1
  ‚Üí <span class="kr">‚àÄ</span> (<span class="nv">l1</span> : composite_label
              IM1) (<span class="nv">om</span> : 
                    option
                      message),
      constraint1 l1 (s1, om)
      ‚Üí constraint2
          (same_IM_label_rew
             l1)
          (same_IM_state_rew
             s1, om)</span></span></span><br><span><var>seed</var><span class="hyp-type"><b>: </b><span>message ‚Üí <span class="kt">Prop</span></span></span></span><br><span><var>l</var><span class="hyp-type"><b>: </b><span>label
  (preloaded_vlsm (composite_vlsm IM1 constraint1)
     seed)</span></span></span><br><span><var>s</var><span class="hyp-type"><b>: </b><span>state
  (preloaded_vlsm (composite_vlsm IM1 constraint1)
     seed)</span></span></span><br><span><var>om</var><span class="hyp-type"><b>: </b><span>option message</span></span></span><br><span><var>Hs</var><span class="hyp-type"><b>: </b><span>valid_state_prop
  (preloaded_vlsm
     (composite_vlsm IM1 constraint1) seed) s</span></span></span><br><span><var>Hom</var><span class="hyp-type"><b>: </b><span>option_valid_message_prop
  (preloaded_vlsm
     (composite_vlsm IM1 constraint1) seed) om</span></span></span><br><span><var>Hv</var><span class="hyp-type"><b>: </b><span>valid l (s, om)</span></span></span><br><span><var>Hc</var><span class="hyp-type"><b>: </b><span>constraint1 l (s, om)</span></span></span><br><span><var>HsY</var><span class="hyp-type"><b>: </b><span>valid_state_prop
  (preloaded_vlsm
     (composite_vlsm IM2 constraint2) seed)
  (same_IM_state_rew s)</span></span></span><br><span><var>HomY</var><span class="hyp-type"><b>: </b><span>option_valid_message_prop
  (preloaded_vlsm
     (composite_vlsm IM2 constraint2) seed) om</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">constrained_state_prop (free_composite_vlsm IM1) s</div></blockquote><div class="alectryon-extra-goals"><input class="alectryon-extra-goal-toggle" id="Composition-v-chk1c8" style="display: none" type="checkbox"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>message, index</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>EqDecision0</var><span class="hyp-type"><b>: </b><span>EqDecision index</span></span></span><br><span><var>IM1, IM2</var><span class="hyp-type"><b>: </b><span>index ‚Üí VLSM message</span></span></span><br><span><var>Heq</var><span class="hyp-type"><b>: </b><span><span class="kr">‚àÄ</span> <span class="nv">i</span> : index, IM1 i = IM2 i</span></span></span><br><span><var>constraint1</var><span class="hyp-type"><b>: </b><span>composite_label IM1
‚Üí composite_state IM1 * option message
  ‚Üí <span class="kt">Prop</span></span></span></span><br><span><var>constraint2</var><span class="hyp-type"><b>: </b><span>composite_label IM2
‚Üí composite_state IM2 * option message
  ‚Üí <span class="kt">Prop</span></span></span></span><br><span><var>constraint_projection</var><span class="hyp-type"><b>: </b><span><span class="kr">‚àÄ</span> <span class="nv">s1</span> : state
         (preloaded_with_all_messages_vlsm
            (free_composite_vlsm
               IM1)),
  constrained_state_prop
    (free_composite_vlsm IM1)
    s1
  ‚Üí <span class="kr">‚àÄ</span> (<span class="nv">l1</span> : composite_label
              IM1) (<span class="nv">om</span> : 
                    option
                      message),
      constraint1 l1 (s1, om)
      ‚Üí constraint2
          (same_IM_label_rew
             l1)
          (same_IM_state_rew
             s1, om)</span></span></span><br><span><var>seed</var><span class="hyp-type"><b>: </b><span>message ‚Üí <span class="kt">Prop</span></span></span></span><br><span><var>l</var><span class="hyp-type"><b>: </b><span>label
  (preloaded_vlsm (composite_vlsm IM1 constraint1)
     seed)</span></span></span><br><span><var>s</var><span class="hyp-type"><b>: </b><span>state
  (preloaded_vlsm (composite_vlsm IM1 constraint1)
     seed)</span></span></span><br><span><var>om</var><span class="hyp-type"><b>: </b><span>option message</span></span></span><br><span><var>Hs</var><span class="hyp-type"><b>: </b><span>valid_state_prop
  (preloaded_vlsm
     (composite_vlsm IM1 constraint1) seed) s</span></span></span><br><span><var>Hom</var><span class="hyp-type"><b>: </b><span>option_valid_message_prop
  (preloaded_vlsm
     (composite_vlsm IM1 constraint1) seed) om</span></span></span><br><span><var>Hv</var><span class="hyp-type"><b>: </b><span>valid l (s, om)</span></span></span><br><span><var>Hc</var><span class="hyp-type"><b>: </b><span>constraint2 (same_IM_label_rew l)
  (same_IM_state_rew s, om)</span></span></span><br><span><var>HsY</var><span class="hyp-type"><b>: </b><span>valid_state_prop
  (preloaded_vlsm
     (composite_vlsm IM2 constraint2) seed)
  (same_IM_state_rew s)</span></span></span><br><span><var>HomY</var><span class="hyp-type"><b>: </b><span>option_valid_message_prop
  (preloaded_vlsm
     (composite_vlsm IM2 constraint2) seed) om</span></span></span><br></div><label class="goal-separator" for="Composition-v-chk1c8"><hr></label><div class="goal-conclusion">valid (same_IM_label_rew l) (same_IM_state_rew s, om)</div></blockquote></div></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="Composition-v-chk1c9" style="display: none" type="checkbox"><label class="alectryon-input" for="Composition-v-chk1c9">+</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>message, index</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>EqDecision0</var><span class="hyp-type"><b>: </b><span>EqDecision index</span></span></span><br><span><var>IM1, IM2</var><span class="hyp-type"><b>: </b><span>index ‚Üí VLSM message</span></span></span><br><span><var>Heq</var><span class="hyp-type"><b>: </b><span><span class="kr">‚àÄ</span> <span class="nv">i</span> : index, IM1 i = IM2 i</span></span></span><br><span><var>constraint1</var><span class="hyp-type"><b>: </b><span>composite_label IM1
‚Üí composite_state IM1 * option message
  ‚Üí <span class="kt">Prop</span></span></span></span><br><span><var>constraint2</var><span class="hyp-type"><b>: </b><span>composite_label IM2
‚Üí composite_state IM2 * option message
  ‚Üí <span class="kt">Prop</span></span></span></span><br><span><var>constraint_projection</var><span class="hyp-type"><b>: </b><span><span class="kr">‚àÄ</span> <span class="nv">s1</span> : state
         (preloaded_with_all_messages_vlsm
            (free_composite_vlsm
               IM1)),
  constrained_state_prop
    (free_composite_vlsm IM1)
    s1
  ‚Üí <span class="kr">‚àÄ</span> (<span class="nv">l1</span> : composite_label
              IM1) (<span class="nv">om</span> : 
                    option
                      message),
      constraint1 l1 (s1, om)
      ‚Üí constraint2
          (same_IM_label_rew
             l1)
          (same_IM_state_rew
             s1, om)</span></span></span><br><span><var>seed</var><span class="hyp-type"><b>: </b><span>message ‚Üí <span class="kt">Prop</span></span></span></span><br><span><var>l</var><span class="hyp-type"><b>: </b><span>label
  (preloaded_vlsm (composite_vlsm IM1 constraint1)
     seed)</span></span></span><br><span><var>s</var><span class="hyp-type"><b>: </b><span>state
  (preloaded_vlsm (composite_vlsm IM1 constraint1)
     seed)</span></span></span><br><span><var>om</var><span class="hyp-type"><b>: </b><span>option message</span></span></span><br><span><var>Hs</var><span class="hyp-type"><b>: </b><span>valid_state_prop
  (preloaded_vlsm
     (composite_vlsm IM1 constraint1) seed) s</span></span></span><br><span><var>Hom</var><span class="hyp-type"><b>: </b><span>option_valid_message_prop
  (preloaded_vlsm
     (composite_vlsm IM1 constraint1) seed) om</span></span></span><br><span><var>Hv</var><span class="hyp-type"><b>: </b><span>valid l (s, om)</span></span></span><br><span><var>Hc</var><span class="hyp-type"><b>: </b><span>constraint1 l (s, om)</span></span></span><br><span><var>HsY</var><span class="hyp-type"><b>: </b><span>valid_state_prop
  (preloaded_vlsm
     (composite_vlsm IM2 constraint2) seed)
  (same_IM_state_rew s)</span></span></span><br><span><var>HomY</var><span class="hyp-type"><b>: </b><span>option_valid_message_prop
  (preloaded_vlsm
     (composite_vlsm IM2 constraint2) seed) om</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">constrained_state_prop (free_composite_vlsm IM1) s</div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="Composition-v-chk1ca" style="display: none" type="checkbox"><label class="alectryon-input" for="Composition-v-chk1ca"><span class="nb">apply</span> VLSM_incl_valid_state; [| <span class="bp">done</span>].</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>message, index</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>EqDecision0</var><span class="hyp-type"><b>: </b><span>EqDecision index</span></span></span><br><span><var>IM1, IM2</var><span class="hyp-type"><b>: </b><span>index ‚Üí VLSM message</span></span></span><br><span><var>Heq</var><span class="hyp-type"><b>: </b><span><span class="kr">‚àÄ</span> <span class="nv">i</span> : index, IM1 i = IM2 i</span></span></span><br><span><var>constraint1</var><span class="hyp-type"><b>: </b><span>composite_label IM1
‚Üí composite_state IM1 * option message
  ‚Üí <span class="kt">Prop</span></span></span></span><br><span><var>constraint2</var><span class="hyp-type"><b>: </b><span>composite_label IM2
‚Üí composite_state IM2 * option message
  ‚Üí <span class="kt">Prop</span></span></span></span><br><span><var>constraint_projection</var><span class="hyp-type"><b>: </b><span><span class="kr">‚àÄ</span> <span class="nv">s1</span> : state
         (preloaded_with_all_messages_vlsm
            (free_composite_vlsm
               IM1)),
  constrained_state_prop
    (free_composite_vlsm IM1)
    s1
  ‚Üí <span class="kr">‚àÄ</span> (<span class="nv">l1</span> : composite_label
              IM1) (<span class="nv">om</span> : 
                    option
                      message),
      constraint1 l1 (s1, om)
      ‚Üí constraint2
          (same_IM_label_rew
             l1)
          (same_IM_state_rew
             s1, om)</span></span></span><br><span><var>seed</var><span class="hyp-type"><b>: </b><span>message ‚Üí <span class="kt">Prop</span></span></span></span><br><span><var>l</var><span class="hyp-type"><b>: </b><span>label
  (preloaded_vlsm (composite_vlsm IM1 constraint1)
     seed)</span></span></span><br><span><var>s</var><span class="hyp-type"><b>: </b><span>state
  (preloaded_vlsm (composite_vlsm IM1 constraint1)
     seed)</span></span></span><br><span><var>om</var><span class="hyp-type"><b>: </b><span>option message</span></span></span><br><span><var>Hs</var><span class="hyp-type"><b>: </b><span>valid_state_prop
  (preloaded_vlsm
     (composite_vlsm IM1 constraint1) seed) s</span></span></span><br><span><var>Hom</var><span class="hyp-type"><b>: </b><span>option_valid_message_prop
  (preloaded_vlsm
     (composite_vlsm IM1 constraint1) seed) om</span></span></span><br><span><var>Hv</var><span class="hyp-type"><b>: </b><span>valid l (s, om)</span></span></span><br><span><var>Hc</var><span class="hyp-type"><b>: </b><span>constraint1 l (s, om)</span></span></span><br><span><var>HsY</var><span class="hyp-type"><b>: </b><span>valid_state_prop
  (preloaded_vlsm
     (composite_vlsm IM2 constraint2) seed)
  (same_IM_state_rew s)</span></span></span><br><span><var>HomY</var><span class="hyp-type"><b>: </b><span>option_valid_message_prop
  (preloaded_vlsm
     (composite_vlsm IM2 constraint2) seed) om</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">VLSM_incl_part
  (preloaded_vlsm_machine
     (composite_vlsm IM1 constraint1) seed)
  (preloaded_vlsm_machine (free_composite_vlsm IM1)
     (<span class="kr">Œª</span> <span class="nv">_</span> : message, <span class="kt">True</span>))</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">      </span><span class="alectryon-sentence"><span class="alectryon-input"><span class="bp">by</span> <span class="nb">apply</span> constrained_preloaded_vlsm_incl_preloaded_with_all_messages.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="Composition-v-chk1cb" style="display: none" type="checkbox"><label class="alectryon-input" for="Composition-v-chk1cb">+</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>message, index</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>EqDecision0</var><span class="hyp-type"><b>: </b><span>EqDecision index</span></span></span><br><span><var>IM1, IM2</var><span class="hyp-type"><b>: </b><span>index ‚Üí VLSM message</span></span></span><br><span><var>Heq</var><span class="hyp-type"><b>: </b><span><span class="kr">‚àÄ</span> <span class="nv">i</span> : index, IM1 i = IM2 i</span></span></span><br><span><var>constraint1</var><span class="hyp-type"><b>: </b><span>composite_label IM1
‚Üí composite_state IM1 * option message
  ‚Üí <span class="kt">Prop</span></span></span></span><br><span><var>constraint2</var><span class="hyp-type"><b>: </b><span>composite_label IM2
‚Üí composite_state IM2 * option message
  ‚Üí <span class="kt">Prop</span></span></span></span><br><span><var>constraint_projection</var><span class="hyp-type"><b>: </b><span><span class="kr">‚àÄ</span> <span class="nv">s1</span> : state
         (preloaded_with_all_messages_vlsm
            (free_composite_vlsm
               IM1)),
  constrained_state_prop
    (free_composite_vlsm IM1)
    s1
  ‚Üí <span class="kr">‚àÄ</span> (<span class="nv">l1</span> : composite_label
              IM1) (<span class="nv">om</span> : 
                    option
                      message),
      constraint1 l1 (s1, om)
      ‚Üí constraint2
          (same_IM_label_rew
             l1)
          (same_IM_state_rew
             s1, om)</span></span></span><br><span><var>seed</var><span class="hyp-type"><b>: </b><span>message ‚Üí <span class="kt">Prop</span></span></span></span><br><span><var>l</var><span class="hyp-type"><b>: </b><span>label
  (preloaded_vlsm (composite_vlsm IM1 constraint1)
     seed)</span></span></span><br><span><var>s</var><span class="hyp-type"><b>: </b><span>state
  (preloaded_vlsm (composite_vlsm IM1 constraint1)
     seed)</span></span></span><br><span><var>om</var><span class="hyp-type"><b>: </b><span>option message</span></span></span><br><span><var>Hs</var><span class="hyp-type"><b>: </b><span>valid_state_prop
  (preloaded_vlsm
     (composite_vlsm IM1 constraint1) seed) s</span></span></span><br><span><var>Hom</var><span class="hyp-type"><b>: </b><span>option_valid_message_prop
  (preloaded_vlsm
     (composite_vlsm IM1 constraint1) seed) om</span></span></span><br><span><var>Hv</var><span class="hyp-type"><b>: </b><span>valid l (s, om)</span></span></span><br><span><var>Hc</var><span class="hyp-type"><b>: </b><span>constraint2 (same_IM_label_rew l)
  (same_IM_state_rew s, om)</span></span></span><br><span><var>HsY</var><span class="hyp-type"><b>: </b><span>valid_state_prop
  (preloaded_vlsm
     (composite_vlsm IM2 constraint2) seed)
  (same_IM_state_rew s)</span></span></span><br><span><var>HomY</var><span class="hyp-type"><b>: </b><span>option_valid_message_prop
  (preloaded_vlsm
     (composite_vlsm IM2 constraint2) seed) om</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">valid (same_IM_label_rew l) (same_IM_state_rew s, om)</div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="Composition-v-chk1cc" style="display: none" type="checkbox"><label class="alectryon-input" for="Composition-v-chk1cc"><span class="nb">split</span>; [| <span class="bp">done</span>].</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>message, index</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>EqDecision0</var><span class="hyp-type"><b>: </b><span>EqDecision index</span></span></span><br><span><var>IM1, IM2</var><span class="hyp-type"><b>: </b><span>index ‚Üí VLSM message</span></span></span><br><span><var>Heq</var><span class="hyp-type"><b>: </b><span><span class="kr">‚àÄ</span> <span class="nv">i</span> : index, IM1 i = IM2 i</span></span></span><br><span><var>constraint1</var><span class="hyp-type"><b>: </b><span>composite_label IM1
‚Üí composite_state IM1 * option message
  ‚Üí <span class="kt">Prop</span></span></span></span><br><span><var>constraint2</var><span class="hyp-type"><b>: </b><span>composite_label IM2
‚Üí composite_state IM2 * option message
  ‚Üí <span class="kt">Prop</span></span></span></span><br><span><var>constraint_projection</var><span class="hyp-type"><b>: </b><span><span class="kr">‚àÄ</span> <span class="nv">s1</span> : state
         (preloaded_with_all_messages_vlsm
            (free_composite_vlsm
               IM1)),
  constrained_state_prop
    (free_composite_vlsm IM1)
    s1
  ‚Üí <span class="kr">‚àÄ</span> (<span class="nv">l1</span> : composite_label
              IM1) (<span class="nv">om</span> : 
                    option
                      message),
      constraint1 l1 (s1, om)
      ‚Üí constraint2
          (same_IM_label_rew
             l1)
          (same_IM_state_rew
             s1, om)</span></span></span><br><span><var>seed</var><span class="hyp-type"><b>: </b><span>message ‚Üí <span class="kt">Prop</span></span></span></span><br><span><var>l</var><span class="hyp-type"><b>: </b><span>label
  (preloaded_vlsm (composite_vlsm IM1 constraint1)
     seed)</span></span></span><br><span><var>s</var><span class="hyp-type"><b>: </b><span>state
  (preloaded_vlsm (composite_vlsm IM1 constraint1)
     seed)</span></span></span><br><span><var>om</var><span class="hyp-type"><b>: </b><span>option message</span></span></span><br><span><var>Hs</var><span class="hyp-type"><b>: </b><span>valid_state_prop
  (preloaded_vlsm
     (composite_vlsm IM1 constraint1) seed) s</span></span></span><br><span><var>Hom</var><span class="hyp-type"><b>: </b><span>option_valid_message_prop
  (preloaded_vlsm
     (composite_vlsm IM1 constraint1) seed) om</span></span></span><br><span><var>Hv</var><span class="hyp-type"><b>: </b><span>valid l (s, om)</span></span></span><br><span><var>Hc</var><span class="hyp-type"><b>: </b><span>constraint2 (same_IM_label_rew l)
  (same_IM_state_rew s, om)</span></span></span><br><span><var>HsY</var><span class="hyp-type"><b>: </b><span>valid_state_prop
  (preloaded_vlsm
     (composite_vlsm IM2 constraint2) seed)
  (same_IM_state_rew s)</span></span></span><br><span><var>HomY</var><span class="hyp-type"><b>: </b><span>option_valid_message_prop
  (preloaded_vlsm
     (composite_vlsm IM2 constraint2) seed) om</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">valid (same_IM_label_rew l) (same_IM_state_rew s, om)</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">      </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="Composition-v-chk1cd" style="display: none" type="checkbox"><label class="alectryon-input" for="Composition-v-chk1cd"><span class="nb">clear</span> Hc.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>message, index</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>EqDecision0</var><span class="hyp-type"><b>: </b><span>EqDecision index</span></span></span><br><span><var>IM1, IM2</var><span class="hyp-type"><b>: </b><span>index ‚Üí VLSM message</span></span></span><br><span><var>Heq</var><span class="hyp-type"><b>: </b><span><span class="kr">‚àÄ</span> <span class="nv">i</span> : index, IM1 i = IM2 i</span></span></span><br><span><var>constraint1</var><span class="hyp-type"><b>: </b><span>composite_label IM1
‚Üí composite_state IM1 * option message
  ‚Üí <span class="kt">Prop</span></span></span></span><br><span><var>constraint2</var><span class="hyp-type"><b>: </b><span>composite_label IM2
‚Üí composite_state IM2 * option message
  ‚Üí <span class="kt">Prop</span></span></span></span><br><span><var>constraint_projection</var><span class="hyp-type"><b>: </b><span><span class="kr">‚àÄ</span> <span class="nv">s1</span> : state
         (preloaded_with_all_messages_vlsm
            (free_composite_vlsm
               IM1)),
  constrained_state_prop
    (free_composite_vlsm IM1)
    s1
  ‚Üí <span class="kr">‚àÄ</span> (<span class="nv">l1</span> : composite_label
              IM1) (<span class="nv">om</span> : 
                    option
                      message),
      constraint1 l1 (s1, om)
      ‚Üí constraint2
          (same_IM_label_rew
             l1)
          (same_IM_state_rew
             s1, om)</span></span></span><br><span><var>seed</var><span class="hyp-type"><b>: </b><span>message ‚Üí <span class="kt">Prop</span></span></span></span><br><span><var>l</var><span class="hyp-type"><b>: </b><span>label
  (preloaded_vlsm (composite_vlsm IM1 constraint1)
     seed)</span></span></span><br><span><var>s</var><span class="hyp-type"><b>: </b><span>state
  (preloaded_vlsm (composite_vlsm IM1 constraint1)
     seed)</span></span></span><br><span><var>om</var><span class="hyp-type"><b>: </b><span>option message</span></span></span><br><span><var>Hs</var><span class="hyp-type"><b>: </b><span>valid_state_prop
  (preloaded_vlsm
     (composite_vlsm IM1 constraint1) seed) s</span></span></span><br><span><var>Hom</var><span class="hyp-type"><b>: </b><span>option_valid_message_prop
  (preloaded_vlsm
     (composite_vlsm IM1 constraint1) seed) om</span></span></span><br><span><var>Hv</var><span class="hyp-type"><b>: </b><span>valid l (s, om)</span></span></span><br><span><var>HsY</var><span class="hyp-type"><b>: </b><span>valid_state_prop
  (preloaded_vlsm
     (composite_vlsm IM2 constraint2) seed)
  (same_IM_state_rew s)</span></span></span><br><span><var>HomY</var><span class="hyp-type"><b>: </b><span>option_valid_message_prop
  (preloaded_vlsm
     (composite_vlsm IM2 constraint2) seed) om</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">valid (same_IM_label_rew l) (same_IM_state_rew s, om)</div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="Composition-v-chk1ce" style="display: none" type="checkbox"><label class="alectryon-input" for="Composition-v-chk1ce"><span class="nb">revert</span> Hv.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>message, index</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>EqDecision0</var><span class="hyp-type"><b>: </b><span>EqDecision index</span></span></span><br><span><var>IM1, IM2</var><span class="hyp-type"><b>: </b><span>index ‚Üí VLSM message</span></span></span><br><span><var>Heq</var><span class="hyp-type"><b>: </b><span><span class="kr">‚àÄ</span> <span class="nv">i</span> : index, IM1 i = IM2 i</span></span></span><br><span><var>constraint1</var><span class="hyp-type"><b>: </b><span>composite_label IM1
‚Üí composite_state IM1 * option message
  ‚Üí <span class="kt">Prop</span></span></span></span><br><span><var>constraint2</var><span class="hyp-type"><b>: </b><span>composite_label IM2
‚Üí composite_state IM2 * option message
  ‚Üí <span class="kt">Prop</span></span></span></span><br><span><var>constraint_projection</var><span class="hyp-type"><b>: </b><span><span class="kr">‚àÄ</span> <span class="nv">s1</span> : state
         (preloaded_with_all_messages_vlsm
            (free_composite_vlsm
               IM1)),
  constrained_state_prop
    (free_composite_vlsm IM1)
    s1
  ‚Üí <span class="kr">‚àÄ</span> (<span class="nv">l1</span> : composite_label
              IM1) (<span class="nv">om</span> : 
                    option
                      message),
      constraint1 l1 (s1, om)
      ‚Üí constraint2
          (same_IM_label_rew
             l1)
          (same_IM_state_rew
             s1, om)</span></span></span><br><span><var>seed</var><span class="hyp-type"><b>: </b><span>message ‚Üí <span class="kt">Prop</span></span></span></span><br><span><var>l</var><span class="hyp-type"><b>: </b><span>label
  (preloaded_vlsm (composite_vlsm IM1 constraint1)
     seed)</span></span></span><br><span><var>s</var><span class="hyp-type"><b>: </b><span>state
  (preloaded_vlsm (composite_vlsm IM1 constraint1)
     seed)</span></span></span><br><span><var>om</var><span class="hyp-type"><b>: </b><span>option message</span></span></span><br><span><var>Hs</var><span class="hyp-type"><b>: </b><span>valid_state_prop
  (preloaded_vlsm
     (composite_vlsm IM1 constraint1) seed) s</span></span></span><br><span><var>Hom</var><span class="hyp-type"><b>: </b><span>option_valid_message_prop
  (preloaded_vlsm
     (composite_vlsm IM1 constraint1) seed) om</span></span></span><br><span><var>HsY</var><span class="hyp-type"><b>: </b><span>valid_state_prop
  (preloaded_vlsm
     (composite_vlsm IM2 constraint2) seed)
  (same_IM_state_rew s)</span></span></span><br><span><var>HomY</var><span class="hyp-type"><b>: </b><span>option_valid_message_prop
  (preloaded_vlsm
     (composite_vlsm IM2 constraint2) seed) om</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">valid l (s, om)
‚Üí valid (same_IM_label_rew l)
    (same_IM_state_rew s, om)</div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="Composition-v-chk1cf" style="display: none" type="checkbox"><label class="alectryon-input" for="Composition-v-chk1cf"><span class="nb">destruct</span> l <span class="kr">as</span> (i, li).</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>message, index</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>EqDecision0</var><span class="hyp-type"><b>: </b><span>EqDecision index</span></span></span><br><span><var>IM1, IM2</var><span class="hyp-type"><b>: </b><span>index ‚Üí VLSM message</span></span></span><br><span><var>Heq</var><span class="hyp-type"><b>: </b><span><span class="kr">‚àÄ</span> <span class="nv">i</span> : index, IM1 i = IM2 i</span></span></span><br><span><var>constraint1</var><span class="hyp-type"><b>: </b><span>composite_label IM1
‚Üí composite_state IM1 * option message
  ‚Üí <span class="kt">Prop</span></span></span></span><br><span><var>constraint2</var><span class="hyp-type"><b>: </b><span>composite_label IM2
‚Üí composite_state IM2 * option message
  ‚Üí <span class="kt">Prop</span></span></span></span><br><span><var>constraint_projection</var><span class="hyp-type"><b>: </b><span><span class="kr">‚àÄ</span> <span class="nv">s1</span> : state
         (preloaded_with_all_messages_vlsm
            (free_composite_vlsm
               IM1)),
  constrained_state_prop
    (free_composite_vlsm IM1)
    s1
  ‚Üí <span class="kr">‚àÄ</span> (<span class="nv">l1</span> : composite_label
              IM1) (<span class="nv">om</span> : 
                    option
                      message),
      constraint1 l1 (s1, om)
      ‚Üí constraint2
          (same_IM_label_rew
             l1)
          (same_IM_state_rew
             s1, om)</span></span></span><br><span><var>seed</var><span class="hyp-type"><b>: </b><span>message ‚Üí <span class="kt">Prop</span></span></span></span><br><span><var>i</var><span class="hyp-type"><b>: </b><span>index</span></span></span><br><span><var>li</var><span class="hyp-type"><b>: </b><span>label (IM1 i)</span></span></span><br><span><var>s</var><span class="hyp-type"><b>: </b><span>state
  (preloaded_vlsm (composite_vlsm IM1 constraint1)
     seed)</span></span></span><br><span><var>om</var><span class="hyp-type"><b>: </b><span>option message</span></span></span><br><span><var>Hs</var><span class="hyp-type"><b>: </b><span>valid_state_prop
  (preloaded_vlsm
     (composite_vlsm IM1 constraint1) seed) s</span></span></span><br><span><var>Hom</var><span class="hyp-type"><b>: </b><span>option_valid_message_prop
  (preloaded_vlsm
     (composite_vlsm IM1 constraint1) seed) om</span></span></span><br><span><var>HsY</var><span class="hyp-type"><b>: </b><span>valid_state_prop
  (preloaded_vlsm
     (composite_vlsm IM2 constraint2) seed)
  (same_IM_state_rew s)</span></span></span><br><span><var>HomY</var><span class="hyp-type"><b>: </b><span>option_valid_message_prop
  (preloaded_vlsm
     (composite_vlsm IM2 constraint2) seed) om</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">valid (existT i li) (s, om)
‚Üí valid (same_IM_label_rew (existT i li))
    (same_IM_state_rew s, om)</div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="Composition-v-chk1d0" style="display: none" type="checkbox"><label class="alectryon-input" for="Composition-v-chk1d0"><span class="nb">cbn</span>.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>message, index</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>EqDecision0</var><span class="hyp-type"><b>: </b><span>EqDecision index</span></span></span><br><span><var>IM1, IM2</var><span class="hyp-type"><b>: </b><span>index ‚Üí VLSM message</span></span></span><br><span><var>Heq</var><span class="hyp-type"><b>: </b><span><span class="kr">‚àÄ</span> <span class="nv">i</span> : index, IM1 i = IM2 i</span></span></span><br><span><var>constraint1</var><span class="hyp-type"><b>: </b><span>composite_label IM1
‚Üí composite_state IM1 * option message
  ‚Üí <span class="kt">Prop</span></span></span></span><br><span><var>constraint2</var><span class="hyp-type"><b>: </b><span>composite_label IM2
‚Üí composite_state IM2 * option message
  ‚Üí <span class="kt">Prop</span></span></span></span><br><span><var>constraint_projection</var><span class="hyp-type"><b>: </b><span><span class="kr">‚àÄ</span> <span class="nv">s1</span> : state
         (preloaded_with_all_messages_vlsm
            (free_composite_vlsm
               IM1)),
  constrained_state_prop
    (free_composite_vlsm IM1)
    s1
  ‚Üí <span class="kr">‚àÄ</span> (<span class="nv">l1</span> : composite_label
              IM1) (<span class="nv">om</span> : 
                    option
                      message),
      constraint1 l1 (s1, om)
      ‚Üí constraint2
          (same_IM_label_rew
             l1)
          (same_IM_state_rew
             s1, om)</span></span></span><br><span><var>seed</var><span class="hyp-type"><b>: </b><span>message ‚Üí <span class="kt">Prop</span></span></span></span><br><span><var>i</var><span class="hyp-type"><b>: </b><span>index</span></span></span><br><span><var>li</var><span class="hyp-type"><b>: </b><span>label (IM1 i)</span></span></span><br><span><var>s</var><span class="hyp-type"><b>: </b><span>state
  (preloaded_vlsm (composite_vlsm IM1 constraint1)
     seed)</span></span></span><br><span><var>om</var><span class="hyp-type"><b>: </b><span>option message</span></span></span><br><span><var>Hs</var><span class="hyp-type"><b>: </b><span>valid_state_prop
  (preloaded_vlsm
     (composite_vlsm IM1 constraint1) seed) s</span></span></span><br><span><var>Hom</var><span class="hyp-type"><b>: </b><span>option_valid_message_prop
  (preloaded_vlsm
     (composite_vlsm IM1 constraint1) seed) om</span></span></span><br><span><var>HsY</var><span class="hyp-type"><b>: </b><span>valid_state_prop
  (preloaded_vlsm
     (composite_vlsm IM2 constraint2) seed)
  (same_IM_state_rew s)</span></span></span><br><span><var>HomY</var><span class="hyp-type"><b>: </b><span>option_valid_message_prop
  (preloaded_vlsm
     (composite_vlsm IM2 constraint2) seed) om</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">valid li (s i, om)
‚Üí valid (same_VLSM_label_rew (Heq i) li)
    (same_IM_state_rew s i, om)</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">      </span><span class="alectryon-sentence"><span class="alectryon-input"><span class="bp">by</span> <span class="nb">apply</span> same_VLSM_valid_preservation.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="Composition-v-chk1d1" style="display: none" type="checkbox"><label class="alectryon-input" for="Composition-v-chk1d1">-</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>message, index</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>EqDecision0</var><span class="hyp-type"><b>: </b><span>EqDecision index</span></span></span><br><span><var>IM1, IM2</var><span class="hyp-type"><b>: </b><span>index ‚Üí VLSM message</span></span></span><br><span><var>Heq</var><span class="hyp-type"><b>: </b><span><span class="kr">‚àÄ</span> <span class="nv">i</span> : index, IM1 i = IM2 i</span></span></span><br><span><var>constraint1</var><span class="hyp-type"><b>: </b><span>composite_label IM1
‚Üí composite_state IM1 * option message
  ‚Üí <span class="kt">Prop</span></span></span></span><br><span><var>constraint2</var><span class="hyp-type"><b>: </b><span>composite_label IM2
‚Üí composite_state IM2 * option message
  ‚Üí <span class="kt">Prop</span></span></span></span><br><span><var>constraint_projection</var><span class="hyp-type"><b>: </b><span><span class="kr">‚àÄ</span> <span class="nv">s1</span> : state
         (preloaded_with_all_messages_vlsm
            (free_composite_vlsm
               IM1)),
  constrained_state_prop
    (free_composite_vlsm IM1)
    s1
  ‚Üí <span class="kr">‚àÄ</span> (<span class="nv">l1</span> : composite_label
              IM1) (<span class="nv">om</span> : 
                    option
                      message),
      constraint1 l1 (s1, om)
      ‚Üí constraint2
          (same_IM_label_rew
             l1)
          (same_IM_state_rew
             s1, om)</span></span></span><br><span><var>seed</var><span class="hyp-type"><b>: </b><span>message ‚Üí <span class="kt">Prop</span></span></span></span><br><span><var>l</var><span class="hyp-type"><b>: </b><span>label
  (preloaded_vlsm (composite_vlsm IM1 constraint1)
     seed)</span></span></span><br><span><var>s</var><span class="hyp-type"><b>: </b><span>state
  (preloaded_vlsm (composite_vlsm IM1 constraint1)
     seed)</span></span></span><br><span><var>om</var><span class="hyp-type"><b>: </b><span>option message</span></span></span><br><span><var>s'</var><span class="hyp-type"><b>: </b><span>state
  (preloaded_vlsm
     (composite_vlsm IM1 constraint1) seed)</span></span></span><br><span><var>om'</var><span class="hyp-type"><b>: </b><span>option message</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>input_valid_transition
  (preloaded_vlsm (composite_vlsm IM1 constraint1)
     seed) l (s, om) (s&#39;, om&#39;)</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">transition (same_IM_label_rew l)
  (same_IM_state_rew s, om) =
(same_IM_state_rew s&#39;, om&#39;)</div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="Composition-v-chk1d2" style="display: none" type="checkbox"><label class="alectryon-input" for="Composition-v-chk1d2"><span class="nb">apply</span> proj2 <span class="kr">in</span> H.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>message, index</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>EqDecision0</var><span class="hyp-type"><b>: </b><span>EqDecision index</span></span></span><br><span><var>IM1, IM2</var><span class="hyp-type"><b>: </b><span>index ‚Üí VLSM message</span></span></span><br><span><var>Heq</var><span class="hyp-type"><b>: </b><span><span class="kr">‚àÄ</span> <span class="nv">i</span> : index, IM1 i = IM2 i</span></span></span><br><span><var>constraint1</var><span class="hyp-type"><b>: </b><span>composite_label IM1
‚Üí composite_state IM1 * option message
  ‚Üí <span class="kt">Prop</span></span></span></span><br><span><var>constraint2</var><span class="hyp-type"><b>: </b><span>composite_label IM2
‚Üí composite_state IM2 * option message
  ‚Üí <span class="kt">Prop</span></span></span></span><br><span><var>constraint_projection</var><span class="hyp-type"><b>: </b><span><span class="kr">‚àÄ</span> <span class="nv">s1</span> : state
         (preloaded_with_all_messages_vlsm
            (free_composite_vlsm
               IM1)),
  constrained_state_prop
    (free_composite_vlsm IM1)
    s1
  ‚Üí <span class="kr">‚àÄ</span> (<span class="nv">l1</span> : composite_label
              IM1) (<span class="nv">om</span> : 
                    option
                      message),
      constraint1 l1 (s1, om)
      ‚Üí constraint2
          (same_IM_label_rew
             l1)
          (same_IM_state_rew
             s1, om)</span></span></span><br><span><var>seed</var><span class="hyp-type"><b>: </b><span>message ‚Üí <span class="kt">Prop</span></span></span></span><br><span><var>l</var><span class="hyp-type"><b>: </b><span>label
  (preloaded_vlsm (composite_vlsm IM1 constraint1)
     seed)</span></span></span><br><span><var>s</var><span class="hyp-type"><b>: </b><span>state
  (preloaded_vlsm (composite_vlsm IM1 constraint1)
     seed)</span></span></span><br><span><var>om</var><span class="hyp-type"><b>: </b><span>option message</span></span></span><br><span><var>s'</var><span class="hyp-type"><b>: </b><span>state
  (preloaded_vlsm
     (composite_vlsm IM1 constraint1) seed)</span></span></span><br><span><var>om'</var><span class="hyp-type"><b>: </b><span>option message</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>transition l (s, om) = (s&#39;, om&#39;)</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">transition (same_IM_label_rew l)
  (same_IM_state_rew s, om) =
(same_IM_state_rew s&#39;, om&#39;)</div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="Composition-v-chk1d3" style="display: none" type="checkbox"><label class="alectryon-input" for="Composition-v-chk1d3"><span class="nb">revert</span> H.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>message, index</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>EqDecision0</var><span class="hyp-type"><b>: </b><span>EqDecision index</span></span></span><br><span><var>IM1, IM2</var><span class="hyp-type"><b>: </b><span>index ‚Üí VLSM message</span></span></span><br><span><var>Heq</var><span class="hyp-type"><b>: </b><span><span class="kr">‚àÄ</span> <span class="nv">i</span> : index, IM1 i = IM2 i</span></span></span><br><span><var>constraint1</var><span class="hyp-type"><b>: </b><span>composite_label IM1
‚Üí composite_state IM1 * option message
  ‚Üí <span class="kt">Prop</span></span></span></span><br><span><var>constraint2</var><span class="hyp-type"><b>: </b><span>composite_label IM2
‚Üí composite_state IM2 * option message
  ‚Üí <span class="kt">Prop</span></span></span></span><br><span><var>constraint_projection</var><span class="hyp-type"><b>: </b><span><span class="kr">‚àÄ</span> <span class="nv">s1</span> : state
         (preloaded_with_all_messages_vlsm
            (free_composite_vlsm
               IM1)),
  constrained_state_prop
    (free_composite_vlsm IM1)
    s1
  ‚Üí <span class="kr">‚àÄ</span> (<span class="nv">l1</span> : composite_label
              IM1) (<span class="nv">om</span> : 
                    option
                      message),
      constraint1 l1 (s1, om)
      ‚Üí constraint2
          (same_IM_label_rew
             l1)
          (same_IM_state_rew
             s1, om)</span></span></span><br><span><var>seed</var><span class="hyp-type"><b>: </b><span>message ‚Üí <span class="kt">Prop</span></span></span></span><br><span><var>l</var><span class="hyp-type"><b>: </b><span>label
  (preloaded_vlsm (composite_vlsm IM1 constraint1)
     seed)</span></span></span><br><span><var>s</var><span class="hyp-type"><b>: </b><span>state
  (preloaded_vlsm (composite_vlsm IM1 constraint1)
     seed)</span></span></span><br><span><var>om</var><span class="hyp-type"><b>: </b><span>option message</span></span></span><br><span><var>s'</var><span class="hyp-type"><b>: </b><span>state
  (preloaded_vlsm
     (composite_vlsm IM1 constraint1) seed)</span></span></span><br><span><var>om'</var><span class="hyp-type"><b>: </b><span>option message</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">transition l (s, om) = (s&#39;, om&#39;)
‚Üí transition (same_IM_label_rew l)
    (same_IM_state_rew s, om) =
  (same_IM_state_rew s&#39;, om&#39;)</div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="Composition-v-chk1d4" style="display: none" type="checkbox"><label class="alectryon-input" for="Composition-v-chk1d4"><span class="nb">destruct</span> l <span class="kr">as</span> (i, li).</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>message, index</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>EqDecision0</var><span class="hyp-type"><b>: </b><span>EqDecision index</span></span></span><br><span><var>IM1, IM2</var><span class="hyp-type"><b>: </b><span>index ‚Üí VLSM message</span></span></span><br><span><var>Heq</var><span class="hyp-type"><b>: </b><span><span class="kr">‚àÄ</span> <span class="nv">i</span> : index, IM1 i = IM2 i</span></span></span><br><span><var>constraint1</var><span class="hyp-type"><b>: </b><span>composite_label IM1
‚Üí composite_state IM1 * option message
  ‚Üí <span class="kt">Prop</span></span></span></span><br><span><var>constraint2</var><span class="hyp-type"><b>: </b><span>composite_label IM2
‚Üí composite_state IM2 * option message
  ‚Üí <span class="kt">Prop</span></span></span></span><br><span><var>constraint_projection</var><span class="hyp-type"><b>: </b><span><span class="kr">‚àÄ</span> <span class="nv">s1</span> : state
         (preloaded_with_all_messages_vlsm
            (free_composite_vlsm
               IM1)),
  constrained_state_prop
    (free_composite_vlsm IM1)
    s1
  ‚Üí <span class="kr">‚àÄ</span> (<span class="nv">l1</span> : composite_label
              IM1) (<span class="nv">om</span> : 
                    option
                      message),
      constraint1 l1 (s1, om)
      ‚Üí constraint2
          (same_IM_label_rew
             l1)
          (same_IM_state_rew
             s1, om)</span></span></span><br><span><var>seed</var><span class="hyp-type"><b>: </b><span>message ‚Üí <span class="kt">Prop</span></span></span></span><br><span><var>i</var><span class="hyp-type"><b>: </b><span>index</span></span></span><br><span><var>li</var><span class="hyp-type"><b>: </b><span>label (IM1 i)</span></span></span><br><span><var>s</var><span class="hyp-type"><b>: </b><span>state
  (preloaded_vlsm (composite_vlsm IM1 constraint1)
     seed)</span></span></span><br><span><var>om</var><span class="hyp-type"><b>: </b><span>option message</span></span></span><br><span><var>s'</var><span class="hyp-type"><b>: </b><span>state
  (preloaded_vlsm
     (composite_vlsm IM1 constraint1) seed)</span></span></span><br><span><var>om'</var><span class="hyp-type"><b>: </b><span>option message</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">transition (existT i li) (s, om) = (s&#39;, om&#39;)
‚Üí transition (same_IM_label_rew (existT i li))
    (same_IM_state_rew s, om) =
  (same_IM_state_rew s&#39;, om&#39;)</div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="Composition-v-chk1d5" style="display: none" type="checkbox"><label class="alectryon-input" for="Composition-v-chk1d5"><span class="nb">cbn</span>.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>message, index</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>EqDecision0</var><span class="hyp-type"><b>: </b><span>EqDecision index</span></span></span><br><span><var>IM1, IM2</var><span class="hyp-type"><b>: </b><span>index ‚Üí VLSM message</span></span></span><br><span><var>Heq</var><span class="hyp-type"><b>: </b><span><span class="kr">‚àÄ</span> <span class="nv">i</span> : index, IM1 i = IM2 i</span></span></span><br><span><var>constraint1</var><span class="hyp-type"><b>: </b><span>composite_label IM1
‚Üí composite_state IM1 * option message
  ‚Üí <span class="kt">Prop</span></span></span></span><br><span><var>constraint2</var><span class="hyp-type"><b>: </b><span>composite_label IM2
‚Üí composite_state IM2 * option message
  ‚Üí <span class="kt">Prop</span></span></span></span><br><span><var>constraint_projection</var><span class="hyp-type"><b>: </b><span><span class="kr">‚àÄ</span> <span class="nv">s1</span> : state
         (preloaded_with_all_messages_vlsm
            (free_composite_vlsm
               IM1)),
  constrained_state_prop
    (free_composite_vlsm IM1)
    s1
  ‚Üí <span class="kr">‚àÄ</span> (<span class="nv">l1</span> : composite_label
              IM1) (<span class="nv">om</span> : 
                    option
                      message),
      constraint1 l1 (s1, om)
      ‚Üí constraint2
          (same_IM_label_rew
             l1)
          (same_IM_state_rew
             s1, om)</span></span></span><br><span><var>seed</var><span class="hyp-type"><b>: </b><span>message ‚Üí <span class="kt">Prop</span></span></span></span><br><span><var>i</var><span class="hyp-type"><b>: </b><span>index</span></span></span><br><span><var>li</var><span class="hyp-type"><b>: </b><span>label (IM1 i)</span></span></span><br><span><var>s</var><span class="hyp-type"><b>: </b><span>state
  (preloaded_vlsm (composite_vlsm IM1 constraint1)
     seed)</span></span></span><br><span><var>om</var><span class="hyp-type"><b>: </b><span>option message</span></span></span><br><span><var>s'</var><span class="hyp-type"><b>: </b><span>state
  (preloaded_vlsm
     (composite_vlsm IM1 constraint1) seed)</span></span></span><br><span><var>om'</var><span class="hyp-type"><b>: </b><span>option message</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">(<span class="kr">let</span> (<span class="nv">si&#39;</span>, om&#39;) := transition li (s i, om) <span class="kr">in</span>
 (state_update IM1 s i si&#39;, om&#39;)) = (s&#39;, om&#39;)
‚Üí (<span class="kr">let</span> (<span class="nv">si&#39;</span>, om&#39;) :=
     transition (same_VLSM_label_rew (Heq i) li)
       (same_IM_state_rew s i, om) <span class="kr">in</span>
   (state_update IM2 (same_IM_state_rew s) i si&#39;, om&#39;)) =
  (same_IM_state_rew s&#39;, om&#39;)</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="Composition-v-chk1d6" style="display: none" type="checkbox"><label class="alectryon-input" for="Composition-v-chk1d6"><span class="nb">destruct</span> (transition (IM1 i) _ _) <span class="kr">as</span> (si&#39;1, _om&#39;) <span class="nb">eqn</span>: Ht1.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>message, index</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>EqDecision0</var><span class="hyp-type"><b>: </b><span>EqDecision index</span></span></span><br><span><var>IM1, IM2</var><span class="hyp-type"><b>: </b><span>index ‚Üí VLSM message</span></span></span><br><span><var>Heq</var><span class="hyp-type"><b>: </b><span><span class="kr">‚àÄ</span> <span class="nv">i</span> : index, IM1 i = IM2 i</span></span></span><br><span><var>constraint1</var><span class="hyp-type"><b>: </b><span>composite_label IM1
‚Üí composite_state IM1 * option message
  ‚Üí <span class="kt">Prop</span></span></span></span><br><span><var>constraint2</var><span class="hyp-type"><b>: </b><span>composite_label IM2
‚Üí composite_state IM2 * option message
  ‚Üí <span class="kt">Prop</span></span></span></span><br><span><var>constraint_projection</var><span class="hyp-type"><b>: </b><span><span class="kr">‚àÄ</span> <span class="nv">s1</span> : state
         (preloaded_with_all_messages_vlsm
            (free_composite_vlsm
               IM1)),
  constrained_state_prop
    (free_composite_vlsm IM1)
    s1
  ‚Üí <span class="kr">‚àÄ</span> (<span class="nv">l1</span> : composite_label
              IM1) (<span class="nv">om</span> : 
                    option
                      message),
      constraint1 l1 (s1, om)
      ‚Üí constraint2
          (same_IM_label_rew
             l1)
          (same_IM_state_rew
             s1, om)</span></span></span><br><span><var>seed</var><span class="hyp-type"><b>: </b><span>message ‚Üí <span class="kt">Prop</span></span></span></span><br><span><var>i</var><span class="hyp-type"><b>: </b><span>index</span></span></span><br><span><var>li</var><span class="hyp-type"><b>: </b><span>label (IM1 i)</span></span></span><br><span><var>s</var><span class="hyp-type"><b>: </b><span>state
  (preloaded_vlsm (composite_vlsm IM1 constraint1)
     seed)</span></span></span><br><span><var>om</var><span class="hyp-type"><b>: </b><span>option message</span></span></span><br><span><var>s'</var><span class="hyp-type"><b>: </b><span>state
  (preloaded_vlsm
     (composite_vlsm IM1 constraint1) seed)</span></span></span><br><span><var>om'</var><span class="hyp-type"><b>: </b><span>option message</span></span></span><br><span><var>si'1</var><span class="hyp-type"><b>: </b><span>state (IM1 i)</span></span></span><br><span><var>_om'</var><span class="hyp-type"><b>: </b><span>option message</span></span></span><br><span><var>Ht1</var><span class="hyp-type"><b>: </b><span>transition li (s i, om) = (si&#39;1, _om&#39;)</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">(state_update IM1 s i si&#39;1, _om&#39;) = (s&#39;, om&#39;)
‚Üí (<span class="kr">let</span> (<span class="nv">si&#39;</span>, om&#39;) :=
     transition (same_VLSM_label_rew (Heq i) li)
       (same_IM_state_rew s i, om) <span class="kr">in</span>
   (state_update IM2 (same_IM_state_rew s) i si&#39;, om&#39;)) =
  (same_IM_state_rew s&#39;, om&#39;)</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="Composition-v-chk1d7" style="display: none" type="checkbox"><label class="alectryon-input" for="Composition-v-chk1d7"><span class="nb">unfold</span> same_IM_state_rew <span class="nb">at</span> <span class="mi">1</span>.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>message, index</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>EqDecision0</var><span class="hyp-type"><b>: </b><span>EqDecision index</span></span></span><br><span><var>IM1, IM2</var><span class="hyp-type"><b>: </b><span>index ‚Üí VLSM message</span></span></span><br><span><var>Heq</var><span class="hyp-type"><b>: </b><span><span class="kr">‚àÄ</span> <span class="nv">i</span> : index, IM1 i = IM2 i</span></span></span><br><span><var>constraint1</var><span class="hyp-type"><b>: </b><span>composite_label IM1
‚Üí composite_state IM1 * option message
  ‚Üí <span class="kt">Prop</span></span></span></span><br><span><var>constraint2</var><span class="hyp-type"><b>: </b><span>composite_label IM2
‚Üí composite_state IM2 * option message
  ‚Üí <span class="kt">Prop</span></span></span></span><br><span><var>constraint_projection</var><span class="hyp-type"><b>: </b><span><span class="kr">‚àÄ</span> <span class="nv">s1</span> : state
         (preloaded_with_all_messages_vlsm
            (free_composite_vlsm
               IM1)),
  constrained_state_prop
    (free_composite_vlsm IM1)
    s1
  ‚Üí <span class="kr">‚àÄ</span> (<span class="nv">l1</span> : composite_label
              IM1) (<span class="nv">om</span> : 
                    option
                      message),
      constraint1 l1 (s1, om)
      ‚Üí constraint2
          (same_IM_label_rew
             l1)
          (same_IM_state_rew
             s1, om)</span></span></span><br><span><var>seed</var><span class="hyp-type"><b>: </b><span>message ‚Üí <span class="kt">Prop</span></span></span></span><br><span><var>i</var><span class="hyp-type"><b>: </b><span>index</span></span></span><br><span><var>li</var><span class="hyp-type"><b>: </b><span>label (IM1 i)</span></span></span><br><span><var>s</var><span class="hyp-type"><b>: </b><span>state
  (preloaded_vlsm (composite_vlsm IM1 constraint1)
     seed)</span></span></span><br><span><var>om</var><span class="hyp-type"><b>: </b><span>option message</span></span></span><br><span><var>s'</var><span class="hyp-type"><b>: </b><span>state
  (preloaded_vlsm
     (composite_vlsm IM1 constraint1) seed)</span></span></span><br><span><var>om'</var><span class="hyp-type"><b>: </b><span>option message</span></span></span><br><span><var>si'1</var><span class="hyp-type"><b>: </b><span>state (IM1 i)</span></span></span><br><span><var>_om'</var><span class="hyp-type"><b>: </b><span>option message</span></span></span><br><span><var>Ht1</var><span class="hyp-type"><b>: </b><span>transition li (s i, om) = (si&#39;1, _om&#39;)</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">(state_update IM1 s i si&#39;1, _om&#39;) = (s&#39;, om&#39;)
‚Üí (<span class="kr">let</span> (<span class="nv">si&#39;</span>, om&#39;) :=
     transition (same_VLSM_label_rew (Heq i) li)
       (same_VLSM_state_rew (Heq i) (s i), om) <span class="kr">in</span>
   (state_update IM2 (same_IM_state_rew s) i si&#39;, om&#39;)) =
  (same_IM_state_rew s&#39;, om&#39;)</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="Composition-v-chk1d8" style="display: none" type="checkbox"><label class="alectryon-input" for="Composition-v-chk1d8"><span class="nb">erewrite</span> same_VLSM_transition_preservation; [| <span class="bp">done</span>].</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>message, index</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>EqDecision0</var><span class="hyp-type"><b>: </b><span>EqDecision index</span></span></span><br><span><var>IM1, IM2</var><span class="hyp-type"><b>: </b><span>index ‚Üí VLSM message</span></span></span><br><span><var>Heq</var><span class="hyp-type"><b>: </b><span><span class="kr">‚àÄ</span> <span class="nv">i</span> : index, IM1 i = IM2 i</span></span></span><br><span><var>constraint1</var><span class="hyp-type"><b>: </b><span>composite_label IM1
‚Üí composite_state IM1 * option message
  ‚Üí <span class="kt">Prop</span></span></span></span><br><span><var>constraint2</var><span class="hyp-type"><b>: </b><span>composite_label IM2
‚Üí composite_state IM2 * option message
  ‚Üí <span class="kt">Prop</span></span></span></span><br><span><var>constraint_projection</var><span class="hyp-type"><b>: </b><span><span class="kr">‚àÄ</span> <span class="nv">s1</span> : state
         (preloaded_with_all_messages_vlsm
            (free_composite_vlsm
               IM1)),
  constrained_state_prop
    (free_composite_vlsm IM1)
    s1
  ‚Üí <span class="kr">‚àÄ</span> (<span class="nv">l1</span> : composite_label
              IM1) (<span class="nv">om</span> : 
                    option
                      message),
      constraint1 l1 (s1, om)
      ‚Üí constraint2
          (same_IM_label_rew
             l1)
          (same_IM_state_rew
             s1, om)</span></span></span><br><span><var>seed</var><span class="hyp-type"><b>: </b><span>message ‚Üí <span class="kt">Prop</span></span></span></span><br><span><var>i</var><span class="hyp-type"><b>: </b><span>index</span></span></span><br><span><var>li</var><span class="hyp-type"><b>: </b><span>label (IM1 i)</span></span></span><br><span><var>s</var><span class="hyp-type"><b>: </b><span>state
  (preloaded_vlsm (composite_vlsm IM1 constraint1)
     seed)</span></span></span><br><span><var>om</var><span class="hyp-type"><b>: </b><span>option message</span></span></span><br><span><var>s'</var><span class="hyp-type"><b>: </b><span>state
  (preloaded_vlsm
     (composite_vlsm IM1 constraint1) seed)</span></span></span><br><span><var>om'</var><span class="hyp-type"><b>: </b><span>option message</span></span></span><br><span><var>si'1</var><span class="hyp-type"><b>: </b><span>state (IM1 i)</span></span></span><br><span><var>_om'</var><span class="hyp-type"><b>: </b><span>option message</span></span></span><br><span><var>Ht1</var><span class="hyp-type"><b>: </b><span>transition li (s i, om) = (si&#39;1, _om&#39;)</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">(state_update IM1 s i si&#39;1, _om&#39;) = (s&#39;, om&#39;)
‚Üí (state_update IM2 (same_IM_state_rew s) i
     (same_VLSM_state_rew (Heq i) si&#39;1), _om&#39;) =
  (same_IM_state_rew s&#39;, om&#39;)</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="Composition-v-chk1d9" style="display: none" type="checkbox"><label class="alectryon-input" for="Composition-v-chk1d9"><span class="nb">inversion</span> <span class="mi">1</span>; <span class="nb">subst</span>; <span class="nb">clear</span> H.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>message, index</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>EqDecision0</var><span class="hyp-type"><b>: </b><span>EqDecision index</span></span></span><br><span><var>IM1, IM2</var><span class="hyp-type"><b>: </b><span>index ‚Üí VLSM message</span></span></span><br><span><var>Heq</var><span class="hyp-type"><b>: </b><span><span class="kr">‚àÄ</span> <span class="nv">i</span> : index, IM1 i = IM2 i</span></span></span><br><span><var>constraint1</var><span class="hyp-type"><b>: </b><span>composite_label IM1
‚Üí composite_state IM1 * option message
  ‚Üí <span class="kt">Prop</span></span></span></span><br><span><var>constraint2</var><span class="hyp-type"><b>: </b><span>composite_label IM2
‚Üí composite_state IM2 * option message
  ‚Üí <span class="kt">Prop</span></span></span></span><br><span><var>constraint_projection</var><span class="hyp-type"><b>: </b><span><span class="kr">‚àÄ</span> <span class="nv">s1</span> : state
         (preloaded_with_all_messages_vlsm
            (free_composite_vlsm
               IM1)),
  constrained_state_prop
    (free_composite_vlsm IM1)
    s1
  ‚Üí <span class="kr">‚àÄ</span> (<span class="nv">l1</span> : composite_label
              IM1) (<span class="nv">om</span> : 
                    option
                      message),
      constraint1 l1 (s1, om)
      ‚Üí constraint2
          (same_IM_label_rew
             l1)
          (same_IM_state_rew
             s1, om)</span></span></span><br><span><var>seed</var><span class="hyp-type"><b>: </b><span>message ‚Üí <span class="kt">Prop</span></span></span></span><br><span><var>i</var><span class="hyp-type"><b>: </b><span>index</span></span></span><br><span><var>li</var><span class="hyp-type"><b>: </b><span>label (IM1 i)</span></span></span><br><span><var>s</var><span class="hyp-type"><b>: </b><span>state
  (preloaded_vlsm (composite_vlsm IM1 constraint1)
     seed)</span></span></span><br><span><var>om, om'</var><span class="hyp-type"><b>: </b><span>option message</span></span></span><br><span><var>si'1</var><span class="hyp-type"><b>: </b><span>state (IM1 i)</span></span></span><br><span><var>Ht1</var><span class="hyp-type"><b>: </b><span>transition li (s i, om) = (si&#39;1, om&#39;)</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">(state_update IM2 (same_IM_state_rew s) i
   (same_VLSM_state_rew (Heq i) si&#39;1), om&#39;) =
(same_IM_state_rew (state_update IM1 s i si&#39;1), om&#39;)</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="Composition-v-chk1da" style="display: none" type="checkbox"><label class="alectryon-input" for="Composition-v-chk1da"><span class="nb">f_equal</span>.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>message, index</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>EqDecision0</var><span class="hyp-type"><b>: </b><span>EqDecision index</span></span></span><br><span><var>IM1, IM2</var><span class="hyp-type"><b>: </b><span>index ‚Üí VLSM message</span></span></span><br><span><var>Heq</var><span class="hyp-type"><b>: </b><span><span class="kr">‚àÄ</span> <span class="nv">i</span> : index, IM1 i = IM2 i</span></span></span><br><span><var>constraint1</var><span class="hyp-type"><b>: </b><span>composite_label IM1
‚Üí composite_state IM1 * option message
  ‚Üí <span class="kt">Prop</span></span></span></span><br><span><var>constraint2</var><span class="hyp-type"><b>: </b><span>composite_label IM2
‚Üí composite_state IM2 * option message
  ‚Üí <span class="kt">Prop</span></span></span></span><br><span><var>constraint_projection</var><span class="hyp-type"><b>: </b><span><span class="kr">‚àÄ</span> <span class="nv">s1</span> : state
         (preloaded_with_all_messages_vlsm
            (free_composite_vlsm
               IM1)),
  constrained_state_prop
    (free_composite_vlsm IM1)
    s1
  ‚Üí <span class="kr">‚àÄ</span> (<span class="nv">l1</span> : composite_label
              IM1) (<span class="nv">om</span> : 
                    option
                      message),
      constraint1 l1 (s1, om)
      ‚Üí constraint2
          (same_IM_label_rew
             l1)
          (same_IM_state_rew
             s1, om)</span></span></span><br><span><var>seed</var><span class="hyp-type"><b>: </b><span>message ‚Üí <span class="kt">Prop</span></span></span></span><br><span><var>i</var><span class="hyp-type"><b>: </b><span>index</span></span></span><br><span><var>li</var><span class="hyp-type"><b>: </b><span>label (IM1 i)</span></span></span><br><span><var>s</var><span class="hyp-type"><b>: </b><span>state
  (preloaded_vlsm (composite_vlsm IM1 constraint1)
     seed)</span></span></span><br><span><var>om, om'</var><span class="hyp-type"><b>: </b><span>option message</span></span></span><br><span><var>si'1</var><span class="hyp-type"><b>: </b><span>state (IM1 i)</span></span></span><br><span><var>Ht1</var><span class="hyp-type"><b>: </b><span>transition li (s i, om) = (si&#39;1, om&#39;)</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">state_update IM2 (same_IM_state_rew s) i
  (same_VLSM_state_rew (Heq i) si&#39;1) =
same_IM_state_rew (state_update IM1 s i si&#39;1)</div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="Composition-v-chk1db" style="display: none" type="checkbox"><label class="alectryon-input" for="Composition-v-chk1db">extensionality j.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>message, index</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>EqDecision0</var><span class="hyp-type"><b>: </b><span>EqDecision index</span></span></span><br><span><var>IM1, IM2</var><span class="hyp-type"><b>: </b><span>index ‚Üí VLSM message</span></span></span><br><span><var>Heq</var><span class="hyp-type"><b>: </b><span><span class="kr">‚àÄ</span> <span class="nv">i</span> : index, IM1 i = IM2 i</span></span></span><br><span><var>constraint1</var><span class="hyp-type"><b>: </b><span>composite_label IM1
‚Üí composite_state IM1 * option message
  ‚Üí <span class="kt">Prop</span></span></span></span><br><span><var>constraint2</var><span class="hyp-type"><b>: </b><span>composite_label IM2
‚Üí composite_state IM2 * option message
  ‚Üí <span class="kt">Prop</span></span></span></span><br><span><var>constraint_projection</var><span class="hyp-type"><b>: </b><span><span class="kr">‚àÄ</span> <span class="nv">s1</span> : state
         (preloaded_with_all_messages_vlsm
            (free_composite_vlsm
               IM1)),
  constrained_state_prop
    (free_composite_vlsm IM1)
    s1
  ‚Üí <span class="kr">‚àÄ</span> (<span class="nv">l1</span> : composite_label
              IM1) (<span class="nv">om</span> : 
                    option
                      message),
      constraint1 l1 (s1, om)
      ‚Üí constraint2
          (same_IM_label_rew
             l1)
          (same_IM_state_rew
             s1, om)</span></span></span><br><span><var>seed</var><span class="hyp-type"><b>: </b><span>message ‚Üí <span class="kt">Prop</span></span></span></span><br><span><var>i</var><span class="hyp-type"><b>: </b><span>index</span></span></span><br><span><var>li</var><span class="hyp-type"><b>: </b><span>label (IM1 i)</span></span></span><br><span><var>s</var><span class="hyp-type"><b>: </b><span>state
  (preloaded_vlsm (composite_vlsm IM1 constraint1)
     seed)</span></span></span><br><span><var>om, om'</var><span class="hyp-type"><b>: </b><span>option message</span></span></span><br><span><var>si'1</var><span class="hyp-type"><b>: </b><span>state (IM1 i)</span></span></span><br><span><var>Ht1</var><span class="hyp-type"><b>: </b><span>transition li (s i, om) = (si&#39;1, om&#39;)</span></span></span><br><span><var>j</var><span class="hyp-type"><b>: </b><span>index</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">state_update IM2 (same_IM_state_rew s) i
  (same_VLSM_state_rew (Heq i) si&#39;1) j =
same_IM_state_rew (state_update IM1 s i si&#39;1) j</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="Composition-v-chk1dc" style="display: none" type="checkbox"><label class="alectryon-input" for="Composition-v-chk1dc"><span class="nb">unfold</span> same_IM_state_rew <span class="nb">at</span> <span class="mi">2</span>.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>message, index</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>EqDecision0</var><span class="hyp-type"><b>: </b><span>EqDecision index</span></span></span><br><span><var>IM1, IM2</var><span class="hyp-type"><b>: </b><span>index ‚Üí VLSM message</span></span></span><br><span><var>Heq</var><span class="hyp-type"><b>: </b><span><span class="kr">‚àÄ</span> <span class="nv">i</span> : index, IM1 i = IM2 i</span></span></span><br><span><var>constraint1</var><span class="hyp-type"><b>: </b><span>composite_label IM1
‚Üí composite_state IM1 * option message
  ‚Üí <span class="kt">Prop</span></span></span></span><br><span><var>constraint2</var><span class="hyp-type"><b>: </b><span>composite_label IM2
‚Üí composite_state IM2 * option message
  ‚Üí <span class="kt">Prop</span></span></span></span><br><span><var>constraint_projection</var><span class="hyp-type"><b>: </b><span><span class="kr">‚àÄ</span> <span class="nv">s1</span> : state
         (preloaded_with_all_messages_vlsm
            (free_composite_vlsm
               IM1)),
  constrained_state_prop
    (free_composite_vlsm IM1)
    s1
  ‚Üí <span class="kr">‚àÄ</span> (<span class="nv">l1</span> : composite_label
              IM1) (<span class="nv">om</span> : 
                    option
                      message),
      constraint1 l1 (s1, om)
      ‚Üí constraint2
          (same_IM_label_rew
             l1)
          (same_IM_state_rew
             s1, om)</span></span></span><br><span><var>seed</var><span class="hyp-type"><b>: </b><span>message ‚Üí <span class="kt">Prop</span></span></span></span><br><span><var>i</var><span class="hyp-type"><b>: </b><span>index</span></span></span><br><span><var>li</var><span class="hyp-type"><b>: </b><span>label (IM1 i)</span></span></span><br><span><var>s</var><span class="hyp-type"><b>: </b><span>state
  (preloaded_vlsm (composite_vlsm IM1 constraint1)
     seed)</span></span></span><br><span><var>om, om'</var><span class="hyp-type"><b>: </b><span>option message</span></span></span><br><span><var>si'1</var><span class="hyp-type"><b>: </b><span>state (IM1 i)</span></span></span><br><span><var>Ht1</var><span class="hyp-type"><b>: </b><span>transition li (s i, om) = (si&#39;1, om&#39;)</span></span></span><br><span><var>j</var><span class="hyp-type"><b>: </b><span>index</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">state_update IM2 (same_IM_state_rew s) i
  (same_VLSM_state_rew (Heq i) si&#39;1) j =
same_VLSM_state_rew (Heq j)
  (state_update IM1 s i si&#39;1 j)</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><span class="alectryon-input"><span class="bp">by</span> <span class="nb">destruct</span> (decide (i = j)); <span class="nb">subst</span>; state_update_simpl.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="Composition-v-chk1dd" style="display: none" type="checkbox"><label class="alectryon-input" for="Composition-v-chk1dd">-</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>message, index</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>EqDecision0</var><span class="hyp-type"><b>: </b><span>EqDecision index</span></span></span><br><span><var>IM1, IM2</var><span class="hyp-type"><b>: </b><span>index ‚Üí VLSM message</span></span></span><br><span><var>Heq</var><span class="hyp-type"><b>: </b><span><span class="kr">‚àÄ</span> <span class="nv">i</span> : index, IM1 i = IM2 i</span></span></span><br><span><var>constraint1</var><span class="hyp-type"><b>: </b><span>composite_label IM1
‚Üí composite_state IM1 * option message
  ‚Üí <span class="kt">Prop</span></span></span></span><br><span><var>constraint2</var><span class="hyp-type"><b>: </b><span>composite_label IM2
‚Üí composite_state IM2 * option message
  ‚Üí <span class="kt">Prop</span></span></span></span><br><span><var>constraint_projection</var><span class="hyp-type"><b>: </b><span><span class="kr">‚àÄ</span> <span class="nv">s1</span> : state
         (preloaded_with_all_messages_vlsm
            (free_composite_vlsm
               IM1)),
  constrained_state_prop
    (free_composite_vlsm IM1)
    s1
  ‚Üí <span class="kr">‚àÄ</span> (<span class="nv">l1</span> : composite_label
              IM1) (<span class="nv">om</span> : 
                    option
                      message),
      constraint1 l1 (s1, om)
      ‚Üí constraint2
          (same_IM_label_rew
             l1)
          (same_IM_state_rew
             s1, om)</span></span></span><br><span><var>seed</var><span class="hyp-type"><b>: </b><span>message ‚Üí <span class="kt">Prop</span></span></span></span><br><span><var>l</var><span class="hyp-type"><b>: </b><span>state
  (preloaded_vlsm (composite_vlsm IM1 constraint1)
     seed)</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>initial_state_prop l</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">initial_state_prop (same_IM_state_rew l)</div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="bp">by</span> <span class="nb">intros</span> i; <span class="nb">apply</span> same_VLSM_initial_state_preservation, H.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="Composition-v-chk1de" style="display: none" type="checkbox"><label class="alectryon-input" for="Composition-v-chk1de">-</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>message, index</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>EqDecision0</var><span class="hyp-type"><b>: </b><span>EqDecision index</span></span></span><br><span><var>IM1, IM2</var><span class="hyp-type"><b>: </b><span>index ‚Üí VLSM message</span></span></span><br><span><var>Heq</var><span class="hyp-type"><b>: </b><span><span class="kr">‚àÄ</span> <span class="nv">i</span> : index, IM1 i = IM2 i</span></span></span><br><span><var>constraint1</var><span class="hyp-type"><b>: </b><span>composite_label IM1
‚Üí composite_state IM1 * option message
  ‚Üí <span class="kt">Prop</span></span></span></span><br><span><var>constraint2</var><span class="hyp-type"><b>: </b><span>composite_label IM2
‚Üí composite_state IM2 * option message
  ‚Üí <span class="kt">Prop</span></span></span></span><br><span><var>constraint_projection</var><span class="hyp-type"><b>: </b><span><span class="kr">‚àÄ</span> <span class="nv">s1</span> : state
         (preloaded_with_all_messages_vlsm
            (free_composite_vlsm
               IM1)),
  constrained_state_prop
    (free_composite_vlsm IM1)
    s1
  ‚Üí <span class="kr">‚àÄ</span> (<span class="nv">l1</span> : composite_label
              IM1) (<span class="nv">om</span> : 
                    option
                      message),
      constraint1 l1 (s1, om)
      ‚Üí constraint2
          (same_IM_label_rew
             l1)
          (same_IM_state_rew
             s1, om)</span></span></span><br><span><var>seed</var><span class="hyp-type"><b>: </b><span>message ‚Üí <span class="kt">Prop</span></span></span></span><br><span><var>l</var><span class="hyp-type"><b>: </b><span>label
  (preloaded_vlsm (composite_vlsm IM1 constraint1)
     seed)</span></span></span><br><span><var>s</var><span class="hyp-type"><b>: </b><span>state
  (preloaded_vlsm (composite_vlsm IM1 constraint1)
     seed)</span></span></span><br><span><var>m</var><span class="hyp-type"><b>: </b><span>message</span></span></span><br><span><var>Hv</var><span class="hyp-type"><b>: </b><span>input_valid
  (preloaded_vlsm
     (composite_vlsm IM1 constraint1) seed) l
  (s, Some m)</span></span></span><br><span><var>HsY</var><span class="hyp-type"><b>: </b><span>valid_state_prop
  (preloaded_vlsm
     (composite_vlsm IM2 constraint2) seed)
  (same_IM_state_rew s)</span></span></span><br><span><var>HmX</var><span class="hyp-type"><b>: </b><span>initial_message_prop m</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">valid_message_prop
  (preloaded_vlsm (composite_vlsm IM2 constraint2)
     seed) m</div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="Composition-v-chk1df" style="display: none" type="checkbox"><label class="alectryon-input" for="Composition-v-chk1df"><span class="nb">apply</span> initial_message_is_valid.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>message, index</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>EqDecision0</var><span class="hyp-type"><b>: </b><span>EqDecision index</span></span></span><br><span><var>IM1, IM2</var><span class="hyp-type"><b>: </b><span>index ‚Üí VLSM message</span></span></span><br><span><var>Heq</var><span class="hyp-type"><b>: </b><span><span class="kr">‚àÄ</span> <span class="nv">i</span> : index, IM1 i = IM2 i</span></span></span><br><span><var>constraint1</var><span class="hyp-type"><b>: </b><span>composite_label IM1
‚Üí composite_state IM1 * option message
  ‚Üí <span class="kt">Prop</span></span></span></span><br><span><var>constraint2</var><span class="hyp-type"><b>: </b><span>composite_label IM2
‚Üí composite_state IM2 * option message
  ‚Üí <span class="kt">Prop</span></span></span></span><br><span><var>constraint_projection</var><span class="hyp-type"><b>: </b><span><span class="kr">‚àÄ</span> <span class="nv">s1</span> : state
         (preloaded_with_all_messages_vlsm
            (free_composite_vlsm
               IM1)),
  constrained_state_prop
    (free_composite_vlsm IM1)
    s1
  ‚Üí <span class="kr">‚àÄ</span> (<span class="nv">l1</span> : composite_label
              IM1) (<span class="nv">om</span> : 
                    option
                      message),
      constraint1 l1 (s1, om)
      ‚Üí constraint2
          (same_IM_label_rew
             l1)
          (same_IM_state_rew
             s1, om)</span></span></span><br><span><var>seed</var><span class="hyp-type"><b>: </b><span>message ‚Üí <span class="kt">Prop</span></span></span></span><br><span><var>l</var><span class="hyp-type"><b>: </b><span>label
  (preloaded_vlsm (composite_vlsm IM1 constraint1)
     seed)</span></span></span><br><span><var>s</var><span class="hyp-type"><b>: </b><span>state
  (preloaded_vlsm (composite_vlsm IM1 constraint1)
     seed)</span></span></span><br><span><var>m</var><span class="hyp-type"><b>: </b><span>message</span></span></span><br><span><var>Hv</var><span class="hyp-type"><b>: </b><span>input_valid
  (preloaded_vlsm
     (composite_vlsm IM1 constraint1) seed) l
  (s, Some m)</span></span></span><br><span><var>HsY</var><span class="hyp-type"><b>: </b><span>valid_state_prop
  (preloaded_vlsm
     (composite_vlsm IM2 constraint2) seed)
  (same_IM_state_rew s)</span></span></span><br><span><var>HmX</var><span class="hyp-type"><b>: </b><span>initial_message_prop m</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">initial_message_prop m</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="Composition-v-chk1e0" style="display: none" type="checkbox"><label class="alectryon-input" for="Composition-v-chk1e0"><span class="nb">destruct</span> HmX <span class="kr">as</span> [[i [[im Him] Hi]] | Hseed]; [| <span class="bp">by</span> <span class="nb">right</span>].</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>message, index</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>EqDecision0</var><span class="hyp-type"><b>: </b><span>EqDecision index</span></span></span><br><span><var>IM1, IM2</var><span class="hyp-type"><b>: </b><span>index ‚Üí VLSM message</span></span></span><br><span><var>Heq</var><span class="hyp-type"><b>: </b><span><span class="kr">‚àÄ</span> <span class="nv">i</span> : index, IM1 i = IM2 i</span></span></span><br><span><var>constraint1</var><span class="hyp-type"><b>: </b><span>composite_label IM1
‚Üí composite_state IM1 * option message
  ‚Üí <span class="kt">Prop</span></span></span></span><br><span><var>constraint2</var><span class="hyp-type"><b>: </b><span>composite_label IM2
‚Üí composite_state IM2 * option message
  ‚Üí <span class="kt">Prop</span></span></span></span><br><span><var>constraint_projection</var><span class="hyp-type"><b>: </b><span><span class="kr">‚àÄ</span> <span class="nv">s1</span> : state
         (preloaded_with_all_messages_vlsm
            (free_composite_vlsm
               IM1)),
  constrained_state_prop
    (free_composite_vlsm IM1)
    s1
  ‚Üí <span class="kr">‚àÄ</span> (<span class="nv">l1</span> : composite_label
              IM1) (<span class="nv">om</span> : 
                    option
                      message),
      constraint1 l1 (s1, om)
      ‚Üí constraint2
          (same_IM_label_rew
             l1)
          (same_IM_state_rew
             s1, om)</span></span></span><br><span><var>seed</var><span class="hyp-type"><b>: </b><span>message ‚Üí <span class="kt">Prop</span></span></span></span><br><span><var>l</var><span class="hyp-type"><b>: </b><span>label
  (preloaded_vlsm (composite_vlsm IM1 constraint1)
     seed)</span></span></span><br><span><var>s</var><span class="hyp-type"><b>: </b><span>state
  (preloaded_vlsm (composite_vlsm IM1 constraint1)
     seed)</span></span></span><br><span><var>m</var><span class="hyp-type"><b>: </b><span>message</span></span></span><br><span><var>Hv</var><span class="hyp-type"><b>: </b><span>input_valid
  (preloaded_vlsm
     (composite_vlsm IM1 constraint1) seed) l
  (s, Some m)</span></span></span><br><span><var>HsY</var><span class="hyp-type"><b>: </b><span>valid_state_prop
  (preloaded_vlsm
     (composite_vlsm IM2 constraint2) seed)
  (same_IM_state_rew s)</span></span></span><br><span><var>i</var><span class="hyp-type"><b>: </b><span>index</span></span></span><br><span><var>im</var><span class="hyp-type"><b>: </b><span>message</span></span></span><br><span><var>Him</var><span class="hyp-type"><b>: </b><span>initial_message_prop im</span></span></span><br><span><var>Hi</var><span class="hyp-type"><b>: </b><span>`(im ‚Üæ Him) = m</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">initial_message_prop m</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="Composition-v-chk1e1" style="display: none" type="checkbox"><label class="alectryon-input" for="Composition-v-chk1e1"><span class="nb">simpl</span> <span class="kr">in</span> Hi.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>message, index</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>EqDecision0</var><span class="hyp-type"><b>: </b><span>EqDecision index</span></span></span><br><span><var>IM1, IM2</var><span class="hyp-type"><b>: </b><span>index ‚Üí VLSM message</span></span></span><br><span><var>Heq</var><span class="hyp-type"><b>: </b><span><span class="kr">‚àÄ</span> <span class="nv">i</span> : index, IM1 i = IM2 i</span></span></span><br><span><var>constraint1</var><span class="hyp-type"><b>: </b><span>composite_label IM1
‚Üí composite_state IM1 * option message
  ‚Üí <span class="kt">Prop</span></span></span></span><br><span><var>constraint2</var><span class="hyp-type"><b>: </b><span>composite_label IM2
‚Üí composite_state IM2 * option message
  ‚Üí <span class="kt">Prop</span></span></span></span><br><span><var>constraint_projection</var><span class="hyp-type"><b>: </b><span><span class="kr">‚àÄ</span> <span class="nv">s1</span> : state
         (preloaded_with_all_messages_vlsm
            (free_composite_vlsm
               IM1)),
  constrained_state_prop
    (free_composite_vlsm IM1)
    s1
  ‚Üí <span class="kr">‚àÄ</span> (<span class="nv">l1</span> : composite_label
              IM1) (<span class="nv">om</span> : 
                    option
                      message),
      constraint1 l1 (s1, om)
      ‚Üí constraint2
          (same_IM_label_rew
             l1)
          (same_IM_state_rew
             s1, om)</span></span></span><br><span><var>seed</var><span class="hyp-type"><b>: </b><span>message ‚Üí <span class="kt">Prop</span></span></span></span><br><span><var>l</var><span class="hyp-type"><b>: </b><span>label
  (preloaded_vlsm (composite_vlsm IM1 constraint1)
     seed)</span></span></span><br><span><var>s</var><span class="hyp-type"><b>: </b><span>state
  (preloaded_vlsm (composite_vlsm IM1 constraint1)
     seed)</span></span></span><br><span><var>m</var><span class="hyp-type"><b>: </b><span>message</span></span></span><br><span><var>Hv</var><span class="hyp-type"><b>: </b><span>input_valid
  (preloaded_vlsm
     (composite_vlsm IM1 constraint1) seed) l
  (s, Some m)</span></span></span><br><span><var>HsY</var><span class="hyp-type"><b>: </b><span>valid_state_prop
  (preloaded_vlsm
     (composite_vlsm IM2 constraint2) seed)
  (same_IM_state_rew s)</span></span></span><br><span><var>i</var><span class="hyp-type"><b>: </b><span>index</span></span></span><br><span><var>im</var><span class="hyp-type"><b>: </b><span>message</span></span></span><br><span><var>Him</var><span class="hyp-type"><b>: </b><span>initial_message_prop im</span></span></span><br><span><var>Hi</var><span class="hyp-type"><b>: </b><span>im = m</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">initial_message_prop m</div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="Composition-v-chk1e2" style="display: none" type="checkbox"><label class="alectryon-input" for="Composition-v-chk1e2"><span class="nb">subst</span> im.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>message, index</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>EqDecision0</var><span class="hyp-type"><b>: </b><span>EqDecision index</span></span></span><br><span><var>IM1, IM2</var><span class="hyp-type"><b>: </b><span>index ‚Üí VLSM message</span></span></span><br><span><var>Heq</var><span class="hyp-type"><b>: </b><span><span class="kr">‚àÄ</span> <span class="nv">i</span> : index, IM1 i = IM2 i</span></span></span><br><span><var>constraint1</var><span class="hyp-type"><b>: </b><span>composite_label IM1
‚Üí composite_state IM1 * option message
  ‚Üí <span class="kt">Prop</span></span></span></span><br><span><var>constraint2</var><span class="hyp-type"><b>: </b><span>composite_label IM2
‚Üí composite_state IM2 * option message
  ‚Üí <span class="kt">Prop</span></span></span></span><br><span><var>constraint_projection</var><span class="hyp-type"><b>: </b><span><span class="kr">‚àÄ</span> <span class="nv">s1</span> : state
         (preloaded_with_all_messages_vlsm
            (free_composite_vlsm
               IM1)),
  constrained_state_prop
    (free_composite_vlsm IM1)
    s1
  ‚Üí <span class="kr">‚àÄ</span> (<span class="nv">l1</span> : composite_label
              IM1) (<span class="nv">om</span> : 
                    option
                      message),
      constraint1 l1 (s1, om)
      ‚Üí constraint2
          (same_IM_label_rew
             l1)
          (same_IM_state_rew
             s1, om)</span></span></span><br><span><var>seed</var><span class="hyp-type"><b>: </b><span>message ‚Üí <span class="kt">Prop</span></span></span></span><br><span><var>l</var><span class="hyp-type"><b>: </b><span>label
  (preloaded_vlsm (composite_vlsm IM1 constraint1)
     seed)</span></span></span><br><span><var>s</var><span class="hyp-type"><b>: </b><span>state
  (preloaded_vlsm (composite_vlsm IM1 constraint1)
     seed)</span></span></span><br><span><var>m</var><span class="hyp-type"><b>: </b><span>message</span></span></span><br><span><var>Hv</var><span class="hyp-type"><b>: </b><span>input_valid
  (preloaded_vlsm
     (composite_vlsm IM1 constraint1) seed) l
  (s, Some m)</span></span></span><br><span><var>HsY</var><span class="hyp-type"><b>: </b><span>valid_state_prop
  (preloaded_vlsm
     (composite_vlsm IM2 constraint2) seed)
  (same_IM_state_rew s)</span></span></span><br><span><var>i</var><span class="hyp-type"><b>: </b><span>index</span></span></span><br><span><var>Him</var><span class="hyp-type"><b>: </b><span>initial_message_prop m</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">initial_message_prop m</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="Composition-v-chk1e3" style="display: none" type="checkbox"><label class="alectryon-input" for="Composition-v-chk1e3"><span class="nb">cbn</span>.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>message, index</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>EqDecision0</var><span class="hyp-type"><b>: </b><span>EqDecision index</span></span></span><br><span><var>IM1, IM2</var><span class="hyp-type"><b>: </b><span>index ‚Üí VLSM message</span></span></span><br><span><var>Heq</var><span class="hyp-type"><b>: </b><span><span class="kr">‚àÄ</span> <span class="nv">i</span> : index, IM1 i = IM2 i</span></span></span><br><span><var>constraint1</var><span class="hyp-type"><b>: </b><span>composite_label IM1
‚Üí composite_state IM1 * option message
  ‚Üí <span class="kt">Prop</span></span></span></span><br><span><var>constraint2</var><span class="hyp-type"><b>: </b><span>composite_label IM2
‚Üí composite_state IM2 * option message
  ‚Üí <span class="kt">Prop</span></span></span></span><br><span><var>constraint_projection</var><span class="hyp-type"><b>: </b><span><span class="kr">‚àÄ</span> <span class="nv">s1</span> : state
         (preloaded_with_all_messages_vlsm
            (free_composite_vlsm
               IM1)),
  constrained_state_prop
    (free_composite_vlsm IM1)
    s1
  ‚Üí <span class="kr">‚àÄ</span> (<span class="nv">l1</span> : composite_label
              IM1) (<span class="nv">om</span> : 
                    option
                      message),
      constraint1 l1 (s1, om)
      ‚Üí constraint2
          (same_IM_label_rew
             l1)
          (same_IM_state_rew
             s1, om)</span></span></span><br><span><var>seed</var><span class="hyp-type"><b>: </b><span>message ‚Üí <span class="kt">Prop</span></span></span></span><br><span><var>l</var><span class="hyp-type"><b>: </b><span>label
  (preloaded_vlsm (composite_vlsm IM1 constraint1)
     seed)</span></span></span><br><span><var>s</var><span class="hyp-type"><b>: </b><span>state
  (preloaded_vlsm (composite_vlsm IM1 constraint1)
     seed)</span></span></span><br><span><var>m</var><span class="hyp-type"><b>: </b><span>message</span></span></span><br><span><var>Hv</var><span class="hyp-type"><b>: </b><span>input_valid
  (preloaded_vlsm
     (composite_vlsm IM1 constraint1) seed) l
  (s, Some m)</span></span></span><br><span><var>HsY</var><span class="hyp-type"><b>: </b><span>valid_state_prop
  (preloaded_vlsm
     (composite_vlsm IM2 constraint2) seed)
  (same_IM_state_rew s)</span></span></span><br><span><var>i</var><span class="hyp-type"><b>: </b><span>index</span></span></span><br><span><var>Him</var><span class="hyp-type"><b>: </b><span>initial_message_prop m</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">composite_initial_message_prop IM2 m ‚à® seed m</div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="Composition-v-chk1e4" style="display: none" type="checkbox"><label class="alectryon-input" for="Composition-v-chk1e4"><span class="nb">unfold</span> composite_initial_message_prop.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>message, index</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>EqDecision0</var><span class="hyp-type"><b>: </b><span>EqDecision index</span></span></span><br><span><var>IM1, IM2</var><span class="hyp-type"><b>: </b><span>index ‚Üí VLSM message</span></span></span><br><span><var>Heq</var><span class="hyp-type"><b>: </b><span><span class="kr">‚àÄ</span> <span class="nv">i</span> : index, IM1 i = IM2 i</span></span></span><br><span><var>constraint1</var><span class="hyp-type"><b>: </b><span>composite_label IM1
‚Üí composite_state IM1 * option message
  ‚Üí <span class="kt">Prop</span></span></span></span><br><span><var>constraint2</var><span class="hyp-type"><b>: </b><span>composite_label IM2
‚Üí composite_state IM2 * option message
  ‚Üí <span class="kt">Prop</span></span></span></span><br><span><var>constraint_projection</var><span class="hyp-type"><b>: </b><span><span class="kr">‚àÄ</span> <span class="nv">s1</span> : state
         (preloaded_with_all_messages_vlsm
            (free_composite_vlsm
               IM1)),
  constrained_state_prop
    (free_composite_vlsm IM1)
    s1
  ‚Üí <span class="kr">‚àÄ</span> (<span class="nv">l1</span> : composite_label
              IM1) (<span class="nv">om</span> : 
                    option
                      message),
      constraint1 l1 (s1, om)
      ‚Üí constraint2
          (same_IM_label_rew
             l1)
          (same_IM_state_rew
             s1, om)</span></span></span><br><span><var>seed</var><span class="hyp-type"><b>: </b><span>message ‚Üí <span class="kt">Prop</span></span></span></span><br><span><var>l</var><span class="hyp-type"><b>: </b><span>label
  (preloaded_vlsm (composite_vlsm IM1 constraint1)
     seed)</span></span></span><br><span><var>s</var><span class="hyp-type"><b>: </b><span>state
  (preloaded_vlsm (composite_vlsm IM1 constraint1)
     seed)</span></span></span><br><span><var>m</var><span class="hyp-type"><b>: </b><span>message</span></span></span><br><span><var>Hv</var><span class="hyp-type"><b>: </b><span>input_valid
  (preloaded_vlsm
     (composite_vlsm IM1 constraint1) seed) l
  (s, Some m)</span></span></span><br><span><var>HsY</var><span class="hyp-type"><b>: </b><span>valid_state_prop
  (preloaded_vlsm
     (composite_vlsm IM2 constraint2) seed)
  (same_IM_state_rew s)</span></span></span><br><span><var>i</var><span class="hyp-type"><b>: </b><span>index</span></span></span><br><span><var>Him</var><span class="hyp-type"><b>: </b><span>initial_message_prop m</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">(<span class="kr">‚àÉ</span> (<span class="nv">n</span> : index) (<span class="nv">mi</span> : initial_message (IM2 n)), `mi = m)
‚à® seed m</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="Composition-v-chk1e5" style="display: none" type="checkbox"><label class="alectryon-input" for="Composition-v-chk1e5"><span class="nb">left</span>; <span class="kr">exists</span> <span class="nv">i</span>.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>message, index</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>EqDecision0</var><span class="hyp-type"><b>: </b><span>EqDecision index</span></span></span><br><span><var>IM1, IM2</var><span class="hyp-type"><b>: </b><span>index ‚Üí VLSM message</span></span></span><br><span><var>Heq</var><span class="hyp-type"><b>: </b><span><span class="kr">‚àÄ</span> <span class="nv">i</span> : index, IM1 i = IM2 i</span></span></span><br><span><var>constraint1</var><span class="hyp-type"><b>: </b><span>composite_label IM1
‚Üí composite_state IM1 * option message
  ‚Üí <span class="kt">Prop</span></span></span></span><br><span><var>constraint2</var><span class="hyp-type"><b>: </b><span>composite_label IM2
‚Üí composite_state IM2 * option message
  ‚Üí <span class="kt">Prop</span></span></span></span><br><span><var>constraint_projection</var><span class="hyp-type"><b>: </b><span><span class="kr">‚àÄ</span> <span class="nv">s1</span> : state
         (preloaded_with_all_messages_vlsm
            (free_composite_vlsm
               IM1)),
  constrained_state_prop
    (free_composite_vlsm IM1)
    s1
  ‚Üí <span class="kr">‚àÄ</span> (<span class="nv">l1</span> : composite_label
              IM1) (<span class="nv">om</span> : 
                    option
                      message),
      constraint1 l1 (s1, om)
      ‚Üí constraint2
          (same_IM_label_rew
             l1)
          (same_IM_state_rew
             s1, om)</span></span></span><br><span><var>seed</var><span class="hyp-type"><b>: </b><span>message ‚Üí <span class="kt">Prop</span></span></span></span><br><span><var>l</var><span class="hyp-type"><b>: </b><span>label
  (preloaded_vlsm (composite_vlsm IM1 constraint1)
     seed)</span></span></span><br><span><var>s</var><span class="hyp-type"><b>: </b><span>state
  (preloaded_vlsm (composite_vlsm IM1 constraint1)
     seed)</span></span></span><br><span><var>m</var><span class="hyp-type"><b>: </b><span>message</span></span></span><br><span><var>Hv</var><span class="hyp-type"><b>: </b><span>input_valid
  (preloaded_vlsm
     (composite_vlsm IM1 constraint1) seed) l
  (s, Some m)</span></span></span><br><span><var>HsY</var><span class="hyp-type"><b>: </b><span>valid_state_prop
  (preloaded_vlsm
     (composite_vlsm IM2 constraint2) seed)
  (same_IM_state_rew s)</span></span></span><br><span><var>i</var><span class="hyp-type"><b>: </b><span>index</span></span></span><br><span><var>Him</var><span class="hyp-type"><b>: </b><span>initial_message_prop m</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="kr">‚àÉ</span> <span class="nv">mi</span> : initial_message (IM2 i), `mi = m</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="Composition-v-chk1e6" style="display: none" type="checkbox"><label class="alectryon-input" for="Composition-v-chk1e6"><span class="nb">unshelve</span> <span class="nb">esplit</span>.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>message, index</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>EqDecision0</var><span class="hyp-type"><b>: </b><span>EqDecision index</span></span></span><br><span><var>IM1, IM2</var><span class="hyp-type"><b>: </b><span>index ‚Üí VLSM message</span></span></span><br><span><var>Heq</var><span class="hyp-type"><b>: </b><span><span class="kr">‚àÄ</span> <span class="nv">i</span> : index, IM1 i = IM2 i</span></span></span><br><span><var>constraint1</var><span class="hyp-type"><b>: </b><span>composite_label IM1
‚Üí composite_state IM1 * option message
  ‚Üí <span class="kt">Prop</span></span></span></span><br><span><var>constraint2</var><span class="hyp-type"><b>: </b><span>composite_label IM2
‚Üí composite_state IM2 * option message
  ‚Üí <span class="kt">Prop</span></span></span></span><br><span><var>constraint_projection</var><span class="hyp-type"><b>: </b><span><span class="kr">‚àÄ</span> <span class="nv">s1</span> : state
         (preloaded_with_all_messages_vlsm
            (free_composite_vlsm
               IM1)),
  constrained_state_prop
    (free_composite_vlsm IM1)
    s1
  ‚Üí <span class="kr">‚àÄ</span> (<span class="nv">l1</span> : composite_label
              IM1) (<span class="nv">om</span> : 
                    option
                      message),
      constraint1 l1 (s1, om)
      ‚Üí constraint2
          (same_IM_label_rew
             l1)
          (same_IM_state_rew
             s1, om)</span></span></span><br><span><var>seed</var><span class="hyp-type"><b>: </b><span>message ‚Üí <span class="kt">Prop</span></span></span></span><br><span><var>l</var><span class="hyp-type"><b>: </b><span>label
  (preloaded_vlsm (composite_vlsm IM1 constraint1)
     seed)</span></span></span><br><span><var>s</var><span class="hyp-type"><b>: </b><span>state
  (preloaded_vlsm (composite_vlsm IM1 constraint1)
     seed)</span></span></span><br><span><var>m</var><span class="hyp-type"><b>: </b><span>message</span></span></span><br><span><var>Hv</var><span class="hyp-type"><b>: </b><span>input_valid
  (preloaded_vlsm
     (composite_vlsm IM1 constraint1) seed) l
  (s, Some m)</span></span></span><br><span><var>HsY</var><span class="hyp-type"><b>: </b><span>valid_state_prop
  (preloaded_vlsm
     (composite_vlsm IM2 constraint2) seed)
  (same_IM_state_rew s)</span></span></span><br><span><var>i</var><span class="hyp-type"><b>: </b><span>index</span></span></span><br><span><var>Him</var><span class="hyp-type"><b>: </b><span>initial_message_prop m</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">initial_message (IM2 i)</div></blockquote><div class="alectryon-extra-goals"><input class="alectryon-extra-goal-toggle" id="Composition-v-chk1e7" style="display: none" type="checkbox"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>message, index</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>EqDecision0</var><span class="hyp-type"><b>: </b><span>EqDecision index</span></span></span><br><span><var>IM1, IM2</var><span class="hyp-type"><b>: </b><span>index ‚Üí VLSM message</span></span></span><br><span><var>Heq</var><span class="hyp-type"><b>: </b><span><span class="kr">‚àÄ</span> <span class="nv">i</span> : index, IM1 i = IM2 i</span></span></span><br><span><var>constraint1</var><span class="hyp-type"><b>: </b><span>composite_label IM1
‚Üí composite_state IM1 * option message
  ‚Üí <span class="kt">Prop</span></span></span></span><br><span><var>constraint2</var><span class="hyp-type"><b>: </b><span>composite_label IM2
‚Üí composite_state IM2 * option message
  ‚Üí <span class="kt">Prop</span></span></span></span><br><span><var>constraint_projection</var><span class="hyp-type"><b>: </b><span><span class="kr">‚àÄ</span> <span class="nv">s1</span> : state
         (preloaded_with_all_messages_vlsm
            (free_composite_vlsm
               IM1)),
  constrained_state_prop
    (free_composite_vlsm IM1)
    s1
  ‚Üí <span class="kr">‚àÄ</span> (<span class="nv">l1</span> : composite_label
              IM1) (<span class="nv">om</span> : 
                    option
                      message),
      constraint1 l1 (s1, om)
      ‚Üí constraint2
          (same_IM_label_rew
             l1)
          (same_IM_state_rew
             s1, om)</span></span></span><br><span><var>seed</var><span class="hyp-type"><b>: </b><span>message ‚Üí <span class="kt">Prop</span></span></span></span><br><span><var>l</var><span class="hyp-type"><b>: </b><span>label
  (preloaded_vlsm (composite_vlsm IM1 constraint1)
     seed)</span></span></span><br><span><var>s</var><span class="hyp-type"><b>: </b><span>state
  (preloaded_vlsm (composite_vlsm IM1 constraint1)
     seed)</span></span></span><br><span><var>m</var><span class="hyp-type"><b>: </b><span>message</span></span></span><br><span><var>Hv</var><span class="hyp-type"><b>: </b><span>input_valid
  (preloaded_vlsm
     (composite_vlsm IM1 constraint1) seed) l
  (s, Some m)</span></span></span><br><span><var>HsY</var><span class="hyp-type"><b>: </b><span>valid_state_prop
  (preloaded_vlsm
     (composite_vlsm IM2 constraint2) seed)
  (same_IM_state_rew s)</span></span></span><br><span><var>i</var><span class="hyp-type"><b>: </b><span>index</span></span></span><br><span><var>Him</var><span class="hyp-type"><b>: </b><span>initial_message_prop m</span></span></span><br></div><label class="goal-separator" for="Composition-v-chk1e7"><hr></label><div class="goal-conclusion">`<span class="nl">?mi</span> = m</div></blockquote></div></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="Composition-v-chk1e8" style="display: none" type="checkbox"><label class="alectryon-input" for="Composition-v-chk1e8">+</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>message, index</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>EqDecision0</var><span class="hyp-type"><b>: </b><span>EqDecision index</span></span></span><br><span><var>IM1, IM2</var><span class="hyp-type"><b>: </b><span>index ‚Üí VLSM message</span></span></span><br><span><var>Heq</var><span class="hyp-type"><b>: </b><span><span class="kr">‚àÄ</span> <span class="nv">i</span> : index, IM1 i = IM2 i</span></span></span><br><span><var>constraint1</var><span class="hyp-type"><b>: </b><span>composite_label IM1
‚Üí composite_state IM1 * option message
  ‚Üí <span class="kt">Prop</span></span></span></span><br><span><var>constraint2</var><span class="hyp-type"><b>: </b><span>composite_label IM2
‚Üí composite_state IM2 * option message
  ‚Üí <span class="kt">Prop</span></span></span></span><br><span><var>constraint_projection</var><span class="hyp-type"><b>: </b><span><span class="kr">‚àÄ</span> <span class="nv">s1</span> : state
         (preloaded_with_all_messages_vlsm
            (free_composite_vlsm
               IM1)),
  constrained_state_prop
    (free_composite_vlsm IM1)
    s1
  ‚Üí <span class="kr">‚àÄ</span> (<span class="nv">l1</span> : composite_label
              IM1) (<span class="nv">om</span> : 
                    option
                      message),
      constraint1 l1 (s1, om)
      ‚Üí constraint2
          (same_IM_label_rew
             l1)
          (same_IM_state_rew
             s1, om)</span></span></span><br><span><var>seed</var><span class="hyp-type"><b>: </b><span>message ‚Üí <span class="kt">Prop</span></span></span></span><br><span><var>l</var><span class="hyp-type"><b>: </b><span>label
  (preloaded_vlsm (composite_vlsm IM1 constraint1)
     seed)</span></span></span><br><span><var>s</var><span class="hyp-type"><b>: </b><span>state
  (preloaded_vlsm (composite_vlsm IM1 constraint1)
     seed)</span></span></span><br><span><var>m</var><span class="hyp-type"><b>: </b><span>message</span></span></span><br><span><var>Hv</var><span class="hyp-type"><b>: </b><span>input_valid
  (preloaded_vlsm
     (composite_vlsm IM1 constraint1) seed) l
  (s, Some m)</span></span></span><br><span><var>HsY</var><span class="hyp-type"><b>: </b><span>valid_state_prop
  (preloaded_vlsm
     (composite_vlsm IM2 constraint2) seed)
  (same_IM_state_rew s)</span></span></span><br><span><var>i</var><span class="hyp-type"><b>: </b><span>index</span></span></span><br><span><var>Him</var><span class="hyp-type"><b>: </b><span>initial_message_prop m</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">initial_message (IM2 i)</div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="bp">by</span> <span class="kr">exists</span> <span class="nv">m</span>; <span class="nb">eapply</span> same_VLSM_initial_message_preservation; <span class="nb">eauto</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="Composition-v-chk1e9" style="display: none" type="checkbox"><label class="alectryon-input" for="Composition-v-chk1e9">+</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>message, index</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>EqDecision0</var><span class="hyp-type"><b>: </b><span>EqDecision index</span></span></span><br><span><var>IM1, IM2</var><span class="hyp-type"><b>: </b><span>index ‚Üí VLSM message</span></span></span><br><span><var>Heq</var><span class="hyp-type"><b>: </b><span><span class="kr">‚àÄ</span> <span class="nv">i</span> : index, IM1 i = IM2 i</span></span></span><br><span><var>constraint1</var><span class="hyp-type"><b>: </b><span>composite_label IM1
‚Üí composite_state IM1 * option message
  ‚Üí <span class="kt">Prop</span></span></span></span><br><span><var>constraint2</var><span class="hyp-type"><b>: </b><span>composite_label IM2
‚Üí composite_state IM2 * option message
  ‚Üí <span class="kt">Prop</span></span></span></span><br><span><var>constraint_projection</var><span class="hyp-type"><b>: </b><span><span class="kr">‚àÄ</span> <span class="nv">s1</span> : state
         (preloaded_with_all_messages_vlsm
            (free_composite_vlsm
               IM1)),
  constrained_state_prop
    (free_composite_vlsm IM1)
    s1
  ‚Üí <span class="kr">‚àÄ</span> (<span class="nv">l1</span> : composite_label
              IM1) (<span class="nv">om</span> : 
                    option
                      message),
      constraint1 l1 (s1, om)
      ‚Üí constraint2
          (same_IM_label_rew
             l1)
          (same_IM_state_rew
             s1, om)</span></span></span><br><span><var>seed</var><span class="hyp-type"><b>: </b><span>message ‚Üí <span class="kt">Prop</span></span></span></span><br><span><var>l</var><span class="hyp-type"><b>: </b><span>label
  (preloaded_vlsm (composite_vlsm IM1 constraint1)
     seed)</span></span></span><br><span><var>s</var><span class="hyp-type"><b>: </b><span>state
  (preloaded_vlsm (composite_vlsm IM1 constraint1)
     seed)</span></span></span><br><span><var>m</var><span class="hyp-type"><b>: </b><span>message</span></span></span><br><span><var>Hv</var><span class="hyp-type"><b>: </b><span>input_valid
  (preloaded_vlsm
     (composite_vlsm IM1 constraint1) seed) l
  (s, Some m)</span></span></span><br><span><var>HsY</var><span class="hyp-type"><b>: </b><span>valid_state_prop
  (preloaded_vlsm
     (composite_vlsm IM2 constraint2) seed)
  (same_IM_state_rew s)</span></span></span><br><span><var>i</var><span class="hyp-type"><b>: </b><span>index</span></span></span><br><span><var>Him</var><span class="hyp-type"><b>: </b><span>initial_message_prop m</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">`(m
  ‚Üæ same_VLSM_initial_message_preservation (IM1 i)
      (IM2 i) (Heq i) m Him) = m</div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="bp">done</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Qed</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
</span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">End</span> <span class="nf">sec_preloaded_constrained</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
</span><span class="alectryon-sentence"><input class="alectryon-toggle" id="Composition-v-chk1ea" style="display: none" type="checkbox"><label class="alectryon-input" for="Composition-v-chk1ea"><span class="kn">Lemma</span> <span class="nf">same_IM_preloaded_free_embedding</span> :
  VLSM_embedding
    (preloaded_with_all_messages_vlsm (free_composite_vlsm IM1))
    (preloaded_with_all_messages_vlsm (free_composite_vlsm IM2))
    same_IM_label_rew
    same_IM_state_rew.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>message, index</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>EqDecision0</var><span class="hyp-type"><b>: </b><span>EqDecision index</span></span></span><br><span><var>IM1, IM2</var><span class="hyp-type"><b>: </b><span>index ‚Üí VLSM message</span></span></span><br><span><var>Heq</var><span class="hyp-type"><b>: </b><span><span class="kr">‚àÄ</span> <span class="nv">i</span> : index, IM1 i = IM2 i</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">VLSM_embedding
  (preloaded_with_all_messages_vlsm
     (free_composite_vlsm IM1))
  (preloaded_with_all_messages_vlsm
     (free_composite_vlsm IM2)) same_IM_label_rew
  same_IM_state_rew</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="Composition-v-chk1eb" style="display: none" type="checkbox"><label class="alectryon-input" for="Composition-v-chk1eb"><span class="kn">Proof</span>.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>message, index</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>EqDecision0</var><span class="hyp-type"><b>: </b><span>EqDecision index</span></span></span><br><span><var>IM1, IM2</var><span class="hyp-type"><b>: </b><span>index ‚Üí VLSM message</span></span></span><br><span><var>Heq</var><span class="hyp-type"><b>: </b><span><span class="kr">‚àÄ</span> <span class="nv">i</span> : index, IM1 i = IM2 i</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">VLSM_embedding
  (preloaded_with_all_messages_vlsm
     (free_composite_vlsm IM1))
  (preloaded_with_all_messages_vlsm
     (free_composite_vlsm IM2)) same_IM_label_rew
  same_IM_state_rew</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="Composition-v-chk1ec" style="display: none" type="checkbox"><label class="alectryon-input" for="Composition-v-chk1ec"><span class="nb">constructor</span>.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>message, index</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>EqDecision0</var><span class="hyp-type"><b>: </b><span>EqDecision index</span></span></span><br><span><var>IM1, IM2</var><span class="hyp-type"><b>: </b><span>index ‚Üí VLSM message</span></span></span><br><span><var>Heq</var><span class="hyp-type"><b>: </b><span><span class="kr">‚àÄ</span> <span class="nv">i</span> : index, IM1 i = IM2 i</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="kr">‚àÄ</span> (<span class="nv">sX</span> : state
          (preloaded_with_all_messages_vlsm
             (free_composite_vlsm IM1))) (<span class="nv">trX</span> : list
                                                 transition_item),
  finite_valid_trace
    (preloaded_with_all_messages_vlsm
       (free_composite_vlsm IM1)) sX trX
  ‚Üí finite_valid_trace
      (preloaded_with_all_messages_vlsm
         (free_composite_vlsm IM2))
      (same_IM_state_rew sX)
      (pre_VLSM_embedding_finite_trace_project
         (preloaded_with_all_messages_vlsm
            (free_composite_vlsm IM1))
         (preloaded_with_all_messages_vlsm
            (free_composite_vlsm IM2))
         same_IM_label_rew same_IM_state_rew trX)</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="Composition-v-chk1ed" style="display: none" type="checkbox"><label class="alectryon-input" for="Composition-v-chk1ed"><span class="nb">intros</span> s1 tr1 Htr1.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>message, index</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>EqDecision0</var><span class="hyp-type"><b>: </b><span>EqDecision index</span></span></span><br><span><var>IM1, IM2</var><span class="hyp-type"><b>: </b><span>index ‚Üí VLSM message</span></span></span><br><span><var>Heq</var><span class="hyp-type"><b>: </b><span><span class="kr">‚àÄ</span> <span class="nv">i</span> : index, IM1 i = IM2 i</span></span></span><br><span><var>s1</var><span class="hyp-type"><b>: </b><span>state
  (preloaded_with_all_messages_vlsm
     (free_composite_vlsm IM1))</span></span></span><br><span><var>tr1</var><span class="hyp-type"><b>: </b><span>list transition_item</span></span></span><br><span><var>Htr1</var><span class="hyp-type"><b>: </b><span>finite_valid_trace
  (preloaded_with_all_messages_vlsm
     (free_composite_vlsm IM1)) s1 tr1</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">finite_valid_trace
  (preloaded_with_all_messages_vlsm
     (free_composite_vlsm IM2)) (same_IM_state_rew s1)
  (pre_VLSM_embedding_finite_trace_project
     (preloaded_with_all_messages_vlsm
        (free_composite_vlsm IM1))
     (preloaded_with_all_messages_vlsm
        (free_composite_vlsm IM2)) same_IM_label_rew
     same_IM_state_rew tr1)</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="Composition-v-chk1ee" style="display: none" type="checkbox"><label class="alectryon-input" for="Composition-v-chk1ee"><span class="nb">eapply</span> VLSM_incl_finite_valid_trace <span class="kr">in</span> Htr1; [| <span class="bp">by</span> <span class="nb">apply</span> preloaded_free_composite_vlsm_spec].</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>message, index</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>EqDecision0</var><span class="hyp-type"><b>: </b><span>EqDecision index</span></span></span><br><span><var>IM1, IM2</var><span class="hyp-type"><b>: </b><span>index ‚Üí VLSM message</span></span></span><br><span><var>Heq</var><span class="hyp-type"><b>: </b><span><span class="kr">‚àÄ</span> <span class="nv">i</span> : index, IM1 i = IM2 i</span></span></span><br><span><var>s1</var><span class="hyp-type"><b>: </b><span>state
  (preloaded_with_all_messages_vlsm
     (free_composite_vlsm IM1))</span></span></span><br><span><var>tr1</var><span class="hyp-type"><b>: </b><span>list transition_item</span></span></span><br><span><var>Htr1</var><span class="hyp-type"><b>: </b><span>finite_valid_trace
  {|
    vlsm_type := free_composite_vlsm IM1;
    vlsm_machine :=
      {|
        vlsm_type :=
          preloaded_vlsm
            (free_composite_vlsm IM1)
            (<span class="kr">Œª</span> <span class="nv">_</span> : message, <span class="kt">True</span>);
        vlsm_machine :=
          preloaded_vlsm
            (composite_vlsm IM1
               (free_constraint IM1))
            (<span class="kr">Œª</span> <span class="nv">_</span> : message, <span class="kt">True</span>)
      |}
  |} s1 tr1</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">finite_valid_trace
  (preloaded_with_all_messages_vlsm
     (free_composite_vlsm IM2)) (same_IM_state_rew s1)
  (pre_VLSM_embedding_finite_trace_project
     (preloaded_with_all_messages_vlsm
        (free_composite_vlsm IM1))
     (preloaded_with_all_messages_vlsm
        (free_composite_vlsm IM2)) same_IM_label_rew
     same_IM_state_rew tr1)</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="Composition-v-chk1ef" style="display: none" type="checkbox"><label class="alectryon-input" for="Composition-v-chk1ef"><span class="nb">pose proof</span> (Hproj := same_IM_embedding (free_constraint IM1) (free_constraint IM2)
    <span class="kp">ltac</span>:(<span class="bp">done</span>) (<span class="kr">fun</span> <span class="nv">_</span> =&gt; <span class="kt">True</span>)).</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>message, index</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>EqDecision0</var><span class="hyp-type"><b>: </b><span>EqDecision index</span></span></span><br><span><var>IM1, IM2</var><span class="hyp-type"><b>: </b><span>index ‚Üí VLSM message</span></span></span><br><span><var>Heq</var><span class="hyp-type"><b>: </b><span><span class="kr">‚àÄ</span> <span class="nv">i</span> : index, IM1 i = IM2 i</span></span></span><br><span><var>s1</var><span class="hyp-type"><b>: </b><span>state
  (preloaded_with_all_messages_vlsm
     (free_composite_vlsm IM1))</span></span></span><br><span><var>tr1</var><span class="hyp-type"><b>: </b><span>list transition_item</span></span></span><br><span><var>Htr1</var><span class="hyp-type"><b>: </b><span>finite_valid_trace
  {|
    vlsm_type := free_composite_vlsm IM1;
    vlsm_machine :=
      {|
        vlsm_type :=
          preloaded_vlsm
            (free_composite_vlsm IM1)
            (<span class="kr">Œª</span> <span class="nv">_</span> : message, <span class="kt">True</span>);
        vlsm_machine :=
          preloaded_vlsm
            (composite_vlsm IM1
               (free_constraint IM1))
            (<span class="kr">Œª</span> <span class="nv">_</span> : message, <span class="kt">True</span>)
      |}
  |} s1 tr1</span></span></span><br><span><var>Hproj</var><span class="hyp-type"><b>: </b><span>VLSM_embedding
  (preloaded_vlsm
     (composite_vlsm IM1 (free_constraint IM1))
     (<span class="kr">Œª</span> <span class="nv">_</span> : message, <span class="kt">True</span>))
  (preloaded_vlsm
     (composite_vlsm IM2 (free_constraint IM2))
     (<span class="kr">Œª</span> <span class="nv">_</span> : message, <span class="kt">True</span>)) same_IM_label_rew
  same_IM_state_rew</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">finite_valid_trace
  (preloaded_with_all_messages_vlsm
     (free_composite_vlsm IM2)) (same_IM_state_rew s1)
  (pre_VLSM_embedding_finite_trace_project
     (preloaded_with_all_messages_vlsm
        (free_composite_vlsm IM1))
     (preloaded_with_all_messages_vlsm
        (free_composite_vlsm IM2)) same_IM_label_rew
     same_IM_state_rew tr1)</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="Composition-v-chk1f0" style="display: none" type="checkbox"><label class="alectryon-input" for="Composition-v-chk1f0"><span class="nb">apply</span> (VLSM_embedding_finite_valid_trace Hproj) <span class="kr">in</span> Htr1.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>message, index</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>EqDecision0</var><span class="hyp-type"><b>: </b><span>EqDecision index</span></span></span><br><span><var>IM1, IM2</var><span class="hyp-type"><b>: </b><span>index ‚Üí VLSM message</span></span></span><br><span><var>Heq</var><span class="hyp-type"><b>: </b><span><span class="kr">‚àÄ</span> <span class="nv">i</span> : index, IM1 i = IM2 i</span></span></span><br><span><var>s1</var><span class="hyp-type"><b>: </b><span>state
  (preloaded_with_all_messages_vlsm
     (free_composite_vlsm IM1))</span></span></span><br><span><var>tr1</var><span class="hyp-type"><b>: </b><span>list transition_item</span></span></span><br><span><var>Hproj</var><span class="hyp-type"><b>: </b><span>VLSM_embedding
  (preloaded_vlsm
     (composite_vlsm IM1 (free_constraint IM1))
     (<span class="kr">Œª</span> <span class="nv">_</span> : message, <span class="kt">True</span>))
  (preloaded_vlsm
     (composite_vlsm IM2 (free_constraint IM2))
     (<span class="kr">Œª</span> <span class="nv">_</span> : message, <span class="kt">True</span>)) same_IM_label_rew
  same_IM_state_rew</span></span></span><br><span><var>Htr1</var><span class="hyp-type"><b>: </b><span>finite_valid_trace
  (preloaded_vlsm
     (composite_vlsm IM2 (free_constraint IM2))
     (<span class="kr">Œª</span> <span class="nv">_</span> : message, <span class="kt">True</span>))
  (same_IM_state_rew s1)
  (VLSM_embedding_finite_trace_project Hproj
     tr1)</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">finite_valid_trace
  (preloaded_with_all_messages_vlsm
     (free_composite_vlsm IM2)) (same_IM_state_rew s1)
  (pre_VLSM_embedding_finite_trace_project
     (preloaded_with_all_messages_vlsm
        (free_composite_vlsm IM1))
     (preloaded_with_all_messages_vlsm
        (free_composite_vlsm IM2)) same_IM_label_rew
     same_IM_state_rew tr1)</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="Composition-v-chk1f1" style="display: none" type="checkbox"><label class="alectryon-input" for="Composition-v-chk1f1"><span class="nb">eapply</span> VLSM_incl_finite_valid_trace <span class="kr">in</span> Htr1; [<span class="bp">done</span> |].</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>message, index</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>EqDecision0</var><span class="hyp-type"><b>: </b><span>EqDecision index</span></span></span><br><span><var>IM1, IM2</var><span class="hyp-type"><b>: </b><span>index ‚Üí VLSM message</span></span></span><br><span><var>Heq</var><span class="hyp-type"><b>: </b><span><span class="kr">‚àÄ</span> <span class="nv">i</span> : index, IM1 i = IM2 i</span></span></span><br><span><var>s1</var><span class="hyp-type"><b>: </b><span>state
  (preloaded_with_all_messages_vlsm
     (free_composite_vlsm IM1))</span></span></span><br><span><var>tr1</var><span class="hyp-type"><b>: </b><span>list transition_item</span></span></span><br><span><var>Hproj</var><span class="hyp-type"><b>: </b><span>VLSM_embedding
  (preloaded_vlsm
     (composite_vlsm IM1 (free_constraint IM1))
     (<span class="kr">Œª</span> <span class="nv">_</span> : message, <span class="kt">True</span>))
  (preloaded_vlsm
     (composite_vlsm IM2 (free_constraint IM2))
     (<span class="kr">Œª</span> <span class="nv">_</span> : message, <span class="kt">True</span>)) same_IM_label_rew
  same_IM_state_rew</span></span></span><br><span><var>Htr1</var><span class="hyp-type"><b>: </b><span>finite_valid_trace
  (preloaded_vlsm
     (composite_vlsm IM2 (free_constraint IM2))
     (<span class="kr">Œª</span> <span class="nv">_</span> : message, <span class="kt">True</span>))
  (same_IM_state_rew s1)
  (VLSM_embedding_finite_trace_project Hproj
     tr1)</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">VLSM_incl_part
  (preloaded_vlsm_machine
     (composite_vlsm IM2 (free_constraint IM2))
     (<span class="kr">Œª</span> <span class="nv">_</span> : message, <span class="kt">True</span>))
  (preloaded_vlsm_machine (free_composite_vlsm IM2)
     (<span class="kr">Œª</span> <span class="nv">_</span> : message, <span class="kt">True</span>))</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><span class="alectryon-input"><span class="bp">by</span> <span class="nb">apply</span> preloaded_free_composite_vlsm_spec.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Qed</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
</span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">End</span> <span class="nf">sec_same_IM_embedding</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
</span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Arguments</span> same_IM_label_rew {_ _ _ _} _ _ : <span class="nb">assert</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Arguments</span> same_IM_state_rew {_ _ _ _} _ _ _ : <span class="nb">assert</span>.</span></span></pre><div class="doc">
<a id="lab13"></a><h2 class="section">Valid transitions in a composition</h2>
</div><pre class="alectryon-io highlight"><!-- Generator: Alectryon --><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Section</span> <span class="nf">sec_composite_valid_transition</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
</span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Context</span>
  {<span class="nv">message</span> : <span class="kt">Type</span>}
  `{EqDecision index}
  (IM : index -&gt; VLSM message)
  (Free := free_composite_vlsm IM)
  .</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
</span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Definition</span> <span class="nf">composite_valid_transition</span> <span class="nv">l</span> <span class="nv">s1</span> <span class="nv">iom</span> <span class="nv">s2</span> <span class="nv">oom</span> : <span class="kt">Prop</span> :=
  valid_transition Free l s1 iom s2 oom.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
</span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Definition</span> <span class="nf">composite_valid_transition_item</span>
  (<span class="nv">s</span> : composite_state IM) (<span class="nv">item</span> : composite_transition_item IM) : <span class="kt">Prop</span> :=
  composite_valid_transition (l item) s (input item) (destination item) (output item).</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
</span><span class="alectryon-sentence"><input class="alectryon-toggle" id="Composition-v-chk1f2" style="display: none" type="checkbox"><label class="alectryon-input" for="Composition-v-chk1f2"><span class="kn">Lemma</span> <span class="nf">composite_valid_transition_reachable_iff</span> <span class="nv">l</span> <span class="nv">s1</span> <span class="nv">iom</span> <span class="nv">s2</span> <span class="nv">oom</span> :
  composite_valid_transition l s1 iom s2 oom
    &lt;-&gt;
  valid_transition (preloaded_with_all_messages_vlsm Free) l s1 iom s2 oom.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>message, index</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>EqDecision0</var><span class="hyp-type"><b>: </b><span>EqDecision index</span></span></span><br><span><var>IM</var><span class="hyp-type"><b>: </b><span>index ‚Üí VLSM message</span></span></span><br><span><var>Free</var><span><span class="hyp-body"><b>:= </b><span>free_composite_vlsm IM</span></span><span class="hyp-type"><b>: </b><span>VLSM message</span></span></span></span><br><span><var>l</var><span class="hyp-type"><b>: </b><span>label Free</span></span></span><br><span><var>s1</var><span class="hyp-type"><b>: </b><span>state Free</span></span></span><br><span><var>iom</var><span class="hyp-type"><b>: </b><span>option message</span></span></span><br><span><var>s2</var><span class="hyp-type"><b>: </b><span>state Free</span></span></span><br><span><var>oom</var><span class="hyp-type"><b>: </b><span>option message</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">composite_valid_transition l s1 iom s2 oom
‚Üî valid_transition
    (preloaded_with_all_messages_vlsm Free) l s1 iom
    s2 oom</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="Composition-v-chk1f3" style="display: none" type="checkbox"><label class="alectryon-input" for="Composition-v-chk1f3"><span class="kn">Proof</span>.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>message, index</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>EqDecision0</var><span class="hyp-type"><b>: </b><span>EqDecision index</span></span></span><br><span><var>IM</var><span class="hyp-type"><b>: </b><span>index ‚Üí VLSM message</span></span></span><br><span><var>Free</var><span><span class="hyp-body"><b>:= </b><span>free_composite_vlsm IM</span></span><span class="hyp-type"><b>: </b><span>VLSM message</span></span></span></span><br><span><var>l</var><span class="hyp-type"><b>: </b><span>label Free</span></span></span><br><span><var>s1</var><span class="hyp-type"><b>: </b><span>state Free</span></span></span><br><span><var>iom</var><span class="hyp-type"><b>: </b><span>option message</span></span></span><br><span><var>s2</var><span class="hyp-type"><b>: </b><span>state Free</span></span></span><br><span><var>oom</var><span class="hyp-type"><b>: </b><span>option message</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">composite_valid_transition l s1 iom s2 oom
‚Üî valid_transition
    (preloaded_with_all_messages_vlsm Free) l s1 iom
    s2 oom</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><span class="alectryon-input"><span class="bp">by</span> <span class="nb">split</span>; <span class="nb">intros</span> []; <span class="nb">constructor</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Qed</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
</span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Definition</span> <span class="nf">composite_valid_transition_next</span> <span class="nv">s1</span> <span class="nv">s2</span> : <span class="kt">Prop</span> :=
  valid_transition_next Free s1 s2.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
</span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Definition</span> <span class="nf">composite_valid_transition_future</span> : relation (composite_state IM) :=
  tc composite_valid_transition_next.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
</span><span class="alectryon-sentence"><input class="alectryon-toggle" id="Composition-v-chk1f4" style="display: none" type="checkbox"><label class="alectryon-input" for="Composition-v-chk1f4"><span class="kn">Lemma</span> <span class="nf">composite_valid_transition_next_reachable_iff</span> <span class="nv">s1</span> <span class="nv">s2</span> :
  composite_valid_transition_next s1 s2
    &lt;-&gt;
  valid_transition_next (preloaded_with_all_messages_vlsm Free) s1 s2.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>message, index</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>EqDecision0</var><span class="hyp-type"><b>: </b><span>EqDecision index</span></span></span><br><span><var>IM</var><span class="hyp-type"><b>: </b><span>index ‚Üí VLSM message</span></span></span><br><span><var>Free</var><span><span class="hyp-body"><b>:= </b><span>free_composite_vlsm IM</span></span><span class="hyp-type"><b>: </b><span>VLSM message</span></span></span></span><br><span><var>s1, s2</var><span class="hyp-type"><b>: </b><span>state Free</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">composite_valid_transition_next s1 s2
‚Üî valid_transition_next
    (preloaded_with_all_messages_vlsm Free) s1 s2</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="Composition-v-chk1f5" style="display: none" type="checkbox"><label class="alectryon-input" for="Composition-v-chk1f5"><span class="kn">Proof</span>.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>message, index</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>EqDecision0</var><span class="hyp-type"><b>: </b><span>EqDecision index</span></span></span><br><span><var>IM</var><span class="hyp-type"><b>: </b><span>index ‚Üí VLSM message</span></span></span><br><span><var>Free</var><span><span class="hyp-body"><b>:= </b><span>free_composite_vlsm IM</span></span><span class="hyp-type"><b>: </b><span>VLSM message</span></span></span></span><br><span><var>s1, s2</var><span class="hyp-type"><b>: </b><span>state Free</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">composite_valid_transition_next s1 s2
‚Üî valid_transition_next
    (preloaded_with_all_messages_vlsm Free) s1 s2</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><span class="alectryon-input"><span class="bp">by</span> <span class="nb">split</span>; <span class="nb">intros</span> []; <span class="nb">econstructor</span>; <span class="nb">apply</span> composite_valid_transition_reachable_iff.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Qed</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
</span><span class="alectryon-sentence"><input class="alectryon-toggle" id="Composition-v-chk1f6" style="display: none" type="checkbox"><label class="alectryon-input" for="Composition-v-chk1f6"><span class="kn">Lemma</span> <span class="nf">composite_valid_transition_projection</span> :
  <span class="kr">forall</span> <span class="nv">l</span> <span class="nv">s1</span> <span class="nv">iom</span> <span class="nv">s2</span> <span class="nv">oom</span>,
    composite_valid_transition l s1 iom s2 oom -&gt;
    valid_transition (IM (projT1 l)) (projT2 l) (s1 (projT1 l)) iom (s2 (projT1 l)) oom /\
    s2 = state_update IM s1 (projT1 l) (s2 (projT1 l)).</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>message, index</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>EqDecision0</var><span class="hyp-type"><b>: </b><span>EqDecision index</span></span></span><br><span><var>IM</var><span class="hyp-type"><b>: </b><span>index ‚Üí VLSM message</span></span></span><br><span><var>Free</var><span><span class="hyp-body"><b>:= </b><span>free_composite_vlsm IM</span></span><span class="hyp-type"><b>: </b><span>VLSM message</span></span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="kr">‚àÄ</span> (<span class="nv">l</span> : label Free) (<span class="nv">s1</span> : state Free) (<span class="nv">iom</span> : option
                                              message) 
  (<span class="nv">s2</span> : state Free) (<span class="nv">oom</span> : option message),
  composite_valid_transition l s1 iom s2 oom
  ‚Üí valid_transition (IM (projT1 l)) (projT2 l)
      (s1 (projT1 l)) iom (s2 (projT1 l)) oom
    ‚àß s2 =
      state_update IM s1 (projT1 l) (s2 (projT1 l))</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="Composition-v-chk1f7" style="display: none" type="checkbox"><label class="alectryon-input" for="Composition-v-chk1f7"><span class="kn">Proof</span>.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>message, index</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>EqDecision0</var><span class="hyp-type"><b>: </b><span>EqDecision index</span></span></span><br><span><var>IM</var><span class="hyp-type"><b>: </b><span>index ‚Üí VLSM message</span></span></span><br><span><var>Free</var><span><span class="hyp-body"><b>:= </b><span>free_composite_vlsm IM</span></span><span class="hyp-type"><b>: </b><span>VLSM message</span></span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="kr">‚àÄ</span> (<span class="nv">l</span> : label Free) (<span class="nv">s1</span> : state Free) (<span class="nv">iom</span> : option
                                              message) 
  (<span class="nv">s2</span> : state Free) (<span class="nv">oom</span> : option message),
  composite_valid_transition l s1 iom s2 oom
  ‚Üí valid_transition (IM (projT1 l)) (projT2 l)
      (s1 (projT1 l)) iom (s2 (projT1 l)) oom
    ‚àß s2 =
      state_update IM s1 (projT1 l) (s2 (projT1 l))</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="Composition-v-chk1f8" style="display: none" type="checkbox"><label class="alectryon-input" for="Composition-v-chk1f8"><span class="nb">intros</span> [i li] * [Hv Ht]; <span class="nb">cbn</span> <span class="kr">in</span> Ht; <span class="nb">destruct</span> (transition _ _ _) <span class="nb">eqn</span>: Hti.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>message, index</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>EqDecision0</var><span class="hyp-type"><b>: </b><span>EqDecision index</span></span></span><br><span><var>IM</var><span class="hyp-type"><b>: </b><span>index ‚Üí VLSM message</span></span></span><br><span><var>Free</var><span><span class="hyp-body"><b>:= </b><span>free_composite_vlsm IM</span></span><span class="hyp-type"><b>: </b><span>VLSM message</span></span></span></span><br><span><var>i</var><span class="hyp-type"><b>: </b><span>index</span></span></span><br><span><var>li</var><span class="hyp-type"><b>: </b><span>label (IM i)</span></span></span><br><span><var>s1</var><span class="hyp-type"><b>: </b><span>state Free</span></span></span><br><span><var>iom</var><span class="hyp-type"><b>: </b><span>option message</span></span></span><br><span><var>s2</var><span class="hyp-type"><b>: </b><span>state Free</span></span></span><br><span><var>oom</var><span class="hyp-type"><b>: </b><span>option message</span></span></span><br><span><var>Hv</var><span class="hyp-type"><b>: </b><span>valid (existT i li) (s1, iom)</span></span></span><br><span><var>s</var><span class="hyp-type"><b>: </b><span>state (IM i)</span></span></span><br><span><var>o</var><span class="hyp-type"><b>: </b><span>option message</span></span></span><br><span><var>Hti</var><span class="hyp-type"><b>: </b><span>transition li (s1 i, iom) = (s, o)</span></span></span><br><span><var>Ht</var><span class="hyp-type"><b>: </b><span>(state_update IM s1 i s, o) = (s2, oom)</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">valid_transition (IM (projT1 (existT i li)))
  (projT2 (existT i li)) (s1 (projT1 (existT i li)))
  iom (s2 (projT1 (existT i li))) oom
‚àß s2 =
  state_update IM s1 (projT1 (existT i li))
    (s2 (projT1 (existT i li)))</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><span class="alectryon-input"><span class="bp">by</span> <span class="nb">inversion</span> Ht; <span class="nb">subst</span>; <span class="nb">cbn</span>; state_update_simpl.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Qed</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
</span><span class="alectryon-sentence"><input class="alectryon-toggle" id="Composition-v-chk1f9" style="display: none" type="checkbox"><label class="alectryon-input" for="Composition-v-chk1f9"><span class="kn">Lemma</span> <span class="nf">composite_valid_transition_projection_inv</span> :
  <span class="kr">forall</span> <span class="nv">i</span> <span class="nv">li</span> <span class="nv">si1</span> <span class="nv">iom</span> <span class="nv">si2</span> <span class="nv">oom</span>,
    valid_transition (IM i) li si1 iom si2 oom -&gt;
    <span class="kr">forall</span> <span class="nv">s1</span>, s1 i = si1 -&gt; <span class="kr">forall</span> <span class="nv">s2</span>, s2 = state_update IM s1 i si2 -&gt;
    composite_valid_transition (existT i li) s1 iom s2 oom.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>message, index</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>EqDecision0</var><span class="hyp-type"><b>: </b><span>EqDecision index</span></span></span><br><span><var>IM</var><span class="hyp-type"><b>: </b><span>index ‚Üí VLSM message</span></span></span><br><span><var>Free</var><span><span class="hyp-body"><b>:= </b><span>free_composite_vlsm IM</span></span><span class="hyp-type"><b>: </b><span>VLSM message</span></span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="kr">‚àÄ</span> (<span class="nv">i</span> : index) (<span class="nv">li</span> : label (IM i)) (<span class="nv">si1</span> : state (IM i)) 
  (<span class="nv">iom</span> : option message) (<span class="nv">si2</span> : state (IM i)) (<span class="nv">oom</span> : 
                                               option
                                                 message),
  valid_transition (IM i) li si1 iom si2 oom
  ‚Üí <span class="kr">‚àÄ</span> <span class="nv">s1</span> : <span class="kr">‚àÄ</span> <span class="nv">x</span> : index, state (IM x),
      s1 i = si1
      ‚Üí <span class="kr">‚àÄ</span> <span class="nv">s2</span> : <span class="kr">‚àÄ</span> <span class="nv">j</span> : index, state (IM j),
          s2 = state_update IM s1 i si2
          ‚Üí composite_valid_transition (existT i li)
              s1 iom s2 oom</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="Composition-v-chk1fa" style="display: none" type="checkbox"><label class="alectryon-input" for="Composition-v-chk1fa"><span class="kn">Proof</span>.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>message, index</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>EqDecision0</var><span class="hyp-type"><b>: </b><span>EqDecision index</span></span></span><br><span><var>IM</var><span class="hyp-type"><b>: </b><span>index ‚Üí VLSM message</span></span></span><br><span><var>Free</var><span><span class="hyp-body"><b>:= </b><span>free_composite_vlsm IM</span></span><span class="hyp-type"><b>: </b><span>VLSM message</span></span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="kr">‚àÄ</span> (<span class="nv">i</span> : index) (<span class="nv">li</span> : label (IM i)) (<span class="nv">si1</span> : state (IM i)) 
  (<span class="nv">iom</span> : option message) (<span class="nv">si2</span> : state (IM i)) (<span class="nv">oom</span> : 
                                               option
                                                 message),
  valid_transition (IM i) li si1 iom si2 oom
  ‚Üí <span class="kr">‚àÄ</span> <span class="nv">s1</span> : <span class="kr">‚àÄ</span> <span class="nv">x</span> : index, state (IM x),
      s1 i = si1
      ‚Üí <span class="kr">‚àÄ</span> <span class="nv">s2</span> : <span class="kr">‚àÄ</span> <span class="nv">j</span> : index, state (IM j),
          s2 = state_update IM s1 i si2
          ‚Üí composite_valid_transition (existT i li)
              s1 iom s2 oom</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="Composition-v-chk1fb" style="display: none" type="checkbox"><label class="alectryon-input" for="Composition-v-chk1fb"><span class="nb">intros</span> * [Hv Ht] s1 &lt;- s2 -&gt;; <span class="nb">split</span>; [<span class="bp">done</span> |].</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>message, index</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>EqDecision0</var><span class="hyp-type"><b>: </b><span>EqDecision index</span></span></span><br><span><var>IM</var><span class="hyp-type"><b>: </b><span>index ‚Üí VLSM message</span></span></span><br><span><var>Free</var><span><span class="hyp-body"><b>:= </b><span>free_composite_vlsm IM</span></span><span class="hyp-type"><b>: </b><span>VLSM message</span></span></span></span><br><span><var>i</var><span class="hyp-type"><b>: </b><span>index</span></span></span><br><span><var>li</var><span class="hyp-type"><b>: </b><span>label (IM i)</span></span></span><br><span><var>iom</var><span class="hyp-type"><b>: </b><span>option message</span></span></span><br><span><var>si2</var><span class="hyp-type"><b>: </b><span>state (IM i)</span></span></span><br><span><var>oom</var><span class="hyp-type"><b>: </b><span>option message</span></span></span><br><span><var>s1</var><span class="hyp-type"><b>: </b><span><span class="kr">‚àÄ</span> <span class="nv">x</span> : index, state (IM x)</span></span></span><br><span><var>Ht</var><span class="hyp-type"><b>: </b><span>transition li (s1 i, iom) = (si2, oom)</span></span></span><br><span><var>Hv</var><span class="hyp-type"><b>: </b><span>valid li (s1 i, iom)</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">transition (existT i li) (s1, iom) =
(state_update IM s1 i si2, oom)</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><span class="alectryon-input"><span class="bp">by</span> <span class="nb">cbn</span>; <span class="nb">replace</span> (transition _ _ _) <span class="kr">with</span> (si2, oom).</span><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Qed</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
</span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Inductive</span> <span class="nf">composite_valid_transitions_from_to</span>
  : composite_state IM -&gt; composite_state IM -&gt; list (composite_transition_item IM) -&gt; <span class="kt">Prop</span> :=
| cvtft_empty : <span class="kr">forall</span> <span class="nv">s</span>, composite_valid_transitions_from_to s s []
| cvtft_cons : <span class="kr">forall</span> <span class="nv">s</span> <span class="nv">s&#39;</span> <span class="nv">tr</span> <span class="nv">item</span>,
    composite_valid_transitions_from_to s s&#39; tr -&gt;
    composite_valid_transition_item s&#39; item -&gt;
    composite_valid_transitions_from_to s (destination item) (tr ++ [item]).</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
</span><span class="alectryon-sentence"><input class="alectryon-toggle" id="Composition-v-chk1fc" style="display: none" type="checkbox"><label class="alectryon-input" for="Composition-v-chk1fc"><span class="kn">Lemma</span> <span class="nf">composite_valid_transitions_from_to_trace</span> : <span class="kr">forall</span> <span class="nv">s</span> <span class="nv">s&#39;</span> <span class="nv">tr</span>,
  finite_constrained_trace_from_to Free s s&#39; tr -&gt;
  composite_valid_transitions_from_to s s&#39; tr.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>message, index</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>EqDecision0</var><span class="hyp-type"><b>: </b><span>EqDecision index</span></span></span><br><span><var>IM</var><span class="hyp-type"><b>: </b><span>index ‚Üí VLSM message</span></span></span><br><span><var>Free</var><span><span class="hyp-body"><b>:= </b><span>free_composite_vlsm IM</span></span><span class="hyp-type"><b>: </b><span>VLSM message</span></span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="kr">‚àÄ</span> (<span class="nv">s</span>
   <span class="nv">s&#39;</span> : state (preloaded_with_all_messages_vlsm Free)) 
  (<span class="nv">tr</span> : list transition_item),
  finite_constrained_trace_from_to Free s s&#39; tr
  ‚Üí composite_valid_transitions_from_to s s&#39; tr</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="Composition-v-chk1fd" style="display: none" type="checkbox"><label class="alectryon-input" for="Composition-v-chk1fd"><span class="kn">Proof</span>.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>message, index</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>EqDecision0</var><span class="hyp-type"><b>: </b><span>EqDecision index</span></span></span><br><span><var>IM</var><span class="hyp-type"><b>: </b><span>index ‚Üí VLSM message</span></span></span><br><span><var>Free</var><span><span class="hyp-body"><b>:= </b><span>free_composite_vlsm IM</span></span><span class="hyp-type"><b>: </b><span>VLSM message</span></span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="kr">‚àÄ</span> (<span class="nv">s</span>
   <span class="nv">s&#39;</span> : state (preloaded_with_all_messages_vlsm Free)) 
  (<span class="nv">tr</span> : list transition_item),
  finite_constrained_trace_from_to Free s s&#39; tr
  ‚Üí composite_valid_transitions_from_to s s&#39; tr</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="Composition-v-chk1fe" style="display: none" type="checkbox"><label class="alectryon-input" for="Composition-v-chk1fe"><span class="nb">induction</span> <span class="mi">1</span> <span class="nb">using</span> finite_valid_trace_from_to_rev_ind; [<span class="bp">by</span> <span class="nb">constructor</span> |].</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>message, index</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>EqDecision0</var><span class="hyp-type"><b>: </b><span>EqDecision index</span></span></span><br><span><var>IM</var><span class="hyp-type"><b>: </b><span>index ‚Üí VLSM message</span></span></span><br><span><var>Free</var><span><span class="hyp-body"><b>:= </b><span>free_composite_vlsm IM</span></span><span class="hyp-type"><b>: </b><span>VLSM message</span></span></span></span><br><span><var>si, s</var><span class="hyp-type"><b>: </b><span>state (preloaded_with_all_messages_vlsm Free)</span></span></span><br><span><var>tr</var><span class="hyp-type"><b>: </b><span>list transition_item</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>finite_valid_trace_from_to
  (preloaded_with_all_messages_vlsm Free) si s tr</span></span></span><br><span><var>sf</var><span class="hyp-type"><b>: </b><span>state (preloaded_with_all_messages_vlsm Free)</span></span></span><br><span><var>iom, oom</var><span class="hyp-type"><b>: </b><span>option message</span></span></span><br><span><var>l</var><span class="hyp-type"><b>: </b><span>label (preloaded_with_all_messages_vlsm Free)</span></span></span><br><span><var>Ht</var><span class="hyp-type"><b>: </b><span>input_valid_transition
  (preloaded_with_all_messages_vlsm Free) l
  (s, iom) (sf, oom)</span></span></span><br><span><var>IHfinite_valid_trace_from_to</var><span class="hyp-type"><b>: </b><span>composite_valid_transitions_from_to
  si s tr</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">composite_valid_transitions_from_to si sf
  (tr ++
   [{|
      l := l;
      input := iom;
      destination := sf;
      output := oom
    |}])</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="Composition-v-chk1ff" style="display: none" type="checkbox"><label class="alectryon-input" for="Composition-v-chk1ff"><span class="nb">remember</span> {| destination := sf |} <span class="kr">as</span> item.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>message, index</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>EqDecision0</var><span class="hyp-type"><b>: </b><span>EqDecision index</span></span></span><br><span><var>IM</var><span class="hyp-type"><b>: </b><span>index ‚Üí VLSM message</span></span></span><br><span><var>Free</var><span><span class="hyp-body"><b>:= </b><span>free_composite_vlsm IM</span></span><span class="hyp-type"><b>: </b><span>VLSM message</span></span></span></span><br><span><var>si, s</var><span class="hyp-type"><b>: </b><span>state (preloaded_with_all_messages_vlsm Free)</span></span></span><br><span><var>tr</var><span class="hyp-type"><b>: </b><span>list transition_item</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>finite_valid_trace_from_to
  (preloaded_with_all_messages_vlsm Free) si s tr</span></span></span><br><span><var>sf</var><span class="hyp-type"><b>: </b><span>state (preloaded_with_all_messages_vlsm Free)</span></span></span><br><span><var>iom, oom</var><span class="hyp-type"><b>: </b><span>option message</span></span></span><br><span><var>l</var><span class="hyp-type"><b>: </b><span>label (preloaded_with_all_messages_vlsm Free)</span></span></span><br><span><var>Ht</var><span class="hyp-type"><b>: </b><span>input_valid_transition
  (preloaded_with_all_messages_vlsm Free) l
  (s, iom) (sf, oom)</span></span></span><br><span><var>IHfinite_valid_trace_from_to</var><span class="hyp-type"><b>: </b><span>composite_valid_transitions_from_to
  si s tr</span></span></span><br><span><var>item</var><span class="hyp-type"><b>: </b><span>transition_item</span></span></span><br><span><var>Heqitem</var><span class="hyp-type"><b>: </b><span>item =
{|
  l := l;
  input := iom;
  destination := sf;
  output := oom
|}</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">composite_valid_transitions_from_to si sf
  (tr ++ [item])</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="Composition-v-chk200" style="display: none" type="checkbox"><label class="alectryon-input" for="Composition-v-chk200"><span class="nb">replace</span> sf <span class="kr">with</span> (destination item) <span class="bp">by</span> (<span class="nb">subst</span>; <span class="bp">done</span>).</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>message, index</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>EqDecision0</var><span class="hyp-type"><b>: </b><span>EqDecision index</span></span></span><br><span><var>IM</var><span class="hyp-type"><b>: </b><span>index ‚Üí VLSM message</span></span></span><br><span><var>Free</var><span><span class="hyp-body"><b>:= </b><span>free_composite_vlsm IM</span></span><span class="hyp-type"><b>: </b><span>VLSM message</span></span></span></span><br><span><var>si, s</var><span class="hyp-type"><b>: </b><span>state (preloaded_with_all_messages_vlsm Free)</span></span></span><br><span><var>tr</var><span class="hyp-type"><b>: </b><span>list transition_item</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>finite_valid_trace_from_to
  (preloaded_with_all_messages_vlsm Free) si s tr</span></span></span><br><span><var>sf</var><span class="hyp-type"><b>: </b><span>state (preloaded_with_all_messages_vlsm Free)</span></span></span><br><span><var>iom, oom</var><span class="hyp-type"><b>: </b><span>option message</span></span></span><br><span><var>l</var><span class="hyp-type"><b>: </b><span>label (preloaded_with_all_messages_vlsm Free)</span></span></span><br><span><var>Ht</var><span class="hyp-type"><b>: </b><span>input_valid_transition
  (preloaded_with_all_messages_vlsm Free) l
  (s, iom) (sf, oom)</span></span></span><br><span><var>IHfinite_valid_trace_from_to</var><span class="hyp-type"><b>: </b><span>composite_valid_transitions_from_to
  si s tr</span></span></span><br><span><var>item</var><span class="hyp-type"><b>: </b><span>transition_item</span></span></span><br><span><var>Heqitem</var><span class="hyp-type"><b>: </b><span>item =
{|
  l := l;
  input := iom;
  destination := sf;
  output := oom
|}</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">composite_valid_transitions_from_to si
  (destination item) (tr ++ [item])</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="Composition-v-chk201" style="display: none" type="checkbox"><label class="alectryon-input" for="Composition-v-chk201"><span class="nb">econstructor</span>; [<span class="bp">done</span> |]; <span class="nb">subst</span>.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>message, index</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>EqDecision0</var><span class="hyp-type"><b>: </b><span>EqDecision index</span></span></span><br><span><var>IM</var><span class="hyp-type"><b>: </b><span>index ‚Üí VLSM message</span></span></span><br><span><var>Free</var><span><span class="hyp-body"><b>:= </b><span>free_composite_vlsm IM</span></span><span class="hyp-type"><b>: </b><span>VLSM message</span></span></span></span><br><span><var>si, s</var><span class="hyp-type"><b>: </b><span>state (preloaded_with_all_messages_vlsm Free)</span></span></span><br><span><var>tr</var><span class="hyp-type"><b>: </b><span>list transition_item</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>finite_valid_trace_from_to
  (preloaded_with_all_messages_vlsm Free) si s tr</span></span></span><br><span><var>sf</var><span class="hyp-type"><b>: </b><span>state (preloaded_with_all_messages_vlsm Free)</span></span></span><br><span><var>iom, oom</var><span class="hyp-type"><b>: </b><span>option message</span></span></span><br><span><var>l</var><span class="hyp-type"><b>: </b><span>label (preloaded_with_all_messages_vlsm Free)</span></span></span><br><span><var>Ht</var><span class="hyp-type"><b>: </b><span>input_valid_transition
  (preloaded_with_all_messages_vlsm Free) l
  (s, iom) (sf, oom)</span></span></span><br><span><var>IHfinite_valid_trace_from_to</var><span class="hyp-type"><b>: </b><span>composite_valid_transitions_from_to
  si s tr</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">composite_valid_transition_item s
  {|
    l := l;
    input := iom;
    destination := sf;
    output := oom
  |}</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><span class="alectryon-input"><span class="bp">by</span> <span class="nb">apply</span> composite_valid_transition_reachable_iff, input_valid_transition_forget_input.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Qed</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
</span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">End</span> <span class="nf">sec_composite_valid_transition</span>.</span></span></pre><div class="doc">
<a id="lab14"></a><h2 class="section">Valid composite states properties</h2>
</div><pre class="alectryon-io highlight"><!-- Generator: Alectryon --><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Section</span> <span class="nf">sec_composite_state</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
</span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Context</span>
  `{EqDecision index}
  `[IM : index -&gt; VLSM message]
  [constraint : composite_label IM -&gt; composite_state IM * option message -&gt; <span class="kt">Prop</span>]
  (X := composite_vlsm IM constraint)
  .</span></span></pre><div class="doc">
  Given a valid state for the free composition and a constrained trace in one
  of the components receiving only valid messages of the free composition,
  the trace can be replayed on top of the given state to yield a valid trace
  segment for the free composition.

</div><pre class="alectryon-io highlight"><!-- Generator: Alectryon --><span class="alectryon-sentence"><input class="alectryon-toggle" id="Composition-v-chk202" style="display: none" type="checkbox"><label class="alectryon-input" for="Composition-v-chk202"><span class="kn">Lemma</span> <span class="nf">pre_free_lift_to_free_weak_embedding</span> :
  <span class="kr">forall</span> (<span class="nv">i</span> : index) (<span class="nv">cs</span> : composite_state IM),
    valid_state_prop (free_composite_vlsm IM) cs -&gt;
    VLSM_weak_embedding
      (preloaded_vlsm (IM i) (valid_message_prop (free_composite_vlsm IM)))
      (free_composite_vlsm IM) (lift_to_composite_label IM i) (lift_to_composite_state IM cs i).</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>index</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>EqDecision0</var><span class="hyp-type"><b>: </b><span>EqDecision index</span></span></span><br><span><var>message</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>IM</var><span class="hyp-type"><b>: </b><span>index ‚Üí VLSM message</span></span></span><br><span><var>constraint</var><span class="hyp-type"><b>: </b><span>composite_label IM
‚Üí composite_state IM * option message
  ‚Üí <span class="kt">Prop</span></span></span></span><br><span><var>X</var><span><span class="hyp-body"><b>:= </b><span>composite_vlsm IM constraint</span></span><span class="hyp-type"><b>: </b><span>VLSM message</span></span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="kr">‚àÄ</span> (<span class="nv">i</span> : index) (<span class="nv">cs</span> : composite_state IM),
  valid_state_prop (free_composite_vlsm IM) cs
  ‚Üí VLSM_weak_embedding
      (preloaded_vlsm (IM i)
         (valid_message_prop (free_composite_vlsm IM)))
      (free_composite_vlsm IM)
      (lift_to_composite_label IM i)
      (lift_to_composite_state IM cs i)</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="Composition-v-chk203" style="display: none" type="checkbox"><label class="alectryon-input" for="Composition-v-chk203"><span class="kn">Proof</span>.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>index</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>EqDecision0</var><span class="hyp-type"><b>: </b><span>EqDecision index</span></span></span><br><span><var>message</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>IM</var><span class="hyp-type"><b>: </b><span>index ‚Üí VLSM message</span></span></span><br><span><var>constraint</var><span class="hyp-type"><b>: </b><span>composite_label IM
‚Üí composite_state IM * option message
  ‚Üí <span class="kt">Prop</span></span></span></span><br><span><var>X</var><span><span class="hyp-body"><b>:= </b><span>composite_vlsm IM constraint</span></span><span class="hyp-type"><b>: </b><span>VLSM message</span></span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="kr">‚àÄ</span> (<span class="nv">i</span> : index) (<span class="nv">cs</span> : composite_state IM),
  valid_state_prop (free_composite_vlsm IM) cs
  ‚Üí VLSM_weak_embedding
      (preloaded_vlsm (IM i)
         (valid_message_prop (free_composite_vlsm IM)))
      (free_composite_vlsm IM)
      (lift_to_composite_label IM i)
      (lift_to_composite_state IM cs i)</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="Composition-v-chk204" style="display: none" type="checkbox"><label class="alectryon-input" for="Composition-v-chk204"><span class="nb">intros</span> i cs Hvsp; <span class="nb">constructor</span>; <span class="nb">intros</span> s tr Htr.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>index</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>EqDecision0</var><span class="hyp-type"><b>: </b><span>EqDecision index</span></span></span><br><span><var>message</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>IM</var><span class="hyp-type"><b>: </b><span>index ‚Üí VLSM message</span></span></span><br><span><var>constraint</var><span class="hyp-type"><b>: </b><span>composite_label IM
‚Üí composite_state IM * option message
  ‚Üí <span class="kt">Prop</span></span></span></span><br><span><var>X</var><span><span class="hyp-body"><b>:= </b><span>composite_vlsm IM constraint</span></span><span class="hyp-type"><b>: </b><span>VLSM message</span></span></span></span><br><span><var>i</var><span class="hyp-type"><b>: </b><span>index</span></span></span><br><span><var>cs</var><span class="hyp-type"><b>: </b><span>composite_state IM</span></span></span><br><span><var>Hvsp</var><span class="hyp-type"><b>: </b><span>valid_state_prop (free_composite_vlsm IM) cs</span></span></span><br><span><var>s</var><span class="hyp-type"><b>: </b><span>state
  (preloaded_vlsm (IM i)
     (valid_message_prop (free_composite_vlsm IM)))</span></span></span><br><span><var>tr</var><span class="hyp-type"><b>: </b><span>list transition_item</span></span></span><br><span><var>Htr</var><span class="hyp-type"><b>: </b><span>finite_valid_trace_from
  (preloaded_vlsm (IM i)
     (valid_message_prop
        (free_composite_vlsm IM))) s tr</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">finite_valid_trace_from (free_composite_vlsm IM)
  (lift_to_composite_state IM cs i s)
  (pre_VLSM_embedding_finite_trace_project
     (preloaded_vlsm (IM i)
        (valid_message_prop (free_composite_vlsm IM)))
     (free_composite_vlsm IM)
     (lift_to_composite_label IM i)
     (lift_to_composite_state IM cs i) tr)</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="Composition-v-chk205" style="display: none" type="checkbox"><label class="alectryon-input" for="Composition-v-chk205"><span class="nb">pose proof</span> (Heq := vlsm_is_preloaded_with_valid (free_composite_vlsm IM)).</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>index</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>EqDecision0</var><span class="hyp-type"><b>: </b><span>EqDecision index</span></span></span><br><span><var>message</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>IM</var><span class="hyp-type"><b>: </b><span>index ‚Üí VLSM message</span></span></span><br><span><var>constraint</var><span class="hyp-type"><b>: </b><span>composite_label IM
‚Üí composite_state IM * option message
  ‚Üí <span class="kt">Prop</span></span></span></span><br><span><var>X</var><span><span class="hyp-body"><b>:= </b><span>composite_vlsm IM constraint</span></span><span class="hyp-type"><b>: </b><span>VLSM message</span></span></span></span><br><span><var>i</var><span class="hyp-type"><b>: </b><span>index</span></span></span><br><span><var>cs</var><span class="hyp-type"><b>: </b><span>composite_state IM</span></span></span><br><span><var>Hvsp</var><span class="hyp-type"><b>: </b><span>valid_state_prop (free_composite_vlsm IM) cs</span></span></span><br><span><var>s</var><span class="hyp-type"><b>: </b><span>state
  (preloaded_vlsm (IM i)
     (valid_message_prop (free_composite_vlsm IM)))</span></span></span><br><span><var>tr</var><span class="hyp-type"><b>: </b><span>list transition_item</span></span></span><br><span><var>Htr</var><span class="hyp-type"><b>: </b><span>finite_valid_trace_from
  (preloaded_vlsm (IM i)
     (valid_message_prop
        (free_composite_vlsm IM))) s tr</span></span></span><br><span><var>Heq</var><span class="hyp-type"><b>: </b><span>VLSM_eq (free_composite_vlsm IM)
  (preloaded_vlsm (free_composite_vlsm IM)
     (valid_message_prop
        (free_composite_vlsm IM)))</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">finite_valid_trace_from (free_composite_vlsm IM)
  (lift_to_composite_state IM cs i s)
  (pre_VLSM_embedding_finite_trace_project
     (preloaded_vlsm (IM i)
        (valid_message_prop (free_composite_vlsm IM)))
     (free_composite_vlsm IM)
     (lift_to_composite_label IM i)
     (lift_to_composite_state IM cs i) tr)</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="Composition-v-chk206" style="display: none" type="checkbox"><label class="alectryon-input" for="Composition-v-chk206"><span class="nb">apply</span> (VLSM_eq_valid_state Heq) <span class="kr">in</span> Hvsp.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>index</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>EqDecision0</var><span class="hyp-type"><b>: </b><span>EqDecision index</span></span></span><br><span><var>message</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>IM</var><span class="hyp-type"><b>: </b><span>index ‚Üí VLSM message</span></span></span><br><span><var>constraint</var><span class="hyp-type"><b>: </b><span>composite_label IM
‚Üí composite_state IM * option message
  ‚Üí <span class="kt">Prop</span></span></span></span><br><span><var>X</var><span><span class="hyp-body"><b>:= </b><span>composite_vlsm IM constraint</span></span><span class="hyp-type"><b>: </b><span>VLSM message</span></span></span></span><br><span><var>i</var><span class="hyp-type"><b>: </b><span>index</span></span></span><br><span><var>cs</var><span class="hyp-type"><b>: </b><span>composite_state IM</span></span></span><br><span><var>Hvsp</var><span class="hyp-type"><b>: </b><span>valid_state_prop
  {|
    vlsm_type := free_composite_vlsm IM;
    vlsm_machine :=
      preloaded_vlsm (free_composite_vlsm IM)
        (valid_message_prop
           (free_composite_vlsm IM))
  |} cs</span></span></span><br><span><var>s</var><span class="hyp-type"><b>: </b><span>state
  (preloaded_vlsm (IM i)
     (valid_message_prop (free_composite_vlsm IM)))</span></span></span><br><span><var>tr</var><span class="hyp-type"><b>: </b><span>list transition_item</span></span></span><br><span><var>Htr</var><span class="hyp-type"><b>: </b><span>finite_valid_trace_from
  (preloaded_vlsm (IM i)
     (valid_message_prop
        (free_composite_vlsm IM))) s tr</span></span></span><br><span><var>Heq</var><span class="hyp-type"><b>: </b><span>VLSM_eq (free_composite_vlsm IM)
  (preloaded_vlsm (free_composite_vlsm IM)
     (valid_message_prop
        (free_composite_vlsm IM)))</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">finite_valid_trace_from (free_composite_vlsm IM)
  (lift_to_composite_state IM cs i s)
  (pre_VLSM_embedding_finite_trace_project
     (preloaded_vlsm (IM i)
        (valid_message_prop (free_composite_vlsm IM)))
     (free_composite_vlsm IM)
     (lift_to_composite_label IM i)
     (lift_to_composite_state IM cs i) tr)</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="Composition-v-chk207" style="display: none" type="checkbox"><label class="alectryon-input" for="Composition-v-chk207"><span class="nb">apply</span> (VLSM_eq_finite_valid_trace_from Heq).</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>index</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>EqDecision0</var><span class="hyp-type"><b>: </b><span>EqDecision index</span></span></span><br><span><var>message</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>IM</var><span class="hyp-type"><b>: </b><span>index ‚Üí VLSM message</span></span></span><br><span><var>constraint</var><span class="hyp-type"><b>: </b><span>composite_label IM
‚Üí composite_state IM * option message
  ‚Üí <span class="kt">Prop</span></span></span></span><br><span><var>X</var><span><span class="hyp-body"><b>:= </b><span>composite_vlsm IM constraint</span></span><span class="hyp-type"><b>: </b><span>VLSM message</span></span></span></span><br><span><var>i</var><span class="hyp-type"><b>: </b><span>index</span></span></span><br><span><var>cs</var><span class="hyp-type"><b>: </b><span>composite_state IM</span></span></span><br><span><var>Hvsp</var><span class="hyp-type"><b>: </b><span>valid_state_prop
  {|
    vlsm_type := free_composite_vlsm IM;
    vlsm_machine :=
      preloaded_vlsm (free_composite_vlsm IM)
        (valid_message_prop
           (free_composite_vlsm IM))
  |} cs</span></span></span><br><span><var>s</var><span class="hyp-type"><b>: </b><span>state
  (preloaded_vlsm (IM i)
     (valid_message_prop (free_composite_vlsm IM)))</span></span></span><br><span><var>tr</var><span class="hyp-type"><b>: </b><span>list transition_item</span></span></span><br><span><var>Htr</var><span class="hyp-type"><b>: </b><span>finite_valid_trace_from
  (preloaded_vlsm (IM i)
     (valid_message_prop
        (free_composite_vlsm IM))) s tr</span></span></span><br><span><var>Heq</var><span class="hyp-type"><b>: </b><span>VLSM_eq (free_composite_vlsm IM)
  (preloaded_vlsm (free_composite_vlsm IM)
     (valid_message_prop
        (free_composite_vlsm IM)))</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">finite_valid_trace_from
  {|
    vlsm_type := free_composite_vlsm IM;
    vlsm_machine :=
      preloaded_vlsm (free_composite_vlsm IM)
        (valid_message_prop (free_composite_vlsm IM))
  |} (lift_to_composite_state IM cs i s)
  (pre_VLSM_embedding_finite_trace_project
     (preloaded_vlsm (IM i)
        (valid_message_prop (free_composite_vlsm IM)))
     (free_composite_vlsm IM)
     (lift_to_composite_label IM i)
     (lift_to_composite_state IM cs i) tr)</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><span class="alectryon-input"><span class="bp">by</span> <span class="nb">unshelve</span> <span class="nb">eapply</span> VLSM_weak_embedding_finite_valid_trace_from <span class="kr">in</span> Htr; <span class="nb">cycle</span> <span class="mi">3</span>;
    [<span class="nb">apply</span> pre_lift_to_free_weak_embedding | ..].</span><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Qed</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
</span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Definition</span> <span class="nf">lift_to_composite_plan</span> [i : index] : plan (IM i) -&gt; composite_plan IM :=
  List.map (lift_to_composite_plan_item IM i).</span></span></pre><div class="doc">
  A component state for the final state of a valid trace of the composition
  is either initial, or there is a witness in the trace when a transition in
  that component led to the current component state.

</div><pre class="alectryon-io highlight"><!-- Generator: Alectryon --><span class="alectryon-sentence"><input class="alectryon-toggle" id="Composition-v-chk208" style="display: none" type="checkbox"><label class="alectryon-input" for="Composition-v-chk208"><span class="kn">Lemma</span> <span class="nf">final_state_component_initial_or_transition</span> :
  <span class="kr">forall</span> (<span class="nv">i</span> : index) (<span class="nv">is</span> <span class="nv">f</span> : composite_state IM) (<span class="nv">tr</span> : list (composite_transition_item IM)),
    finite_valid_trace_init_to X <span class="kr">is</span> f tr -&gt;
    initial_state_prop (IM i) (f i)
      \/
    <span class="kr">exists</span> (<span class="nv">item</span> : composite_transition_item IM),
      item ‚àà tr /\ destination item i = f i /\ projT1 (l item) = i.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>index</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>EqDecision0</var><span class="hyp-type"><b>: </b><span>EqDecision index</span></span></span><br><span><var>message</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>IM</var><span class="hyp-type"><b>: </b><span>index ‚Üí VLSM message</span></span></span><br><span><var>constraint</var><span class="hyp-type"><b>: </b><span>composite_label IM
‚Üí composite_state IM * option message
  ‚Üí <span class="kt">Prop</span></span></span></span><br><span><var>X</var><span><span class="hyp-body"><b>:= </b><span>composite_vlsm IM constraint</span></span><span class="hyp-type"><b>: </b><span>VLSM message</span></span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="kr">‚àÄ</span> (<span class="nv">i</span> : index) (<span class="nv">is</span> <span class="nv">f</span> : composite_state IM) (<span class="nv">tr</span> : list
                                                 (composite_transition_item
                                                 IM)),
  finite_valid_trace_init_to X <span class="kr">is</span> f tr
  ‚Üí initial_state_prop (f i)
    ‚à® (<span class="kr">‚àÉ</span> <span class="nv">item</span> : composite_transition_item IM,
         item ‚àà tr
         ‚àß destination item i = f i
           ‚àß projT1 (l item) = i)</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="Composition-v-chk209" style="display: none" type="checkbox"><label class="alectryon-input" for="Composition-v-chk209"><span class="kn">Proof</span>.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>index</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>EqDecision0</var><span class="hyp-type"><b>: </b><span>EqDecision index</span></span></span><br><span><var>message</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>IM</var><span class="hyp-type"><b>: </b><span>index ‚Üí VLSM message</span></span></span><br><span><var>constraint</var><span class="hyp-type"><b>: </b><span>composite_label IM
‚Üí composite_state IM * option message
  ‚Üí <span class="kt">Prop</span></span></span></span><br><span><var>X</var><span><span class="hyp-body"><b>:= </b><span>composite_vlsm IM constraint</span></span><span class="hyp-type"><b>: </b><span>VLSM message</span></span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="kr">‚àÄ</span> (<span class="nv">i</span> : index) (<span class="nv">is</span> <span class="nv">f</span> : composite_state IM) (<span class="nv">tr</span> : list
                                                 (composite_transition_item
                                                 IM)),
  finite_valid_trace_init_to X <span class="kr">is</span> f tr
  ‚Üí initial_state_prop (f i)
    ‚à® (<span class="kr">‚àÉ</span> <span class="nv">item</span> : composite_transition_item IM,
         item ‚àà tr
         ‚àß destination item i = f i
           ‚àß projT1 (l item) = i)</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="Composition-v-chk20a" style="display: none" type="checkbox"><label class="alectryon-input" for="Composition-v-chk20a"><span class="nb">intros</span> * Htr; <span class="nb">induction</span> Htr <span class="nb">using</span> finite_valid_trace_init_to_rev_ind; [<span class="bp">by</span> <span class="nb">left</span> |].</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>index</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>EqDecision0</var><span class="hyp-type"><b>: </b><span>EqDecision index</span></span></span><br><span><var>message</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>IM</var><span class="hyp-type"><b>: </b><span>index ‚Üí VLSM message</span></span></span><br><span><var>constraint</var><span class="hyp-type"><b>: </b><span>composite_label IM
‚Üí composite_state IM * option message
  ‚Üí <span class="kt">Prop</span></span></span></span><br><span><var>X</var><span><span class="hyp-body"><b>:= </b><span>composite_vlsm IM constraint</span></span><span class="hyp-type"><b>: </b><span>VLSM message</span></span></span></span><br><span><var>i</var><span class="hyp-type"><b>: </b><span>index</span></span></span><br><span><var>si, s</var><span class="hyp-type"><b>: </b><span>state X</span></span></span><br><span><var>tr</var><span class="hyp-type"><b>: </b><span>list transition_item</span></span></span><br><span><var>Htr</var><span class="hyp-type"><b>: </b><span>finite_valid_trace_init_to X si s tr</span></span></span><br><span><var>sf</var><span class="hyp-type"><b>: </b><span>state X</span></span></span><br><span><var>iom, oom</var><span class="hyp-type"><b>: </b><span>option message</span></span></span><br><span><var>l</var><span class="hyp-type"><b>: </b><span>label X</span></span></span><br><span><var>Ht</var><span class="hyp-type"><b>: </b><span>input_valid_transition X l (s, iom) (sf, oom)</span></span></span><br><span><var>IHHtr</var><span class="hyp-type"><b>: </b><span>initial_state_prop (s i)
‚à® (<span class="kr">‚àÉ</span> <span class="nv">item</span> : composite_transition_item IM,
     item ‚àà tr
     ‚àß destination item i = s i
       ‚àß projT1 (VLSM.l item) = i)</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">initial_state_prop (sf i)
‚à® (<span class="kr">‚àÉ</span> <span class="nv">item</span> : composite_transition_item IM,
     item
     ‚àà tr ++
       [{|
          l := l;
          input := iom;
          destination := sf;
          output := oom
        |}]
     ‚àß destination item i = sf i
       ‚àß projT1 (VLSM.l item) = i)</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="Composition-v-chk20b" style="display: none" type="checkbox"><label class="alectryon-input" for="Composition-v-chk20b"><span class="nb">destruct</span> l <span class="kr">as</span> [j lj], (decide (i = j)) <span class="kr">as</span> [&lt;- |]; <span class="nb">cbn</span>.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>index</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>EqDecision0</var><span class="hyp-type"><b>: </b><span>EqDecision index</span></span></span><br><span><var>message</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>IM</var><span class="hyp-type"><b>: </b><span>index ‚Üí VLSM message</span></span></span><br><span><var>constraint</var><span class="hyp-type"><b>: </b><span>composite_label IM
‚Üí composite_state IM * option message
  ‚Üí <span class="kt">Prop</span></span></span></span><br><span><var>X</var><span><span class="hyp-body"><b>:= </b><span>composite_vlsm IM constraint</span></span><span class="hyp-type"><b>: </b><span>VLSM message</span></span></span></span><br><span><var>i</var><span class="hyp-type"><b>: </b><span>index</span></span></span><br><span><var>si, s</var><span class="hyp-type"><b>: </b><span>state X</span></span></span><br><span><var>tr</var><span class="hyp-type"><b>: </b><span>list transition_item</span></span></span><br><span><var>Htr</var><span class="hyp-type"><b>: </b><span>finite_valid_trace_init_to X si s tr</span></span></span><br><span><var>sf</var><span class="hyp-type"><b>: </b><span>state X</span></span></span><br><span><var>iom, oom</var><span class="hyp-type"><b>: </b><span>option message</span></span></span><br><span><var>lj</var><span class="hyp-type"><b>: </b><span>label (IM i)</span></span></span><br><span><var>Ht</var><span class="hyp-type"><b>: </b><span>input_valid_transition X 
  (existT i lj) (s, iom) (
  sf, oom)</span></span></span><br><span><var>IHHtr</var><span class="hyp-type"><b>: </b><span>initial_state_prop (s i)
‚à® (<span class="kr">‚àÉ</span> <span class="nv">item</span> : composite_transition_item IM,
     item ‚àà tr
     ‚àß destination item i = s i
       ‚àß projT1 (l item) = i)</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">initial_state_prop (sf i)
‚à® (<span class="kr">‚àÉ</span> <span class="nv">item</span> : composite_transition_item IM,
     item
     ‚àà tr ++
       [{|
          l := existT i lj;
          input := iom;
          destination := sf;
          output := oom
        |}]
     ‚àß destination item i = sf i ‚àß projT1 (l item) = i)</div></blockquote><div class="alectryon-extra-goals"><input class="alectryon-extra-goal-toggle" id="Composition-v-chk20c" style="display: none" type="checkbox"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>index</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>EqDecision0</var><span class="hyp-type"><b>: </b><span>EqDecision index</span></span></span><br><span><var>message</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>IM</var><span class="hyp-type"><b>: </b><span>index ‚Üí VLSM message</span></span></span><br><span><var>constraint</var><span class="hyp-type"><b>: </b><span>composite_label IM
‚Üí composite_state IM * option message
  ‚Üí <span class="kt">Prop</span></span></span></span><br><span><var>X</var><span><span class="hyp-body"><b>:= </b><span>composite_vlsm IM constraint</span></span><span class="hyp-type"><b>: </b><span>VLSM message</span></span></span></span><br><span><var>i</var><span class="hyp-type"><b>: </b><span>index</span></span></span><br><span><var>si, s</var><span class="hyp-type"><b>: </b><span>state X</span></span></span><br><span><var>tr</var><span class="hyp-type"><b>: </b><span>list transition_item</span></span></span><br><span><var>Htr</var><span class="hyp-type"><b>: </b><span>finite_valid_trace_init_to X si s tr</span></span></span><br><span><var>sf</var><span class="hyp-type"><b>: </b><span>state X</span></span></span><br><span><var>iom, oom</var><span class="hyp-type"><b>: </b><span>option message</span></span></span><br><span><var>j</var><span class="hyp-type"><b>: </b><span>index</span></span></span><br><span><var>lj</var><span class="hyp-type"><b>: </b><span>label (IM j)</span></span></span><br><span><var>Ht</var><span class="hyp-type"><b>: </b><span>input_valid_transition X 
  (existT j lj) (s, iom) (
  sf, oom)</span></span></span><br><span><var>IHHtr</var><span class="hyp-type"><b>: </b><span>initial_state_prop (s i)
‚à® (<span class="kr">‚àÉ</span> <span class="nv">item</span> : composite_transition_item IM,
     item ‚àà tr
     ‚àß destination item i = s i
       ‚àß projT1 (l item) = i)</span></span></span><br><span><var>n</var><span class="hyp-type"><b>: </b><span>i ‚â† j</span></span></span><br></div><label class="goal-separator" for="Composition-v-chk20c"><hr></label><div class="goal-conclusion">initial_state_prop (sf i)
‚à® (<span class="kr">‚àÉ</span> <span class="nv">item</span> : composite_transition_item IM,
     item
     ‚àà tr ++
       [{|
          l := existT j lj;
          input := iom;
          destination := sf;
          output := oom
        |}]
     ‚àß destination item i = sf i ‚àß projT1 (l item) = i)</div></blockquote></div></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="Composition-v-chk20d" style="display: none" type="checkbox"><label class="alectryon-input" for="Composition-v-chk20d">-</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>index</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>EqDecision0</var><span class="hyp-type"><b>: </b><span>EqDecision index</span></span></span><br><span><var>message</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>IM</var><span class="hyp-type"><b>: </b><span>index ‚Üí VLSM message</span></span></span><br><span><var>constraint</var><span class="hyp-type"><b>: </b><span>composite_label IM
‚Üí composite_state IM * option message
  ‚Üí <span class="kt">Prop</span></span></span></span><br><span><var>X</var><span><span class="hyp-body"><b>:= </b><span>composite_vlsm IM constraint</span></span><span class="hyp-type"><b>: </b><span>VLSM message</span></span></span></span><br><span><var>i</var><span class="hyp-type"><b>: </b><span>index</span></span></span><br><span><var>si, s</var><span class="hyp-type"><b>: </b><span>state X</span></span></span><br><span><var>tr</var><span class="hyp-type"><b>: </b><span>list transition_item</span></span></span><br><span><var>Htr</var><span class="hyp-type"><b>: </b><span>finite_valid_trace_init_to X si s tr</span></span></span><br><span><var>sf</var><span class="hyp-type"><b>: </b><span>state X</span></span></span><br><span><var>iom, oom</var><span class="hyp-type"><b>: </b><span>option message</span></span></span><br><span><var>lj</var><span class="hyp-type"><b>: </b><span>label (IM i)</span></span></span><br><span><var>Ht</var><span class="hyp-type"><b>: </b><span>input_valid_transition X 
  (existT i lj) (s, iom) (
  sf, oom)</span></span></span><br><span><var>IHHtr</var><span class="hyp-type"><b>: </b><span>initial_state_prop (s i)
‚à® (<span class="kr">‚àÉ</span> <span class="nv">item</span> : composite_transition_item IM,
     item ‚àà tr
     ‚àß destination item i = s i
       ‚àß projT1 (l item) = i)</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">initial_state_prop (sf i)
‚à® (<span class="kr">‚àÉ</span> <span class="nv">item</span> : composite_transition_item IM,
     item
     ‚àà tr ++
       [{|
          l := existT i lj;
          input := iom;
          destination := sf;
          output := oom
        |}]
     ‚àß destination item i = sf i ‚àß projT1 (l item) = i)</div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="bp">by</span> <span class="nb">right</span>; <span class="nb">eexists</span>; <span class="nb">split</span>; [<span class="nb">rewrite</span> elem_of_app, elem_of_list_singleton; <span class="nb">right</span> |].</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="Composition-v-chk20e" style="display: none" type="checkbox"><label class="alectryon-input" for="Composition-v-chk20e">-</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>index</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>EqDecision0</var><span class="hyp-type"><b>: </b><span>EqDecision index</span></span></span><br><span><var>message</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>IM</var><span class="hyp-type"><b>: </b><span>index ‚Üí VLSM message</span></span></span><br><span><var>constraint</var><span class="hyp-type"><b>: </b><span>composite_label IM
‚Üí composite_state IM * option message
  ‚Üí <span class="kt">Prop</span></span></span></span><br><span><var>X</var><span><span class="hyp-body"><b>:= </b><span>composite_vlsm IM constraint</span></span><span class="hyp-type"><b>: </b><span>VLSM message</span></span></span></span><br><span><var>i</var><span class="hyp-type"><b>: </b><span>index</span></span></span><br><span><var>si, s</var><span class="hyp-type"><b>: </b><span>state X</span></span></span><br><span><var>tr</var><span class="hyp-type"><b>: </b><span>list transition_item</span></span></span><br><span><var>Htr</var><span class="hyp-type"><b>: </b><span>finite_valid_trace_init_to X si s tr</span></span></span><br><span><var>sf</var><span class="hyp-type"><b>: </b><span>state X</span></span></span><br><span><var>iom, oom</var><span class="hyp-type"><b>: </b><span>option message</span></span></span><br><span><var>j</var><span class="hyp-type"><b>: </b><span>index</span></span></span><br><span><var>lj</var><span class="hyp-type"><b>: </b><span>label (IM j)</span></span></span><br><span><var>Ht</var><span class="hyp-type"><b>: </b><span>input_valid_transition X 
  (existT j lj) (s, iom) (
  sf, oom)</span></span></span><br><span><var>IHHtr</var><span class="hyp-type"><b>: </b><span>initial_state_prop (s i)
‚à® (<span class="kr">‚àÉ</span> <span class="nv">item</span> : composite_transition_item IM,
     item ‚àà tr
     ‚àß destination item i = s i
       ‚àß projT1 (l item) = i)</span></span></span><br><span><var>n</var><span class="hyp-type"><b>: </b><span>i ‚â† j</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">initial_state_prop (sf i)
‚à® (<span class="kr">‚àÉ</span> <span class="nv">item</span> : composite_transition_item IM,
     item
     ‚àà tr ++
       [{|
          l := existT j lj;
          input := iom;
          destination := sf;
          output := oom
        |}]
     ‚àß destination item i = sf i ‚àß projT1 (l item) = i)</div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="Composition-v-chk20f" style="display: none" type="checkbox"><label class="alectryon-input" for="Composition-v-chk20f"><span class="nb">destruct</span> Ht <span class="kr">as</span> [_ Ht]; <span class="nb">cbn</span> <span class="kr">in</span> Ht.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>index</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>EqDecision0</var><span class="hyp-type"><b>: </b><span>EqDecision index</span></span></span><br><span><var>message</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>IM</var><span class="hyp-type"><b>: </b><span>index ‚Üí VLSM message</span></span></span><br><span><var>constraint</var><span class="hyp-type"><b>: </b><span>composite_label IM
‚Üí composite_state IM * option message
  ‚Üí <span class="kt">Prop</span></span></span></span><br><span><var>X</var><span><span class="hyp-body"><b>:= </b><span>composite_vlsm IM constraint</span></span><span class="hyp-type"><b>: </b><span>VLSM message</span></span></span></span><br><span><var>i</var><span class="hyp-type"><b>: </b><span>index</span></span></span><br><span><var>si, s</var><span class="hyp-type"><b>: </b><span>state X</span></span></span><br><span><var>tr</var><span class="hyp-type"><b>: </b><span>list transition_item</span></span></span><br><span><var>Htr</var><span class="hyp-type"><b>: </b><span>finite_valid_trace_init_to X si s tr</span></span></span><br><span><var>sf</var><span class="hyp-type"><b>: </b><span>state X</span></span></span><br><span><var>iom, oom</var><span class="hyp-type"><b>: </b><span>option message</span></span></span><br><span><var>j</var><span class="hyp-type"><b>: </b><span>index</span></span></span><br><span><var>lj</var><span class="hyp-type"><b>: </b><span>label (IM j)</span></span></span><br><span><var>Ht</var><span class="hyp-type"><b>: </b><span>(<span class="kr">let</span> (<span class="nv">si&#39;</span>, om&#39;) := transition lj (s j, iom) <span class="kr">in</span>
 (state_update IM s j si&#39;, om&#39;)) = (
sf, oom)</span></span></span><br><span><var>IHHtr</var><span class="hyp-type"><b>: </b><span>initial_state_prop (s i)
‚à® (<span class="kr">‚àÉ</span> <span class="nv">item</span> : composite_transition_item IM,
     item ‚àà tr
     ‚àß destination item i = s i
       ‚àß projT1 (l item) = i)</span></span></span><br><span><var>n</var><span class="hyp-type"><b>: </b><span>i ‚â† j</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">initial_state_prop (sf i)
‚à® (<span class="kr">‚àÉ</span> <span class="nv">item</span> : composite_transition_item IM,
     item
     ‚àà tr ++
       [{|
          l := existT j lj;
          input := iom;
          destination := sf;
          output := oom
        |}]
     ‚àß destination item i = sf i ‚àß projT1 (l item) = i)</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="Composition-v-chk210" style="display: none" type="checkbox"><label class="alectryon-input" for="Composition-v-chk210"><span class="nb">destruct</span> (transition lj (s j, iom)) <span class="kr">as</span> [si&#39; om&#39;]; <span class="nb">inversion</span> Ht; <span class="nb">subst</span>; <span class="nb">clear</span> Ht.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>index</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>EqDecision0</var><span class="hyp-type"><b>: </b><span>EqDecision index</span></span></span><br><span><var>message</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>IM</var><span class="hyp-type"><b>: </b><span>index ‚Üí VLSM message</span></span></span><br><span><var>constraint</var><span class="hyp-type"><b>: </b><span>composite_label IM
‚Üí composite_state IM * option message
  ‚Üí <span class="kt">Prop</span></span></span></span><br><span><var>X</var><span><span class="hyp-body"><b>:= </b><span>composite_vlsm IM constraint</span></span><span class="hyp-type"><b>: </b><span>VLSM message</span></span></span></span><br><span><var>i</var><span class="hyp-type"><b>: </b><span>index</span></span></span><br><span><var>si, s</var><span class="hyp-type"><b>: </b><span>state X</span></span></span><br><span><var>tr</var><span class="hyp-type"><b>: </b><span>list transition_item</span></span></span><br><span><var>Htr</var><span class="hyp-type"><b>: </b><span>finite_valid_trace_init_to X si s tr</span></span></span><br><span><var>iom, oom</var><span class="hyp-type"><b>: </b><span>option message</span></span></span><br><span><var>j</var><span class="hyp-type"><b>: </b><span>index</span></span></span><br><span><var>lj</var><span class="hyp-type"><b>: </b><span>label (IM j)</span></span></span><br><span><var>si'</var><span class="hyp-type"><b>: </b><span>state (IM j)</span></span></span><br><span><var>IHHtr</var><span class="hyp-type"><b>: </b><span>initial_state_prop (s i)
‚à® (<span class="kr">‚àÉ</span> <span class="nv">item</span> : composite_transition_item IM,
     item ‚àà tr
     ‚àß destination item i = s i
       ‚àß projT1 (l item) = i)</span></span></span><br><span><var>n</var><span class="hyp-type"><b>: </b><span>i ‚â† j</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">initial_state_prop (state_update IM s j si&#39; i)
‚à® (<span class="kr">‚àÉ</span> <span class="nv">item</span> : composite_transition_item IM,
     item
     ‚àà tr ++
       [{|
          l := existT j lj;
          input := iom;
          destination := state_update IM s j si&#39;;
          output := oom
        |}]
     ‚àß destination item i = state_update IM s j si&#39; i
       ‚àß projT1 (l item) = i)</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="Composition-v-chk211" style="display: none" type="checkbox"><label class="alectryon-input" for="Composition-v-chk211">state_update_simpl.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>index</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>EqDecision0</var><span class="hyp-type"><b>: </b><span>EqDecision index</span></span></span><br><span><var>message</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>IM</var><span class="hyp-type"><b>: </b><span>index ‚Üí VLSM message</span></span></span><br><span><var>constraint</var><span class="hyp-type"><b>: </b><span>composite_label IM
‚Üí composite_state IM * option message
  ‚Üí <span class="kt">Prop</span></span></span></span><br><span><var>X</var><span><span class="hyp-body"><b>:= </b><span>composite_vlsm IM constraint</span></span><span class="hyp-type"><b>: </b><span>VLSM message</span></span></span></span><br><span><var>i</var><span class="hyp-type"><b>: </b><span>index</span></span></span><br><span><var>si, s</var><span class="hyp-type"><b>: </b><span>state X</span></span></span><br><span><var>tr</var><span class="hyp-type"><b>: </b><span>list transition_item</span></span></span><br><span><var>Htr</var><span class="hyp-type"><b>: </b><span>finite_valid_trace_init_to X si s tr</span></span></span><br><span><var>iom, oom</var><span class="hyp-type"><b>: </b><span>option message</span></span></span><br><span><var>j</var><span class="hyp-type"><b>: </b><span>index</span></span></span><br><span><var>lj</var><span class="hyp-type"><b>: </b><span>label (IM j)</span></span></span><br><span><var>si'</var><span class="hyp-type"><b>: </b><span>state (IM j)</span></span></span><br><span><var>IHHtr</var><span class="hyp-type"><b>: </b><span>initial_state_prop (s i)
‚à® (<span class="kr">‚àÉ</span> <span class="nv">item</span> : composite_transition_item IM,
     item ‚àà tr
     ‚àß destination item i = s i
       ‚àß projT1 (l item) = i)</span></span></span><br><span><var>n</var><span class="hyp-type"><b>: </b><span>i ‚â† j</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">initial_state_prop (s i)
‚à® (<span class="kr">‚àÉ</span> <span class="nv">item</span> : composite_transition_item IM,
     item
     ‚àà tr ++
       [{|
          l := existT j lj;
          input := iom;
          destination := state_update IM s j si&#39;;
          output := oom
        |}]
     ‚àß destination item i = s i ‚àß projT1 (l item) = i)</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="Composition-v-chk212" style="display: none" type="checkbox"><label class="alectryon-input" for="Composition-v-chk212"><span class="nb">destruct</span> IHHtr <span class="kr">as</span> [| (? &amp; ? &amp; ?)]; [<span class="bp">by</span> <span class="nb">left</span> |].</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>index</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>EqDecision0</var><span class="hyp-type"><b>: </b><span>EqDecision index</span></span></span><br><span><var>message</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>IM</var><span class="hyp-type"><b>: </b><span>index ‚Üí VLSM message</span></span></span><br><span><var>constraint</var><span class="hyp-type"><b>: </b><span>composite_label IM
‚Üí composite_state IM * option message
  ‚Üí <span class="kt">Prop</span></span></span></span><br><span><var>X</var><span><span class="hyp-body"><b>:= </b><span>composite_vlsm IM constraint</span></span><span class="hyp-type"><b>: </b><span>VLSM message</span></span></span></span><br><span><var>i</var><span class="hyp-type"><b>: </b><span>index</span></span></span><br><span><var>si, s</var><span class="hyp-type"><b>: </b><span>state X</span></span></span><br><span><var>tr</var><span class="hyp-type"><b>: </b><span>list transition_item</span></span></span><br><span><var>Htr</var><span class="hyp-type"><b>: </b><span>finite_valid_trace_init_to X si s tr</span></span></span><br><span><var>iom, oom</var><span class="hyp-type"><b>: </b><span>option message</span></span></span><br><span><var>j</var><span class="hyp-type"><b>: </b><span>index</span></span></span><br><span><var>lj</var><span class="hyp-type"><b>: </b><span>label (IM j)</span></span></span><br><span><var>si'</var><span class="hyp-type"><b>: </b><span>state (IM j)</span></span></span><br><span><var>x</var><span class="hyp-type"><b>: </b><span>composite_transition_item IM</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>x ‚àà tr</span></span></span><br><span><var>H0</var><span class="hyp-type"><b>: </b><span>destination x i = s i ‚àß projT1 (l x) = i</span></span></span><br><span><var>n</var><span class="hyp-type"><b>: </b><span>i ‚â† j</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">initial_state_prop (s i)
‚à® (<span class="kr">‚àÉ</span> <span class="nv">item</span> : composite_transition_item IM,
     item
     ‚àà tr ++
       [{|
          l := existT j lj;
          input := iom;
          destination := state_update IM s j si&#39;;
          output := oom
        |}]
     ‚àß destination item i = s i ‚àß projT1 (l item) = i)</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><span class="alectryon-input"><span class="bp">by</span> <span class="nb">right</span>; <span class="nb">eexists</span>; <span class="nb">split</span>; [<span class="nb">rewrite</span> elem_of_app; <span class="nb">left</span> |].</span><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Qed</span>.</span></span></pre><div class="doc">
  A reformulation of <span class="inlinecode"><span class="id" title="var">final_state_component_initial_or_transition</span></span> in terms of
  <span class="inlinecode"><span class="id" title="var">valid_state_prop</span></span> and <span class="inlinecode"><span class="id" title="var">in_futures</span></span>.

<div class="paragraph"> </div>

  A component state from a valid state for a composition is either initial or
  there exists a valid transition in the composition from whose destination
  the given state is validly reachable and which corresponds to a transition
  in the component leading to the current component state.

</div><pre class="alectryon-io highlight"><!-- Generator: Alectryon --><span class="alectryon-sentence"><input class="alectryon-toggle" id="Composition-v-chk213" style="display: none" type="checkbox"><label class="alectryon-input" for="Composition-v-chk213"><span class="kn">Lemma</span> <span class="nf">valid_state_component_initial_or_transition</span> :
  <span class="kr">forall</span> (<span class="nv">i</span> : index) (<span class="nv">f</span> : composite_state IM),
    valid_state_prop X f -&gt;
    initial_state_prop (IM i) (f i)
      \/
    <span class="kr">exists</span> (<span class="nv">s1</span> <span class="nv">s2</span> : composite_state IM) (<span class="nv">li</span> : label (IM i)) (<span class="nv">om</span> <span class="nv">om&#39;</span> : option message),
      in_futures X s2 f /\ s2 i = f i /\
      input_valid_transition X (existT i li) (s1, om) (s2, om&#39;).</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>index</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>EqDecision0</var><span class="hyp-type"><b>: </b><span>EqDecision index</span></span></span><br><span><var>message</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>IM</var><span class="hyp-type"><b>: </b><span>index ‚Üí VLSM message</span></span></span><br><span><var>constraint</var><span class="hyp-type"><b>: </b><span>composite_label IM
‚Üí composite_state IM * option message
  ‚Üí <span class="kt">Prop</span></span></span></span><br><span><var>X</var><span><span class="hyp-body"><b>:= </b><span>composite_vlsm IM constraint</span></span><span class="hyp-type"><b>: </b><span>VLSM message</span></span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="kr">‚àÄ</span> (<span class="nv">i</span> : index) (<span class="nv">f</span> : composite_state IM),
  valid_state_prop X f
  ‚Üí initial_state_prop (f i)
    ‚à® (<span class="kr">‚àÉ</span> (<span class="nv">s1</span> <span class="nv">s2</span> : composite_state IM) (<span class="nv">li</span> : label
                                              (IM i)) 
         (<span class="nv">om</span> <span class="nv">om&#39;</span> : option message),
         in_futures X s2 f
         ‚àß s2 i = f i
           ‚àß input_valid_transition X (existT i li)
               (s1, om) (s2, om&#39;))</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="Composition-v-chk214" style="display: none" type="checkbox"><label class="alectryon-input" for="Composition-v-chk214"><span class="kn">Proof</span>.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>index</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>EqDecision0</var><span class="hyp-type"><b>: </b><span>EqDecision index</span></span></span><br><span><var>message</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>IM</var><span class="hyp-type"><b>: </b><span>index ‚Üí VLSM message</span></span></span><br><span><var>constraint</var><span class="hyp-type"><b>: </b><span>composite_label IM
‚Üí composite_state IM * option message
  ‚Üí <span class="kt">Prop</span></span></span></span><br><span><var>X</var><span><span class="hyp-body"><b>:= </b><span>composite_vlsm IM constraint</span></span><span class="hyp-type"><b>: </b><span>VLSM message</span></span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="kr">‚àÄ</span> (<span class="nv">i</span> : index) (<span class="nv">f</span> : composite_state IM),
  valid_state_prop X f
  ‚Üí initial_state_prop (f i)
    ‚à® (<span class="kr">‚àÉ</span> (<span class="nv">s1</span> <span class="nv">s2</span> : composite_state IM) (<span class="nv">li</span> : label
                                              (IM i)) 
         (<span class="nv">om</span> <span class="nv">om&#39;</span> : option message),
         in_futures X s2 f
         ‚àß s2 i = f i
           ‚àß input_valid_transition X (existT i li)
               (s1, om) (s2, om&#39;))</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="Composition-v-chk215" style="display: none" type="checkbox"><label class="alectryon-input" for="Composition-v-chk215"><span class="nb">intros</span> i f Hf.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>index</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>EqDecision0</var><span class="hyp-type"><b>: </b><span>EqDecision index</span></span></span><br><span><var>message</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>IM</var><span class="hyp-type"><b>: </b><span>index ‚Üí VLSM message</span></span></span><br><span><var>constraint</var><span class="hyp-type"><b>: </b><span>composite_label IM
‚Üí composite_state IM * option message
  ‚Üí <span class="kt">Prop</span></span></span></span><br><span><var>X</var><span><span class="hyp-body"><b>:= </b><span>composite_vlsm IM constraint</span></span><span class="hyp-type"><b>: </b><span>VLSM message</span></span></span></span><br><span><var>i</var><span class="hyp-type"><b>: </b><span>index</span></span></span><br><span><var>f</var><span class="hyp-type"><b>: </b><span>composite_state IM</span></span></span><br><span><var>Hf</var><span class="hyp-type"><b>: </b><span>valid_state_prop X f</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">initial_state_prop (f i)
‚à® (<span class="kr">‚àÉ</span> (<span class="nv">s1</span> <span class="nv">s2</span> : composite_state IM) (<span class="nv">li</span> : label (IM i)) 
     (<span class="nv">om</span> <span class="nv">om&#39;</span> : option message),
     in_futures X s2 f
     ‚àß s2 i = f i
       ‚àß input_valid_transition X (existT i li)
           (s1, om) (s2, om&#39;))</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="Composition-v-chk216" style="display: none" type="checkbox"><label class="alectryon-input" for="Composition-v-chk216"><span class="nb">apply</span> valid_state_has_trace <span class="kr">in</span> Hf <span class="kr">as</span> (<span class="kr">is</span> &amp; tr &amp; Htr).</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>index</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>EqDecision0</var><span class="hyp-type"><b>: </b><span>EqDecision index</span></span></span><br><span><var>message</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>IM</var><span class="hyp-type"><b>: </b><span>index ‚Üí VLSM message</span></span></span><br><span><var>constraint</var><span class="hyp-type"><b>: </b><span>composite_label IM
‚Üí composite_state IM * option message
  ‚Üí <span class="kt">Prop</span></span></span></span><br><span><var>X</var><span><span class="hyp-body"><b>:= </b><span>composite_vlsm IM constraint</span></span><span class="hyp-type"><b>: </b><span>VLSM message</span></span></span></span><br><span><var>i</var><span class="hyp-type"><b>: </b><span>index</span></span></span><br><span><var>f</var><span class="hyp-type"><b>: </b><span>composite_state IM</span></span></span><br><span><var>is</var><span class="hyp-type"><b>: </b><span>state X</span></span></span><br><span><var>tr</var><span class="hyp-type"><b>: </b><span>list transition_item</span></span></span><br><span><var>Htr</var><span class="hyp-type"><b>: </b><span>finite_valid_trace_init_to X <span class="kr">is</span> f tr</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">initial_state_prop (f i)
‚à® (<span class="kr">‚àÉ</span> (<span class="nv">s1</span> <span class="nv">s2</span> : composite_state IM) (<span class="nv">li</span> : label (IM i)) 
     (<span class="nv">om</span> <span class="nv">om&#39;</span> : option message),
     in_futures X s2 f
     ‚àß s2 i = f i
       ‚àß input_valid_transition X (existT i li)
           (s1, om) (s2, om&#39;))</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="Composition-v-chk217" style="display: none" type="checkbox"><label class="alectryon-input" for="Composition-v-chk217"><span class="nb">apply</span> (final_state_component_initial_or_transition i) <span class="kr">in</span> Htr <span class="kr">as</span> Hitem.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>index</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>EqDecision0</var><span class="hyp-type"><b>: </b><span>EqDecision index</span></span></span><br><span><var>message</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>IM</var><span class="hyp-type"><b>: </b><span>index ‚Üí VLSM message</span></span></span><br><span><var>constraint</var><span class="hyp-type"><b>: </b><span>composite_label IM
‚Üí composite_state IM * option message
  ‚Üí <span class="kt">Prop</span></span></span></span><br><span><var>X</var><span><span class="hyp-body"><b>:= </b><span>composite_vlsm IM constraint</span></span><span class="hyp-type"><b>: </b><span>VLSM message</span></span></span></span><br><span><var>i</var><span class="hyp-type"><b>: </b><span>index</span></span></span><br><span><var>f</var><span class="hyp-type"><b>: </b><span>composite_state IM</span></span></span><br><span><var>is</var><span class="hyp-type"><b>: </b><span>state X</span></span></span><br><span><var>tr</var><span class="hyp-type"><b>: </b><span>list transition_item</span></span></span><br><span><var>Htr</var><span class="hyp-type"><b>: </b><span>finite_valid_trace_init_to X <span class="kr">is</span> f tr</span></span></span><br><span><var>Hitem</var><span class="hyp-type"><b>: </b><span>initial_state_prop (f i)
‚à® (<span class="kr">‚àÉ</span> <span class="nv">item</span> : composite_transition_item IM,
     item ‚àà tr
     ‚àß destination item i = f i
       ‚àß projT1 (l item) = i)</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">initial_state_prop (f i)
‚à® (<span class="kr">‚àÉ</span> (<span class="nv">s1</span> <span class="nv">s2</span> : composite_state IM) (<span class="nv">li</span> : label (IM i)) 
     (<span class="nv">om</span> <span class="nv">om&#39;</span> : option message),
     in_futures X s2 f
     ‚àß s2 i = f i
       ‚àß input_valid_transition X (existT i li)
           (s1, om) (s2, om&#39;))</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="Composition-v-chk218" style="display: none" type="checkbox"><label class="alectryon-input" for="Composition-v-chk218"><span class="nb">destruct</span> Hitem <span class="kr">as</span> [| (item &amp; Hitem &amp; Hdest &amp; Hl)]; [<span class="bp">by</span> <span class="nb">left</span> |].</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>index</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>EqDecision0</var><span class="hyp-type"><b>: </b><span>EqDecision index</span></span></span><br><span><var>message</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>IM</var><span class="hyp-type"><b>: </b><span>index ‚Üí VLSM message</span></span></span><br><span><var>constraint</var><span class="hyp-type"><b>: </b><span>composite_label IM
‚Üí composite_state IM * option message
  ‚Üí <span class="kt">Prop</span></span></span></span><br><span><var>X</var><span><span class="hyp-body"><b>:= </b><span>composite_vlsm IM constraint</span></span><span class="hyp-type"><b>: </b><span>VLSM message</span></span></span></span><br><span><var>i</var><span class="hyp-type"><b>: </b><span>index</span></span></span><br><span><var>f</var><span class="hyp-type"><b>: </b><span>composite_state IM</span></span></span><br><span><var>is</var><span class="hyp-type"><b>: </b><span>state X</span></span></span><br><span><var>tr</var><span class="hyp-type"><b>: </b><span>list transition_item</span></span></span><br><span><var>Htr</var><span class="hyp-type"><b>: </b><span>finite_valid_trace_init_to X <span class="kr">is</span> f tr</span></span></span><br><span><var>item</var><span class="hyp-type"><b>: </b><span>composite_transition_item IM</span></span></span><br><span><var>Hitem</var><span class="hyp-type"><b>: </b><span>item ‚àà tr</span></span></span><br><span><var>Hdest</var><span class="hyp-type"><b>: </b><span>destination item i = f i</span></span></span><br><span><var>Hl</var><span class="hyp-type"><b>: </b><span>projT1 (l item) = i</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">initial_state_prop (f i)
‚à® (<span class="kr">‚àÉ</span> (<span class="nv">s1</span> <span class="nv">s2</span> : composite_state IM) (<span class="nv">li</span> : label (IM i)) 
     (<span class="nv">om</span> <span class="nv">om&#39;</span> : option message),
     in_futures X s2 f
     ‚àß s2 i = f i
       ‚àß input_valid_transition X (existT i li)
           (s1, om) (s2, om&#39;))</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="Composition-v-chk219" style="display: none" type="checkbox"><label class="alectryon-input" for="Composition-v-chk219"><span class="nb">apply</span> elem_of_list_split <span class="kr">in</span> Hitem <span class="kr">as</span> (pre &amp; suf &amp; -&gt;).</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>index</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>EqDecision0</var><span class="hyp-type"><b>: </b><span>EqDecision index</span></span></span><br><span><var>message</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>IM</var><span class="hyp-type"><b>: </b><span>index ‚Üí VLSM message</span></span></span><br><span><var>constraint</var><span class="hyp-type"><b>: </b><span>composite_label IM
‚Üí composite_state IM * option message
  ‚Üí <span class="kt">Prop</span></span></span></span><br><span><var>X</var><span><span class="hyp-body"><b>:= </b><span>composite_vlsm IM constraint</span></span><span class="hyp-type"><b>: </b><span>VLSM message</span></span></span></span><br><span><var>i</var><span class="hyp-type"><b>: </b><span>index</span></span></span><br><span><var>f</var><span class="hyp-type"><b>: </b><span>composite_state IM</span></span></span><br><span><var>is</var><span class="hyp-type"><b>: </b><span>state X</span></span></span><br><span><var>item</var><span class="hyp-type"><b>: </b><span>composite_transition_item IM</span></span></span><br><span><var>pre, suf</var><span class="hyp-type"><b>: </b><span>list (composite_transition_item IM)</span></span></span><br><span><var>Htr</var><span class="hyp-type"><b>: </b><span>finite_valid_trace_init_to X <span class="kr">is</span> f
  (pre ++ item :: suf)</span></span></span><br><span><var>Hdest</var><span class="hyp-type"><b>: </b><span>destination item i = f i</span></span></span><br><span><var>Hl</var><span class="hyp-type"><b>: </b><span>projT1 (l item) = i</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">initial_state_prop (f i)
‚à® (<span class="kr">‚àÉ</span> (<span class="nv">s1</span> <span class="nv">s2</span> : composite_state IM) (<span class="nv">li</span> : label (IM i)) 
     (<span class="nv">om</span> <span class="nv">om&#39;</span> : option message),
     in_futures X s2 f
     ‚àß s2 i = f i
       ‚àß input_valid_transition X (existT i li)
           (s1, om) (s2, om&#39;))</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="Composition-v-chk21a" style="display: none" type="checkbox"><label class="alectryon-input" for="Composition-v-chk21a"><span class="nb">destruct</span> Htr <span class="kr">as</span> [Htr Hinit].</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>index</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>EqDecision0</var><span class="hyp-type"><b>: </b><span>EqDecision index</span></span></span><br><span><var>message</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>IM</var><span class="hyp-type"><b>: </b><span>index ‚Üí VLSM message</span></span></span><br><span><var>constraint</var><span class="hyp-type"><b>: </b><span>composite_label IM
‚Üí composite_state IM * option message
  ‚Üí <span class="kt">Prop</span></span></span></span><br><span><var>X</var><span><span class="hyp-body"><b>:= </b><span>composite_vlsm IM constraint</span></span><span class="hyp-type"><b>: </b><span>VLSM message</span></span></span></span><br><span><var>i</var><span class="hyp-type"><b>: </b><span>index</span></span></span><br><span><var>f</var><span class="hyp-type"><b>: </b><span>composite_state IM</span></span></span><br><span><var>is</var><span class="hyp-type"><b>: </b><span>state X</span></span></span><br><span><var>item</var><span class="hyp-type"><b>: </b><span>composite_transition_item IM</span></span></span><br><span><var>pre, suf</var><span class="hyp-type"><b>: </b><span>list (composite_transition_item IM)</span></span></span><br><span><var>Htr</var><span class="hyp-type"><b>: </b><span>finite_valid_trace_from_to X <span class="kr">is</span> f
  (pre ++ item :: suf)</span></span></span><br><span><var>Hinit</var><span class="hyp-type"><b>: </b><span>initial_state_prop <span class="kr">is</span></span></span></span><br><span><var>Hdest</var><span class="hyp-type"><b>: </b><span>destination item i = f i</span></span></span><br><span><var>Hl</var><span class="hyp-type"><b>: </b><span>projT1 (l item) = i</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">initial_state_prop (f i)
‚à® (<span class="kr">‚àÉ</span> (<span class="nv">s1</span> <span class="nv">s2</span> : composite_state IM) (<span class="nv">li</span> : label (IM i)) 
     (<span class="nv">om</span> <span class="nv">om&#39;</span> : option message),
     in_futures X s2 f
     ‚àß s2 i = f i
       ‚àß input_valid_transition X (existT i li)
           (s1, om) (s2, om&#39;))</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="Composition-v-chk21b" style="display: none" type="checkbox"><label class="alectryon-input" for="Composition-v-chk21b"><span class="nb">apply</span> finite_valid_trace_from_to_app_split <span class="kr">in</span> Htr <span class="kr">as</span> [_ Htr].</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>index</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>EqDecision0</var><span class="hyp-type"><b>: </b><span>EqDecision index</span></span></span><br><span><var>message</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>IM</var><span class="hyp-type"><b>: </b><span>index ‚Üí VLSM message</span></span></span><br><span><var>constraint</var><span class="hyp-type"><b>: </b><span>composite_label IM
‚Üí composite_state IM * option message
  ‚Üí <span class="kt">Prop</span></span></span></span><br><span><var>X</var><span><span class="hyp-body"><b>:= </b><span>composite_vlsm IM constraint</span></span><span class="hyp-type"><b>: </b><span>VLSM message</span></span></span></span><br><span><var>i</var><span class="hyp-type"><b>: </b><span>index</span></span></span><br><span><var>f</var><span class="hyp-type"><b>: </b><span>composite_state IM</span></span></span><br><span><var>is</var><span class="hyp-type"><b>: </b><span>state X</span></span></span><br><span><var>item</var><span class="hyp-type"><b>: </b><span>composite_transition_item IM</span></span></span><br><span><var>pre, suf</var><span class="hyp-type"><b>: </b><span>list (composite_transition_item IM)</span></span></span><br><span><var>Htr</var><span class="hyp-type"><b>: </b><span>finite_valid_trace_from_to X
  (finite_trace_last <span class="kr">is</span> pre) f 
  (item :: suf)</span></span></span><br><span><var>Hinit</var><span class="hyp-type"><b>: </b><span>initial_state_prop <span class="kr">is</span></span></span></span><br><span><var>Hdest</var><span class="hyp-type"><b>: </b><span>destination item i = f i</span></span></span><br><span><var>Hl</var><span class="hyp-type"><b>: </b><span>projT1 (l item) = i</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">initial_state_prop (f i)
‚à® (<span class="kr">‚àÉ</span> (<span class="nv">s1</span> <span class="nv">s2</span> : composite_state IM) (<span class="nv">li</span> : label (IM i)) 
     (<span class="nv">om</span> <span class="nv">om&#39;</span> : option message),
     in_futures X s2 f
     ‚àß s2 i = f i
       ‚àß input_valid_transition X (existT i li)
           (s1, om) (s2, om&#39;))</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="Composition-v-chk21c" style="display: none" type="checkbox"><label class="alectryon-input" for="Composition-v-chk21c"><span class="nb">inversion</span> Htr; <span class="nb">subst</span>; <span class="nb">destruct</span> l <span class="kr">as</span> [i li]; <span class="nb">cbn</span> <span class="kr">in</span> *.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>index</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>EqDecision0</var><span class="hyp-type"><b>: </b><span>EqDecision index</span></span></span><br><span><var>message</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>IM</var><span class="hyp-type"><b>: </b><span>index ‚Üí VLSM message</span></span></span><br><span><var>constraint</var><span class="hyp-type"><b>: </b><span>composite_label IM
‚Üí composite_state IM * option message
  ‚Üí <span class="kt">Prop</span></span></span></span><br><span><var>X</var><span><span class="hyp-body"><b>:= </b><span>composite_vlsm IM constraint</span></span><span class="hyp-type"><b>: </b><span>VLSM message</span></span></span></span><br><span><var>f, is</var><span class="hyp-type"><b>: </b><span>composite_state IM</span></span></span><br><span><var>pre, suf</var><span class="hyp-type"><b>: </b><span>list (composite_transition_item IM)</span></span></span><br><span><var>s</var><span class="hyp-type"><b>: </b><span>composite_state IM</span></span></span><br><span><var>iom, oom</var><span class="hyp-type"><b>: </b><span>option message</span></span></span><br><span><var>i</var><span class="hyp-type"><b>: </b><span>index</span></span></span><br><span><var>li</var><span class="hyp-type"><b>: </b><span>label (IM i)</span></span></span><br><span><var>Htr</var><span class="hyp-type"><b>: </b><span>finite_valid_trace_from_to X
  (finite_trace_last <span class="kr">is</span> pre) f
  ({|
     l := existT i li;
     input := iom;
     destination := s;
     output := oom
   |} :: suf)</span></span></span><br><span><var>Hinit</var><span class="hyp-type"><b>: </b><span>composite_initial_state_prop IM <span class="kr">is</span></span></span></span><br><span><var>Hdest</var><span class="hyp-type"><b>: </b><span>s i = f i</span></span></span><br><span><var>Htl</var><span class="hyp-type"><b>: </b><span>finite_valid_trace_from_to X s f suf</span></span></span><br><span><var>Ht</var><span class="hyp-type"><b>: </b><span>input_valid_transition X 
  (existT i li) (finite_trace_last <span class="kr">is</span> pre, iom)
  (s, oom)</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">initial_state_prop (f i)
‚à® (<span class="kr">‚àÉ</span> (<span class="nv">s1</span> <span class="nv">s2</span> : composite_state IM) (<span class="nv">li</span> : label (IM i)) 
     (<span class="nv">om</span> <span class="nv">om&#39;</span> : option message),
     in_futures X s2 f
     ‚àß s2 i = f i
       ‚àß input_valid_transition X (existT i li)
           (s1, om) (s2, om&#39;))</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="Composition-v-chk21d" style="display: none" type="checkbox"><label class="alectryon-input" for="Composition-v-chk21d"><span class="nb">right</span>; <span class="kr">exists</span> (<span class="nv">finite_trace_last</span> <span class="nv">is</span> <span class="nv">pre</span>), s, li, iom, oom.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>index</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>EqDecision0</var><span class="hyp-type"><b>: </b><span>EqDecision index</span></span></span><br><span><var>message</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>IM</var><span class="hyp-type"><b>: </b><span>index ‚Üí VLSM message</span></span></span><br><span><var>constraint</var><span class="hyp-type"><b>: </b><span>composite_label IM
‚Üí composite_state IM * option message
  ‚Üí <span class="kt">Prop</span></span></span></span><br><span><var>X</var><span><span class="hyp-body"><b>:= </b><span>composite_vlsm IM constraint</span></span><span class="hyp-type"><b>: </b><span>VLSM message</span></span></span></span><br><span><var>f, is</var><span class="hyp-type"><b>: </b><span>composite_state IM</span></span></span><br><span><var>pre, suf</var><span class="hyp-type"><b>: </b><span>list (composite_transition_item IM)</span></span></span><br><span><var>s</var><span class="hyp-type"><b>: </b><span>composite_state IM</span></span></span><br><span><var>iom, oom</var><span class="hyp-type"><b>: </b><span>option message</span></span></span><br><span><var>i</var><span class="hyp-type"><b>: </b><span>index</span></span></span><br><span><var>li</var><span class="hyp-type"><b>: </b><span>label (IM i)</span></span></span><br><span><var>Htr</var><span class="hyp-type"><b>: </b><span>finite_valid_trace_from_to X
  (finite_trace_last <span class="kr">is</span> pre) f
  ({|
     l := existT i li;
     input := iom;
     destination := s;
     output := oom
   |} :: suf)</span></span></span><br><span><var>Hinit</var><span class="hyp-type"><b>: </b><span>composite_initial_state_prop IM <span class="kr">is</span></span></span></span><br><span><var>Hdest</var><span class="hyp-type"><b>: </b><span>s i = f i</span></span></span><br><span><var>Htl</var><span class="hyp-type"><b>: </b><span>finite_valid_trace_from_to X s f suf</span></span></span><br><span><var>Ht</var><span class="hyp-type"><b>: </b><span>input_valid_transition X 
  (existT i li) (finite_trace_last <span class="kr">is</span> pre, iom)
  (s, oom)</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">in_futures X s f
‚àß s i = f i
  ‚àß input_valid_transition X (existT i li)
      (finite_trace_last <span class="kr">is</span> pre, iom) (s, oom)</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><span class="alectryon-input"><span class="bp">by</span> <span class="nb">split</span>; [<span class="nb">eexists</span> |].</span><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Qed</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
</span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">End</span> <span class="nf">sec_composite_state</span>.</span></span></pre></article></body></html>