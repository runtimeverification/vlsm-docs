<!DOCTYPE html>
<html class="alectryon-standalone"><head><title>FinSuppFn.v</title><meta charset="utf-8"><meta content="Alectryon" name="generator"><meta name="viewport" content="width=device-width, initial-scale=1"><link href="alectryon.css" rel="stylesheet"><link href="pygments.css" rel="stylesheet">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/IBM-type/0.5.4/css/ibm-type.min.css" integrity="sha512-sky5cf9Ts6FY1kstGOBHSybfKqdHR41M0Ldb0BjNiv3ifltoQIsg0zIaQ+wwdwgQ0w9vKFW7Js50lxH9vqNSSw==" crossorigin="anonymous" />
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/firacode/5.2.0/fira_code.min.css" integrity="sha512-MbysAYimH1hH2xYzkkMHB6MqxBqfP0megxsCLknbYqHVwXTCg9IqHbk+ZP/vnhO8UEW6PaXAkKe2vQ+SWACxxA==" crossorigin="anonymous" /><script src="alectryon.js"></script></head><body><article class="alectryon-root alectryon-windowed alectryon-coqdoc"><div class="alectryon-banner">Built with <a href="https://github.com/cpitclaudel/alectryon/">Alectryon</a>, running Coq+SerAPI v8.18.0+0.18.1. Bubbles (<span class="alectryon-bubble"></span>) indicate interactive fragments: hover for details, tap to reveal contents. Use <kbd>Ctrl+‚Üë</kbd> <kbd>Ctrl+‚Üì</kbd> to navigate, <kbd>Ctrl+üñ±Ô∏è</kbd> to focus. On Mac, use <kbd>‚åò</kbd> instead of <kbd>Ctrl</kbd>.</div><pre class="alectryon-io highlight"><!-- Generator: Alectryon --><span class="alectryon-sentence"><input class="alectryon-toggle" id="FinSuppFn-v-chk0" style="display: none" type="checkbox"><label class="alectryon-input" for="FinSuppFn-v-chk0"><span class="kn">From</span> VLSM.Lib <span class="kn">Require Import</span> Itauto.</label><small class="alectryon-output"><div><div class="alectryon-messages"><blockquote class="alectryon-message">[Loading ML file ring_plugin.cmxs (<span class="nb">using</span> legacy method) ... <span class="bp">done</span>]</blockquote><blockquote class="alectryon-message">[Loading ML file zify_plugin.cmxs (<span class="nb">using</span> legacy method) ... <span class="bp">done</span>]</blockquote><blockquote class="alectryon-message">[Loading ML file micromega_plugin.cmxs (<span class="nb">using</span> legacy method) ... <span class="bp">done</span>]</blockquote><blockquote class="alectryon-message">[Loading ML file btauto_plugin.cmxs (<span class="nb">using</span> legacy method) ... <span class="bp">done</span>]</blockquote><blockquote class="alectryon-message">[Loading ML file coq-itauto.plugin ... <span class="bp">done</span>]</blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">From</span> Coq <span class="kn">Require Import</span> FunctionalExtensionality.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">From</span> stdpp <span class="kn">Require Import</span> prelude finite.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">From</span> VLSM.Lib <span class="kn">Require Import</span> Preamble StdppExtras ListExtras FinSetExtras.</span></span></pre><div class="doc">
<a id="lab1"></a><h1 class="section">Utility: Finitely Supported Functions</h1>
</div><pre class="alectryon-io highlight"><!-- Generator: Alectryon --></pre><div class="doc">
  The support of a function (w.r.t. a specified codomain value) is the type of
  elements of its domain that are not mapped to the specified value.

<div class="paragraph"> </div>

  Note that we require the codomain to have decidable equality, because it
  allows for a straight-forward approach to proving equality of elements
  of the support.

</div><pre class="alectryon-io highlight"><!-- Generator: Alectryon --><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Definition</span> <span class="nf">support</span> {<span class="nv">A</span> <span class="nv">B</span> : <span class="kt">Type</span>} (<span class="nv">s</span> : B) (<span class="nv">f</span> : A -&gt; B) `{EqDecision B} : <span class="kt">Type</span> :=
  dsig (<span class="kr">fun</span> <span class="nv">a</span> =&gt; f a &lt;&gt; s).</span></span></pre><div class="doc">
  A function is finitely supported if its <span class="inlinecode"><span class="id" title="var">support</span></span> is <span class="inlinecode"><span class="id" title="var">Finite</span></span>.
  We define a type to encapsulate functions of finite support.

</div><pre class="alectryon-io highlight"><!-- Generator: Alectryon --><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Definition</span> <span class="nf">fsfun</span> (<span class="nv">A</span> : <span class="kt">Type</span>) `(s : B) `{EqDecision A, EqDecision B} : <span class="kt">Type</span> :=
  {f : A -&gt; B &amp; Finite (support s f)}.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
</span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Definition</span> <span class="nf">fsfun_project</span>
  {<span class="nv">A</span> <span class="nv">B</span> : <span class="kt">Type</span>} {<span class="nv">b</span> : B} `{EqDecision A, EqDecision B} : fsfun A b -&gt; A -&gt; B :=
  projT1.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
</span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Coercion</span> <span class="nf">fsfun_project</span> : fsfun &gt;-&gt; <span class="kt">Funclass</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
</span><span class="alectryon-sentence"><span class="alectryon-input">#[<span class="kn">global</span>] <span class="kn">Arguments</span> fsfun_project : <span class="nb">simpl</span> never.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
</span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Section</span> <span class="nf">sec_fsfun_fixed_domain</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
</span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Context</span>
  `{EqDecision A}
  .</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
</span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Section</span> <span class="nf">sec_fsfun_fixed_supp_value</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
</span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Context</span>
  `{EqDecision B}
  {b : B}
  .</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
</span><span class="alectryon-sentence"><span class="alectryon-input">#[export] <span class="kn">Instance</span> <span class="nf">fsfun_equiv</span> : Equiv (fsfun A b) :=
  <span class="kr">fun</span> <span class="nv">f</span> <span class="nv">g</span> =&gt; fsfun_project f = fsfun_project g.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
</span><span class="alectryon-sentence"><input class="alectryon-toggle" id="FinSuppFn-v-chk1" style="display: none" type="checkbox"><label class="alectryon-input" for="FinSuppFn-v-chk1">#[export] <span class="kn">Instance</span> <span class="nf">fsfun_equivalence</span> :
  Equivalence (‚â°@{fsfun A b}).</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>A</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>EqDecision0</var><span class="hyp-type"><b>: </b><span>EqDecision A</span></span></span><br><span><var>B</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>EqDecision1</var><span class="hyp-type"><b>: </b><span>EqDecision B</span></span></span><br><span><var>b</var><span class="hyp-type"><b>: </b><span>B</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">Equivalence equiv</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="FinSuppFn-v-chk2" style="display: none" type="checkbox"><label class="alectryon-input" for="FinSuppFn-v-chk2"><span class="kn">Proof</span>.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>A</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>EqDecision0</var><span class="hyp-type"><b>: </b><span>EqDecision A</span></span></span><br><span><var>B</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>EqDecision1</var><span class="hyp-type"><b>: </b><span>EqDecision B</span></span></span><br><span><var>b</var><span class="hyp-type"><b>: </b><span>B</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">Equivalence equiv</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="FinSuppFn-v-chk3" style="display: none" type="checkbox"><label class="alectryon-input" for="FinSuppFn-v-chk3"><span class="nb">unfold</span> equiv, fsfun_equiv.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>A</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>EqDecision0</var><span class="hyp-type"><b>: </b><span>EqDecision A</span></span></span><br><span><var>B</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>EqDecision1</var><span class="hyp-type"><b>: </b><span>EqDecision B</span></span></span><br><span><var>b</var><span class="hyp-type"><b>: </b><span>B</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">Equivalence (<span class="kr">Œª</span> <span class="nv">f</span> <span class="nv">g</span> : fsfun A b, f = g)</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="FinSuppFn-v-chk4" style="display: none" type="checkbox"><label class="alectryon-input" for="FinSuppFn-v-chk4"><span class="nb">constructor</span>; [<span class="bp">done</span> | ..].</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>A</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>EqDecision0</var><span class="hyp-type"><b>: </b><span>EqDecision A</span></span></span><br><span><var>B</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>EqDecision1</var><span class="hyp-type"><b>: </b><span>EqDecision B</span></span></span><br><span><var>b</var><span class="hyp-type"><b>: </b><span>B</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">Symmetric (<span class="kr">Œª</span> <span class="nv">f</span> <span class="nv">g</span> : fsfun A b, f = g)</div></blockquote><div class="alectryon-extra-goals"><input class="alectryon-extra-goal-toggle" id="FinSuppFn-v-chk5" style="display: none" type="checkbox"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>A</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>EqDecision0</var><span class="hyp-type"><b>: </b><span>EqDecision A</span></span></span><br><span><var>B</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>EqDecision1</var><span class="hyp-type"><b>: </b><span>EqDecision B</span></span></span><br><span><var>b</var><span class="hyp-type"><b>: </b><span>B</span></span></span><br></div><label class="goal-separator" for="FinSuppFn-v-chk5"><hr></label><div class="goal-conclusion">Transitive (<span class="kr">Œª</span> <span class="nv">f</span> <span class="nv">g</span> : fsfun A b, f = g)</div></blockquote></div></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="FinSuppFn-v-chk6" style="display: none" type="checkbox"><label class="alectryon-input" for="FinSuppFn-v-chk6">-</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>A</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>EqDecision0</var><span class="hyp-type"><b>: </b><span>EqDecision A</span></span></span><br><span><var>B</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>EqDecision1</var><span class="hyp-type"><b>: </b><span>EqDecision B</span></span></span><br><span><var>b</var><span class="hyp-type"><b>: </b><span>B</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">Symmetric (<span class="kr">Œª</span> <span class="nv">f</span> <span class="nv">g</span> : fsfun A b, f = g)</div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="bp">by</span> <span class="nb">intros</span> f g; <span class="nb">apply</span> <span class="nb">symmetry</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="FinSuppFn-v-chk7" style="display: none" type="checkbox"><label class="alectryon-input" for="FinSuppFn-v-chk7">-</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>A</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>EqDecision0</var><span class="hyp-type"><b>: </b><span>EqDecision A</span></span></span><br><span><var>B</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>EqDecision1</var><span class="hyp-type"><b>: </b><span>EqDecision B</span></span></span><br><span><var>b</var><span class="hyp-type"><b>: </b><span>B</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">Transitive (<span class="kr">Œª</span> <span class="nv">f</span> <span class="nv">g</span> : fsfun A b, f = g)</div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="bp">by</span> <span class="nb">intros</span> f g h; <span class="nb">apply</span> <span class="nb">transitivity</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Qed</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
</span><span class="alectryon-sentence"><input class="alectryon-toggle" id="FinSuppFn-v-chk8" style="display: none" type="checkbox"><label class="alectryon-input" for="FinSuppFn-v-chk8">#[export] <span class="kn">Instance</span> <span class="nf">fsfun_project_proper</span> :
  Proper ((‚â°) ==&gt; (=)) fsfun_project.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>A</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>EqDecision0</var><span class="hyp-type"><b>: </b><span>EqDecision A</span></span></span><br><span><var>B</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>EqDecision1</var><span class="hyp-type"><b>: </b><span>EqDecision B</span></span></span><br><span><var>b</var><span class="hyp-type"><b>: </b><span>B</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">Proper (equiv ==&gt; eq) fsfun_project</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="FinSuppFn-v-chk9" style="display: none" type="checkbox"><label class="alectryon-input" for="FinSuppFn-v-chk9"><span class="kn">Proof</span>.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>A</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>EqDecision0</var><span class="hyp-type"><b>: </b><span>EqDecision A</span></span></span><br><span><var>B</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>EqDecision1</var><span class="hyp-type"><b>: </b><span>EqDecision B</span></span></span><br><span><var>b</var><span class="hyp-type"><b>: </b><span>B</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">Proper (equiv ==&gt; eq) fsfun_project</div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="bp">by</span> <span class="nb">intros</span> f g Heqv; <span class="nb">inversion</span> Heqv.</span><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Qed</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
</span><span class="alectryon-sentence"><input class="alectryon-toggle" id="FinSuppFn-v-chka" style="display: none" type="checkbox"><label class="alectryon-input" for="FinSuppFn-v-chka">#[export] <span class="kn">Instance</span> <span class="nf">projT1_proper</span> :
  Proper ((‚â°@{fsfun A b}) ==&gt; (=)) projT1.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>A</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>EqDecision0</var><span class="hyp-type"><b>: </b><span>EqDecision A</span></span></span><br><span><var>B</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>EqDecision1</var><span class="hyp-type"><b>: </b><span>EqDecision B</span></span></span><br><span><var>b</var><span class="hyp-type"><b>: </b><span>B</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">Proper (equiv ==&gt; eq) projT1</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="FinSuppFn-v-chkb" style="display: none" type="checkbox"><label class="alectryon-input" for="FinSuppFn-v-chkb"><span class="kn">Proof</span>.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>A</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>EqDecision0</var><span class="hyp-type"><b>: </b><span>EqDecision A</span></span></span><br><span><var>B</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>EqDecision1</var><span class="hyp-type"><b>: </b><span>EqDecision B</span></span></span><br><span><var>b</var><span class="hyp-type"><b>: </b><span>B</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">Proper (equiv ==&gt; eq) projT1</div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="bp">by</span> <span class="nb">apply</span> fsfun_project_proper.</span><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Qed</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
</span><span class="alectryon-sentence"><input class="alectryon-toggle" id="FinSuppFn-v-chkc" style="display: none" type="checkbox"><label class="alectryon-input" for="FinSuppFn-v-chkc"><span class="kn">Lemma</span> <span class="nf">fsfun_equiv_unfold</span> (<span class="nv">f</span> <span class="nv">g</span> : fsfun A b) :
  f ‚â° g &lt;-&gt; fsfun_project f = fsfun_project g.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>A</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>EqDecision0</var><span class="hyp-type"><b>: </b><span>EqDecision A</span></span></span><br><span><var>B</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>EqDecision1</var><span class="hyp-type"><b>: </b><span>EqDecision B</span></span></span><br><span><var>b</var><span class="hyp-type"><b>: </b><span>B</span></span></span><br><span><var>f, g</var><span class="hyp-type"><b>: </b><span>fsfun A b</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">f ‚â° g ‚Üî f = g</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="FinSuppFn-v-chkd" style="display: none" type="checkbox"><label class="alectryon-input" for="FinSuppFn-v-chkd"><span class="kn">Proof</span>.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>A</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>EqDecision0</var><span class="hyp-type"><b>: </b><span>EqDecision A</span></span></span><br><span><var>B</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>EqDecision1</var><span class="hyp-type"><b>: </b><span>EqDecision B</span></span></span><br><span><var>b</var><span class="hyp-type"><b>: </b><span>B</span></span></span><br><span><var>f, g</var><span class="hyp-type"><b>: </b><span>fsfun A b</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">f ‚â° g ‚Üî f = g</div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="bp">done</span>.</span><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Qed</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
</span><span class="alectryon-sentence"><span class="alectryon-input">#[export] <span class="kn">Instance</span> <span class="nf">fsfun_has_fin_supp</span>
  (<span class="nv">f</span> : fsfun A b) : Finite (support b f) :=
    projT2 f.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
</span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Definition</span> <span class="nf">fin_supp</span> (<span class="nv">f</span> : fsfun A b) : list A :=
  map proj1_sig (enum (support b f)).</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
</span><span class="alectryon-sentence"><input class="alectryon-toggle" id="FinSuppFn-v-chke" style="display: none" type="checkbox"><label class="alectryon-input" for="FinSuppFn-v-chke"><span class="kn">Lemma</span> <span class="nf">elem_of_fin_supp</span> (<span class="nv">f</span> : fsfun A b) :
  <span class="kr">forall</span> (<span class="nv">a</span> : A), a ‚àà fin_supp f &lt;-&gt; f a &lt;&gt; b.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>A</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>EqDecision0</var><span class="hyp-type"><b>: </b><span>EqDecision A</span></span></span><br><span><var>B</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>EqDecision1</var><span class="hyp-type"><b>: </b><span>EqDecision B</span></span></span><br><span><var>b</var><span class="hyp-type"><b>: </b><span>B</span></span></span><br><span><var>f</var><span class="hyp-type"><b>: </b><span>fsfun A b</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="kr">‚àÄ</span> <span class="nv">a</span> : A, a ‚àà fin_supp f ‚Üî f a ‚â† b</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="FinSuppFn-v-chkf" style="display: none" type="checkbox"><label class="alectryon-input" for="FinSuppFn-v-chkf"><span class="kn">Proof</span>.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>A</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>EqDecision0</var><span class="hyp-type"><b>: </b><span>EqDecision A</span></span></span><br><span><var>B</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>EqDecision1</var><span class="hyp-type"><b>: </b><span>EqDecision B</span></span></span><br><span><var>b</var><span class="hyp-type"><b>: </b><span>B</span></span></span><br><span><var>f</var><span class="hyp-type"><b>: </b><span>fsfun A b</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="kr">‚àÄ</span> <span class="nv">a</span> : A, a ‚àà fin_supp f ‚Üî f a ‚â† b</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="FinSuppFn-v-chk10" style="display: none" type="checkbox"><label class="alectryon-input" for="FinSuppFn-v-chk10"><span class="nb">unfold</span> fin_supp.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>A</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>EqDecision0</var><span class="hyp-type"><b>: </b><span>EqDecision A</span></span></span><br><span><var>B</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>EqDecision1</var><span class="hyp-type"><b>: </b><span>EqDecision B</span></span></span><br><span><var>b</var><span class="hyp-type"><b>: </b><span>B</span></span></span><br><span><var>f</var><span class="hyp-type"><b>: </b><span>fsfun A b</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="kr">‚àÄ</span> <span class="nv">a</span> : A,
  a ‚àà map proj1_sig (enum (support b f)) ‚Üî f a ‚â† b</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="FinSuppFn-v-chk11" style="display: none" type="checkbox"><label class="alectryon-input" for="FinSuppFn-v-chk11"><span class="nb">split</span>; <span class="nb">rewrite</span> elem_of_list_fmap.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>A</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>EqDecision0</var><span class="hyp-type"><b>: </b><span>EqDecision A</span></span></span><br><span><var>B</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>EqDecision1</var><span class="hyp-type"><b>: </b><span>EqDecision B</span></span></span><br><span><var>b</var><span class="hyp-type"><b>: </b><span>B</span></span></span><br><span><var>f</var><span class="hyp-type"><b>: </b><span>fsfun A b</span></span></span><br><span><var>a</var><span class="hyp-type"><b>: </b><span>A</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">(<span class="kr">‚àÉ</span> <span class="nv">y</span> : {x : A | bool_decide (f x ‚â† b)},
   a = `y ‚àß y ‚àà enum (support b f)) ‚Üí f a ‚â† b</div></blockquote><div class="alectryon-extra-goals"><input class="alectryon-extra-goal-toggle" id="FinSuppFn-v-chk12" style="display: none" type="checkbox"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>A</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>EqDecision0</var><span class="hyp-type"><b>: </b><span>EqDecision A</span></span></span><br><span><var>B</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>EqDecision1</var><span class="hyp-type"><b>: </b><span>EqDecision B</span></span></span><br><span><var>b</var><span class="hyp-type"><b>: </b><span>B</span></span></span><br><span><var>f</var><span class="hyp-type"><b>: </b><span>fsfun A b</span></span></span><br><span><var>a</var><span class="hyp-type"><b>: </b><span>A</span></span></span><br></div><label class="goal-separator" for="FinSuppFn-v-chk12"><hr></label><div class="goal-conclusion">f a ‚â† b
‚Üí <span class="kr">‚àÉ</span> <span class="nv">y</span> : {x : A | bool_decide (f x ‚â† b)},
    a = `y ‚àß y ‚àà enum (support b f)</div></blockquote></div></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="FinSuppFn-v-chk13" style="display: none" type="checkbox"><label class="alectryon-input" for="FinSuppFn-v-chk13">-</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>A</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>EqDecision0</var><span class="hyp-type"><b>: </b><span>EqDecision A</span></span></span><br><span><var>B</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>EqDecision1</var><span class="hyp-type"><b>: </b><span>EqDecision B</span></span></span><br><span><var>b</var><span class="hyp-type"><b>: </b><span>B</span></span></span><br><span><var>f</var><span class="hyp-type"><b>: </b><span>fsfun A b</span></span></span><br><span><var>a</var><span class="hyp-type"><b>: </b><span>A</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">(<span class="kr">‚àÉ</span> <span class="nv">y</span> : {x : A | bool_decide (f x ‚â† b)},
   a = `y ‚àß y ‚àà enum (support b f)) ‚Üí f a ‚â† b</div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="FinSuppFn-v-chk14" style="display: none" type="checkbox"><label class="alectryon-input" for="FinSuppFn-v-chk14"><span class="nb">intros</span> (asupp &amp; -&gt; &amp; _).</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>A</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>EqDecision0</var><span class="hyp-type"><b>: </b><span>EqDecision A</span></span></span><br><span><var>B</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>EqDecision1</var><span class="hyp-type"><b>: </b><span>EqDecision B</span></span></span><br><span><var>b</var><span class="hyp-type"><b>: </b><span>B</span></span></span><br><span><var>f</var><span class="hyp-type"><b>: </b><span>fsfun A b</span></span></span><br><span><var>asupp</var><span class="hyp-type"><b>: </b><span>{x : A | bool_decide (f x ‚â† b)}</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">f (`asupp) ‚â† b</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><span class="alectryon-input"><span class="bp">by</span> destruct_dec_sig asupp _a H_a Heq; <span class="nb">subst</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="FinSuppFn-v-chk15" style="display: none" type="checkbox"><label class="alectryon-input" for="FinSuppFn-v-chk15">-</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>A</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>EqDecision0</var><span class="hyp-type"><b>: </b><span>EqDecision A</span></span></span><br><span><var>B</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>EqDecision1</var><span class="hyp-type"><b>: </b><span>EqDecision B</span></span></span><br><span><var>b</var><span class="hyp-type"><b>: </b><span>B</span></span></span><br><span><var>f</var><span class="hyp-type"><b>: </b><span>fsfun A b</span></span></span><br><span><var>a</var><span class="hyp-type"><b>: </b><span>A</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">f a ‚â† b
‚Üí <span class="kr">‚àÉ</span> <span class="nv">y</span> : {x : A | bool_decide (f x ‚â† b)},
    a = `y ‚àß y ‚àà enum (support b f)</div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="FinSuppFn-v-chk16" style="display: none" type="checkbox"><label class="alectryon-input" for="FinSuppFn-v-chk16"><span class="nb">intros</span> Ha.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>A</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>EqDecision0</var><span class="hyp-type"><b>: </b><span>EqDecision A</span></span></span><br><span><var>B</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>EqDecision1</var><span class="hyp-type"><b>: </b><span>EqDecision B</span></span></span><br><span><var>b</var><span class="hyp-type"><b>: </b><span>B</span></span></span><br><span><var>f</var><span class="hyp-type"><b>: </b><span>fsfun A b</span></span></span><br><span><var>a</var><span class="hyp-type"><b>: </b><span>A</span></span></span><br><span><var>Ha</var><span class="hyp-type"><b>: </b><span>f a ‚â† b</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="kr">‚àÉ</span> <span class="nv">y</span> : {x : A | bool_decide (f x ‚â† b)},
  a = `y ‚àß y ‚àà enum (support b f)</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><span class="alectryon-input"><span class="bp">by</span> <span class="kr">exists</span> (<span class="nv">dexist</span> <span class="nv">a</span> <span class="nv">Ha</span>); <span class="nb">split</span>; [| <span class="nb">apply</span> elem_of_enum].</span><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Qed</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
</span><span class="alectryon-sentence"><input class="alectryon-toggle" id="FinSuppFn-v-chk17" style="display: none" type="checkbox"><label class="alectryon-input" for="FinSuppFn-v-chk17"><span class="kn">Lemma</span> <span class="nf">not_elem_of_fin_supp</span> (<span class="nv">f</span> : fsfun A b) :
  <span class="kr">forall</span> (<span class="nv">a</span> : A), a ‚àâ fin_supp f &lt;-&gt; f a = b.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>A</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>EqDecision0</var><span class="hyp-type"><b>: </b><span>EqDecision A</span></span></span><br><span><var>B</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>EqDecision1</var><span class="hyp-type"><b>: </b><span>EqDecision B</span></span></span><br><span><var>b</var><span class="hyp-type"><b>: </b><span>B</span></span></span><br><span><var>f</var><span class="hyp-type"><b>: </b><span>fsfun A b</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="kr">‚àÄ</span> <span class="nv">a</span> : A, a ‚àâ fin_supp f ‚Üî f a = b</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="FinSuppFn-v-chk18" style="display: none" type="checkbox"><label class="alectryon-input" for="FinSuppFn-v-chk18"><span class="kn">Proof</span>.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>A</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>EqDecision0</var><span class="hyp-type"><b>: </b><span>EqDecision A</span></span></span><br><span><var>B</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>EqDecision1</var><span class="hyp-type"><b>: </b><span>EqDecision B</span></span></span><br><span><var>b</var><span class="hyp-type"><b>: </b><span>B</span></span></span><br><span><var>f</var><span class="hyp-type"><b>: </b><span>fsfun A b</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="kr">‚àÄ</span> <span class="nv">a</span> : A, a ‚àâ fin_supp f ‚Üî f a = b</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="FinSuppFn-v-chk19" style="display: none" type="checkbox"><label class="alectryon-input" for="FinSuppFn-v-chk19"><span class="nb">intros</span> a; <span class="nb">rewrite</span> elem_of_fin_supp.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>A</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>EqDecision0</var><span class="hyp-type"><b>: </b><span>EqDecision A</span></span></span><br><span><var>B</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>EqDecision1</var><span class="hyp-type"><b>: </b><span>EqDecision B</span></span></span><br><span><var>b</var><span class="hyp-type"><b>: </b><span>B</span></span></span><br><span><var>f</var><span class="hyp-type"><b>: </b><span>fsfun A b</span></span></span><br><span><var>a</var><span class="hyp-type"><b>: </b><span>A</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">¬¨ f a ‚â† b ‚Üî f a = b</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><span class="alectryon-input"><span class="bp">by</span> <span class="nb">destruct</span> (decide (f a = b)); itauto.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Qed</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
</span><span class="alectryon-sentence"><input class="alectryon-toggle" id="FinSuppFn-v-chk1a" style="display: none" type="checkbox"><label class="alectryon-input" for="FinSuppFn-v-chk1a"><span class="kn">Lemma</span> <span class="nf">fin_supp_NoDup</span> (<span class="nv">f</span> : fsfun A b) : NoDup (fin_supp f).</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>A</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>EqDecision0</var><span class="hyp-type"><b>: </b><span>EqDecision A</span></span></span><br><span><var>B</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>EqDecision1</var><span class="hyp-type"><b>: </b><span>EqDecision B</span></span></span><br><span><var>b</var><span class="hyp-type"><b>: </b><span>B</span></span></span><br><span><var>f</var><span class="hyp-type"><b>: </b><span>fsfun A b</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">NoDup (fin_supp f)</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="FinSuppFn-v-chk1b" style="display: none" type="checkbox"><label class="alectryon-input" for="FinSuppFn-v-chk1b"><span class="kn">Proof</span>.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>A</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>EqDecision0</var><span class="hyp-type"><b>: </b><span>EqDecision A</span></span></span><br><span><var>B</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>EqDecision1</var><span class="hyp-type"><b>: </b><span>EqDecision B</span></span></span><br><span><var>b</var><span class="hyp-type"><b>: </b><span>B</span></span></span><br><span><var>f</var><span class="hyp-type"><b>: </b><span>fsfun A b</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">NoDup (fin_supp f)</div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="bp">by</span> <span class="nb">apply</span> dsig_NoDup_map, NoDup_enum.</span><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Qed</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
</span><span class="alectryon-sentence"><input class="alectryon-toggle" id="FinSuppFn-v-chk1c" style="display: none" type="checkbox"><label class="alectryon-input" for="FinSuppFn-v-chk1c">#[export] <span class="kn">Instance</span> <span class="nf">fin_supp_proper</span> : Proper ((‚â°) ==&gt; (‚â°‚Çö)) fin_supp.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>A</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>EqDecision0</var><span class="hyp-type"><b>: </b><span>EqDecision A</span></span></span><br><span><var>B</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>EqDecision1</var><span class="hyp-type"><b>: </b><span>EqDecision B</span></span></span><br><span><var>b</var><span class="hyp-type"><b>: </b><span>B</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">Proper (equiv ==&gt; Permutation) fin_supp</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="FinSuppFn-v-chk1d" style="display: none" type="checkbox"><label class="alectryon-input" for="FinSuppFn-v-chk1d"><span class="kn">Proof</span>.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>A</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>EqDecision0</var><span class="hyp-type"><b>: </b><span>EqDecision A</span></span></span><br><span><var>B</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>EqDecision1</var><span class="hyp-type"><b>: </b><span>EqDecision B</span></span></span><br><span><var>b</var><span class="hyp-type"><b>: </b><span>B</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">Proper (equiv ==&gt; Permutation) fin_supp</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="FinSuppFn-v-chk1e" style="display: none" type="checkbox"><label class="alectryon-input" for="FinSuppFn-v-chk1e"><span class="nb">intros</span> f g Heq.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>A</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>EqDecision0</var><span class="hyp-type"><b>: </b><span>EqDecision A</span></span></span><br><span><var>B</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>EqDecision1</var><span class="hyp-type"><b>: </b><span>EqDecision B</span></span></span><br><span><var>b</var><span class="hyp-type"><b>: </b><span>B</span></span></span><br><span><var>f, g</var><span class="hyp-type"><b>: </b><span>fsfun A b</span></span></span><br><span><var>Heq</var><span class="hyp-type"><b>: </b><span>f ‚â° g</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">fin_supp f ‚â°‚Çö fin_supp g</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="FinSuppFn-v-chk1f" style="display: none" type="checkbox"><label class="alectryon-input" for="FinSuppFn-v-chk1f"><span class="nb">apply</span> NoDup_Permutation; [<span class="bp">by</span> <span class="nb">apply</span> fin_supp_NoDup.. |].</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>A</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>EqDecision0</var><span class="hyp-type"><b>: </b><span>EqDecision A</span></span></span><br><span><var>B</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>EqDecision1</var><span class="hyp-type"><b>: </b><span>EqDecision B</span></span></span><br><span><var>b</var><span class="hyp-type"><b>: </b><span>B</span></span></span><br><span><var>f, g</var><span class="hyp-type"><b>: </b><span>fsfun A b</span></span></span><br><span><var>Heq</var><span class="hyp-type"><b>: </b><span>f ‚â° g</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="kr">‚àÄ</span> <span class="nv">x</span> : A, x ‚àà fin_supp f ‚Üî x ‚àà fin_supp g</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><span class="alectryon-input"><span class="bp">by</span> <span class="nb">intro</span>; <span class="nb">rewrite</span> !elem_of_fin_supp, Heq.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Qed</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
</span><span class="alectryon-sentence"><input class="alectryon-toggle" id="FinSuppFn-v-chk20" style="display: none" type="checkbox"><label class="alectryon-input" for="FinSuppFn-v-chk20">#[export] <span class="kn">Instance</span> <span class="nf">fsfun_eq_dec</span> : RelDecision (‚â°@{fsfun A b}).</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>A</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>EqDecision0</var><span class="hyp-type"><b>: </b><span>EqDecision A</span></span></span><br><span><var>B</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>EqDecision1</var><span class="hyp-type"><b>: </b><span>EqDecision B</span></span></span><br><span><var>b</var><span class="hyp-type"><b>: </b><span>B</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">RelDecision equiv</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="FinSuppFn-v-chk21" style="display: none" type="checkbox"><label class="alectryon-input" for="FinSuppFn-v-chk21"><span class="kn">Proof</span>.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>A</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>EqDecision0</var><span class="hyp-type"><b>: </b><span>EqDecision A</span></span></span><br><span><var>B</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>EqDecision1</var><span class="hyp-type"><b>: </b><span>EqDecision B</span></span></span><br><span><var>b</var><span class="hyp-type"><b>: </b><span>B</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">RelDecision equiv</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="FinSuppFn-v-chk22" style="display: none" type="checkbox"><label class="alectryon-input" for="FinSuppFn-v-chk22"><span class="nb">intros</span> f g.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>A</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>EqDecision0</var><span class="hyp-type"><b>: </b><span>EqDecision A</span></span></span><br><span><var>B</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>EqDecision1</var><span class="hyp-type"><b>: </b><span>EqDecision B</span></span></span><br><span><var>b</var><span class="hyp-type"><b>: </b><span>B</span></span></span><br><span><var>f, g</var><span class="hyp-type"><b>: </b><span>fsfun A b</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">Decision (f ‚â° g)</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="FinSuppFn-v-chk23" style="display: none" type="checkbox"><label class="alectryon-input" for="FinSuppFn-v-chk23"><span class="nb">destruct</span> (@finset_equiv_dec A (listset A) _ _ _ _ _ _ _ _ _
    (list_to_set (fin_supp f)) (list_to_set (fin_supp g))) <span class="kr">as</span> [Heqv | Hneqv]; <span class="nb">cycle</span> <span class="mi">1</span>.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>A</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>EqDecision0</var><span class="hyp-type"><b>: </b><span>EqDecision A</span></span></span><br><span><var>B</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>EqDecision1</var><span class="hyp-type"><b>: </b><span>EqDecision B</span></span></span><br><span><var>b</var><span class="hyp-type"><b>: </b><span>B</span></span></span><br><span><var>f, g</var><span class="hyp-type"><b>: </b><span>fsfun A b</span></span></span><br><span><var>Hneqv</var><span class="hyp-type"><b>: </b><span>list_to_set (fin_supp f)
‚â¢ list_to_set (fin_supp g)</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">Decision (f ‚â° g)</div></blockquote><div class="alectryon-extra-goals"><input class="alectryon-extra-goal-toggle" id="FinSuppFn-v-chk24" style="display: none" type="checkbox"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>A</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>EqDecision0</var><span class="hyp-type"><b>: </b><span>EqDecision A</span></span></span><br><span><var>B</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>EqDecision1</var><span class="hyp-type"><b>: </b><span>EqDecision B</span></span></span><br><span><var>b</var><span class="hyp-type"><b>: </b><span>B</span></span></span><br><span><var>f, g</var><span class="hyp-type"><b>: </b><span>fsfun A b</span></span></span><br><span><var>Heqv</var><span class="hyp-type"><b>: </b><span>list_to_set (fin_supp f)
‚â° list_to_set (fin_supp g)</span></span></span><br></div><label class="goal-separator" for="FinSuppFn-v-chk24"><hr></label><div class="goal-conclusion">Decision (f ‚â° g)</div></blockquote></div></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="FinSuppFn-v-chk25" style="display: none" type="checkbox"><label class="alectryon-input" for="FinSuppFn-v-chk25">-</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>A</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>EqDecision0</var><span class="hyp-type"><b>: </b><span>EqDecision A</span></span></span><br><span><var>B</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>EqDecision1</var><span class="hyp-type"><b>: </b><span>EqDecision B</span></span></span><br><span><var>b</var><span class="hyp-type"><b>: </b><span>B</span></span></span><br><span><var>f, g</var><span class="hyp-type"><b>: </b><span>fsfun A b</span></span></span><br><span><var>Hneqv</var><span class="hyp-type"><b>: </b><span>list_to_set (fin_supp f)
‚â¢ list_to_set (fin_supp g)</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">Decision (f ‚â° g)</div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="FinSuppFn-v-chk26" style="display: none" type="checkbox"><label class="alectryon-input" for="FinSuppFn-v-chk26"><span class="nb">right</span>; <span class="nb">intros</span> Heqv.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>A</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>EqDecision0</var><span class="hyp-type"><b>: </b><span>EqDecision A</span></span></span><br><span><var>B</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>EqDecision1</var><span class="hyp-type"><b>: </b><span>EqDecision B</span></span></span><br><span><var>b</var><span class="hyp-type"><b>: </b><span>B</span></span></span><br><span><var>f, g</var><span class="hyp-type"><b>: </b><span>fsfun A b</span></span></span><br><span><var>Hneqv</var><span class="hyp-type"><b>: </b><span>list_to_set (fin_supp f)
‚â¢ list_to_set (fin_supp g)</span></span></span><br><span><var>Heqv</var><span class="hyp-type"><b>: </b><span>f ‚â° g</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="kt">False</span></div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><span class="alectryon-input"><span class="bp">by</span> <span class="nb">rewrite</span> Heqv <span class="kr">in</span> Hneqv.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="FinSuppFn-v-chk27" style="display: none" type="checkbox"><label class="alectryon-input" for="FinSuppFn-v-chk27">-</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>A</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>EqDecision0</var><span class="hyp-type"><b>: </b><span>EqDecision A</span></span></span><br><span><var>B</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>EqDecision1</var><span class="hyp-type"><b>: </b><span>EqDecision B</span></span></span><br><span><var>b</var><span class="hyp-type"><b>: </b><span>B</span></span></span><br><span><var>f, g</var><span class="hyp-type"><b>: </b><span>fsfun A b</span></span></span><br><span><var>Heqv</var><span class="hyp-type"><b>: </b><span>list_to_set (fin_supp f)
‚â° list_to_set (fin_supp g)</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">Decision (f ‚â° g)</div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="FinSuppFn-v-chk28" style="display: none" type="checkbox"><label class="alectryon-input" for="FinSuppFn-v-chk28"><span class="nb">destruct</span> (decide (set_Forall (<span class="kr">fun</span> <span class="nv">a</span> =&gt; fsfun_project f a = fsfun_project g a)
      (list_to_set (C := listset A) (fin_supp f))))
      <span class="kr">as</span> [Hall | Hall]; [| <span class="bp">by</span> <span class="nb">right</span>; <span class="bp">contradict</span> Hall; <span class="nb">rewrite</span> Hall].</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>A</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>EqDecision0</var><span class="hyp-type"><b>: </b><span>EqDecision A</span></span></span><br><span><var>B</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>EqDecision1</var><span class="hyp-type"><b>: </b><span>EqDecision B</span></span></span><br><span><var>b</var><span class="hyp-type"><b>: </b><span>B</span></span></span><br><span><var>f, g</var><span class="hyp-type"><b>: </b><span>fsfun A b</span></span></span><br><span><var>Heqv</var><span class="hyp-type"><b>: </b><span>list_to_set (fin_supp f)
‚â° list_to_set (fin_supp g)</span></span></span><br><span><var>Hall</var><span class="hyp-type"><b>: </b><span>set_Forall (<span class="kr">Œª</span> <span class="nv">a</span> : A, f a = g a)
  (list_to_set (fin_supp f))</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">Decision (f ‚â° g)</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="FinSuppFn-v-chk29" style="display: none" type="checkbox"><label class="alectryon-input" for="FinSuppFn-v-chk29"><span class="nb">left</span>; <span class="nb">apply</span> fsfun_equiv_unfold; extensionality a.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>A</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>EqDecision0</var><span class="hyp-type"><b>: </b><span>EqDecision A</span></span></span><br><span><var>B</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>EqDecision1</var><span class="hyp-type"><b>: </b><span>EqDecision B</span></span></span><br><span><var>b</var><span class="hyp-type"><b>: </b><span>B</span></span></span><br><span><var>f, g</var><span class="hyp-type"><b>: </b><span>fsfun A b</span></span></span><br><span><var>Heqv</var><span class="hyp-type"><b>: </b><span>list_to_set (fin_supp f)
‚â° list_to_set (fin_supp g)</span></span></span><br><span><var>Hall</var><span class="hyp-type"><b>: </b><span>set_Forall (<span class="kr">Œª</span> <span class="nv">a</span> : A, f a = g a)
  (list_to_set (fin_supp f))</span></span></span><br><span><var>a</var><span class="hyp-type"><b>: </b><span>A</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">f a = g a</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="FinSuppFn-v-chk2a" style="display: none" type="checkbox"><label class="alectryon-input" for="FinSuppFn-v-chk2a"><span class="nb">destruct</span> (decide (a ‚àà fin_supp f)) <span class="kr">as</span> [| Hf]; [<span class="bp">by</span> <span class="nb">apply</span> Hall, elem_of_list_to_set |].</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>A</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>EqDecision0</var><span class="hyp-type"><b>: </b><span>EqDecision A</span></span></span><br><span><var>B</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>EqDecision1</var><span class="hyp-type"><b>: </b><span>EqDecision B</span></span></span><br><span><var>b</var><span class="hyp-type"><b>: </b><span>B</span></span></span><br><span><var>f, g</var><span class="hyp-type"><b>: </b><span>fsfun A b</span></span></span><br><span><var>Heqv</var><span class="hyp-type"><b>: </b><span>list_to_set (fin_supp f)
‚â° list_to_set (fin_supp g)</span></span></span><br><span><var>Hall</var><span class="hyp-type"><b>: </b><span>set_Forall (<span class="kr">Œª</span> <span class="nv">a</span> : A, f a = g a)
  (list_to_set (fin_supp f))</span></span></span><br><span><var>a</var><span class="hyp-type"><b>: </b><span>A</span></span></span><br><span><var>Hf</var><span class="hyp-type"><b>: </b><span>a ‚àâ fin_supp f</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">f a = g a</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="FinSuppFn-v-chk2b" style="display: none" type="checkbox"><label class="alectryon-input" for="FinSuppFn-v-chk2b"><span class="nb">destruct</span> (decide (a ‚àà fin_supp g)) <span class="kr">as</span> [| Hg]; [<span class="bp">by</span> <span class="nb">apply</span> Hall; <span class="nb">rewrite</span> Heqv, elem_of_list_to_set |].</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>A</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>EqDecision0</var><span class="hyp-type"><b>: </b><span>EqDecision A</span></span></span><br><span><var>B</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>EqDecision1</var><span class="hyp-type"><b>: </b><span>EqDecision B</span></span></span><br><span><var>b</var><span class="hyp-type"><b>: </b><span>B</span></span></span><br><span><var>f, g</var><span class="hyp-type"><b>: </b><span>fsfun A b</span></span></span><br><span><var>Heqv</var><span class="hyp-type"><b>: </b><span>list_to_set (fin_supp f)
‚â° list_to_set (fin_supp g)</span></span></span><br><span><var>Hall</var><span class="hyp-type"><b>: </b><span>set_Forall (<span class="kr">Œª</span> <span class="nv">a</span> : A, f a = g a)
  (list_to_set (fin_supp f))</span></span></span><br><span><var>a</var><span class="hyp-type"><b>: </b><span>A</span></span></span><br><span><var>Hf</var><span class="hyp-type"><b>: </b><span>a ‚àâ fin_supp f</span></span></span><br><span><var>Hg</var><span class="hyp-type"><b>: </b><span>a ‚àâ fin_supp g</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">f a = g a</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="FinSuppFn-v-chk2c" style="display: none" type="checkbox"><label class="alectryon-input" for="FinSuppFn-v-chk2c"><span class="nb">apply</span> not_elem_of_fin_supp <span class="kr">in</span> Hf, Hg.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>A</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>EqDecision0</var><span class="hyp-type"><b>: </b><span>EqDecision A</span></span></span><br><span><var>B</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>EqDecision1</var><span class="hyp-type"><b>: </b><span>EqDecision B</span></span></span><br><span><var>b</var><span class="hyp-type"><b>: </b><span>B</span></span></span><br><span><var>f, g</var><span class="hyp-type"><b>: </b><span>fsfun A b</span></span></span><br><span><var>Heqv</var><span class="hyp-type"><b>: </b><span>list_to_set (fin_supp f)
‚â° list_to_set (fin_supp g)</span></span></span><br><span><var>Hall</var><span class="hyp-type"><b>: </b><span>set_Forall (<span class="kr">Œª</span> <span class="nv">a</span> : A, f a = g a)
  (list_to_set (fin_supp f))</span></span></span><br><span><var>a</var><span class="hyp-type"><b>: </b><span>A</span></span></span><br><span><var>Hf</var><span class="hyp-type"><b>: </b><span>f a = b</span></span></span><br><span><var>Hg</var><span class="hyp-type"><b>: </b><span>g a = b</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">f a = g a</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><span class="alectryon-input"><span class="bp">by</span> <span class="nb">transitivity</span> b.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Qed</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
</span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Program Definition</span> <span class="nf">empty_fsfun</span> : fsfun A b :=
  existT (const b) {| enum := [] |}.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="FinSuppFn-v-chk2d" style="display: none" type="checkbox"><label class="alectryon-input" for="FinSuppFn-v-chk2d"><span class="kn">Next Obligation</span>.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>A</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>EqDecision0</var><span class="hyp-type"><b>: </b><span>EqDecision A</span></span></span><br><span><var>B</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>EqDecision1</var><span class="hyp-type"><b>: </b><span>EqDecision B</span></span></span><br><span><var>b</var><span class="hyp-type"><b>: </b><span>B</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">NoDup []</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="FinSuppFn-v-chk2e" style="display: none" type="checkbox"><label class="alectryon-input" for="FinSuppFn-v-chk2e"><span class="kn">Proof</span>.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>A</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>EqDecision0</var><span class="hyp-type"><b>: </b><span>EqDecision A</span></span></span><br><span><var>B</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>EqDecision1</var><span class="hyp-type"><b>: </b><span>EqDecision B</span></span></span><br><span><var>b</var><span class="hyp-type"><b>: </b><span>B</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">NoDup []</div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="bp">by</span> <span class="nb">constructor</span>.</span><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Qed</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="FinSuppFn-v-chk2f" style="display: none" type="checkbox"><label class="alectryon-input" for="FinSuppFn-v-chk2f"><span class="kn">Next Obligation</span>.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>A</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>EqDecision0</var><span class="hyp-type"><b>: </b><span>EqDecision A</span></span></span><br><span><var>B</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>EqDecision1</var><span class="hyp-type"><b>: </b><span>EqDecision B</span></span></span><br><span><var>b</var><span class="hyp-type"><b>: </b><span>B</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="kr">‚àÄ</span> <span class="nv">x</span> : support b (const b), x ‚àà []</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="FinSuppFn-v-chk30" style="display: none" type="checkbox"><label class="alectryon-input" for="FinSuppFn-v-chk30"><span class="kn">Proof</span>.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>A</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>EqDecision0</var><span class="hyp-type"><b>: </b><span>EqDecision A</span></span></span><br><span><var>B</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>EqDecision1</var><span class="hyp-type"><b>: </b><span>EqDecision B</span></span></span><br><span><var>b</var><span class="hyp-type"><b>: </b><span>B</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="kr">‚àÄ</span> <span class="nv">x</span> : support b (const b), x ‚àà []</div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="bp">by</span> <span class="nb">intros</span>; destruct_dec_sig x a Ha Heq; <span class="bp">contradiction</span> Ha.</span><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Qed</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
</span><span class="alectryon-sentence"><input class="alectryon-toggle" id="FinSuppFn-v-chk31" style="display: none" type="checkbox"><label class="alectryon-input" for="FinSuppFn-v-chk31"><span class="kn">Lemma</span> <span class="nf">empty_fsfun_supp</span> : fin_supp empty_fsfun = [].</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>A</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>EqDecision0</var><span class="hyp-type"><b>: </b><span>EqDecision A</span></span></span><br><span><var>B</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>EqDecision1</var><span class="hyp-type"><b>: </b><span>EqDecision B</span></span></span><br><span><var>b</var><span class="hyp-type"><b>: </b><span>B</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">fin_supp empty_fsfun = []</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="FinSuppFn-v-chk32" style="display: none" type="checkbox"><label class="alectryon-input" for="FinSuppFn-v-chk32"><span class="kn">Proof</span>.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>A</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>EqDecision0</var><span class="hyp-type"><b>: </b><span>EqDecision A</span></span></span><br><span><var>B</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>EqDecision1</var><span class="hyp-type"><b>: </b><span>EqDecision B</span></span></span><br><span><var>b</var><span class="hyp-type"><b>: </b><span>B</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">fin_supp empty_fsfun = []</div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="bp">done</span>.</span><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Qed</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
</span><span class="alectryon-sentence"><input class="alectryon-toggle" id="FinSuppFn-v-chk33" style="display: none" type="checkbox"><label class="alectryon-input" for="FinSuppFn-v-chk33"><span class="kn">Lemma</span> <span class="nf">empty_fsfun_supp_inv</span> (<span class="nv">f</span> : fsfun A b) :
  fin_supp f = [] -&gt; f ‚â° empty_fsfun.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>A</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>EqDecision0</var><span class="hyp-type"><b>: </b><span>EqDecision A</span></span></span><br><span><var>B</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>EqDecision1</var><span class="hyp-type"><b>: </b><span>EqDecision B</span></span></span><br><span><var>b</var><span class="hyp-type"><b>: </b><span>B</span></span></span><br><span><var>f</var><span class="hyp-type"><b>: </b><span>fsfun A b</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">fin_supp f = [] ‚Üí f ‚â° empty_fsfun</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="FinSuppFn-v-chk34" style="display: none" type="checkbox"><label class="alectryon-input" for="FinSuppFn-v-chk34"><span class="kn">Proof</span>.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>A</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>EqDecision0</var><span class="hyp-type"><b>: </b><span>EqDecision A</span></span></span><br><span><var>B</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>EqDecision1</var><span class="hyp-type"><b>: </b><span>EqDecision B</span></span></span><br><span><var>b</var><span class="hyp-type"><b>: </b><span>B</span></span></span><br><span><var>f</var><span class="hyp-type"><b>: </b><span>fsfun A b</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">fin_supp f = [] ‚Üí f ‚â° empty_fsfun</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="FinSuppFn-v-chk35" style="display: none" type="checkbox"><label class="alectryon-input" for="FinSuppFn-v-chk35"><span class="nb">intros</span> Hf; <span class="nb">apply</span> fsfun_equiv_unfold; extensionality a; <span class="nb">cbn</span>.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>A</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>EqDecision0</var><span class="hyp-type"><b>: </b><span>EqDecision A</span></span></span><br><span><var>B</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>EqDecision1</var><span class="hyp-type"><b>: </b><span>EqDecision B</span></span></span><br><span><var>b</var><span class="hyp-type"><b>: </b><span>B</span></span></span><br><span><var>f</var><span class="hyp-type"><b>: </b><span>fsfun A b</span></span></span><br><span><var>Hf</var><span class="hyp-type"><b>: </b><span>fin_supp f = []</span></span></span><br><span><var>a</var><span class="hyp-type"><b>: </b><span>A</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">f a = empty_fsfun a</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="FinSuppFn-v-chk36" style="display: none" type="checkbox"><label class="alectryon-input" for="FinSuppFn-v-chk36"><span class="nb">eapply</span> not_elem_of_fin_supp.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>A</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>EqDecision0</var><span class="hyp-type"><b>: </b><span>EqDecision A</span></span></span><br><span><var>B</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>EqDecision1</var><span class="hyp-type"><b>: </b><span>EqDecision B</span></span></span><br><span><var>b</var><span class="hyp-type"><b>: </b><span>B</span></span></span><br><span><var>f</var><span class="hyp-type"><b>: </b><span>fsfun A b</span></span></span><br><span><var>Hf</var><span class="hyp-type"><b>: </b><span>fin_supp f = []</span></span></span><br><span><var>a</var><span class="hyp-type"><b>: </b><span>A</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">a ‚àâ fin_supp f</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="FinSuppFn-v-chk37" style="display: none" type="checkbox"><label class="alectryon-input" for="FinSuppFn-v-chk37"><span class="nb">rewrite</span> Hf.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>A</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>EqDecision0</var><span class="hyp-type"><b>: </b><span>EqDecision A</span></span></span><br><span><var>B</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>EqDecision1</var><span class="hyp-type"><b>: </b><span>EqDecision B</span></span></span><br><span><var>b</var><span class="hyp-type"><b>: </b><span>B</span></span></span><br><span><var>f</var><span class="hyp-type"><b>: </b><span>fsfun A b</span></span></span><br><span><var>Hf</var><span class="hyp-type"><b>: </b><span>fin_supp f = []</span></span></span><br><span><var>a</var><span class="hyp-type"><b>: </b><span>A</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">a ‚àâ []</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><span class="alectryon-input"><span class="bp">by</span> <span class="nb">apply</span> not_elem_of_nil.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Qed</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
</span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Definition</span> <span class="nf">update_supp</span> (<span class="nv">f</span> : fsfun A b) (<span class="nv">n</span> : A) (<span class="nv">b&#39;</span> : B) : listset A :=
  <span class="kr">if</span> decide (b&#39; = b)
  <span class="kr">then</span> list_to_set (fin_supp f) ‚àñ {[n]}
  <span class="kr">else</span> {[n]} ‚à™ list_to_set (fin_supp f).</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
</span><span class="alectryon-sentence"><input class="alectryon-toggle" id="FinSuppFn-v-chk38" style="display: none" type="checkbox"><label class="alectryon-input" for="FinSuppFn-v-chk38"><span class="kn">Lemma</span> <span class="nf">update_supp_all</span> (<span class="nv">f</span> : fsfun A b) (<span class="nv">n</span> : A) (<span class="nv">b&#39;</span> : B) :
  Forall (<span class="kr">fun</span> <span class="nv">a</span> =&gt; update f n b&#39; a &lt;&gt; b) (elements (update_supp f n b&#39;)).</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>A</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>EqDecision0</var><span class="hyp-type"><b>: </b><span>EqDecision A</span></span></span><br><span><var>B</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>EqDecision1</var><span class="hyp-type"><b>: </b><span>EqDecision B</span></span></span><br><span><var>b</var><span class="hyp-type"><b>: </b><span>B</span></span></span><br><span><var>f</var><span class="hyp-type"><b>: </b><span>fsfun A b</span></span></span><br><span><var>n</var><span class="hyp-type"><b>: </b><span>A</span></span></span><br><span><var>b'</var><span class="hyp-type"><b>: </b><span>B</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">Forall (<span class="kr">Œª</span> <span class="nv">a</span> : A, update f n b&#39; a ‚â† b)
  (elements (update_supp f n b&#39;))</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="FinSuppFn-v-chk39" style="display: none" type="checkbox"><label class="alectryon-input" for="FinSuppFn-v-chk39"><span class="kn">Proof</span>.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>A</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>EqDecision0</var><span class="hyp-type"><b>: </b><span>EqDecision A</span></span></span><br><span><var>B</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>EqDecision1</var><span class="hyp-type"><b>: </b><span>EqDecision B</span></span></span><br><span><var>b</var><span class="hyp-type"><b>: </b><span>B</span></span></span><br><span><var>f</var><span class="hyp-type"><b>: </b><span>fsfun A b</span></span></span><br><span><var>n</var><span class="hyp-type"><b>: </b><span>A</span></span></span><br><span><var>b'</var><span class="hyp-type"><b>: </b><span>B</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">Forall (<span class="kr">Œª</span> <span class="nv">a</span> : A, update f n b&#39; a ‚â† b)
  (elements (update_supp f n b&#39;))</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="FinSuppFn-v-chk3a" style="display: none" type="checkbox"><label class="alectryon-input" for="FinSuppFn-v-chk3a"><span class="nb">unfold</span> update_supp.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>A</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>EqDecision0</var><span class="hyp-type"><b>: </b><span>EqDecision A</span></span></span><br><span><var>B</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>EqDecision1</var><span class="hyp-type"><b>: </b><span>EqDecision B</span></span></span><br><span><var>b</var><span class="hyp-type"><b>: </b><span>B</span></span></span><br><span><var>f</var><span class="hyp-type"><b>: </b><span>fsfun A b</span></span></span><br><span><var>n</var><span class="hyp-type"><b>: </b><span>A</span></span></span><br><span><var>b'</var><span class="hyp-type"><b>: </b><span>B</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">Forall (<span class="kr">Œª</span> <span class="nv">a</span> : A, update f n b&#39; a ‚â† b)
  (elements
     (<span class="kr">if</span> decide (b&#39; = b)
      <span class="kr">then</span> list_to_set (fin_supp f) ‚àñ {[n]}
      <span class="kr">else</span> {[n]} ‚à™ list_to_set (fin_supp f)))</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="FinSuppFn-v-chk3b" style="display: none" type="checkbox"><label class="alectryon-input" for="FinSuppFn-v-chk3b"><span class="nb">apply</span> Forall_forall; <span class="nb">intros</span> a.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>A</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>EqDecision0</var><span class="hyp-type"><b>: </b><span>EqDecision A</span></span></span><br><span><var>B</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>EqDecision1</var><span class="hyp-type"><b>: </b><span>EqDecision B</span></span></span><br><span><var>b</var><span class="hyp-type"><b>: </b><span>B</span></span></span><br><span><var>f</var><span class="hyp-type"><b>: </b><span>fsfun A b</span></span></span><br><span><var>n</var><span class="hyp-type"><b>: </b><span>A</span></span></span><br><span><var>b'</var><span class="hyp-type"><b>: </b><span>B</span></span></span><br><span><var>a</var><span class="hyp-type"><b>: </b><span>A</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">a
‚àà elements
    (<span class="kr">if</span> decide (b&#39; = b)
     <span class="kr">then</span> list_to_set (fin_supp f) ‚àñ {[n]}
     <span class="kr">else</span> {[n]} ‚à™ list_to_set (fin_supp f))
‚Üí update f n b&#39; a ‚â† b</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="FinSuppFn-v-chk3c" style="display: none" type="checkbox"><label class="alectryon-input" for="FinSuppFn-v-chk3c"><span class="nb">rewrite</span> elem_of_elements.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>A</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>EqDecision0</var><span class="hyp-type"><b>: </b><span>EqDecision A</span></span></span><br><span><var>B</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>EqDecision1</var><span class="hyp-type"><b>: </b><span>EqDecision B</span></span></span><br><span><var>b</var><span class="hyp-type"><b>: </b><span>B</span></span></span><br><span><var>f</var><span class="hyp-type"><b>: </b><span>fsfun A b</span></span></span><br><span><var>n</var><span class="hyp-type"><b>: </b><span>A</span></span></span><br><span><var>b'</var><span class="hyp-type"><b>: </b><span>B</span></span></span><br><span><var>a</var><span class="hyp-type"><b>: </b><span>A</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">a
‚àà (<span class="kr">if</span> decide (b&#39; = b)
   <span class="kr">then</span> list_to_set (fin_supp f) ‚àñ {[n]}
   <span class="kr">else</span> {[n]} ‚à™ list_to_set (fin_supp f))
‚Üí update f n b&#39; a ‚â† b</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="FinSuppFn-v-chk3d" style="display: none" type="checkbox"><label class="alectryon-input" for="FinSuppFn-v-chk3d">case_decide.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>A</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>EqDecision0</var><span class="hyp-type"><b>: </b><span>EqDecision A</span></span></span><br><span><var>B</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>EqDecision1</var><span class="hyp-type"><b>: </b><span>EqDecision B</span></span></span><br><span><var>b</var><span class="hyp-type"><b>: </b><span>B</span></span></span><br><span><var>f</var><span class="hyp-type"><b>: </b><span>fsfun A b</span></span></span><br><span><var>n</var><span class="hyp-type"><b>: </b><span>A</span></span></span><br><span><var>b'</var><span class="hyp-type"><b>: </b><span>B</span></span></span><br><span><var>a</var><span class="hyp-type"><b>: </b><span>A</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>b&#39; = b</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">a ‚àà list_to_set (fin_supp f) ‚àñ {[n]}
‚Üí update f n b&#39; a ‚â† b</div></blockquote><div class="alectryon-extra-goals"><input class="alectryon-extra-goal-toggle" id="FinSuppFn-v-chk3e" style="display: none" type="checkbox"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>A</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>EqDecision0</var><span class="hyp-type"><b>: </b><span>EqDecision A</span></span></span><br><span><var>B</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>EqDecision1</var><span class="hyp-type"><b>: </b><span>EqDecision B</span></span></span><br><span><var>b</var><span class="hyp-type"><b>: </b><span>B</span></span></span><br><span><var>f</var><span class="hyp-type"><b>: </b><span>fsfun A b</span></span></span><br><span><var>n</var><span class="hyp-type"><b>: </b><span>A</span></span></span><br><span><var>b'</var><span class="hyp-type"><b>: </b><span>B</span></span></span><br><span><var>a</var><span class="hyp-type"><b>: </b><span>A</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>b&#39; ‚â† b</span></span></span><br></div><label class="goal-separator" for="FinSuppFn-v-chk3e"><hr></label><div class="goal-conclusion">a ‚àà {[n]} ‚à™ list_to_set (fin_supp f)
‚Üí update f n b&#39; a ‚â† b</div></blockquote></div></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="FinSuppFn-v-chk3f" style="display: none" type="checkbox"><label class="alectryon-input" for="FinSuppFn-v-chk3f">-</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>A</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>EqDecision0</var><span class="hyp-type"><b>: </b><span>EqDecision A</span></span></span><br><span><var>B</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>EqDecision1</var><span class="hyp-type"><b>: </b><span>EqDecision B</span></span></span><br><span><var>b</var><span class="hyp-type"><b>: </b><span>B</span></span></span><br><span><var>f</var><span class="hyp-type"><b>: </b><span>fsfun A b</span></span></span><br><span><var>n</var><span class="hyp-type"><b>: </b><span>A</span></span></span><br><span><var>b'</var><span class="hyp-type"><b>: </b><span>B</span></span></span><br><span><var>a</var><span class="hyp-type"><b>: </b><span>A</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>b&#39; = b</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">a ‚àà list_to_set (fin_supp f) ‚àñ {[n]}
‚Üí update f n b&#39; a ‚â† b</div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="FinSuppFn-v-chk40" style="display: none" type="checkbox"><label class="alectryon-input" for="FinSuppFn-v-chk40"><span class="nb">rewrite</span> elem_of_difference, elem_of_singleton, elem_of_list_to_set,
      elem_of_fin_supp.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>A</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>EqDecision0</var><span class="hyp-type"><b>: </b><span>EqDecision A</span></span></span><br><span><var>B</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>EqDecision1</var><span class="hyp-type"><b>: </b><span>EqDecision B</span></span></span><br><span><var>b</var><span class="hyp-type"><b>: </b><span>B</span></span></span><br><span><var>f</var><span class="hyp-type"><b>: </b><span>fsfun A b</span></span></span><br><span><var>n</var><span class="hyp-type"><b>: </b><span>A</span></span></span><br><span><var>b'</var><span class="hyp-type"><b>: </b><span>B</span></span></span><br><span><var>a</var><span class="hyp-type"><b>: </b><span>A</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>b&#39; = b</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">f a ‚â† b ‚àß a ‚â† n ‚Üí update f n b&#39; a ‚â† b</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><span class="alectryon-input"><span class="bp">by</span> <span class="nb">intros</span> []; <span class="nb">rewrite</span> update_neq.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="FinSuppFn-v-chk41" style="display: none" type="checkbox"><label class="alectryon-input" for="FinSuppFn-v-chk41">-</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>A</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>EqDecision0</var><span class="hyp-type"><b>: </b><span>EqDecision A</span></span></span><br><span><var>B</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>EqDecision1</var><span class="hyp-type"><b>: </b><span>EqDecision B</span></span></span><br><span><var>b</var><span class="hyp-type"><b>: </b><span>B</span></span></span><br><span><var>f</var><span class="hyp-type"><b>: </b><span>fsfun A b</span></span></span><br><span><var>n</var><span class="hyp-type"><b>: </b><span>A</span></span></span><br><span><var>b'</var><span class="hyp-type"><b>: </b><span>B</span></span></span><br><span><var>a</var><span class="hyp-type"><b>: </b><span>A</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>b&#39; ‚â† b</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">a ‚àà {[n]} ‚à™ list_to_set (fin_supp f)
‚Üí update f n b&#39; a ‚â† b</div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="FinSuppFn-v-chk42" style="display: none" type="checkbox"><label class="alectryon-input" for="FinSuppFn-v-chk42"><span class="nb">rewrite</span> elem_of_union, elem_of_singleton, elem_of_list_to_set,
      elem_of_fin_supp.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>A</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>EqDecision0</var><span class="hyp-type"><b>: </b><span>EqDecision A</span></span></span><br><span><var>B</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>EqDecision1</var><span class="hyp-type"><b>: </b><span>EqDecision B</span></span></span><br><span><var>b</var><span class="hyp-type"><b>: </b><span>B</span></span></span><br><span><var>f</var><span class="hyp-type"><b>: </b><span>fsfun A b</span></span></span><br><span><var>n</var><span class="hyp-type"><b>: </b><span>A</span></span></span><br><span><var>b'</var><span class="hyp-type"><b>: </b><span>B</span></span></span><br><span><var>a</var><span class="hyp-type"><b>: </b><span>A</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>b&#39; ‚â† b</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">a = n ‚à® f a ‚â† b ‚Üí update f n b&#39; a ‚â† b</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><span class="alectryon-input"><span class="bp">by</span> <span class="nb">unfold</span> update; case_decide; <span class="nb">cbn</span>; <span class="nb">intros</span> [].</span><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Qed</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
</span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Program Definition</span> <span class="nf">update_fsfun</span>
  (<span class="nv">f</span> : fsfun A b) (<span class="nv">n</span> : A) (<span class="nv">b&#39;</span> : B) : fsfun A b :=
  existT (update f n b&#39;)
    {| enum := list_annotate (update_supp_all f n b&#39;) |}.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="FinSuppFn-v-chk43" style="display: none" type="checkbox"><label class="alectryon-input" for="FinSuppFn-v-chk43"><span class="kn">Next Obligation</span>.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>A</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>EqDecision0</var><span class="hyp-type"><b>: </b><span>EqDecision A</span></span></span><br><span><var>B</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>EqDecision1</var><span class="hyp-type"><b>: </b><span>EqDecision B</span></span></span><br><span><var>b</var><span class="hyp-type"><b>: </b><span>B</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="kr">‚àÄ</span> (<span class="nv">f</span> : fsfun A b) (<span class="nv">n</span> : A) (<span class="nv">b&#39;</span> : B),
  NoDup (list_annotate (update_supp_all f n b&#39;))</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="FinSuppFn-v-chk44" style="display: none" type="checkbox"><label class="alectryon-input" for="FinSuppFn-v-chk44"><span class="kn">Proof</span>.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>A</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>EqDecision0</var><span class="hyp-type"><b>: </b><span>EqDecision A</span></span></span><br><span><var>B</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>EqDecision1</var><span class="hyp-type"><b>: </b><span>EqDecision B</span></span></span><br><span><var>b</var><span class="hyp-type"><b>: </b><span>B</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="kr">‚àÄ</span> (<span class="nv">f</span> : fsfun A b) (<span class="nv">n</span> : A) (<span class="nv">b&#39;</span> : B),
  NoDup (list_annotate (update_supp_all f n b&#39;))</div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="bp">by</span> <span class="nb">intros</span>; <span class="nb">apply</span> list_annotate_NoDup, NoDup_elements.</span><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Qed</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="FinSuppFn-v-chk45" style="display: none" type="checkbox"><label class="alectryon-input" for="FinSuppFn-v-chk45"><span class="kn">Next Obligation</span>.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>A</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>EqDecision0</var><span class="hyp-type"><b>: </b><span>EqDecision A</span></span></span><br><span><var>B</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>EqDecision1</var><span class="hyp-type"><b>: </b><span>EqDecision B</span></span></span><br><span><var>b</var><span class="hyp-type"><b>: </b><span>B</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="kr">‚àÄ</span> (<span class="nv">f</span> : fsfun A b) (<span class="nv">n</span> : A) (<span class="nv">b&#39;</span> : B) (<span class="nv">x</span> : support b
                                          (update f n
                                             b&#39;)),
  x ‚àà list_annotate (update_supp_all f n b&#39;)</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="FinSuppFn-v-chk46" style="display: none" type="checkbox"><label class="alectryon-input" for="FinSuppFn-v-chk46"><span class="kn">Proof</span>.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>A</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>EqDecision0</var><span class="hyp-type"><b>: </b><span>EqDecision A</span></span></span><br><span><var>B</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>EqDecision1</var><span class="hyp-type"><b>: </b><span>EqDecision B</span></span></span><br><span><var>b</var><span class="hyp-type"><b>: </b><span>B</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="kr">‚àÄ</span> (<span class="nv">f</span> : fsfun A b) (<span class="nv">n</span> : A) (<span class="nv">b&#39;</span> : B) (<span class="nv">x</span> : support b
                                          (update f n
                                             b&#39;)),
  x ‚àà list_annotate (update_supp_all f n b&#39;)</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="FinSuppFn-v-chk47" style="display: none" type="checkbox"><label class="alectryon-input" for="FinSuppFn-v-chk47"><span class="nb">intros</span>; destruct_dec_sig x a Ha Heq; <span class="nb">subst</span>.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>A</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>EqDecision0</var><span class="hyp-type"><b>: </b><span>EqDecision A</span></span></span><br><span><var>B</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>EqDecision1</var><span class="hyp-type"><b>: </b><span>EqDecision B</span></span></span><br><span><var>b</var><span class="hyp-type"><b>: </b><span>B</span></span></span><br><span><var>f</var><span class="hyp-type"><b>: </b><span>fsfun A b</span></span></span><br><span><var>n</var><span class="hyp-type"><b>: </b><span>A</span></span></span><br><span><var>b'</var><span class="hyp-type"><b>: </b><span>B</span></span></span><br><span><var>a</var><span class="hyp-type"><b>: </b><span>A</span></span></span><br><span><var>Ha</var><span class="hyp-type"><b>: </b><span>update f n b&#39; a ‚â† b</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">dexist a Ha ‚àà list_annotate (update_supp_all f n b&#39;)</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="FinSuppFn-v-chk48" style="display: none" type="checkbox"><label class="alectryon-input" for="FinSuppFn-v-chk48"><span class="nb">apply</span> elem_of_list_annotate, elem_of_elements.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>A</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>EqDecision0</var><span class="hyp-type"><b>: </b><span>EqDecision A</span></span></span><br><span><var>B</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>EqDecision1</var><span class="hyp-type"><b>: </b><span>EqDecision B</span></span></span><br><span><var>b</var><span class="hyp-type"><b>: </b><span>B</span></span></span><br><span><var>f</var><span class="hyp-type"><b>: </b><span>fsfun A b</span></span></span><br><span><var>n</var><span class="hyp-type"><b>: </b><span>A</span></span></span><br><span><var>b'</var><span class="hyp-type"><b>: </b><span>B</span></span></span><br><span><var>a</var><span class="hyp-type"><b>: </b><span>A</span></span></span><br><span><var>Ha</var><span class="hyp-type"><b>: </b><span>update f n b&#39; a ‚â† b</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">`(dexist a Ha) ‚àà update_supp f n b&#39;</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="FinSuppFn-v-chk49" style="display: none" type="checkbox"><label class="alectryon-input" for="FinSuppFn-v-chk49"><span class="nb">unfold</span> update_supp; case_decide.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>A</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>EqDecision0</var><span class="hyp-type"><b>: </b><span>EqDecision A</span></span></span><br><span><var>B</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>EqDecision1</var><span class="hyp-type"><b>: </b><span>EqDecision B</span></span></span><br><span><var>b</var><span class="hyp-type"><b>: </b><span>B</span></span></span><br><span><var>f</var><span class="hyp-type"><b>: </b><span>fsfun A b</span></span></span><br><span><var>n</var><span class="hyp-type"><b>: </b><span>A</span></span></span><br><span><var>b'</var><span class="hyp-type"><b>: </b><span>B</span></span></span><br><span><var>a</var><span class="hyp-type"><b>: </b><span>A</span></span></span><br><span><var>Ha</var><span class="hyp-type"><b>: </b><span>update f n b&#39; a ‚â† b</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>b&#39; = b</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">`(dexist a Ha) ‚àà list_to_set (fin_supp f) ‚àñ {[n]}</div></blockquote><div class="alectryon-extra-goals"><input class="alectryon-extra-goal-toggle" id="FinSuppFn-v-chk4a" style="display: none" type="checkbox"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>A</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>EqDecision0</var><span class="hyp-type"><b>: </b><span>EqDecision A</span></span></span><br><span><var>B</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>EqDecision1</var><span class="hyp-type"><b>: </b><span>EqDecision B</span></span></span><br><span><var>b</var><span class="hyp-type"><b>: </b><span>B</span></span></span><br><span><var>f</var><span class="hyp-type"><b>: </b><span>fsfun A b</span></span></span><br><span><var>n</var><span class="hyp-type"><b>: </b><span>A</span></span></span><br><span><var>b'</var><span class="hyp-type"><b>: </b><span>B</span></span></span><br><span><var>a</var><span class="hyp-type"><b>: </b><span>A</span></span></span><br><span><var>Ha</var><span class="hyp-type"><b>: </b><span>update f n b&#39; a ‚â† b</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>b&#39; ‚â† b</span></span></span><br></div><label class="goal-separator" for="FinSuppFn-v-chk4a"><hr></label><div class="goal-conclusion">`(dexist a Ha) ‚àà {[n]} ‚à™ list_to_set (fin_supp f)</div></blockquote></div></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="FinSuppFn-v-chk4b" style="display: none" type="checkbox"><label class="alectryon-input" for="FinSuppFn-v-chk4b">-</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>A</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>EqDecision0</var><span class="hyp-type"><b>: </b><span>EqDecision A</span></span></span><br><span><var>B</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>EqDecision1</var><span class="hyp-type"><b>: </b><span>EqDecision B</span></span></span><br><span><var>b</var><span class="hyp-type"><b>: </b><span>B</span></span></span><br><span><var>f</var><span class="hyp-type"><b>: </b><span>fsfun A b</span></span></span><br><span><var>n</var><span class="hyp-type"><b>: </b><span>A</span></span></span><br><span><var>b'</var><span class="hyp-type"><b>: </b><span>B</span></span></span><br><span><var>a</var><span class="hyp-type"><b>: </b><span>A</span></span></span><br><span><var>Ha</var><span class="hyp-type"><b>: </b><span>update f n b&#39; a ‚â† b</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>b&#39; = b</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">`(dexist a Ha) ‚àà list_to_set (fin_supp f) ‚àñ {[n]}</div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="FinSuppFn-v-chk4c" style="display: none" type="checkbox"><label class="alectryon-input" for="FinSuppFn-v-chk4c"><span class="nb">rewrite</span> elem_of_difference, elem_of_list_to_set, elem_of_fin_supp,
      elem_of_singleton; <span class="nb">cbn</span>.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>A</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>EqDecision0</var><span class="hyp-type"><b>: </b><span>EqDecision A</span></span></span><br><span><var>B</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>EqDecision1</var><span class="hyp-type"><b>: </b><span>EqDecision B</span></span></span><br><span><var>b</var><span class="hyp-type"><b>: </b><span>B</span></span></span><br><span><var>f</var><span class="hyp-type"><b>: </b><span>fsfun A b</span></span></span><br><span><var>n</var><span class="hyp-type"><b>: </b><span>A</span></span></span><br><span><var>b'</var><span class="hyp-type"><b>: </b><span>B</span></span></span><br><span><var>a</var><span class="hyp-type"><b>: </b><span>A</span></span></span><br><span><var>Ha</var><span class="hyp-type"><b>: </b><span>update f n b&#39; a ‚â† b</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>b&#39; = b</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">f a ‚â† b ‚àß a ‚â† n</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><span class="alectryon-input"><span class="bp">by</span> <span class="nb">unfold</span> update <span class="kr">in</span> Ha; case_decide; <span class="nb">split</span>; <span class="bp">congruence</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="FinSuppFn-v-chk4d" style="display: none" type="checkbox"><label class="alectryon-input" for="FinSuppFn-v-chk4d">-</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>A</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>EqDecision0</var><span class="hyp-type"><b>: </b><span>EqDecision A</span></span></span><br><span><var>B</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>EqDecision1</var><span class="hyp-type"><b>: </b><span>EqDecision B</span></span></span><br><span><var>b</var><span class="hyp-type"><b>: </b><span>B</span></span></span><br><span><var>f</var><span class="hyp-type"><b>: </b><span>fsfun A b</span></span></span><br><span><var>n</var><span class="hyp-type"><b>: </b><span>A</span></span></span><br><span><var>b'</var><span class="hyp-type"><b>: </b><span>B</span></span></span><br><span><var>a</var><span class="hyp-type"><b>: </b><span>A</span></span></span><br><span><var>Ha</var><span class="hyp-type"><b>: </b><span>update f n b&#39; a ‚â† b</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>b&#39; ‚â† b</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">`(dexist a Ha) ‚àà {[n]} ‚à™ list_to_set (fin_supp f)</div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="FinSuppFn-v-chk4e" style="display: none" type="checkbox"><label class="alectryon-input" for="FinSuppFn-v-chk4e"><span class="nb">rewrite</span> elem_of_union, elem_of_list_to_set, elem_of_fin_supp,
      elem_of_singleton; <span class="nb">cbn</span>.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>A</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>EqDecision0</var><span class="hyp-type"><b>: </b><span>EqDecision A</span></span></span><br><span><var>B</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>EqDecision1</var><span class="hyp-type"><b>: </b><span>EqDecision B</span></span></span><br><span><var>b</var><span class="hyp-type"><b>: </b><span>B</span></span></span><br><span><var>f</var><span class="hyp-type"><b>: </b><span>fsfun A b</span></span></span><br><span><var>n</var><span class="hyp-type"><b>: </b><span>A</span></span></span><br><span><var>b'</var><span class="hyp-type"><b>: </b><span>B</span></span></span><br><span><var>a</var><span class="hyp-type"><b>: </b><span>A</span></span></span><br><span><var>Ha</var><span class="hyp-type"><b>: </b><span>update f n b&#39; a ‚â† b</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>b&#39; ‚â† b</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">a = n ‚à® f a ‚â† b</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><span class="alectryon-input"><span class="bp">by</span> <span class="nb">unfold</span> update <span class="kr">in</span> Ha; case_decide; [<span class="nb">left</span> | <span class="nb">right</span>].</span><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Qed</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
</span><span class="alectryon-sentence"><input class="alectryon-toggle" id="FinSuppFn-v-chk4f" style="display: none" type="checkbox"><label class="alectryon-input" for="FinSuppFn-v-chk4f"><span class="kn">Lemma</span> <span class="nf">update_fsfun_eq</span> (<span class="nv">f</span> : fsfun A b) (<span class="nv">n</span> : A) (<span class="nv">b&#39;</span> : B) :
  update_fsfun f n b&#39; n = b&#39;.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>A</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>EqDecision0</var><span class="hyp-type"><b>: </b><span>EqDecision A</span></span></span><br><span><var>B</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>EqDecision1</var><span class="hyp-type"><b>: </b><span>EqDecision B</span></span></span><br><span><var>b</var><span class="hyp-type"><b>: </b><span>B</span></span></span><br><span><var>f</var><span class="hyp-type"><b>: </b><span>fsfun A b</span></span></span><br><span><var>n</var><span class="hyp-type"><b>: </b><span>A</span></span></span><br><span><var>b'</var><span class="hyp-type"><b>: </b><span>B</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">update_fsfun f n b&#39; n = b&#39;</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="FinSuppFn-v-chk50" style="display: none" type="checkbox"><label class="alectryon-input" for="FinSuppFn-v-chk50"><span class="kn">Proof</span>.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>A</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>EqDecision0</var><span class="hyp-type"><b>: </b><span>EqDecision A</span></span></span><br><span><var>B</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>EqDecision1</var><span class="hyp-type"><b>: </b><span>EqDecision B</span></span></span><br><span><var>b</var><span class="hyp-type"><b>: </b><span>B</span></span></span><br><span><var>f</var><span class="hyp-type"><b>: </b><span>fsfun A b</span></span></span><br><span><var>n</var><span class="hyp-type"><b>: </b><span>A</span></span></span><br><span><var>b'</var><span class="hyp-type"><b>: </b><span>B</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">update_fsfun f n b&#39; n = b&#39;</div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="bp">by</span> <span class="nb">setoid_rewrite</span> update_eq.</span><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Qed</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
</span><span class="alectryon-sentence"><input class="alectryon-toggle" id="FinSuppFn-v-chk51" style="display: none" type="checkbox"><label class="alectryon-input" for="FinSuppFn-v-chk51"><span class="kn">Lemma</span> <span class="nf">update_fsfun_neq</span> (<span class="nv">f</span> : fsfun A b) (<span class="nv">n</span> : A) (<span class="nv">b&#39;</span> : B):
  <span class="kr">forall</span> (<span class="nv">m</span> : A), m &lt;&gt; n -&gt; update_fsfun f n b&#39; m = f m.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>A</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>EqDecision0</var><span class="hyp-type"><b>: </b><span>EqDecision A</span></span></span><br><span><var>B</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>EqDecision1</var><span class="hyp-type"><b>: </b><span>EqDecision B</span></span></span><br><span><var>b</var><span class="hyp-type"><b>: </b><span>B</span></span></span><br><span><var>f</var><span class="hyp-type"><b>: </b><span>fsfun A b</span></span></span><br><span><var>n</var><span class="hyp-type"><b>: </b><span>A</span></span></span><br><span><var>b'</var><span class="hyp-type"><b>: </b><span>B</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="kr">‚àÄ</span> <span class="nv">m</span> : A, m ‚â† n ‚Üí update_fsfun f n b&#39; m = f m</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="FinSuppFn-v-chk52" style="display: none" type="checkbox"><label class="alectryon-input" for="FinSuppFn-v-chk52"><span class="kn">Proof</span>.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>A</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>EqDecision0</var><span class="hyp-type"><b>: </b><span>EqDecision A</span></span></span><br><span><var>B</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>EqDecision1</var><span class="hyp-type"><b>: </b><span>EqDecision B</span></span></span><br><span><var>b</var><span class="hyp-type"><b>: </b><span>B</span></span></span><br><span><var>f</var><span class="hyp-type"><b>: </b><span>fsfun A b</span></span></span><br><span><var>n</var><span class="hyp-type"><b>: </b><span>A</span></span></span><br><span><var>b'</var><span class="hyp-type"><b>: </b><span>B</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="kr">‚àÄ</span> <span class="nv">m</span> : A, m ‚â† n ‚Üí update_fsfun f n b&#39; m = f m</div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="bp">by</span> <span class="nb">intros</span>; <span class="nb">setoid_rewrite</span> update_neq.</span><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Qed</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
</span><span class="alectryon-sentence"><input class="alectryon-toggle" id="FinSuppFn-v-chk53" style="display: none" type="checkbox"><label class="alectryon-input" for="FinSuppFn-v-chk53">#[export] <span class="kn">Instance</span> <span class="nf">update_fsfun_proper</span> :
  Proper ((‚â°) ==&gt; (=) ==&gt; (=) ==&gt; (‚â°)) update_fsfun.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>A</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>EqDecision0</var><span class="hyp-type"><b>: </b><span>EqDecision A</span></span></span><br><span><var>B</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>EqDecision1</var><span class="hyp-type"><b>: </b><span>EqDecision B</span></span></span><br><span><var>b</var><span class="hyp-type"><b>: </b><span>B</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">Proper (equiv ==&gt; eq ==&gt; eq ==&gt; equiv) update_fsfun</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="FinSuppFn-v-chk54" style="display: none" type="checkbox"><label class="alectryon-input" for="FinSuppFn-v-chk54"><span class="kn">Proof</span>.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>A</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>EqDecision0</var><span class="hyp-type"><b>: </b><span>EqDecision A</span></span></span><br><span><var>B</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>EqDecision1</var><span class="hyp-type"><b>: </b><span>EqDecision B</span></span></span><br><span><var>b</var><span class="hyp-type"><b>: </b><span>B</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">Proper (equiv ==&gt; eq ==&gt; eq ==&gt; equiv) update_fsfun</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="FinSuppFn-v-chk55" style="display: none" type="checkbox"><label class="alectryon-input" for="FinSuppFn-v-chk55"><span class="nb">intros</span> f g Heqv _n n -&gt; _b&#39; b&#39; -&gt;.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>A</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>EqDecision0</var><span class="hyp-type"><b>: </b><span>EqDecision A</span></span></span><br><span><var>B</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>EqDecision1</var><span class="hyp-type"><b>: </b><span>EqDecision B</span></span></span><br><span><var>b</var><span class="hyp-type"><b>: </b><span>B</span></span></span><br><span><var>f, g</var><span class="hyp-type"><b>: </b><span>fsfun A b</span></span></span><br><span><var>Heqv</var><span class="hyp-type"><b>: </b><span>f ‚â° g</span></span></span><br><span><var>n</var><span class="hyp-type"><b>: </b><span>A</span></span></span><br><span><var>b'</var><span class="hyp-type"><b>: </b><span>B</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">update_fsfun f n b&#39; ‚â° update_fsfun g n b&#39;</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="FinSuppFn-v-chk56" style="display: none" type="checkbox"><label class="alectryon-input" for="FinSuppFn-v-chk56"><span class="nb">apply</span> fsfun_equiv_unfold; extensionality a; <span class="nb">cbn</span>.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>A</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>EqDecision0</var><span class="hyp-type"><b>: </b><span>EqDecision A</span></span></span><br><span><var>B</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>EqDecision1</var><span class="hyp-type"><b>: </b><span>EqDecision B</span></span></span><br><span><var>b</var><span class="hyp-type"><b>: </b><span>B</span></span></span><br><span><var>f, g</var><span class="hyp-type"><b>: </b><span>fsfun A b</span></span></span><br><span><var>Heqv</var><span class="hyp-type"><b>: </b><span>f ‚â° g</span></span></span><br><span><var>n</var><span class="hyp-type"><b>: </b><span>A</span></span></span><br><span><var>b'</var><span class="hyp-type"><b>: </b><span>B</span></span></span><br><span><var>a</var><span class="hyp-type"><b>: </b><span>A</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">update_fsfun f n b&#39; a = update_fsfun g n b&#39; a</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="FinSuppFn-v-chk57" style="display: none" type="checkbox"><label class="alectryon-input" for="FinSuppFn-v-chk57"><span class="nb">destruct</span> (decide (n = a)) <span class="kr">as</span> [-&gt; |].</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>A</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>EqDecision0</var><span class="hyp-type"><b>: </b><span>EqDecision A</span></span></span><br><span><var>B</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>EqDecision1</var><span class="hyp-type"><b>: </b><span>EqDecision B</span></span></span><br><span><var>b</var><span class="hyp-type"><b>: </b><span>B</span></span></span><br><span><var>f, g</var><span class="hyp-type"><b>: </b><span>fsfun A b</span></span></span><br><span><var>Heqv</var><span class="hyp-type"><b>: </b><span>f ‚â° g</span></span></span><br><span><var>b'</var><span class="hyp-type"><b>: </b><span>B</span></span></span><br><span><var>a</var><span class="hyp-type"><b>: </b><span>A</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">update_fsfun f a b&#39; a = update_fsfun g a b&#39; a</div></blockquote><div class="alectryon-extra-goals"><input class="alectryon-extra-goal-toggle" id="FinSuppFn-v-chk58" style="display: none" type="checkbox"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>A</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>EqDecision0</var><span class="hyp-type"><b>: </b><span>EqDecision A</span></span></span><br><span><var>B</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>EqDecision1</var><span class="hyp-type"><b>: </b><span>EqDecision B</span></span></span><br><span><var>b</var><span class="hyp-type"><b>: </b><span>B</span></span></span><br><span><var>f, g</var><span class="hyp-type"><b>: </b><span>fsfun A b</span></span></span><br><span><var>Heqv</var><span class="hyp-type"><b>: </b><span>f ‚â° g</span></span></span><br><span><var>n</var><span class="hyp-type"><b>: </b><span>A</span></span></span><br><span><var>b'</var><span class="hyp-type"><b>: </b><span>B</span></span></span><br><span><var>a</var><span class="hyp-type"><b>: </b><span>A</span></span></span><br><span><var>n0</var><span class="hyp-type"><b>: </b><span>n ‚â† a</span></span></span><br></div><label class="goal-separator" for="FinSuppFn-v-chk58"><hr></label><div class="goal-conclusion">update_fsfun f n b&#39; a = update_fsfun g n b&#39; a</div></blockquote></div></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="FinSuppFn-v-chk59" style="display: none" type="checkbox"><label class="alectryon-input" for="FinSuppFn-v-chk59">-</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>A</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>EqDecision0</var><span class="hyp-type"><b>: </b><span>EqDecision A</span></span></span><br><span><var>B</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>EqDecision1</var><span class="hyp-type"><b>: </b><span>EqDecision B</span></span></span><br><span><var>b</var><span class="hyp-type"><b>: </b><span>B</span></span></span><br><span><var>f, g</var><span class="hyp-type"><b>: </b><span>fsfun A b</span></span></span><br><span><var>Heqv</var><span class="hyp-type"><b>: </b><span>f ‚â° g</span></span></span><br><span><var>b'</var><span class="hyp-type"><b>: </b><span>B</span></span></span><br><span><var>a</var><span class="hyp-type"><b>: </b><span>A</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">update_fsfun f a b&#39; a = update_fsfun g a b&#39; a</div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="bp">by</span> <span class="nb">rewrite</span> !update_fsfun_eq.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="FinSuppFn-v-chk5a" style="display: none" type="checkbox"><label class="alectryon-input" for="FinSuppFn-v-chk5a">-</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>A</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>EqDecision0</var><span class="hyp-type"><b>: </b><span>EqDecision A</span></span></span><br><span><var>B</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>EqDecision1</var><span class="hyp-type"><b>: </b><span>EqDecision B</span></span></span><br><span><var>b</var><span class="hyp-type"><b>: </b><span>B</span></span></span><br><span><var>f, g</var><span class="hyp-type"><b>: </b><span>fsfun A b</span></span></span><br><span><var>Heqv</var><span class="hyp-type"><b>: </b><span>f ‚â° g</span></span></span><br><span><var>n</var><span class="hyp-type"><b>: </b><span>A</span></span></span><br><span><var>b'</var><span class="hyp-type"><b>: </b><span>B</span></span></span><br><span><var>a</var><span class="hyp-type"><b>: </b><span>A</span></span></span><br><span><var>n0</var><span class="hyp-type"><b>: </b><span>n ‚â† a</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">update_fsfun f n b&#39; a = update_fsfun g n b&#39; a</div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="bp">by</span> <span class="nb">rewrite</span> !update_fsfun_neq, Heqv.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Qed</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
</span><span class="alectryon-sentence"><input class="alectryon-toggle" id="FinSuppFn-v-chk5b" style="display: none" type="checkbox"><label class="alectryon-input" for="FinSuppFn-v-chk5b"><span class="kn">Lemma</span> <span class="nf">elem_of_update_fsfun</span> (<span class="nv">f</span> : fsfun A b) (<span class="nv">n</span> : A) (<span class="nv">b&#39;</span> : B) :
  <span class="kr">forall</span> (<span class="nv">a</span> : A),
    a ‚àà fin_supp (update_fsfun f n b&#39;)
      &lt;-&gt;
    b&#39; = b /\ a ‚àà fin_supp f /\ a &lt;&gt; n \/
    b&#39; &lt;&gt; b /\ (a ‚àà fin_supp f \/ a = n).</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>A</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>EqDecision0</var><span class="hyp-type"><b>: </b><span>EqDecision A</span></span></span><br><span><var>B</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>EqDecision1</var><span class="hyp-type"><b>: </b><span>EqDecision B</span></span></span><br><span><var>b</var><span class="hyp-type"><b>: </b><span>B</span></span></span><br><span><var>f</var><span class="hyp-type"><b>: </b><span>fsfun A b</span></span></span><br><span><var>n</var><span class="hyp-type"><b>: </b><span>A</span></span></span><br><span><var>b'</var><span class="hyp-type"><b>: </b><span>B</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="kr">‚àÄ</span> <span class="nv">a</span> : A,
  a ‚àà fin_supp (update_fsfun f n b&#39;)
  ‚Üî b&#39; = b ‚àß a ‚àà fin_supp f ‚àß a ‚â† n
    ‚à® b&#39; ‚â† b ‚àß (a ‚àà fin_supp f ‚à® a = n)</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="FinSuppFn-v-chk5c" style="display: none" type="checkbox"><label class="alectryon-input" for="FinSuppFn-v-chk5c"><span class="kn">Proof</span>.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>A</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>EqDecision0</var><span class="hyp-type"><b>: </b><span>EqDecision A</span></span></span><br><span><var>B</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>EqDecision1</var><span class="hyp-type"><b>: </b><span>EqDecision B</span></span></span><br><span><var>b</var><span class="hyp-type"><b>: </b><span>B</span></span></span><br><span><var>f</var><span class="hyp-type"><b>: </b><span>fsfun A b</span></span></span><br><span><var>n</var><span class="hyp-type"><b>: </b><span>A</span></span></span><br><span><var>b'</var><span class="hyp-type"><b>: </b><span>B</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="kr">‚àÄ</span> <span class="nv">a</span> : A,
  a ‚àà fin_supp (update_fsfun f n b&#39;)
  ‚Üî b&#39; = b ‚àß a ‚àà fin_supp f ‚àß a ‚â† n
    ‚à® b&#39; ‚â† b ‚àß (a ‚àà fin_supp f ‚à® a = n)</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="FinSuppFn-v-chk5d" style="display: none" type="checkbox"><label class="alectryon-input" for="FinSuppFn-v-chk5d"><span class="nb">intros</span> a; <span class="nb">unfold</span> fin_supp <span class="nb">at</span> <span class="mi">1</span>; <span class="nb">cbn</span>.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>A</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>EqDecision0</var><span class="hyp-type"><b>: </b><span>EqDecision A</span></span></span><br><span><var>B</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>EqDecision1</var><span class="hyp-type"><b>: </b><span>EqDecision B</span></span></span><br><span><var>b</var><span class="hyp-type"><b>: </b><span>B</span></span></span><br><span><var>f</var><span class="hyp-type"><b>: </b><span>fsfun A b</span></span></span><br><span><var>n</var><span class="hyp-type"><b>: </b><span>A</span></span></span><br><span><var>b'</var><span class="hyp-type"><b>: </b><span>B</span></span></span><br><span><var>a</var><span class="hyp-type"><b>: </b><span>A</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">a
‚àà map proj1_sig
    (list_annotate (update_supp_all f n b&#39;))
‚Üî b&#39; = b ‚àß a ‚àà fin_supp f ‚àß a ‚â† n
  ‚à® b&#39; ‚â† b ‚àß (a ‚àà fin_supp f ‚à® a = n)</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="FinSuppFn-v-chk5e" style="display: none" type="checkbox"><label class="alectryon-input" for="FinSuppFn-v-chk5e"><span class="nb">rewrite</span> list_annotate_forget, elem_of_elements.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>A</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>EqDecision0</var><span class="hyp-type"><b>: </b><span>EqDecision A</span></span></span><br><span><var>B</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>EqDecision1</var><span class="hyp-type"><b>: </b><span>EqDecision B</span></span></span><br><span><var>b</var><span class="hyp-type"><b>: </b><span>B</span></span></span><br><span><var>f</var><span class="hyp-type"><b>: </b><span>fsfun A b</span></span></span><br><span><var>n</var><span class="hyp-type"><b>: </b><span>A</span></span></span><br><span><var>b'</var><span class="hyp-type"><b>: </b><span>B</span></span></span><br><span><var>a</var><span class="hyp-type"><b>: </b><span>A</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">a ‚àà update_supp f n b&#39;
‚Üî b&#39; = b ‚àß a ‚àà fin_supp f ‚àß a ‚â† n
  ‚à® b&#39; ‚â† b ‚àß (a ‚àà fin_supp f ‚à® a = n)</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="FinSuppFn-v-chk5f" style="display: none" type="checkbox"><label class="alectryon-input" for="FinSuppFn-v-chk5f"><span class="nb">unfold</span> update_supp; case_decide.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>A</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>EqDecision0</var><span class="hyp-type"><b>: </b><span>EqDecision A</span></span></span><br><span><var>B</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>EqDecision1</var><span class="hyp-type"><b>: </b><span>EqDecision B</span></span></span><br><span><var>b</var><span class="hyp-type"><b>: </b><span>B</span></span></span><br><span><var>f</var><span class="hyp-type"><b>: </b><span>fsfun A b</span></span></span><br><span><var>n</var><span class="hyp-type"><b>: </b><span>A</span></span></span><br><span><var>b'</var><span class="hyp-type"><b>: </b><span>B</span></span></span><br><span><var>a</var><span class="hyp-type"><b>: </b><span>A</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>b&#39; = b</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">a ‚àà list_to_set (fin_supp f) ‚àñ {[n]}
‚Üî b&#39; = b ‚àß a ‚àà fin_supp f ‚àß a ‚â† n
  ‚à® b&#39; ‚â† b ‚àß (a ‚àà fin_supp f ‚à® a = n)</div></blockquote><div class="alectryon-extra-goals"><input class="alectryon-extra-goal-toggle" id="FinSuppFn-v-chk60" style="display: none" type="checkbox"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>A</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>EqDecision0</var><span class="hyp-type"><b>: </b><span>EqDecision A</span></span></span><br><span><var>B</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>EqDecision1</var><span class="hyp-type"><b>: </b><span>EqDecision B</span></span></span><br><span><var>b</var><span class="hyp-type"><b>: </b><span>B</span></span></span><br><span><var>f</var><span class="hyp-type"><b>: </b><span>fsfun A b</span></span></span><br><span><var>n</var><span class="hyp-type"><b>: </b><span>A</span></span></span><br><span><var>b'</var><span class="hyp-type"><b>: </b><span>B</span></span></span><br><span><var>a</var><span class="hyp-type"><b>: </b><span>A</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>b&#39; ‚â† b</span></span></span><br></div><label class="goal-separator" for="FinSuppFn-v-chk60"><hr></label><div class="goal-conclusion">a ‚àà {[n]} ‚à™ list_to_set (fin_supp f)
‚Üî b&#39; = b ‚àß a ‚àà fin_supp f ‚àß a ‚â† n
  ‚à® b&#39; ‚â† b ‚àß (a ‚àà fin_supp f ‚à® a = n)</div></blockquote></div></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="FinSuppFn-v-chk61" style="display: none" type="checkbox"><label class="alectryon-input" for="FinSuppFn-v-chk61">-</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>A</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>EqDecision0</var><span class="hyp-type"><b>: </b><span>EqDecision A</span></span></span><br><span><var>B</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>EqDecision1</var><span class="hyp-type"><b>: </b><span>EqDecision B</span></span></span><br><span><var>b</var><span class="hyp-type"><b>: </b><span>B</span></span></span><br><span><var>f</var><span class="hyp-type"><b>: </b><span>fsfun A b</span></span></span><br><span><var>n</var><span class="hyp-type"><b>: </b><span>A</span></span></span><br><span><var>b'</var><span class="hyp-type"><b>: </b><span>B</span></span></span><br><span><var>a</var><span class="hyp-type"><b>: </b><span>A</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>b&#39; = b</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">a ‚àà list_to_set (fin_supp f) ‚àñ {[n]}
‚Üî b&#39; = b ‚àß a ‚àà fin_supp f ‚àß a ‚â† n
  ‚à® b&#39; ‚â† b ‚àß (a ‚àà fin_supp f ‚à® a = n)</div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="bp">by</span> <span class="nb">rewrite</span> elem_of_difference, elem_of_list_to_set, elem_of_singleton; <span class="nb">split</span>; itauto.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="FinSuppFn-v-chk62" style="display: none" type="checkbox"><label class="alectryon-input" for="FinSuppFn-v-chk62">-</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>A</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>EqDecision0</var><span class="hyp-type"><b>: </b><span>EqDecision A</span></span></span><br><span><var>B</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>EqDecision1</var><span class="hyp-type"><b>: </b><span>EqDecision B</span></span></span><br><span><var>b</var><span class="hyp-type"><b>: </b><span>B</span></span></span><br><span><var>f</var><span class="hyp-type"><b>: </b><span>fsfun A b</span></span></span><br><span><var>n</var><span class="hyp-type"><b>: </b><span>A</span></span></span><br><span><var>b'</var><span class="hyp-type"><b>: </b><span>B</span></span></span><br><span><var>a</var><span class="hyp-type"><b>: </b><span>A</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>b&#39; ‚â† b</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">a ‚àà {[n]} ‚à™ list_to_set (fin_supp f)
‚Üî b&#39; = b ‚àß a ‚àà fin_supp f ‚àß a ‚â† n
  ‚à® b&#39; ‚â† b ‚àß (a ‚àà fin_supp f ‚à® a = n)</div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="bp">by</span> <span class="nb">rewrite</span> elem_of_union, elem_of_list_to_set, elem_of_singleton; <span class="nb">split</span>; itauto.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Qed</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
</span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">End</span> <span class="nf">sec_fsfun_fixed_supp_value</span>.</span></span></pre><div class="doc">
<a id="lab2"></a><h2 class="section">Finitely supported functions on naturals</h2>
</div><pre class="alectryon-io highlight"><!-- Generator: Alectryon --><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Definition</span> <span class="nf">zero_fsfun</span> : fsfun A <span class="mi">0</span> := empty_fsfun.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
</span><span class="alectryon-sentence"><input class="alectryon-toggle" id="FinSuppFn-v-chk63" style="display: none" type="checkbox"><label class="alectryon-input" for="FinSuppFn-v-chk63"><span class="kn">Lemma</span> <span class="nf">zero_fsfun_rew</span> : <span class="kr">forall</span> (<span class="nv">n</span> : A), zero_fsfun n = <span class="mi">0</span>.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>A</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>EqDecision0</var><span class="hyp-type"><b>: </b><span>EqDecision A</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="kr">‚àÄ</span> <span class="nv">n</span> : A, zero_fsfun n = <span class="mi">0</span></div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="FinSuppFn-v-chk64" style="display: none" type="checkbox"><label class="alectryon-input" for="FinSuppFn-v-chk64"><span class="kn">Proof</span>.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>A</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>EqDecision0</var><span class="hyp-type"><b>: </b><span>EqDecision A</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="kr">‚àÄ</span> <span class="nv">n</span> : A, zero_fsfun n = <span class="mi">0</span></div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="bp">done</span>.</span><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Qed</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
</span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Definition</span> <span class="nf">succ_fsfun</span> (<span class="nv">f</span> : fsfun A <span class="mi">0</span>) (<span class="nv">n</span> : A) : fsfun A <span class="mi">0</span> :=
  update_fsfun f n (S (f n)).</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
</span><span class="alectryon-sentence"><input class="alectryon-toggle" id="FinSuppFn-v-chk65" style="display: none" type="checkbox"><label class="alectryon-input" for="FinSuppFn-v-chk65"><span class="kn">Lemma</span> <span class="nf">succ_fsfun_eq</span> (<span class="nv">f</span> : fsfun A <span class="mi">0</span>) (<span class="nv">n</span> : A) :
  succ_fsfun f n n = S (f n).</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>A</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>EqDecision0</var><span class="hyp-type"><b>: </b><span>EqDecision A</span></span></span><br><span><var>f</var><span class="hyp-type"><b>: </b><span>fsfun A <span class="mi">0</span></span></span></span><br><span><var>n</var><span class="hyp-type"><b>: </b><span>A</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">succ_fsfun f n n = S (f n)</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="FinSuppFn-v-chk66" style="display: none" type="checkbox"><label class="alectryon-input" for="FinSuppFn-v-chk66"><span class="kn">Proof</span>.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>A</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>EqDecision0</var><span class="hyp-type"><b>: </b><span>EqDecision A</span></span></span><br><span><var>f</var><span class="hyp-type"><b>: </b><span>fsfun A <span class="mi">0</span></span></span></span><br><span><var>n</var><span class="hyp-type"><b>: </b><span>A</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">succ_fsfun f n n = S (f n)</div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="bp">by</span> <span class="nb">apply</span> update_fsfun_eq.</span><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Qed</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
</span><span class="alectryon-sentence"><input class="alectryon-toggle" id="FinSuppFn-v-chk67" style="display: none" type="checkbox"><label class="alectryon-input" for="FinSuppFn-v-chk67"><span class="kn">Lemma</span> <span class="nf">succ_fsfun_neq</span> (<span class="nv">f</span> : fsfun A <span class="mi">0</span>) (<span class="nv">n</span> : A) :
  <span class="kr">forall</span> (<span class="nv">m</span> : A), m &lt;&gt; n -&gt; succ_fsfun f n m = f m.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>A</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>EqDecision0</var><span class="hyp-type"><b>: </b><span>EqDecision A</span></span></span><br><span><var>f</var><span class="hyp-type"><b>: </b><span>fsfun A <span class="mi">0</span></span></span></span><br><span><var>n</var><span class="hyp-type"><b>: </b><span>A</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="kr">‚àÄ</span> <span class="nv">m</span> : A, m ‚â† n ‚Üí succ_fsfun f n m = f m</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="FinSuppFn-v-chk68" style="display: none" type="checkbox"><label class="alectryon-input" for="FinSuppFn-v-chk68"><span class="kn">Proof</span>.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>A</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>EqDecision0</var><span class="hyp-type"><b>: </b><span>EqDecision A</span></span></span><br><span><var>f</var><span class="hyp-type"><b>: </b><span>fsfun A <span class="mi">0</span></span></span></span><br><span><var>n</var><span class="hyp-type"><b>: </b><span>A</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="kr">‚àÄ</span> <span class="nv">m</span> : A, m ‚â† n ‚Üí succ_fsfun f n m = f m</div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="bp">by</span> <span class="nb">apply</span> update_fsfun_neq.</span><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Qed</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
</span><span class="alectryon-sentence"><input class="alectryon-toggle" id="FinSuppFn-v-chk69" style="display: none" type="checkbox"><label class="alectryon-input" for="FinSuppFn-v-chk69">#[export] <span class="kn">Instance</span> <span class="nf">succ_fsfun_proper</span> :
  Proper ((‚â°) ==&gt; (=) ==&gt; (‚â°)) succ_fsfun.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>A</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>EqDecision0</var><span class="hyp-type"><b>: </b><span>EqDecision A</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">Proper (equiv ==&gt; eq ==&gt; equiv) succ_fsfun</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="FinSuppFn-v-chk6a" style="display: none" type="checkbox"><label class="alectryon-input" for="FinSuppFn-v-chk6a"><span class="kn">Proof</span>.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>A</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>EqDecision0</var><span class="hyp-type"><b>: </b><span>EqDecision A</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">Proper (equiv ==&gt; eq ==&gt; equiv) succ_fsfun</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="FinSuppFn-v-chk6b" style="display: none" type="checkbox"><label class="alectryon-input" for="FinSuppFn-v-chk6b"><span class="nb">intros</span> f g Heqv _n n -&gt;.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>A</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>EqDecision0</var><span class="hyp-type"><b>: </b><span>EqDecision A</span></span></span><br><span><var>f, g</var><span class="hyp-type"><b>: </b><span>fsfun A <span class="mi">0</span></span></span></span><br><span><var>Heqv</var><span class="hyp-type"><b>: </b><span>f ‚â° g</span></span></span><br><span><var>n</var><span class="hyp-type"><b>: </b><span>A</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">succ_fsfun f n ‚â° succ_fsfun g n</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><span class="alectryon-input"><span class="bp">by</span> <span class="nb">apply</span> update_fsfun_proper; [.. | <span class="nb">rewrite</span> Heqv].</span><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Qed</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
</span><span class="alectryon-sentence"><input class="alectryon-toggle" id="FinSuppFn-v-chk6c" style="display: none" type="checkbox"><label class="alectryon-input" for="FinSuppFn-v-chk6c"><span class="kn">Lemma</span> <span class="nf">elem_of_succ_fsfun</span> (<span class="nv">f</span> : fsfun A <span class="mi">0</span>) (<span class="nv">n</span> : A) :
  <span class="kr">forall</span> (<span class="nv">a</span> : A),
    a ‚àà fin_supp (succ_fsfun f n) &lt;-&gt; a = n \/ a ‚àà fin_supp f.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>A</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>EqDecision0</var><span class="hyp-type"><b>: </b><span>EqDecision A</span></span></span><br><span><var>f</var><span class="hyp-type"><b>: </b><span>fsfun A <span class="mi">0</span></span></span></span><br><span><var>n</var><span class="hyp-type"><b>: </b><span>A</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="kr">‚àÄ</span> <span class="nv">a</span> : A,
  a ‚àà fin_supp (succ_fsfun f n)
  ‚Üî a = n ‚à® a ‚àà fin_supp f</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="FinSuppFn-v-chk6d" style="display: none" type="checkbox"><label class="alectryon-input" for="FinSuppFn-v-chk6d"><span class="kn">Proof</span>.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>A</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>EqDecision0</var><span class="hyp-type"><b>: </b><span>EqDecision A</span></span></span><br><span><var>f</var><span class="hyp-type"><b>: </b><span>fsfun A <span class="mi">0</span></span></span></span><br><span><var>n</var><span class="hyp-type"><b>: </b><span>A</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="kr">‚àÄ</span> <span class="nv">a</span> : A,
  a ‚àà fin_supp (succ_fsfun f n)
  ‚Üî a = n ‚à® a ‚àà fin_supp f</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="FinSuppFn-v-chk6e" style="display: none" type="checkbox"><label class="alectryon-input" for="FinSuppFn-v-chk6e"><span class="nb">intros</span> a; <span class="nb">unfold</span> succ_fsfun.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>A</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>EqDecision0</var><span class="hyp-type"><b>: </b><span>EqDecision A</span></span></span><br><span><var>f</var><span class="hyp-type"><b>: </b><span>fsfun A <span class="mi">0</span></span></span></span><br><span><var>n, a</var><span class="hyp-type"><b>: </b><span>A</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">a ‚àà fin_supp (update_fsfun f n (S (f n)))
‚Üî a = n ‚à® a ‚àà fin_supp f</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="FinSuppFn-v-chk6f" style="display: none" type="checkbox"><label class="alectryon-input" for="FinSuppFn-v-chk6f"><span class="nb">rewrite</span> elem_of_update_fsfun.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>A</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>EqDecision0</var><span class="hyp-type"><b>: </b><span>EqDecision A</span></span></span><br><span><var>f</var><span class="hyp-type"><b>: </b><span>fsfun A <span class="mi">0</span></span></span></span><br><span><var>n, a</var><span class="hyp-type"><b>: </b><span>A</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">S (f n) = <span class="mi">0</span> ‚àß a ‚àà fin_supp f ‚àß a ‚â† n
‚à® S (f n) ‚â† <span class="mi">0</span> ‚àß (a ‚àà fin_supp f ‚à® a = n)
‚Üî a = n ‚à® a ‚àà fin_supp f</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><span class="alectryon-input"><span class="bp">by</span> <span class="nb">split</span>; itauto <span class="bp">lia</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Qed</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
</span><span class="alectryon-sentence"><input class="alectryon-toggle" id="FinSuppFn-v-chk70" style="display: none" type="checkbox"><label class="alectryon-input" for="FinSuppFn-v-chk70"><span class="kn">Lemma</span> <span class="nf">succ_fsfun_supp_in</span> (<span class="nv">f</span> : fsfun A <span class="mi">0</span>) (<span class="nv">n</span> : A) :
  n ‚àà fin_supp f -&gt; fin_supp (succ_fsfun f n) ‚â°‚Çö fin_supp f.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>A</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>EqDecision0</var><span class="hyp-type"><b>: </b><span>EqDecision A</span></span></span><br><span><var>f</var><span class="hyp-type"><b>: </b><span>fsfun A <span class="mi">0</span></span></span></span><br><span><var>n</var><span class="hyp-type"><b>: </b><span>A</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">n ‚àà fin_supp f
‚Üí fin_supp (succ_fsfun f n) ‚â°‚Çö fin_supp f</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="FinSuppFn-v-chk71" style="display: none" type="checkbox"><label class="alectryon-input" for="FinSuppFn-v-chk71"><span class="kn">Proof</span>.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>A</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>EqDecision0</var><span class="hyp-type"><b>: </b><span>EqDecision A</span></span></span><br><span><var>f</var><span class="hyp-type"><b>: </b><span>fsfun A <span class="mi">0</span></span></span></span><br><span><var>n</var><span class="hyp-type"><b>: </b><span>A</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">n ‚àà fin_supp f
‚Üí fin_supp (succ_fsfun f n) ‚â°‚Çö fin_supp f</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="FinSuppFn-v-chk72" style="display: none" type="checkbox"><label class="alectryon-input" for="FinSuppFn-v-chk72"><span class="nb">intros</span>.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>A</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>EqDecision0</var><span class="hyp-type"><b>: </b><span>EqDecision A</span></span></span><br><span><var>f</var><span class="hyp-type"><b>: </b><span>fsfun A <span class="mi">0</span></span></span></span><br><span><var>n</var><span class="hyp-type"><b>: </b><span>A</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>n ‚àà fin_supp f</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">fin_supp (succ_fsfun f n) ‚â°‚Çö fin_supp f</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="FinSuppFn-v-chk73" style="display: none" type="checkbox"><label class="alectryon-input" for="FinSuppFn-v-chk73"><span class="nb">apply</span> NoDup_Permutation; <span class="nb">intros</span>; [<span class="bp">by</span> <span class="nb">apply</span> fin_supp_NoDup.. |].</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>A</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>EqDecision0</var><span class="hyp-type"><b>: </b><span>EqDecision A</span></span></span><br><span><var>f</var><span class="hyp-type"><b>: </b><span>fsfun A <span class="mi">0</span></span></span></span><br><span><var>n</var><span class="hyp-type"><b>: </b><span>A</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>n ‚àà fin_supp f</span></span></span><br><span><var>x</var><span class="hyp-type"><b>: </b><span>A</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">x ‚àà fin_supp (succ_fsfun f n) ‚Üî x ‚àà fin_supp f</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="FinSuppFn-v-chk74" style="display: none" type="checkbox"><label class="alectryon-input" for="FinSuppFn-v-chk74"><span class="nb">rewrite</span> elem_of_succ_fsfun.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>A</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>EqDecision0</var><span class="hyp-type"><b>: </b><span>EqDecision A</span></span></span><br><span><var>f</var><span class="hyp-type"><b>: </b><span>fsfun A <span class="mi">0</span></span></span></span><br><span><var>n</var><span class="hyp-type"><b>: </b><span>A</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>n ‚àà fin_supp f</span></span></span><br><span><var>x</var><span class="hyp-type"><b>: </b><span>A</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">x = n ‚à® x ‚àà fin_supp f ‚Üî x ‚àà fin_supp f</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><span class="alectryon-input"><span class="bp">by</span> set_solver.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Qed</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
</span><span class="alectryon-sentence"><input class="alectryon-toggle" id="FinSuppFn-v-chk75" style="display: none" type="checkbox"><label class="alectryon-input" for="FinSuppFn-v-chk75"><span class="kn">Lemma</span> <span class="nf">succ_fsfun_supp_not_in</span> (<span class="nv">f</span> : fsfun A <span class="mi">0</span>) (<span class="nv">n</span> : A) :
  n ‚àâ fin_supp f -&gt; fin_supp (succ_fsfun f n) ‚â°‚Çö n :: fin_supp f.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>A</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>EqDecision0</var><span class="hyp-type"><b>: </b><span>EqDecision A</span></span></span><br><span><var>f</var><span class="hyp-type"><b>: </b><span>fsfun A <span class="mi">0</span></span></span></span><br><span><var>n</var><span class="hyp-type"><b>: </b><span>A</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">n ‚àâ fin_supp f
‚Üí fin_supp (succ_fsfun f n) ‚â°‚Çö n :: fin_supp f</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="FinSuppFn-v-chk76" style="display: none" type="checkbox"><label class="alectryon-input" for="FinSuppFn-v-chk76"><span class="kn">Proof</span>.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>A</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>EqDecision0</var><span class="hyp-type"><b>: </b><span>EqDecision A</span></span></span><br><span><var>f</var><span class="hyp-type"><b>: </b><span>fsfun A <span class="mi">0</span></span></span></span><br><span><var>n</var><span class="hyp-type"><b>: </b><span>A</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">n ‚àâ fin_supp f
‚Üí fin_supp (succ_fsfun f n) ‚â°‚Çö n :: fin_supp f</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="FinSuppFn-v-chk77" style="display: none" type="checkbox"><label class="alectryon-input" for="FinSuppFn-v-chk77"><span class="nb">intros</span>; <span class="nb">cbn</span>; <span class="nb">rewrite</span> list_annotate_forget.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>A</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>EqDecision0</var><span class="hyp-type"><b>: </b><span>EqDecision A</span></span></span><br><span><var>f</var><span class="hyp-type"><b>: </b><span>fsfun A <span class="mi">0</span></span></span></span><br><span><var>n</var><span class="hyp-type"><b>: </b><span>A</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>n ‚àâ fin_supp f</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">elements (update_supp f n (S (f n)))
‚â°‚Çö n :: fin_supp f</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="FinSuppFn-v-chk78" style="display: none" type="checkbox"><label class="alectryon-input" for="FinSuppFn-v-chk78"><span class="nb">unfold</span> update_supp; <span class="nb">rewrite</span> decide_False <span class="bp">by</span> <span class="bp">lia</span>.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>A</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>EqDecision0</var><span class="hyp-type"><b>: </b><span>EqDecision A</span></span></span><br><span><var>f</var><span class="hyp-type"><b>: </b><span>fsfun A <span class="mi">0</span></span></span></span><br><span><var>n</var><span class="hyp-type"><b>: </b><span>A</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>n ‚àâ fin_supp f</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">elements ({[n]} ‚à™ list_to_set (fin_supp f))
‚â°‚Çö n :: fin_supp f</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="FinSuppFn-v-chk79" style="display: none" type="checkbox"><label class="alectryon-input" for="FinSuppFn-v-chk79"><span class="nb">rewrite</span> @elements_union_singleton;
    [| <span class="bp">by</span> <span class="nb">typeclasses eauto</span> | <span class="bp">by</span> <span class="nb">rewrite</span> elem_of_list_to_set].</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>A</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>EqDecision0</var><span class="hyp-type"><b>: </b><span>EqDecision A</span></span></span><br><span><var>f</var><span class="hyp-type"><b>: </b><span>fsfun A <span class="mi">0</span></span></span></span><br><span><var>n</var><span class="hyp-type"><b>: </b><span>A</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>n ‚àâ fin_supp f</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">n :: elements (list_to_set (fin_supp f))
‚â°‚Çö n :: fin_supp f</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><span class="alectryon-input"><span class="bp">by</span> <span class="nb">constructor</span>; <span class="nb">eapply</span> @elements_list_to_set;
    [<span class="nb">typeclasses eauto</span> | <span class="nb">apply</span> fin_supp_NoDup].</span><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Qed</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
</span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Definition</span> <span class="nf">delta_nat_fsfun</span> (<span class="nv">n</span> : A) : fsfun A <span class="mi">0</span> :=
  succ_fsfun zero_fsfun n.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
</span><span class="alectryon-sentence"><input class="alectryon-toggle" id="FinSuppFn-v-chk7a" style="display: none" type="checkbox"><label class="alectryon-input" for="FinSuppFn-v-chk7a"><span class="kn">Lemma</span> <span class="nf">delta_nat_fsfun_eq</span> (<span class="nv">n</span> : A) :
  delta_nat_fsfun n n = <span class="mi">1</span>.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>A</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>EqDecision0</var><span class="hyp-type"><b>: </b><span>EqDecision A</span></span></span><br><span><var>n</var><span class="hyp-type"><b>: </b><span>A</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">delta_nat_fsfun n n = <span class="mi">1</span></div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="FinSuppFn-v-chk7b" style="display: none" type="checkbox"><label class="alectryon-input" for="FinSuppFn-v-chk7b"><span class="kn">Proof</span>.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>A</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>EqDecision0</var><span class="hyp-type"><b>: </b><span>EqDecision A</span></span></span><br><span><var>n</var><span class="hyp-type"><b>: </b><span>A</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">delta_nat_fsfun n n = <span class="mi">1</span></div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="bp">by</span> <span class="nb">apply</span> succ_fsfun_eq.</span><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Qed</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
</span><span class="alectryon-sentence"><input class="alectryon-toggle" id="FinSuppFn-v-chk7c" style="display: none" type="checkbox"><label class="alectryon-input" for="FinSuppFn-v-chk7c"><span class="kn">Lemma</span> <span class="nf">delta_nat_fsfun_neq</span> (<span class="nv">n</span> : A) :
  <span class="kr">forall</span> (<span class="nv">m</span> : A), m &lt;&gt; n -&gt; delta_nat_fsfun n m = <span class="mi">0</span>.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>A</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>EqDecision0</var><span class="hyp-type"><b>: </b><span>EqDecision A</span></span></span><br><span><var>n</var><span class="hyp-type"><b>: </b><span>A</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="kr">‚àÄ</span> <span class="nv">m</span> : A, m ‚â† n ‚Üí delta_nat_fsfun n m = <span class="mi">0</span></div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="FinSuppFn-v-chk7d" style="display: none" type="checkbox"><label class="alectryon-input" for="FinSuppFn-v-chk7d"><span class="kn">Proof</span>.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>A</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>EqDecision0</var><span class="hyp-type"><b>: </b><span>EqDecision A</span></span></span><br><span><var>n</var><span class="hyp-type"><b>: </b><span>A</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="kr">‚àÄ</span> <span class="nv">m</span> : A, m ‚â† n ‚Üí delta_nat_fsfun n m = <span class="mi">0</span></div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="bp">by</span> <span class="nb">apply</span> succ_fsfun_neq.</span><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Qed</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
</span><span class="alectryon-sentence"><input class="alectryon-toggle" id="FinSuppFn-v-chk7e" style="display: none" type="checkbox"><label class="alectryon-input" for="FinSuppFn-v-chk7e"><span class="kn">Lemma</span> <span class="nf">elem_of_delta_nat_fsfun</span> (<span class="nv">n</span> : A) :
  <span class="kr">forall</span> (<span class="nv">a</span> : A),
    a ‚àà fin_supp (delta_nat_fsfun n) &lt;-&gt; a = n.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>A</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>EqDecision0</var><span class="hyp-type"><b>: </b><span>EqDecision A</span></span></span><br><span><var>n</var><span class="hyp-type"><b>: </b><span>A</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="kr">‚àÄ</span> <span class="nv">a</span> : A, a ‚àà fin_supp (delta_nat_fsfun n) ‚Üî a = n</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="FinSuppFn-v-chk7f" style="display: none" type="checkbox"><label class="alectryon-input" for="FinSuppFn-v-chk7f"><span class="kn">Proof</span>.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>A</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>EqDecision0</var><span class="hyp-type"><b>: </b><span>EqDecision A</span></span></span><br><span><var>n</var><span class="hyp-type"><b>: </b><span>A</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="kr">‚àÄ</span> <span class="nv">a</span> : A, a ‚àà fin_supp (delta_nat_fsfun n) ‚Üî a = n</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="FinSuppFn-v-chk80" style="display: none" type="checkbox"><label class="alectryon-input" for="FinSuppFn-v-chk80"><span class="nb">intros</span> a.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>A</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>EqDecision0</var><span class="hyp-type"><b>: </b><span>EqDecision A</span></span></span><br><span><var>n, a</var><span class="hyp-type"><b>: </b><span>A</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">a ‚àà fin_supp (delta_nat_fsfun n) ‚Üî a = n</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="FinSuppFn-v-chk81" style="display: none" type="checkbox"><label class="alectryon-input" for="FinSuppFn-v-chk81"><span class="nb">unfold</span> delta_nat_fsfun.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>A</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>EqDecision0</var><span class="hyp-type"><b>: </b><span>EqDecision A</span></span></span><br><span><var>n, a</var><span class="hyp-type"><b>: </b><span>A</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">a ‚àà fin_supp (succ_fsfun zero_fsfun n) ‚Üî a = n</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="FinSuppFn-v-chk82" style="display: none" type="checkbox"><label class="alectryon-input" for="FinSuppFn-v-chk82"><span class="nb">rewrite</span> elem_of_succ_fsfun; <span class="nb">cbn</span>; <span class="nb">rewrite</span> elem_of_nil.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>A</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>EqDecision0</var><span class="hyp-type"><b>: </b><span>EqDecision A</span></span></span><br><span><var>n, a</var><span class="hyp-type"><b>: </b><span>A</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">a = n ‚à® <span class="kt">False</span> ‚Üî a = n</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><span class="alectryon-input"><span class="bp">by</span> itauto.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Qed</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
</span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Definition</span> <span class="nf">fsfun_sum</span> (<span class="nv">f</span> : fsfun A <span class="mi">0</span>) : nat :=
  sum_list_with f (fin_supp f).</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
</span><span class="alectryon-sentence"><input class="alectryon-toggle" id="FinSuppFn-v-chk83" style="display: none" type="checkbox"><label class="alectryon-input" for="FinSuppFn-v-chk83"><span class="kn">Lemma</span> <span class="nf">fsfun_sum_proper</span> : Proper ((‚â°) ==&gt; (=)) fsfun_sum.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>A</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>EqDecision0</var><span class="hyp-type"><b>: </b><span>EqDecision A</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">Proper (equiv ==&gt; eq) fsfun_sum</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="FinSuppFn-v-chk84" style="display: none" type="checkbox"><label class="alectryon-input" for="FinSuppFn-v-chk84"><span class="kn">Proof</span>.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>A</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>EqDecision0</var><span class="hyp-type"><b>: </b><span>EqDecision A</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">Proper (equiv ==&gt; eq) fsfun_sum</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="FinSuppFn-v-chk85" style="display: none" type="checkbox"><label class="alectryon-input" for="FinSuppFn-v-chk85"><span class="nb">intros</span> f g Heqv.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>A</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>EqDecision0</var><span class="hyp-type"><b>: </b><span>EqDecision A</span></span></span><br><span><var>f, g</var><span class="hyp-type"><b>: </b><span>fsfun A <span class="mi">0</span></span></span></span><br><span><var>Heqv</var><span class="hyp-type"><b>: </b><span>f ‚â° g</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">fsfun_sum f = fsfun_sum g</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="FinSuppFn-v-chk86" style="display: none" type="checkbox"><label class="alectryon-input" for="FinSuppFn-v-chk86"><span class="nb">unfold</span> fsfun_sum.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>A</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>EqDecision0</var><span class="hyp-type"><b>: </b><span>EqDecision A</span></span></span><br><span><var>f, g</var><span class="hyp-type"><b>: </b><span>fsfun A <span class="mi">0</span></span></span></span><br><span><var>Heqv</var><span class="hyp-type"><b>: </b><span>f ‚â° g</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">sum_list_with f (fin_supp f) =
sum_list_with g (fin_supp g)</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="FinSuppFn-v-chk87" style="display: none" type="checkbox"><label class="alectryon-input" for="FinSuppFn-v-chk87"><span class="nb">rewrite</span> (sum_list_with_proper f (fin_supp f) (fin_supp g)).</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>A</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>EqDecision0</var><span class="hyp-type"><b>: </b><span>EqDecision A</span></span></span><br><span><var>f, g</var><span class="hyp-type"><b>: </b><span>fsfun A <span class="mi">0</span></span></span></span><br><span><var>Heqv</var><span class="hyp-type"><b>: </b><span>f ‚â° g</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">sum_list_with f (fin_supp g) =
sum_list_with g (fin_supp g)</div></blockquote><div class="alectryon-extra-goals"><input class="alectryon-extra-goal-toggle" id="FinSuppFn-v-chk88" style="display: none" type="checkbox"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>A</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>EqDecision0</var><span class="hyp-type"><b>: </b><span>EqDecision A</span></span></span><br><span><var>f, g</var><span class="hyp-type"><b>: </b><span>fsfun A <span class="mi">0</span></span></span></span><br><span><var>Heqv</var><span class="hyp-type"><b>: </b><span>f ‚â° g</span></span></span><br></div><label class="goal-separator" for="FinSuppFn-v-chk88"><hr></label><div class="goal-conclusion">fin_supp f ‚â°‚Çö fin_supp g</div></blockquote></div></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="FinSuppFn-v-chk89" style="display: none" type="checkbox"><label class="alectryon-input" for="FinSuppFn-v-chk89">-</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>A</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>EqDecision0</var><span class="hyp-type"><b>: </b><span>EqDecision A</span></span></span><br><span><var>f, g</var><span class="hyp-type"><b>: </b><span>fsfun A <span class="mi">0</span></span></span></span><br><span><var>Heqv</var><span class="hyp-type"><b>: </b><span>f ‚â° g</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">sum_list_with f (fin_supp g) =
sum_list_with g (fin_supp g)</div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="bp">by</span> <span class="nb">apply</span> sum_list_with_ext_forall; <span class="nb">intros</span>; <span class="nb">rewrite</span> Heqv.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="FinSuppFn-v-chk8a" style="display: none" type="checkbox"><label class="alectryon-input" for="FinSuppFn-v-chk8a">-</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>A</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>EqDecision0</var><span class="hyp-type"><b>: </b><span>EqDecision A</span></span></span><br><span><var>f, g</var><span class="hyp-type"><b>: </b><span>fsfun A <span class="mi">0</span></span></span></span><br><span><var>Heqv</var><span class="hyp-type"><b>: </b><span>f ‚â° g</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">fin_supp f ‚â°‚Çö fin_supp g</div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="bp">by</span> <span class="nb">apply</span> fin_supp_proper.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Qed</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
</span><span class="alectryon-sentence"><input class="alectryon-toggle" id="FinSuppFn-v-chk8b" style="display: none" type="checkbox"><label class="alectryon-input" for="FinSuppFn-v-chk8b"><span class="kn">Lemma</span> <span class="nf">fsfun_sum_zero_inv</span> (<span class="nv">f</span> : fsfun A <span class="mi">0</span>) :
  fsfun_sum f = <span class="mi">0</span> -&gt; f ‚â° zero_fsfun.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>A</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>EqDecision0</var><span class="hyp-type"><b>: </b><span>EqDecision A</span></span></span><br><span><var>f</var><span class="hyp-type"><b>: </b><span>fsfun A <span class="mi">0</span></span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">fsfun_sum f = <span class="mi">0</span> ‚Üí f ‚â° zero_fsfun</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="FinSuppFn-v-chk8c" style="display: none" type="checkbox"><label class="alectryon-input" for="FinSuppFn-v-chk8c"><span class="kn">Proof</span>.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>A</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>EqDecision0</var><span class="hyp-type"><b>: </b><span>EqDecision A</span></span></span><br><span><var>f</var><span class="hyp-type"><b>: </b><span>fsfun A <span class="mi">0</span></span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">fsfun_sum f = <span class="mi">0</span> ‚Üí f ‚â° zero_fsfun</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="FinSuppFn-v-chk8d" style="display: none" type="checkbox"><label class="alectryon-input" for="FinSuppFn-v-chk8d"><span class="nb">setoid_rewrite</span> sum_list_with_zero; <span class="nb">intros</span> Hall.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>A</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>EqDecision0</var><span class="hyp-type"><b>: </b><span>EqDecision A</span></span></span><br><span><var>f</var><span class="hyp-type"><b>: </b><span>fsfun A <span class="mi">0</span></span></span></span><br><span><var>Hall</var><span class="hyp-type"><b>: </b><span><span class="kr">‚àÄ</span> <span class="nv">i</span> : A, i ‚àà fin_supp f ‚Üí f i = <span class="mi">0</span></span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">f ‚â° zero_fsfun</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="FinSuppFn-v-chk8e" style="display: none" type="checkbox"><label class="alectryon-input" for="FinSuppFn-v-chk8e"><span class="nb">apply</span> fsfun_equiv_unfold; extensionality a; <span class="nb">cbn</span>.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>A</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>EqDecision0</var><span class="hyp-type"><b>: </b><span>EqDecision A</span></span></span><br><span><var>f</var><span class="hyp-type"><b>: </b><span>fsfun A <span class="mi">0</span></span></span></span><br><span><var>Hall</var><span class="hyp-type"><b>: </b><span><span class="kr">‚àÄ</span> <span class="nv">i</span> : A, i ‚àà fin_supp f ‚Üí f i = <span class="mi">0</span></span></span></span><br><span><var>a</var><span class="hyp-type"><b>: </b><span>A</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">f a = zero_fsfun a</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="FinSuppFn-v-chk8f" style="display: none" type="checkbox"><label class="alectryon-input" for="FinSuppFn-v-chk8f"><span class="nb">apply</span> dec_stable; <span class="nb">intro</span> Ha.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>A</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>EqDecision0</var><span class="hyp-type"><b>: </b><span>EqDecision A</span></span></span><br><span><var>f</var><span class="hyp-type"><b>: </b><span>fsfun A <span class="mi">0</span></span></span></span><br><span><var>Hall</var><span class="hyp-type"><b>: </b><span><span class="kr">‚àÄ</span> <span class="nv">i</span> : A, i ‚àà fin_supp f ‚Üí f i = <span class="mi">0</span></span></span></span><br><span><var>a</var><span class="hyp-type"><b>: </b><span>A</span></span></span><br><span><var>Ha</var><span class="hyp-type"><b>: </b><span>f a ‚â† zero_fsfun a</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="kt">False</span></div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="FinSuppFn-v-chk90" style="display: none" type="checkbox"><label class="alectryon-input" for="FinSuppFn-v-chk90"><span class="nb">apply</span> elem_of_fin_supp <span class="kr">in</span> Ha <span class="kr">as</span> Ha&#39;.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>A</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>EqDecision0</var><span class="hyp-type"><b>: </b><span>EqDecision A</span></span></span><br><span><var>f</var><span class="hyp-type"><b>: </b><span>fsfun A <span class="mi">0</span></span></span></span><br><span><var>Hall</var><span class="hyp-type"><b>: </b><span><span class="kr">‚àÄ</span> <span class="nv">i</span> : A, i ‚àà fin_supp f ‚Üí f i = <span class="mi">0</span></span></span></span><br><span><var>a</var><span class="hyp-type"><b>: </b><span>A</span></span></span><br><span><var>Ha</var><span class="hyp-type"><b>: </b><span>f a ‚â† zero_fsfun a</span></span></span><br><span><var>Ha'</var><span class="hyp-type"><b>: </b><span>a ‚àà fin_supp f</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="kt">False</span></div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><span class="alectryon-input"><span class="bp">by</span> <span class="nb">apply</span> Hall <span class="kr">in</span> Ha&#39;.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Qed</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
</span><span class="alectryon-sentence"><input class="alectryon-toggle" id="FinSuppFn-v-chk91" style="display: none" type="checkbox"><label class="alectryon-input" for="FinSuppFn-v-chk91"><span class="kn">Lemma</span> <span class="nf">fsfun_sum_succ</span> (<span class="nv">f</span> : fsfun A <span class="mi">0</span>) (<span class="nv">n</span> : A) :
  fsfun_sum (succ_fsfun f n) = S (fsfun_sum f).</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>A</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>EqDecision0</var><span class="hyp-type"><b>: </b><span>EqDecision A</span></span></span><br><span><var>f</var><span class="hyp-type"><b>: </b><span>fsfun A <span class="mi">0</span></span></span></span><br><span><var>n</var><span class="hyp-type"><b>: </b><span>A</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">fsfun_sum (succ_fsfun f n) = S (fsfun_sum f)</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="FinSuppFn-v-chk92" style="display: none" type="checkbox"><label class="alectryon-input" for="FinSuppFn-v-chk92"><span class="kn">Proof</span>.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>A</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>EqDecision0</var><span class="hyp-type"><b>: </b><span>EqDecision A</span></span></span><br><span><var>f</var><span class="hyp-type"><b>: </b><span>fsfun A <span class="mi">0</span></span></span></span><br><span><var>n</var><span class="hyp-type"><b>: </b><span>A</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">fsfun_sum (succ_fsfun f n) = S (fsfun_sum f)</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="FinSuppFn-v-chk93" style="display: none" type="checkbox"><label class="alectryon-input" for="FinSuppFn-v-chk93"><span class="nb">unfold</span> fsfun_sum.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>A</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>EqDecision0</var><span class="hyp-type"><b>: </b><span>EqDecision A</span></span></span><br><span><var>f</var><span class="hyp-type"><b>: </b><span>fsfun A <span class="mi">0</span></span></span></span><br><span><var>n</var><span class="hyp-type"><b>: </b><span>A</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">sum_list_with (succ_fsfun f n)
  (fin_supp (succ_fsfun f n)) =
S (sum_list_with f (fin_supp f))</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="FinSuppFn-v-chk94" style="display: none" type="checkbox"><label class="alectryon-input" for="FinSuppFn-v-chk94"><span class="nb">destruct</span> (decide (n ‚àà fin_supp f)).</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>A</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>EqDecision0</var><span class="hyp-type"><b>: </b><span>EqDecision A</span></span></span><br><span><var>f</var><span class="hyp-type"><b>: </b><span>fsfun A <span class="mi">0</span></span></span></span><br><span><var>n</var><span class="hyp-type"><b>: </b><span>A</span></span></span><br><span><var>e</var><span class="hyp-type"><b>: </b><span>n ‚àà fin_supp f</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">sum_list_with (succ_fsfun f n)
  (fin_supp (succ_fsfun f n)) =
S (sum_list_with f (fin_supp f))</div></blockquote><div class="alectryon-extra-goals"><input class="alectryon-extra-goal-toggle" id="FinSuppFn-v-chk95" style="display: none" type="checkbox"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>A</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>EqDecision0</var><span class="hyp-type"><b>: </b><span>EqDecision A</span></span></span><br><span><var>f</var><span class="hyp-type"><b>: </b><span>fsfun A <span class="mi">0</span></span></span></span><br><span><var>n</var><span class="hyp-type"><b>: </b><span>A</span></span></span><br><span><var>n0</var><span class="hyp-type"><b>: </b><span>n ‚àâ fin_supp f</span></span></span><br></div><label class="goal-separator" for="FinSuppFn-v-chk95"><hr></label><div class="goal-conclusion">sum_list_with (succ_fsfun f n)
  (fin_supp (succ_fsfun f n)) =
S (sum_list_with f (fin_supp f))</div></blockquote></div></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="FinSuppFn-v-chk96" style="display: none" type="checkbox"><label class="alectryon-input" for="FinSuppFn-v-chk96">-</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>A</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>EqDecision0</var><span class="hyp-type"><b>: </b><span>EqDecision A</span></span></span><br><span><var>f</var><span class="hyp-type"><b>: </b><span>fsfun A <span class="mi">0</span></span></span></span><br><span><var>n</var><span class="hyp-type"><b>: </b><span>A</span></span></span><br><span><var>e</var><span class="hyp-type"><b>: </b><span>n ‚àà fin_supp f</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">sum_list_with (succ_fsfun f n)
  (fin_supp (succ_fsfun f n)) =
S (sum_list_with f (fin_supp f))</div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="FinSuppFn-v-chk97" style="display: none" type="checkbox"><label class="alectryon-input" for="FinSuppFn-v-chk97"><span class="nb">rewrite</span> succ_fsfun_supp_in <span class="bp">by</span> <span class="bp">done</span>.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>A</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>EqDecision0</var><span class="hyp-type"><b>: </b><span>EqDecision A</span></span></span><br><span><var>f</var><span class="hyp-type"><b>: </b><span>fsfun A <span class="mi">0</span></span></span></span><br><span><var>n</var><span class="hyp-type"><b>: </b><span>A</span></span></span><br><span><var>e</var><span class="hyp-type"><b>: </b><span>n ‚àà fin_supp f</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">sum_list_with (succ_fsfun f n) (fin_supp f) =
S (sum_list_with f (fin_supp f))</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="FinSuppFn-v-chk98" style="display: none" type="checkbox"><label class="alectryon-input" for="FinSuppFn-v-chk98"><span class="nb">pose proof</span> (Hnodup := fin_supp_NoDup f).</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>A</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>EqDecision0</var><span class="hyp-type"><b>: </b><span>EqDecision A</span></span></span><br><span><var>f</var><span class="hyp-type"><b>: </b><span>fsfun A <span class="mi">0</span></span></span></span><br><span><var>n</var><span class="hyp-type"><b>: </b><span>A</span></span></span><br><span><var>e</var><span class="hyp-type"><b>: </b><span>n ‚àà fin_supp f</span></span></span><br><span><var>Hnodup</var><span class="hyp-type"><b>: </b><span>NoDup (fin_supp f)</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">sum_list_with (succ_fsfun f n) (fin_supp f) =
S (sum_list_with f (fin_supp f))</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="FinSuppFn-v-chk99" style="display: none" type="checkbox"><label class="alectryon-input" for="FinSuppFn-v-chk99"><span class="nb">revert</span> Hnodup e; <span class="nb">cbn</span>.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>A</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>EqDecision0</var><span class="hyp-type"><b>: </b><span>EqDecision A</span></span></span><br><span><var>f</var><span class="hyp-type"><b>: </b><span>fsfun A <span class="mi">0</span></span></span></span><br><span><var>n</var><span class="hyp-type"><b>: </b><span>A</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">NoDup (fin_supp f)
‚Üí n ‚àà fin_supp f
  ‚Üí sum_list_with (succ_fsfun f n) (fin_supp f) =
    S (sum_list_with f (fin_supp f))</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="FinSuppFn-v-chk9a" style="display: none" type="checkbox"><label class="alectryon-input" for="FinSuppFn-v-chk9a"><span class="nb">generalize</span> (fin_supp f) <span class="kr">as</span> l; <span class="nb">induction</span> l; [<span class="bp">by</span> <span class="nb">inversion</span> <span class="mi">2</span> |].</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>A</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>EqDecision0</var><span class="hyp-type"><b>: </b><span>EqDecision A</span></span></span><br><span><var>f</var><span class="hyp-type"><b>: </b><span>fsfun A <span class="mi">0</span></span></span></span><br><span><var>n, a</var><span class="hyp-type"><b>: </b><span>A</span></span></span><br><span><var>l</var><span class="hyp-type"><b>: </b><span>list A</span></span></span><br><span><var>IHl</var><span class="hyp-type"><b>: </b><span>NoDup l
‚Üí n ‚àà l
  ‚Üí sum_list_with (succ_fsfun f n) l =
    S (sum_list_with f l)</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">NoDup (a :: l)
‚Üí n ‚àà a :: l
  ‚Üí sum_list_with (succ_fsfun f n) (a :: l) =
    S (sum_list_with f (a :: l))</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="FinSuppFn-v-chk9b" style="display: none" type="checkbox"><label class="alectryon-input" for="FinSuppFn-v-chk9b"><span class="nb">rewrite</span> list.NoDup_cons, elem_of_cons; <span class="nb">cbn</span>.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>A</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>EqDecision0</var><span class="hyp-type"><b>: </b><span>EqDecision A</span></span></span><br><span><var>f</var><span class="hyp-type"><b>: </b><span>fsfun A <span class="mi">0</span></span></span></span><br><span><var>n, a</var><span class="hyp-type"><b>: </b><span>A</span></span></span><br><span><var>l</var><span class="hyp-type"><b>: </b><span>list A</span></span></span><br><span><var>IHl</var><span class="hyp-type"><b>: </b><span>NoDup l
‚Üí n ‚àà l
  ‚Üí sum_list_with (succ_fsfun f n) l =
    S (sum_list_with f l)</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">(a ‚àâ l) ‚àß NoDup l
‚Üí n = a ‚à® n ‚àà l
  ‚Üí succ_fsfun f n a +
    sum_list_with (succ_fsfun f n) l =
    S (f a + sum_list_with f l)</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="FinSuppFn-v-chk9c" style="display: none" type="checkbox"><label class="alectryon-input" for="FinSuppFn-v-chk9c"><span class="nb">intros</span> [Ha Hnodup] [&lt;- | Hn].</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>A</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>EqDecision0</var><span class="hyp-type"><b>: </b><span>EqDecision A</span></span></span><br><span><var>f</var><span class="hyp-type"><b>: </b><span>fsfun A <span class="mi">0</span></span></span></span><br><span><var>n</var><span class="hyp-type"><b>: </b><span>A</span></span></span><br><span><var>l</var><span class="hyp-type"><b>: </b><span>list A</span></span></span><br><span><var>IHl</var><span class="hyp-type"><b>: </b><span>NoDup l
‚Üí n ‚àà l
  ‚Üí sum_list_with (succ_fsfun f n) l =
    S (sum_list_with f l)</span></span></span><br><span><var>Ha</var><span class="hyp-type"><b>: </b><span>n ‚àâ l</span></span></span><br><span><var>Hnodup</var><span class="hyp-type"><b>: </b><span>NoDup l</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">succ_fsfun f n n + sum_list_with (succ_fsfun f n) l =
S (f n + sum_list_with f l)</div></blockquote><div class="alectryon-extra-goals"><input class="alectryon-extra-goal-toggle" id="FinSuppFn-v-chk9d" style="display: none" type="checkbox"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>A</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>EqDecision0</var><span class="hyp-type"><b>: </b><span>EqDecision A</span></span></span><br><span><var>f</var><span class="hyp-type"><b>: </b><span>fsfun A <span class="mi">0</span></span></span></span><br><span><var>n, a</var><span class="hyp-type"><b>: </b><span>A</span></span></span><br><span><var>l</var><span class="hyp-type"><b>: </b><span>list A</span></span></span><br><span><var>IHl</var><span class="hyp-type"><b>: </b><span>NoDup l
‚Üí n ‚àà l
  ‚Üí sum_list_with (succ_fsfun f n) l =
    S (sum_list_with f l)</span></span></span><br><span><var>Ha</var><span class="hyp-type"><b>: </b><span>a ‚àâ l</span></span></span><br><span><var>Hnodup</var><span class="hyp-type"><b>: </b><span>NoDup l</span></span></span><br><span><var>Hn</var><span class="hyp-type"><b>: </b><span>n ‚àà l</span></span></span><br></div><label class="goal-separator" for="FinSuppFn-v-chk9d"><hr></label><div class="goal-conclusion">succ_fsfun f n a + sum_list_with (succ_fsfun f n) l =
S (f a + sum_list_with f l)</div></blockquote></div></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="FinSuppFn-v-chk9e" style="display: none" type="checkbox"><label class="alectryon-input" for="FinSuppFn-v-chk9e">+</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>A</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>EqDecision0</var><span class="hyp-type"><b>: </b><span>EqDecision A</span></span></span><br><span><var>f</var><span class="hyp-type"><b>: </b><span>fsfun A <span class="mi">0</span></span></span></span><br><span><var>n</var><span class="hyp-type"><b>: </b><span>A</span></span></span><br><span><var>l</var><span class="hyp-type"><b>: </b><span>list A</span></span></span><br><span><var>IHl</var><span class="hyp-type"><b>: </b><span>NoDup l
‚Üí n ‚àà l
  ‚Üí sum_list_with (succ_fsfun f n) l =
    S (sum_list_with f l)</span></span></span><br><span><var>Ha</var><span class="hyp-type"><b>: </b><span>n ‚àâ l</span></span></span><br><span><var>Hnodup</var><span class="hyp-type"><b>: </b><span>NoDup l</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">succ_fsfun f n n + sum_list_with (succ_fsfun f n) l =
S (f n + sum_list_with f l)</div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="FinSuppFn-v-chk9f" style="display: none" type="checkbox"><label class="alectryon-input" for="FinSuppFn-v-chk9f"><span class="nb">rewrite</span> succ_fsfun_eq; <span class="nb">cbn</span>.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>A</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>EqDecision0</var><span class="hyp-type"><b>: </b><span>EqDecision A</span></span></span><br><span><var>f</var><span class="hyp-type"><b>: </b><span>fsfun A <span class="mi">0</span></span></span></span><br><span><var>n</var><span class="hyp-type"><b>: </b><span>A</span></span></span><br><span><var>l</var><span class="hyp-type"><b>: </b><span>list A</span></span></span><br><span><var>IHl</var><span class="hyp-type"><b>: </b><span>NoDup l
‚Üí n ‚àà l
  ‚Üí sum_list_with (succ_fsfun f n) l =
    S (sum_list_with f l)</span></span></span><br><span><var>Ha</var><span class="hyp-type"><b>: </b><span>n ‚àâ l</span></span></span><br><span><var>Hnodup</var><span class="hyp-type"><b>: </b><span>NoDup l</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">S (f n + sum_list_with (succ_fsfun f n) l) =
S (f n + sum_list_with f l)</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">      </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="FinSuppFn-v-chka0" style="display: none" type="checkbox"><label class="alectryon-input" for="FinSuppFn-v-chka0"><span class="kp">do</span> <span class="mi">2</span> <span class="nb">f_equal</span>.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>A</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>EqDecision0</var><span class="hyp-type"><b>: </b><span>EqDecision A</span></span></span><br><span><var>f</var><span class="hyp-type"><b>: </b><span>fsfun A <span class="mi">0</span></span></span></span><br><span><var>n</var><span class="hyp-type"><b>: </b><span>A</span></span></span><br><span><var>l</var><span class="hyp-type"><b>: </b><span>list A</span></span></span><br><span><var>IHl</var><span class="hyp-type"><b>: </b><span>NoDup l
‚Üí n ‚àà l
  ‚Üí sum_list_with (succ_fsfun f n) l =
    S (sum_list_with f l)</span></span></span><br><span><var>Ha</var><span class="hyp-type"><b>: </b><span>n ‚àâ l</span></span></span><br><span><var>Hnodup</var><span class="hyp-type"><b>: </b><span>NoDup l</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">sum_list_with (succ_fsfun f n) l = sum_list_with f l</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">      </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="FinSuppFn-v-chka1" style="display: none" type="checkbox"><label class="alectryon-input" for="FinSuppFn-v-chka1"><span class="nb">apply</span> sum_list_with_ext_forall.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>A</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>EqDecision0</var><span class="hyp-type"><b>: </b><span>EqDecision A</span></span></span><br><span><var>f</var><span class="hyp-type"><b>: </b><span>fsfun A <span class="mi">0</span></span></span></span><br><span><var>n</var><span class="hyp-type"><b>: </b><span>A</span></span></span><br><span><var>l</var><span class="hyp-type"><b>: </b><span>list A</span></span></span><br><span><var>IHl</var><span class="hyp-type"><b>: </b><span>NoDup l
‚Üí n ‚àà l
  ‚Üí sum_list_with (succ_fsfun f n) l =
    S (sum_list_with f l)</span></span></span><br><span><var>Ha</var><span class="hyp-type"><b>: </b><span>n ‚àâ l</span></span></span><br><span><var>Hnodup</var><span class="hyp-type"><b>: </b><span>NoDup l</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="kr">‚àÄ</span> <span class="nv">i</span> : A, i ‚àà l ‚Üí succ_fsfun f n i = f i</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">      </span><span class="alectryon-sentence"><span class="alectryon-input"><span class="bp">by</span> <span class="nb">intros</span>; <span class="nb">rewrite</span> succ_fsfun_neq <span class="bp">by</span> set_solver.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="FinSuppFn-v-chka2" style="display: none" type="checkbox"><label class="alectryon-input" for="FinSuppFn-v-chka2">+</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>A</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>EqDecision0</var><span class="hyp-type"><b>: </b><span>EqDecision A</span></span></span><br><span><var>f</var><span class="hyp-type"><b>: </b><span>fsfun A <span class="mi">0</span></span></span></span><br><span><var>n, a</var><span class="hyp-type"><b>: </b><span>A</span></span></span><br><span><var>l</var><span class="hyp-type"><b>: </b><span>list A</span></span></span><br><span><var>IHl</var><span class="hyp-type"><b>: </b><span>NoDup l
‚Üí n ‚àà l
  ‚Üí sum_list_with (succ_fsfun f n) l =
    S (sum_list_with f l)</span></span></span><br><span><var>Ha</var><span class="hyp-type"><b>: </b><span>a ‚àâ l</span></span></span><br><span><var>Hnodup</var><span class="hyp-type"><b>: </b><span>NoDup l</span></span></span><br><span><var>Hn</var><span class="hyp-type"><b>: </b><span>n ‚àà l</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">succ_fsfun f n a + sum_list_with (succ_fsfun f n) l =
S (f a + sum_list_with f l)</div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="FinSuppFn-v-chka3" style="display: none" type="checkbox"><label class="alectryon-input" for="FinSuppFn-v-chka3"><span class="nb">rewrite</span> succ_fsfun_neq <span class="bp">by</span> set_solver.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>A</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>EqDecision0</var><span class="hyp-type"><b>: </b><span>EqDecision A</span></span></span><br><span><var>f</var><span class="hyp-type"><b>: </b><span>fsfun A <span class="mi">0</span></span></span></span><br><span><var>n, a</var><span class="hyp-type"><b>: </b><span>A</span></span></span><br><span><var>l</var><span class="hyp-type"><b>: </b><span>list A</span></span></span><br><span><var>IHl</var><span class="hyp-type"><b>: </b><span>NoDup l
‚Üí n ‚àà l
  ‚Üí sum_list_with (succ_fsfun f n) l =
    S (sum_list_with f l)</span></span></span><br><span><var>Ha</var><span class="hyp-type"><b>: </b><span>a ‚àâ l</span></span></span><br><span><var>Hnodup</var><span class="hyp-type"><b>: </b><span>NoDup l</span></span></span><br><span><var>Hn</var><span class="hyp-type"><b>: </b><span>n ‚àà l</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">f a + sum_list_with (succ_fsfun f n) l =
S (f a + sum_list_with f l)</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">      </span><span class="alectryon-sentence"><span class="alectryon-input"><span class="bp">by</span> <span class="nb">rewrite</span> IHl.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="FinSuppFn-v-chka4" style="display: none" type="checkbox"><label class="alectryon-input" for="FinSuppFn-v-chka4">-</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>A</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>EqDecision0</var><span class="hyp-type"><b>: </b><span>EqDecision A</span></span></span><br><span><var>f</var><span class="hyp-type"><b>: </b><span>fsfun A <span class="mi">0</span></span></span></span><br><span><var>n</var><span class="hyp-type"><b>: </b><span>A</span></span></span><br><span><var>n0</var><span class="hyp-type"><b>: </b><span>n ‚àâ fin_supp f</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">sum_list_with (succ_fsfun f n)
  (fin_supp (succ_fsfun f n)) =
S (sum_list_with f (fin_supp f))</div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="FinSuppFn-v-chka5" style="display: none" type="checkbox"><label class="alectryon-input" for="FinSuppFn-v-chka5"><span class="nb">rewrite</span> succ_fsfun_supp_not_in <span class="bp">by</span> <span class="bp">done</span>.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>A</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>EqDecision0</var><span class="hyp-type"><b>: </b><span>EqDecision A</span></span></span><br><span><var>f</var><span class="hyp-type"><b>: </b><span>fsfun A <span class="mi">0</span></span></span></span><br><span><var>n</var><span class="hyp-type"><b>: </b><span>A</span></span></span><br><span><var>n0</var><span class="hyp-type"><b>: </b><span>n ‚àâ fin_supp f</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">sum_list_with (succ_fsfun f n) (n :: fin_supp f) =
S (sum_list_with f (fin_supp f))</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="FinSuppFn-v-chka6" style="display: none" type="checkbox"><label class="alectryon-input" for="FinSuppFn-v-chka6"><span class="nb">cbn</span>; <span class="nb">rewrite</span> succ_fsfun_eq.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>A</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>EqDecision0</var><span class="hyp-type"><b>: </b><span>EqDecision A</span></span></span><br><span><var>f</var><span class="hyp-type"><b>: </b><span>fsfun A <span class="mi">0</span></span></span></span><br><span><var>n</var><span class="hyp-type"><b>: </b><span>A</span></span></span><br><span><var>n0</var><span class="hyp-type"><b>: </b><span>n ‚àâ fin_supp f</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">S (f n) + sum_list_with (succ_fsfun f n) (fin_supp f) =
S (sum_list_with f (fin_supp f))</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="FinSuppFn-v-chka7" style="display: none" type="checkbox"><label class="alectryon-input" for="FinSuppFn-v-chka7"><span class="nb">replace</span> (f n) <span class="kr">with</span> <span class="mi">0</span> <span class="bp">by</span> (<span class="nb">rewrite</span> elem_of_fin_supp <span class="kr">in</span> n0; <span class="nb">cbn</span> <span class="kr">in</span> n0; <span class="bp">lia</span>).</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>A</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>EqDecision0</var><span class="hyp-type"><b>: </b><span>EqDecision A</span></span></span><br><span><var>f</var><span class="hyp-type"><b>: </b><span>fsfun A <span class="mi">0</span></span></span></span><br><span><var>n</var><span class="hyp-type"><b>: </b><span>A</span></span></span><br><span><var>n0</var><span class="hyp-type"><b>: </b><span>n ‚àâ fin_supp f</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="mi">1</span> + sum_list_with (succ_fsfun f n) (fin_supp f) =
S (sum_list_with f (fin_supp f))</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="FinSuppFn-v-chka8" style="display: none" type="checkbox"><label class="alectryon-input" for="FinSuppFn-v-chka8"><span class="nb">cbn</span>; <span class="nb">f_equal</span>.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>A</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>EqDecision0</var><span class="hyp-type"><b>: </b><span>EqDecision A</span></span></span><br><span><var>f</var><span class="hyp-type"><b>: </b><span>fsfun A <span class="mi">0</span></span></span></span><br><span><var>n</var><span class="hyp-type"><b>: </b><span>A</span></span></span><br><span><var>n0</var><span class="hyp-type"><b>: </b><span>n ‚àâ fin_supp f</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">sum_list_with (succ_fsfun f n) (fin_supp f) =
sum_list_with f (fin_supp f)</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="FinSuppFn-v-chka9" style="display: none" type="checkbox"><label class="alectryon-input" for="FinSuppFn-v-chka9"><span class="nb">apply</span> sum_list_with_ext_forall.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>A</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>EqDecision0</var><span class="hyp-type"><b>: </b><span>EqDecision A</span></span></span><br><span><var>f</var><span class="hyp-type"><b>: </b><span>fsfun A <span class="mi">0</span></span></span></span><br><span><var>n</var><span class="hyp-type"><b>: </b><span>A</span></span></span><br><span><var>n0</var><span class="hyp-type"><b>: </b><span>n ‚àâ fin_supp f</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="kr">‚àÄ</span> <span class="nv">i</span> : A, i ‚àà fin_supp f ‚Üí succ_fsfun f n i = f i</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><span class="alectryon-input"><span class="bp">by</span> <span class="nb">intros</span>; <span class="nb">rewrite</span> succ_fsfun_neq; [| set_solver].</span><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Qed</span>.</span></span></pre><div class="doc">
The component-wise sum of two functions 
</div><pre class="alectryon-io highlight"><!-- Generator: Alectryon --><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Definition</span> <span class="nf">add_fsfun_supp</span> (<span class="nv">f1</span> <span class="nv">f2</span> : fsfun A <span class="mi">0</span>) : listset A :=
  list_to_set (fin_supp f1) ‚à™ list_to_set (fin_supp f2).</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
</span><span class="alectryon-sentence"><input class="alectryon-toggle" id="FinSuppFn-v-chkaa" style="display: none" type="checkbox"><label class="alectryon-input" for="FinSuppFn-v-chkaa"><span class="kn">Lemma</span> <span class="nf">add_fsfun_supp_all</span> (<span class="nv">f1</span> <span class="nv">f2</span> : fsfun A <span class="mi">0</span>) :
  Forall (<span class="kr">fun</span> <span class="nv">a</span> =&gt; f1 a + f2 a &lt;&gt; <span class="mi">0</span>)
    (elements (add_fsfun_supp f1 f2)).</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>A</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>EqDecision0</var><span class="hyp-type"><b>: </b><span>EqDecision A</span></span></span><br><span><var>f1, f2</var><span class="hyp-type"><b>: </b><span>fsfun A <span class="mi">0</span></span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">Forall (<span class="kr">Œª</span> <span class="nv">a</span> : A, f1 a + f2 a ‚â† <span class="mi">0</span>)
  (elements (add_fsfun_supp f1 f2))</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="FinSuppFn-v-chkab" style="display: none" type="checkbox"><label class="alectryon-input" for="FinSuppFn-v-chkab"><span class="kn">Proof</span>.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>A</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>EqDecision0</var><span class="hyp-type"><b>: </b><span>EqDecision A</span></span></span><br><span><var>f1, f2</var><span class="hyp-type"><b>: </b><span>fsfun A <span class="mi">0</span></span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">Forall (<span class="kr">Œª</span> <span class="nv">a</span> : A, f1 a + f2 a ‚â† <span class="mi">0</span>)
  (elements (add_fsfun_supp f1 f2))</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="FinSuppFn-v-chkac" style="display: none" type="checkbox"><label class="alectryon-input" for="FinSuppFn-v-chkac"><span class="nb">unfold</span> add_fsfun_supp; <span class="nb">apply</span> Forall_forall; <span class="nb">intros</span> a.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>A</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>EqDecision0</var><span class="hyp-type"><b>: </b><span>EqDecision A</span></span></span><br><span><var>f1, f2</var><span class="hyp-type"><b>: </b><span>fsfun A <span class="mi">0</span></span></span></span><br><span><var>a</var><span class="hyp-type"><b>: </b><span>A</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">a
‚àà elements
    (list_to_set (fin_supp f1)
     ‚à™ list_to_set (fin_supp f2)) ‚Üí f1 a + f2 a ‚â† <span class="mi">0</span></div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="FinSuppFn-v-chkad" style="display: none" type="checkbox"><label class="alectryon-input" for="FinSuppFn-v-chkad"><span class="nb">rewrite</span> elem_of_elements, elem_of_union, !elem_of_list_to_set,
    !elem_of_fin_supp.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>A</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>EqDecision0</var><span class="hyp-type"><b>: </b><span>EqDecision A</span></span></span><br><span><var>f1, f2</var><span class="hyp-type"><b>: </b><span>fsfun A <span class="mi">0</span></span></span></span><br><span><var>a</var><span class="hyp-type"><b>: </b><span>A</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">f1 a ‚â† <span class="mi">0</span> ‚à® f2 a ‚â† <span class="mi">0</span> ‚Üí f1 a + f2 a ‚â† <span class="mi">0</span></div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><span class="alectryon-input"><span class="bp">by</span> <span class="bp">lia</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Qed</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
</span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Program Definition</span> <span class="nf">add_fsfun</span> (<span class="nv">f1</span> <span class="nv">f2</span> : fsfun A <span class="mi">0</span>) : fsfun A <span class="mi">0</span> :=
  existT (<span class="kr">fun</span> <span class="nv">a</span> =&gt; f1 a + f2 a)
    {| enum := list_annotate (add_fsfun_supp_all f1 f2) |}.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="FinSuppFn-v-chkae" style="display: none" type="checkbox"><label class="alectryon-input" for="FinSuppFn-v-chkae"><span class="kn">Next Obligation</span>.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>A</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>EqDecision0</var><span class="hyp-type"><b>: </b><span>EqDecision A</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="kr">‚àÄ</span> <span class="nv">f1</span> <span class="nv">f2</span> : fsfun A <span class="mi">0</span>,
  NoDup (list_annotate (add_fsfun_supp_all f1 f2))</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="FinSuppFn-v-chkaf" style="display: none" type="checkbox"><label class="alectryon-input" for="FinSuppFn-v-chkaf"><span class="kn">Proof</span>.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>A</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>EqDecision0</var><span class="hyp-type"><b>: </b><span>EqDecision A</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="kr">‚àÄ</span> <span class="nv">f1</span> <span class="nv">f2</span> : fsfun A <span class="mi">0</span>,
  NoDup (list_annotate (add_fsfun_supp_all f1 f2))</div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="bp">by</span> <span class="nb">intros</span>; <span class="nb">apply</span> list_annotate_NoDup, NoDup_elements.</span><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Qed</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="FinSuppFn-v-chkb0" style="display: none" type="checkbox"><label class="alectryon-input" for="FinSuppFn-v-chkb0"><span class="kn">Next Obligation</span>.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>A</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>EqDecision0</var><span class="hyp-type"><b>: </b><span>EqDecision A</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="kr">‚àÄ</span> (<span class="nv">f1</span> <span class="nv">f2</span> : fsfun A <span class="mi">0</span>) (<span class="nv">x</span> : support <span class="mi">0</span>
                             (<span class="kr">Œª</span> <span class="nv">a</span> : A, f1 a + f2 a)),
  x ‚àà list_annotate (add_fsfun_supp_all f1 f2)</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="FinSuppFn-v-chkb1" style="display: none" type="checkbox"><label class="alectryon-input" for="FinSuppFn-v-chkb1"><span class="kn">Proof</span>.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>A</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>EqDecision0</var><span class="hyp-type"><b>: </b><span>EqDecision A</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="kr">‚àÄ</span> (<span class="nv">f1</span> <span class="nv">f2</span> : fsfun A <span class="mi">0</span>) (<span class="nv">x</span> : support <span class="mi">0</span>
                             (<span class="kr">Œª</span> <span class="nv">a</span> : A, f1 a + f2 a)),
  x ‚àà list_annotate (add_fsfun_supp_all f1 f2)</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="FinSuppFn-v-chkb2" style="display: none" type="checkbox"><label class="alectryon-input" for="FinSuppFn-v-chkb2"><span class="nb">intros</span>; destruct_dec_sig x a Ha Heq; <span class="nb">subst</span>.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>A</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>EqDecision0</var><span class="hyp-type"><b>: </b><span>EqDecision A</span></span></span><br><span><var>f1, f2</var><span class="hyp-type"><b>: </b><span>fsfun A <span class="mi">0</span></span></span></span><br><span><var>a</var><span class="hyp-type"><b>: </b><span>A</span></span></span><br><span><var>Ha</var><span class="hyp-type"><b>: </b><span>f1 a + f2 a ‚â† <span class="mi">0</span></span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">dexist a Ha ‚àà list_annotate (add_fsfun_supp_all f1 f2)</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="FinSuppFn-v-chkb3" style="display: none" type="checkbox"><label class="alectryon-input" for="FinSuppFn-v-chkb3"><span class="nb">apply</span> elem_of_list_annotate; <span class="nb">unfold</span> add_fsfun_supp.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>A</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>EqDecision0</var><span class="hyp-type"><b>: </b><span>EqDecision A</span></span></span><br><span><var>f1, f2</var><span class="hyp-type"><b>: </b><span>fsfun A <span class="mi">0</span></span></span></span><br><span><var>a</var><span class="hyp-type"><b>: </b><span>A</span></span></span><br><span><var>Ha</var><span class="hyp-type"><b>: </b><span>f1 a + f2 a ‚â† <span class="mi">0</span></span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">`(dexist a Ha)
‚àà elements
    (list_to_set (fin_supp f1)
     ‚à™ list_to_set (fin_supp f2))</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="FinSuppFn-v-chkb4" style="display: none" type="checkbox"><label class="alectryon-input" for="FinSuppFn-v-chkb4"><span class="nb">rewrite</span> elem_of_elements, !elem_of_union, !elem_of_list_to_set, !elem_of_fin_supp; <span class="nb">cbn</span>.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>A</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>EqDecision0</var><span class="hyp-type"><b>: </b><span>EqDecision A</span></span></span><br><span><var>f1, f2</var><span class="hyp-type"><b>: </b><span>fsfun A <span class="mi">0</span></span></span></span><br><span><var>a</var><span class="hyp-type"><b>: </b><span>A</span></span></span><br><span><var>Ha</var><span class="hyp-type"><b>: </b><span>f1 a + f2 a ‚â† <span class="mi">0</span></span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">f1 a ‚â† <span class="mi">0</span> ‚à® f2 a ‚â† <span class="mi">0</span></div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><span class="alectryon-input"><span class="bp">by</span> <span class="bp">lia</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Qed</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
</span><span class="alectryon-sentence"><input class="alectryon-toggle" id="FinSuppFn-v-chkb5" style="display: none" type="checkbox"><label class="alectryon-input" for="FinSuppFn-v-chkb5"><span class="kn">Lemma</span> <span class="nf">add_fsfun_rew</span> (<span class="nv">f1</span> <span class="nv">f2</span> : fsfun A <span class="mi">0</span>) (<span class="nv">a</span> : A) :
  add_fsfun f1 f2 a = f1 a + f2 a.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>A</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>EqDecision0</var><span class="hyp-type"><b>: </b><span>EqDecision A</span></span></span><br><span><var>f1, f2</var><span class="hyp-type"><b>: </b><span>fsfun A <span class="mi">0</span></span></span></span><br><span><var>a</var><span class="hyp-type"><b>: </b><span>A</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">add_fsfun f1 f2 a = f1 a + f2 a</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="FinSuppFn-v-chkb6" style="display: none" type="checkbox"><label class="alectryon-input" for="FinSuppFn-v-chkb6"><span class="kn">Proof</span>.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>A</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>EqDecision0</var><span class="hyp-type"><b>: </b><span>EqDecision A</span></span></span><br><span><var>f1, f2</var><span class="hyp-type"><b>: </b><span>fsfun A <span class="mi">0</span></span></span></span><br><span><var>a</var><span class="hyp-type"><b>: </b><span>A</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">add_fsfun f1 f2 a = f1 a + f2 a</div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="bp">done</span>.</span><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Qed</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
</span><span class="alectryon-sentence"><input class="alectryon-toggle" id="FinSuppFn-v-chkb7" style="display: none" type="checkbox"><label class="alectryon-input" for="FinSuppFn-v-chkb7">#[export] <span class="kn">Instance</span> <span class="nf">add_fsfun_proper</span> :
  Proper ((‚â°) ==&gt; (‚â°) ==&gt; (‚â°)) add_fsfun.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>A</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>EqDecision0</var><span class="hyp-type"><b>: </b><span>EqDecision A</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">Proper (equiv ==&gt; equiv ==&gt; equiv) add_fsfun</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="FinSuppFn-v-chkb8" style="display: none" type="checkbox"><label class="alectryon-input" for="FinSuppFn-v-chkb8"><span class="kn">Proof</span>.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>A</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>EqDecision0</var><span class="hyp-type"><b>: </b><span>EqDecision A</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">Proper (equiv ==&gt; equiv ==&gt; equiv) add_fsfun</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="FinSuppFn-v-chkb9" style="display: none" type="checkbox"><label class="alectryon-input" for="FinSuppFn-v-chkb9"><span class="nb">intros</span> f1 g1 Heqv1 f2 g2 Heqv2.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>A</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>EqDecision0</var><span class="hyp-type"><b>: </b><span>EqDecision A</span></span></span><br><span><var>f1, g1</var><span class="hyp-type"><b>: </b><span>fsfun A <span class="mi">0</span></span></span></span><br><span><var>Heqv1</var><span class="hyp-type"><b>: </b><span>f1 ‚â° g1</span></span></span><br><span><var>f2, g2</var><span class="hyp-type"><b>: </b><span>fsfun A <span class="mi">0</span></span></span></span><br><span><var>Heqv2</var><span class="hyp-type"><b>: </b><span>f2 ‚â° g2</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">add_fsfun f1 f2 ‚â° add_fsfun g1 g2</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="FinSuppFn-v-chkba" style="display: none" type="checkbox"><label class="alectryon-input" for="FinSuppFn-v-chkba"><span class="nb">apply</span> fsfun_equiv_unfold; extensionality a.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>A</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>EqDecision0</var><span class="hyp-type"><b>: </b><span>EqDecision A</span></span></span><br><span><var>f1, g1</var><span class="hyp-type"><b>: </b><span>fsfun A <span class="mi">0</span></span></span></span><br><span><var>Heqv1</var><span class="hyp-type"><b>: </b><span>f1 ‚â° g1</span></span></span><br><span><var>f2, g2</var><span class="hyp-type"><b>: </b><span>fsfun A <span class="mi">0</span></span></span></span><br><span><var>Heqv2</var><span class="hyp-type"><b>: </b><span>f2 ‚â° g2</span></span></span><br><span><var>a</var><span class="hyp-type"><b>: </b><span>A</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">add_fsfun f1 f2 a = add_fsfun g1 g2 a</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><span class="alectryon-input"><span class="bp">by</span> <span class="nb">rewrite</span> !add_fsfun_rew, Heqv1, Heqv2.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Qed</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
</span><span class="alectryon-sentence"><input class="alectryon-toggle" id="FinSuppFn-v-chkbb" style="display: none" type="checkbox"><label class="alectryon-input" for="FinSuppFn-v-chkbb"><span class="kn">Lemma</span> <span class="nf">elem_of_add_fsfun</span> (<span class="nv">f1</span> <span class="nv">f2</span> : fsfun A <span class="mi">0</span>) :
  <span class="kr">forall</span> (<span class="nv">a</span> : A),
    a ‚àà fin_supp (add_fsfun f1 f2) &lt;-&gt;
    a ‚àà fin_supp f1 \/ a ‚àà fin_supp f2.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>A</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>EqDecision0</var><span class="hyp-type"><b>: </b><span>EqDecision A</span></span></span><br><span><var>f1, f2</var><span class="hyp-type"><b>: </b><span>fsfun A <span class="mi">0</span></span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="kr">‚àÄ</span> <span class="nv">a</span> : A,
  a ‚àà fin_supp (add_fsfun f1 f2)
  ‚Üî a ‚àà fin_supp f1 ‚à® a ‚àà fin_supp f2</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="FinSuppFn-v-chkbc" style="display: none" type="checkbox"><label class="alectryon-input" for="FinSuppFn-v-chkbc"><span class="kn">Proof</span>.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>A</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>EqDecision0</var><span class="hyp-type"><b>: </b><span>EqDecision A</span></span></span><br><span><var>f1, f2</var><span class="hyp-type"><b>: </b><span>fsfun A <span class="mi">0</span></span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="kr">‚àÄ</span> <span class="nv">a</span> : A,
  a ‚àà fin_supp (add_fsfun f1 f2)
  ‚Üî a ‚àà fin_supp f1 ‚à® a ‚àà fin_supp f2</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="FinSuppFn-v-chkbd" style="display: none" type="checkbox"><label class="alectryon-input" for="FinSuppFn-v-chkbd"><span class="nb">intro</span>; <span class="nb">unfold</span> fin_supp <span class="nb">at</span> <span class="mi">1</span>; <span class="nb">cbn</span>.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>A</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>EqDecision0</var><span class="hyp-type"><b>: </b><span>EqDecision A</span></span></span><br><span><var>f1, f2</var><span class="hyp-type"><b>: </b><span>fsfun A <span class="mi">0</span></span></span></span><br><span><var>a</var><span class="hyp-type"><b>: </b><span>A</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">a
‚àà map proj1_sig
    (list_annotate (add_fsfun_supp_all f1 f2))
‚Üî a ‚àà fin_supp f1 ‚à® a ‚àà fin_supp f2</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="FinSuppFn-v-chkbe" style="display: none" type="checkbox"><label class="alectryon-input" for="FinSuppFn-v-chkbe"><span class="nb">rewrite</span> list_annotate_forget, elem_of_elements.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>A</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>EqDecision0</var><span class="hyp-type"><b>: </b><span>EqDecision A</span></span></span><br><span><var>f1, f2</var><span class="hyp-type"><b>: </b><span>fsfun A <span class="mi">0</span></span></span></span><br><span><var>a</var><span class="hyp-type"><b>: </b><span>A</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">a ‚àà add_fsfun_supp f1 f2
‚Üî a ‚àà fin_supp f1 ‚à® a ‚àà fin_supp f2</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="FinSuppFn-v-chkbf" style="display: none" type="checkbox"><label class="alectryon-input" for="FinSuppFn-v-chkbf"><span class="nb">unfold</span> add_fsfun_supp.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>A</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>EqDecision0</var><span class="hyp-type"><b>: </b><span>EqDecision A</span></span></span><br><span><var>f1, f2</var><span class="hyp-type"><b>: </b><span>fsfun A <span class="mi">0</span></span></span></span><br><span><var>a</var><span class="hyp-type"><b>: </b><span>A</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">a
‚àà list_to_set (fin_supp f1)
  ‚à™ list_to_set (fin_supp f2)
‚Üî a ‚àà fin_supp f1 ‚à® a ‚àà fin_supp f2</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><span class="alectryon-input"><span class="bp">by</span> <span class="nb">rewrite</span> elem_of_union, !elem_of_list_to_set.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Qed</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
</span><span class="alectryon-sentence"><input class="alectryon-toggle" id="FinSuppFn-v-chkc0" style="display: none" type="checkbox"><label class="alectryon-input" for="FinSuppFn-v-chkc0">#[export] <span class="kn">Instance</span> <span class="nf">add_fsfun_comm</span> : Comm (‚â°) add_fsfun.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>A</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>EqDecision0</var><span class="hyp-type"><b>: </b><span>EqDecision A</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">Comm equiv add_fsfun</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="FinSuppFn-v-chkc1" style="display: none" type="checkbox"><label class="alectryon-input" for="FinSuppFn-v-chkc1"><span class="kn">Proof</span>.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>A</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>EqDecision0</var><span class="hyp-type"><b>: </b><span>EqDecision A</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">Comm equiv add_fsfun</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="FinSuppFn-v-chkc2" style="display: none" type="checkbox"><label class="alectryon-input" for="FinSuppFn-v-chkc2"><span class="nb">intros</span> f1 f2; <span class="nb">apply</span> fsfun_equiv_unfold; extensionality a.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>A</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>EqDecision0</var><span class="hyp-type"><b>: </b><span>EqDecision A</span></span></span><br><span><var>f1, f2</var><span class="hyp-type"><b>: </b><span>fsfun A <span class="mi">0</span></span></span></span><br><span><var>a</var><span class="hyp-type"><b>: </b><span>A</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">add_fsfun f1 f2 a = add_fsfun f2 f1 a</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><span class="alectryon-input"><span class="bp">by</span> <span class="nb">rewrite</span> !add_fsfun_rew; <span class="bp">lia</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Qed</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
</span><span class="alectryon-sentence"><input class="alectryon-toggle" id="FinSuppFn-v-chkc3" style="display: none" type="checkbox"><label class="alectryon-input" for="FinSuppFn-v-chkc3">#[export] <span class="kn">Instance</span> <span class="nf">add_fsfun_left_id</span> :
  LeftId (‚â°) zero_fsfun add_fsfun.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>A</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>EqDecision0</var><span class="hyp-type"><b>: </b><span>EqDecision A</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">LeftId equiv zero_fsfun add_fsfun</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="FinSuppFn-v-chkc4" style="display: none" type="checkbox"><label class="alectryon-input" for="FinSuppFn-v-chkc4"><span class="kn">Proof</span>.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>A</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>EqDecision0</var><span class="hyp-type"><b>: </b><span>EqDecision A</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">LeftId equiv zero_fsfun add_fsfun</div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="bp">by</span> <span class="nb">intro</span>; <span class="nb">apply</span> fsfun_equiv_unfold; extensionality a.</span><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Qed</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
</span><span class="alectryon-sentence"><input class="alectryon-toggle" id="FinSuppFn-v-chkc5" style="display: none" type="checkbox"><label class="alectryon-input" for="FinSuppFn-v-chkc5">#[export] <span class="kn">Instance</span> <span class="nf">add_fsfun_right_id</span> :
  RightId (‚â°) zero_fsfun add_fsfun.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>A</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>EqDecision0</var><span class="hyp-type"><b>: </b><span>EqDecision A</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">RightId equiv zero_fsfun add_fsfun</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="FinSuppFn-v-chkc6" style="display: none" type="checkbox"><label class="alectryon-input" for="FinSuppFn-v-chkc6"><span class="kn">Proof</span>.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>A</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>EqDecision0</var><span class="hyp-type"><b>: </b><span>EqDecision A</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">RightId equiv zero_fsfun add_fsfun</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="FinSuppFn-v-chkc7" style="display: none" type="checkbox"><label class="alectryon-input" for="FinSuppFn-v-chkc7"><span class="nb">intro</span>; <span class="nb">apply</span> fsfun_equiv_unfold; extensionality a.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>A</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>EqDecision0</var><span class="hyp-type"><b>: </b><span>EqDecision A</span></span></span><br><span><var>x</var><span class="hyp-type"><b>: </b><span>fsfun A <span class="mi">0</span></span></span></span><br><span><var>a</var><span class="hyp-type"><b>: </b><span>A</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">add_fsfun x zero_fsfun a = x a</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><span class="alectryon-input"><span class="bp">by</span> <span class="nb">rewrite</span> add_fsfun_rew, zero_fsfun_rew; <span class="bp">lia</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Qed</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
</span><span class="alectryon-sentence"><input class="alectryon-toggle" id="FinSuppFn-v-chkc8" style="display: none" type="checkbox"><label class="alectryon-input" for="FinSuppFn-v-chkc8">#[export] <span class="kn">Instance</span> <span class="nf">add_fsfun_assoc</span> : Assoc (‚â°) add_fsfun.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>A</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>EqDecision0</var><span class="hyp-type"><b>: </b><span>EqDecision A</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">Assoc equiv add_fsfun</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="FinSuppFn-v-chkc9" style="display: none" type="checkbox"><label class="alectryon-input" for="FinSuppFn-v-chkc9"><span class="kn">Proof</span>.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>A</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>EqDecision0</var><span class="hyp-type"><b>: </b><span>EqDecision A</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">Assoc equiv add_fsfun</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="FinSuppFn-v-chkca" style="display: none" type="checkbox"><label class="alectryon-input" for="FinSuppFn-v-chkca"><span class="nb">intros</span> f g h; <span class="nb">rewrite</span> !fsfun_equiv_unfold; extensionality a.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>A</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>EqDecision0</var><span class="hyp-type"><b>: </b><span>EqDecision A</span></span></span><br><span><var>f, g, h</var><span class="hyp-type"><b>: </b><span>fsfun A <span class="mi">0</span></span></span></span><br><span><var>a</var><span class="hyp-type"><b>: </b><span>A</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">add_fsfun f (add_fsfun g h) a =
add_fsfun (add_fsfun f g) h a</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><span class="alectryon-input"><span class="bp">by</span> <span class="nb">rewrite</span> !add_fsfun_rew; <span class="bp">lia</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Qed</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
</span><span class="alectryon-sentence"><input class="alectryon-toggle" id="FinSuppFn-v-chkcb" style="display: none" type="checkbox"><label class="alectryon-input" for="FinSuppFn-v-chkcb"><span class="kn">Lemma</span> <span class="nf">add_fsfun_succ_l</span> (<span class="nv">f1</span> <span class="nv">f2</span> : fsfun A <span class="mi">0</span>) :
  <span class="kr">forall</span> (<span class="nv">a</span> : A),
    add_fsfun (succ_fsfun f1 a) f2
      ‚â°
    succ_fsfun (add_fsfun f1 f2) a.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>A</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>EqDecision0</var><span class="hyp-type"><b>: </b><span>EqDecision A</span></span></span><br><span><var>f1, f2</var><span class="hyp-type"><b>: </b><span>fsfun A <span class="mi">0</span></span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="kr">‚àÄ</span> <span class="nv">a</span> : A,
  add_fsfun (succ_fsfun f1 a) f2
  ‚â° succ_fsfun (add_fsfun f1 f2) a</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="FinSuppFn-v-chkcc" style="display: none" type="checkbox"><label class="alectryon-input" for="FinSuppFn-v-chkcc"><span class="kn">Proof</span>.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>A</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>EqDecision0</var><span class="hyp-type"><b>: </b><span>EqDecision A</span></span></span><br><span><var>f1, f2</var><span class="hyp-type"><b>: </b><span>fsfun A <span class="mi">0</span></span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="kr">‚àÄ</span> <span class="nv">a</span> : A,
  add_fsfun (succ_fsfun f1 a) f2
  ‚â° succ_fsfun (add_fsfun f1 f2) a</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="FinSuppFn-v-chkcd" style="display: none" type="checkbox"><label class="alectryon-input" for="FinSuppFn-v-chkcd"><span class="nb">intros</span> a; <span class="nb">apply</span> fsfun_equiv_unfold; extensionality a&#39;.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>A</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>EqDecision0</var><span class="hyp-type"><b>: </b><span>EqDecision A</span></span></span><br><span><var>f1, f2</var><span class="hyp-type"><b>: </b><span>fsfun A <span class="mi">0</span></span></span></span><br><span><var>a, a'</var><span class="hyp-type"><b>: </b><span>A</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">add_fsfun (succ_fsfun f1 a) f2 a&#39; =
succ_fsfun (add_fsfun f1 f2) a a&#39;</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="FinSuppFn-v-chkce" style="display: none" type="checkbox"><label class="alectryon-input" for="FinSuppFn-v-chkce"><span class="nb">rewrite</span> add_fsfun_rew.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>A</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>EqDecision0</var><span class="hyp-type"><b>: </b><span>EqDecision A</span></span></span><br><span><var>f1, f2</var><span class="hyp-type"><b>: </b><span>fsfun A <span class="mi">0</span></span></span></span><br><span><var>a, a'</var><span class="hyp-type"><b>: </b><span>A</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">succ_fsfun f1 a a&#39; + f2 a&#39; =
succ_fsfun (add_fsfun f1 f2) a a&#39;</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="FinSuppFn-v-chkcf" style="display: none" type="checkbox"><label class="alectryon-input" for="FinSuppFn-v-chkcf"><span class="nb">destruct</span> (decide (a = a&#39;)) <span class="kr">as</span> [-&gt; |].</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>A</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>EqDecision0</var><span class="hyp-type"><b>: </b><span>EqDecision A</span></span></span><br><span><var>f1, f2</var><span class="hyp-type"><b>: </b><span>fsfun A <span class="mi">0</span></span></span></span><br><span><var>a'</var><span class="hyp-type"><b>: </b><span>A</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">succ_fsfun f1 a&#39; a&#39; + f2 a&#39; =
succ_fsfun (add_fsfun f1 f2) a&#39; a&#39;</div></blockquote><div class="alectryon-extra-goals"><input class="alectryon-extra-goal-toggle" id="FinSuppFn-v-chkd0" style="display: none" type="checkbox"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>A</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>EqDecision0</var><span class="hyp-type"><b>: </b><span>EqDecision A</span></span></span><br><span><var>f1, f2</var><span class="hyp-type"><b>: </b><span>fsfun A <span class="mi">0</span></span></span></span><br><span><var>a, a'</var><span class="hyp-type"><b>: </b><span>A</span></span></span><br><span><var>n</var><span class="hyp-type"><b>: </b><span>a ‚â† a&#39;</span></span></span><br></div><label class="goal-separator" for="FinSuppFn-v-chkd0"><hr></label><div class="goal-conclusion">succ_fsfun f1 a a&#39; + f2 a&#39; =
succ_fsfun (add_fsfun f1 f2) a a&#39;</div></blockquote></div></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="FinSuppFn-v-chkd1" style="display: none" type="checkbox"><label class="alectryon-input" for="FinSuppFn-v-chkd1">-</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>A</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>EqDecision0</var><span class="hyp-type"><b>: </b><span>EqDecision A</span></span></span><br><span><var>f1, f2</var><span class="hyp-type"><b>: </b><span>fsfun A <span class="mi">0</span></span></span></span><br><span><var>a'</var><span class="hyp-type"><b>: </b><span>A</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">succ_fsfun f1 a&#39; a&#39; + f2 a&#39; =
succ_fsfun (add_fsfun f1 f2) a&#39; a&#39;</div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="bp">by</span> <span class="nb">rewrite</span> !succ_fsfun_eq.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="FinSuppFn-v-chkd2" style="display: none" type="checkbox"><label class="alectryon-input" for="FinSuppFn-v-chkd2">-</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>A</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>EqDecision0</var><span class="hyp-type"><b>: </b><span>EqDecision A</span></span></span><br><span><var>f1, f2</var><span class="hyp-type"><b>: </b><span>fsfun A <span class="mi">0</span></span></span></span><br><span><var>a, a'</var><span class="hyp-type"><b>: </b><span>A</span></span></span><br><span><var>n</var><span class="hyp-type"><b>: </b><span>a ‚â† a&#39;</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">succ_fsfun f1 a a&#39; + f2 a&#39; =
succ_fsfun (add_fsfun f1 f2) a a&#39;</div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="bp">by</span> <span class="nb">rewrite</span> !succ_fsfun_neq.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Qed</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
</span><span class="alectryon-sentence"><input class="alectryon-toggle" id="FinSuppFn-v-chkd3" style="display: none" type="checkbox"><label class="alectryon-input" for="FinSuppFn-v-chkd3"><span class="kn">Lemma</span> <span class="nf">add_fsfun_succ_r</span> (<span class="nv">f1</span> <span class="nv">f2</span> : fsfun A <span class="mi">0</span>) :
  <span class="kr">forall</span> (<span class="nv">a</span> : A),
    add_fsfun f2 (succ_fsfun f1 a)
      ‚â°
    succ_fsfun (add_fsfun f2 f1) a.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>A</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>EqDecision0</var><span class="hyp-type"><b>: </b><span>EqDecision A</span></span></span><br><span><var>f1, f2</var><span class="hyp-type"><b>: </b><span>fsfun A <span class="mi">0</span></span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="kr">‚àÄ</span> <span class="nv">a</span> : A,
  add_fsfun f2 (succ_fsfun f1 a)
  ‚â° succ_fsfun (add_fsfun f2 f1) a</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="FinSuppFn-v-chkd4" style="display: none" type="checkbox"><label class="alectryon-input" for="FinSuppFn-v-chkd4"><span class="kn">Proof</span>.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>A</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>EqDecision0</var><span class="hyp-type"><b>: </b><span>EqDecision A</span></span></span><br><span><var>f1, f2</var><span class="hyp-type"><b>: </b><span>fsfun A <span class="mi">0</span></span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="kr">‚àÄ</span> <span class="nv">a</span> : A,
  add_fsfun f2 (succ_fsfun f1 a)
  ‚â° succ_fsfun (add_fsfun f2 f1) a</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><span class="alectryon-input"><span class="bp">by</span> <span class="nb">intros</span>; <span class="nb">rewrite</span> (comm add_fsfun), add_fsfun_succ_l,
    (comm add_fsfun).</span><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Qed</span>.</span></span></pre><div class="doc">
  To be able to prove things by induction on finitely supported functions on
  naturals we define the following inductive property and then we show that it
  holds for all such functions.

</div><pre class="alectryon-io highlight"><!-- Generator: Alectryon --><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Inductive</span> <span class="nf">NatFSFun</span> : fsfun A <span class="mi">0</span> -&gt; <span class="kt">Prop</span> :=
| P_zero :
    <span class="kr">forall</span> (<span class="nv">f&#39;</span> : fsfun A <span class="mi">0</span>), f&#39; ‚â° zero_fsfun -&gt;
    NatFSFun f&#39;
| P_succ :
    <span class="kr">forall</span> (<span class="nv">f</span> : fsfun A <span class="mi">0</span>), NatFSFun f -&gt;
    <span class="kr">forall</span> (<span class="nv">f&#39;</span> : fsfun A <span class="mi">0</span>) (<span class="nv">i</span> : A), f&#39; ‚â° succ_fsfun f i -&gt;
    NatFSFun f&#39;.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
</span><span class="alectryon-sentence"><input class="alectryon-toggle" id="FinSuppFn-v-chkd5" style="display: none" type="checkbox"><label class="alectryon-input" for="FinSuppFn-v-chkd5"><span class="kn">Lemma</span> <span class="nf">NatFSFun_complete</span> (<span class="nv">f</span> : fsfun A <span class="mi">0</span>) :  NatFSFun f.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>A</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>EqDecision0</var><span class="hyp-type"><b>: </b><span>EqDecision A</span></span></span><br><span><var>f</var><span class="hyp-type"><b>: </b><span>fsfun A <span class="mi">0</span></span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">NatFSFun f</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="FinSuppFn-v-chkd6" style="display: none" type="checkbox"><label class="alectryon-input" for="FinSuppFn-v-chkd6"><span class="kn">Proof</span>.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>A</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>EqDecision0</var><span class="hyp-type"><b>: </b><span>EqDecision A</span></span></span><br><span><var>f</var><span class="hyp-type"><b>: </b><span>fsfun A <span class="mi">0</span></span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">NatFSFun f</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="FinSuppFn-v-chkd7" style="display: none" type="checkbox"><label class="alectryon-input" for="FinSuppFn-v-chkd7"><span class="nb">remember</span> (fsfun_sum f) <span class="kr">as</span> n.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>A</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>EqDecision0</var><span class="hyp-type"><b>: </b><span>EqDecision A</span></span></span><br><span><var>f</var><span class="hyp-type"><b>: </b><span>fsfun A <span class="mi">0</span></span></span></span><br><span><var>n</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>Heqn</var><span class="hyp-type"><b>: </b><span>n = fsfun_sum f</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">NatFSFun f</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="FinSuppFn-v-chkd8" style="display: none" type="checkbox"><label class="alectryon-input" for="FinSuppFn-v-chkd8"><span class="nb">symmetry in</span> Heqn.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>A</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>EqDecision0</var><span class="hyp-type"><b>: </b><span>EqDecision A</span></span></span><br><span><var>f</var><span class="hyp-type"><b>: </b><span>fsfun A <span class="mi">0</span></span></span></span><br><span><var>n</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>Heqn</var><span class="hyp-type"><b>: </b><span>fsfun_sum f = n</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">NatFSFun f</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="FinSuppFn-v-chkd9" style="display: none" type="checkbox"><label class="alectryon-input" for="FinSuppFn-v-chkd9"><span class="nb">revert</span> f Heqn; <span class="nb">induction</span> n; <span class="nb">intros</span>;
    [<span class="bp">by</span> <span class="nb">apply</span> fsfun_sum_zero_inv <span class="kr">in</span> Heqn; <span class="nb">constructor</span> |].</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>A</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>EqDecision0</var><span class="hyp-type"><b>: </b><span>EqDecision A</span></span></span><br><span><var>n</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>IHn</var><span class="hyp-type"><b>: </b><span><span class="kr">‚àÄ</span> <span class="nv">f</span> : fsfun A <span class="mi">0</span>, fsfun_sum f = n ‚Üí NatFSFun f</span></span></span><br><span><var>f</var><span class="hyp-type"><b>: </b><span>fsfun A <span class="mi">0</span></span></span></span><br><span><var>Heqn</var><span class="hyp-type"><b>: </b><span>fsfun_sum f = S n</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">NatFSFun f</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="FinSuppFn-v-chkda" style="display: none" type="checkbox"><label class="alectryon-input" for="FinSuppFn-v-chkda"><span class="nb">assert</span> (Hex : Exists (<span class="kr">fun</span> (<span class="nv">i</span> : A) =&gt; f i &lt;&gt; <span class="mi">0</span>) (fin_supp f)).</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>A</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>EqDecision0</var><span class="hyp-type"><b>: </b><span>EqDecision A</span></span></span><br><span><var>n</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>IHn</var><span class="hyp-type"><b>: </b><span><span class="kr">‚àÄ</span> <span class="nv">f</span> : fsfun A <span class="mi">0</span>, fsfun_sum f = n ‚Üí NatFSFun f</span></span></span><br><span><var>f</var><span class="hyp-type"><b>: </b><span>fsfun A <span class="mi">0</span></span></span></span><br><span><var>Heqn</var><span class="hyp-type"><b>: </b><span>fsfun_sum f = S n</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">Exists (<span class="kr">Œª</span> <span class="nv">i</span> : A, f i ‚â† <span class="mi">0</span>) (fin_supp f)</div></blockquote><div class="alectryon-extra-goals"><input class="alectryon-extra-goal-toggle" id="FinSuppFn-v-chkdb" style="display: none" type="checkbox"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>A</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>EqDecision0</var><span class="hyp-type"><b>: </b><span>EqDecision A</span></span></span><br><span><var>n</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>IHn</var><span class="hyp-type"><b>: </b><span><span class="kr">‚àÄ</span> <span class="nv">f</span> : fsfun A <span class="mi">0</span>, fsfun_sum f = n ‚Üí NatFSFun f</span></span></span><br><span><var>f</var><span class="hyp-type"><b>: </b><span>fsfun A <span class="mi">0</span></span></span></span><br><span><var>Heqn</var><span class="hyp-type"><b>: </b><span>fsfun_sum f = S n</span></span></span><br><span><var>Hex</var><span class="hyp-type"><b>: </b><span>Exists (<span class="kr">Œª</span> <span class="nv">i</span> : A, f i ‚â† <span class="mi">0</span>) (fin_supp f)</span></span></span><br></div><label class="goal-separator" for="FinSuppFn-v-chkdb"><hr></label><div class="goal-conclusion">NatFSFun f</div></blockquote></div></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="FinSuppFn-v-chkdc" style="display: none" type="checkbox"><label class="alectryon-input" for="FinSuppFn-v-chkdc">{</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>A</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>EqDecision0</var><span class="hyp-type"><b>: </b><span>EqDecision A</span></span></span><br><span><var>n</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>IHn</var><span class="hyp-type"><b>: </b><span><span class="kr">‚àÄ</span> <span class="nv">f</span> : fsfun A <span class="mi">0</span>, fsfun_sum f = n ‚Üí NatFSFun f</span></span></span><br><span><var>f</var><span class="hyp-type"><b>: </b><span>fsfun A <span class="mi">0</span></span></span></span><br><span><var>Heqn</var><span class="hyp-type"><b>: </b><span>fsfun_sum f = S n</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">Exists (<span class="kr">Œª</span> <span class="nv">i</span> : A, f i ‚â† <span class="mi">0</span>) (fin_supp f)</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="FinSuppFn-v-chkdd" style="display: none" type="checkbox"><label class="alectryon-input" for="FinSuppFn-v-chkdd"><span class="nb">apply</span> dec_stable; <span class="nb">intros</span> Hex.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>A</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>EqDecision0</var><span class="hyp-type"><b>: </b><span>EqDecision A</span></span></span><br><span><var>n</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>IHn</var><span class="hyp-type"><b>: </b><span><span class="kr">‚àÄ</span> <span class="nv">f</span> : fsfun A <span class="mi">0</span>, fsfun_sum f = n ‚Üí NatFSFun f</span></span></span><br><span><var>f</var><span class="hyp-type"><b>: </b><span>fsfun A <span class="mi">0</span></span></span></span><br><span><var>Heqn</var><span class="hyp-type"><b>: </b><span>fsfun_sum f = S n</span></span></span><br><span><var>Hex</var><span class="hyp-type"><b>: </b><span>¬¨ Exists (<span class="kr">Œª</span> <span class="nv">i</span> : A, f i ‚â† <span class="mi">0</span>) (fin_supp f)</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="kt">False</span></div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="FinSuppFn-v-chkde" style="display: none" type="checkbox"><label class="alectryon-input" for="FinSuppFn-v-chkde"><span class="nb">apply</span> not_Exists_Forall <span class="kr">in</span> Hex; [| <span class="bp">by</span> <span class="nb">typeclasses eauto</span>].</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>A</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>EqDecision0</var><span class="hyp-type"><b>: </b><span>EqDecision A</span></span></span><br><span><var>n</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>IHn</var><span class="hyp-type"><b>: </b><span><span class="kr">‚àÄ</span> <span class="nv">f</span> : fsfun A <span class="mi">0</span>, fsfun_sum f = n ‚Üí NatFSFun f</span></span></span><br><span><var>f</var><span class="hyp-type"><b>: </b><span>fsfun A <span class="mi">0</span></span></span></span><br><span><var>Heqn</var><span class="hyp-type"><b>: </b><span>fsfun_sum f = S n</span></span></span><br><span><var>Hex</var><span class="hyp-type"><b>: </b><span>Forall (not ‚àò (<span class="kr">Œª</span> <span class="nv">i</span> : A, f i ‚â† <span class="mi">0</span>)) (fin_supp f)</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="kt">False</span></div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="FinSuppFn-v-chkdf" style="display: none" type="checkbox"><label class="alectryon-input" for="FinSuppFn-v-chkdf"><span class="nb">replace</span> (fsfun_sum f) <span class="kr">with</span> <span class="mi">0</span> <span class="kr">in</span> Heqn; [<span class="bp">done</span> |].</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>A</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>EqDecision0</var><span class="hyp-type"><b>: </b><span>EqDecision A</span></span></span><br><span><var>n</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>IHn</var><span class="hyp-type"><b>: </b><span><span class="kr">‚àÄ</span> <span class="nv">f</span> : fsfun A <span class="mi">0</span>, fsfun_sum f = n ‚Üí NatFSFun f</span></span></span><br><span><var>f</var><span class="hyp-type"><b>: </b><span>fsfun A <span class="mi">0</span></span></span></span><br><span><var>Heqn</var><span class="hyp-type"><b>: </b><span>fsfun_sum f = S n</span></span></span><br><span><var>Hex</var><span class="hyp-type"><b>: </b><span>Forall (not ‚àò (<span class="kr">Œª</span> <span class="nv">i</span> : A, f i ‚â† <span class="mi">0</span>)) (fin_supp f)</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="mi">0</span> = fsfun_sum f</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="FinSuppFn-v-chke0" style="display: none" type="checkbox"><label class="alectryon-input" for="FinSuppFn-v-chke0"><span class="nb">symmetry</span>.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>A</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>EqDecision0</var><span class="hyp-type"><b>: </b><span>EqDecision A</span></span></span><br><span><var>n</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>IHn</var><span class="hyp-type"><b>: </b><span><span class="kr">‚àÄ</span> <span class="nv">f</span> : fsfun A <span class="mi">0</span>, fsfun_sum f = n ‚Üí NatFSFun f</span></span></span><br><span><var>f</var><span class="hyp-type"><b>: </b><span>fsfun A <span class="mi">0</span></span></span></span><br><span><var>Heqn</var><span class="hyp-type"><b>: </b><span>fsfun_sum f = S n</span></span></span><br><span><var>Hex</var><span class="hyp-type"><b>: </b><span>Forall (not ‚àò (<span class="kr">Œª</span> <span class="nv">i</span> : A, f i ‚â† <span class="mi">0</span>)) (fin_supp f)</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">fsfun_sum f = <span class="mi">0</span></div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="FinSuppFn-v-chke1" style="display: none" type="checkbox"><label class="alectryon-input" for="FinSuppFn-v-chke1"><span class="nb">apply</span> sum_list_with_zero.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>A</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>EqDecision0</var><span class="hyp-type"><b>: </b><span>EqDecision A</span></span></span><br><span><var>n</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>IHn</var><span class="hyp-type"><b>: </b><span><span class="kr">‚àÄ</span> <span class="nv">f</span> : fsfun A <span class="mi">0</span>, fsfun_sum f = n ‚Üí NatFSFun f</span></span></span><br><span><var>f</var><span class="hyp-type"><b>: </b><span>fsfun A <span class="mi">0</span></span></span></span><br><span><var>Heqn</var><span class="hyp-type"><b>: </b><span>fsfun_sum f = S n</span></span></span><br><span><var>Hex</var><span class="hyp-type"><b>: </b><span>Forall (not ‚àò (<span class="kr">Œª</span> <span class="nv">i</span> : A, f i ‚â† <span class="mi">0</span>)) (fin_supp f)</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="kr">‚àÄ</span> <span class="nv">i</span> : A, i ‚àà fin_supp f ‚Üí f i = <span class="mi">0</span></div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="FinSuppFn-v-chke2" style="display: none" type="checkbox"><label class="alectryon-input" for="FinSuppFn-v-chke2"><span class="nb">intros</span> a Ha.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>A</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>EqDecision0</var><span class="hyp-type"><b>: </b><span>EqDecision A</span></span></span><br><span><var>n</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>IHn</var><span class="hyp-type"><b>: </b><span><span class="kr">‚àÄ</span> <span class="nv">f</span> : fsfun A <span class="mi">0</span>, fsfun_sum f = n ‚Üí NatFSFun f</span></span></span><br><span><var>f</var><span class="hyp-type"><b>: </b><span>fsfun A <span class="mi">0</span></span></span></span><br><span><var>Heqn</var><span class="hyp-type"><b>: </b><span>fsfun_sum f = S n</span></span></span><br><span><var>Hex</var><span class="hyp-type"><b>: </b><span>Forall (not ‚àò (<span class="kr">Œª</span> <span class="nv">i</span> : A, f i ‚â† <span class="mi">0</span>)) (fin_supp f)</span></span></span><br><span><var>a</var><span class="hyp-type"><b>: </b><span>A</span></span></span><br><span><var>Ha</var><span class="hyp-type"><b>: </b><span>a ‚àà fin_supp f</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">f a = <span class="mi">0</span></div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><span class="alectryon-input"><span class="bp">by</span> <span class="nb">rewrite</span> Forall_forall <span class="kr">in</span> Hex; <span class="nb">apply</span> Hex <span class="kr">in</span> Ha; <span class="nb">cbn</span> <span class="kr">in</span> Ha; <span class="bp">lia</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="FinSuppFn-v-chke3" style="display: none" type="checkbox"><label class="alectryon-input" for="FinSuppFn-v-chke3">}</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>A</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>EqDecision0</var><span class="hyp-type"><b>: </b><span>EqDecision A</span></span></span><br><span><var>n</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>IHn</var><span class="hyp-type"><b>: </b><span><span class="kr">‚àÄ</span> <span class="nv">f</span> : fsfun A <span class="mi">0</span>, fsfun_sum f = n ‚Üí NatFSFun f</span></span></span><br><span><var>f</var><span class="hyp-type"><b>: </b><span>fsfun A <span class="mi">0</span></span></span></span><br><span><var>Heqn</var><span class="hyp-type"><b>: </b><span>fsfun_sum f = S n</span></span></span><br><span><var>Hex</var><span class="hyp-type"><b>: </b><span>Exists (<span class="kr">Œª</span> <span class="nv">i</span> : A, f i ‚â† <span class="mi">0</span>) (fin_supp f)</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">NatFSFun f</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="FinSuppFn-v-chke4" style="display: none" type="checkbox"><label class="alectryon-input" for="FinSuppFn-v-chke4"><span class="nb">pose proof</span> (Hx := Exists_choose_first_good _ _ Hex); <span class="nb">cbn</span> <span class="kr">in</span> Hx.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>A</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>EqDecision0</var><span class="hyp-type"><b>: </b><span>EqDecision A</span></span></span><br><span><var>n</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>IHn</var><span class="hyp-type"><b>: </b><span><span class="kr">‚àÄ</span> <span class="nv">f</span> : fsfun A <span class="mi">0</span>, fsfun_sum f = n ‚Üí NatFSFun f</span></span></span><br><span><var>f</var><span class="hyp-type"><b>: </b><span>fsfun A <span class="mi">0</span></span></span></span><br><span><var>Heqn</var><span class="hyp-type"><b>: </b><span>fsfun_sum f = S n</span></span></span><br><span><var>Hex</var><span class="hyp-type"><b>: </b><span>Exists (<span class="kr">Œª</span> <span class="nv">i</span> : A, f i ‚â† <span class="mi">0</span>) (fin_supp f)</span></span></span><br><span><var>Hx</var><span class="hyp-type"><b>: </b><span>f (Exists_choose_first Hex) ‚â† <span class="mi">0</span></span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">NatFSFun f</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="FinSuppFn-v-chke5" style="display: none" type="checkbox"><label class="alectryon-input" for="FinSuppFn-v-chke5"><span class="nb">pose</span> (x := Exists_choose_first Hex).</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>A</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>EqDecision0</var><span class="hyp-type"><b>: </b><span>EqDecision A</span></span></span><br><span><var>n</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>IHn</var><span class="hyp-type"><b>: </b><span><span class="kr">‚àÄ</span> <span class="nv">f</span> : fsfun A <span class="mi">0</span>, fsfun_sum f = n ‚Üí NatFSFun f</span></span></span><br><span><var>f</var><span class="hyp-type"><b>: </b><span>fsfun A <span class="mi">0</span></span></span></span><br><span><var>Heqn</var><span class="hyp-type"><b>: </b><span>fsfun_sum f = S n</span></span></span><br><span><var>Hex</var><span class="hyp-type"><b>: </b><span>Exists (<span class="kr">Œª</span> <span class="nv">i</span> : A, f i ‚â† <span class="mi">0</span>) (fin_supp f)</span></span></span><br><span><var>Hx</var><span class="hyp-type"><b>: </b><span>f (Exists_choose_first Hex) ‚â† <span class="mi">0</span></span></span></span><br><span><var>x</var><span><span class="hyp-body"><b>:= </b><span>Exists_choose_first Hex</span></span><span class="hyp-type"><b>: </b><span>A</span></span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">NatFSFun f</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="FinSuppFn-v-chke6" style="display: none" type="checkbox"><label class="alectryon-input" for="FinSuppFn-v-chke6"><span class="nb">destruct</span> (f x) <span class="kr">as</span> [| px] <span class="nb">eqn</span>: Heqx; [<span class="bp">done</span> |]; <span class="nb">clear</span> Hx.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>A</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>EqDecision0</var><span class="hyp-type"><b>: </b><span>EqDecision A</span></span></span><br><span><var>n</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>IHn</var><span class="hyp-type"><b>: </b><span><span class="kr">‚àÄ</span> <span class="nv">f</span> : fsfun A <span class="mi">0</span>, fsfun_sum f = n ‚Üí NatFSFun f</span></span></span><br><span><var>f</var><span class="hyp-type"><b>: </b><span>fsfun A <span class="mi">0</span></span></span></span><br><span><var>Heqn</var><span class="hyp-type"><b>: </b><span>fsfun_sum f = S n</span></span></span><br><span><var>Hex</var><span class="hyp-type"><b>: </b><span>Exists (<span class="kr">Œª</span> <span class="nv">i</span> : A, f i ‚â† <span class="mi">0</span>) (fin_supp f)</span></span></span><br><span><var>x</var><span><span class="hyp-body"><b>:= </b><span>Exists_choose_first Hex</span></span><span class="hyp-type"><b>: </b><span>A</span></span></span></span><br><span><var>px</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>Heqx</var><span class="hyp-type"><b>: </b><span>f x = S px</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">NatFSFun f</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="FinSuppFn-v-chke7" style="display: none" type="checkbox"><label class="alectryon-input" for="FinSuppFn-v-chke7"><span class="nb">pose</span> (f&#39; := update_fsfun f x px).</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>A</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>EqDecision0</var><span class="hyp-type"><b>: </b><span>EqDecision A</span></span></span><br><span><var>n</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>IHn</var><span class="hyp-type"><b>: </b><span><span class="kr">‚àÄ</span> <span class="nv">f</span> : fsfun A <span class="mi">0</span>, fsfun_sum f = n ‚Üí NatFSFun f</span></span></span><br><span><var>f</var><span class="hyp-type"><b>: </b><span>fsfun A <span class="mi">0</span></span></span></span><br><span><var>Heqn</var><span class="hyp-type"><b>: </b><span>fsfun_sum f = S n</span></span></span><br><span><var>Hex</var><span class="hyp-type"><b>: </b><span>Exists (<span class="kr">Œª</span> <span class="nv">i</span> : A, f i ‚â† <span class="mi">0</span>) (fin_supp f)</span></span></span><br><span><var>x</var><span><span class="hyp-body"><b>:= </b><span>Exists_choose_first Hex</span></span><span class="hyp-type"><b>: </b><span>A</span></span></span></span><br><span><var>px</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>Heqx</var><span class="hyp-type"><b>: </b><span>f x = S px</span></span></span><br><span><var>f'</var><span><span class="hyp-body"><b>:= </b><span>update_fsfun f x px</span></span><span class="hyp-type"><b>: </b><span>fsfun A <span class="mi">0</span></span></span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">NatFSFun f</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="FinSuppFn-v-chke8" style="display: none" type="checkbox"><label class="alectryon-input" for="FinSuppFn-v-chke8"><span class="nb">assert</span> (Heq : f ‚â° succ_fsfun f&#39; x).</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>A</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>EqDecision0</var><span class="hyp-type"><b>: </b><span>EqDecision A</span></span></span><br><span><var>n</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>IHn</var><span class="hyp-type"><b>: </b><span><span class="kr">‚àÄ</span> <span class="nv">f</span> : fsfun A <span class="mi">0</span>, fsfun_sum f = n ‚Üí NatFSFun f</span></span></span><br><span><var>f</var><span class="hyp-type"><b>: </b><span>fsfun A <span class="mi">0</span></span></span></span><br><span><var>Heqn</var><span class="hyp-type"><b>: </b><span>fsfun_sum f = S n</span></span></span><br><span><var>Hex</var><span class="hyp-type"><b>: </b><span>Exists (<span class="kr">Œª</span> <span class="nv">i</span> : A, f i ‚â† <span class="mi">0</span>) (fin_supp f)</span></span></span><br><span><var>x</var><span><span class="hyp-body"><b>:= </b><span>Exists_choose_first Hex</span></span><span class="hyp-type"><b>: </b><span>A</span></span></span></span><br><span><var>px</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>Heqx</var><span class="hyp-type"><b>: </b><span>f x = S px</span></span></span><br><span><var>f'</var><span><span class="hyp-body"><b>:= </b><span>update_fsfun f x px</span></span><span class="hyp-type"><b>: </b><span>fsfun A <span class="mi">0</span></span></span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">f ‚â° succ_fsfun f&#39; x</div></blockquote><div class="alectryon-extra-goals"><input class="alectryon-extra-goal-toggle" id="FinSuppFn-v-chke9" style="display: none" type="checkbox"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>A</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>EqDecision0</var><span class="hyp-type"><b>: </b><span>EqDecision A</span></span></span><br><span><var>n</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>IHn</var><span class="hyp-type"><b>: </b><span><span class="kr">‚àÄ</span> <span class="nv">f</span> : fsfun A <span class="mi">0</span>, fsfun_sum f = n ‚Üí NatFSFun f</span></span></span><br><span><var>f</var><span class="hyp-type"><b>: </b><span>fsfun A <span class="mi">0</span></span></span></span><br><span><var>Heqn</var><span class="hyp-type"><b>: </b><span>fsfun_sum f = S n</span></span></span><br><span><var>Hex</var><span class="hyp-type"><b>: </b><span>Exists (<span class="kr">Œª</span> <span class="nv">i</span> : A, f i ‚â† <span class="mi">0</span>) (fin_supp f)</span></span></span><br><span><var>x</var><span><span class="hyp-body"><b>:= </b><span>Exists_choose_first Hex</span></span><span class="hyp-type"><b>: </b><span>A</span></span></span></span><br><span><var>px</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>Heqx</var><span class="hyp-type"><b>: </b><span>f x = S px</span></span></span><br><span><var>f'</var><span><span class="hyp-body"><b>:= </b><span>update_fsfun f x px</span></span><span class="hyp-type"><b>: </b><span>fsfun A <span class="mi">0</span></span></span></span></span><br><span><var>Heq</var><span class="hyp-type"><b>: </b><span>f ‚â° succ_fsfun f&#39; x</span></span></span><br></div><label class="goal-separator" for="FinSuppFn-v-chke9"><hr></label><div class="goal-conclusion">NatFSFun f</div></blockquote></div></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="FinSuppFn-v-chkea" style="display: none" type="checkbox"><label class="alectryon-input" for="FinSuppFn-v-chkea">{</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>A</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>EqDecision0</var><span class="hyp-type"><b>: </b><span>EqDecision A</span></span></span><br><span><var>n</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>IHn</var><span class="hyp-type"><b>: </b><span><span class="kr">‚àÄ</span> <span class="nv">f</span> : fsfun A <span class="mi">0</span>, fsfun_sum f = n ‚Üí NatFSFun f</span></span></span><br><span><var>f</var><span class="hyp-type"><b>: </b><span>fsfun A <span class="mi">0</span></span></span></span><br><span><var>Heqn</var><span class="hyp-type"><b>: </b><span>fsfun_sum f = S n</span></span></span><br><span><var>Hex</var><span class="hyp-type"><b>: </b><span>Exists (<span class="kr">Œª</span> <span class="nv">i</span> : A, f i ‚â† <span class="mi">0</span>) (fin_supp f)</span></span></span><br><span><var>x</var><span><span class="hyp-body"><b>:= </b><span>Exists_choose_first Hex</span></span><span class="hyp-type"><b>: </b><span>A</span></span></span></span><br><span><var>px</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>Heqx</var><span class="hyp-type"><b>: </b><span>f x = S px</span></span></span><br><span><var>f'</var><span><span class="hyp-body"><b>:= </b><span>update_fsfun f x px</span></span><span class="hyp-type"><b>: </b><span>fsfun A <span class="mi">0</span></span></span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">f ‚â° succ_fsfun f&#39; x</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="FinSuppFn-v-chkeb" style="display: none" type="checkbox"><label class="alectryon-input" for="FinSuppFn-v-chkeb"><span class="nb">subst</span> f&#39;; <span class="nb">apply</span> fsfun_equiv_unfold; extensionality a.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>A</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>EqDecision0</var><span class="hyp-type"><b>: </b><span>EqDecision A</span></span></span><br><span><var>n</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>IHn</var><span class="hyp-type"><b>: </b><span><span class="kr">‚àÄ</span> <span class="nv">f</span> : fsfun A <span class="mi">0</span>, fsfun_sum f = n ‚Üí NatFSFun f</span></span></span><br><span><var>f</var><span class="hyp-type"><b>: </b><span>fsfun A <span class="mi">0</span></span></span></span><br><span><var>Heqn</var><span class="hyp-type"><b>: </b><span>fsfun_sum f = S n</span></span></span><br><span><var>Hex</var><span class="hyp-type"><b>: </b><span>Exists (<span class="kr">Œª</span> <span class="nv">i</span> : A, f i ‚â† <span class="mi">0</span>) (fin_supp f)</span></span></span><br><span><var>x</var><span><span class="hyp-body"><b>:= </b><span>Exists_choose_first Hex</span></span><span class="hyp-type"><b>: </b><span>A</span></span></span></span><br><span><var>px</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>Heqx</var><span class="hyp-type"><b>: </b><span>f x = S px</span></span></span><br><span><var>a</var><span class="hyp-type"><b>: </b><span>A</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">f a = succ_fsfun (update_fsfun f x px) x a</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="FinSuppFn-v-chkec" style="display: none" type="checkbox"><label class="alectryon-input" for="FinSuppFn-v-chkec"><span class="nb">destruct</span> (decide (x = a)) <span class="kr">as</span> [-&gt; |].</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>A</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>EqDecision0</var><span class="hyp-type"><b>: </b><span>EqDecision A</span></span></span><br><span><var>n</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>IHn</var><span class="hyp-type"><b>: </b><span><span class="kr">‚àÄ</span> <span class="nv">f</span> : fsfun A <span class="mi">0</span>, fsfun_sum f = n ‚Üí NatFSFun f</span></span></span><br><span><var>f</var><span class="hyp-type"><b>: </b><span>fsfun A <span class="mi">0</span></span></span></span><br><span><var>Heqn</var><span class="hyp-type"><b>: </b><span>fsfun_sum f = S n</span></span></span><br><span><var>Hex</var><span class="hyp-type"><b>: </b><span>Exists (<span class="kr">Œª</span> <span class="nv">i</span> : A, f i ‚â† <span class="mi">0</span>) (fin_supp f)</span></span></span><br><span><var>px</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>a</var><span class="hyp-type"><b>: </b><span>A</span></span></span><br><span><var>Heqx</var><span class="hyp-type"><b>: </b><span>f a = S px</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">f a = succ_fsfun (update_fsfun f a px) a a</div></blockquote><div class="alectryon-extra-goals"><input class="alectryon-extra-goal-toggle" id="FinSuppFn-v-chked" style="display: none" type="checkbox"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>A</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>EqDecision0</var><span class="hyp-type"><b>: </b><span>EqDecision A</span></span></span><br><span><var>n</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>IHn</var><span class="hyp-type"><b>: </b><span><span class="kr">‚àÄ</span> <span class="nv">f</span> : fsfun A <span class="mi">0</span>, fsfun_sum f = n ‚Üí NatFSFun f</span></span></span><br><span><var>f</var><span class="hyp-type"><b>: </b><span>fsfun A <span class="mi">0</span></span></span></span><br><span><var>Heqn</var><span class="hyp-type"><b>: </b><span>fsfun_sum f = S n</span></span></span><br><span><var>Hex</var><span class="hyp-type"><b>: </b><span>Exists (<span class="kr">Œª</span> <span class="nv">i</span> : A, f i ‚â† <span class="mi">0</span>) (fin_supp f)</span></span></span><br><span><var>x</var><span><span class="hyp-body"><b>:= </b><span>Exists_choose_first Hex</span></span><span class="hyp-type"><b>: </b><span>A</span></span></span></span><br><span><var>px</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>Heqx</var><span class="hyp-type"><b>: </b><span>f x = S px</span></span></span><br><span><var>a</var><span class="hyp-type"><b>: </b><span>A</span></span></span><br><span><var>n0</var><span class="hyp-type"><b>: </b><span>x ‚â† a</span></span></span><br></div><label class="goal-separator" for="FinSuppFn-v-chked"><hr></label><div class="goal-conclusion">f a = succ_fsfun (update_fsfun f x px) x a</div></blockquote></div></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="FinSuppFn-v-chkee" style="display: none" type="checkbox"><label class="alectryon-input" for="FinSuppFn-v-chkee">-</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>A</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>EqDecision0</var><span class="hyp-type"><b>: </b><span>EqDecision A</span></span></span><br><span><var>n</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>IHn</var><span class="hyp-type"><b>: </b><span><span class="kr">‚àÄ</span> <span class="nv">f</span> : fsfun A <span class="mi">0</span>, fsfun_sum f = n ‚Üí NatFSFun f</span></span></span><br><span><var>f</var><span class="hyp-type"><b>: </b><span>fsfun A <span class="mi">0</span></span></span></span><br><span><var>Heqn</var><span class="hyp-type"><b>: </b><span>fsfun_sum f = S n</span></span></span><br><span><var>Hex</var><span class="hyp-type"><b>: </b><span>Exists (<span class="kr">Œª</span> <span class="nv">i</span> : A, f i ‚â† <span class="mi">0</span>) (fin_supp f)</span></span></span><br><span><var>px</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>a</var><span class="hyp-type"><b>: </b><span>A</span></span></span><br><span><var>Heqx</var><span class="hyp-type"><b>: </b><span>f a = S px</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">f a = succ_fsfun (update_fsfun f a px) a a</div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="bp">by</span> <span class="nb">rewrite</span> succ_fsfun_eq, update_fsfun_eq.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="FinSuppFn-v-chkef" style="display: none" type="checkbox"><label class="alectryon-input" for="FinSuppFn-v-chkef">-</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>A</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>EqDecision0</var><span class="hyp-type"><b>: </b><span>EqDecision A</span></span></span><br><span><var>n</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>IHn</var><span class="hyp-type"><b>: </b><span><span class="kr">‚àÄ</span> <span class="nv">f</span> : fsfun A <span class="mi">0</span>, fsfun_sum f = n ‚Üí NatFSFun f</span></span></span><br><span><var>f</var><span class="hyp-type"><b>: </b><span>fsfun A <span class="mi">0</span></span></span></span><br><span><var>Heqn</var><span class="hyp-type"><b>: </b><span>fsfun_sum f = S n</span></span></span><br><span><var>Hex</var><span class="hyp-type"><b>: </b><span>Exists (<span class="kr">Œª</span> <span class="nv">i</span> : A, f i ‚â† <span class="mi">0</span>) (fin_supp f)</span></span></span><br><span><var>x</var><span><span class="hyp-body"><b>:= </b><span>Exists_choose_first Hex</span></span><span class="hyp-type"><b>: </b><span>A</span></span></span></span><br><span><var>px</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>Heqx</var><span class="hyp-type"><b>: </b><span>f x = S px</span></span></span><br><span><var>a</var><span class="hyp-type"><b>: </b><span>A</span></span></span><br><span><var>n0</var><span class="hyp-type"><b>: </b><span>x ‚â† a</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">f a = succ_fsfun (update_fsfun f x px) x a</div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="bp">by</span> <span class="nb">rewrite</span> succ_fsfun_neq, update_fsfun_neq.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="FinSuppFn-v-chkf0" style="display: none" type="checkbox"><label class="alectryon-input" for="FinSuppFn-v-chkf0">}</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>A</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>EqDecision0</var><span class="hyp-type"><b>: </b><span>EqDecision A</span></span></span><br><span><var>n</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>IHn</var><span class="hyp-type"><b>: </b><span><span class="kr">‚àÄ</span> <span class="nv">f</span> : fsfun A <span class="mi">0</span>, fsfun_sum f = n ‚Üí NatFSFun f</span></span></span><br><span><var>f</var><span class="hyp-type"><b>: </b><span>fsfun A <span class="mi">0</span></span></span></span><br><span><var>Heqn</var><span class="hyp-type"><b>: </b><span>fsfun_sum f = S n</span></span></span><br><span><var>Hex</var><span class="hyp-type"><b>: </b><span>Exists (<span class="kr">Œª</span> <span class="nv">i</span> : A, f i ‚â† <span class="mi">0</span>) (fin_supp f)</span></span></span><br><span><var>x</var><span><span class="hyp-body"><b>:= </b><span>Exists_choose_first Hex</span></span><span class="hyp-type"><b>: </b><span>A</span></span></span></span><br><span><var>px</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>Heqx</var><span class="hyp-type"><b>: </b><span>f x = S px</span></span></span><br><span><var>f'</var><span><span class="hyp-body"><b>:= </b><span>update_fsfun f x px</span></span><span class="hyp-type"><b>: </b><span>fsfun A <span class="mi">0</span></span></span></span></span><br><span><var>Heq</var><span class="hyp-type"><b>: </b><span>f ‚â° succ_fsfun f&#39; x</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">NatFSFun f</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="FinSuppFn-v-chkf1" style="display: none" type="checkbox"><label class="alectryon-input" for="FinSuppFn-v-chkf1"><span class="nb">constructor</span> <span class="mi">2</span> <span class="kr">with</span> f&#39; x; [| <span class="bp">done</span>].</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>A</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>EqDecision0</var><span class="hyp-type"><b>: </b><span>EqDecision A</span></span></span><br><span><var>n</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>IHn</var><span class="hyp-type"><b>: </b><span><span class="kr">‚àÄ</span> <span class="nv">f</span> : fsfun A <span class="mi">0</span>, fsfun_sum f = n ‚Üí NatFSFun f</span></span></span><br><span><var>f</var><span class="hyp-type"><b>: </b><span>fsfun A <span class="mi">0</span></span></span></span><br><span><var>Heqn</var><span class="hyp-type"><b>: </b><span>fsfun_sum f = S n</span></span></span><br><span><var>Hex</var><span class="hyp-type"><b>: </b><span>Exists (<span class="kr">Œª</span> <span class="nv">i</span> : A, f i ‚â† <span class="mi">0</span>) (fin_supp f)</span></span></span><br><span><var>x</var><span><span class="hyp-body"><b>:= </b><span>Exists_choose_first Hex</span></span><span class="hyp-type"><b>: </b><span>A</span></span></span></span><br><span><var>px</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>Heqx</var><span class="hyp-type"><b>: </b><span>f x = S px</span></span></span><br><span><var>f'</var><span><span class="hyp-body"><b>:= </b><span>update_fsfun f x px</span></span><span class="hyp-type"><b>: </b><span>fsfun A <span class="mi">0</span></span></span></span></span><br><span><var>Heq</var><span class="hyp-type"><b>: </b><span>f ‚â° succ_fsfun f&#39; x</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">NatFSFun f&#39;</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="FinSuppFn-v-chkf2" style="display: none" type="checkbox"><label class="alectryon-input" for="FinSuppFn-v-chkf2"><span class="nb">apply</span> IHn; <span class="nb">subst</span> f&#39;.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>A</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>EqDecision0</var><span class="hyp-type"><b>: </b><span>EqDecision A</span></span></span><br><span><var>n</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>IHn</var><span class="hyp-type"><b>: </b><span><span class="kr">‚àÄ</span> <span class="nv">f</span> : fsfun A <span class="mi">0</span>, fsfun_sum f = n ‚Üí NatFSFun f</span></span></span><br><span><var>f</var><span class="hyp-type"><b>: </b><span>fsfun A <span class="mi">0</span></span></span></span><br><span><var>Heqn</var><span class="hyp-type"><b>: </b><span>fsfun_sum f = S n</span></span></span><br><span><var>Hex</var><span class="hyp-type"><b>: </b><span>Exists (<span class="kr">Œª</span> <span class="nv">i</span> : A, f i ‚â† <span class="mi">0</span>) (fin_supp f)</span></span></span><br><span><var>x</var><span><span class="hyp-body"><b>:= </b><span>Exists_choose_first Hex</span></span><span class="hyp-type"><b>: </b><span>A</span></span></span></span><br><span><var>px</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>Heqx</var><span class="hyp-type"><b>: </b><span>f x = S px</span></span></span><br><span><var>Heq</var><span class="hyp-type"><b>: </b><span>f ‚â° succ_fsfun (update_fsfun f x px) x</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">fsfun_sum (update_fsfun f x px) = n</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="FinSuppFn-v-chkf3" style="display: none" type="checkbox"><label class="alectryon-input" for="FinSuppFn-v-chkf3"><span class="nb">rewrite</span> fsfun_sum_proper <span class="kr">in</span> Heqn <span class="bp">by</span> <span class="bp">done</span>.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>A</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>EqDecision0</var><span class="hyp-type"><b>: </b><span>EqDecision A</span></span></span><br><span><var>n</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>IHn</var><span class="hyp-type"><b>: </b><span><span class="kr">‚àÄ</span> <span class="nv">f</span> : fsfun A <span class="mi">0</span>, fsfun_sum f = n ‚Üí NatFSFun f</span></span></span><br><span><var>f</var><span class="hyp-type"><b>: </b><span>fsfun A <span class="mi">0</span></span></span></span><br><span><var>Hex</var><span class="hyp-type"><b>: </b><span>Exists (<span class="kr">Œª</span> <span class="nv">i</span> : A, f i ‚â† <span class="mi">0</span>) (fin_supp f)</span></span></span><br><span><var>x</var><span><span class="hyp-body"><b>:= </b><span>Exists_choose_first Hex</span></span><span class="hyp-type"><b>: </b><span>A</span></span></span></span><br><span><var>px</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>Heqx</var><span class="hyp-type"><b>: </b><span>f x = S px</span></span></span><br><span><var>Heq</var><span class="hyp-type"><b>: </b><span>f ‚â° succ_fsfun (update_fsfun f x px) x</span></span></span><br><span><var>Heqn</var><span class="hyp-type"><b>: </b><span>fsfun_sum (succ_fsfun (update_fsfun f x px) x) =
S n</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">fsfun_sum (update_fsfun f x px) = n</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="FinSuppFn-v-chkf4" style="display: none" type="checkbox"><label class="alectryon-input" for="FinSuppFn-v-chkf4"><span class="nb">rewrite</span> fsfun_sum_succ <span class="kr">in</span> Heqn.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>A</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>EqDecision0</var><span class="hyp-type"><b>: </b><span>EqDecision A</span></span></span><br><span><var>n</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>IHn</var><span class="hyp-type"><b>: </b><span><span class="kr">‚àÄ</span> <span class="nv">f</span> : fsfun A <span class="mi">0</span>, fsfun_sum f = n ‚Üí NatFSFun f</span></span></span><br><span><var>f</var><span class="hyp-type"><b>: </b><span>fsfun A <span class="mi">0</span></span></span></span><br><span><var>Hex</var><span class="hyp-type"><b>: </b><span>Exists (<span class="kr">Œª</span> <span class="nv">i</span> : A, f i ‚â† <span class="mi">0</span>) (fin_supp f)</span></span></span><br><span><var>x</var><span><span class="hyp-body"><b>:= </b><span>Exists_choose_first Hex</span></span><span class="hyp-type"><b>: </b><span>A</span></span></span></span><br><span><var>px</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>Heqx</var><span class="hyp-type"><b>: </b><span>f x = S px</span></span></span><br><span><var>Heq</var><span class="hyp-type"><b>: </b><span>f ‚â° succ_fsfun (update_fsfun f x px) x</span></span></span><br><span><var>Heqn</var><span class="hyp-type"><b>: </b><span>S (fsfun_sum (update_fsfun f x px)) = S n</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">fsfun_sum (update_fsfun f x px) = n</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><span class="alectryon-input"><span class="bp">by</span> <span class="bp">congruence</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Qed</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
</span><span class="alectryon-sentence"><input class="alectryon-toggle" id="FinSuppFn-v-chkf5" style="display: none" type="checkbox"><label class="alectryon-input" for="FinSuppFn-v-chkf5"><span class="kn">Lemma</span> <span class="nf">nat_fsfun_inv</span> (<span class="nv">f</span> : fsfun A <span class="mi">0</span>) :
  f ‚â° zero_fsfun
    \/
  <span class="kr">exists</span> (<span class="nv">a</span> : A) (<span class="nv">f&#39;</span> : fsfun A <span class="mi">0</span>), f ‚â° succ_fsfun f&#39; a.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>A</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>EqDecision0</var><span class="hyp-type"><b>: </b><span>EqDecision A</span></span></span><br><span><var>f</var><span class="hyp-type"><b>: </b><span>fsfun A <span class="mi">0</span></span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">f ‚â° zero_fsfun
‚à® (<span class="kr">‚àÉ</span> (<span class="nv">a</span> : A) (<span class="nv">f&#39;</span> : fsfun A <span class="mi">0</span>), f ‚â° succ_fsfun f&#39; a)</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="FinSuppFn-v-chkf6" style="display: none" type="checkbox"><label class="alectryon-input" for="FinSuppFn-v-chkf6"><span class="kn">Proof</span>.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>A</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>EqDecision0</var><span class="hyp-type"><b>: </b><span>EqDecision A</span></span></span><br><span><var>f</var><span class="hyp-type"><b>: </b><span>fsfun A <span class="mi">0</span></span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">f ‚â° zero_fsfun
‚à® (<span class="kr">‚àÉ</span> (<span class="nv">a</span> : A) (<span class="nv">f&#39;</span> : fsfun A <span class="mi">0</span>), f ‚â° succ_fsfun f&#39; a)</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="FinSuppFn-v-chkf7" style="display: none" type="checkbox"><label class="alectryon-input" for="FinSuppFn-v-chkf7"><span class="nb">pose proof</span> (Hcomplete := NatFSFun_complete f).</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>A</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>EqDecision0</var><span class="hyp-type"><b>: </b><span>EqDecision A</span></span></span><br><span><var>f</var><span class="hyp-type"><b>: </b><span>fsfun A <span class="mi">0</span></span></span></span><br><span><var>Hcomplete</var><span class="hyp-type"><b>: </b><span>NatFSFun f</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">f ‚â° zero_fsfun
‚à® (<span class="kr">‚àÉ</span> (<span class="nv">a</span> : A) (<span class="nv">f&#39;</span> : fsfun A <span class="mi">0</span>), f ‚â° succ_fsfun f&#39; a)</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><span class="alectryon-input"><span class="bp">by</span> <span class="nb">inversion</span> Hcomplete; <span class="nb">subst</span>; [<span class="nb">left</span> | <span class="nb">right</span>; <span class="nb">eexists</span> _,_].</span><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Qed</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
</span><span class="alectryon-sentence"><input class="alectryon-toggle" id="FinSuppFn-v-chkf8" style="display: none" type="checkbox"><label class="alectryon-input" for="FinSuppFn-v-chkf8"><span class="kn">Lemma</span> <span class="nf">nat_fsfun_ind</span> (<span class="nv">P</span> : (fsfun A <span class="mi">0</span>) -&gt; <span class="kt">Prop</span>)
  (<span class="nv">Hproper</span> : Proper ((‚â°) ==&gt; impl) P)
  (<span class="nv">Hzero</span> : P zero_fsfun)
  (<span class="nv">Hsucc</span> : <span class="kr">forall</span> (<span class="nv">i</span> : A) (<span class="nv">f</span> : fsfun A <span class="mi">0</span>),
    P f -&gt; P (succ_fsfun f i)) :
  <span class="kr">forall</span> (<span class="nv">f</span> : fsfun A <span class="mi">0</span>), P f.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>A</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>EqDecision0</var><span class="hyp-type"><b>: </b><span>EqDecision A</span></span></span><br><span><var>P</var><span class="hyp-type"><b>: </b><span>fsfun A <span class="mi">0</span> ‚Üí <span class="kt">Prop</span></span></span></span><br><span><var>Hproper</var><span class="hyp-type"><b>: </b><span>Proper (equiv ==&gt; impl) P</span></span></span><br><span><var>Hzero</var><span class="hyp-type"><b>: </b><span>P zero_fsfun</span></span></span><br><span><var>Hsucc</var><span class="hyp-type"><b>: </b><span><span class="kr">‚àÄ</span> (<span class="nv">i</span> : A) (<span class="nv">f</span> : fsfun A <span class="mi">0</span>),
  P f ‚Üí P (succ_fsfun f i)</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="kr">‚àÄ</span> <span class="nv">f</span> : fsfun A <span class="mi">0</span>, P f</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="FinSuppFn-v-chkf9" style="display: none" type="checkbox"><label class="alectryon-input" for="FinSuppFn-v-chkf9"><span class="kn">Proof</span>.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>A</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>EqDecision0</var><span class="hyp-type"><b>: </b><span>EqDecision A</span></span></span><br><span><var>P</var><span class="hyp-type"><b>: </b><span>fsfun A <span class="mi">0</span> ‚Üí <span class="kt">Prop</span></span></span></span><br><span><var>Hproper</var><span class="hyp-type"><b>: </b><span>Proper (equiv ==&gt; impl) P</span></span></span><br><span><var>Hzero</var><span class="hyp-type"><b>: </b><span>P zero_fsfun</span></span></span><br><span><var>Hsucc</var><span class="hyp-type"><b>: </b><span><span class="kr">‚àÄ</span> (<span class="nv">i</span> : A) (<span class="nv">f</span> : fsfun A <span class="mi">0</span>),
  P f ‚Üí P (succ_fsfun f i)</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="kr">‚àÄ</span> <span class="nv">f</span> : fsfun A <span class="mi">0</span>, P f</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="FinSuppFn-v-chkfa" style="display: none" type="checkbox"><label class="alectryon-input" for="FinSuppFn-v-chkfa"><span class="nb">intros</span>.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>A</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>EqDecision0</var><span class="hyp-type"><b>: </b><span>EqDecision A</span></span></span><br><span><var>P</var><span class="hyp-type"><b>: </b><span>fsfun A <span class="mi">0</span> ‚Üí <span class="kt">Prop</span></span></span></span><br><span><var>Hproper</var><span class="hyp-type"><b>: </b><span>Proper (equiv ==&gt; impl) P</span></span></span><br><span><var>Hzero</var><span class="hyp-type"><b>: </b><span>P zero_fsfun</span></span></span><br><span><var>Hsucc</var><span class="hyp-type"><b>: </b><span><span class="kr">‚àÄ</span> (<span class="nv">i</span> : A) (<span class="nv">f</span> : fsfun A <span class="mi">0</span>),
  P f ‚Üí P (succ_fsfun f i)</span></span></span><br><span><var>f</var><span class="hyp-type"><b>: </b><span>fsfun A <span class="mi">0</span></span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">P f</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="FinSuppFn-v-chkfb" style="display: none" type="checkbox"><label class="alectryon-input" for="FinSuppFn-v-chkfb"><span class="nb">pose proof</span> (Hcomplete := NatFSFun_complete f).</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>A</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>EqDecision0</var><span class="hyp-type"><b>: </b><span>EqDecision A</span></span></span><br><span><var>P</var><span class="hyp-type"><b>: </b><span>fsfun A <span class="mi">0</span> ‚Üí <span class="kt">Prop</span></span></span></span><br><span><var>Hproper</var><span class="hyp-type"><b>: </b><span>Proper (equiv ==&gt; impl) P</span></span></span><br><span><var>Hzero</var><span class="hyp-type"><b>: </b><span>P zero_fsfun</span></span></span><br><span><var>Hsucc</var><span class="hyp-type"><b>: </b><span><span class="kr">‚àÄ</span> (<span class="nv">i</span> : A) (<span class="nv">f</span> : fsfun A <span class="mi">0</span>),
  P f ‚Üí P (succ_fsfun f i)</span></span></span><br><span><var>f</var><span class="hyp-type"><b>: </b><span>fsfun A <span class="mi">0</span></span></span></span><br><span><var>Hcomplete</var><span class="hyp-type"><b>: </b><span>NatFSFun f</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">P f</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><span class="alectryon-input"><span class="bp">by</span> <span class="nb">induction</span> Hcomplete <span class="kr">as</span> [| ? ? ? ? ? -&gt;];
    [<span class="nb">eapply</span> Hproper | <span class="nb">apply</span> Hsucc].</span><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Qed</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
</span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">End</span> <span class="nf">sec_fsfun_fixed_domain</span>.</span></span></pre></article></body></html>