<!DOCTYPE html>
<html class="alectryon-standalone"><head><title>BaseELMO.v</title><meta charset="utf-8"><meta content="Alectryon" name="generator"><meta name="viewport" content="width=device-width, initial-scale=1"><link href="alectryon.css" rel="stylesheet"><link href="pygments.css" rel="stylesheet">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/IBM-type/0.5.4/css/ibm-type.min.css" integrity="sha512-sky5cf9Ts6FY1kstGOBHSybfKqdHR41M0Ldb0BjNiv3ifltoQIsg0zIaQ+wwdwgQ0w9vKFW7Js50lxH9vqNSSw==" crossorigin="anonymous" />
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/firacode/5.2.0/fira_code.min.css" integrity="sha512-MbysAYimH1hH2xYzkkMHB6MqxBqfP0megxsCLknbYqHVwXTCg9IqHbk+ZP/vnhO8UEW6PaXAkKe2vQ+SWACxxA==" crossorigin="anonymous" /><script src="alectryon.js"></script></head><body><article class="alectryon-root alectryon-windowed alectryon-coqdoc"><div class="alectryon-banner">Built with <a href="https://github.com/cpitclaudel/alectryon/">Alectryon</a>, running Coq+SerAPI v8.18.0+0.18.1. Bubbles (<span class="alectryon-bubble"></span>) indicate interactive fragments: hover for details, tap to reveal contents. Use <kbd>Ctrl+‚Üë</kbd> <kbd>Ctrl+‚Üì</kbd> to navigate, <kbd>Ctrl+üñ±Ô∏è</kbd> to focus. On Mac, use <kbd>‚åò</kbd> instead of <kbd>Ctrl</kbd>.</div><pre class="alectryon-io highlight"><!-- Generator: Alectryon --><span class="alectryon-sentence"><input class="alectryon-toggle" id="BaseELMO-v-chk0" style="display: none" type="checkbox"><label class="alectryon-input" for="BaseELMO-v-chk0"><span class="kn">From</span> VLSM.Lib <span class="kn">Require Import</span> Itauto.</label><small class="alectryon-output"><div><div class="alectryon-messages"><blockquote class="alectryon-message">[Loading ML file ring_plugin.cmxs (<span class="nb">using</span> legacy method) ... <span class="bp">done</span>]</blockquote><blockquote class="alectryon-message">[Loading ML file zify_plugin.cmxs (<span class="nb">using</span> legacy method) ... <span class="bp">done</span>]</blockquote><blockquote class="alectryon-message">[Loading ML file micromega_plugin.cmxs (<span class="nb">using</span> legacy method) ... <span class="bp">done</span>]</blockquote><blockquote class="alectryon-message">[Loading ML file btauto_plugin.cmxs (<span class="nb">using</span> legacy method) ... <span class="bp">done</span>]</blockquote><blockquote class="alectryon-message">[Loading ML file coq-itauto.plugin ... <span class="bp">done</span>]</blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">From</span> stdpp <span class="kn">Require Import</span> prelude finite.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="BaseELMO-v-chk1" style="display: none" type="checkbox"><label class="alectryon-input" for="BaseELMO-v-chk1"><span class="kn">From</span> VLSM.Lib <span class="kn">Require Import</span> EquationsExtras.</label><small class="alectryon-output"><div><div class="alectryon-messages"><blockquote class="alectryon-message">[Loading ML file extraction_plugin.cmxs (<span class="nb">using</span> legacy method) ... <span class="bp">done</span>]</blockquote><blockquote class="alectryon-message">[Loading ML file equations_plugin.cmxs (<span class="nb">using</span> legacy method) ... <span class="bp">done</span>]</blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">From</span> VLSM.Lib <span class="kn">Require Import</span> Preamble StdppExtras Measurable.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">From</span> VLSM.Core <span class="kn">Require Import</span> VLSM PreloadedVLSM MessageDependencies.</span></span></pre><div class="doc">
<a id="lab1"></a><h1 class="section">ELMO: Basic Definitions and Results for UMO, MO and ELMO</h1>
<div class="paragraph"> </div>

  This module contains basic definitions and lemmas needed for the UMO, MO and
  ELMO protocols. In contrast to the paper, which uses natural numbers,
  we abstract over the implementation of an <span class="inlinecode"><span class="id" title="var">Address</span></span> by making it an arbitrary
  type with decidable equality.

</div><pre class="alectryon-io highlight"><!-- Generator: Alectryon --><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Section</span> <span class="nf">sec_base_ELMO</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
</span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Context</span>
  {<span class="nv">Address</span> : <span class="kt">Type</span>}
  `{EqDecision Address}.</span></span></pre><div class="doc">
<a id="lab2"></a><h2 class="section">Labels, States, Observations and Messages</h2>
</div><pre class="alectryon-io highlight"><!-- Generator: Alectryon --></pre><div class="doc">
Messages can be labeled as either sent or received. 
</div><pre class="alectryon-io highlight"><!-- Generator: Alectryon --><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Inductive</span> <span class="nf">Label</span> : <span class="kt">Type</span> :=
| Receive
| Send.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
</span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Inductive</span> <span class="nf">State</span> : <span class="kt">Type</span> := MkState
{
  obs : list Observation;
  adr  : Address;
}
<span class="kr">with</span> Observation : <span class="kt">Type</span> := MkObservation
{
  label   : Label;
  message : Message;
}
<span class="sd">(** A [Message] is a wrapper for [State]. *)</span>
<span class="kr">with</span> Message : <span class="kt">Type</span> := MkMessage
{
  state : State;
}.</span></span></pre><div class="doc">
<span class="inlinecode"><span class="id" title="var">State</span></span>s, <span class="inlinecode"><span class="id" title="var">Observation</span></span>s and <span class="inlinecode"><span class="id" title="var">Message</span></span>s are printed like ordinary inductive
  types, using their constructor names, instead of as records with the
  {| ... |} notation.

</div><pre class="alectryon-io highlight"><!-- Generator: Alectryon --><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Add Printing Constructor</span> State Observation Message.</span></span></pre><div class="doc">
Two states are equal when they have equal observations and equal addresses. 
</div><pre class="alectryon-io highlight"><!-- Generator: Alectryon --><span class="alectryon-sentence"><input class="alectryon-toggle" id="BaseELMO-v-chk2" style="display: none" type="checkbox"><label class="alectryon-input" for="BaseELMO-v-chk2"><span class="kn">Lemma</span> <span class="nf">eq_State</span> :
  <span class="kr">forall</span> <span class="nv">s1</span> <span class="nv">s2</span> : State,
    obs s1 = obs s2 -&gt; adr s1 = adr s2 -&gt; s1 = s2.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>Address</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>EqDecision0</var><span class="hyp-type"><b>: </b><span>EqDecision Address</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="kr">‚àÄ</span> <span class="nv">s1</span> <span class="nv">s2</span> : State,
  obs s1 = obs s2 ‚Üí adr s1 = adr s2 ‚Üí s1 = s2</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="BaseELMO-v-chk3" style="display: none" type="checkbox"><label class="alectryon-input" for="BaseELMO-v-chk3"><span class="kn">Proof</span>.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>Address</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>EqDecision0</var><span class="hyp-type"><b>: </b><span>EqDecision Address</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="kr">‚àÄ</span> <span class="nv">s1</span> <span class="nv">s2</span> : State,
  obs s1 = obs s2 ‚Üí adr s1 = adr s2 ‚Üí s1 = s2</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><span class="alectryon-input"><span class="bp">by</span> <span class="nb">intros</span> [] []; <span class="nb">cbn</span>; <span class="bp">congruence</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Qed</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
</span><span class="alectryon-sentence"><input class="alectryon-toggle" id="BaseELMO-v-chk4" style="display: none" type="checkbox"><label class="alectryon-input" for="BaseELMO-v-chk4"><span class="kn">Lemma</span> <span class="nf">eq_Message</span> :
  <span class="kr">forall</span> <span class="nv">m1</span> <span class="nv">m2</span> : Message,
    obs (state m1) = obs (state m2) -&gt; adr (state m1) = adr (state m2) -&gt; m1 = m2.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>Address</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>EqDecision0</var><span class="hyp-type"><b>: </b><span>EqDecision Address</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="kr">‚àÄ</span> <span class="nv">m1</span> <span class="nv">m2</span> : Message,
  obs (state m1) = obs (state m2)
  ‚Üí adr (state m1) = adr (state m2) ‚Üí m1 = m2</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="BaseELMO-v-chk5" style="display: none" type="checkbox"><label class="alectryon-input" for="BaseELMO-v-chk5"><span class="kn">Proof</span>.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>Address</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>EqDecision0</var><span class="hyp-type"><b>: </b><span>EqDecision Address</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="kr">‚àÄ</span> <span class="nv">m1</span> <span class="nv">m2</span> : Message,
  obs (state m1) = obs (state m2)
  ‚Üí adr (state m1) = adr (state m2) ‚Üí m1 = m2</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><span class="alectryon-input"><span class="bp">by</span> <span class="nb">intros</span> [[]] [[]]; <span class="nb">cbn</span>; <span class="bp">congruence</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Qed</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
</span><span class="alectryon-sentence"><input class="alectryon-toggle" id="BaseELMO-v-chk6" style="display: none" type="checkbox"><label class="alectryon-input" for="BaseELMO-v-chk6"><span class="kn">Lemma</span> <span class="nf">eq_Observation</span> :
  <span class="kr">forall</span> <span class="nv">ob1</span> <span class="nv">ob2</span> : Observation,
    label ob1 = label ob2 -&gt; message ob1 = message ob2 -&gt; ob1 = ob2.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>Address</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>EqDecision0</var><span class="hyp-type"><b>: </b><span>EqDecision Address</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="kr">‚àÄ</span> <span class="nv">ob1</span> <span class="nv">ob2</span> : Observation,
  label ob1 = label ob2
  ‚Üí message ob1 = message ob2 ‚Üí ob1 = ob2</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="BaseELMO-v-chk7" style="display: none" type="checkbox"><label class="alectryon-input" for="BaseELMO-v-chk7"><span class="kn">Proof</span>.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>Address</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>EqDecision0</var><span class="hyp-type"><b>: </b><span>EqDecision Address</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="kr">‚àÄ</span> <span class="nv">ob1</span> <span class="nv">ob2</span> : Observation,
  label ob1 = label ob2
  ‚Üí message ob1 = message ob2 ‚Üí ob1 = ob2</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><span class="alectryon-input"><span class="bp">by</span> <span class="nb">intros</span> [] []; <span class="nb">cbn</span>; <span class="bp">congruence</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Qed</span>.</span></span></pre><div class="doc">
<span class="inlinecode"><span class="id" title="var">Label</span></span>s, <span class="inlinecode"><span class="id" title="var">State</span></span>s, <span class="inlinecode"><span class="id" title="var">Observation</span></span>s and <span class="inlinecode"><span class="id" title="var">Message</span></span>s have decidable equality. 
</div><pre class="alectryon-io highlight"><!-- Generator: Alectryon --><span class="alectryon-sentence"><input class="alectryon-toggle" id="BaseELMO-v-chk8" style="display: none" type="checkbox"><label class="alectryon-input" for="BaseELMO-v-chk8">#[export] <span class="kn">Instance</span> <span class="nf">EqDecision_Label</span> : EqDecision Label.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>Address</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>EqDecision0</var><span class="hyp-type"><b>: </b><span>EqDecision Address</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">EqDecision Label</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="BaseELMO-v-chk9" style="display: none" type="checkbox"><label class="alectryon-input" for="BaseELMO-v-chk9"><span class="kn">Proof</span>.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>Address</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>EqDecision0</var><span class="hyp-type"><b>: </b><span>EqDecision Address</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">EqDecision Label</div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="bp">by</span> <span class="nb">intros</span> x y; <span class="nb">unfold</span> Decision; <span class="bp">decide equality</span>.</span><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Defined</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
</span><span class="alectryon-sentence"><input class="alectryon-toggle" id="BaseELMO-v-chka" style="display: none" type="checkbox"><label class="alectryon-input" for="BaseELMO-v-chka">#[local] <span class="kn">Lemma</span> <span class="nf">State_eq_dec</span> : <span class="kr">forall</span> <span class="nv">x</span> <span class="nv">y</span> : State, {x = y} + {x &lt;&gt; y}
<span class="kr">with</span> Observation_eq_dec : <span class="kr">forall</span> <span class="nv">x</span> <span class="nv">y</span> : Observation, {x = y} + {x &lt;&gt; y}
<span class="kr">with</span> Message_eq_dec : <span class="kr">forall</span> <span class="nv">x</span> <span class="nv">y</span> : Message, {x = y} + {x &lt;&gt; y}.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>Address</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>EqDecision0</var><span class="hyp-type"><b>: </b><span>EqDecision Address</span></span></span><br><span><var>State_eq_dec</var><span class="hyp-type"><b>: </b><span><span class="kr">‚àÄ</span> <span class="nv">x</span> <span class="nv">y</span> : State, {x = y} + {x ‚â† y}</span></span></span><br><span><var>Observation_eq_dec</var><span class="hyp-type"><b>: </b><span><span class="kr">‚àÄ</span> <span class="nv">x</span> <span class="nv">y</span> : Observation,
  {x = y} + {x ‚â† y}</span></span></span><br><span><var>Message_eq_dec</var><span class="hyp-type"><b>: </b><span><span class="kr">‚àÄ</span> <span class="nv">x</span> <span class="nv">y</span> : Message, {x = y} + {x ‚â† y}</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="kr">‚àÄ</span> <span class="nv">x</span> <span class="nv">y</span> : State, {x = y} + {x ‚â† y}</div></blockquote><div class="alectryon-extra-goals"><input class="alectryon-extra-goal-toggle" id="BaseELMO-v-chkb" style="display: none" type="checkbox"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>Address</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>EqDecision0</var><span class="hyp-type"><b>: </b><span>EqDecision Address</span></span></span><br><span><var>State_eq_dec</var><span class="hyp-type"><b>: </b><span><span class="kr">‚àÄ</span> <span class="nv">x</span> <span class="nv">y</span> : State, {x = y} + {x ‚â† y}</span></span></span><br><span><var>Observation_eq_dec</var><span class="hyp-type"><b>: </b><span><span class="kr">‚àÄ</span> <span class="nv">x</span> <span class="nv">y</span> : Observation,
  {x = y} + {x ‚â† y}</span></span></span><br><span><var>Message_eq_dec</var><span class="hyp-type"><b>: </b><span><span class="kr">‚àÄ</span> <span class="nv">x</span> <span class="nv">y</span> : Message, {x = y} + {x ‚â† y}</span></span></span><br></div><label class="goal-separator" for="BaseELMO-v-chkb"><hr></label><div class="goal-conclusion"><span class="kr">‚àÄ</span> <span class="nv">x</span> <span class="nv">y</span> : Observation, {x = y} + {x ‚â† y}</div></blockquote><input class="alectryon-extra-goal-toggle" id="BaseELMO-v-chkc" style="display: none" type="checkbox"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>Address</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>EqDecision0</var><span class="hyp-type"><b>: </b><span>EqDecision Address</span></span></span><br><span><var>State_eq_dec</var><span class="hyp-type"><b>: </b><span><span class="kr">‚àÄ</span> <span class="nv">x</span> <span class="nv">y</span> : State, {x = y} + {x ‚â† y}</span></span></span><br><span><var>Observation_eq_dec</var><span class="hyp-type"><b>: </b><span><span class="kr">‚àÄ</span> <span class="nv">x</span> <span class="nv">y</span> : Observation,
  {x = y} + {x ‚â† y}</span></span></span><br><span><var>Message_eq_dec</var><span class="hyp-type"><b>: </b><span><span class="kr">‚àÄ</span> <span class="nv">x</span> <span class="nv">y</span> : Message, {x = y} + {x ‚â† y}</span></span></span><br></div><label class="goal-separator" for="BaseELMO-v-chkc"><hr></label><div class="goal-conclusion"><span class="kr">‚àÄ</span> <span class="nv">x</span> <span class="nv">y</span> : Message, {x = y} + {x ‚â† y}</div></blockquote></div></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="BaseELMO-v-chkd" style="display: none" type="checkbox"><label class="alectryon-input" for="BaseELMO-v-chkd"><span class="kn">Proof</span>.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>Address</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>EqDecision0</var><span class="hyp-type"><b>: </b><span>EqDecision Address</span></span></span><br><span><var>State_eq_dec</var><span class="hyp-type"><b>: </b><span><span class="kr">‚àÄ</span> <span class="nv">x</span> <span class="nv">y</span> : State, {x = y} + {x ‚â† y}</span></span></span><br><span><var>Observation_eq_dec</var><span class="hyp-type"><b>: </b><span><span class="kr">‚àÄ</span> <span class="nv">x</span> <span class="nv">y</span> : Observation,
  {x = y} + {x ‚â† y}</span></span></span><br><span><var>Message_eq_dec</var><span class="hyp-type"><b>: </b><span><span class="kr">‚àÄ</span> <span class="nv">x</span> <span class="nv">y</span> : Message, {x = y} + {x ‚â† y}</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="kr">‚àÄ</span> <span class="nv">x</span> <span class="nv">y</span> : State, {x = y} + {x ‚â† y}</div></blockquote><div class="alectryon-extra-goals"><input class="alectryon-extra-goal-toggle" id="BaseELMO-v-chke" style="display: none" type="checkbox"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>Address</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>EqDecision0</var><span class="hyp-type"><b>: </b><span>EqDecision Address</span></span></span><br><span><var>State_eq_dec</var><span class="hyp-type"><b>: </b><span><span class="kr">‚àÄ</span> <span class="nv">x</span> <span class="nv">y</span> : State, {x = y} + {x ‚â† y}</span></span></span><br><span><var>Observation_eq_dec</var><span class="hyp-type"><b>: </b><span><span class="kr">‚àÄ</span> <span class="nv">x</span> <span class="nv">y</span> : Observation,
  {x = y} + {x ‚â† y}</span></span></span><br><span><var>Message_eq_dec</var><span class="hyp-type"><b>: </b><span><span class="kr">‚àÄ</span> <span class="nv">x</span> <span class="nv">y</span> : Message, {x = y} + {x ‚â† y}</span></span></span><br></div><label class="goal-separator" for="BaseELMO-v-chke"><hr></label><div class="goal-conclusion"><span class="kr">‚àÄ</span> <span class="nv">x</span> <span class="nv">y</span> : Observation, {x = y} + {x ‚â† y}</div></blockquote><input class="alectryon-extra-goal-toggle" id="BaseELMO-v-chkf" style="display: none" type="checkbox"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>Address</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>EqDecision0</var><span class="hyp-type"><b>: </b><span>EqDecision Address</span></span></span><br><span><var>State_eq_dec</var><span class="hyp-type"><b>: </b><span><span class="kr">‚àÄ</span> <span class="nv">x</span> <span class="nv">y</span> : State, {x = y} + {x ‚â† y}</span></span></span><br><span><var>Observation_eq_dec</var><span class="hyp-type"><b>: </b><span><span class="kr">‚àÄ</span> <span class="nv">x</span> <span class="nv">y</span> : Observation,
  {x = y} + {x ‚â† y}</span></span></span><br><span><var>Message_eq_dec</var><span class="hyp-type"><b>: </b><span><span class="kr">‚àÄ</span> <span class="nv">x</span> <span class="nv">y</span> : Message, {x = y} + {x ‚â† y}</span></span></span><br></div><label class="goal-separator" for="BaseELMO-v-chkf"><hr></label><div class="goal-conclusion"><span class="kr">‚àÄ</span> <span class="nv">x</span> <span class="nv">y</span> : Message, {x = y} + {x ‚â† y}</div></blockquote></div></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="BaseELMO-v-chk10" style="display: none" type="checkbox"><label class="alectryon-input" for="BaseELMO-v-chk10">-</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>Address</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>EqDecision0</var><span class="hyp-type"><b>: </b><span>EqDecision Address</span></span></span><br><span><var>State_eq_dec</var><span class="hyp-type"><b>: </b><span><span class="kr">‚àÄ</span> <span class="nv">x</span> <span class="nv">y</span> : State, {x = y} + {x ‚â† y}</span></span></span><br><span><var>Observation_eq_dec</var><span class="hyp-type"><b>: </b><span><span class="kr">‚àÄ</span> <span class="nv">x</span> <span class="nv">y</span> : Observation,
  {x = y} + {x ‚â† y}</span></span></span><br><span><var>Message_eq_dec</var><span class="hyp-type"><b>: </b><span><span class="kr">‚àÄ</span> <span class="nv">x</span> <span class="nv">y</span> : Message, {x = y} + {x ‚â† y}</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="kr">‚àÄ</span> <span class="nv">x</span> <span class="nv">y</span> : State, {x = y} + {x ‚â† y}</div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="BaseELMO-v-chk11" style="display: none" type="checkbox"><label class="alectryon-input" for="BaseELMO-v-chk11"><span class="nb">intros</span> x y; <span class="bp">decide equality</span>.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>Address</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>EqDecision0</var><span class="hyp-type"><b>: </b><span>EqDecision Address</span></span></span><br><span><var>State_eq_dec</var><span class="hyp-type"><b>: </b><span><span class="kr">‚àÄ</span> <span class="nv">x</span> <span class="nv">y</span> : State, {x = y} + {x ‚â† y}</span></span></span><br><span><var>Observation_eq_dec</var><span class="hyp-type"><b>: </b><span><span class="kr">‚àÄ</span> <span class="nv">x</span> <span class="nv">y</span> : Observation,
  {x = y} + {x ‚â† y}</span></span></span><br><span><var>Message_eq_dec</var><span class="hyp-type"><b>: </b><span><span class="kr">‚àÄ</span> <span class="nv">x</span> <span class="nv">y</span> : Message, {x = y} + {x ‚â† y}</span></span></span><br><span><var>x, y</var><span class="hyp-type"><b>: </b><span>State</span></span></span><br><span><var>obs0</var><span class="hyp-type"><b>: </b><span>list Observation</span></span></span><br><span><var>adr0</var><span class="hyp-type"><b>: </b><span>Address</span></span></span><br><span><var>obs1</var><span class="hyp-type"><b>: </b><span>list Observation</span></span></span><br><span><var>adr1</var><span class="hyp-type"><b>: </b><span>Address</span></span></span><br><span><var>a</var><span class="hyp-type"><b>: </b><span>obs0 = obs1</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">{adr0 = adr1} + {adr0 ‚â† adr1}</div></blockquote><div class="alectryon-extra-goals"><input class="alectryon-extra-goal-toggle" id="BaseELMO-v-chk12" style="display: none" type="checkbox"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>Address</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>EqDecision0</var><span class="hyp-type"><b>: </b><span>EqDecision Address</span></span></span><br><span><var>State_eq_dec</var><span class="hyp-type"><b>: </b><span><span class="kr">‚àÄ</span> <span class="nv">x</span> <span class="nv">y</span> : State, {x = y} + {x ‚â† y}</span></span></span><br><span><var>Observation_eq_dec</var><span class="hyp-type"><b>: </b><span><span class="kr">‚àÄ</span> <span class="nv">x</span> <span class="nv">y</span> : Observation,
  {x = y} + {x ‚â† y}</span></span></span><br><span><var>Message_eq_dec</var><span class="hyp-type"><b>: </b><span><span class="kr">‚àÄ</span> <span class="nv">x</span> <span class="nv">y</span> : Message, {x = y} + {x ‚â† y}</span></span></span><br><span><var>x, y</var><span class="hyp-type"><b>: </b><span>State</span></span></span><br><span><var>obs0</var><span class="hyp-type"><b>: </b><span>list Observation</span></span></span><br><span><var>adr0</var><span class="hyp-type"><b>: </b><span>Address</span></span></span><br><span><var>obs1</var><span class="hyp-type"><b>: </b><span>list Observation</span></span></span><br><span><var>adr1</var><span class="hyp-type"><b>: </b><span>Address</span></span></span><br></div><label class="goal-separator" for="BaseELMO-v-chk12"><hr></label><div class="goal-conclusion">{obs0 = obs1} + {obs0 ‚â† obs1}</div></blockquote></div></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="BaseELMO-v-chk13" style="display: none" type="checkbox"><label class="alectryon-input" for="BaseELMO-v-chk13">+</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>Address</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>EqDecision0</var><span class="hyp-type"><b>: </b><span>EqDecision Address</span></span></span><br><span><var>State_eq_dec</var><span class="hyp-type"><b>: </b><span><span class="kr">‚àÄ</span> <span class="nv">x</span> <span class="nv">y</span> : State, {x = y} + {x ‚â† y}</span></span></span><br><span><var>Observation_eq_dec</var><span class="hyp-type"><b>: </b><span><span class="kr">‚àÄ</span> <span class="nv">x</span> <span class="nv">y</span> : Observation,
  {x = y} + {x ‚â† y}</span></span></span><br><span><var>Message_eq_dec</var><span class="hyp-type"><b>: </b><span><span class="kr">‚àÄ</span> <span class="nv">x</span> <span class="nv">y</span> : Message, {x = y} + {x ‚â† y}</span></span></span><br><span><var>x, y</var><span class="hyp-type"><b>: </b><span>State</span></span></span><br><span><var>obs0</var><span class="hyp-type"><b>: </b><span>list Observation</span></span></span><br><span><var>adr0</var><span class="hyp-type"><b>: </b><span>Address</span></span></span><br><span><var>obs1</var><span class="hyp-type"><b>: </b><span>list Observation</span></span></span><br><span><var>adr1</var><span class="hyp-type"><b>: </b><span>Address</span></span></span><br><span><var>a</var><span class="hyp-type"><b>: </b><span>obs0 = obs1</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">{adr0 = adr1} + {adr0 ‚â† adr1}</div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="bp">by</span> <span class="nb">apply</span> EqDecision0.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="BaseELMO-v-chk14" style="display: none" type="checkbox"><label class="alectryon-input" for="BaseELMO-v-chk14">+</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>Address</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>EqDecision0</var><span class="hyp-type"><b>: </b><span>EqDecision Address</span></span></span><br><span><var>State_eq_dec</var><span class="hyp-type"><b>: </b><span><span class="kr">‚àÄ</span> <span class="nv">x</span> <span class="nv">y</span> : State, {x = y} + {x ‚â† y}</span></span></span><br><span><var>Observation_eq_dec</var><span class="hyp-type"><b>: </b><span><span class="kr">‚àÄ</span> <span class="nv">x</span> <span class="nv">y</span> : Observation,
  {x = y} + {x ‚â† y}</span></span></span><br><span><var>Message_eq_dec</var><span class="hyp-type"><b>: </b><span><span class="kr">‚àÄ</span> <span class="nv">x</span> <span class="nv">y</span> : Message, {x = y} + {x ‚â† y}</span></span></span><br><span><var>x, y</var><span class="hyp-type"><b>: </b><span>State</span></span></span><br><span><var>obs0</var><span class="hyp-type"><b>: </b><span>list Observation</span></span></span><br><span><var>adr0</var><span class="hyp-type"><b>: </b><span>Address</span></span></span><br><span><var>obs1</var><span class="hyp-type"><b>: </b><span>list Observation</span></span></span><br><span><var>adr1</var><span class="hyp-type"><b>: </b><span>Address</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">{obs0 = obs1} + {obs0 ‚â† obs1}</div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="bp">by</span> <span class="bp">decide equality</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="BaseELMO-v-chk15" style="display: none" type="checkbox"><label class="alectryon-input" for="BaseELMO-v-chk15">-</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>Address</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>EqDecision0</var><span class="hyp-type"><b>: </b><span>EqDecision Address</span></span></span><br><span><var>State_eq_dec</var><span class="hyp-type"><b>: </b><span><span class="kr">‚àÄ</span> <span class="nv">x</span> <span class="nv">y</span> : State, {x = y} + {x ‚â† y}</span></span></span><br><span><var>Observation_eq_dec</var><span class="hyp-type"><b>: </b><span><span class="kr">‚àÄ</span> <span class="nv">x</span> <span class="nv">y</span> : Observation,
  {x = y} + {x ‚â† y}</span></span></span><br><span><var>Message_eq_dec</var><span class="hyp-type"><b>: </b><span><span class="kr">‚àÄ</span> <span class="nv">x</span> <span class="nv">y</span> : Message, {x = y} + {x ‚â† y}</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="kr">‚àÄ</span> <span class="nv">x</span> <span class="nv">y</span> : Observation, {x = y} + {x ‚â† y}</div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="bp">by</span> <span class="kp">do</span> <span class="mi">2</span> <span class="bp">decide equality</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="BaseELMO-v-chk16" style="display: none" type="checkbox"><label class="alectryon-input" for="BaseELMO-v-chk16">-</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>Address</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>EqDecision0</var><span class="hyp-type"><b>: </b><span>EqDecision Address</span></span></span><br><span><var>State_eq_dec</var><span class="hyp-type"><b>: </b><span><span class="kr">‚àÄ</span> <span class="nv">x</span> <span class="nv">y</span> : State, {x = y} + {x ‚â† y}</span></span></span><br><span><var>Observation_eq_dec</var><span class="hyp-type"><b>: </b><span><span class="kr">‚àÄ</span> <span class="nv">x</span> <span class="nv">y</span> : Observation,
  {x = y} + {x ‚â† y}</span></span></span><br><span><var>Message_eq_dec</var><span class="hyp-type"><b>: </b><span><span class="kr">‚àÄ</span> <span class="nv">x</span> <span class="nv">y</span> : Message, {x = y} + {x ‚â† y}</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="kr">‚àÄ</span> <span class="nv">x</span> <span class="nv">y</span> : Message, {x = y} + {x ‚â† y}</div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="bp">by</span> <span class="nb">intros</span> x y; <span class="bp">decide equality</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Defined</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
</span><span class="alectryon-sentence"><span class="alectryon-input">#[export] <span class="kn">Instance</span> <span class="nf">EqDecision_State</span> : EqDecision State := State_eq_dec.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><span class="alectryon-input">#[export] <span class="kn">Instance</span> <span class="nf">EqDecision_Observation</span> : EqDecision Observation := Observation_eq_dec.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><span class="alectryon-input">#[export] <span class="kn">Instance</span> <span class="nf">EqDecision_Message</span> : EqDecision Message := Message_eq_dec.</span></span></pre><div class="doc">
A notion of size for <span class="inlinecode"><span class="id" title="var">State</span></span>s, <span class="inlinecode"><span class="id" title="var">Observation</span></span>s and <span class="inlinecode"><span class="id" title="var">Message</span></span>s. 
</div><pre class="alectryon-io highlight"><!-- Generator: Alectryon --><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Fixpoint</span> <span class="nf">sizeState</span> (<span class="nv">s</span> : State) : nat :=
  <span class="mi">1</span> + fold_right (<span class="kr">fun</span> <span class="nv">ob</span> <span class="nv">sizeObs</span> =&gt; sizeObservation ob + sizeObs) <span class="mi">0</span> (obs s)

<span class="kr">with</span> sizeObservation (ob : Observation) : nat :=
  <span class="mi">1</span> + sizeMessage (message ob)

<span class="kr">with</span> sizeMessage (msg : Message) : nat :=
  <span class="mi">1</span> + sizeState (state msg).</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
</span><span class="alectryon-sentence"><input class="alectryon-toggle" id="BaseELMO-v-chk17" style="display: none" type="checkbox"><label class="alectryon-input" for="BaseELMO-v-chk17"><span class="kn">Lemma</span> <span class="nf">sizeObservation_unfold</span> (<span class="nv">ob</span> : Observation) :
  sizeObservation ob = <span class="mi">2</span> + sizeState (state (message ob)).</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>Address</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>EqDecision0</var><span class="hyp-type"><b>: </b><span>EqDecision Address</span></span></span><br><span><var>ob</var><span class="hyp-type"><b>: </b><span>Observation</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">sizeObservation ob =
<span class="mi">2</span> + sizeState (state (message ob))</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="BaseELMO-v-chk18" style="display: none" type="checkbox"><label class="alectryon-input" for="BaseELMO-v-chk18"><span class="kn">Proof</span>.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>Address</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>EqDecision0</var><span class="hyp-type"><b>: </b><span>EqDecision Address</span></span></span><br><span><var>ob</var><span class="hyp-type"><b>: </b><span>Observation</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">sizeObservation ob =
<span class="mi">2</span> + sizeState (state (message ob))</div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="bp">by</span> <span class="nb">destruct</span> ob <span class="kr">as</span> [? []].</span><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Qed</span>.</span></span></pre><div class="doc">
<a id="lab3"></a><h2 class="section">Extending States with new Observations</h2>
<div class="paragraph"> </div>

  We want to abstract over from the "direction" of the <span class="inlinecode"><span class="id" title="var">list</span></span> of <span class="inlinecode"><span class="id" title="var">Observation</span></span>s,
  so that we can <span class="inlinecode"><span class="id" title="var">cons</span></span> new observations at the beginning, whereas in the paper
  they are <span class="inlinecode"><span class="id" title="var">app</span></span>ended to the end. We will use the function <span class="inlinecode"><span class="id" title="var">addObservation</span></span> to
  extend a state with a new observations and <span class="inlinecode"><span class="id" title="var">addObservations</span></span> to extend a state
  with a list of new observations.

</div><pre class="alectryon-io highlight"><!-- Generator: Alectryon --><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Definition</span> <span class="nf">addObservation&#39;</span> (<span class="nv">ob</span> : Observation) (<span class="nv">obs</span> : list Observation) : list Observation :=
  ob :: obs.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
</span><span class="alectryon-sentence"><input class="alectryon-toggle" id="BaseELMO-v-chk19" style="display: none" type="checkbox"><label class="alectryon-input" for="BaseELMO-v-chk19"><span class="kn">Lemma</span> <span class="nf">addObservation&#39;_ind</span> (<span class="nv">P</span> : list Observation -&gt; <span class="kt">Prop</span>)
  (<span class="nv">Hempty</span> : P [])
  (<span class="nv">Hadd</span> : <span class="kr">forall</span> <span class="nv">ob</span> <span class="nv">obs</span>, P obs -&gt; P (addObservation&#39; ob obs)) :
  <span class="kr">forall</span> <span class="nv">obs</span>, P obs.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>Address</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>EqDecision0</var><span class="hyp-type"><b>: </b><span>EqDecision Address</span></span></span><br><span><var>P</var><span class="hyp-type"><b>: </b><span>list Observation ‚Üí <span class="kt">Prop</span></span></span></span><br><span><var>Hempty</var><span class="hyp-type"><b>: </b><span>P []</span></span></span><br><span><var>Hadd</var><span class="hyp-type"><b>: </b><span><span class="kr">‚àÄ</span> (<span class="nv">ob</span> : Observation) (<span class="nv">obs</span> : list Observation),
  P obs ‚Üí P (addObservation&#39; ob obs)</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="kr">‚àÄ</span> <span class="nv">obs</span> : list Observation, P obs</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="BaseELMO-v-chk1a" style="display: none" type="checkbox"><label class="alectryon-input" for="BaseELMO-v-chk1a"><span class="kn">Proof</span>.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>Address</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>EqDecision0</var><span class="hyp-type"><b>: </b><span>EqDecision Address</span></span></span><br><span><var>P</var><span class="hyp-type"><b>: </b><span>list Observation ‚Üí <span class="kt">Prop</span></span></span></span><br><span><var>Hempty</var><span class="hyp-type"><b>: </b><span>P []</span></span></span><br><span><var>Hadd</var><span class="hyp-type"><b>: </b><span><span class="kr">‚àÄ</span> (<span class="nv">ob</span> : Observation) (<span class="nv">obs</span> : list Observation),
  P obs ‚Üí P (addObservation&#39; ob obs)</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="kr">‚àÄ</span> <span class="nv">obs</span> : list Observation, P obs</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><span class="alectryon-input"><span class="bp">exact</span> (list_ind P Hempty Hadd).</span><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Qed</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
</span><span class="alectryon-sentence"><input class="alectryon-toggle" id="BaseELMO-v-chk1b" style="display: none" type="checkbox"><label class="alectryon-input" for="BaseELMO-v-chk1b"><span class="kn">Lemma</span> <span class="nf">addObservation&#39;_rec</span> (<span class="nv">P</span> : list Observation -&gt; <span class="kt">Set</span>)
  (<span class="nv">Hempty</span> : P [])
  (<span class="nv">Hadd</span> : <span class="kr">forall</span> <span class="nv">ob</span> <span class="nv">obs</span>, P obs -&gt; P (addObservation&#39; ob obs)) :
  <span class="kr">forall</span> <span class="nv">obs</span>, P obs.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>Address</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>EqDecision0</var><span class="hyp-type"><b>: </b><span>EqDecision Address</span></span></span><br><span><var>P</var><span class="hyp-type"><b>: </b><span>list Observation ‚Üí <span class="kt">Set</span></span></span></span><br><span><var>Hempty</var><span class="hyp-type"><b>: </b><span>P []</span></span></span><br><span><var>Hadd</var><span class="hyp-type"><b>: </b><span><span class="kr">‚àÄ</span> (<span class="nv">ob</span> : Observation) (<span class="nv">obs</span> : list Observation),
  P obs ‚Üí P (addObservation&#39; ob obs)</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="kr">‚àÄ</span> <span class="nv">obs</span> : list Observation, P obs</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="BaseELMO-v-chk1c" style="display: none" type="checkbox"><label class="alectryon-input" for="BaseELMO-v-chk1c"><span class="kn">Proof</span>.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>Address</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>EqDecision0</var><span class="hyp-type"><b>: </b><span>EqDecision Address</span></span></span><br><span><var>P</var><span class="hyp-type"><b>: </b><span>list Observation ‚Üí <span class="kt">Set</span></span></span></span><br><span><var>Hempty</var><span class="hyp-type"><b>: </b><span>P []</span></span></span><br><span><var>Hadd</var><span class="hyp-type"><b>: </b><span><span class="kr">‚àÄ</span> (<span class="nv">ob</span> : Observation) (<span class="nv">obs</span> : list Observation),
  P obs ‚Üí P (addObservation&#39; ob obs)</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="kr">‚àÄ</span> <span class="nv">obs</span> : list Observation, P obs</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><span class="alectryon-input"><span class="bp">exact</span> (list_rec P Hempty Hadd).</span><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Defined</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
</span><span class="alectryon-sentence"><input class="alectryon-toggle" id="BaseELMO-v-chk1d" style="display: none" type="checkbox"><label class="alectryon-input" for="BaseELMO-v-chk1d"><span class="kn">Lemma</span> <span class="nf">addObservation&#39;_rect</span> (<span class="nv">P</span> : list Observation -&gt; <span class="kt">Type</span>)
  (<span class="nv">Hempty</span> : P [])
  (<span class="nv">Hadd</span> : <span class="kr">forall</span> <span class="nv">ob</span> <span class="nv">obs</span>, P obs -&gt; P (addObservation&#39; ob obs)) :
  <span class="kr">forall</span> <span class="nv">obs</span>, P obs.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>Address</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>EqDecision0</var><span class="hyp-type"><b>: </b><span>EqDecision Address</span></span></span><br><span><var>P</var><span class="hyp-type"><b>: </b><span>list Observation ‚Üí <span class="kt">Type</span></span></span></span><br><span><var>Hempty</var><span class="hyp-type"><b>: </b><span>P []</span></span></span><br><span><var>Hadd</var><span class="hyp-type"><b>: </b><span><span class="kr">‚àÄ</span> (<span class="nv">ob</span> : Observation) (<span class="nv">obs</span> : list Observation),
  P obs ‚Üí P (addObservation&#39; ob obs)</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="kr">‚àÄ</span> <span class="nv">obs</span> : list Observation, P obs</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="BaseELMO-v-chk1e" style="display: none" type="checkbox"><label class="alectryon-input" for="BaseELMO-v-chk1e"><span class="kn">Proof</span>.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>Address</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>EqDecision0</var><span class="hyp-type"><b>: </b><span>EqDecision Address</span></span></span><br><span><var>P</var><span class="hyp-type"><b>: </b><span>list Observation ‚Üí <span class="kt">Type</span></span></span></span><br><span><var>Hempty</var><span class="hyp-type"><b>: </b><span>P []</span></span></span><br><span><var>Hadd</var><span class="hyp-type"><b>: </b><span><span class="kr">‚àÄ</span> (<span class="nv">ob</span> : Observation) (<span class="nv">obs</span> : list Observation),
  P obs ‚Üí P (addObservation&#39; ob obs)</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="kr">‚àÄ</span> <span class="nv">obs</span> : list Observation, P obs</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><span class="alectryon-input"><span class="bp">exact</span> (list_rect P Hempty Hadd).</span><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Defined</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
</span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Definition</span> <span class="nf">addObservation</span> (<span class="nv">ob</span> : Observation) (<span class="nv">s</span> : State) : State :=
  MkState (addObservation&#39; ob (obs s)) (adr s).</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
</span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Notation</span> <span class="s2">&quot;s &lt;+&gt; ob&quot;</span> := (addObservation ob s) (<span class="kn">left associativity</span>, <span class="kn">at level</span> <span class="mi">50</span>).</span></span></pre><div class="doc">
  The induction principle <span class="inlinecode"><span class="id" title="var">addObservation_ind</span></span> considers a <span class="inlinecode"><span class="id" title="var">State</span></span>
  as built up using <span class="inlinecode"><span class="id" title="var">addObservation</span></span> from an initial state.

</div><pre class="alectryon-io highlight"><!-- Generator: Alectryon --><span class="alectryon-sentence"><input class="alectryon-toggle" id="BaseELMO-v-chk1f" style="display: none" type="checkbox"><label class="alectryon-input" for="BaseELMO-v-chk1f"><span class="kn">Lemma</span> <span class="nf">addObservation_ind</span> (<span class="nv">P</span> : State -&gt; <span class="kt">Prop</span>)
  (<span class="nv">Hempty</span> : <span class="kr">forall</span> <span class="nv">a</span>, P (MkState [] a))
  (<span class="nv">Hadd</span> : <span class="kr">forall</span> <span class="nv">ob</span> <span class="nv">s</span>, P s -&gt; P (addObservation ob s)) :
  <span class="kr">forall</span> <span class="nv">obs</span>, P obs.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>Address</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>EqDecision0</var><span class="hyp-type"><b>: </b><span>EqDecision Address</span></span></span><br><span><var>P</var><span class="hyp-type"><b>: </b><span>State ‚Üí <span class="kt">Prop</span></span></span></span><br><span><var>Hempty</var><span class="hyp-type"><b>: </b><span><span class="kr">‚àÄ</span> <span class="nv">a</span> : Address, P (MkState [] a)</span></span></span><br><span><var>Hadd</var><span class="hyp-type"><b>: </b><span><span class="kr">‚àÄ</span> (<span class="nv">ob</span> : Observation) (<span class="nv">s</span> : State),
  P s ‚Üí P (s &lt;+&gt; ob)</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="kr">‚àÄ</span> <span class="nv">obs</span> : State, P obs</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="BaseELMO-v-chk20" style="display: none" type="checkbox"><label class="alectryon-input" for="BaseELMO-v-chk20"><span class="kn">Proof</span>.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>Address</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>EqDecision0</var><span class="hyp-type"><b>: </b><span>EqDecision Address</span></span></span><br><span><var>P</var><span class="hyp-type"><b>: </b><span>State ‚Üí <span class="kt">Prop</span></span></span></span><br><span><var>Hempty</var><span class="hyp-type"><b>: </b><span><span class="kr">‚àÄ</span> <span class="nv">a</span> : Address, P (MkState [] a)</span></span></span><br><span><var>Hadd</var><span class="hyp-type"><b>: </b><span><span class="kr">‚àÄ</span> (<span class="nv">ob</span> : Observation) (<span class="nv">s</span> : State),
  P s ‚Üí P (s &lt;+&gt; ob)</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="kr">‚àÄ</span> <span class="nv">obs</span> : State, P obs</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="BaseELMO-v-chk21" style="display: none" type="checkbox"><label class="alectryon-input" for="BaseELMO-v-chk21"><span class="nb">intros</span> [obs a].</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>Address</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>EqDecision0</var><span class="hyp-type"><b>: </b><span>EqDecision Address</span></span></span><br><span><var>P</var><span class="hyp-type"><b>: </b><span>State ‚Üí <span class="kt">Prop</span></span></span></span><br><span><var>Hempty</var><span class="hyp-type"><b>: </b><span><span class="kr">‚àÄ</span> <span class="nv">a</span> : Address, P (MkState [] a)</span></span></span><br><span><var>Hadd</var><span class="hyp-type"><b>: </b><span><span class="kr">‚àÄ</span> (<span class="nv">ob</span> : Observation) (<span class="nv">s</span> : State),
  P s ‚Üí P (s &lt;+&gt; ob)</span></span></span><br><span><var>obs</var><span class="hyp-type"><b>: </b><span>list Observation</span></span></span><br><span><var>a</var><span class="hyp-type"><b>: </b><span>Address</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">P (MkState obs a)</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="BaseELMO-v-chk22" style="display: none" type="checkbox"><label class="alectryon-input" for="BaseELMO-v-chk22"><span class="nb">induction</span> obs <span class="nb">using</span> addObservation&#39;_ind; [<span class="bp">done</span> |].</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>Address</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>EqDecision0</var><span class="hyp-type"><b>: </b><span>EqDecision Address</span></span></span><br><span><var>P</var><span class="hyp-type"><b>: </b><span>State ‚Üí <span class="kt">Prop</span></span></span></span><br><span><var>Hempty</var><span class="hyp-type"><b>: </b><span><span class="kr">‚àÄ</span> <span class="nv">a</span> : Address, P (MkState [] a)</span></span></span><br><span><var>Hadd</var><span class="hyp-type"><b>: </b><span><span class="kr">‚àÄ</span> (<span class="nv">ob</span> : Observation) (<span class="nv">s</span> : State),
  P s ‚Üí P (s &lt;+&gt; ob)</span></span></span><br><span><var>a</var><span class="hyp-type"><b>: </b><span>Address</span></span></span><br><span><var>ob</var><span class="hyp-type"><b>: </b><span>Observation</span></span></span><br><span><var>obs0</var><span class="hyp-type"><b>: </b><span>list Observation</span></span></span><br><span><var>IHobs</var><span class="hyp-type"><b>: </b><span>P (MkState obs0 a)</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">P (MkState (addObservation&#39; ob obs0) a)</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><span class="alectryon-input"><span class="bp">by</span> <span class="nb">apply</span> (Hadd ob) <span class="kr">in</span> IHobs.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Qed</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
</span><span class="alectryon-sentence"><input class="alectryon-toggle" id="BaseELMO-v-chk23" style="display: none" type="checkbox"><label class="alectryon-input" for="BaseELMO-v-chk23"><span class="kn">Lemma</span> <span class="nf">addObservation_rec</span> (<span class="nv">P</span> : State -&gt; <span class="kt">Set</span>)
  (<span class="nv">Hempty</span> : <span class="kr">forall</span> <span class="nv">a</span>, P (MkState [] a))
  (<span class="nv">Hadd</span> : <span class="kr">forall</span> <span class="nv">ob</span> <span class="nv">s</span>, P s -&gt; P (s &lt;+&gt; ob)) :
  <span class="kr">forall</span> <span class="nv">obs</span>, P obs.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>Address</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>EqDecision0</var><span class="hyp-type"><b>: </b><span>EqDecision Address</span></span></span><br><span><var>P</var><span class="hyp-type"><b>: </b><span>State ‚Üí <span class="kt">Set</span></span></span></span><br><span><var>Hempty</var><span class="hyp-type"><b>: </b><span><span class="kr">‚àÄ</span> <span class="nv">a</span> : Address, P (MkState [] a)</span></span></span><br><span><var>Hadd</var><span class="hyp-type"><b>: </b><span><span class="kr">‚àÄ</span> (<span class="nv">ob</span> : Observation) (<span class="nv">s</span> : State),
  P s ‚Üí P (s &lt;+&gt; ob)</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="kr">‚àÄ</span> <span class="nv">obs</span> : State, P obs</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="BaseELMO-v-chk24" style="display: none" type="checkbox"><label class="alectryon-input" for="BaseELMO-v-chk24"><span class="kn">Proof</span>.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>Address</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>EqDecision0</var><span class="hyp-type"><b>: </b><span>EqDecision Address</span></span></span><br><span><var>P</var><span class="hyp-type"><b>: </b><span>State ‚Üí <span class="kt">Set</span></span></span></span><br><span><var>Hempty</var><span class="hyp-type"><b>: </b><span><span class="kr">‚àÄ</span> <span class="nv">a</span> : Address, P (MkState [] a)</span></span></span><br><span><var>Hadd</var><span class="hyp-type"><b>: </b><span><span class="kr">‚àÄ</span> (<span class="nv">ob</span> : Observation) (<span class="nv">s</span> : State),
  P s ‚Üí P (s &lt;+&gt; ob)</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="kr">‚àÄ</span> <span class="nv">obs</span> : State, P obs</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="BaseELMO-v-chk25" style="display: none" type="checkbox"><label class="alectryon-input" for="BaseELMO-v-chk25"><span class="nb">intros</span> [obs a].</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>Address</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>EqDecision0</var><span class="hyp-type"><b>: </b><span>EqDecision Address</span></span></span><br><span><var>P</var><span class="hyp-type"><b>: </b><span>State ‚Üí <span class="kt">Set</span></span></span></span><br><span><var>Hempty</var><span class="hyp-type"><b>: </b><span><span class="kr">‚àÄ</span> <span class="nv">a</span> : Address, P (MkState [] a)</span></span></span><br><span><var>Hadd</var><span class="hyp-type"><b>: </b><span><span class="kr">‚àÄ</span> (<span class="nv">ob</span> : Observation) (<span class="nv">s</span> : State),
  P s ‚Üí P (s &lt;+&gt; ob)</span></span></span><br><span><var>obs</var><span class="hyp-type"><b>: </b><span>list Observation</span></span></span><br><span><var>a</var><span class="hyp-type"><b>: </b><span>Address</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">P (MkState obs a)</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="BaseELMO-v-chk26" style="display: none" type="checkbox"><label class="alectryon-input" for="BaseELMO-v-chk26"><span class="nb">induction</span> obs <span class="nb">using</span> addObservation&#39;_rec; [<span class="bp">done</span> |].</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>Address</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>EqDecision0</var><span class="hyp-type"><b>: </b><span>EqDecision Address</span></span></span><br><span><var>P</var><span class="hyp-type"><b>: </b><span>State ‚Üí <span class="kt">Set</span></span></span></span><br><span><var>Hempty</var><span class="hyp-type"><b>: </b><span><span class="kr">‚àÄ</span> <span class="nv">a</span> : Address, P (MkState [] a)</span></span></span><br><span><var>Hadd</var><span class="hyp-type"><b>: </b><span><span class="kr">‚àÄ</span> (<span class="nv">ob</span> : Observation) (<span class="nv">s</span> : State),
  P s ‚Üí P (s &lt;+&gt; ob)</span></span></span><br><span><var>a</var><span class="hyp-type"><b>: </b><span>Address</span></span></span><br><span><var>ob</var><span class="hyp-type"><b>: </b><span>Observation</span></span></span><br><span><var>obs0</var><span class="hyp-type"><b>: </b><span>list Observation</span></span></span><br><span><var>IHobs</var><span class="hyp-type"><b>: </b><span>P (MkState obs0 a)</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">P (MkState (addObservation&#39; ob obs0) a)</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><span class="alectryon-input"><span class="bp">by</span> <span class="nb">apply</span> (Hadd ob) <span class="kr">in</span> IHobs.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Defined</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
</span><span class="alectryon-sentence"><input class="alectryon-toggle" id="BaseELMO-v-chk27" style="display: none" type="checkbox"><label class="alectryon-input" for="BaseELMO-v-chk27"><span class="kn">Lemma</span> <span class="nf">addObservation_rect</span> (<span class="nv">P</span> : State -&gt; <span class="kt">Type</span>)
  (<span class="nv">Hempty</span> : <span class="kr">forall</span> <span class="nv">a</span>, P (MkState [] a))
  (<span class="nv">Hadd</span> : <span class="kr">forall</span> <span class="nv">ob</span> <span class="nv">s</span>, P s -&gt; P (addObservation ob s)) :
  <span class="kr">forall</span> <span class="nv">obs</span>, P obs.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>Address</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>EqDecision0</var><span class="hyp-type"><b>: </b><span>EqDecision Address</span></span></span><br><span><var>P</var><span class="hyp-type"><b>: </b><span>State ‚Üí <span class="kt">Type</span></span></span></span><br><span><var>Hempty</var><span class="hyp-type"><b>: </b><span><span class="kr">‚àÄ</span> <span class="nv">a</span> : Address, P (MkState [] a)</span></span></span><br><span><var>Hadd</var><span class="hyp-type"><b>: </b><span><span class="kr">‚àÄ</span> (<span class="nv">ob</span> : Observation) (<span class="nv">s</span> : State),
  P s ‚Üí P (s &lt;+&gt; ob)</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="kr">‚àÄ</span> <span class="nv">obs</span> : State, P obs</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="BaseELMO-v-chk28" style="display: none" type="checkbox"><label class="alectryon-input" for="BaseELMO-v-chk28"><span class="kn">Proof</span>.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>Address</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>EqDecision0</var><span class="hyp-type"><b>: </b><span>EqDecision Address</span></span></span><br><span><var>P</var><span class="hyp-type"><b>: </b><span>State ‚Üí <span class="kt">Type</span></span></span></span><br><span><var>Hempty</var><span class="hyp-type"><b>: </b><span><span class="kr">‚àÄ</span> <span class="nv">a</span> : Address, P (MkState [] a)</span></span></span><br><span><var>Hadd</var><span class="hyp-type"><b>: </b><span><span class="kr">‚àÄ</span> (<span class="nv">ob</span> : Observation) (<span class="nv">s</span> : State),
  P s ‚Üí P (s &lt;+&gt; ob)</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="kr">‚àÄ</span> <span class="nv">obs</span> : State, P obs</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="BaseELMO-v-chk29" style="display: none" type="checkbox"><label class="alectryon-input" for="BaseELMO-v-chk29"><span class="nb">intros</span> [obs a].</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>Address</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>EqDecision0</var><span class="hyp-type"><b>: </b><span>EqDecision Address</span></span></span><br><span><var>P</var><span class="hyp-type"><b>: </b><span>State ‚Üí <span class="kt">Type</span></span></span></span><br><span><var>Hempty</var><span class="hyp-type"><b>: </b><span><span class="kr">‚àÄ</span> <span class="nv">a</span> : Address, P (MkState [] a)</span></span></span><br><span><var>Hadd</var><span class="hyp-type"><b>: </b><span><span class="kr">‚àÄ</span> (<span class="nv">ob</span> : Observation) (<span class="nv">s</span> : State),
  P s ‚Üí P (s &lt;+&gt; ob)</span></span></span><br><span><var>obs</var><span class="hyp-type"><b>: </b><span>list Observation</span></span></span><br><span><var>a</var><span class="hyp-type"><b>: </b><span>Address</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">P (MkState obs a)</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="BaseELMO-v-chk2a" style="display: none" type="checkbox"><label class="alectryon-input" for="BaseELMO-v-chk2a"><span class="nb">induction</span> obs <span class="nb">using</span> addObservation&#39;_rect; [<span class="bp">done</span> |].</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>Address</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>EqDecision0</var><span class="hyp-type"><b>: </b><span>EqDecision Address</span></span></span><br><span><var>P</var><span class="hyp-type"><b>: </b><span>State ‚Üí <span class="kt">Type</span></span></span></span><br><span><var>Hempty</var><span class="hyp-type"><b>: </b><span><span class="kr">‚àÄ</span> <span class="nv">a</span> : Address, P (MkState [] a)</span></span></span><br><span><var>Hadd</var><span class="hyp-type"><b>: </b><span><span class="kr">‚àÄ</span> (<span class="nv">ob</span> : Observation) (<span class="nv">s</span> : State),
  P s ‚Üí P (s &lt;+&gt; ob)</span></span></span><br><span><var>a</var><span class="hyp-type"><b>: </b><span>Address</span></span></span><br><span><var>ob</var><span class="hyp-type"><b>: </b><span>Observation</span></span></span><br><span><var>obs0</var><span class="hyp-type"><b>: </b><span>list Observation</span></span></span><br><span><var>IHobs</var><span class="hyp-type"><b>: </b><span>P (MkState obs0 a)</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">P (MkState (addObservation&#39; ob obs0) a)</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><span class="alectryon-input"><span class="bp">by</span> <span class="nb">apply</span> (Hadd ob) <span class="kr">in</span> IHobs.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Defined</span>.</span></span></pre><div class="doc">
  This induction principle is like <span class="inlinecode"><span class="id" title="var">addObservation_ind</span></span>, but
  also provides an induction hypothesis for the <span class="inlinecode"><span class="id" title="var">State</span></span> contained
  in the message of the added observation.

</div><pre class="alectryon-io highlight"><!-- Generator: Alectryon --><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Definition</span> <span class="nf">addObservation_both_ind</span>
  (<span class="nv">P</span> : State -&gt; <span class="kt">Prop</span>)
  (<span class="nv">Hinit</span> : <span class="kr">forall</span> <span class="nv">a</span>, P (MkState [] a))
  (<span class="nv">Hadd</span> : <span class="kr">forall</span> [s l ms], P s -&gt; P ms -&gt; P (s &lt;+&gt; MkObservation l (MkMessage ms))) :
  <span class="kr">forall</span> <span class="nv">s</span>, P s :=
  <span class="kr">fix</span> rec s :=
    <span class="kr">let</span> &#39;(MkState ol a) := s <span class="kr">in</span>
    <span class="kr">let</span> <span class="nv">Hcons</span> := <span class="kr">fun</span> &#39;(MkObservation _ (MkMessage ms)) <span class="nv">_</span> <span class="nv">IHol&#39;</span> =&gt; Hadd IHol&#39; (rec ms)
    <span class="kr">in</span> list_ind _ (Hinit a) Hcons ol.</span></span></pre><div class="doc">
  A property on <span class="inlinecode"><span class="id" title="var">sizeState</span></span> of <span class="inlinecode"><span class="id" title="var">addObservation</span></span>.
  Useful because a <span class="inlinecode"><span class="id" title="keyword">Fixpoint</span></span> can't be unfolded unless
  the argument is in the form of a constructor application.

</div><pre class="alectryon-io highlight"><!-- Generator: Alectryon --><span class="alectryon-sentence"><input class="alectryon-toggle" id="BaseELMO-v-chk2b" style="display: none" type="checkbox"><label class="alectryon-input" for="BaseELMO-v-chk2b"><span class="kn">Lemma</span> <span class="nf">addObservation_size</span> <span class="nv">s</span> <span class="nv">ob</span> :
  sizeState (s &lt;+&gt; ob) = sizeState s + sizeObservation ob.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>Address</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>EqDecision0</var><span class="hyp-type"><b>: </b><span>EqDecision Address</span></span></span><br><span><var>s</var><span class="hyp-type"><b>: </b><span>State</span></span></span><br><span><var>ob</var><span class="hyp-type"><b>: </b><span>Observation</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">sizeState (s &lt;+&gt; ob) =
sizeState s + sizeObservation ob</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="BaseELMO-v-chk2c" style="display: none" type="checkbox"><label class="alectryon-input" for="BaseELMO-v-chk2c"><span class="kn">Proof</span>.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>Address</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>EqDecision0</var><span class="hyp-type"><b>: </b><span>EqDecision Address</span></span></span><br><span><var>s</var><span class="hyp-type"><b>: </b><span>State</span></span></span><br><span><var>ob</var><span class="hyp-type"><b>: </b><span>Observation</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">sizeState (s &lt;+&gt; ob) =
sizeState s + sizeObservation ob</div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="bp">by</span> <span class="nb">destruct</span> s; <span class="nb">cbn</span>; <span class="bp">lia</span>.</span><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Qed</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
</span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Definition</span> <span class="nf">addObservations</span> (<span class="nv">obs&#39;</span> : list Observation) (<span class="nv">s</span> : State) : State :=
  MkState (obs&#39; ++ (obs s)) (adr s).</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
</span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Notation</span> <span class="s2">&quot;s &lt;++&gt; obs&quot;</span> := (addObservations obs s) (<span class="kn">left associativity</span>, <span class="kn">at level</span> <span class="mi">50</span>).</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
</span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Definition</span> <span class="nf">addObservationToMessage</span> (<span class="nv">ob</span> : Observation) (<span class="nv">m</span> : Message) : Message :=
  MkMessage (state m &lt;+&gt; ob).</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
</span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Notation</span> <span class="s2">&quot;m &lt;*&gt; ob&quot;</span> := (addObservationToMessage ob m) (<span class="kn">left associativity</span>, <span class="kn">at level</span> <span class="mi">50</span>).</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
</span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Definition</span> <span class="nf">addObservationsToMessage</span> (<span class="nv">obs&#39;</span> : list Observation) (<span class="nv">m</span> : Message) : Message :=
  MkMessage (state m &lt;++&gt; obs&#39;).</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
</span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Notation</span> <span class="s2">&quot;m &lt;**&gt; obs&quot;</span> := (addObservationsToMessage obs m) (<span class="kn">left associativity</span>, <span class="kn">at level</span> <span class="mi">50</span>).</span></span></pre><div class="doc">
<span class="inlinecode">&lt;+&gt;</span> is injective in both arguments. 
</div><pre class="alectryon-io highlight"><!-- Generator: Alectryon --><span class="alectryon-sentence"><input class="alectryon-toggle" id="BaseELMO-v-chk2d" style="display: none" type="checkbox"><label class="alectryon-input" for="BaseELMO-v-chk2d"><span class="kn">Lemma</span> <span class="nf">addObservation_inj</span> :
  <span class="kr">forall</span> (<span class="nv">ob1</span> <span class="nv">ob2</span> : Observation) (<span class="nv">s1</span> <span class="nv">s2</span> : State),
    s1 &lt;+&gt; ob1 = s2 &lt;+&gt; ob2 -&gt; ob1 = ob2 /\ s1 = s2.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>Address</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>EqDecision0</var><span class="hyp-type"><b>: </b><span>EqDecision Address</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="kr">‚àÄ</span> (<span class="nv">ob1</span> <span class="nv">ob2</span> : Observation) (<span class="nv">s1</span> <span class="nv">s2</span> : State),
  s1 &lt;+&gt; ob1 = s2 &lt;+&gt; ob2 ‚Üí ob1 = ob2 ‚àß s1 = s2</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="BaseELMO-v-chk2e" style="display: none" type="checkbox"><label class="alectryon-input" for="BaseELMO-v-chk2e"><span class="kn">Proof</span>.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>Address</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>EqDecision0</var><span class="hyp-type"><b>: </b><span>EqDecision Address</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="kr">‚àÄ</span> (<span class="nv">ob1</span> <span class="nv">ob2</span> : Observation) (<span class="nv">s1</span> <span class="nv">s2</span> : State),
  s1 &lt;+&gt; ob1 = s2 &lt;+&gt; ob2 ‚Üí ob1 = ob2 ‚àß s1 = s2</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="BaseELMO-v-chk2f" style="display: none" type="checkbox"><label class="alectryon-input" for="BaseELMO-v-chk2f"><span class="nb">intros</span> ob1 ob2 s1 s2 [= -&gt;].</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>Address</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>EqDecision0</var><span class="hyp-type"><b>: </b><span>EqDecision Address</span></span></span><br><span><var>ob2</var><span class="hyp-type"><b>: </b><span>Observation</span></span></span><br><span><var>s1, s2</var><span class="hyp-type"><b>: </b><span>State</span></span></span><br><span><var>H0</var><span class="hyp-type"><b>: </b><span>obs s1 = obs s2</span></span></span><br><span><var>H1</var><span class="hyp-type"><b>: </b><span>adr s1 = adr s2</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">ob2 = ob2 ‚àß s1 = s2</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><span class="alectryon-input"><span class="bp">by</span> <span class="nb">split</span>; [| <span class="nb">apply</span> eq_State].</span><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Qed</span>.</span></span></pre><div class="doc">
Adding an observation to a state results in a different state. 
</div><pre class="alectryon-io highlight"><!-- Generator: Alectryon --><span class="alectryon-sentence"><input class="alectryon-toggle" id="BaseELMO-v-chk30" style="display: none" type="checkbox"><label class="alectryon-input" for="BaseELMO-v-chk30"><span class="kn">Lemma</span> <span class="nf">addObservation_acyclic</span> :
  <span class="kr">forall</span> (<span class="nv">ob</span> : Observation) (<span class="nv">s</span> : State),
    s &lt;+&gt; ob &lt;&gt; s.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>Address</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>EqDecision0</var><span class="hyp-type"><b>: </b><span>EqDecision Address</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="kr">‚àÄ</span> (<span class="nv">ob</span> : Observation) (<span class="nv">s</span> : State), s &lt;+&gt; ob ‚â† s</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="BaseELMO-v-chk31" style="display: none" type="checkbox"><label class="alectryon-input" for="BaseELMO-v-chk31"><span class="kn">Proof</span>.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>Address</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>EqDecision0</var><span class="hyp-type"><b>: </b><span>EqDecision Address</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="kr">‚àÄ</span> (<span class="nv">ob</span> : Observation) (<span class="nv">s</span> : State), s &lt;+&gt; ob ‚â† s</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="BaseELMO-v-chk32" style="display: none" type="checkbox"><label class="alectryon-input" for="BaseELMO-v-chk32"><span class="nb">intros</span> ob [obs adr] [= Heq].</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>Address</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>EqDecision0</var><span class="hyp-type"><b>: </b><span>EqDecision Address</span></span></span><br><span><var>ob</var><span class="hyp-type"><b>: </b><span>Observation</span></span></span><br><span><var>obs</var><span class="hyp-type"><b>: </b><span>list Observation</span></span></span><br><span><var>adr</var><span class="hyp-type"><b>: </b><span>Address</span></span></span><br><span><var>Heq</var><span class="hyp-type"><b>: </b><span>addObservation&#39; ob obs = obs</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="kt">False</span></div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="BaseELMO-v-chk33" style="display: none" type="checkbox"><label class="alectryon-input" for="BaseELMO-v-chk33"><span class="nb">unfold</span> addObservation&#39; <span class="kr">in</span> Heq.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>Address</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>EqDecision0</var><span class="hyp-type"><b>: </b><span>EqDecision Address</span></span></span><br><span><var>ob</var><span class="hyp-type"><b>: </b><span>Observation</span></span></span><br><span><var>obs</var><span class="hyp-type"><b>: </b><span>list Observation</span></span></span><br><span><var>adr</var><span class="hyp-type"><b>: </b><span>Address</span></span></span><br><span><var>Heq</var><span class="hyp-type"><b>: </b><span>ob :: obs = obs</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="kt">False</span></div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><span class="alectryon-input"><span class="bp">by</span> <span class="nb">apply</span> (app_inv_tail _ [ob] []) <span class="kr">in</span> Heq.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Qed</span>.</span></span></pre><div class="doc">
Adding no observations does not change the state. 
</div><pre class="alectryon-io highlight"><!-- Generator: Alectryon --><span class="alectryon-sentence"><input class="alectryon-toggle" id="BaseELMO-v-chk34" style="display: none" type="checkbox"><label class="alectryon-input" for="BaseELMO-v-chk34"><span class="kn">Lemma</span> <span class="nf">addObservations_nil</span> :
  <span class="kr">forall</span> <span class="nv">s</span> : State,
    s &lt;++&gt; [] = s.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>Address</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>EqDecision0</var><span class="hyp-type"><b>: </b><span>EqDecision Address</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="kr">‚àÄ</span> <span class="nv">s</span> : State, s &lt;++&gt; [] = s</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="BaseELMO-v-chk35" style="display: none" type="checkbox"><label class="alectryon-input" for="BaseELMO-v-chk35"><span class="kn">Proof</span>.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>Address</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>EqDecision0</var><span class="hyp-type"><b>: </b><span>EqDecision Address</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="kr">‚àÄ</span> <span class="nv">s</span> : State, s &lt;++&gt; [] = s</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><span class="alectryon-input"><span class="bp">by</span> <span class="nb">intros</span> [].</span><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Qed</span>.</span></span></pre><div class="doc">
  Adding a single observation is compatible with adding many observations at
  once, in the obvious way.

</div><pre class="alectryon-io highlight"><!-- Generator: Alectryon --><span class="alectryon-sentence"><input class="alectryon-toggle" id="BaseELMO-v-chk36" style="display: none" type="checkbox"><label class="alectryon-input" for="BaseELMO-v-chk36"><span class="kn">Lemma</span> <span class="nf">addObservations_app</span> :
  <span class="kr">forall</span> (<span class="nv">s</span> : State) (<span class="nv">ob</span> : Observation) (<span class="nv">obs&#39;</span> : list Observation),
    s &lt;+&gt; ob &lt;++&gt; obs&#39; = s &lt;++&gt; (obs&#39; ++ [ob]).</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>Address</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>EqDecision0</var><span class="hyp-type"><b>: </b><span>EqDecision Address</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="kr">‚àÄ</span> (<span class="nv">s</span> : State) (<span class="nv">ob</span> : Observation) (<span class="nv">obs&#39;</span> : list
                                           Observation),
  s &lt;+&gt; ob &lt;++&gt; obs&#39; = s &lt;++&gt; (obs&#39; ++ [ob])</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="BaseELMO-v-chk37" style="display: none" type="checkbox"><label class="alectryon-input" for="BaseELMO-v-chk37"><span class="kn">Proof</span>.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>Address</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>EqDecision0</var><span class="hyp-type"><b>: </b><span>EqDecision Address</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="kr">‚àÄ</span> (<span class="nv">s</span> : State) (<span class="nv">ob</span> : Observation) (<span class="nv">obs&#39;</span> : list
                                           Observation),
  s &lt;+&gt; ob &lt;++&gt; obs&#39; = s &lt;++&gt; (obs&#39; ++ [ob])</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="BaseELMO-v-chk38" style="display: none" type="checkbox"><label class="alectryon-input" for="BaseELMO-v-chk38"><span class="nb">intros</span> s ob obs&#39;.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>Address</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>EqDecision0</var><span class="hyp-type"><b>: </b><span>EqDecision Address</span></span></span><br><span><var>s</var><span class="hyp-type"><b>: </b><span>State</span></span></span><br><span><var>ob</var><span class="hyp-type"><b>: </b><span>Observation</span></span></span><br><span><var>obs'</var><span class="hyp-type"><b>: </b><span>list Observation</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">s &lt;+&gt; ob &lt;++&gt; obs&#39; = s &lt;++&gt; (obs&#39; ++ [ob])</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><span class="alectryon-input"><span class="bp">by</span> <span class="nb">apply</span> eq_State; <span class="nb">cbn</span>; [<span class="nb">rewrite</span> &lt;- app_assoc |].</span><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Qed</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
</span><span class="alectryon-sentence"><input class="alectryon-toggle" id="BaseELMO-v-chk39" style="display: none" type="checkbox"><label class="alectryon-input" for="BaseELMO-v-chk39"><span class="kn">Lemma</span> <span class="nf">addObservation_cons</span> :
  <span class="kr">forall</span> (<span class="nv">s</span> : State) (<span class="nv">ob</span> : Observation) (<span class="nv">obs&#39;</span> : list Observation),
    s &lt;++&gt; obs&#39; &lt;+&gt; ob = s &lt;++&gt; (ob :: obs&#39;).</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>Address</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>EqDecision0</var><span class="hyp-type"><b>: </b><span>EqDecision Address</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="kr">‚àÄ</span> (<span class="nv">s</span> : State) (<span class="nv">ob</span> : Observation) (<span class="nv">obs&#39;</span> : list
                                           Observation),
  s &lt;++&gt; obs&#39; &lt;+&gt; ob = s &lt;++&gt; (ob :: obs&#39;)</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="BaseELMO-v-chk3a" style="display: none" type="checkbox"><label class="alectryon-input" for="BaseELMO-v-chk3a"><span class="kn">Proof</span>.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>Address</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>EqDecision0</var><span class="hyp-type"><b>: </b><span>EqDecision Address</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="kr">‚àÄ</span> (<span class="nv">s</span> : State) (<span class="nv">ob</span> : Observation) (<span class="nv">obs&#39;</span> : list
                                           Observation),
  s &lt;++&gt; obs&#39; &lt;+&gt; ob = s &lt;++&gt; (ob :: obs&#39;)</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="BaseELMO-v-chk3b" style="display: none" type="checkbox"><label class="alectryon-input" for="BaseELMO-v-chk3b"><span class="nb">intros</span> s ob obs&#39;.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>Address</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>EqDecision0</var><span class="hyp-type"><b>: </b><span>EqDecision Address</span></span></span><br><span><var>s</var><span class="hyp-type"><b>: </b><span>State</span></span></span><br><span><var>ob</var><span class="hyp-type"><b>: </b><span>Observation</span></span></span><br><span><var>obs'</var><span class="hyp-type"><b>: </b><span>list Observation</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">s &lt;++&gt; obs&#39; &lt;+&gt; ob = s &lt;++&gt; (ob :: obs&#39;)</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><span class="alectryon-input"><span class="bp">by</span> <span class="nb">apply</span> eq_State; <span class="nb">cbn</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Qed</span>.</span></span></pre><div class="doc">
  An observation in <span class="inlinecode"><span class="id" title="var">s</span></span> <span class="inlinecode">&lt;+&gt;</span> <span class="inlinecode"><span class="id" title="var">ob</span></span> is either the added observation <span class="inlinecode"><span class="id" title="var">ob</span></span>
  or an observation in the original state.

</div><pre class="alectryon-io highlight"><!-- Generator: Alectryon --><span class="alectryon-sentence"><input class="alectryon-toggle" id="BaseELMO-v-chk3c" style="display: none" type="checkbox"><label class="alectryon-input" for="BaseELMO-v-chk3c"><span class="kn">Lemma</span> <span class="nf">elem_of_addObservation</span> :
  <span class="kr">forall</span> (<span class="nv">s</span> : State) (<span class="nv">ob</span> <span class="nv">ob&#39;</span> : Observation),
    ob&#39; ‚àà obs (s &lt;+&gt; ob) &lt;-&gt; ob&#39; = ob \/ ob&#39; ‚àà obs s.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>Address</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>EqDecision0</var><span class="hyp-type"><b>: </b><span>EqDecision Address</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="kr">‚àÄ</span> (<span class="nv">s</span> : State) (<span class="nv">ob</span> <span class="nv">ob&#39;</span> : Observation),
  ob&#39; ‚àà obs (s &lt;+&gt; ob) ‚Üî ob&#39; = ob ‚à® ob&#39; ‚àà obs s</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="BaseELMO-v-chk3d" style="display: none" type="checkbox"><label class="alectryon-input" for="BaseELMO-v-chk3d"><span class="kn">Proof</span>.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>Address</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>EqDecision0</var><span class="hyp-type"><b>: </b><span>EqDecision Address</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="kr">‚àÄ</span> (<span class="nv">s</span> : State) (<span class="nv">ob</span> <span class="nv">ob&#39;</span> : Observation),
  ob&#39; ‚àà obs (s &lt;+&gt; ob) ‚Üî ob&#39; = ob ‚à® ob&#39; ‚àà obs s</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="BaseELMO-v-chk3e" style="display: none" type="checkbox"><label class="alectryon-input" for="BaseELMO-v-chk3e"><span class="nb">intros</span> [s_obs a] ob ob&#39;.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>Address</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>EqDecision0</var><span class="hyp-type"><b>: </b><span>EqDecision Address</span></span></span><br><span><var>s_obs</var><span class="hyp-type"><b>: </b><span>list Observation</span></span></span><br><span><var>a</var><span class="hyp-type"><b>: </b><span>Address</span></span></span><br><span><var>ob, ob'</var><span class="hyp-type"><b>: </b><span>Observation</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">ob&#39; ‚àà obs (MkState s_obs a &lt;+&gt; ob)
‚Üî ob&#39; = ob ‚à® ob&#39; ‚àà obs (MkState s_obs a)</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="BaseELMO-v-chk3f" style="display: none" type="checkbox"><label class="alectryon-input" for="BaseELMO-v-chk3f"><span class="nb">cbn</span>; <span class="nb">unfold</span> addObservation&#39;.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>Address</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>EqDecision0</var><span class="hyp-type"><b>: </b><span>EqDecision Address</span></span></span><br><span><var>s_obs</var><span class="hyp-type"><b>: </b><span>list Observation</span></span></span><br><span><var>a</var><span class="hyp-type"><b>: </b><span>Address</span></span></span><br><span><var>ob, ob'</var><span class="hyp-type"><b>: </b><span>Observation</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">ob&#39; ‚àà ob :: s_obs ‚Üî ob&#39; = ob ‚à® ob&#39; ‚àà s_obs</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><span class="alectryon-input"><span class="bp">by</span> <span class="nb">apply</span> elem_of_cons.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Qed</span>.</span></span></pre><div class="doc">
  The immediate substate relation. May be used to prove that
  a <span class="inlinecode"><span class="id" title="var">State</span></span> does not contain itself.

</div><pre class="alectryon-io highlight"><!-- Generator: Alectryon --><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Inductive</span> <span class="nf">immediate_substate</span> : State -&gt; State -&gt; <span class="kt">Prop</span> :=
| substate_prev : <span class="kr">forall</span> <span class="nv">s</span> <span class="nv">ob</span>, immediate_substate s (s &lt;+&gt; ob)
| substate_new : <span class="kr">forall</span> <span class="nv">s</span> <span class="nv">ob</span>, immediate_substate (state (message ob)) (s &lt;+&gt; ob).</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
</span><span class="alectryon-sentence"><input class="alectryon-toggle" id="BaseELMO-v-chk40" style="display: none" type="checkbox"><label class="alectryon-input" for="BaseELMO-v-chk40"><span class="kn">Lemma</span> <span class="nf">immediate_substate_wf</span> : well_founded immediate_substate.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>Address</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>EqDecision0</var><span class="hyp-type"><b>: </b><span>EqDecision Address</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="kn">wf</span> immediate_substate</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="BaseELMO-v-chk41" style="display: none" type="checkbox"><label class="alectryon-input" for="BaseELMO-v-chk41"><span class="kn">Proof</span>.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>Address</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>EqDecision0</var><span class="hyp-type"><b>: </b><span>EqDecision Address</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="kn">wf</span> immediate_substate</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="BaseELMO-v-chk42" style="display: none" type="checkbox"><label class="alectryon-input" for="BaseELMO-v-chk42"><span class="nb">intro</span> s; <span class="nb">induction</span> s <span class="nb">using</span> addObservation_both_ind; <span class="nb">constructor</span>.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>Address</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>EqDecision0</var><span class="hyp-type"><b>: </b><span>EqDecision Address</span></span></span><br><span><var>a</var><span class="hyp-type"><b>: </b><span>Address</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="kr">‚àÄ</span> <span class="nv">y</span> : State,
  immediate_substate y (MkState [] a)
  ‚Üí Acc immediate_substate y</div></blockquote><div class="alectryon-extra-goals"><input class="alectryon-extra-goal-toggle" id="BaseELMO-v-chk43" style="display: none" type="checkbox"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>Address</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>EqDecision0</var><span class="hyp-type"><b>: </b><span>EqDecision Address</span></span></span><br><span><var>s1</var><span class="hyp-type"><b>: </b><span>State</span></span></span><br><span><var>l</var><span class="hyp-type"><b>: </b><span>Label</span></span></span><br><span><var>s2</var><span class="hyp-type"><b>: </b><span>State</span></span></span><br><span><var>IHs1</var><span class="hyp-type"><b>: </b><span>Acc immediate_substate s1</span></span></span><br><span><var>IHs2</var><span class="hyp-type"><b>: </b><span>Acc immediate_substate s2</span></span></span><br></div><label class="goal-separator" for="BaseELMO-v-chk43"><hr></label><div class="goal-conclusion"><span class="kr">‚àÄ</span> <span class="nv">y</span> : State,
  immediate_substate y
    (s1 &lt;+&gt; MkObservation l (MkMessage s2))
  ‚Üí Acc immediate_substate y</div></blockquote></div></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="BaseELMO-v-chk44" style="display: none" type="checkbox"><label class="alectryon-input" for="BaseELMO-v-chk44">-</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>Address</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>EqDecision0</var><span class="hyp-type"><b>: </b><span>EqDecision Address</span></span></span><br><span><var>a</var><span class="hyp-type"><b>: </b><span>Address</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="kr">‚àÄ</span> <span class="nv">y</span> : State,
  immediate_substate y (MkState [] a)
  ‚Üí Acc immediate_substate y</div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="bp">by</span> <span class="nb">inversion</span> <span class="mi">1</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="BaseELMO-v-chk45" style="display: none" type="checkbox"><label class="alectryon-input" for="BaseELMO-v-chk45">-</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>Address</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>EqDecision0</var><span class="hyp-type"><b>: </b><span>EqDecision Address</span></span></span><br><span><var>s1</var><span class="hyp-type"><b>: </b><span>State</span></span></span><br><span><var>l</var><span class="hyp-type"><b>: </b><span>Label</span></span></span><br><span><var>s2</var><span class="hyp-type"><b>: </b><span>State</span></span></span><br><span><var>IHs1</var><span class="hyp-type"><b>: </b><span>Acc immediate_substate s1</span></span></span><br><span><var>IHs2</var><span class="hyp-type"><b>: </b><span>Acc immediate_substate s2</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="kr">‚àÄ</span> <span class="nv">y</span> : State,
  immediate_substate y
    (s1 &lt;+&gt; MkObservation l (MkMessage s2))
  ‚Üí Acc immediate_substate y</div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="bp">by</span> <span class="nb">inversion</span> <span class="mi">1</span>; [<span class="nb">rewrite</span> (eq_State y s1) | <span class="nb">subst</span> y].</span><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Qed</span>.</span></span></pre><div class="doc">
<a id="lab4"></a><h3 class="section">Messages sent and received by a State</h3>
</div><pre class="alectryon-io highlight"><!-- Generator: Alectryon --><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Definition</span> <span class="nf">isSend</span> (<span class="nv">ob</span> : Observation) : <span class="kt">Prop</span> :=
  <span class="kr">match</span> label ob <span class="kr">with</span>
  | Send =&gt; <span class="kt">True</span>
  | Receive =&gt; <span class="kt">False</span>
  <span class="kr">end</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
</span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Definition</span> <span class="nf">isReceive</span> (<span class="nv">ob</span> : Observation) : <span class="kt">Prop</span> :=
  <span class="kr">match</span> label ob <span class="kr">with</span>
  | Send =&gt; <span class="kt">False</span>
  | Receive =&gt; <span class="kt">True</span>
  <span class="kr">end</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
</span><span class="alectryon-sentence"><input class="alectryon-toggle" id="BaseELMO-v-chk46" style="display: none" type="checkbox"><label class="alectryon-input" for="BaseELMO-v-chk46">#[export] <span class="kn">Instance</span> <span class="nf">isSend_dec</span> (<span class="nv">ob</span> : Observation) : Decision (isSend ob).</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>Address</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>EqDecision0</var><span class="hyp-type"><b>: </b><span>EqDecision Address</span></span></span><br><span><var>ob</var><span class="hyp-type"><b>: </b><span>Observation</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">Decision (isSend ob)</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="BaseELMO-v-chk47" style="display: none" type="checkbox"><label class="alectryon-input" for="BaseELMO-v-chk47"><span class="kn">Proof</span>.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>Address</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>EqDecision0</var><span class="hyp-type"><b>: </b><span>EqDecision Address</span></span></span><br><span><var>ob</var><span class="hyp-type"><b>: </b><span>Observation</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">Decision (isSend ob)</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><span class="alectryon-input"><span class="bp">by</span> <span class="nb">destruct</span> ob <span class="kr">as</span> [[] m]; <span class="nb">cbn</span>; <span class="nb">typeclasses eauto</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Defined</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
</span><span class="alectryon-sentence"><input class="alectryon-toggle" id="BaseELMO-v-chk48" style="display: none" type="checkbox"><label class="alectryon-input" for="BaseELMO-v-chk48">#[export] <span class="kn">Instance</span> <span class="nf">isReceive_dec</span> (<span class="nv">ob</span> : Observation) : Decision (isReceive ob).</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>Address</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>EqDecision0</var><span class="hyp-type"><b>: </b><span>EqDecision Address</span></span></span><br><span><var>ob</var><span class="hyp-type"><b>: </b><span>Observation</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">Decision (isReceive ob)</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="BaseELMO-v-chk49" style="display: none" type="checkbox"><label class="alectryon-input" for="BaseELMO-v-chk49"><span class="kn">Proof</span>.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>Address</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>EqDecision0</var><span class="hyp-type"><b>: </b><span>EqDecision Address</span></span></span><br><span><var>ob</var><span class="hyp-type"><b>: </b><span>Observation</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">Decision (isReceive ob)</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><span class="alectryon-input"><span class="bp">by</span> <span class="nb">destruct</span> ob <span class="kr">as</span> [[] m]; <span class="nb">cbn</span>; <span class="nb">typeclasses eauto</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Defined</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
</span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Definition</span> <span class="nf">messages&#39;</span> (<span class="nv">obs</span> : list Observation) : list Message :=
  map message obs.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
</span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Definition</span> <span class="nf">messages</span> (<span class="nv">st</span> : State) : list Message :=
  messages&#39; (obs st).</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
</span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Definition</span> <span class="nf">sentMessages&#39;</span> (<span class="nv">obs</span> : list Observation) : list Message :=
  map message (filter isSend obs).</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
</span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Definition</span> <span class="nf">sentMessages</span> (<span class="nv">st</span> : State) : list Message :=
  sentMessages&#39; (obs st).</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
</span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Definition</span> <span class="nf">receivedMessages&#39;</span> (<span class="nv">obs</span> : list Observation) : list Message :=
  map message (filter isReceive obs).</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
</span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Definition</span> <span class="nf">receivedMessages</span> (<span class="nv">st</span> : State) : list Message :=
  receivedMessages&#39; (obs st).</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
</span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Definition</span> <span class="nf">receivedAddresses</span> (<span class="nv">st</span> : State) : list Address :=
  map (<span class="kr">fun</span> <span class="nv">m</span> =&gt; adr (state m)) (receivedMessages st).</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
</span><span class="alectryon-sentence"><input class="alectryon-toggle" id="BaseELMO-v-chk4a" style="display: none" type="checkbox"><label class="alectryon-input" for="BaseELMO-v-chk4a"><span class="kn">Lemma</span> <span class="nf">elem_of_map_filter_addObservation</span>
  [B] (f : Observation -&gt; B)
  (P : Observation -&gt; <span class="kt">Prop</span>) {P_dec : <span class="kr">forall</span> <span class="nv">a</span>, Decision (P a)} :
  <span class="kr">forall</span> <span class="nv">s</span> <span class="nv">ob</span> <span class="nv">v</span>,
    v ‚àà map f (filter P (obs (s &lt;+&gt; ob)))
      &lt;-&gt;
    v = f ob /\ P ob \/ v ‚àà map f (filter P (obs s)).</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>Address</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>EqDecision0</var><span class="hyp-type"><b>: </b><span>EqDecision Address</span></span></span><br><span><var>B</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>f</var><span class="hyp-type"><b>: </b><span>Observation ‚Üí B</span></span></span><br><span><var>P</var><span class="hyp-type"><b>: </b><span>Observation ‚Üí <span class="kt">Prop</span></span></span></span><br><span><var>P_dec</var><span class="hyp-type"><b>: </b><span><span class="kr">‚àÄ</span> <span class="nv">a</span> : Observation, Decision (P a)</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="kr">‚àÄ</span> (<span class="nv">s</span> : State) (<span class="nv">ob</span> : Observation) (<span class="nv">v</span> : B),
  v ‚àà map f (filter P (obs (s &lt;+&gt; ob)))
  ‚Üî v = f ob ‚àß P ob ‚à® v ‚àà map f (filter P (obs s))</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="BaseELMO-v-chk4b" style="display: none" type="checkbox"><label class="alectryon-input" for="BaseELMO-v-chk4b"><span class="kn">Proof</span>.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>Address</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>EqDecision0</var><span class="hyp-type"><b>: </b><span>EqDecision Address</span></span></span><br><span><var>B</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>f</var><span class="hyp-type"><b>: </b><span>Observation ‚Üí B</span></span></span><br><span><var>P</var><span class="hyp-type"><b>: </b><span>Observation ‚Üí <span class="kt">Prop</span></span></span></span><br><span><var>P_dec</var><span class="hyp-type"><b>: </b><span><span class="kr">‚àÄ</span> <span class="nv">a</span> : Observation, Decision (P a)</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="kr">‚àÄ</span> (<span class="nv">s</span> : State) (<span class="nv">ob</span> : Observation) (<span class="nv">v</span> : B),
  v ‚àà map f (filter P (obs (s &lt;+&gt; ob)))
  ‚Üî v = f ob ‚àß P ob ‚à® v ‚àà map f (filter P (obs s))</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="BaseELMO-v-chk4c" style="display: none" type="checkbox"><label class="alectryon-input" for="BaseELMO-v-chk4c"><span class="nb">intros</span> s ob v.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>Address</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>EqDecision0</var><span class="hyp-type"><b>: </b><span>EqDecision Address</span></span></span><br><span><var>B</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>f</var><span class="hyp-type"><b>: </b><span>Observation ‚Üí B</span></span></span><br><span><var>P</var><span class="hyp-type"><b>: </b><span>Observation ‚Üí <span class="kt">Prop</span></span></span></span><br><span><var>P_dec</var><span class="hyp-type"><b>: </b><span><span class="kr">‚àÄ</span> <span class="nv">a</span> : Observation, Decision (P a)</span></span></span><br><span><var>s</var><span class="hyp-type"><b>: </b><span>State</span></span></span><br><span><var>ob</var><span class="hyp-type"><b>: </b><span>Observation</span></span></span><br><span><var>v</var><span class="hyp-type"><b>: </b><span>B</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">v ‚àà map f (filter P (obs (s &lt;+&gt; ob)))
‚Üî v = f ob ‚àß P ob ‚à® v ‚àà map f (filter P (obs s))</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="BaseELMO-v-chk4d" style="display: none" type="checkbox"><label class="alectryon-input" for="BaseELMO-v-chk4d"><span class="nb">rewrite</span> !elem_of_list_fmap.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>Address</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>EqDecision0</var><span class="hyp-type"><b>: </b><span>EqDecision Address</span></span></span><br><span><var>B</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>f</var><span class="hyp-type"><b>: </b><span>Observation ‚Üí B</span></span></span><br><span><var>P</var><span class="hyp-type"><b>: </b><span>Observation ‚Üí <span class="kt">Prop</span></span></span></span><br><span><var>P_dec</var><span class="hyp-type"><b>: </b><span><span class="kr">‚àÄ</span> <span class="nv">a</span> : Observation, Decision (P a)</span></span></span><br><span><var>s</var><span class="hyp-type"><b>: </b><span>State</span></span></span><br><span><var>ob</var><span class="hyp-type"><b>: </b><span>Observation</span></span></span><br><span><var>v</var><span class="hyp-type"><b>: </b><span>B</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">(<span class="kr">‚àÉ</span> <span class="nv">y</span> : Observation,
   v = f y ‚àß y ‚àà filter P (obs (s &lt;+&gt; ob)))
‚Üî v = f ob ‚àß P ob
  ‚à® (<span class="kr">‚àÉ</span> <span class="nv">y</span> : Observation, v = f y ‚àß y ‚àà filter P (obs s))</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="BaseELMO-v-chk4e" style="display: none" type="checkbox"><label class="alectryon-input" for="BaseELMO-v-chk4e"><span class="nb">setoid_rewrite</span> elem_of_list_filter.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>Address</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>EqDecision0</var><span class="hyp-type"><b>: </b><span>EqDecision Address</span></span></span><br><span><var>B</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>f</var><span class="hyp-type"><b>: </b><span>Observation ‚Üí B</span></span></span><br><span><var>P</var><span class="hyp-type"><b>: </b><span>Observation ‚Üí <span class="kt">Prop</span></span></span></span><br><span><var>P_dec</var><span class="hyp-type"><b>: </b><span><span class="kr">‚àÄ</span> <span class="nv">a</span> : Observation, Decision (P a)</span></span></span><br><span><var>s</var><span class="hyp-type"><b>: </b><span>State</span></span></span><br><span><var>ob</var><span class="hyp-type"><b>: </b><span>Observation</span></span></span><br><span><var>v</var><span class="hyp-type"><b>: </b><span>B</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">(<span class="kr">‚àÉ</span> <span class="nv">y</span> : Observation, v = f y ‚àß P y ‚àß y ‚àà obs (s &lt;+&gt; ob))
‚Üî v = f ob ‚àß P ob
  ‚à® (<span class="kr">‚àÉ</span> <span class="nv">y</span> : Observation, v = f y ‚àß P y ‚àß y ‚àà obs s)</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="BaseELMO-v-chk4f" style="display: none" type="checkbox"><label class="alectryon-input" for="BaseELMO-v-chk4f"><span class="nb">cbn</span>; <span class="nb">unfold</span> addObservation&#39;.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>Address</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>EqDecision0</var><span class="hyp-type"><b>: </b><span>EqDecision Address</span></span></span><br><span><var>B</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>f</var><span class="hyp-type"><b>: </b><span>Observation ‚Üí B</span></span></span><br><span><var>P</var><span class="hyp-type"><b>: </b><span>Observation ‚Üí <span class="kt">Prop</span></span></span></span><br><span><var>P_dec</var><span class="hyp-type"><b>: </b><span><span class="kr">‚àÄ</span> <span class="nv">a</span> : Observation, Decision (P a)</span></span></span><br><span><var>s</var><span class="hyp-type"><b>: </b><span>State</span></span></span><br><span><var>ob</var><span class="hyp-type"><b>: </b><span>Observation</span></span></span><br><span><var>v</var><span class="hyp-type"><b>: </b><span>B</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">(<span class="kr">‚àÉ</span> <span class="nv">y</span> : Observation, v = f y ‚àß P y ‚àß y ‚àà ob :: obs s)
‚Üî v = f ob ‚àß P ob
  ‚à® (<span class="kr">‚àÉ</span> <span class="nv">y</span> : Observation, v = f y ‚àß P y ‚àß y ‚àà obs s)</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="BaseELMO-v-chk50" style="display: none" type="checkbox"><label class="alectryon-input" for="BaseELMO-v-chk50"><span class="nb">setoid_rewrite</span> elem_of_cons.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>Address</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>EqDecision0</var><span class="hyp-type"><b>: </b><span>EqDecision Address</span></span></span><br><span><var>B</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>f</var><span class="hyp-type"><b>: </b><span>Observation ‚Üí B</span></span></span><br><span><var>P</var><span class="hyp-type"><b>: </b><span>Observation ‚Üí <span class="kt">Prop</span></span></span></span><br><span><var>P_dec</var><span class="hyp-type"><b>: </b><span><span class="kr">‚àÄ</span> <span class="nv">a</span> : Observation, Decision (P a)</span></span></span><br><span><var>s</var><span class="hyp-type"><b>: </b><span>State</span></span></span><br><span><var>ob</var><span class="hyp-type"><b>: </b><span>Observation</span></span></span><br><span><var>v</var><span class="hyp-type"><b>: </b><span>B</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">(<span class="kr">‚àÉ</span> <span class="nv">y</span> : Observation,
   v = f y ‚àß P y ‚àß (y = ob ‚à® y ‚àà obs s))
‚Üî v = f ob ‚àß P ob
  ‚à® (<span class="kr">‚àÉ</span> <span class="nv">y</span> : Observation, v = f y ‚àß P y ‚àß y ‚àà obs s)</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><span class="alectryon-input"><span class="bp">by</span> <span class="nb">split</span>; <span class="nb">intros</span> H; <span class="nb">decompose</span> [<span class="kn">and</span> or ex] H; <span class="nb">subst</span>; <span class="nb">eauto</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Qed</span>.</span></span></pre><div class="doc">
  When a message belongs to the <span class="inlinecode"><span class="id" title="var">sentMessages</span></span> of some state, then the state
  contains a corresponding observation which was sent. The converse also holds.

</div><pre class="alectryon-io highlight"><!-- Generator: Alectryon --><span class="alectryon-sentence"><input class="alectryon-toggle" id="BaseELMO-v-chk51" style="display: none" type="checkbox"><label class="alectryon-input" for="BaseELMO-v-chk51"><span class="kn">Lemma</span> <span class="nf">elem_of_sentMessages</span> :
  <span class="kr">forall</span> (<span class="nv">s</span> : State) (<span class="nv">m</span> : Message),
    m ‚àà sentMessages s &lt;-&gt; MkObservation Send m ‚àà obs s.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>Address</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>EqDecision0</var><span class="hyp-type"><b>: </b><span>EqDecision Address</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="kr">‚àÄ</span> (<span class="nv">s</span> : State) (<span class="nv">m</span> : Message),
  m ‚àà sentMessages s ‚Üî MkObservation Send m ‚àà obs s</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="BaseELMO-v-chk52" style="display: none" type="checkbox"><label class="alectryon-input" for="BaseELMO-v-chk52"><span class="kn">Proof</span>.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>Address</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>EqDecision0</var><span class="hyp-type"><b>: </b><span>EqDecision Address</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="kr">‚àÄ</span> (<span class="nv">s</span> : State) (<span class="nv">m</span> : Message),
  m ‚àà sentMessages s ‚Üî MkObservation Send m ‚àà obs s</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="BaseELMO-v-chk53" style="display: none" type="checkbox"><label class="alectryon-input" for="BaseELMO-v-chk53"><span class="nb">intros</span>; <span class="nb">unfold</span> sentMessages, sentMessages&#39;.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>Address</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>EqDecision0</var><span class="hyp-type"><b>: </b><span>EqDecision Address</span></span></span><br><span><var>s</var><span class="hyp-type"><b>: </b><span>State</span></span></span><br><span><var>m</var><span class="hyp-type"><b>: </b><span>Message</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">m ‚àà map message (filter isSend (obs s))
‚Üî MkObservation Send m ‚àà obs s</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="BaseELMO-v-chk54" style="display: none" type="checkbox"><label class="alectryon-input" for="BaseELMO-v-chk54"><span class="nb">rewrite</span> elem_of_list_fmap; <span class="nb">setoid_rewrite</span> elem_of_list_filter.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>Address</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>EqDecision0</var><span class="hyp-type"><b>: </b><span>EqDecision Address</span></span></span><br><span><var>s</var><span class="hyp-type"><b>: </b><span>State</span></span></span><br><span><var>m</var><span class="hyp-type"><b>: </b><span>Message</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">(<span class="kr">‚àÉ</span> <span class="nv">y</span> : Observation,
   m = message y ‚àß isSend y ‚àß y ‚àà obs s)
‚Üî MkObservation Send m ‚àà obs s</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="BaseELMO-v-chk55" style="display: none" type="checkbox"><label class="alectryon-input" for="BaseELMO-v-chk55"><span class="nb">split</span>; [| <span class="bp">by</span> <span class="nb">firstorder</span>].</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>Address</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>EqDecision0</var><span class="hyp-type"><b>: </b><span>EqDecision Address</span></span></span><br><span><var>s</var><span class="hyp-type"><b>: </b><span>State</span></span></span><br><span><var>m</var><span class="hyp-type"><b>: </b><span>Message</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">(<span class="kr">‚àÉ</span> <span class="nv">y</span> : Observation,
   m = message y ‚àß isSend y ‚àß y ‚àà obs s)
‚Üí MkObservation Send m ‚àà obs s</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><span class="alectryon-input"><span class="bp">by</span> <span class="nb">intros</span> ([[] ?] &amp; -&gt; &amp; []); <span class="nb">cbn</span> <span class="kr">in</span> *.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Qed</span>.</span></span></pre><div class="doc">
  A message in <span class="inlinecode"><span class="id" title="var">sentMessages</span></span> <span class="inlinecode">(<span class="id" title="var">s</span></span> <span class="inlinecode">&lt;+&gt;</span> <span class="inlinecode"><span class="id" title="var">ob</span>)</span> is either in
  <span class="inlinecode"><span class="id" title="var">sentMessages</span></span> <span class="inlinecode"><span class="id" title="var">s</span></span> or is the message in the new observation <span class="inlinecode"><span class="id" title="var">ob</span></span>,
  and can only be the message from <span class="inlinecode"><span class="id" title="var">ob</span></span> if that is a <span class="inlinecode"><span class="id" title="var">Send</span></span> observation.

</div><pre class="alectryon-io highlight"><!-- Generator: Alectryon --><span class="alectryon-sentence"><input class="alectryon-toggle" id="BaseELMO-v-chk56" style="display: none" type="checkbox"><label class="alectryon-input" for="BaseELMO-v-chk56"><span class="kn">Lemma</span> <span class="nf">elem_of_sentMessages_addObservation</span> :
  <span class="kr">forall</span> (<span class="nv">s</span> : State) (<span class="nv">ob</span> : Observation) (<span class="nv">m</span> : Message),
    m ‚àà sentMessages (s &lt;+&gt; ob)
      &lt;-&gt;
    m = message ob /\ isSend ob \/ m ‚àà sentMessages s.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>Address</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>EqDecision0</var><span class="hyp-type"><b>: </b><span>EqDecision Address</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="kr">‚àÄ</span> (<span class="nv">s</span> : State) (<span class="nv">ob</span> : Observation) (<span class="nv">m</span> : Message),
  m ‚àà sentMessages (s &lt;+&gt; ob)
  ‚Üî m = message ob ‚àß isSend ob ‚à® m ‚àà sentMessages s</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="BaseELMO-v-chk57" style="display: none" type="checkbox"><label class="alectryon-input" for="BaseELMO-v-chk57"><span class="kn">Proof</span>.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>Address</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>EqDecision0</var><span class="hyp-type"><b>: </b><span>EqDecision Address</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="kr">‚àÄ</span> (<span class="nv">s</span> : State) (<span class="nv">ob</span> : Observation) (<span class="nv">m</span> : Message),
  m ‚àà sentMessages (s &lt;+&gt; ob)
  ‚Üî m = message ob ‚àß isSend ob ‚à® m ‚àà sentMessages s</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><span class="alectryon-input"><span class="bp">by</span> <span class="nb">apply</span> elem_of_map_filter_addObservation.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Qed</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
</span><span class="alectryon-sentence"><input class="alectryon-toggle" id="BaseELMO-v-chk58" style="display: none" type="checkbox"><label class="alectryon-input" for="BaseELMO-v-chk58"><span class="kn">Lemma</span> <span class="nf">sentMessages_addObservation</span> :
  <span class="kr">forall</span> (<span class="nv">s</span> : State) (<span class="nv">ob</span> : Observation),
    sentMessages (s &lt;+&gt; ob)
      =
    <span class="kr">if</span> decide (isSend ob) <span class="kr">then</span> message ob :: sentMessages s <span class="kr">else</span> sentMessages s.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>Address</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>EqDecision0</var><span class="hyp-type"><b>: </b><span>EqDecision Address</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="kr">‚àÄ</span> (<span class="nv">s</span> : State) (<span class="nv">ob</span> : Observation),
  sentMessages (s &lt;+&gt; ob) =
  (<span class="kr">if</span> decide (isSend ob)
   <span class="kr">then</span> message ob :: sentMessages s
   <span class="kr">else</span> sentMessages s)</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="BaseELMO-v-chk59" style="display: none" type="checkbox"><label class="alectryon-input" for="BaseELMO-v-chk59"><span class="kn">Proof</span>.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>Address</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>EqDecision0</var><span class="hyp-type"><b>: </b><span>EqDecision Address</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="kr">‚àÄ</span> (<span class="nv">s</span> : State) (<span class="nv">ob</span> : Observation),
  sentMessages (s &lt;+&gt; ob) =
  (<span class="kr">if</span> decide (isSend ob)
   <span class="kr">then</span> message ob :: sentMessages s
   <span class="kr">else</span> sentMessages s)</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="BaseELMO-v-chk5a" style="display: none" type="checkbox"><label class="alectryon-input" for="BaseELMO-v-chk5a"><span class="nb">intros</span> s ob.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>Address</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>EqDecision0</var><span class="hyp-type"><b>: </b><span>EqDecision Address</span></span></span><br><span><var>s</var><span class="hyp-type"><b>: </b><span>State</span></span></span><br><span><var>ob</var><span class="hyp-type"><b>: </b><span>Observation</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">sentMessages (s &lt;+&gt; ob) =
(<span class="kr">if</span> decide (isSend ob)
 <span class="kr">then</span> message ob :: sentMessages s
 <span class="kr">else</span> sentMessages s)</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="BaseELMO-v-chk5b" style="display: none" type="checkbox"><label class="alectryon-input" for="BaseELMO-v-chk5b"><span class="nb">unfold</span> sentMessages, sentMessages&#39;; <span class="nb">cbn</span>.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>Address</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>EqDecision0</var><span class="hyp-type"><b>: </b><span>EqDecision Address</span></span></span><br><span><var>s</var><span class="hyp-type"><b>: </b><span>State</span></span></span><br><span><var>ob</var><span class="hyp-type"><b>: </b><span>Observation</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">map message
  (<span class="kr">if</span> decide (isSend ob)
   <span class="kr">then</span> ob :: filter isSend (obs s)
   <span class="kr">else</span> filter isSend (obs s)) =
(<span class="kr">if</span> decide (isSend ob)
 <span class="kr">then</span>
  message ob :: map message (filter isSend (obs s))
 <span class="kr">else</span> map message (filter isSend (obs s)))</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><span class="alectryon-input"><span class="bp">by</span> <span class="nb">destruct</span> (decide (isSend ob)).</span><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Qed</span>.</span></span></pre><div class="doc">
  When a message belongs to the <span class="inlinecode"><span class="id" title="var">receivedMessages</span></span> of some state, then the state
  contains a corresponding observation which was received. The converse also holds.

</div><pre class="alectryon-io highlight"><!-- Generator: Alectryon --><span class="alectryon-sentence"><input class="alectryon-toggle" id="BaseELMO-v-chk5c" style="display: none" type="checkbox"><label class="alectryon-input" for="BaseELMO-v-chk5c"><span class="kn">Lemma</span> <span class="nf">elem_of_receivedMessages</span> :
  <span class="kr">forall</span> (<span class="nv">s</span> : State) (<span class="nv">m</span> : Message),
    m ‚àà receivedMessages s &lt;-&gt; MkObservation Receive m ‚àà obs s.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>Address</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>EqDecision0</var><span class="hyp-type"><b>: </b><span>EqDecision Address</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="kr">‚àÄ</span> (<span class="nv">s</span> : State) (<span class="nv">m</span> : Message),
  m ‚àà receivedMessages s
  ‚Üî MkObservation Receive m ‚àà obs s</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="BaseELMO-v-chk5d" style="display: none" type="checkbox"><label class="alectryon-input" for="BaseELMO-v-chk5d"><span class="kn">Proof</span>.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>Address</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>EqDecision0</var><span class="hyp-type"><b>: </b><span>EqDecision Address</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="kr">‚àÄ</span> (<span class="nv">s</span> : State) (<span class="nv">m</span> : Message),
  m ‚àà receivedMessages s
  ‚Üî MkObservation Receive m ‚àà obs s</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="BaseELMO-v-chk5e" style="display: none" type="checkbox"><label class="alectryon-input" for="BaseELMO-v-chk5e"><span class="nb">intros</span>; <span class="nb">unfold</span> receivedMessages, receivedMessages&#39;.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>Address</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>EqDecision0</var><span class="hyp-type"><b>: </b><span>EqDecision Address</span></span></span><br><span><var>s</var><span class="hyp-type"><b>: </b><span>State</span></span></span><br><span><var>m</var><span class="hyp-type"><b>: </b><span>Message</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">m ‚àà map message (filter isReceive (obs s))
‚Üî MkObservation Receive m ‚àà obs s</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="BaseELMO-v-chk5f" style="display: none" type="checkbox"><label class="alectryon-input" for="BaseELMO-v-chk5f"><span class="nb">rewrite</span> elem_of_list_fmap; <span class="nb">setoid_rewrite</span> elem_of_list_filter.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>Address</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>EqDecision0</var><span class="hyp-type"><b>: </b><span>EqDecision Address</span></span></span><br><span><var>s</var><span class="hyp-type"><b>: </b><span>State</span></span></span><br><span><var>m</var><span class="hyp-type"><b>: </b><span>Message</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">(<span class="kr">‚àÉ</span> <span class="nv">y</span> : Observation,
   m = message y ‚àß isReceive y ‚àß y ‚àà obs s)
‚Üî MkObservation Receive m ‚àà obs s</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="BaseELMO-v-chk60" style="display: none" type="checkbox"><label class="alectryon-input" for="BaseELMO-v-chk60"><span class="nb">split</span>; [| <span class="bp">by</span> <span class="nb">firstorder</span>].</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>Address</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>EqDecision0</var><span class="hyp-type"><b>: </b><span>EqDecision Address</span></span></span><br><span><var>s</var><span class="hyp-type"><b>: </b><span>State</span></span></span><br><span><var>m</var><span class="hyp-type"><b>: </b><span>Message</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">(<span class="kr">‚àÉ</span> <span class="nv">y</span> : Observation,
   m = message y ‚àß isReceive y ‚àß y ‚àà obs s)
‚Üí MkObservation Receive m ‚àà obs s</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><span class="alectryon-input"><span class="bp">by</span> <span class="nb">intros</span> ([[] ?] &amp; -&gt; &amp; []); <span class="nb">cbn</span> <span class="kr">in</span> *.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Qed</span>.</span></span></pre><div class="doc">
  A message in <span class="inlinecode"><span class="id" title="var">receivedMessages</span></span> <span class="inlinecode">(<span class="id" title="var">s</span></span> <span class="inlinecode">&lt;+&gt;</span> <span class="inlinecode"><span class="id" title="var">ob</span>)</span> is either in
  <span class="inlinecode"><span class="id" title="var">receivedMessages</span></span> <span class="inlinecode"><span class="id" title="var">s</span></span> or is the message in the new observation <span class="inlinecode"><span class="id" title="var">ob</span></span>,
  and can only be the message from <span class="inlinecode"><span class="id" title="var">ob</span></span> if that is a <span class="inlinecode"><span class="id" title="var">Receive</span></span> observation.

</div><pre class="alectryon-io highlight"><!-- Generator: Alectryon --><span class="alectryon-sentence"><input class="alectryon-toggle" id="BaseELMO-v-chk61" style="display: none" type="checkbox"><label class="alectryon-input" for="BaseELMO-v-chk61"><span class="kn">Lemma</span> <span class="nf">elem_of_receivedMessages_addObservation</span> :
  <span class="kr">forall</span> (<span class="nv">s</span> : State) (<span class="nv">ob</span> : Observation) (<span class="nv">m</span> : Message),
    m ‚àà receivedMessages (s &lt;+&gt; ob)
      &lt;-&gt;
    m = message ob /\ isReceive ob \/ m ‚àà receivedMessages s.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>Address</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>EqDecision0</var><span class="hyp-type"><b>: </b><span>EqDecision Address</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="kr">‚àÄ</span> (<span class="nv">s</span> : State) (<span class="nv">ob</span> : Observation) (<span class="nv">m</span> : Message),
  m ‚àà receivedMessages (s &lt;+&gt; ob)
  ‚Üî m = message ob ‚àß isReceive ob
    ‚à® m ‚àà receivedMessages s</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="BaseELMO-v-chk62" style="display: none" type="checkbox"><label class="alectryon-input" for="BaseELMO-v-chk62"><span class="kn">Proof</span>.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>Address</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>EqDecision0</var><span class="hyp-type"><b>: </b><span>EqDecision Address</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="kr">‚àÄ</span> (<span class="nv">s</span> : State) (<span class="nv">ob</span> : Observation) (<span class="nv">m</span> : Message),
  m ‚àà receivedMessages (s &lt;+&gt; ob)
  ‚Üî m = message ob ‚àß isReceive ob
    ‚à® m ‚àà receivedMessages s</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><span class="alectryon-input"><span class="bp">by</span> <span class="nb">apply</span> elem_of_map_filter_addObservation.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Qed</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
</span><span class="alectryon-sentence"><input class="alectryon-toggle" id="BaseELMO-v-chk63" style="display: none" type="checkbox"><label class="alectryon-input" for="BaseELMO-v-chk63"><span class="kn">Lemma</span> <span class="nf">receivedMessages_addObservation</span> :
  <span class="kr">forall</span> (<span class="nv">s</span> : State) (<span class="nv">ob</span> : Observation),
    receivedMessages (s &lt;+&gt; ob)
      =
    <span class="kr">if</span> decide (isReceive ob) <span class="kr">then</span> message ob :: receivedMessages s <span class="kr">else</span> receivedMessages s.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>Address</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>EqDecision0</var><span class="hyp-type"><b>: </b><span>EqDecision Address</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="kr">‚àÄ</span> (<span class="nv">s</span> : State) (<span class="nv">ob</span> : Observation),
  receivedMessages (s &lt;+&gt; ob) =
  (<span class="kr">if</span> decide (isReceive ob)
   <span class="kr">then</span> message ob :: receivedMessages s
   <span class="kr">else</span> receivedMessages s)</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="BaseELMO-v-chk64" style="display: none" type="checkbox"><label class="alectryon-input" for="BaseELMO-v-chk64"><span class="kn">Proof</span>.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>Address</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>EqDecision0</var><span class="hyp-type"><b>: </b><span>EqDecision Address</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="kr">‚àÄ</span> (<span class="nv">s</span> : State) (<span class="nv">ob</span> : Observation),
  receivedMessages (s &lt;+&gt; ob) =
  (<span class="kr">if</span> decide (isReceive ob)
   <span class="kr">then</span> message ob :: receivedMessages s
   <span class="kr">else</span> receivedMessages s)</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="BaseELMO-v-chk65" style="display: none" type="checkbox"><label class="alectryon-input" for="BaseELMO-v-chk65"><span class="nb">intros</span> s ob.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>Address</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>EqDecision0</var><span class="hyp-type"><b>: </b><span>EqDecision Address</span></span></span><br><span><var>s</var><span class="hyp-type"><b>: </b><span>State</span></span></span><br><span><var>ob</var><span class="hyp-type"><b>: </b><span>Observation</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">receivedMessages (s &lt;+&gt; ob) =
(<span class="kr">if</span> decide (isReceive ob)
 <span class="kr">then</span> message ob :: receivedMessages s
 <span class="kr">else</span> receivedMessages s)</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="BaseELMO-v-chk66" style="display: none" type="checkbox"><label class="alectryon-input" for="BaseELMO-v-chk66"><span class="nb">unfold</span> receivedMessages, receivedMessages&#39;; <span class="nb">cbn</span>.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>Address</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>EqDecision0</var><span class="hyp-type"><b>: </b><span>EqDecision Address</span></span></span><br><span><var>s</var><span class="hyp-type"><b>: </b><span>State</span></span></span><br><span><var>ob</var><span class="hyp-type"><b>: </b><span>Observation</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">map message
  (<span class="kr">if</span> decide (isReceive ob)
   <span class="kr">then</span> ob :: filter isReceive (obs s)
   <span class="kr">else</span> filter isReceive (obs s)) =
(<span class="kr">if</span> decide (isReceive ob)
 <span class="kr">then</span>
  message ob :: map message (filter isReceive (obs s))
 <span class="kr">else</span> map message (filter isReceive (obs s)))</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><span class="alectryon-input"><span class="bp">by</span> <span class="nb">destruct</span> (decide (isReceive ob)).</span><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Qed</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
</span><span class="alectryon-sentence"><input class="alectryon-toggle" id="BaseELMO-v-chk67" style="display: none" type="checkbox"><label class="alectryon-input" for="BaseELMO-v-chk67"><span class="kn">Lemma</span> <span class="nf">elem_of_messages</span> :
  <span class="kr">forall</span> (<span class="nv">s</span> : State) (<span class="nv">m</span> : Message),
    m ‚àà messages s &lt;-&gt; m ‚àà sentMessages s \/ m ‚àà receivedMessages s.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>Address</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>EqDecision0</var><span class="hyp-type"><b>: </b><span>EqDecision Address</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="kr">‚àÄ</span> (<span class="nv">s</span> : State) (<span class="nv">m</span> : Message),
  m ‚àà messages s
  ‚Üî m ‚àà sentMessages s ‚à® m ‚àà receivedMessages s</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="BaseELMO-v-chk68" style="display: none" type="checkbox"><label class="alectryon-input" for="BaseELMO-v-chk68"><span class="kn">Proof</span>.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>Address</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>EqDecision0</var><span class="hyp-type"><b>: </b><span>EqDecision Address</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="kr">‚àÄ</span> (<span class="nv">s</span> : State) (<span class="nv">m</span> : Message),
  m ‚àà messages s
  ‚Üî m ‚àà sentMessages s ‚à® m ‚àà receivedMessages s</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="BaseELMO-v-chk69" style="display: none" type="checkbox"><label class="alectryon-input" for="BaseELMO-v-chk69"><span class="nb">intros</span>; <span class="nb">unfold</span> messages, messages&#39;.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>Address</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>EqDecision0</var><span class="hyp-type"><b>: </b><span>EqDecision Address</span></span></span><br><span><var>s</var><span class="hyp-type"><b>: </b><span>State</span></span></span><br><span><var>m</var><span class="hyp-type"><b>: </b><span>Message</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">m ‚àà map message (obs s)
‚Üî m ‚àà sentMessages s ‚à® m ‚àà receivedMessages s</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="BaseELMO-v-chk6a" style="display: none" type="checkbox"><label class="alectryon-input" for="BaseELMO-v-chk6a"><span class="nb">rewrite</span> elem_of_sentMessages, elem_of_receivedMessages, elem_of_list_fmap.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>Address</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>EqDecision0</var><span class="hyp-type"><b>: </b><span>EqDecision Address</span></span></span><br><span><var>s</var><span class="hyp-type"><b>: </b><span>State</span></span></span><br><span><var>m</var><span class="hyp-type"><b>: </b><span>Message</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">(<span class="kr">‚àÉ</span> <span class="nv">y</span> : Observation, m = message y ‚àß y ‚àà obs s)
‚Üî MkObservation Send m ‚àà obs s
  ‚à® MkObservation Receive m ‚àà obs s</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="BaseELMO-v-chk6b" style="display: none" type="checkbox"><label class="alectryon-input" for="BaseELMO-v-chk6b"><span class="nb">split</span>.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>Address</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>EqDecision0</var><span class="hyp-type"><b>: </b><span>EqDecision Address</span></span></span><br><span><var>s</var><span class="hyp-type"><b>: </b><span>State</span></span></span><br><span><var>m</var><span class="hyp-type"><b>: </b><span>Message</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">(<span class="kr">‚àÉ</span> <span class="nv">y</span> : Observation, m = message y ‚àß y ‚àà obs s)
‚Üí MkObservation Send m ‚àà obs s
  ‚à® MkObservation Receive m ‚àà obs s</div></blockquote><div class="alectryon-extra-goals"><input class="alectryon-extra-goal-toggle" id="BaseELMO-v-chk6c" style="display: none" type="checkbox"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>Address</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>EqDecision0</var><span class="hyp-type"><b>: </b><span>EqDecision Address</span></span></span><br><span><var>s</var><span class="hyp-type"><b>: </b><span>State</span></span></span><br><span><var>m</var><span class="hyp-type"><b>: </b><span>Message</span></span></span><br></div><label class="goal-separator" for="BaseELMO-v-chk6c"><hr></label><div class="goal-conclusion">MkObservation Send m ‚àà obs s
‚à® MkObservation Receive m ‚àà obs s
‚Üí <span class="kr">‚àÉ</span> <span class="nv">y</span> : Observation, m = message y ‚àß y ‚àà obs s</div></blockquote></div></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="BaseELMO-v-chk6d" style="display: none" type="checkbox"><label class="alectryon-input" for="BaseELMO-v-chk6d">-</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>Address</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>EqDecision0</var><span class="hyp-type"><b>: </b><span>EqDecision Address</span></span></span><br><span><var>s</var><span class="hyp-type"><b>: </b><span>State</span></span></span><br><span><var>m</var><span class="hyp-type"><b>: </b><span>Message</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">(<span class="kr">‚àÉ</span> <span class="nv">y</span> : Observation, m = message y ‚àß y ‚àà obs s)
‚Üí MkObservation Send m ‚àà obs s
  ‚à® MkObservation Receive m ‚àà obs s</div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="bp">by</span> <span class="nb">intros</span> [[[]] [-&gt; Hm]]; <span class="nb">auto</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="BaseELMO-v-chk6e" style="display: none" type="checkbox"><label class="alectryon-input" for="BaseELMO-v-chk6e">-</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>Address</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>EqDecision0</var><span class="hyp-type"><b>: </b><span>EqDecision Address</span></span></span><br><span><var>s</var><span class="hyp-type"><b>: </b><span>State</span></span></span><br><span><var>m</var><span class="hyp-type"><b>: </b><span>Message</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">MkObservation Send m ‚àà obs s
‚à® MkObservation Receive m ‚àà obs s
‚Üí <span class="kr">‚àÉ</span> <span class="nv">y</span> : Observation, m = message y ‚àß y ‚àà obs s</div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="bp">by</span> <span class="nb">intros</span> []; (<span class="nb">eexists</span>; <span class="nb">split</span>; [| <span class="nb">eauto</span>]).</span><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Qed</span>.</span></span></pre><div class="doc">
  A message in <span class="inlinecode"><span class="id" title="var">s</span></span> <span class="inlinecode">&lt;+&gt;</span> <span class="inlinecode"><span class="id" title="var">ob</span></span> is either the message of the added
  observation <span class="inlinecode"><span class="id" title="var">ob</span></span> or a message in the original state.

</div><pre class="alectryon-io highlight"><!-- Generator: Alectryon --><span class="alectryon-sentence"><input class="alectryon-toggle" id="BaseELMO-v-chk6f" style="display: none" type="checkbox"><label class="alectryon-input" for="BaseELMO-v-chk6f"><span class="kn">Lemma</span> <span class="nf">elem_of_messages_addObservation</span> :
  <span class="kr">forall</span> (<span class="nv">s</span> : State) (<span class="nv">ob</span> : Observation) (<span class="nv">m</span> : Message),
    m ‚àà messages (s &lt;+&gt; ob) &lt;-&gt; m = message ob \/ m ‚àà messages s.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>Address</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>EqDecision0</var><span class="hyp-type"><b>: </b><span>EqDecision Address</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="kr">‚àÄ</span> (<span class="nv">s</span> : State) (<span class="nv">ob</span> : Observation) (<span class="nv">m</span> : Message),
  m ‚àà messages (s &lt;+&gt; ob)
  ‚Üî m = message ob ‚à® m ‚àà messages s</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="BaseELMO-v-chk70" style="display: none" type="checkbox"><label class="alectryon-input" for="BaseELMO-v-chk70"><span class="kn">Proof</span>.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>Address</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>EqDecision0</var><span class="hyp-type"><b>: </b><span>EqDecision Address</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="kr">‚àÄ</span> (<span class="nv">s</span> : State) (<span class="nv">ob</span> : Observation) (<span class="nv">m</span> : Message),
  m ‚àà messages (s &lt;+&gt; ob)
  ‚Üî m = message ob ‚à® m ‚àà messages s</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><span class="alectryon-input"><span class="bp">by</span> <span class="nb">intros</span>; <span class="nb">apply</span> elem_of_cons.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Qed</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
</span><span class="alectryon-sentence"><input class="alectryon-toggle" id="BaseELMO-v-chk71" style="display: none" type="checkbox"><label class="alectryon-input" for="BaseELMO-v-chk71"><span class="kn">Lemma</span> <span class="nf">messages_addObservation</span> :
  <span class="kr">forall</span> (<span class="nv">s</span> : State) (<span class="nv">ob</span> : Observation),
    messages (s &lt;+&gt; ob) = message ob :: messages s.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>Address</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>EqDecision0</var><span class="hyp-type"><b>: </b><span>EqDecision Address</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="kr">‚àÄ</span> (<span class="nv">s</span> : State) (<span class="nv">ob</span> : Observation),
  messages (s &lt;+&gt; ob) = message ob :: messages s</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="BaseELMO-v-chk72" style="display: none" type="checkbox"><label class="alectryon-input" for="BaseELMO-v-chk72"><span class="kn">Proof</span>.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>Address</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>EqDecision0</var><span class="hyp-type"><b>: </b><span>EqDecision Address</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="kr">‚àÄ</span> (<span class="nv">s</span> : State) (<span class="nv">ob</span> : Observation),
  messages (s &lt;+&gt; ob) = message ob :: messages s</div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="bp">done</span>.</span><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Qed</span>.</span></span></pre><div class="doc">
  An address in <span class="inlinecode"><span class="id" title="var">receivedAddresses</span></span> <span class="inlinecode">(<span class="id" title="var">s</span></span> <span class="inlinecode">&lt;+&gt;</span> <span class="inlinecode"><span class="id" title="var">ob</span>)</span> is either in
  <span class="inlinecode"><span class="id" title="var">receivedAddresses</span></span> <span class="inlinecode"><span class="id" title="var">s</span></span> or is the address from the message in the
  new observation <span class="inlinecode"><span class="id" title="var">ob</span></span>, and can only be from <span class="inlinecode"><span class="id" title="var">ob</span></span> if that is
  a <span class="inlinecode"><span class="id" title="var">Receive</span></span> observation.

</div><pre class="alectryon-io highlight"><!-- Generator: Alectryon --><span class="alectryon-sentence"><input class="alectryon-toggle" id="BaseELMO-v-chk73" style="display: none" type="checkbox"><label class="alectryon-input" for="BaseELMO-v-chk73"><span class="kn">Lemma</span> <span class="nf">elem_of_receivedAddresses</span> :
  <span class="kr">forall</span> (<span class="nv">s</span> : State) (<span class="nv">ob</span> : Observation) (<span class="nv">a</span> : Address),
    a ‚àà receivedAddresses (s &lt;+&gt; ob)
      &lt;-&gt;
    a = adr (state (message ob)) /\ isReceive ob \/ a ‚àà receivedAddresses s.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>Address</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>EqDecision0</var><span class="hyp-type"><b>: </b><span>EqDecision Address</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="kr">‚àÄ</span> (<span class="nv">s</span> : State) (<span class="nv">ob</span> : Observation) (<span class="nv">a</span> : Address),
  a ‚àà receivedAddresses (s &lt;+&gt; ob)
  ‚Üî a = adr (state (message ob)) ‚àß isReceive ob
    ‚à® a ‚àà receivedAddresses s</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="BaseELMO-v-chk74" style="display: none" type="checkbox"><label class="alectryon-input" for="BaseELMO-v-chk74"><span class="kn">Proof</span>.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>Address</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>EqDecision0</var><span class="hyp-type"><b>: </b><span>EqDecision Address</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="kr">‚àÄ</span> (<span class="nv">s</span> : State) (<span class="nv">ob</span> : Observation) (<span class="nv">a</span> : Address),
  a ‚àà receivedAddresses (s &lt;+&gt; ob)
  ‚Üî a = adr (state (message ob)) ‚àß isReceive ob
    ‚à® a ‚àà receivedAddresses s</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="BaseELMO-v-chk75" style="display: none" type="checkbox"><label class="alectryon-input" for="BaseELMO-v-chk75"><span class="nb">intros</span> s ob a.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>Address</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>EqDecision0</var><span class="hyp-type"><b>: </b><span>EqDecision Address</span></span></span><br><span><var>s</var><span class="hyp-type"><b>: </b><span>State</span></span></span><br><span><var>ob</var><span class="hyp-type"><b>: </b><span>Observation</span></span></span><br><span><var>a</var><span class="hyp-type"><b>: </b><span>Address</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">a ‚àà receivedAddresses (s &lt;+&gt; ob)
‚Üî a = adr (state (message ob)) ‚àß isReceive ob
  ‚à® a ‚àà receivedAddresses s</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="BaseELMO-v-chk76" style="display: none" type="checkbox"><label class="alectryon-input" for="BaseELMO-v-chk76"><span class="nb">unfold</span> receivedAddresses, receivedMessages, receivedMessages&#39;.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>Address</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>EqDecision0</var><span class="hyp-type"><b>: </b><span>EqDecision Address</span></span></span><br><span><var>s</var><span class="hyp-type"><b>: </b><span>State</span></span></span><br><span><var>ob</var><span class="hyp-type"><b>: </b><span>Observation</span></span></span><br><span><var>a</var><span class="hyp-type"><b>: </b><span>Address</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">a
‚àà map (<span class="kr">Œª</span> <span class="nv">m</span> : Message, adr (state m))
    (map message (filter isReceive (obs (s &lt;+&gt; ob))))
‚Üî a = adr (state (message ob)) ‚àß isReceive ob
  ‚à® a
    ‚àà map (<span class="kr">Œª</span> <span class="nv">m</span> : Message, adr (state m))
        (map message (filter isReceive (obs s)))</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><span class="alectryon-input"><span class="bp">by</span> <span class="nb">rewrite</span> !map_map, elem_of_map_filter_addObservation.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Qed</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
</span><span class="alectryon-sentence"><input class="alectryon-toggle" id="BaseELMO-v-chk77" style="display: none" type="checkbox"><label class="alectryon-input" for="BaseELMO-v-chk77"><span class="kn">Lemma</span> <span class="nf">receivedAddresses_addObservation</span> :
  <span class="kr">forall</span> (<span class="nv">s</span> : State) (<span class="nv">ob</span> : Observation),
    receivedAddresses (s &lt;+&gt; ob)
      =
    <span class="kr">if</span> decide (isReceive ob)
    <span class="kr">then</span> adr (state (message ob)) :: receivedAddresses s
    <span class="kr">else</span> receivedAddresses s.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>Address</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>EqDecision0</var><span class="hyp-type"><b>: </b><span>EqDecision Address</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="kr">‚àÄ</span> (<span class="nv">s</span> : State) (<span class="nv">ob</span> : Observation),
  receivedAddresses (s &lt;+&gt; ob) =
  (<span class="kr">if</span> decide (isReceive ob)
   <span class="kr">then</span>
    adr (state (message ob)) :: receivedAddresses s
   <span class="kr">else</span> receivedAddresses s)</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="BaseELMO-v-chk78" style="display: none" type="checkbox"><label class="alectryon-input" for="BaseELMO-v-chk78"><span class="kn">Proof</span>.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>Address</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>EqDecision0</var><span class="hyp-type"><b>: </b><span>EqDecision Address</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="kr">‚àÄ</span> (<span class="nv">s</span> : State) (<span class="nv">ob</span> : Observation),
  receivedAddresses (s &lt;+&gt; ob) =
  (<span class="kr">if</span> decide (isReceive ob)
   <span class="kr">then</span>
    adr (state (message ob)) :: receivedAddresses s
   <span class="kr">else</span> receivedAddresses s)</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="BaseELMO-v-chk79" style="display: none" type="checkbox"><label class="alectryon-input" for="BaseELMO-v-chk79"><span class="nb">intros</span> s ob.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>Address</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>EqDecision0</var><span class="hyp-type"><b>: </b><span>EqDecision Address</span></span></span><br><span><var>s</var><span class="hyp-type"><b>: </b><span>State</span></span></span><br><span><var>ob</var><span class="hyp-type"><b>: </b><span>Observation</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">receivedAddresses (s &lt;+&gt; ob) =
(<span class="kr">if</span> decide (isReceive ob)
 <span class="kr">then</span> adr (state (message ob)) :: receivedAddresses s
 <span class="kr">else</span> receivedAddresses s)</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="BaseELMO-v-chk7a" style="display: none" type="checkbox"><label class="alectryon-input" for="BaseELMO-v-chk7a"><span class="nb">unfold</span> receivedAddresses; <span class="nb">cbn</span>.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>Address</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>EqDecision0</var><span class="hyp-type"><b>: </b><span>EqDecision Address</span></span></span><br><span><var>s</var><span class="hyp-type"><b>: </b><span>State</span></span></span><br><span><var>ob</var><span class="hyp-type"><b>: </b><span>Observation</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">map (<span class="kr">Œª</span> <span class="nv">m</span> : Message, adr (state m))
  (map message
     (<span class="kr">if</span> decide (isReceive ob)
      <span class="kr">then</span> ob :: filter isReceive (obs s)
      <span class="kr">else</span> filter isReceive (obs s))) =
(<span class="kr">if</span> decide (isReceive ob)
 <span class="kr">then</span>
  adr (state (message ob))
  :: map (<span class="kr">Œª</span> <span class="nv">m</span> : Message, adr (state m))
       (receivedMessages s)
 <span class="kr">else</span>
  map (<span class="kr">Œª</span> <span class="nv">m</span> : Message, adr (state m))
    (receivedMessages s))</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><span class="alectryon-input"><span class="bp">by</span> <span class="nb">destruct</span> (decide (isReceive ob)).</span><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Qed</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
</span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">End</span> <span class="nf">sec_base_ELMO</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
</span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Notation</span> <span class="s2">&quot;s &lt;+&gt; ob&quot;</span> := (addObservation ob s) (<span class="kn">left associativity</span>, <span class="kn">at level</span> <span class="mi">50</span>).</span><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Notation</span> <span class="s2">&quot;s &lt;++&gt; obs&quot;</span> := (addObservations obs s) (<span class="kn">left associativity</span>, <span class="kn">at level</span> <span class="mi">50</span>).</span><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Notation</span> <span class="s2">&quot;m &lt;*&gt; ob&quot;</span> := (addObservationToMessage ob m) (<span class="kn">left associativity</span>, <span class="kn">at level</span> <span class="mi">50</span>).</span><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Notation</span> <span class="s2">&quot;m &lt;**&gt; obs&quot;</span> := (addObservationsToMessage obs m) (<span class="kn">left associativity</span>, <span class="kn">at level</span> <span class="mi">50</span>).</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
</span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Section</span> <span class="nf">sec_BaseELMO_Observations</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
</span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Context</span>
  {<span class="nv">Address</span> : <span class="kt">Type</span>}
  `{EqDecision Address}
  (State := @State Address)
  (Observation := @Observation Address)
  (Message := @Message Address)
  .</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
</span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Definition</span> <span class="nf">ELMO_component_type</span> : VLSMType Message :=
{|
  VLSM.state := State;
  VLSM.label := Label;
|}.</span></span></pre><div class="doc">
We can extract a trace from a <span class="inlinecode"><span class="id" title="var">list</span></span> of <span class="inlinecode"><span class="id" title="var">Observation</span></span>s. 
</div><pre class="alectryon-io highlight"><!-- Generator: Alectryon --><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Fixpoint</span> <span class="nf">observations2trace</span> (<span class="nv">obs</span> : list Observation) (<span class="nv">adr</span> : Address)
  : list (transition_item ELMO_component_type) :=
  <span class="kr">match</span> obs <span class="kr">with</span>
  | [] =&gt; []
  | MkObservation Send msg <span class="kr">as</span> ob :: obs =&gt;
      <span class="kr">let</span> <span class="nv">s&#39;</span>   := MkState obs adr <span class="kr">in</span>
      <span class="kr">let</span> <span class="nv">msg&#39;</span> := MkMessage s&#39; <span class="kr">in</span>
      <span class="kr">let</span> <span class="nv">ob&#39;</span>  := MkObservation Send msg&#39; <span class="kr">in</span>
      <span class="kr">let</span> <span class="nv">obs&#39;</span> := addObservation&#39; ob&#39; obs <span class="kr">in</span>
      <span class="kr">let</span> <span class="nv">dest</span> := MkState obs&#39; adr <span class="kr">in</span>
        observations2trace obs adr ++
          [Build_transition_item ELMO_component_type Send None dest (Some msg&#39;)]
  | MkObservation Receive msg <span class="kr">as</span> ob :: obs =&gt;
      <span class="kr">let</span> <span class="nv">dest</span> := MkState (ob :: obs) adr <span class="kr">in</span>
        observations2trace obs adr ++
          [Build_transition_item ELMO_component_type Receive (Some msg) dest None]
  <span class="kr">end</span>.</span></span></pre><div class="doc">
A state contains a list of observations, so we can extract a trace from a state. 
</div><pre class="alectryon-io highlight"><!-- Generator: Alectryon --><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Definition</span> <span class="nf">state2trace</span> (<span class="nv">s</span> : State) : list transition_item :=
  observations2trace (obs s) (adr s).</span></span></pre><div class="doc">
<a id="lab5"></a><h2 class="section">Observations and message dependencies</h2>
</div><pre class="alectryon-io highlight"><!-- Generator: Alectryon --><span class="alectryon-sentence"><input class="alectryon-toggle" id="BaseELMO-v-chk7b" style="display: none" type="checkbox"><label class="alectryon-input" for="BaseELMO-v-chk7b"><span class="kn">Lemma</span> <span class="nf">obs_sizeState</span> :
  <span class="kr">forall</span> (<span class="nv">s</span> : State) (<span class="nv">ob</span> : Observation), ob ‚àà obs s -&gt;
    sizeState (state (message ob)) &lt; sizeState s.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>Address</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>EqDecision0</var><span class="hyp-type"><b>: </b><span>EqDecision Address</span></span></span><br><span><var>State</var><span><span class="hyp-body"><b>:= </b><span>BaseELMO.State</span></span><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span></span><br><span><var>Observation</var><span><span class="hyp-body"><b>:= </b><span>BaseELMO.Observation</span></span><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span></span><br><span><var>Message</var><span><span class="hyp-body"><b>:= </b><span>BaseELMO.Message</span></span><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="kr">‚àÄ</span> (<span class="nv">s</span> : State) (<span class="nv">ob</span> : Observation),
  ob ‚àà obs s
  ‚Üí sizeState (state (message ob)) &lt; sizeState s</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="BaseELMO-v-chk7c" style="display: none" type="checkbox"><label class="alectryon-input" for="BaseELMO-v-chk7c"><span class="kn">Proof</span>.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>Address</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>EqDecision0</var><span class="hyp-type"><b>: </b><span>EqDecision Address</span></span></span><br><span><var>State</var><span><span class="hyp-body"><b>:= </b><span>BaseELMO.State</span></span><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span></span><br><span><var>Observation</var><span><span class="hyp-body"><b>:= </b><span>BaseELMO.Observation</span></span><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span></span><br><span><var>Message</var><span><span class="hyp-body"><b>:= </b><span>BaseELMO.Message</span></span><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="kr">‚àÄ</span> (<span class="nv">s</span> : State) (<span class="nv">ob</span> : Observation),
  ob ‚àà obs s
  ‚Üí sizeState (state (message ob)) &lt; sizeState s</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="BaseELMO-v-chk7d" style="display: none" type="checkbox"><label class="alectryon-input" for="BaseELMO-v-chk7d"><span class="nb">induction</span> s <span class="nb">using</span> addObservation_ind; <span class="nb">inversion</span> <span class="mi">1</span>; <span class="nb">subst</span>.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>Address</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>EqDecision0</var><span class="hyp-type"><b>: </b><span>EqDecision Address</span></span></span><br><span><var>State</var><span><span class="hyp-body"><b>:= </b><span>BaseELMO.State</span></span><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span></span><br><span><var>Observation</var><span><span class="hyp-body"><b>:= </b><span>BaseELMO.Observation</span></span><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span></span><br><span><var>Message</var><span><span class="hyp-body"><b>:= </b><span>BaseELMO.Message</span></span><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span></span><br><span><var>ob</var><span class="hyp-type"><b>: </b><span>BaseELMO.Observation</span></span></span><br><span><var>s</var><span class="hyp-type"><b>: </b><span>BaseELMO.State</span></span></span><br><span><var>IHs</var><span class="hyp-type"><b>: </b><span><span class="kr">‚àÄ</span> <span class="nv">ob</span> : Observation,
  ob ‚àà obs s
  ‚Üí sizeState (state (message ob)) &lt; sizeState s</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>ob ‚àà obs (s &lt;+&gt; ob)</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">sizeState (state (message ob)) &lt; sizeState (s &lt;+&gt; ob)</div></blockquote><div class="alectryon-extra-goals"><input class="alectryon-extra-goal-toggle" id="BaseELMO-v-chk7e" style="display: none" type="checkbox"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>Address</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>EqDecision0</var><span class="hyp-type"><b>: </b><span>EqDecision Address</span></span></span><br><span><var>State</var><span><span class="hyp-body"><b>:= </b><span>BaseELMO.State</span></span><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span></span><br><span><var>Observation</var><span><span class="hyp-body"><b>:= </b><span>BaseELMO.Observation</span></span><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span></span><br><span><var>Message</var><span><span class="hyp-body"><b>:= </b><span>BaseELMO.Message</span></span><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span></span><br><span><var>ob</var><span class="hyp-type"><b>: </b><span>BaseELMO.Observation</span></span></span><br><span><var>s</var><span class="hyp-type"><b>: </b><span>BaseELMO.State</span></span></span><br><span><var>IHs</var><span class="hyp-type"><b>: </b><span><span class="kr">‚àÄ</span> <span class="nv">ob</span> : Observation,
  ob ‚àà obs s
  ‚Üí sizeState (state (message ob)) &lt; sizeState s</span></span></span><br><span><var>ob0</var><span class="hyp-type"><b>: </b><span>Observation</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>ob0 ‚àà obs (s &lt;+&gt; ob)</span></span></span><br><span><var>H2</var><span class="hyp-type"><b>: </b><span>ob0 ‚àà obs s</span></span></span><br></div><label class="goal-separator" for="BaseELMO-v-chk7e"><hr></label><div class="goal-conclusion">sizeState (state (message ob0)) &lt; sizeState (s &lt;+&gt; ob)</div></blockquote></div></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="BaseELMO-v-chk7f" style="display: none" type="checkbox"><label class="alectryon-input" for="BaseELMO-v-chk7f">-</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>Address</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>EqDecision0</var><span class="hyp-type"><b>: </b><span>EqDecision Address</span></span></span><br><span><var>State</var><span><span class="hyp-body"><b>:= </b><span>BaseELMO.State</span></span><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span></span><br><span><var>Observation</var><span><span class="hyp-body"><b>:= </b><span>BaseELMO.Observation</span></span><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span></span><br><span><var>Message</var><span><span class="hyp-body"><b>:= </b><span>BaseELMO.Message</span></span><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span></span><br><span><var>ob</var><span class="hyp-type"><b>: </b><span>BaseELMO.Observation</span></span></span><br><span><var>s</var><span class="hyp-type"><b>: </b><span>BaseELMO.State</span></span></span><br><span><var>IHs</var><span class="hyp-type"><b>: </b><span><span class="kr">‚àÄ</span> <span class="nv">ob</span> : Observation,
  ob ‚àà obs s
  ‚Üí sizeState (state (message ob)) &lt; sizeState s</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>ob ‚àà obs (s &lt;+&gt; ob)</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">sizeState (state (message ob)) &lt; sizeState (s &lt;+&gt; ob)</div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="bp">by</span> <span class="nb">destruct</span> ob <span class="kr">as</span> [? []]; <span class="nb">unfold</span> sizeState; <span class="nb">cbn</span>; <span class="bp">lia</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="BaseELMO-v-chk80" style="display: none" type="checkbox"><label class="alectryon-input" for="BaseELMO-v-chk80">-</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>Address</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>EqDecision0</var><span class="hyp-type"><b>: </b><span>EqDecision Address</span></span></span><br><span><var>State</var><span><span class="hyp-body"><b>:= </b><span>BaseELMO.State</span></span><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span></span><br><span><var>Observation</var><span><span class="hyp-body"><b>:= </b><span>BaseELMO.Observation</span></span><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span></span><br><span><var>Message</var><span><span class="hyp-body"><b>:= </b><span>BaseELMO.Message</span></span><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span></span><br><span><var>ob</var><span class="hyp-type"><b>: </b><span>BaseELMO.Observation</span></span></span><br><span><var>s</var><span class="hyp-type"><b>: </b><span>BaseELMO.State</span></span></span><br><span><var>IHs</var><span class="hyp-type"><b>: </b><span><span class="kr">‚àÄ</span> <span class="nv">ob</span> : Observation,
  ob ‚àà obs s
  ‚Üí sizeState (state (message ob)) &lt; sizeState s</span></span></span><br><span><var>ob0</var><span class="hyp-type"><b>: </b><span>Observation</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>ob0 ‚àà obs (s &lt;+&gt; ob)</span></span></span><br><span><var>H2</var><span class="hyp-type"><b>: </b><span>ob0 ‚àà obs s</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">sizeState (state (message ob0)) &lt; sizeState (s &lt;+&gt; ob)</div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="BaseELMO-v-chk81" style="display: none" type="checkbox"><label class="alectryon-input" for="BaseELMO-v-chk81"><span class="nb">etransitivity</span>; [<span class="bp">by</span> <span class="nb">apply</span> IHs |].</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>Address</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>EqDecision0</var><span class="hyp-type"><b>: </b><span>EqDecision Address</span></span></span><br><span><var>State</var><span><span class="hyp-body"><b>:= </b><span>BaseELMO.State</span></span><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span></span><br><span><var>Observation</var><span><span class="hyp-body"><b>:= </b><span>BaseELMO.Observation</span></span><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span></span><br><span><var>Message</var><span><span class="hyp-body"><b>:= </b><span>BaseELMO.Message</span></span><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span></span><br><span><var>ob</var><span class="hyp-type"><b>: </b><span>BaseELMO.Observation</span></span></span><br><span><var>s</var><span class="hyp-type"><b>: </b><span>BaseELMO.State</span></span></span><br><span><var>IHs</var><span class="hyp-type"><b>: </b><span><span class="kr">‚àÄ</span> <span class="nv">ob</span> : Observation,
  ob ‚àà obs s
  ‚Üí sizeState (state (message ob)) &lt; sizeState s</span></span></span><br><span><var>ob0</var><span class="hyp-type"><b>: </b><span>Observation</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>ob0 ‚àà obs (s &lt;+&gt; ob)</span></span></span><br><span><var>H2</var><span class="hyp-type"><b>: </b><span>ob0 ‚àà obs s</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">sizeState s &lt; sizeState (s &lt;+&gt; ob)</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><span class="alectryon-input"><span class="bp">by</span> <span class="nb">destruct</span> s, ob <span class="kr">as</span> [? []]; <span class="nb">unfold</span> sizeState; <span class="nb">cbn</span>; <span class="bp">lia</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Qed</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
</span><span class="alectryon-sentence"><input class="alectryon-toggle" id="BaseELMO-v-chk82" style="display: none" type="checkbox"><label class="alectryon-input" for="BaseELMO-v-chk82"><span class="kn">Lemma</span> <span class="nf">messages_sizeState</span> :
  <span class="kr">forall</span> (<span class="nv">s</span> : State) (<span class="nv">m</span> : Message), m ‚àà messages s -&gt;
    sizeState (state m) &lt; sizeState s.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>Address</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>EqDecision0</var><span class="hyp-type"><b>: </b><span>EqDecision Address</span></span></span><br><span><var>State</var><span><span class="hyp-body"><b>:= </b><span>BaseELMO.State</span></span><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span></span><br><span><var>Observation</var><span><span class="hyp-body"><b>:= </b><span>BaseELMO.Observation</span></span><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span></span><br><span><var>Message</var><span><span class="hyp-body"><b>:= </b><span>BaseELMO.Message</span></span><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="kr">‚àÄ</span> (<span class="nv">s</span> : State) (<span class="nv">m</span> : Message),
  m ‚àà messages s ‚Üí sizeState (state m) &lt; sizeState s</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="BaseELMO-v-chk83" style="display: none" type="checkbox"><label class="alectryon-input" for="BaseELMO-v-chk83"><span class="kn">Proof</span>.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>Address</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>EqDecision0</var><span class="hyp-type"><b>: </b><span>EqDecision Address</span></span></span><br><span><var>State</var><span><span class="hyp-body"><b>:= </b><span>BaseELMO.State</span></span><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span></span><br><span><var>Observation</var><span><span class="hyp-body"><b>:= </b><span>BaseELMO.Observation</span></span><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span></span><br><span><var>Message</var><span><span class="hyp-body"><b>:= </b><span>BaseELMO.Message</span></span><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="kr">‚àÄ</span> (<span class="nv">s</span> : State) (<span class="nv">m</span> : Message),
  m ‚àà messages s ‚Üí sizeState (state m) &lt; sizeState s</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="BaseELMO-v-chk84" style="display: none" type="checkbox"><label class="alectryon-input" for="BaseELMO-v-chk84"><span class="nb">intros</span> s m Hm.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>Address</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>EqDecision0</var><span class="hyp-type"><b>: </b><span>EqDecision Address</span></span></span><br><span><var>State</var><span><span class="hyp-body"><b>:= </b><span>BaseELMO.State</span></span><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span></span><br><span><var>Observation</var><span><span class="hyp-body"><b>:= </b><span>BaseELMO.Observation</span></span><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span></span><br><span><var>Message</var><span><span class="hyp-body"><b>:= </b><span>BaseELMO.Message</span></span><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span></span><br><span><var>s</var><span class="hyp-type"><b>: </b><span>State</span></span></span><br><span><var>m</var><span class="hyp-type"><b>: </b><span>Message</span></span></span><br><span><var>Hm</var><span class="hyp-type"><b>: </b><span>m ‚àà messages s</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">sizeState (state m) &lt; sizeState s</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="BaseELMO-v-chk85" style="display: none" type="checkbox"><label class="alectryon-input" for="BaseELMO-v-chk85"><span class="nb">apply</span> elem_of_list_fmap <span class="kr">in</span> Hm <span class="kr">as</span> (o &amp; -&gt; &amp; Hobs).</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>Address</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>EqDecision0</var><span class="hyp-type"><b>: </b><span>EqDecision Address</span></span></span><br><span><var>State</var><span><span class="hyp-body"><b>:= </b><span>BaseELMO.State</span></span><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span></span><br><span><var>Observation</var><span><span class="hyp-body"><b>:= </b><span>BaseELMO.Observation</span></span><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span></span><br><span><var>Message</var><span><span class="hyp-body"><b>:= </b><span>BaseELMO.Message</span></span><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span></span><br><span><var>s</var><span class="hyp-type"><b>: </b><span>State</span></span></span><br><span><var>o</var><span class="hyp-type"><b>: </b><span>BaseELMO.Observation</span></span></span><br><span><var>Hobs</var><span class="hyp-type"><b>: </b><span>o ‚àà obs s</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">sizeState (state (message o)) &lt; sizeState s</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><span class="alectryon-input"><span class="bp">by</span> <span class="nb">apply</span> obs_sizeState.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Qed</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
</span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Inductive</span> <span class="nf">rec_obs</span> : State -&gt; Observation -&gt; <span class="kt">Prop</span> :=
| rec_new :
    <span class="kr">forall</span> (<span class="nv">s</span> : State) (<span class="nv">ob</span> : Observation),
      rec_obs (s &lt;+&gt; ob) ob
| rec_prev :
    <span class="kr">forall</span> (<span class="nv">s</span> : State) (<span class="nv">ob&#39;</span> <span class="nv">ob</span> : Observation),
      rec_obs s ob -&gt; rec_obs (s &lt;+&gt; ob&#39;) ob
| rec_recv :
    <span class="kr">forall</span> (<span class="nv">s</span> : State) (<span class="nv">m</span> : Message) (<span class="nv">ob</span> : Observation),
      rec_obs (state m) ob -&gt; rec_obs (s &lt;+&gt; MkObservation Receive m) ob.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
</span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Equations</span> <span class="nf">rec_obs_fn</span> (<span class="nv">s</span> : State) : listset Observation <span class="bp">by</span> <span class="kn">wf</span> (sizeState s) lt :=
| {| obs := [] |} =&gt; ‚àÖ
| {| obs := o :: os; adr := a |} =&gt;
  {[ o ]} ‚à™ rec_obs_fn (state (message o)) ‚à™ rec_obs_fn {| obs := os; adr := a |}.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="BaseELMO-v-chk86" style="display: none" type="checkbox"><label class="alectryon-input" for="BaseELMO-v-chk86"><span class="kn">Next Obligation</span>.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>Address</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>EqDecision0</var><span class="hyp-type"><b>: </b><span>EqDecision Address</span></span></span><br><span><var>State</var><span><span class="hyp-body"><b>:= </b><span>BaseELMO.State</span></span><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span></span><br><span><var>Observation</var><span><span class="hyp-body"><b>:= </b><span>BaseELMO.Observation</span></span><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span></span><br><span><var>Message</var><span><span class="hyp-body"><b>:= </b><span>BaseELMO.Message</span></span><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="kr">‚àÄ</span> (<span class="nv">o</span> : BaseELMO.Observation) (<span class="nv">os</span> : list
                                     BaseELMO.Observation) 
  (<span class="nv">a</span> : Address),
  (<span class="kr">‚àÄ</span> <span class="nv">x</span> : State,
     sizeState x &lt;
     sizeState {| obs := o :: os; adr := a |}
     ‚Üí listset Observation)
  ‚Üí sizeState (state (message o)) &lt;
    sizeState {| obs := o :: os; adr := a |}</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="BaseELMO-v-chk87" style="display: none" type="checkbox"><label class="alectryon-input" for="BaseELMO-v-chk87"><span class="kn">Proof</span>.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>Address</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>EqDecision0</var><span class="hyp-type"><b>: </b><span>EqDecision Address</span></span></span><br><span><var>State</var><span><span class="hyp-body"><b>:= </b><span>BaseELMO.State</span></span><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span></span><br><span><var>Observation</var><span><span class="hyp-body"><b>:= </b><span>BaseELMO.Observation</span></span><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span></span><br><span><var>Message</var><span><span class="hyp-body"><b>:= </b><span>BaseELMO.Message</span></span><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="kr">‚àÄ</span> (<span class="nv">o</span> : BaseELMO.Observation) (<span class="nv">os</span> : list
                                     BaseELMO.Observation) 
  (<span class="nv">a</span> : Address),
  (<span class="kr">‚àÄ</span> <span class="nv">x</span> : State,
     sizeState x &lt;
     sizeState {| obs := o :: os; adr := a |}
     ‚Üí listset Observation)
  ‚Üí sizeState (state (message o)) &lt;
    sizeState {| obs := o :: os; adr := a |}</div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="bp">by</span> <span class="nb">intros</span> [? []] os a _; <span class="nb">unfold</span> sizeState; <span class="nb">cbn</span>; <span class="bp">lia</span>.</span><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Qed</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="BaseELMO-v-chk88" style="display: none" type="checkbox"><label class="alectryon-input" for="BaseELMO-v-chk88"><span class="kn">Next Obligation</span>.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>Address</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>EqDecision0</var><span class="hyp-type"><b>: </b><span>EqDecision Address</span></span></span><br><span><var>State</var><span><span class="hyp-body"><b>:= </b><span>BaseELMO.State</span></span><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span></span><br><span><var>Observation</var><span><span class="hyp-body"><b>:= </b><span>BaseELMO.Observation</span></span><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span></span><br><span><var>Message</var><span><span class="hyp-body"><b>:= </b><span>BaseELMO.Message</span></span><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="kr">‚àÄ</span> (<span class="nv">o</span> : BaseELMO.Observation) (<span class="nv">os</span> : list
                                     BaseELMO.Observation) 
  (<span class="nv">a</span> : Address),
  (<span class="kr">‚àÄ</span> <span class="nv">x</span> : State,
     sizeState x &lt;
     sizeState {| obs := o :: os; adr := a |}
     ‚Üí listset Observation)
  ‚Üí sizeState {| obs := os; adr := a |} &lt;
    sizeState {| obs := o :: os; adr := a |}</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="BaseELMO-v-chk89" style="display: none" type="checkbox"><label class="alectryon-input" for="BaseELMO-v-chk89"><span class="kn">Proof</span>.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>Address</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>EqDecision0</var><span class="hyp-type"><b>: </b><span>EqDecision Address</span></span></span><br><span><var>State</var><span><span class="hyp-body"><b>:= </b><span>BaseELMO.State</span></span><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span></span><br><span><var>Observation</var><span><span class="hyp-body"><b>:= </b><span>BaseELMO.Observation</span></span><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span></span><br><span><var>Message</var><span><span class="hyp-body"><b>:= </b><span>BaseELMO.Message</span></span><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="kr">‚àÄ</span> (<span class="nv">o</span> : BaseELMO.Observation) (<span class="nv">os</span> : list
                                     BaseELMO.Observation) 
  (<span class="nv">a</span> : Address),
  (<span class="kr">‚àÄ</span> <span class="nv">x</span> : State,
     sizeState x &lt;
     sizeState {| obs := o :: os; adr := a |}
     ‚Üí listset Observation)
  ‚Üí sizeState {| obs := os; adr := a |} &lt;
    sizeState {| obs := o :: os; adr := a |}</div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="bp">by</span> <span class="nb">intros</span> [? []] os a _; <span class="nb">unfold</span> sizeState; <span class="nb">cbn</span>; <span class="bp">lia</span>.</span><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Qed</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
</span><span class="alectryon-sentence"><input class="alectryon-toggle" id="BaseELMO-v-chk8a" style="display: none" type="checkbox"><label class="alectryon-input" for="BaseELMO-v-chk8a"><span class="kn">Lemma</span> <span class="nf">elem_of_rec_obs_fn_1</span> :
  <span class="kr">forall</span> (<span class="nv">s</span> : State) (<span class="nv">o</span> : Observation),
    rec_obs s o -&gt; o ‚àà rec_obs_fn s.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>Address</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>EqDecision0</var><span class="hyp-type"><b>: </b><span>EqDecision Address</span></span></span><br><span><var>State</var><span><span class="hyp-body"><b>:= </b><span>BaseELMO.State</span></span><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span></span><br><span><var>Observation</var><span><span class="hyp-body"><b>:= </b><span>BaseELMO.Observation</span></span><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span></span><br><span><var>Message</var><span><span class="hyp-body"><b>:= </b><span>BaseELMO.Message</span></span><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="kr">‚àÄ</span> (<span class="nv">s</span> : State) (<span class="nv">o</span> : Observation),
  rec_obs s o ‚Üí o ‚àà rec_obs_fn s</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="BaseELMO-v-chk8b" style="display: none" type="checkbox"><label class="alectryon-input" for="BaseELMO-v-chk8b"><span class="kn">Proof</span>.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>Address</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>EqDecision0</var><span class="hyp-type"><b>: </b><span>EqDecision Address</span></span></span><br><span><var>State</var><span><span class="hyp-body"><b>:= </b><span>BaseELMO.State</span></span><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span></span><br><span><var>Observation</var><span><span class="hyp-body"><b>:= </b><span>BaseELMO.Observation</span></span><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span></span><br><span><var>Message</var><span><span class="hyp-body"><b>:= </b><span>BaseELMO.Message</span></span><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="kr">‚àÄ</span> (<span class="nv">s</span> : State) (<span class="nv">o</span> : Observation),
  rec_obs s o ‚Üí o ‚àà rec_obs_fn s</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="BaseELMO-v-chk8c" style="display: none" type="checkbox"><label class="alectryon-input" for="BaseELMO-v-chk8c"><span class="nb">intro</span> s; apply_funelim (rec_obs_fn s); <span class="nb">clear</span> s; [<span class="bp">by</span> <span class="nb">inversion</span> <span class="mi">1</span> |].</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>Address</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>EqDecision0</var><span class="hyp-type"><b>: </b><span>EqDecision Address</span></span></span><br><span><var>State</var><span><span class="hyp-body"><b>:= </b><span>BaseELMO.State</span></span><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span></span><br><span><var>Observation</var><span><span class="hyp-body"><b>:= </b><span>BaseELMO.Observation</span></span><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span></span><br><span><var>Message</var><span><span class="hyp-body"><b>:= </b><span>BaseELMO.Message</span></span><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="kr">‚àÄ</span> (<span class="nv">o</span> : BaseELMO.Observation) (<span class="nv">os</span> : list
                                     BaseELMO.Observation) 
  (<span class="nv">a</span> : Address),
  (<span class="kr">‚àÄ</span> <span class="nv">o0</span> : Observation,
     rec_obs (state (message o)) o0
     ‚Üí o0 ‚àà rec_obs_fn (state (message o)))
  ‚Üí (<span class="kr">‚àÄ</span> <span class="nv">o0</span> : Observation,
       rec_obs {| obs := os; adr := a |} o0
       ‚Üí o0 ‚àà rec_obs_fn {| obs := os; adr := a |})
    ‚Üí <span class="kr">‚àÄ</span> <span class="nv">o0</span> : Observation,
        rec_obs {| obs := o :: os; adr := a |} o0
        ‚Üí o0
          ‚àà {[o]} ‚à™ rec_obs_fn (state (message o))
            ‚à™ rec_obs_fn {| obs := os; adr := a |}</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><span class="alectryon-input"><span class="bp">by</span> <span class="nb">intros</span> [] os a Hindm Hindos o; <span class="nb">inversion</span> <span class="mi">1</span> <span class="kr">as</span> [[] ? | [] ? | [] ?]; <span class="nb">subst</span>;
    <span class="nb">cbn</span> <span class="kr">in</span> *; <span class="nb">unfold</span> Observation; <span class="nb">rewrite</span> !elem_of_union, <span class="nl">?elem_of_singleton</span>; itauto.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Qed</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
</span><span class="alectryon-sentence"><input class="alectryon-toggle" id="BaseELMO-v-chk8d" style="display: none" type="checkbox"><label class="alectryon-input" for="BaseELMO-v-chk8d"><span class="kn">Lemma</span> <span class="nf">rec_obs_fn_sizeState</span> :
  <span class="kr">forall</span> (<span class="nv">s</span> : State) (<span class="nv">o</span> : Observation), o ‚àà rec_obs_fn s -&gt;
    sizeState (state (message o)) &lt; sizeState s.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>Address</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>EqDecision0</var><span class="hyp-type"><b>: </b><span>EqDecision Address</span></span></span><br><span><var>State</var><span><span class="hyp-body"><b>:= </b><span>BaseELMO.State</span></span><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span></span><br><span><var>Observation</var><span><span class="hyp-body"><b>:= </b><span>BaseELMO.Observation</span></span><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span></span><br><span><var>Message</var><span><span class="hyp-body"><b>:= </b><span>BaseELMO.Message</span></span><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="kr">‚àÄ</span> (<span class="nv">s</span> : State) (<span class="nv">o</span> : Observation),
  o ‚àà rec_obs_fn s
  ‚Üí sizeState (state (message o)) &lt; sizeState s</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="BaseELMO-v-chk8e" style="display: none" type="checkbox"><label class="alectryon-input" for="BaseELMO-v-chk8e"><span class="kn">Proof</span>.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>Address</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>EqDecision0</var><span class="hyp-type"><b>: </b><span>EqDecision Address</span></span></span><br><span><var>State</var><span><span class="hyp-body"><b>:= </b><span>BaseELMO.State</span></span><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span></span><br><span><var>Observation</var><span><span class="hyp-body"><b>:= </b><span>BaseELMO.Observation</span></span><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span></span><br><span><var>Message</var><span><span class="hyp-body"><b>:= </b><span>BaseELMO.Message</span></span><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="kr">‚àÄ</span> (<span class="nv">s</span> : State) (<span class="nv">o</span> : Observation),
  o ‚àà rec_obs_fn s
  ‚Üí sizeState (state (message o)) &lt; sizeState s</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="BaseELMO-v-chk8f" style="display: none" type="checkbox"><label class="alectryon-input" for="BaseELMO-v-chk8f"><span class="nb">intro</span> s; apply_funelim (rec_obs_fn s); <span class="nb">clear</span> s;
    [<span class="nb">intros</span> * Ho; <span class="bp">contradict</span> Ho; <span class="nb">apply</span> not_elem_of_empty |].</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>Address</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>EqDecision0</var><span class="hyp-type"><b>: </b><span>EqDecision Address</span></span></span><br><span><var>State</var><span><span class="hyp-body"><b>:= </b><span>BaseELMO.State</span></span><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span></span><br><span><var>Observation</var><span><span class="hyp-body"><b>:= </b><span>BaseELMO.Observation</span></span><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span></span><br><span><var>Message</var><span><span class="hyp-body"><b>:= </b><span>BaseELMO.Message</span></span><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="kr">‚àÄ</span> (<span class="nv">o</span> : BaseELMO.Observation) (<span class="nv">os</span> : list
                                     BaseELMO.Observation) 
  (<span class="nv">a</span> : Address),
  (<span class="kr">‚àÄ</span> <span class="nv">o0</span> : Observation,
     o0 ‚àà rec_obs_fn (state (message o))
     ‚Üí sizeState (state (message o0)) &lt;
       sizeState (state (message o)))
  ‚Üí (<span class="kr">‚àÄ</span> <span class="nv">o0</span> : Observation,
       o0 ‚àà rec_obs_fn {| obs := os; adr := a |}
       ‚Üí sizeState (state (message o0)) &lt;
         sizeState {| obs := os; adr := a |})
    ‚Üí <span class="kr">‚àÄ</span> <span class="nv">o0</span> : Observation,
        o0
        ‚àà {[o]} ‚à™ rec_obs_fn (state (message o))
          ‚à™ rec_obs_fn {| obs := os; adr := a |}
        ‚Üí sizeState (state (message o0)) &lt;
          sizeState {| obs := o :: os; adr := a |}</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="BaseELMO-v-chk90" style="display: none" type="checkbox"><label class="alectryon-input" for="BaseELMO-v-chk90"><span class="nb">intros</span> o os a Hindo Hindos o0; <span class="nb">rewrite</span> !elem_of_union; <span class="nb">intros</span> [[Heq | Ho] | Hos].</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>Address</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>EqDecision0</var><span class="hyp-type"><b>: </b><span>EqDecision Address</span></span></span><br><span><var>State</var><span><span class="hyp-body"><b>:= </b><span>BaseELMO.State</span></span><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span></span><br><span><var>Observation</var><span><span class="hyp-body"><b>:= </b><span>BaseELMO.Observation</span></span><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span></span><br><span><var>Message</var><span><span class="hyp-body"><b>:= </b><span>BaseELMO.Message</span></span><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span></span><br><span><var>o</var><span class="hyp-type"><b>: </b><span>BaseELMO.Observation</span></span></span><br><span><var>os</var><span class="hyp-type"><b>: </b><span>list BaseELMO.Observation</span></span></span><br><span><var>a</var><span class="hyp-type"><b>: </b><span>Address</span></span></span><br><span><var>Hindo</var><span class="hyp-type"><b>: </b><span><span class="kr">‚àÄ</span> <span class="nv">o0</span> : Observation,
  o0 ‚àà rec_obs_fn (state (message o))
  ‚Üí sizeState (state (message o0)) &lt;
    sizeState (state (message o))</span></span></span><br><span><var>Hindos</var><span class="hyp-type"><b>: </b><span><span class="kr">‚àÄ</span> <span class="nv">o</span> : Observation,
  o ‚àà rec_obs_fn {| obs := os; adr := a |}
  ‚Üí sizeState (state (message o)) &lt;
    sizeState {| obs := os; adr := a |}</span></span></span><br><span><var>o0</var><span class="hyp-type"><b>: </b><span>Observation</span></span></span><br><span><var>Heq</var><span class="hyp-type"><b>: </b><span>o0 ‚àà {[o]}</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">sizeState (state (message o0)) &lt;
sizeState {| obs := o :: os; adr := a |}</div></blockquote><div class="alectryon-extra-goals"><input class="alectryon-extra-goal-toggle" id="BaseELMO-v-chk91" style="display: none" type="checkbox"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>Address</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>EqDecision0</var><span class="hyp-type"><b>: </b><span>EqDecision Address</span></span></span><br><span><var>State</var><span><span class="hyp-body"><b>:= </b><span>BaseELMO.State</span></span><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span></span><br><span><var>Observation</var><span><span class="hyp-body"><b>:= </b><span>BaseELMO.Observation</span></span><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span></span><br><span><var>Message</var><span><span class="hyp-body"><b>:= </b><span>BaseELMO.Message</span></span><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span></span><br><span><var>o</var><span class="hyp-type"><b>: </b><span>BaseELMO.Observation</span></span></span><br><span><var>os</var><span class="hyp-type"><b>: </b><span>list BaseELMO.Observation</span></span></span><br><span><var>a</var><span class="hyp-type"><b>: </b><span>Address</span></span></span><br><span><var>Hindo</var><span class="hyp-type"><b>: </b><span><span class="kr">‚àÄ</span> <span class="nv">o0</span> : Observation,
  o0 ‚àà rec_obs_fn (state (message o))
  ‚Üí sizeState (state (message o0)) &lt;
    sizeState (state (message o))</span></span></span><br><span><var>Hindos</var><span class="hyp-type"><b>: </b><span><span class="kr">‚àÄ</span> <span class="nv">o</span> : Observation,
  o ‚àà rec_obs_fn {| obs := os; adr := a |}
  ‚Üí sizeState (state (message o)) &lt;
    sizeState {| obs := os; adr := a |}</span></span></span><br><span><var>o0</var><span class="hyp-type"><b>: </b><span>Observation</span></span></span><br><span><var>Ho</var><span class="hyp-type"><b>: </b><span>o0 ‚àà rec_obs_fn (state (message o))</span></span></span><br></div><label class="goal-separator" for="BaseELMO-v-chk91"><hr></label><div class="goal-conclusion">sizeState (state (message o0)) &lt;
sizeState {| obs := o :: os; adr := a |}</div></blockquote><input class="alectryon-extra-goal-toggle" id="BaseELMO-v-chk92" style="display: none" type="checkbox"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>Address</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>EqDecision0</var><span class="hyp-type"><b>: </b><span>EqDecision Address</span></span></span><br><span><var>State</var><span><span class="hyp-body"><b>:= </b><span>BaseELMO.State</span></span><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span></span><br><span><var>Observation</var><span><span class="hyp-body"><b>:= </b><span>BaseELMO.Observation</span></span><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span></span><br><span><var>Message</var><span><span class="hyp-body"><b>:= </b><span>BaseELMO.Message</span></span><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span></span><br><span><var>o</var><span class="hyp-type"><b>: </b><span>BaseELMO.Observation</span></span></span><br><span><var>os</var><span class="hyp-type"><b>: </b><span>list BaseELMO.Observation</span></span></span><br><span><var>a</var><span class="hyp-type"><b>: </b><span>Address</span></span></span><br><span><var>Hindo</var><span class="hyp-type"><b>: </b><span><span class="kr">‚àÄ</span> <span class="nv">o0</span> : Observation,
  o0 ‚àà rec_obs_fn (state (message o))
  ‚Üí sizeState (state (message o0)) &lt;
    sizeState (state (message o))</span></span></span><br><span><var>Hindos</var><span class="hyp-type"><b>: </b><span><span class="kr">‚àÄ</span> <span class="nv">o</span> : Observation,
  o ‚àà rec_obs_fn {| obs := os; adr := a |}
  ‚Üí sizeState (state (message o)) &lt;
    sizeState {| obs := os; adr := a |}</span></span></span><br><span><var>o0</var><span class="hyp-type"><b>: </b><span>Observation</span></span></span><br><span><var>Hos</var><span class="hyp-type"><b>: </b><span>o0 ‚àà rec_obs_fn {| obs := os; adr := a |}</span></span></span><br></div><label class="goal-separator" for="BaseELMO-v-chk92"><hr></label><div class="goal-conclusion">sizeState (state (message o0)) &lt;
sizeState {| obs := o :: os; adr := a |}</div></blockquote></div></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="BaseELMO-v-chk93" style="display: none" type="checkbox"><label class="alectryon-input" for="BaseELMO-v-chk93">-</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>Address</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>EqDecision0</var><span class="hyp-type"><b>: </b><span>EqDecision Address</span></span></span><br><span><var>State</var><span><span class="hyp-body"><b>:= </b><span>BaseELMO.State</span></span><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span></span><br><span><var>Observation</var><span><span class="hyp-body"><b>:= </b><span>BaseELMO.Observation</span></span><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span></span><br><span><var>Message</var><span><span class="hyp-body"><b>:= </b><span>BaseELMO.Message</span></span><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span></span><br><span><var>o</var><span class="hyp-type"><b>: </b><span>BaseELMO.Observation</span></span></span><br><span><var>os</var><span class="hyp-type"><b>: </b><span>list BaseELMO.Observation</span></span></span><br><span><var>a</var><span class="hyp-type"><b>: </b><span>Address</span></span></span><br><span><var>Hindo</var><span class="hyp-type"><b>: </b><span><span class="kr">‚àÄ</span> <span class="nv">o0</span> : Observation,
  o0 ‚àà rec_obs_fn (state (message o))
  ‚Üí sizeState (state (message o0)) &lt;
    sizeState (state (message o))</span></span></span><br><span><var>Hindos</var><span class="hyp-type"><b>: </b><span><span class="kr">‚àÄ</span> <span class="nv">o</span> : Observation,
  o ‚àà rec_obs_fn {| obs := os; adr := a |}
  ‚Üí sizeState (state (message o)) &lt;
    sizeState {| obs := os; adr := a |}</span></span></span><br><span><var>o0</var><span class="hyp-type"><b>: </b><span>Observation</span></span></span><br><span><var>Heq</var><span class="hyp-type"><b>: </b><span>o0 ‚àà {[o]}</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">sizeState (state (message o0)) &lt;
sizeState {| obs := o :: os; adr := a |}</div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="BaseELMO-v-chk94" style="display: none" type="checkbox"><label class="alectryon-input" for="BaseELMO-v-chk94"><span class="nb">apply</span> elem_of_singleton <span class="kr">in</span> Heq <span class="kr">as</span> -&gt;.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>Address</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>EqDecision0</var><span class="hyp-type"><b>: </b><span>EqDecision Address</span></span></span><br><span><var>State</var><span><span class="hyp-body"><b>:= </b><span>BaseELMO.State</span></span><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span></span><br><span><var>Observation</var><span><span class="hyp-body"><b>:= </b><span>BaseELMO.Observation</span></span><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span></span><br><span><var>Message</var><span><span class="hyp-body"><b>:= </b><span>BaseELMO.Message</span></span><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span></span><br><span><var>o</var><span class="hyp-type"><b>: </b><span>BaseELMO.Observation</span></span></span><br><span><var>os</var><span class="hyp-type"><b>: </b><span>list BaseELMO.Observation</span></span></span><br><span><var>a</var><span class="hyp-type"><b>: </b><span>Address</span></span></span><br><span><var>Hindo</var><span class="hyp-type"><b>: </b><span><span class="kr">‚àÄ</span> <span class="nv">o0</span> : Observation,
  o0 ‚àà rec_obs_fn (state (message o))
  ‚Üí sizeState (state (message o0)) &lt;
    sizeState (state (message o))</span></span></span><br><span><var>Hindos</var><span class="hyp-type"><b>: </b><span><span class="kr">‚àÄ</span> <span class="nv">o</span> : Observation,
  o ‚àà rec_obs_fn {| obs := os; adr := a |}
  ‚Üí sizeState (state (message o)) &lt;
    sizeState {| obs := os; adr := a |}</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">sizeState (state (message o)) &lt;
sizeState {| obs := o :: os; adr := a |}</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><span class="alectryon-input"><span class="bp">by</span> <span class="nb">unfold</span> sizeState; <span class="nb">destruct</span> o <span class="kr">as</span> [? []]; <span class="nb">cbn</span>; <span class="bp">lia</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="BaseELMO-v-chk95" style="display: none" type="checkbox"><label class="alectryon-input" for="BaseELMO-v-chk95">-</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>Address</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>EqDecision0</var><span class="hyp-type"><b>: </b><span>EqDecision Address</span></span></span><br><span><var>State</var><span><span class="hyp-body"><b>:= </b><span>BaseELMO.State</span></span><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span></span><br><span><var>Observation</var><span><span class="hyp-body"><b>:= </b><span>BaseELMO.Observation</span></span><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span></span><br><span><var>Message</var><span><span class="hyp-body"><b>:= </b><span>BaseELMO.Message</span></span><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span></span><br><span><var>o</var><span class="hyp-type"><b>: </b><span>BaseELMO.Observation</span></span></span><br><span><var>os</var><span class="hyp-type"><b>: </b><span>list BaseELMO.Observation</span></span></span><br><span><var>a</var><span class="hyp-type"><b>: </b><span>Address</span></span></span><br><span><var>Hindo</var><span class="hyp-type"><b>: </b><span><span class="kr">‚àÄ</span> <span class="nv">o0</span> : Observation,
  o0 ‚àà rec_obs_fn (state (message o))
  ‚Üí sizeState (state (message o0)) &lt;
    sizeState (state (message o))</span></span></span><br><span><var>Hindos</var><span class="hyp-type"><b>: </b><span><span class="kr">‚àÄ</span> <span class="nv">o</span> : Observation,
  o ‚àà rec_obs_fn {| obs := os; adr := a |}
  ‚Üí sizeState (state (message o)) &lt;
    sizeState {| obs := os; adr := a |}</span></span></span><br><span><var>o0</var><span class="hyp-type"><b>: </b><span>Observation</span></span></span><br><span><var>Ho</var><span class="hyp-type"><b>: </b><span>o0 ‚àà rec_obs_fn (state (message o))</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">sizeState (state (message o0)) &lt;
sizeState {| obs := o :: os; adr := a |}</div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="BaseELMO-v-chk96" style="display: none" type="checkbox"><label class="alectryon-input" for="BaseELMO-v-chk96"><span class="nb">transitivity</span> (sizeState (state (message o))); [<span class="bp">by</span> <span class="nb">apply</span> Hindo |].</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>Address</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>EqDecision0</var><span class="hyp-type"><b>: </b><span>EqDecision Address</span></span></span><br><span><var>State</var><span><span class="hyp-body"><b>:= </b><span>BaseELMO.State</span></span><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span></span><br><span><var>Observation</var><span><span class="hyp-body"><b>:= </b><span>BaseELMO.Observation</span></span><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span></span><br><span><var>Message</var><span><span class="hyp-body"><b>:= </b><span>BaseELMO.Message</span></span><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span></span><br><span><var>o</var><span class="hyp-type"><b>: </b><span>BaseELMO.Observation</span></span></span><br><span><var>os</var><span class="hyp-type"><b>: </b><span>list BaseELMO.Observation</span></span></span><br><span><var>a</var><span class="hyp-type"><b>: </b><span>Address</span></span></span><br><span><var>Hindo</var><span class="hyp-type"><b>: </b><span><span class="kr">‚àÄ</span> <span class="nv">o0</span> : Observation,
  o0 ‚àà rec_obs_fn (state (message o))
  ‚Üí sizeState (state (message o0)) &lt;
    sizeState (state (message o))</span></span></span><br><span><var>Hindos</var><span class="hyp-type"><b>: </b><span><span class="kr">‚àÄ</span> <span class="nv">o</span> : Observation,
  o ‚àà rec_obs_fn {| obs := os; adr := a |}
  ‚Üí sizeState (state (message o)) &lt;
    sizeState {| obs := os; adr := a |}</span></span></span><br><span><var>o0</var><span class="hyp-type"><b>: </b><span>Observation</span></span></span><br><span><var>Ho</var><span class="hyp-type"><b>: </b><span>o0 ‚àà rec_obs_fn (state (message o))</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">sizeState (state (message o)) &lt;
sizeState {| obs := o :: os; adr := a |}</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><span class="alectryon-input"><span class="bp">by</span> <span class="nb">unfold</span> sizeState; <span class="nb">destruct</span> o <span class="kr">as</span> [? []]; <span class="nb">cbn</span>; <span class="bp">lia</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="BaseELMO-v-chk97" style="display: none" type="checkbox"><label class="alectryon-input" for="BaseELMO-v-chk97">-</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>Address</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>EqDecision0</var><span class="hyp-type"><b>: </b><span>EqDecision Address</span></span></span><br><span><var>State</var><span><span class="hyp-body"><b>:= </b><span>BaseELMO.State</span></span><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span></span><br><span><var>Observation</var><span><span class="hyp-body"><b>:= </b><span>BaseELMO.Observation</span></span><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span></span><br><span><var>Message</var><span><span class="hyp-body"><b>:= </b><span>BaseELMO.Message</span></span><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span></span><br><span><var>o</var><span class="hyp-type"><b>: </b><span>BaseELMO.Observation</span></span></span><br><span><var>os</var><span class="hyp-type"><b>: </b><span>list BaseELMO.Observation</span></span></span><br><span><var>a</var><span class="hyp-type"><b>: </b><span>Address</span></span></span><br><span><var>Hindo</var><span class="hyp-type"><b>: </b><span><span class="kr">‚àÄ</span> <span class="nv">o0</span> : Observation,
  o0 ‚àà rec_obs_fn (state (message o))
  ‚Üí sizeState (state (message o0)) &lt;
    sizeState (state (message o))</span></span></span><br><span><var>Hindos</var><span class="hyp-type"><b>: </b><span><span class="kr">‚àÄ</span> <span class="nv">o</span> : Observation,
  o ‚àà rec_obs_fn {| obs := os; adr := a |}
  ‚Üí sizeState (state (message o)) &lt;
    sizeState {| obs := os; adr := a |}</span></span></span><br><span><var>o0</var><span class="hyp-type"><b>: </b><span>Observation</span></span></span><br><span><var>Hos</var><span class="hyp-type"><b>: </b><span>o0 ‚àà rec_obs_fn {| obs := os; adr := a |}</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">sizeState (state (message o0)) &lt;
sizeState {| obs := o :: os; adr := a |}</div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="BaseELMO-v-chk98" style="display: none" type="checkbox"><label class="alectryon-input" for="BaseELMO-v-chk98"><span class="nb">transitivity</span> (sizeState (MkState os a)); [<span class="bp">by</span> <span class="nb">apply</span> Hindos |].</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>Address</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>EqDecision0</var><span class="hyp-type"><b>: </b><span>EqDecision Address</span></span></span><br><span><var>State</var><span><span class="hyp-body"><b>:= </b><span>BaseELMO.State</span></span><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span></span><br><span><var>Observation</var><span><span class="hyp-body"><b>:= </b><span>BaseELMO.Observation</span></span><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span></span><br><span><var>Message</var><span><span class="hyp-body"><b>:= </b><span>BaseELMO.Message</span></span><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span></span><br><span><var>o</var><span class="hyp-type"><b>: </b><span>BaseELMO.Observation</span></span></span><br><span><var>os</var><span class="hyp-type"><b>: </b><span>list BaseELMO.Observation</span></span></span><br><span><var>a</var><span class="hyp-type"><b>: </b><span>Address</span></span></span><br><span><var>Hindo</var><span class="hyp-type"><b>: </b><span><span class="kr">‚àÄ</span> <span class="nv">o0</span> : Observation,
  o0 ‚àà rec_obs_fn (state (message o))
  ‚Üí sizeState (state (message o0)) &lt;
    sizeState (state (message o))</span></span></span><br><span><var>Hindos</var><span class="hyp-type"><b>: </b><span><span class="kr">‚àÄ</span> <span class="nv">o</span> : Observation,
  o ‚àà rec_obs_fn {| obs := os; adr := a |}
  ‚Üí sizeState (state (message o)) &lt;
    sizeState {| obs := os; adr := a |}</span></span></span><br><span><var>o0</var><span class="hyp-type"><b>: </b><span>Observation</span></span></span><br><span><var>Hos</var><span class="hyp-type"><b>: </b><span>o0 ‚àà rec_obs_fn {| obs := os; adr := a |}</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">sizeState {| obs := os; adr := a |} &lt;
sizeState {| obs := o :: os; adr := a |}</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><span class="alectryon-input"><span class="bp">by</span> <span class="nb">unfold</span> sizeState; <span class="nb">destruct</span> o <span class="kr">as</span> [? []]; <span class="nb">cbn</span>; <span class="bp">lia</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Qed</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
</span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Definition</span> <span class="nf">Message_dependencies</span> (<span class="nv">m</span> : Message) : listset Message :=
  list_to_set (map message (obs (state m))).</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
</span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Definition</span> <span class="nf">Message_full_dependencies</span> (<span class="nv">m</span> : Message) : listset Message :=
  fin_sets.set_map message (rec_obs_fn (state m)).</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
</span><span class="alectryon-sentence"><input class="alectryon-toggle" id="BaseELMO-v-chk99" style="display: none" type="checkbox"><label class="alectryon-input" for="BaseELMO-v-chk99"><span class="kn">Lemma</span> <span class="nf">Message_full_dependencies_sizeState</span> (<span class="nv">dm</span> <span class="nv">m</span> : Message) :
  dm ‚àà Message_full_dependencies m -&gt; sizeState (state dm) &lt; sizeState (state m).</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>Address</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>EqDecision0</var><span class="hyp-type"><b>: </b><span>EqDecision Address</span></span></span><br><span><var>State</var><span><span class="hyp-body"><b>:= </b><span>BaseELMO.State</span></span><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span></span><br><span><var>Observation</var><span><span class="hyp-body"><b>:= </b><span>BaseELMO.Observation</span></span><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span></span><br><span><var>Message</var><span><span class="hyp-body"><b>:= </b><span>BaseELMO.Message</span></span><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span></span><br><span><var>dm, m</var><span class="hyp-type"><b>: </b><span>Message</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">dm ‚àà Message_full_dependencies m
‚Üí sizeState (state dm) &lt; sizeState (state m)</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="BaseELMO-v-chk9a" style="display: none" type="checkbox"><label class="alectryon-input" for="BaseELMO-v-chk9a"><span class="kn">Proof</span>.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>Address</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>EqDecision0</var><span class="hyp-type"><b>: </b><span>EqDecision Address</span></span></span><br><span><var>State</var><span><span class="hyp-body"><b>:= </b><span>BaseELMO.State</span></span><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span></span><br><span><var>Observation</var><span><span class="hyp-body"><b>:= </b><span>BaseELMO.Observation</span></span><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span></span><br><span><var>Message</var><span><span class="hyp-body"><b>:= </b><span>BaseELMO.Message</span></span><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span></span><br><span><var>dm, m</var><span class="hyp-type"><b>: </b><span>Message</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">dm ‚àà Message_full_dependencies m
‚Üí sizeState (state dm) &lt; sizeState (state m)</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="BaseELMO-v-chk9b" style="display: none" type="checkbox"><label class="alectryon-input" for="BaseELMO-v-chk9b"><span class="nb">unfold</span> Message_full_dependencies; <span class="nb">intro</span> Hdm.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>Address</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>EqDecision0</var><span class="hyp-type"><b>: </b><span>EqDecision Address</span></span></span><br><span><var>State</var><span><span class="hyp-body"><b>:= </b><span>BaseELMO.State</span></span><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span></span><br><span><var>Observation</var><span><span class="hyp-body"><b>:= </b><span>BaseELMO.Observation</span></span><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span></span><br><span><var>Message</var><span><span class="hyp-body"><b>:= </b><span>BaseELMO.Message</span></span><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span></span><br><span><var>dm, m</var><span class="hyp-type"><b>: </b><span>Message</span></span></span><br><span><var>Hdm</var><span class="hyp-type"><b>: </b><span>dm ‚àà set_map message (rec_obs_fn (state m))</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">sizeState (state dm) &lt; sizeState (state m)</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="BaseELMO-v-chk9c" style="display: none" type="checkbox"><label class="alectryon-input" for="BaseELMO-v-chk9c"><span class="nb">apply</span> elem_of_map <span class="kr">in</span> Hdm <span class="kr">as</span> (o &amp; -&gt; &amp; Ho).</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>Address</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>EqDecision0</var><span class="hyp-type"><b>: </b><span>EqDecision Address</span></span></span><br><span><var>State</var><span><span class="hyp-body"><b>:= </b><span>BaseELMO.State</span></span><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span></span><br><span><var>Observation</var><span><span class="hyp-body"><b>:= </b><span>BaseELMO.Observation</span></span><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span></span><br><span><var>Message</var><span><span class="hyp-body"><b>:= </b><span>BaseELMO.Message</span></span><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span></span><br><span><var>m</var><span class="hyp-type"><b>: </b><span>Message</span></span></span><br><span><var>o</var><span class="hyp-type"><b>: </b><span>BaseELMO.Observation</span></span></span><br><span><var>Ho</var><span class="hyp-type"><b>: </b><span>o ‚àà rec_obs_fn (state m)</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">sizeState (state (message o)) &lt; sizeState (state m)</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><span class="alectryon-input"><span class="bp">by</span> <span class="nb">apply</span> rec_obs_fn_sizeState.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Qed</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
</span><span class="alectryon-sentence"><input class="alectryon-toggle" id="BaseELMO-v-chk9d" style="display: none" type="checkbox"><label class="alectryon-input" for="BaseELMO-v-chk9d">#[export] <span class="kn">Instance</span> <span class="nf">Message_FullMessageDependencies</span> :
  FullMessageDependencies Message_dependencies Message_full_dependencies.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>Address</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>EqDecision0</var><span class="hyp-type"><b>: </b><span>EqDecision Address</span></span></span><br><span><var>State</var><span><span class="hyp-body"><b>:= </b><span>BaseELMO.State</span></span><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span></span><br><span><var>Observation</var><span><span class="hyp-body"><b>:= </b><span>BaseELMO.Observation</span></span><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span></span><br><span><var>Message</var><span><span class="hyp-body"><b>:= </b><span>BaseELMO.Message</span></span><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">FullMessageDependencies Message_dependencies
  Message_full_dependencies</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="BaseELMO-v-chk9e" style="display: none" type="checkbox"><label class="alectryon-input" for="BaseELMO-v-chk9e"><span class="kn">Proof</span>.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>Address</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>EqDecision0</var><span class="hyp-type"><b>: </b><span>EqDecision Address</span></span></span><br><span><var>State</var><span><span class="hyp-body"><b>:= </b><span>BaseELMO.State</span></span><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span></span><br><span><var>Observation</var><span><span class="hyp-body"><b>:= </b><span>BaseELMO.Observation</span></span><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span></span><br><span><var>Message</var><span><span class="hyp-body"><b>:= </b><span>BaseELMO.Message</span></span><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">FullMessageDependencies Message_dependencies
  Message_full_dependencies</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="BaseELMO-v-chk9f" style="display: none" type="checkbox"><label class="alectryon-input" for="BaseELMO-v-chk9f"><span class="nb">constructor</span>; [| <span class="bp">by</span> <span class="nb">intros</span> m Hm; <span class="nb">apply</span> Message_full_dependencies_sizeState <span class="kr">in</span> Hm; <span class="bp">lia</span>].</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>Address</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>EqDecision0</var><span class="hyp-type"><b>: </b><span>EqDecision Address</span></span></span><br><span><var>State</var><span><span class="hyp-body"><b>:= </b><span>BaseELMO.State</span></span><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span></span><br><span><var>Observation</var><span><span class="hyp-body"><b>:= </b><span>BaseELMO.Observation</span></span><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span></span><br><span><var>Message</var><span><span class="hyp-body"><b>:= </b><span>BaseELMO.Message</span></span><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="kr">‚àÄ</span> <span class="nv">dm</span> <span class="nv">m</span> : Message,
  dm ‚àà Message_full_dependencies m
  ‚Üî msg_dep_happens_before Message_dependencies dm m</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="BaseELMO-v-chka0" style="display: none" type="checkbox"><label class="alectryon-input" for="BaseELMO-v-chka0"><span class="nb">intros</span> dm [s]; <span class="nb">revert</span> dm; <span class="nb">unfold</span> Message_full_dependencies; <span class="nb">cbn</span>.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>Address</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>EqDecision0</var><span class="hyp-type"><b>: </b><span>EqDecision Address</span></span></span><br><span><var>State</var><span><span class="hyp-body"><b>:= </b><span>BaseELMO.State</span></span><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span></span><br><span><var>Observation</var><span><span class="hyp-body"><b>:= </b><span>BaseELMO.Observation</span></span><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span></span><br><span><var>Message</var><span><span class="hyp-body"><b>:= </b><span>BaseELMO.Message</span></span><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span></span><br><span><var>s</var><span class="hyp-type"><b>: </b><span>BaseELMO.State</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="kr">‚àÄ</span> <span class="nv">dm</span> : Message,
  dm ‚àà set_map message (rec_obs_fn s)
  ‚Üî msg_dep_happens_before Message_dependencies dm
      {| state := s |}</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="BaseELMO-v-chka1" style="display: none" type="checkbox"><label class="alectryon-input" for="BaseELMO-v-chka1">apply_funelim (rec_obs_fn s);
    [<span class="nb">intros</span> adr dm; <span class="nb">split</span> | <span class="nb">intros</span> [l m] os a Hindm Hindos dm; <span class="nb">split</span>].</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>Address</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>EqDecision0</var><span class="hyp-type"><b>: </b><span>EqDecision Address</span></span></span><br><span><var>State</var><span><span class="hyp-body"><b>:= </b><span>BaseELMO.State</span></span><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span></span><br><span><var>Observation</var><span><span class="hyp-body"><b>:= </b><span>BaseELMO.Observation</span></span><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span></span><br><span><var>Message</var><span><span class="hyp-body"><b>:= </b><span>BaseELMO.Message</span></span><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span></span><br><span><var>s</var><span class="hyp-type"><b>: </b><span>BaseELMO.State</span></span></span><br><span><var>adr</var><span class="hyp-type"><b>: </b><span>Address</span></span></span><br><span><var>dm</var><span class="hyp-type"><b>: </b><span>Message</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">dm ‚àà set_map message ‚àÖ
‚Üí msg_dep_happens_before Message_dependencies dm
    {| state := {| obs := []; adr := adr |} |}</div></blockquote><div class="alectryon-extra-goals"><input class="alectryon-extra-goal-toggle" id="BaseELMO-v-chka2" style="display: none" type="checkbox"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>Address</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>EqDecision0</var><span class="hyp-type"><b>: </b><span>EqDecision Address</span></span></span><br><span><var>State</var><span><span class="hyp-body"><b>:= </b><span>BaseELMO.State</span></span><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span></span><br><span><var>Observation</var><span><span class="hyp-body"><b>:= </b><span>BaseELMO.Observation</span></span><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span></span><br><span><var>Message</var><span><span class="hyp-body"><b>:= </b><span>BaseELMO.Message</span></span><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span></span><br><span><var>s</var><span class="hyp-type"><b>: </b><span>BaseELMO.State</span></span></span><br><span><var>adr</var><span class="hyp-type"><b>: </b><span>Address</span></span></span><br><span><var>dm</var><span class="hyp-type"><b>: </b><span>Message</span></span></span><br></div><label class="goal-separator" for="BaseELMO-v-chka2"><hr></label><div class="goal-conclusion">msg_dep_happens_before Message_dependencies dm
  {| state := {| obs := []; adr := adr |} |}
‚Üí dm ‚àà set_map message ‚àÖ</div></blockquote><input class="alectryon-extra-goal-toggle" id="BaseELMO-v-chka3" style="display: none" type="checkbox"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>Address</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>EqDecision0</var><span class="hyp-type"><b>: </b><span>EqDecision Address</span></span></span><br><span><var>State</var><span><span class="hyp-body"><b>:= </b><span>BaseELMO.State</span></span><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span></span><br><span><var>Observation</var><span><span class="hyp-body"><b>:= </b><span>BaseELMO.Observation</span></span><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span></span><br><span><var>Message</var><span><span class="hyp-body"><b>:= </b><span>BaseELMO.Message</span></span><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span></span><br><span><var>s</var><span class="hyp-type"><b>: </b><span>BaseELMO.State</span></span></span><br><span><var>l</var><span class="hyp-type"><b>: </b><span>Label</span></span></span><br><span><var>m</var><span class="hyp-type"><b>: </b><span>BaseELMO.Message</span></span></span><br><span><var>os</var><span class="hyp-type"><b>: </b><span>list BaseELMO.Observation</span></span></span><br><span><var>a</var><span class="hyp-type"><b>: </b><span>Address</span></span></span><br><span><var>Hindm</var><span class="hyp-type"><b>: </b><span><span class="kr">‚àÄ</span> <span class="nv">dm</span> : Message,
  dm
  ‚àà set_map message
      (rec_obs_fn
         (state
            (message
               {| label := l; message := m |})))
  ‚Üî msg_dep_happens_before
      Message_dependencies dm
      {|
        state :=
          state
            (message
               {| label := l; message := m |})
      |}</span></span></span><br><span><var>Hindos</var><span class="hyp-type"><b>: </b><span><span class="kr">‚àÄ</span> <span class="nv">dm</span> : Message,
  dm
  ‚àà set_map message
      (rec_obs_fn {| obs := os; adr := a |})
  ‚Üî msg_dep_happens_before
      Message_dependencies dm
      {|
        state := {| obs := os; adr := a |}
      |}</span></span></span><br><span><var>dm</var><span class="hyp-type"><b>: </b><span>Message</span></span></span><br></div><label class="goal-separator" for="BaseELMO-v-chka3"><hr></label><div class="goal-conclusion">dm
‚àà set_map message
    ({[{| label := l; message := m |}]}
     ‚à™ rec_obs_fn
         (state
            (message {| label := l; message := m |}))
     ‚à™ rec_obs_fn {| obs := os; adr := a |})
‚Üí msg_dep_happens_before Message_dependencies dm
    {|
      state :=
        {|
          obs := {| label := l; message := m |} :: os;
          adr := a
        |}
    |}</div></blockquote><input class="alectryon-extra-goal-toggle" id="BaseELMO-v-chka4" style="display: none" type="checkbox"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>Address</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>EqDecision0</var><span class="hyp-type"><b>: </b><span>EqDecision Address</span></span></span><br><span><var>State</var><span><span class="hyp-body"><b>:= </b><span>BaseELMO.State</span></span><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span></span><br><span><var>Observation</var><span><span class="hyp-body"><b>:= </b><span>BaseELMO.Observation</span></span><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span></span><br><span><var>Message</var><span><span class="hyp-body"><b>:= </b><span>BaseELMO.Message</span></span><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span></span><br><span><var>s</var><span class="hyp-type"><b>: </b><span>BaseELMO.State</span></span></span><br><span><var>l</var><span class="hyp-type"><b>: </b><span>Label</span></span></span><br><span><var>m</var><span class="hyp-type"><b>: </b><span>BaseELMO.Message</span></span></span><br><span><var>os</var><span class="hyp-type"><b>: </b><span>list BaseELMO.Observation</span></span></span><br><span><var>a</var><span class="hyp-type"><b>: </b><span>Address</span></span></span><br><span><var>Hindm</var><span class="hyp-type"><b>: </b><span><span class="kr">‚àÄ</span> <span class="nv">dm</span> : Message,
  dm
  ‚àà set_map message
      (rec_obs_fn
         (state
            (message
               {| label := l; message := m |})))
  ‚Üî msg_dep_happens_before
      Message_dependencies dm
      {|
        state :=
          state
            (message
               {| label := l; message := m |})
      |}</span></span></span><br><span><var>Hindos</var><span class="hyp-type"><b>: </b><span><span class="kr">‚àÄ</span> <span class="nv">dm</span> : Message,
  dm
  ‚àà set_map message
      (rec_obs_fn {| obs := os; adr := a |})
  ‚Üî msg_dep_happens_before
      Message_dependencies dm
      {|
        state := {| obs := os; adr := a |}
      |}</span></span></span><br><span><var>dm</var><span class="hyp-type"><b>: </b><span>Message</span></span></span><br></div><label class="goal-separator" for="BaseELMO-v-chka4"><hr></label><div class="goal-conclusion">msg_dep_happens_before Message_dependencies dm
  {|
    state :=
      {|
        obs := {| label := l; message := m |} :: os;
        adr := a
      |}
  |}
‚Üí dm
  ‚àà set_map message
      ({[{| label := l; message := m |}]}
       ‚à™ rec_obs_fn
           (state
              (message {| label := l; message := m |}))
       ‚à™ rec_obs_fn {| obs := os; adr := a |})</div></blockquote></div></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="BaseELMO-v-chka5" style="display: none" type="checkbox"><label class="alectryon-input" for="BaseELMO-v-chka5">-</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>Address</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>EqDecision0</var><span class="hyp-type"><b>: </b><span>EqDecision Address</span></span></span><br><span><var>State</var><span><span class="hyp-body"><b>:= </b><span>BaseELMO.State</span></span><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span></span><br><span><var>Observation</var><span><span class="hyp-body"><b>:= </b><span>BaseELMO.Observation</span></span><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span></span><br><span><var>Message</var><span><span class="hyp-body"><b>:= </b><span>BaseELMO.Message</span></span><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span></span><br><span><var>s</var><span class="hyp-type"><b>: </b><span>BaseELMO.State</span></span></span><br><span><var>adr</var><span class="hyp-type"><b>: </b><span>Address</span></span></span><br><span><var>dm</var><span class="hyp-type"><b>: </b><span>Message</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">dm ‚àà set_map message ‚àÖ
‚Üí msg_dep_happens_before Message_dependencies dm
    {| state := {| obs := []; adr := adr |} |}</div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="bp">by</span> <span class="nb">rewrite</span> set_map_empty, elem_of_empty.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="BaseELMO-v-chka6" style="display: none" type="checkbox"><label class="alectryon-input" for="BaseELMO-v-chka6">-</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>Address</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>EqDecision0</var><span class="hyp-type"><b>: </b><span>EqDecision Address</span></span></span><br><span><var>State</var><span><span class="hyp-body"><b>:= </b><span>BaseELMO.State</span></span><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span></span><br><span><var>Observation</var><span><span class="hyp-body"><b>:= </b><span>BaseELMO.Observation</span></span><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span></span><br><span><var>Message</var><span><span class="hyp-body"><b>:= </b><span>BaseELMO.Message</span></span><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span></span><br><span><var>s</var><span class="hyp-type"><b>: </b><span>BaseELMO.State</span></span></span><br><span><var>adr</var><span class="hyp-type"><b>: </b><span>Address</span></span></span><br><span><var>dm</var><span class="hyp-type"><b>: </b><span>Message</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">msg_dep_happens_before Message_dependencies dm
  {| state := {| obs := []; adr := adr |} |}
‚Üí dm ‚àà set_map message ‚àÖ</div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="BaseELMO-v-chka7" style="display: none" type="checkbox"><label class="alectryon-input" for="BaseELMO-v-chka7"><span class="nb">rewrite</span> msg_dep_happens_before_iff_one; <span class="nb">unfold</span> msg_dep_rel; <span class="nb">cbn</span>.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>Address</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>EqDecision0</var><span class="hyp-type"><b>: </b><span>EqDecision Address</span></span></span><br><span><var>State</var><span><span class="hyp-body"><b>:= </b><span>BaseELMO.State</span></span><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span></span><br><span><var>Observation</var><span><span class="hyp-body"><b>:= </b><span>BaseELMO.Observation</span></span><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span></span><br><span><var>Message</var><span><span class="hyp-body"><b>:= </b><span>BaseELMO.Message</span></span><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span></span><br><span><var>s</var><span class="hyp-type"><b>: </b><span>BaseELMO.State</span></span></span><br><span><var>adr</var><span class="hyp-type"><b>: </b><span>Address</span></span></span><br><span><var>dm</var><span class="hyp-type"><b>: </b><span>Message</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">dm ‚àà ‚àÖ
‚à® (<span class="kr">‚àÉ</span> <span class="nv">y</span> : Message,
     msg_dep_happens_before Message_dependencies dm y
     ‚àß y ‚àà ‚àÖ) ‚Üí dm ‚àà set_map message ‚àÖ</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="BaseELMO-v-chka8" style="display: none" type="checkbox"><label class="alectryon-input" for="BaseELMO-v-chka8"><span class="nb">rewrite</span> set_map_empty; <span class="nb">setoid_rewrite</span> elem_of_empty.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>Address</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>EqDecision0</var><span class="hyp-type"><b>: </b><span>EqDecision Address</span></span></span><br><span><var>State</var><span><span class="hyp-body"><b>:= </b><span>BaseELMO.State</span></span><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span></span><br><span><var>Observation</var><span><span class="hyp-body"><b>:= </b><span>BaseELMO.Observation</span></span><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span></span><br><span><var>Message</var><span><span class="hyp-body"><b>:= </b><span>BaseELMO.Message</span></span><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span></span><br><span><var>s</var><span class="hyp-type"><b>: </b><span>BaseELMO.State</span></span></span><br><span><var>adr</var><span class="hyp-type"><b>: </b><span>Address</span></span></span><br><span><var>dm</var><span class="hyp-type"><b>: </b><span>Message</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="kt">False</span>
‚à® (<span class="kr">‚àÉ</span> <span class="nv">y</span> : Message,
     msg_dep_happens_before Message_dependencies dm y
     ‚àß <span class="kt">False</span>) ‚Üí <span class="kt">False</span></div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><span class="alectryon-input"><span class="bp">by</span> <span class="nb">firstorder</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="BaseELMO-v-chka9" style="display: none" type="checkbox"><label class="alectryon-input" for="BaseELMO-v-chka9">-</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>Address</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>EqDecision0</var><span class="hyp-type"><b>: </b><span>EqDecision Address</span></span></span><br><span><var>State</var><span><span class="hyp-body"><b>:= </b><span>BaseELMO.State</span></span><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span></span><br><span><var>Observation</var><span><span class="hyp-body"><b>:= </b><span>BaseELMO.Observation</span></span><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span></span><br><span><var>Message</var><span><span class="hyp-body"><b>:= </b><span>BaseELMO.Message</span></span><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span></span><br><span><var>s</var><span class="hyp-type"><b>: </b><span>BaseELMO.State</span></span></span><br><span><var>l</var><span class="hyp-type"><b>: </b><span>Label</span></span></span><br><span><var>m</var><span class="hyp-type"><b>: </b><span>BaseELMO.Message</span></span></span><br><span><var>os</var><span class="hyp-type"><b>: </b><span>list BaseELMO.Observation</span></span></span><br><span><var>a</var><span class="hyp-type"><b>: </b><span>Address</span></span></span><br><span><var>Hindm</var><span class="hyp-type"><b>: </b><span><span class="kr">‚àÄ</span> <span class="nv">dm</span> : Message,
  dm
  ‚àà set_map message
      (rec_obs_fn
         (state
            (message
               {| label := l; message := m |})))
  ‚Üî msg_dep_happens_before
      Message_dependencies dm
      {|
        state :=
          state
            (message
               {| label := l; message := m |})
      |}</span></span></span><br><span><var>Hindos</var><span class="hyp-type"><b>: </b><span><span class="kr">‚àÄ</span> <span class="nv">dm</span> : Message,
  dm
  ‚àà set_map message
      (rec_obs_fn {| obs := os; adr := a |})
  ‚Üî msg_dep_happens_before
      Message_dependencies dm
      {|
        state := {| obs := os; adr := a |}
      |}</span></span></span><br><span><var>dm</var><span class="hyp-type"><b>: </b><span>Message</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">dm
‚àà set_map message
    ({[{| label := l; message := m |}]}
     ‚à™ rec_obs_fn
         (state
            (message {| label := l; message := m |}))
     ‚à™ rec_obs_fn {| obs := os; adr := a |})
‚Üí msg_dep_happens_before Message_dependencies dm
    {|
      state :=
        {|
          obs := {| label := l; message := m |} :: os;
          adr := a
        |}
    |}</div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="BaseELMO-v-chkaa" style="display: none" type="checkbox"><label class="alectryon-input" for="BaseELMO-v-chkaa"><span class="nb">intros</span> Hdm; <span class="nb">apply</span> elem_of_map <span class="kr">in</span> Hdm <span class="kr">as</span> (o &amp; -&gt; &amp; Hdm).</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>Address</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>EqDecision0</var><span class="hyp-type"><b>: </b><span>EqDecision Address</span></span></span><br><span><var>State</var><span><span class="hyp-body"><b>:= </b><span>BaseELMO.State</span></span><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span></span><br><span><var>Observation</var><span><span class="hyp-body"><b>:= </b><span>BaseELMO.Observation</span></span><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span></span><br><span><var>Message</var><span><span class="hyp-body"><b>:= </b><span>BaseELMO.Message</span></span><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span></span><br><span><var>s</var><span class="hyp-type"><b>: </b><span>BaseELMO.State</span></span></span><br><span><var>l</var><span class="hyp-type"><b>: </b><span>Label</span></span></span><br><span><var>m</var><span class="hyp-type"><b>: </b><span>BaseELMO.Message</span></span></span><br><span><var>os</var><span class="hyp-type"><b>: </b><span>list BaseELMO.Observation</span></span></span><br><span><var>a</var><span class="hyp-type"><b>: </b><span>Address</span></span></span><br><span><var>Hindm</var><span class="hyp-type"><b>: </b><span><span class="kr">‚àÄ</span> <span class="nv">dm</span> : Message,
  dm
  ‚àà set_map message
      (rec_obs_fn
         (state
            (message
               {| label := l; message := m |})))
  ‚Üî msg_dep_happens_before
      Message_dependencies dm
      {|
        state :=
          state
            (message
               {| label := l; message := m |})
      |}</span></span></span><br><span><var>Hindos</var><span class="hyp-type"><b>: </b><span><span class="kr">‚àÄ</span> <span class="nv">dm</span> : Message,
  dm
  ‚àà set_map message
      (rec_obs_fn {| obs := os; adr := a |})
  ‚Üî msg_dep_happens_before
      Message_dependencies dm
      {|
        state := {| obs := os; adr := a |}
      |}</span></span></span><br><span><var>o</var><span class="hyp-type"><b>: </b><span>BaseELMO.Observation</span></span></span><br><span><var>Hdm</var><span class="hyp-type"><b>: </b><span>o
‚àà {[{| label := l; message := m |}]}
  ‚à™ rec_obs_fn
      (state
         (message {| label := l; message := m |}))
  ‚à™ rec_obs_fn {| obs := os; adr := a |}</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">msg_dep_happens_before Message_dependencies
  (message o)
  {|
    state :=
      {|
        obs := {| label := l; message := m |} :: os;
        adr := a
      |}
  |}</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="BaseELMO-v-chkab" style="display: none" type="checkbox"><label class="alectryon-input" for="BaseELMO-v-chkab"><span class="nb">unfold</span> Message <span class="kr">in</span> Hdm; <span class="nb">rewrite</span> !elem_of_union, !elem_of_singleton <span class="kr">in</span> Hdm; <span class="nb">cbn</span> <span class="kr">in</span> Hdm.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>Address</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>EqDecision0</var><span class="hyp-type"><b>: </b><span>EqDecision Address</span></span></span><br><span><var>State</var><span><span class="hyp-body"><b>:= </b><span>BaseELMO.State</span></span><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span></span><br><span><var>Observation</var><span><span class="hyp-body"><b>:= </b><span>BaseELMO.Observation</span></span><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span></span><br><span><var>Message</var><span><span class="hyp-body"><b>:= </b><span>BaseELMO.Message</span></span><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span></span><br><span><var>s</var><span class="hyp-type"><b>: </b><span>BaseELMO.State</span></span></span><br><span><var>l</var><span class="hyp-type"><b>: </b><span>Label</span></span></span><br><span><var>m</var><span class="hyp-type"><b>: </b><span>BaseELMO.Message</span></span></span><br><span><var>os</var><span class="hyp-type"><b>: </b><span>list BaseELMO.Observation</span></span></span><br><span><var>a</var><span class="hyp-type"><b>: </b><span>Address</span></span></span><br><span><var>Hindm</var><span class="hyp-type"><b>: </b><span><span class="kr">‚àÄ</span> <span class="nv">dm</span> : Message,
  dm
  ‚àà set_map message
      (rec_obs_fn
         (state
            (message
               {| label := l; message := m |})))
  ‚Üî msg_dep_happens_before
      Message_dependencies dm
      {|
        state :=
          state
            (message
               {| label := l; message := m |})
      |}</span></span></span><br><span><var>Hindos</var><span class="hyp-type"><b>: </b><span><span class="kr">‚àÄ</span> <span class="nv">dm</span> : Message,
  dm
  ‚àà set_map message
      (rec_obs_fn {| obs := os; adr := a |})
  ‚Üî msg_dep_happens_before
      Message_dependencies dm
      {|
        state := {| obs := os; adr := a |}
      |}</span></span></span><br><span><var>o</var><span class="hyp-type"><b>: </b><span>BaseELMO.Observation</span></span></span><br><span><var>Hdm</var><span class="hyp-type"><b>: </b><span>(o = {| label := l; message := m |}
 ‚à® o ‚àà rec_obs_fn (state m))
‚à® o ‚àà rec_obs_fn {| obs := os; adr := a |}</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">msg_dep_happens_before Message_dependencies
  (message o)
  {|
    state :=
      {|
        obs := {| label := l; message := m |} :: os;
        adr := a
      |}
  |}</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="BaseELMO-v-chkac" style="display: none" type="checkbox"><label class="alectryon-input" for="BaseELMO-v-chkac"><span class="nb">destruct</span> Hdm <span class="kr">as</span> [[-&gt; | Hm] | Hos].</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>Address</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>EqDecision0</var><span class="hyp-type"><b>: </b><span>EqDecision Address</span></span></span><br><span><var>State</var><span><span class="hyp-body"><b>:= </b><span>BaseELMO.State</span></span><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span></span><br><span><var>Observation</var><span><span class="hyp-body"><b>:= </b><span>BaseELMO.Observation</span></span><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span></span><br><span><var>Message</var><span><span class="hyp-body"><b>:= </b><span>BaseELMO.Message</span></span><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span></span><br><span><var>s</var><span class="hyp-type"><b>: </b><span>BaseELMO.State</span></span></span><br><span><var>l</var><span class="hyp-type"><b>: </b><span>Label</span></span></span><br><span><var>m</var><span class="hyp-type"><b>: </b><span>BaseELMO.Message</span></span></span><br><span><var>os</var><span class="hyp-type"><b>: </b><span>list BaseELMO.Observation</span></span></span><br><span><var>a</var><span class="hyp-type"><b>: </b><span>Address</span></span></span><br><span><var>Hindm</var><span class="hyp-type"><b>: </b><span><span class="kr">‚àÄ</span> <span class="nv">dm</span> : Message,
  dm
  ‚àà set_map message
      (rec_obs_fn
         (state
            (message
               {| label := l; message := m |})))
  ‚Üî msg_dep_happens_before
      Message_dependencies dm
      {|
        state :=
          state
            (message
               {| label := l; message := m |})
      |}</span></span></span><br><span><var>Hindos</var><span class="hyp-type"><b>: </b><span><span class="kr">‚àÄ</span> <span class="nv">dm</span> : Message,
  dm
  ‚àà set_map message
      (rec_obs_fn {| obs := os; adr := a |})
  ‚Üî msg_dep_happens_before
      Message_dependencies dm
      {|
        state := {| obs := os; adr := a |}
      |}</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">msg_dep_happens_before Message_dependencies
  (message {| label := l; message := m |})
  {|
    state :=
      {|
        obs := {| label := l; message := m |} :: os;
        adr := a
      |}
  |}</div></blockquote><div class="alectryon-extra-goals"><input class="alectryon-extra-goal-toggle" id="BaseELMO-v-chkad" style="display: none" type="checkbox"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>Address</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>EqDecision0</var><span class="hyp-type"><b>: </b><span>EqDecision Address</span></span></span><br><span><var>State</var><span><span class="hyp-body"><b>:= </b><span>BaseELMO.State</span></span><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span></span><br><span><var>Observation</var><span><span class="hyp-body"><b>:= </b><span>BaseELMO.Observation</span></span><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span></span><br><span><var>Message</var><span><span class="hyp-body"><b>:= </b><span>BaseELMO.Message</span></span><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span></span><br><span><var>s</var><span class="hyp-type"><b>: </b><span>BaseELMO.State</span></span></span><br><span><var>l</var><span class="hyp-type"><b>: </b><span>Label</span></span></span><br><span><var>m</var><span class="hyp-type"><b>: </b><span>BaseELMO.Message</span></span></span><br><span><var>os</var><span class="hyp-type"><b>: </b><span>list BaseELMO.Observation</span></span></span><br><span><var>a</var><span class="hyp-type"><b>: </b><span>Address</span></span></span><br><span><var>Hindm</var><span class="hyp-type"><b>: </b><span><span class="kr">‚àÄ</span> <span class="nv">dm</span> : Message,
  dm
  ‚àà set_map message
      (rec_obs_fn
         (state
            (message
               {| label := l; message := m |})))
  ‚Üî msg_dep_happens_before
      Message_dependencies dm
      {|
        state :=
          state
            (message
               {| label := l; message := m |})
      |}</span></span></span><br><span><var>Hindos</var><span class="hyp-type"><b>: </b><span><span class="kr">‚àÄ</span> <span class="nv">dm</span> : Message,
  dm
  ‚àà set_map message
      (rec_obs_fn {| obs := os; adr := a |})
  ‚Üî msg_dep_happens_before
      Message_dependencies dm
      {|
        state := {| obs := os; adr := a |}
      |}</span></span></span><br><span><var>o</var><span class="hyp-type"><b>: </b><span>BaseELMO.Observation</span></span></span><br><span><var>Hm</var><span class="hyp-type"><b>: </b><span>o ‚àà rec_obs_fn (state m)</span></span></span><br></div><label class="goal-separator" for="BaseELMO-v-chkad"><hr></label><div class="goal-conclusion">msg_dep_happens_before Message_dependencies
  (message o)
  {|
    state :=
      {|
        obs := {| label := l; message := m |} :: os;
        adr := a
      |}
  |}</div></blockquote><input class="alectryon-extra-goal-toggle" id="BaseELMO-v-chkae" style="display: none" type="checkbox"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>Address</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>EqDecision0</var><span class="hyp-type"><b>: </b><span>EqDecision Address</span></span></span><br><span><var>State</var><span><span class="hyp-body"><b>:= </b><span>BaseELMO.State</span></span><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span></span><br><span><var>Observation</var><span><span class="hyp-body"><b>:= </b><span>BaseELMO.Observation</span></span><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span></span><br><span><var>Message</var><span><span class="hyp-body"><b>:= </b><span>BaseELMO.Message</span></span><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span></span><br><span><var>s</var><span class="hyp-type"><b>: </b><span>BaseELMO.State</span></span></span><br><span><var>l</var><span class="hyp-type"><b>: </b><span>Label</span></span></span><br><span><var>m</var><span class="hyp-type"><b>: </b><span>BaseELMO.Message</span></span></span><br><span><var>os</var><span class="hyp-type"><b>: </b><span>list BaseELMO.Observation</span></span></span><br><span><var>a</var><span class="hyp-type"><b>: </b><span>Address</span></span></span><br><span><var>Hindm</var><span class="hyp-type"><b>: </b><span><span class="kr">‚àÄ</span> <span class="nv">dm</span> : Message,
  dm
  ‚àà set_map message
      (rec_obs_fn
         (state
            (message
               {| label := l; message := m |})))
  ‚Üî msg_dep_happens_before
      Message_dependencies dm
      {|
        state :=
          state
            (message
               {| label := l; message := m |})
      |}</span></span></span><br><span><var>Hindos</var><span class="hyp-type"><b>: </b><span><span class="kr">‚àÄ</span> <span class="nv">dm</span> : Message,
  dm
  ‚àà set_map message
      (rec_obs_fn {| obs := os; adr := a |})
  ‚Üî msg_dep_happens_before
      Message_dependencies dm
      {|
        state := {| obs := os; adr := a |}
      |}</span></span></span><br><span><var>o</var><span class="hyp-type"><b>: </b><span>BaseELMO.Observation</span></span></span><br><span><var>Hos</var><span class="hyp-type"><b>: </b><span>o ‚àà rec_obs_fn {| obs := os; adr := a |}</span></span></span><br></div><label class="goal-separator" for="BaseELMO-v-chkae"><hr></label><div class="goal-conclusion">msg_dep_happens_before Message_dependencies
  (message o)
  {|
    state :=
      {|
        obs := {| label := l; message := m |} :: os;
        adr := a
      |}
  |}</div></blockquote></div></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="BaseELMO-v-chkaf" style="display: none" type="checkbox"><label class="alectryon-input" for="BaseELMO-v-chkaf">+</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>Address</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>EqDecision0</var><span class="hyp-type"><b>: </b><span>EqDecision Address</span></span></span><br><span><var>State</var><span><span class="hyp-body"><b>:= </b><span>BaseELMO.State</span></span><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span></span><br><span><var>Observation</var><span><span class="hyp-body"><b>:= </b><span>BaseELMO.Observation</span></span><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span></span><br><span><var>Message</var><span><span class="hyp-body"><b>:= </b><span>BaseELMO.Message</span></span><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span></span><br><span><var>s</var><span class="hyp-type"><b>: </b><span>BaseELMO.State</span></span></span><br><span><var>l</var><span class="hyp-type"><b>: </b><span>Label</span></span></span><br><span><var>m</var><span class="hyp-type"><b>: </b><span>BaseELMO.Message</span></span></span><br><span><var>os</var><span class="hyp-type"><b>: </b><span>list BaseELMO.Observation</span></span></span><br><span><var>a</var><span class="hyp-type"><b>: </b><span>Address</span></span></span><br><span><var>Hindm</var><span class="hyp-type"><b>: </b><span><span class="kr">‚àÄ</span> <span class="nv">dm</span> : Message,
  dm
  ‚àà set_map message
      (rec_obs_fn
         (state
            (message
               {| label := l; message := m |})))
  ‚Üî msg_dep_happens_before
      Message_dependencies dm
      {|
        state :=
          state
            (message
               {| label := l; message := m |})
      |}</span></span></span><br><span><var>Hindos</var><span class="hyp-type"><b>: </b><span><span class="kr">‚àÄ</span> <span class="nv">dm</span> : Message,
  dm
  ‚àà set_map message
      (rec_obs_fn {| obs := os; adr := a |})
  ‚Üî msg_dep_happens_before
      Message_dependencies dm
      {|
        state := {| obs := os; adr := a |}
      |}</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">msg_dep_happens_before Message_dependencies
  (message {| label := l; message := m |})
  {|
    state :=
      {|
        obs := {| label := l; message := m |} :: os;
        adr := a
      |}
  |}</div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="BaseELMO-v-chkb0" style="display: none" type="checkbox"><label class="alectryon-input" for="BaseELMO-v-chkb0"><span class="nb">apply</span> msg_dep_happens_before_iff_one; <span class="nb">left</span>.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>Address</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>EqDecision0</var><span class="hyp-type"><b>: </b><span>EqDecision Address</span></span></span><br><span><var>State</var><span><span class="hyp-body"><b>:= </b><span>BaseELMO.State</span></span><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span></span><br><span><var>Observation</var><span><span class="hyp-body"><b>:= </b><span>BaseELMO.Observation</span></span><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span></span><br><span><var>Message</var><span><span class="hyp-body"><b>:= </b><span>BaseELMO.Message</span></span><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span></span><br><span><var>s</var><span class="hyp-type"><b>: </b><span>BaseELMO.State</span></span></span><br><span><var>l</var><span class="hyp-type"><b>: </b><span>Label</span></span></span><br><span><var>m</var><span class="hyp-type"><b>: </b><span>BaseELMO.Message</span></span></span><br><span><var>os</var><span class="hyp-type"><b>: </b><span>list BaseELMO.Observation</span></span></span><br><span><var>a</var><span class="hyp-type"><b>: </b><span>Address</span></span></span><br><span><var>Hindm</var><span class="hyp-type"><b>: </b><span><span class="kr">‚àÄ</span> <span class="nv">dm</span> : Message,
  dm
  ‚àà set_map message
      (rec_obs_fn
         (state
            (message
               {| label := l; message := m |})))
  ‚Üî msg_dep_happens_before
      Message_dependencies dm
      {|
        state :=
          state
            (message
               {| label := l; message := m |})
      |}</span></span></span><br><span><var>Hindos</var><span class="hyp-type"><b>: </b><span><span class="kr">‚àÄ</span> <span class="nv">dm</span> : Message,
  dm
  ‚àà set_map message
      (rec_obs_fn {| obs := os; adr := a |})
  ‚Üî msg_dep_happens_before
      Message_dependencies dm
      {|
        state := {| obs := os; adr := a |}
      |}</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">msg_dep_rel Message_dependencies
  (message {| label := l; message := m |})
  {|
    state :=
      {|
        obs := {| label := l; message := m |} :: os;
        adr := a
      |}
  |}</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">      </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="BaseELMO-v-chkb1" style="display: none" type="checkbox"><label class="alectryon-input" for="BaseELMO-v-chkb1"><span class="nb">unfold</span> msg_dep_rel, compose; <span class="nb">cbn</span>; <span class="nb">unfold</span> Message.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>Address</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>EqDecision0</var><span class="hyp-type"><b>: </b><span>EqDecision Address</span></span></span><br><span><var>State</var><span><span class="hyp-body"><b>:= </b><span>BaseELMO.State</span></span><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span></span><br><span><var>Observation</var><span><span class="hyp-body"><b>:= </b><span>BaseELMO.Observation</span></span><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span></span><br><span><var>Message</var><span><span class="hyp-body"><b>:= </b><span>BaseELMO.Message</span></span><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span></span><br><span><var>s</var><span class="hyp-type"><b>: </b><span>BaseELMO.State</span></span></span><br><span><var>l</var><span class="hyp-type"><b>: </b><span>Label</span></span></span><br><span><var>m</var><span class="hyp-type"><b>: </b><span>BaseELMO.Message</span></span></span><br><span><var>os</var><span class="hyp-type"><b>: </b><span>list BaseELMO.Observation</span></span></span><br><span><var>a</var><span class="hyp-type"><b>: </b><span>Address</span></span></span><br><span><var>Hindm</var><span class="hyp-type"><b>: </b><span><span class="kr">‚àÄ</span> <span class="nv">dm</span> : Message,
  dm
  ‚àà set_map message
      (rec_obs_fn
         (state
            (message
               {| label := l; message := m |})))
  ‚Üî msg_dep_happens_before
      Message_dependencies dm
      {|
        state :=
          state
            (message
               {| label := l; message := m |})
      |}</span></span></span><br><span><var>Hindos</var><span class="hyp-type"><b>: </b><span><span class="kr">‚àÄ</span> <span class="nv">dm</span> : Message,
  dm
  ‚àà set_map message
      (rec_obs_fn {| obs := os; adr := a |})
  ‚Üî msg_dep_happens_before
      Message_dependencies dm
      {|
        state := {| obs := os; adr := a |}
      |}</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">m ‚àà {[m]} ‚à™ list_to_set (map message os)</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">      </span><span class="alectryon-sentence"><span class="alectryon-input"><span class="bp">by</span> <span class="nb">rewrite</span> elem_of_union, elem_of_singleton; <span class="nb">left</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="BaseELMO-v-chkb2" style="display: none" type="checkbox"><label class="alectryon-input" for="BaseELMO-v-chkb2">+</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>Address</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>EqDecision0</var><span class="hyp-type"><b>: </b><span>EqDecision Address</span></span></span><br><span><var>State</var><span><span class="hyp-body"><b>:= </b><span>BaseELMO.State</span></span><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span></span><br><span><var>Observation</var><span><span class="hyp-body"><b>:= </b><span>BaseELMO.Observation</span></span><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span></span><br><span><var>Message</var><span><span class="hyp-body"><b>:= </b><span>BaseELMO.Message</span></span><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span></span><br><span><var>s</var><span class="hyp-type"><b>: </b><span>BaseELMO.State</span></span></span><br><span><var>l</var><span class="hyp-type"><b>: </b><span>Label</span></span></span><br><span><var>m</var><span class="hyp-type"><b>: </b><span>BaseELMO.Message</span></span></span><br><span><var>os</var><span class="hyp-type"><b>: </b><span>list BaseELMO.Observation</span></span></span><br><span><var>a</var><span class="hyp-type"><b>: </b><span>Address</span></span></span><br><span><var>Hindm</var><span class="hyp-type"><b>: </b><span><span class="kr">‚àÄ</span> <span class="nv">dm</span> : Message,
  dm
  ‚àà set_map message
      (rec_obs_fn
         (state
            (message
               {| label := l; message := m |})))
  ‚Üî msg_dep_happens_before
      Message_dependencies dm
      {|
        state :=
          state
            (message
               {| label := l; message := m |})
      |}</span></span></span><br><span><var>Hindos</var><span class="hyp-type"><b>: </b><span><span class="kr">‚àÄ</span> <span class="nv">dm</span> : Message,
  dm
  ‚àà set_map message
      (rec_obs_fn {| obs := os; adr := a |})
  ‚Üî msg_dep_happens_before
      Message_dependencies dm
      {|
        state := {| obs := os; adr := a |}
      |}</span></span></span><br><span><var>o</var><span class="hyp-type"><b>: </b><span>BaseELMO.Observation</span></span></span><br><span><var>Hm</var><span class="hyp-type"><b>: </b><span>o ‚àà rec_obs_fn (state m)</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">msg_dep_happens_before Message_dependencies
  (message o)
  {|
    state :=
      {|
        obs := {| label := l; message := m |} :: os;
        adr := a
      |}
  |}</div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="BaseELMO-v-chkb3" style="display: none" type="checkbox"><label class="alectryon-input" for="BaseELMO-v-chkb3"><span class="nb">transitivity</span> m; <span class="nb">cbn</span> <span class="kr">in</span> *.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>Address</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>EqDecision0</var><span class="hyp-type"><b>: </b><span>EqDecision Address</span></span></span><br><span><var>State</var><span><span class="hyp-body"><b>:= </b><span>BaseELMO.State</span></span><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span></span><br><span><var>Observation</var><span><span class="hyp-body"><b>:= </b><span>BaseELMO.Observation</span></span><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span></span><br><span><var>Message</var><span><span class="hyp-body"><b>:= </b><span>BaseELMO.Message</span></span><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span></span><br><span><var>s</var><span class="hyp-type"><b>: </b><span>BaseELMO.State</span></span></span><br><span><var>l</var><span class="hyp-type"><b>: </b><span>Label</span></span></span><br><span><var>m</var><span class="hyp-type"><b>: </b><span>BaseELMO.Message</span></span></span><br><span><var>os</var><span class="hyp-type"><b>: </b><span>list BaseELMO.Observation</span></span></span><br><span><var>a</var><span class="hyp-type"><b>: </b><span>Address</span></span></span><br><span><var>Hindm</var><span class="hyp-type"><b>: </b><span><span class="kr">‚àÄ</span> <span class="nv">dm</span> : Message,
  dm ‚àà set_map message (rec_obs_fn (state m))
  ‚Üî msg_dep_happens_before
      Message_dependencies dm
      {| state := state m |}</span></span></span><br><span><var>Hindos</var><span class="hyp-type"><b>: </b><span><span class="kr">‚àÄ</span> <span class="nv">dm</span> : Message,
  dm
  ‚àà set_map message
      (rec_obs_fn {| obs := os; adr := a |})
  ‚Üî msg_dep_happens_before
      Message_dependencies dm
      {|
        state := {| obs := os; adr := a |}
      |}</span></span></span><br><span><var>o</var><span class="hyp-type"><b>: </b><span>BaseELMO.Observation</span></span></span><br><span><var>Hm</var><span class="hyp-type"><b>: </b><span>o ‚àà rec_obs_fn (state m)</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">msg_dep_happens_before Message_dependencies
  (message o) m</div></blockquote><div class="alectryon-extra-goals"><input class="alectryon-extra-goal-toggle" id="BaseELMO-v-chkb4" style="display: none" type="checkbox"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>Address</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>EqDecision0</var><span class="hyp-type"><b>: </b><span>EqDecision Address</span></span></span><br><span><var>State</var><span><span class="hyp-body"><b>:= </b><span>BaseELMO.State</span></span><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span></span><br><span><var>Observation</var><span><span class="hyp-body"><b>:= </b><span>BaseELMO.Observation</span></span><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span></span><br><span><var>Message</var><span><span class="hyp-body"><b>:= </b><span>BaseELMO.Message</span></span><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span></span><br><span><var>s</var><span class="hyp-type"><b>: </b><span>BaseELMO.State</span></span></span><br><span><var>l</var><span class="hyp-type"><b>: </b><span>Label</span></span></span><br><span><var>m</var><span class="hyp-type"><b>: </b><span>BaseELMO.Message</span></span></span><br><span><var>os</var><span class="hyp-type"><b>: </b><span>list BaseELMO.Observation</span></span></span><br><span><var>a</var><span class="hyp-type"><b>: </b><span>Address</span></span></span><br><span><var>Hindm</var><span class="hyp-type"><b>: </b><span><span class="kr">‚àÄ</span> <span class="nv">dm</span> : Message,
  dm ‚àà set_map message (rec_obs_fn (state m))
  ‚Üî msg_dep_happens_before
      Message_dependencies dm
      {| state := state m |}</span></span></span><br><span><var>Hindos</var><span class="hyp-type"><b>: </b><span><span class="kr">‚àÄ</span> <span class="nv">dm</span> : Message,
  dm
  ‚àà set_map message
      (rec_obs_fn {| obs := os; adr := a |})
  ‚Üî msg_dep_happens_before
      Message_dependencies dm
      {|
        state := {| obs := os; adr := a |}
      |}</span></span></span><br><span><var>o</var><span class="hyp-type"><b>: </b><span>BaseELMO.Observation</span></span></span><br><span><var>Hm</var><span class="hyp-type"><b>: </b><span>o ‚àà rec_obs_fn (state m)</span></span></span><br></div><label class="goal-separator" for="BaseELMO-v-chkb4"><hr></label><div class="goal-conclusion">msg_dep_happens_before Message_dependencies m
  {|
    state :=
      {|
        obs := {| label := l; message := m |} :: os;
        adr := a
      |}
  |}</div></blockquote></div></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">      </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="BaseELMO-v-chkb5" style="display: none" type="checkbox"><label class="alectryon-input" for="BaseELMO-v-chkb5">*</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>Address</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>EqDecision0</var><span class="hyp-type"><b>: </b><span>EqDecision Address</span></span></span><br><span><var>State</var><span><span class="hyp-body"><b>:= </b><span>BaseELMO.State</span></span><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span></span><br><span><var>Observation</var><span><span class="hyp-body"><b>:= </b><span>BaseELMO.Observation</span></span><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span></span><br><span><var>Message</var><span><span class="hyp-body"><b>:= </b><span>BaseELMO.Message</span></span><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span></span><br><span><var>s</var><span class="hyp-type"><b>: </b><span>BaseELMO.State</span></span></span><br><span><var>l</var><span class="hyp-type"><b>: </b><span>Label</span></span></span><br><span><var>m</var><span class="hyp-type"><b>: </b><span>BaseELMO.Message</span></span></span><br><span><var>os</var><span class="hyp-type"><b>: </b><span>list BaseELMO.Observation</span></span></span><br><span><var>a</var><span class="hyp-type"><b>: </b><span>Address</span></span></span><br><span><var>Hindm</var><span class="hyp-type"><b>: </b><span><span class="kr">‚àÄ</span> <span class="nv">dm</span> : Message,
  dm ‚àà set_map message (rec_obs_fn (state m))
  ‚Üî msg_dep_happens_before
      Message_dependencies dm
      {| state := state m |}</span></span></span><br><span><var>Hindos</var><span class="hyp-type"><b>: </b><span><span class="kr">‚àÄ</span> <span class="nv">dm</span> : Message,
  dm
  ‚àà set_map message
      (rec_obs_fn {| obs := os; adr := a |})
  ‚Üî msg_dep_happens_before
      Message_dependencies dm
      {|
        state := {| obs := os; adr := a |}
      |}</span></span></span><br><span><var>o</var><span class="hyp-type"><b>: </b><span>BaseELMO.Observation</span></span></span><br><span><var>Hm</var><span class="hyp-type"><b>: </b><span>o ‚àà rec_obs_fn (state m)</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">msg_dep_happens_before Message_dependencies
  (message o) m</div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="bp">by</span> <span class="nb">destruct</span> m; <span class="nb">apply</span> Hindm, elem_of_map; <span class="nb">cbn</span>; <span class="nb">eexists</span>; <span class="nb">split</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">      </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="BaseELMO-v-chkb6" style="display: none" type="checkbox"><label class="alectryon-input" for="BaseELMO-v-chkb6">*</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>Address</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>EqDecision0</var><span class="hyp-type"><b>: </b><span>EqDecision Address</span></span></span><br><span><var>State</var><span><span class="hyp-body"><b>:= </b><span>BaseELMO.State</span></span><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span></span><br><span><var>Observation</var><span><span class="hyp-body"><b>:= </b><span>BaseELMO.Observation</span></span><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span></span><br><span><var>Message</var><span><span class="hyp-body"><b>:= </b><span>BaseELMO.Message</span></span><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span></span><br><span><var>s</var><span class="hyp-type"><b>: </b><span>BaseELMO.State</span></span></span><br><span><var>l</var><span class="hyp-type"><b>: </b><span>Label</span></span></span><br><span><var>m</var><span class="hyp-type"><b>: </b><span>BaseELMO.Message</span></span></span><br><span><var>os</var><span class="hyp-type"><b>: </b><span>list BaseELMO.Observation</span></span></span><br><span><var>a</var><span class="hyp-type"><b>: </b><span>Address</span></span></span><br><span><var>Hindm</var><span class="hyp-type"><b>: </b><span><span class="kr">‚àÄ</span> <span class="nv">dm</span> : Message,
  dm ‚àà set_map message (rec_obs_fn (state m))
  ‚Üî msg_dep_happens_before
      Message_dependencies dm
      {| state := state m |}</span></span></span><br><span><var>Hindos</var><span class="hyp-type"><b>: </b><span><span class="kr">‚àÄ</span> <span class="nv">dm</span> : Message,
  dm
  ‚àà set_map message
      (rec_obs_fn {| obs := os; adr := a |})
  ‚Üî msg_dep_happens_before
      Message_dependencies dm
      {|
        state := {| obs := os; adr := a |}
      |}</span></span></span><br><span><var>o</var><span class="hyp-type"><b>: </b><span>BaseELMO.Observation</span></span></span><br><span><var>Hm</var><span class="hyp-type"><b>: </b><span>o ‚àà rec_obs_fn (state m)</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">msg_dep_happens_before Message_dependencies m
  {|
    state :=
      {|
        obs := {| label := l; message := m |} :: os;
        adr := a
      |}
  |}</div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="BaseELMO-v-chkb7" style="display: none" type="checkbox"><label class="alectryon-input" for="BaseELMO-v-chkb7"><span class="nb">apply</span> msg_dep_happens_before_iff_one; <span class="nb">left</span>.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>Address</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>EqDecision0</var><span class="hyp-type"><b>: </b><span>EqDecision Address</span></span></span><br><span><var>State</var><span><span class="hyp-body"><b>:= </b><span>BaseELMO.State</span></span><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span></span><br><span><var>Observation</var><span><span class="hyp-body"><b>:= </b><span>BaseELMO.Observation</span></span><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span></span><br><span><var>Message</var><span><span class="hyp-body"><b>:= </b><span>BaseELMO.Message</span></span><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span></span><br><span><var>s</var><span class="hyp-type"><b>: </b><span>BaseELMO.State</span></span></span><br><span><var>l</var><span class="hyp-type"><b>: </b><span>Label</span></span></span><br><span><var>m</var><span class="hyp-type"><b>: </b><span>BaseELMO.Message</span></span></span><br><span><var>os</var><span class="hyp-type"><b>: </b><span>list BaseELMO.Observation</span></span></span><br><span><var>a</var><span class="hyp-type"><b>: </b><span>Address</span></span></span><br><span><var>Hindm</var><span class="hyp-type"><b>: </b><span><span class="kr">‚àÄ</span> <span class="nv">dm</span> : Message,
  dm ‚àà set_map message (rec_obs_fn (state m))
  ‚Üî msg_dep_happens_before
      Message_dependencies dm
      {| state := state m |}</span></span></span><br><span><var>Hindos</var><span class="hyp-type"><b>: </b><span><span class="kr">‚àÄ</span> <span class="nv">dm</span> : Message,
  dm
  ‚àà set_map message
      (rec_obs_fn {| obs := os; adr := a |})
  ‚Üî msg_dep_happens_before
      Message_dependencies dm
      {|
        state := {| obs := os; adr := a |}
      |}</span></span></span><br><span><var>o</var><span class="hyp-type"><b>: </b><span>BaseELMO.Observation</span></span></span><br><span><var>Hm</var><span class="hyp-type"><b>: </b><span>o ‚àà rec_obs_fn (state m)</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">msg_dep_rel Message_dependencies m
  {|
    state :=
      {|
        obs := {| label := l; message := m |} :: os;
        adr := a
      |}
  |}</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">        </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="BaseELMO-v-chkb8" style="display: none" type="checkbox"><label class="alectryon-input" for="BaseELMO-v-chkb8"><span class="nb">unfold</span> msg_dep_rel, compose; <span class="nb">cbn</span>; <span class="nb">unfold</span> Message.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>Address</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>EqDecision0</var><span class="hyp-type"><b>: </b><span>EqDecision Address</span></span></span><br><span><var>State</var><span><span class="hyp-body"><b>:= </b><span>BaseELMO.State</span></span><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span></span><br><span><var>Observation</var><span><span class="hyp-body"><b>:= </b><span>BaseELMO.Observation</span></span><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span></span><br><span><var>Message</var><span><span class="hyp-body"><b>:= </b><span>BaseELMO.Message</span></span><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span></span><br><span><var>s</var><span class="hyp-type"><b>: </b><span>BaseELMO.State</span></span></span><br><span><var>l</var><span class="hyp-type"><b>: </b><span>Label</span></span></span><br><span><var>m</var><span class="hyp-type"><b>: </b><span>BaseELMO.Message</span></span></span><br><span><var>os</var><span class="hyp-type"><b>: </b><span>list BaseELMO.Observation</span></span></span><br><span><var>a</var><span class="hyp-type"><b>: </b><span>Address</span></span></span><br><span><var>Hindm</var><span class="hyp-type"><b>: </b><span><span class="kr">‚àÄ</span> <span class="nv">dm</span> : Message,
  dm ‚àà set_map message (rec_obs_fn (state m))
  ‚Üî msg_dep_happens_before
      Message_dependencies dm
      {| state := state m |}</span></span></span><br><span><var>Hindos</var><span class="hyp-type"><b>: </b><span><span class="kr">‚àÄ</span> <span class="nv">dm</span> : Message,
  dm
  ‚àà set_map message
      (rec_obs_fn {| obs := os; adr := a |})
  ‚Üî msg_dep_happens_before
      Message_dependencies dm
      {|
        state := {| obs := os; adr := a |}
      |}</span></span></span><br><span><var>o</var><span class="hyp-type"><b>: </b><span>BaseELMO.Observation</span></span></span><br><span><var>Hm</var><span class="hyp-type"><b>: </b><span>o ‚àà rec_obs_fn (state m)</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">m ‚àà {[m]} ‚à™ list_to_set (map message os)</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">        </span><span class="alectryon-sentence"><span class="alectryon-input"><span class="bp">by</span> <span class="nb">rewrite</span> elem_of_union, elem_of_singleton; <span class="nb">left</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="BaseELMO-v-chkb9" style="display: none" type="checkbox"><label class="alectryon-input" for="BaseELMO-v-chkb9">+</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>Address</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>EqDecision0</var><span class="hyp-type"><b>: </b><span>EqDecision Address</span></span></span><br><span><var>State</var><span><span class="hyp-body"><b>:= </b><span>BaseELMO.State</span></span><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span></span><br><span><var>Observation</var><span><span class="hyp-body"><b>:= </b><span>BaseELMO.Observation</span></span><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span></span><br><span><var>Message</var><span><span class="hyp-body"><b>:= </b><span>BaseELMO.Message</span></span><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span></span><br><span><var>s</var><span class="hyp-type"><b>: </b><span>BaseELMO.State</span></span></span><br><span><var>l</var><span class="hyp-type"><b>: </b><span>Label</span></span></span><br><span><var>m</var><span class="hyp-type"><b>: </b><span>BaseELMO.Message</span></span></span><br><span><var>os</var><span class="hyp-type"><b>: </b><span>list BaseELMO.Observation</span></span></span><br><span><var>a</var><span class="hyp-type"><b>: </b><span>Address</span></span></span><br><span><var>Hindm</var><span class="hyp-type"><b>: </b><span><span class="kr">‚àÄ</span> <span class="nv">dm</span> : Message,
  dm
  ‚àà set_map message
      (rec_obs_fn
         (state
            (message
               {| label := l; message := m |})))
  ‚Üî msg_dep_happens_before
      Message_dependencies dm
      {|
        state :=
          state
            (message
               {| label := l; message := m |})
      |}</span></span></span><br><span><var>Hindos</var><span class="hyp-type"><b>: </b><span><span class="kr">‚àÄ</span> <span class="nv">dm</span> : Message,
  dm
  ‚àà set_map message
      (rec_obs_fn {| obs := os; adr := a |})
  ‚Üî msg_dep_happens_before
      Message_dependencies dm
      {|
        state := {| obs := os; adr := a |}
      |}</span></span></span><br><span><var>o</var><span class="hyp-type"><b>: </b><span>BaseELMO.Observation</span></span></span><br><span><var>Hos</var><span class="hyp-type"><b>: </b><span>o ‚àà rec_obs_fn {| obs := os; adr := a |}</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">msg_dep_happens_before Message_dependencies
  (message o)
  {|
    state :=
      {|
        obs := {| label := l; message := m |} :: os;
        adr := a
      |}
  |}</div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="BaseELMO-v-chkba" style="display: none" type="checkbox"><label class="alectryon-input" for="BaseELMO-v-chkba"><span class="nb">assert</span> (Hmos : message o ‚àà@{listset Message} set_map message (rec_obs_fn (MkState os a)))
        <span class="bp">by</span> (<span class="nb">apply</span> elem_of_map; <span class="nb">eexists</span>; <span class="nb">split</span>; <span class="bp">done</span>).</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>Address</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>EqDecision0</var><span class="hyp-type"><b>: </b><span>EqDecision Address</span></span></span><br><span><var>State</var><span><span class="hyp-body"><b>:= </b><span>BaseELMO.State</span></span><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span></span><br><span><var>Observation</var><span><span class="hyp-body"><b>:= </b><span>BaseELMO.Observation</span></span><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span></span><br><span><var>Message</var><span><span class="hyp-body"><b>:= </b><span>BaseELMO.Message</span></span><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span></span><br><span><var>s</var><span class="hyp-type"><b>: </b><span>BaseELMO.State</span></span></span><br><span><var>l</var><span class="hyp-type"><b>: </b><span>Label</span></span></span><br><span><var>m</var><span class="hyp-type"><b>: </b><span>BaseELMO.Message</span></span></span><br><span><var>os</var><span class="hyp-type"><b>: </b><span>list BaseELMO.Observation</span></span></span><br><span><var>a</var><span class="hyp-type"><b>: </b><span>Address</span></span></span><br><span><var>Hindm</var><span class="hyp-type"><b>: </b><span><span class="kr">‚àÄ</span> <span class="nv">dm</span> : Message,
  dm
  ‚àà set_map message
      (rec_obs_fn
         (state
            (message
               {| label := l; message := m |})))
  ‚Üî msg_dep_happens_before
      Message_dependencies dm
      {|
        state :=
          state
            (message
               {| label := l; message := m |})
      |}</span></span></span><br><span><var>Hindos</var><span class="hyp-type"><b>: </b><span><span class="kr">‚àÄ</span> <span class="nv">dm</span> : Message,
  dm
  ‚àà set_map message
      (rec_obs_fn {| obs := os; adr := a |})
  ‚Üî msg_dep_happens_before
      Message_dependencies dm
      {|
        state := {| obs := os; adr := a |}
      |}</span></span></span><br><span><var>o</var><span class="hyp-type"><b>: </b><span>BaseELMO.Observation</span></span></span><br><span><var>Hos</var><span class="hyp-type"><b>: </b><span>o ‚àà rec_obs_fn {| obs := os; adr := a |}</span></span></span><br><span><var>Hmos</var><span class="hyp-type"><b>: </b><span>message o
‚àà set_map message
    (rec_obs_fn {| obs := os; adr := a |})</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">msg_dep_happens_before Message_dependencies
  (message o)
  {|
    state :=
      {|
        obs := {| label := l; message := m |} :: os;
        adr := a
      |}
  |}</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">      </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="BaseELMO-v-chkbb" style="display: none" type="checkbox"><label class="alectryon-input" for="BaseELMO-v-chkbb"><span class="nb">apply</span> Hindos <span class="kr">in</span> Hmos.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>Address</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>EqDecision0</var><span class="hyp-type"><b>: </b><span>EqDecision Address</span></span></span><br><span><var>State</var><span><span class="hyp-body"><b>:= </b><span>BaseELMO.State</span></span><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span></span><br><span><var>Observation</var><span><span class="hyp-body"><b>:= </b><span>BaseELMO.Observation</span></span><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span></span><br><span><var>Message</var><span><span class="hyp-body"><b>:= </b><span>BaseELMO.Message</span></span><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span></span><br><span><var>s</var><span class="hyp-type"><b>: </b><span>BaseELMO.State</span></span></span><br><span><var>l</var><span class="hyp-type"><b>: </b><span>Label</span></span></span><br><span><var>m</var><span class="hyp-type"><b>: </b><span>BaseELMO.Message</span></span></span><br><span><var>os</var><span class="hyp-type"><b>: </b><span>list BaseELMO.Observation</span></span></span><br><span><var>a</var><span class="hyp-type"><b>: </b><span>Address</span></span></span><br><span><var>Hindm</var><span class="hyp-type"><b>: </b><span><span class="kr">‚àÄ</span> <span class="nv">dm</span> : Message,
  dm
  ‚àà set_map message
      (rec_obs_fn
         (state
            (message
               {| label := l; message := m |})))
  ‚Üî msg_dep_happens_before
      Message_dependencies dm
      {|
        state :=
          state
            (message
               {| label := l; message := m |})
      |}</span></span></span><br><span><var>Hindos</var><span class="hyp-type"><b>: </b><span><span class="kr">‚àÄ</span> <span class="nv">dm</span> : Message,
  dm
  ‚àà set_map message
      (rec_obs_fn {| obs := os; adr := a |})
  ‚Üî msg_dep_happens_before
      Message_dependencies dm
      {|
        state := {| obs := os; adr := a |}
      |}</span></span></span><br><span><var>o</var><span class="hyp-type"><b>: </b><span>BaseELMO.Observation</span></span></span><br><span><var>Hos</var><span class="hyp-type"><b>: </b><span>o ‚àà rec_obs_fn {| obs := os; adr := a |}</span></span></span><br><span><var>Hmos</var><span class="hyp-type"><b>: </b><span>msg_dep_happens_before Message_dependencies
  (message o)
  {| state := {| obs := os; adr := a |} |}</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">msg_dep_happens_before Message_dependencies
  (message o)
  {|
    state :=
      {|
        obs := {| label := l; message := m |} :: os;
        adr := a
      |}
  |}</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">      </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="BaseELMO-v-chkbc" style="display: none" type="checkbox"><label class="alectryon-input" for="BaseELMO-v-chkbc"><span class="nb">cut</span> (<span class="kr">forall</span> <span class="nv">dm</span>,
        msg_dep_rel Message_dependencies dm (MkMessage (MkState os a)) -&gt;
        msg_dep_rel Message_dependencies dm (MkMessage (MkState (MkObservation l m :: os) a))).</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>Address</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>EqDecision0</var><span class="hyp-type"><b>: </b><span>EqDecision Address</span></span></span><br><span><var>State</var><span><span class="hyp-body"><b>:= </b><span>BaseELMO.State</span></span><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span></span><br><span><var>Observation</var><span><span class="hyp-body"><b>:= </b><span>BaseELMO.Observation</span></span><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span></span><br><span><var>Message</var><span><span class="hyp-body"><b>:= </b><span>BaseELMO.Message</span></span><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span></span><br><span><var>s</var><span class="hyp-type"><b>: </b><span>BaseELMO.State</span></span></span><br><span><var>l</var><span class="hyp-type"><b>: </b><span>Label</span></span></span><br><span><var>m</var><span class="hyp-type"><b>: </b><span>BaseELMO.Message</span></span></span><br><span><var>os</var><span class="hyp-type"><b>: </b><span>list BaseELMO.Observation</span></span></span><br><span><var>a</var><span class="hyp-type"><b>: </b><span>Address</span></span></span><br><span><var>Hindm</var><span class="hyp-type"><b>: </b><span><span class="kr">‚àÄ</span> <span class="nv">dm</span> : Message,
  dm
  ‚àà set_map message
      (rec_obs_fn
         (state
            (message
               {| label := l; message := m |})))
  ‚Üî msg_dep_happens_before
      Message_dependencies dm
      {|
        state :=
          state
            (message
               {| label := l; message := m |})
      |}</span></span></span><br><span><var>Hindos</var><span class="hyp-type"><b>: </b><span><span class="kr">‚àÄ</span> <span class="nv">dm</span> : Message,
  dm
  ‚àà set_map message
      (rec_obs_fn {| obs := os; adr := a |})
  ‚Üî msg_dep_happens_before
      Message_dependencies dm
      {|
        state := {| obs := os; adr := a |}
      |}</span></span></span><br><span><var>o</var><span class="hyp-type"><b>: </b><span>BaseELMO.Observation</span></span></span><br><span><var>Hos</var><span class="hyp-type"><b>: </b><span>o ‚àà rec_obs_fn {| obs := os; adr := a |}</span></span></span><br><span><var>Hmos</var><span class="hyp-type"><b>: </b><span>msg_dep_happens_before Message_dependencies
  (message o)
  {| state := {| obs := os; adr := a |} |}</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">(<span class="kr">‚àÄ</span> <span class="nv">dm</span> : Message,
   msg_dep_rel Message_dependencies dm
     {| state := {| obs := os; adr := a |} |}
   ‚Üí msg_dep_rel Message_dependencies dm
       {|
         state :=
           {|
             obs :=
               {| label := l; message := m |} :: os;
             adr := a
           |}
       |})
‚Üí msg_dep_happens_before Message_dependencies
    (message o)
    {|
      state :=
        {|
          obs := {| label := l; message := m |} :: os;
          adr := a
        |}
    |}</div></blockquote><div class="alectryon-extra-goals"><input class="alectryon-extra-goal-toggle" id="BaseELMO-v-chkbd" style="display: none" type="checkbox"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>Address</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>EqDecision0</var><span class="hyp-type"><b>: </b><span>EqDecision Address</span></span></span><br><span><var>State</var><span><span class="hyp-body"><b>:= </b><span>BaseELMO.State</span></span><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span></span><br><span><var>Observation</var><span><span class="hyp-body"><b>:= </b><span>BaseELMO.Observation</span></span><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span></span><br><span><var>Message</var><span><span class="hyp-body"><b>:= </b><span>BaseELMO.Message</span></span><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span></span><br><span><var>s</var><span class="hyp-type"><b>: </b><span>BaseELMO.State</span></span></span><br><span><var>l</var><span class="hyp-type"><b>: </b><span>Label</span></span></span><br><span><var>m</var><span class="hyp-type"><b>: </b><span>BaseELMO.Message</span></span></span><br><span><var>os</var><span class="hyp-type"><b>: </b><span>list BaseELMO.Observation</span></span></span><br><span><var>a</var><span class="hyp-type"><b>: </b><span>Address</span></span></span><br><span><var>Hindm</var><span class="hyp-type"><b>: </b><span><span class="kr">‚àÄ</span> <span class="nv">dm</span> : Message,
  dm
  ‚àà set_map message
      (rec_obs_fn
         (state
            (message
               {| label := l; message := m |})))
  ‚Üî msg_dep_happens_before
      Message_dependencies dm
      {|
        state :=
          state
            (message
               {| label := l; message := m |})
      |}</span></span></span><br><span><var>Hindos</var><span class="hyp-type"><b>: </b><span><span class="kr">‚àÄ</span> <span class="nv">dm</span> : Message,
  dm
  ‚àà set_map message
      (rec_obs_fn {| obs := os; adr := a |})
  ‚Üî msg_dep_happens_before
      Message_dependencies dm
      {|
        state := {| obs := os; adr := a |}
      |}</span></span></span><br><span><var>o</var><span class="hyp-type"><b>: </b><span>BaseELMO.Observation</span></span></span><br><span><var>Hos</var><span class="hyp-type"><b>: </b><span>o ‚àà rec_obs_fn {| obs := os; adr := a |}</span></span></span><br><span><var>Hmos</var><span class="hyp-type"><b>: </b><span>msg_dep_happens_before Message_dependencies
  (message o)
  {| state := {| obs := os; adr := a |} |}</span></span></span><br></div><label class="goal-separator" for="BaseELMO-v-chkbd"><hr></label><div class="goal-conclusion"><span class="kr">‚àÄ</span> <span class="nv">dm</span> : Message,
  msg_dep_rel Message_dependencies dm
    {| state := {| obs := os; adr := a |} |}
  ‚Üí msg_dep_rel Message_dependencies dm
      {|
        state :=
          {|
            obs :=
              {| label := l; message := m |} :: os;
            adr := a
          |}
      |}</div></blockquote></div></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">      </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="BaseELMO-v-chkbe" style="display: none" type="checkbox"><label class="alectryon-input" for="BaseELMO-v-chkbe">{</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>Address</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>EqDecision0</var><span class="hyp-type"><b>: </b><span>EqDecision Address</span></span></span><br><span><var>State</var><span><span class="hyp-body"><b>:= </b><span>BaseELMO.State</span></span><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span></span><br><span><var>Observation</var><span><span class="hyp-body"><b>:= </b><span>BaseELMO.Observation</span></span><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span></span><br><span><var>Message</var><span><span class="hyp-body"><b>:= </b><span>BaseELMO.Message</span></span><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span></span><br><span><var>s</var><span class="hyp-type"><b>: </b><span>BaseELMO.State</span></span></span><br><span><var>l</var><span class="hyp-type"><b>: </b><span>Label</span></span></span><br><span><var>m</var><span class="hyp-type"><b>: </b><span>BaseELMO.Message</span></span></span><br><span><var>os</var><span class="hyp-type"><b>: </b><span>list BaseELMO.Observation</span></span></span><br><span><var>a</var><span class="hyp-type"><b>: </b><span>Address</span></span></span><br><span><var>Hindm</var><span class="hyp-type"><b>: </b><span><span class="kr">‚àÄ</span> <span class="nv">dm</span> : Message,
  dm
  ‚àà set_map message
      (rec_obs_fn
         (state
            (message
               {| label := l; message := m |})))
  ‚Üî msg_dep_happens_before
      Message_dependencies dm
      {|
        state :=
          state
            (message
               {| label := l; message := m |})
      |}</span></span></span><br><span><var>Hindos</var><span class="hyp-type"><b>: </b><span><span class="kr">‚àÄ</span> <span class="nv">dm</span> : Message,
  dm
  ‚àà set_map message
      (rec_obs_fn {| obs := os; adr := a |})
  ‚Üî msg_dep_happens_before
      Message_dependencies dm
      {|
        state := {| obs := os; adr := a |}
      |}</span></span></span><br><span><var>o</var><span class="hyp-type"><b>: </b><span>BaseELMO.Observation</span></span></span><br><span><var>Hos</var><span class="hyp-type"><b>: </b><span>o ‚àà rec_obs_fn {| obs := os; adr := a |}</span></span></span><br><span><var>Hmos</var><span class="hyp-type"><b>: </b><span>msg_dep_happens_before Message_dependencies
  (message o)
  {| state := {| obs := os; adr := a |} |}</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">(<span class="kr">‚àÄ</span> <span class="nv">dm</span> : Message,
   msg_dep_rel Message_dependencies dm
     {| state := {| obs := os; adr := a |} |}
   ‚Üí msg_dep_rel Message_dependencies dm
       {|
         state :=
           {|
             obs :=
               {| label := l; message := m |} :: os;
             adr := a
           |}
       |})
‚Üí msg_dep_happens_before Message_dependencies
    (message o)
    {|
      state :=
        {|
          obs := {| label := l; message := m |} :: os;
          adr := a
        |}
    |}</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">        </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="BaseELMO-v-chkbf" style="display: none" type="checkbox"><label class="alectryon-input" for="BaseELMO-v-chkbf"><span class="nb">intro</span> Hext; <span class="nb">apply</span> msg_dep_happens_before_iff_one.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>Address</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>EqDecision0</var><span class="hyp-type"><b>: </b><span>EqDecision Address</span></span></span><br><span><var>State</var><span><span class="hyp-body"><b>:= </b><span>BaseELMO.State</span></span><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span></span><br><span><var>Observation</var><span><span class="hyp-body"><b>:= </b><span>BaseELMO.Observation</span></span><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span></span><br><span><var>Message</var><span><span class="hyp-body"><b>:= </b><span>BaseELMO.Message</span></span><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span></span><br><span><var>s</var><span class="hyp-type"><b>: </b><span>BaseELMO.State</span></span></span><br><span><var>l</var><span class="hyp-type"><b>: </b><span>Label</span></span></span><br><span><var>m</var><span class="hyp-type"><b>: </b><span>BaseELMO.Message</span></span></span><br><span><var>os</var><span class="hyp-type"><b>: </b><span>list BaseELMO.Observation</span></span></span><br><span><var>a</var><span class="hyp-type"><b>: </b><span>Address</span></span></span><br><span><var>Hindm</var><span class="hyp-type"><b>: </b><span><span class="kr">‚àÄ</span> <span class="nv">dm</span> : Message,
  dm
  ‚àà set_map message
      (rec_obs_fn
         (state
            (message
               {| label := l; message := m |})))
  ‚Üî msg_dep_happens_before
      Message_dependencies dm
      {|
        state :=
          state
            (message
               {| label := l; message := m |})
      |}</span></span></span><br><span><var>Hindos</var><span class="hyp-type"><b>: </b><span><span class="kr">‚àÄ</span> <span class="nv">dm</span> : Message,
  dm
  ‚àà set_map message
      (rec_obs_fn {| obs := os; adr := a |})
  ‚Üî msg_dep_happens_before
      Message_dependencies dm
      {|
        state := {| obs := os; adr := a |}
      |}</span></span></span><br><span><var>o</var><span class="hyp-type"><b>: </b><span>BaseELMO.Observation</span></span></span><br><span><var>Hos</var><span class="hyp-type"><b>: </b><span>o ‚àà rec_obs_fn {| obs := os; adr := a |}</span></span></span><br><span><var>Hmos</var><span class="hyp-type"><b>: </b><span>msg_dep_happens_before Message_dependencies
  (message o)
  {| state := {| obs := os; adr := a |} |}</span></span></span><br><span><var>Hext</var><span class="hyp-type"><b>: </b><span><span class="kr">‚àÄ</span> <span class="nv">dm</span> : Message,
  msg_dep_rel Message_dependencies dm
    {| state := {| obs := os; adr := a |} |}
  ‚Üí msg_dep_rel Message_dependencies dm
      {|
        state :=
          {|
            obs :=
              {| label := l; message := m |}
              :: os;
            adr := a
          |}
      |}</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">msg_dep_rel Message_dependencies (message o)
  {|
    state :=
      {|
        obs := {| label := l; message := m |} :: os;
        adr := a
      |}
  |}
‚à® (<span class="kr">‚àÉ</span> <span class="nv">y</span> : Message,
     msg_dep_happens_before Message_dependencies
       (message o) y
     ‚àß msg_dep_rel Message_dependencies y
         {|
           state :=
             {|
               obs :=
                 {| label := l; message := m |} :: os;
               adr := a
             |}
         |})</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">        </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="BaseELMO-v-chkc0" style="display: none" type="checkbox"><label class="alectryon-input" for="BaseELMO-v-chkc0"><span class="nb">apply</span> msg_dep_happens_before_iff_one <span class="kr">in</span> Hmos <span class="kr">as</span> [Hdep | (dm &amp; Hhb &amp; Hdep)].</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>Address</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>EqDecision0</var><span class="hyp-type"><b>: </b><span>EqDecision Address</span></span></span><br><span><var>State</var><span><span class="hyp-body"><b>:= </b><span>BaseELMO.State</span></span><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span></span><br><span><var>Observation</var><span><span class="hyp-body"><b>:= </b><span>BaseELMO.Observation</span></span><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span></span><br><span><var>Message</var><span><span class="hyp-body"><b>:= </b><span>BaseELMO.Message</span></span><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span></span><br><span><var>s</var><span class="hyp-type"><b>: </b><span>BaseELMO.State</span></span></span><br><span><var>l</var><span class="hyp-type"><b>: </b><span>Label</span></span></span><br><span><var>m</var><span class="hyp-type"><b>: </b><span>BaseELMO.Message</span></span></span><br><span><var>os</var><span class="hyp-type"><b>: </b><span>list BaseELMO.Observation</span></span></span><br><span><var>a</var><span class="hyp-type"><b>: </b><span>Address</span></span></span><br><span><var>Hindm</var><span class="hyp-type"><b>: </b><span><span class="kr">‚àÄ</span> <span class="nv">dm</span> : Message,
  dm
  ‚àà set_map message
      (rec_obs_fn
         (state
            (message
               {| label := l; message := m |})))
  ‚Üî msg_dep_happens_before
      Message_dependencies dm
      {|
        state :=
          state
            (message
               {| label := l; message := m |})
      |}</span></span></span><br><span><var>Hindos</var><span class="hyp-type"><b>: </b><span><span class="kr">‚àÄ</span> <span class="nv">dm</span> : Message,
  dm
  ‚àà set_map message
      (rec_obs_fn {| obs := os; adr := a |})
  ‚Üî msg_dep_happens_before
      Message_dependencies dm
      {|
        state := {| obs := os; adr := a |}
      |}</span></span></span><br><span><var>o</var><span class="hyp-type"><b>: </b><span>BaseELMO.Observation</span></span></span><br><span><var>Hos</var><span class="hyp-type"><b>: </b><span>o ‚àà rec_obs_fn {| obs := os; adr := a |}</span></span></span><br><span><var>Hdep</var><span class="hyp-type"><b>: </b><span>msg_dep_rel Message_dependencies 
  (message o)
  {| state := {| obs := os; adr := a |} |}</span></span></span><br><span><var>Hext</var><span class="hyp-type"><b>: </b><span><span class="kr">‚àÄ</span> <span class="nv">dm</span> : Message,
  msg_dep_rel Message_dependencies dm
    {| state := {| obs := os; adr := a |} |}
  ‚Üí msg_dep_rel Message_dependencies dm
      {|
        state :=
          {|
            obs :=
              {| label := l; message := m |}
              :: os;
            adr := a
          |}
      |}</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">msg_dep_rel Message_dependencies (message o)
  {|
    state :=
      {|
        obs := {| label := l; message := m |} :: os;
        adr := a
      |}
  |}
‚à® (<span class="kr">‚àÉ</span> <span class="nv">y</span> : Message,
     msg_dep_happens_before Message_dependencies
       (message o) y
     ‚àß msg_dep_rel Message_dependencies y
         {|
           state :=
             {|
               obs :=
                 {| label := l; message := m |} :: os;
               adr := a
             |}
         |})</div></blockquote><div class="alectryon-extra-goals"><input class="alectryon-extra-goal-toggle" id="BaseELMO-v-chkc1" style="display: none" type="checkbox"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>Address</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>EqDecision0</var><span class="hyp-type"><b>: </b><span>EqDecision Address</span></span></span><br><span><var>State</var><span><span class="hyp-body"><b>:= </b><span>BaseELMO.State</span></span><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span></span><br><span><var>Observation</var><span><span class="hyp-body"><b>:= </b><span>BaseELMO.Observation</span></span><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span></span><br><span><var>Message</var><span><span class="hyp-body"><b>:= </b><span>BaseELMO.Message</span></span><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span></span><br><span><var>s</var><span class="hyp-type"><b>: </b><span>BaseELMO.State</span></span></span><br><span><var>l</var><span class="hyp-type"><b>: </b><span>Label</span></span></span><br><span><var>m</var><span class="hyp-type"><b>: </b><span>BaseELMO.Message</span></span></span><br><span><var>os</var><span class="hyp-type"><b>: </b><span>list BaseELMO.Observation</span></span></span><br><span><var>a</var><span class="hyp-type"><b>: </b><span>Address</span></span></span><br><span><var>Hindm</var><span class="hyp-type"><b>: </b><span><span class="kr">‚àÄ</span> <span class="nv">dm</span> : Message,
  dm
  ‚àà set_map message
      (rec_obs_fn
         (state
            (message
               {| label := l; message := m |})))
  ‚Üî msg_dep_happens_before
      Message_dependencies dm
      {|
        state :=
          state
            (message
               {| label := l; message := m |})
      |}</span></span></span><br><span><var>Hindos</var><span class="hyp-type"><b>: </b><span><span class="kr">‚àÄ</span> <span class="nv">dm</span> : Message,
  dm
  ‚àà set_map message
      (rec_obs_fn {| obs := os; adr := a |})
  ‚Üî msg_dep_happens_before
      Message_dependencies dm
      {|
        state := {| obs := os; adr := a |}
      |}</span></span></span><br><span><var>o</var><span class="hyp-type"><b>: </b><span>BaseELMO.Observation</span></span></span><br><span><var>Hos</var><span class="hyp-type"><b>: </b><span>o ‚àà rec_obs_fn {| obs := os; adr := a |}</span></span></span><br><span><var>dm</var><span class="hyp-type"><b>: </b><span>Message</span></span></span><br><span><var>Hhb</var><span class="hyp-type"><b>: </b><span>msg_dep_happens_before Message_dependencies
  (message o) dm</span></span></span><br><span><var>Hdep</var><span class="hyp-type"><b>: </b><span>msg_dep_rel Message_dependencies dm
  {| state := {| obs := os; adr := a |} |}</span></span></span><br><span><var>Hext</var><span class="hyp-type"><b>: </b><span><span class="kr">‚àÄ</span> <span class="nv">dm</span> : Message,
  msg_dep_rel Message_dependencies dm
    {| state := {| obs := os; adr := a |} |}
  ‚Üí msg_dep_rel Message_dependencies dm
      {|
        state :=
          {|
            obs :=
              {| label := l; message := m |}
              :: os;
            adr := a
          |}
      |}</span></span></span><br></div><label class="goal-separator" for="BaseELMO-v-chkc1"><hr></label><div class="goal-conclusion">msg_dep_rel Message_dependencies 
  (message o)
  {|
    state :=
      {|
        obs := {| label := l; message := m |} :: os;
        adr := a
      |}
  |}
‚à® (<span class="kr">‚àÉ</span> <span class="nv">y</span> : Message,
     msg_dep_happens_before Message_dependencies
       (message o) y
     ‚àß msg_dep_rel Message_dependencies y
         {|
           state :=
             {|
               obs :=
                 {| label := l; message := m |} :: os;
               adr := a
             |}
         |})</div></blockquote></div></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">        </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="BaseELMO-v-chkc2" style="display: none" type="checkbox"><label class="alectryon-input" for="BaseELMO-v-chkc2">-</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>Address</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>EqDecision0</var><span class="hyp-type"><b>: </b><span>EqDecision Address</span></span></span><br><span><var>State</var><span><span class="hyp-body"><b>:= </b><span>BaseELMO.State</span></span><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span></span><br><span><var>Observation</var><span><span class="hyp-body"><b>:= </b><span>BaseELMO.Observation</span></span><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span></span><br><span><var>Message</var><span><span class="hyp-body"><b>:= </b><span>BaseELMO.Message</span></span><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span></span><br><span><var>s</var><span class="hyp-type"><b>: </b><span>BaseELMO.State</span></span></span><br><span><var>l</var><span class="hyp-type"><b>: </b><span>Label</span></span></span><br><span><var>m</var><span class="hyp-type"><b>: </b><span>BaseELMO.Message</span></span></span><br><span><var>os</var><span class="hyp-type"><b>: </b><span>list BaseELMO.Observation</span></span></span><br><span><var>a</var><span class="hyp-type"><b>: </b><span>Address</span></span></span><br><span><var>Hindm</var><span class="hyp-type"><b>: </b><span><span class="kr">‚àÄ</span> <span class="nv">dm</span> : Message,
  dm
  ‚àà set_map message
      (rec_obs_fn
         (state
            (message
               {| label := l; message := m |})))
  ‚Üî msg_dep_happens_before
      Message_dependencies dm
      {|
        state :=
          state
            (message
               {| label := l; message := m |})
      |}</span></span></span><br><span><var>Hindos</var><span class="hyp-type"><b>: </b><span><span class="kr">‚àÄ</span> <span class="nv">dm</span> : Message,
  dm
  ‚àà set_map message
      (rec_obs_fn {| obs := os; adr := a |})
  ‚Üî msg_dep_happens_before
      Message_dependencies dm
      {|
        state := {| obs := os; adr := a |}
      |}</span></span></span><br><span><var>o</var><span class="hyp-type"><b>: </b><span>BaseELMO.Observation</span></span></span><br><span><var>Hos</var><span class="hyp-type"><b>: </b><span>o ‚àà rec_obs_fn {| obs := os; adr := a |}</span></span></span><br><span><var>Hdep</var><span class="hyp-type"><b>: </b><span>msg_dep_rel Message_dependencies 
  (message o)
  {| state := {| obs := os; adr := a |} |}</span></span></span><br><span><var>Hext</var><span class="hyp-type"><b>: </b><span><span class="kr">‚àÄ</span> <span class="nv">dm</span> : Message,
  msg_dep_rel Message_dependencies dm
    {| state := {| obs := os; adr := a |} |}
  ‚Üí msg_dep_rel Message_dependencies dm
      {|
        state :=
          {|
            obs :=
              {| label := l; message := m |}
              :: os;
            adr := a
          |}
      |}</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">msg_dep_rel Message_dependencies (message o)
  {|
    state :=
      {|
        obs := {| label := l; message := m |} :: os;
        adr := a
      |}
  |}
‚à® (<span class="kr">‚àÉ</span> <span class="nv">y</span> : Message,
     msg_dep_happens_before Message_dependencies
       (message o) y
     ‚àß msg_dep_rel Message_dependencies y
         {|
           state :=
             {|
               obs :=
                 {| label := l; message := m |} :: os;
               adr := a
             |}
         |})</div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="bp">by</span> <span class="nb">left</span>; <span class="nb">apply</span> Hext.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">        </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="BaseELMO-v-chkc3" style="display: none" type="checkbox"><label class="alectryon-input" for="BaseELMO-v-chkc3">-</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>Address</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>EqDecision0</var><span class="hyp-type"><b>: </b><span>EqDecision Address</span></span></span><br><span><var>State</var><span><span class="hyp-body"><b>:= </b><span>BaseELMO.State</span></span><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span></span><br><span><var>Observation</var><span><span class="hyp-body"><b>:= </b><span>BaseELMO.Observation</span></span><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span></span><br><span><var>Message</var><span><span class="hyp-body"><b>:= </b><span>BaseELMO.Message</span></span><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span></span><br><span><var>s</var><span class="hyp-type"><b>: </b><span>BaseELMO.State</span></span></span><br><span><var>l</var><span class="hyp-type"><b>: </b><span>Label</span></span></span><br><span><var>m</var><span class="hyp-type"><b>: </b><span>BaseELMO.Message</span></span></span><br><span><var>os</var><span class="hyp-type"><b>: </b><span>list BaseELMO.Observation</span></span></span><br><span><var>a</var><span class="hyp-type"><b>: </b><span>Address</span></span></span><br><span><var>Hindm</var><span class="hyp-type"><b>: </b><span><span class="kr">‚àÄ</span> <span class="nv">dm</span> : Message,
  dm
  ‚àà set_map message
      (rec_obs_fn
         (state
            (message
               {| label := l; message := m |})))
  ‚Üî msg_dep_happens_before
      Message_dependencies dm
      {|
        state :=
          state
            (message
               {| label := l; message := m |})
      |}</span></span></span><br><span><var>Hindos</var><span class="hyp-type"><b>: </b><span><span class="kr">‚àÄ</span> <span class="nv">dm</span> : Message,
  dm
  ‚àà set_map message
      (rec_obs_fn {| obs := os; adr := a |})
  ‚Üî msg_dep_happens_before
      Message_dependencies dm
      {|
        state := {| obs := os; adr := a |}
      |}</span></span></span><br><span><var>o</var><span class="hyp-type"><b>: </b><span>BaseELMO.Observation</span></span></span><br><span><var>Hos</var><span class="hyp-type"><b>: </b><span>o ‚àà rec_obs_fn {| obs := os; adr := a |}</span></span></span><br><span><var>dm</var><span class="hyp-type"><b>: </b><span>Message</span></span></span><br><span><var>Hhb</var><span class="hyp-type"><b>: </b><span>msg_dep_happens_before Message_dependencies
  (message o) dm</span></span></span><br><span><var>Hdep</var><span class="hyp-type"><b>: </b><span>msg_dep_rel Message_dependencies dm
  {| state := {| obs := os; adr := a |} |}</span></span></span><br><span><var>Hext</var><span class="hyp-type"><b>: </b><span><span class="kr">‚àÄ</span> <span class="nv">dm</span> : Message,
  msg_dep_rel Message_dependencies dm
    {| state := {| obs := os; adr := a |} |}
  ‚Üí msg_dep_rel Message_dependencies dm
      {|
        state :=
          {|
            obs :=
              {| label := l; message := m |}
              :: os;
            adr := a
          |}
      |}</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">msg_dep_rel Message_dependencies (message o)
  {|
    state :=
      {|
        obs := {| label := l; message := m |} :: os;
        adr := a
      |}
  |}
‚à® (<span class="kr">‚àÉ</span> <span class="nv">y</span> : Message,
     msg_dep_happens_before Message_dependencies
       (message o) y
     ‚àß msg_dep_rel Message_dependencies y
         {|
           state :=
             {|
               obs :=
                 {| label := l; message := m |} :: os;
               adr := a
             |}
         |})</div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="bp">by</span> <span class="nb">right</span>; <span class="nb">eexists</span>; <span class="nb">split</span>; [| <span class="nb">apply</span> Hext].</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">      </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="BaseELMO-v-chkc4" style="display: none" type="checkbox"><label class="alectryon-input" for="BaseELMO-v-chkc4">}</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>Address</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>EqDecision0</var><span class="hyp-type"><b>: </b><span>EqDecision Address</span></span></span><br><span><var>State</var><span><span class="hyp-body"><b>:= </b><span>BaseELMO.State</span></span><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span></span><br><span><var>Observation</var><span><span class="hyp-body"><b>:= </b><span>BaseELMO.Observation</span></span><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span></span><br><span><var>Message</var><span><span class="hyp-body"><b>:= </b><span>BaseELMO.Message</span></span><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span></span><br><span><var>s</var><span class="hyp-type"><b>: </b><span>BaseELMO.State</span></span></span><br><span><var>l</var><span class="hyp-type"><b>: </b><span>Label</span></span></span><br><span><var>m</var><span class="hyp-type"><b>: </b><span>BaseELMO.Message</span></span></span><br><span><var>os</var><span class="hyp-type"><b>: </b><span>list BaseELMO.Observation</span></span></span><br><span><var>a</var><span class="hyp-type"><b>: </b><span>Address</span></span></span><br><span><var>Hindm</var><span class="hyp-type"><b>: </b><span><span class="kr">‚àÄ</span> <span class="nv">dm</span> : Message,
  dm
  ‚àà set_map message
      (rec_obs_fn
         (state
            (message
               {| label := l; message := m |})))
  ‚Üî msg_dep_happens_before
      Message_dependencies dm
      {|
        state :=
          state
            (message
               {| label := l; message := m |})
      |}</span></span></span><br><span><var>Hindos</var><span class="hyp-type"><b>: </b><span><span class="kr">‚àÄ</span> <span class="nv">dm</span> : Message,
  dm
  ‚àà set_map message
      (rec_obs_fn {| obs := os; adr := a |})
  ‚Üî msg_dep_happens_before
      Message_dependencies dm
      {|
        state := {| obs := os; adr := a |}
      |}</span></span></span><br><span><var>o</var><span class="hyp-type"><b>: </b><span>BaseELMO.Observation</span></span></span><br><span><var>Hos</var><span class="hyp-type"><b>: </b><span>o ‚àà rec_obs_fn {| obs := os; adr := a |}</span></span></span><br><span><var>Hmos</var><span class="hyp-type"><b>: </b><span>msg_dep_happens_before Message_dependencies
  (message o)
  {| state := {| obs := os; adr := a |} |}</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="kr">‚àÄ</span> <span class="nv">dm</span> : Message,
  msg_dep_rel Message_dependencies dm
    {| state := {| obs := os; adr := a |} |}
  ‚Üí msg_dep_rel Message_dependencies dm
      {|
        state :=
          {|
            obs :=
              {| label := l; message := m |} :: os;
            adr := a
          |}
      |}</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">      </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="BaseELMO-v-chkc5" style="display: none" type="checkbox"><label class="alectryon-input" for="BaseELMO-v-chkc5"><span class="nb">unfold</span> msg_dep_rel; <span class="nb">cbn</span>.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>Address</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>EqDecision0</var><span class="hyp-type"><b>: </b><span>EqDecision Address</span></span></span><br><span><var>State</var><span><span class="hyp-body"><b>:= </b><span>BaseELMO.State</span></span><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span></span><br><span><var>Observation</var><span><span class="hyp-body"><b>:= </b><span>BaseELMO.Observation</span></span><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span></span><br><span><var>Message</var><span><span class="hyp-body"><b>:= </b><span>BaseELMO.Message</span></span><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span></span><br><span><var>s</var><span class="hyp-type"><b>: </b><span>BaseELMO.State</span></span></span><br><span><var>l</var><span class="hyp-type"><b>: </b><span>Label</span></span></span><br><span><var>m</var><span class="hyp-type"><b>: </b><span>BaseELMO.Message</span></span></span><br><span><var>os</var><span class="hyp-type"><b>: </b><span>list BaseELMO.Observation</span></span></span><br><span><var>a</var><span class="hyp-type"><b>: </b><span>Address</span></span></span><br><span><var>Hindm</var><span class="hyp-type"><b>: </b><span><span class="kr">‚àÄ</span> <span class="nv">dm</span> : Message,
  dm
  ‚àà set_map message
      (rec_obs_fn
         (state
            (message
               {| label := l; message := m |})))
  ‚Üî msg_dep_happens_before
      Message_dependencies dm
      {|
        state :=
          state
            (message
               {| label := l; message := m |})
      |}</span></span></span><br><span><var>Hindos</var><span class="hyp-type"><b>: </b><span><span class="kr">‚àÄ</span> <span class="nv">dm</span> : Message,
  dm
  ‚àà set_map message
      (rec_obs_fn {| obs := os; adr := a |})
  ‚Üî msg_dep_happens_before
      Message_dependencies dm
      {|
        state := {| obs := os; adr := a |}
      |}</span></span></span><br><span><var>o</var><span class="hyp-type"><b>: </b><span>BaseELMO.Observation</span></span></span><br><span><var>Hos</var><span class="hyp-type"><b>: </b><span>o ‚àà rec_obs_fn {| obs := os; adr := a |}</span></span></span><br><span><var>Hmos</var><span class="hyp-type"><b>: </b><span>msg_dep_happens_before Message_dependencies
  (message o)
  {| state := {| obs := os; adr := a |} |}</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="kr">‚àÄ</span> <span class="nv">dm</span> : Message,
  dm ‚àà list_to_set (map message os)
  ‚Üí dm ‚àà {[m]} ‚à™ list_to_set (map message os)</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">      </span><span class="alectryon-sentence"><span class="alectryon-input"><span class="bp">by</span> <span class="nb">intros</span> dm; <span class="nb">rewrite</span> elem_of_union; <span class="nb">right</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="BaseELMO-v-chkc6" style="display: none" type="checkbox"><label class="alectryon-input" for="BaseELMO-v-chkc6">-</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>Address</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>EqDecision0</var><span class="hyp-type"><b>: </b><span>EqDecision Address</span></span></span><br><span><var>State</var><span><span class="hyp-body"><b>:= </b><span>BaseELMO.State</span></span><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span></span><br><span><var>Observation</var><span><span class="hyp-body"><b>:= </b><span>BaseELMO.Observation</span></span><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span></span><br><span><var>Message</var><span><span class="hyp-body"><b>:= </b><span>BaseELMO.Message</span></span><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span></span><br><span><var>s</var><span class="hyp-type"><b>: </b><span>BaseELMO.State</span></span></span><br><span><var>l</var><span class="hyp-type"><b>: </b><span>Label</span></span></span><br><span><var>m</var><span class="hyp-type"><b>: </b><span>BaseELMO.Message</span></span></span><br><span><var>os</var><span class="hyp-type"><b>: </b><span>list BaseELMO.Observation</span></span></span><br><span><var>a</var><span class="hyp-type"><b>: </b><span>Address</span></span></span><br><span><var>Hindm</var><span class="hyp-type"><b>: </b><span><span class="kr">‚àÄ</span> <span class="nv">dm</span> : Message,
  dm
  ‚àà set_map message
      (rec_obs_fn
         (state
            (message
               {| label := l; message := m |})))
  ‚Üî msg_dep_happens_before
      Message_dependencies dm
      {|
        state :=
          state
            (message
               {| label := l; message := m |})
      |}</span></span></span><br><span><var>Hindos</var><span class="hyp-type"><b>: </b><span><span class="kr">‚àÄ</span> <span class="nv">dm</span> : Message,
  dm
  ‚àà set_map message
      (rec_obs_fn {| obs := os; adr := a |})
  ‚Üî msg_dep_happens_before
      Message_dependencies dm
      {|
        state := {| obs := os; adr := a |}
      |}</span></span></span><br><span><var>dm</var><span class="hyp-type"><b>: </b><span>Message</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">msg_dep_happens_before Message_dependencies dm
  {|
    state :=
      {|
        obs := {| label := l; message := m |} :: os;
        adr := a
      |}
  |}
‚Üí dm
  ‚àà set_map message
      ({[{| label := l; message := m |}]}
       ‚à™ rec_obs_fn
           (state
              (message {| label := l; message := m |}))
       ‚à™ rec_obs_fn {| obs := os; adr := a |})</div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="BaseELMO-v-chkc7" style="display: none" type="checkbox"><label class="alectryon-input" for="BaseELMO-v-chkc7"><span class="nb">intros</span> Hb; <span class="nb">apply</span> elem_of_map.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>Address</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>EqDecision0</var><span class="hyp-type"><b>: </b><span>EqDecision Address</span></span></span><br><span><var>State</var><span><span class="hyp-body"><b>:= </b><span>BaseELMO.State</span></span><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span></span><br><span><var>Observation</var><span><span class="hyp-body"><b>:= </b><span>BaseELMO.Observation</span></span><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span></span><br><span><var>Message</var><span><span class="hyp-body"><b>:= </b><span>BaseELMO.Message</span></span><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span></span><br><span><var>s</var><span class="hyp-type"><b>: </b><span>BaseELMO.State</span></span></span><br><span><var>l</var><span class="hyp-type"><b>: </b><span>Label</span></span></span><br><span><var>m</var><span class="hyp-type"><b>: </b><span>BaseELMO.Message</span></span></span><br><span><var>os</var><span class="hyp-type"><b>: </b><span>list BaseELMO.Observation</span></span></span><br><span><var>a</var><span class="hyp-type"><b>: </b><span>Address</span></span></span><br><span><var>Hindm</var><span class="hyp-type"><b>: </b><span><span class="kr">‚àÄ</span> <span class="nv">dm</span> : Message,
  dm
  ‚àà set_map message
      (rec_obs_fn
         (state
            (message
               {| label := l; message := m |})))
  ‚Üî msg_dep_happens_before
      Message_dependencies dm
      {|
        state :=
          state
            (message
               {| label := l; message := m |})
      |}</span></span></span><br><span><var>Hindos</var><span class="hyp-type"><b>: </b><span><span class="kr">‚àÄ</span> <span class="nv">dm</span> : Message,
  dm
  ‚àà set_map message
      (rec_obs_fn {| obs := os; adr := a |})
  ‚Üî msg_dep_happens_before
      Message_dependencies dm
      {|
        state := {| obs := os; adr := a |}
      |}</span></span></span><br><span><var>dm</var><span class="hyp-type"><b>: </b><span>Message</span></span></span><br><span><var>Hb</var><span class="hyp-type"><b>: </b><span>msg_dep_happens_before Message_dependencies dm
  {|
    state :=
      {|
        obs :=
          {| label := l; message := m |} :: os;
        adr := a
      |}
  |}</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="kr">‚àÉ</span> <span class="nv">x</span> : BaseELMO.Observation,
  dm = message x
  ‚àß x
    ‚àà {[{| label := l; message := m |}]}
      ‚à™ rec_obs_fn
          (state
             (message {| label := l; message := m |}))
      ‚à™ rec_obs_fn {| obs := os; adr := a |}</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="BaseELMO-v-chkc8" style="display: none" type="checkbox"><label class="alectryon-input" for="BaseELMO-v-chkc8"><span class="kp">do</span> <span class="mi">2</span> <span class="nb">setoid_rewrite</span> elem_of_union; <span class="nb">setoid_rewrite</span> elem_of_singleton; <span class="nb">cbn</span>.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>Address</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>EqDecision0</var><span class="hyp-type"><b>: </b><span>EqDecision Address</span></span></span><br><span><var>State</var><span><span class="hyp-body"><b>:= </b><span>BaseELMO.State</span></span><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span></span><br><span><var>Observation</var><span><span class="hyp-body"><b>:= </b><span>BaseELMO.Observation</span></span><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span></span><br><span><var>Message</var><span><span class="hyp-body"><b>:= </b><span>BaseELMO.Message</span></span><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span></span><br><span><var>s</var><span class="hyp-type"><b>: </b><span>BaseELMO.State</span></span></span><br><span><var>l</var><span class="hyp-type"><b>: </b><span>Label</span></span></span><br><span><var>m</var><span class="hyp-type"><b>: </b><span>BaseELMO.Message</span></span></span><br><span><var>os</var><span class="hyp-type"><b>: </b><span>list BaseELMO.Observation</span></span></span><br><span><var>a</var><span class="hyp-type"><b>: </b><span>Address</span></span></span><br><span><var>Hindm</var><span class="hyp-type"><b>: </b><span><span class="kr">‚àÄ</span> <span class="nv">dm</span> : Message,
  dm
  ‚àà set_map message
      (rec_obs_fn
         (state
            (message
               {| label := l; message := m |})))
  ‚Üî msg_dep_happens_before
      Message_dependencies dm
      {|
        state :=
          state
            (message
               {| label := l; message := m |})
      |}</span></span></span><br><span><var>Hindos</var><span class="hyp-type"><b>: </b><span><span class="kr">‚àÄ</span> <span class="nv">dm</span> : Message,
  dm
  ‚àà set_map message
      (rec_obs_fn {| obs := os; adr := a |})
  ‚Üî msg_dep_happens_before
      Message_dependencies dm
      {|
        state := {| obs := os; adr := a |}
      |}</span></span></span><br><span><var>dm</var><span class="hyp-type"><b>: </b><span>Message</span></span></span><br><span><var>Hb</var><span class="hyp-type"><b>: </b><span>msg_dep_happens_before Message_dependencies dm
  {|
    state :=
      {|
        obs :=
          {| label := l; message := m |} :: os;
        adr := a
      |}
  |}</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="kr">‚àÉ</span> <span class="nv">x</span> : BaseELMO.Observation,
  dm = message x
  ‚àß ((x = {| label := l; message := m |}
      ‚à® x ‚àà rec_obs_fn (state m))
     ‚à® x ‚àà rec_obs_fn {| obs := os; adr := a |})</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="BaseELMO-v-chkc9" style="display: none" type="checkbox"><label class="alectryon-input" for="BaseELMO-v-chkc9"><span class="nb">apply</span> msg_dep_happens_before_iff_one <span class="kr">in</span> Hb.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>Address</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>EqDecision0</var><span class="hyp-type"><b>: </b><span>EqDecision Address</span></span></span><br><span><var>State</var><span><span class="hyp-body"><b>:= </b><span>BaseELMO.State</span></span><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span></span><br><span><var>Observation</var><span><span class="hyp-body"><b>:= </b><span>BaseELMO.Observation</span></span><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span></span><br><span><var>Message</var><span><span class="hyp-body"><b>:= </b><span>BaseELMO.Message</span></span><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span></span><br><span><var>s</var><span class="hyp-type"><b>: </b><span>BaseELMO.State</span></span></span><br><span><var>l</var><span class="hyp-type"><b>: </b><span>Label</span></span></span><br><span><var>m</var><span class="hyp-type"><b>: </b><span>BaseELMO.Message</span></span></span><br><span><var>os</var><span class="hyp-type"><b>: </b><span>list BaseELMO.Observation</span></span></span><br><span><var>a</var><span class="hyp-type"><b>: </b><span>Address</span></span></span><br><span><var>Hindm</var><span class="hyp-type"><b>: </b><span><span class="kr">‚àÄ</span> <span class="nv">dm</span> : Message,
  dm
  ‚àà set_map message
      (rec_obs_fn
         (state
            (message
               {| label := l; message := m |})))
  ‚Üî msg_dep_happens_before
      Message_dependencies dm
      {|
        state :=
          state
            (message
               {| label := l; message := m |})
      |}</span></span></span><br><span><var>Hindos</var><span class="hyp-type"><b>: </b><span><span class="kr">‚àÄ</span> <span class="nv">dm</span> : Message,
  dm
  ‚àà set_map message
      (rec_obs_fn {| obs := os; adr := a |})
  ‚Üî msg_dep_happens_before
      Message_dependencies dm
      {|
        state := {| obs := os; adr := a |}
      |}</span></span></span><br><span><var>dm</var><span class="hyp-type"><b>: </b><span>Message</span></span></span><br><span><var>Hb</var><span class="hyp-type"><b>: </b><span>msg_dep_rel Message_dependencies dm
  {|
    state :=
      {|
        obs :=
          {| label := l; message := m |} :: os;
        adr := a
      |}
  |}
‚à® (<span class="kr">‚àÉ</span> <span class="nv">y</span> : Message,
     msg_dep_happens_before Message_dependencies
       dm y
     ‚àß msg_dep_rel Message_dependencies y
         {|
           state :=
             {|
               obs :=
                 {| label := l; message := m |}
                 :: os;
               adr := a
             |}
         |})</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="kr">‚àÉ</span> <span class="nv">x</span> : BaseELMO.Observation,
  dm = message x
  ‚àß ((x = {| label := l; message := m |}
      ‚à® x ‚àà rec_obs_fn (state m))
     ‚à® x ‚àà rec_obs_fn {| obs := os; adr := a |})</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="BaseELMO-v-chkca" style="display: none" type="checkbox"><label class="alectryon-input" for="BaseELMO-v-chkca"><span class="nb">unfold</span> msg_dep_rel, compose <span class="kr">in</span> Hb; <span class="nb">cbn</span> <span class="kr">in</span> Hb; <span class="nb">unfold</span> Message <span class="kr">in</span> Hb.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>Address</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>EqDecision0</var><span class="hyp-type"><b>: </b><span>EqDecision Address</span></span></span><br><span><var>State</var><span><span class="hyp-body"><b>:= </b><span>BaseELMO.State</span></span><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span></span><br><span><var>Observation</var><span><span class="hyp-body"><b>:= </b><span>BaseELMO.Observation</span></span><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span></span><br><span><var>Message</var><span><span class="hyp-body"><b>:= </b><span>BaseELMO.Message</span></span><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span></span><br><span><var>s</var><span class="hyp-type"><b>: </b><span>BaseELMO.State</span></span></span><br><span><var>l</var><span class="hyp-type"><b>: </b><span>Label</span></span></span><br><span><var>m</var><span class="hyp-type"><b>: </b><span>BaseELMO.Message</span></span></span><br><span><var>os</var><span class="hyp-type"><b>: </b><span>list BaseELMO.Observation</span></span></span><br><span><var>a</var><span class="hyp-type"><b>: </b><span>Address</span></span></span><br><span><var>Hindm</var><span class="hyp-type"><b>: </b><span><span class="kr">‚àÄ</span> <span class="nv">dm</span> : Message,
  dm
  ‚àà set_map message
      (rec_obs_fn
         (state
            (message
               {| label := l; message := m |})))
  ‚Üî msg_dep_happens_before
      Message_dependencies dm
      {|
        state :=
          state
            (message
               {| label := l; message := m |})
      |}</span></span></span><br><span><var>Hindos</var><span class="hyp-type"><b>: </b><span><span class="kr">‚àÄ</span> <span class="nv">dm</span> : Message,
  dm
  ‚àà set_map message
      (rec_obs_fn {| obs := os; adr := a |})
  ‚Üî msg_dep_happens_before
      Message_dependencies dm
      {|
        state := {| obs := os; adr := a |}
      |}</span></span></span><br><span><var>dm</var><span class="hyp-type"><b>: </b><span>Message</span></span></span><br><span><var>Hb</var><span class="hyp-type"><b>: </b><span>dm ‚àà {[m]} ‚à™ list_to_set (map message os)
‚à® (<span class="kr">‚àÉ</span> <span class="nv">y</span> : BaseELMO.Message,
     msg_dep_happens_before Message_dependencies
       dm y
     ‚àß y ‚àà {[m]} ‚à™ list_to_set (map message os))</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="kr">‚àÉ</span> <span class="nv">x</span> : BaseELMO.Observation,
  dm = message x
  ‚àß ((x = {| label := l; message := m |}
      ‚à® x ‚àà rec_obs_fn (state m))
     ‚à® x ‚àà rec_obs_fn {| obs := os; adr := a |})</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="BaseELMO-v-chkcb" style="display: none" type="checkbox"><label class="alectryon-input" for="BaseELMO-v-chkcb"><span class="nb">setoid_rewrite</span> elem_of_union <span class="kr">in</span> Hb;
      <span class="nb">setoid_rewrite</span> elem_of_singleton <span class="kr">in</span> Hb.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>Address</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>EqDecision0</var><span class="hyp-type"><b>: </b><span>EqDecision Address</span></span></span><br><span><var>State</var><span><span class="hyp-body"><b>:= </b><span>BaseELMO.State</span></span><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span></span><br><span><var>Observation</var><span><span class="hyp-body"><b>:= </b><span>BaseELMO.Observation</span></span><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span></span><br><span><var>Message</var><span><span class="hyp-body"><b>:= </b><span>BaseELMO.Message</span></span><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span></span><br><span><var>s</var><span class="hyp-type"><b>: </b><span>BaseELMO.State</span></span></span><br><span><var>l</var><span class="hyp-type"><b>: </b><span>Label</span></span></span><br><span><var>m</var><span class="hyp-type"><b>: </b><span>BaseELMO.Message</span></span></span><br><span><var>os</var><span class="hyp-type"><b>: </b><span>list BaseELMO.Observation</span></span></span><br><span><var>a</var><span class="hyp-type"><b>: </b><span>Address</span></span></span><br><span><var>Hindm</var><span class="hyp-type"><b>: </b><span><span class="kr">‚àÄ</span> <span class="nv">dm</span> : Message,
  dm
  ‚àà set_map message
      (rec_obs_fn
         (state
            (message
               {| label := l; message := m |})))
  ‚Üî msg_dep_happens_before
      Message_dependencies dm
      {|
        state :=
          state
            (message
               {| label := l; message := m |})
      |}</span></span></span><br><span><var>Hindos</var><span class="hyp-type"><b>: </b><span><span class="kr">‚àÄ</span> <span class="nv">dm</span> : Message,
  dm
  ‚àà set_map message
      (rec_obs_fn {| obs := os; adr := a |})
  ‚Üî msg_dep_happens_before
      Message_dependencies dm
      {|
        state := {| obs := os; adr := a |}
      |}</span></span></span><br><span><var>dm</var><span class="hyp-type"><b>: </b><span>Message</span></span></span><br><span><var>Hb</var><span class="hyp-type"><b>: </b><span>(dm = m ‚à® dm ‚àà list_to_set (map message os))
‚à® (<span class="kr">‚àÉ</span> <span class="nv">y</span> : BaseELMO.Message,
     msg_dep_happens_before Message_dependencies
       dm y
     ‚àß (y = m ‚à® y ‚àà list_to_set (map message os)))</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="kr">‚àÉ</span> <span class="nv">x</span> : BaseELMO.Observation,
  dm = message x
  ‚àß ((x = {| label := l; message := m |}
      ‚à® x ‚àà rec_obs_fn (state m))
     ‚à® x ‚àà rec_obs_fn {| obs := os; adr := a |})</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="BaseELMO-v-chkcc" style="display: none" type="checkbox"><label class="alectryon-input" for="BaseELMO-v-chkcc"><span class="nb">destruct</span> Hb <span class="kr">as</span> [[-&gt; | Hdm] | Hos].</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>Address</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>EqDecision0</var><span class="hyp-type"><b>: </b><span>EqDecision Address</span></span></span><br><span><var>State</var><span><span class="hyp-body"><b>:= </b><span>BaseELMO.State</span></span><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span></span><br><span><var>Observation</var><span><span class="hyp-body"><b>:= </b><span>BaseELMO.Observation</span></span><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span></span><br><span><var>Message</var><span><span class="hyp-body"><b>:= </b><span>BaseELMO.Message</span></span><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span></span><br><span><var>s</var><span class="hyp-type"><b>: </b><span>BaseELMO.State</span></span></span><br><span><var>l</var><span class="hyp-type"><b>: </b><span>Label</span></span></span><br><span><var>m</var><span class="hyp-type"><b>: </b><span>BaseELMO.Message</span></span></span><br><span><var>os</var><span class="hyp-type"><b>: </b><span>list BaseELMO.Observation</span></span></span><br><span><var>a</var><span class="hyp-type"><b>: </b><span>Address</span></span></span><br><span><var>Hindm</var><span class="hyp-type"><b>: </b><span><span class="kr">‚àÄ</span> <span class="nv">dm</span> : Message,
  dm
  ‚àà set_map message
      (rec_obs_fn
         (state
            (message
               {| label := l; message := m |})))
  ‚Üî msg_dep_happens_before
      Message_dependencies dm
      {|
        state :=
          state
            (message
               {| label := l; message := m |})
      |}</span></span></span><br><span><var>Hindos</var><span class="hyp-type"><b>: </b><span><span class="kr">‚àÄ</span> <span class="nv">dm</span> : Message,
  dm
  ‚àà set_map message
      (rec_obs_fn {| obs := os; adr := a |})
  ‚Üî msg_dep_happens_before
      Message_dependencies dm
      {|
        state := {| obs := os; adr := a |}
      |}</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="kr">‚àÉ</span> <span class="nv">x</span> : BaseELMO.Observation,
  m = message x
  ‚àß ((x = {| label := l; message := m |}
      ‚à® x ‚àà rec_obs_fn (state m))
     ‚à® x ‚àà rec_obs_fn {| obs := os; adr := a |})</div></blockquote><div class="alectryon-extra-goals"><input class="alectryon-extra-goal-toggle" id="BaseELMO-v-chkcd" style="display: none" type="checkbox"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>Address</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>EqDecision0</var><span class="hyp-type"><b>: </b><span>EqDecision Address</span></span></span><br><span><var>State</var><span><span class="hyp-body"><b>:= </b><span>BaseELMO.State</span></span><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span></span><br><span><var>Observation</var><span><span class="hyp-body"><b>:= </b><span>BaseELMO.Observation</span></span><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span></span><br><span><var>Message</var><span><span class="hyp-body"><b>:= </b><span>BaseELMO.Message</span></span><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span></span><br><span><var>s</var><span class="hyp-type"><b>: </b><span>BaseELMO.State</span></span></span><br><span><var>l</var><span class="hyp-type"><b>: </b><span>Label</span></span></span><br><span><var>m</var><span class="hyp-type"><b>: </b><span>BaseELMO.Message</span></span></span><br><span><var>os</var><span class="hyp-type"><b>: </b><span>list BaseELMO.Observation</span></span></span><br><span><var>a</var><span class="hyp-type"><b>: </b><span>Address</span></span></span><br><span><var>Hindm</var><span class="hyp-type"><b>: </b><span><span class="kr">‚àÄ</span> <span class="nv">dm</span> : Message,
  dm
  ‚àà set_map message
      (rec_obs_fn
         (state
            (message
               {| label := l; message := m |})))
  ‚Üî msg_dep_happens_before
      Message_dependencies dm
      {|
        state :=
          state
            (message
               {| label := l; message := m |})
      |}</span></span></span><br><span><var>Hindos</var><span class="hyp-type"><b>: </b><span><span class="kr">‚àÄ</span> <span class="nv">dm</span> : Message,
  dm
  ‚àà set_map message
      (rec_obs_fn {| obs := os; adr := a |})
  ‚Üî msg_dep_happens_before
      Message_dependencies dm
      {|
        state := {| obs := os; adr := a |}
      |}</span></span></span><br><span><var>dm</var><span class="hyp-type"><b>: </b><span>Message</span></span></span><br><span><var>Hdm</var><span class="hyp-type"><b>: </b><span>dm ‚àà list_to_set (map message os)</span></span></span><br></div><label class="goal-separator" for="BaseELMO-v-chkcd"><hr></label><div class="goal-conclusion"><span class="kr">‚àÉ</span> <span class="nv">x</span> : BaseELMO.Observation,
  dm = message x
  ‚àß ((x = {| label := l; message := m |}
      ‚à® x ‚àà rec_obs_fn (state m))
     ‚à® x ‚àà rec_obs_fn {| obs := os; adr := a |})</div></blockquote><input class="alectryon-extra-goal-toggle" id="BaseELMO-v-chkce" style="display: none" type="checkbox"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>Address</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>EqDecision0</var><span class="hyp-type"><b>: </b><span>EqDecision Address</span></span></span><br><span><var>State</var><span><span class="hyp-body"><b>:= </b><span>BaseELMO.State</span></span><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span></span><br><span><var>Observation</var><span><span class="hyp-body"><b>:= </b><span>BaseELMO.Observation</span></span><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span></span><br><span><var>Message</var><span><span class="hyp-body"><b>:= </b><span>BaseELMO.Message</span></span><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span></span><br><span><var>s</var><span class="hyp-type"><b>: </b><span>BaseELMO.State</span></span></span><br><span><var>l</var><span class="hyp-type"><b>: </b><span>Label</span></span></span><br><span><var>m</var><span class="hyp-type"><b>: </b><span>BaseELMO.Message</span></span></span><br><span><var>os</var><span class="hyp-type"><b>: </b><span>list BaseELMO.Observation</span></span></span><br><span><var>a</var><span class="hyp-type"><b>: </b><span>Address</span></span></span><br><span><var>Hindm</var><span class="hyp-type"><b>: </b><span><span class="kr">‚àÄ</span> <span class="nv">dm</span> : Message,
  dm
  ‚àà set_map message
      (rec_obs_fn
         (state
            (message
               {| label := l; message := m |})))
  ‚Üî msg_dep_happens_before
      Message_dependencies dm
      {|
        state :=
          state
            (message
               {| label := l; message := m |})
      |}</span></span></span><br><span><var>Hindos</var><span class="hyp-type"><b>: </b><span><span class="kr">‚àÄ</span> <span class="nv">dm</span> : Message,
  dm
  ‚àà set_map message
      (rec_obs_fn {| obs := os; adr := a |})
  ‚Üî msg_dep_happens_before
      Message_dependencies dm
      {|
        state := {| obs := os; adr := a |}
      |}</span></span></span><br><span><var>dm</var><span class="hyp-type"><b>: </b><span>Message</span></span></span><br><span><var>Hos</var><span class="hyp-type"><b>: </b><span><span class="kr">‚àÉ</span> <span class="nv">y</span> : BaseELMO.Message,
  msg_dep_happens_before Message_dependencies dm
    y
  ‚àß (y = m ‚à® y ‚àà list_to_set (map message os))</span></span></span><br></div><label class="goal-separator" for="BaseELMO-v-chkce"><hr></label><div class="goal-conclusion"><span class="kr">‚àÉ</span> <span class="nv">x</span> : BaseELMO.Observation,
  dm = message x
  ‚àß ((x = {| label := l; message := m |}
      ‚à® x ‚àà rec_obs_fn (state m))
     ‚à® x ‚àà rec_obs_fn {| obs := os; adr := a |})</div></blockquote></div></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="BaseELMO-v-chkcf" style="display: none" type="checkbox"><label class="alectryon-input" for="BaseELMO-v-chkcf">+</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>Address</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>EqDecision0</var><span class="hyp-type"><b>: </b><span>EqDecision Address</span></span></span><br><span><var>State</var><span><span class="hyp-body"><b>:= </b><span>BaseELMO.State</span></span><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span></span><br><span><var>Observation</var><span><span class="hyp-body"><b>:= </b><span>BaseELMO.Observation</span></span><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span></span><br><span><var>Message</var><span><span class="hyp-body"><b>:= </b><span>BaseELMO.Message</span></span><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span></span><br><span><var>s</var><span class="hyp-type"><b>: </b><span>BaseELMO.State</span></span></span><br><span><var>l</var><span class="hyp-type"><b>: </b><span>Label</span></span></span><br><span><var>m</var><span class="hyp-type"><b>: </b><span>BaseELMO.Message</span></span></span><br><span><var>os</var><span class="hyp-type"><b>: </b><span>list BaseELMO.Observation</span></span></span><br><span><var>a</var><span class="hyp-type"><b>: </b><span>Address</span></span></span><br><span><var>Hindm</var><span class="hyp-type"><b>: </b><span><span class="kr">‚àÄ</span> <span class="nv">dm</span> : Message,
  dm
  ‚àà set_map message
      (rec_obs_fn
         (state
            (message
               {| label := l; message := m |})))
  ‚Üî msg_dep_happens_before
      Message_dependencies dm
      {|
        state :=
          state
            (message
               {| label := l; message := m |})
      |}</span></span></span><br><span><var>Hindos</var><span class="hyp-type"><b>: </b><span><span class="kr">‚àÄ</span> <span class="nv">dm</span> : Message,
  dm
  ‚àà set_map message
      (rec_obs_fn {| obs := os; adr := a |})
  ‚Üî msg_dep_happens_before
      Message_dependencies dm
      {|
        state := {| obs := os; adr := a |}
      |}</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="kr">‚àÉ</span> <span class="nv">x</span> : BaseELMO.Observation,
  m = message x
  ‚àß ((x = {| label := l; message := m |}
      ‚à® x ‚àà rec_obs_fn (state m))
     ‚à® x ‚àà rec_obs_fn {| obs := os; adr := a |})</div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="bp">by</span> <span class="nb">eexists</span>; <span class="nb">split</span>; [| <span class="bp">by</span> <span class="nb">left</span>; <span class="nb">left</span>].</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="BaseELMO-v-chkd0" style="display: none" type="checkbox"><label class="alectryon-input" for="BaseELMO-v-chkd0">+</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>Address</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>EqDecision0</var><span class="hyp-type"><b>: </b><span>EqDecision Address</span></span></span><br><span><var>State</var><span><span class="hyp-body"><b>:= </b><span>BaseELMO.State</span></span><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span></span><br><span><var>Observation</var><span><span class="hyp-body"><b>:= </b><span>BaseELMO.Observation</span></span><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span></span><br><span><var>Message</var><span><span class="hyp-body"><b>:= </b><span>BaseELMO.Message</span></span><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span></span><br><span><var>s</var><span class="hyp-type"><b>: </b><span>BaseELMO.State</span></span></span><br><span><var>l</var><span class="hyp-type"><b>: </b><span>Label</span></span></span><br><span><var>m</var><span class="hyp-type"><b>: </b><span>BaseELMO.Message</span></span></span><br><span><var>os</var><span class="hyp-type"><b>: </b><span>list BaseELMO.Observation</span></span></span><br><span><var>a</var><span class="hyp-type"><b>: </b><span>Address</span></span></span><br><span><var>Hindm</var><span class="hyp-type"><b>: </b><span><span class="kr">‚àÄ</span> <span class="nv">dm</span> : Message,
  dm
  ‚àà set_map message
      (rec_obs_fn
         (state
            (message
               {| label := l; message := m |})))
  ‚Üî msg_dep_happens_before
      Message_dependencies dm
      {|
        state :=
          state
            (message
               {| label := l; message := m |})
      |}</span></span></span><br><span><var>Hindos</var><span class="hyp-type"><b>: </b><span><span class="kr">‚àÄ</span> <span class="nv">dm</span> : Message,
  dm
  ‚àà set_map message
      (rec_obs_fn {| obs := os; adr := a |})
  ‚Üî msg_dep_happens_before
      Message_dependencies dm
      {|
        state := {| obs := os; adr := a |}
      |}</span></span></span><br><span><var>dm</var><span class="hyp-type"><b>: </b><span>Message</span></span></span><br><span><var>Hdm</var><span class="hyp-type"><b>: </b><span>dm ‚àà list_to_set (map message os)</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="kr">‚àÉ</span> <span class="nv">x</span> : BaseELMO.Observation,
  dm = message x
  ‚àß ((x = {| label := l; message := m |}
      ‚à® x ‚àà rec_obs_fn (state m))
     ‚à® x ‚àà rec_obs_fn {| obs := os; adr := a |})</div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="BaseELMO-v-chkd1" style="display: none" type="checkbox"><label class="alectryon-input" for="BaseELMO-v-chkd1"><span class="nb">cut</span> (msg_dep_happens_before Message_dependencies dm (MkMessage (MkState os a))).</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>Address</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>EqDecision0</var><span class="hyp-type"><b>: </b><span>EqDecision Address</span></span></span><br><span><var>State</var><span><span class="hyp-body"><b>:= </b><span>BaseELMO.State</span></span><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span></span><br><span><var>Observation</var><span><span class="hyp-body"><b>:= </b><span>BaseELMO.Observation</span></span><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span></span><br><span><var>Message</var><span><span class="hyp-body"><b>:= </b><span>BaseELMO.Message</span></span><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span></span><br><span><var>s</var><span class="hyp-type"><b>: </b><span>BaseELMO.State</span></span></span><br><span><var>l</var><span class="hyp-type"><b>: </b><span>Label</span></span></span><br><span><var>m</var><span class="hyp-type"><b>: </b><span>BaseELMO.Message</span></span></span><br><span><var>os</var><span class="hyp-type"><b>: </b><span>list BaseELMO.Observation</span></span></span><br><span><var>a</var><span class="hyp-type"><b>: </b><span>Address</span></span></span><br><span><var>Hindm</var><span class="hyp-type"><b>: </b><span><span class="kr">‚àÄ</span> <span class="nv">dm</span> : Message,
  dm
  ‚àà set_map message
      (rec_obs_fn
         (state
            (message
               {| label := l; message := m |})))
  ‚Üî msg_dep_happens_before
      Message_dependencies dm
      {|
        state :=
          state
            (message
               {| label := l; message := m |})
      |}</span></span></span><br><span><var>Hindos</var><span class="hyp-type"><b>: </b><span><span class="kr">‚àÄ</span> <span class="nv">dm</span> : Message,
  dm
  ‚àà set_map message
      (rec_obs_fn {| obs := os; adr := a |})
  ‚Üî msg_dep_happens_before
      Message_dependencies dm
      {|
        state := {| obs := os; adr := a |}
      |}</span></span></span><br><span><var>dm</var><span class="hyp-type"><b>: </b><span>Message</span></span></span><br><span><var>Hdm</var><span class="hyp-type"><b>: </b><span>dm ‚àà list_to_set (map message os)</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">msg_dep_happens_before Message_dependencies dm
  {| state := {| obs := os; adr := a |} |}
‚Üí <span class="kr">‚àÉ</span> <span class="nv">x</span> : BaseELMO.Observation,
    dm = message x
    ‚àß ((x = {| label := l; message := m |}
        ‚à® x ‚àà rec_obs_fn (state m))
       ‚à® x ‚àà rec_obs_fn {| obs := os; adr := a |})</div></blockquote><div class="alectryon-extra-goals"><input class="alectryon-extra-goal-toggle" id="BaseELMO-v-chkd2" style="display: none" type="checkbox"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>Address</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>EqDecision0</var><span class="hyp-type"><b>: </b><span>EqDecision Address</span></span></span><br><span><var>State</var><span><span class="hyp-body"><b>:= </b><span>BaseELMO.State</span></span><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span></span><br><span><var>Observation</var><span><span class="hyp-body"><b>:= </b><span>BaseELMO.Observation</span></span><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span></span><br><span><var>Message</var><span><span class="hyp-body"><b>:= </b><span>BaseELMO.Message</span></span><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span></span><br><span><var>s</var><span class="hyp-type"><b>: </b><span>BaseELMO.State</span></span></span><br><span><var>l</var><span class="hyp-type"><b>: </b><span>Label</span></span></span><br><span><var>m</var><span class="hyp-type"><b>: </b><span>BaseELMO.Message</span></span></span><br><span><var>os</var><span class="hyp-type"><b>: </b><span>list BaseELMO.Observation</span></span></span><br><span><var>a</var><span class="hyp-type"><b>: </b><span>Address</span></span></span><br><span><var>Hindm</var><span class="hyp-type"><b>: </b><span><span class="kr">‚àÄ</span> <span class="nv">dm</span> : Message,
  dm
  ‚àà set_map message
      (rec_obs_fn
         (state
            (message
               {| label := l; message := m |})))
  ‚Üî msg_dep_happens_before
      Message_dependencies dm
      {|
        state :=
          state
            (message
               {| label := l; message := m |})
      |}</span></span></span><br><span><var>Hindos</var><span class="hyp-type"><b>: </b><span><span class="kr">‚àÄ</span> <span class="nv">dm</span> : Message,
  dm
  ‚àà set_map message
      (rec_obs_fn {| obs := os; adr := a |})
  ‚Üî msg_dep_happens_before
      Message_dependencies dm
      {|
        state := {| obs := os; adr := a |}
      |}</span></span></span><br><span><var>dm</var><span class="hyp-type"><b>: </b><span>Message</span></span></span><br><span><var>Hdm</var><span class="hyp-type"><b>: </b><span>dm ‚àà list_to_set (map message os)</span></span></span><br></div><label class="goal-separator" for="BaseELMO-v-chkd2"><hr></label><div class="goal-conclusion">msg_dep_happens_before Message_dependencies dm
  {| state := {| obs := os; adr := a |} |}</div></blockquote></div></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">      </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="BaseELMO-v-chkd3" style="display: none" type="checkbox"><label class="alectryon-input" for="BaseELMO-v-chkd3">{</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>Address</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>EqDecision0</var><span class="hyp-type"><b>: </b><span>EqDecision Address</span></span></span><br><span><var>State</var><span><span class="hyp-body"><b>:= </b><span>BaseELMO.State</span></span><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span></span><br><span><var>Observation</var><span><span class="hyp-body"><b>:= </b><span>BaseELMO.Observation</span></span><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span></span><br><span><var>Message</var><span><span class="hyp-body"><b>:= </b><span>BaseELMO.Message</span></span><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span></span><br><span><var>s</var><span class="hyp-type"><b>: </b><span>BaseELMO.State</span></span></span><br><span><var>l</var><span class="hyp-type"><b>: </b><span>Label</span></span></span><br><span><var>m</var><span class="hyp-type"><b>: </b><span>BaseELMO.Message</span></span></span><br><span><var>os</var><span class="hyp-type"><b>: </b><span>list BaseELMO.Observation</span></span></span><br><span><var>a</var><span class="hyp-type"><b>: </b><span>Address</span></span></span><br><span><var>Hindm</var><span class="hyp-type"><b>: </b><span><span class="kr">‚àÄ</span> <span class="nv">dm</span> : Message,
  dm
  ‚àà set_map message
      (rec_obs_fn
         (state
            (message
               {| label := l; message := m |})))
  ‚Üî msg_dep_happens_before
      Message_dependencies dm
      {|
        state :=
          state
            (message
               {| label := l; message := m |})
      |}</span></span></span><br><span><var>Hindos</var><span class="hyp-type"><b>: </b><span><span class="kr">‚àÄ</span> <span class="nv">dm</span> : Message,
  dm
  ‚àà set_map message
      (rec_obs_fn {| obs := os; adr := a |})
  ‚Üî msg_dep_happens_before
      Message_dependencies dm
      {|
        state := {| obs := os; adr := a |}
      |}</span></span></span><br><span><var>dm</var><span class="hyp-type"><b>: </b><span>Message</span></span></span><br><span><var>Hdm</var><span class="hyp-type"><b>: </b><span>dm ‚àà list_to_set (map message os)</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">msg_dep_happens_before Message_dependencies dm
  {| state := {| obs := os; adr := a |} |}
‚Üí <span class="kr">‚àÉ</span> <span class="nv">x</span> : BaseELMO.Observation,
    dm = message x
    ‚àß ((x = {| label := l; message := m |}
        ‚à® x ‚àà rec_obs_fn (state m))
       ‚à® x ‚àà rec_obs_fn {| obs := os; adr := a |})</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">        </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="BaseELMO-v-chkd4" style="display: none" type="checkbox"><label class="alectryon-input" for="BaseELMO-v-chkd4"><span class="nb">intro</span> Hb; <span class="nb">apply</span> Hindos, elem_of_map <span class="kr">in</span> Hb <span class="kr">as</span> (y &amp; -&gt; &amp; Hy).</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>Address</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>EqDecision0</var><span class="hyp-type"><b>: </b><span>EqDecision Address</span></span></span><br><span><var>State</var><span><span class="hyp-body"><b>:= </b><span>BaseELMO.State</span></span><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span></span><br><span><var>Observation</var><span><span class="hyp-body"><b>:= </b><span>BaseELMO.Observation</span></span><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span></span><br><span><var>Message</var><span><span class="hyp-body"><b>:= </b><span>BaseELMO.Message</span></span><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span></span><br><span><var>s</var><span class="hyp-type"><b>: </b><span>BaseELMO.State</span></span></span><br><span><var>l</var><span class="hyp-type"><b>: </b><span>Label</span></span></span><br><span><var>m</var><span class="hyp-type"><b>: </b><span>BaseELMO.Message</span></span></span><br><span><var>os</var><span class="hyp-type"><b>: </b><span>list BaseELMO.Observation</span></span></span><br><span><var>a</var><span class="hyp-type"><b>: </b><span>Address</span></span></span><br><span><var>Hindm</var><span class="hyp-type"><b>: </b><span><span class="kr">‚àÄ</span> <span class="nv">dm</span> : Message,
  dm
  ‚àà set_map message
      (rec_obs_fn
         (state
            (message
               {| label := l; message := m |})))
  ‚Üî msg_dep_happens_before
      Message_dependencies dm
      {|
        state :=
          state
            (message
               {| label := l; message := m |})
      |}</span></span></span><br><span><var>Hindos</var><span class="hyp-type"><b>: </b><span><span class="kr">‚àÄ</span> <span class="nv">dm</span> : Message,
  dm
  ‚àà set_map message
      (rec_obs_fn {| obs := os; adr := a |})
  ‚Üî msg_dep_happens_before
      Message_dependencies dm
      {|
        state := {| obs := os; adr := a |}
      |}</span></span></span><br><span><var>y</var><span class="hyp-type"><b>: </b><span>BaseELMO.Observation</span></span></span><br><span><var>Hdm</var><span class="hyp-type"><b>: </b><span>message y ‚àà list_to_set (map message os)</span></span></span><br><span><var>Hy</var><span class="hyp-type"><b>: </b><span>y ‚àà rec_obs_fn {| obs := os; adr := a |}</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="kr">‚àÉ</span> <span class="nv">x</span> : BaseELMO.Observation,
  message y = message x
  ‚àß ((x = {| label := l; message := m |}
      ‚à® x ‚àà rec_obs_fn (state m))
     ‚à® x ‚àà rec_obs_fn {| obs := os; adr := a |})</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">        </span><span class="alectryon-sentence"><span class="alectryon-input"><span class="bp">by</span> <span class="nb">eexists</span>; <span class="nb">split</span>; [| <span class="nb">right</span>].</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">      </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="BaseELMO-v-chkd5" style="display: none" type="checkbox"><label class="alectryon-input" for="BaseELMO-v-chkd5">}</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>Address</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>EqDecision0</var><span class="hyp-type"><b>: </b><span>EqDecision Address</span></span></span><br><span><var>State</var><span><span class="hyp-body"><b>:= </b><span>BaseELMO.State</span></span><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span></span><br><span><var>Observation</var><span><span class="hyp-body"><b>:= </b><span>BaseELMO.Observation</span></span><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span></span><br><span><var>Message</var><span><span class="hyp-body"><b>:= </b><span>BaseELMO.Message</span></span><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span></span><br><span><var>s</var><span class="hyp-type"><b>: </b><span>BaseELMO.State</span></span></span><br><span><var>l</var><span class="hyp-type"><b>: </b><span>Label</span></span></span><br><span><var>m</var><span class="hyp-type"><b>: </b><span>BaseELMO.Message</span></span></span><br><span><var>os</var><span class="hyp-type"><b>: </b><span>list BaseELMO.Observation</span></span></span><br><span><var>a</var><span class="hyp-type"><b>: </b><span>Address</span></span></span><br><span><var>Hindm</var><span class="hyp-type"><b>: </b><span><span class="kr">‚àÄ</span> <span class="nv">dm</span> : Message,
  dm
  ‚àà set_map message
      (rec_obs_fn
         (state
            (message
               {| label := l; message := m |})))
  ‚Üî msg_dep_happens_before
      Message_dependencies dm
      {|
        state :=
          state
            (message
               {| label := l; message := m |})
      |}</span></span></span><br><span><var>Hindos</var><span class="hyp-type"><b>: </b><span><span class="kr">‚àÄ</span> <span class="nv">dm</span> : Message,
  dm
  ‚àà set_map message
      (rec_obs_fn {| obs := os; adr := a |})
  ‚Üî msg_dep_happens_before
      Message_dependencies dm
      {|
        state := {| obs := os; adr := a |}
      |}</span></span></span><br><span><var>dm</var><span class="hyp-type"><b>: </b><span>Message</span></span></span><br><span><var>Hdm</var><span class="hyp-type"><b>: </b><span>dm ‚àà list_to_set (map message os)</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">msg_dep_happens_before Message_dependencies dm
  {| state := {| obs := os; adr := a |} |}</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">      </span><span class="alectryon-sentence"><span class="alectryon-input"><span class="bp">by</span> <span class="nb">apply</span> msg_dep_happens_before_iff_one; <span class="nb">left</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="BaseELMO-v-chkd6" style="display: none" type="checkbox"><label class="alectryon-input" for="BaseELMO-v-chkd6">+</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>Address</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>EqDecision0</var><span class="hyp-type"><b>: </b><span>EqDecision Address</span></span></span><br><span><var>State</var><span><span class="hyp-body"><b>:= </b><span>BaseELMO.State</span></span><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span></span><br><span><var>Observation</var><span><span class="hyp-body"><b>:= </b><span>BaseELMO.Observation</span></span><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span></span><br><span><var>Message</var><span><span class="hyp-body"><b>:= </b><span>BaseELMO.Message</span></span><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span></span><br><span><var>s</var><span class="hyp-type"><b>: </b><span>BaseELMO.State</span></span></span><br><span><var>l</var><span class="hyp-type"><b>: </b><span>Label</span></span></span><br><span><var>m</var><span class="hyp-type"><b>: </b><span>BaseELMO.Message</span></span></span><br><span><var>os</var><span class="hyp-type"><b>: </b><span>list BaseELMO.Observation</span></span></span><br><span><var>a</var><span class="hyp-type"><b>: </b><span>Address</span></span></span><br><span><var>Hindm</var><span class="hyp-type"><b>: </b><span><span class="kr">‚àÄ</span> <span class="nv">dm</span> : Message,
  dm
  ‚àà set_map message
      (rec_obs_fn
         (state
            (message
               {| label := l; message := m |})))
  ‚Üî msg_dep_happens_before
      Message_dependencies dm
      {|
        state :=
          state
            (message
               {| label := l; message := m |})
      |}</span></span></span><br><span><var>Hindos</var><span class="hyp-type"><b>: </b><span><span class="kr">‚àÄ</span> <span class="nv">dm</span> : Message,
  dm
  ‚àà set_map message
      (rec_obs_fn {| obs := os; adr := a |})
  ‚Üî msg_dep_happens_before
      Message_dependencies dm
      {|
        state := {| obs := os; adr := a |}
      |}</span></span></span><br><span><var>dm</var><span class="hyp-type"><b>: </b><span>Message</span></span></span><br><span><var>Hos</var><span class="hyp-type"><b>: </b><span><span class="kr">‚àÉ</span> <span class="nv">y</span> : BaseELMO.Message,
  msg_dep_happens_before Message_dependencies dm
    y
  ‚àß (y = m ‚à® y ‚àà list_to_set (map message os))</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="kr">‚àÉ</span> <span class="nv">x</span> : BaseELMO.Observation,
  dm = message x
  ‚àß ((x = {| label := l; message := m |}
      ‚à® x ‚àà rec_obs_fn (state m))
     ‚à® x ‚àà rec_obs_fn {| obs := os; adr := a |})</div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="BaseELMO-v-chkd7" style="display: none" type="checkbox"><label class="alectryon-input" for="BaseELMO-v-chkd7"><span class="nb">destruct</span> Hos <span class="kr">as</span> (y &amp; Hb &amp; [-&gt; | Hos]).</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>Address</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>EqDecision0</var><span class="hyp-type"><b>: </b><span>EqDecision Address</span></span></span><br><span><var>State</var><span><span class="hyp-body"><b>:= </b><span>BaseELMO.State</span></span><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span></span><br><span><var>Observation</var><span><span class="hyp-body"><b>:= </b><span>BaseELMO.Observation</span></span><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span></span><br><span><var>Message</var><span><span class="hyp-body"><b>:= </b><span>BaseELMO.Message</span></span><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span></span><br><span><var>s</var><span class="hyp-type"><b>: </b><span>BaseELMO.State</span></span></span><br><span><var>l</var><span class="hyp-type"><b>: </b><span>Label</span></span></span><br><span><var>m</var><span class="hyp-type"><b>: </b><span>BaseELMO.Message</span></span></span><br><span><var>os</var><span class="hyp-type"><b>: </b><span>list BaseELMO.Observation</span></span></span><br><span><var>a</var><span class="hyp-type"><b>: </b><span>Address</span></span></span><br><span><var>Hindm</var><span class="hyp-type"><b>: </b><span><span class="kr">‚àÄ</span> <span class="nv">dm</span> : Message,
  dm
  ‚àà set_map message
      (rec_obs_fn
         (state
            (message
               {| label := l; message := m |})))
  ‚Üî msg_dep_happens_before
      Message_dependencies dm
      {|
        state :=
          state
            (message
               {| label := l; message := m |})
      |}</span></span></span><br><span><var>Hindos</var><span class="hyp-type"><b>: </b><span><span class="kr">‚àÄ</span> <span class="nv">dm</span> : Message,
  dm
  ‚àà set_map message
      (rec_obs_fn {| obs := os; adr := a |})
  ‚Üî msg_dep_happens_before
      Message_dependencies dm
      {|
        state := {| obs := os; adr := a |}
      |}</span></span></span><br><span><var>dm</var><span class="hyp-type"><b>: </b><span>Message</span></span></span><br><span><var>Hb</var><span class="hyp-type"><b>: </b><span>msg_dep_happens_before Message_dependencies dm m</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="kr">‚àÉ</span> <span class="nv">x</span> : BaseELMO.Observation,
  dm = message x
  ‚àß ((x = {| label := l; message := m |}
      ‚à® x ‚àà rec_obs_fn (state m))
     ‚à® x ‚àà rec_obs_fn {| obs := os; adr := a |})</div></blockquote><div class="alectryon-extra-goals"><input class="alectryon-extra-goal-toggle" id="BaseELMO-v-chkd8" style="display: none" type="checkbox"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>Address</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>EqDecision0</var><span class="hyp-type"><b>: </b><span>EqDecision Address</span></span></span><br><span><var>State</var><span><span class="hyp-body"><b>:= </b><span>BaseELMO.State</span></span><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span></span><br><span><var>Observation</var><span><span class="hyp-body"><b>:= </b><span>BaseELMO.Observation</span></span><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span></span><br><span><var>Message</var><span><span class="hyp-body"><b>:= </b><span>BaseELMO.Message</span></span><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span></span><br><span><var>s</var><span class="hyp-type"><b>: </b><span>BaseELMO.State</span></span></span><br><span><var>l</var><span class="hyp-type"><b>: </b><span>Label</span></span></span><br><span><var>m</var><span class="hyp-type"><b>: </b><span>BaseELMO.Message</span></span></span><br><span><var>os</var><span class="hyp-type"><b>: </b><span>list BaseELMO.Observation</span></span></span><br><span><var>a</var><span class="hyp-type"><b>: </b><span>Address</span></span></span><br><span><var>Hindm</var><span class="hyp-type"><b>: </b><span><span class="kr">‚àÄ</span> <span class="nv">dm</span> : Message,
  dm
  ‚àà set_map message
      (rec_obs_fn
         (state
            (message
               {| label := l; message := m |})))
  ‚Üî msg_dep_happens_before
      Message_dependencies dm
      {|
        state :=
          state
            (message
               {| label := l; message := m |})
      |}</span></span></span><br><span><var>Hindos</var><span class="hyp-type"><b>: </b><span><span class="kr">‚àÄ</span> <span class="nv">dm</span> : Message,
  dm
  ‚àà set_map message
      (rec_obs_fn {| obs := os; adr := a |})
  ‚Üî msg_dep_happens_before
      Message_dependencies dm
      {|
        state := {| obs := os; adr := a |}
      |}</span></span></span><br><span><var>dm</var><span class="hyp-type"><b>: </b><span>Message</span></span></span><br><span><var>y</var><span class="hyp-type"><b>: </b><span>BaseELMO.Message</span></span></span><br><span><var>Hb</var><span class="hyp-type"><b>: </b><span>msg_dep_happens_before Message_dependencies dm y</span></span></span><br><span><var>Hos</var><span class="hyp-type"><b>: </b><span>y ‚àà list_to_set (map message os)</span></span></span><br></div><label class="goal-separator" for="BaseELMO-v-chkd8"><hr></label><div class="goal-conclusion"><span class="kr">‚àÉ</span> <span class="nv">x</span> : BaseELMO.Observation,
  dm = message x
  ‚àß ((x = {| label := l; message := m |}
      ‚à® x ‚àà rec_obs_fn (state m))
     ‚à® x ‚àà rec_obs_fn {| obs := os; adr := a |})</div></blockquote></div></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">      </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="BaseELMO-v-chkd9" style="display: none" type="checkbox"><label class="alectryon-input" for="BaseELMO-v-chkd9">*</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>Address</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>EqDecision0</var><span class="hyp-type"><b>: </b><span>EqDecision Address</span></span></span><br><span><var>State</var><span><span class="hyp-body"><b>:= </b><span>BaseELMO.State</span></span><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span></span><br><span><var>Observation</var><span><span class="hyp-body"><b>:= </b><span>BaseELMO.Observation</span></span><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span></span><br><span><var>Message</var><span><span class="hyp-body"><b>:= </b><span>BaseELMO.Message</span></span><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span></span><br><span><var>s</var><span class="hyp-type"><b>: </b><span>BaseELMO.State</span></span></span><br><span><var>l</var><span class="hyp-type"><b>: </b><span>Label</span></span></span><br><span><var>m</var><span class="hyp-type"><b>: </b><span>BaseELMO.Message</span></span></span><br><span><var>os</var><span class="hyp-type"><b>: </b><span>list BaseELMO.Observation</span></span></span><br><span><var>a</var><span class="hyp-type"><b>: </b><span>Address</span></span></span><br><span><var>Hindm</var><span class="hyp-type"><b>: </b><span><span class="kr">‚àÄ</span> <span class="nv">dm</span> : Message,
  dm
  ‚àà set_map message
      (rec_obs_fn
         (state
            (message
               {| label := l; message := m |})))
  ‚Üî msg_dep_happens_before
      Message_dependencies dm
      {|
        state :=
          state
            (message
               {| label := l; message := m |})
      |}</span></span></span><br><span><var>Hindos</var><span class="hyp-type"><b>: </b><span><span class="kr">‚àÄ</span> <span class="nv">dm</span> : Message,
  dm
  ‚àà set_map message
      (rec_obs_fn {| obs := os; adr := a |})
  ‚Üî msg_dep_happens_before
      Message_dependencies dm
      {|
        state := {| obs := os; adr := a |}
      |}</span></span></span><br><span><var>dm</var><span class="hyp-type"><b>: </b><span>Message</span></span></span><br><span><var>Hb</var><span class="hyp-type"><b>: </b><span>msg_dep_happens_before Message_dependencies dm m</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="kr">‚àÉ</span> <span class="nv">x</span> : BaseELMO.Observation,
  dm = message x
  ‚àß ((x = {| label := l; message := m |}
      ‚à® x ‚àà rec_obs_fn (state m))
     ‚à® x ‚àà rec_obs_fn {| obs := os; adr := a |})</div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="BaseELMO-v-chkda" style="display: none" type="checkbox"><label class="alectryon-input" for="BaseELMO-v-chkda"><span class="nb">destruct</span> m <span class="kr">as</span> [state_m].</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>Address</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>EqDecision0</var><span class="hyp-type"><b>: </b><span>EqDecision Address</span></span></span><br><span><var>State</var><span><span class="hyp-body"><b>:= </b><span>BaseELMO.State</span></span><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span></span><br><span><var>Observation</var><span><span class="hyp-body"><b>:= </b><span>BaseELMO.Observation</span></span><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span></span><br><span><var>Message</var><span><span class="hyp-body"><b>:= </b><span>BaseELMO.Message</span></span><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span></span><br><span><var>s</var><span class="hyp-type"><b>: </b><span>BaseELMO.State</span></span></span><br><span><var>l</var><span class="hyp-type"><b>: </b><span>Label</span></span></span><br><span><var>state_m</var><span class="hyp-type"><b>: </b><span>BaseELMO.State</span></span></span><br><span><var>os</var><span class="hyp-type"><b>: </b><span>list BaseELMO.Observation</span></span></span><br><span><var>a</var><span class="hyp-type"><b>: </b><span>Address</span></span></span><br><span><var>Hindm</var><span class="hyp-type"><b>: </b><span><span class="kr">‚àÄ</span> <span class="nv">dm</span> : Message,
  dm
  ‚àà set_map message
      (rec_obs_fn
         (state
            (message
               {|
                 label := l;
                 message :=
                   {| state := state_m |}
               |})))
  ‚Üî msg_dep_happens_before
      Message_dependencies dm
      {|
        state :=
          state
            (message
               {|
                 label := l;
                 message :=
                   {| state := state_m |}
               |})
      |}</span></span></span><br><span><var>Hindos</var><span class="hyp-type"><b>: </b><span><span class="kr">‚àÄ</span> <span class="nv">dm</span> : Message,
  dm
  ‚àà set_map message
      (rec_obs_fn {| obs := os; adr := a |})
  ‚Üî msg_dep_happens_before
      Message_dependencies dm
      {|
        state := {| obs := os; adr := a |}
      |}</span></span></span><br><span><var>dm</var><span class="hyp-type"><b>: </b><span>Message</span></span></span><br><span><var>Hb</var><span class="hyp-type"><b>: </b><span>msg_dep_happens_before Message_dependencies dm
  {| state := state_m |}</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="kr">‚àÉ</span> <span class="nv">x</span> : BaseELMO.Observation,
  dm = message x
  ‚àß ((x =
      {|
        label := l; message := {| state := state_m |}
      |}
      ‚à® x ‚àà rec_obs_fn (state {| state := state_m |}))
     ‚à® x ‚àà rec_obs_fn {| obs := os; adr := a |})</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">        </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="BaseELMO-v-chkdb" style="display: none" type="checkbox"><label class="alectryon-input" for="BaseELMO-v-chkdb"><span class="nb">apply</span> Hindm, elem_of_map <span class="kr">in</span> Hb <span class="kr">as</span> (y &amp; -&gt; &amp; Hy).</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>Address</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>EqDecision0</var><span class="hyp-type"><b>: </b><span>EqDecision Address</span></span></span><br><span><var>State</var><span><span class="hyp-body"><b>:= </b><span>BaseELMO.State</span></span><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span></span><br><span><var>Observation</var><span><span class="hyp-body"><b>:= </b><span>BaseELMO.Observation</span></span><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span></span><br><span><var>Message</var><span><span class="hyp-body"><b>:= </b><span>BaseELMO.Message</span></span><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span></span><br><span><var>s</var><span class="hyp-type"><b>: </b><span>BaseELMO.State</span></span></span><br><span><var>l</var><span class="hyp-type"><b>: </b><span>Label</span></span></span><br><span><var>state_m</var><span class="hyp-type"><b>: </b><span>BaseELMO.State</span></span></span><br><span><var>os</var><span class="hyp-type"><b>: </b><span>list BaseELMO.Observation</span></span></span><br><span><var>a</var><span class="hyp-type"><b>: </b><span>Address</span></span></span><br><span><var>Hindm</var><span class="hyp-type"><b>: </b><span><span class="kr">‚àÄ</span> <span class="nv">dm</span> : Message,
  dm
  ‚àà set_map message
      (rec_obs_fn
         (state
            (message
               {|
                 label := l;
                 message :=
                   {| state := state_m |}
               |})))
  ‚Üî msg_dep_happens_before
      Message_dependencies dm
      {|
        state :=
          state
            (message
               {|
                 label := l;
                 message :=
                   {| state := state_m |}
               |})
      |}</span></span></span><br><span><var>Hindos</var><span class="hyp-type"><b>: </b><span><span class="kr">‚àÄ</span> <span class="nv">dm</span> : Message,
  dm
  ‚àà set_map message
      (rec_obs_fn {| obs := os; adr := a |})
  ‚Üî msg_dep_happens_before
      Message_dependencies dm
      {|
        state := {| obs := os; adr := a |}
      |}</span></span></span><br><span><var>y</var><span class="hyp-type"><b>: </b><span>BaseELMO.Observation</span></span></span><br><span><var>Hy</var><span class="hyp-type"><b>: </b><span>y
‚àà rec_obs_fn
    (state
       (message
          {|
            label := l;
            message := {| state := state_m |}
          |}))</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="kr">‚àÉ</span> <span class="nv">x</span> : BaseELMO.Observation,
  message y = message x
  ‚àß ((x =
      {|
        label := l; message := {| state := state_m |}
      |}
      ‚à® x ‚àà rec_obs_fn (state {| state := state_m |}))
     ‚à® x ‚àà rec_obs_fn {| obs := os; adr := a |})</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">        </span><span class="alectryon-sentence"><span class="alectryon-input"><span class="bp">by</span> <span class="nb">eexists</span>; <span class="nb">split</span>; [| <span class="nb">left</span>; <span class="nb">right</span>].</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">      </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="BaseELMO-v-chkdc" style="display: none" type="checkbox"><label class="alectryon-input" for="BaseELMO-v-chkdc">*</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>Address</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>EqDecision0</var><span class="hyp-type"><b>: </b><span>EqDecision Address</span></span></span><br><span><var>State</var><span><span class="hyp-body"><b>:= </b><span>BaseELMO.State</span></span><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span></span><br><span><var>Observation</var><span><span class="hyp-body"><b>:= </b><span>BaseELMO.Observation</span></span><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span></span><br><span><var>Message</var><span><span class="hyp-body"><b>:= </b><span>BaseELMO.Message</span></span><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span></span><br><span><var>s</var><span class="hyp-type"><b>: </b><span>BaseELMO.State</span></span></span><br><span><var>l</var><span class="hyp-type"><b>: </b><span>Label</span></span></span><br><span><var>m</var><span class="hyp-type"><b>: </b><span>BaseELMO.Message</span></span></span><br><span><var>os</var><span class="hyp-type"><b>: </b><span>list BaseELMO.Observation</span></span></span><br><span><var>a</var><span class="hyp-type"><b>: </b><span>Address</span></span></span><br><span><var>Hindm</var><span class="hyp-type"><b>: </b><span><span class="kr">‚àÄ</span> <span class="nv">dm</span> : Message,
  dm
  ‚àà set_map message
      (rec_obs_fn
         (state
            (message
               {| label := l; message := m |})))
  ‚Üî msg_dep_happens_before
      Message_dependencies dm
      {|
        state :=
          state
            (message
               {| label := l; message := m |})
      |}</span></span></span><br><span><var>Hindos</var><span class="hyp-type"><b>: </b><span><span class="kr">‚àÄ</span> <span class="nv">dm</span> : Message,
  dm
  ‚àà set_map message
      (rec_obs_fn {| obs := os; adr := a |})
  ‚Üî msg_dep_happens_before
      Message_dependencies dm
      {|
        state := {| obs := os; adr := a |}
      |}</span></span></span><br><span><var>dm</var><span class="hyp-type"><b>: </b><span>Message</span></span></span><br><span><var>y</var><span class="hyp-type"><b>: </b><span>BaseELMO.Message</span></span></span><br><span><var>Hb</var><span class="hyp-type"><b>: </b><span>msg_dep_happens_before Message_dependencies dm y</span></span></span><br><span><var>Hos</var><span class="hyp-type"><b>: </b><span>y ‚àà list_to_set (map message os)</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="kr">‚àÉ</span> <span class="nv">x</span> : BaseELMO.Observation,
  dm = message x
  ‚àß ((x = {| label := l; message := m |}
      ‚à® x ‚àà rec_obs_fn (state m))
     ‚à® x ‚àà rec_obs_fn {| obs := os; adr := a |})</div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="BaseELMO-v-chkdd" style="display: none" type="checkbox"><label class="alectryon-input" for="BaseELMO-v-chkdd"><span class="nb">cut</span> (msg_dep_happens_before Message_dependencies dm (MkMessage (MkState os a))).</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>Address</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>EqDecision0</var><span class="hyp-type"><b>: </b><span>EqDecision Address</span></span></span><br><span><var>State</var><span><span class="hyp-body"><b>:= </b><span>BaseELMO.State</span></span><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span></span><br><span><var>Observation</var><span><span class="hyp-body"><b>:= </b><span>BaseELMO.Observation</span></span><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span></span><br><span><var>Message</var><span><span class="hyp-body"><b>:= </b><span>BaseELMO.Message</span></span><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span></span><br><span><var>s</var><span class="hyp-type"><b>: </b><span>BaseELMO.State</span></span></span><br><span><var>l</var><span class="hyp-type"><b>: </b><span>Label</span></span></span><br><span><var>m</var><span class="hyp-type"><b>: </b><span>BaseELMO.Message</span></span></span><br><span><var>os</var><span class="hyp-type"><b>: </b><span>list BaseELMO.Observation</span></span></span><br><span><var>a</var><span class="hyp-type"><b>: </b><span>Address</span></span></span><br><span><var>Hindm</var><span class="hyp-type"><b>: </b><span><span class="kr">‚àÄ</span> <span class="nv">dm</span> : Message,
  dm
  ‚àà set_map message
      (rec_obs_fn
         (state
            (message
               {| label := l; message := m |})))
  ‚Üî msg_dep_happens_before
      Message_dependencies dm
      {|
        state :=
          state
            (message
               {| label := l; message := m |})
      |}</span></span></span><br><span><var>Hindos</var><span class="hyp-type"><b>: </b><span><span class="kr">‚àÄ</span> <span class="nv">dm</span> : Message,
  dm
  ‚àà set_map message
      (rec_obs_fn {| obs := os; adr := a |})
  ‚Üî msg_dep_happens_before
      Message_dependencies dm
      {|
        state := {| obs := os; adr := a |}
      |}</span></span></span><br><span><var>dm</var><span class="hyp-type"><b>: </b><span>Message</span></span></span><br><span><var>y</var><span class="hyp-type"><b>: </b><span>BaseELMO.Message</span></span></span><br><span><var>Hb</var><span class="hyp-type"><b>: </b><span>msg_dep_happens_before Message_dependencies dm y</span></span></span><br><span><var>Hos</var><span class="hyp-type"><b>: </b><span>y ‚àà list_to_set (map message os)</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">msg_dep_happens_before Message_dependencies dm
  {| state := {| obs := os; adr := a |} |}
‚Üí <span class="kr">‚àÉ</span> <span class="nv">x</span> : BaseELMO.Observation,
    dm = message x
    ‚àß ((x = {| label := l; message := m |}
        ‚à® x ‚àà rec_obs_fn (state m))
       ‚à® x ‚àà rec_obs_fn {| obs := os; adr := a |})</div></blockquote><div class="alectryon-extra-goals"><input class="alectryon-extra-goal-toggle" id="BaseELMO-v-chkde" style="display: none" type="checkbox"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>Address</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>EqDecision0</var><span class="hyp-type"><b>: </b><span>EqDecision Address</span></span></span><br><span><var>State</var><span><span class="hyp-body"><b>:= </b><span>BaseELMO.State</span></span><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span></span><br><span><var>Observation</var><span><span class="hyp-body"><b>:= </b><span>BaseELMO.Observation</span></span><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span></span><br><span><var>Message</var><span><span class="hyp-body"><b>:= </b><span>BaseELMO.Message</span></span><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span></span><br><span><var>s</var><span class="hyp-type"><b>: </b><span>BaseELMO.State</span></span></span><br><span><var>l</var><span class="hyp-type"><b>: </b><span>Label</span></span></span><br><span><var>m</var><span class="hyp-type"><b>: </b><span>BaseELMO.Message</span></span></span><br><span><var>os</var><span class="hyp-type"><b>: </b><span>list BaseELMO.Observation</span></span></span><br><span><var>a</var><span class="hyp-type"><b>: </b><span>Address</span></span></span><br><span><var>Hindm</var><span class="hyp-type"><b>: </b><span><span class="kr">‚àÄ</span> <span class="nv">dm</span> : Message,
  dm
  ‚àà set_map message
      (rec_obs_fn
         (state
            (message
               {| label := l; message := m |})))
  ‚Üî msg_dep_happens_before
      Message_dependencies dm
      {|
        state :=
          state
            (message
               {| label := l; message := m |})
      |}</span></span></span><br><span><var>Hindos</var><span class="hyp-type"><b>: </b><span><span class="kr">‚àÄ</span> <span class="nv">dm</span> : Message,
  dm
  ‚àà set_map message
      (rec_obs_fn {| obs := os; adr := a |})
  ‚Üî msg_dep_happens_before
      Message_dependencies dm
      {|
        state := {| obs := os; adr := a |}
      |}</span></span></span><br><span><var>dm</var><span class="hyp-type"><b>: </b><span>Message</span></span></span><br><span><var>y</var><span class="hyp-type"><b>: </b><span>BaseELMO.Message</span></span></span><br><span><var>Hb</var><span class="hyp-type"><b>: </b><span>msg_dep_happens_before Message_dependencies dm y</span></span></span><br><span><var>Hos</var><span class="hyp-type"><b>: </b><span>y ‚àà list_to_set (map message os)</span></span></span><br></div><label class="goal-separator" for="BaseELMO-v-chkde"><hr></label><div class="goal-conclusion">msg_dep_happens_before Message_dependencies dm
  {| state := {| obs := os; adr := a |} |}</div></blockquote></div></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">        </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="BaseELMO-v-chkdf" style="display: none" type="checkbox"><label class="alectryon-input" for="BaseELMO-v-chkdf">{</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>Address</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>EqDecision0</var><span class="hyp-type"><b>: </b><span>EqDecision Address</span></span></span><br><span><var>State</var><span><span class="hyp-body"><b>:= </b><span>BaseELMO.State</span></span><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span></span><br><span><var>Observation</var><span><span class="hyp-body"><b>:= </b><span>BaseELMO.Observation</span></span><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span></span><br><span><var>Message</var><span><span class="hyp-body"><b>:= </b><span>BaseELMO.Message</span></span><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span></span><br><span><var>s</var><span class="hyp-type"><b>: </b><span>BaseELMO.State</span></span></span><br><span><var>l</var><span class="hyp-type"><b>: </b><span>Label</span></span></span><br><span><var>m</var><span class="hyp-type"><b>: </b><span>BaseELMO.Message</span></span></span><br><span><var>os</var><span class="hyp-type"><b>: </b><span>list BaseELMO.Observation</span></span></span><br><span><var>a</var><span class="hyp-type"><b>: </b><span>Address</span></span></span><br><span><var>Hindm</var><span class="hyp-type"><b>: </b><span><span class="kr">‚àÄ</span> <span class="nv">dm</span> : Message,
  dm
  ‚àà set_map message
      (rec_obs_fn
         (state
            (message
               {| label := l; message := m |})))
  ‚Üî msg_dep_happens_before
      Message_dependencies dm
      {|
        state :=
          state
            (message
               {| label := l; message := m |})
      |}</span></span></span><br><span><var>Hindos</var><span class="hyp-type"><b>: </b><span><span class="kr">‚àÄ</span> <span class="nv">dm</span> : Message,
  dm
  ‚àà set_map message
      (rec_obs_fn {| obs := os; adr := a |})
  ‚Üî msg_dep_happens_before
      Message_dependencies dm
      {|
        state := {| obs := os; adr := a |}
      |}</span></span></span><br><span><var>dm</var><span class="hyp-type"><b>: </b><span>Message</span></span></span><br><span><var>y</var><span class="hyp-type"><b>: </b><span>BaseELMO.Message</span></span></span><br><span><var>Hb</var><span class="hyp-type"><b>: </b><span>msg_dep_happens_before Message_dependencies dm y</span></span></span><br><span><var>Hos</var><span class="hyp-type"><b>: </b><span>y ‚àà list_to_set (map message os)</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">msg_dep_happens_before Message_dependencies dm
  {| state := {| obs := os; adr := a |} |}
‚Üí <span class="kr">‚àÉ</span> <span class="nv">x</span> : BaseELMO.Observation,
    dm = message x
    ‚àß ((x = {| label := l; message := m |}
        ‚à® x ‚àà rec_obs_fn (state m))
       ‚à® x ‚àà rec_obs_fn {| obs := os; adr := a |})</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">          </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="BaseELMO-v-chke0" style="display: none" type="checkbox"><label class="alectryon-input" for="BaseELMO-v-chke0"><span class="nb">intros</span> (z &amp; -&gt; &amp; Hz)%Hindos%elem_of_map.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>Address</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>EqDecision0</var><span class="hyp-type"><b>: </b><span>EqDecision Address</span></span></span><br><span><var>State</var><span><span class="hyp-body"><b>:= </b><span>BaseELMO.State</span></span><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span></span><br><span><var>Observation</var><span><span class="hyp-body"><b>:= </b><span>BaseELMO.Observation</span></span><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span></span><br><span><var>Message</var><span><span class="hyp-body"><b>:= </b><span>BaseELMO.Message</span></span><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span></span><br><span><var>s</var><span class="hyp-type"><b>: </b><span>BaseELMO.State</span></span></span><br><span><var>l</var><span class="hyp-type"><b>: </b><span>Label</span></span></span><br><span><var>m</var><span class="hyp-type"><b>: </b><span>BaseELMO.Message</span></span></span><br><span><var>os</var><span class="hyp-type"><b>: </b><span>list BaseELMO.Observation</span></span></span><br><span><var>a</var><span class="hyp-type"><b>: </b><span>Address</span></span></span><br><span><var>Hindm</var><span class="hyp-type"><b>: </b><span><span class="kr">‚àÄ</span> <span class="nv">dm</span> : Message,
  dm
  ‚àà set_map message
      (rec_obs_fn
         (state
            (message
               {| label := l; message := m |})))
  ‚Üî msg_dep_happens_before
      Message_dependencies dm
      {|
        state :=
          state
            (message
               {| label := l; message := m |})
      |}</span></span></span><br><span><var>Hindos</var><span class="hyp-type"><b>: </b><span><span class="kr">‚àÄ</span> <span class="nv">dm</span> : Message,
  dm
  ‚àà set_map message
      (rec_obs_fn {| obs := os; adr := a |})
  ‚Üî msg_dep_happens_before
      Message_dependencies dm
      {|
        state := {| obs := os; adr := a |}
      |}</span></span></span><br><span><var>y</var><span class="hyp-type"><b>: </b><span>BaseELMO.Message</span></span></span><br><span><var>z</var><span class="hyp-type"><b>: </b><span>BaseELMO.Observation</span></span></span><br><span><var>Hb</var><span class="hyp-type"><b>: </b><span>msg_dep_happens_before Message_dependencies
  (message z) y</span></span></span><br><span><var>Hos</var><span class="hyp-type"><b>: </b><span>y ‚àà list_to_set (map message os)</span></span></span><br><span><var>Hz</var><span class="hyp-type"><b>: </b><span>z ‚àà rec_obs_fn {| obs := os; adr := a |}</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="kr">‚àÉ</span> <span class="nv">x</span> : BaseELMO.Observation,
  message z = message x
  ‚àß ((x = {| label := l; message := m |}
      ‚à® x ‚àà rec_obs_fn (state m))
     ‚à® x ‚àà rec_obs_fn {| obs := os; adr := a |})</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">          </span><span class="alectryon-sentence"><span class="alectryon-input"><span class="bp">by</span> <span class="nb">eexists</span>; <span class="nb">split</span>; [| <span class="nb">right</span>].</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">        </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="BaseELMO-v-chke1" style="display: none" type="checkbox"><label class="alectryon-input" for="BaseELMO-v-chke1">}</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>Address</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>EqDecision0</var><span class="hyp-type"><b>: </b><span>EqDecision Address</span></span></span><br><span><var>State</var><span><span class="hyp-body"><b>:= </b><span>BaseELMO.State</span></span><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span></span><br><span><var>Observation</var><span><span class="hyp-body"><b>:= </b><span>BaseELMO.Observation</span></span><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span></span><br><span><var>Message</var><span><span class="hyp-body"><b>:= </b><span>BaseELMO.Message</span></span><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span></span><br><span><var>s</var><span class="hyp-type"><b>: </b><span>BaseELMO.State</span></span></span><br><span><var>l</var><span class="hyp-type"><b>: </b><span>Label</span></span></span><br><span><var>m</var><span class="hyp-type"><b>: </b><span>BaseELMO.Message</span></span></span><br><span><var>os</var><span class="hyp-type"><b>: </b><span>list BaseELMO.Observation</span></span></span><br><span><var>a</var><span class="hyp-type"><b>: </b><span>Address</span></span></span><br><span><var>Hindm</var><span class="hyp-type"><b>: </b><span><span class="kr">‚àÄ</span> <span class="nv">dm</span> : Message,
  dm
  ‚àà set_map message
      (rec_obs_fn
         (state
            (message
               {| label := l; message := m |})))
  ‚Üî msg_dep_happens_before
      Message_dependencies dm
      {|
        state :=
          state
            (message
               {| label := l; message := m |})
      |}</span></span></span><br><span><var>Hindos</var><span class="hyp-type"><b>: </b><span><span class="kr">‚àÄ</span> <span class="nv">dm</span> : Message,
  dm
  ‚àà set_map message
      (rec_obs_fn {| obs := os; adr := a |})
  ‚Üî msg_dep_happens_before
      Message_dependencies dm
      {|
        state := {| obs := os; adr := a |}
      |}</span></span></span><br><span><var>dm</var><span class="hyp-type"><b>: </b><span>Message</span></span></span><br><span><var>y</var><span class="hyp-type"><b>: </b><span>BaseELMO.Message</span></span></span><br><span><var>Hb</var><span class="hyp-type"><b>: </b><span>msg_dep_happens_before Message_dependencies dm y</span></span></span><br><span><var>Hos</var><span class="hyp-type"><b>: </b><span>y ‚àà list_to_set (map message os)</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">msg_dep_happens_before Message_dependencies dm
  {| state := {| obs := os; adr := a |} |}</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">        </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="BaseELMO-v-chke2" style="display: none" type="checkbox"><label class="alectryon-input" for="BaseELMO-v-chke2"><span class="nb">transitivity</span> y; [<span class="bp">done</span> |].</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>Address</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>EqDecision0</var><span class="hyp-type"><b>: </b><span>EqDecision Address</span></span></span><br><span><var>State</var><span><span class="hyp-body"><b>:= </b><span>BaseELMO.State</span></span><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span></span><br><span><var>Observation</var><span><span class="hyp-body"><b>:= </b><span>BaseELMO.Observation</span></span><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span></span><br><span><var>Message</var><span><span class="hyp-body"><b>:= </b><span>BaseELMO.Message</span></span><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span></span><br><span><var>s</var><span class="hyp-type"><b>: </b><span>BaseELMO.State</span></span></span><br><span><var>l</var><span class="hyp-type"><b>: </b><span>Label</span></span></span><br><span><var>m</var><span class="hyp-type"><b>: </b><span>BaseELMO.Message</span></span></span><br><span><var>os</var><span class="hyp-type"><b>: </b><span>list BaseELMO.Observation</span></span></span><br><span><var>a</var><span class="hyp-type"><b>: </b><span>Address</span></span></span><br><span><var>Hindm</var><span class="hyp-type"><b>: </b><span><span class="kr">‚àÄ</span> <span class="nv">dm</span> : Message,
  dm
  ‚àà set_map message
      (rec_obs_fn
         (state
            (message
               {| label := l; message := m |})))
  ‚Üî msg_dep_happens_before
      Message_dependencies dm
      {|
        state :=
          state
            (message
               {| label := l; message := m |})
      |}</span></span></span><br><span><var>Hindos</var><span class="hyp-type"><b>: </b><span><span class="kr">‚àÄ</span> <span class="nv">dm</span> : Message,
  dm
  ‚àà set_map message
      (rec_obs_fn {| obs := os; adr := a |})
  ‚Üî msg_dep_happens_before
      Message_dependencies dm
      {|
        state := {| obs := os; adr := a |}
      |}</span></span></span><br><span><var>dm</var><span class="hyp-type"><b>: </b><span>Message</span></span></span><br><span><var>y</var><span class="hyp-type"><b>: </b><span>BaseELMO.Message</span></span></span><br><span><var>Hb</var><span class="hyp-type"><b>: </b><span>msg_dep_happens_before Message_dependencies dm y</span></span></span><br><span><var>Hos</var><span class="hyp-type"><b>: </b><span>y ‚àà list_to_set (map message os)</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">msg_dep_happens_before Message_dependencies y
  {| state := {| obs := os; adr := a |} |}</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">        </span><span class="alectryon-sentence"><span class="alectryon-input"><span class="bp">by</span> <span class="nb">apply</span> msg_dep_happens_before_iff_one; <span class="nb">left</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Qed</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
</span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Context</span>
  `{finite.Finite index}
  `{Inhabited index}
  (idx : index -&gt; Address)
  `{!Inj (=) (=) idx}
  .</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
</span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Definition</span> <span class="nf">adr2idx</span> (<span class="nv">a</span> : Address) : option index :=
  head (filter (<span class="kr">fun</span> <span class="nv">i</span> =&gt; idx i = a) (enum index)).</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
</span><span class="alectryon-sentence"><input class="alectryon-toggle" id="BaseELMO-v-chke3" style="display: none" type="checkbox"><label class="alectryon-input" for="BaseELMO-v-chke3"><span class="kn">Lemma</span> <span class="nf">adr2idx_idx</span> :
  <span class="kr">forall</span> (<span class="nv">i</span> : index),
    adr2idx (idx i) = Some i.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>Address</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>EqDecision0</var><span class="hyp-type"><b>: </b><span>EqDecision Address</span></span></span><br><span><var>State</var><span><span class="hyp-body"><b>:= </b><span>BaseELMO.State</span></span><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span></span><br><span><var>Observation</var><span><span class="hyp-body"><b>:= </b><span>BaseELMO.Observation</span></span><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span></span><br><span><var>Message</var><span><span class="hyp-body"><b>:= </b><span>BaseELMO.Message</span></span><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span></span><br><span><var>index</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>EqDecision1</var><span class="hyp-type"><b>: </b><span>EqDecision index</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>finite.Finite index</span></span></span><br><span><var>H0</var><span class="hyp-type"><b>: </b><span>Inhabited index</span></span></span><br><span><var>idx</var><span class="hyp-type"><b>: </b><span>index ‚Üí Address</span></span></span><br><span><var>Inj0</var><span class="hyp-type"><b>: </b><span>Inj eq eq idx</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="kr">‚àÄ</span> <span class="nv">i</span> : index, adr2idx (idx i) = Some i</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="BaseELMO-v-chke4" style="display: none" type="checkbox"><label class="alectryon-input" for="BaseELMO-v-chke4"><span class="kn">Proof</span>.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>Address</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>EqDecision0</var><span class="hyp-type"><b>: </b><span>EqDecision Address</span></span></span><br><span><var>State</var><span><span class="hyp-body"><b>:= </b><span>BaseELMO.State</span></span><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span></span><br><span><var>Observation</var><span><span class="hyp-body"><b>:= </b><span>BaseELMO.Observation</span></span><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span></span><br><span><var>Message</var><span><span class="hyp-body"><b>:= </b><span>BaseELMO.Message</span></span><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span></span><br><span><var>index</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>EqDecision1</var><span class="hyp-type"><b>: </b><span>EqDecision index</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>finite.Finite index</span></span></span><br><span><var>H0</var><span class="hyp-type"><b>: </b><span>Inhabited index</span></span></span><br><span><var>idx</var><span class="hyp-type"><b>: </b><span>index ‚Üí Address</span></span></span><br><span><var>Inj0</var><span class="hyp-type"><b>: </b><span>Inj eq eq idx</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="kr">‚àÄ</span> <span class="nv">i</span> : index, adr2idx (idx i) = Some i</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="BaseELMO-v-chke5" style="display: none" type="checkbox"><label class="alectryon-input" for="BaseELMO-v-chke5"><span class="nb">intro</span> i; <span class="nb">unfold</span> adr2idx; <span class="nb">cbn</span>.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>Address</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>EqDecision0</var><span class="hyp-type"><b>: </b><span>EqDecision Address</span></span></span><br><span><var>State</var><span><span class="hyp-body"><b>:= </b><span>BaseELMO.State</span></span><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span></span><br><span><var>Observation</var><span><span class="hyp-body"><b>:= </b><span>BaseELMO.Observation</span></span><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span></span><br><span><var>Message</var><span><span class="hyp-body"><b>:= </b><span>BaseELMO.Message</span></span><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span></span><br><span><var>index</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>EqDecision1</var><span class="hyp-type"><b>: </b><span>EqDecision index</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>finite.Finite index</span></span></span><br><span><var>H0</var><span class="hyp-type"><b>: </b><span>Inhabited index</span></span></span><br><span><var>idx</var><span class="hyp-type"><b>: </b><span>index ‚Üí Address</span></span></span><br><span><var>Inj0</var><span class="hyp-type"><b>: </b><span>Inj eq eq idx</span></span></span><br><span><var>i</var><span class="hyp-type"><b>: </b><span>index</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">head
  (filter (<span class="kr">Œª</span> <span class="nv">i0</span> : index, idx i0 = idx i) (enum index)) =
Some i</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="BaseELMO-v-chke6" style="display: none" type="checkbox"><label class="alectryon-input" for="BaseELMO-v-chke6"><span class="nb">replace</span> (filter _ _) <span class="kr">with</span> [i]; [<span class="bp">done</span> |].</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>Address</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>EqDecision0</var><span class="hyp-type"><b>: </b><span>EqDecision Address</span></span></span><br><span><var>State</var><span><span class="hyp-body"><b>:= </b><span>BaseELMO.State</span></span><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span></span><br><span><var>Observation</var><span><span class="hyp-body"><b>:= </b><span>BaseELMO.Observation</span></span><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span></span><br><span><var>Message</var><span><span class="hyp-body"><b>:= </b><span>BaseELMO.Message</span></span><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span></span><br><span><var>index</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>EqDecision1</var><span class="hyp-type"><b>: </b><span>EqDecision index</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>finite.Finite index</span></span></span><br><span><var>H0</var><span class="hyp-type"><b>: </b><span>Inhabited index</span></span></span><br><span><var>idx</var><span class="hyp-type"><b>: </b><span>index ‚Üí Address</span></span></span><br><span><var>Inj0</var><span class="hyp-type"><b>: </b><span>Inj eq eq idx</span></span></span><br><span><var>i</var><span class="hyp-type"><b>: </b><span>index</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">[i] =
filter (<span class="kr">Œª</span> <span class="nv">i0</span> : index, idx i0 = idx i) (enum index)</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="BaseELMO-v-chke7" style="display: none" type="checkbox"><label class="alectryon-input" for="BaseELMO-v-chke7"><span class="nb">generalize</span> (enum index), (NoDup_enum index) <span class="kr">as</span> Hnodup, (elem_of_enum i) <span class="kr">as</span> Hi.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>Address</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>EqDecision0</var><span class="hyp-type"><b>: </b><span>EqDecision Address</span></span></span><br><span><var>State</var><span><span class="hyp-body"><b>:= </b><span>BaseELMO.State</span></span><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span></span><br><span><var>Observation</var><span><span class="hyp-body"><b>:= </b><span>BaseELMO.Observation</span></span><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span></span><br><span><var>Message</var><span><span class="hyp-body"><b>:= </b><span>BaseELMO.Message</span></span><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span></span><br><span><var>index</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>EqDecision1</var><span class="hyp-type"><b>: </b><span>EqDecision index</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>finite.Finite index</span></span></span><br><span><var>H0</var><span class="hyp-type"><b>: </b><span>Inhabited index</span></span></span><br><span><var>idx</var><span class="hyp-type"><b>: </b><span>index ‚Üí Address</span></span></span><br><span><var>Inj0</var><span class="hyp-type"><b>: </b><span>Inj eq eq idx</span></span></span><br><span><var>i</var><span class="hyp-type"><b>: </b><span>index</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="kr">‚àÄ</span> <span class="nv">l</span> : list index,
  NoDup l
  ‚Üí i ‚àà l
    ‚Üí [i] = filter (<span class="kr">Œª</span> <span class="nv">i0</span> : index, idx i0 = idx i) l</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="BaseELMO-v-chke8" style="display: none" type="checkbox"><label class="alectryon-input" for="BaseELMO-v-chke8"><span class="nb">induction</span> l; <span class="nb">intros</span>; [<span class="bp">by</span> <span class="nb">inversion</span> Hi |].</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>Address</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>EqDecision0</var><span class="hyp-type"><b>: </b><span>EqDecision Address</span></span></span><br><span><var>State</var><span><span class="hyp-body"><b>:= </b><span>BaseELMO.State</span></span><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span></span><br><span><var>Observation</var><span><span class="hyp-body"><b>:= </b><span>BaseELMO.Observation</span></span><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span></span><br><span><var>Message</var><span><span class="hyp-body"><b>:= </b><span>BaseELMO.Message</span></span><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span></span><br><span><var>index</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>EqDecision1</var><span class="hyp-type"><b>: </b><span>EqDecision index</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>finite.Finite index</span></span></span><br><span><var>H0</var><span class="hyp-type"><b>: </b><span>Inhabited index</span></span></span><br><span><var>idx</var><span class="hyp-type"><b>: </b><span>index ‚Üí Address</span></span></span><br><span><var>Inj0</var><span class="hyp-type"><b>: </b><span>Inj eq eq idx</span></span></span><br><span><var>i, a</var><span class="hyp-type"><b>: </b><span>index</span></span></span><br><span><var>l</var><span class="hyp-type"><b>: </b><span>list index</span></span></span><br><span><var>IHl</var><span class="hyp-type"><b>: </b><span>NoDup l
‚Üí i ‚àà l
  ‚Üí [i] =
    filter (<span class="kr">Œª</span> <span class="nv">i0</span> : index, idx i0 = idx i) l</span></span></span><br><span><var>Hnodup</var><span class="hyp-type"><b>: </b><span>NoDup (a :: l)</span></span></span><br><span><var>Hi</var><span class="hyp-type"><b>: </b><span>i ‚àà a :: l</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">[i] = filter (<span class="kr">Œª</span> <span class="nv">i0</span> : index, idx i0 = idx i) (a :: l)</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="BaseELMO-v-chke9" style="display: none" type="checkbox"><label class="alectryon-input" for="BaseELMO-v-chke9"><span class="nb">inversion</span> Hnodup; <span class="nb">subst</span>.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>Address</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>EqDecision0</var><span class="hyp-type"><b>: </b><span>EqDecision Address</span></span></span><br><span><var>State</var><span><span class="hyp-body"><b>:= </b><span>BaseELMO.State</span></span><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span></span><br><span><var>Observation</var><span><span class="hyp-body"><b>:= </b><span>BaseELMO.Observation</span></span><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span></span><br><span><var>Message</var><span><span class="hyp-body"><b>:= </b><span>BaseELMO.Message</span></span><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span></span><br><span><var>index</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>EqDecision1</var><span class="hyp-type"><b>: </b><span>EqDecision index</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>finite.Finite index</span></span></span><br><span><var>H0</var><span class="hyp-type"><b>: </b><span>Inhabited index</span></span></span><br><span><var>idx</var><span class="hyp-type"><b>: </b><span>index ‚Üí Address</span></span></span><br><span><var>Inj0</var><span class="hyp-type"><b>: </b><span>Inj eq eq idx</span></span></span><br><span><var>i, a</var><span class="hyp-type"><b>: </b><span>index</span></span></span><br><span><var>l</var><span class="hyp-type"><b>: </b><span>list index</span></span></span><br><span><var>IHl</var><span class="hyp-type"><b>: </b><span>NoDup l
‚Üí i ‚àà l
  ‚Üí [i] =
    filter (<span class="kr">Œª</span> <span class="nv">i0</span> : index, idx i0 = idx i) l</span></span></span><br><span><var>Hnodup</var><span class="hyp-type"><b>: </b><span>NoDup (a :: l)</span></span></span><br><span><var>Hi</var><span class="hyp-type"><b>: </b><span>i ‚àà a :: l</span></span></span><br><span><var>H3</var><span class="hyp-type"><b>: </b><span>a ‚àâ l</span></span></span><br><span><var>H4</var><span class="hyp-type"><b>: </b><span>NoDup l</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">[i] = filter (<span class="kr">Œª</span> <span class="nv">i0</span> : index, idx i0 = idx i) (a :: l)</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="BaseELMO-v-chkea" style="display: none" type="checkbox"><label class="alectryon-input" for="BaseELMO-v-chkea"><span class="nb">assert</span> (Hnil : <span class="kr">forall</span> <span class="nv">i</span>, i ‚àâ l -&gt; filter (<span class="kr">fun</span> <span class="nv">i0</span> : index =&gt; idx i0 = idx i) l = []).</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>Address</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>EqDecision0</var><span class="hyp-type"><b>: </b><span>EqDecision Address</span></span></span><br><span><var>State</var><span><span class="hyp-body"><b>:= </b><span>BaseELMO.State</span></span><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span></span><br><span><var>Observation</var><span><span class="hyp-body"><b>:= </b><span>BaseELMO.Observation</span></span><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span></span><br><span><var>Message</var><span><span class="hyp-body"><b>:= </b><span>BaseELMO.Message</span></span><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span></span><br><span><var>index</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>EqDecision1</var><span class="hyp-type"><b>: </b><span>EqDecision index</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>finite.Finite index</span></span></span><br><span><var>H0</var><span class="hyp-type"><b>: </b><span>Inhabited index</span></span></span><br><span><var>idx</var><span class="hyp-type"><b>: </b><span>index ‚Üí Address</span></span></span><br><span><var>Inj0</var><span class="hyp-type"><b>: </b><span>Inj eq eq idx</span></span></span><br><span><var>i, a</var><span class="hyp-type"><b>: </b><span>index</span></span></span><br><span><var>l</var><span class="hyp-type"><b>: </b><span>list index</span></span></span><br><span><var>IHl</var><span class="hyp-type"><b>: </b><span>NoDup l
‚Üí i ‚àà l
  ‚Üí [i] =
    filter (<span class="kr">Œª</span> <span class="nv">i0</span> : index, idx i0 = idx i) l</span></span></span><br><span><var>Hnodup</var><span class="hyp-type"><b>: </b><span>NoDup (a :: l)</span></span></span><br><span><var>Hi</var><span class="hyp-type"><b>: </b><span>i ‚àà a :: l</span></span></span><br><span><var>H3</var><span class="hyp-type"><b>: </b><span>a ‚àâ l</span></span></span><br><span><var>H4</var><span class="hyp-type"><b>: </b><span>NoDup l</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="kr">‚àÄ</span> <span class="nv">i</span> : index,
  i ‚àâ l ‚Üí filter (<span class="kr">Œª</span> <span class="nv">i0</span> : index, idx i0 = idx i) l = []</div></blockquote><div class="alectryon-extra-goals"><input class="alectryon-extra-goal-toggle" id="BaseELMO-v-chkeb" style="display: none" type="checkbox"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>Address</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>EqDecision0</var><span class="hyp-type"><b>: </b><span>EqDecision Address</span></span></span><br><span><var>State</var><span><span class="hyp-body"><b>:= </b><span>BaseELMO.State</span></span><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span></span><br><span><var>Observation</var><span><span class="hyp-body"><b>:= </b><span>BaseELMO.Observation</span></span><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span></span><br><span><var>Message</var><span><span class="hyp-body"><b>:= </b><span>BaseELMO.Message</span></span><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span></span><br><span><var>index</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>EqDecision1</var><span class="hyp-type"><b>: </b><span>EqDecision index</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>finite.Finite index</span></span></span><br><span><var>H0</var><span class="hyp-type"><b>: </b><span>Inhabited index</span></span></span><br><span><var>idx</var><span class="hyp-type"><b>: </b><span>index ‚Üí Address</span></span></span><br><span><var>Inj0</var><span class="hyp-type"><b>: </b><span>Inj eq eq idx</span></span></span><br><span><var>i, a</var><span class="hyp-type"><b>: </b><span>index</span></span></span><br><span><var>l</var><span class="hyp-type"><b>: </b><span>list index</span></span></span><br><span><var>IHl</var><span class="hyp-type"><b>: </b><span>NoDup l
‚Üí i ‚àà l
  ‚Üí [i] =
    filter (<span class="kr">Œª</span> <span class="nv">i0</span> : index, idx i0 = idx i) l</span></span></span><br><span><var>Hnodup</var><span class="hyp-type"><b>: </b><span>NoDup (a :: l)</span></span></span><br><span><var>Hi</var><span class="hyp-type"><b>: </b><span>i ‚àà a :: l</span></span></span><br><span><var>H3</var><span class="hyp-type"><b>: </b><span>a ‚àâ l</span></span></span><br><span><var>H4</var><span class="hyp-type"><b>: </b><span>NoDup l</span></span></span><br><span><var>Hnil</var><span class="hyp-type"><b>: </b><span><span class="kr">‚àÄ</span> <span class="nv">i</span> : index,
  i ‚àâ l
  ‚Üí filter (<span class="kr">Œª</span> <span class="nv">i0</span> : index, idx i0 = idx i) l =
    []</span></span></span><br></div><label class="goal-separator" for="BaseELMO-v-chkeb"><hr></label><div class="goal-conclusion">[i] = filter (<span class="kr">Œª</span> <span class="nv">i0</span> : index, idx i0 = idx i) (a :: l)</div></blockquote></div></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="BaseELMO-v-chkec" style="display: none" type="checkbox"><label class="alectryon-input" for="BaseELMO-v-chkec">{</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>Address</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>EqDecision0</var><span class="hyp-type"><b>: </b><span>EqDecision Address</span></span></span><br><span><var>State</var><span><span class="hyp-body"><b>:= </b><span>BaseELMO.State</span></span><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span></span><br><span><var>Observation</var><span><span class="hyp-body"><b>:= </b><span>BaseELMO.Observation</span></span><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span></span><br><span><var>Message</var><span><span class="hyp-body"><b>:= </b><span>BaseELMO.Message</span></span><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span></span><br><span><var>index</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>EqDecision1</var><span class="hyp-type"><b>: </b><span>EqDecision index</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>finite.Finite index</span></span></span><br><span><var>H0</var><span class="hyp-type"><b>: </b><span>Inhabited index</span></span></span><br><span><var>idx</var><span class="hyp-type"><b>: </b><span>index ‚Üí Address</span></span></span><br><span><var>Inj0</var><span class="hyp-type"><b>: </b><span>Inj eq eq idx</span></span></span><br><span><var>i, a</var><span class="hyp-type"><b>: </b><span>index</span></span></span><br><span><var>l</var><span class="hyp-type"><b>: </b><span>list index</span></span></span><br><span><var>IHl</var><span class="hyp-type"><b>: </b><span>NoDup l
‚Üí i ‚àà l
  ‚Üí [i] =
    filter (<span class="kr">Œª</span> <span class="nv">i0</span> : index, idx i0 = idx i) l</span></span></span><br><span><var>Hnodup</var><span class="hyp-type"><b>: </b><span>NoDup (a :: l)</span></span></span><br><span><var>Hi</var><span class="hyp-type"><b>: </b><span>i ‚àà a :: l</span></span></span><br><span><var>H3</var><span class="hyp-type"><b>: </b><span>a ‚àâ l</span></span></span><br><span><var>H4</var><span class="hyp-type"><b>: </b><span>NoDup l</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="kr">‚àÄ</span> <span class="nv">i</span> : index,
  i ‚àâ l ‚Üí filter (<span class="kr">Œª</span> <span class="nv">i0</span> : index, idx i0 = idx i) l = []</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="BaseELMO-v-chked" style="display: none" type="checkbox"><label class="alectryon-input" for="BaseELMO-v-chked"><span class="nb">intros</span>; <span class="nb">apply</span> Forall_filter_nil, Forall_forall.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>Address</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>EqDecision0</var><span class="hyp-type"><b>: </b><span>EqDecision Address</span></span></span><br><span><var>State</var><span><span class="hyp-body"><b>:= </b><span>BaseELMO.State</span></span><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span></span><br><span><var>Observation</var><span><span class="hyp-body"><b>:= </b><span>BaseELMO.Observation</span></span><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span></span><br><span><var>Message</var><span><span class="hyp-body"><b>:= </b><span>BaseELMO.Message</span></span><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span></span><br><span><var>index</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>EqDecision1</var><span class="hyp-type"><b>: </b><span>EqDecision index</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>finite.Finite index</span></span></span><br><span><var>H0</var><span class="hyp-type"><b>: </b><span>Inhabited index</span></span></span><br><span><var>idx</var><span class="hyp-type"><b>: </b><span>index ‚Üí Address</span></span></span><br><span><var>Inj0</var><span class="hyp-type"><b>: </b><span>Inj eq eq idx</span></span></span><br><span><var>i, a</var><span class="hyp-type"><b>: </b><span>index</span></span></span><br><span><var>l</var><span class="hyp-type"><b>: </b><span>list index</span></span></span><br><span><var>IHl</var><span class="hyp-type"><b>: </b><span>NoDup l
‚Üí i ‚àà l
  ‚Üí [i] =
    filter (<span class="kr">Œª</span> <span class="nv">i0</span> : index, idx i0 = idx i) l</span></span></span><br><span><var>Hnodup</var><span class="hyp-type"><b>: </b><span>NoDup (a :: l)</span></span></span><br><span><var>Hi</var><span class="hyp-type"><b>: </b><span>i ‚àà a :: l</span></span></span><br><span><var>H3</var><span class="hyp-type"><b>: </b><span>a ‚àâ l</span></span></span><br><span><var>H4</var><span class="hyp-type"><b>: </b><span>NoDup l</span></span></span><br><span><var>i0</var><span class="hyp-type"><b>: </b><span>index</span></span></span><br><span><var>H1</var><span class="hyp-type"><b>: </b><span>i0 ‚àâ l</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="kr">‚àÄ</span> <span class="nv">x</span> : index, x ‚àà l ‚Üí idx x ‚â† idx i0</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="BaseELMO-v-chkee" style="display: none" type="checkbox"><label class="alectryon-input" for="BaseELMO-v-chkee"><span class="nb">intros</span> j Hj; <span class="bp">contradict</span> Hj.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>Address</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>EqDecision0</var><span class="hyp-type"><b>: </b><span>EqDecision Address</span></span></span><br><span><var>State</var><span><span class="hyp-body"><b>:= </b><span>BaseELMO.State</span></span><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span></span><br><span><var>Observation</var><span><span class="hyp-body"><b>:= </b><span>BaseELMO.Observation</span></span><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span></span><br><span><var>Message</var><span><span class="hyp-body"><b>:= </b><span>BaseELMO.Message</span></span><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span></span><br><span><var>index</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>EqDecision1</var><span class="hyp-type"><b>: </b><span>EqDecision index</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>finite.Finite index</span></span></span><br><span><var>H0</var><span class="hyp-type"><b>: </b><span>Inhabited index</span></span></span><br><span><var>idx</var><span class="hyp-type"><b>: </b><span>index ‚Üí Address</span></span></span><br><span><var>Inj0</var><span class="hyp-type"><b>: </b><span>Inj eq eq idx</span></span></span><br><span><var>i, a</var><span class="hyp-type"><b>: </b><span>index</span></span></span><br><span><var>l</var><span class="hyp-type"><b>: </b><span>list index</span></span></span><br><span><var>IHl</var><span class="hyp-type"><b>: </b><span>NoDup l
‚Üí i ‚àà l
  ‚Üí [i] =
    filter (<span class="kr">Œª</span> <span class="nv">i0</span> : index, idx i0 = idx i) l</span></span></span><br><span><var>Hnodup</var><span class="hyp-type"><b>: </b><span>NoDup (a :: l)</span></span></span><br><span><var>Hi</var><span class="hyp-type"><b>: </b><span>i ‚àà a :: l</span></span></span><br><span><var>H3</var><span class="hyp-type"><b>: </b><span>a ‚àâ l</span></span></span><br><span><var>H4</var><span class="hyp-type"><b>: </b><span>NoDup l</span></span></span><br><span><var>i0</var><span class="hyp-type"><b>: </b><span>index</span></span></span><br><span><var>H1</var><span class="hyp-type"><b>: </b><span>i0 ‚àâ l</span></span></span><br><span><var>j</var><span class="hyp-type"><b>: </b><span>index</span></span></span><br><span><var>Hj</var><span class="hyp-type"><b>: </b><span>idx j = idx i0</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">j ‚àâ l</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><span class="alectryon-input"><span class="bp">by</span> <span class="nb">eapply</span> inj <span class="kr">in</span> Hj; [| <span class="bp">done</span>]; <span class="nb">subst</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="BaseELMO-v-chkef" style="display: none" type="checkbox"><label class="alectryon-input" for="BaseELMO-v-chkef">}</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>Address</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>EqDecision0</var><span class="hyp-type"><b>: </b><span>EqDecision Address</span></span></span><br><span><var>State</var><span><span class="hyp-body"><b>:= </b><span>BaseELMO.State</span></span><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span></span><br><span><var>Observation</var><span><span class="hyp-body"><b>:= </b><span>BaseELMO.Observation</span></span><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span></span><br><span><var>Message</var><span><span class="hyp-body"><b>:= </b><span>BaseELMO.Message</span></span><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span></span><br><span><var>index</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>EqDecision1</var><span class="hyp-type"><b>: </b><span>EqDecision index</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>finite.Finite index</span></span></span><br><span><var>H0</var><span class="hyp-type"><b>: </b><span>Inhabited index</span></span></span><br><span><var>idx</var><span class="hyp-type"><b>: </b><span>index ‚Üí Address</span></span></span><br><span><var>Inj0</var><span class="hyp-type"><b>: </b><span>Inj eq eq idx</span></span></span><br><span><var>i, a</var><span class="hyp-type"><b>: </b><span>index</span></span></span><br><span><var>l</var><span class="hyp-type"><b>: </b><span>list index</span></span></span><br><span><var>IHl</var><span class="hyp-type"><b>: </b><span>NoDup l
‚Üí i ‚àà l
  ‚Üí [i] =
    filter (<span class="kr">Œª</span> <span class="nv">i0</span> : index, idx i0 = idx i) l</span></span></span><br><span><var>Hnodup</var><span class="hyp-type"><b>: </b><span>NoDup (a :: l)</span></span></span><br><span><var>Hi</var><span class="hyp-type"><b>: </b><span>i ‚àà a :: l</span></span></span><br><span><var>H3</var><span class="hyp-type"><b>: </b><span>a ‚àâ l</span></span></span><br><span><var>H4</var><span class="hyp-type"><b>: </b><span>NoDup l</span></span></span><br><span><var>Hnil</var><span class="hyp-type"><b>: </b><span><span class="kr">‚àÄ</span> <span class="nv">i</span> : index,
  i ‚àâ l
  ‚Üí filter (<span class="kr">Œª</span> <span class="nv">i0</span> : index, idx i0 = idx i) l =
    []</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">[i] = filter (<span class="kr">Œª</span> <span class="nv">i0</span> : index, idx i0 = idx i) (a :: l)</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="BaseELMO-v-chkf0" style="display: none" type="checkbox"><label class="alectryon-input" for="BaseELMO-v-chkf0"><span class="nb">inversion</span> Hi; <span class="nb">subst</span>; <span class="nb">cbn</span>.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>Address</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>EqDecision0</var><span class="hyp-type"><b>: </b><span>EqDecision Address</span></span></span><br><span><var>State</var><span><span class="hyp-body"><b>:= </b><span>BaseELMO.State</span></span><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span></span><br><span><var>Observation</var><span><span class="hyp-body"><b>:= </b><span>BaseELMO.Observation</span></span><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span></span><br><span><var>Message</var><span><span class="hyp-body"><b>:= </b><span>BaseELMO.Message</span></span><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span></span><br><span><var>index</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>EqDecision1</var><span class="hyp-type"><b>: </b><span>EqDecision index</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>finite.Finite index</span></span></span><br><span><var>H0</var><span class="hyp-type"><b>: </b><span>Inhabited index</span></span></span><br><span><var>idx</var><span class="hyp-type"><b>: </b><span>index ‚Üí Address</span></span></span><br><span><var>Inj0</var><span class="hyp-type"><b>: </b><span>Inj eq eq idx</span></span></span><br><span><var>a</var><span class="hyp-type"><b>: </b><span>index</span></span></span><br><span><var>l</var><span class="hyp-type"><b>: </b><span>list index</span></span></span><br><span><var>IHl</var><span class="hyp-type"><b>: </b><span>NoDup l
‚Üí a ‚àà l
  ‚Üí [a] = filter (<span class="kr">Œª</span> <span class="nv">i</span> : index, idx i = idx a) l</span></span></span><br><span><var>Hnodup</var><span class="hyp-type"><b>: </b><span>NoDup (a :: l)</span></span></span><br><span><var>Hi</var><span class="hyp-type"><b>: </b><span>a ‚àà a :: l</span></span></span><br><span><var>H3</var><span class="hyp-type"><b>: </b><span>a ‚àâ l</span></span></span><br><span><var>H4</var><span class="hyp-type"><b>: </b><span>NoDup l</span></span></span><br><span><var>Hnil</var><span class="hyp-type"><b>: </b><span><span class="kr">‚àÄ</span> <span class="nv">i</span> : index,
  i ‚àâ l
  ‚Üí filter (<span class="kr">Œª</span> <span class="nv">i0</span> : index, idx i0 = idx i) l =
    []</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">[a] =
(<span class="kr">if</span> decide (idx a = idx a)
 <span class="kr">then</span> a :: filter (<span class="kr">Œª</span> <span class="nv">i</span> : index, idx i = idx a) l
 <span class="kr">else</span> filter (<span class="kr">Œª</span> <span class="nv">i</span> : index, idx i = idx a) l)</div></blockquote><div class="alectryon-extra-goals"><input class="alectryon-extra-goal-toggle" id="BaseELMO-v-chkf1" style="display: none" type="checkbox"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>Address</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>EqDecision0</var><span class="hyp-type"><b>: </b><span>EqDecision Address</span></span></span><br><span><var>State</var><span><span class="hyp-body"><b>:= </b><span>BaseELMO.State</span></span><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span></span><br><span><var>Observation</var><span><span class="hyp-body"><b>:= </b><span>BaseELMO.Observation</span></span><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span></span><br><span><var>Message</var><span><span class="hyp-body"><b>:= </b><span>BaseELMO.Message</span></span><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span></span><br><span><var>index</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>EqDecision1</var><span class="hyp-type"><b>: </b><span>EqDecision index</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>finite.Finite index</span></span></span><br><span><var>H0</var><span class="hyp-type"><b>: </b><span>Inhabited index</span></span></span><br><span><var>idx</var><span class="hyp-type"><b>: </b><span>index ‚Üí Address</span></span></span><br><span><var>Inj0</var><span class="hyp-type"><b>: </b><span>Inj eq eq idx</span></span></span><br><span><var>i, a</var><span class="hyp-type"><b>: </b><span>index</span></span></span><br><span><var>l</var><span class="hyp-type"><b>: </b><span>list index</span></span></span><br><span><var>IHl</var><span class="hyp-type"><b>: </b><span>NoDup l
‚Üí i ‚àà l
  ‚Üí [i] =
    filter (<span class="kr">Œª</span> <span class="nv">i0</span> : index, idx i0 = idx i) l</span></span></span><br><span><var>Hnodup</var><span class="hyp-type"><b>: </b><span>NoDup (a :: l)</span></span></span><br><span><var>Hi</var><span class="hyp-type"><b>: </b><span>i ‚àà a :: l</span></span></span><br><span><var>H3</var><span class="hyp-type"><b>: </b><span>a ‚àâ l</span></span></span><br><span><var>H4</var><span class="hyp-type"><b>: </b><span>NoDup l</span></span></span><br><span><var>Hnil</var><span class="hyp-type"><b>: </b><span><span class="kr">‚àÄ</span> <span class="nv">i</span> : index,
  i ‚àâ l
  ‚Üí filter (<span class="kr">Œª</span> <span class="nv">i0</span> : index, idx i0 = idx i) l =
    []</span></span></span><br><span><var>H5</var><span class="hyp-type"><b>: </b><span>i ‚àà l</span></span></span><br></div><label class="goal-separator" for="BaseELMO-v-chkf1"><hr></label><div class="goal-conclusion">[i] =
(<span class="kr">if</span> decide (idx a = idx i)
 <span class="kr">then</span> a :: filter (<span class="kr">Œª</span> <span class="nv">i0</span> : index, idx i0 = idx i) l
 <span class="kr">else</span> filter (<span class="kr">Œª</span> <span class="nv">i0</span> : index, idx i0 = idx i) l)</div></blockquote></div></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="BaseELMO-v-chkf2" style="display: none" type="checkbox"><label class="alectryon-input" for="BaseELMO-v-chkf2">-</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>Address</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>EqDecision0</var><span class="hyp-type"><b>: </b><span>EqDecision Address</span></span></span><br><span><var>State</var><span><span class="hyp-body"><b>:= </b><span>BaseELMO.State</span></span><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span></span><br><span><var>Observation</var><span><span class="hyp-body"><b>:= </b><span>BaseELMO.Observation</span></span><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span></span><br><span><var>Message</var><span><span class="hyp-body"><b>:= </b><span>BaseELMO.Message</span></span><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span></span><br><span><var>index</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>EqDecision1</var><span class="hyp-type"><b>: </b><span>EqDecision index</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>finite.Finite index</span></span></span><br><span><var>H0</var><span class="hyp-type"><b>: </b><span>Inhabited index</span></span></span><br><span><var>idx</var><span class="hyp-type"><b>: </b><span>index ‚Üí Address</span></span></span><br><span><var>Inj0</var><span class="hyp-type"><b>: </b><span>Inj eq eq idx</span></span></span><br><span><var>a</var><span class="hyp-type"><b>: </b><span>index</span></span></span><br><span><var>l</var><span class="hyp-type"><b>: </b><span>list index</span></span></span><br><span><var>IHl</var><span class="hyp-type"><b>: </b><span>NoDup l
‚Üí a ‚àà l
  ‚Üí [a] = filter (<span class="kr">Œª</span> <span class="nv">i</span> : index, idx i = idx a) l</span></span></span><br><span><var>Hnodup</var><span class="hyp-type"><b>: </b><span>NoDup (a :: l)</span></span></span><br><span><var>Hi</var><span class="hyp-type"><b>: </b><span>a ‚àà a :: l</span></span></span><br><span><var>H3</var><span class="hyp-type"><b>: </b><span>a ‚àâ l</span></span></span><br><span><var>H4</var><span class="hyp-type"><b>: </b><span>NoDup l</span></span></span><br><span><var>Hnil</var><span class="hyp-type"><b>: </b><span><span class="kr">‚àÄ</span> <span class="nv">i</span> : index,
  i ‚àâ l
  ‚Üí filter (<span class="kr">Œª</span> <span class="nv">i0</span> : index, idx i0 = idx i) l =
    []</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">[a] =
(<span class="kr">if</span> decide (idx a = idx a)
 <span class="kr">then</span> a :: filter (<span class="kr">Œª</span> <span class="nv">i</span> : index, idx i = idx a) l
 <span class="kr">else</span> filter (<span class="kr">Œª</span> <span class="nv">i</span> : index, idx i = idx a) l)</div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="bp">by</span> <span class="nb">rewrite</span> decide_True, Hnil.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="BaseELMO-v-chkf3" style="display: none" type="checkbox"><label class="alectryon-input" for="BaseELMO-v-chkf3">-</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>Address</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>EqDecision0</var><span class="hyp-type"><b>: </b><span>EqDecision Address</span></span></span><br><span><var>State</var><span><span class="hyp-body"><b>:= </b><span>BaseELMO.State</span></span><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span></span><br><span><var>Observation</var><span><span class="hyp-body"><b>:= </b><span>BaseELMO.Observation</span></span><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span></span><br><span><var>Message</var><span><span class="hyp-body"><b>:= </b><span>BaseELMO.Message</span></span><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span></span><br><span><var>index</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>EqDecision1</var><span class="hyp-type"><b>: </b><span>EqDecision index</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>finite.Finite index</span></span></span><br><span><var>H0</var><span class="hyp-type"><b>: </b><span>Inhabited index</span></span></span><br><span><var>idx</var><span class="hyp-type"><b>: </b><span>index ‚Üí Address</span></span></span><br><span><var>Inj0</var><span class="hyp-type"><b>: </b><span>Inj eq eq idx</span></span></span><br><span><var>i, a</var><span class="hyp-type"><b>: </b><span>index</span></span></span><br><span><var>l</var><span class="hyp-type"><b>: </b><span>list index</span></span></span><br><span><var>IHl</var><span class="hyp-type"><b>: </b><span>NoDup l
‚Üí i ‚àà l
  ‚Üí [i] =
    filter (<span class="kr">Œª</span> <span class="nv">i0</span> : index, idx i0 = idx i) l</span></span></span><br><span><var>Hnodup</var><span class="hyp-type"><b>: </b><span>NoDup (a :: l)</span></span></span><br><span><var>Hi</var><span class="hyp-type"><b>: </b><span>i ‚àà a :: l</span></span></span><br><span><var>H3</var><span class="hyp-type"><b>: </b><span>a ‚àâ l</span></span></span><br><span><var>H4</var><span class="hyp-type"><b>: </b><span>NoDup l</span></span></span><br><span><var>Hnil</var><span class="hyp-type"><b>: </b><span><span class="kr">‚àÄ</span> <span class="nv">i</span> : index,
  i ‚àâ l
  ‚Üí filter (<span class="kr">Œª</span> <span class="nv">i0</span> : index, idx i0 = idx i) l =
    []</span></span></span><br><span><var>H5</var><span class="hyp-type"><b>: </b><span>i ‚àà l</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">[i] =
(<span class="kr">if</span> decide (idx a = idx i)
 <span class="kr">then</span> a :: filter (<span class="kr">Œª</span> <span class="nv">i0</span> : index, idx i0 = idx i) l
 <span class="kr">else</span> filter (<span class="kr">Œª</span> <span class="nv">i0</span> : index, idx i0 = idx i) l)</div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="BaseELMO-v-chkf4" style="display: none" type="checkbox"><label class="alectryon-input" for="BaseELMO-v-chkf4"><span class="nb">rewrite</span> decide_False, IHl; [<span class="bp">done</span>.. |].</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>Address</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>EqDecision0</var><span class="hyp-type"><b>: </b><span>EqDecision Address</span></span></span><br><span><var>State</var><span><span class="hyp-body"><b>:= </b><span>BaseELMO.State</span></span><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span></span><br><span><var>Observation</var><span><span class="hyp-body"><b>:= </b><span>BaseELMO.Observation</span></span><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span></span><br><span><var>Message</var><span><span class="hyp-body"><b>:= </b><span>BaseELMO.Message</span></span><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span></span><br><span><var>index</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>EqDecision1</var><span class="hyp-type"><b>: </b><span>EqDecision index</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>finite.Finite index</span></span></span><br><span><var>H0</var><span class="hyp-type"><b>: </b><span>Inhabited index</span></span></span><br><span><var>idx</var><span class="hyp-type"><b>: </b><span>index ‚Üí Address</span></span></span><br><span><var>Inj0</var><span class="hyp-type"><b>: </b><span>Inj eq eq idx</span></span></span><br><span><var>i, a</var><span class="hyp-type"><b>: </b><span>index</span></span></span><br><span><var>l</var><span class="hyp-type"><b>: </b><span>list index</span></span></span><br><span><var>IHl</var><span class="hyp-type"><b>: </b><span>NoDup l
‚Üí i ‚àà l
  ‚Üí [i] =
    filter (<span class="kr">Œª</span> <span class="nv">i0</span> : index, idx i0 = idx i) l</span></span></span><br><span><var>Hnodup</var><span class="hyp-type"><b>: </b><span>NoDup (a :: l)</span></span></span><br><span><var>Hi</var><span class="hyp-type"><b>: </b><span>i ‚àà a :: l</span></span></span><br><span><var>H3</var><span class="hyp-type"><b>: </b><span>a ‚àâ l</span></span></span><br><span><var>H4</var><span class="hyp-type"><b>: </b><span>NoDup l</span></span></span><br><span><var>Hnil</var><span class="hyp-type"><b>: </b><span><span class="kr">‚àÄ</span> <span class="nv">i</span> : index,
  i ‚àâ l
  ‚Üí filter (<span class="kr">Œª</span> <span class="nv">i0</span> : index, idx i0 = idx i) l =
    []</span></span></span><br><span><var>H5</var><span class="hyp-type"><b>: </b><span>i ‚àà l</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">idx a ‚â† idx i</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><span class="alectryon-input"><span class="bp">by</span> <span class="nb">intro</span> Hcontra; <span class="nb">eapply</span> inj <span class="kr">in</span> Hcontra; [| <span class="bp">done</span>]; <span class="nb">subst</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Qed</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
</span><span class="alectryon-sentence"><input class="alectryon-toggle" id="BaseELMO-v-chkf5" style="display: none" type="checkbox"><label class="alectryon-input" for="BaseELMO-v-chkf5"><span class="kn">Lemma</span> <span class="nf">idx_adr2idx</span> :
  <span class="kr">forall</span> (<span class="nv">i</span> : index) (<span class="nv">adr</span> : Address),
    adr2idx adr = Some i -&gt; idx i = adr.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>Address</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>EqDecision0</var><span class="hyp-type"><b>: </b><span>EqDecision Address</span></span></span><br><span><var>State</var><span><span class="hyp-body"><b>:= </b><span>BaseELMO.State</span></span><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span></span><br><span><var>Observation</var><span><span class="hyp-body"><b>:= </b><span>BaseELMO.Observation</span></span><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span></span><br><span><var>Message</var><span><span class="hyp-body"><b>:= </b><span>BaseELMO.Message</span></span><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span></span><br><span><var>index</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>EqDecision1</var><span class="hyp-type"><b>: </b><span>EqDecision index</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>finite.Finite index</span></span></span><br><span><var>H0</var><span class="hyp-type"><b>: </b><span>Inhabited index</span></span></span><br><span><var>idx</var><span class="hyp-type"><b>: </b><span>index ‚Üí Address</span></span></span><br><span><var>Inj0</var><span class="hyp-type"><b>: </b><span>Inj eq eq idx</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="kr">‚àÄ</span> (<span class="nv">i</span> : index) (<span class="nv">adr</span> : Address),
  adr2idx adr = Some i ‚Üí idx i = adr</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="BaseELMO-v-chkf6" style="display: none" type="checkbox"><label class="alectryon-input" for="BaseELMO-v-chkf6"><span class="kn">Proof</span>.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>Address</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>EqDecision0</var><span class="hyp-type"><b>: </b><span>EqDecision Address</span></span></span><br><span><var>State</var><span><span class="hyp-body"><b>:= </b><span>BaseELMO.State</span></span><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span></span><br><span><var>Observation</var><span><span class="hyp-body"><b>:= </b><span>BaseELMO.Observation</span></span><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span></span><br><span><var>Message</var><span><span class="hyp-body"><b>:= </b><span>BaseELMO.Message</span></span><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span></span><br><span><var>index</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>EqDecision1</var><span class="hyp-type"><b>: </b><span>EqDecision index</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>finite.Finite index</span></span></span><br><span><var>H0</var><span class="hyp-type"><b>: </b><span>Inhabited index</span></span></span><br><span><var>idx</var><span class="hyp-type"><b>: </b><span>index ‚Üí Address</span></span></span><br><span><var>Inj0</var><span class="hyp-type"><b>: </b><span>Inj eq eq idx</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="kr">‚àÄ</span> (<span class="nv">i</span> : index) (<span class="nv">adr</span> : Address),
  adr2idx adr = Some i ‚Üí idx i = adr</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="BaseELMO-v-chkf7" style="display: none" type="checkbox"><label class="alectryon-input" for="BaseELMO-v-chkf7"><span class="nb">unfold</span> adr2idx.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>Address</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>EqDecision0</var><span class="hyp-type"><b>: </b><span>EqDecision Address</span></span></span><br><span><var>State</var><span><span class="hyp-body"><b>:= </b><span>BaseELMO.State</span></span><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span></span><br><span><var>Observation</var><span><span class="hyp-body"><b>:= </b><span>BaseELMO.Observation</span></span><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span></span><br><span><var>Message</var><span><span class="hyp-body"><b>:= </b><span>BaseELMO.Message</span></span><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span></span><br><span><var>index</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>EqDecision1</var><span class="hyp-type"><b>: </b><span>EqDecision index</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>finite.Finite index</span></span></span><br><span><var>H0</var><span class="hyp-type"><b>: </b><span>Inhabited index</span></span></span><br><span><var>idx</var><span class="hyp-type"><b>: </b><span>index ‚Üí Address</span></span></span><br><span><var>Inj0</var><span class="hyp-type"><b>: </b><span>Inj eq eq idx</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="kr">‚àÄ</span> (<span class="nv">i</span> : index) (<span class="nv">adr</span> : Address),
  head
    (filter (<span class="kr">Œª</span> <span class="nv">i0</span> : index, idx i0 = adr) (enum index)) =
  Some i ‚Üí idx i = adr</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="BaseELMO-v-chkf8" style="display: none" type="checkbox"><label class="alectryon-input" for="BaseELMO-v-chkf8"><span class="nb">intros</span> i adr Heq.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>Address</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>EqDecision0</var><span class="hyp-type"><b>: </b><span>EqDecision Address</span></span></span><br><span><var>State</var><span><span class="hyp-body"><b>:= </b><span>BaseELMO.State</span></span><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span></span><br><span><var>Observation</var><span><span class="hyp-body"><b>:= </b><span>BaseELMO.Observation</span></span><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span></span><br><span><var>Message</var><span><span class="hyp-body"><b>:= </b><span>BaseELMO.Message</span></span><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span></span><br><span><var>index</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>EqDecision1</var><span class="hyp-type"><b>: </b><span>EqDecision index</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>finite.Finite index</span></span></span><br><span><var>H0</var><span class="hyp-type"><b>: </b><span>Inhabited index</span></span></span><br><span><var>idx</var><span class="hyp-type"><b>: </b><span>index ‚Üí Address</span></span></span><br><span><var>Inj0</var><span class="hyp-type"><b>: </b><span>Inj eq eq idx</span></span></span><br><span><var>i</var><span class="hyp-type"><b>: </b><span>index</span></span></span><br><span><var>adr</var><span class="hyp-type"><b>: </b><span>Address</span></span></span><br><span><var>Heq</var><span class="hyp-type"><b>: </b><span>head
  (filter (<span class="kr">Œª</span> <span class="nv">i</span> : index, idx i = adr)
     (enum index)) = Some i</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">idx i = adr</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="BaseELMO-v-chkf9" style="display: none" type="checkbox"><label class="alectryon-input" for="BaseELMO-v-chkf9"><span class="nb">apply</span> (@elem_of_list_filter _ (<span class="kr">fun</span> <span class="nv">i</span> =&gt; idx i = adr) _ (enum index) i).</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>Address</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>EqDecision0</var><span class="hyp-type"><b>: </b><span>EqDecision Address</span></span></span><br><span><var>State</var><span><span class="hyp-body"><b>:= </b><span>BaseELMO.State</span></span><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span></span><br><span><var>Observation</var><span><span class="hyp-body"><b>:= </b><span>BaseELMO.Observation</span></span><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span></span><br><span><var>Message</var><span><span class="hyp-body"><b>:= </b><span>BaseELMO.Message</span></span><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span></span><br><span><var>index</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>EqDecision1</var><span class="hyp-type"><b>: </b><span>EqDecision index</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>finite.Finite index</span></span></span><br><span><var>H0</var><span class="hyp-type"><b>: </b><span>Inhabited index</span></span></span><br><span><var>idx</var><span class="hyp-type"><b>: </b><span>index ‚Üí Address</span></span></span><br><span><var>Inj0</var><span class="hyp-type"><b>: </b><span>Inj eq eq idx</span></span></span><br><span><var>i</var><span class="hyp-type"><b>: </b><span>index</span></span></span><br><span><var>adr</var><span class="hyp-type"><b>: </b><span>Address</span></span></span><br><span><var>Heq</var><span class="hyp-type"><b>: </b><span>head
  (filter (<span class="kr">Œª</span> <span class="nv">i</span> : index, idx i = adr)
     (enum index)) = Some i</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">i ‚àà filter (<span class="kr">Œª</span> <span class="nv">i</span> : index, idx i = adr) (enum index)</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="BaseELMO-v-chkfa" style="display: none" type="checkbox"><label class="alectryon-input" for="BaseELMO-v-chkfa"><span class="nb">destruct</span> (filter _ _); <span class="nb">inversion</span> Heq; <span class="nb">subst</span>.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>Address</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>EqDecision0</var><span class="hyp-type"><b>: </b><span>EqDecision Address</span></span></span><br><span><var>State</var><span><span class="hyp-body"><b>:= </b><span>BaseELMO.State</span></span><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span></span><br><span><var>Observation</var><span><span class="hyp-body"><b>:= </b><span>BaseELMO.Observation</span></span><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span></span><br><span><var>Message</var><span><span class="hyp-body"><b>:= </b><span>BaseELMO.Message</span></span><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span></span><br><span><var>index</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>EqDecision1</var><span class="hyp-type"><b>: </b><span>EqDecision index</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>finite.Finite index</span></span></span><br><span><var>H0</var><span class="hyp-type"><b>: </b><span>Inhabited index</span></span></span><br><span><var>idx</var><span class="hyp-type"><b>: </b><span>index ‚Üí Address</span></span></span><br><span><var>Inj0</var><span class="hyp-type"><b>: </b><span>Inj eq eq idx</span></span></span><br><span><var>i</var><span class="hyp-type"><b>: </b><span>index</span></span></span><br><span><var>adr</var><span class="hyp-type"><b>: </b><span>Address</span></span></span><br><span><var>y</var><span class="hyp-type"><b>: </b><span>list index</span></span></span><br><span><var>Heq</var><span class="hyp-type"><b>: </b><span>head (i :: y) = Some i</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">i ‚àà i :: y</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><span class="alectryon-input"><span class="bp">by</span> <span class="nb">left</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Qed</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
</span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Definition</span> <span class="nf">Message_validator</span> : <span class="kt">Type</span> :=
  dsig (is_Some ‚àò adr2idx).</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
</span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Definition</span> <span class="nf">Message_sender</span> (<span class="nv">m</span> : Message) : option Message_validator :=
  <span class="kr">let</span> <span class="nv">a</span> := adr (state m) <span class="kr">in</span>
  <span class="kr">match</span> decide (is_Some (adr2idx a)) <span class="kr">with</span>
  | <span class="nb">left</span> Ha =&gt; Some (dexist a Ha)
  | _ =&gt; None
  <span class="kr">end</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
</span><span class="alectryon-sentence"><input class="alectryon-toggle" id="BaseELMO-v-chkfb" style="display: none" type="checkbox"><label class="alectryon-input" for="BaseELMO-v-chkfb"><span class="kn">Lemma</span> <span class="nf">Message_sender_Some_adr</span> :
  <span class="kr">forall</span> (<span class="nv">m</span> : Message) (<span class="nv">v</span> : Message_validator),
    Message_sender m = Some v -&gt; `v = adr (state m).</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>Address</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>EqDecision0</var><span class="hyp-type"><b>: </b><span>EqDecision Address</span></span></span><br><span><var>State</var><span><span class="hyp-body"><b>:= </b><span>BaseELMO.State</span></span><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span></span><br><span><var>Observation</var><span><span class="hyp-body"><b>:= </b><span>BaseELMO.Observation</span></span><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span></span><br><span><var>Message</var><span><span class="hyp-body"><b>:= </b><span>BaseELMO.Message</span></span><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span></span><br><span><var>index</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>EqDecision1</var><span class="hyp-type"><b>: </b><span>EqDecision index</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>finite.Finite index</span></span></span><br><span><var>H0</var><span class="hyp-type"><b>: </b><span>Inhabited index</span></span></span><br><span><var>idx</var><span class="hyp-type"><b>: </b><span>index ‚Üí Address</span></span></span><br><span><var>Inj0</var><span class="hyp-type"><b>: </b><span>Inj eq eq idx</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="kr">‚àÄ</span> (<span class="nv">m</span> : Message) (<span class="nv">v</span> : Message_validator),
  Message_sender m = Some v ‚Üí `v = adr (state m)</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="BaseELMO-v-chkfc" style="display: none" type="checkbox"><label class="alectryon-input" for="BaseELMO-v-chkfc"><span class="kn">Proof</span>.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>Address</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>EqDecision0</var><span class="hyp-type"><b>: </b><span>EqDecision Address</span></span></span><br><span><var>State</var><span><span class="hyp-body"><b>:= </b><span>BaseELMO.State</span></span><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span></span><br><span><var>Observation</var><span><span class="hyp-body"><b>:= </b><span>BaseELMO.Observation</span></span><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span></span><br><span><var>Message</var><span><span class="hyp-body"><b>:= </b><span>BaseELMO.Message</span></span><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span></span><br><span><var>index</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>EqDecision1</var><span class="hyp-type"><b>: </b><span>EqDecision index</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>finite.Finite index</span></span></span><br><span><var>H0</var><span class="hyp-type"><b>: </b><span>Inhabited index</span></span></span><br><span><var>idx</var><span class="hyp-type"><b>: </b><span>index ‚Üí Address</span></span></span><br><span><var>Inj0</var><span class="hyp-type"><b>: </b><span>Inj eq eq idx</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="kr">‚àÄ</span> (<span class="nv">m</span> : Message) (<span class="nv">v</span> : Message_validator),
  Message_sender m = Some v ‚Üí `v = adr (state m)</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="BaseELMO-v-chkfd" style="display: none" type="checkbox"><label class="alectryon-input" for="BaseELMO-v-chkfd"><span class="nb">unfold</span> Message_sender; <span class="nb">intros</span> v mv Hsender; case_decide; [| <span class="bp">done</span>].</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>Address</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>EqDecision0</var><span class="hyp-type"><b>: </b><span>EqDecision Address</span></span></span><br><span><var>State</var><span><span class="hyp-body"><b>:= </b><span>BaseELMO.State</span></span><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span></span><br><span><var>Observation</var><span><span class="hyp-body"><b>:= </b><span>BaseELMO.Observation</span></span><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span></span><br><span><var>Message</var><span><span class="hyp-body"><b>:= </b><span>BaseELMO.Message</span></span><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span></span><br><span><var>index</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>EqDecision1</var><span class="hyp-type"><b>: </b><span>EqDecision index</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>finite.Finite index</span></span></span><br><span><var>H0</var><span class="hyp-type"><b>: </b><span>Inhabited index</span></span></span><br><span><var>idx</var><span class="hyp-type"><b>: </b><span>index ‚Üí Address</span></span></span><br><span><var>Inj0</var><span class="hyp-type"><b>: </b><span>Inj eq eq idx</span></span></span><br><span><var>v</var><span class="hyp-type"><b>: </b><span>Message</span></span></span><br><span><var>mv</var><span class="hyp-type"><b>: </b><span>Message_validator</span></span></span><br><span><var>H1</var><span class="hyp-type"><b>: </b><span>is_Some (adr2idx (adr (state v)))</span></span></span><br><span><var>Hsender</var><span class="hyp-type"><b>: </b><span>Some (dexist (adr (state v)) H1) = Some mv</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">`mv = adr (state v)</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><span class="alectryon-input"><span class="bp">by</span> <span class="nb">inversion</span> Hsender.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Qed</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
</span><span class="alectryon-sentence"><input class="alectryon-toggle" id="BaseELMO-v-chkfe" style="display: none" type="checkbox"><label class="alectryon-input" for="BaseELMO-v-chkfe"><span class="kn">Lemma</span> <span class="nf">Message_sender_Some_adr_iff</span> :
  <span class="kr">forall</span> (<span class="nv">m</span> : Message) (<span class="nv">v</span> : Message_validator),
    Message_sender m = Some v &lt;-&gt; `v = adr (state m).</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>Address</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>EqDecision0</var><span class="hyp-type"><b>: </b><span>EqDecision Address</span></span></span><br><span><var>State</var><span><span class="hyp-body"><b>:= </b><span>BaseELMO.State</span></span><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span></span><br><span><var>Observation</var><span><span class="hyp-body"><b>:= </b><span>BaseELMO.Observation</span></span><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span></span><br><span><var>Message</var><span><span class="hyp-body"><b>:= </b><span>BaseELMO.Message</span></span><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span></span><br><span><var>index</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>EqDecision1</var><span class="hyp-type"><b>: </b><span>EqDecision index</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>finite.Finite index</span></span></span><br><span><var>H0</var><span class="hyp-type"><b>: </b><span>Inhabited index</span></span></span><br><span><var>idx</var><span class="hyp-type"><b>: </b><span>index ‚Üí Address</span></span></span><br><span><var>Inj0</var><span class="hyp-type"><b>: </b><span>Inj eq eq idx</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="kr">‚àÄ</span> (<span class="nv">m</span> : Message) (<span class="nv">v</span> : Message_validator),
  Message_sender m = Some v ‚Üî `v = adr (state m)</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="BaseELMO-v-chkff" style="display: none" type="checkbox"><label class="alectryon-input" for="BaseELMO-v-chkff"><span class="kn">Proof</span>.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>Address</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>EqDecision0</var><span class="hyp-type"><b>: </b><span>EqDecision Address</span></span></span><br><span><var>State</var><span><span class="hyp-body"><b>:= </b><span>BaseELMO.State</span></span><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span></span><br><span><var>Observation</var><span><span class="hyp-body"><b>:= </b><span>BaseELMO.Observation</span></span><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span></span><br><span><var>Message</var><span><span class="hyp-body"><b>:= </b><span>BaseELMO.Message</span></span><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span></span><br><span><var>index</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>EqDecision1</var><span class="hyp-type"><b>: </b><span>EqDecision index</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>finite.Finite index</span></span></span><br><span><var>H0</var><span class="hyp-type"><b>: </b><span>Inhabited index</span></span></span><br><span><var>idx</var><span class="hyp-type"><b>: </b><span>index ‚Üí Address</span></span></span><br><span><var>Inj0</var><span class="hyp-type"><b>: </b><span>Inj eq eq idx</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="kr">‚àÄ</span> (<span class="nv">m</span> : Message) (<span class="nv">v</span> : Message_validator),
  Message_sender m = Some v ‚Üî `v = adr (state m)</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="BaseELMO-v-chk100" style="display: none" type="checkbox"><label class="alectryon-input" for="BaseELMO-v-chk100"><span class="nb">split</span>; [<span class="bp">by</span> <span class="nb">apply</span> Message_sender_Some_adr |].</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>Address</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>EqDecision0</var><span class="hyp-type"><b>: </b><span>EqDecision Address</span></span></span><br><span><var>State</var><span><span class="hyp-body"><b>:= </b><span>BaseELMO.State</span></span><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span></span><br><span><var>Observation</var><span><span class="hyp-body"><b>:= </b><span>BaseELMO.Observation</span></span><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span></span><br><span><var>Message</var><span><span class="hyp-body"><b>:= </b><span>BaseELMO.Message</span></span><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span></span><br><span><var>index</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>EqDecision1</var><span class="hyp-type"><b>: </b><span>EqDecision index</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>finite.Finite index</span></span></span><br><span><var>H0</var><span class="hyp-type"><b>: </b><span>Inhabited index</span></span></span><br><span><var>idx</var><span class="hyp-type"><b>: </b><span>index ‚Üí Address</span></span></span><br><span><var>Inj0</var><span class="hyp-type"><b>: </b><span>Inj eq eq idx</span></span></span><br><span><var>m</var><span class="hyp-type"><b>: </b><span>Message</span></span></span><br><span><var>v</var><span class="hyp-type"><b>: </b><span>Message_validator</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">`v = adr (state m) ‚Üí Message_sender m = Some v</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="BaseELMO-v-chk101" style="display: none" type="checkbox"><label class="alectryon-input" for="BaseELMO-v-chk101"><span class="nb">unfold</span> Message_sender; case_decide <span class="kr">as</span> Hdec; <span class="nb">intros</span> Hv.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>Address</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>EqDecision0</var><span class="hyp-type"><b>: </b><span>EqDecision Address</span></span></span><br><span><var>State</var><span><span class="hyp-body"><b>:= </b><span>BaseELMO.State</span></span><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span></span><br><span><var>Observation</var><span><span class="hyp-body"><b>:= </b><span>BaseELMO.Observation</span></span><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span></span><br><span><var>Message</var><span><span class="hyp-body"><b>:= </b><span>BaseELMO.Message</span></span><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span></span><br><span><var>index</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>EqDecision1</var><span class="hyp-type"><b>: </b><span>EqDecision index</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>finite.Finite index</span></span></span><br><span><var>H0</var><span class="hyp-type"><b>: </b><span>Inhabited index</span></span></span><br><span><var>idx</var><span class="hyp-type"><b>: </b><span>index ‚Üí Address</span></span></span><br><span><var>Inj0</var><span class="hyp-type"><b>: </b><span>Inj eq eq idx</span></span></span><br><span><var>m</var><span class="hyp-type"><b>: </b><span>Message</span></span></span><br><span><var>v</var><span class="hyp-type"><b>: </b><span>Message_validator</span></span></span><br><span><var>Hdec</var><span class="hyp-type"><b>: </b><span>is_Some (adr2idx (adr (state m)))</span></span></span><br><span><var>Hv</var><span class="hyp-type"><b>: </b><span>`v = adr (state m)</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">Some (dexist (adr (state m)) Hdec) = Some v</div></blockquote><div class="alectryon-extra-goals"><input class="alectryon-extra-goal-toggle" id="BaseELMO-v-chk102" style="display: none" type="checkbox"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>Address</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>EqDecision0</var><span class="hyp-type"><b>: </b><span>EqDecision Address</span></span></span><br><span><var>State</var><span><span class="hyp-body"><b>:= </b><span>BaseELMO.State</span></span><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span></span><br><span><var>Observation</var><span><span class="hyp-body"><b>:= </b><span>BaseELMO.Observation</span></span><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span></span><br><span><var>Message</var><span><span class="hyp-body"><b>:= </b><span>BaseELMO.Message</span></span><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span></span><br><span><var>index</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>EqDecision1</var><span class="hyp-type"><b>: </b><span>EqDecision index</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>finite.Finite index</span></span></span><br><span><var>H0</var><span class="hyp-type"><b>: </b><span>Inhabited index</span></span></span><br><span><var>idx</var><span class="hyp-type"><b>: </b><span>index ‚Üí Address</span></span></span><br><span><var>Inj0</var><span class="hyp-type"><b>: </b><span>Inj eq eq idx</span></span></span><br><span><var>m</var><span class="hyp-type"><b>: </b><span>Message</span></span></span><br><span><var>v</var><span class="hyp-type"><b>: </b><span>Message_validator</span></span></span><br><span><var>Hdec</var><span class="hyp-type"><b>: </b><span>¬¨ is_Some (adr2idx (adr (state m)))</span></span></span><br><span><var>Hv</var><span class="hyp-type"><b>: </b><span>`v = adr (state m)</span></span></span><br></div><label class="goal-separator" for="BaseELMO-v-chk102"><hr></label><div class="goal-conclusion">None = Some v</div></blockquote></div></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="BaseELMO-v-chk103" style="display: none" type="checkbox"><label class="alectryon-input" for="BaseELMO-v-chk103">-</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>Address</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>EqDecision0</var><span class="hyp-type"><b>: </b><span>EqDecision Address</span></span></span><br><span><var>State</var><span><span class="hyp-body"><b>:= </b><span>BaseELMO.State</span></span><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span></span><br><span><var>Observation</var><span><span class="hyp-body"><b>:= </b><span>BaseELMO.Observation</span></span><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span></span><br><span><var>Message</var><span><span class="hyp-body"><b>:= </b><span>BaseELMO.Message</span></span><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span></span><br><span><var>index</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>EqDecision1</var><span class="hyp-type"><b>: </b><span>EqDecision index</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>finite.Finite index</span></span></span><br><span><var>H0</var><span class="hyp-type"><b>: </b><span>Inhabited index</span></span></span><br><span><var>idx</var><span class="hyp-type"><b>: </b><span>index ‚Üí Address</span></span></span><br><span><var>Inj0</var><span class="hyp-type"><b>: </b><span>Inj eq eq idx</span></span></span><br><span><var>m</var><span class="hyp-type"><b>: </b><span>Message</span></span></span><br><span><var>v</var><span class="hyp-type"><b>: </b><span>Message_validator</span></span></span><br><span><var>Hdec</var><span class="hyp-type"><b>: </b><span>is_Some (adr2idx (adr (state m)))</span></span></span><br><span><var>Hv</var><span class="hyp-type"><b>: </b><span>`v = adr (state m)</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">Some (dexist (adr (state m)) Hdec) = Some v</div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="bp">by</span> <span class="nb">f_equal</span>; <span class="nb">apply</span> dsig_eq.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="BaseELMO-v-chk104" style="display: none" type="checkbox"><label class="alectryon-input" for="BaseELMO-v-chk104">-</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>Address</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>EqDecision0</var><span class="hyp-type"><b>: </b><span>EqDecision Address</span></span></span><br><span><var>State</var><span><span class="hyp-body"><b>:= </b><span>BaseELMO.State</span></span><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span></span><br><span><var>Observation</var><span><span class="hyp-body"><b>:= </b><span>BaseELMO.Observation</span></span><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span></span><br><span><var>Message</var><span><span class="hyp-body"><b>:= </b><span>BaseELMO.Message</span></span><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span></span><br><span><var>index</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>EqDecision1</var><span class="hyp-type"><b>: </b><span>EqDecision index</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>finite.Finite index</span></span></span><br><span><var>H0</var><span class="hyp-type"><b>: </b><span>Inhabited index</span></span></span><br><span><var>idx</var><span class="hyp-type"><b>: </b><span>index ‚Üí Address</span></span></span><br><span><var>Inj0</var><span class="hyp-type"><b>: </b><span>Inj eq eq idx</span></span></span><br><span><var>m</var><span class="hyp-type"><b>: </b><span>Message</span></span></span><br><span><var>v</var><span class="hyp-type"><b>: </b><span>Message_validator</span></span></span><br><span><var>Hdec</var><span class="hyp-type"><b>: </b><span>¬¨ is_Some (adr2idx (adr (state m)))</span></span></span><br><span><var>Hv</var><span class="hyp-type"><b>: </b><span>`v = adr (state m)</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">None = Some v</div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="bp">by</span> destruct_dec_sig v a Ha Heq; <span class="nb">subst</span> v; <span class="nb">cbn</span> <span class="kr">in</span> Hv; <span class="nb">subst</span> a.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Qed</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
</span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Definition</span> <span class="nf">Message_sender_index</span> (<span class="nv">v</span> : Message_validator) : index :=
  is_Some_proj (proj2_dsig v).</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
</span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Definition</span> <span class="nf">Message_sender_index_inv_fn</span> (<span class="nv">i</span> : index) : Message_validator :=
  dexist (idx i) (ex_intro _ i (adr2idx_idx i)).</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
</span><span class="alectryon-sentence"><input class="alectryon-toggle" id="BaseELMO-v-chk105" style="display: none" type="checkbox"><label class="alectryon-input" for="BaseELMO-v-chk105"><span class="kn">Lemma</span> <span class="nf">Message_sender_index_inv</span> :
  <span class="kr">forall</span> (<span class="nv">i</span> : index) (<span class="nv">v</span> : Message_validator),
    `v = idx i -&gt; Message_sender_index v = i.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>Address</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>EqDecision0</var><span class="hyp-type"><b>: </b><span>EqDecision Address</span></span></span><br><span><var>State</var><span><span class="hyp-body"><b>:= </b><span>BaseELMO.State</span></span><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span></span><br><span><var>Observation</var><span><span class="hyp-body"><b>:= </b><span>BaseELMO.Observation</span></span><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span></span><br><span><var>Message</var><span><span class="hyp-body"><b>:= </b><span>BaseELMO.Message</span></span><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span></span><br><span><var>index</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>EqDecision1</var><span class="hyp-type"><b>: </b><span>EqDecision index</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>finite.Finite index</span></span></span><br><span><var>H0</var><span class="hyp-type"><b>: </b><span>Inhabited index</span></span></span><br><span><var>idx</var><span class="hyp-type"><b>: </b><span>index ‚Üí Address</span></span></span><br><span><var>Inj0</var><span class="hyp-type"><b>: </b><span>Inj eq eq idx</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="kr">‚àÄ</span> (<span class="nv">i</span> : index) (<span class="nv">v</span> : Message_validator),
  `v = idx i ‚Üí Message_sender_index v = i</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="BaseELMO-v-chk106" style="display: none" type="checkbox"><label class="alectryon-input" for="BaseELMO-v-chk106"><span class="kn">Proof</span>.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>Address</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>EqDecision0</var><span class="hyp-type"><b>: </b><span>EqDecision Address</span></span></span><br><span><var>State</var><span><span class="hyp-body"><b>:= </b><span>BaseELMO.State</span></span><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span></span><br><span><var>Observation</var><span><span class="hyp-body"><b>:= </b><span>BaseELMO.Observation</span></span><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span></span><br><span><var>Message</var><span><span class="hyp-body"><b>:= </b><span>BaseELMO.Message</span></span><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span></span><br><span><var>index</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>EqDecision1</var><span class="hyp-type"><b>: </b><span>EqDecision index</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>finite.Finite index</span></span></span><br><span><var>H0</var><span class="hyp-type"><b>: </b><span>Inhabited index</span></span></span><br><span><var>idx</var><span class="hyp-type"><b>: </b><span>index ‚Üí Address</span></span></span><br><span><var>Inj0</var><span class="hyp-type"><b>: </b><span>Inj eq eq idx</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="kr">‚àÄ</span> (<span class="nv">i</span> : index) (<span class="nv">v</span> : Message_validator),
  `v = idx i ‚Üí Message_sender_index v = i</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="BaseELMO-v-chk107" style="display: none" type="checkbox"><label class="alectryon-input" for="BaseELMO-v-chk107"><span class="nb">intros</span> i v Hv.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>Address</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>EqDecision0</var><span class="hyp-type"><b>: </b><span>EqDecision Address</span></span></span><br><span><var>State</var><span><span class="hyp-body"><b>:= </b><span>BaseELMO.State</span></span><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span></span><br><span><var>Observation</var><span><span class="hyp-body"><b>:= </b><span>BaseELMO.Observation</span></span><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span></span><br><span><var>Message</var><span><span class="hyp-body"><b>:= </b><span>BaseELMO.Message</span></span><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span></span><br><span><var>index</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>EqDecision1</var><span class="hyp-type"><b>: </b><span>EqDecision index</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>finite.Finite index</span></span></span><br><span><var>H0</var><span class="hyp-type"><b>: </b><span>Inhabited index</span></span></span><br><span><var>idx</var><span class="hyp-type"><b>: </b><span>index ‚Üí Address</span></span></span><br><span><var>Inj0</var><span class="hyp-type"><b>: </b><span>Inj eq eq idx</span></span></span><br><span><var>i</var><span class="hyp-type"><b>: </b><span>index</span></span></span><br><span><var>v</var><span class="hyp-type"><b>: </b><span>Message_validator</span></span></span><br><span><var>Hv</var><span class="hyp-type"><b>: </b><span>`v = idx i</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">Message_sender_index v = i</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="BaseELMO-v-chk108" style="display: none" type="checkbox"><label class="alectryon-input" for="BaseELMO-v-chk108">destruct_dec_sig v a Ha Heq; <span class="nb">subst</span> v; <span class="nb">cbn</span> <span class="kr">in</span> Hv; <span class="nb">subst</span> a.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>Address</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>EqDecision0</var><span class="hyp-type"><b>: </b><span>EqDecision Address</span></span></span><br><span><var>State</var><span><span class="hyp-body"><b>:= </b><span>BaseELMO.State</span></span><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span></span><br><span><var>Observation</var><span><span class="hyp-body"><b>:= </b><span>BaseELMO.Observation</span></span><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span></span><br><span><var>Message</var><span><span class="hyp-body"><b>:= </b><span>BaseELMO.Message</span></span><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span></span><br><span><var>index</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>EqDecision1</var><span class="hyp-type"><b>: </b><span>EqDecision index</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>finite.Finite index</span></span></span><br><span><var>H0</var><span class="hyp-type"><b>: </b><span>Inhabited index</span></span></span><br><span><var>idx</var><span class="hyp-type"><b>: </b><span>index ‚Üí Address</span></span></span><br><span><var>Inj0</var><span class="hyp-type"><b>: </b><span>Inj eq eq idx</span></span></span><br><span><var>i</var><span class="hyp-type"><b>: </b><span>index</span></span></span><br><span><var>Ha</var><span class="hyp-type"><b>: </b><span>(is_Some ‚àò adr2idx) (idx i)</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">Message_sender_index (dexist (idx i) Ha) = i</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><span class="alectryon-input"><span class="bp">by</span> <span class="nb">apply</span> is_Some_proj_elim, adr2idx_idx.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Qed</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
</span><span class="alectryon-sentence"><input class="alectryon-toggle" id="BaseELMO-v-chk109" style="display: none" type="checkbox"><label class="alectryon-input" for="BaseELMO-v-chk109"><span class="kn">Lemma</span> <span class="nf">Message_sender_index_address</span> :
  <span class="kr">forall</span> (<span class="nv">m</span> : Message) (<span class="nv">v</span> : Message_validator),
    Message_sender m = Some v -&gt; idx (Message_sender_index v) = adr (state m).</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>Address</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>EqDecision0</var><span class="hyp-type"><b>: </b><span>EqDecision Address</span></span></span><br><span><var>State</var><span><span class="hyp-body"><b>:= </b><span>BaseELMO.State</span></span><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span></span><br><span><var>Observation</var><span><span class="hyp-body"><b>:= </b><span>BaseELMO.Observation</span></span><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span></span><br><span><var>Message</var><span><span class="hyp-body"><b>:= </b><span>BaseELMO.Message</span></span><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span></span><br><span><var>index</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>EqDecision1</var><span class="hyp-type"><b>: </b><span>EqDecision index</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>finite.Finite index</span></span></span><br><span><var>H0</var><span class="hyp-type"><b>: </b><span>Inhabited index</span></span></span><br><span><var>idx</var><span class="hyp-type"><b>: </b><span>index ‚Üí Address</span></span></span><br><span><var>Inj0</var><span class="hyp-type"><b>: </b><span>Inj eq eq idx</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="kr">‚àÄ</span> (<span class="nv">m</span> : Message) (<span class="nv">v</span> : Message_validator),
  Message_sender m = Some v
  ‚Üí idx (Message_sender_index v) = adr (state m)</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="BaseELMO-v-chk10a" style="display: none" type="checkbox"><label class="alectryon-input" for="BaseELMO-v-chk10a"><span class="kn">Proof</span>.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>Address</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>EqDecision0</var><span class="hyp-type"><b>: </b><span>EqDecision Address</span></span></span><br><span><var>State</var><span><span class="hyp-body"><b>:= </b><span>BaseELMO.State</span></span><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span></span><br><span><var>Observation</var><span><span class="hyp-body"><b>:= </b><span>BaseELMO.Observation</span></span><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span></span><br><span><var>Message</var><span><span class="hyp-body"><b>:= </b><span>BaseELMO.Message</span></span><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span></span><br><span><var>index</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>EqDecision1</var><span class="hyp-type"><b>: </b><span>EqDecision index</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>finite.Finite index</span></span></span><br><span><var>H0</var><span class="hyp-type"><b>: </b><span>Inhabited index</span></span></span><br><span><var>idx</var><span class="hyp-type"><b>: </b><span>index ‚Üí Address</span></span></span><br><span><var>Inj0</var><span class="hyp-type"><b>: </b><span>Inj eq eq idx</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="kr">‚àÄ</span> (<span class="nv">m</span> : Message) (<span class="nv">v</span> : Message_validator),
  Message_sender m = Some v
  ‚Üí idx (Message_sender_index v) = adr (state m)</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="BaseELMO-v-chk10b" style="display: none" type="checkbox"><label class="alectryon-input" for="BaseELMO-v-chk10b"><span class="nb">intros</span> m v Hsender.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>Address</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>EqDecision0</var><span class="hyp-type"><b>: </b><span>EqDecision Address</span></span></span><br><span><var>State</var><span><span class="hyp-body"><b>:= </b><span>BaseELMO.State</span></span><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span></span><br><span><var>Observation</var><span><span class="hyp-body"><b>:= </b><span>BaseELMO.Observation</span></span><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span></span><br><span><var>Message</var><span><span class="hyp-body"><b>:= </b><span>BaseELMO.Message</span></span><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span></span><br><span><var>index</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>EqDecision1</var><span class="hyp-type"><b>: </b><span>EqDecision index</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>finite.Finite index</span></span></span><br><span><var>H0</var><span class="hyp-type"><b>: </b><span>Inhabited index</span></span></span><br><span><var>idx</var><span class="hyp-type"><b>: </b><span>index ‚Üí Address</span></span></span><br><span><var>Inj0</var><span class="hyp-type"><b>: </b><span>Inj eq eq idx</span></span></span><br><span><var>m</var><span class="hyp-type"><b>: </b><span>Message</span></span></span><br><span><var>v</var><span class="hyp-type"><b>: </b><span>Message_validator</span></span></span><br><span><var>Hsender</var><span class="hyp-type"><b>: </b><span>Message_sender m = Some v</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">idx (Message_sender_index v) = adr (state m)</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="BaseELMO-v-chk10c" style="display: none" type="checkbox"><label class="alectryon-input" for="BaseELMO-v-chk10c"><span class="nb">apply</span> Message_sender_Some_adr <span class="kr">in</span> Hsender.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>Address</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>EqDecision0</var><span class="hyp-type"><b>: </b><span>EqDecision Address</span></span></span><br><span><var>State</var><span><span class="hyp-body"><b>:= </b><span>BaseELMO.State</span></span><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span></span><br><span><var>Observation</var><span><span class="hyp-body"><b>:= </b><span>BaseELMO.Observation</span></span><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span></span><br><span><var>Message</var><span><span class="hyp-body"><b>:= </b><span>BaseELMO.Message</span></span><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span></span><br><span><var>index</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>EqDecision1</var><span class="hyp-type"><b>: </b><span>EqDecision index</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>finite.Finite index</span></span></span><br><span><var>H0</var><span class="hyp-type"><b>: </b><span>Inhabited index</span></span></span><br><span><var>idx</var><span class="hyp-type"><b>: </b><span>index ‚Üí Address</span></span></span><br><span><var>Inj0</var><span class="hyp-type"><b>: </b><span>Inj eq eq idx</span></span></span><br><span><var>m</var><span class="hyp-type"><b>: </b><span>Message</span></span></span><br><span><var>v</var><span class="hyp-type"><b>: </b><span>Message_validator</span></span></span><br><span><var>Hsender</var><span class="hyp-type"><b>: </b><span>`v = adr (state m)</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">idx (Message_sender_index v) = adr (state m)</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="BaseELMO-v-chk10d" style="display: none" type="checkbox"><label class="alectryon-input" for="BaseELMO-v-chk10d">destruct_dec_sig v a Ha Heq; <span class="nb">subst</span> v.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>Address</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>EqDecision0</var><span class="hyp-type"><b>: </b><span>EqDecision Address</span></span></span><br><span><var>State</var><span><span class="hyp-body"><b>:= </b><span>BaseELMO.State</span></span><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span></span><br><span><var>Observation</var><span><span class="hyp-body"><b>:= </b><span>BaseELMO.Observation</span></span><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span></span><br><span><var>Message</var><span><span class="hyp-body"><b>:= </b><span>BaseELMO.Message</span></span><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span></span><br><span><var>index</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>EqDecision1</var><span class="hyp-type"><b>: </b><span>EqDecision index</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>finite.Finite index</span></span></span><br><span><var>H0</var><span class="hyp-type"><b>: </b><span>Inhabited index</span></span></span><br><span><var>idx</var><span class="hyp-type"><b>: </b><span>index ‚Üí Address</span></span></span><br><span><var>Inj0</var><span class="hyp-type"><b>: </b><span>Inj eq eq idx</span></span></span><br><span><var>m</var><span class="hyp-type"><b>: </b><span>Message</span></span></span><br><span><var>a</var><span class="hyp-type"><b>: </b><span>Address</span></span></span><br><span><var>Ha</var><span class="hyp-type"><b>: </b><span>(is_Some ‚àò adr2idx) a</span></span></span><br><span><var>Hsender</var><span class="hyp-type"><b>: </b><span>`(dexist a Ha) = adr (state m)</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">idx (Message_sender_index (dexist a Ha)) =
adr (state m)</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="BaseELMO-v-chk10e" style="display: none" type="checkbox"><label class="alectryon-input" for="BaseELMO-v-chk10e"><span class="nb">cbn</span> <span class="kr">in</span> Hsender; <span class="nb">subst</span> a.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>Address</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>EqDecision0</var><span class="hyp-type"><b>: </b><span>EqDecision Address</span></span></span><br><span><var>State</var><span><span class="hyp-body"><b>:= </b><span>BaseELMO.State</span></span><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span></span><br><span><var>Observation</var><span><span class="hyp-body"><b>:= </b><span>BaseELMO.Observation</span></span><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span></span><br><span><var>Message</var><span><span class="hyp-body"><b>:= </b><span>BaseELMO.Message</span></span><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span></span><br><span><var>index</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>EqDecision1</var><span class="hyp-type"><b>: </b><span>EqDecision index</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>finite.Finite index</span></span></span><br><span><var>H0</var><span class="hyp-type"><b>: </b><span>Inhabited index</span></span></span><br><span><var>idx</var><span class="hyp-type"><b>: </b><span>index ‚Üí Address</span></span></span><br><span><var>Inj0</var><span class="hyp-type"><b>: </b><span>Inj eq eq idx</span></span></span><br><span><var>m</var><span class="hyp-type"><b>: </b><span>Message</span></span></span><br><span><var>Ha</var><span class="hyp-type"><b>: </b><span>(is_Some ‚àò adr2idx) (adr (state m))</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">idx (Message_sender_index (dexist (adr (state m)) Ha)) =
adr (state m)</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="BaseELMO-v-chk10f" style="display: none" type="checkbox"><label class="alectryon-input" for="BaseELMO-v-chk10f"><span class="nb">apply</span> idx_adr2idx.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>Address</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>EqDecision0</var><span class="hyp-type"><b>: </b><span>EqDecision Address</span></span></span><br><span><var>State</var><span><span class="hyp-body"><b>:= </b><span>BaseELMO.State</span></span><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span></span><br><span><var>Observation</var><span><span class="hyp-body"><b>:= </b><span>BaseELMO.Observation</span></span><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span></span><br><span><var>Message</var><span><span class="hyp-body"><b>:= </b><span>BaseELMO.Message</span></span><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span></span><br><span><var>index</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>EqDecision1</var><span class="hyp-type"><b>: </b><span>EqDecision index</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>finite.Finite index</span></span></span><br><span><var>H0</var><span class="hyp-type"><b>: </b><span>Inhabited index</span></span></span><br><span><var>idx</var><span class="hyp-type"><b>: </b><span>index ‚Üí Address</span></span></span><br><span><var>Inj0</var><span class="hyp-type"><b>: </b><span>Inj eq eq idx</span></span></span><br><span><var>m</var><span class="hyp-type"><b>: </b><span>Message</span></span></span><br><span><var>Ha</var><span class="hyp-type"><b>: </b><span>(is_Some ‚àò adr2idx) (adr (state m))</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">adr2idx (adr (state m)) =
Some
  (Message_sender_index (dexist (adr (state m)) Ha))</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="BaseELMO-v-chk110" style="display: none" type="checkbox"><label class="alectryon-input" for="BaseELMO-v-chk110"><span class="nb">destruct</span> Ha <span class="kr">as</span> [a Heq].</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>Address</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>EqDecision0</var><span class="hyp-type"><b>: </b><span>EqDecision Address</span></span></span><br><span><var>State</var><span><span class="hyp-body"><b>:= </b><span>BaseELMO.State</span></span><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span></span><br><span><var>Observation</var><span><span class="hyp-body"><b>:= </b><span>BaseELMO.Observation</span></span><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span></span><br><span><var>Message</var><span><span class="hyp-body"><b>:= </b><span>BaseELMO.Message</span></span><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span></span><br><span><var>index</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>EqDecision1</var><span class="hyp-type"><b>: </b><span>EqDecision index</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>finite.Finite index</span></span></span><br><span><var>H0</var><span class="hyp-type"><b>: </b><span>Inhabited index</span></span></span><br><span><var>idx</var><span class="hyp-type"><b>: </b><span>index ‚Üí Address</span></span></span><br><span><var>Inj0</var><span class="hyp-type"><b>: </b><span>Inj eq eq idx</span></span></span><br><span><var>m</var><span class="hyp-type"><b>: </b><span>Message</span></span></span><br><span><var>a</var><span class="hyp-type"><b>: </b><span>index</span></span></span><br><span><var>Heq</var><span class="hyp-type"><b>: </b><span>adr2idx (adr (state m)) = Some a</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">adr2idx (adr (state m)) =
Some
  (Message_sender_index
     (dexist (adr (state m))
        (ex_intro
           (<span class="kr">Œª</span> <span class="nv">x</span> : index,
              adr2idx (adr (state m)) = Some x) a Heq)))</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="BaseELMO-v-chk111" style="display: none" type="checkbox"><label class="alectryon-input" for="BaseELMO-v-chk111"><span class="nb">rewrite</span> Heq <span class="nb">at</span> <span class="mi">1</span>.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>Address</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>EqDecision0</var><span class="hyp-type"><b>: </b><span>EqDecision Address</span></span></span><br><span><var>State</var><span><span class="hyp-body"><b>:= </b><span>BaseELMO.State</span></span><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span></span><br><span><var>Observation</var><span><span class="hyp-body"><b>:= </b><span>BaseELMO.Observation</span></span><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span></span><br><span><var>Message</var><span><span class="hyp-body"><b>:= </b><span>BaseELMO.Message</span></span><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span></span><br><span><var>index</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>EqDecision1</var><span class="hyp-type"><b>: </b><span>EqDecision index</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>finite.Finite index</span></span></span><br><span><var>H0</var><span class="hyp-type"><b>: </b><span>Inhabited index</span></span></span><br><span><var>idx</var><span class="hyp-type"><b>: </b><span>index ‚Üí Address</span></span></span><br><span><var>Inj0</var><span class="hyp-type"><b>: </b><span>Inj eq eq idx</span></span></span><br><span><var>m</var><span class="hyp-type"><b>: </b><span>Message</span></span></span><br><span><var>a</var><span class="hyp-type"><b>: </b><span>index</span></span></span><br><span><var>Heq</var><span class="hyp-type"><b>: </b><span>adr2idx (adr (state m)) = Some a</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">Some a =
Some
  (Message_sender_index
     (dexist (adr (state m))
        (ex_intro
           (<span class="kr">Œª</span> <span class="nv">x</span> : index,
              adr2idx (adr (state m)) = Some x) a Heq)))</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="BaseELMO-v-chk112" style="display: none" type="checkbox"><label class="alectryon-input" for="BaseELMO-v-chk112"><span class="nb">f_equal</span>; <span class="nb">symmetry</span>; <span class="nb">apply</span> Message_sender_index_inv; <span class="nb">cbn</span>.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>Address</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>EqDecision0</var><span class="hyp-type"><b>: </b><span>EqDecision Address</span></span></span><br><span><var>State</var><span><span class="hyp-body"><b>:= </b><span>BaseELMO.State</span></span><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span></span><br><span><var>Observation</var><span><span class="hyp-body"><b>:= </b><span>BaseELMO.Observation</span></span><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span></span><br><span><var>Message</var><span><span class="hyp-body"><b>:= </b><span>BaseELMO.Message</span></span><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span></span><br><span><var>index</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>EqDecision1</var><span class="hyp-type"><b>: </b><span>EqDecision index</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>finite.Finite index</span></span></span><br><span><var>H0</var><span class="hyp-type"><b>: </b><span>Inhabited index</span></span></span><br><span><var>idx</var><span class="hyp-type"><b>: </b><span>index ‚Üí Address</span></span></span><br><span><var>Inj0</var><span class="hyp-type"><b>: </b><span>Inj eq eq idx</span></span></span><br><span><var>m</var><span class="hyp-type"><b>: </b><span>Message</span></span></span><br><span><var>a</var><span class="hyp-type"><b>: </b><span>index</span></span></span><br><span><var>Heq</var><span class="hyp-type"><b>: </b><span>adr2idx (adr (state m)) = Some a</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">adr (state m) = idx a</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><span class="alectryon-input"><span class="bp">by</span> <span class="nb">symmetry</span>; <span class="nb">apply</span> idx_adr2idx.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Qed</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
</span><span class="alectryon-sentence"><input class="alectryon-toggle" id="BaseELMO-v-chk113" style="display: none" type="checkbox"><label class="alectryon-input" for="BaseELMO-v-chk113">#[export] <span class="kn">Instance</span> <span class="nf">Message_sender_index_inj</span> : Inj (=) (=) Message_sender_index.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>Address</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>EqDecision0</var><span class="hyp-type"><b>: </b><span>EqDecision Address</span></span></span><br><span><var>State</var><span><span class="hyp-body"><b>:= </b><span>BaseELMO.State</span></span><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span></span><br><span><var>Observation</var><span><span class="hyp-body"><b>:= </b><span>BaseELMO.Observation</span></span><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span></span><br><span><var>Message</var><span><span class="hyp-body"><b>:= </b><span>BaseELMO.Message</span></span><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span></span><br><span><var>index</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>EqDecision1</var><span class="hyp-type"><b>: </b><span>EqDecision index</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>finite.Finite index</span></span></span><br><span><var>H0</var><span class="hyp-type"><b>: </b><span>Inhabited index</span></span></span><br><span><var>idx</var><span class="hyp-type"><b>: </b><span>index ‚Üí Address</span></span></span><br><span><var>Inj0</var><span class="hyp-type"><b>: </b><span>Inj eq eq idx</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">Inj eq eq Message_sender_index</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="BaseELMO-v-chk114" style="display: none" type="checkbox"><label class="alectryon-input" for="BaseELMO-v-chk114"><span class="kn">Proof</span>.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>Address</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>EqDecision0</var><span class="hyp-type"><b>: </b><span>EqDecision Address</span></span></span><br><span><var>State</var><span><span class="hyp-body"><b>:= </b><span>BaseELMO.State</span></span><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span></span><br><span><var>Observation</var><span><span class="hyp-body"><b>:= </b><span>BaseELMO.Observation</span></span><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span></span><br><span><var>Message</var><span><span class="hyp-body"><b>:= </b><span>BaseELMO.Message</span></span><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span></span><br><span><var>index</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>EqDecision1</var><span class="hyp-type"><b>: </b><span>EqDecision index</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>finite.Finite index</span></span></span><br><span><var>H0</var><span class="hyp-type"><b>: </b><span>Inhabited index</span></span></span><br><span><var>idx</var><span class="hyp-type"><b>: </b><span>index ‚Üí Address</span></span></span><br><span><var>Inj0</var><span class="hyp-type"><b>: </b><span>Inj eq eq idx</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">Inj eq eq Message_sender_index</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="BaseELMO-v-chk115" style="display: none" type="checkbox"><label class="alectryon-input" for="BaseELMO-v-chk115"><span class="nb">intros</span> v1 v2.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>Address</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>EqDecision0</var><span class="hyp-type"><b>: </b><span>EqDecision Address</span></span></span><br><span><var>State</var><span><span class="hyp-body"><b>:= </b><span>BaseELMO.State</span></span><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span></span><br><span><var>Observation</var><span><span class="hyp-body"><b>:= </b><span>BaseELMO.Observation</span></span><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span></span><br><span><var>Message</var><span><span class="hyp-body"><b>:= </b><span>BaseELMO.Message</span></span><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span></span><br><span><var>index</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>EqDecision1</var><span class="hyp-type"><b>: </b><span>EqDecision index</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>finite.Finite index</span></span></span><br><span><var>H0</var><span class="hyp-type"><b>: </b><span>Inhabited index</span></span></span><br><span><var>idx</var><span class="hyp-type"><b>: </b><span>index ‚Üí Address</span></span></span><br><span><var>Inj0</var><span class="hyp-type"><b>: </b><span>Inj eq eq idx</span></span></span><br><span><var>v1, v2</var><span class="hyp-type"><b>: </b><span>Message_validator</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">Message_sender_index v1 = Message_sender_index v2
‚Üí v1 = v2</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="BaseELMO-v-chk116" style="display: none" type="checkbox"><label class="alectryon-input" for="BaseELMO-v-chk116">destruct_dec_sig v1 a1 Ha1 Heq1; <span class="nb">subst</span> v1.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>Address</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>EqDecision0</var><span class="hyp-type"><b>: </b><span>EqDecision Address</span></span></span><br><span><var>State</var><span><span class="hyp-body"><b>:= </b><span>BaseELMO.State</span></span><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span></span><br><span><var>Observation</var><span><span class="hyp-body"><b>:= </b><span>BaseELMO.Observation</span></span><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span></span><br><span><var>Message</var><span><span class="hyp-body"><b>:= </b><span>BaseELMO.Message</span></span><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span></span><br><span><var>index</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>EqDecision1</var><span class="hyp-type"><b>: </b><span>EqDecision index</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>finite.Finite index</span></span></span><br><span><var>H0</var><span class="hyp-type"><b>: </b><span>Inhabited index</span></span></span><br><span><var>idx</var><span class="hyp-type"><b>: </b><span>index ‚Üí Address</span></span></span><br><span><var>Inj0</var><span class="hyp-type"><b>: </b><span>Inj eq eq idx</span></span></span><br><span><var>v2</var><span class="hyp-type"><b>: </b><span>Message_validator</span></span></span><br><span><var>a1</var><span class="hyp-type"><b>: </b><span>Address</span></span></span><br><span><var>Ha1</var><span class="hyp-type"><b>: </b><span>(is_Some ‚àò adr2idx) a1</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">Message_sender_index (dexist a1 Ha1) =
Message_sender_index v2 ‚Üí dexist a1 Ha1 = v2</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="BaseELMO-v-chk117" style="display: none" type="checkbox"><label class="alectryon-input" for="BaseELMO-v-chk117">destruct_dec_sig v2 a2 Ha2 Heq2; <span class="nb">subst</span> v2.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>Address</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>EqDecision0</var><span class="hyp-type"><b>: </b><span>EqDecision Address</span></span></span><br><span><var>State</var><span><span class="hyp-body"><b>:= </b><span>BaseELMO.State</span></span><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span></span><br><span><var>Observation</var><span><span class="hyp-body"><b>:= </b><span>BaseELMO.Observation</span></span><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span></span><br><span><var>Message</var><span><span class="hyp-body"><b>:= </b><span>BaseELMO.Message</span></span><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span></span><br><span><var>index</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>EqDecision1</var><span class="hyp-type"><b>: </b><span>EqDecision index</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>finite.Finite index</span></span></span><br><span><var>H0</var><span class="hyp-type"><b>: </b><span>Inhabited index</span></span></span><br><span><var>idx</var><span class="hyp-type"><b>: </b><span>index ‚Üí Address</span></span></span><br><span><var>Inj0</var><span class="hyp-type"><b>: </b><span>Inj eq eq idx</span></span></span><br><span><var>a1</var><span class="hyp-type"><b>: </b><span>Address</span></span></span><br><span><var>Ha1</var><span class="hyp-type"><b>: </b><span>(is_Some ‚àò adr2idx) a1</span></span></span><br><span><var>a2</var><span class="hyp-type"><b>: </b><span>Address</span></span></span><br><span><var>Ha2</var><span class="hyp-type"><b>: </b><span>(is_Some ‚àò adr2idx) a2</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">Message_sender_index (dexist a1 Ha1) =
Message_sender_index (dexist a2 Ha2)
‚Üí dexist a1 Ha1 = dexist a2 Ha2</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="BaseELMO-v-chk118" style="display: none" type="checkbox"><label class="alectryon-input" for="BaseELMO-v-chk118"><span class="nb">destruct</span> Ha1 <span class="kr">as</span> [i1 Ha1], Ha2 <span class="kr">as</span> [i2 Ha2].</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>Address</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>EqDecision0</var><span class="hyp-type"><b>: </b><span>EqDecision Address</span></span></span><br><span><var>State</var><span><span class="hyp-body"><b>:= </b><span>BaseELMO.State</span></span><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span></span><br><span><var>Observation</var><span><span class="hyp-body"><b>:= </b><span>BaseELMO.Observation</span></span><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span></span><br><span><var>Message</var><span><span class="hyp-body"><b>:= </b><span>BaseELMO.Message</span></span><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span></span><br><span><var>index</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>EqDecision1</var><span class="hyp-type"><b>: </b><span>EqDecision index</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>finite.Finite index</span></span></span><br><span><var>H0</var><span class="hyp-type"><b>: </b><span>Inhabited index</span></span></span><br><span><var>idx</var><span class="hyp-type"><b>: </b><span>index ‚Üí Address</span></span></span><br><span><var>Inj0</var><span class="hyp-type"><b>: </b><span>Inj eq eq idx</span></span></span><br><span><var>a1</var><span class="hyp-type"><b>: </b><span>Address</span></span></span><br><span><var>i1</var><span class="hyp-type"><b>: </b><span>index</span></span></span><br><span><var>Ha1</var><span class="hyp-type"><b>: </b><span>adr2idx a1 = Some i1</span></span></span><br><span><var>a2</var><span class="hyp-type"><b>: </b><span>Address</span></span></span><br><span><var>i2</var><span class="hyp-type"><b>: </b><span>index</span></span></span><br><span><var>Ha2</var><span class="hyp-type"><b>: </b><span>adr2idx a2 = Some i2</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">Message_sender_index
  (dexist a1
     (ex_intro (<span class="kr">Œª</span> <span class="nv">x</span> : index, adr2idx a1 = Some x) i1
        Ha1)) =
Message_sender_index
  (dexist a2
     (ex_intro (<span class="kr">Œª</span> <span class="nv">x</span> : index, adr2idx a2 = Some x) i2
        Ha2))
‚Üí dexist a1
    (ex_intro (<span class="kr">Œª</span> <span class="nv">x</span> : index, adr2idx a1 = Some x) i1
       Ha1) =
  dexist a2
    (ex_intro (<span class="kr">Œª</span> <span class="nv">x</span> : index, adr2idx a2 = Some x) i2
       Ha2)</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="BaseELMO-v-chk119" style="display: none" type="checkbox"><label class="alectryon-input" for="BaseELMO-v-chk119"><span class="nb">unfold</span> Message_sender_index; <span class="nb">cbn</span>.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>Address</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>EqDecision0</var><span class="hyp-type"><b>: </b><span>EqDecision Address</span></span></span><br><span><var>State</var><span><span class="hyp-body"><b>:= </b><span>BaseELMO.State</span></span><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span></span><br><span><var>Observation</var><span><span class="hyp-body"><b>:= </b><span>BaseELMO.Observation</span></span><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span></span><br><span><var>Message</var><span><span class="hyp-body"><b>:= </b><span>BaseELMO.Message</span></span><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span></span><br><span><var>index</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>EqDecision1</var><span class="hyp-type"><b>: </b><span>EqDecision index</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>finite.Finite index</span></span></span><br><span><var>H0</var><span class="hyp-type"><b>: </b><span>Inhabited index</span></span></span><br><span><var>idx</var><span class="hyp-type"><b>: </b><span>index ‚Üí Address</span></span></span><br><span><var>Inj0</var><span class="hyp-type"><b>: </b><span>Inj eq eq idx</span></span></span><br><span><var>a1</var><span class="hyp-type"><b>: </b><span>Address</span></span></span><br><span><var>i1</var><span class="hyp-type"><b>: </b><span>index</span></span></span><br><span><var>Ha1</var><span class="hyp-type"><b>: </b><span>adr2idx a1 = Some i1</span></span></span><br><span><var>a2</var><span class="hyp-type"><b>: </b><span>Address</span></span></span><br><span><var>i2</var><span class="hyp-type"><b>: </b><span>index</span></span></span><br><span><var>Ha2</var><span class="hyp-type"><b>: </b><span>adr2idx a2 = Some i2</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">is_Some_proj
  (proj2_dsig
     (dexist a1
        (ex_intro (<span class="kr">Œª</span> <span class="nv">x</span> : index, adr2idx a1 = Some x)
           i1 Ha1))) =
is_Some_proj
  (proj2_dsig
     (dexist a2
        (ex_intro (<span class="kr">Œª</span> <span class="nv">x</span> : index, adr2idx a2 = Some x)
           i2 Ha2)))
‚Üí dexist a1
    (ex_intro (<span class="kr">Œª</span> <span class="nv">x</span> : index, adr2idx a1 = Some x) i1
       Ha1) =
  dexist a2
    (ex_intro (<span class="kr">Œª</span> <span class="nv">x</span> : index, adr2idx a2 = Some x) i2
       Ha2)</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="BaseELMO-v-chk11a" style="display: none" type="checkbox"><label class="alectryon-input" for="BaseELMO-v-chk11a"><span class="nb">erewrite</span> !is_Some_proj_elim <span class="bp">by</span> <span class="bp">done</span>.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>Address</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>EqDecision0</var><span class="hyp-type"><b>: </b><span>EqDecision Address</span></span></span><br><span><var>State</var><span><span class="hyp-body"><b>:= </b><span>BaseELMO.State</span></span><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span></span><br><span><var>Observation</var><span><span class="hyp-body"><b>:= </b><span>BaseELMO.Observation</span></span><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span></span><br><span><var>Message</var><span><span class="hyp-body"><b>:= </b><span>BaseELMO.Message</span></span><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span></span><br><span><var>index</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>EqDecision1</var><span class="hyp-type"><b>: </b><span>EqDecision index</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>finite.Finite index</span></span></span><br><span><var>H0</var><span class="hyp-type"><b>: </b><span>Inhabited index</span></span></span><br><span><var>idx</var><span class="hyp-type"><b>: </b><span>index ‚Üí Address</span></span></span><br><span><var>Inj0</var><span class="hyp-type"><b>: </b><span>Inj eq eq idx</span></span></span><br><span><var>a1</var><span class="hyp-type"><b>: </b><span>Address</span></span></span><br><span><var>i1</var><span class="hyp-type"><b>: </b><span>index</span></span></span><br><span><var>Ha1</var><span class="hyp-type"><b>: </b><span>adr2idx a1 = Some i1</span></span></span><br><span><var>a2</var><span class="hyp-type"><b>: </b><span>Address</span></span></span><br><span><var>i2</var><span class="hyp-type"><b>: </b><span>index</span></span></span><br><span><var>Ha2</var><span class="hyp-type"><b>: </b><span>adr2idx a2 = Some i2</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">i1 = i2
‚Üí dexist a1
    (ex_intro (<span class="kr">Œª</span> <span class="nv">x</span> : index, adr2idx a1 = Some x) i1
       Ha1) =
  dexist a2
    (ex_intro (<span class="kr">Œª</span> <span class="nv">x</span> : index, adr2idx a2 = Some x) i2
       Ha2)</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="BaseELMO-v-chk11b" style="display: none" type="checkbox"><label class="alectryon-input" for="BaseELMO-v-chk11b"><span class="nb">intros</span> -&gt;; <span class="nb">apply</span> dsig_eq; <span class="nb">cbn</span>.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>Address</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>EqDecision0</var><span class="hyp-type"><b>: </b><span>EqDecision Address</span></span></span><br><span><var>State</var><span><span class="hyp-body"><b>:= </b><span>BaseELMO.State</span></span><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span></span><br><span><var>Observation</var><span><span class="hyp-body"><b>:= </b><span>BaseELMO.Observation</span></span><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span></span><br><span><var>Message</var><span><span class="hyp-body"><b>:= </b><span>BaseELMO.Message</span></span><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span></span><br><span><var>index</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>EqDecision1</var><span class="hyp-type"><b>: </b><span>EqDecision index</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>finite.Finite index</span></span></span><br><span><var>H0</var><span class="hyp-type"><b>: </b><span>Inhabited index</span></span></span><br><span><var>idx</var><span class="hyp-type"><b>: </b><span>index ‚Üí Address</span></span></span><br><span><var>Inj0</var><span class="hyp-type"><b>: </b><span>Inj eq eq idx</span></span></span><br><span><var>a1</var><span class="hyp-type"><b>: </b><span>Address</span></span></span><br><span><var>i2</var><span class="hyp-type"><b>: </b><span>index</span></span></span><br><span><var>Ha1</var><span class="hyp-type"><b>: </b><span>adr2idx a1 = Some i2</span></span></span><br><span><var>a2</var><span class="hyp-type"><b>: </b><span>Address</span></span></span><br><span><var>Ha2</var><span class="hyp-type"><b>: </b><span>adr2idx a2 = Some i2</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">a1 = a2</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><span class="alectryon-input"><span class="bp">by</span> <span class="nb">apply</span> idx_adr2idx <span class="kr">in</span> Ha1, Ha2; <span class="nb">subst</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Qed</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
</span><span class="alectryon-sentence"><span class="alectryon-input">#[export] <span class="kn">Instance</span> <span class="nf">Message_validator_measurable</span>
  `{Measurable Address} : Measurable Message_validator :=
    <span class="kr">fun</span> <span class="nv">v</span> =&gt; weight (`v).</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
</span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">End</span> <span class="nf">sec_BaseELMO_Observations</span>.</span></span></pre><div class="doc">
  We want to display State, Observation and Message using constructors
  also outside of the current module.

</div><pre class="alectryon-io highlight"><!-- Generator: Alectryon --><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Add Printing Constructor</span> State Observation Message.</span></span></pre></article></body></html>