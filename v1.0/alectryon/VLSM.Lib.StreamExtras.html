<!DOCTYPE html>
<html class="alectryon-standalone"><head><title>StreamExtras.v</title><meta charset="utf-8"><meta content="Alectryon" name="generator"><meta name="viewport" content="width=device-width, initial-scale=1"><link href="alectryon.css" rel="stylesheet"><link href="pygments.css" rel="stylesheet">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/IBM-type/0.5.4/css/ibm-type.min.css" integrity="sha512-sky5cf9Ts6FY1kstGOBHSybfKqdHR41M0Ldb0BjNiv3ifltoQIsg0zIaQ+wwdwgQ0w9vKFW7Js50lxH9vqNSSw==" crossorigin="anonymous" />
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/firacode/5.2.0/fira_code.min.css" integrity="sha512-MbysAYimH1hH2xYzkkMHB6MqxBqfP0megxsCLknbYqHVwXTCg9IqHbk+ZP/vnhO8UEW6PaXAkKe2vQ+SWACxxA==" crossorigin="anonymous" /><script src="alectryon.js"></script></head><body><article class="alectryon-root alectryon-windowed alectryon-coqdoc"><div class="alectryon-banner">Built with <a href="https://github.com/cpitclaudel/alectryon/">Alectryon</a>, running Coq+SerAPI v8.13.0+0.13.0. Bubbles (<span class="alectryon-bubble"></span>) indicate interactive fragments: hover for details, tap to reveal contents. Use <kbd>Ctrl+↑</kbd> <kbd>Ctrl+↓</kbd> to navigate, <kbd>Ctrl+🖱️</kbd> to focus. On Mac, use <kbd>⌘</kbd> instead of <kbd>Ctrl</kbd>.</div><pre class="alectryon-io highlight"><!-- Generator: Alectryon --><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">From</span> stdpp <span class="kn">Require Import</span> prelude.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">From</span> Coq <span class="kn">Require Import</span> Streams Sorted.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">From</span> VLSM.Lib <span class="kn">Require Import</span> Preamble ListExtras SortedLists.</span></span></pre><div class="doc">
<a id="lab1"></a><h1 class="section">Stream utility definitions and lemmas</h1>
</div><pre class="alectryon-io highlight"><!-- Generator: Alectryon --><span class="alectryon-sentence"><input class="alectryon-toggle" id="StreamExtras-v-chk0" style="display: none" type="checkbox"><label class="alectryon-input" for="StreamExtras-v-chk0"><span class="kn">Lemma</span> <span class="nf">fHere</span> [A:<span class="kt">Type</span>] (P: Stream A -&gt; <span class="kt">Prop</span>) : <span class="kr">forall</span> <span class="nv">s</span>, ForAll P s -&gt; P s.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>A</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>P</var><span class="hyp-type"><b>: </b><span>Stream A → <span class="kt">Prop</span></span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="kr">∀</span> <span class="nv">s</span> : Stream A, ForAll P s → P s</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="StreamExtras-v-chk1" style="display: none" type="checkbox"><label class="alectryon-input" for="StreamExtras-v-chk1"><span class="kn">Proof</span>.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>A</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>P</var><span class="hyp-type"><b>: </b><span>Stream A → <span class="kt">Prop</span></span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="kr">∀</span> <span class="nv">s</span> : Stream A, ForAll P s → P s</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><span class="alectryon-input"><span class="nb">destruct</span> <span class="mi">1</span>;<span class="bp">assumption</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Qed</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
</span><span class="alectryon-sentence"><input class="alectryon-toggle" id="StreamExtras-v-chk2" style="display: none" type="checkbox"><label class="alectryon-input" for="StreamExtras-v-chk2"><span class="kn">Lemma</span> <span class="nf">fFurther</span> [A:<span class="kt">Type</span>] (P: Stream A -&gt; <span class="kt">Prop</span>) : <span class="kr">forall</span> <span class="nv">s</span>, ForAll P s -&gt; ForAll P (tl s).</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>A</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>P</var><span class="hyp-type"><b>: </b><span>Stream A → <span class="kt">Prop</span></span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="kr">∀</span> <span class="nv">s</span> : Stream A, ForAll P s → ForAll P (tl s)</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="StreamExtras-v-chk3" style="display: none" type="checkbox"><label class="alectryon-input" for="StreamExtras-v-chk3"><span class="kn">Proof</span>.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>A</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>P</var><span class="hyp-type"><b>: </b><span>Stream A → <span class="kt">Prop</span></span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="kr">∀</span> <span class="nv">s</span> : Stream A, ForAll P s → ForAll P (tl s)</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><span class="alectryon-input"><span class="nb">destruct</span> <span class="mi">1</span>;<span class="bp">assumption</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Qed</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
</span><span class="alectryon-sentence"><input class="alectryon-toggle" id="StreamExtras-v-chk4" style="display: none" type="checkbox"><label class="alectryon-input" for="StreamExtras-v-chk4"><span class="kn">Lemma</span> <span class="nf">ForAll_subsumption</span> [A:<span class="kt">Type</span>] (P Q: Stream A -&gt; <span class="kt">Prop</span>)
  (HPQ : <span class="kr">forall</span> <span class="nv">s</span>, P s -&gt; Q s)
  : <span class="kr">forall</span> <span class="nv">s</span>, ForAll P s -&gt; ForAll Q s.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>A</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>P, Q</var><span class="hyp-type"><b>: </b><span>Stream A → <span class="kt">Prop</span></span></span></span><br><span><var>HPQ</var><span class="hyp-type"><b>: </b><span><span class="kr">∀</span> <span class="nv">s</span> : Stream A, P s → Q s</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="kr">∀</span> <span class="nv">s</span> : Stream A, ForAll P s → ForAll Q s</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="StreamExtras-v-chk5" style="display: none" type="checkbox"><label class="alectryon-input" for="StreamExtras-v-chk5"><span class="kn">Proof</span>.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>A</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>P, Q</var><span class="hyp-type"><b>: </b><span>Stream A → <span class="kt">Prop</span></span></span></span><br><span><var>HPQ</var><span class="hyp-type"><b>: </b><span><span class="kr">∀</span> <span class="nv">s</span> : Stream A, P s → Q s</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="kr">∀</span> <span class="nv">s</span> : Stream A, ForAll P s → ForAll Q s</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="StreamExtras-v-chk6" style="display: none" type="checkbox"><label class="alectryon-input" for="StreamExtras-v-chk6"><span class="nb">apply</span> ForAll_coind.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>A</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>P, Q</var><span class="hyp-type"><b>: </b><span>Stream A → <span class="kt">Prop</span></span></span></span><br><span><var>HPQ</var><span class="hyp-type"><b>: </b><span><span class="kr">∀</span> <span class="nv">s</span> : Stream A, P s → Q s</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="kr">∀</span> <span class="nv">x</span> : Stream A, ForAll P x → Q x</div></blockquote><div class="alectryon-extra-goals"><input class="alectryon-extra-goal-toggle" id="StreamExtras-v-chk7" style="display: none" type="checkbox"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>A</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>P, Q</var><span class="hyp-type"><b>: </b><span>Stream A → <span class="kt">Prop</span></span></span></span><br><span><var>HPQ</var><span class="hyp-type"><b>: </b><span><span class="kr">∀</span> <span class="nv">s</span> : Stream A, P s → Q s</span></span></span><br></div><label class="goal-separator" for="StreamExtras-v-chk7"><hr></label><div class="goal-conclusion"><span class="kr">∀</span> <span class="nv">x</span> : Stream A, ForAll P x → ForAll P (tl x)</div></blockquote></div></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="StreamExtras-v-chk8" style="display: none" type="checkbox"><label class="alectryon-input" for="StreamExtras-v-chk8">-</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>A</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>P, Q</var><span class="hyp-type"><b>: </b><span>Stream A → <span class="kt">Prop</span></span></span></span><br><span><var>HPQ</var><span class="hyp-type"><b>: </b><span><span class="kr">∀</span> <span class="nv">s</span> : Stream A, P s → Q s</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="kr">∀</span> <span class="nv">x</span> : Stream A, ForAll P x → Q x</div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="StreamExtras-v-chk9" style="display: none" type="checkbox"><label class="alectryon-input" for="StreamExtras-v-chk9"><span class="nb">intros</span> s Hp.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>A</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>P, Q</var><span class="hyp-type"><b>: </b><span>Stream A → <span class="kt">Prop</span></span></span></span><br><span><var>HPQ</var><span class="hyp-type"><b>: </b><span><span class="kr">∀</span> <span class="nv">s</span> : Stream A, P s → Q s</span></span></span><br><span><var>s</var><span class="hyp-type"><b>: </b><span>Stream A</span></span></span><br><span><var>Hp</var><span class="hyp-type"><b>: </b><span>ForAll P s</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">Q s</div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="StreamExtras-v-chka" style="display: none" type="checkbox"><label class="alectryon-input" for="StreamExtras-v-chka"><span class="nb">apply</span> HPQ.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>A</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>P, Q</var><span class="hyp-type"><b>: </b><span>Stream A → <span class="kt">Prop</span></span></span></span><br><span><var>HPQ</var><span class="hyp-type"><b>: </b><span><span class="kr">∀</span> <span class="nv">s</span> : Stream A, P s → Q s</span></span></span><br><span><var>s</var><span class="hyp-type"><b>: </b><span>Stream A</span></span></span><br><span><var>Hp</var><span class="hyp-type"><b>: </b><span>ForAll P s</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">P s</div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="StreamExtras-v-chkb" style="display: none" type="checkbox"><label class="alectryon-input" for="StreamExtras-v-chkb"><span class="nb">revert</span> Hp.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>A</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>P, Q</var><span class="hyp-type"><b>: </b><span>Stream A → <span class="kt">Prop</span></span></span></span><br><span><var>HPQ</var><span class="hyp-type"><b>: </b><span><span class="kr">∀</span> <span class="nv">s</span> : Stream A, P s → Q s</span></span></span><br><span><var>s</var><span class="hyp-type"><b>: </b><span>Stream A</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">ForAll P s → P s</div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="nb">apply</span> fHere.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="StreamExtras-v-chkc" style="display: none" type="checkbox"><label class="alectryon-input" for="StreamExtras-v-chkc">-</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>A</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>P, Q</var><span class="hyp-type"><b>: </b><span>Stream A → <span class="kt">Prop</span></span></span></span><br><span><var>HPQ</var><span class="hyp-type"><b>: </b><span><span class="kr">∀</span> <span class="nv">s</span> : Stream A, P s → Q s</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="kr">∀</span> <span class="nv">x</span> : Stream A, ForAll P x → ForAll P (tl x)</div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="nb">apply</span> fFurther.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Qed</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
</span><span class="alectryon-sentence"><input class="alectryon-toggle" id="StreamExtras-v-chkd" style="display: none" type="checkbox"><label class="alectryon-input" for="StreamExtras-v-chkd"><span class="kn">Lemma</span> <span class="nf">Exists_Str_nth_tl</span> [A : <span class="kt">Type</span>] (P : Stream A -&gt; <span class="kt">Prop</span>)
  : <span class="kr">forall</span> <span class="nv">s</span>, Exists P s &lt;-&gt; <span class="kr">exists</span> <span class="nv">n</span>, P (Str_nth_tl n s).</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>A</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>P</var><span class="hyp-type"><b>: </b><span>Stream A → <span class="kt">Prop</span></span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="kr">∀</span> <span class="nv">s</span> : Stream A,
  Exists P s ↔ (<span class="kr">∃</span> <span class="nv">n</span> : nat, P (Str_nth_tl n s))</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="StreamExtras-v-chke" style="display: none" type="checkbox"><label class="alectryon-input" for="StreamExtras-v-chke"><span class="kn">Proof</span>.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>A</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>P</var><span class="hyp-type"><b>: </b><span>Stream A → <span class="kt">Prop</span></span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="kr">∀</span> <span class="nv">s</span> : Stream A,
  Exists P s ↔ (<span class="kr">∃</span> <span class="nv">n</span> : nat, P (Str_nth_tl n s))</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="StreamExtras-v-chkf" style="display: none" type="checkbox"><label class="alectryon-input" for="StreamExtras-v-chkf"><span class="nb">intros</span> s; <span class="nb">split</span>.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>A</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>P</var><span class="hyp-type"><b>: </b><span>Stream A → <span class="kt">Prop</span></span></span></span><br><span><var>s</var><span class="hyp-type"><b>: </b><span>Stream A</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">Exists P s → <span class="kr">∃</span> <span class="nv">n</span> : nat, P (Str_nth_tl n s)</div></blockquote><div class="alectryon-extra-goals"><input class="alectryon-extra-goal-toggle" id="StreamExtras-v-chk10" style="display: none" type="checkbox"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>A</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>P</var><span class="hyp-type"><b>: </b><span>Stream A → <span class="kt">Prop</span></span></span></span><br><span><var>s</var><span class="hyp-type"><b>: </b><span>Stream A</span></span></span><br></div><label class="goal-separator" for="StreamExtras-v-chk10"><hr></label><div class="goal-conclusion">(<span class="kr">∃</span> <span class="nv">n</span> : nat, P (Str_nth_tl n s)) → Exists P s</div></blockquote></div></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="StreamExtras-v-chk11" style="display: none" type="checkbox"><label class="alectryon-input" for="StreamExtras-v-chk11">-</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>A</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>P</var><span class="hyp-type"><b>: </b><span>Stream A → <span class="kt">Prop</span></span></span></span><br><span><var>s</var><span class="hyp-type"><b>: </b><span>Stream A</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">Exists P s → <span class="kr">∃</span> <span class="nv">n</span> : nat, P (Str_nth_tl n s)</div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="StreamExtras-v-chk12" style="display: none" type="checkbox"><label class="alectryon-input" for="StreamExtras-v-chk12"><span class="nb">induction</span> <span class="mi">1</span>; [<span class="kr">exists</span> <span class="mi">0</span>; <span class="bp">assumption</span>|].</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>A</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>P</var><span class="hyp-type"><b>: </b><span>Stream A → <span class="kt">Prop</span></span></span></span><br><span><var>x</var><span class="hyp-type"><b>: </b><span>Stream A</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>Exists P (tl x)</span></span></span><br><span><var>IHExists</var><span class="hyp-type"><b>: </b><span><span class="kr">∃</span> <span class="nv">n</span> : nat, P (Str_nth_tl n (tl x))</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="kr">∃</span> <span class="nv">n</span> : nat, P (Str_nth_tl n x)</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="StreamExtras-v-chk13" style="display: none" type="checkbox"><label class="alectryon-input" for="StreamExtras-v-chk13"><span class="nb">destruct</span> IHExists <span class="kr">as</span> [n Hn].</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>A</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>P</var><span class="hyp-type"><b>: </b><span>Stream A → <span class="kt">Prop</span></span></span></span><br><span><var>x</var><span class="hyp-type"><b>: </b><span>Stream A</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>Exists P (tl x)</span></span></span><br><span><var>n</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>Hn</var><span class="hyp-type"><b>: </b><span>P (Str_nth_tl n (tl x))</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="kr">∃</span> <span class="nv">n</span> : nat, P (Str_nth_tl n x)</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="StreamExtras-v-chk14" style="display: none" type="checkbox"><label class="alectryon-input" for="StreamExtras-v-chk14"><span class="kr">exists</span> (<span class="nv">S</span> <span class="nv">n</span>).</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>A</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>P</var><span class="hyp-type"><b>: </b><span>Stream A → <span class="kt">Prop</span></span></span></span><br><span><var>x</var><span class="hyp-type"><b>: </b><span>Stream A</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>Exists P (tl x)</span></span></span><br><span><var>n</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>Hn</var><span class="hyp-type"><b>: </b><span>P (Str_nth_tl n (tl x))</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">P (Str_nth_tl (S n) x)</div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="bp">assumption</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="StreamExtras-v-chk15" style="display: none" type="checkbox"><label class="alectryon-input" for="StreamExtras-v-chk15">-</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>A</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>P</var><span class="hyp-type"><b>: </b><span>Stream A → <span class="kt">Prop</span></span></span></span><br><span><var>s</var><span class="hyp-type"><b>: </b><span>Stream A</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">(<span class="kr">∃</span> <span class="nv">n</span> : nat, P (Str_nth_tl n s)) → Exists P s</div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="StreamExtras-v-chk16" style="display: none" type="checkbox"><label class="alectryon-input" for="StreamExtras-v-chk16"><span class="nb">intros</span> [n Hn].</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>A</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>P</var><span class="hyp-type"><b>: </b><span>Stream A → <span class="kt">Prop</span></span></span></span><br><span><var>s</var><span class="hyp-type"><b>: </b><span>Stream A</span></span></span><br><span><var>n</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>Hn</var><span class="hyp-type"><b>: </b><span>P (Str_nth_tl n s)</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">Exists P s</div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="StreamExtras-v-chk17" style="display: none" type="checkbox"><label class="alectryon-input" for="StreamExtras-v-chk17"><span class="nb">revert</span> s Hn.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>A</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>P</var><span class="hyp-type"><b>: </b><span>Stream A → <span class="kt">Prop</span></span></span></span><br><span><var>n</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="kr">∀</span> <span class="nv">s</span> : Stream A, P (Str_nth_tl n s) → Exists P s</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="StreamExtras-v-chk18" style="display: none" type="checkbox"><label class="alectryon-input" for="StreamExtras-v-chk18"><span class="nb">induction</span> n; [<span class="nb">apply</span> Here; <span class="bp">assumption</span>|].</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>A</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>P</var><span class="hyp-type"><b>: </b><span>Stream A → <span class="kt">Prop</span></span></span></span><br><span><var>n</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>IHn</var><span class="hyp-type"><b>: </b><span><span class="kr">∀</span> <span class="nv">s</span> : Stream A, P (Str_nth_tl n s) → Exists P s</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="kr">∀</span> <span class="nv">s</span> : Stream A, P (Str_nth_tl (S n) s) → Exists P s</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="StreamExtras-v-chk19" style="display: none" type="checkbox"><label class="alectryon-input" for="StreamExtras-v-chk19"><span class="nb">intros</span> s Hs.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>A</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>P</var><span class="hyp-type"><b>: </b><span>Stream A → <span class="kt">Prop</span></span></span></span><br><span><var>n</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>IHn</var><span class="hyp-type"><b>: </b><span><span class="kr">∀</span> <span class="nv">s</span> : Stream A, P (Str_nth_tl n s) → Exists P s</span></span></span><br><span><var>s</var><span class="hyp-type"><b>: </b><span>Stream A</span></span></span><br><span><var>Hs</var><span class="hyp-type"><b>: </b><span>P (Str_nth_tl (S n) s)</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">Exists P s</div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="StreamExtras-v-chk1a" style="display: none" type="checkbox"><label class="alectryon-input" for="StreamExtras-v-chk1a"><span class="nb">specialize</span> (IHn (tl s) Hs).</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>A</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>P</var><span class="hyp-type"><b>: </b><span>Stream A → <span class="kt">Prop</span></span></span></span><br><span><var>n</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>s</var><span class="hyp-type"><b>: </b><span>Stream A</span></span></span><br><span><var>IHn</var><span class="hyp-type"><b>: </b><span>Exists P (tl s)</span></span></span><br><span><var>Hs</var><span class="hyp-type"><b>: </b><span>P (Str_nth_tl (S n) s)</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">Exists P s</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="StreamExtras-v-chk1b" style="display: none" type="checkbox"><label class="alectryon-input" for="StreamExtras-v-chk1b"><span class="nb">apply</span> Further.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>A</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>P</var><span class="hyp-type"><b>: </b><span>Stream A → <span class="kt">Prop</span></span></span></span><br><span><var>n</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>s</var><span class="hyp-type"><b>: </b><span>Stream A</span></span></span><br><span><var>IHn</var><span class="hyp-type"><b>: </b><span>Exists P (tl s)</span></span></span><br><span><var>Hs</var><span class="hyp-type"><b>: </b><span>P (Str_nth_tl (S n) s)</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">Exists P (tl s)</div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="bp">assumption</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Qed</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
</span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Definition</span> <span class="nf">Exists1</span> [A : <span class="kt">Type</span>] (P : A -&gt; <span class="kt">Prop</span>) := Exists (<span class="kr">fun</span> <span class="nv">s</span> =&gt; P (hd s)).</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
</span><span class="alectryon-sentence"><input class="alectryon-toggle" id="StreamExtras-v-chk1c" style="display: none" type="checkbox"><label class="alectryon-input" for="StreamExtras-v-chk1c"><span class="kn">Lemma</span> <span class="nf">Exists1_exists</span> [A : <span class="kt">Type</span>] (P : A -&gt; <span class="kt">Prop</span>) s
  : Exists1 P s &lt;-&gt; <span class="kr">exists</span> <span class="nv">n</span>, P (Str_nth n s).</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>A</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>P</var><span class="hyp-type"><b>: </b><span>A → <span class="kt">Prop</span></span></span></span><br><span><var>s</var><span class="hyp-type"><b>: </b><span>Stream A</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">Exists1 P s ↔ (<span class="kr">∃</span> <span class="nv">n</span> : nat, P (Str_nth n s))</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="StreamExtras-v-chk1d" style="display: none" type="checkbox"><label class="alectryon-input" for="StreamExtras-v-chk1d"><span class="kn">Proof</span>.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>A</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>P</var><span class="hyp-type"><b>: </b><span>A → <span class="kt">Prop</span></span></span></span><br><span><var>s</var><span class="hyp-type"><b>: </b><span>Stream A</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">Exists1 P s ↔ (<span class="kr">∃</span> <span class="nv">n</span> : nat, P (Str_nth n s))</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="StreamExtras-v-chk1e" style="display: none" type="checkbox"><label class="alectryon-input" for="StreamExtras-v-chk1e"><span class="nb">split</span>.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>A</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>P</var><span class="hyp-type"><b>: </b><span>A → <span class="kt">Prop</span></span></span></span><br><span><var>s</var><span class="hyp-type"><b>: </b><span>Stream A</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">Exists1 P s → <span class="kr">∃</span> <span class="nv">n</span> : nat, P (Str_nth n s)</div></blockquote><div class="alectryon-extra-goals"><input class="alectryon-extra-goal-toggle" id="StreamExtras-v-chk1f" style="display: none" type="checkbox"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>A</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>P</var><span class="hyp-type"><b>: </b><span>A → <span class="kt">Prop</span></span></span></span><br><span><var>s</var><span class="hyp-type"><b>: </b><span>Stream A</span></span></span><br></div><label class="goal-separator" for="StreamExtras-v-chk1f"><hr></label><div class="goal-conclusion">(<span class="kr">∃</span> <span class="nv">n</span> : nat, P (Str_nth n s)) → Exists1 P s</div></blockquote></div></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="StreamExtras-v-chk20" style="display: none" type="checkbox"><label class="alectryon-input" for="StreamExtras-v-chk20">-</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>A</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>P</var><span class="hyp-type"><b>: </b><span>A → <span class="kt">Prop</span></span></span></span><br><span><var>s</var><span class="hyp-type"><b>: </b><span>Stream A</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">Exists1 P s → <span class="kr">∃</span> <span class="nv">n</span> : nat, P (Str_nth n s)</div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="StreamExtras-v-chk21" style="display: none" type="checkbox"><label class="alectryon-input" for="StreamExtras-v-chk21"><span class="nb">induction</span> <span class="mi">1</span>.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>A</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>P</var><span class="hyp-type"><b>: </b><span>A → <span class="kt">Prop</span></span></span></span><br><span><var>x</var><span class="hyp-type"><b>: </b><span>Stream A</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>P (hd x)</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="kr">∃</span> <span class="nv">n</span> : nat, P (Str_nth n x)</div></blockquote><div class="alectryon-extra-goals"><input class="alectryon-extra-goal-toggle" id="StreamExtras-v-chk22" style="display: none" type="checkbox"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>A</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>P</var><span class="hyp-type"><b>: </b><span>A → <span class="kt">Prop</span></span></span></span><br><span><var>x</var><span class="hyp-type"><b>: </b><span>Stream A</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>Exists (<span class="kr">λ</span> <span class="nv">s</span> : Stream A, P (hd s)) (tl x)</span></span></span><br><span><var>IHExists</var><span class="hyp-type"><b>: </b><span><span class="kr">∃</span> <span class="nv">n</span> : nat, P (Str_nth n (tl x))</span></span></span><br></div><label class="goal-separator" for="StreamExtras-v-chk22"><hr></label><div class="goal-conclusion"><span class="kr">∃</span> <span class="nv">n</span> : nat, P (Str_nth n x)</div></blockquote></div></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="StreamExtras-v-chk23" style="display: none" type="checkbox"><label class="alectryon-input" for="StreamExtras-v-chk23">+</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>A</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>P</var><span class="hyp-type"><b>: </b><span>A → <span class="kt">Prop</span></span></span></span><br><span><var>x</var><span class="hyp-type"><b>: </b><span>Stream A</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>P (hd x)</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="kr">∃</span> <span class="nv">n</span> : nat, P (Str_nth n x)</div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="StreamExtras-v-chk24" style="display: none" type="checkbox"><label class="alectryon-input" for="StreamExtras-v-chk24"><span class="kr">exists</span> <span class="mi">0</span>.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>A</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>P</var><span class="hyp-type"><b>: </b><span>A → <span class="kt">Prop</span></span></span></span><br><span><var>x</var><span class="hyp-type"><b>: </b><span>Stream A</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>P (hd x)</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">P (Str_nth <span class="mi">0</span> x)</div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="bp">assumption</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="StreamExtras-v-chk25" style="display: none" type="checkbox"><label class="alectryon-input" for="StreamExtras-v-chk25">+</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>A</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>P</var><span class="hyp-type"><b>: </b><span>A → <span class="kt">Prop</span></span></span></span><br><span><var>x</var><span class="hyp-type"><b>: </b><span>Stream A</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>Exists (<span class="kr">λ</span> <span class="nv">s</span> : Stream A, P (hd s)) (tl x)</span></span></span><br><span><var>IHExists</var><span class="hyp-type"><b>: </b><span><span class="kr">∃</span> <span class="nv">n</span> : nat, P (Str_nth n (tl x))</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="kr">∃</span> <span class="nv">n</span> : nat, P (Str_nth n x)</div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="StreamExtras-v-chk26" style="display: none" type="checkbox"><label class="alectryon-input" for="StreamExtras-v-chk26"><span class="nb">destruct</span> IHExists <span class="kr">as</span> [n Hp].</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>A</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>P</var><span class="hyp-type"><b>: </b><span>A → <span class="kt">Prop</span></span></span></span><br><span><var>x</var><span class="hyp-type"><b>: </b><span>Stream A</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>Exists (<span class="kr">λ</span> <span class="nv">s</span> : Stream A, P (hd s)) (tl x)</span></span></span><br><span><var>n</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>Hp</var><span class="hyp-type"><b>: </b><span>P (Str_nth n (tl x))</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="kr">∃</span> <span class="nv">n</span> : nat, P (Str_nth n x)</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">      </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="StreamExtras-v-chk27" style="display: none" type="checkbox"><label class="alectryon-input" for="StreamExtras-v-chk27"><span class="kr">exists</span> (<span class="nv">S</span> <span class="nv">n</span>).</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>A</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>P</var><span class="hyp-type"><b>: </b><span>A → <span class="kt">Prop</span></span></span></span><br><span><var>x</var><span class="hyp-type"><b>: </b><span>Stream A</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>Exists (<span class="kr">λ</span> <span class="nv">s</span> : Stream A, P (hd s)) (tl x)</span></span></span><br><span><var>n</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>Hp</var><span class="hyp-type"><b>: </b><span>P (Str_nth n (tl x))</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">P (Str_nth (S n) x)</div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="bp">assumption</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="StreamExtras-v-chk28" style="display: none" type="checkbox"><label class="alectryon-input" for="StreamExtras-v-chk28">-</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>A</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>P</var><span class="hyp-type"><b>: </b><span>A → <span class="kt">Prop</span></span></span></span><br><span><var>s</var><span class="hyp-type"><b>: </b><span>Stream A</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">(<span class="kr">∃</span> <span class="nv">n</span> : nat, P (Str_nth n s)) → Exists1 P s</div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="StreamExtras-v-chk29" style="display: none" type="checkbox"><label class="alectryon-input" for="StreamExtras-v-chk29"><span class="nb">intros</span> [n Hp].</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>A</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>P</var><span class="hyp-type"><b>: </b><span>A → <span class="kt">Prop</span></span></span></span><br><span><var>s</var><span class="hyp-type"><b>: </b><span>Stream A</span></span></span><br><span><var>n</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>Hp</var><span class="hyp-type"><b>: </b><span>P (Str_nth n s)</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">Exists1 P s</div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="StreamExtras-v-chk2a" style="display: none" type="checkbox"><label class="alectryon-input" for="StreamExtras-v-chk2a"><span class="nb">revert</span> s Hp.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>A</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>P</var><span class="hyp-type"><b>: </b><span>A → <span class="kt">Prop</span></span></span></span><br><span><var>n</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="kr">∀</span> <span class="nv">s</span> : Stream A, P (Str_nth n s) → Exists1 P s</div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="StreamExtras-v-chk2b" style="display: none" type="checkbox"><label class="alectryon-input" for="StreamExtras-v-chk2b"><span class="nb">induction</span> n; <span class="nb">intros</span>.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>A</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>P</var><span class="hyp-type"><b>: </b><span>A → <span class="kt">Prop</span></span></span></span><br><span><var>s</var><span class="hyp-type"><b>: </b><span>Stream A</span></span></span><br><span><var>Hp</var><span class="hyp-type"><b>: </b><span>P (Str_nth <span class="mi">0</span> s)</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">Exists1 P s</div></blockquote><div class="alectryon-extra-goals"><input class="alectryon-extra-goal-toggle" id="StreamExtras-v-chk2c" style="display: none" type="checkbox"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>A</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>P</var><span class="hyp-type"><b>: </b><span>A → <span class="kt">Prop</span></span></span></span><br><span><var>n</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>IHn</var><span class="hyp-type"><b>: </b><span><span class="kr">∀</span> <span class="nv">s</span> : Stream A, P (Str_nth n s) → Exists1 P s</span></span></span><br><span><var>s</var><span class="hyp-type"><b>: </b><span>Stream A</span></span></span><br><span><var>Hp</var><span class="hyp-type"><b>: </b><span>P (Str_nth (S n) s)</span></span></span><br></div><label class="goal-separator" for="StreamExtras-v-chk2c"><hr></label><div class="goal-conclusion">Exists1 P s</div></blockquote></div></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="StreamExtras-v-chk2d" style="display: none" type="checkbox"><label class="alectryon-input" for="StreamExtras-v-chk2d">+</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>A</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>P</var><span class="hyp-type"><b>: </b><span>A → <span class="kt">Prop</span></span></span></span><br><span><var>s</var><span class="hyp-type"><b>: </b><span>Stream A</span></span></span><br><span><var>Hp</var><span class="hyp-type"><b>: </b><span>P (Str_nth <span class="mi">0</span> s)</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">Exists1 P s</div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="StreamExtras-v-chk2e" style="display: none" type="checkbox"><label class="alectryon-input" for="StreamExtras-v-chk2e"><span class="nb">apply</span> Here.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>A</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>P</var><span class="hyp-type"><b>: </b><span>A → <span class="kt">Prop</span></span></span></span><br><span><var>s</var><span class="hyp-type"><b>: </b><span>Stream A</span></span></span><br><span><var>Hp</var><span class="hyp-type"><b>: </b><span>P (Str_nth <span class="mi">0</span> s)</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">P (hd s)</div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="bp">assumption</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="StreamExtras-v-chk2f" style="display: none" type="checkbox"><label class="alectryon-input" for="StreamExtras-v-chk2f">+</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>A</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>P</var><span class="hyp-type"><b>: </b><span>A → <span class="kt">Prop</span></span></span></span><br><span><var>n</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>IHn</var><span class="hyp-type"><b>: </b><span><span class="kr">∀</span> <span class="nv">s</span> : Stream A, P (Str_nth n s) → Exists1 P s</span></span></span><br><span><var>s</var><span class="hyp-type"><b>: </b><span>Stream A</span></span></span><br><span><var>Hp</var><span class="hyp-type"><b>: </b><span>P (Str_nth (S n) s)</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">Exists1 P s</div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="StreamExtras-v-chk30" style="display: none" type="checkbox"><label class="alectryon-input" for="StreamExtras-v-chk30"><span class="nb">apply</span> Further, IHn.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>A</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>P</var><span class="hyp-type"><b>: </b><span>A → <span class="kt">Prop</span></span></span></span><br><span><var>n</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>IHn</var><span class="hyp-type"><b>: </b><span><span class="kr">∀</span> <span class="nv">s</span> : Stream A, P (Str_nth n s) → Exists1 P s</span></span></span><br><span><var>s</var><span class="hyp-type"><b>: </b><span>Stream A</span></span></span><br><span><var>Hp</var><span class="hyp-type"><b>: </b><span>P (Str_nth (S n) s)</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">P (Str_nth n (tl s))</div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="bp">assumption</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Qed</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
</span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Definition</span> <span class="nf">ForAll1</span> [A : <span class="kt">Type</span>] (P : A -&gt; <span class="kt">Prop</span>) := ForAll (<span class="kr">fun</span> <span class="nv">s</span> =&gt; P (hd s)).</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
</span><span class="alectryon-sentence"><input class="alectryon-toggle" id="StreamExtras-v-chk31" style="display: none" type="checkbox"><label class="alectryon-input" for="StreamExtras-v-chk31"><span class="kn">Lemma</span> <span class="nf">ForAll1_subsumption</span> [A:<span class="kt">Type</span>] (P Q: A -&gt; <span class="kt">Prop</span>)
  (HPQ : <span class="kr">forall</span> <span class="nv">a</span>, P a -&gt; Q a)
  : <span class="kr">forall</span> <span class="nv">s</span>, ForAll1 P s -&gt; ForAll1 Q s.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>A</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>P, Q</var><span class="hyp-type"><b>: </b><span>A → <span class="kt">Prop</span></span></span></span><br><span><var>HPQ</var><span class="hyp-type"><b>: </b><span><span class="kr">∀</span> <span class="nv">a</span> : A, P a → Q a</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="kr">∀</span> <span class="nv">s</span> : Stream A, ForAll1 P s → ForAll1 Q s</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="StreamExtras-v-chk32" style="display: none" type="checkbox"><label class="alectryon-input" for="StreamExtras-v-chk32"><span class="kn">Proof</span>.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>A</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>P, Q</var><span class="hyp-type"><b>: </b><span>A → <span class="kt">Prop</span></span></span></span><br><span><var>HPQ</var><span class="hyp-type"><b>: </b><span><span class="kr">∀</span> <span class="nv">a</span> : A, P a → Q a</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="kr">∀</span> <span class="nv">s</span> : Stream A, ForAll1 P s → ForAll1 Q s</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="StreamExtras-v-chk33" style="display: none" type="checkbox"><label class="alectryon-input" for="StreamExtras-v-chk33"><span class="nb">apply</span> ForAll_subsumption.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>A</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>P, Q</var><span class="hyp-type"><b>: </b><span>A → <span class="kt">Prop</span></span></span></span><br><span><var>HPQ</var><span class="hyp-type"><b>: </b><span><span class="kr">∀</span> <span class="nv">a</span> : A, P a → Q a</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="kr">∀</span> <span class="nv">s</span> : Stream A, P (hd s) → Q (hd s)</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="StreamExtras-v-chk34" style="display: none" type="checkbox"><label class="alectryon-input" for="StreamExtras-v-chk34"><span class="nb">intro</span> s.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>A</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>P, Q</var><span class="hyp-type"><b>: </b><span>A → <span class="kt">Prop</span></span></span></span><br><span><var>HPQ</var><span class="hyp-type"><b>: </b><span><span class="kr">∀</span> <span class="nv">a</span> : A, P a → Q a</span></span></span><br><span><var>s</var><span class="hyp-type"><b>: </b><span>Stream A</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">P (hd s) → Q (hd s)</div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="nb">apply</span> HPQ.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Qed</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
</span><span class="alectryon-sentence"><input class="alectryon-toggle" id="StreamExtras-v-chk35" style="display: none" type="checkbox"><label class="alectryon-input" for="StreamExtras-v-chk35"><span class="kn">Lemma</span> <span class="nf">ForAll1_forall</span> [A : <span class="kt">Type</span>] (P : A -&gt; <span class="kt">Prop</span>) s
  : ForAll1 P s &lt;-&gt; <span class="kr">forall</span> <span class="nv">n</span>, P (Str_nth n s).</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>A</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>P</var><span class="hyp-type"><b>: </b><span>A → <span class="kt">Prop</span></span></span></span><br><span><var>s</var><span class="hyp-type"><b>: </b><span>Stream A</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">ForAll1 P s ↔ (<span class="kr">∀</span> <span class="nv">n</span> : nat, P (Str_nth n s))</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="StreamExtras-v-chk36" style="display: none" type="checkbox"><label class="alectryon-input" for="StreamExtras-v-chk36"><span class="kn">Proof</span>.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>A</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>P</var><span class="hyp-type"><b>: </b><span>A → <span class="kt">Prop</span></span></span></span><br><span><var>s</var><span class="hyp-type"><b>: </b><span>Stream A</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">ForAll1 P s ↔ (<span class="kr">∀</span> <span class="nv">n</span> : nat, P (Str_nth n s))</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="StreamExtras-v-chk37" style="display: none" type="checkbox"><label class="alectryon-input" for="StreamExtras-v-chk37"><span class="nb">split</span>; <span class="nb">intros</span>.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>A</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>P</var><span class="hyp-type"><b>: </b><span>A → <span class="kt">Prop</span></span></span></span><br><span><var>s</var><span class="hyp-type"><b>: </b><span>Stream A</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>ForAll1 P s</span></span></span><br><span><var>n</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">P (Str_nth n s)</div></blockquote><div class="alectryon-extra-goals"><input class="alectryon-extra-goal-toggle" id="StreamExtras-v-chk38" style="display: none" type="checkbox"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>A</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>P</var><span class="hyp-type"><b>: </b><span>A → <span class="kt">Prop</span></span></span></span><br><span><var>s</var><span class="hyp-type"><b>: </b><span>Stream A</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span><span class="kr">∀</span> <span class="nv">n</span> : nat, P (Str_nth n s)</span></span></span><br></div><label class="goal-separator" for="StreamExtras-v-chk38"><hr></label><div class="goal-conclusion">ForAll1 P s</div></blockquote></div></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="StreamExtras-v-chk39" style="display: none" type="checkbox"><label class="alectryon-input" for="StreamExtras-v-chk39">-</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>A</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>P</var><span class="hyp-type"><b>: </b><span>A → <span class="kt">Prop</span></span></span></span><br><span><var>s</var><span class="hyp-type"><b>: </b><span>Stream A</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>ForAll1 P s</span></span></span><br><span><var>n</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">P (Str_nth n s)</div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="StreamExtras-v-chk3a" style="display: none" type="checkbox"><label class="alectryon-input" for="StreamExtras-v-chk3a"><span class="nb">apply</span> ForAll_Str_nth_tl <span class="kr">with</span> (m := n) <span class="kr">in</span> H.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>A</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>P</var><span class="hyp-type"><b>: </b><span>A → <span class="kt">Prop</span></span></span></span><br><span><var>s</var><span class="hyp-type"><b>: </b><span>Stream A</span></span></span><br><span><var>n</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>ForAll (<span class="kr">λ</span> <span class="nv">s</span> : Stream A, P (hd s)) (Str_nth_tl n s)</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">P (Str_nth n s)</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="StreamExtras-v-chk3b" style="display: none" type="checkbox"><label class="alectryon-input" for="StreamExtras-v-chk3b"><span class="nb">apply</span> fHere <span class="kr">in</span> H.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>A</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>P</var><span class="hyp-type"><b>: </b><span>A → <span class="kt">Prop</span></span></span></span><br><span><var>s</var><span class="hyp-type"><b>: </b><span>Stream A</span></span></span><br><span><var>n</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>P (hd (Str_nth_tl n s))</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">P (Str_nth n s)</div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="bp">assumption</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="StreamExtras-v-chk3c" style="display: none" type="checkbox"><label class="alectryon-input" for="StreamExtras-v-chk3c">-</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>A</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>P</var><span class="hyp-type"><b>: </b><span>A → <span class="kt">Prop</span></span></span></span><br><span><var>s</var><span class="hyp-type"><b>: </b><span>Stream A</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span><span class="kr">∀</span> <span class="nv">n</span> : nat, P (Str_nth n s)</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">ForAll1 P s</div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="StreamExtras-v-chk3d" style="display: none" type="checkbox"><label class="alectryon-input" for="StreamExtras-v-chk3d"><span class="nb">apply</span> ForAll_coind <span class="kr">with</span> (<span class="kr">fun</span> <span class="nv">s</span> : Stream A =&gt; <span class="kr">forall</span> <span class="nv">n</span> : nat, P (Str_nth n s))
    ; <span class="nb">intros</span>.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>A</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>P</var><span class="hyp-type"><b>: </b><span>A → <span class="kt">Prop</span></span></span></span><br><span><var>s</var><span class="hyp-type"><b>: </b><span>Stream A</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span><span class="kr">∀</span> <span class="nv">n</span> : nat, P (Str_nth n s)</span></span></span><br><span><var>x</var><span class="hyp-type"><b>: </b><span>Stream A</span></span></span><br><span><var>H0</var><span class="hyp-type"><b>: </b><span><span class="kr">∀</span> <span class="nv">n</span> : nat, P (Str_nth n x)</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">P (hd x)</div></blockquote><div class="alectryon-extra-goals"><input class="alectryon-extra-goal-toggle" id="StreamExtras-v-chk3e" style="display: none" type="checkbox"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>A</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>P</var><span class="hyp-type"><b>: </b><span>A → <span class="kt">Prop</span></span></span></span><br><span><var>s</var><span class="hyp-type"><b>: </b><span>Stream A</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span><span class="kr">∀</span> <span class="nv">n</span> : nat, P (Str_nth n s)</span></span></span><br><span><var>x</var><span class="hyp-type"><b>: </b><span>Stream A</span></span></span><br><span><var>H0</var><span class="hyp-type"><b>: </b><span><span class="kr">∀</span> <span class="nv">n</span> : nat, P (Str_nth n x)</span></span></span><br><span><var>n</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br></div><label class="goal-separator" for="StreamExtras-v-chk3e"><hr></label><div class="goal-conclusion">P (Str_nth n (tl x))</div></blockquote><input class="alectryon-extra-goal-toggle" id="StreamExtras-v-chk3f" style="display: none" type="checkbox"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>A</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>P</var><span class="hyp-type"><b>: </b><span>A → <span class="kt">Prop</span></span></span></span><br><span><var>s</var><span class="hyp-type"><b>: </b><span>Stream A</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span><span class="kr">∀</span> <span class="nv">n</span> : nat, P (Str_nth n s)</span></span></span><br><span><var>n</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br></div><label class="goal-separator" for="StreamExtras-v-chk3f"><hr></label><div class="goal-conclusion">P (Str_nth n s)</div></blockquote></div></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="StreamExtras-v-chk40" style="display: none" type="checkbox"><label class="alectryon-input" for="StreamExtras-v-chk40">+</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>A</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>P</var><span class="hyp-type"><b>: </b><span>A → <span class="kt">Prop</span></span></span></span><br><span><var>s</var><span class="hyp-type"><b>: </b><span>Stream A</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span><span class="kr">∀</span> <span class="nv">n</span> : nat, P (Str_nth n s)</span></span></span><br><span><var>x</var><span class="hyp-type"><b>: </b><span>Stream A</span></span></span><br><span><var>H0</var><span class="hyp-type"><b>: </b><span><span class="kr">∀</span> <span class="nv">n</span> : nat, P (Str_nth n x)</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">P (hd x)</div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="StreamExtras-v-chk41" style="display: none" type="checkbox"><label class="alectryon-input" for="StreamExtras-v-chk41"><span class="nb">specialize</span> (H0 <span class="mi">0</span>).</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>A</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>P</var><span class="hyp-type"><b>: </b><span>A → <span class="kt">Prop</span></span></span></span><br><span><var>s</var><span class="hyp-type"><b>: </b><span>Stream A</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span><span class="kr">∀</span> <span class="nv">n</span> : nat, P (Str_nth n s)</span></span></span><br><span><var>x</var><span class="hyp-type"><b>: </b><span>Stream A</span></span></span><br><span><var>H0</var><span class="hyp-type"><b>: </b><span>P (Str_nth <span class="mi">0</span> x)</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">P (hd x)</div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="bp">assumption</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="StreamExtras-v-chk42" style="display: none" type="checkbox"><label class="alectryon-input" for="StreamExtras-v-chk42">+</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>A</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>P</var><span class="hyp-type"><b>: </b><span>A → <span class="kt">Prop</span></span></span></span><br><span><var>s</var><span class="hyp-type"><b>: </b><span>Stream A</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span><span class="kr">∀</span> <span class="nv">n</span> : nat, P (Str_nth n s)</span></span></span><br><span><var>x</var><span class="hyp-type"><b>: </b><span>Stream A</span></span></span><br><span><var>H0</var><span class="hyp-type"><b>: </b><span><span class="kr">∀</span> <span class="nv">n</span> : nat, P (Str_nth n x)</span></span></span><br><span><var>n</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">P (Str_nth n (tl x))</div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="StreamExtras-v-chk43" style="display: none" type="checkbox"><label class="alectryon-input" for="StreamExtras-v-chk43"><span class="nb">specialize</span> (H0 (S n)).</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>A</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>P</var><span class="hyp-type"><b>: </b><span>A → <span class="kt">Prop</span></span></span></span><br><span><var>s</var><span class="hyp-type"><b>: </b><span>Stream A</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span><span class="kr">∀</span> <span class="nv">n</span> : nat, P (Str_nth n s)</span></span></span><br><span><var>x</var><span class="hyp-type"><b>: </b><span>Stream A</span></span></span><br><span><var>n</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>H0</var><span class="hyp-type"><b>: </b><span>P (Str_nth (S n) x)</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">P (Str_nth n (tl x))</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">      </span><span class="alectryon-sentence"><span class="alectryon-input"><span class="bp">assumption</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="StreamExtras-v-chk44" style="display: none" type="checkbox"><label class="alectryon-input" for="StreamExtras-v-chk44">+</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>A</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>P</var><span class="hyp-type"><b>: </b><span>A → <span class="kt">Prop</span></span></span></span><br><span><var>s</var><span class="hyp-type"><b>: </b><span>Stream A</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span><span class="kr">∀</span> <span class="nv">n</span> : nat, P (Str_nth n s)</span></span></span><br><span><var>n</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">P (Str_nth n s)</div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="nb">apply</span> H.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Qed</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
</span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Definition</span> <span class="nf">ForAll2</span> [A : <span class="kt">Type</span>] (R : A -&gt; A -&gt; <span class="kt">Prop</span>) := ForAll (<span class="kr">fun</span> <span class="nv">s</span> =&gt; R (hd s) (hd (tl s))).</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
</span><span class="alectryon-sentence"><input class="alectryon-toggle" id="StreamExtras-v-chk45" style="display: none" type="checkbox"><label class="alectryon-input" for="StreamExtras-v-chk45"><span class="kn">Lemma</span> <span class="nf">ForAll2_subsumption</span> [A:<span class="kt">Type</span>] (R1 R2 : A -&gt; A -&gt; <span class="kt">Prop</span>)
  (HR : <span class="kr">forall</span> <span class="nv">a</span> <span class="nv">b</span>, R1 a b -&gt; R2 a b)
  : <span class="kr">forall</span> <span class="nv">s</span>, ForAll2 R1 s -&gt; ForAll2 R2 s.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>A</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>R1, R2</var><span class="hyp-type"><b>: </b><span>A → A → <span class="kt">Prop</span></span></span></span><br><span><var>HR</var><span class="hyp-type"><b>: </b><span><span class="kr">∀</span> <span class="nv">a</span> <span class="nv">b</span> : A, R1 a b → R2 a b</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="kr">∀</span> <span class="nv">s</span> : Stream A, ForAll2 R1 s → ForAll2 R2 s</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="StreamExtras-v-chk46" style="display: none" type="checkbox"><label class="alectryon-input" for="StreamExtras-v-chk46"><span class="kn">Proof</span>.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>A</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>R1, R2</var><span class="hyp-type"><b>: </b><span>A → A → <span class="kt">Prop</span></span></span></span><br><span><var>HR</var><span class="hyp-type"><b>: </b><span><span class="kr">∀</span> <span class="nv">a</span> <span class="nv">b</span> : A, R1 a b → R2 a b</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="kr">∀</span> <span class="nv">s</span> : Stream A, ForAll2 R1 s → ForAll2 R2 s</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="StreamExtras-v-chk47" style="display: none" type="checkbox"><label class="alectryon-input" for="StreamExtras-v-chk47"><span class="nb">apply</span> ForAll_subsumption.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>A</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>R1, R2</var><span class="hyp-type"><b>: </b><span>A → A → <span class="kt">Prop</span></span></span></span><br><span><var>HR</var><span class="hyp-type"><b>: </b><span><span class="kr">∀</span> <span class="nv">a</span> <span class="nv">b</span> : A, R1 a b → R2 a b</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="kr">∀</span> <span class="nv">s</span> : Stream A,
  R1 (hd s) (hd (tl s)) → R2 (hd s) (hd (tl s))</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="StreamExtras-v-chk48" style="display: none" type="checkbox"><label class="alectryon-input" for="StreamExtras-v-chk48"><span class="nb">intro</span> s.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>A</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>R1, R2</var><span class="hyp-type"><b>: </b><span>A → A → <span class="kt">Prop</span></span></span></span><br><span><var>HR</var><span class="hyp-type"><b>: </b><span><span class="kr">∀</span> <span class="nv">a</span> <span class="nv">b</span> : A, R1 a b → R2 a b</span></span></span><br><span><var>s</var><span class="hyp-type"><b>: </b><span>Stream A</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">R1 (hd s) (hd (tl s)) → R2 (hd s) (hd (tl s))</div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="nb">apply</span> HR.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Qed</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
</span><span class="alectryon-sentence"><input class="alectryon-toggle" id="StreamExtras-v-chk49" style="display: none" type="checkbox"><label class="alectryon-input" for="StreamExtras-v-chk49"><span class="kn">Lemma</span> <span class="nf">ForAll2_forall</span> [A : <span class="kt">Type</span>] (R : A -&gt; A -&gt; <span class="kt">Prop</span>) s
  : ForAll2 R s &lt;-&gt; <span class="kr">forall</span> <span class="nv">n</span>, R (Str_nth n s) (Str_nth (S n) s).</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>A</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>R</var><span class="hyp-type"><b>: </b><span>A → A → <span class="kt">Prop</span></span></span></span><br><span><var>s</var><span class="hyp-type"><b>: </b><span>Stream A</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">ForAll2 R s
↔ (<span class="kr">∀</span> <span class="nv">n</span> : nat, R (Str_nth n s) (Str_nth (S n) s))</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="StreamExtras-v-chk4a" style="display: none" type="checkbox"><label class="alectryon-input" for="StreamExtras-v-chk4a"><span class="kn">Proof</span>.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>A</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>R</var><span class="hyp-type"><b>: </b><span>A → A → <span class="kt">Prop</span></span></span></span><br><span><var>s</var><span class="hyp-type"><b>: </b><span>Stream A</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">ForAll2 R s
↔ (<span class="kr">∀</span> <span class="nv">n</span> : nat, R (Str_nth n s) (Str_nth (S n) s))</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="StreamExtras-v-chk4b" style="display: none" type="checkbox"><label class="alectryon-input" for="StreamExtras-v-chk4b"><span class="nb">split</span>; <span class="nb">intros</span>.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>A</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>R</var><span class="hyp-type"><b>: </b><span>A → A → <span class="kt">Prop</span></span></span></span><br><span><var>s</var><span class="hyp-type"><b>: </b><span>Stream A</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>ForAll2 R s</span></span></span><br><span><var>n</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">R (Str_nth n s) (Str_nth (S n) s)</div></blockquote><div class="alectryon-extra-goals"><input class="alectryon-extra-goal-toggle" id="StreamExtras-v-chk4c" style="display: none" type="checkbox"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>A</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>R</var><span class="hyp-type"><b>: </b><span>A → A → <span class="kt">Prop</span></span></span></span><br><span><var>s</var><span class="hyp-type"><b>: </b><span>Stream A</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span><span class="kr">∀</span> <span class="nv">n</span> : nat, R (Str_nth n s) (Str_nth (S n) s)</span></span></span><br></div><label class="goal-separator" for="StreamExtras-v-chk4c"><hr></label><div class="goal-conclusion">ForAll2 R s</div></blockquote></div></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="StreamExtras-v-chk4d" style="display: none" type="checkbox"><label class="alectryon-input" for="StreamExtras-v-chk4d">-</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>A</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>R</var><span class="hyp-type"><b>: </b><span>A → A → <span class="kt">Prop</span></span></span></span><br><span><var>s</var><span class="hyp-type"><b>: </b><span>Stream A</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>ForAll2 R s</span></span></span><br><span><var>n</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">R (Str_nth n s) (Str_nth (S n) s)</div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="StreamExtras-v-chk4e" style="display: none" type="checkbox"><label class="alectryon-input" for="StreamExtras-v-chk4e"><span class="nb">apply</span> ForAll_Str_nth_tl <span class="kr">with</span> (m := n) <span class="kr">in</span> H.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>A</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>R</var><span class="hyp-type"><b>: </b><span>A → A → <span class="kt">Prop</span></span></span></span><br><span><var>s</var><span class="hyp-type"><b>: </b><span>Stream A</span></span></span><br><span><var>n</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>ForAll (<span class="kr">λ</span> <span class="nv">s</span> : Stream A, R (hd s) (hd (tl s)))
  (Str_nth_tl n s)</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">R (Str_nth n s) (Str_nth (S n) s)</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="StreamExtras-v-chk4f" style="display: none" type="checkbox"><label class="alectryon-input" for="StreamExtras-v-chk4f"><span class="nb">apply</span> fHere <span class="kr">in</span> H.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>A</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>R</var><span class="hyp-type"><b>: </b><span>A → A → <span class="kt">Prop</span></span></span></span><br><span><var>s</var><span class="hyp-type"><b>: </b><span>Stream A</span></span></span><br><span><var>n</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>R (hd (Str_nth_tl n s)) (hd (tl (Str_nth_tl n s)))</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">R (Str_nth n s) (Str_nth (S n) s)</div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="StreamExtras-v-chk50" style="display: none" type="checkbox"><label class="alectryon-input" for="StreamExtras-v-chk50"><span class="nb">rewrite</span> tl_nth_tl <span class="kr">in</span> H.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>A</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>R</var><span class="hyp-type"><b>: </b><span>A → A → <span class="kt">Prop</span></span></span></span><br><span><var>s</var><span class="hyp-type"><b>: </b><span>Stream A</span></span></span><br><span><var>n</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>R (hd (Str_nth_tl n s)) (hd (Str_nth_tl n (tl s)))</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">R (Str_nth n s) (Str_nth (S n) s)</div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="bp">assumption</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="StreamExtras-v-chk51" style="display: none" type="checkbox"><label class="alectryon-input" for="StreamExtras-v-chk51">-</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>A</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>R</var><span class="hyp-type"><b>: </b><span>A → A → <span class="kt">Prop</span></span></span></span><br><span><var>s</var><span class="hyp-type"><b>: </b><span>Stream A</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span><span class="kr">∀</span> <span class="nv">n</span> : nat, R (Str_nth n s) (Str_nth (S n) s)</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">ForAll2 R s</div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="StreamExtras-v-chk52" style="display: none" type="checkbox"><label class="alectryon-input" for="StreamExtras-v-chk52"><span class="nb">apply</span> ForAll_coind <span class="kr">with</span> (<span class="kr">fun</span> <span class="nv">s</span> : Stream A =&gt; <span class="kr">forall</span> <span class="nv">n</span> : nat, R (Str_nth n s) (Str_nth (S n) s))
    ; <span class="nb">intros</span>.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>A</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>R</var><span class="hyp-type"><b>: </b><span>A → A → <span class="kt">Prop</span></span></span></span><br><span><var>s</var><span class="hyp-type"><b>: </b><span>Stream A</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span><span class="kr">∀</span> <span class="nv">n</span> : nat, R (Str_nth n s) (Str_nth (S n) s)</span></span></span><br><span><var>x</var><span class="hyp-type"><b>: </b><span>Stream A</span></span></span><br><span><var>H0</var><span class="hyp-type"><b>: </b><span><span class="kr">∀</span> <span class="nv">n</span> : nat, R (Str_nth n x) (Str_nth (S n) x)</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">R (hd x) (hd (tl x))</div></blockquote><div class="alectryon-extra-goals"><input class="alectryon-extra-goal-toggle" id="StreamExtras-v-chk53" style="display: none" type="checkbox"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>A</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>R</var><span class="hyp-type"><b>: </b><span>A → A → <span class="kt">Prop</span></span></span></span><br><span><var>s</var><span class="hyp-type"><b>: </b><span>Stream A</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span><span class="kr">∀</span> <span class="nv">n</span> : nat, R (Str_nth n s) (Str_nth (S n) s)</span></span></span><br><span><var>x</var><span class="hyp-type"><b>: </b><span>Stream A</span></span></span><br><span><var>H0</var><span class="hyp-type"><b>: </b><span><span class="kr">∀</span> <span class="nv">n</span> : nat, R (Str_nth n x) (Str_nth (S n) x)</span></span></span><br><span><var>n</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br></div><label class="goal-separator" for="StreamExtras-v-chk53"><hr></label><div class="goal-conclusion">R (Str_nth n (tl x)) (Str_nth (S n) (tl x))</div></blockquote><input class="alectryon-extra-goal-toggle" id="StreamExtras-v-chk54" style="display: none" type="checkbox"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>A</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>R</var><span class="hyp-type"><b>: </b><span>A → A → <span class="kt">Prop</span></span></span></span><br><span><var>s</var><span class="hyp-type"><b>: </b><span>Stream A</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span><span class="kr">∀</span> <span class="nv">n</span> : nat, R (Str_nth n s) (Str_nth (S n) s)</span></span></span><br><span><var>n</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br></div><label class="goal-separator" for="StreamExtras-v-chk54"><hr></label><div class="goal-conclusion">R (Str_nth n s) (Str_nth (S n) s)</div></blockquote></div></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="StreamExtras-v-chk55" style="display: none" type="checkbox"><label class="alectryon-input" for="StreamExtras-v-chk55">+</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>A</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>R</var><span class="hyp-type"><b>: </b><span>A → A → <span class="kt">Prop</span></span></span></span><br><span><var>s</var><span class="hyp-type"><b>: </b><span>Stream A</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span><span class="kr">∀</span> <span class="nv">n</span> : nat, R (Str_nth n s) (Str_nth (S n) s)</span></span></span><br><span><var>x</var><span class="hyp-type"><b>: </b><span>Stream A</span></span></span><br><span><var>H0</var><span class="hyp-type"><b>: </b><span><span class="kr">∀</span> <span class="nv">n</span> : nat, R (Str_nth n x) (Str_nth (S n) x)</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">R (hd x) (hd (tl x))</div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="StreamExtras-v-chk56" style="display: none" type="checkbox"><label class="alectryon-input" for="StreamExtras-v-chk56"><span class="nb">specialize</span> (H0 <span class="mi">0</span>).</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>A</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>R</var><span class="hyp-type"><b>: </b><span>A → A → <span class="kt">Prop</span></span></span></span><br><span><var>s</var><span class="hyp-type"><b>: </b><span>Stream A</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span><span class="kr">∀</span> <span class="nv">n</span> : nat, R (Str_nth n s) (Str_nth (S n) s)</span></span></span><br><span><var>x</var><span class="hyp-type"><b>: </b><span>Stream A</span></span></span><br><span><var>H0</var><span class="hyp-type"><b>: </b><span>R (Str_nth <span class="mi">0</span> x) (Str_nth <span class="mi">1</span> x)</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">R (hd x) (hd (tl x))</div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="bp">assumption</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="StreamExtras-v-chk57" style="display: none" type="checkbox"><label class="alectryon-input" for="StreamExtras-v-chk57">+</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>A</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>R</var><span class="hyp-type"><b>: </b><span>A → A → <span class="kt">Prop</span></span></span></span><br><span><var>s</var><span class="hyp-type"><b>: </b><span>Stream A</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span><span class="kr">∀</span> <span class="nv">n</span> : nat, R (Str_nth n s) (Str_nth (S n) s)</span></span></span><br><span><var>x</var><span class="hyp-type"><b>: </b><span>Stream A</span></span></span><br><span><var>H0</var><span class="hyp-type"><b>: </b><span><span class="kr">∀</span> <span class="nv">n</span> : nat, R (Str_nth n x) (Str_nth (S n) x)</span></span></span><br><span><var>n</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">R (Str_nth n (tl x)) (Str_nth (S n) (tl x))</div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="StreamExtras-v-chk58" style="display: none" type="checkbox"><label class="alectryon-input" for="StreamExtras-v-chk58"><span class="nb">specialize</span> (H0 (S n)).</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>A</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>R</var><span class="hyp-type"><b>: </b><span>A → A → <span class="kt">Prop</span></span></span></span><br><span><var>s</var><span class="hyp-type"><b>: </b><span>Stream A</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span><span class="kr">∀</span> <span class="nv">n</span> : nat, R (Str_nth n s) (Str_nth (S n) s)</span></span></span><br><span><var>x</var><span class="hyp-type"><b>: </b><span>Stream A</span></span></span><br><span><var>n</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>H0</var><span class="hyp-type"><b>: </b><span>R (Str_nth (S n) x) (Str_nth (S (S n)) x)</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">R (Str_nth n (tl x)) (Str_nth (S n) (tl x))</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">      </span><span class="alectryon-sentence"><span class="alectryon-input"><span class="bp">assumption</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="StreamExtras-v-chk59" style="display: none" type="checkbox"><label class="alectryon-input" for="StreamExtras-v-chk59">+</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>A</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>R</var><span class="hyp-type"><b>: </b><span>A → A → <span class="kt">Prop</span></span></span></span><br><span><var>s</var><span class="hyp-type"><b>: </b><span>Stream A</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span><span class="kr">∀</span> <span class="nv">n</span> : nat, R (Str_nth n s) (Str_nth (S n) s)</span></span></span><br><span><var>n</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">R (Str_nth n s) (Str_nth (S n) s)</div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="nb">apply</span> H.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Qed</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
</span><span class="alectryon-sentence"><input class="alectryon-toggle" id="StreamExtras-v-chk5a" style="display: none" type="checkbox"><label class="alectryon-input" for="StreamExtras-v-chk5a"><span class="kn">Lemma</span> <span class="nf">recons</span>
  {<span class="nv">A</span> : <span class="kt">Type</span>}
  (<span class="nv">s</span> : Stream A)
  : Cons (hd s) (tl s) = s.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>A</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>s</var><span class="hyp-type"><b>: </b><span>Stream A</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">Cons (hd s) (tl s) = s</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="StreamExtras-v-chk5b" style="display: none" type="checkbox"><label class="alectryon-input" for="StreamExtras-v-chk5b"><span class="kn">Proof</span>.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>A</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>s</var><span class="hyp-type"><b>: </b><span>Stream A</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">Cons (hd s) (tl s) = s</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="StreamExtras-v-chk5c" style="display: none" type="checkbox"><label class="alectryon-input" for="StreamExtras-v-chk5c"><span class="nb">case</span> s.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>A</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>s</var><span class="hyp-type"><b>: </b><span>Stream A</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="kr">∀</span> (<span class="nv">a</span> : A) (<span class="nv">s</span> : Stream A),
  Cons (hd (Cons a s)) (tl (Cons a s)) = Cons a s</div></blockquote></div></div></small><span class="alectryon-wsp">  </span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="bp">reflexivity</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Qed</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
</span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Definition</span> <span class="nf">stream_app</span>
  {<span class="nv">A</span> : <span class="kt">Type</span>}
  (<span class="nv">prefix</span> : list A)
  (<span class="nv">suffix</span> : Stream A)
  : Stream A
  :=
  fold_right (@Cons A) suffix prefix.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">

</span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Definition</span> <span class="nf">stream_app_cons</span> {<span class="nv">A</span>}
  (<span class="nv">a</span> : A)
  (<span class="nv">l</span> : Stream A)
  : stream_app [a] l = Cons a l
  := eq_refl.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
</span><span class="alectryon-sentence"><input class="alectryon-toggle" id="StreamExtras-v-chk5d" style="display: none" type="checkbox"><label class="alectryon-input" for="StreamExtras-v-chk5d"><span class="kn">Lemma</span> <span class="nf">stream_app_assoc</span>
  {<span class="nv">A</span> : <span class="kt">Type</span>}
  (<span class="nv">l</span> <span class="nv">m</span> : list A)
  (<span class="nv">n</span> : Stream A)
  : stream_app l (stream_app m n) = stream_app (l ++ m) n.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>A</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>l, m</var><span class="hyp-type"><b>: </b><span>list A</span></span></span><br><span><var>n</var><span class="hyp-type"><b>: </b><span>Stream A</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">stream_app l (stream_app m n) = stream_app (l ++ m) n</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="StreamExtras-v-chk5e" style="display: none" type="checkbox"><label class="alectryon-input" for="StreamExtras-v-chk5e"><span class="kn">Proof</span>.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>A</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>l, m</var><span class="hyp-type"><b>: </b><span>list A</span></span></span><br><span><var>n</var><span class="hyp-type"><b>: </b><span>Stream A</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">stream_app l (stream_app m n) = stream_app (l ++ m) n</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="StreamExtras-v-chk5f" style="display: none" type="checkbox"><label class="alectryon-input" for="StreamExtras-v-chk5f"><span class="nb">induction</span> l; <span class="kp">try</span> <span class="bp">reflexivity</span>.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>A</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>a</var><span class="hyp-type"><b>: </b><span>A</span></span></span><br><span><var>l, m</var><span class="hyp-type"><b>: </b><span>list A</span></span></span><br><span><var>n</var><span class="hyp-type"><b>: </b><span>Stream A</span></span></span><br><span><var>IHl</var><span class="hyp-type"><b>: </b><span>stream_app l (stream_app m n) = stream_app (l ++ m) n</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">stream_app (a :: l) (stream_app m n) =
stream_app ((a :: l) ++ m) n</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="StreamExtras-v-chk60" style="display: none" type="checkbox"><label class="alectryon-input" for="StreamExtras-v-chk60"><span class="nb">simpl</span>.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>A</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>a</var><span class="hyp-type"><b>: </b><span>A</span></span></span><br><span><var>l, m</var><span class="hyp-type"><b>: </b><span>list A</span></span></span><br><span><var>n</var><span class="hyp-type"><b>: </b><span>Stream A</span></span></span><br><span><var>IHl</var><span class="hyp-type"><b>: </b><span>stream_app l (stream_app m n) = stream_app (l ++ m) n</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">Cons a (stream_app l (stream_app m n)) =
Cons a (stream_app (l ++ m) n)</div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="StreamExtras-v-chk61" style="display: none" type="checkbox"><label class="alectryon-input" for="StreamExtras-v-chk61"><span class="nb">apply</span> <span class="nb">f_equal</span>.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>A</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>a</var><span class="hyp-type"><b>: </b><span>A</span></span></span><br><span><var>l, m</var><span class="hyp-type"><b>: </b><span>list A</span></span></span><br><span><var>n</var><span class="hyp-type"><b>: </b><span>Stream A</span></span></span><br><span><var>IHl</var><span class="hyp-type"><b>: </b><span>stream_app l (stream_app m n) = stream_app (l ++ m) n</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">stream_app l (stream_app m n) = stream_app (l ++ m) n</div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="bp">assumption</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Qed</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
</span><span class="alectryon-sentence"><input class="alectryon-toggle" id="StreamExtras-v-chk62" style="display: none" type="checkbox"><label class="alectryon-input" for="StreamExtras-v-chk62"><span class="kn">Lemma</span> <span class="nf">stream_app_f_equal</span>
  {<span class="nv">A</span> : <span class="kt">Type</span>}
  (<span class="nv">l1</span> <span class="nv">l2</span> : list A)
  (<span class="nv">s1</span> <span class="nv">s2</span> : Stream A)
  (<span class="nv">Hl</span> : l1 = l2)
  (<span class="nv">Hs</span> : EqSt s1 s2)
  : EqSt (stream_app l1 s1) (stream_app l2 s2).</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>A</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>l1, l2</var><span class="hyp-type"><b>: </b><span>list A</span></span></span><br><span><var>s1, s2</var><span class="hyp-type"><b>: </b><span>Stream A</span></span></span><br><span><var>Hl</var><span class="hyp-type"><b>: </b><span>l1 = l2</span></span></span><br><span><var>Hs</var><span class="hyp-type"><b>: </b><span>EqSt s1 s2</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">EqSt (stream_app l1 s1) (stream_app l2 s2)</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="StreamExtras-v-chk63" style="display: none" type="checkbox"><label class="alectryon-input" for="StreamExtras-v-chk63"><span class="kn">Proof</span>.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>A</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>l1, l2</var><span class="hyp-type"><b>: </b><span>list A</span></span></span><br><span><var>s1, s2</var><span class="hyp-type"><b>: </b><span>Stream A</span></span></span><br><span><var>Hl</var><span class="hyp-type"><b>: </b><span>l1 = l2</span></span></span><br><span><var>Hs</var><span class="hyp-type"><b>: </b><span>EqSt s1 s2</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">EqSt (stream_app l1 s1) (stream_app l2 s2)</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="StreamExtras-v-chk64" style="display: none" type="checkbox"><label class="alectryon-input" for="StreamExtras-v-chk64"><span class="nb">subst</span>.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>A</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>l2</var><span class="hyp-type"><b>: </b><span>list A</span></span></span><br><span><var>s1, s2</var><span class="hyp-type"><b>: </b><span>Stream A</span></span></span><br><span><var>Hs</var><span class="hyp-type"><b>: </b><span>EqSt s1 s2</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">EqSt (stream_app l2 s1) (stream_app l2 s2)</div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="StreamExtras-v-chk65" style="display: none" type="checkbox"><label class="alectryon-input" for="StreamExtras-v-chk65"><span class="nb">induction</span> l2; <span class="kp">try</span> <span class="bp">assumption</span>.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>A</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>a</var><span class="hyp-type"><b>: </b><span>A</span></span></span><br><span><var>l2</var><span class="hyp-type"><b>: </b><span>list A</span></span></span><br><span><var>s1, s2</var><span class="hyp-type"><b>: </b><span>Stream A</span></span></span><br><span><var>Hs</var><span class="hyp-type"><b>: </b><span>EqSt s1 s2</span></span></span><br><span><var>IHl2</var><span class="hyp-type"><b>: </b><span>EqSt (stream_app l2 s1) (stream_app l2 s2)</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">EqSt (stream_app (a :: l2) s1)
  (stream_app (a :: l2) s2)</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="StreamExtras-v-chk66" style="display: none" type="checkbox"><label class="alectryon-input" for="StreamExtras-v-chk66"><span class="nb">simpl</span>.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>A</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>a</var><span class="hyp-type"><b>: </b><span>A</span></span></span><br><span><var>l2</var><span class="hyp-type"><b>: </b><span>list A</span></span></span><br><span><var>s1, s2</var><span class="hyp-type"><b>: </b><span>Stream A</span></span></span><br><span><var>Hs</var><span class="hyp-type"><b>: </b><span>EqSt s1 s2</span></span></span><br><span><var>IHl2</var><span class="hyp-type"><b>: </b><span>EqSt (stream_app l2 s1) (stream_app l2 s2)</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">EqSt (Cons a (stream_app l2 s1))
  (Cons a (stream_app l2 s2))</div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="StreamExtras-v-chk67" style="display: none" type="checkbox"><label class="alectryon-input" for="StreamExtras-v-chk67"><span class="nb">constructor</span>; <span class="kp">try</span> <span class="bp">reflexivity</span>.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>A</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>a</var><span class="hyp-type"><b>: </b><span>A</span></span></span><br><span><var>l2</var><span class="hyp-type"><b>: </b><span>list A</span></span></span><br><span><var>s1, s2</var><span class="hyp-type"><b>: </b><span>Stream A</span></span></span><br><span><var>Hs</var><span class="hyp-type"><b>: </b><span>EqSt s1 s2</span></span></span><br><span><var>IHl2</var><span class="hyp-type"><b>: </b><span>EqSt (stream_app l2 s1) (stream_app l2 s2)</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">EqSt (tl (Cons a (stream_app l2 s1)))
  (tl (Cons a (stream_app l2 s2)))</div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="bp">assumption</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Qed</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
</span><span class="alectryon-sentence"><input class="alectryon-toggle" id="StreamExtras-v-chk68" style="display: none" type="checkbox"><label class="alectryon-input" for="StreamExtras-v-chk68"><span class="kn">Lemma</span> <span class="nf">stream_app_inj_l</span>
  {<span class="nv">A</span> : <span class="kt">Type</span>}
  (<span class="nv">l1</span> <span class="nv">l2</span> : list A)
  (<span class="nv">s</span> : Stream A)
  (<span class="nv">Heq</span> : stream_app l1 s = stream_app l2 s)
  (<span class="nv">Heq_len</span> : length l1 = length l2)
  : l1 = l2.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>A</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>l1, l2</var><span class="hyp-type"><b>: </b><span>list A</span></span></span><br><span><var>s</var><span class="hyp-type"><b>: </b><span>Stream A</span></span></span><br><span><var>Heq</var><span class="hyp-type"><b>: </b><span>stream_app l1 s = stream_app l2 s</span></span></span><br><span><var>Heq_len</var><span class="hyp-type"><b>: </b><span>length l1 = length l2</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">l1 = l2</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="StreamExtras-v-chk69" style="display: none" type="checkbox"><label class="alectryon-input" for="StreamExtras-v-chk69"><span class="kn">Proof</span>.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>A</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>l1, l2</var><span class="hyp-type"><b>: </b><span>list A</span></span></span><br><span><var>s</var><span class="hyp-type"><b>: </b><span>Stream A</span></span></span><br><span><var>Heq</var><span class="hyp-type"><b>: </b><span>stream_app l1 s = stream_app l2 s</span></span></span><br><span><var>Heq_len</var><span class="hyp-type"><b>: </b><span>length l1 = length l2</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">l1 = l2</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="StreamExtras-v-chk6a" style="display: none" type="checkbox"><label class="alectryon-input" for="StreamExtras-v-chk6a"><span class="nb">generalize dependent</span> l2.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>A</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>l1</var><span class="hyp-type"><b>: </b><span>list A</span></span></span><br><span><var>s</var><span class="hyp-type"><b>: </b><span>Stream A</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="kr">∀</span> <span class="nv">l2</span> : list A,
  stream_app l1 s = stream_app l2 s
  → length l1 = length l2 → l1 = l2</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="StreamExtras-v-chk6b" style="display: none" type="checkbox"><label class="alectryon-input" for="StreamExtras-v-chk6b"><span class="nb">induction</span> l1; <span class="nb">intros</span>; <span class="nb">destruct</span> l2; <span class="kp">try</span> <span class="bp">reflexivity</span>; <span class="kp">try</span> <span class="nb">inversion</span> Heq_len.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>A</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>a</var><span class="hyp-type"><b>: </b><span>A</span></span></span><br><span><var>l1</var><span class="hyp-type"><b>: </b><span>list A</span></span></span><br><span><var>s</var><span class="hyp-type"><b>: </b><span>Stream A</span></span></span><br><span><var>IHl1</var><span class="hyp-type"><b>: </b><span><span class="kr">∀</span> <span class="nv">l2</span> : list A,
  stream_app l1 s = stream_app l2 s
  → length l1 = length l2 → l1 = l2</span></span></span><br><span><var>a0</var><span class="hyp-type"><b>: </b><span>A</span></span></span><br><span><var>l2</var><span class="hyp-type"><b>: </b><span>list A</span></span></span><br><span><var>Heq</var><span class="hyp-type"><b>: </b><span>stream_app (a :: l1) s = stream_app (a0 :: l2) s</span></span></span><br><span><var>Heq_len</var><span class="hyp-type"><b>: </b><span>length (a :: l1) = length (a0 :: l2)</span></span></span><br><span><var>H0</var><span class="hyp-type"><b>: </b><span>length l1 = length l2</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">a :: l1 = a0 :: l2</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="StreamExtras-v-chk6c" style="display: none" type="checkbox"><label class="alectryon-input" for="StreamExtras-v-chk6c"><span class="nb">inversion</span> Heq.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>A</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>a</var><span class="hyp-type"><b>: </b><span>A</span></span></span><br><span><var>l1</var><span class="hyp-type"><b>: </b><span>list A</span></span></span><br><span><var>s</var><span class="hyp-type"><b>: </b><span>Stream A</span></span></span><br><span><var>IHl1</var><span class="hyp-type"><b>: </b><span><span class="kr">∀</span> <span class="nv">l2</span> : list A,
  stream_app l1 s = stream_app l2 s
  → length l1 = length l2 → l1 = l2</span></span></span><br><span><var>a0</var><span class="hyp-type"><b>: </b><span>A</span></span></span><br><span><var>l2</var><span class="hyp-type"><b>: </b><span>list A</span></span></span><br><span><var>Heq</var><span class="hyp-type"><b>: </b><span>stream_app (a :: l1) s = stream_app (a0 :: l2) s</span></span></span><br><span><var>Heq_len</var><span class="hyp-type"><b>: </b><span>length (a :: l1) = length (a0 :: l2)</span></span></span><br><span><var>H0</var><span class="hyp-type"><b>: </b><span>length l1 = length l2</span></span></span><br><span><var>H1</var><span class="hyp-type"><b>: </b><span>a = a0</span></span></span><br><span><var>H2</var><span class="hyp-type"><b>: </b><span>stream_app l1 s = stream_app l2 s</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">a0 :: l1 = a0 :: l2</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="StreamExtras-v-chk6d" style="display: none" type="checkbox"><label class="alectryon-input" for="StreamExtras-v-chk6d"><span class="nb">f_equal</span>.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>A</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>a</var><span class="hyp-type"><b>: </b><span>A</span></span></span><br><span><var>l1</var><span class="hyp-type"><b>: </b><span>list A</span></span></span><br><span><var>s</var><span class="hyp-type"><b>: </b><span>Stream A</span></span></span><br><span><var>IHl1</var><span class="hyp-type"><b>: </b><span><span class="kr">∀</span> <span class="nv">l2</span> : list A,
  stream_app l1 s = stream_app l2 s
  → length l1 = length l2 → l1 = l2</span></span></span><br><span><var>a0</var><span class="hyp-type"><b>: </b><span>A</span></span></span><br><span><var>l2</var><span class="hyp-type"><b>: </b><span>list A</span></span></span><br><span><var>Heq</var><span class="hyp-type"><b>: </b><span>stream_app (a :: l1) s = stream_app (a0 :: l2) s</span></span></span><br><span><var>Heq_len</var><span class="hyp-type"><b>: </b><span>length (a :: l1) = length (a0 :: l2)</span></span></span><br><span><var>H0</var><span class="hyp-type"><b>: </b><span>length l1 = length l2</span></span></span><br><span><var>H1</var><span class="hyp-type"><b>: </b><span>a = a0</span></span></span><br><span><var>H2</var><span class="hyp-type"><b>: </b><span>stream_app l1 s = stream_app l2 s</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">l1 = l2</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="StreamExtras-v-chk6e" style="display: none" type="checkbox"><label class="alectryon-input" for="StreamExtras-v-chk6e"><span class="nb">specialize</span> (IHl1 l2 H2 H0).</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>A</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>a</var><span class="hyp-type"><b>: </b><span>A</span></span></span><br><span><var>l1</var><span class="hyp-type"><b>: </b><span>list A</span></span></span><br><span><var>s</var><span class="hyp-type"><b>: </b><span>Stream A</span></span></span><br><span><var>l2</var><span class="hyp-type"><b>: </b><span>list A</span></span></span><br><span><var>IHl1</var><span class="hyp-type"><b>: </b><span>l1 = l2</span></span></span><br><span><var>a0</var><span class="hyp-type"><b>: </b><span>A</span></span></span><br><span><var>Heq</var><span class="hyp-type"><b>: </b><span>stream_app (a :: l1) s = stream_app (a0 :: l2) s</span></span></span><br><span><var>Heq_len</var><span class="hyp-type"><b>: </b><span>length (a :: l1) = length (a0 :: l2)</span></span></span><br><span><var>H0</var><span class="hyp-type"><b>: </b><span>length l1 = length l2</span></span></span><br><span><var>H1</var><span class="hyp-type"><b>: </b><span>a = a0</span></span></span><br><span><var>H2</var><span class="hyp-type"><b>: </b><span>stream_app l1 s = stream_app l2 s</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">l1 = l2</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><span class="alectryon-input"><span class="bp">assumption</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Qed</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
</span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Fixpoint</span> <span class="nf">stream_prefix</span>
  {<span class="nv">A</span> : <span class="kt">Type</span>}
  (<span class="nv">l</span> : Stream A)
  (<span class="nv">n</span> : nat)
  : list A
  := <span class="kr">match</span> n,l <span class="kr">with</span>
  | <span class="mi">0</span>,_ =&gt; []
  | S n, Cons a l =&gt; a :: stream_prefix l n
  <span class="kr">end</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
</span><span class="alectryon-sentence"><input class="alectryon-toggle" id="StreamExtras-v-chk6f" style="display: none" type="checkbox"><label class="alectryon-input" for="StreamExtras-v-chk6f"><span class="kn">Lemma</span> <span class="nf">stream_prefix_nth</span>
  {<span class="nv">A</span> : <span class="kt">Type</span>}
  (<span class="nv">s</span> : Stream A)
  (<span class="nv">n</span> : nat)
  (<span class="nv">i</span> : nat)
  (<span class="nv">Hi</span> : i &lt; n)
  : nth_error (stream_prefix s n) i = Some (Str_nth i s).</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>A</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>s</var><span class="hyp-type"><b>: </b><span>Stream A</span></span></span><br><span><var>n, i</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>Hi</var><span class="hyp-type"><b>: </b><span>i &lt; n</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">nth_error (stream_prefix s n) i = Some (Str_nth i s)</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="StreamExtras-v-chk70" style="display: none" type="checkbox"><label class="alectryon-input" for="StreamExtras-v-chk70"><span class="kn">Proof</span>.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>A</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>s</var><span class="hyp-type"><b>: </b><span>Stream A</span></span></span><br><span><var>n, i</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>Hi</var><span class="hyp-type"><b>: </b><span>i &lt; n</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">nth_error (stream_prefix s n) i = Some (Str_nth i s)</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="StreamExtras-v-chk71" style="display: none" type="checkbox"><label class="alectryon-input" for="StreamExtras-v-chk71"><span class="nb">generalize dependent</span> n.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>A</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>s</var><span class="hyp-type"><b>: </b><span>Stream A</span></span></span><br><span><var>i</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="kr">∀</span> <span class="nv">n</span> : nat,
  i &lt; n
  → nth_error (stream_prefix s n) i =
    Some (Str_nth i s)</div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="StreamExtras-v-chk72" style="display: none" type="checkbox"><label class="alectryon-input" for="StreamExtras-v-chk72"><span class="nb">generalize dependent</span> s.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>A</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>i</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="kr">∀</span> (<span class="nv">s</span> : Stream A) (<span class="nv">n</span> : nat),
  i &lt; n
  → nth_error (stream_prefix s n) i =
    Some (Str_nth i s)</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="StreamExtras-v-chk73" style="display: none" type="checkbox"><label class="alectryon-input" for="StreamExtras-v-chk73"><span class="nb">induction</span> i; <span class="nb">intros</span> [a s] [|n] Hi; <span class="kp">try</span> <span class="bp">reflexivity</span>.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>A</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>a</var><span class="hyp-type"><b>: </b><span>A</span></span></span><br><span><var>s</var><span class="hyp-type"><b>: </b><span>Stream A</span></span></span><br><span><var>Hi</var><span class="hyp-type"><b>: </b><span><span class="mi">0</span> &lt; <span class="mi">0</span></span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">nth_error (stream_prefix (Cons a s) <span class="mi">0</span>) <span class="mi">0</span> =
Some (Str_nth <span class="mi">0</span> (Cons a s))</div></blockquote><div class="alectryon-extra-goals"><input class="alectryon-extra-goal-toggle" id="StreamExtras-v-chk74" style="display: none" type="checkbox"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>A</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>i</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>IHi</var><span class="hyp-type"><b>: </b><span><span class="kr">∀</span> (<span class="nv">s</span> : Stream A) (<span class="nv">n</span> : nat),
i &lt; n → nth_error (stream_prefix s n) i = Some (Str_nth i s)</span></span></span><br><span><var>a</var><span class="hyp-type"><b>: </b><span>A</span></span></span><br><span><var>s</var><span class="hyp-type"><b>: </b><span>Stream A</span></span></span><br><span><var>Hi</var><span class="hyp-type"><b>: </b><span>S i &lt; <span class="mi">0</span></span></span></span><br></div><label class="goal-separator" for="StreamExtras-v-chk74"><hr></label><div class="goal-conclusion">nth_error (stream_prefix (Cons a s) <span class="mi">0</span>) (S i) =
Some (Str_nth (S i) (Cons a s))</div></blockquote><input class="alectryon-extra-goal-toggle" id="StreamExtras-v-chk75" style="display: none" type="checkbox"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>A</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>i</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>IHi</var><span class="hyp-type"><b>: </b><span><span class="kr">∀</span> (<span class="nv">s</span> : Stream A) (<span class="nv">n</span> : nat),
i &lt; n → nth_error (stream_prefix s n) i = Some (Str_nth i s)</span></span></span><br><span><var>a</var><span class="hyp-type"><b>: </b><span>A</span></span></span><br><span><var>s</var><span class="hyp-type"><b>: </b><span>Stream A</span></span></span><br><span><var>n</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>Hi</var><span class="hyp-type"><b>: </b><span>S i &lt; S n</span></span></span><br></div><label class="goal-separator" for="StreamExtras-v-chk75"><hr></label><div class="goal-conclusion">nth_error (stream_prefix (Cons a s) (S n)) (S i) =
Some (Str_nth (S i) (Cons a s))</div></blockquote></div></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="StreamExtras-v-chk76" style="display: none" type="checkbox"><label class="alectryon-input" for="StreamExtras-v-chk76">-</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>A</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>a</var><span class="hyp-type"><b>: </b><span>A</span></span></span><br><span><var>s</var><span class="hyp-type"><b>: </b><span>Stream A</span></span></span><br><span><var>Hi</var><span class="hyp-type"><b>: </b><span><span class="mi">0</span> &lt; <span class="mi">0</span></span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">nth_error (stream_prefix (Cons a s) <span class="mi">0</span>) <span class="mi">0</span> =
Some (Str_nth <span class="mi">0</span> (Cons a s))</div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="nb">inversion</span> Hi.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="StreamExtras-v-chk77" style="display: none" type="checkbox"><label class="alectryon-input" for="StreamExtras-v-chk77">-</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>A</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>i</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>IHi</var><span class="hyp-type"><b>: </b><span><span class="kr">∀</span> (<span class="nv">s</span> : Stream A) (<span class="nv">n</span> : nat),
i &lt; n → nth_error (stream_prefix s n) i = Some (Str_nth i s)</span></span></span><br><span><var>a</var><span class="hyp-type"><b>: </b><span>A</span></span></span><br><span><var>s</var><span class="hyp-type"><b>: </b><span>Stream A</span></span></span><br><span><var>Hi</var><span class="hyp-type"><b>: </b><span>S i &lt; <span class="mi">0</span></span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">nth_error (stream_prefix (Cons a s) <span class="mi">0</span>) (S i) =
Some (Str_nth (S i) (Cons a s))</div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="nb">inversion</span> Hi.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="StreamExtras-v-chk78" style="display: none" type="checkbox"><label class="alectryon-input" for="StreamExtras-v-chk78">-</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>A</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>i</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>IHi</var><span class="hyp-type"><b>: </b><span><span class="kr">∀</span> (<span class="nv">s</span> : Stream A) (<span class="nv">n</span> : nat),
i &lt; n → nth_error (stream_prefix s n) i = Some (Str_nth i s)</span></span></span><br><span><var>a</var><span class="hyp-type"><b>: </b><span>A</span></span></span><br><span><var>s</var><span class="hyp-type"><b>: </b><span>Stream A</span></span></span><br><span><var>n</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>Hi</var><span class="hyp-type"><b>: </b><span>S i &lt; S n</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">nth_error (stream_prefix (Cons a s) (S n)) (S i) =
Some (Str_nth (S i) (Cons a s))</div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="StreamExtras-v-chk79" style="display: none" type="checkbox"><label class="alectryon-input" for="StreamExtras-v-chk79"><span class="nb">simpl</span>.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>A</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>i</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>IHi</var><span class="hyp-type"><b>: </b><span><span class="kr">∀</span> (<span class="nv">s</span> : Stream A) (<span class="nv">n</span> : nat),
i &lt; n → nth_error (stream_prefix s n) i = Some (Str_nth i s)</span></span></span><br><span><var>a</var><span class="hyp-type"><b>: </b><span>A</span></span></span><br><span><var>s</var><span class="hyp-type"><b>: </b><span>Stream A</span></span></span><br><span><var>n</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>Hi</var><span class="hyp-type"><b>: </b><span>S i &lt; S n</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">nth_error (stream_prefix s n) i =
Some (Str_nth (S i) (Cons a s))</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="StreamExtras-v-chk7a" style="display: none" type="checkbox"><label class="alectryon-input" for="StreamExtras-v-chk7a"><span class="nb">assert</span> (Hi&#39;: i &lt; n) <span class="bp">by</span> <span class="bp">lia</span>.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>A</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>i</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>IHi</var><span class="hyp-type"><b>: </b><span><span class="kr">∀</span> (<span class="nv">s</span> : Stream A) (<span class="nv">n</span> : nat),
i &lt; n → nth_error (stream_prefix s n) i = Some (Str_nth i s)</span></span></span><br><span><var>a</var><span class="hyp-type"><b>: </b><span>A</span></span></span><br><span><var>s</var><span class="hyp-type"><b>: </b><span>Stream A</span></span></span><br><span><var>n</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>Hi</var><span class="hyp-type"><b>: </b><span>S i &lt; S n</span></span></span><br><span><var>Hi'</var><span class="hyp-type"><b>: </b><span>i &lt; n</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">nth_error (stream_prefix s n) i =
Some (Str_nth (S i) (Cons a s))</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="StreamExtras-v-chk7b" style="display: none" type="checkbox"><label class="alectryon-input" for="StreamExtras-v-chk7b"><span class="nb">specialize</span> (IHi s n Hi&#39;).</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>A</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>i</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>s</var><span class="hyp-type"><b>: </b><span>Stream A</span></span></span><br><span><var>n</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>IHi</var><span class="hyp-type"><b>: </b><span>nth_error (stream_prefix s n) i = Some (Str_nth i s)</span></span></span><br><span><var>a</var><span class="hyp-type"><b>: </b><span>A</span></span></span><br><span><var>Hi</var><span class="hyp-type"><b>: </b><span>S i &lt; S n</span></span></span><br><span><var>Hi'</var><span class="hyp-type"><b>: </b><span>i &lt; n</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">nth_error (stream_prefix s n) i =
Some (Str_nth (S i) (Cons a s))</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="StreamExtras-v-chk7c" style="display: none" type="checkbox"><label class="alectryon-input" for="StreamExtras-v-chk7c"><span class="nb">rewrite</span> IHi.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>A</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>i</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>s</var><span class="hyp-type"><b>: </b><span>Stream A</span></span></span><br><span><var>n</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>IHi</var><span class="hyp-type"><b>: </b><span>nth_error (stream_prefix s n) i = Some (Str_nth i s)</span></span></span><br><span><var>a</var><span class="hyp-type"><b>: </b><span>A</span></span></span><br><span><var>Hi</var><span class="hyp-type"><b>: </b><span>S i &lt; S n</span></span></span><br><span><var>Hi'</var><span class="hyp-type"><b>: </b><span>i &lt; n</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">Some (Str_nth i s) = Some (Str_nth (S i) (Cons a s))</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><span class="alectryon-input"><span class="bp">reflexivity</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Qed</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
</span><span class="alectryon-sentence"><input class="alectryon-toggle" id="StreamExtras-v-chk7d" style="display: none" type="checkbox"><label class="alectryon-input" for="StreamExtras-v-chk7d"><span class="kn">Lemma</span> <span class="nf">stream_prefix_lookup</span>
  {<span class="nv">A</span> : <span class="kt">Type</span>}
  (<span class="nv">s</span> : Stream A)
  (<span class="nv">n</span> : nat)
  (<span class="nv">i</span> : nat)
  (<span class="nv">Hi</span> : i &lt; n)
  : stream_prefix s n !! i = Some (Str_nth i s).</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>A</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>s</var><span class="hyp-type"><b>: </b><span>Stream A</span></span></span><br><span><var>n, i</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>Hi</var><span class="hyp-type"><b>: </b><span>i &lt; n</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">stream_prefix s n !! i = Some (Str_nth i s)</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="StreamExtras-v-chk7e" style="display: none" type="checkbox"><label class="alectryon-input" for="StreamExtras-v-chk7e"><span class="kn">Proof</span>.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>A</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>s</var><span class="hyp-type"><b>: </b><span>Stream A</span></span></span><br><span><var>n, i</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>Hi</var><span class="hyp-type"><b>: </b><span>i &lt; n</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">stream_prefix s n !! i = Some (Str_nth i s)</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="StreamExtras-v-chk7f" style="display: none" type="checkbox"><label class="alectryon-input" for="StreamExtras-v-chk7f"><span class="nb">revert</span> s n Hi.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>A</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>i</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="kr">∀</span> (<span class="nv">s</span> : Stream A) (<span class="nv">n</span> : nat),
  i &lt; n → stream_prefix s n !! i = Some (Str_nth i s)</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="StreamExtras-v-chk80" style="display: none" type="checkbox"><label class="alectryon-input" for="StreamExtras-v-chk80"><span class="nb">induction</span> i; <span class="nb">intros</span> [a s] [|n] Hi; <span class="kp">try</span> <span class="bp">reflexivity</span>.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>A</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>a</var><span class="hyp-type"><b>: </b><span>A</span></span></span><br><span><var>s</var><span class="hyp-type"><b>: </b><span>Stream A</span></span></span><br><span><var>Hi</var><span class="hyp-type"><b>: </b><span><span class="mi">0</span> &lt; <span class="mi">0</span></span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">stream_prefix (Cons a s) <span class="mi">0</span> !! <span class="mi">0</span> =
Some (Str_nth <span class="mi">0</span> (Cons a s))</div></blockquote><div class="alectryon-extra-goals"><input class="alectryon-extra-goal-toggle" id="StreamExtras-v-chk81" style="display: none" type="checkbox"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>A</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>i</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>IHi</var><span class="hyp-type"><b>: </b><span><span class="kr">∀</span> (<span class="nv">s</span> : Stream A) (<span class="nv">n</span> : nat),
i &lt; n → stream_prefix s n !! i = Some (Str_nth i s)</span></span></span><br><span><var>a</var><span class="hyp-type"><b>: </b><span>A</span></span></span><br><span><var>s</var><span class="hyp-type"><b>: </b><span>Stream A</span></span></span><br><span><var>Hi</var><span class="hyp-type"><b>: </b><span>S i &lt; <span class="mi">0</span></span></span></span><br></div><label class="goal-separator" for="StreamExtras-v-chk81"><hr></label><div class="goal-conclusion">stream_prefix (Cons a s) <span class="mi">0</span> !! S i =
Some (Str_nth (S i) (Cons a s))</div></blockquote><input class="alectryon-extra-goal-toggle" id="StreamExtras-v-chk82" style="display: none" type="checkbox"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>A</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>i</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>IHi</var><span class="hyp-type"><b>: </b><span><span class="kr">∀</span> (<span class="nv">s</span> : Stream A) (<span class="nv">n</span> : nat),
i &lt; n → stream_prefix s n !! i = Some (Str_nth i s)</span></span></span><br><span><var>a</var><span class="hyp-type"><b>: </b><span>A</span></span></span><br><span><var>s</var><span class="hyp-type"><b>: </b><span>Stream A</span></span></span><br><span><var>n</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>Hi</var><span class="hyp-type"><b>: </b><span>S i &lt; S n</span></span></span><br></div><label class="goal-separator" for="StreamExtras-v-chk82"><hr></label><div class="goal-conclusion">stream_prefix (Cons a s) (S n) !! S i =
Some (Str_nth (S i) (Cons a s))</div></blockquote></div></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="StreamExtras-v-chk83" style="display: none" type="checkbox"><label class="alectryon-input" for="StreamExtras-v-chk83">-</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>A</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>a</var><span class="hyp-type"><b>: </b><span>A</span></span></span><br><span><var>s</var><span class="hyp-type"><b>: </b><span>Stream A</span></span></span><br><span><var>Hi</var><span class="hyp-type"><b>: </b><span><span class="mi">0</span> &lt; <span class="mi">0</span></span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">stream_prefix (Cons a s) <span class="mi">0</span> !! <span class="mi">0</span> =
Some (Str_nth <span class="mi">0</span> (Cons a s))</div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="nb">inversion</span> Hi.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="StreamExtras-v-chk84" style="display: none" type="checkbox"><label class="alectryon-input" for="StreamExtras-v-chk84">-</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>A</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>i</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>IHi</var><span class="hyp-type"><b>: </b><span><span class="kr">∀</span> (<span class="nv">s</span> : Stream A) (<span class="nv">n</span> : nat),
i &lt; n → stream_prefix s n !! i = Some (Str_nth i s)</span></span></span><br><span><var>a</var><span class="hyp-type"><b>: </b><span>A</span></span></span><br><span><var>s</var><span class="hyp-type"><b>: </b><span>Stream A</span></span></span><br><span><var>Hi</var><span class="hyp-type"><b>: </b><span>S i &lt; <span class="mi">0</span></span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">stream_prefix (Cons a s) <span class="mi">0</span> !! S i =
Some (Str_nth (S i) (Cons a s))</div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="nb">inversion</span> Hi.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="StreamExtras-v-chk85" style="display: none" type="checkbox"><label class="alectryon-input" for="StreamExtras-v-chk85">-</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>A</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>i</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>IHi</var><span class="hyp-type"><b>: </b><span><span class="kr">∀</span> (<span class="nv">s</span> : Stream A) (<span class="nv">n</span> : nat),
i &lt; n → stream_prefix s n !! i = Some (Str_nth i s)</span></span></span><br><span><var>a</var><span class="hyp-type"><b>: </b><span>A</span></span></span><br><span><var>s</var><span class="hyp-type"><b>: </b><span>Stream A</span></span></span><br><span><var>n</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>Hi</var><span class="hyp-type"><b>: </b><span>S i &lt; S n</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">stream_prefix (Cons a s) (S n) !! S i =
Some (Str_nth (S i) (Cons a s))</div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="StreamExtras-v-chk86" style="display: none" type="checkbox"><label class="alectryon-input" for="StreamExtras-v-chk86"><span class="nb">simpl</span>.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>A</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>i</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>IHi</var><span class="hyp-type"><b>: </b><span><span class="kr">∀</span> (<span class="nv">s</span> : Stream A) (<span class="nv">n</span> : nat),
i &lt; n → stream_prefix s n !! i = Some (Str_nth i s)</span></span></span><br><span><var>a</var><span class="hyp-type"><b>: </b><span>A</span></span></span><br><span><var>s</var><span class="hyp-type"><b>: </b><span>Stream A</span></span></span><br><span><var>n</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>Hi</var><span class="hyp-type"><b>: </b><span>S i &lt; S n</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">stream_prefix s n !! i =
Some (Str_nth (S i) (Cons a s))</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="StreamExtras-v-chk87" style="display: none" type="checkbox"><label class="alectryon-input" for="StreamExtras-v-chk87"><span class="nb">assert</span> (Hi&#39;: i &lt; n) <span class="bp">by</span> <span class="bp">lia</span>.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>A</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>i</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>IHi</var><span class="hyp-type"><b>: </b><span><span class="kr">∀</span> (<span class="nv">s</span> : Stream A) (<span class="nv">n</span> : nat),
i &lt; n → stream_prefix s n !! i = Some (Str_nth i s)</span></span></span><br><span><var>a</var><span class="hyp-type"><b>: </b><span>A</span></span></span><br><span><var>s</var><span class="hyp-type"><b>: </b><span>Stream A</span></span></span><br><span><var>n</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>Hi</var><span class="hyp-type"><b>: </b><span>S i &lt; S n</span></span></span><br><span><var>Hi'</var><span class="hyp-type"><b>: </b><span>i &lt; n</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">stream_prefix s n !! i =
Some (Str_nth (S i) (Cons a s))</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="StreamExtras-v-chk88" style="display: none" type="checkbox"><label class="alectryon-input" for="StreamExtras-v-chk88"><span class="nb">specialize</span> (IHi s n Hi&#39;).</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>A</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>i</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>s</var><span class="hyp-type"><b>: </b><span>Stream A</span></span></span><br><span><var>n</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>IHi</var><span class="hyp-type"><b>: </b><span>stream_prefix s n !! i = Some (Str_nth i s)</span></span></span><br><span><var>a</var><span class="hyp-type"><b>: </b><span>A</span></span></span><br><span><var>Hi</var><span class="hyp-type"><b>: </b><span>S i &lt; S n</span></span></span><br><span><var>Hi'</var><span class="hyp-type"><b>: </b><span>i &lt; n</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">stream_prefix s n !! i =
Some (Str_nth (S i) (Cons a s))</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="StreamExtras-v-chk89" style="display: none" type="checkbox"><label class="alectryon-input" for="StreamExtras-v-chk89"><span class="nb">rewrite</span> IHi.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>A</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>i</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>s</var><span class="hyp-type"><b>: </b><span>Stream A</span></span></span><br><span><var>n</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>IHi</var><span class="hyp-type"><b>: </b><span>stream_prefix s n !! i = Some (Str_nth i s)</span></span></span><br><span><var>a</var><span class="hyp-type"><b>: </b><span>A</span></span></span><br><span><var>Hi</var><span class="hyp-type"><b>: </b><span>S i &lt; S n</span></span></span><br><span><var>Hi'</var><span class="hyp-type"><b>: </b><span>i &lt; n</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">Some (Str_nth i s) = Some (Str_nth (S i) (Cons a s))</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><span class="alectryon-input"><span class="bp">reflexivity</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Qed</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
</span><span class="alectryon-sentence"><input class="alectryon-toggle" id="StreamExtras-v-chk8a" style="display: none" type="checkbox"><label class="alectryon-input" for="StreamExtras-v-chk8a"><span class="kn">Lemma</span> <span class="nf">stream_prefix_S</span>
  {<span class="nv">A</span> : <span class="kt">Type</span>}
  (<span class="nv">s</span> : Stream A)
  (<span class="nv">n</span> : nat)
  : stream_prefix s (S n) = stream_prefix s n ++ [Str_nth n s].</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>A</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>s</var><span class="hyp-type"><b>: </b><span>Stream A</span></span></span><br><span><var>n</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">stream_prefix s (S n) =
stream_prefix s n ++ [Str_nth n s]</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="StreamExtras-v-chk8b" style="display: none" type="checkbox"><label class="alectryon-input" for="StreamExtras-v-chk8b"><span class="kn">Proof</span>.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>A</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>s</var><span class="hyp-type"><b>: </b><span>Stream A</span></span></span><br><span><var>n</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">stream_prefix s (S n) =
stream_prefix s n ++ [Str_nth n s]</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="StreamExtras-v-chk8c" style="display: none" type="checkbox"><label class="alectryon-input" for="StreamExtras-v-chk8c"><span class="nb">revert</span> s.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>A</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>n</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="kr">∀</span> <span class="nv">s</span> : Stream A,
  stream_prefix s (S n) =
  stream_prefix s n ++ [Str_nth n s]</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="StreamExtras-v-chk8d" style="display: none" type="checkbox"><label class="alectryon-input" for="StreamExtras-v-chk8d"><span class="nb">induction</span> n; <span class="nb">intros</span>; <span class="nb">rewrite</span> &lt;- (recons s); [<span class="bp">reflexivity</span>|].</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>A</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>n</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>IHn</var><span class="hyp-type"><b>: </b><span><span class="kr">∀</span> <span class="nv">s</span> : Stream A, stream_prefix s (S n) = stream_prefix s n ++ [Str_nth n s]</span></span></span><br><span><var>s</var><span class="hyp-type"><b>: </b><span>Stream A</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">stream_prefix (Cons (hd s) (tl s)) (S (S n)) =
stream_prefix (Cons (hd s) (tl s)) (S n) ++
[Str_nth (S n) (Cons (hd s) (tl s))]</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="StreamExtras-v-chk8e" style="display: none" type="checkbox"><label class="alectryon-input" for="StreamExtras-v-chk8e"><span class="nb">simpl</span>.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>A</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>n</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>IHn</var><span class="hyp-type"><b>: </b><span><span class="kr">∀</span> <span class="nv">s</span> : Stream A, stream_prefix s (S n) = stream_prefix s n ++ [Str_nth n s]</span></span></span><br><span><var>s</var><span class="hyp-type"><b>: </b><span>Stream A</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">hd s
:: <span class="kr">match</span> tl s <span class="kr">with</span>
   | Cons a l =&gt; a :: stream_prefix l n
   <span class="kr">end</span> =
hd s
:: stream_prefix (tl s) n ++
   [Str_nth (S n) (Cons (hd s) (tl s))]</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="StreamExtras-v-chk8f" style="display: none" type="checkbox"><label class="alectryon-input" for="StreamExtras-v-chk8f"><span class="nb">f_equal</span>.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>A</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>n</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>IHn</var><span class="hyp-type"><b>: </b><span><span class="kr">∀</span> <span class="nv">s</span> : Stream A, stream_prefix s (S n) = stream_prefix s n ++ [Str_nth n s]</span></span></span><br><span><var>s</var><span class="hyp-type"><b>: </b><span>Stream A</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="kr">match</span> tl s <span class="kr">with</span>
| Cons a l =&gt; a :: stream_prefix l n
<span class="kr">end</span> =
stream_prefix (tl s) n ++
[Str_nth (S n) (Cons (hd s) (tl s))]</div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="nb">apply</span> IHn.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Qed</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
</span><span class="alectryon-sentence"><input class="alectryon-toggle" id="StreamExtras-v-chk90" style="display: none" type="checkbox"><label class="alectryon-input" for="StreamExtras-v-chk90"><span class="kn">Lemma</span> <span class="nf">stream_prefix_EqSt</span>
  {<span class="nv">A</span> : <span class="kt">Type</span>}
  (<span class="nv">s1</span> <span class="nv">s2</span> : Stream A)
  (<span class="nv">Heq</span> : EqSt s1 s2)
  : <span class="kr">forall</span> <span class="nv">n</span> : nat, stream_prefix s1 n = stream_prefix s2 n .</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>A</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>s1, s2</var><span class="hyp-type"><b>: </b><span>Stream A</span></span></span><br><span><var>Heq</var><span class="hyp-type"><b>: </b><span>EqSt s1 s2</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="kr">∀</span> <span class="nv">n</span> : nat, stream_prefix s1 n = stream_prefix s2 n</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="StreamExtras-v-chk91" style="display: none" type="checkbox"><label class="alectryon-input" for="StreamExtras-v-chk91"><span class="kn">Proof</span>.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>A</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>s1, s2</var><span class="hyp-type"><b>: </b><span>Stream A</span></span></span><br><span><var>Heq</var><span class="hyp-type"><b>: </b><span>EqSt s1 s2</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="kr">∀</span> <span class="nv">n</span> : nat, stream_prefix s1 n = stream_prefix s2 n</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="StreamExtras-v-chk92" style="display: none" type="checkbox"><label class="alectryon-input" for="StreamExtras-v-chk92"><span class="nb">intro</span> n.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>A</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>s1, s2</var><span class="hyp-type"><b>: </b><span>Stream A</span></span></span><br><span><var>Heq</var><span class="hyp-type"><b>: </b><span>EqSt s1 s2</span></span></span><br><span><var>n</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">stream_prefix s1 n = stream_prefix s2 n</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="StreamExtras-v-chk93" style="display: none" type="checkbox"><label class="alectryon-input" for="StreamExtras-v-chk93"><span class="nb">generalize dependent</span> s2.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>A</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>s1</var><span class="hyp-type"><b>: </b><span>Stream A</span></span></span><br><span><var>n</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="kr">∀</span> <span class="nv">s2</span> : Stream A,
  EqSt s1 s2 → stream_prefix s1 n = stream_prefix s2 n</div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="StreamExtras-v-chk94" style="display: none" type="checkbox"><label class="alectryon-input" for="StreamExtras-v-chk94"><span class="nb">generalize dependent</span> s1.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>A</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>n</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="kr">∀</span> <span class="nv">s1</span> <span class="nv">s2</span> : Stream A,
  EqSt s1 s2 → stream_prefix s1 n = stream_prefix s2 n</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="StreamExtras-v-chk95" style="display: none" type="checkbox"><label class="alectryon-input" for="StreamExtras-v-chk95"><span class="nb">induction</span> n; <span class="kp">try</span> <span class="bp">reflexivity</span>; <span class="nb">intros</span> (a1, s1) (a2,s2) Heq.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>A</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>n</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>IHn</var><span class="hyp-type"><b>: </b><span><span class="kr">∀</span> <span class="nv">s1</span> <span class="nv">s2</span> : Stream A, EqSt s1 s2 → stream_prefix s1 n = stream_prefix s2 n</span></span></span><br><span><var>a1</var><span class="hyp-type"><b>: </b><span>A</span></span></span><br><span><var>s1</var><span class="hyp-type"><b>: </b><span>Stream A</span></span></span><br><span><var>a2</var><span class="hyp-type"><b>: </b><span>A</span></span></span><br><span><var>s2</var><span class="hyp-type"><b>: </b><span>Stream A</span></span></span><br><span><var>Heq</var><span class="hyp-type"><b>: </b><span>EqSt (Cons a1 s1) (Cons a2 s2)</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">stream_prefix (Cons a1 s1) (S n) =
stream_prefix (Cons a2 s2) (S n)</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="StreamExtras-v-chk96" style="display: none" type="checkbox"><label class="alectryon-input" for="StreamExtras-v-chk96"><span class="nb">inversion</span> Heq.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>A</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>n</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>IHn</var><span class="hyp-type"><b>: </b><span><span class="kr">∀</span> <span class="nv">s1</span> <span class="nv">s2</span> : Stream A, EqSt s1 s2 → stream_prefix s1 n = stream_prefix s2 n</span></span></span><br><span><var>a1</var><span class="hyp-type"><b>: </b><span>A</span></span></span><br><span><var>s1</var><span class="hyp-type"><b>: </b><span>Stream A</span></span></span><br><span><var>a2</var><span class="hyp-type"><b>: </b><span>A</span></span></span><br><span><var>s2</var><span class="hyp-type"><b>: </b><span>Stream A</span></span></span><br><span><var>Heq</var><span class="hyp-type"><b>: </b><span>EqSt (Cons a1 s1) (Cons a2 s2)</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>hd (Cons a1 s1) = hd (Cons a2 s2)</span></span></span><br><span><var>H0</var><span class="hyp-type"><b>: </b><span>EqSt (tl (Cons a1 s1)) (tl (Cons a2 s2))</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">stream_prefix (Cons a1 s1) (S n) =
stream_prefix (Cons a2 s2) (S n)</div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="StreamExtras-v-chk97" style="display: none" type="checkbox"><label class="alectryon-input" for="StreamExtras-v-chk97"><span class="nb">simpl</span> <span class="kr">in</span> H; <span class="nb">subst</span>.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>A</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>n</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>IHn</var><span class="hyp-type"><b>: </b><span><span class="kr">∀</span> <span class="nv">s1</span> <span class="nv">s2</span> : Stream A, EqSt s1 s2 → stream_prefix s1 n = stream_prefix s2 n</span></span></span><br><span><var>s1</var><span class="hyp-type"><b>: </b><span>Stream A</span></span></span><br><span><var>a2</var><span class="hyp-type"><b>: </b><span>A</span></span></span><br><span><var>s2</var><span class="hyp-type"><b>: </b><span>Stream A</span></span></span><br><span><var>Heq</var><span class="hyp-type"><b>: </b><span>EqSt (Cons a2 s1) (Cons a2 s2)</span></span></span><br><span><var>H0</var><span class="hyp-type"><b>: </b><span>EqSt (tl (Cons a2 s1)) (tl (Cons a2 s2))</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">stream_prefix (Cons a2 s1) (S n) =
stream_prefix (Cons a2 s2) (S n)</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="StreamExtras-v-chk98" style="display: none" type="checkbox"><label class="alectryon-input" for="StreamExtras-v-chk98"><span class="nb">simpl</span>.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>A</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>n</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>IHn</var><span class="hyp-type"><b>: </b><span><span class="kr">∀</span> <span class="nv">s1</span> <span class="nv">s2</span> : Stream A, EqSt s1 s2 → stream_prefix s1 n = stream_prefix s2 n</span></span></span><br><span><var>s1</var><span class="hyp-type"><b>: </b><span>Stream A</span></span></span><br><span><var>a2</var><span class="hyp-type"><b>: </b><span>A</span></span></span><br><span><var>s2</var><span class="hyp-type"><b>: </b><span>Stream A</span></span></span><br><span><var>Heq</var><span class="hyp-type"><b>: </b><span>EqSt (Cons a2 s1) (Cons a2 s2)</span></span></span><br><span><var>H0</var><span class="hyp-type"><b>: </b><span>EqSt (tl (Cons a2 s1)) (tl (Cons a2 s2))</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">a2 :: stream_prefix s1 n = a2 :: stream_prefix s2 n</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="StreamExtras-v-chk99" style="display: none" type="checkbox"><label class="alectryon-input" for="StreamExtras-v-chk99"><span class="nb">f_equal</span>.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>A</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>n</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>IHn</var><span class="hyp-type"><b>: </b><span><span class="kr">∀</span> <span class="nv">s1</span> <span class="nv">s2</span> : Stream A, EqSt s1 s2 → stream_prefix s1 n = stream_prefix s2 n</span></span></span><br><span><var>s1</var><span class="hyp-type"><b>: </b><span>Stream A</span></span></span><br><span><var>a2</var><span class="hyp-type"><b>: </b><span>A</span></span></span><br><span><var>s2</var><span class="hyp-type"><b>: </b><span>Stream A</span></span></span><br><span><var>Heq</var><span class="hyp-type"><b>: </b><span>EqSt (Cons a2 s1) (Cons a2 s2)</span></span></span><br><span><var>H0</var><span class="hyp-type"><b>: </b><span>EqSt (tl (Cons a2 s1)) (tl (Cons a2 s2))</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">stream_prefix s1 n = stream_prefix s2 n</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="StreamExtras-v-chk9a" style="display: none" type="checkbox"><label class="alectryon-input" for="StreamExtras-v-chk9a"><span class="nb">apply</span> IHn.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>A</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>n</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>IHn</var><span class="hyp-type"><b>: </b><span><span class="kr">∀</span> <span class="nv">s1</span> <span class="nv">s2</span> : Stream A, EqSt s1 s2 → stream_prefix s1 n = stream_prefix s2 n</span></span></span><br><span><var>s1</var><span class="hyp-type"><b>: </b><span>Stream A</span></span></span><br><span><var>a2</var><span class="hyp-type"><b>: </b><span>A</span></span></span><br><span><var>s2</var><span class="hyp-type"><b>: </b><span>Stream A</span></span></span><br><span><var>Heq</var><span class="hyp-type"><b>: </b><span>EqSt (Cons a2 s1) (Cons a2 s2)</span></span></span><br><span><var>H0</var><span class="hyp-type"><b>: </b><span>EqSt (tl (Cons a2 s1)) (tl (Cons a2 s2))</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">EqSt s1 s2</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><span class="alectryon-input"><span class="bp">assumption</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Qed</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
</span><span class="alectryon-sentence"><input class="alectryon-toggle" id="StreamExtras-v-chk9b" style="display: none" type="checkbox"><label class="alectryon-input" for="StreamExtras-v-chk9b"><span class="kn">Lemma</span> <span class="nf">EqSt_stream_prefix</span>
  {<span class="nv">A</span> : <span class="kt">Type</span>}
  (<span class="nv">s1</span> <span class="nv">s2</span> : Stream A)
  (<span class="nv">Hpref</span> : <span class="kr">forall</span> <span class="nv">n</span> : nat, stream_prefix s1 n = stream_prefix s2 n)
  : EqSt s1 s2.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>A</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>s1, s2</var><span class="hyp-type"><b>: </b><span>Stream A</span></span></span><br><span><var>Hpref</var><span class="hyp-type"><b>: </b><span><span class="kr">∀</span> <span class="nv">n</span> : nat,
  stream_prefix s1 n = stream_prefix s2 n</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">EqSt s1 s2</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="StreamExtras-v-chk9c" style="display: none" type="checkbox"><label class="alectryon-input" for="StreamExtras-v-chk9c"><span class="kn">Proof</span>.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>A</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>s1, s2</var><span class="hyp-type"><b>: </b><span>Stream A</span></span></span><br><span><var>Hpref</var><span class="hyp-type"><b>: </b><span><span class="kr">∀</span> <span class="nv">n</span> : nat,
  stream_prefix s1 n = stream_prefix s2 n</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">EqSt s1 s2</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="StreamExtras-v-chk9d" style="display: none" type="checkbox"><label class="alectryon-input" for="StreamExtras-v-chk9d"><span class="nb">apply</span> ntheq_eqst.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>A</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>s1, s2</var><span class="hyp-type"><b>: </b><span>Stream A</span></span></span><br><span><var>Hpref</var><span class="hyp-type"><b>: </b><span><span class="kr">∀</span> <span class="nv">n</span> : nat,
  stream_prefix s1 n = stream_prefix s2 n</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="kr">∀</span> <span class="nv">n</span> : nat, Str_nth n s1 = Str_nth n s2</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="StreamExtras-v-chk9e" style="display: none" type="checkbox"><label class="alectryon-input" for="StreamExtras-v-chk9e"><span class="nb">intro</span> n.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>A</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>s1, s2</var><span class="hyp-type"><b>: </b><span>Stream A</span></span></span><br><span><var>Hpref</var><span class="hyp-type"><b>: </b><span><span class="kr">∀</span> <span class="nv">n</span> : nat,
  stream_prefix s1 n = stream_prefix s2 n</span></span></span><br><span><var>n</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">Str_nth n s1 = Str_nth n s2</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="StreamExtras-v-chk9f" style="display: none" type="checkbox"><label class="alectryon-input" for="StreamExtras-v-chk9f"><span class="nb">assert</span> (Hlt : n &lt; S n) <span class="bp">by</span> <span class="nb">constructor</span>.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>A</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>s1, s2</var><span class="hyp-type"><b>: </b><span>Stream A</span></span></span><br><span><var>Hpref</var><span class="hyp-type"><b>: </b><span><span class="kr">∀</span> <span class="nv">n</span> : nat,
  stream_prefix s1 n = stream_prefix s2 n</span></span></span><br><span><var>n</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>Hlt</var><span class="hyp-type"><b>: </b><span>n &lt; S n</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">Str_nth n s1 = Str_nth n s2</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="StreamExtras-v-chka0" style="display: none" type="checkbox"><label class="alectryon-input" for="StreamExtras-v-chka0"><span class="nb">assert</span> (HSome : Some (Str_nth n s1) = Some (Str_nth n s2)).</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>A</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>s1, s2</var><span class="hyp-type"><b>: </b><span>Stream A</span></span></span><br><span><var>Hpref</var><span class="hyp-type"><b>: </b><span><span class="kr">∀</span> <span class="nv">n</span> : nat,
  stream_prefix s1 n = stream_prefix s2 n</span></span></span><br><span><var>n</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>Hlt</var><span class="hyp-type"><b>: </b><span>n &lt; S n</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">Some (Str_nth n s1) = Some (Str_nth n s2)</div></blockquote><div class="alectryon-extra-goals"><input class="alectryon-extra-goal-toggle" id="StreamExtras-v-chka1" style="display: none" type="checkbox"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>A</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>s1, s2</var><span class="hyp-type"><b>: </b><span>Stream A</span></span></span><br><span><var>Hpref</var><span class="hyp-type"><b>: </b><span><span class="kr">∀</span> <span class="nv">n</span> : nat,
  stream_prefix s1 n = stream_prefix s2 n</span></span></span><br><span><var>n</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>Hlt</var><span class="hyp-type"><b>: </b><span>n &lt; S n</span></span></span><br><span><var>HSome</var><span class="hyp-type"><b>: </b><span>Some (Str_nth n s1) = Some (Str_nth n s2)</span></span></span><br></div><label class="goal-separator" for="StreamExtras-v-chka1"><hr></label><div class="goal-conclusion">Str_nth n s1 = Str_nth n s2</div></blockquote></div></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="StreamExtras-v-chka2" style="display: none" type="checkbox"><label class="alectryon-input" for="StreamExtras-v-chka2">{</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>A</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>s1, s2</var><span class="hyp-type"><b>: </b><span>Stream A</span></span></span><br><span><var>Hpref</var><span class="hyp-type"><b>: </b><span><span class="kr">∀</span> <span class="nv">n</span> : nat,
  stream_prefix s1 n = stream_prefix s2 n</span></span></span><br><span><var>n</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>Hlt</var><span class="hyp-type"><b>: </b><span>n &lt; S n</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">Some (Str_nth n s1) = Some (Str_nth n s2)</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="StreamExtras-v-chka3" style="display: none" type="checkbox"><label class="alectryon-input" for="StreamExtras-v-chka3"><span class="nb">rewrite</span> &lt;- (stream_prefix_nth  s1 (S n) n Hlt).</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>A</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>s1, s2</var><span class="hyp-type"><b>: </b><span>Stream A</span></span></span><br><span><var>Hpref</var><span class="hyp-type"><b>: </b><span><span class="kr">∀</span> <span class="nv">n</span> : nat,
  stream_prefix s1 n = stream_prefix s2 n</span></span></span><br><span><var>n</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>Hlt</var><span class="hyp-type"><b>: </b><span>n &lt; S n</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">nth_error (stream_prefix s1 (S n)) n =
Some (Str_nth n s2)</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="StreamExtras-v-chka4" style="display: none" type="checkbox"><label class="alectryon-input" for="StreamExtras-v-chka4"><span class="nb">rewrite</span> &lt;- (stream_prefix_nth  s2 (S n) n Hlt).</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>A</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>s1, s2</var><span class="hyp-type"><b>: </b><span>Stream A</span></span></span><br><span><var>Hpref</var><span class="hyp-type"><b>: </b><span><span class="kr">∀</span> <span class="nv">n</span> : nat,
  stream_prefix s1 n = stream_prefix s2 n</span></span></span><br><span><var>n</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>Hlt</var><span class="hyp-type"><b>: </b><span>n &lt; S n</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">nth_error (stream_prefix s1 (S n)) n =
nth_error (stream_prefix s2 (S n)) n</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="StreamExtras-v-chka5" style="display: none" type="checkbox"><label class="alectryon-input" for="StreamExtras-v-chka5"><span class="nb">specialize</span> (Hpref (S n)).</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>A</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>s1, s2</var><span class="hyp-type"><b>: </b><span>Stream A</span></span></span><br><span><var>n</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>Hpref</var><span class="hyp-type"><b>: </b><span>stream_prefix s1 (S n) =
stream_prefix s2 (S n)</span></span></span><br><span><var>Hlt</var><span class="hyp-type"><b>: </b><span>n &lt; S n</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">nth_error (stream_prefix s1 (S n)) n =
nth_error (stream_prefix s2 (S n)) n</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="StreamExtras-v-chka6" style="display: none" type="checkbox"><label class="alectryon-input" for="StreamExtras-v-chka6"><span class="nb">rewrite</span> Hpref.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>A</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>s1, s2</var><span class="hyp-type"><b>: </b><span>Stream A</span></span></span><br><span><var>n</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>Hpref</var><span class="hyp-type"><b>: </b><span>stream_prefix s1 (S n) =
stream_prefix s2 (S n)</span></span></span><br><span><var>Hlt</var><span class="hyp-type"><b>: </b><span>n &lt; S n</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">nth_error (stream_prefix s2 (S n)) n =
nth_error (stream_prefix s2 (S n)) n</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><span class="alectryon-input"><span class="bp">reflexivity</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="StreamExtras-v-chka7" style="display: none" type="checkbox"><label class="alectryon-input" for="StreamExtras-v-chka7">}</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>A</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>s1, s2</var><span class="hyp-type"><b>: </b><span>Stream A</span></span></span><br><span><var>Hpref</var><span class="hyp-type"><b>: </b><span><span class="kr">∀</span> <span class="nv">n</span> : nat,
  stream_prefix s1 n = stream_prefix s2 n</span></span></span><br><span><var>n</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>Hlt</var><span class="hyp-type"><b>: </b><span>n &lt; S n</span></span></span><br><span><var>HSome</var><span class="hyp-type"><b>: </b><span>Some (Str_nth n s1) = Some (Str_nth n s2)</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">Str_nth n s1 = Str_nth n s2</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="StreamExtras-v-chka8" style="display: none" type="checkbox"><label class="alectryon-input" for="StreamExtras-v-chka8"><span class="nb">inversion</span> HSome.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>A</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>s1, s2</var><span class="hyp-type"><b>: </b><span>Stream A</span></span></span><br><span><var>Hpref</var><span class="hyp-type"><b>: </b><span><span class="kr">∀</span> <span class="nv">n</span> : nat,
  stream_prefix s1 n = stream_prefix s2 n</span></span></span><br><span><var>n</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>Hlt</var><span class="hyp-type"><b>: </b><span>n &lt; S n</span></span></span><br><span><var>HSome</var><span class="hyp-type"><b>: </b><span>Some (Str_nth n s1) = Some (Str_nth n s2)</span></span></span><br><span><var>H0</var><span class="hyp-type"><b>: </b><span>Str_nth n s1 = Str_nth n s2</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">Str_nth n s1 = Str_nth n s1</div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="bp">reflexivity</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Qed</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
</span><span class="alectryon-sentence"><input class="alectryon-toggle" id="StreamExtras-v-chka9" style="display: none" type="checkbox"><label class="alectryon-input" for="StreamExtras-v-chka9"><span class="kn">Lemma</span> <span class="nf">elem_of_stream_prefix</span>
  {<span class="nv">A</span> : <span class="kt">Type</span>}
  (<span class="nv">l</span> : Stream A)
  (<span class="nv">n</span> : nat)
  (<span class="nv">a</span> : A)
  : a ∈ (stream_prefix l n) &lt;-&gt; <span class="kr">exists</span> <span class="nv">k</span> : nat, k &lt; n /\ Str_nth k l = a.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>A</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>l</var><span class="hyp-type"><b>: </b><span>Stream A</span></span></span><br><span><var>n</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>a</var><span class="hyp-type"><b>: </b><span>A</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">a ∈ stream_prefix l n
↔ (<span class="kr">∃</span> <span class="nv">k</span> : nat, k &lt; n ∧ Str_nth k l = a)</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="StreamExtras-v-chkaa" style="display: none" type="checkbox"><label class="alectryon-input" for="StreamExtras-v-chkaa"><span class="kn">Proof</span>.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>A</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>l</var><span class="hyp-type"><b>: </b><span>Stream A</span></span></span><br><span><var>n</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>a</var><span class="hyp-type"><b>: </b><span>A</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">a ∈ stream_prefix l n
↔ (<span class="kr">∃</span> <span class="nv">k</span> : nat, k &lt; n ∧ Str_nth k l = a)</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="StreamExtras-v-chkab" style="display: none" type="checkbox"><label class="alectryon-input" for="StreamExtras-v-chkab"><span class="nb">revert</span> l a.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>A</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>n</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="kr">∀</span> (<span class="nv">l</span> : Stream A) (<span class="nv">a</span> : A),
  a ∈ stream_prefix l n
  ↔ (<span class="kr">∃</span> <span class="nv">k</span> : nat, k &lt; n ∧ Str_nth k l = a)</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="StreamExtras-v-chkac" style="display: none" type="checkbox"><label class="alectryon-input" for="StreamExtras-v-chkac"><span class="nb">induction</span> n; <span class="nb">simpl</span>; <span class="nb">split</span>; <span class="nb">intros</span>.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>A</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>l</var><span class="hyp-type"><b>: </b><span>Stream A</span></span></span><br><span><var>a</var><span class="hyp-type"><b>: </b><span>A</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>a ∈ []</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="kr">∃</span> <span class="nv">k</span> : nat, k &lt; <span class="mi">0</span> ∧ Str_nth k l = a</div></blockquote><div class="alectryon-extra-goals"><input class="alectryon-extra-goal-toggle" id="StreamExtras-v-chkad" style="display: none" type="checkbox"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>A</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>l</var><span class="hyp-type"><b>: </b><span>Stream A</span></span></span><br><span><var>a</var><span class="hyp-type"><b>: </b><span>A</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span><span class="kr">∃</span> <span class="nv">k</span> : nat, k &lt; <span class="mi">0</span> ∧ Str_nth k l = a</span></span></span><br></div><label class="goal-separator" for="StreamExtras-v-chkad"><hr></label><div class="goal-conclusion">a ∈ []</div></blockquote><input class="alectryon-extra-goal-toggle" id="StreamExtras-v-chkae" style="display: none" type="checkbox"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>A</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>n</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>IHn</var><span class="hyp-type"><b>: </b><span><span class="kr">∀</span> (<span class="nv">l</span> : Stream A) (<span class="nv">a</span> : A),
a ∈ stream_prefix l n ↔ (<span class="kr">∃</span> <span class="nv">k</span> : nat, k &lt; n ∧ Str_nth k l = a)</span></span></span><br><span><var>l</var><span class="hyp-type"><b>: </b><span>Stream A</span></span></span><br><span><var>a</var><span class="hyp-type"><b>: </b><span>A</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>a
∈ <span class="kr">match</span> l <span class="kr">with</span>
  | Cons a l =&gt; a :: stream_prefix l n
  <span class="kr">end</span></span></span></span><br></div><label class="goal-separator" for="StreamExtras-v-chkae"><hr></label><div class="goal-conclusion"><span class="kr">∃</span> <span class="nv">k</span> : nat, k &lt; S n ∧ Str_nth k l = a</div></blockquote><input class="alectryon-extra-goal-toggle" id="StreamExtras-v-chkaf" style="display: none" type="checkbox"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>A</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>n</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>IHn</var><span class="hyp-type"><b>: </b><span><span class="kr">∀</span> (<span class="nv">l</span> : Stream A) (<span class="nv">a</span> : A),
a ∈ stream_prefix l n ↔ (<span class="kr">∃</span> <span class="nv">k</span> : nat, k &lt; n ∧ Str_nth k l = a)</span></span></span><br><span><var>l</var><span class="hyp-type"><b>: </b><span>Stream A</span></span></span><br><span><var>a</var><span class="hyp-type"><b>: </b><span>A</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span><span class="kr">∃</span> <span class="nv">k</span> : nat, k &lt; S n ∧ Str_nth k l = a</span></span></span><br></div><label class="goal-separator" for="StreamExtras-v-chkaf"><hr></label><div class="goal-conclusion">a
∈ <span class="kr">match</span> l <span class="kr">with</span>
  | Cons a l =&gt; a :: stream_prefix l n
  <span class="kr">end</span></div></blockquote></div></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="StreamExtras-v-chkb0" style="display: none" type="checkbox"><label class="alectryon-input" for="StreamExtras-v-chkb0">-</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>A</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>l</var><span class="hyp-type"><b>: </b><span>Stream A</span></span></span><br><span><var>a</var><span class="hyp-type"><b>: </b><span>A</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>a ∈ []</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="kr">∃</span> <span class="nv">k</span> : nat, k &lt; <span class="mi">0</span> ∧ Str_nth k l = a</div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="nb">inversion</span> H.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="StreamExtras-v-chkb1" style="display: none" type="checkbox"><label class="alectryon-input" for="StreamExtras-v-chkb1">-</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>A</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>l</var><span class="hyp-type"><b>: </b><span>Stream A</span></span></span><br><span><var>a</var><span class="hyp-type"><b>: </b><span>A</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span><span class="kr">∃</span> <span class="nv">k</span> : nat, k &lt; <span class="mi">0</span> ∧ Str_nth k l = a</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">a ∈ []</div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="StreamExtras-v-chkb2" style="display: none" type="checkbox"><label class="alectryon-input" for="StreamExtras-v-chkb2"><span class="nb">destruct</span> H <span class="kr">as</span> [k [Hk _]].</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>A</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>l</var><span class="hyp-type"><b>: </b><span>Stream A</span></span></span><br><span><var>a</var><span class="hyp-type"><b>: </b><span>A</span></span></span><br><span><var>k</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>Hk</var><span class="hyp-type"><b>: </b><span>k &lt; <span class="mi">0</span></span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">a ∈ []</div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="bp">lia</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="StreamExtras-v-chkb3" style="display: none" type="checkbox"><label class="alectryon-input" for="StreamExtras-v-chkb3">-</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>A</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>n</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>IHn</var><span class="hyp-type"><b>: </b><span><span class="kr">∀</span> (<span class="nv">l</span> : Stream A) (<span class="nv">a</span> : A),
a ∈ stream_prefix l n ↔ (<span class="kr">∃</span> <span class="nv">k</span> : nat, k &lt; n ∧ Str_nth k l = a)</span></span></span><br><span><var>l</var><span class="hyp-type"><b>: </b><span>Stream A</span></span></span><br><span><var>a</var><span class="hyp-type"><b>: </b><span>A</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>a
∈ <span class="kr">match</span> l <span class="kr">with</span>
  | Cons a l =&gt; a :: stream_prefix l n
  <span class="kr">end</span></span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="kr">∃</span> <span class="nv">k</span> : nat, k &lt; S n ∧ Str_nth k l = a</div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="StreamExtras-v-chkb4" style="display: none" type="checkbox"><label class="alectryon-input" for="StreamExtras-v-chkb4"><span class="nb">destruct</span> l <span class="kr">as</span> (b, l).</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>A</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>n</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>IHn</var><span class="hyp-type"><b>: </b><span><span class="kr">∀</span> (<span class="nv">l</span> : Stream A) (<span class="nv">a</span> : A),
a ∈ stream_prefix l n ↔ (<span class="kr">∃</span> <span class="nv">k</span> : nat, k &lt; n ∧ Str_nth k l = a)</span></span></span><br><span><var>b</var><span class="hyp-type"><b>: </b><span>A</span></span></span><br><span><var>l</var><span class="hyp-type"><b>: </b><span>Stream A</span></span></span><br><span><var>a</var><span class="hyp-type"><b>: </b><span>A</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>a ∈ b :: stream_prefix l n</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="kr">∃</span> <span class="nv">k</span> : nat, k &lt; S n ∧ Str_nth k (Cons b l) = a</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="StreamExtras-v-chkb5" style="display: none" type="checkbox"><label class="alectryon-input" for="StreamExtras-v-chkb5"><span class="nb">inversion</span> H; <span class="nb">subst</span>.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>A</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>n</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>IHn</var><span class="hyp-type"><b>: </b><span><span class="kr">∀</span> (<span class="nv">l</span> : Stream A) (<span class="nv">a</span> : A),
a ∈ stream_prefix l n ↔ (<span class="kr">∃</span> <span class="nv">k</span> : nat, k &lt; n ∧ Str_nth k l = a)</span></span></span><br><span><var>b</var><span class="hyp-type"><b>: </b><span>A</span></span></span><br><span><var>l</var><span class="hyp-type"><b>: </b><span>Stream A</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>b ∈ b :: stream_prefix l n</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="kr">∃</span> <span class="nv">k</span> : nat, k &lt; S n ∧ Str_nth k (Cons b l) = b</div></blockquote><div class="alectryon-extra-goals"><input class="alectryon-extra-goal-toggle" id="StreamExtras-v-chkb6" style="display: none" type="checkbox"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>A</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>n</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>IHn</var><span class="hyp-type"><b>: </b><span><span class="kr">∀</span> (<span class="nv">l</span> : Stream A) (<span class="nv">a</span> : A),
a ∈ stream_prefix l n ↔ (<span class="kr">∃</span> <span class="nv">k</span> : nat, k &lt; n ∧ Str_nth k l = a)</span></span></span><br><span><var>b</var><span class="hyp-type"><b>: </b><span>A</span></span></span><br><span><var>l</var><span class="hyp-type"><b>: </b><span>Stream A</span></span></span><br><span><var>a</var><span class="hyp-type"><b>: </b><span>A</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>a ∈ b :: stream_prefix l n</span></span></span><br><span><var>H2</var><span class="hyp-type"><b>: </b><span>a ∈ stream_prefix l n</span></span></span><br></div><label class="goal-separator" for="StreamExtras-v-chkb6"><hr></label><div class="goal-conclusion"><span class="kr">∃</span> <span class="nv">k</span> : nat, k &lt; S n ∧ Str_nth k (Cons b l) = a</div></blockquote></div></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="StreamExtras-v-chkb7" style="display: none" type="checkbox"><label class="alectryon-input" for="StreamExtras-v-chkb7">+</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>A</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>n</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>IHn</var><span class="hyp-type"><b>: </b><span><span class="kr">∀</span> (<span class="nv">l</span> : Stream A) (<span class="nv">a</span> : A),
a ∈ stream_prefix l n ↔ (<span class="kr">∃</span> <span class="nv">k</span> : nat, k &lt; n ∧ Str_nth k l = a)</span></span></span><br><span><var>b</var><span class="hyp-type"><b>: </b><span>A</span></span></span><br><span><var>l</var><span class="hyp-type"><b>: </b><span>Stream A</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>b ∈ b :: stream_prefix l n</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="kr">∃</span> <span class="nv">k</span> : nat, k &lt; S n ∧ Str_nth k (Cons b l) = b</div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="StreamExtras-v-chkb8" style="display: none" type="checkbox"><label class="alectryon-input" for="StreamExtras-v-chkb8"><span class="kr">exists</span> <span class="mi">0</span>.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>A</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>n</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>IHn</var><span class="hyp-type"><b>: </b><span><span class="kr">∀</span> (<span class="nv">l</span> : Stream A) (<span class="nv">a</span> : A),
a ∈ stream_prefix l n ↔ (<span class="kr">∃</span> <span class="nv">k</span> : nat, k &lt; n ∧ Str_nth k l = a)</span></span></span><br><span><var>b</var><span class="hyp-type"><b>: </b><span>A</span></span></span><br><span><var>l</var><span class="hyp-type"><b>: </b><span>Stream A</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>b ∈ b :: stream_prefix l n</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="mi">0</span> &lt; S n ∧ Str_nth <span class="mi">0</span> (Cons b l) = b</div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="StreamExtras-v-chkb9" style="display: none" type="checkbox"><label class="alectryon-input" for="StreamExtras-v-chkb9"><span class="nb">split</span>; <span class="kp">try</span> <span class="bp">reflexivity</span>.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>A</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>n</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>IHn</var><span class="hyp-type"><b>: </b><span><span class="kr">∀</span> (<span class="nv">l</span> : Stream A) (<span class="nv">a</span> : A),
a ∈ stream_prefix l n ↔ (<span class="kr">∃</span> <span class="nv">k</span> : nat, k &lt; n ∧ Str_nth k l = a)</span></span></span><br><span><var>b</var><span class="hyp-type"><b>: </b><span>A</span></span></span><br><span><var>l</var><span class="hyp-type"><b>: </b><span>Stream A</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>b ∈ b :: stream_prefix l n</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="mi">0</span> &lt; S n</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">      </span><span class="alectryon-sentence"><span class="alectryon-input"><span class="bp">lia</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="StreamExtras-v-chkba" style="display: none" type="checkbox"><label class="alectryon-input" for="StreamExtras-v-chkba">+</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>A</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>n</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>IHn</var><span class="hyp-type"><b>: </b><span><span class="kr">∀</span> (<span class="nv">l</span> : Stream A) (<span class="nv">a</span> : A),
a ∈ stream_prefix l n ↔ (<span class="kr">∃</span> <span class="nv">k</span> : nat, k &lt; n ∧ Str_nth k l = a)</span></span></span><br><span><var>b</var><span class="hyp-type"><b>: </b><span>A</span></span></span><br><span><var>l</var><span class="hyp-type"><b>: </b><span>Stream A</span></span></span><br><span><var>a</var><span class="hyp-type"><b>: </b><span>A</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>a ∈ b :: stream_prefix l n</span></span></span><br><span><var>H2</var><span class="hyp-type"><b>: </b><span>a ∈ stream_prefix l n</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="kr">∃</span> <span class="nv">k</span> : nat, k &lt; S n ∧ Str_nth k (Cons b l) = a</div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="StreamExtras-v-chkbb" style="display: none" type="checkbox"><label class="alectryon-input" for="StreamExtras-v-chkbb"><span class="nb">apply</span> IHn <span class="kr">in</span> H2 <span class="kr">as</span> [k [Hlt Heq]].</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>A</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>n</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>IHn</var><span class="hyp-type"><b>: </b><span><span class="kr">∀</span> (<span class="nv">l</span> : Stream A) (<span class="nv">a</span> : A),
a ∈ stream_prefix l n ↔ (<span class="kr">∃</span> <span class="nv">k</span> : nat, k &lt; n ∧ Str_nth k l = a)</span></span></span><br><span><var>b</var><span class="hyp-type"><b>: </b><span>A</span></span></span><br><span><var>l</var><span class="hyp-type"><b>: </b><span>Stream A</span></span></span><br><span><var>a</var><span class="hyp-type"><b>: </b><span>A</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>a ∈ b :: stream_prefix l n</span></span></span><br><span><var>k</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>Hlt</var><span class="hyp-type"><b>: </b><span>k &lt; n</span></span></span><br><span><var>Heq</var><span class="hyp-type"><b>: </b><span>Str_nth k l = a</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="kr">∃</span> <span class="nv">k</span> : nat, k &lt; S n ∧ Str_nth k (Cons b l) = a</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">      </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="StreamExtras-v-chkbc" style="display: none" type="checkbox"><label class="alectryon-input" for="StreamExtras-v-chkbc"><span class="kr">exists</span> (<span class="nv">S</span> <span class="nv">k</span>).</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>A</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>n</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>IHn</var><span class="hyp-type"><b>: </b><span><span class="kr">∀</span> (<span class="nv">l</span> : Stream A) (<span class="nv">a</span> : A),
a ∈ stream_prefix l n ↔ (<span class="kr">∃</span> <span class="nv">k</span> : nat, k &lt; n ∧ Str_nth k l = a)</span></span></span><br><span><var>b</var><span class="hyp-type"><b>: </b><span>A</span></span></span><br><span><var>l</var><span class="hyp-type"><b>: </b><span>Stream A</span></span></span><br><span><var>a</var><span class="hyp-type"><b>: </b><span>A</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>a ∈ b :: stream_prefix l n</span></span></span><br><span><var>k</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>Hlt</var><span class="hyp-type"><b>: </b><span>k &lt; n</span></span></span><br><span><var>Heq</var><span class="hyp-type"><b>: </b><span>Str_nth k l = a</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">S k &lt; S n ∧ Str_nth (S k) (Cons b l) = a</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">      </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="StreamExtras-v-chkbd" style="display: none" type="checkbox"><label class="alectryon-input" for="StreamExtras-v-chkbd"><span class="nb">split</span>; <span class="kp">try</span> <span class="bp">assumption</span>.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>A</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>n</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>IHn</var><span class="hyp-type"><b>: </b><span><span class="kr">∀</span> (<span class="nv">l</span> : Stream A) (<span class="nv">a</span> : A),
a ∈ stream_prefix l n ↔ (<span class="kr">∃</span> <span class="nv">k</span> : nat, k &lt; n ∧ Str_nth k l = a)</span></span></span><br><span><var>b</var><span class="hyp-type"><b>: </b><span>A</span></span></span><br><span><var>l</var><span class="hyp-type"><b>: </b><span>Stream A</span></span></span><br><span><var>a</var><span class="hyp-type"><b>: </b><span>A</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>a ∈ b :: stream_prefix l n</span></span></span><br><span><var>k</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>Hlt</var><span class="hyp-type"><b>: </b><span>k &lt; n</span></span></span><br><span><var>Heq</var><span class="hyp-type"><b>: </b><span>Str_nth k l = a</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">S k &lt; S n</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">      </span><span class="alectryon-sentence"><span class="alectryon-input"><span class="bp">lia</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="StreamExtras-v-chkbe" style="display: none" type="checkbox"><label class="alectryon-input" for="StreamExtras-v-chkbe">-</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>A</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>n</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>IHn</var><span class="hyp-type"><b>: </b><span><span class="kr">∀</span> (<span class="nv">l</span> : Stream A) (<span class="nv">a</span> : A),
a ∈ stream_prefix l n ↔ (<span class="kr">∃</span> <span class="nv">k</span> : nat, k &lt; n ∧ Str_nth k l = a)</span></span></span><br><span><var>l</var><span class="hyp-type"><b>: </b><span>Stream A</span></span></span><br><span><var>a</var><span class="hyp-type"><b>: </b><span>A</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span><span class="kr">∃</span> <span class="nv">k</span> : nat, k &lt; S n ∧ Str_nth k l = a</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">a
∈ <span class="kr">match</span> l <span class="kr">with</span>
  | Cons a l =&gt; a :: stream_prefix l n
  <span class="kr">end</span></div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="StreamExtras-v-chkbf" style="display: none" type="checkbox"><label class="alectryon-input" for="StreamExtras-v-chkbf"><span class="nb">destruct</span> l <span class="kr">as</span> (b, l).</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>A</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>n</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>IHn</var><span class="hyp-type"><b>: </b><span><span class="kr">∀</span> (<span class="nv">l</span> : Stream A) (<span class="nv">a</span> : A),
a ∈ stream_prefix l n ↔ (<span class="kr">∃</span> <span class="nv">k</span> : nat, k &lt; n ∧ Str_nth k l = a)</span></span></span><br><span><var>b</var><span class="hyp-type"><b>: </b><span>A</span></span></span><br><span><var>l</var><span class="hyp-type"><b>: </b><span>Stream A</span></span></span><br><span><var>a</var><span class="hyp-type"><b>: </b><span>A</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span><span class="kr">∃</span> <span class="nv">k</span> : nat, k &lt; S n ∧ Str_nth k (Cons b l) = a</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">a ∈ b :: stream_prefix l n</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="StreamExtras-v-chkc0" style="display: none" type="checkbox"><label class="alectryon-input" for="StreamExtras-v-chkc0"><span class="nb">destruct</span> H <span class="kr">as</span> [k [Hlt Heq]].</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>A</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>n</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>IHn</var><span class="hyp-type"><b>: </b><span><span class="kr">∀</span> (<span class="nv">l</span> : Stream A) (<span class="nv">a</span> : A),
a ∈ stream_prefix l n ↔ (<span class="kr">∃</span> <span class="nv">k</span> : nat, k &lt; n ∧ Str_nth k l = a)</span></span></span><br><span><var>b</var><span class="hyp-type"><b>: </b><span>A</span></span></span><br><span><var>l</var><span class="hyp-type"><b>: </b><span>Stream A</span></span></span><br><span><var>a</var><span class="hyp-type"><b>: </b><span>A</span></span></span><br><span><var>k</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>Hlt</var><span class="hyp-type"><b>: </b><span>k &lt; S n</span></span></span><br><span><var>Heq</var><span class="hyp-type"><b>: </b><span>Str_nth k (Cons b l) = a</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">a ∈ b :: stream_prefix l n</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="StreamExtras-v-chkc1" style="display: none" type="checkbox"><label class="alectryon-input" for="StreamExtras-v-chkc1"><span class="nb">destruct</span> k.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>A</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>n</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>IHn</var><span class="hyp-type"><b>: </b><span><span class="kr">∀</span> (<span class="nv">l</span> : Stream A) (<span class="nv">a</span> : A),
a ∈ stream_prefix l n ↔ (<span class="kr">∃</span> <span class="nv">k</span> : nat, k &lt; n ∧ Str_nth k l = a)</span></span></span><br><span><var>b</var><span class="hyp-type"><b>: </b><span>A</span></span></span><br><span><var>l</var><span class="hyp-type"><b>: </b><span>Stream A</span></span></span><br><span><var>a</var><span class="hyp-type"><b>: </b><span>A</span></span></span><br><span><var>Hlt</var><span class="hyp-type"><b>: </b><span><span class="mi">0</span> &lt; S n</span></span></span><br><span><var>Heq</var><span class="hyp-type"><b>: </b><span>Str_nth <span class="mi">0</span> (Cons b l) = a</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">a ∈ b :: stream_prefix l n</div></blockquote><div class="alectryon-extra-goals"><input class="alectryon-extra-goal-toggle" id="StreamExtras-v-chkc2" style="display: none" type="checkbox"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>A</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>n</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>IHn</var><span class="hyp-type"><b>: </b><span><span class="kr">∀</span> (<span class="nv">l</span> : Stream A) (<span class="nv">a</span> : A),
a ∈ stream_prefix l n ↔ (<span class="kr">∃</span> <span class="nv">k</span> : nat, k &lt; n ∧ Str_nth k l = a)</span></span></span><br><span><var>b</var><span class="hyp-type"><b>: </b><span>A</span></span></span><br><span><var>l</var><span class="hyp-type"><b>: </b><span>Stream A</span></span></span><br><span><var>a</var><span class="hyp-type"><b>: </b><span>A</span></span></span><br><span><var>k</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>Hlt</var><span class="hyp-type"><b>: </b><span>S k &lt; S n</span></span></span><br><span><var>Heq</var><span class="hyp-type"><b>: </b><span>Str_nth (S k) (Cons b l) = a</span></span></span><br></div><label class="goal-separator" for="StreamExtras-v-chkc2"><hr></label><div class="goal-conclusion">a ∈ b :: stream_prefix l n</div></blockquote></div></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="StreamExtras-v-chkc3" style="display: none" type="checkbox"><label class="alectryon-input" for="StreamExtras-v-chkc3">+</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>A</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>n</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>IHn</var><span class="hyp-type"><b>: </b><span><span class="kr">∀</span> (<span class="nv">l</span> : Stream A) (<span class="nv">a</span> : A),
a ∈ stream_prefix l n ↔ (<span class="kr">∃</span> <span class="nv">k</span> : nat, k &lt; n ∧ Str_nth k l = a)</span></span></span><br><span><var>b</var><span class="hyp-type"><b>: </b><span>A</span></span></span><br><span><var>l</var><span class="hyp-type"><b>: </b><span>Stream A</span></span></span><br><span><var>a</var><span class="hyp-type"><b>: </b><span>A</span></span></span><br><span><var>Hlt</var><span class="hyp-type"><b>: </b><span><span class="mi">0</span> &lt; S n</span></span></span><br><span><var>Heq</var><span class="hyp-type"><b>: </b><span>Str_nth <span class="mi">0</span> (Cons b l) = a</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">a ∈ b :: stream_prefix l n</div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="StreamExtras-v-chkc4" style="display: none" type="checkbox"><label class="alectryon-input" for="StreamExtras-v-chkc4"><span class="nb">unfold</span> Str_nth <span class="kr">in</span> Heq.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>A</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>n</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>IHn</var><span class="hyp-type"><b>: </b><span><span class="kr">∀</span> (<span class="nv">l</span> : Stream A) (<span class="nv">a</span> : A),
a ∈ stream_prefix l n ↔ (<span class="kr">∃</span> <span class="nv">k</span> : nat, k &lt; n ∧ Str_nth k l = a)</span></span></span><br><span><var>b</var><span class="hyp-type"><b>: </b><span>A</span></span></span><br><span><var>l</var><span class="hyp-type"><b>: </b><span>Stream A</span></span></span><br><span><var>a</var><span class="hyp-type"><b>: </b><span>A</span></span></span><br><span><var>Hlt</var><span class="hyp-type"><b>: </b><span><span class="mi">0</span> &lt; S n</span></span></span><br><span><var>Heq</var><span class="hyp-type"><b>: </b><span>hd (Str_nth_tl <span class="mi">0</span> (Cons b l)) = a</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">a ∈ b :: stream_prefix l n</div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="StreamExtras-v-chkc5" style="display: none" type="checkbox"><label class="alectryon-input" for="StreamExtras-v-chkc5"><span class="nb">simpl</span> <span class="kr">in</span> Heq.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>A</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>n</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>IHn</var><span class="hyp-type"><b>: </b><span><span class="kr">∀</span> (<span class="nv">l</span> : Stream A) (<span class="nv">a</span> : A),
a ∈ stream_prefix l n ↔ (<span class="kr">∃</span> <span class="nv">k</span> : nat, k &lt; n ∧ Str_nth k l = a)</span></span></span><br><span><var>b</var><span class="hyp-type"><b>: </b><span>A</span></span></span><br><span><var>l</var><span class="hyp-type"><b>: </b><span>Stream A</span></span></span><br><span><var>a</var><span class="hyp-type"><b>: </b><span>A</span></span></span><br><span><var>Hlt</var><span class="hyp-type"><b>: </b><span><span class="mi">0</span> &lt; S n</span></span></span><br><span><var>Heq</var><span class="hyp-type"><b>: </b><span>b = a</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">a ∈ b :: stream_prefix l n</div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="StreamExtras-v-chkc6" style="display: none" type="checkbox"><label class="alectryon-input" for="StreamExtras-v-chkc6"><span class="nb">subst</span>.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>A</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>n</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>IHn</var><span class="hyp-type"><b>: </b><span><span class="kr">∀</span> (<span class="nv">l</span> : Stream A) (<span class="nv">a</span> : A),
a ∈ stream_prefix l n ↔ (<span class="kr">∃</span> <span class="nv">k</span> : nat, k &lt; n ∧ Str_nth k l = a)</span></span></span><br><span><var>l</var><span class="hyp-type"><b>: </b><span>Stream A</span></span></span><br><span><var>a</var><span class="hyp-type"><b>: </b><span>A</span></span></span><br><span><var>Hlt</var><span class="hyp-type"><b>: </b><span><span class="mi">0</span> &lt; S n</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">a ∈ a :: stream_prefix l n</div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="nb">left</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="StreamExtras-v-chkc7" style="display: none" type="checkbox"><label class="alectryon-input" for="StreamExtras-v-chkc7">+</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>A</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>n</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>IHn</var><span class="hyp-type"><b>: </b><span><span class="kr">∀</span> (<span class="nv">l</span> : Stream A) (<span class="nv">a</span> : A),
a ∈ stream_prefix l n ↔ (<span class="kr">∃</span> <span class="nv">k</span> : nat, k &lt; n ∧ Str_nth k l = a)</span></span></span><br><span><var>b</var><span class="hyp-type"><b>: </b><span>A</span></span></span><br><span><var>l</var><span class="hyp-type"><b>: </b><span>Stream A</span></span></span><br><span><var>a</var><span class="hyp-type"><b>: </b><span>A</span></span></span><br><span><var>k</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>Hlt</var><span class="hyp-type"><b>: </b><span>S k &lt; S n</span></span></span><br><span><var>Heq</var><span class="hyp-type"><b>: </b><span>Str_nth (S k) (Cons b l) = a</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">a ∈ b :: stream_prefix l n</div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="StreamExtras-v-chkc8" style="display: none" type="checkbox"><label class="alectryon-input" for="StreamExtras-v-chkc8"><span class="nb">unfold</span> Str_nth <span class="kr">in</span> *.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>A</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>n</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>IHn</var><span class="hyp-type"><b>: </b><span><span class="kr">∀</span> (<span class="nv">l</span> : Stream A) (<span class="nv">a</span> : A),
a ∈ stream_prefix l n ↔ (<span class="kr">∃</span> <span class="nv">k</span> : nat, k &lt; n ∧ hd (Str_nth_tl k l) = a)</span></span></span><br><span><var>b</var><span class="hyp-type"><b>: </b><span>A</span></span></span><br><span><var>l</var><span class="hyp-type"><b>: </b><span>Stream A</span></span></span><br><span><var>a</var><span class="hyp-type"><b>: </b><span>A</span></span></span><br><span><var>k</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>Hlt</var><span class="hyp-type"><b>: </b><span>S k &lt; S n</span></span></span><br><span><var>Heq</var><span class="hyp-type"><b>: </b><span>hd (Str_nth_tl (S k) (Cons b l)) = a</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">a ∈ b :: stream_prefix l n</div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="StreamExtras-v-chkc9" style="display: none" type="checkbox"><label class="alectryon-input" for="StreamExtras-v-chkc9"><span class="nb">simpl</span> <span class="kr">in</span> Heq.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>A</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>n</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>IHn</var><span class="hyp-type"><b>: </b><span><span class="kr">∀</span> (<span class="nv">l</span> : Stream A) (<span class="nv">a</span> : A),
a ∈ stream_prefix l n ↔ (<span class="kr">∃</span> <span class="nv">k</span> : nat, k &lt; n ∧ hd (Str_nth_tl k l) = a)</span></span></span><br><span><var>b</var><span class="hyp-type"><b>: </b><span>A</span></span></span><br><span><var>l</var><span class="hyp-type"><b>: </b><span>Stream A</span></span></span><br><span><var>a</var><span class="hyp-type"><b>: </b><span>A</span></span></span><br><span><var>k</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>Hlt</var><span class="hyp-type"><b>: </b><span>S k &lt; S n</span></span></span><br><span><var>Heq</var><span class="hyp-type"><b>: </b><span>hd (Str_nth_tl k l) = a</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">a ∈ b :: stream_prefix l n</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">      </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="StreamExtras-v-chkca" style="display: none" type="checkbox"><label class="alectryon-input" for="StreamExtras-v-chkca"><span class="nb">right</span>.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>A</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>n</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>IHn</var><span class="hyp-type"><b>: </b><span><span class="kr">∀</span> (<span class="nv">l</span> : Stream A) (<span class="nv">a</span> : A),
a ∈ stream_prefix l n ↔ (<span class="kr">∃</span> <span class="nv">k</span> : nat, k &lt; n ∧ hd (Str_nth_tl k l) = a)</span></span></span><br><span><var>b</var><span class="hyp-type"><b>: </b><span>A</span></span></span><br><span><var>l</var><span class="hyp-type"><b>: </b><span>Stream A</span></span></span><br><span><var>a</var><span class="hyp-type"><b>: </b><span>A</span></span></span><br><span><var>k</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>Hlt</var><span class="hyp-type"><b>: </b><span>S k &lt; S n</span></span></span><br><span><var>Heq</var><span class="hyp-type"><b>: </b><span>hd (Str_nth_tl k l) = a</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">a ∈ stream_prefix l n</div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="StreamExtras-v-chkcb" style="display: none" type="checkbox"><label class="alectryon-input" for="StreamExtras-v-chkcb"><span class="nb">apply</span> IHn.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>A</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>n</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>IHn</var><span class="hyp-type"><b>: </b><span><span class="kr">∀</span> (<span class="nv">l</span> : Stream A) (<span class="nv">a</span> : A),
a ∈ stream_prefix l n ↔ (<span class="kr">∃</span> <span class="nv">k</span> : nat, k &lt; n ∧ hd (Str_nth_tl k l) = a)</span></span></span><br><span><var>b</var><span class="hyp-type"><b>: </b><span>A</span></span></span><br><span><var>l</var><span class="hyp-type"><b>: </b><span>Stream A</span></span></span><br><span><var>a</var><span class="hyp-type"><b>: </b><span>A</span></span></span><br><span><var>k</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>Hlt</var><span class="hyp-type"><b>: </b><span>S k &lt; S n</span></span></span><br><span><var>Heq</var><span class="hyp-type"><b>: </b><span>hd (Str_nth_tl k l) = a</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="kr">∃</span> <span class="nv">k</span> : nat, k &lt; n ∧ hd (Str_nth_tl k l) = a</div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="StreamExtras-v-chkcc" style="display: none" type="checkbox"><label class="alectryon-input" for="StreamExtras-v-chkcc"><span class="kr">exists</span> <span class="nv">k</span>.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>A</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>n</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>IHn</var><span class="hyp-type"><b>: </b><span><span class="kr">∀</span> (<span class="nv">l</span> : Stream A) (<span class="nv">a</span> : A),
a ∈ stream_prefix l n ↔ (<span class="kr">∃</span> <span class="nv">k</span> : nat, k &lt; n ∧ hd (Str_nth_tl k l) = a)</span></span></span><br><span><var>b</var><span class="hyp-type"><b>: </b><span>A</span></span></span><br><span><var>l</var><span class="hyp-type"><b>: </b><span>Stream A</span></span></span><br><span><var>a</var><span class="hyp-type"><b>: </b><span>A</span></span></span><br><span><var>k</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>Hlt</var><span class="hyp-type"><b>: </b><span>S k &lt; S n</span></span></span><br><span><var>Heq</var><span class="hyp-type"><b>: </b><span>hd (Str_nth_tl k l) = a</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">k &lt; n ∧ hd (Str_nth_tl k l) = a</div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="nb">split</span>; [<span class="bp">lia</span>|<span class="bp">assumption</span>].</span><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Qed</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
</span><span class="alectryon-sentence"><input class="alectryon-toggle" id="StreamExtras-v-chkcd" style="display: none" type="checkbox"><label class="alectryon-input" for="StreamExtras-v-chkcd"><span class="kn">Lemma</span> <span class="nf">stream_prefix_app_l</span>
  {<span class="nv">A</span> : <span class="kt">Type</span>}
  (<span class="nv">l</span> : list A)
  (<span class="nv">s</span> : Stream A)
  (<span class="nv">n</span> : nat)
  (<span class="nv">Hle</span> : n &lt;= length l)
  : stream_prefix (stream_app l s) n = list_prefix l n.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>A</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>l</var><span class="hyp-type"><b>: </b><span>list A</span></span></span><br><span><var>s</var><span class="hyp-type"><b>: </b><span>Stream A</span></span></span><br><span><var>n</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>Hle</var><span class="hyp-type"><b>: </b><span>n ≤ length l</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">stream_prefix (stream_app l s) n = list_prefix l n</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="StreamExtras-v-chkce" style="display: none" type="checkbox"><label class="alectryon-input" for="StreamExtras-v-chkce"><span class="kn">Proof</span>.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>A</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>l</var><span class="hyp-type"><b>: </b><span>list A</span></span></span><br><span><var>s</var><span class="hyp-type"><b>: </b><span>Stream A</span></span></span><br><span><var>n</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>Hle</var><span class="hyp-type"><b>: </b><span>n ≤ length l</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">stream_prefix (stream_app l s) n = list_prefix l n</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="StreamExtras-v-chkcf" style="display: none" type="checkbox"><label class="alectryon-input" for="StreamExtras-v-chkcf"><span class="nb">generalize dependent</span> n.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>A</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>l</var><span class="hyp-type"><b>: </b><span>list A</span></span></span><br><span><var>s</var><span class="hyp-type"><b>: </b><span>Stream A</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="kr">∀</span> <span class="nv">n</span> : nat,
  n ≤ length l
  → stream_prefix (stream_app l s) n = list_prefix l n</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="StreamExtras-v-chkd0" style="display: none" type="checkbox"><label class="alectryon-input" for="StreamExtras-v-chkd0"><span class="nb">induction</span> l; <span class="nb">intros</span> [|n] Hle; <span class="kp">try</span> <span class="bp">reflexivity</span>.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>A</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>s</var><span class="hyp-type"><b>: </b><span>Stream A</span></span></span><br><span><var>n</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>Hle</var><span class="hyp-type"><b>: </b><span>S n ≤ length []</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">stream_prefix (stream_app [] s) (S n) =
list_prefix [] (S n)</div></blockquote><div class="alectryon-extra-goals"><input class="alectryon-extra-goal-toggle" id="StreamExtras-v-chkd1" style="display: none" type="checkbox"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>A</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>a</var><span class="hyp-type"><b>: </b><span>A</span></span></span><br><span><var>l</var><span class="hyp-type"><b>: </b><span>list A</span></span></span><br><span><var>s</var><span class="hyp-type"><b>: </b><span>Stream A</span></span></span><br><span><var>IHl</var><span class="hyp-type"><b>: </b><span><span class="kr">∀</span> <span class="nv">n</span> : nat, n ≤ length l → stream_prefix (stream_app l s) n = list_prefix l n</span></span></span><br><span><var>n</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>Hle</var><span class="hyp-type"><b>: </b><span>S n ≤ length (a :: l)</span></span></span><br></div><label class="goal-separator" for="StreamExtras-v-chkd1"><hr></label><div class="goal-conclusion">stream_prefix (stream_app (a :: l) s) (S n) =
list_prefix (a :: l) (S n)</div></blockquote></div></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="StreamExtras-v-chkd2" style="display: none" type="checkbox"><label class="alectryon-input" for="StreamExtras-v-chkd2">-</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>A</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>s</var><span class="hyp-type"><b>: </b><span>Stream A</span></span></span><br><span><var>n</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>Hle</var><span class="hyp-type"><b>: </b><span>S n ≤ length []</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">stream_prefix (stream_app [] s) (S n) =
list_prefix [] (S n)</div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="nb">inversion</span> Hle.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="StreamExtras-v-chkd3" style="display: none" type="checkbox"><label class="alectryon-input" for="StreamExtras-v-chkd3">-</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>A</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>a</var><span class="hyp-type"><b>: </b><span>A</span></span></span><br><span><var>l</var><span class="hyp-type"><b>: </b><span>list A</span></span></span><br><span><var>s</var><span class="hyp-type"><b>: </b><span>Stream A</span></span></span><br><span><var>IHl</var><span class="hyp-type"><b>: </b><span><span class="kr">∀</span> <span class="nv">n</span> : nat, n ≤ length l → stream_prefix (stream_app l s) n = list_prefix l n</span></span></span><br><span><var>n</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>Hle</var><span class="hyp-type"><b>: </b><span>S n ≤ length (a :: l)</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">stream_prefix (stream_app (a :: l) s) (S n) =
list_prefix (a :: l) (S n)</div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="StreamExtras-v-chkd4" style="display: none" type="checkbox"><label class="alectryon-input" for="StreamExtras-v-chkd4"><span class="nb">simpl</span> <span class="kr">in</span> Hle.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>A</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>a</var><span class="hyp-type"><b>: </b><span>A</span></span></span><br><span><var>l</var><span class="hyp-type"><b>: </b><span>list A</span></span></span><br><span><var>s</var><span class="hyp-type"><b>: </b><span>Stream A</span></span></span><br><span><var>IHl</var><span class="hyp-type"><b>: </b><span><span class="kr">∀</span> <span class="nv">n</span> : nat, n ≤ length l → stream_prefix (stream_app l s) n = list_prefix l n</span></span></span><br><span><var>n</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>Hle</var><span class="hyp-type"><b>: </b><span>S n ≤ S (length l)</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">stream_prefix (stream_app (a :: l) s) (S n) =
list_prefix (a :: l) (S n)</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="StreamExtras-v-chkd5" style="display: none" type="checkbox"><label class="alectryon-input" for="StreamExtras-v-chkd5"><span class="nb">simpl</span>.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>A</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>a</var><span class="hyp-type"><b>: </b><span>A</span></span></span><br><span><var>l</var><span class="hyp-type"><b>: </b><span>list A</span></span></span><br><span><var>s</var><span class="hyp-type"><b>: </b><span>Stream A</span></span></span><br><span><var>IHl</var><span class="hyp-type"><b>: </b><span><span class="kr">∀</span> <span class="nv">n</span> : nat, n ≤ length l → stream_prefix (stream_app l s) n = list_prefix l n</span></span></span><br><span><var>n</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>Hle</var><span class="hyp-type"><b>: </b><span>S n ≤ S (length l)</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">a :: stream_prefix (stream_app l s) n =
a :: list_prefix l n</div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="StreamExtras-v-chkd6" style="display: none" type="checkbox"><label class="alectryon-input" for="StreamExtras-v-chkd6"><span class="nb">f_equal</span>.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>A</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>a</var><span class="hyp-type"><b>: </b><span>A</span></span></span><br><span><var>l</var><span class="hyp-type"><b>: </b><span>list A</span></span></span><br><span><var>s</var><span class="hyp-type"><b>: </b><span>Stream A</span></span></span><br><span><var>IHl</var><span class="hyp-type"><b>: </b><span><span class="kr">∀</span> <span class="nv">n</span> : nat, n ≤ length l → stream_prefix (stream_app l s) n = list_prefix l n</span></span></span><br><span><var>n</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>Hle</var><span class="hyp-type"><b>: </b><span>S n ≤ S (length l)</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">stream_prefix (stream_app l s) n = list_prefix l n</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="StreamExtras-v-chkd7" style="display: none" type="checkbox"><label class="alectryon-input" for="StreamExtras-v-chkd7"><span class="nb">apply</span> IHl.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>A</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>a</var><span class="hyp-type"><b>: </b><span>A</span></span></span><br><span><var>l</var><span class="hyp-type"><b>: </b><span>list A</span></span></span><br><span><var>s</var><span class="hyp-type"><b>: </b><span>Stream A</span></span></span><br><span><var>IHl</var><span class="hyp-type"><b>: </b><span><span class="kr">∀</span> <span class="nv">n</span> : nat, n ≤ length l → stream_prefix (stream_app l s) n = list_prefix l n</span></span></span><br><span><var>n</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>Hle</var><span class="hyp-type"><b>: </b><span>S n ≤ S (length l)</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">n ≤ length l</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><span class="alectryon-input"><span class="bp">lia</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Qed</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
</span><span class="alectryon-sentence"><input class="alectryon-toggle" id="StreamExtras-v-chkd8" style="display: none" type="checkbox"><label class="alectryon-input" for="StreamExtras-v-chkd8"><span class="kn">Lemma</span> <span class="nf">stream_prefix_app_r</span>
  {<span class="nv">A</span> : <span class="kt">Type</span>}
  (<span class="nv">l</span> : list A)
  (<span class="nv">s</span> : Stream A)
  (<span class="nv">n</span> : nat)
  (<span class="nv">Hge</span> : n &gt;= length l)
  : stream_prefix (stream_app l s) n = l ++ stream_prefix s (n - length l).</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>A</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>l</var><span class="hyp-type"><b>: </b><span>list A</span></span></span><br><span><var>s</var><span class="hyp-type"><b>: </b><span>Stream A</span></span></span><br><span><var>n</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>Hge</var><span class="hyp-type"><b>: </b><span>n ≥ length l</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">stream_prefix (stream_app l s) n =
l ++ stream_prefix s (n - length l)</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="StreamExtras-v-chkd9" style="display: none" type="checkbox"><label class="alectryon-input" for="StreamExtras-v-chkd9"><span class="kn">Proof</span>.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>A</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>l</var><span class="hyp-type"><b>: </b><span>list A</span></span></span><br><span><var>s</var><span class="hyp-type"><b>: </b><span>Stream A</span></span></span><br><span><var>n</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>Hge</var><span class="hyp-type"><b>: </b><span>n ≥ length l</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">stream_prefix (stream_app l s) n =
l ++ stream_prefix s (n - length l)</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="StreamExtras-v-chkda" style="display: none" type="checkbox"><label class="alectryon-input" for="StreamExtras-v-chkda"><span class="nb">generalize dependent</span> l.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>A</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>s</var><span class="hyp-type"><b>: </b><span>Stream A</span></span></span><br><span><var>n</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="kr">∀</span> <span class="nv">l</span> : list A,
  n ≥ length l
  → stream_prefix (stream_app l s) n =
    l ++ stream_prefix s (n - length l)</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="StreamExtras-v-chkdb" style="display: none" type="checkbox"><label class="alectryon-input" for="StreamExtras-v-chkdb"><span class="nb">generalize dependent</span> s.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>A</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>n</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="kr">∀</span> (<span class="nv">s</span> : Stream A) (<span class="nv">l</span> : list A),
  n ≥ length l
  → stream_prefix (stream_app l s) n =
    l ++ stream_prefix s (n - length l)</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="StreamExtras-v-chkdc" style="display: none" type="checkbox"><label class="alectryon-input" for="StreamExtras-v-chkdc"><span class="nb">induction</span> n.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>A</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="kr">∀</span> (<span class="nv">s</span> : Stream A) (<span class="nv">l</span> : list A),
  <span class="mi">0</span> ≥ length l
  → stream_prefix (stream_app l s) <span class="mi">0</span> =
    l ++ stream_prefix s (<span class="mi">0</span> - length l)</div></blockquote><div class="alectryon-extra-goals"><input class="alectryon-extra-goal-toggle" id="StreamExtras-v-chkdd" style="display: none" type="checkbox"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>A</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>n</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>IHn</var><span class="hyp-type"><b>: </b><span><span class="kr">∀</span> (<span class="nv">s</span> : Stream A) (<span class="nv">l</span> : list A),
n ≥ length l
→ stream_prefix (stream_app l s) n = l ++ stream_prefix s (n - length l)</span></span></span><br></div><label class="goal-separator" for="StreamExtras-v-chkdd"><hr></label><div class="goal-conclusion"><span class="kr">∀</span> (<span class="nv">s</span> : Stream A) (<span class="nv">l</span> : list A),
  S n ≥ length l
  → stream_prefix (stream_app l s) (S n) =
    l ++ stream_prefix s (S n - length l)</div></blockquote></div></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="StreamExtras-v-chkde" style="display: none" type="checkbox"><label class="alectryon-input" for="StreamExtras-v-chkde">-</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>A</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="kr">∀</span> (<span class="nv">s</span> : Stream A) (<span class="nv">l</span> : list A),
  <span class="mi">0</span> ≥ length l
  → stream_prefix (stream_app l s) <span class="mi">0</span> =
    l ++ stream_prefix s (<span class="mi">0</span> - length l)</div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="StreamExtras-v-chkdf" style="display: none" type="checkbox"><label class="alectryon-input" for="StreamExtras-v-chkdf"><span class="nb">intros</span>.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>A</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>s</var><span class="hyp-type"><b>: </b><span>Stream A</span></span></span><br><span><var>l</var><span class="hyp-type"><b>: </b><span>list A</span></span></span><br><span><var>Hge</var><span class="hyp-type"><b>: </b><span><span class="mi">0</span> ≥ length l</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">stream_prefix (stream_app l s) <span class="mi">0</span> =
l ++ stream_prefix s (<span class="mi">0</span> - length l)</div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="StreamExtras-v-chke0" style="display: none" type="checkbox"><label class="alectryon-input" for="StreamExtras-v-chke0"><span class="nb">simpl</span>.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>A</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>s</var><span class="hyp-type"><b>: </b><span>Stream A</span></span></span><br><span><var>l</var><span class="hyp-type"><b>: </b><span>list A</span></span></span><br><span><var>Hge</var><span class="hyp-type"><b>: </b><span><span class="mi">0</span> ≥ length l</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">[] = l ++ []</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="StreamExtras-v-chke1" style="display: none" type="checkbox"><label class="alectryon-input" for="StreamExtras-v-chke1"><span class="nb">destruct</span> l <span class="kr">as</span> [|a l]; <span class="kp">try</span> <span class="bp">reflexivity</span>.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>A</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>s</var><span class="hyp-type"><b>: </b><span>Stream A</span></span></span><br><span><var>a</var><span class="hyp-type"><b>: </b><span>A</span></span></span><br><span><var>l</var><span class="hyp-type"><b>: </b><span>list A</span></span></span><br><span><var>Hge</var><span class="hyp-type"><b>: </b><span><span class="mi">0</span> ≥ length (a :: l)</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">[] = (a :: l) ++ []</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="StreamExtras-v-chke2" style="display: none" type="checkbox"><label class="alectryon-input" for="StreamExtras-v-chke2"><span class="nb">simpl</span> <span class="kr">in</span> Hge.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>A</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>s</var><span class="hyp-type"><b>: </b><span>Stream A</span></span></span><br><span><var>a</var><span class="hyp-type"><b>: </b><span>A</span></span></span><br><span><var>l</var><span class="hyp-type"><b>: </b><span>list A</span></span></span><br><span><var>Hge</var><span class="hyp-type"><b>: </b><span><span class="mi">0</span> ≥ S (length l)</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">[] = (a :: l) ++ []</div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="nb">inversion</span> Hge.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="StreamExtras-v-chke3" style="display: none" type="checkbox"><label class="alectryon-input" for="StreamExtras-v-chke3">-</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>A</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>n</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>IHn</var><span class="hyp-type"><b>: </b><span><span class="kr">∀</span> (<span class="nv">s</span> : Stream A) (<span class="nv">l</span> : list A),
n ≥ length l
→ stream_prefix (stream_app l s) n = l ++ stream_prefix s (n - length l)</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="kr">∀</span> (<span class="nv">s</span> : Stream A) (<span class="nv">l</span> : list A),
  S n ≥ length l
  → stream_prefix (stream_app l s) (S n) =
    l ++ stream_prefix s (S n - length l)</div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="StreamExtras-v-chke4" style="display: none" type="checkbox"><label class="alectryon-input" for="StreamExtras-v-chke4"><span class="nb">intros</span> s [| a l] Hge; <span class="kp">try</span> <span class="bp">reflexivity</span>.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>A</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>n</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>IHn</var><span class="hyp-type"><b>: </b><span><span class="kr">∀</span> (<span class="nv">s</span> : Stream A) (<span class="nv">l</span> : list A),
n ≥ length l
→ stream_prefix (stream_app l s) n = l ++ stream_prefix s (n - length l)</span></span></span><br><span><var>s</var><span class="hyp-type"><b>: </b><span>Stream A</span></span></span><br><span><var>a</var><span class="hyp-type"><b>: </b><span>A</span></span></span><br><span><var>l</var><span class="hyp-type"><b>: </b><span>list A</span></span></span><br><span><var>Hge</var><span class="hyp-type"><b>: </b><span>S n ≥ length (a :: l)</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">stream_prefix (stream_app (a :: l) s) (S n) =
(a :: l) ++ stream_prefix s (S n - length (a :: l))</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="StreamExtras-v-chke5" style="display: none" type="checkbox"><label class="alectryon-input" for="StreamExtras-v-chke5"><span class="nb">simpl</span>.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>A</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>n</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>IHn</var><span class="hyp-type"><b>: </b><span><span class="kr">∀</span> (<span class="nv">s</span> : Stream A) (<span class="nv">l</span> : list A),
n ≥ length l
→ stream_prefix (stream_app l s) n = l ++ stream_prefix s (n - length l)</span></span></span><br><span><var>s</var><span class="hyp-type"><b>: </b><span>Stream A</span></span></span><br><span><var>a</var><span class="hyp-type"><b>: </b><span>A</span></span></span><br><span><var>l</var><span class="hyp-type"><b>: </b><span>list A</span></span></span><br><span><var>Hge</var><span class="hyp-type"><b>: </b><span>S n ≥ length (a :: l)</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">a :: stream_prefix (stream_app l s) n =
a :: l ++ stream_prefix s (n - length l)</div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="StreamExtras-v-chke6" style="display: none" type="checkbox"><label class="alectryon-input" for="StreamExtras-v-chke6"><span class="nb">f_equal</span>.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>A</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>n</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>IHn</var><span class="hyp-type"><b>: </b><span><span class="kr">∀</span> (<span class="nv">s</span> : Stream A) (<span class="nv">l</span> : list A),
n ≥ length l
→ stream_prefix (stream_app l s) n = l ++ stream_prefix s (n - length l)</span></span></span><br><span><var>s</var><span class="hyp-type"><b>: </b><span>Stream A</span></span></span><br><span><var>a</var><span class="hyp-type"><b>: </b><span>A</span></span></span><br><span><var>l</var><span class="hyp-type"><b>: </b><span>list A</span></span></span><br><span><var>Hge</var><span class="hyp-type"><b>: </b><span>S n ≥ length (a :: l)</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">stream_prefix (stream_app l s) n =
l ++ stream_prefix s (n - length l)</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="StreamExtras-v-chke7" style="display: none" type="checkbox"><label class="alectryon-input" for="StreamExtras-v-chke7"><span class="nb">apply</span> IHn.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>A</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>n</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>IHn</var><span class="hyp-type"><b>: </b><span><span class="kr">∀</span> (<span class="nv">s</span> : Stream A) (<span class="nv">l</span> : list A),
n ≥ length l
→ stream_prefix (stream_app l s) n = l ++ stream_prefix s (n - length l)</span></span></span><br><span><var>s</var><span class="hyp-type"><b>: </b><span>Stream A</span></span></span><br><span><var>a</var><span class="hyp-type"><b>: </b><span>A</span></span></span><br><span><var>l</var><span class="hyp-type"><b>: </b><span>list A</span></span></span><br><span><var>Hge</var><span class="hyp-type"><b>: </b><span>S n ≥ length (a :: l)</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">n ≥ length l</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="StreamExtras-v-chke8" style="display: none" type="checkbox"><label class="alectryon-input" for="StreamExtras-v-chke8"><span class="nb">simpl</span> <span class="kr">in</span> Hge.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>A</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>n</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>IHn</var><span class="hyp-type"><b>: </b><span><span class="kr">∀</span> (<span class="nv">s</span> : Stream A) (<span class="nv">l</span> : list A),
n ≥ length l
→ stream_prefix (stream_app l s) n = l ++ stream_prefix s (n - length l)</span></span></span><br><span><var>s</var><span class="hyp-type"><b>: </b><span>Stream A</span></span></span><br><span><var>a</var><span class="hyp-type"><b>: </b><span>A</span></span></span><br><span><var>l</var><span class="hyp-type"><b>: </b><span>list A</span></span></span><br><span><var>Hge</var><span class="hyp-type"><b>: </b><span>S n ≥ S (length l)</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">n ≥ length l</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><span class="alectryon-input"><span class="bp">lia</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Qed</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
</span><span class="alectryon-sentence"><input class="alectryon-toggle" id="StreamExtras-v-chke9" style="display: none" type="checkbox"><label class="alectryon-input" for="StreamExtras-v-chke9"><span class="kn">Lemma</span> <span class="nf">stream_prefix_map</span>
  {<span class="nv">A</span> <span class="nv">B</span> : <span class="kt">Type</span>}
  (<span class="nv">f</span> : A -&gt; B)
  (<span class="nv">l</span> : Stream A)
  (<span class="nv">n</span> : nat)
  : List.map f (stream_prefix l n) = stream_prefix (Streams.map f l) n.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>A, B</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>f</var><span class="hyp-type"><b>: </b><span>A → B</span></span></span><br><span><var>l</var><span class="hyp-type"><b>: </b><span>Stream A</span></span></span><br><span><var>n</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">List.map f (stream_prefix l n) =
stream_prefix (map f l) n</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="StreamExtras-v-chkea" style="display: none" type="checkbox"><label class="alectryon-input" for="StreamExtras-v-chkea"><span class="kn">Proof</span>.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>A, B</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>f</var><span class="hyp-type"><b>: </b><span>A → B</span></span></span><br><span><var>l</var><span class="hyp-type"><b>: </b><span>Stream A</span></span></span><br><span><var>n</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">List.map f (stream_prefix l n) =
stream_prefix (map f l) n</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="StreamExtras-v-chkeb" style="display: none" type="checkbox"><label class="alectryon-input" for="StreamExtras-v-chkeb"><span class="nb">generalize dependent</span> l.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>A, B</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>f</var><span class="hyp-type"><b>: </b><span>A → B</span></span></span><br><span><var>n</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="kr">∀</span> <span class="nv">l</span> : Stream A,
  List.map f (stream_prefix l n) =
  stream_prefix (map f l) n</div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="StreamExtras-v-chkec" style="display: none" type="checkbox"><label class="alectryon-input" for="StreamExtras-v-chkec"><span class="nb">induction</span> n; <span class="nb">intros</span> [a l]; <span class="kp">try</span> <span class="bp">reflexivity</span>.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>A, B</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>f</var><span class="hyp-type"><b>: </b><span>A → B</span></span></span><br><span><var>n</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>IHn</var><span class="hyp-type"><b>: </b><span><span class="kr">∀</span> <span class="nv">l</span> : Stream A, List.map f (stream_prefix l n) = stream_prefix (map f l) n</span></span></span><br><span><var>a</var><span class="hyp-type"><b>: </b><span>A</span></span></span><br><span><var>l</var><span class="hyp-type"><b>: </b><span>Stream A</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">List.map f (stream_prefix (Cons a l) (S n)) =
stream_prefix (map f (Cons a l)) (S n)</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="StreamExtras-v-chked" style="display: none" type="checkbox"><label class="alectryon-input" for="StreamExtras-v-chked"><span class="nb">simpl</span>.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>A, B</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>f</var><span class="hyp-type"><b>: </b><span>A → B</span></span></span><br><span><var>n</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>IHn</var><span class="hyp-type"><b>: </b><span><span class="kr">∀</span> <span class="nv">l</span> : Stream A, List.map f (stream_prefix l n) = stream_prefix (map f l) n</span></span></span><br><span><var>a</var><span class="hyp-type"><b>: </b><span>A</span></span></span><br><span><var>l</var><span class="hyp-type"><b>: </b><span>Stream A</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">f a :: List.map f (stream_prefix l n) =
f a
:: stream_prefix
     ((<span class="kr">cofix</span> map (s : Stream A) : Stream B :=
         Cons (f (hd s)) (map (tl s))) l) n</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="StreamExtras-v-chkee" style="display: none" type="checkbox"><label class="alectryon-input" for="StreamExtras-v-chkee"><span class="nb">f_equal</span>.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>A, B</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>f</var><span class="hyp-type"><b>: </b><span>A → B</span></span></span><br><span><var>n</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>IHn</var><span class="hyp-type"><b>: </b><span><span class="kr">∀</span> <span class="nv">l</span> : Stream A, List.map f (stream_prefix l n) = stream_prefix (map f l) n</span></span></span><br><span><var>a</var><span class="hyp-type"><b>: </b><span>A</span></span></span><br><span><var>l</var><span class="hyp-type"><b>: </b><span>Stream A</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">List.map f (stream_prefix l n) =
stream_prefix
  ((<span class="kr">cofix</span> map (s : Stream A) : Stream B :=
      Cons (f (hd s)) (map (tl s))) l) n</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><span class="alectryon-input"><span class="nb">apply</span> IHn.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Qed</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
</span><span class="alectryon-sentence"><input class="alectryon-toggle" id="StreamExtras-v-chkef" style="display: none" type="checkbox"><label class="alectryon-input" for="StreamExtras-v-chkef"><span class="kn">Lemma</span> <span class="nf">stream_prefix_length</span>
  {<span class="nv">A</span> : <span class="kt">Type</span>}
  (<span class="nv">l</span> : Stream A)
  (<span class="nv">n</span> : nat)
  : length (stream_prefix l n) = n.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>A</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>l</var><span class="hyp-type"><b>: </b><span>Stream A</span></span></span><br><span><var>n</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">length (stream_prefix l n) = n</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="StreamExtras-v-chkf0" style="display: none" type="checkbox"><label class="alectryon-input" for="StreamExtras-v-chkf0"><span class="kn">Proof</span>.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>A</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>l</var><span class="hyp-type"><b>: </b><span>Stream A</span></span></span><br><span><var>n</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">length (stream_prefix l n) = n</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="StreamExtras-v-chkf1" style="display: none" type="checkbox"><label class="alectryon-input" for="StreamExtras-v-chkf1"><span class="nb">generalize dependent</span> l.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>A</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>n</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="kr">∀</span> <span class="nv">l</span> : Stream A, length (stream_prefix l n) = n</div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="StreamExtras-v-chkf2" style="display: none" type="checkbox"><label class="alectryon-input" for="StreamExtras-v-chkf2"><span class="nb">induction</span> n; <span class="nb">intros</span> [a l]; <span class="kp">try</span> <span class="bp">reflexivity</span>.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>A</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>n</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>IHn</var><span class="hyp-type"><b>: </b><span><span class="kr">∀</span> <span class="nv">l</span> : Stream A, length (stream_prefix l n) = n</span></span></span><br><span><var>a</var><span class="hyp-type"><b>: </b><span>A</span></span></span><br><span><var>l</var><span class="hyp-type"><b>: </b><span>Stream A</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">length (stream_prefix (Cons a l) (S n)) = S n</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="StreamExtras-v-chkf3" style="display: none" type="checkbox"><label class="alectryon-input" for="StreamExtras-v-chkf3"><span class="nb">simpl</span> <span class="kr">in</span> *.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>A</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>n</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>IHn</var><span class="hyp-type"><b>: </b><span><span class="kr">∀</span> <span class="nv">l</span> : Stream A, length (stream_prefix l n) = n</span></span></span><br><span><var>a</var><span class="hyp-type"><b>: </b><span>A</span></span></span><br><span><var>l</var><span class="hyp-type"><b>: </b><span>Stream A</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">S (length (stream_prefix l n)) = S n</div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="StreamExtras-v-chkf4" style="display: none" type="checkbox"><label class="alectryon-input" for="StreamExtras-v-chkf4"><span class="nb">f_equal</span>.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>A</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>n</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>IHn</var><span class="hyp-type"><b>: </b><span><span class="kr">∀</span> <span class="nv">l</span> : Stream A, length (stream_prefix l n) = n</span></span></span><br><span><var>a</var><span class="hyp-type"><b>: </b><span>A</span></span></span><br><span><var>l</var><span class="hyp-type"><b>: </b><span>Stream A</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">length (stream_prefix l n) = n</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><span class="alectryon-input"><span class="nb">apply</span> IHn.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Qed</span>.</span></span></pre><div class="doc">
The following two of lemmas connect forall quantifiers looking at one
element or two consecutive elements at a time with corresponding list
quantifiers applied on their finite prefixes.

</div><pre class="alectryon-io highlight"><!-- Generator: Alectryon --><span class="alectryon-sentence"><input class="alectryon-toggle" id="StreamExtras-v-chkf5" style="display: none" type="checkbox"><label class="alectryon-input" for="StreamExtras-v-chkf5"><span class="kn">Lemma</span> <span class="nf">stream_prefix_ForAll</span>
  {<span class="nv">A</span> : <span class="kt">Type</span>}
  (<span class="nv">P</span> : A -&gt; <span class="kt">Prop</span>)
  (<span class="nv">s</span> : Stream A)
  : ForAll1 P s &lt;-&gt; <span class="kr">forall</span> <span class="nv">n</span> : nat, Forall P (stream_prefix s n).</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>A</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>P</var><span class="hyp-type"><b>: </b><span>A → <span class="kt">Prop</span></span></span></span><br><span><var>s</var><span class="hyp-type"><b>: </b><span>Stream A</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">ForAll1 P s
↔ (<span class="kr">∀</span> <span class="nv">n</span> : nat, Forall P (stream_prefix s n))</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="StreamExtras-v-chkf6" style="display: none" type="checkbox"><label class="alectryon-input" for="StreamExtras-v-chkf6"><span class="kn">Proof</span>.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>A</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>P</var><span class="hyp-type"><b>: </b><span>A → <span class="kt">Prop</span></span></span></span><br><span><var>s</var><span class="hyp-type"><b>: </b><span>Stream A</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">ForAll1 P s
↔ (<span class="kr">∀</span> <span class="nv">n</span> : nat, Forall P (stream_prefix s n))</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="StreamExtras-v-chkf7" style="display: none" type="checkbox"><label class="alectryon-input" for="StreamExtras-v-chkf7"><span class="nb">rewrite</span> ForAll1_forall.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>A</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>P</var><span class="hyp-type"><b>: </b><span>A → <span class="kt">Prop</span></span></span></span><br><span><var>s</var><span class="hyp-type"><b>: </b><span>Stream A</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">(<span class="kr">∀</span> <span class="nv">n</span> : nat, P (Str_nth n s))
↔ (<span class="kr">∀</span> <span class="nv">n</span> : nat, Forall P (stream_prefix s n))</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="StreamExtras-v-chkf8" style="display: none" type="checkbox"><label class="alectryon-input" for="StreamExtras-v-chkf8"><span class="nb">setoid_rewrite</span> (Forall_nth P (hd s)).</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>A</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>P</var><span class="hyp-type"><b>: </b><span>A → <span class="kt">Prop</span></span></span></span><br><span><var>s</var><span class="hyp-type"><b>: </b><span>Stream A</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">(<span class="kr">∀</span> <span class="nv">n</span> : nat, P (Str_nth n s))
↔ (<span class="kr">∀</span> <span class="nv">n</span> <span class="nv">i</span> : nat,
     i &lt; length (stream_prefix s n)
     → P (nth i (stream_prefix s n) (hd s)))</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="StreamExtras-v-chkf9" style="display: none" type="checkbox"><label class="alectryon-input" for="StreamExtras-v-chkf9"><span class="nb">setoid_rewrite</span> stream_prefix_length.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>A</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>P</var><span class="hyp-type"><b>: </b><span>A → <span class="kt">Prop</span></span></span></span><br><span><var>s</var><span class="hyp-type"><b>: </b><span>Stream A</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">(<span class="kr">∀</span> <span class="nv">n</span> : nat, P (Str_nth n s))
↔ (<span class="kr">∀</span> <span class="nv">n</span> <span class="nv">i</span> : nat,
     i &lt; n → P (nth i (stream_prefix s n) (hd s)))</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="StreamExtras-v-chkfa" style="display: none" type="checkbox"><label class="alectryon-input" for="StreamExtras-v-chkfa"><span class="nb">specialize</span> (stream_prefix_nth s) <span class="kr">as</span> Hi.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>A</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>P</var><span class="hyp-type"><b>: </b><span>A → <span class="kt">Prop</span></span></span></span><br><span><var>s</var><span class="hyp-type"><b>: </b><span>Stream A</span></span></span><br><span><var>Hi</var><span class="hyp-type"><b>: </b><span><span class="kr">∀</span> <span class="nv">n</span> <span class="nv">i</span> : nat,
  i &lt; n
  → nth_error (stream_prefix s n) i =
    Some (Str_nth i s)</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">(<span class="kr">∀</span> <span class="nv">n</span> : nat, P (Str_nth n s))
↔ (<span class="kr">∀</span> <span class="nv">n</span> <span class="nv">i</span> : nat,
     i &lt; n → P (nth i (stream_prefix s n) (hd s)))</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="StreamExtras-v-chkfb" style="display: none" type="checkbox"><label class="alectryon-input" for="StreamExtras-v-chkfb"><span class="nb">split</span>.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>A</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>P</var><span class="hyp-type"><b>: </b><span>A → <span class="kt">Prop</span></span></span></span><br><span><var>s</var><span class="hyp-type"><b>: </b><span>Stream A</span></span></span><br><span><var>Hi</var><span class="hyp-type"><b>: </b><span><span class="kr">∀</span> <span class="nv">n</span> <span class="nv">i</span> : nat,
  i &lt; n
  → nth_error (stream_prefix s n) i =
    Some (Str_nth i s)</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">(<span class="kr">∀</span> <span class="nv">n</span> : nat, P (Str_nth n s))
→ <span class="kr">∀</span> <span class="nv">n</span> <span class="nv">i</span> : nat,
    i &lt; n → P (nth i (stream_prefix s n) (hd s))</div></blockquote><div class="alectryon-extra-goals"><input class="alectryon-extra-goal-toggle" id="StreamExtras-v-chkfc" style="display: none" type="checkbox"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>A</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>P</var><span class="hyp-type"><b>: </b><span>A → <span class="kt">Prop</span></span></span></span><br><span><var>s</var><span class="hyp-type"><b>: </b><span>Stream A</span></span></span><br><span><var>Hi</var><span class="hyp-type"><b>: </b><span><span class="kr">∀</span> <span class="nv">n</span> <span class="nv">i</span> : nat,
  i &lt; n
  → nth_error (stream_prefix s n) i =
    Some (Str_nth i s)</span></span></span><br></div><label class="goal-separator" for="StreamExtras-v-chkfc"><hr></label><div class="goal-conclusion">(<span class="kr">∀</span> <span class="nv">n</span> <span class="nv">i</span> : nat,
   i &lt; n → P (nth i (stream_prefix s n) (hd s)))
→ <span class="kr">∀</span> <span class="nv">n</span> : nat, P (Str_nth n s)</div></blockquote></div></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="StreamExtras-v-chkfd" style="display: none" type="checkbox"><label class="alectryon-input" for="StreamExtras-v-chkfd">-</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>A</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>P</var><span class="hyp-type"><b>: </b><span>A → <span class="kt">Prop</span></span></span></span><br><span><var>s</var><span class="hyp-type"><b>: </b><span>Stream A</span></span></span><br><span><var>Hi</var><span class="hyp-type"><b>: </b><span><span class="kr">∀</span> <span class="nv">n</span> <span class="nv">i</span> : nat,
  i &lt; n
  → nth_error (stream_prefix s n) i =
    Some (Str_nth i s)</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">(<span class="kr">∀</span> <span class="nv">n</span> : nat, P (Str_nth n s))
→ <span class="kr">∀</span> <span class="nv">n</span> <span class="nv">i</span> : nat,
    i &lt; n → P (nth i (stream_prefix s n) (hd s))</div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="StreamExtras-v-chkfe" style="display: none" type="checkbox"><label class="alectryon-input" for="StreamExtras-v-chkfe"><span class="nb">intros</span> Hp n i Hlt.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>A</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>P</var><span class="hyp-type"><b>: </b><span>A → <span class="kt">Prop</span></span></span></span><br><span><var>s</var><span class="hyp-type"><b>: </b><span>Stream A</span></span></span><br><span><var>Hi</var><span class="hyp-type"><b>: </b><span><span class="kr">∀</span> <span class="nv">n</span> <span class="nv">i</span> : nat,
  i &lt; n
  → nth_error (stream_prefix s n) i =
    Some (Str_nth i s)</span></span></span><br><span><var>Hp</var><span class="hyp-type"><b>: </b><span><span class="kr">∀</span> <span class="nv">n</span> : nat, P (Str_nth n s)</span></span></span><br><span><var>n, i</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>Hlt</var><span class="hyp-type"><b>: </b><span>i &lt; n</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">P (nth i (stream_prefix s n) (hd s))</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="StreamExtras-v-chkff" style="display: none" type="checkbox"><label class="alectryon-input" for="StreamExtras-v-chkff"><span class="nb">specialize</span> (Hi _ _ Hlt).</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>A</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>P</var><span class="hyp-type"><b>: </b><span>A → <span class="kt">Prop</span></span></span></span><br><span><var>s</var><span class="hyp-type"><b>: </b><span>Stream A</span></span></span><br><span><var>n, i</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>Hi</var><span class="hyp-type"><b>: </b><span>nth_error (stream_prefix s n) i =
Some (Str_nth i s)</span></span></span><br><span><var>Hp</var><span class="hyp-type"><b>: </b><span><span class="kr">∀</span> <span class="nv">n</span> : nat, P (Str_nth n s)</span></span></span><br><span><var>Hlt</var><span class="hyp-type"><b>: </b><span>i &lt; n</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">P (nth i (stream_prefix s n) (hd s))</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="StreamExtras-v-chk100" style="display: none" type="checkbox"><label class="alectryon-input" for="StreamExtras-v-chk100"><span class="nb">apply</span> nth_error_nth <span class="kr">with</span> (d := hd s) <span class="kr">in</span> Hi.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>A</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>P</var><span class="hyp-type"><b>: </b><span>A → <span class="kt">Prop</span></span></span></span><br><span><var>s</var><span class="hyp-type"><b>: </b><span>Stream A</span></span></span><br><span><var>n, i</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>Hi</var><span class="hyp-type"><b>: </b><span>nth i (stream_prefix s n) (hd s) = Str_nth i s</span></span></span><br><span><var>Hp</var><span class="hyp-type"><b>: </b><span><span class="kr">∀</span> <span class="nv">n</span> : nat, P (Str_nth n s)</span></span></span><br><span><var>Hlt</var><span class="hyp-type"><b>: </b><span>i &lt; n</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">P (nth i (stream_prefix s n) (hd s))</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="StreamExtras-v-chk101" style="display: none" type="checkbox"><label class="alectryon-input" for="StreamExtras-v-chk101"><span class="nb">rewrite</span> Hi.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>A</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>P</var><span class="hyp-type"><b>: </b><span>A → <span class="kt">Prop</span></span></span></span><br><span><var>s</var><span class="hyp-type"><b>: </b><span>Stream A</span></span></span><br><span><var>n, i</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>Hi</var><span class="hyp-type"><b>: </b><span>nth i (stream_prefix s n) (hd s) = Str_nth i s</span></span></span><br><span><var>Hp</var><span class="hyp-type"><b>: </b><span><span class="kr">∀</span> <span class="nv">n</span> : nat, P (Str_nth n s)</span></span></span><br><span><var>Hlt</var><span class="hyp-type"><b>: </b><span>i &lt; n</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">P (Str_nth i s)</div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="nb">apply</span> Hp.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="StreamExtras-v-chk102" style="display: none" type="checkbox"><label class="alectryon-input" for="StreamExtras-v-chk102">-</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>A</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>P</var><span class="hyp-type"><b>: </b><span>A → <span class="kt">Prop</span></span></span></span><br><span><var>s</var><span class="hyp-type"><b>: </b><span>Stream A</span></span></span><br><span><var>Hi</var><span class="hyp-type"><b>: </b><span><span class="kr">∀</span> <span class="nv">n</span> <span class="nv">i</span> : nat,
  i &lt; n
  → nth_error (stream_prefix s n) i =
    Some (Str_nth i s)</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">(<span class="kr">∀</span> <span class="nv">n</span> <span class="nv">i</span> : nat,
   i &lt; n → P (nth i (stream_prefix s n) (hd s)))
→ <span class="kr">∀</span> <span class="nv">n</span> : nat, P (Str_nth n s)</div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="StreamExtras-v-chk103" style="display: none" type="checkbox"><label class="alectryon-input" for="StreamExtras-v-chk103"><span class="nb">intros</span> Hp n.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>A</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>P</var><span class="hyp-type"><b>: </b><span>A → <span class="kt">Prop</span></span></span></span><br><span><var>s</var><span class="hyp-type"><b>: </b><span>Stream A</span></span></span><br><span><var>Hi</var><span class="hyp-type"><b>: </b><span><span class="kr">∀</span> <span class="nv">n</span> <span class="nv">i</span> : nat,
  i &lt; n
  → nth_error (stream_prefix s n) i =
    Some (Str_nth i s)</span></span></span><br><span><var>Hp</var><span class="hyp-type"><b>: </b><span><span class="kr">∀</span> <span class="nv">n</span> <span class="nv">i</span> : nat,
  i &lt; n → P (nth i (stream_prefix s n) (hd s))</span></span></span><br><span><var>n</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">P (Str_nth n s)</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="StreamExtras-v-chk104" style="display: none" type="checkbox"><label class="alectryon-input" for="StreamExtras-v-chk104"><span class="nb">assert</span> (Hn : n &lt; S n) <span class="bp">by</span> <span class="bp">lia</span>.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>A</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>P</var><span class="hyp-type"><b>: </b><span>A → <span class="kt">Prop</span></span></span></span><br><span><var>s</var><span class="hyp-type"><b>: </b><span>Stream A</span></span></span><br><span><var>Hi</var><span class="hyp-type"><b>: </b><span><span class="kr">∀</span> <span class="nv">n</span> <span class="nv">i</span> : nat,
  i &lt; n
  → nth_error (stream_prefix s n) i =
    Some (Str_nth i s)</span></span></span><br><span><var>Hp</var><span class="hyp-type"><b>: </b><span><span class="kr">∀</span> <span class="nv">n</span> <span class="nv">i</span> : nat,
  i &lt; n → P (nth i (stream_prefix s n) (hd s))</span></span></span><br><span><var>n</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>Hn</var><span class="hyp-type"><b>: </b><span>n &lt; S n</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">P (Str_nth n s)</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="StreamExtras-v-chk105" style="display: none" type="checkbox"><label class="alectryon-input" for="StreamExtras-v-chk105"><span class="nb">specialize</span> (Hp _ _ Hn).</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>A</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>P</var><span class="hyp-type"><b>: </b><span>A → <span class="kt">Prop</span></span></span></span><br><span><var>s</var><span class="hyp-type"><b>: </b><span>Stream A</span></span></span><br><span><var>Hi</var><span class="hyp-type"><b>: </b><span><span class="kr">∀</span> <span class="nv">n</span> <span class="nv">i</span> : nat,
  i &lt; n
  → nth_error (stream_prefix s n) i =
    Some (Str_nth i s)</span></span></span><br><span><var>n</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>Hp</var><span class="hyp-type"><b>: </b><span>P (nth n (stream_prefix s (S n)) (hd s))</span></span></span><br><span><var>Hn</var><span class="hyp-type"><b>: </b><span>n &lt; S n</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">P (Str_nth n s)</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="StreamExtras-v-chk106" style="display: none" type="checkbox"><label class="alectryon-input" for="StreamExtras-v-chk106"><span class="nb">specialize</span> (Hi _ _ Hn).</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>A</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>P</var><span class="hyp-type"><b>: </b><span>A → <span class="kt">Prop</span></span></span></span><br><span><var>s</var><span class="hyp-type"><b>: </b><span>Stream A</span></span></span><br><span><var>n</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>Hi</var><span class="hyp-type"><b>: </b><span>nth_error (stream_prefix s (S n)) n =
Some (Str_nth n s)</span></span></span><br><span><var>Hp</var><span class="hyp-type"><b>: </b><span>P (nth n (stream_prefix s (S n)) (hd s))</span></span></span><br><span><var>Hn</var><span class="hyp-type"><b>: </b><span>n &lt; S n</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">P (Str_nth n s)</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="StreamExtras-v-chk107" style="display: none" type="checkbox"><label class="alectryon-input" for="StreamExtras-v-chk107"><span class="nb">apply</span> nth_error_nth <span class="kr">with</span> (d := hd s) <span class="kr">in</span> Hi.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>A</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>P</var><span class="hyp-type"><b>: </b><span>A → <span class="kt">Prop</span></span></span></span><br><span><var>s</var><span class="hyp-type"><b>: </b><span>Stream A</span></span></span><br><span><var>n</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>Hi</var><span class="hyp-type"><b>: </b><span>nth n (stream_prefix s (S n)) (hd s) =
Str_nth n s</span></span></span><br><span><var>Hp</var><span class="hyp-type"><b>: </b><span>P (nth n (stream_prefix s (S n)) (hd s))</span></span></span><br><span><var>Hn</var><span class="hyp-type"><b>: </b><span>n &lt; S n</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">P (Str_nth n s)</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="StreamExtras-v-chk108" style="display: none" type="checkbox"><label class="alectryon-input" for="StreamExtras-v-chk108"><span class="nb">rewrite</span> Hi <span class="kr">in</span> Hp.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>A</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>P</var><span class="hyp-type"><b>: </b><span>A → <span class="kt">Prop</span></span></span></span><br><span><var>s</var><span class="hyp-type"><b>: </b><span>Stream A</span></span></span><br><span><var>n</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>Hi</var><span class="hyp-type"><b>: </b><span>nth n (stream_prefix s (S n)) (hd s) =
Str_nth n s</span></span></span><br><span><var>Hp</var><span class="hyp-type"><b>: </b><span>P (Str_nth n s)</span></span></span><br><span><var>Hn</var><span class="hyp-type"><b>: </b><span>n &lt; S n</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">P (Str_nth n s)</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><span class="alectryon-input"><span class="bp">assumption</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Qed</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
</span><span class="alectryon-sentence"><input class="alectryon-toggle" id="StreamExtras-v-chk109" style="display: none" type="checkbox"><label class="alectryon-input" for="StreamExtras-v-chk109"><span class="kn">Lemma</span> <span class="nf">stream_prefix_ForAll2</span>
  {<span class="nv">A</span> : <span class="kt">Type</span>}
  (<span class="nv">R</span> : A -&gt; A -&gt; <span class="kt">Prop</span>)
  (<span class="nv">s</span> : Stream A)
  : ForAll2 R s &lt;-&gt; <span class="kr">forall</span> <span class="nv">n</span> : nat, ForAllSuffix2 R (stream_prefix s n).</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>A</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>R</var><span class="hyp-type"><b>: </b><span>A → A → <span class="kt">Prop</span></span></span></span><br><span><var>s</var><span class="hyp-type"><b>: </b><span>Stream A</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">ForAll2 R s
↔ (<span class="kr">∀</span> <span class="nv">n</span> : nat, ForAllSuffix2 R (stream_prefix s n))</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="StreamExtras-v-chk10a" style="display: none" type="checkbox"><label class="alectryon-input" for="StreamExtras-v-chk10a"><span class="kn">Proof</span>.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>A</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>R</var><span class="hyp-type"><b>: </b><span>A → A → <span class="kt">Prop</span></span></span></span><br><span><var>s</var><span class="hyp-type"><b>: </b><span>Stream A</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">ForAll2 R s
↔ (<span class="kr">∀</span> <span class="nv">n</span> : nat, ForAllSuffix2 R (stream_prefix s n))</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="StreamExtras-v-chk10b" style="display: none" type="checkbox"><label class="alectryon-input" for="StreamExtras-v-chk10b"><span class="nb">rewrite</span> ForAll2_forall.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>A</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>R</var><span class="hyp-type"><b>: </b><span>A → A → <span class="kt">Prop</span></span></span></span><br><span><var>s</var><span class="hyp-type"><b>: </b><span>Stream A</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">(<span class="kr">∀</span> <span class="nv">n</span> : nat, R (Str_nth n s) (Str_nth (S n) s))
↔ (<span class="kr">∀</span> <span class="nv">n</span> : nat, ForAllSuffix2 R (stream_prefix s n))</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="StreamExtras-v-chk10c" style="display: none" type="checkbox"><label class="alectryon-input" for="StreamExtras-v-chk10c"><span class="nb">setoid_rewrite</span> (ForAllSuffix2_lookup R).</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>A</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>R</var><span class="hyp-type"><b>: </b><span>A → A → <span class="kt">Prop</span></span></span></span><br><span><var>s</var><span class="hyp-type"><b>: </b><span>Stream A</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">(<span class="kr">∀</span> <span class="nv">n</span> : nat, R (Str_nth n s) (Str_nth (S n) s))
↔ (<span class="kr">∀</span> (<span class="nv">n</span> <span class="nv">n0</span> : nat) (<span class="nv">a</span> <span class="nv">b</span> : A),
     stream_prefix s n !! n0 = Some a
     → stream_prefix s n !! S n0 = Some b → R a b)</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="StreamExtras-v-chk10d" style="display: none" type="checkbox"><label class="alectryon-input" for="StreamExtras-v-chk10d"><span class="nb">specialize</span> (stream_prefix_lookup s) <span class="kr">as</span> Hi.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>A</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>R</var><span class="hyp-type"><b>: </b><span>A → A → <span class="kt">Prop</span></span></span></span><br><span><var>s</var><span class="hyp-type"><b>: </b><span>Stream A</span></span></span><br><span><var>Hi</var><span class="hyp-type"><b>: </b><span><span class="kr">∀</span> <span class="nv">n</span> <span class="nv">i</span> : nat,
  i &lt; n
  → stream_prefix s n !! i = Some (Str_nth i s)</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">(<span class="kr">∀</span> <span class="nv">n</span> : nat, R (Str_nth n s) (Str_nth (S n) s))
↔ (<span class="kr">∀</span> (<span class="nv">n</span> <span class="nv">n0</span> : nat) (<span class="nv">a</span> <span class="nv">b</span> : A),
     stream_prefix s n !! n0 = Some a
     → stream_prefix s n !! S n0 = Some b → R a b)</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="StreamExtras-v-chk10e" style="display: none" type="checkbox"><label class="alectryon-input" for="StreamExtras-v-chk10e"><span class="nb">split</span>.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>A</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>R</var><span class="hyp-type"><b>: </b><span>A → A → <span class="kt">Prop</span></span></span></span><br><span><var>s</var><span class="hyp-type"><b>: </b><span>Stream A</span></span></span><br><span><var>Hi</var><span class="hyp-type"><b>: </b><span><span class="kr">∀</span> <span class="nv">n</span> <span class="nv">i</span> : nat,
  i &lt; n
  → stream_prefix s n !! i = Some (Str_nth i s)</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">(<span class="kr">∀</span> <span class="nv">n</span> : nat, R (Str_nth n s) (Str_nth (S n) s))
→ <span class="kr">∀</span> (<span class="nv">n</span> <span class="nv">n0</span> : nat) (<span class="nv">a</span> <span class="nv">b</span> : A),
    stream_prefix s n !! n0 = Some a
    → stream_prefix s n !! S n0 = Some b → R a b</div></blockquote><div class="alectryon-extra-goals"><input class="alectryon-extra-goal-toggle" id="StreamExtras-v-chk10f" style="display: none" type="checkbox"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>A</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>R</var><span class="hyp-type"><b>: </b><span>A → A → <span class="kt">Prop</span></span></span></span><br><span><var>s</var><span class="hyp-type"><b>: </b><span>Stream A</span></span></span><br><span><var>Hi</var><span class="hyp-type"><b>: </b><span><span class="kr">∀</span> <span class="nv">n</span> <span class="nv">i</span> : nat,
  i &lt; n
  → stream_prefix s n !! i = Some (Str_nth i s)</span></span></span><br></div><label class="goal-separator" for="StreamExtras-v-chk10f"><hr></label><div class="goal-conclusion">(<span class="kr">∀</span> (<span class="nv">n</span> <span class="nv">n0</span> : nat) (<span class="nv">a</span> <span class="nv">b</span> : A),
   stream_prefix s n !! n0 = Some a
   → stream_prefix s n !! S n0 = Some b → R a b)
→ <span class="kr">∀</span> <span class="nv">n</span> : nat, R (Str_nth n s) (Str_nth (S n) s)</div></blockquote></div></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="StreamExtras-v-chk110" style="display: none" type="checkbox"><label class="alectryon-input" for="StreamExtras-v-chk110">-</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>A</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>R</var><span class="hyp-type"><b>: </b><span>A → A → <span class="kt">Prop</span></span></span></span><br><span><var>s</var><span class="hyp-type"><b>: </b><span>Stream A</span></span></span><br><span><var>Hi</var><span class="hyp-type"><b>: </b><span><span class="kr">∀</span> <span class="nv">n</span> <span class="nv">i</span> : nat,
  i &lt; n
  → stream_prefix s n !! i = Some (Str_nth i s)</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">(<span class="kr">∀</span> <span class="nv">n</span> : nat, R (Str_nth n s) (Str_nth (S n) s))
→ <span class="kr">∀</span> (<span class="nv">n</span> <span class="nv">n0</span> : nat) (<span class="nv">a</span> <span class="nv">b</span> : A),
    stream_prefix s n !! n0 = Some a
    → stream_prefix s n !! S n0 = Some b → R a b</div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="StreamExtras-v-chk111" style="display: none" type="checkbox"><label class="alectryon-input" for="StreamExtras-v-chk111"><span class="nb">intros</span> Hp n i.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>A</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>R</var><span class="hyp-type"><b>: </b><span>A → A → <span class="kt">Prop</span></span></span></span><br><span><var>s</var><span class="hyp-type"><b>: </b><span>Stream A</span></span></span><br><span><var>Hi</var><span class="hyp-type"><b>: </b><span><span class="kr">∀</span> <span class="nv">n</span> <span class="nv">i</span> : nat,
  i &lt; n
  → stream_prefix s n !! i = Some (Str_nth i s)</span></span></span><br><span><var>Hp</var><span class="hyp-type"><b>: </b><span><span class="kr">∀</span> <span class="nv">n</span> : nat, R (Str_nth n s) (Str_nth (S n) s)</span></span></span><br><span><var>n, i</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="kr">∀</span> <span class="nv">a</span> <span class="nv">b</span> : A,
  stream_prefix s n !! i = Some a
  → stream_prefix s n !! S i = Some b → R a b</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="StreamExtras-v-chk112" style="display: none" type="checkbox"><label class="alectryon-input" for="StreamExtras-v-chk112"><span class="nb">destruct</span> (decide (n &lt;= S i)).</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>A</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>R</var><span class="hyp-type"><b>: </b><span>A → A → <span class="kt">Prop</span></span></span></span><br><span><var>s</var><span class="hyp-type"><b>: </b><span>Stream A</span></span></span><br><span><var>Hi</var><span class="hyp-type"><b>: </b><span><span class="kr">∀</span> <span class="nv">n</span> <span class="nv">i</span> : nat,
  i &lt; n
  → stream_prefix s n !! i = Some (Str_nth i s)</span></span></span><br><span><var>Hp</var><span class="hyp-type"><b>: </b><span><span class="kr">∀</span> <span class="nv">n</span> : nat, R (Str_nth n s) (Str_nth (S n) s)</span></span></span><br><span><var>n, i</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>l</var><span class="hyp-type"><b>: </b><span>n ≤ S i</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="kr">∀</span> <span class="nv">a</span> <span class="nv">b</span> : A,
  stream_prefix s n !! i = Some a
  → stream_prefix s n !! S i = Some b → R a b</div></blockquote><div class="alectryon-extra-goals"><input class="alectryon-extra-goal-toggle" id="StreamExtras-v-chk113" style="display: none" type="checkbox"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>A</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>R</var><span class="hyp-type"><b>: </b><span>A → A → <span class="kt">Prop</span></span></span></span><br><span><var>s</var><span class="hyp-type"><b>: </b><span>Stream A</span></span></span><br><span><var>Hi</var><span class="hyp-type"><b>: </b><span><span class="kr">∀</span> <span class="nv">n</span> <span class="nv">i</span> : nat,
  i &lt; n
  → stream_prefix s n !! i = Some (Str_nth i s)</span></span></span><br><span><var>Hp</var><span class="hyp-type"><b>: </b><span><span class="kr">∀</span> <span class="nv">n</span> : nat, R (Str_nth n s) (Str_nth (S n) s)</span></span></span><br><span><var>n, i</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>n0</var><span class="hyp-type"><b>: </b><span>¬ n ≤ S i</span></span></span><br></div><label class="goal-separator" for="StreamExtras-v-chk113"><hr></label><div class="goal-conclusion"><span class="kr">∀</span> <span class="nv">a</span> <span class="nv">b</span> : A,
  stream_prefix s n !! i = Some a
  → stream_prefix s n !! S i = Some b → R a b</div></blockquote></div></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="StreamExtras-v-chk114" style="display: none" type="checkbox"><label class="alectryon-input" for="StreamExtras-v-chk114">+</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>A</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>R</var><span class="hyp-type"><b>: </b><span>A → A → <span class="kt">Prop</span></span></span></span><br><span><var>s</var><span class="hyp-type"><b>: </b><span>Stream A</span></span></span><br><span><var>Hi</var><span class="hyp-type"><b>: </b><span><span class="kr">∀</span> <span class="nv">n</span> <span class="nv">i</span> : nat,
  i &lt; n
  → stream_prefix s n !! i = Some (Str_nth i s)</span></span></span><br><span><var>Hp</var><span class="hyp-type"><b>: </b><span><span class="kr">∀</span> <span class="nv">n</span> : nat, R (Str_nth n s) (Str_nth (S n) s)</span></span></span><br><span><var>n, i</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>l</var><span class="hyp-type"><b>: </b><span>n ≤ S i</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="kr">∀</span> <span class="nv">a</span> <span class="nv">b</span> : A,
  stream_prefix s n !! i = Some a
  → stream_prefix s n !! S i = Some b → R a b</div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="StreamExtras-v-chk115" style="display: none" type="checkbox"><label class="alectryon-input" for="StreamExtras-v-chk115"><span class="nb">intros</span>.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>A</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>R</var><span class="hyp-type"><b>: </b><span>A → A → <span class="kt">Prop</span></span></span></span><br><span><var>s</var><span class="hyp-type"><b>: </b><span>Stream A</span></span></span><br><span><var>Hi</var><span class="hyp-type"><b>: </b><span><span class="kr">∀</span> <span class="nv">n</span> <span class="nv">i</span> : nat,
  i &lt; n
  → stream_prefix s n !! i = Some (Str_nth i s)</span></span></span><br><span><var>Hp</var><span class="hyp-type"><b>: </b><span><span class="kr">∀</span> <span class="nv">n</span> : nat, R (Str_nth n s) (Str_nth (S n) s)</span></span></span><br><span><var>n, i</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>l</var><span class="hyp-type"><b>: </b><span>n ≤ S i</span></span></span><br><span><var>a, b</var><span class="hyp-type"><b>: </b><span>A</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>stream_prefix s n !! i = Some a</span></span></span><br><span><var>H0</var><span class="hyp-type"><b>: </b><span>stream_prefix s n !! S i = Some b</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">R a b</div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="StreamExtras-v-chk116" style="display: none" type="checkbox"><label class="alectryon-input" for="StreamExtras-v-chk116"><span class="nb">rewrite</span> lookup_ge_None_2 <span class="kr">in</span> H0; [<span class="bp">discriminate</span>|].</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>A</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>R</var><span class="hyp-type"><b>: </b><span>A → A → <span class="kt">Prop</span></span></span></span><br><span><var>s</var><span class="hyp-type"><b>: </b><span>Stream A</span></span></span><br><span><var>Hi</var><span class="hyp-type"><b>: </b><span><span class="kr">∀</span> <span class="nv">n</span> <span class="nv">i</span> : nat,
  i &lt; n
  → stream_prefix s n !! i = Some (Str_nth i s)</span></span></span><br><span><var>Hp</var><span class="hyp-type"><b>: </b><span><span class="kr">∀</span> <span class="nv">n</span> : nat, R (Str_nth n s) (Str_nth (S n) s)</span></span></span><br><span><var>n, i</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>l</var><span class="hyp-type"><b>: </b><span>n ≤ S i</span></span></span><br><span><var>a, b</var><span class="hyp-type"><b>: </b><span>A</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>stream_prefix s n !! i = Some a</span></span></span><br><span><var>H0</var><span class="hyp-type"><b>: </b><span>stream_prefix s n !! S i = Some b</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">length (stream_prefix s n) ≤ S i</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">      </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="StreamExtras-v-chk117" style="display: none" type="checkbox"><label class="alectryon-input" for="StreamExtras-v-chk117"><span class="nb">rewrite</span> stream_prefix_length.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>A</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>R</var><span class="hyp-type"><b>: </b><span>A → A → <span class="kt">Prop</span></span></span></span><br><span><var>s</var><span class="hyp-type"><b>: </b><span>Stream A</span></span></span><br><span><var>Hi</var><span class="hyp-type"><b>: </b><span><span class="kr">∀</span> <span class="nv">n</span> <span class="nv">i</span> : nat,
  i &lt; n
  → stream_prefix s n !! i = Some (Str_nth i s)</span></span></span><br><span><var>Hp</var><span class="hyp-type"><b>: </b><span><span class="kr">∀</span> <span class="nv">n</span> : nat, R (Str_nth n s) (Str_nth (S n) s)</span></span></span><br><span><var>n, i</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>l</var><span class="hyp-type"><b>: </b><span>n ≤ S i</span></span></span><br><span><var>a, b</var><span class="hyp-type"><b>: </b><span>A</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>stream_prefix s n !! i = Some a</span></span></span><br><span><var>H0</var><span class="hyp-type"><b>: </b><span>stream_prefix s n !! S i = Some b</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">n ≤ S i</div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="bp">assumption</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="StreamExtras-v-chk118" style="display: none" type="checkbox"><label class="alectryon-input" for="StreamExtras-v-chk118">+</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>A</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>R</var><span class="hyp-type"><b>: </b><span>A → A → <span class="kt">Prop</span></span></span></span><br><span><var>s</var><span class="hyp-type"><b>: </b><span>Stream A</span></span></span><br><span><var>Hi</var><span class="hyp-type"><b>: </b><span><span class="kr">∀</span> <span class="nv">n</span> <span class="nv">i</span> : nat,
  i &lt; n
  → stream_prefix s n !! i = Some (Str_nth i s)</span></span></span><br><span><var>Hp</var><span class="hyp-type"><b>: </b><span><span class="kr">∀</span> <span class="nv">n</span> : nat, R (Str_nth n s) (Str_nth (S n) s)</span></span></span><br><span><var>n, i</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>n0</var><span class="hyp-type"><b>: </b><span>¬ n ≤ S i</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="kr">∀</span> <span class="nv">a</span> <span class="nv">b</span> : A,
  stream_prefix s n !! i = Some a
  → stream_prefix s n !! S i = Some b → R a b</div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="StreamExtras-v-chk119" style="display: none" type="checkbox"><label class="alectryon-input" for="StreamExtras-v-chk119"><span class="nb">pose proof</span> (stream_prefix_length s n) <span class="kr">as</span> Hlen.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>A</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>R</var><span class="hyp-type"><b>: </b><span>A → A → <span class="kt">Prop</span></span></span></span><br><span><var>s</var><span class="hyp-type"><b>: </b><span>Stream A</span></span></span><br><span><var>Hi</var><span class="hyp-type"><b>: </b><span><span class="kr">∀</span> <span class="nv">n</span> <span class="nv">i</span> : nat,
  i &lt; n
  → stream_prefix s n !! i = Some (Str_nth i s)</span></span></span><br><span><var>Hp</var><span class="hyp-type"><b>: </b><span><span class="kr">∀</span> <span class="nv">n</span> : nat, R (Str_nth n s) (Str_nth (S n) s)</span></span></span><br><span><var>n, i</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>n0</var><span class="hyp-type"><b>: </b><span>¬ n ≤ S i</span></span></span><br><span><var>Hlen</var><span class="hyp-type"><b>: </b><span>length (stream_prefix s n) = n</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="kr">∀</span> <span class="nv">a</span> <span class="nv">b</span> : A,
  stream_prefix s n !! i = Some a
  → stream_prefix s n !! S i = Some b → R a b</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">      </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="StreamExtras-v-chk11a" style="display: none" type="checkbox"><label class="alectryon-input" for="StreamExtras-v-chk11a"><span class="nb">rewrite</span> (Hi n i) <span class="bp">by</span> <span class="bp">lia</span>.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>A</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>R</var><span class="hyp-type"><b>: </b><span>A → A → <span class="kt">Prop</span></span></span></span><br><span><var>s</var><span class="hyp-type"><b>: </b><span>Stream A</span></span></span><br><span><var>Hi</var><span class="hyp-type"><b>: </b><span><span class="kr">∀</span> <span class="nv">n</span> <span class="nv">i</span> : nat,
  i &lt; n
  → stream_prefix s n !! i = Some (Str_nth i s)</span></span></span><br><span><var>Hp</var><span class="hyp-type"><b>: </b><span><span class="kr">∀</span> <span class="nv">n</span> : nat, R (Str_nth n s) (Str_nth (S n) s)</span></span></span><br><span><var>n, i</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>n0</var><span class="hyp-type"><b>: </b><span>¬ n ≤ S i</span></span></span><br><span><var>Hlen</var><span class="hyp-type"><b>: </b><span>length (stream_prefix s n) = n</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="kr">∀</span> <span class="nv">a</span> <span class="nv">b</span> : A,
  Some (Str_nth i s) = Some a
  → stream_prefix s n !! S i = Some b → R a b</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">      </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="StreamExtras-v-chk11b" style="display: none" type="checkbox"><label class="alectryon-input" for="StreamExtras-v-chk11b"><span class="nb">rewrite</span> (Hi n (S i)) <span class="bp">by</span> <span class="bp">lia</span>.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>A</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>R</var><span class="hyp-type"><b>: </b><span>A → A → <span class="kt">Prop</span></span></span></span><br><span><var>s</var><span class="hyp-type"><b>: </b><span>Stream A</span></span></span><br><span><var>Hi</var><span class="hyp-type"><b>: </b><span><span class="kr">∀</span> <span class="nv">n</span> <span class="nv">i</span> : nat,
  i &lt; n
  → stream_prefix s n !! i = Some (Str_nth i s)</span></span></span><br><span><var>Hp</var><span class="hyp-type"><b>: </b><span><span class="kr">∀</span> <span class="nv">n</span> : nat, R (Str_nth n s) (Str_nth (S n) s)</span></span></span><br><span><var>n, i</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>n0</var><span class="hyp-type"><b>: </b><span>¬ n ≤ S i</span></span></span><br><span><var>Hlen</var><span class="hyp-type"><b>: </b><span>length (stream_prefix s n) = n</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="kr">∀</span> <span class="nv">a</span> <span class="nv">b</span> : A,
  Some (Str_nth i s) = Some a
  → Some (Str_nth (S i) s) = Some b → R a b</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">      </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="StreamExtras-v-chk11c" style="display: none" type="checkbox"><label class="alectryon-input" for="StreamExtras-v-chk11c"><span class="nb">intros</span> a b Ha Hb.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>A</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>R</var><span class="hyp-type"><b>: </b><span>A → A → <span class="kt">Prop</span></span></span></span><br><span><var>s</var><span class="hyp-type"><b>: </b><span>Stream A</span></span></span><br><span><var>Hi</var><span class="hyp-type"><b>: </b><span><span class="kr">∀</span> <span class="nv">n</span> <span class="nv">i</span> : nat,
  i &lt; n
  → stream_prefix s n !! i = Some (Str_nth i s)</span></span></span><br><span><var>Hp</var><span class="hyp-type"><b>: </b><span><span class="kr">∀</span> <span class="nv">n</span> : nat, R (Str_nth n s) (Str_nth (S n) s)</span></span></span><br><span><var>n, i</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>n0</var><span class="hyp-type"><b>: </b><span>¬ n ≤ S i</span></span></span><br><span><var>Hlen</var><span class="hyp-type"><b>: </b><span>length (stream_prefix s n) = n</span></span></span><br><span><var>a, b</var><span class="hyp-type"><b>: </b><span>A</span></span></span><br><span><var>Ha</var><span class="hyp-type"><b>: </b><span>Some (Str_nth i s) = Some a</span></span></span><br><span><var>Hb</var><span class="hyp-type"><b>: </b><span>Some (Str_nth (S i) s) = Some b</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">R a b</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">      </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="StreamExtras-v-chk11d" style="display: none" type="checkbox"><label class="alectryon-input" for="StreamExtras-v-chk11d"><span class="nb">inversion</span> Ha; <span class="nb">subst</span>.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>A</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>R</var><span class="hyp-type"><b>: </b><span>A → A → <span class="kt">Prop</span></span></span></span><br><span><var>s</var><span class="hyp-type"><b>: </b><span>Stream A</span></span></span><br><span><var>Hi</var><span class="hyp-type"><b>: </b><span><span class="kr">∀</span> <span class="nv">n</span> <span class="nv">i</span> : nat,
  i &lt; n
  → stream_prefix s n !! i = Some (Str_nth i s)</span></span></span><br><span><var>Hp</var><span class="hyp-type"><b>: </b><span><span class="kr">∀</span> <span class="nv">n</span> : nat, R (Str_nth n s) (Str_nth (S n) s)</span></span></span><br><span><var>n, i</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>n0</var><span class="hyp-type"><b>: </b><span>¬ n ≤ S i</span></span></span><br><span><var>Hlen</var><span class="hyp-type"><b>: </b><span>length (stream_prefix s n) = n</span></span></span><br><span><var>b</var><span class="hyp-type"><b>: </b><span>A</span></span></span><br><span><var>Ha</var><span class="hyp-type"><b>: </b><span>Some (Str_nth i s) = Some (Str_nth i s)</span></span></span><br><span><var>Hb</var><span class="hyp-type"><b>: </b><span>Some (Str_nth (S i) s) = Some b</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">R (Str_nth i s) b</div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="StreamExtras-v-chk11e" style="display: none" type="checkbox"><label class="alectryon-input" for="StreamExtras-v-chk11e"><span class="nb">inversion</span> Hb; <span class="nb">subst</span>.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>A</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>R</var><span class="hyp-type"><b>: </b><span>A → A → <span class="kt">Prop</span></span></span></span><br><span><var>s</var><span class="hyp-type"><b>: </b><span>Stream A</span></span></span><br><span><var>Hi</var><span class="hyp-type"><b>: </b><span><span class="kr">∀</span> <span class="nv">n</span> <span class="nv">i</span> : nat,
  i &lt; n
  → stream_prefix s n !! i = Some (Str_nth i s)</span></span></span><br><span><var>Hp</var><span class="hyp-type"><b>: </b><span><span class="kr">∀</span> <span class="nv">n</span> : nat, R (Str_nth n s) (Str_nth (S n) s)</span></span></span><br><span><var>n, i</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>n0</var><span class="hyp-type"><b>: </b><span>¬ n ≤ S i</span></span></span><br><span><var>Hlen</var><span class="hyp-type"><b>: </b><span>length (stream_prefix s n) = n</span></span></span><br><span><var>Ha</var><span class="hyp-type"><b>: </b><span>Some (Str_nth i s) = Some (Str_nth i s)</span></span></span><br><span><var>Hb</var><span class="hyp-type"><b>: </b><span>Some (Str_nth (S i) s) = Some (Str_nth (S i) s)</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">R (Str_nth i s) (Str_nth (S i) s)</div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="nb">apply</span> Hp.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="StreamExtras-v-chk11f" style="display: none" type="checkbox"><label class="alectryon-input" for="StreamExtras-v-chk11f">-</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>A</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>R</var><span class="hyp-type"><b>: </b><span>A → A → <span class="kt">Prop</span></span></span></span><br><span><var>s</var><span class="hyp-type"><b>: </b><span>Stream A</span></span></span><br><span><var>Hi</var><span class="hyp-type"><b>: </b><span><span class="kr">∀</span> <span class="nv">n</span> <span class="nv">i</span> : nat,
  i &lt; n
  → stream_prefix s n !! i = Some (Str_nth i s)</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">(<span class="kr">∀</span> (<span class="nv">n</span> <span class="nv">n0</span> : nat) (<span class="nv">a</span> <span class="nv">b</span> : A),
   stream_prefix s n !! n0 = Some a
   → stream_prefix s n !! S n0 = Some b → R a b)
→ <span class="kr">∀</span> <span class="nv">n</span> : nat, R (Str_nth n s) (Str_nth (S n) s)</div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="StreamExtras-v-chk120" style="display: none" type="checkbox"><label class="alectryon-input" for="StreamExtras-v-chk120"><span class="nb">intros</span> Hp n.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>A</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>R</var><span class="hyp-type"><b>: </b><span>A → A → <span class="kt">Prop</span></span></span></span><br><span><var>s</var><span class="hyp-type"><b>: </b><span>Stream A</span></span></span><br><span><var>Hi</var><span class="hyp-type"><b>: </b><span><span class="kr">∀</span> <span class="nv">n</span> <span class="nv">i</span> : nat,
  i &lt; n
  → stream_prefix s n !! i = Some (Str_nth i s)</span></span></span><br><span><var>Hp</var><span class="hyp-type"><b>: </b><span><span class="kr">∀</span> (<span class="nv">n</span> <span class="nv">n0</span> : nat) (<span class="nv">a</span> <span class="nv">b</span> : A),
  stream_prefix s n !! n0 = Some a
  → stream_prefix s n !! S n0 = Some b → R a b</span></span></span><br><span><var>n</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">R (Str_nth n s) (Str_nth (S n) s)</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="StreamExtras-v-chk121" style="display: none" type="checkbox"><label class="alectryon-input" for="StreamExtras-v-chk121"><span class="nb">specialize</span> (Hp (S (S n)) n).</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>A</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>R</var><span class="hyp-type"><b>: </b><span>A → A → <span class="kt">Prop</span></span></span></span><br><span><var>s</var><span class="hyp-type"><b>: </b><span>Stream A</span></span></span><br><span><var>Hi</var><span class="hyp-type"><b>: </b><span><span class="kr">∀</span> <span class="nv">n</span> <span class="nv">i</span> : nat,
  i &lt; n
  → stream_prefix s n !! i = Some (Str_nth i s)</span></span></span><br><span><var>n</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>Hp</var><span class="hyp-type"><b>: </b><span><span class="kr">∀</span> <span class="nv">a</span> <span class="nv">b</span> : A,
  stream_prefix s (S (S n)) !! n = Some a
  → stream_prefix s (S (S n)) !! S n = Some b
    → R a b</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">R (Str_nth n s) (Str_nth (S n) s)</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="StreamExtras-v-chk122" style="display: none" type="checkbox"><label class="alectryon-input" for="StreamExtras-v-chk122"><span class="nb">rewrite</span> !Hi <span class="kr">in</span> Hp <span class="bp">by</span> <span class="bp">lia</span>.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>A</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>R</var><span class="hyp-type"><b>: </b><span>A → A → <span class="kt">Prop</span></span></span></span><br><span><var>s</var><span class="hyp-type"><b>: </b><span>Stream A</span></span></span><br><span><var>Hi</var><span class="hyp-type"><b>: </b><span><span class="kr">∀</span> <span class="nv">n</span> <span class="nv">i</span> : nat,
  i &lt; n
  → stream_prefix s n !! i = Some (Str_nth i s)</span></span></span><br><span><var>n</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>Hp</var><span class="hyp-type"><b>: </b><span><span class="kr">∀</span> <span class="nv">a</span> <span class="nv">b</span> : A,
  Some (Str_nth n s) = Some a
  → Some (Str_nth (S n) s) = Some b → R a b</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">R (Str_nth n s) (Str_nth (S n) s)</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><span class="alectryon-input"><span class="nb">apply</span> Hp; <span class="bp">reflexivity</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Qed</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
</span><span class="alectryon-sentence"><input class="alectryon-toggle" id="StreamExtras-v-chk123" style="display: none" type="checkbox"><label class="alectryon-input" for="StreamExtras-v-chk123"><span class="kn">Lemma</span> <span class="nf">ForAll2_transitive_lookup</span> [A : <span class="kt">Type</span>] (R : A -&gt; A -&gt; <span class="kt">Prop</span>) {HT : Transitive R}
  : <span class="kr">forall</span> <span class="nv">l</span>, ForAll2 R l &lt;-&gt; <span class="kr">forall</span> <span class="nv">m</span> <span class="nv">n</span>, m &lt; n -&gt; R (Str_nth m l) (Str_nth n l).</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>A</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>R</var><span class="hyp-type"><b>: </b><span>A → A → <span class="kt">Prop</span></span></span></span><br><span><var>HT</var><span class="hyp-type"><b>: </b><span>Transitive R</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="kr">∀</span> <span class="nv">l</span> : Stream A,
  ForAll2 R l
  ↔ (<span class="kr">∀</span> <span class="nv">m</span> <span class="nv">n</span> : nat,
       m &lt; n → R (Str_nth m l) (Str_nth n l))</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="StreamExtras-v-chk124" style="display: none" type="checkbox"><label class="alectryon-input" for="StreamExtras-v-chk124"><span class="kn">Proof</span>.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>A</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>R</var><span class="hyp-type"><b>: </b><span>A → A → <span class="kt">Prop</span></span></span></span><br><span><var>HT</var><span class="hyp-type"><b>: </b><span>Transitive R</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="kr">∀</span> <span class="nv">l</span> : Stream A,
  ForAll2 R l
  ↔ (<span class="kr">∀</span> <span class="nv">m</span> <span class="nv">n</span> : nat,
       m &lt; n → R (Str_nth m l) (Str_nth n l))</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="StreamExtras-v-chk125" style="display: none" type="checkbox"><label class="alectryon-input" for="StreamExtras-v-chk125"><span class="nb">setoid_rewrite</span> stream_prefix_ForAll2.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>A</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>R</var><span class="hyp-type"><b>: </b><span>A → A → <span class="kt">Prop</span></span></span></span><br><span><var>HT</var><span class="hyp-type"><b>: </b><span>Transitive R</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="kr">∀</span> <span class="nv">l</span> : Stream A,
  (<span class="kr">∀</span> <span class="nv">n</span> : nat, ForAllSuffix2 R (stream_prefix l n))
  ↔ (<span class="kr">∀</span> <span class="nv">m</span> <span class="nv">n</span> : nat,
       m &lt; n → R (Str_nth m l) (Str_nth n l))</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="StreamExtras-v-chk126" style="display: none" type="checkbox"><label class="alectryon-input" for="StreamExtras-v-chk126"><span class="nb">setoid_rewrite</span> ForAllSuffix2_transitive_lookup; [|<span class="bp">assumption</span>].</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>A</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>R</var><span class="hyp-type"><b>: </b><span>A → A → <span class="kt">Prop</span></span></span></span><br><span><var>HT</var><span class="hyp-type"><b>: </b><span>Transitive R</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="kr">∀</span> <span class="nv">l</span> : Stream A,
  (<span class="kr">∀</span> (<span class="nv">n</span> <span class="nv">m</span> <span class="nv">n0</span> : nat) (<span class="nv">a</span> <span class="nv">b</span> : A),
     m &lt; n0
     → stream_prefix l n !! m = Some a
       → stream_prefix l n !! n0 = Some b → R a b)
  ↔ (<span class="kr">∀</span> <span class="nv">m</span> <span class="nv">n</span> : nat,
       m &lt; n → R (Str_nth m l) (Str_nth n l))</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="StreamExtras-v-chk127" style="display: none" type="checkbox"><label class="alectryon-input" for="StreamExtras-v-chk127"><span class="nb">intros</span> s.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>A</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>R</var><span class="hyp-type"><b>: </b><span>A → A → <span class="kt">Prop</span></span></span></span><br><span><var>HT</var><span class="hyp-type"><b>: </b><span>Transitive R</span></span></span><br><span><var>s</var><span class="hyp-type"><b>: </b><span>Stream A</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">(<span class="kr">∀</span> (<span class="nv">n</span> <span class="nv">m</span> <span class="nv">n0</span> : nat) (<span class="nv">a</span> <span class="nv">b</span> : A),
   m &lt; n0
   → stream_prefix s n !! m = Some a
     → stream_prefix s n !! n0 = Some b → R a b)
↔ (<span class="kr">∀</span> <span class="nv">m</span> <span class="nv">n</span> : nat, m &lt; n → R (Str_nth m s) (Str_nth n s))</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="StreamExtras-v-chk128" style="display: none" type="checkbox"><label class="alectryon-input" for="StreamExtras-v-chk128"><span class="nb">specialize</span> (stream_prefix_lookup s) <span class="kr">as</span> Hi.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>A</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>R</var><span class="hyp-type"><b>: </b><span>A → A → <span class="kt">Prop</span></span></span></span><br><span><var>HT</var><span class="hyp-type"><b>: </b><span>Transitive R</span></span></span><br><span><var>s</var><span class="hyp-type"><b>: </b><span>Stream A</span></span></span><br><span><var>Hi</var><span class="hyp-type"><b>: </b><span><span class="kr">∀</span> <span class="nv">n</span> <span class="nv">i</span> : nat,
  i &lt; n
  → stream_prefix s n !! i = Some (Str_nth i s)</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">(<span class="kr">∀</span> (<span class="nv">n</span> <span class="nv">m</span> <span class="nv">n0</span> : nat) (<span class="nv">a</span> <span class="nv">b</span> : A),
   m &lt; n0
   → stream_prefix s n !! m = Some a
     → stream_prefix s n !! n0 = Some b → R a b)
↔ (<span class="kr">∀</span> <span class="nv">m</span> <span class="nv">n</span> : nat, m &lt; n → R (Str_nth m s) (Str_nth n s))</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="StreamExtras-v-chk129" style="display: none" type="checkbox"><label class="alectryon-input" for="StreamExtras-v-chk129"><span class="nb">split</span>.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>A</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>R</var><span class="hyp-type"><b>: </b><span>A → A → <span class="kt">Prop</span></span></span></span><br><span><var>HT</var><span class="hyp-type"><b>: </b><span>Transitive R</span></span></span><br><span><var>s</var><span class="hyp-type"><b>: </b><span>Stream A</span></span></span><br><span><var>Hi</var><span class="hyp-type"><b>: </b><span><span class="kr">∀</span> <span class="nv">n</span> <span class="nv">i</span> : nat,
  i &lt; n
  → stream_prefix s n !! i = Some (Str_nth i s)</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">(<span class="kr">∀</span> (<span class="nv">n</span> <span class="nv">m</span> <span class="nv">n0</span> : nat) (<span class="nv">a</span> <span class="nv">b</span> : A),
   m &lt; n0
   → stream_prefix s n !! m = Some a
     → stream_prefix s n !! n0 = Some b → R a b)
→ <span class="kr">∀</span> <span class="nv">m</span> <span class="nv">n</span> : nat, m &lt; n → R (Str_nth m s) (Str_nth n s)</div></blockquote><div class="alectryon-extra-goals"><input class="alectryon-extra-goal-toggle" id="StreamExtras-v-chk12a" style="display: none" type="checkbox"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>A</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>R</var><span class="hyp-type"><b>: </b><span>A → A → <span class="kt">Prop</span></span></span></span><br><span><var>HT</var><span class="hyp-type"><b>: </b><span>Transitive R</span></span></span><br><span><var>s</var><span class="hyp-type"><b>: </b><span>Stream A</span></span></span><br><span><var>Hi</var><span class="hyp-type"><b>: </b><span><span class="kr">∀</span> <span class="nv">n</span> <span class="nv">i</span> : nat,
  i &lt; n
  → stream_prefix s n !! i = Some (Str_nth i s)</span></span></span><br></div><label class="goal-separator" for="StreamExtras-v-chk12a"><hr></label><div class="goal-conclusion">(<span class="kr">∀</span> <span class="nv">m</span> <span class="nv">n</span> : nat, m &lt; n → R (Str_nth m s) (Str_nth n s))
→ <span class="kr">∀</span> (<span class="nv">n</span> <span class="nv">m</span> <span class="nv">n0</span> : nat) (<span class="nv">a</span> <span class="nv">b</span> : A),
    m &lt; n0
    → stream_prefix s n !! m = Some a
      → stream_prefix s n !! n0 = Some b → R a b</div></blockquote></div></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="StreamExtras-v-chk12b" style="display: none" type="checkbox"><label class="alectryon-input" for="StreamExtras-v-chk12b">-</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>A</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>R</var><span class="hyp-type"><b>: </b><span>A → A → <span class="kt">Prop</span></span></span></span><br><span><var>HT</var><span class="hyp-type"><b>: </b><span>Transitive R</span></span></span><br><span><var>s</var><span class="hyp-type"><b>: </b><span>Stream A</span></span></span><br><span><var>Hi</var><span class="hyp-type"><b>: </b><span><span class="kr">∀</span> <span class="nv">n</span> <span class="nv">i</span> : nat,
  i &lt; n
  → stream_prefix s n !! i = Some (Str_nth i s)</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">(<span class="kr">∀</span> (<span class="nv">n</span> <span class="nv">m</span> <span class="nv">n0</span> : nat) (<span class="nv">a</span> <span class="nv">b</span> : A),
   m &lt; n0
   → stream_prefix s n !! m = Some a
     → stream_prefix s n !! n0 = Some b → R a b)
→ <span class="kr">∀</span> <span class="nv">m</span> <span class="nv">n</span> : nat, m &lt; n → R (Str_nth m s) (Str_nth n s)</div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="StreamExtras-v-chk12c" style="display: none" type="checkbox"><label class="alectryon-input" for="StreamExtras-v-chk12c"><span class="nb">intros</span> Hp i j Hij.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>A</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>R</var><span class="hyp-type"><b>: </b><span>A → A → <span class="kt">Prop</span></span></span></span><br><span><var>HT</var><span class="hyp-type"><b>: </b><span>Transitive R</span></span></span><br><span><var>s</var><span class="hyp-type"><b>: </b><span>Stream A</span></span></span><br><span><var>Hi</var><span class="hyp-type"><b>: </b><span><span class="kr">∀</span> <span class="nv">n</span> <span class="nv">i</span> : nat,
  i &lt; n
  → stream_prefix s n !! i = Some (Str_nth i s)</span></span></span><br><span><var>Hp</var><span class="hyp-type"><b>: </b><span><span class="kr">∀</span> (<span class="nv">n</span> <span class="nv">m</span> <span class="nv">n0</span> : nat) (<span class="nv">a</span> <span class="nv">b</span> : A),
  m &lt; n0
  → stream_prefix s n !! m = Some a
    → stream_prefix s n !! n0 = Some b → R a b</span></span></span><br><span><var>i, j</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>Hij</var><span class="hyp-type"><b>: </b><span>i &lt; j</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">R (Str_nth i s) (Str_nth j s)</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="StreamExtras-v-chk12d" style="display: none" type="checkbox"><label class="alectryon-input" for="StreamExtras-v-chk12d"><span class="nb">specialize</span> (Hp (S j) i j (Str_nth i s) (Str_nth j s) Hij).</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>A</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>R</var><span class="hyp-type"><b>: </b><span>A → A → <span class="kt">Prop</span></span></span></span><br><span><var>HT</var><span class="hyp-type"><b>: </b><span>Transitive R</span></span></span><br><span><var>s</var><span class="hyp-type"><b>: </b><span>Stream A</span></span></span><br><span><var>Hi</var><span class="hyp-type"><b>: </b><span><span class="kr">∀</span> <span class="nv">n</span> <span class="nv">i</span> : nat,
  i &lt; n
  → stream_prefix s n !! i = Some (Str_nth i s)</span></span></span><br><span><var>i, j</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>Hp</var><span class="hyp-type"><b>: </b><span>stream_prefix s (S j) !! i = Some (Str_nth i s)
→ stream_prefix s (S j) !! j = Some (Str_nth j s)
  → R (Str_nth i s) (Str_nth j s)</span></span></span><br><span><var>Hij</var><span class="hyp-type"><b>: </b><span>i &lt; j</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">R (Str_nth i s) (Str_nth j s)</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="StreamExtras-v-chk12e" style="display: none" type="checkbox"><label class="alectryon-input" for="StreamExtras-v-chk12e"><span class="nb">rewrite</span> !Hi <span class="kr">in</span> Hp <span class="bp">by</span> <span class="bp">lia</span>.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>A</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>R</var><span class="hyp-type"><b>: </b><span>A → A → <span class="kt">Prop</span></span></span></span><br><span><var>HT</var><span class="hyp-type"><b>: </b><span>Transitive R</span></span></span><br><span><var>s</var><span class="hyp-type"><b>: </b><span>Stream A</span></span></span><br><span><var>Hi</var><span class="hyp-type"><b>: </b><span><span class="kr">∀</span> <span class="nv">n</span> <span class="nv">i</span> : nat,
  i &lt; n
  → stream_prefix s n !! i = Some (Str_nth i s)</span></span></span><br><span><var>i, j</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>Hp</var><span class="hyp-type"><b>: </b><span>Some (Str_nth i s) = Some (Str_nth i s)
→ Some (Str_nth j s) = Some (Str_nth j s)
  → R (Str_nth i s) (Str_nth j s)</span></span></span><br><span><var>Hij</var><span class="hyp-type"><b>: </b><span>i &lt; j</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">R (Str_nth i s) (Str_nth j s)</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><span class="alectryon-input"><span class="nb">apply</span> Hp; <span class="bp">reflexivity</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="StreamExtras-v-chk12f" style="display: none" type="checkbox"><label class="alectryon-input" for="StreamExtras-v-chk12f">-</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>A</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>R</var><span class="hyp-type"><b>: </b><span>A → A → <span class="kt">Prop</span></span></span></span><br><span><var>HT</var><span class="hyp-type"><b>: </b><span>Transitive R</span></span></span><br><span><var>s</var><span class="hyp-type"><b>: </b><span>Stream A</span></span></span><br><span><var>Hi</var><span class="hyp-type"><b>: </b><span><span class="kr">∀</span> <span class="nv">n</span> <span class="nv">i</span> : nat,
  i &lt; n
  → stream_prefix s n !! i = Some (Str_nth i s)</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">(<span class="kr">∀</span> <span class="nv">m</span> <span class="nv">n</span> : nat, m &lt; n → R (Str_nth m s) (Str_nth n s))
→ <span class="kr">∀</span> (<span class="nv">n</span> <span class="nv">m</span> <span class="nv">n0</span> : nat) (<span class="nv">a</span> <span class="nv">b</span> : A),
    m &lt; n0
    → stream_prefix s n !! m = Some a
      → stream_prefix s n !! n0 = Some b → R a b</div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="StreamExtras-v-chk130" style="display: none" type="checkbox"><label class="alectryon-input" for="StreamExtras-v-chk130"><span class="nb">intros</span> Hp n i j a b Hlt Ha Hb.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>A</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>R</var><span class="hyp-type"><b>: </b><span>A → A → <span class="kt">Prop</span></span></span></span><br><span><var>HT</var><span class="hyp-type"><b>: </b><span>Transitive R</span></span></span><br><span><var>s</var><span class="hyp-type"><b>: </b><span>Stream A</span></span></span><br><span><var>Hi</var><span class="hyp-type"><b>: </b><span><span class="kr">∀</span> <span class="nv">n</span> <span class="nv">i</span> : nat,
  i &lt; n
  → stream_prefix s n !! i = Some (Str_nth i s)</span></span></span><br><span><var>Hp</var><span class="hyp-type"><b>: </b><span><span class="kr">∀</span> <span class="nv">m</span> <span class="nv">n</span> : nat,
  m &lt; n → R (Str_nth m s) (Str_nth n s)</span></span></span><br><span><var>n, i, j</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>a, b</var><span class="hyp-type"><b>: </b><span>A</span></span></span><br><span><var>Hlt</var><span class="hyp-type"><b>: </b><span>i &lt; j</span></span></span><br><span><var>Ha</var><span class="hyp-type"><b>: </b><span>stream_prefix s n !! i = Some a</span></span></span><br><span><var>Hb</var><span class="hyp-type"><b>: </b><span>stream_prefix s n !! j = Some b</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">R a b</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="StreamExtras-v-chk131" style="display: none" type="checkbox"><label class="alectryon-input" for="StreamExtras-v-chk131"><span class="nb">apply</span> lookup_lt_Some <span class="kr">in</span> Hb <span class="kr">as</span> Hltj.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>A</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>R</var><span class="hyp-type"><b>: </b><span>A → A → <span class="kt">Prop</span></span></span></span><br><span><var>HT</var><span class="hyp-type"><b>: </b><span>Transitive R</span></span></span><br><span><var>s</var><span class="hyp-type"><b>: </b><span>Stream A</span></span></span><br><span><var>Hi</var><span class="hyp-type"><b>: </b><span><span class="kr">∀</span> <span class="nv">n</span> <span class="nv">i</span> : nat,
  i &lt; n
  → stream_prefix s n !! i = Some (Str_nth i s)</span></span></span><br><span><var>Hp</var><span class="hyp-type"><b>: </b><span><span class="kr">∀</span> <span class="nv">m</span> <span class="nv">n</span> : nat,
  m &lt; n → R (Str_nth m s) (Str_nth n s)</span></span></span><br><span><var>n, i, j</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>a, b</var><span class="hyp-type"><b>: </b><span>A</span></span></span><br><span><var>Hlt</var><span class="hyp-type"><b>: </b><span>i &lt; j</span></span></span><br><span><var>Ha</var><span class="hyp-type"><b>: </b><span>stream_prefix s n !! i = Some a</span></span></span><br><span><var>Hb</var><span class="hyp-type"><b>: </b><span>stream_prefix s n !! j = Some b</span></span></span><br><span><var>Hltj</var><span class="hyp-type"><b>: </b><span>j &lt; length (stream_prefix s n)</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">R a b</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="StreamExtras-v-chk132" style="display: none" type="checkbox"><label class="alectryon-input" for="StreamExtras-v-chk132"><span class="nb">rewrite</span> stream_prefix_length <span class="kr">in</span> Hltj.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>A</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>R</var><span class="hyp-type"><b>: </b><span>A → A → <span class="kt">Prop</span></span></span></span><br><span><var>HT</var><span class="hyp-type"><b>: </b><span>Transitive R</span></span></span><br><span><var>s</var><span class="hyp-type"><b>: </b><span>Stream A</span></span></span><br><span><var>Hi</var><span class="hyp-type"><b>: </b><span><span class="kr">∀</span> <span class="nv">n</span> <span class="nv">i</span> : nat,
  i &lt; n
  → stream_prefix s n !! i = Some (Str_nth i s)</span></span></span><br><span><var>Hp</var><span class="hyp-type"><b>: </b><span><span class="kr">∀</span> <span class="nv">m</span> <span class="nv">n</span> : nat,
  m &lt; n → R (Str_nth m s) (Str_nth n s)</span></span></span><br><span><var>n, i, j</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>a, b</var><span class="hyp-type"><b>: </b><span>A</span></span></span><br><span><var>Hlt</var><span class="hyp-type"><b>: </b><span>i &lt; j</span></span></span><br><span><var>Ha</var><span class="hyp-type"><b>: </b><span>stream_prefix s n !! i = Some a</span></span></span><br><span><var>Hb</var><span class="hyp-type"><b>: </b><span>stream_prefix s n !! j = Some b</span></span></span><br><span><var>Hltj</var><span class="hyp-type"><b>: </b><span>j &lt; n</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">R a b</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="StreamExtras-v-chk133" style="display: none" type="checkbox"><label class="alectryon-input" for="StreamExtras-v-chk133"><span class="nb">rewrite</span> Hi <span class="kr">in</span> Ha <span class="bp">by</span> <span class="bp">lia</span>.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>A</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>R</var><span class="hyp-type"><b>: </b><span>A → A → <span class="kt">Prop</span></span></span></span><br><span><var>HT</var><span class="hyp-type"><b>: </b><span>Transitive R</span></span></span><br><span><var>s</var><span class="hyp-type"><b>: </b><span>Stream A</span></span></span><br><span><var>Hi</var><span class="hyp-type"><b>: </b><span><span class="kr">∀</span> <span class="nv">n</span> <span class="nv">i</span> : nat,
  i &lt; n
  → stream_prefix s n !! i = Some (Str_nth i s)</span></span></span><br><span><var>Hp</var><span class="hyp-type"><b>: </b><span><span class="kr">∀</span> <span class="nv">m</span> <span class="nv">n</span> : nat,
  m &lt; n → R (Str_nth m s) (Str_nth n s)</span></span></span><br><span><var>n, i, j</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>a, b</var><span class="hyp-type"><b>: </b><span>A</span></span></span><br><span><var>Hlt</var><span class="hyp-type"><b>: </b><span>i &lt; j</span></span></span><br><span><var>Ha</var><span class="hyp-type"><b>: </b><span>Some (Str_nth i s) = Some a</span></span></span><br><span><var>Hb</var><span class="hyp-type"><b>: </b><span>stream_prefix s n !! j = Some b</span></span></span><br><span><var>Hltj</var><span class="hyp-type"><b>: </b><span>j &lt; n</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">R a b</div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="StreamExtras-v-chk134" style="display: none" type="checkbox"><label class="alectryon-input" for="StreamExtras-v-chk134"><span class="nb">inversion</span> Ha.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>A</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>R</var><span class="hyp-type"><b>: </b><span>A → A → <span class="kt">Prop</span></span></span></span><br><span><var>HT</var><span class="hyp-type"><b>: </b><span>Transitive R</span></span></span><br><span><var>s</var><span class="hyp-type"><b>: </b><span>Stream A</span></span></span><br><span><var>Hi</var><span class="hyp-type"><b>: </b><span><span class="kr">∀</span> <span class="nv">n</span> <span class="nv">i</span> : nat,
  i &lt; n
  → stream_prefix s n !! i = Some (Str_nth i s)</span></span></span><br><span><var>Hp</var><span class="hyp-type"><b>: </b><span><span class="kr">∀</span> <span class="nv">m</span> <span class="nv">n</span> : nat,
  m &lt; n → R (Str_nth m s) (Str_nth n s)</span></span></span><br><span><var>n, i, j</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>a, b</var><span class="hyp-type"><b>: </b><span>A</span></span></span><br><span><var>Hlt</var><span class="hyp-type"><b>: </b><span>i &lt; j</span></span></span><br><span><var>Ha</var><span class="hyp-type"><b>: </b><span>Some (Str_nth i s) = Some a</span></span></span><br><span><var>Hb</var><span class="hyp-type"><b>: </b><span>stream_prefix s n !! j = Some b</span></span></span><br><span><var>Hltj</var><span class="hyp-type"><b>: </b><span>j &lt; n</span></span></span><br><span><var>H0</var><span class="hyp-type"><b>: </b><span>Str_nth i s = a</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">R (Str_nth i s) b</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="StreamExtras-v-chk135" style="display: none" type="checkbox"><label class="alectryon-input" for="StreamExtras-v-chk135"><span class="nb">rewrite</span> Hi <span class="kr">in</span> Hb <span class="bp">by</span> <span class="bp">lia</span>.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>A</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>R</var><span class="hyp-type"><b>: </b><span>A → A → <span class="kt">Prop</span></span></span></span><br><span><var>HT</var><span class="hyp-type"><b>: </b><span>Transitive R</span></span></span><br><span><var>s</var><span class="hyp-type"><b>: </b><span>Stream A</span></span></span><br><span><var>Hi</var><span class="hyp-type"><b>: </b><span><span class="kr">∀</span> <span class="nv">n</span> <span class="nv">i</span> : nat,
  i &lt; n
  → stream_prefix s n !! i = Some (Str_nth i s)</span></span></span><br><span><var>Hp</var><span class="hyp-type"><b>: </b><span><span class="kr">∀</span> <span class="nv">m</span> <span class="nv">n</span> : nat,
  m &lt; n → R (Str_nth m s) (Str_nth n s)</span></span></span><br><span><var>n, i, j</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>a, b</var><span class="hyp-type"><b>: </b><span>A</span></span></span><br><span><var>Hlt</var><span class="hyp-type"><b>: </b><span>i &lt; j</span></span></span><br><span><var>Ha</var><span class="hyp-type"><b>: </b><span>Some (Str_nth i s) = Some a</span></span></span><br><span><var>Hb</var><span class="hyp-type"><b>: </b><span>Some (Str_nth j s) = Some b</span></span></span><br><span><var>Hltj</var><span class="hyp-type"><b>: </b><span>j &lt; n</span></span></span><br><span><var>H0</var><span class="hyp-type"><b>: </b><span>Str_nth i s = a</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">R (Str_nth i s) b</div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="StreamExtras-v-chk136" style="display: none" type="checkbox"><label class="alectryon-input" for="StreamExtras-v-chk136"><span class="nb">inversion</span> Hb.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>A</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>R</var><span class="hyp-type"><b>: </b><span>A → A → <span class="kt">Prop</span></span></span></span><br><span><var>HT</var><span class="hyp-type"><b>: </b><span>Transitive R</span></span></span><br><span><var>s</var><span class="hyp-type"><b>: </b><span>Stream A</span></span></span><br><span><var>Hi</var><span class="hyp-type"><b>: </b><span><span class="kr">∀</span> <span class="nv">n</span> <span class="nv">i</span> : nat,
  i &lt; n
  → stream_prefix s n !! i = Some (Str_nth i s)</span></span></span><br><span><var>Hp</var><span class="hyp-type"><b>: </b><span><span class="kr">∀</span> <span class="nv">m</span> <span class="nv">n</span> : nat,
  m &lt; n → R (Str_nth m s) (Str_nth n s)</span></span></span><br><span><var>n, i, j</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>a, b</var><span class="hyp-type"><b>: </b><span>A</span></span></span><br><span><var>Hlt</var><span class="hyp-type"><b>: </b><span>i &lt; j</span></span></span><br><span><var>Ha</var><span class="hyp-type"><b>: </b><span>Some (Str_nth i s) = Some a</span></span></span><br><span><var>Hb</var><span class="hyp-type"><b>: </b><span>Some (Str_nth j s) = Some b</span></span></span><br><span><var>Hltj</var><span class="hyp-type"><b>: </b><span>j &lt; n</span></span></span><br><span><var>H0</var><span class="hyp-type"><b>: </b><span>Str_nth i s = a</span></span></span><br><span><var>H1</var><span class="hyp-type"><b>: </b><span>Str_nth j s = b</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">R (Str_nth i s) (Str_nth j s)</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="StreamExtras-v-chk137" style="display: none" type="checkbox"><label class="alectryon-input" for="StreamExtras-v-chk137"><span class="nb">apply</span> Hp.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>A</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>R</var><span class="hyp-type"><b>: </b><span>A → A → <span class="kt">Prop</span></span></span></span><br><span><var>HT</var><span class="hyp-type"><b>: </b><span>Transitive R</span></span></span><br><span><var>s</var><span class="hyp-type"><b>: </b><span>Stream A</span></span></span><br><span><var>Hi</var><span class="hyp-type"><b>: </b><span><span class="kr">∀</span> <span class="nv">n</span> <span class="nv">i</span> : nat,
  i &lt; n
  → stream_prefix s n !! i = Some (Str_nth i s)</span></span></span><br><span><var>Hp</var><span class="hyp-type"><b>: </b><span><span class="kr">∀</span> <span class="nv">m</span> <span class="nv">n</span> : nat,
  m &lt; n → R (Str_nth m s) (Str_nth n s)</span></span></span><br><span><var>n, i, j</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>a, b</var><span class="hyp-type"><b>: </b><span>A</span></span></span><br><span><var>Hlt</var><span class="hyp-type"><b>: </b><span>i &lt; j</span></span></span><br><span><var>Ha</var><span class="hyp-type"><b>: </b><span>Some (Str_nth i s) = Some a</span></span></span><br><span><var>Hb</var><span class="hyp-type"><b>: </b><span>Some (Str_nth j s) = Some b</span></span></span><br><span><var>Hltj</var><span class="hyp-type"><b>: </b><span>j &lt; n</span></span></span><br><span><var>H0</var><span class="hyp-type"><b>: </b><span>Str_nth i s = a</span></span></span><br><span><var>H1</var><span class="hyp-type"><b>: </b><span>Str_nth j s = b</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">i &lt; j</div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="bp">assumption</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Qed</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
</span><span class="alectryon-sentence"><input class="alectryon-toggle" id="StreamExtras-v-chk138" style="display: none" type="checkbox"><label class="alectryon-input" for="StreamExtras-v-chk138"><span class="kn">Lemma</span> <span class="nf">ForAll2_strict_lookup_rev</span> [A : <span class="kt">Type</span>] (R : A -&gt; A -&gt; <span class="kt">Prop</span>) {HR : StrictOrder R}
  (l : Stream A) (Hl : ForAll2 R l)
  : <span class="kr">forall</span> <span class="nv">m</span> <span class="nv">n</span>, R (Str_nth m l) (Str_nth n l) -&gt; m &lt; n.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>A</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>R</var><span class="hyp-type"><b>: </b><span>A → A → <span class="kt">Prop</span></span></span></span><br><span><var>HR</var><span class="hyp-type"><b>: </b><span>StrictOrder R</span></span></span><br><span><var>l</var><span class="hyp-type"><b>: </b><span>Stream A</span></span></span><br><span><var>Hl</var><span class="hyp-type"><b>: </b><span>ForAll2 R l</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="kr">∀</span> <span class="nv">m</span> <span class="nv">n</span> : nat, R (Str_nth m l) (Str_nth n l) → m &lt; n</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="StreamExtras-v-chk139" style="display: none" type="checkbox"><label class="alectryon-input" for="StreamExtras-v-chk139"><span class="kn">Proof</span>.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>A</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>R</var><span class="hyp-type"><b>: </b><span>A → A → <span class="kt">Prop</span></span></span></span><br><span><var>HR</var><span class="hyp-type"><b>: </b><span>StrictOrder R</span></span></span><br><span><var>l</var><span class="hyp-type"><b>: </b><span>Stream A</span></span></span><br><span><var>Hl</var><span class="hyp-type"><b>: </b><span>ForAll2 R l</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="kr">∀</span> <span class="nv">m</span> <span class="nv">n</span> : nat, R (Str_nth m l) (Str_nth n l) → m &lt; n</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="StreamExtras-v-chk13a" style="display: none" type="checkbox"><label class="alectryon-input" for="StreamExtras-v-chk13a"><span class="nb">intros</span> m n Hr.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>A</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>R</var><span class="hyp-type"><b>: </b><span>A → A → <span class="kt">Prop</span></span></span></span><br><span><var>HR</var><span class="hyp-type"><b>: </b><span>StrictOrder R</span></span></span><br><span><var>l</var><span class="hyp-type"><b>: </b><span>Stream A</span></span></span><br><span><var>Hl</var><span class="hyp-type"><b>: </b><span>ForAll2 R l</span></span></span><br><span><var>m, n</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>Hr</var><span class="hyp-type"><b>: </b><span>R (Str_nth m l) (Str_nth n l)</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">m &lt; n</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="StreamExtras-v-chk13b" style="display: none" type="checkbox"><label class="alectryon-input" for="StreamExtras-v-chk13b"><span class="nb">destruct</span> (decide (n &lt;= m)); [|<span class="bp">lia</span>].</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>A</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>R</var><span class="hyp-type"><b>: </b><span>A → A → <span class="kt">Prop</span></span></span></span><br><span><var>HR</var><span class="hyp-type"><b>: </b><span>StrictOrder R</span></span></span><br><span><var>l</var><span class="hyp-type"><b>: </b><span>Stream A</span></span></span><br><span><var>Hl</var><span class="hyp-type"><b>: </b><span>ForAll2 R l</span></span></span><br><span><var>m, n</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>Hr</var><span class="hyp-type"><b>: </b><span>R (Str_nth m l) (Str_nth n l)</span></span></span><br><span><var>l0</var><span class="hyp-type"><b>: </b><span>n ≤ m</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">m &lt; n</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="StreamExtras-v-chk13c" style="display: none" type="checkbox"><label class="alectryon-input" for="StreamExtras-v-chk13c"><span class="nb">exfalso</span>.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>A</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>R</var><span class="hyp-type"><b>: </b><span>A → A → <span class="kt">Prop</span></span></span></span><br><span><var>HR</var><span class="hyp-type"><b>: </b><span>StrictOrder R</span></span></span><br><span><var>l</var><span class="hyp-type"><b>: </b><span>Stream A</span></span></span><br><span><var>Hl</var><span class="hyp-type"><b>: </b><span>ForAll2 R l</span></span></span><br><span><var>m, n</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>Hr</var><span class="hyp-type"><b>: </b><span>R (Str_nth m l) (Str_nth n l)</span></span></span><br><span><var>l0</var><span class="hyp-type"><b>: </b><span>n ≤ m</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="kt">False</span></div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="StreamExtras-v-chk13d" style="display: none" type="checkbox"><label class="alectryon-input" for="StreamExtras-v-chk13d"><span class="nb">destruct</span> HR <span class="kr">as</span> [HI HT].</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>A</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>R</var><span class="hyp-type"><b>: </b><span>A → A → <span class="kt">Prop</span></span></span></span><br><span><var>HI</var><span class="hyp-type"><b>: </b><span>Irreflexive R</span></span></span><br><span><var>HT</var><span class="hyp-type"><b>: </b><span>Transitive R</span></span></span><br><span><var>l</var><span class="hyp-type"><b>: </b><span>Stream A</span></span></span><br><span><var>Hl</var><span class="hyp-type"><b>: </b><span>ForAll2 R l</span></span></span><br><span><var>m, n</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>Hr</var><span class="hyp-type"><b>: </b><span>R (Str_nth m l) (Str_nth n l)</span></span></span><br><span><var>l0</var><span class="hyp-type"><b>: </b><span>n ≤ m</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="kt">False</span></div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="StreamExtras-v-chk13e" style="display: none" type="checkbox"><label class="alectryon-input" for="StreamExtras-v-chk13e"><span class="nb">rewrite</span> ForAll2_transitive_lookup <span class="kr">in</span> Hl <span class="bp">by</span> <span class="bp">assumption</span>.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>A</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>R</var><span class="hyp-type"><b>: </b><span>A → A → <span class="kt">Prop</span></span></span></span><br><span><var>HI</var><span class="hyp-type"><b>: </b><span>Irreflexive R</span></span></span><br><span><var>HT</var><span class="hyp-type"><b>: </b><span>Transitive R</span></span></span><br><span><var>l</var><span class="hyp-type"><b>: </b><span>Stream A</span></span></span><br><span><var>Hl</var><span class="hyp-type"><b>: </b><span><span class="kr">∀</span> <span class="nv">m</span> <span class="nv">n</span> : nat,
  m &lt; n → R (Str_nth m l) (Str_nth n l)</span></span></span><br><span><var>m, n</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>Hr</var><span class="hyp-type"><b>: </b><span>R (Str_nth m l) (Str_nth n l)</span></span></span><br><span><var>l0</var><span class="hyp-type"><b>: </b><span>n ≤ m</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="kt">False</span></div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="StreamExtras-v-chk13f" style="display: none" type="checkbox"><label class="alectryon-input" for="StreamExtras-v-chk13f"><span class="nb">destruct</span> (decide (m = n)).</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>A</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>R</var><span class="hyp-type"><b>: </b><span>A → A → <span class="kt">Prop</span></span></span></span><br><span><var>HI</var><span class="hyp-type"><b>: </b><span>Irreflexive R</span></span></span><br><span><var>HT</var><span class="hyp-type"><b>: </b><span>Transitive R</span></span></span><br><span><var>l</var><span class="hyp-type"><b>: </b><span>Stream A</span></span></span><br><span><var>Hl</var><span class="hyp-type"><b>: </b><span><span class="kr">∀</span> <span class="nv">m</span> <span class="nv">n</span> : nat,
  m &lt; n → R (Str_nth m l) (Str_nth n l)</span></span></span><br><span><var>m, n</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>Hr</var><span class="hyp-type"><b>: </b><span>R (Str_nth m l) (Str_nth n l)</span></span></span><br><span><var>l0</var><span class="hyp-type"><b>: </b><span>n ≤ m</span></span></span><br><span><var>e</var><span class="hyp-type"><b>: </b><span>m = n</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="kt">False</span></div></blockquote><div class="alectryon-extra-goals"><input class="alectryon-extra-goal-toggle" id="StreamExtras-v-chk140" style="display: none" type="checkbox"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>A</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>R</var><span class="hyp-type"><b>: </b><span>A → A → <span class="kt">Prop</span></span></span></span><br><span><var>HI</var><span class="hyp-type"><b>: </b><span>Irreflexive R</span></span></span><br><span><var>HT</var><span class="hyp-type"><b>: </b><span>Transitive R</span></span></span><br><span><var>l</var><span class="hyp-type"><b>: </b><span>Stream A</span></span></span><br><span><var>Hl</var><span class="hyp-type"><b>: </b><span><span class="kr">∀</span> <span class="nv">m</span> <span class="nv">n</span> : nat,
  m &lt; n → R (Str_nth m l) (Str_nth n l)</span></span></span><br><span><var>m, n</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>Hr</var><span class="hyp-type"><b>: </b><span>R (Str_nth m l) (Str_nth n l)</span></span></span><br><span><var>l0</var><span class="hyp-type"><b>: </b><span>n ≤ m</span></span></span><br><span><var>n0</var><span class="hyp-type"><b>: </b><span>m ≠ n</span></span></span><br></div><label class="goal-separator" for="StreamExtras-v-chk140"><hr></label><div class="goal-conclusion"><span class="kt">False</span></div></blockquote></div></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="StreamExtras-v-chk141" style="display: none" type="checkbox"><label class="alectryon-input" for="StreamExtras-v-chk141">-</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>A</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>R</var><span class="hyp-type"><b>: </b><span>A → A → <span class="kt">Prop</span></span></span></span><br><span><var>HI</var><span class="hyp-type"><b>: </b><span>Irreflexive R</span></span></span><br><span><var>HT</var><span class="hyp-type"><b>: </b><span>Transitive R</span></span></span><br><span><var>l</var><span class="hyp-type"><b>: </b><span>Stream A</span></span></span><br><span><var>Hl</var><span class="hyp-type"><b>: </b><span><span class="kr">∀</span> <span class="nv">m</span> <span class="nv">n</span> : nat,
  m &lt; n → R (Str_nth m l) (Str_nth n l)</span></span></span><br><span><var>m, n</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>Hr</var><span class="hyp-type"><b>: </b><span>R (Str_nth m l) (Str_nth n l)</span></span></span><br><span><var>l0</var><span class="hyp-type"><b>: </b><span>n ≤ m</span></span></span><br><span><var>e</var><span class="hyp-type"><b>: </b><span>m = n</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="kt">False</span></div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="StreamExtras-v-chk142" style="display: none" type="checkbox"><label class="alectryon-input" for="StreamExtras-v-chk142"><span class="nb">subst</span>.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>A</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>R</var><span class="hyp-type"><b>: </b><span>A → A → <span class="kt">Prop</span></span></span></span><br><span><var>HI</var><span class="hyp-type"><b>: </b><span>Irreflexive R</span></span></span><br><span><var>HT</var><span class="hyp-type"><b>: </b><span>Transitive R</span></span></span><br><span><var>l</var><span class="hyp-type"><b>: </b><span>Stream A</span></span></span><br><span><var>Hl</var><span class="hyp-type"><b>: </b><span><span class="kr">∀</span> <span class="nv">m</span> <span class="nv">n</span> : nat,
  m &lt; n → R (Str_nth m l) (Str_nth n l)</span></span></span><br><span><var>n</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>l0</var><span class="hyp-type"><b>: </b><span>n ≤ n</span></span></span><br><span><var>Hr</var><span class="hyp-type"><b>: </b><span>R (Str_nth n l) (Str_nth n l)</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="kt">False</span></div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="StreamExtras-v-chk143" style="display: none" type="checkbox"><label class="alectryon-input" for="StreamExtras-v-chk143"><span class="nb">elim</span> (HI (Str_nth n l)).</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>A</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>R</var><span class="hyp-type"><b>: </b><span>A → A → <span class="kt">Prop</span></span></span></span><br><span><var>HI</var><span class="hyp-type"><b>: </b><span>Irreflexive R</span></span></span><br><span><var>HT</var><span class="hyp-type"><b>: </b><span>Transitive R</span></span></span><br><span><var>l</var><span class="hyp-type"><b>: </b><span>Stream A</span></span></span><br><span><var>Hl</var><span class="hyp-type"><b>: </b><span><span class="kr">∀</span> <span class="nv">m</span> <span class="nv">n</span> : nat,
  m &lt; n → R (Str_nth m l) (Str_nth n l)</span></span></span><br><span><var>n</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>l0</var><span class="hyp-type"><b>: </b><span>n ≤ n</span></span></span><br><span><var>Hr</var><span class="hyp-type"><b>: </b><span>R (Str_nth n l) (Str_nth n l)</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">R (Str_nth n l) (Str_nth n l)</div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="bp">assumption</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="StreamExtras-v-chk144" style="display: none" type="checkbox"><label class="alectryon-input" for="StreamExtras-v-chk144">-</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>A</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>R</var><span class="hyp-type"><b>: </b><span>A → A → <span class="kt">Prop</span></span></span></span><br><span><var>HI</var><span class="hyp-type"><b>: </b><span>Irreflexive R</span></span></span><br><span><var>HT</var><span class="hyp-type"><b>: </b><span>Transitive R</span></span></span><br><span><var>l</var><span class="hyp-type"><b>: </b><span>Stream A</span></span></span><br><span><var>Hl</var><span class="hyp-type"><b>: </b><span><span class="kr">∀</span> <span class="nv">m</span> <span class="nv">n</span> : nat,
  m &lt; n → R (Str_nth m l) (Str_nth n l)</span></span></span><br><span><var>m, n</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>Hr</var><span class="hyp-type"><b>: </b><span>R (Str_nth m l) (Str_nth n l)</span></span></span><br><span><var>l0</var><span class="hyp-type"><b>: </b><span>n ≤ m</span></span></span><br><span><var>n0</var><span class="hyp-type"><b>: </b><span>m ≠ n</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="kt">False</span></div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="StreamExtras-v-chk145" style="display: none" type="checkbox"><label class="alectryon-input" for="StreamExtras-v-chk145"><span class="nb">specialize</span> (Hl n m).</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>A</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>R</var><span class="hyp-type"><b>: </b><span>A → A → <span class="kt">Prop</span></span></span></span><br><span><var>HI</var><span class="hyp-type"><b>: </b><span>Irreflexive R</span></span></span><br><span><var>HT</var><span class="hyp-type"><b>: </b><span>Transitive R</span></span></span><br><span><var>l</var><span class="hyp-type"><b>: </b><span>Stream A</span></span></span><br><span><var>m, n</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>Hl</var><span class="hyp-type"><b>: </b><span>n &lt; m → R (Str_nth n l) (Str_nth m l)</span></span></span><br><span><var>Hr</var><span class="hyp-type"><b>: </b><span>R (Str_nth m l) (Str_nth n l)</span></span></span><br><span><var>l0</var><span class="hyp-type"><b>: </b><span>n ≤ m</span></span></span><br><span><var>n0</var><span class="hyp-type"><b>: </b><span>m ≠ n</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="kt">False</span></div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="StreamExtras-v-chk146" style="display: none" type="checkbox"><label class="alectryon-input" for="StreamExtras-v-chk146">spec Hl; [<span class="bp">lia</span>|].</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>A</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>R</var><span class="hyp-type"><b>: </b><span>A → A → <span class="kt">Prop</span></span></span></span><br><span><var>HI</var><span class="hyp-type"><b>: </b><span>Irreflexive R</span></span></span><br><span><var>HT</var><span class="hyp-type"><b>: </b><span>Transitive R</span></span></span><br><span><var>l</var><span class="hyp-type"><b>: </b><span>Stream A</span></span></span><br><span><var>m, n</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>Hr</var><span class="hyp-type"><b>: </b><span>R (Str_nth m l) (Str_nth n l)</span></span></span><br><span><var>l0</var><span class="hyp-type"><b>: </b><span>n ≤ m</span></span></span><br><span><var>n0</var><span class="hyp-type"><b>: </b><span>m ≠ n</span></span></span><br><span><var>Hl</var><span class="hyp-type"><b>: </b><span>R (Str_nth n l) (Str_nth m l)</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="kt">False</span></div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="StreamExtras-v-chk147" style="display: none" type="checkbox"><label class="alectryon-input" for="StreamExtras-v-chk147"><span class="nb">elim</span> (HI (Str_nth n l)).</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>A</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>R</var><span class="hyp-type"><b>: </b><span>A → A → <span class="kt">Prop</span></span></span></span><br><span><var>HI</var><span class="hyp-type"><b>: </b><span>Irreflexive R</span></span></span><br><span><var>HT</var><span class="hyp-type"><b>: </b><span>Transitive R</span></span></span><br><span><var>l</var><span class="hyp-type"><b>: </b><span>Stream A</span></span></span><br><span><var>m, n</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>Hr</var><span class="hyp-type"><b>: </b><span>R (Str_nth m l) (Str_nth n l)</span></span></span><br><span><var>l0</var><span class="hyp-type"><b>: </b><span>n ≤ m</span></span></span><br><span><var>n0</var><span class="hyp-type"><b>: </b><span>m ≠ n</span></span></span><br><span><var>Hl</var><span class="hyp-type"><b>: </b><span>R (Str_nth n l) (Str_nth m l)</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">R (Str_nth n l) (Str_nth n l)</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><span class="alectryon-input"><span class="nb">transitivity</span> (Str_nth m l); <span class="bp">assumption</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Qed</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
</span><span class="alectryon-sentence"><input class="alectryon-toggle" id="StreamExtras-v-chk148" style="display: none" type="checkbox"><label class="alectryon-input" for="StreamExtras-v-chk148"><span class="kn">Lemma</span> <span class="nf">ForAll2_strict_lookup_inj</span>
 [A : <span class="kt">Type</span>] (R : A -&gt; A -&gt; <span class="kt">Prop</span>) {HR : StrictOrder R}
  (l : Stream A) (Hl : ForAll2 R l)
  : <span class="kr">forall</span> <span class="nv">m</span> <span class="nv">n</span>, Str_nth m l = Str_nth n l -&gt; m = n.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>A</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>R</var><span class="hyp-type"><b>: </b><span>A → A → <span class="kt">Prop</span></span></span></span><br><span><var>HR</var><span class="hyp-type"><b>: </b><span>StrictOrder R</span></span></span><br><span><var>l</var><span class="hyp-type"><b>: </b><span>Stream A</span></span></span><br><span><var>Hl</var><span class="hyp-type"><b>: </b><span>ForAll2 R l</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="kr">∀</span> <span class="nv">m</span> <span class="nv">n</span> : nat, Str_nth m l = Str_nth n l → m = n</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="StreamExtras-v-chk149" style="display: none" type="checkbox"><label class="alectryon-input" for="StreamExtras-v-chk149"><span class="kn">Proof</span>.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>A</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>R</var><span class="hyp-type"><b>: </b><span>A → A → <span class="kt">Prop</span></span></span></span><br><span><var>HR</var><span class="hyp-type"><b>: </b><span>StrictOrder R</span></span></span><br><span><var>l</var><span class="hyp-type"><b>: </b><span>Stream A</span></span></span><br><span><var>Hl</var><span class="hyp-type"><b>: </b><span>ForAll2 R l</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="kr">∀</span> <span class="nv">m</span> <span class="nv">n</span> : nat, Str_nth m l = Str_nth n l → m = n</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="StreamExtras-v-chk14a" style="display: none" type="checkbox"><label class="alectryon-input" for="StreamExtras-v-chk14a"><span class="nb">intros</span> m n Hmn.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>A</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>R</var><span class="hyp-type"><b>: </b><span>A → A → <span class="kt">Prop</span></span></span></span><br><span><var>HR</var><span class="hyp-type"><b>: </b><span>StrictOrder R</span></span></span><br><span><var>l</var><span class="hyp-type"><b>: </b><span>Stream A</span></span></span><br><span><var>Hl</var><span class="hyp-type"><b>: </b><span>ForAll2 R l</span></span></span><br><span><var>m, n</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>Hmn</var><span class="hyp-type"><b>: </b><span>Str_nth m l = Str_nth n l</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">m = n</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="StreamExtras-v-chk14b" style="display: none" type="checkbox"><label class="alectryon-input" for="StreamExtras-v-chk14b"><span class="nb">destruct</span> HR <span class="kr">as</span> [HI HT].</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>A</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>R</var><span class="hyp-type"><b>: </b><span>A → A → <span class="kt">Prop</span></span></span></span><br><span><var>HI</var><span class="hyp-type"><b>: </b><span>Irreflexive R</span></span></span><br><span><var>HT</var><span class="hyp-type"><b>: </b><span>Transitive R</span></span></span><br><span><var>l</var><span class="hyp-type"><b>: </b><span>Stream A</span></span></span><br><span><var>Hl</var><span class="hyp-type"><b>: </b><span>ForAll2 R l</span></span></span><br><span><var>m, n</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>Hmn</var><span class="hyp-type"><b>: </b><span>Str_nth m l = Str_nth n l</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">m = n</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="StreamExtras-v-chk14c" style="display: none" type="checkbox"><label class="alectryon-input" for="StreamExtras-v-chk14c"><span class="nb">rewrite</span> ForAll2_transitive_lookup <span class="kr">in</span> Hl <span class="bp">by</span> <span class="bp">assumption</span>.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>A</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>R</var><span class="hyp-type"><b>: </b><span>A → A → <span class="kt">Prop</span></span></span></span><br><span><var>HI</var><span class="hyp-type"><b>: </b><span>Irreflexive R</span></span></span><br><span><var>HT</var><span class="hyp-type"><b>: </b><span>Transitive R</span></span></span><br><span><var>l</var><span class="hyp-type"><b>: </b><span>Stream A</span></span></span><br><span><var>Hl</var><span class="hyp-type"><b>: </b><span><span class="kr">∀</span> <span class="nv">m</span> <span class="nv">n</span> : nat,
  m &lt; n → R (Str_nth m l) (Str_nth n l)</span></span></span><br><span><var>m, n</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>Hmn</var><span class="hyp-type"><b>: </b><span>Str_nth m l = Str_nth n l</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">m = n</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="StreamExtras-v-chk14d" style="display: none" type="checkbox"><label class="alectryon-input" for="StreamExtras-v-chk14d"><span class="nb">destruct</span> (decide (m = n)); [<span class="bp">assumption</span>|].</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>A</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>R</var><span class="hyp-type"><b>: </b><span>A → A → <span class="kt">Prop</span></span></span></span><br><span><var>HI</var><span class="hyp-type"><b>: </b><span>Irreflexive R</span></span></span><br><span><var>HT</var><span class="hyp-type"><b>: </b><span>Transitive R</span></span></span><br><span><var>l</var><span class="hyp-type"><b>: </b><span>Stream A</span></span></span><br><span><var>Hl</var><span class="hyp-type"><b>: </b><span><span class="kr">∀</span> <span class="nv">m</span> <span class="nv">n</span> : nat,
  m &lt; n → R (Str_nth m l) (Str_nth n l)</span></span></span><br><span><var>m, n</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>Hmn</var><span class="hyp-type"><b>: </b><span>Str_nth m l = Str_nth n l</span></span></span><br><span><var>n0</var><span class="hyp-type"><b>: </b><span>m ≠ n</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">m = n</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="StreamExtras-v-chk14e" style="display: none" type="checkbox"><label class="alectryon-input" for="StreamExtras-v-chk14e"><span class="nb">elim</span> (HI (Str_nth n l)).</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>A</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>R</var><span class="hyp-type"><b>: </b><span>A → A → <span class="kt">Prop</span></span></span></span><br><span><var>HI</var><span class="hyp-type"><b>: </b><span>Irreflexive R</span></span></span><br><span><var>HT</var><span class="hyp-type"><b>: </b><span>Transitive R</span></span></span><br><span><var>l</var><span class="hyp-type"><b>: </b><span>Stream A</span></span></span><br><span><var>Hl</var><span class="hyp-type"><b>: </b><span><span class="kr">∀</span> <span class="nv">m</span> <span class="nv">n</span> : nat,
  m &lt; n → R (Str_nth m l) (Str_nth n l)</span></span></span><br><span><var>m, n</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>Hmn</var><span class="hyp-type"><b>: </b><span>Str_nth m l = Str_nth n l</span></span></span><br><span><var>n0</var><span class="hyp-type"><b>: </b><span>m ≠ n</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">R (Str_nth n l) (Str_nth n l)</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><span class="alectryon-input"><span class="nb">destruct</span> (decide (m &lt; n))
  ; [spec Hl m n|spec Hl n m]; (spec Hl; [<span class="bp">lia</span>|])
  ; <span class="nb">rewrite</span> Hmn <span class="kr">in</span> Hl; <span class="bp">assumption</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Qed</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
</span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Definition</span> <span class="nf">stream_suffix</span>
  {<span class="nv">A</span> : <span class="kt">Type</span>}
  (<span class="nv">l</span> : Stream A)
  (<span class="nv">n</span> : nat)
  : Stream A
  := Str_nth_tl n l.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
</span><span class="alectryon-sentence"><input class="alectryon-toggle" id="StreamExtras-v-chk14f" style="display: none" type="checkbox"><label class="alectryon-input" for="StreamExtras-v-chk14f"><span class="kn">Lemma</span> <span class="nf">stream_suffix_S</span>
  {<span class="nv">A</span> : <span class="kt">Type</span>}
  (<span class="nv">l</span> : Stream A)
  (<span class="nv">n</span> : nat)
  : stream_suffix l n = Cons (Str_nth n l) (stream_suffix l (S n)).</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>A</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>l</var><span class="hyp-type"><b>: </b><span>Stream A</span></span></span><br><span><var>n</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">stream_suffix l n =
Cons (Str_nth n l) (stream_suffix l (S n))</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="StreamExtras-v-chk150" style="display: none" type="checkbox"><label class="alectryon-input" for="StreamExtras-v-chk150"><span class="kn">Proof</span>.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>A</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>l</var><span class="hyp-type"><b>: </b><span>Stream A</span></span></span><br><span><var>n</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">stream_suffix l n =
Cons (Str_nth n l) (stream_suffix l (S n))</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="StreamExtras-v-chk151" style="display: none" type="checkbox"><label class="alectryon-input" for="StreamExtras-v-chk151"><span class="nb">generalize dependent</span> l.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>A</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>n</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="kr">∀</span> <span class="nv">l</span> : Stream A,
  stream_suffix l n =
  Cons (Str_nth n l) (stream_suffix l (S n))</div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="StreamExtras-v-chk152" style="display: none" type="checkbox"><label class="alectryon-input" for="StreamExtras-v-chk152"><span class="nb">induction</span> n; <span class="nb">intros</span>.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>A</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>l</var><span class="hyp-type"><b>: </b><span>Stream A</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">stream_suffix l <span class="mi">0</span> =
Cons (Str_nth <span class="mi">0</span> l) (stream_suffix l <span class="mi">1</span>)</div></blockquote><div class="alectryon-extra-goals"><input class="alectryon-extra-goal-toggle" id="StreamExtras-v-chk153" style="display: none" type="checkbox"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>A</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>n</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>IHn</var><span class="hyp-type"><b>: </b><span><span class="kr">∀</span> <span class="nv">l</span> : Stream A,
stream_suffix l n = Cons (Str_nth n l) (stream_suffix l (S n))</span></span></span><br><span><var>l</var><span class="hyp-type"><b>: </b><span>Stream A</span></span></span><br></div><label class="goal-separator" for="StreamExtras-v-chk153"><hr></label><div class="goal-conclusion">stream_suffix l (S n) =
Cons (Str_nth (S n) l) (stream_suffix l (S (S n)))</div></blockquote></div></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="StreamExtras-v-chk154" style="display: none" type="checkbox"><label class="alectryon-input" for="StreamExtras-v-chk154">-</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>A</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>l</var><span class="hyp-type"><b>: </b><span>Stream A</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">stream_suffix l <span class="mi">0</span> =
Cons (Str_nth <span class="mi">0</span> l) (stream_suffix l <span class="mi">1</span>)</div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="nb">destruct</span> l; <span class="bp">reflexivity</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="StreamExtras-v-chk155" style="display: none" type="checkbox"><label class="alectryon-input" for="StreamExtras-v-chk155">-</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>A</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>n</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>IHn</var><span class="hyp-type"><b>: </b><span><span class="kr">∀</span> <span class="nv">l</span> : Stream A,
stream_suffix l n = Cons (Str_nth n l) (stream_suffix l (S n))</span></span></span><br><span><var>l</var><span class="hyp-type"><b>: </b><span>Stream A</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">stream_suffix l (S n) =
Cons (Str_nth (S n) l) (stream_suffix l (S (S n)))</div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="StreamExtras-v-chk156" style="display: none" type="checkbox"><label class="alectryon-input" for="StreamExtras-v-chk156"><span class="nb">specialize</span> (IHn (tl l)); <span class="nb">simpl</span> <span class="kr">in</span> IHn.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>A</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>n</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>l</var><span class="hyp-type"><b>: </b><span>Stream A</span></span></span><br><span><var>IHn</var><span class="hyp-type"><b>: </b><span>stream_suffix (tl l) n =
Cons (Str_nth n (tl l)) (stream_suffix (tl (tl l)) n)</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">stream_suffix l (S n) =
Cons (Str_nth (S n) l) (stream_suffix l (S (S n)))</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="StreamExtras-v-chk157" style="display: none" type="checkbox"><label class="alectryon-input" for="StreamExtras-v-chk157"><span class="nb">simpl</span>.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>A</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>n</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>l</var><span class="hyp-type"><b>: </b><span>Stream A</span></span></span><br><span><var>IHn</var><span class="hyp-type"><b>: </b><span>stream_suffix (tl l) n =
Cons (Str_nth n (tl l)) (stream_suffix (tl (tl l)) n)</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">stream_suffix (tl l) n =
Cons (Str_nth (S n) l) (stream_suffix (tl (tl l)) n)</div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="bp">assumption</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Qed</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
</span><span class="alectryon-sentence"><input class="alectryon-toggle" id="StreamExtras-v-chk158" style="display: none" type="checkbox"><label class="alectryon-input" for="StreamExtras-v-chk158"><span class="kn">Lemma</span> <span class="nf">stream_suffix_nth</span>
  {<span class="nv">A</span> : <span class="kt">Type</span>}
  (<span class="nv">s</span> : Stream A)
  (<span class="nv">n</span> : nat)
  (<span class="nv">i</span> : nat)
  : Str_nth i (stream_suffix s n) = Str_nth (i + n) s.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>A</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>s</var><span class="hyp-type"><b>: </b><span>Stream A</span></span></span><br><span><var>n, i</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">Str_nth i (stream_suffix s n) = Str_nth (i + n) s</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="StreamExtras-v-chk159" style="display: none" type="checkbox"><label class="alectryon-input" for="StreamExtras-v-chk159"><span class="kn">Proof</span>.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>A</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>s</var><span class="hyp-type"><b>: </b><span>Stream A</span></span></span><br><span><var>n, i</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">Str_nth i (stream_suffix s n) = Str_nth (i + n) s</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><span class="alectryon-input"><span class="nb">apply</span> Str_nth_plus.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Qed</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
</span><span class="alectryon-sentence"><input class="alectryon-toggle" id="StreamExtras-v-chk15a" style="display: none" type="checkbox"><label class="alectryon-input" for="StreamExtras-v-chk15a"><span class="kn">Lemma</span> <span class="nf">stream_prefix_suffix</span>
  {<span class="nv">A</span> : <span class="kt">Type</span>}
  (<span class="nv">l</span> : Stream A)
  (<span class="nv">n</span> : nat)
  : stream_app (stream_prefix l n) (stream_suffix l n) = l.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>A</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>l</var><span class="hyp-type"><b>: </b><span>Stream A</span></span></span><br><span><var>n</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">stream_app (stream_prefix l n) (stream_suffix l n) = l</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="StreamExtras-v-chk15b" style="display: none" type="checkbox"><label class="alectryon-input" for="StreamExtras-v-chk15b"><span class="kn">Proof</span>.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>A</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>l</var><span class="hyp-type"><b>: </b><span>Stream A</span></span></span><br><span><var>n</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">stream_app (stream_prefix l n) (stream_suffix l n) = l</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="StreamExtras-v-chk15c" style="display: none" type="checkbox"><label class="alectryon-input" for="StreamExtras-v-chk15c"><span class="nb">generalize dependent</span> l.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>A</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>n</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="kr">∀</span> <span class="nv">l</span> : Stream A,
  stream_app (stream_prefix l n) (stream_suffix l n) =
  l</div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="StreamExtras-v-chk15d" style="display: none" type="checkbox"><label class="alectryon-input" for="StreamExtras-v-chk15d"><span class="nb">unfold</span> stream_suffix.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>A</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>n</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="kr">∀</span> <span class="nv">l</span> : Stream A,
  stream_app (stream_prefix l n) (Str_nth_tl n l) = l</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="StreamExtras-v-chk15e" style="display: none" type="checkbox"><label class="alectryon-input" for="StreamExtras-v-chk15e"><span class="nb">induction</span> n; <span class="kp">try</span> <span class="bp">reflexivity</span>; <span class="nb">intros</span> [a l]; <span class="nb">simpl</span>.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>A</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>n</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>IHn</var><span class="hyp-type"><b>: </b><span><span class="kr">∀</span> <span class="nv">l</span> : Stream A, stream_app (stream_prefix l n) (Str_nth_tl n l) = l</span></span></span><br><span><var>a</var><span class="hyp-type"><b>: </b><span>A</span></span></span><br><span><var>l</var><span class="hyp-type"><b>: </b><span>Stream A</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">Cons a
  (stream_app (stream_prefix l n) (Str_nth_tl n l)) =
Cons a l</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="StreamExtras-v-chk15f" style="display: none" type="checkbox"><label class="alectryon-input" for="StreamExtras-v-chk15f"><span class="nb">f_equal</span>.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>A</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>n</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>IHn</var><span class="hyp-type"><b>: </b><span><span class="kr">∀</span> <span class="nv">l</span> : Stream A, stream_app (stream_prefix l n) (Str_nth_tl n l) = l</span></span></span><br><span><var>a</var><span class="hyp-type"><b>: </b><span>A</span></span></span><br><span><var>l</var><span class="hyp-type"><b>: </b><span>Stream A</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">stream_app (stream_prefix l n) (Str_nth_tl n l) = l</div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="nb">apply</span> IHn.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Qed</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
</span><span class="alectryon-sentence"><input class="alectryon-toggle" id="StreamExtras-v-chk160" style="display: none" type="checkbox"><label class="alectryon-input" for="StreamExtras-v-chk160"><span class="kn">Lemma</span> <span class="nf">stream_prefix_prefix</span>
  {<span class="nv">A</span> : <span class="kt">Type</span>}
  (<span class="nv">l</span> : Stream A)
  (<span class="nv">n1</span> <span class="nv">n2</span> : nat)
  (<span class="nv">Hn</span>: n1 &lt;= n2)
  : list_prefix (stream_prefix l n2) n1 = stream_prefix l n1.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>A</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>l</var><span class="hyp-type"><b>: </b><span>Stream A</span></span></span><br><span><var>n1, n2</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>Hn</var><span class="hyp-type"><b>: </b><span>n1 ≤ n2</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">list_prefix (stream_prefix l n2) n1 =
stream_prefix l n1</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="StreamExtras-v-chk161" style="display: none" type="checkbox"><label class="alectryon-input" for="StreamExtras-v-chk161"><span class="kn">Proof</span>.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>A</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>l</var><span class="hyp-type"><b>: </b><span>Stream A</span></span></span><br><span><var>n1, n2</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>Hn</var><span class="hyp-type"><b>: </b><span>n1 ≤ n2</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">list_prefix (stream_prefix l n2) n1 =
stream_prefix l n1</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="StreamExtras-v-chk162" style="display: none" type="checkbox"><label class="alectryon-input" for="StreamExtras-v-chk162"><span class="nb">generalize dependent</span> n2.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>A</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>l</var><span class="hyp-type"><b>: </b><span>Stream A</span></span></span><br><span><var>n1</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="kr">∀</span> <span class="nv">n2</span> : nat,
  n1 ≤ n2
  → list_prefix (stream_prefix l n2) n1 =
    stream_prefix l n1</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="StreamExtras-v-chk163" style="display: none" type="checkbox"><label class="alectryon-input" for="StreamExtras-v-chk163"><span class="nb">generalize dependent</span> l.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>A</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>n1</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="kr">∀</span> (<span class="nv">l</span> : Stream A) (<span class="nv">n2</span> : nat),
  n1 ≤ n2
  → list_prefix (stream_prefix l n2) n1 =
    stream_prefix l n1</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="StreamExtras-v-chk164" style="display: none" type="checkbox"><label class="alectryon-input" for="StreamExtras-v-chk164"><span class="nb">induction</span> n1; <span class="nb">intros</span> [a l]; <span class="nb">intros</span> [|n2] Hn; <span class="kp">try</span> <span class="bp">reflexivity</span>.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>A</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>n1</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>IHn1</var><span class="hyp-type"><b>: </b><span><span class="kr">∀</span> (<span class="nv">l</span> : Stream A) (<span class="nv">n2</span> : nat),
  n1 ≤ n2
  → list_prefix (stream_prefix l n2) n1 =
    stream_prefix l n1</span></span></span><br><span><var>a</var><span class="hyp-type"><b>: </b><span>A</span></span></span><br><span><var>l</var><span class="hyp-type"><b>: </b><span>Stream A</span></span></span><br><span><var>Hn</var><span class="hyp-type"><b>: </b><span>S n1 ≤ <span class="mi">0</span></span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">list_prefix (stream_prefix (Cons a l) <span class="mi">0</span>) (S n1) =
stream_prefix (Cons a l) (S n1)</div></blockquote><div class="alectryon-extra-goals"><input class="alectryon-extra-goal-toggle" id="StreamExtras-v-chk165" style="display: none" type="checkbox"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>A</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>n1</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>IHn1</var><span class="hyp-type"><b>: </b><span><span class="kr">∀</span> (<span class="nv">l</span> : Stream A) (<span class="nv">n2</span> : nat),
  n1 ≤ n2
  → list_prefix (stream_prefix l n2) n1 =
    stream_prefix l n1</span></span></span><br><span><var>a</var><span class="hyp-type"><b>: </b><span>A</span></span></span><br><span><var>l</var><span class="hyp-type"><b>: </b><span>Stream A</span></span></span><br><span><var>n2</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>Hn</var><span class="hyp-type"><b>: </b><span>S n1 ≤ S n2</span></span></span><br></div><label class="goal-separator" for="StreamExtras-v-chk165"><hr></label><div class="goal-conclusion">list_prefix (stream_prefix (Cons a l) (S n2)) (S n1) =
stream_prefix (Cons a l) (S n1)</div></blockquote></div></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="StreamExtras-v-chk166" style="display: none" type="checkbox"><label class="alectryon-input" for="StreamExtras-v-chk166">-</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>A</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>n1</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>IHn1</var><span class="hyp-type"><b>: </b><span><span class="kr">∀</span> (<span class="nv">l</span> : Stream A) (<span class="nv">n2</span> : nat),
  n1 ≤ n2
  → list_prefix (stream_prefix l n2) n1 =
    stream_prefix l n1</span></span></span><br><span><var>a</var><span class="hyp-type"><b>: </b><span>A</span></span></span><br><span><var>l</var><span class="hyp-type"><b>: </b><span>Stream A</span></span></span><br><span><var>Hn</var><span class="hyp-type"><b>: </b><span>S n1 ≤ <span class="mi">0</span></span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">list_prefix (stream_prefix (Cons a l) <span class="mi">0</span>) (S n1) =
stream_prefix (Cons a l) (S n1)</div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="nb">inversion</span> Hn.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="StreamExtras-v-chk167" style="display: none" type="checkbox"><label class="alectryon-input" for="StreamExtras-v-chk167">-</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>A</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>n1</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>IHn1</var><span class="hyp-type"><b>: </b><span><span class="kr">∀</span> (<span class="nv">l</span> : Stream A) (<span class="nv">n2</span> : nat),
  n1 ≤ n2
  → list_prefix (stream_prefix l n2) n1 =
    stream_prefix l n1</span></span></span><br><span><var>a</var><span class="hyp-type"><b>: </b><span>A</span></span></span><br><span><var>l</var><span class="hyp-type"><b>: </b><span>Stream A</span></span></span><br><span><var>n2</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>Hn</var><span class="hyp-type"><b>: </b><span>S n1 ≤ S n2</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">list_prefix (stream_prefix (Cons a l) (S n2)) (S n1) =
stream_prefix (Cons a l) (S n1)</div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="StreamExtras-v-chk168" style="display: none" type="checkbox"><label class="alectryon-input" for="StreamExtras-v-chk168"><span class="nb">simpl</span>.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>A</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>n1</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>IHn1</var><span class="hyp-type"><b>: </b><span><span class="kr">∀</span> (<span class="nv">l</span> : Stream A) (<span class="nv">n2</span> : nat),
  n1 ≤ n2
  → list_prefix (stream_prefix l n2) n1 =
    stream_prefix l n1</span></span></span><br><span><var>a</var><span class="hyp-type"><b>: </b><span>A</span></span></span><br><span><var>l</var><span class="hyp-type"><b>: </b><span>Stream A</span></span></span><br><span><var>n2</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>Hn</var><span class="hyp-type"><b>: </b><span>S n1 ≤ S n2</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">a :: list_prefix (stream_prefix l n2) n1 =
a :: stream_prefix l n1</div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="StreamExtras-v-chk169" style="display: none" type="checkbox"><label class="alectryon-input" for="StreamExtras-v-chk169"><span class="nb">f_equal</span>.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>A</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>n1</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>IHn1</var><span class="hyp-type"><b>: </b><span><span class="kr">∀</span> (<span class="nv">l</span> : Stream A) (<span class="nv">n2</span> : nat),
  n1 ≤ n2
  → list_prefix (stream_prefix l n2) n1 =
    stream_prefix l n1</span></span></span><br><span><var>a</var><span class="hyp-type"><b>: </b><span>A</span></span></span><br><span><var>l</var><span class="hyp-type"><b>: </b><span>Stream A</span></span></span><br><span><var>n2</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>Hn</var><span class="hyp-type"><b>: </b><span>S n1 ≤ S n2</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">list_prefix (stream_prefix l n2) n1 =
stream_prefix l n1</div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="StreamExtras-v-chk16a" style="display: none" type="checkbox"><label class="alectryon-input" for="StreamExtras-v-chk16a"><span class="nb">apply</span> IHn1.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>A</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>n1</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>IHn1</var><span class="hyp-type"><b>: </b><span><span class="kr">∀</span> (<span class="nv">l</span> : Stream A) (<span class="nv">n2</span> : nat),
  n1 ≤ n2
  → list_prefix (stream_prefix l n2) n1 =
    stream_prefix l n1</span></span></span><br><span><var>a</var><span class="hyp-type"><b>: </b><span>A</span></span></span><br><span><var>l</var><span class="hyp-type"><b>: </b><span>Stream A</span></span></span><br><span><var>n2</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>Hn</var><span class="hyp-type"><b>: </b><span>S n1 ≤ S n2</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">n1 ≤ n2</div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="bp">lia</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Qed</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
</span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Definition</span> <span class="nf">stream_segment</span>
  {<span class="nv">A</span> : <span class="kt">Type</span>}
  (<span class="nv">l</span> : Stream A)
  (<span class="nv">n1</span> <span class="nv">n2</span> : nat)
  : list A
  := list_suffix (stream_prefix l n2) n1.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
</span><span class="alectryon-sentence"><input class="alectryon-toggle" id="StreamExtras-v-chk16b" style="display: none" type="checkbox"><label class="alectryon-input" for="StreamExtras-v-chk16b"><span class="kn">Lemma</span> <span class="nf">stream_segment_nth</span>
  {<span class="nv">A</span> : <span class="kt">Type</span>}
  (<span class="nv">l</span> : Stream A)
  (<span class="nv">n1</span> <span class="nv">n2</span> : nat)
  (<span class="nv">Hn</span> : n1 &lt;= n2)
  (<span class="nv">i</span> : nat)
  (<span class="nv">Hi1</span> : n1 &lt;= i)
  (<span class="nv">Hi2</span> : i &lt; n2)
  : nth_error (stream_segment l n1 n2) (i - n1) = Some (Str_nth i l).</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>A</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>l</var><span class="hyp-type"><b>: </b><span>Stream A</span></span></span><br><span><var>n1, n2</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>Hn</var><span class="hyp-type"><b>: </b><span>n1 ≤ n2</span></span></span><br><span><var>i</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>Hi1</var><span class="hyp-type"><b>: </b><span>n1 ≤ i</span></span></span><br><span><var>Hi2</var><span class="hyp-type"><b>: </b><span>i &lt; n2</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">nth_error (stream_segment l n1 n2) (i - n1) =
Some (Str_nth i l)</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="StreamExtras-v-chk16c" style="display: none" type="checkbox"><label class="alectryon-input" for="StreamExtras-v-chk16c"><span class="kn">Proof</span>.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>A</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>l</var><span class="hyp-type"><b>: </b><span>Stream A</span></span></span><br><span><var>n1, n2</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>Hn</var><span class="hyp-type"><b>: </b><span>n1 ≤ n2</span></span></span><br><span><var>i</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>Hi1</var><span class="hyp-type"><b>: </b><span>n1 ≤ i</span></span></span><br><span><var>Hi2</var><span class="hyp-type"><b>: </b><span>i &lt; n2</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">nth_error (stream_segment l n1 n2) (i - n1) =
Some (Str_nth i l)</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="StreamExtras-v-chk16d" style="display: none" type="checkbox"><label class="alectryon-input" for="StreamExtras-v-chk16d"><span class="nb">unfold</span> stream_segment.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>A</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>l</var><span class="hyp-type"><b>: </b><span>Stream A</span></span></span><br><span><var>n1, n2</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>Hn</var><span class="hyp-type"><b>: </b><span>n1 ≤ n2</span></span></span><br><span><var>i</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>Hi1</var><span class="hyp-type"><b>: </b><span>n1 ≤ i</span></span></span><br><span><var>Hi2</var><span class="hyp-type"><b>: </b><span>i &lt; n2</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">nth_error (list_suffix (stream_prefix l n2) n1)
  (i - n1) = Some (Str_nth i l)</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="StreamExtras-v-chk16e" style="display: none" type="checkbox"><label class="alectryon-input" for="StreamExtras-v-chk16e"><span class="nb">rewrite</span> list_suffix_nth; <span class="kp">try</span> <span class="bp">assumption</span>.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>A</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>l</var><span class="hyp-type"><b>: </b><span>Stream A</span></span></span><br><span><var>n1, n2</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>Hn</var><span class="hyp-type"><b>: </b><span>n1 ≤ n2</span></span></span><br><span><var>i</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>Hi1</var><span class="hyp-type"><b>: </b><span>n1 ≤ i</span></span></span><br><span><var>Hi2</var><span class="hyp-type"><b>: </b><span>i &lt; n2</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">nth_error (stream_prefix l n2) i = Some (Str_nth i l)</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="StreamExtras-v-chk16f" style="display: none" type="checkbox"><label class="alectryon-input" for="StreamExtras-v-chk16f"><span class="nb">apply</span> stream_prefix_nth.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>A</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>l</var><span class="hyp-type"><b>: </b><span>Stream A</span></span></span><br><span><var>n1, n2</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>Hn</var><span class="hyp-type"><b>: </b><span>n1 ≤ n2</span></span></span><br><span><var>i</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>Hi1</var><span class="hyp-type"><b>: </b><span>n1 ≤ i</span></span></span><br><span><var>Hi2</var><span class="hyp-type"><b>: </b><span>i &lt; n2</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">i &lt; n2</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><span class="alectryon-input"><span class="bp">assumption</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Qed</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
</span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Definition</span> <span class="nf">stream_segment_alt</span>
  {<span class="nv">A</span> : <span class="kt">Type</span>}
  (<span class="nv">l</span> : Stream A)
  (<span class="nv">n1</span> <span class="nv">n2</span> : nat)
  : list A
  := stream_prefix (stream_suffix l n1) (n2 - n1).</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
</span><span class="alectryon-sentence"><input class="alectryon-toggle" id="StreamExtras-v-chk170" style="display: none" type="checkbox"><label class="alectryon-input" for="StreamExtras-v-chk170"><span class="kn">Lemma</span> <span class="nf">stream_segment_alt_iff</span>
  {<span class="nv">A</span> : <span class="kt">Type</span>}
  (<span class="nv">l</span> : Stream A)
  (<span class="nv">n1</span> <span class="nv">n2</span> : nat)
  : stream_segment l n1 n2 = stream_segment_alt l n1 n2.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>A</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>l</var><span class="hyp-type"><b>: </b><span>Stream A</span></span></span><br><span><var>n1, n2</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">stream_segment l n1 n2 = stream_segment_alt l n1 n2</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="StreamExtras-v-chk171" style="display: none" type="checkbox"><label class="alectryon-input" for="StreamExtras-v-chk171"><span class="kn">Proof</span>.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>A</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>l</var><span class="hyp-type"><b>: </b><span>Stream A</span></span></span><br><span><var>n1, n2</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">stream_segment l n1 n2 = stream_segment_alt l n1 n2</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="StreamExtras-v-chk172" style="display: none" type="checkbox"><label class="alectryon-input" for="StreamExtras-v-chk172"><span class="nb">apply</span> nth_error_eq.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>A</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>l</var><span class="hyp-type"><b>: </b><span>Stream A</span></span></span><br><span><var>n1, n2</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="kr">∀</span> <span class="nv">n</span> : nat,
  nth_error (stream_segment l n1 n2) n =
  nth_error (stream_segment_alt l n1 n2) n</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="StreamExtras-v-chk173" style="display: none" type="checkbox"><label class="alectryon-input" for="StreamExtras-v-chk173"><span class="nb">intro</span> k.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>A</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>l</var><span class="hyp-type"><b>: </b><span>Stream A</span></span></span><br><span><var>n1, n2, k</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">nth_error (stream_segment l n1 n2) k =
nth_error (stream_segment_alt l n1 n2) k</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="StreamExtras-v-chk174" style="display: none" type="checkbox"><label class="alectryon-input" for="StreamExtras-v-chk174"><span class="nb">unfold</span> stream_segment_alt.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>A</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>l</var><span class="hyp-type"><b>: </b><span>Stream A</span></span></span><br><span><var>n1, n2, k</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">nth_error (stream_segment l n1 n2) k =
nth_error
  (stream_prefix (stream_suffix l n1) (n2 - n1)) k</div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="StreamExtras-v-chk175" style="display: none" type="checkbox"><label class="alectryon-input" for="StreamExtras-v-chk175"><span class="nb">unfold</span> stream_segment.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>A</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>l</var><span class="hyp-type"><b>: </b><span>Stream A</span></span></span><br><span><var>n1, n2, k</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">nth_error (list_suffix (stream_prefix l n2) n1) k =
nth_error
  (stream_prefix (stream_suffix l n1) (n2 - n1)) k</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="StreamExtras-v-chk176" style="display: none" type="checkbox"><label class="alectryon-input" for="StreamExtras-v-chk176"><span class="nb">destruct</span> (decide (n2 - n1 &lt;= k)).</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>A</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>l</var><span class="hyp-type"><b>: </b><span>Stream A</span></span></span><br><span><var>n1, n2, k</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>l0</var><span class="hyp-type"><b>: </b><span>n2 - n1 ≤ k</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">nth_error (list_suffix (stream_prefix l n2) n1) k =
nth_error
  (stream_prefix (stream_suffix l n1) (n2 - n1)) k</div></blockquote><div class="alectryon-extra-goals"><input class="alectryon-extra-goal-toggle" id="StreamExtras-v-chk177" style="display: none" type="checkbox"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>A</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>l</var><span class="hyp-type"><b>: </b><span>Stream A</span></span></span><br><span><var>n1, n2, k</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>n</var><span class="hyp-type"><b>: </b><span>¬ n2 - n1 ≤ k</span></span></span><br></div><label class="goal-separator" for="StreamExtras-v-chk177"><hr></label><div class="goal-conclusion">nth_error (list_suffix (stream_prefix l n2) n1) k =
nth_error
  (stream_prefix (stream_suffix l n1) (n2 - n1)) k</div></blockquote></div></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="StreamExtras-v-chk178" style="display: none" type="checkbox"><label class="alectryon-input" for="StreamExtras-v-chk178">-</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>A</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>l</var><span class="hyp-type"><b>: </b><span>Stream A</span></span></span><br><span><var>n1, n2, k</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>l0</var><span class="hyp-type"><b>: </b><span>n2 - n1 ≤ k</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">nth_error (list_suffix (stream_prefix l n2) n1) k =
nth_error
  (stream_prefix (stream_suffix l n1) (n2 - n1)) k</div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="StreamExtras-v-chk179" style="display: none" type="checkbox"><label class="alectryon-input" for="StreamExtras-v-chk179"><span class="nb">specialize</span> (nth_error_None (list_suffix (stream_prefix l n2) n1) k); <span class="nb">intros</span> [_ H].</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>A</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>l</var><span class="hyp-type"><b>: </b><span>Stream A</span></span></span><br><span><var>n1, n2, k</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>l0</var><span class="hyp-type"><b>: </b><span>n2 - n1 ≤ k</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>length (list_suffix (stream_prefix l n2) n1) ≤ k
→ nth_error (list_suffix (stream_prefix l n2) n1)
    k = None</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">nth_error (list_suffix (stream_prefix l n2) n1) k =
nth_error
  (stream_prefix (stream_suffix l n1) (n2 - n1)) k</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="StreamExtras-v-chk17a" style="display: none" type="checkbox"><label class="alectryon-input" for="StreamExtras-v-chk17a"><span class="nb">specialize</span> (nth_error_None (stream_prefix (stream_suffix l n1) (n2 - n1)) k); <span class="nb">intros</span> [_ H_alt].</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>A</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>l</var><span class="hyp-type"><b>: </b><span>Stream A</span></span></span><br><span><var>n1, n2, k</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>l0</var><span class="hyp-type"><b>: </b><span>n2 - n1 ≤ k</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>length (list_suffix (stream_prefix l n2) n1) ≤ k
→ nth_error (list_suffix (stream_prefix l n2) n1)
    k = None</span></span></span><br><span><var>H_alt</var><span class="hyp-type"><b>: </b><span>length
  (stream_prefix (stream_suffix l n1)
     (n2 - n1)) ≤ k
→ nth_error
    (stream_prefix (stream_suffix l n1)
       (n2 - n1)) k = None</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">nth_error (list_suffix (stream_prefix l n2) n1) k =
nth_error
  (stream_prefix (stream_suffix l n1) (n2 - n1)) k</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="StreamExtras-v-chk17b" style="display: none" type="checkbox"><label class="alectryon-input" for="StreamExtras-v-chk17b"><span class="nb">rewrite</span> H, H_alt; <span class="kp">try</span> <span class="bp">reflexivity</span>.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>A</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>l</var><span class="hyp-type"><b>: </b><span>Stream A</span></span></span><br><span><var>n1, n2, k</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>l0</var><span class="hyp-type"><b>: </b><span>n2 - n1 ≤ k</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>length (list_suffix (stream_prefix l n2) n1) ≤ k
→ nth_error (list_suffix (stream_prefix l n2) n1)
    k = None</span></span></span><br><span><var>H_alt</var><span class="hyp-type"><b>: </b><span>length
  (stream_prefix (stream_suffix l n1)
     (n2 - n1)) ≤ k
→ nth_error
    (stream_prefix (stream_suffix l n1)
       (n2 - n1)) k = None</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">length (stream_prefix (stream_suffix l n1) (n2 - n1))
≤ k</div></blockquote><div class="alectryon-extra-goals"><input class="alectryon-extra-goal-toggle" id="StreamExtras-v-chk17c" style="display: none" type="checkbox"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>A</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>l</var><span class="hyp-type"><b>: </b><span>Stream A</span></span></span><br><span><var>n1, n2, k</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>l0</var><span class="hyp-type"><b>: </b><span>n2 - n1 ≤ k</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>length (list_suffix (stream_prefix l n2) n1) ≤ k
→ nth_error (list_suffix (stream_prefix l n2) n1)
    k = None</span></span></span><br><span><var>H_alt</var><span class="hyp-type"><b>: </b><span>length
  (stream_prefix (stream_suffix l n1)
     (n2 - n1)) ≤ k
→ nth_error
    (stream_prefix (stream_suffix l n1)
       (n2 - n1)) k = None</span></span></span><br></div><label class="goal-separator" for="StreamExtras-v-chk17c"><hr></label><div class="goal-conclusion">length (list_suffix (stream_prefix l n2) n1) ≤ k</div></blockquote></div></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="StreamExtras-v-chk17d" style="display: none" type="checkbox"><label class="alectryon-input" for="StreamExtras-v-chk17d">+</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>A</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>l</var><span class="hyp-type"><b>: </b><span>Stream A</span></span></span><br><span><var>n1, n2, k</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>l0</var><span class="hyp-type"><b>: </b><span>n2 - n1 ≤ k</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>length (list_suffix (stream_prefix l n2) n1) ≤ k
→ nth_error (list_suffix (stream_prefix l n2) n1)
    k = None</span></span></span><br><span><var>H_alt</var><span class="hyp-type"><b>: </b><span>length
  (stream_prefix (stream_suffix l n1)
     (n2 - n1)) ≤ k
→ nth_error
    (stream_prefix (stream_suffix l n1)
       (n2 - n1)) k = None</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">length (stream_prefix (stream_suffix l n1) (n2 - n1))
≤ k</div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="nb">rewrite</span> stream_prefix_length; <span class="bp">assumption</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="StreamExtras-v-chk17e" style="display: none" type="checkbox"><label class="alectryon-input" for="StreamExtras-v-chk17e">+</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>A</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>l</var><span class="hyp-type"><b>: </b><span>Stream A</span></span></span><br><span><var>n1, n2, k</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>l0</var><span class="hyp-type"><b>: </b><span>n2 - n1 ≤ k</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>length (list_suffix (stream_prefix l n2) n1) ≤ k
→ nth_error (list_suffix (stream_prefix l n2) n1)
    k = None</span></span></span><br><span><var>H_alt</var><span class="hyp-type"><b>: </b><span>length
  (stream_prefix (stream_suffix l n1)
     (n2 - n1)) ≤ k
→ nth_error
    (stream_prefix (stream_suffix l n1)
       (n2 - n1)) k = None</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">length (list_suffix (stream_prefix l n2) n1) ≤ k</div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="StreamExtras-v-chk17f" style="display: none" type="checkbox"><label class="alectryon-input" for="StreamExtras-v-chk17f"><span class="nb">rewrite</span> list_suffix_length.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>A</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>l</var><span class="hyp-type"><b>: </b><span>Stream A</span></span></span><br><span><var>n1, n2, k</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>l0</var><span class="hyp-type"><b>: </b><span>n2 - n1 ≤ k</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>length (list_suffix (stream_prefix l n2) n1) ≤ k
→ nth_error (list_suffix (stream_prefix l n2) n1)
    k = None</span></span></span><br><span><var>H_alt</var><span class="hyp-type"><b>: </b><span>length
  (stream_prefix (stream_suffix l n1)
     (n2 - n1)) ≤ k
→ nth_error
    (stream_prefix (stream_suffix l n1)
       (n2 - n1)) k = None</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">length (stream_prefix l n2) - n1 ≤ k</div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="StreamExtras-v-chk180" style="display: none" type="checkbox"><label class="alectryon-input" for="StreamExtras-v-chk180"><span class="nb">rewrite</span> stream_prefix_length.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>A</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>l</var><span class="hyp-type"><b>: </b><span>Stream A</span></span></span><br><span><var>n1, n2, k</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>l0</var><span class="hyp-type"><b>: </b><span>n2 - n1 ≤ k</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>length (list_suffix (stream_prefix l n2) n1) ≤ k
→ nth_error (list_suffix (stream_prefix l n2) n1)
    k = None</span></span></span><br><span><var>H_alt</var><span class="hyp-type"><b>: </b><span>length
  (stream_prefix (stream_suffix l n1)
     (n2 - n1)) ≤ k
→ nth_error
    (stream_prefix (stream_suffix l n1)
       (n2 - n1)) k = None</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">n2 - n1 ≤ k</div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="bp">assumption</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="StreamExtras-v-chk181" style="display: none" type="checkbox"><label class="alectryon-input" for="StreamExtras-v-chk181">-</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>A</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>l</var><span class="hyp-type"><b>: </b><span>Stream A</span></span></span><br><span><var>n1, n2, k</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>n</var><span class="hyp-type"><b>: </b><span>¬ n2 - n1 ≤ k</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">nth_error (list_suffix (stream_prefix l n2) n1) k =
nth_error
  (stream_prefix (stream_suffix l n1) (n2 - n1)) k</div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="StreamExtras-v-chk182" style="display: none" type="checkbox"><label class="alectryon-input" for="StreamExtras-v-chk182"><span class="nb">rewrite</span> stream_prefix_nth; <span class="kp">try</span> <span class="bp">assumption</span>.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>A</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>l</var><span class="hyp-type"><b>: </b><span>Stream A</span></span></span><br><span><var>n1, n2, k</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>n</var><span class="hyp-type"><b>: </b><span>¬ n2 - n1 ≤ k</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">nth_error (list_suffix (stream_prefix l n2) n1) k =
Some (Str_nth k (stream_suffix l n1))</div></blockquote><div class="alectryon-extra-goals"><input class="alectryon-extra-goal-toggle" id="StreamExtras-v-chk183" style="display: none" type="checkbox"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>A</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>l</var><span class="hyp-type"><b>: </b><span>Stream A</span></span></span><br><span><var>n1, n2, k</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>n</var><span class="hyp-type"><b>: </b><span>¬ n2 - n1 ≤ k</span></span></span><br></div><label class="goal-separator" for="StreamExtras-v-chk183"><hr></label><div class="goal-conclusion">k &lt; n2 - n1</div></blockquote></div></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="StreamExtras-v-chk184" style="display: none" type="checkbox"><label class="alectryon-input" for="StreamExtras-v-chk184"><span class="nb">rewrite</span> stream_suffix_nth.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>A</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>l</var><span class="hyp-type"><b>: </b><span>Stream A</span></span></span><br><span><var>n1, n2, k</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>n</var><span class="hyp-type"><b>: </b><span>¬ n2 - n1 ≤ k</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">nth_error (list_suffix (stream_prefix l n2) n1) k =
Some (Str_nth (k + n1) l)</div></blockquote><div class="alectryon-extra-goals"><input class="alectryon-extra-goal-toggle" id="StreamExtras-v-chk185" style="display: none" type="checkbox"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>A</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>l</var><span class="hyp-type"><b>: </b><span>Stream A</span></span></span><br><span><var>n1, n2, k</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>n</var><span class="hyp-type"><b>: </b><span>¬ n2 - n1 ≤ k</span></span></span><br></div><label class="goal-separator" for="StreamExtras-v-chk185"><hr></label><div class="goal-conclusion">k &lt; n2 - n1</div></blockquote></div></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="StreamExtras-v-chk186" style="display: none" type="checkbox"><label class="alectryon-input" for="StreamExtras-v-chk186"><span class="nb">assert</span> (Hle : n1 &lt;= n1 + k) <span class="bp">by</span> <span class="bp">lia</span>.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>A</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>l</var><span class="hyp-type"><b>: </b><span>Stream A</span></span></span><br><span><var>n1, n2, k</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>n</var><span class="hyp-type"><b>: </b><span>¬ n2 - n1 ≤ k</span></span></span><br><span><var>Hle</var><span class="hyp-type"><b>: </b><span>n1 ≤ n1 + k</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">nth_error (list_suffix (stream_prefix l n2) n1) k =
Some (Str_nth (k + n1) l)</div></blockquote><div class="alectryon-extra-goals"><input class="alectryon-extra-goal-toggle" id="StreamExtras-v-chk187" style="display: none" type="checkbox"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>A</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>l</var><span class="hyp-type"><b>: </b><span>Stream A</span></span></span><br><span><var>n1, n2, k</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>n</var><span class="hyp-type"><b>: </b><span>¬ n2 - n1 ≤ k</span></span></span><br></div><label class="goal-separator" for="StreamExtras-v-chk187"><hr></label><div class="goal-conclusion">k &lt; n2 - n1</div></blockquote></div></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="StreamExtras-v-chk188" style="display: none" type="checkbox"><label class="alectryon-input" for="StreamExtras-v-chk188"><span class="nb">specialize</span> (list_suffix_nth (stream_prefix l n2) n1 (n1 + k) Hle)
    ; <span class="nb">intro</span> Heq.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>A</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>l</var><span class="hyp-type"><b>: </b><span>Stream A</span></span></span><br><span><var>n1, n2, k</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>n</var><span class="hyp-type"><b>: </b><span>¬ n2 - n1 ≤ k</span></span></span><br><span><var>Hle</var><span class="hyp-type"><b>: </b><span>n1 ≤ n1 + k</span></span></span><br><span><var>Heq</var><span class="hyp-type"><b>: </b><span>nth_error (list_suffix (stream_prefix l n2) n1) (n1 + k - n1) =
nth_error (stream_prefix l n2) (n1 + k)</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">nth_error (list_suffix (stream_prefix l n2) n1) k =
Some (Str_nth (k + n1) l)</div></blockquote><div class="alectryon-extra-goals"><input class="alectryon-extra-goal-toggle" id="StreamExtras-v-chk189" style="display: none" type="checkbox"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>A</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>l</var><span class="hyp-type"><b>: </b><span>Stream A</span></span></span><br><span><var>n1, n2, k</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>n</var><span class="hyp-type"><b>: </b><span>¬ n2 - n1 ≤ k</span></span></span><br></div><label class="goal-separator" for="StreamExtras-v-chk189"><hr></label><div class="goal-conclusion">k &lt; n2 - n1</div></blockquote></div></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="StreamExtras-v-chk18a" style="display: none" type="checkbox"><label class="alectryon-input" for="StreamExtras-v-chk18a"><span class="nb">clear</span> Hle.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>A</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>l</var><span class="hyp-type"><b>: </b><span>Stream A</span></span></span><br><span><var>n1, n2, k</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>n</var><span class="hyp-type"><b>: </b><span>¬ n2 - n1 ≤ k</span></span></span><br><span><var>Heq</var><span class="hyp-type"><b>: </b><span>nth_error (list_suffix (stream_prefix l n2) n1) (n1 + k - n1) =
nth_error (stream_prefix l n2) (n1 + k)</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">nth_error (list_suffix (stream_prefix l n2) n1) k =
Some (Str_nth (k + n1) l)</div></blockquote><div class="alectryon-extra-goals"><input class="alectryon-extra-goal-toggle" id="StreamExtras-v-chk18b" style="display: none" type="checkbox"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>A</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>l</var><span class="hyp-type"><b>: </b><span>Stream A</span></span></span><br><span><var>n1, n2, k</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>n</var><span class="hyp-type"><b>: </b><span>¬ n2 - n1 ≤ k</span></span></span><br></div><label class="goal-separator" for="StreamExtras-v-chk18b"><hr></label><div class="goal-conclusion">k &lt; n2 - n1</div></blockquote></div></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="StreamExtras-v-chk18c" style="display: none" type="checkbox"><label class="alectryon-input" for="StreamExtras-v-chk18c"><span class="nb">assert</span> (Hs: n1 + k - n1 = k) <span class="bp">by</span> <span class="bp">lia</span>.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>A</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>l</var><span class="hyp-type"><b>: </b><span>Stream A</span></span></span><br><span><var>n1, n2, k</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>n</var><span class="hyp-type"><b>: </b><span>¬ n2 - n1 ≤ k</span></span></span><br><span><var>Heq</var><span class="hyp-type"><b>: </b><span>nth_error (list_suffix (stream_prefix l n2) n1) (n1 + k - n1) =
nth_error (stream_prefix l n2) (n1 + k)</span></span></span><br><span><var>Hs</var><span class="hyp-type"><b>: </b><span>n1 + k - n1 = k</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">nth_error (list_suffix (stream_prefix l n2) n1) k =
Some (Str_nth (k + n1) l)</div></blockquote><div class="alectryon-extra-goals"><input class="alectryon-extra-goal-toggle" id="StreamExtras-v-chk18d" style="display: none" type="checkbox"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>A</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>l</var><span class="hyp-type"><b>: </b><span>Stream A</span></span></span><br><span><var>n1, n2, k</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>n</var><span class="hyp-type"><b>: </b><span>¬ n2 - n1 ≤ k</span></span></span><br></div><label class="goal-separator" for="StreamExtras-v-chk18d"><hr></label><div class="goal-conclusion">k &lt; n2 - n1</div></blockquote></div></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="StreamExtras-v-chk18e" style="display: none" type="checkbox"><label class="alectryon-input" for="StreamExtras-v-chk18e"><span class="nb">rewrite</span> Hs <span class="kr">in</span> Heq.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>A</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>l</var><span class="hyp-type"><b>: </b><span>Stream A</span></span></span><br><span><var>n1, n2, k</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>n</var><span class="hyp-type"><b>: </b><span>¬ n2 - n1 ≤ k</span></span></span><br><span><var>Heq</var><span class="hyp-type"><b>: </b><span>nth_error (list_suffix (stream_prefix l n2) n1) k =
nth_error (stream_prefix l n2) (n1 + k)</span></span></span><br><span><var>Hs</var><span class="hyp-type"><b>: </b><span>n1 + k - n1 = k</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">nth_error (list_suffix (stream_prefix l n2) n1) k =
Some (Str_nth (k + n1) l)</div></blockquote><div class="alectryon-extra-goals"><input class="alectryon-extra-goal-toggle" id="StreamExtras-v-chk18f" style="display: none" type="checkbox"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>A</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>l</var><span class="hyp-type"><b>: </b><span>Stream A</span></span></span><br><span><var>n1, n2, k</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>n</var><span class="hyp-type"><b>: </b><span>¬ n2 - n1 ≤ k</span></span></span><br></div><label class="goal-separator" for="StreamExtras-v-chk18f"><hr></label><div class="goal-conclusion">k &lt; n2 - n1</div></blockquote></div></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="StreamExtras-v-chk190" style="display: none" type="checkbox"><label class="alectryon-input" for="StreamExtras-v-chk190"><span class="nb">rewrite</span> Heq.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>A</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>l</var><span class="hyp-type"><b>: </b><span>Stream A</span></span></span><br><span><var>n1, n2, k</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>n</var><span class="hyp-type"><b>: </b><span>¬ n2 - n1 ≤ k</span></span></span><br><span><var>Heq</var><span class="hyp-type"><b>: </b><span>nth_error (list_suffix (stream_prefix l n2) n1) k =
nth_error (stream_prefix l n2) (n1 + k)</span></span></span><br><span><var>Hs</var><span class="hyp-type"><b>: </b><span>n1 + k - n1 = k</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">nth_error (stream_prefix l n2) (n1 + k) =
Some (Str_nth (k + n1) l)</div></blockquote><div class="alectryon-extra-goals"><input class="alectryon-extra-goal-toggle" id="StreamExtras-v-chk191" style="display: none" type="checkbox"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>A</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>l</var><span class="hyp-type"><b>: </b><span>Stream A</span></span></span><br><span><var>n1, n2, k</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>n</var><span class="hyp-type"><b>: </b><span>¬ n2 - n1 ≤ k</span></span></span><br></div><label class="goal-separator" for="StreamExtras-v-chk191"><hr></label><div class="goal-conclusion">k &lt; n2 - n1</div></blockquote></div></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="StreamExtras-v-chk192" style="display: none" type="checkbox"><label class="alectryon-input" for="StreamExtras-v-chk192"><span class="nb">rewrite</span> stream_prefix_nth.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>A</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>l</var><span class="hyp-type"><b>: </b><span>Stream A</span></span></span><br><span><var>n1, n2, k</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>n</var><span class="hyp-type"><b>: </b><span>¬ n2 - n1 ≤ k</span></span></span><br><span><var>Heq</var><span class="hyp-type"><b>: </b><span>nth_error (list_suffix (stream_prefix l n2) n1) k =
nth_error (stream_prefix l n2) (n1 + k)</span></span></span><br><span><var>Hs</var><span class="hyp-type"><b>: </b><span>n1 + k - n1 = k</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">Some (Str_nth (n1 + k) l) = Some (Str_nth (k + n1) l)</div></blockquote><div class="alectryon-extra-goals"><input class="alectryon-extra-goal-toggle" id="StreamExtras-v-chk193" style="display: none" type="checkbox"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>A</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>l</var><span class="hyp-type"><b>: </b><span>Stream A</span></span></span><br><span><var>n1, n2, k</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>n</var><span class="hyp-type"><b>: </b><span>¬ n2 - n1 ≤ k</span></span></span><br><span><var>Heq</var><span class="hyp-type"><b>: </b><span>nth_error (list_suffix (stream_prefix l n2) n1) k =
nth_error (stream_prefix l n2) (n1 + k)</span></span></span><br><span><var>Hs</var><span class="hyp-type"><b>: </b><span>n1 + k - n1 = k</span></span></span><br></div><label class="goal-separator" for="StreamExtras-v-chk193"><hr></label><div class="goal-conclusion">n1 + k &lt; n2</div></blockquote><input class="alectryon-extra-goal-toggle" id="StreamExtras-v-chk194" style="display: none" type="checkbox"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>A</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>l</var><span class="hyp-type"><b>: </b><span>Stream A</span></span></span><br><span><var>n1, n2, k</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>n</var><span class="hyp-type"><b>: </b><span>¬ n2 - n1 ≤ k</span></span></span><br></div><label class="goal-separator" for="StreamExtras-v-chk194"><hr></label><div class="goal-conclusion">k &lt; n2 - n1</div></blockquote></div></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="StreamExtras-v-chk195" style="display: none" type="checkbox"><label class="alectryon-input" for="StreamExtras-v-chk195">+</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>A</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>l</var><span class="hyp-type"><b>: </b><span>Stream A</span></span></span><br><span><var>n1, n2, k</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>n</var><span class="hyp-type"><b>: </b><span>¬ n2 - n1 ≤ k</span></span></span><br><span><var>Heq</var><span class="hyp-type"><b>: </b><span>nth_error (list_suffix (stream_prefix l n2) n1) k =
nth_error (stream_prefix l n2) (n1 + k)</span></span></span><br><span><var>Hs</var><span class="hyp-type"><b>: </b><span>n1 + k - n1 = k</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">Some (Str_nth (n1 + k) l) = Some (Str_nth (k + n1) l)</div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="nb">rewrite</span> Plus.plus_comm; <span class="bp">reflexivity</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="StreamExtras-v-chk196" style="display: none" type="checkbox"><label class="alectryon-input" for="StreamExtras-v-chk196">+</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>A</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>l</var><span class="hyp-type"><b>: </b><span>Stream A</span></span></span><br><span><var>n1, n2, k</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>n</var><span class="hyp-type"><b>: </b><span>¬ n2 - n1 ≤ k</span></span></span><br><span><var>Heq</var><span class="hyp-type"><b>: </b><span>nth_error (list_suffix (stream_prefix l n2) n1) k =
nth_error (stream_prefix l n2) (n1 + k)</span></span></span><br><span><var>Hs</var><span class="hyp-type"><b>: </b><span>n1 + k - n1 = k</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">n1 + k &lt; n2</div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="bp">lia</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="StreamExtras-v-chk197" style="display: none" type="checkbox"><label class="alectryon-input" for="StreamExtras-v-chk197">+</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>A</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>l</var><span class="hyp-type"><b>: </b><span>Stream A</span></span></span><br><span><var>n1, n2, k</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>n</var><span class="hyp-type"><b>: </b><span>¬ n2 - n1 ≤ k</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">k &lt; n2 - n1</div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="bp">lia</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Qed</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
</span><span class="alectryon-sentence"><input class="alectryon-toggle" id="StreamExtras-v-chk198" style="display: none" type="checkbox"><label class="alectryon-input" for="StreamExtras-v-chk198"><span class="kn">Lemma</span> <span class="nf">stream_prefix_segment</span>
  {<span class="nv">A</span> : <span class="kt">Type</span>}
  (<span class="nv">l</span> : Stream A)
  (<span class="nv">n1</span> <span class="nv">n2</span> : nat)
  (<span class="nv">Hn</span> : n1 &lt;= n2)
  : stream_prefix l n1 ++ stream_segment l n1 n2 = stream_prefix l n2.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>A</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>l</var><span class="hyp-type"><b>: </b><span>Stream A</span></span></span><br><span><var>n1, n2</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>Hn</var><span class="hyp-type"><b>: </b><span>n1 ≤ n2</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">stream_prefix l n1 ++ stream_segment l n1 n2 =
stream_prefix l n2</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="StreamExtras-v-chk199" style="display: none" type="checkbox"><label class="alectryon-input" for="StreamExtras-v-chk199"><span class="kn">Proof</span>.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>A</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>l</var><span class="hyp-type"><b>: </b><span>Stream A</span></span></span><br><span><var>n1, n2</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>Hn</var><span class="hyp-type"><b>: </b><span>n1 ≤ n2</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">stream_prefix l n1 ++ stream_segment l n1 n2 =
stream_prefix l n2</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="StreamExtras-v-chk19a" style="display: none" type="checkbox"><label class="alectryon-input" for="StreamExtras-v-chk19a"><span class="nb">unfold</span> stream_segment.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>A</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>l</var><span class="hyp-type"><b>: </b><span>Stream A</span></span></span><br><span><var>n1, n2</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>Hn</var><span class="hyp-type"><b>: </b><span>n1 ≤ n2</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">stream_prefix l n1 ++
list_suffix (stream_prefix l n2) n1 =
stream_prefix l n2</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="StreamExtras-v-chk19b" style="display: none" type="checkbox"><label class="alectryon-input" for="StreamExtras-v-chk19b"><span class="nb">rewrite</span> &lt;- (list_prefix_suffix (stream_prefix l n2) n1) <span class="nb">at</span> <span class="mi">2</span>.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>A</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>l</var><span class="hyp-type"><b>: </b><span>Stream A</span></span></span><br><span><var>n1, n2</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>Hn</var><span class="hyp-type"><b>: </b><span>n1 ≤ n2</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">stream_prefix l n1 ++
list_suffix (stream_prefix l n2) n1 =
list_prefix (stream_prefix l n2) n1 ++
list_suffix (stream_prefix l n2) n1</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="StreamExtras-v-chk19c" style="display: none" type="checkbox"><label class="alectryon-input" for="StreamExtras-v-chk19c"><span class="nb">f_equal</span>.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>A</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>l</var><span class="hyp-type"><b>: </b><span>Stream A</span></span></span><br><span><var>n1, n2</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>Hn</var><span class="hyp-type"><b>: </b><span>n1 ≤ n2</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">stream_prefix l n1 =
list_prefix (stream_prefix l n2) n1</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="StreamExtras-v-chk19d" style="display: none" type="checkbox"><label class="alectryon-input" for="StreamExtras-v-chk19d"><span class="nb">symmetry</span>.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>A</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>l</var><span class="hyp-type"><b>: </b><span>Stream A</span></span></span><br><span><var>n1, n2</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>Hn</var><span class="hyp-type"><b>: </b><span>n1 ≤ n2</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">list_prefix (stream_prefix l n2) n1 =
stream_prefix l n1</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="StreamExtras-v-chk19e" style="display: none" type="checkbox"><label class="alectryon-input" for="StreamExtras-v-chk19e"><span class="nb">apply</span> stream_prefix_prefix.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>A</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>l</var><span class="hyp-type"><b>: </b><span>Stream A</span></span></span><br><span><var>n1, n2</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>Hn</var><span class="hyp-type"><b>: </b><span>n1 ≤ n2</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">n1 ≤ n2</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><span class="alectryon-input"><span class="bp">assumption</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Qed</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
</span><span class="alectryon-sentence"><input class="alectryon-toggle" id="StreamExtras-v-chk19f" style="display: none" type="checkbox"><label class="alectryon-input" for="StreamExtras-v-chk19f"><span class="kn">Lemma</span> <span class="nf">stream_prefix_segment_suffix</span>
  {<span class="nv">A</span> : <span class="kt">Type</span>}
  (<span class="nv">l</span> : Stream A)
  (<span class="nv">n1</span> <span class="nv">n2</span> : nat)
  (<span class="nv">Hn</span> : n1 &lt;= n2)
  : stream_app
      ((stream_prefix l n1)
        ++
       (stream_segment l n1 n2)
      )
      (stream_suffix l n2)
  = l.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>A</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>l</var><span class="hyp-type"><b>: </b><span>Stream A</span></span></span><br><span><var>n1, n2</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>Hn</var><span class="hyp-type"><b>: </b><span>n1 ≤ n2</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">stream_app
  (stream_prefix l n1 ++ stream_segment l n1 n2)
  (stream_suffix l n2) = l</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="StreamExtras-v-chk1a0" style="display: none" type="checkbox"><label class="alectryon-input" for="StreamExtras-v-chk1a0"><span class="kn">Proof</span>.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>A</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>l</var><span class="hyp-type"><b>: </b><span>Stream A</span></span></span><br><span><var>n1, n2</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>Hn</var><span class="hyp-type"><b>: </b><span>n1 ≤ n2</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">stream_app
  (stream_prefix l n1 ++ stream_segment l n1 n2)
  (stream_suffix l n2) = l</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="StreamExtras-v-chk1a1" style="display: none" type="checkbox"><label class="alectryon-input" for="StreamExtras-v-chk1a1"><span class="nb">rewrite</span> &lt;- (stream_prefix_suffix l n2) <span class="nb">at</span> <span class="mi">4</span>.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>A</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>l</var><span class="hyp-type"><b>: </b><span>Stream A</span></span></span><br><span><var>n1, n2</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>Hn</var><span class="hyp-type"><b>: </b><span>n1 ≤ n2</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">stream_app
  (stream_prefix l n1 ++ stream_segment l n1 n2)
  (stream_suffix l n2) =
stream_app (stream_prefix l n2) (stream_suffix l n2)</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="StreamExtras-v-chk1a2" style="display: none" type="checkbox"><label class="alectryon-input" for="StreamExtras-v-chk1a2"><span class="nb">f_equal</span>.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>A</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>l</var><span class="hyp-type"><b>: </b><span>Stream A</span></span></span><br><span><var>n1, n2</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>Hn</var><span class="hyp-type"><b>: </b><span>n1 ≤ n2</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">stream_prefix l n1 ++ stream_segment l n1 n2 =
stream_prefix l n2</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="StreamExtras-v-chk1a3" style="display: none" type="checkbox"><label class="alectryon-input" for="StreamExtras-v-chk1a3"><span class="nb">apply</span> stream_prefix_segment.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>A</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>l</var><span class="hyp-type"><b>: </b><span>Stream A</span></span></span><br><span><var>n1, n2</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>Hn</var><span class="hyp-type"><b>: </b><span>n1 ≤ n2</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">n1 ≤ n2</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><span class="alectryon-input"><span class="bp">assumption</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Qed</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
</span><span class="alectryon-sentence"><input class="alectryon-toggle" id="StreamExtras-v-chk1a4" style="display: none" type="checkbox"><label class="alectryon-input" for="StreamExtras-v-chk1a4"><span class="kn">Lemma</span> <span class="nf">stream_segment_app</span>
  {<span class="nv">A</span> : <span class="kt">Type</span>}
  (<span class="nv">l</span> : Stream A)
  (<span class="nv">n1</span> <span class="nv">n2</span> <span class="nv">n3</span> : nat)
  (<span class="nv">H12</span> : n1 &lt;= n2)
  (<span class="nv">H23</span> : n2 &lt;= n3)
  : stream_segment l n1 n2 ++ stream_segment l n2 n3 = stream_segment l n1 n3.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>A</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>l</var><span class="hyp-type"><b>: </b><span>Stream A</span></span></span><br><span><var>n1, n2, n3</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>H12</var><span class="hyp-type"><b>: </b><span>n1 ≤ n2</span></span></span><br><span><var>H23</var><span class="hyp-type"><b>: </b><span>n2 ≤ n3</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">stream_segment l n1 n2 ++ stream_segment l n2 n3 =
stream_segment l n1 n3</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="StreamExtras-v-chk1a5" style="display: none" type="checkbox"><label class="alectryon-input" for="StreamExtras-v-chk1a5"><span class="kn">Proof</span>.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>A</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>l</var><span class="hyp-type"><b>: </b><span>Stream A</span></span></span><br><span><var>n1, n2, n3</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>H12</var><span class="hyp-type"><b>: </b><span>n1 ≤ n2</span></span></span><br><span><var>H23</var><span class="hyp-type"><b>: </b><span>n2 ≤ n3</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">stream_segment l n1 n2 ++ stream_segment l n2 n3 =
stream_segment l n1 n3</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="StreamExtras-v-chk1a6" style="display: none" type="checkbox"><label class="alectryon-input" for="StreamExtras-v-chk1a6"><span class="nb">assert</span> (Hle : n1 &lt;= n3) <span class="bp">by</span> <span class="bp">lia</span>.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>A</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>l</var><span class="hyp-type"><b>: </b><span>Stream A</span></span></span><br><span><var>n1, n2, n3</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>H12</var><span class="hyp-type"><b>: </b><span>n1 ≤ n2</span></span></span><br><span><var>H23</var><span class="hyp-type"><b>: </b><span>n2 ≤ n3</span></span></span><br><span><var>Hle</var><span class="hyp-type"><b>: </b><span>n1 ≤ n3</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">stream_segment l n1 n2 ++ stream_segment l n2 n3 =
stream_segment l n1 n3</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="StreamExtras-v-chk1a7" style="display: none" type="checkbox"><label class="alectryon-input" for="StreamExtras-v-chk1a7"><span class="nb">specialize</span> (stream_prefix_segment_suffix l n1 n3 Hle); <span class="nb">intro</span> Hl1.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>A</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>l</var><span class="hyp-type"><b>: </b><span>Stream A</span></span></span><br><span><var>n1, n2, n3</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>H12</var><span class="hyp-type"><b>: </b><span>n1 ≤ n2</span></span></span><br><span><var>H23</var><span class="hyp-type"><b>: </b><span>n2 ≤ n3</span></span></span><br><span><var>Hle</var><span class="hyp-type"><b>: </b><span>n1 ≤ n3</span></span></span><br><span><var>Hl1</var><span class="hyp-type"><b>: </b><span>stream_app (stream_prefix l n1 ++ stream_segment l n1 n3)
(stream_suffix l n3) = l</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">stream_segment l n1 n2 ++ stream_segment l n2 n3 =
stream_segment l n1 n3</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="StreamExtras-v-chk1a8" style="display: none" type="checkbox"><label class="alectryon-input" for="StreamExtras-v-chk1a8"><span class="nb">specialize</span> (stream_prefix_segment_suffix l n2 n3 H23); <span class="nb">intro</span> Hl2.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>A</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>l</var><span class="hyp-type"><b>: </b><span>Stream A</span></span></span><br><span><var>n1, n2, n3</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>H12</var><span class="hyp-type"><b>: </b><span>n1 ≤ n2</span></span></span><br><span><var>H23</var><span class="hyp-type"><b>: </b><span>n2 ≤ n3</span></span></span><br><span><var>Hle</var><span class="hyp-type"><b>: </b><span>n1 ≤ n3</span></span></span><br><span><var>Hl1</var><span class="hyp-type"><b>: </b><span>stream_app (stream_prefix l n1 ++ stream_segment l n1 n3)
(stream_suffix l n3) = l</span></span></span><br><span><var>Hl2</var><span class="hyp-type"><b>: </b><span>stream_app (stream_prefix l n2 ++ stream_segment l n2 n3)
(stream_suffix l n3) = l</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">stream_segment l n1 n2 ++ stream_segment l n2 n3 =
stream_segment l n1 n3</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="StreamExtras-v-chk1a9" style="display: none" type="checkbox"><label class="alectryon-input" for="StreamExtras-v-chk1a9"><span class="nb">rewrite</span> &lt;- Hl2 <span class="kr">in</span> Hl1 <span class="nb">at</span> <span class="mi">4</span>.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>A</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>l</var><span class="hyp-type"><b>: </b><span>Stream A</span></span></span><br><span><var>n1, n2, n3</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>H12</var><span class="hyp-type"><b>: </b><span>n1 ≤ n2</span></span></span><br><span><var>H23</var><span class="hyp-type"><b>: </b><span>n2 ≤ n3</span></span></span><br><span><var>Hle</var><span class="hyp-type"><b>: </b><span>n1 ≤ n3</span></span></span><br><span><var>Hl1</var><span class="hyp-type"><b>: </b><span>stream_app (stream_prefix l n1 ++ stream_segment l n1 n3)
(stream_suffix l n3) =
stream_app (stream_prefix l n2 ++ stream_segment l n2 n3)
(stream_suffix l n3)</span></span></span><br><span><var>Hl2</var><span class="hyp-type"><b>: </b><span>stream_app (stream_prefix l n2 ++ stream_segment l n2 n3)
(stream_suffix l n3) = l</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">stream_segment l n1 n2 ++ stream_segment l n2 n3 =
stream_segment l n1 n3</div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="StreamExtras-v-chk1aa" style="display: none" type="checkbox"><label class="alectryon-input" for="StreamExtras-v-chk1aa"><span class="nb">clear</span> Hl2.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>A</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>l</var><span class="hyp-type"><b>: </b><span>Stream A</span></span></span><br><span><var>n1, n2, n3</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>H12</var><span class="hyp-type"><b>: </b><span>n1 ≤ n2</span></span></span><br><span><var>H23</var><span class="hyp-type"><b>: </b><span>n2 ≤ n3</span></span></span><br><span><var>Hle</var><span class="hyp-type"><b>: </b><span>n1 ≤ n3</span></span></span><br><span><var>Hl1</var><span class="hyp-type"><b>: </b><span>stream_app (stream_prefix l n1 ++ stream_segment l n1 n3)
(stream_suffix l n3) =
stream_app (stream_prefix l n2 ++ stream_segment l n2 n3)
(stream_suffix l n3)</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">stream_segment l n1 n2 ++ stream_segment l n2 n3 =
stream_segment l n1 n3</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="StreamExtras-v-chk1ab" style="display: none" type="checkbox"><label class="alectryon-input" for="StreamExtras-v-chk1ab"><span class="nb">apply</span> stream_app_inj_l <span class="kr">in</span> Hl1.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>A</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>l</var><span class="hyp-type"><b>: </b><span>Stream A</span></span></span><br><span><var>n1, n2, n3</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>H12</var><span class="hyp-type"><b>: </b><span>n1 ≤ n2</span></span></span><br><span><var>H23</var><span class="hyp-type"><b>: </b><span>n2 ≤ n3</span></span></span><br><span><var>Hle</var><span class="hyp-type"><b>: </b><span>n1 ≤ n3</span></span></span><br><span><var>Hl1</var><span class="hyp-type"><b>: </b><span>stream_prefix l n1 ++ stream_segment l n1 n3 =
stream_prefix l n2 ++ stream_segment l n2 n3</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">stream_segment l n1 n2 ++ stream_segment l n2 n3 =
stream_segment l n1 n3</div></blockquote><div class="alectryon-extra-goals"><input class="alectryon-extra-goal-toggle" id="StreamExtras-v-chk1ac" style="display: none" type="checkbox"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>A</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>l</var><span class="hyp-type"><b>: </b><span>Stream A</span></span></span><br><span><var>n1, n2, n3</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>H12</var><span class="hyp-type"><b>: </b><span>n1 ≤ n2</span></span></span><br><span><var>H23</var><span class="hyp-type"><b>: </b><span>n2 ≤ n3</span></span></span><br><span><var>Hle</var><span class="hyp-type"><b>: </b><span>n1 ≤ n3</span></span></span><br><span><var>Hl1</var><span class="hyp-type"><b>: </b><span>stream_app (stream_prefix l n1 ++ stream_segment l n1 n3)
(stream_suffix l n3) =
stream_app (stream_prefix l n2 ++ stream_segment l n2 n3)
(stream_suffix l n3)</span></span></span><br></div><label class="goal-separator" for="StreamExtras-v-chk1ac"><hr></label><div class="goal-conclusion">length (stream_prefix l n1 ++ stream_segment l n1 n3) =
length (stream_prefix l n2 ++ stream_segment l n2 n3)</div></blockquote></div></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="StreamExtras-v-chk1ad" style="display: none" type="checkbox"><label class="alectryon-input" for="StreamExtras-v-chk1ad">-</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>A</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>l</var><span class="hyp-type"><b>: </b><span>Stream A</span></span></span><br><span><var>n1, n2, n3</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>H12</var><span class="hyp-type"><b>: </b><span>n1 ≤ n2</span></span></span><br><span><var>H23</var><span class="hyp-type"><b>: </b><span>n2 ≤ n3</span></span></span><br><span><var>Hle</var><span class="hyp-type"><b>: </b><span>n1 ≤ n3</span></span></span><br><span><var>Hl1</var><span class="hyp-type"><b>: </b><span>stream_prefix l n1 ++ stream_segment l n1 n3 =
stream_prefix l n2 ++ stream_segment l n2 n3</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">stream_segment l n1 n2 ++ stream_segment l n2 n3 =
stream_segment l n1 n3</div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="StreamExtras-v-chk1ae" style="display: none" type="checkbox"><label class="alectryon-input" for="StreamExtras-v-chk1ae"><span class="nb">specialize</span> (list_prefix_suffix (stream_prefix l n2) n1); <span class="nb">intro</span> Hl2.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>A</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>l</var><span class="hyp-type"><b>: </b><span>Stream A</span></span></span><br><span><var>n1, n2, n3</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>H12</var><span class="hyp-type"><b>: </b><span>n1 ≤ n2</span></span></span><br><span><var>H23</var><span class="hyp-type"><b>: </b><span>n2 ≤ n3</span></span></span><br><span><var>Hle</var><span class="hyp-type"><b>: </b><span>n1 ≤ n3</span></span></span><br><span><var>Hl1</var><span class="hyp-type"><b>: </b><span>stream_prefix l n1 ++ stream_segment l n1 n3 =
stream_prefix l n2 ++ stream_segment l n2 n3</span></span></span><br><span><var>Hl2</var><span class="hyp-type"><b>: </b><span>list_prefix (stream_prefix l n2) n1 ++ list_suffix (stream_prefix l n2) n1 =
stream_prefix l n2</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">stream_segment l n1 n2 ++ stream_segment l n2 n3 =
stream_segment l n1 n3</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="StreamExtras-v-chk1af" style="display: none" type="checkbox"><label class="alectryon-input" for="StreamExtras-v-chk1af"><span class="nb">specialize</span> (stream_prefix_prefix l n1 n2 H12); <span class="nb">intro</span> Hl3.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>A</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>l</var><span class="hyp-type"><b>: </b><span>Stream A</span></span></span><br><span><var>n1, n2, n3</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>H12</var><span class="hyp-type"><b>: </b><span>n1 ≤ n2</span></span></span><br><span><var>H23</var><span class="hyp-type"><b>: </b><span>n2 ≤ n3</span></span></span><br><span><var>Hle</var><span class="hyp-type"><b>: </b><span>n1 ≤ n3</span></span></span><br><span><var>Hl1</var><span class="hyp-type"><b>: </b><span>stream_prefix l n1 ++ stream_segment l n1 n3 =
stream_prefix l n2 ++ stream_segment l n2 n3</span></span></span><br><span><var>Hl2</var><span class="hyp-type"><b>: </b><span>list_prefix (stream_prefix l n2) n1 ++ list_suffix (stream_prefix l n2) n1 =
stream_prefix l n2</span></span></span><br><span><var>Hl3</var><span class="hyp-type"><b>: </b><span>list_prefix (stream_prefix l n2) n1 = stream_prefix l n1</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">stream_segment l n1 n2 ++ stream_segment l n2 n3 =
stream_segment l n1 n3</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="StreamExtras-v-chk1b0" style="display: none" type="checkbox"><label class="alectryon-input" for="StreamExtras-v-chk1b0"><span class="nb">rewrite</span> Hl3 <span class="kr">in</span> Hl2.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>A</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>l</var><span class="hyp-type"><b>: </b><span>Stream A</span></span></span><br><span><var>n1, n2, n3</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>H12</var><span class="hyp-type"><b>: </b><span>n1 ≤ n2</span></span></span><br><span><var>H23</var><span class="hyp-type"><b>: </b><span>n2 ≤ n3</span></span></span><br><span><var>Hle</var><span class="hyp-type"><b>: </b><span>n1 ≤ n3</span></span></span><br><span><var>Hl1</var><span class="hyp-type"><b>: </b><span>stream_prefix l n1 ++ stream_segment l n1 n3 =
stream_prefix l n2 ++ stream_segment l n2 n3</span></span></span><br><span><var>Hl2</var><span class="hyp-type"><b>: </b><span>stream_prefix l n1 ++ list_suffix (stream_prefix l n2) n1 =
stream_prefix l n2</span></span></span><br><span><var>Hl3</var><span class="hyp-type"><b>: </b><span>list_prefix (stream_prefix l n2) n1 = stream_prefix l n1</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">stream_segment l n1 n2 ++ stream_segment l n2 n3 =
stream_segment l n1 n3</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="StreamExtras-v-chk1b1" style="display: none" type="checkbox"><label class="alectryon-input" for="StreamExtras-v-chk1b1"><span class="nb">rewrite</span> &lt;- Hl2 <span class="kr">in</span> Hl1.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>A</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>l</var><span class="hyp-type"><b>: </b><span>Stream A</span></span></span><br><span><var>n1, n2, n3</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>H12</var><span class="hyp-type"><b>: </b><span>n1 ≤ n2</span></span></span><br><span><var>H23</var><span class="hyp-type"><b>: </b><span>n2 ≤ n3</span></span></span><br><span><var>Hle</var><span class="hyp-type"><b>: </b><span>n1 ≤ n3</span></span></span><br><span><var>Hl1</var><span class="hyp-type"><b>: </b><span>stream_prefix l n1 ++ stream_segment l n1 n3 =
(stream_prefix l n1 ++ list_suffix (stream_prefix l n2) n1) ++
stream_segment l n2 n3</span></span></span><br><span><var>Hl2</var><span class="hyp-type"><b>: </b><span>stream_prefix l n1 ++ list_suffix (stream_prefix l n2) n1 =
stream_prefix l n2</span></span></span><br><span><var>Hl3</var><span class="hyp-type"><b>: </b><span>list_prefix (stream_prefix l n2) n1 = stream_prefix l n1</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">stream_segment l n1 n2 ++ stream_segment l n2 n3 =
stream_segment l n1 n3</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="StreamExtras-v-chk1b2" style="display: none" type="checkbox"><label class="alectryon-input" for="StreamExtras-v-chk1b2"><span class="nb">rewrite</span> &lt;- app_assoc <span class="kr">in</span> Hl1.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>A</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>l</var><span class="hyp-type"><b>: </b><span>Stream A</span></span></span><br><span><var>n1, n2, n3</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>H12</var><span class="hyp-type"><b>: </b><span>n1 ≤ n2</span></span></span><br><span><var>H23</var><span class="hyp-type"><b>: </b><span>n2 ≤ n3</span></span></span><br><span><var>Hle</var><span class="hyp-type"><b>: </b><span>n1 ≤ n3</span></span></span><br><span><var>Hl1</var><span class="hyp-type"><b>: </b><span>stream_prefix l n1 ++ stream_segment l n1 n3 =
stream_prefix l n1 ++
list_suffix (stream_prefix l n2) n1 ++ stream_segment l n2 n3</span></span></span><br><span><var>Hl2</var><span class="hyp-type"><b>: </b><span>stream_prefix l n1 ++ list_suffix (stream_prefix l n2) n1 =
stream_prefix l n2</span></span></span><br><span><var>Hl3</var><span class="hyp-type"><b>: </b><span>list_prefix (stream_prefix l n2) n1 = stream_prefix l n1</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">stream_segment l n1 n2 ++ stream_segment l n2 n3 =
stream_segment l n1 n3</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="StreamExtras-v-chk1b3" style="display: none" type="checkbox"><label class="alectryon-input" for="StreamExtras-v-chk1b3"><span class="nb">apply</span> app_inv_head <span class="kr">in</span> Hl1.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>A</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>l</var><span class="hyp-type"><b>: </b><span>Stream A</span></span></span><br><span><var>n1, n2, n3</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>H12</var><span class="hyp-type"><b>: </b><span>n1 ≤ n2</span></span></span><br><span><var>H23</var><span class="hyp-type"><b>: </b><span>n2 ≤ n3</span></span></span><br><span><var>Hle</var><span class="hyp-type"><b>: </b><span>n1 ≤ n3</span></span></span><br><span><var>Hl1</var><span class="hyp-type"><b>: </b><span>stream_segment l n1 n3 =
list_suffix (stream_prefix l n2) n1 ++ stream_segment l n2 n3</span></span></span><br><span><var>Hl2</var><span class="hyp-type"><b>: </b><span>stream_prefix l n1 ++ list_suffix (stream_prefix l n2) n1 =
stream_prefix l n2</span></span></span><br><span><var>Hl3</var><span class="hyp-type"><b>: </b><span>list_prefix (stream_prefix l n2) n1 = stream_prefix l n1</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">stream_segment l n1 n2 ++ stream_segment l n2 n3 =
stream_segment l n1 n3</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="StreamExtras-v-chk1b4" style="display: none" type="checkbox"><label class="alectryon-input" for="StreamExtras-v-chk1b4"><span class="nb">symmetry</span>.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>A</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>l</var><span class="hyp-type"><b>: </b><span>Stream A</span></span></span><br><span><var>n1, n2, n3</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>H12</var><span class="hyp-type"><b>: </b><span>n1 ≤ n2</span></span></span><br><span><var>H23</var><span class="hyp-type"><b>: </b><span>n2 ≤ n3</span></span></span><br><span><var>Hle</var><span class="hyp-type"><b>: </b><span>n1 ≤ n3</span></span></span><br><span><var>Hl1</var><span class="hyp-type"><b>: </b><span>stream_segment l n1 n3 =
list_suffix (stream_prefix l n2) n1 ++ stream_segment l n2 n3</span></span></span><br><span><var>Hl2</var><span class="hyp-type"><b>: </b><span>stream_prefix l n1 ++ list_suffix (stream_prefix l n2) n1 =
stream_prefix l n2</span></span></span><br><span><var>Hl3</var><span class="hyp-type"><b>: </b><span>list_prefix (stream_prefix l n2) n1 = stream_prefix l n1</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">stream_segment l n1 n3 =
stream_segment l n1 n2 ++ stream_segment l n2 n3</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><span class="alectryon-input"><span class="bp">assumption</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="StreamExtras-v-chk1b5" style="display: none" type="checkbox"><label class="alectryon-input" for="StreamExtras-v-chk1b5">-</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>A</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>l</var><span class="hyp-type"><b>: </b><span>Stream A</span></span></span><br><span><var>n1, n2, n3</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>H12</var><span class="hyp-type"><b>: </b><span>n1 ≤ n2</span></span></span><br><span><var>H23</var><span class="hyp-type"><b>: </b><span>n2 ≤ n3</span></span></span><br><span><var>Hle</var><span class="hyp-type"><b>: </b><span>n1 ≤ n3</span></span></span><br><span><var>Hl1</var><span class="hyp-type"><b>: </b><span>stream_app (stream_prefix l n1 ++ stream_segment l n1 n3)
(stream_suffix l n3) =
stream_app (stream_prefix l n2 ++ stream_segment l n2 n3)
(stream_suffix l n3)</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">length (stream_prefix l n1 ++ stream_segment l n1 n3) =
length (stream_prefix l n2 ++ stream_segment l n2 n3)</div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="StreamExtras-v-chk1b6" style="display: none" type="checkbox"><label class="alectryon-input" for="StreamExtras-v-chk1b6"><span class="kp">repeat</span> <span class="nb">rewrite</span> app_length.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>A</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>l</var><span class="hyp-type"><b>: </b><span>Stream A</span></span></span><br><span><var>n1, n2, n3</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>H12</var><span class="hyp-type"><b>: </b><span>n1 ≤ n2</span></span></span><br><span><var>H23</var><span class="hyp-type"><b>: </b><span>n2 ≤ n3</span></span></span><br><span><var>Hle</var><span class="hyp-type"><b>: </b><span>n1 ≤ n3</span></span></span><br><span><var>Hl1</var><span class="hyp-type"><b>: </b><span>stream_app (stream_prefix l n1 ++ stream_segment l n1 n3)
(stream_suffix l n3) =
stream_app (stream_prefix l n2 ++ stream_segment l n2 n3)
(stream_suffix l n3)</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">length (stream_prefix l n1) +
length (stream_segment l n1 n3) =
length (stream_prefix l n2) +
length (stream_segment l n2 n3)</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="StreamExtras-v-chk1b7" style="display: none" type="checkbox"><label class="alectryon-input" for="StreamExtras-v-chk1b7"><span class="nb">unfold</span> stream_segment.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>A</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>l</var><span class="hyp-type"><b>: </b><span>Stream A</span></span></span><br><span><var>n1, n2, n3</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>H12</var><span class="hyp-type"><b>: </b><span>n1 ≤ n2</span></span></span><br><span><var>H23</var><span class="hyp-type"><b>: </b><span>n2 ≤ n3</span></span></span><br><span><var>Hle</var><span class="hyp-type"><b>: </b><span>n1 ≤ n3</span></span></span><br><span><var>Hl1</var><span class="hyp-type"><b>: </b><span>stream_app (stream_prefix l n1 ++ stream_segment l n1 n3)
(stream_suffix l n3) =
stream_app (stream_prefix l n2 ++ stream_segment l n2 n3)
(stream_suffix l n3)</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">length (stream_prefix l n1) +
length (list_suffix (stream_prefix l n3) n1) =
length (stream_prefix l n2) +
length (list_suffix (stream_prefix l n3) n2)</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="StreamExtras-v-chk1b8" style="display: none" type="checkbox"><label class="alectryon-input" for="StreamExtras-v-chk1b8"><span class="kp">repeat</span> <span class="nb">rewrite</span> list_suffix_length.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>A</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>l</var><span class="hyp-type"><b>: </b><span>Stream A</span></span></span><br><span><var>n1, n2, n3</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>H12</var><span class="hyp-type"><b>: </b><span>n1 ≤ n2</span></span></span><br><span><var>H23</var><span class="hyp-type"><b>: </b><span>n2 ≤ n3</span></span></span><br><span><var>Hle</var><span class="hyp-type"><b>: </b><span>n1 ≤ n3</span></span></span><br><span><var>Hl1</var><span class="hyp-type"><b>: </b><span>stream_app (stream_prefix l n1 ++ stream_segment l n1 n3)
(stream_suffix l n3) =
stream_app (stream_prefix l n2 ++ stream_segment l n2 n3)
(stream_suffix l n3)</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">length (stream_prefix l n1) +
(length (stream_prefix l n3) - n1) =
length (stream_prefix l n2) +
(length (stream_prefix l n3) - n2)</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="StreamExtras-v-chk1b9" style="display: none" type="checkbox"><label class="alectryon-input" for="StreamExtras-v-chk1b9"><span class="kp">repeat</span> <span class="nb">rewrite</span> stream_prefix_length.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>A</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>l</var><span class="hyp-type"><b>: </b><span>Stream A</span></span></span><br><span><var>n1, n2, n3</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>H12</var><span class="hyp-type"><b>: </b><span>n1 ≤ n2</span></span></span><br><span><var>H23</var><span class="hyp-type"><b>: </b><span>n2 ≤ n3</span></span></span><br><span><var>Hle</var><span class="hyp-type"><b>: </b><span>n1 ≤ n3</span></span></span><br><span><var>Hl1</var><span class="hyp-type"><b>: </b><span>stream_app (stream_prefix l n1 ++ stream_segment l n1 n3)
(stream_suffix l n3) =
stream_app (stream_prefix l n2 ++ stream_segment l n2 n3)
(stream_suffix l n3)</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">n1 + (n3 - n1) = n2 + (n3 - n2)</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><span class="alectryon-input"><span class="bp">lia</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Qed</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
</span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Definition</span> <span class="nf">monotone_nat_stream_prop</span>
  (<span class="nv">s</span> : Stream nat)
  := <span class="kr">forall</span> <span class="nv">n1</span> <span class="nv">n2</span> : nat, n1 &lt; n2 -&gt; Str_nth n1 s &lt; Str_nth n2 s.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
</span><span class="alectryon-sentence"><input class="alectryon-toggle" id="StreamExtras-v-chk1ba" style="display: none" type="checkbox"><label class="alectryon-input" for="StreamExtras-v-chk1ba"><span class="kn">Lemma</span> <span class="nf">monotone_nat_stream_prop_from_successor</span> <span class="nv">s</span>
  : ForAll2 lt s &lt;-&gt; monotone_nat_stream_prop s.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>s</var><span class="hyp-type"><b>: </b><span>Stream nat</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">ForAll2 lt s ↔ monotone_nat_stream_prop s</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="StreamExtras-v-chk1bb" style="display: none" type="checkbox"><label class="alectryon-input" for="StreamExtras-v-chk1bb"><span class="kn">Proof</span>.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>s</var><span class="hyp-type"><b>: </b><span>Stream nat</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">ForAll2 lt s ↔ monotone_nat_stream_prop s</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="StreamExtras-v-chk1bc" style="display: none" type="checkbox"><label class="alectryon-input" for="StreamExtras-v-chk1bc"><span class="nb">apply</span> ForAll2_transitive_lookup.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>s</var><span class="hyp-type"><b>: </b><span>Stream nat</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">Transitive lt</div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="StreamExtras-v-chk1bd" style="display: none" type="checkbox"><label class="alectryon-input" for="StreamExtras-v-chk1bd"><span class="nb">unfold</span> Transitive.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>s</var><span class="hyp-type"><b>: </b><span>Stream nat</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="kr">∀</span> <span class="nv">x</span> <span class="nv">y</span> <span class="nv">z</span> : nat, x &lt; y → y &lt; z → x &lt; z</div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="bp">lia</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Qed</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
</span><span class="alectryon-sentence"><input class="alectryon-toggle" id="StreamExtras-v-chk1be" style="display: none" type="checkbox"><label class="alectryon-input" for="StreamExtras-v-chk1be"><span class="kn">Lemma</span> <span class="nf">monotone_nat_stream_rev</span>
  (<span class="nv">s</span> : Stream nat)
  (<span class="nv">Hs</span> : monotone_nat_stream_prop s)
  : <span class="kr">forall</span> <span class="nv">n1</span> <span class="nv">n2</span>, Str_nth n1  s &lt;= Str_nth n2 s -&gt; n1 &lt;= n2.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>s</var><span class="hyp-type"><b>: </b><span>Stream nat</span></span></span><br><span><var>Hs</var><span class="hyp-type"><b>: </b><span>monotone_nat_stream_prop s</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="kr">∀</span> <span class="nv">n1</span> <span class="nv">n2</span> : nat, Str_nth n1 s ≤ Str_nth n2 s → n1 ≤ n2</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="StreamExtras-v-chk1bf" style="display: none" type="checkbox"><label class="alectryon-input" for="StreamExtras-v-chk1bf"><span class="kn">Proof</span>.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>s</var><span class="hyp-type"><b>: </b><span>Stream nat</span></span></span><br><span><var>Hs</var><span class="hyp-type"><b>: </b><span>monotone_nat_stream_prop s</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="kr">∀</span> <span class="nv">n1</span> <span class="nv">n2</span> : nat, Str_nth n1 s ≤ Str_nth n2 s → n1 ≤ n2</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="StreamExtras-v-chk1c0" style="display: none" type="checkbox"><label class="alectryon-input" for="StreamExtras-v-chk1c0"><span class="nb">intros</span> n1 n2 Hle.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>s</var><span class="hyp-type"><b>: </b><span>Stream nat</span></span></span><br><span><var>Hs</var><span class="hyp-type"><b>: </b><span>monotone_nat_stream_prop s</span></span></span><br><span><var>n1, n2</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>Hle</var><span class="hyp-type"><b>: </b><span>Str_nth n1 s ≤ Str_nth n2 s</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">n1 ≤ n2</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="StreamExtras-v-chk1c1" style="display: none" type="checkbox"><label class="alectryon-input" for="StreamExtras-v-chk1c1"><span class="nb">destruct</span> (decide (n1 &lt;= n2)); [<span class="bp">lia</span>|].</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>s</var><span class="hyp-type"><b>: </b><span>Stream nat</span></span></span><br><span><var>Hs</var><span class="hyp-type"><b>: </b><span>monotone_nat_stream_prop s</span></span></span><br><span><var>n1, n2</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>Hle</var><span class="hyp-type"><b>: </b><span>Str_nth n1 s ≤ Str_nth n2 s</span></span></span><br><span><var>n</var><span class="hyp-type"><b>: </b><span>¬ n1 ≤ n2</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">n1 ≤ n2</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="StreamExtras-v-chk1c2" style="display: none" type="checkbox"><label class="alectryon-input" for="StreamExtras-v-chk1c2"><span class="nb">specialize</span> (Hs n2 n1).</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>s</var><span class="hyp-type"><b>: </b><span>Stream nat</span></span></span><br><span><var>n1, n2</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>Hs</var><span class="hyp-type"><b>: </b><span>n2 &lt; n1 → Str_nth n2 s &lt; Str_nth n1 s</span></span></span><br><span><var>Hle</var><span class="hyp-type"><b>: </b><span>Str_nth n1 s ≤ Str_nth n2 s</span></span></span><br><span><var>n</var><span class="hyp-type"><b>: </b><span>¬ n1 ≤ n2</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">n1 ≤ n2</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><span class="alectryon-input">spec Hs; <span class="bp">lia</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Qed</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
</span><span class="alectryon-sentence"><input class="alectryon-toggle" id="StreamExtras-v-chk1c3" style="display: none" type="checkbox"><label class="alectryon-input" for="StreamExtras-v-chk1c3"><span class="kn">Lemma</span> <span class="nf">monotone_nat_stream_find</span> <span class="nv">s</span> (<span class="nv">Hs</span> : monotone_nat_stream_prop s) (<span class="nv">n</span> : nat)
  : n &lt; hd s \/ <span class="kr">exists</span> <span class="nv">k</span>, Str_nth k s = n \/ Str_nth k s &lt; n &lt; Str_nth (S k) s.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>s</var><span class="hyp-type"><b>: </b><span>Stream nat</span></span></span><br><span><var>Hs</var><span class="hyp-type"><b>: </b><span>monotone_nat_stream_prop s</span></span></span><br><span><var>n</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">n &lt; hd s
∨ (<span class="kr">∃</span> <span class="nv">k</span> : nat,
     Str_nth k s = n
     ∨ Str_nth k s &lt; n &lt; Str_nth (S k) s)</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="StreamExtras-v-chk1c4" style="display: none" type="checkbox"><label class="alectryon-input" for="StreamExtras-v-chk1c4"><span class="kn">Proof</span>.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>s</var><span class="hyp-type"><b>: </b><span>Stream nat</span></span></span><br><span><var>Hs</var><span class="hyp-type"><b>: </b><span>monotone_nat_stream_prop s</span></span></span><br><span><var>n</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">n &lt; hd s
∨ (<span class="kr">∃</span> <span class="nv">k</span> : nat,
     Str_nth k s = n
     ∨ Str_nth k s &lt; n &lt; Str_nth (S k) s)</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="StreamExtras-v-chk1c5" style="display: none" type="checkbox"><label class="alectryon-input" for="StreamExtras-v-chk1c5"><span class="nb">induction</span> n.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>s</var><span class="hyp-type"><b>: </b><span>Stream nat</span></span></span><br><span><var>Hs</var><span class="hyp-type"><b>: </b><span>monotone_nat_stream_prop s</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="mi">0</span> &lt; hd s
∨ (<span class="kr">∃</span> <span class="nv">k</span> : nat,
     Str_nth k s = <span class="mi">0</span>
     ∨ Str_nth k s &lt; <span class="mi">0</span> &lt; Str_nth (S k) s)</div></blockquote><div class="alectryon-extra-goals"><input class="alectryon-extra-goal-toggle" id="StreamExtras-v-chk1c6" style="display: none" type="checkbox"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>s</var><span class="hyp-type"><b>: </b><span>Stream nat</span></span></span><br><span><var>Hs</var><span class="hyp-type"><b>: </b><span>monotone_nat_stream_prop s</span></span></span><br><span><var>n</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>IHn</var><span class="hyp-type"><b>: </b><span>n &lt; hd s ∨ (<span class="kr">∃</span> <span class="nv">k</span> : nat, Str_nth k s = n ∨ Str_nth k s &lt; n &lt; Str_nth (S k) s)</span></span></span><br></div><label class="goal-separator" for="StreamExtras-v-chk1c6"><hr></label><div class="goal-conclusion">S n &lt; hd s
∨ (<span class="kr">∃</span> <span class="nv">k</span> : nat,
     Str_nth k s = S n
     ∨ Str_nth k s &lt; S n &lt; Str_nth (S k) s)</div></blockquote></div></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="StreamExtras-v-chk1c7" style="display: none" type="checkbox"><label class="alectryon-input" for="StreamExtras-v-chk1c7">-</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>s</var><span class="hyp-type"><b>: </b><span>Stream nat</span></span></span><br><span><var>Hs</var><span class="hyp-type"><b>: </b><span>monotone_nat_stream_prop s</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="mi">0</span> &lt; hd s
∨ (<span class="kr">∃</span> <span class="nv">k</span> : nat,
     Str_nth k s = <span class="mi">0</span>
     ∨ Str_nth k s &lt; <span class="mi">0</span> &lt; Str_nth (S k) s)</div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="StreamExtras-v-chk1c8" style="display: none" type="checkbox"><label class="alectryon-input" for="StreamExtras-v-chk1c8"><span class="nb">destruct</span> (hd s) <span class="nb">eqn</span>:Hhd .</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>s</var><span class="hyp-type"><b>: </b><span>Stream nat</span></span></span><br><span><var>Hs</var><span class="hyp-type"><b>: </b><span>monotone_nat_stream_prop s</span></span></span><br><span><var>Hhd</var><span class="hyp-type"><b>: </b><span>hd s = <span class="mi">0</span></span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="mi">0</span> &lt; <span class="mi">0</span>
∨ (<span class="kr">∃</span> <span class="nv">k</span> : nat,
     Str_nth k s = <span class="mi">0</span>
     ∨ Str_nth k s &lt; <span class="mi">0</span> &lt; Str_nth (S k) s)</div></blockquote><div class="alectryon-extra-goals"><input class="alectryon-extra-goal-toggle" id="StreamExtras-v-chk1c9" style="display: none" type="checkbox"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>s</var><span class="hyp-type"><b>: </b><span>Stream nat</span></span></span><br><span><var>Hs</var><span class="hyp-type"><b>: </b><span>monotone_nat_stream_prop s</span></span></span><br><span><var>n</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>Hhd</var><span class="hyp-type"><b>: </b><span>hd s = S n</span></span></span><br></div><label class="goal-separator" for="StreamExtras-v-chk1c9"><hr></label><div class="goal-conclusion"><span class="mi">0</span> &lt; S n
∨ (<span class="kr">∃</span> <span class="nv">k</span> : nat,
     Str_nth k s = <span class="mi">0</span>
     ∨ Str_nth k s &lt; <span class="mi">0</span> &lt; Str_nth (S k) s)</div></blockquote></div></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="StreamExtras-v-chk1ca" style="display: none" type="checkbox"><label class="alectryon-input" for="StreamExtras-v-chk1ca">+</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>s</var><span class="hyp-type"><b>: </b><span>Stream nat</span></span></span><br><span><var>Hs</var><span class="hyp-type"><b>: </b><span>monotone_nat_stream_prop s</span></span></span><br><span><var>Hhd</var><span class="hyp-type"><b>: </b><span>hd s = <span class="mi">0</span></span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="mi">0</span> &lt; <span class="mi">0</span>
∨ (<span class="kr">∃</span> <span class="nv">k</span> : nat,
     Str_nth k s = <span class="mi">0</span>
     ∨ Str_nth k s &lt; <span class="mi">0</span> &lt; Str_nth (S k) s)</div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="StreamExtras-v-chk1cb" style="display: none" type="checkbox"><label class="alectryon-input" for="StreamExtras-v-chk1cb"><span class="nb">right</span>.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>s</var><span class="hyp-type"><b>: </b><span>Stream nat</span></span></span><br><span><var>Hs</var><span class="hyp-type"><b>: </b><span>monotone_nat_stream_prop s</span></span></span><br><span><var>Hhd</var><span class="hyp-type"><b>: </b><span>hd s = <span class="mi">0</span></span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="kr">∃</span> <span class="nv">k</span> : nat,
  Str_nth k s = <span class="mi">0</span> ∨ Str_nth k s &lt; <span class="mi">0</span> &lt; Str_nth (S k) s</div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="StreamExtras-v-chk1cc" style="display: none" type="checkbox"><label class="alectryon-input" for="StreamExtras-v-chk1cc"><span class="kr">exists</span> <span class="mi">0</span>.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>s</var><span class="hyp-type"><b>: </b><span>Stream nat</span></span></span><br><span><var>Hs</var><span class="hyp-type"><b>: </b><span>monotone_nat_stream_prop s</span></span></span><br><span><var>Hhd</var><span class="hyp-type"><b>: </b><span>hd s = <span class="mi">0</span></span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">Str_nth <span class="mi">0</span> s = <span class="mi">0</span> ∨ Str_nth <span class="mi">0</span> s &lt; <span class="mi">0</span> &lt; Str_nth <span class="mi">1</span> s</div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="StreamExtras-v-chk1cd" style="display: none" type="checkbox"><label class="alectryon-input" for="StreamExtras-v-chk1cd"><span class="nb">left</span>.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>s</var><span class="hyp-type"><b>: </b><span>Stream nat</span></span></span><br><span><var>Hs</var><span class="hyp-type"><b>: </b><span>monotone_nat_stream_prop s</span></span></span><br><span><var>Hhd</var><span class="hyp-type"><b>: </b><span>hd s = <span class="mi">0</span></span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">Str_nth <span class="mi">0</span> s = <span class="mi">0</span></div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="bp">assumption</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="StreamExtras-v-chk1ce" style="display: none" type="checkbox"><label class="alectryon-input" for="StreamExtras-v-chk1ce">+</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>s</var><span class="hyp-type"><b>: </b><span>Stream nat</span></span></span><br><span><var>Hs</var><span class="hyp-type"><b>: </b><span>monotone_nat_stream_prop s</span></span></span><br><span><var>n</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>Hhd</var><span class="hyp-type"><b>: </b><span>hd s = S n</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="mi">0</span> &lt; S n
∨ (<span class="kr">∃</span> <span class="nv">k</span> : nat,
     Str_nth k s = <span class="mi">0</span>
     ∨ Str_nth k s &lt; <span class="mi">0</span> &lt; Str_nth (S k) s)</div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="StreamExtras-v-chk1cf" style="display: none" type="checkbox"><label class="alectryon-input" for="StreamExtras-v-chk1cf"><span class="nb">left</span>.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>s</var><span class="hyp-type"><b>: </b><span>Stream nat</span></span></span><br><span><var>Hs</var><span class="hyp-type"><b>: </b><span>monotone_nat_stream_prop s</span></span></span><br><span><var>n</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>Hhd</var><span class="hyp-type"><b>: </b><span>hd s = S n</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="mi">0</span> &lt; S n</div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="bp">lia</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="StreamExtras-v-chk1d0" style="display: none" type="checkbox"><label class="alectryon-input" for="StreamExtras-v-chk1d0">-</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>s</var><span class="hyp-type"><b>: </b><span>Stream nat</span></span></span><br><span><var>Hs</var><span class="hyp-type"><b>: </b><span>monotone_nat_stream_prop s</span></span></span><br><span><var>n</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>IHn</var><span class="hyp-type"><b>: </b><span>n &lt; hd s ∨ (<span class="kr">∃</span> <span class="nv">k</span> : nat, Str_nth k s = n ∨ Str_nth k s &lt; n &lt; Str_nth (S k) s)</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">S n &lt; hd s
∨ (<span class="kr">∃</span> <span class="nv">k</span> : nat,
     Str_nth k s = S n
     ∨ Str_nth k s &lt; S n &lt; Str_nth (S k) s)</div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="StreamExtras-v-chk1d1" style="display: none" type="checkbox"><label class="alectryon-input" for="StreamExtras-v-chk1d1"><span class="nb">destruct</span> (decide (hd s &lt;= S n)); [|<span class="nb">left</span>; <span class="bp">lia</span>].</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>s</var><span class="hyp-type"><b>: </b><span>Stream nat</span></span></span><br><span><var>Hs</var><span class="hyp-type"><b>: </b><span>monotone_nat_stream_prop s</span></span></span><br><span><var>n</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>IHn</var><span class="hyp-type"><b>: </b><span>n &lt; hd s ∨ (<span class="kr">∃</span> <span class="nv">k</span> : nat, Str_nth k s = n ∨ Str_nth k s &lt; n &lt; Str_nth (S k) s)</span></span></span><br><span><var>l</var><span class="hyp-type"><b>: </b><span>hd s ≤ S n</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">S n &lt; hd s
∨ (<span class="kr">∃</span> <span class="nv">k</span> : nat,
     Str_nth k s = S n
     ∨ Str_nth k s &lt; S n &lt; Str_nth (S k) s)</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="StreamExtras-v-chk1d2" style="display: none" type="checkbox"><label class="alectryon-input" for="StreamExtras-v-chk1d2"><span class="nb">right</span>.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>s</var><span class="hyp-type"><b>: </b><span>Stream nat</span></span></span><br><span><var>Hs</var><span class="hyp-type"><b>: </b><span>monotone_nat_stream_prop s</span></span></span><br><span><var>n</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>IHn</var><span class="hyp-type"><b>: </b><span>n &lt; hd s ∨ (<span class="kr">∃</span> <span class="nv">k</span> : nat, Str_nth k s = n ∨ Str_nth k s &lt; n &lt; Str_nth (S k) s)</span></span></span><br><span><var>l</var><span class="hyp-type"><b>: </b><span>hd s ≤ S n</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="kr">∃</span> <span class="nv">k</span> : nat,
  Str_nth k s = S n
  ∨ Str_nth k s &lt; S n &lt; Str_nth (S k) s</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="StreamExtras-v-chk1d3" style="display: none" type="checkbox"><label class="alectryon-input" for="StreamExtras-v-chk1d3"><span class="nb">destruct</span> IHn <span class="kr">as</span> [Hlt | [k Hk]]
    ; [<span class="kr">exists</span> <span class="mi">0</span>; <span class="nb">left</span>; <span class="nb">cbv</span> <span class="kr">in</span> *; <span class="bp">lia</span>|].</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>s</var><span class="hyp-type"><b>: </b><span>Stream nat</span></span></span><br><span><var>Hs</var><span class="hyp-type"><b>: </b><span>monotone_nat_stream_prop s</span></span></span><br><span><var>n, k</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>Hk</var><span class="hyp-type"><b>: </b><span>Str_nth k s = n
∨ Str_nth k s &lt; n &lt; Str_nth (S k) s</span></span></span><br><span><var>l</var><span class="hyp-type"><b>: </b><span>hd s ≤ S n</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="kr">∃</span> <span class="nv">k</span> : nat,
  Str_nth k s = S n
  ∨ Str_nth k s &lt; S n &lt; Str_nth (S k) s</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="StreamExtras-v-chk1d4" style="display: none" type="checkbox"><label class="alectryon-input" for="StreamExtras-v-chk1d4"><span class="nb">destruct</span> (decide (Str_nth (S k) s = S n))
    ; [<span class="kr">exists</span> (<span class="nv">S</span> <span class="nv">k</span>); <span class="nb">left</span>; <span class="bp">assumption</span>|].</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>s</var><span class="hyp-type"><b>: </b><span>Stream nat</span></span></span><br><span><var>Hs</var><span class="hyp-type"><b>: </b><span>monotone_nat_stream_prop s</span></span></span><br><span><var>n, k</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>Hk</var><span class="hyp-type"><b>: </b><span>Str_nth k s = n
∨ Str_nth k s &lt; n &lt; Str_nth (S k) s</span></span></span><br><span><var>l</var><span class="hyp-type"><b>: </b><span>hd s ≤ S n</span></span></span><br><span><var>n0</var><span class="hyp-type"><b>: </b><span>Str_nth (S k) s ≠ S n</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="kr">∃</span> <span class="nv">k</span> : nat,
  Str_nth k s = S n
  ∨ Str_nth k s &lt; S n &lt; Str_nth (S k) s</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="StreamExtras-v-chk1d5" style="display: none" type="checkbox"><label class="alectryon-input" for="StreamExtras-v-chk1d5"><span class="kr">exists</span> <span class="nv">k</span>.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>s</var><span class="hyp-type"><b>: </b><span>Stream nat</span></span></span><br><span><var>Hs</var><span class="hyp-type"><b>: </b><span>monotone_nat_stream_prop s</span></span></span><br><span><var>n, k</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>Hk</var><span class="hyp-type"><b>: </b><span>Str_nth k s = n
∨ Str_nth k s &lt; n &lt; Str_nth (S k) s</span></span></span><br><span><var>l</var><span class="hyp-type"><b>: </b><span>hd s ≤ S n</span></span></span><br><span><var>n0</var><span class="hyp-type"><b>: </b><span>Str_nth (S k) s ≠ S n</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">Str_nth k s = S n
∨ Str_nth k s &lt; S n &lt; Str_nth (S k) s</div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="StreamExtras-v-chk1d6" style="display: none" type="checkbox"><label class="alectryon-input" for="StreamExtras-v-chk1d6"><span class="nb">right</span>.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>s</var><span class="hyp-type"><b>: </b><span>Stream nat</span></span></span><br><span><var>Hs</var><span class="hyp-type"><b>: </b><span>monotone_nat_stream_prop s</span></span></span><br><span><var>n, k</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>Hk</var><span class="hyp-type"><b>: </b><span>Str_nth k s = n
∨ Str_nth k s &lt; n &lt; Str_nth (S k) s</span></span></span><br><span><var>l</var><span class="hyp-type"><b>: </b><span>hd s ≤ S n</span></span></span><br><span><var>n0</var><span class="hyp-type"><b>: </b><span>Str_nth (S k) s ≠ S n</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">Str_nth k s &lt; S n &lt; Str_nth (S k) s</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="StreamExtras-v-chk1d7" style="display: none" type="checkbox"><label class="alectryon-input" for="StreamExtras-v-chk1d7"><span class="nb">specialize</span> (Hs k (S k)).</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>s</var><span class="hyp-type"><b>: </b><span>Stream nat</span></span></span><br><span><var>k</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>Hs</var><span class="hyp-type"><b>: </b><span>k &lt; S k → Str_nth k s &lt; Str_nth (S k) s</span></span></span><br><span><var>n</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>Hk</var><span class="hyp-type"><b>: </b><span>Str_nth k s = n
∨ Str_nth k s &lt; n &lt; Str_nth (S k) s</span></span></span><br><span><var>l</var><span class="hyp-type"><b>: </b><span>hd s ≤ S n</span></span></span><br><span><var>n0</var><span class="hyp-type"><b>: </b><span>Str_nth (S k) s ≠ S n</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">Str_nth k s &lt; S n &lt; Str_nth (S k) s</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><span class="alectryon-input">spec Hs; <span class="bp">lia</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Qed</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
</span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Definition</span> <span class="nf">monotone_nat_stream</span> :=
  {s : Stream nat | monotone_nat_stream_prop s}.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
</span><span class="alectryon-sentence"><input class="alectryon-toggle" id="StreamExtras-v-chk1d8" style="display: none" type="checkbox"><label class="alectryon-input" for="StreamExtras-v-chk1d8"><span class="kn">Lemma</span> <span class="nf">monotone_nat_stream_tl</span>
  (<span class="nv">s</span> : Stream nat)
  (<span class="nv">Hs</span> : monotone_nat_stream_prop s)
  : monotone_nat_stream_prop (tl s).</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>s</var><span class="hyp-type"><b>: </b><span>Stream nat</span></span></span><br><span><var>Hs</var><span class="hyp-type"><b>: </b><span>monotone_nat_stream_prop s</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">monotone_nat_stream_prop (tl s)</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="StreamExtras-v-chk1d9" style="display: none" type="checkbox"><label class="alectryon-input" for="StreamExtras-v-chk1d9"><span class="kn">Proof</span>.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>s</var><span class="hyp-type"><b>: </b><span>Stream nat</span></span></span><br><span><var>Hs</var><span class="hyp-type"><b>: </b><span>monotone_nat_stream_prop s</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">monotone_nat_stream_prop (tl s)</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="StreamExtras-v-chk1da" style="display: none" type="checkbox"><label class="alectryon-input" for="StreamExtras-v-chk1da"><span class="nb">intros</span> n1 n2 Hlt.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>s</var><span class="hyp-type"><b>: </b><span>Stream nat</span></span></span><br><span><var>Hs</var><span class="hyp-type"><b>: </b><span>monotone_nat_stream_prop s</span></span></span><br><span><var>n1, n2</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>Hlt</var><span class="hyp-type"><b>: </b><span>n1 &lt; n2</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">Str_nth n1 (tl s) &lt; Str_nth n2 (tl s)</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="StreamExtras-v-chk1db" style="display: none" type="checkbox"><label class="alectryon-input" for="StreamExtras-v-chk1db"><span class="nb">specialize</span> (Hs (S n1) (S n2)).</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>s</var><span class="hyp-type"><b>: </b><span>Stream nat</span></span></span><br><span><var>n1, n2</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>Hs</var><span class="hyp-type"><b>: </b><span>S n1 &lt; S n2 → Str_nth (S n1) s &lt; Str_nth (S n2) s</span></span></span><br><span><var>Hlt</var><span class="hyp-type"><b>: </b><span>n1 &lt; n2</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">Str_nth n1 (tl s) &lt; Str_nth n2 (tl s)</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="StreamExtras-v-chk1dc" style="display: none" type="checkbox"><label class="alectryon-input" for="StreamExtras-v-chk1dc"><span class="nb">apply</span> Hs.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>s</var><span class="hyp-type"><b>: </b><span>Stream nat</span></span></span><br><span><var>n1, n2</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>Hs</var><span class="hyp-type"><b>: </b><span>S n1 &lt; S n2 → Str_nth (S n1) s &lt; Str_nth (S n2) s</span></span></span><br><span><var>Hlt</var><span class="hyp-type"><b>: </b><span>n1 &lt; n2</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">S n1 &lt; S n2</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><span class="alectryon-input"><span class="bp">lia</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Qed</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
</span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">CoFixpoint</span> <span class="nf">nat_sequence_from</span> (<span class="nv">n</span> : nat) : Stream nat
  := Cons n (nat_sequence_from (S n)).</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
</span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Definition</span> <span class="nf">nat_sequence</span> : Stream nat := nat_sequence_from <span class="mi">0</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
</span><span class="alectryon-sentence"><input class="alectryon-toggle" id="StreamExtras-v-chk1dd" style="display: none" type="checkbox"><label class="alectryon-input" for="StreamExtras-v-chk1dd"><span class="kn">Lemma</span> <span class="nf">nat_sequence_from_nth</span> : <span class="kr">forall</span> <span class="nv">m</span> <span class="nv">n</span>, Str_nth n (nat_sequence_from m) = n + m.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="kr">∀</span> <span class="nv">m</span> <span class="nv">n</span> : nat, Str_nth n (nat_sequence_from m) = n + m</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="StreamExtras-v-chk1de" style="display: none" type="checkbox"><label class="alectryon-input" for="StreamExtras-v-chk1de"><span class="kn">Proof</span>.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="kr">∀</span> <span class="nv">m</span> <span class="nv">n</span> : nat, Str_nth n (nat_sequence_from m) = n + m</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="StreamExtras-v-chk1df" style="display: none" type="checkbox"><label class="alectryon-input" for="StreamExtras-v-chk1df"><span class="nb">intros</span> m n.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>m, n</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">Str_nth n (nat_sequence_from m) = n + m</div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="StreamExtras-v-chk1e0" style="display: none" type="checkbox"><label class="alectryon-input" for="StreamExtras-v-chk1e0"><span class="nb">revert</span> m.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>n</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="kr">∀</span> <span class="nv">m</span> : nat, Str_nth n (nat_sequence_from m) = n + m</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="StreamExtras-v-chk1e1" style="display: none" type="checkbox"><label class="alectryon-input" for="StreamExtras-v-chk1e1"><span class="nb">induction</span> n; [<span class="bp">reflexivity</span>|].</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>n</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>IHn</var><span class="hyp-type"><b>: </b><span><span class="kr">∀</span> <span class="nv">m</span> : nat, Str_nth n (nat_sequence_from m) = n + m</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="kr">∀</span> <span class="nv">m</span> : nat,
  Str_nth (S n) (nat_sequence_from m) = S n + m</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="StreamExtras-v-chk1e2" style="display: none" type="checkbox"><label class="alectryon-input" for="StreamExtras-v-chk1e2"><span class="nb">intros</span>.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>n</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>IHn</var><span class="hyp-type"><b>: </b><span><span class="kr">∀</span> <span class="nv">m</span> : nat, Str_nth n (nat_sequence_from m) = n + m</span></span></span><br><span><var>m</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">Str_nth (S n) (nat_sequence_from m) = S n + m</div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="StreamExtras-v-chk1e3" style="display: none" type="checkbox"><label class="alectryon-input" for="StreamExtras-v-chk1e3"><span class="nb">simpl</span>.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>n</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>IHn</var><span class="hyp-type"><b>: </b><span><span class="kr">∀</span> <span class="nv">m</span> : nat, Str_nth n (nat_sequence_from m) = n + m</span></span></span><br><span><var>m</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">Str_nth (S n) (nat_sequence_from m) = S (n + m)</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="StreamExtras-v-chk1e4" style="display: none" type="checkbox"><label class="alectryon-input" for="StreamExtras-v-chk1e4"><span class="nb">unfold</span> Str_nth.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>n</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>IHn</var><span class="hyp-type"><b>: </b><span><span class="kr">∀</span> <span class="nv">m</span> : nat, Str_nth n (nat_sequence_from m) = n + m</span></span></span><br><span><var>m</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">hd (Str_nth_tl (S n) (nat_sequence_from m)) =
S (n + m)</div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="StreamExtras-v-chk1e5" style="display: none" type="checkbox"><label class="alectryon-input" for="StreamExtras-v-chk1e5"><span class="nb">simpl</span>.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>n</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>IHn</var><span class="hyp-type"><b>: </b><span><span class="kr">∀</span> <span class="nv">m</span> : nat, Str_nth n (nat_sequence_from m) = n + m</span></span></span><br><span><var>m</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">hd (Str_nth_tl n (nat_sequence_from (S m))) =
S (n + m)</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="StreamExtras-v-chk1e6" style="display: none" type="checkbox"><label class="alectryon-input" for="StreamExtras-v-chk1e6"><span class="nb">unfold</span> Str_nth <span class="kr">in</span> IHn.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>n</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>IHn</var><span class="hyp-type"><b>: </b><span><span class="kr">∀</span> <span class="nv">m</span> : nat, hd (Str_nth_tl n (nat_sequence_from m)) = n + m</span></span></span><br><span><var>m</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">hd (Str_nth_tl n (nat_sequence_from (S m))) =
S (n + m)</div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="StreamExtras-v-chk1e7" style="display: none" type="checkbox"><label class="alectryon-input" for="StreamExtras-v-chk1e7"><span class="nb">rewrite</span> IHn.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>n</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>IHn</var><span class="hyp-type"><b>: </b><span><span class="kr">∀</span> <span class="nv">m</span> : nat, hd (Str_nth_tl n (nat_sequence_from m)) = n + m</span></span></span><br><span><var>m</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">n + S m = S (n + m)</div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="bp">lia</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Qed</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
</span><span class="alectryon-sentence"><input class="alectryon-toggle" id="StreamExtras-v-chk1e8" style="display: none" type="checkbox"><label class="alectryon-input" for="StreamExtras-v-chk1e8"><span class="kn">Lemma</span> <span class="nf">nat_sequence_nth</span> : <span class="kr">forall</span> <span class="nv">n</span>, Str_nth n nat_sequence = n.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="kr">∀</span> <span class="nv">n</span> : nat, Str_nth n nat_sequence = n</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="StreamExtras-v-chk1e9" style="display: none" type="checkbox"><label class="alectryon-input" for="StreamExtras-v-chk1e9"><span class="kn">Proof</span>.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="kr">∀</span> <span class="nv">n</span> : nat, Str_nth n nat_sequence = n</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="StreamExtras-v-chk1ea" style="display: none" type="checkbox"><label class="alectryon-input" for="StreamExtras-v-chk1ea"><span class="nb">intros</span>.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>n</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">Str_nth n nat_sequence = n</div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="StreamExtras-v-chk1eb" style="display: none" type="checkbox"><label class="alectryon-input" for="StreamExtras-v-chk1eb"><span class="nb">unfold</span> nat_sequence.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>n</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">Str_nth n (nat_sequence_from <span class="mi">0</span>) = n</div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="StreamExtras-v-chk1ec" style="display: none" type="checkbox"><label class="alectryon-input" for="StreamExtras-v-chk1ec"><span class="nb">rewrite</span> nat_sequence_from_nth.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>n</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">n + <span class="mi">0</span> = n</div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="bp">lia</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Qed</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
</span><span class="alectryon-sentence"><input class="alectryon-toggle" id="StreamExtras-v-chk1ed" style="display: none" type="checkbox"><label class="alectryon-input" for="StreamExtras-v-chk1ed"><span class="kn">Lemma</span> <span class="nf">nat_sequence_from_sorted</span> : <span class="kr">forall</span> <span class="nv">n</span>, ForAll2 lt (nat_sequence_from n).</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="kr">∀</span> <span class="nv">n</span> : nat, ForAll2 lt (nat_sequence_from n)</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="StreamExtras-v-chk1ee" style="display: none" type="checkbox"><label class="alectryon-input" for="StreamExtras-v-chk1ee"><span class="kn">Proof</span>.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="kr">∀</span> <span class="nv">n</span> : nat, ForAll2 lt (nat_sequence_from n)</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="StreamExtras-v-chk1ef" style="display: none" type="checkbox"><label class="alectryon-input" for="StreamExtras-v-chk1ef"><span class="nb">intro</span> n.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>n</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">ForAll2 lt (nat_sequence_from n)</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="StreamExtras-v-chk1f0" style="display: none" type="checkbox"><label class="alectryon-input" for="StreamExtras-v-chk1f0"><span class="nb">apply</span> ForAll2_forall.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>n</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="kr">∀</span> <span class="nv">n0</span> : nat,
  Str_nth n0 (nat_sequence_from n) &lt;
  Str_nth (S n0) (nat_sequence_from n)</div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="StreamExtras-v-chk1f1" style="display: none" type="checkbox"><label class="alectryon-input" for="StreamExtras-v-chk1f1"><span class="nb">intro</span> m.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>n, m</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">Str_nth m (nat_sequence_from n) &lt;
Str_nth (S m) (nat_sequence_from n)</div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="StreamExtras-v-chk1f2" style="display: none" type="checkbox"><label class="alectryon-input" for="StreamExtras-v-chk1f2"><span class="nb">rewrite</span> !nat_sequence_from_nth.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>n, m</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">m + n &lt; S m + n</div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="bp">lia</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Qed</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
</span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Definition</span> <span class="nf">nat_sequence_sorted</span> : ForAll2 lt nat_sequence :=
  nat_sequence_from_sorted <span class="mi">0</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
</span><span class="alectryon-sentence"><input class="alectryon-toggle" id="StreamExtras-v-chk1f3" style="display: none" type="checkbox"><label class="alectryon-input" for="StreamExtras-v-chk1f3"><span class="kn">Lemma</span> <span class="nf">nat_sequence_from_prefix_sorted</span>
  : <span class="kr">forall</span> <span class="nv">m</span> <span class="nv">n</span>, LocallySorted lt (stream_prefix (nat_sequence_from m) n).</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="kr">∀</span> <span class="nv">m</span> <span class="nv">n</span> : nat,
  LocallySorted lt
    (stream_prefix (nat_sequence_from m) n)</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="StreamExtras-v-chk1f4" style="display: none" type="checkbox"><label class="alectryon-input" for="StreamExtras-v-chk1f4"><span class="kn">Proof</span>.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="kr">∀</span> <span class="nv">m</span> <span class="nv">n</span> : nat,
  LocallySorted lt
    (stream_prefix (nat_sequence_from m) n)</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="StreamExtras-v-chk1f5" style="display: none" type="checkbox"><label class="alectryon-input" for="StreamExtras-v-chk1f5"><span class="nb">intros</span>.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>m, n</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">LocallySorted lt
  (stream_prefix (nat_sequence_from m) n)</div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="StreamExtras-v-chk1f6" style="display: none" type="checkbox"><label class="alectryon-input" for="StreamExtras-v-chk1f6"><span class="nb">apply</span> LocallySorted_ForAll2.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>m, n</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">ForAllSuffix2 lt
  (stream_prefix (nat_sequence_from m) n)</div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="StreamExtras-v-chk1f7" style="display: none" type="checkbox"><label class="alectryon-input" for="StreamExtras-v-chk1f7"><span class="nb">apply</span> stream_prefix_ForAll2.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>m, n</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">ForAll2 lt (nat_sequence_from m)</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><span class="alectryon-input"><span class="nb">apply</span> nat_sequence_from_sorted.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Qed</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
</span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Definition</span> <span class="nf">nat_sequence_prefix_sorted</span>
  : <span class="kr">forall</span> <span class="nv">n</span>, LocallySorted lt (stream_prefix nat_sequence n) :=
  nat_sequence_from_prefix_sorted <span class="mi">0</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
</span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Definition</span> <span class="nf">stream_subsequence</span>
  {<span class="nv">A</span> : <span class="kt">Type</span>}
  (<span class="nv">s</span> : Stream A)
  (<span class="nv">ns</span> : Stream nat)
  : Stream A
  := Streams.map (<span class="kr">fun</span> <span class="nv">k</span> =&gt; Str_nth k s) ns.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
</span><span class="alectryon-sentence"><input class="alectryon-toggle" id="StreamExtras-v-chk1f8" style="display: none" type="checkbox"><label class="alectryon-input" for="StreamExtras-v-chk1f8"><span class="kn">Lemma</span> <span class="nf">stream_prefix_nth_last</span>
  {<span class="nv">A</span> : <span class="kt">Type</span>}
  (<span class="nv">l</span> : Stream A)
  (<span class="nv">n</span> : nat)
  (<span class="nv">_last</span> : A)
  : List.<span class="nb">last</span> (stream_prefix l (S n)) _last = Str_nth n l.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>A</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>l</var><span class="hyp-type"><b>: </b><span>Stream A</span></span></span><br><span><var>n</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>_last</var><span class="hyp-type"><b>: </b><span>A</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">List.<span class="nb">last</span> (stream_prefix l (S n)) _last = Str_nth n l</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="StreamExtras-v-chk1f9" style="display: none" type="checkbox"><label class="alectryon-input" for="StreamExtras-v-chk1f9"><span class="kn">Proof</span>.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>A</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>l</var><span class="hyp-type"><b>: </b><span>Stream A</span></span></span><br><span><var>n</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>_last</var><span class="hyp-type"><b>: </b><span>A</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">List.<span class="nb">last</span> (stream_prefix l (S n)) _last = Str_nth n l</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="StreamExtras-v-chk1fa" style="display: none" type="checkbox"><label class="alectryon-input" for="StreamExtras-v-chk1fa"><span class="nb">specialize</span> (nth_error_last (stream_prefix l (S n)) n); <span class="nb">intro</span> Hlast.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>A</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>l</var><span class="hyp-type"><b>: </b><span>Stream A</span></span></span><br><span><var>n</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>_last</var><span class="hyp-type"><b>: </b><span>A</span></span></span><br><span><var>Hlast</var><span class="hyp-type"><b>: </b><span>S n = length (stream_prefix l (S n))
→ <span class="kr">∀</span> <span class="nv">_last</span> : A,
    nth_error (stream_prefix l (S n)) n =
    Some
      (List.<span class="nb">last</span> (stream_prefix l (S n)) _last)</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">List.<span class="nb">last</span> (stream_prefix l (S n)) _last = Str_nth n l</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="StreamExtras-v-chk1fb" style="display: none" type="checkbox"><label class="alectryon-input" for="StreamExtras-v-chk1fb"><span class="nb">specialize</span> (stream_prefix_length l (S n)); <span class="nb">intro</span> Hpref_len.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>A</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>l</var><span class="hyp-type"><b>: </b><span>Stream A</span></span></span><br><span><var>n</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>_last</var><span class="hyp-type"><b>: </b><span>A</span></span></span><br><span><var>Hlast</var><span class="hyp-type"><b>: </b><span>S n = length (stream_prefix l (S n))
→ <span class="kr">∀</span> <span class="nv">_last</span> : A,
    nth_error (stream_prefix l (S n)) n =
    Some
      (List.<span class="nb">last</span> (stream_prefix l (S n)) _last)</span></span></span><br><span><var>Hpref_len</var><span class="hyp-type"><b>: </b><span>length (stream_prefix l (S n)) = S n</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">List.<span class="nb">last</span> (stream_prefix l (S n)) _last = Str_nth n l</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="StreamExtras-v-chk1fc" style="display: none" type="checkbox"><label class="alectryon-input" for="StreamExtras-v-chk1fc"><span class="nb">symmetry in</span> Hpref_len.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>A</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>l</var><span class="hyp-type"><b>: </b><span>Stream A</span></span></span><br><span><var>n</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>_last</var><span class="hyp-type"><b>: </b><span>A</span></span></span><br><span><var>Hlast</var><span class="hyp-type"><b>: </b><span>S n = length (stream_prefix l (S n))
→ <span class="kr">∀</span> <span class="nv">_last</span> : A,
    nth_error (stream_prefix l (S n)) n =
    Some
      (List.<span class="nb">last</span> (stream_prefix l (S n)) _last)</span></span></span><br><span><var>Hpref_len</var><span class="hyp-type"><b>: </b><span>S n = length (stream_prefix l (S n))</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">List.<span class="nb">last</span> (stream_prefix l (S n)) _last = Str_nth n l</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="StreamExtras-v-chk1fd" style="display: none" type="checkbox"><label class="alectryon-input" for="StreamExtras-v-chk1fd"><span class="nb">specialize</span> (Hlast Hpref_len _last).</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>A</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>l</var><span class="hyp-type"><b>: </b><span>Stream A</span></span></span><br><span><var>n</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>_last</var><span class="hyp-type"><b>: </b><span>A</span></span></span><br><span><var>Hlast</var><span class="hyp-type"><b>: </b><span>nth_error (stream_prefix l (S n)) n =
Some (List.<span class="nb">last</span> (stream_prefix l (S n)) _last)</span></span></span><br><span><var>Hpref_len</var><span class="hyp-type"><b>: </b><span>S n = length (stream_prefix l (S n))</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">List.<span class="nb">last</span> (stream_prefix l (S n)) _last = Str_nth n l</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="StreamExtras-v-chk1fe" style="display: none" type="checkbox"><label class="alectryon-input" for="StreamExtras-v-chk1fe"><span class="nb">specialize</span> (stream_prefix_nth l (S n) n); <span class="nb">intro</span> Hnth.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>A</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>l</var><span class="hyp-type"><b>: </b><span>Stream A</span></span></span><br><span><var>n</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>_last</var><span class="hyp-type"><b>: </b><span>A</span></span></span><br><span><var>Hlast</var><span class="hyp-type"><b>: </b><span>nth_error (stream_prefix l (S n)) n =
Some (List.<span class="nb">last</span> (stream_prefix l (S n)) _last)</span></span></span><br><span><var>Hpref_len</var><span class="hyp-type"><b>: </b><span>S n = length (stream_prefix l (S n))</span></span></span><br><span><var>Hnth</var><span class="hyp-type"><b>: </b><span>n &lt; S n
→ nth_error (stream_prefix l (S n)) n =
  Some (Str_nth n l)</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">List.<span class="nb">last</span> (stream_prefix l (S n)) _last = Str_nth n l</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="StreamExtras-v-chk1ff" style="display: none" type="checkbox"><label class="alectryon-input" for="StreamExtras-v-chk1ff"><span class="nb">assert</span> (Hlt : n &lt; S n) <span class="bp">by</span> <span class="nb">constructor</span>.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>A</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>l</var><span class="hyp-type"><b>: </b><span>Stream A</span></span></span><br><span><var>n</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>_last</var><span class="hyp-type"><b>: </b><span>A</span></span></span><br><span><var>Hlast</var><span class="hyp-type"><b>: </b><span>nth_error (stream_prefix l (S n)) n =
Some (List.<span class="nb">last</span> (stream_prefix l (S n)) _last)</span></span></span><br><span><var>Hpref_len</var><span class="hyp-type"><b>: </b><span>S n = length (stream_prefix l (S n))</span></span></span><br><span><var>Hnth</var><span class="hyp-type"><b>: </b><span>n &lt; S n
→ nth_error (stream_prefix l (S n)) n =
  Some (Str_nth n l)</span></span></span><br><span><var>Hlt</var><span class="hyp-type"><b>: </b><span>n &lt; S n</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">List.<span class="nb">last</span> (stream_prefix l (S n)) _last = Str_nth n l</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="StreamExtras-v-chk200" style="display: none" type="checkbox"><label class="alectryon-input" for="StreamExtras-v-chk200"><span class="nb">specialize</span> (Hnth Hlt).</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>A</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>l</var><span class="hyp-type"><b>: </b><span>Stream A</span></span></span><br><span><var>n</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>_last</var><span class="hyp-type"><b>: </b><span>A</span></span></span><br><span><var>Hlast</var><span class="hyp-type"><b>: </b><span>nth_error (stream_prefix l (S n)) n =
Some (List.<span class="nb">last</span> (stream_prefix l (S n)) _last)</span></span></span><br><span><var>Hpref_len</var><span class="hyp-type"><b>: </b><span>S n = length (stream_prefix l (S n))</span></span></span><br><span><var>Hnth</var><span class="hyp-type"><b>: </b><span>nth_error (stream_prefix l (S n)) n =
Some (Str_nth n l)</span></span></span><br><span><var>Hlt</var><span class="hyp-type"><b>: </b><span>n &lt; S n</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">List.<span class="nb">last</span> (stream_prefix l (S n)) _last = Str_nth n l</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="StreamExtras-v-chk201" style="display: none" type="checkbox"><label class="alectryon-input" for="StreamExtras-v-chk201"><span class="nb">rewrite</span> Hnth <span class="kr">in</span> Hlast.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>A</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>l</var><span class="hyp-type"><b>: </b><span>Stream A</span></span></span><br><span><var>n</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>_last</var><span class="hyp-type"><b>: </b><span>A</span></span></span><br><span><var>Hlast</var><span class="hyp-type"><b>: </b><span>Some (Str_nth n l) =
Some (List.<span class="nb">last</span> (stream_prefix l (S n)) _last)</span></span></span><br><span><var>Hpref_len</var><span class="hyp-type"><b>: </b><span>S n = length (stream_prefix l (S n))</span></span></span><br><span><var>Hnth</var><span class="hyp-type"><b>: </b><span>nth_error (stream_prefix l (S n)) n =
Some (Str_nth n l)</span></span></span><br><span><var>Hlt</var><span class="hyp-type"><b>: </b><span>n &lt; S n</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">List.<span class="nb">last</span> (stream_prefix l (S n)) _last = Str_nth n l</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="StreamExtras-v-chk202" style="display: none" type="checkbox"><label class="alectryon-input" for="StreamExtras-v-chk202"><span class="nb">simpl</span>.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>A</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>l</var><span class="hyp-type"><b>: </b><span>Stream A</span></span></span><br><span><var>n</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>_last</var><span class="hyp-type"><b>: </b><span>A</span></span></span><br><span><var>Hlast</var><span class="hyp-type"><b>: </b><span>Some (Str_nth n l) =
Some (List.<span class="nb">last</span> (stream_prefix l (S n)) _last)</span></span></span><br><span><var>Hpref_len</var><span class="hyp-type"><b>: </b><span>S n = length (stream_prefix l (S n))</span></span></span><br><span><var>Hnth</var><span class="hyp-type"><b>: </b><span>nth_error (stream_prefix l (S n)) n =
Some (Str_nth n l)</span></span></span><br><span><var>Hlt</var><span class="hyp-type"><b>: </b><span>n &lt; S n</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">List.<span class="nb">last</span>
  <span class="kr">match</span> l <span class="kr">with</span>
  | Cons a l =&gt; a :: stream_prefix l n
  <span class="kr">end</span> _last = Str_nth n l</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="StreamExtras-v-chk203" style="display: none" type="checkbox"><label class="alectryon-input" for="StreamExtras-v-chk203"><span class="nb">inversion</span> Hlast.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>A</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>l</var><span class="hyp-type"><b>: </b><span>Stream A</span></span></span><br><span><var>n</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>_last</var><span class="hyp-type"><b>: </b><span>A</span></span></span><br><span><var>Hlast</var><span class="hyp-type"><b>: </b><span>Some (Str_nth n l) =
Some (List.<span class="nb">last</span> (stream_prefix l (S n)) _last)</span></span></span><br><span><var>Hpref_len</var><span class="hyp-type"><b>: </b><span>S n = length (stream_prefix l (S n))</span></span></span><br><span><var>Hnth</var><span class="hyp-type"><b>: </b><span>nth_error (stream_prefix l (S n)) n =
Some (Str_nth n l)</span></span></span><br><span><var>Hlt</var><span class="hyp-type"><b>: </b><span>n &lt; S n</span></span></span><br><span><var>H0</var><span class="hyp-type"><b>: </b><span>Str_nth n l =
List.<span class="nb">last</span>
  <span class="kr">match</span> l <span class="kr">with</span>
  | Cons a l =&gt; a :: stream_prefix l n
  <span class="kr">end</span> _last</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">Str_nth n l = Str_nth n l</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><span class="alectryon-input"><span class="bp">reflexivity</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Qed</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
</span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Section</span> <span class="nf">infinitely_often</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
</span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Context</span>
  [A : <span class="kt">Type</span>]
  (P : A -&gt; <span class="kt">Prop</span>)
  {Pdec : <span class="kr">forall</span> <span class="nv">a</span>, Decision (P a)}
  .</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
</span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Definition</span> <span class="nf">InfinitelyOften</span> : Stream A -&gt; <span class="kt">Prop</span> :=
  ForAll (Exists1 P).</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
</span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Definition</span> <span class="nf">FinitelyMany</span> : Stream A -&gt; <span class="kt">Prop</span> :=
  Exists (ForAll1 (<span class="kr">fun</span> <span class="nv">a</span> =&gt; ~ P a)).</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
</span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Definition</span> <span class="nf">FinitelyManyBound</span> (<span class="nv">s</span> : Stream A) : <span class="kt">Type</span> :=
  { n : nat | ForAll1 (<span class="kr">fun</span> <span class="nv">a</span> =&gt; ~ P a) (Str_nth_tl n s)}.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
</span><span class="alectryon-sentence"><input class="alectryon-toggle" id="StreamExtras-v-chk204" style="display: none" type="checkbox"><label class="alectryon-input" for="StreamExtras-v-chk204"><span class="kn">Lemma</span> <span class="nf">FinitelyMany_from_bound</span>
  : <span class="kr">forall</span> <span class="nv">s</span>, FinitelyManyBound s -&gt; FinitelyMany s.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>A</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>P</var><span class="hyp-type"><b>: </b><span>A → <span class="kt">Prop</span></span></span></span><br><span><var>Pdec</var><span class="hyp-type"><b>: </b><span><span class="kr">∀</span> <span class="nv">a</span> : A, Decision (P a)</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="kr">∀</span> <span class="nv">s</span> : Stream A, FinitelyManyBound s → FinitelyMany s</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="StreamExtras-v-chk205" style="display: none" type="checkbox"><label class="alectryon-input" for="StreamExtras-v-chk205"><span class="kn">Proof</span>.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>A</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>P</var><span class="hyp-type"><b>: </b><span>A → <span class="kt">Prop</span></span></span></span><br><span><var>Pdec</var><span class="hyp-type"><b>: </b><span><span class="kr">∀</span> <span class="nv">a</span> : A, Decision (P a)</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="kr">∀</span> <span class="nv">s</span> : Stream A, FinitelyManyBound s → FinitelyMany s</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="StreamExtras-v-chk206" style="display: none" type="checkbox"><label class="alectryon-input" for="StreamExtras-v-chk206"><span class="nb">intros</span> s [n Hn].</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>A</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>P</var><span class="hyp-type"><b>: </b><span>A → <span class="kt">Prop</span></span></span></span><br><span><var>Pdec</var><span class="hyp-type"><b>: </b><span><span class="kr">∀</span> <span class="nv">a</span> : A, Decision (P a)</span></span></span><br><span><var>s</var><span class="hyp-type"><b>: </b><span>Stream A</span></span></span><br><span><var>n</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>Hn</var><span class="hyp-type"><b>: </b><span>ForAll1 (<span class="kr">λ</span> <span class="nv">a</span> : A, ¬ P a) (Str_nth_tl n s)</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">FinitelyMany s</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="StreamExtras-v-chk207" style="display: none" type="checkbox"><label class="alectryon-input" for="StreamExtras-v-chk207"><span class="nb">apply</span> Exists_Str_nth_tl.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>A</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>P</var><span class="hyp-type"><b>: </b><span>A → <span class="kt">Prop</span></span></span></span><br><span><var>Pdec</var><span class="hyp-type"><b>: </b><span><span class="kr">∀</span> <span class="nv">a</span> : A, Decision (P a)</span></span></span><br><span><var>s</var><span class="hyp-type"><b>: </b><span>Stream A</span></span></span><br><span><var>n</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>Hn</var><span class="hyp-type"><b>: </b><span>ForAll1 (<span class="kr">λ</span> <span class="nv">a</span> : A, ¬ P a) (Str_nth_tl n s)</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="kr">∃</span> <span class="nv">n</span> : nat, ForAll1 (<span class="kr">λ</span> <span class="nv">a</span> : A, ¬ P a) (Str_nth_tl n s)</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="StreamExtras-v-chk208" style="display: none" type="checkbox"><label class="alectryon-input" for="StreamExtras-v-chk208"><span class="kr">exists</span> <span class="nv">n</span>.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>A</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>P</var><span class="hyp-type"><b>: </b><span>A → <span class="kt">Prop</span></span></span></span><br><span><var>Pdec</var><span class="hyp-type"><b>: </b><span><span class="kr">∀</span> <span class="nv">a</span> : A, Decision (P a)</span></span></span><br><span><var>s</var><span class="hyp-type"><b>: </b><span>Stream A</span></span></span><br><span><var>n</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>Hn</var><span class="hyp-type"><b>: </b><span>ForAll1 (<span class="kr">λ</span> <span class="nv">a</span> : A, ¬ P a) (Str_nth_tl n s)</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">ForAll1 (<span class="kr">λ</span> <span class="nv">a</span> : A, ¬ P a) (Str_nth_tl n s)</div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="bp">assumption</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Qed</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
</span><span class="alectryon-sentence"><input class="alectryon-toggle" id="StreamExtras-v-chk209" style="display: none" type="checkbox"><label class="alectryon-input" for="StreamExtras-v-chk209"><span class="kn">Lemma</span> <span class="nf">InfinitelyOften_tl</span> <span class="nv">s</span>
  : InfinitelyOften s -&gt; InfinitelyOften (tl s).</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>A</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>P</var><span class="hyp-type"><b>: </b><span>A → <span class="kt">Prop</span></span></span></span><br><span><var>Pdec</var><span class="hyp-type"><b>: </b><span><span class="kr">∀</span> <span class="nv">a</span> : A, Decision (P a)</span></span></span><br><span><var>s</var><span class="hyp-type"><b>: </b><span>Stream A</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">InfinitelyOften s → InfinitelyOften (tl s)</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="StreamExtras-v-chk20a" style="display: none" type="checkbox"><label class="alectryon-input" for="StreamExtras-v-chk20a"><span class="kn">Proof</span>.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>A</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>P</var><span class="hyp-type"><b>: </b><span>A → <span class="kt">Prop</span></span></span></span><br><span><var>Pdec</var><span class="hyp-type"><b>: </b><span><span class="kr">∀</span> <span class="nv">a</span> : A, Decision (P a)</span></span></span><br><span><var>s</var><span class="hyp-type"><b>: </b><span>Stream A</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">InfinitelyOften s → InfinitelyOften (tl s)</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="StreamExtras-v-chk20b" style="display: none" type="checkbox"><label class="alectryon-input" for="StreamExtras-v-chk20b"><span class="nb">inversion</span> <span class="mi">1</span>.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>A</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>P</var><span class="hyp-type"><b>: </b><span>A → <span class="kt">Prop</span></span></span></span><br><span><var>Pdec</var><span class="hyp-type"><b>: </b><span><span class="kr">∀</span> <span class="nv">a</span> : A, Decision (P a)</span></span></span><br><span><var>s</var><span class="hyp-type"><b>: </b><span>Stream A</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>InfinitelyOften s</span></span></span><br><span><var>H0</var><span class="hyp-type"><b>: </b><span>Exists1 P s</span></span></span><br><span><var>H1</var><span class="hyp-type"><b>: </b><span>ForAll (Exists1 P) (tl s)</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">InfinitelyOften (tl s)</div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="bp">assumption</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Qed</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
</span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Definition</span> <span class="nf">InfinitelyOften_nth_tl</span>
  : <span class="kr">forall</span> <span class="nv">n</span> <span class="nv">s</span>, InfinitelyOften s -&gt; InfinitelyOften (Str_nth_tl n s)
  := (@ForAll_Str_nth_tl _ (Exists1 P)).</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
</span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">End</span> <span class="nf">infinitely_often</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
</span><span class="alectryon-sentence"><input class="alectryon-toggle" id="StreamExtras-v-chk20c" style="display: none" type="checkbox"><label class="alectryon-input" for="StreamExtras-v-chk20c"><span class="kn">Lemma</span> <span class="nf">InfinitelyOften_impl</span> [A : <span class="kt">Type</span>] (P Q : A -&gt; <span class="kt">Prop</span>) (HPQ : <span class="kr">forall</span> <span class="nv">a</span>, P a -&gt; Q a)
  : <span class="kr">forall</span> <span class="nv">s</span>, InfinitelyOften P s -&gt; InfinitelyOften Q s.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>A</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>P, Q</var><span class="hyp-type"><b>: </b><span>A → <span class="kt">Prop</span></span></span></span><br><span><var>HPQ</var><span class="hyp-type"><b>: </b><span><span class="kr">∀</span> <span class="nv">a</span> : A, P a → Q a</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="kr">∀</span> <span class="nv">s</span> : Stream A,
  InfinitelyOften P s → InfinitelyOften Q s</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="StreamExtras-v-chk20d" style="display: none" type="checkbox"><label class="alectryon-input" for="StreamExtras-v-chk20d"><span class="kn">Proof</span>.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>A</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>P, Q</var><span class="hyp-type"><b>: </b><span>A → <span class="kt">Prop</span></span></span></span><br><span><var>HPQ</var><span class="hyp-type"><b>: </b><span><span class="kr">∀</span> <span class="nv">a</span> : A, P a → Q a</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="kr">∀</span> <span class="nv">s</span> : Stream A,
  InfinitelyOften P s → InfinitelyOften Q s</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="StreamExtras-v-chk20e" style="display: none" type="checkbox"><label class="alectryon-input" for="StreamExtras-v-chk20e"><span class="nb">unfold</span> InfinitelyOften.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>A</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>P, Q</var><span class="hyp-type"><b>: </b><span>A → <span class="kt">Prop</span></span></span></span><br><span><var>HPQ</var><span class="hyp-type"><b>: </b><span><span class="kr">∀</span> <span class="nv">a</span> : A, P a → Q a</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="kr">∀</span> <span class="nv">s</span> : Stream A,
  ForAll (Exists1 P) s → ForAll (Exists1 Q) s</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="StreamExtras-v-chk20f" style="display: none" type="checkbox"><label class="alectryon-input" for="StreamExtras-v-chk20f"><span class="kr">cofix</span> IH.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>A</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>P, Q</var><span class="hyp-type"><b>: </b><span>A → <span class="kt">Prop</span></span></span></span><br><span><var>HPQ</var><span class="hyp-type"><b>: </b><span><span class="kr">∀</span> <span class="nv">a</span> : A, P a → Q a</span></span></span><br><span><var>IH</var><span class="hyp-type"><b>: </b><span><span class="kr">∀</span> <span class="nv">s</span> : Stream A,
  ForAll (Exists1 P) s → ForAll (Exists1 Q) s</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="kr">∀</span> <span class="nv">s</span> : Stream A,
  ForAll (Exists1 P) s → ForAll (Exists1 Q) s</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="StreamExtras-v-chk210" style="display: none" type="checkbox"><label class="alectryon-input" for="StreamExtras-v-chk210"><span class="nb">intros</span> [a s] H.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>A</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>P, Q</var><span class="hyp-type"><b>: </b><span>A → <span class="kt">Prop</span></span></span></span><br><span><var>HPQ</var><span class="hyp-type"><b>: </b><span><span class="kr">∀</span> <span class="nv">a</span> : A, P a → Q a</span></span></span><br><span><var>IH</var><span class="hyp-type"><b>: </b><span><span class="kr">∀</span> <span class="nv">s</span> : Stream A,
  ForAll (Exists1 P) s → ForAll (Exists1 Q) s</span></span></span><br><span><var>a</var><span class="hyp-type"><b>: </b><span>A</span></span></span><br><span><var>s</var><span class="hyp-type"><b>: </b><span>Stream A</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>ForAll (Exists1 P) (Cons a s)</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">ForAll (Exists1 Q) (Cons a s)</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="StreamExtras-v-chk211" style="display: none" type="checkbox"><label class="alectryon-input" for="StreamExtras-v-chk211"><span class="nb">inversion</span> H.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>A</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>P, Q</var><span class="hyp-type"><b>: </b><span>A → <span class="kt">Prop</span></span></span></span><br><span><var>HPQ</var><span class="hyp-type"><b>: </b><span><span class="kr">∀</span> <span class="nv">a</span> : A, P a → Q a</span></span></span><br><span><var>IH</var><span class="hyp-type"><b>: </b><span><span class="kr">∀</span> <span class="nv">s</span> : Stream A,
  ForAll (Exists1 P) s → ForAll (Exists1 Q) s</span></span></span><br><span><var>a</var><span class="hyp-type"><b>: </b><span>A</span></span></span><br><span><var>s</var><span class="hyp-type"><b>: </b><span>Stream A</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>ForAll (Exists1 P) (Cons a s)</span></span></span><br><span><var>H0</var><span class="hyp-type"><b>: </b><span>Exists1 P (Cons a s)</span></span></span><br><span><var>H1</var><span class="hyp-type"><b>: </b><span>ForAll (Exists1 P) (tl (Cons a s))</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">ForAll (Exists1 Q) (Cons a s)</div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="StreamExtras-v-chk212" style="display: none" type="checkbox"><label class="alectryon-input" for="StreamExtras-v-chk212"><span class="nb">simpl</span> <span class="kr">in</span> H1.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>A</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>P, Q</var><span class="hyp-type"><b>: </b><span>A → <span class="kt">Prop</span></span></span></span><br><span><var>HPQ</var><span class="hyp-type"><b>: </b><span><span class="kr">∀</span> <span class="nv">a</span> : A, P a → Q a</span></span></span><br><span><var>IH</var><span class="hyp-type"><b>: </b><span><span class="kr">∀</span> <span class="nv">s</span> : Stream A,
  ForAll (Exists1 P) s → ForAll (Exists1 Q) s</span></span></span><br><span><var>a</var><span class="hyp-type"><b>: </b><span>A</span></span></span><br><span><var>s</var><span class="hyp-type"><b>: </b><span>Stream A</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>ForAll (Exists1 P) (Cons a s)</span></span></span><br><span><var>H0</var><span class="hyp-type"><b>: </b><span>Exists1 P (Cons a s)</span></span></span><br><span><var>H1</var><span class="hyp-type"><b>: </b><span>ForAll (Exists1 P) s</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">ForAll (Exists1 Q) (Cons a s)</div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="StreamExtras-v-chk213" style="display: none" type="checkbox"><label class="alectryon-input" for="StreamExtras-v-chk213"><span class="nb">apply</span> IH <span class="kr">in</span> H1.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>A</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>P, Q</var><span class="hyp-type"><b>: </b><span>A → <span class="kt">Prop</span></span></span></span><br><span><var>HPQ</var><span class="hyp-type"><b>: </b><span><span class="kr">∀</span> <span class="nv">a</span> : A, P a → Q a</span></span></span><br><span><var>IH</var><span class="hyp-type"><b>: </b><span><span class="kr">∀</span> <span class="nv">s</span> : Stream A,
  ForAll (Exists1 P) s → ForAll (Exists1 Q) s</span></span></span><br><span><var>a</var><span class="hyp-type"><b>: </b><span>A</span></span></span><br><span><var>s</var><span class="hyp-type"><b>: </b><span>Stream A</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>ForAll (Exists1 P) (Cons a s)</span></span></span><br><span><var>H0</var><span class="hyp-type"><b>: </b><span>Exists1 P (Cons a s)</span></span></span><br><span><var>H1</var><span class="hyp-type"><b>: </b><span>ForAll (Exists1 Q) s</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">ForAll (Exists1 Q) (Cons a s)</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="StreamExtras-v-chk214" style="display: none" type="checkbox"><label class="alectryon-input" for="StreamExtras-v-chk214"><span class="nb">constructor</span>; [|<span class="bp">assumption</span>].</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>A</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>P, Q</var><span class="hyp-type"><b>: </b><span>A → <span class="kt">Prop</span></span></span></span><br><span><var>HPQ</var><span class="hyp-type"><b>: </b><span><span class="kr">∀</span> <span class="nv">a</span> : A, P a → Q a</span></span></span><br><span><var>IH</var><span class="hyp-type"><b>: </b><span><span class="kr">∀</span> <span class="nv">s</span> : Stream A,
  ForAll (Exists1 P) s → ForAll (Exists1 Q) s</span></span></span><br><span><var>a</var><span class="hyp-type"><b>: </b><span>A</span></span></span><br><span><var>s</var><span class="hyp-type"><b>: </b><span>Stream A</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>ForAll (Exists1 P) (Cons a s)</span></span></span><br><span><var>H0</var><span class="hyp-type"><b>: </b><span>Exists1 P (Cons a s)</span></span></span><br><span><var>H1</var><span class="hyp-type"><b>: </b><span>ForAll (Exists1 Q) s</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">Exists1 Q (Cons a s)</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="StreamExtras-v-chk215" style="display: none" type="checkbox"><label class="alectryon-input" for="StreamExtras-v-chk215"><span class="nb">apply</span> Exists1_exists <span class="kr">in</span> H0 <span class="kr">as</span> [n Hn].</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>A</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>P, Q</var><span class="hyp-type"><b>: </b><span>A → <span class="kt">Prop</span></span></span></span><br><span><var>HPQ</var><span class="hyp-type"><b>: </b><span><span class="kr">∀</span> <span class="nv">a</span> : A, P a → Q a</span></span></span><br><span><var>IH</var><span class="hyp-type"><b>: </b><span><span class="kr">∀</span> <span class="nv">s</span> : Stream A,
  ForAll (Exists1 P) s → ForAll (Exists1 Q) s</span></span></span><br><span><var>a</var><span class="hyp-type"><b>: </b><span>A</span></span></span><br><span><var>s</var><span class="hyp-type"><b>: </b><span>Stream A</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>ForAll (Exists1 P) (Cons a s)</span></span></span><br><span><var>n</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>Hn</var><span class="hyp-type"><b>: </b><span>P (Str_nth n (Cons a s))</span></span></span><br><span><var>H1</var><span class="hyp-type"><b>: </b><span>ForAll (Exists1 Q) s</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">Exists1 Q (Cons a s)</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="StreamExtras-v-chk216" style="display: none" type="checkbox"><label class="alectryon-input" for="StreamExtras-v-chk216"><span class="nb">apply</span> Exists1_exists.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>A</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>P, Q</var><span class="hyp-type"><b>: </b><span>A → <span class="kt">Prop</span></span></span></span><br><span><var>HPQ</var><span class="hyp-type"><b>: </b><span><span class="kr">∀</span> <span class="nv">a</span> : A, P a → Q a</span></span></span><br><span><var>IH</var><span class="hyp-type"><b>: </b><span><span class="kr">∀</span> <span class="nv">s</span> : Stream A,
  ForAll (Exists1 P) s → ForAll (Exists1 Q) s</span></span></span><br><span><var>a</var><span class="hyp-type"><b>: </b><span>A</span></span></span><br><span><var>s</var><span class="hyp-type"><b>: </b><span>Stream A</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>ForAll (Exists1 P) (Cons a s)</span></span></span><br><span><var>n</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>Hn</var><span class="hyp-type"><b>: </b><span>P (Str_nth n (Cons a s))</span></span></span><br><span><var>H1</var><span class="hyp-type"><b>: </b><span>ForAll (Exists1 Q) s</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="kr">∃</span> <span class="nv">n</span> : nat, Q (Str_nth n (Cons a s))</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="StreamExtras-v-chk217" style="display: none" type="checkbox"><label class="alectryon-input" for="StreamExtras-v-chk217"><span class="kr">exists</span> <span class="nv">n</span>.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>A</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>P, Q</var><span class="hyp-type"><b>: </b><span>A → <span class="kt">Prop</span></span></span></span><br><span><var>HPQ</var><span class="hyp-type"><b>: </b><span><span class="kr">∀</span> <span class="nv">a</span> : A, P a → Q a</span></span></span><br><span><var>IH</var><span class="hyp-type"><b>: </b><span><span class="kr">∀</span> <span class="nv">s</span> : Stream A,
  ForAll (Exists1 P) s → ForAll (Exists1 Q) s</span></span></span><br><span><var>a</var><span class="hyp-type"><b>: </b><span>A</span></span></span><br><span><var>s</var><span class="hyp-type"><b>: </b><span>Stream A</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>ForAll (Exists1 P) (Cons a s)</span></span></span><br><span><var>n</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>Hn</var><span class="hyp-type"><b>: </b><span>P (Str_nth n (Cons a s))</span></span></span><br><span><var>H1</var><span class="hyp-type"><b>: </b><span>ForAll (Exists1 Q) s</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">Q (Str_nth n (Cons a s))</div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="StreamExtras-v-chk218" style="display: none" type="checkbox"><label class="alectryon-input" for="StreamExtras-v-chk218"><span class="nb">apply</span> HPQ.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>A</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>P, Q</var><span class="hyp-type"><b>: </b><span>A → <span class="kt">Prop</span></span></span></span><br><span><var>HPQ</var><span class="hyp-type"><b>: </b><span><span class="kr">∀</span> <span class="nv">a</span> : A, P a → Q a</span></span></span><br><span><var>IH</var><span class="hyp-type"><b>: </b><span><span class="kr">∀</span> <span class="nv">s</span> : Stream A,
  ForAll (Exists1 P) s → ForAll (Exists1 Q) s</span></span></span><br><span><var>a</var><span class="hyp-type"><b>: </b><span>A</span></span></span><br><span><var>s</var><span class="hyp-type"><b>: </b><span>Stream A</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>ForAll (Exists1 P) (Cons a s)</span></span></span><br><span><var>n</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>Hn</var><span class="hyp-type"><b>: </b><span>P (Str_nth n (Cons a s))</span></span></span><br><span><var>H1</var><span class="hyp-type"><b>: </b><span>ForAll (Exists1 Q) s</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">P (Str_nth n (Cons a s))</div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="bp">assumption</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Qed</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
</span><span class="alectryon-sentence"><input class="alectryon-toggle" id="StreamExtras-v-chk219" style="display: none" type="checkbox"><label class="alectryon-input" for="StreamExtras-v-chk219"><span class="kn">Lemma</span> <span class="nf">FinitelyManyBound_impl_rev</span>
 [A : <span class="kt">Type</span>] (P Q : A -&gt; <span class="kt">Prop</span>) (HPQ : <span class="kr">forall</span> <span class="nv">a</span>, P a -&gt; Q a)
 : <span class="kr">forall</span> <span class="nv">s</span>, FinitelyManyBound Q s -&gt; FinitelyManyBound P s.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>A</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>P, Q</var><span class="hyp-type"><b>: </b><span>A → <span class="kt">Prop</span></span></span></span><br><span><var>HPQ</var><span class="hyp-type"><b>: </b><span><span class="kr">∀</span> <span class="nv">a</span> : A, P a → Q a</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="kr">∀</span> <span class="nv">s</span> : Stream A,
  FinitelyManyBound Q s → FinitelyManyBound P s</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="StreamExtras-v-chk21a" style="display: none" type="checkbox"><label class="alectryon-input" for="StreamExtras-v-chk21a"><span class="kn">Proof</span>.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>A</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>P, Q</var><span class="hyp-type"><b>: </b><span>A → <span class="kt">Prop</span></span></span></span><br><span><var>HPQ</var><span class="hyp-type"><b>: </b><span><span class="kr">∀</span> <span class="nv">a</span> : A, P a → Q a</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="kr">∀</span> <span class="nv">s</span> : Stream A,
  FinitelyManyBound Q s → FinitelyManyBound P s</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="StreamExtras-v-chk21b" style="display: none" type="checkbox"><label class="alectryon-input" for="StreamExtras-v-chk21b"><span class="nb">intros</span> s [n Hn].</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>A</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>P, Q</var><span class="hyp-type"><b>: </b><span>A → <span class="kt">Prop</span></span></span></span><br><span><var>HPQ</var><span class="hyp-type"><b>: </b><span><span class="kr">∀</span> <span class="nv">a</span> : A, P a → Q a</span></span></span><br><span><var>s</var><span class="hyp-type"><b>: </b><span>Stream A</span></span></span><br><span><var>n</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>Hn</var><span class="hyp-type"><b>: </b><span>ForAll1 (<span class="kr">λ</span> <span class="nv">a</span> : A, ¬ Q a) (Str_nth_tl n s)</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">FinitelyManyBound P s</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="StreamExtras-v-chk21c" style="display: none" type="checkbox"><label class="alectryon-input" for="StreamExtras-v-chk21c"><span class="kr">exists</span> <span class="nv">n</span>.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>A</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>P, Q</var><span class="hyp-type"><b>: </b><span>A → <span class="kt">Prop</span></span></span></span><br><span><var>HPQ</var><span class="hyp-type"><b>: </b><span><span class="kr">∀</span> <span class="nv">a</span> : A, P a → Q a</span></span></span><br><span><var>s</var><span class="hyp-type"><b>: </b><span>Stream A</span></span></span><br><span><var>n</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>Hn</var><span class="hyp-type"><b>: </b><span>ForAll1 (<span class="kr">λ</span> <span class="nv">a</span> : A, ¬ Q a) (Str_nth_tl n s)</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">ForAll1 (<span class="kr">λ</span> <span class="nv">a</span> : A, ¬ P a) (Str_nth_tl n s)</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="StreamExtras-v-chk21d" style="display: none" type="checkbox"><label class="alectryon-input" for="StreamExtras-v-chk21d"><span class="nb">apply</span> ForAll1_forall.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>A</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>P, Q</var><span class="hyp-type"><b>: </b><span>A → <span class="kt">Prop</span></span></span></span><br><span><var>HPQ</var><span class="hyp-type"><b>: </b><span><span class="kr">∀</span> <span class="nv">a</span> : A, P a → Q a</span></span></span><br><span><var>s</var><span class="hyp-type"><b>: </b><span>Stream A</span></span></span><br><span><var>n</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>Hn</var><span class="hyp-type"><b>: </b><span>ForAll1 (<span class="kr">λ</span> <span class="nv">a</span> : A, ¬ Q a) (Str_nth_tl n s)</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="kr">∀</span> <span class="nv">n0</span> : nat, ¬ P (Str_nth n0 (Str_nth_tl n s))</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="StreamExtras-v-chk21e" style="display: none" type="checkbox"><label class="alectryon-input" for="StreamExtras-v-chk21e"><span class="nb">rewrite</span> ForAll1_forall <span class="kr">in</span> Hn.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>A</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>P, Q</var><span class="hyp-type"><b>: </b><span>A → <span class="kt">Prop</span></span></span></span><br><span><var>HPQ</var><span class="hyp-type"><b>: </b><span><span class="kr">∀</span> <span class="nv">a</span> : A, P a → Q a</span></span></span><br><span><var>s</var><span class="hyp-type"><b>: </b><span>Stream A</span></span></span><br><span><var>n</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>Hn</var><span class="hyp-type"><b>: </b><span><span class="kr">∀</span> <span class="nv">n0</span> : nat, ¬ Q (Str_nth n0 (Str_nth_tl n s))</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="kr">∀</span> <span class="nv">n0</span> : nat, ¬ P (Str_nth n0 (Str_nth_tl n s))</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="StreamExtras-v-chk21f" style="display: none" type="checkbox"><label class="alectryon-input" for="StreamExtras-v-chk21f"><span class="nb">intros</span> n&#39; Hn&#39;.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>A</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>P, Q</var><span class="hyp-type"><b>: </b><span>A → <span class="kt">Prop</span></span></span></span><br><span><var>HPQ</var><span class="hyp-type"><b>: </b><span><span class="kr">∀</span> <span class="nv">a</span> : A, P a → Q a</span></span></span><br><span><var>s</var><span class="hyp-type"><b>: </b><span>Stream A</span></span></span><br><span><var>n</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>Hn</var><span class="hyp-type"><b>: </b><span><span class="kr">∀</span> <span class="nv">n0</span> : nat, ¬ Q (Str_nth n0 (Str_nth_tl n s))</span></span></span><br><span><var>n'</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>Hn'</var><span class="hyp-type"><b>: </b><span>P (Str_nth n&#39; (Str_nth_tl n s))</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="kt">False</span></div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="StreamExtras-v-chk220" style="display: none" type="checkbox"><label class="alectryon-input" for="StreamExtras-v-chk220"><span class="nb">elim</span> (Hn n&#39;).</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>A</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>P, Q</var><span class="hyp-type"><b>: </b><span>A → <span class="kt">Prop</span></span></span></span><br><span><var>HPQ</var><span class="hyp-type"><b>: </b><span><span class="kr">∀</span> <span class="nv">a</span> : A, P a → Q a</span></span></span><br><span><var>s</var><span class="hyp-type"><b>: </b><span>Stream A</span></span></span><br><span><var>n</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>Hn</var><span class="hyp-type"><b>: </b><span><span class="kr">∀</span> <span class="nv">n0</span> : nat, ¬ Q (Str_nth n0 (Str_nth_tl n s))</span></span></span><br><span><var>n'</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>Hn'</var><span class="hyp-type"><b>: </b><span>P (Str_nth n&#39; (Str_nth_tl n s))</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">Q (Str_nth n&#39; (Str_nth_tl n s))</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="StreamExtras-v-chk221" style="display: none" type="checkbox"><label class="alectryon-input" for="StreamExtras-v-chk221"><span class="nb">revert</span> Hn&#39;.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>A</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>P, Q</var><span class="hyp-type"><b>: </b><span>A → <span class="kt">Prop</span></span></span></span><br><span><var>HPQ</var><span class="hyp-type"><b>: </b><span><span class="kr">∀</span> <span class="nv">a</span> : A, P a → Q a</span></span></span><br><span><var>s</var><span class="hyp-type"><b>: </b><span>Stream A</span></span></span><br><span><var>n</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>Hn</var><span class="hyp-type"><b>: </b><span><span class="kr">∀</span> <span class="nv">n0</span> : nat, ¬ Q (Str_nth n0 (Str_nth_tl n s))</span></span></span><br><span><var>n'</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">P (Str_nth n&#39; (Str_nth_tl n s))
→ Q (Str_nth n&#39; (Str_nth_tl n s))</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><span class="alectryon-input"><span class="nb">apply</span> HPQ.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Qed</span>.</span></span></pre></article></body></html>