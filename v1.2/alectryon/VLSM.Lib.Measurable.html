<!DOCTYPE html>
<html class="alectryon-standalone"><head><title>Measurable.v</title><meta charset="utf-8"><meta content="Alectryon" name="generator"><meta name="viewport" content="width=device-width, initial-scale=1"><link href="alectryon.css" rel="stylesheet"><link href="pygments.css" rel="stylesheet">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/IBM-type/0.5.4/css/ibm-type.min.css" integrity="sha512-sky5cf9Ts6FY1kstGOBHSybfKqdHR41M0Ldb0BjNiv3ifltoQIsg0zIaQ+wwdwgQ0w9vKFW7Js50lxH9vqNSSw==" crossorigin="anonymous" />
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/firacode/5.2.0/fira_code.min.css" integrity="sha512-MbysAYimH1hH2xYzkkMHB6MqxBqfP0megxsCLknbYqHVwXTCg9IqHbk+ZP/vnhO8UEW6PaXAkKe2vQ+SWACxxA==" crossorigin="anonymous" /><script src="alectryon.js"></script></head><body><article class="alectryon-root alectryon-windowed alectryon-coqdoc"><div class="alectryon-banner">Built with <a href="https://github.com/cpitclaudel/alectryon/">Alectryon</a>, running Coq+SerAPI v8.15.0+0.15.2. Bubbles (<span class="alectryon-bubble"></span>) indicate interactive fragments: hover for details, tap to reveal contents. Use <kbd>Ctrl+‚Üë</kbd> <kbd>Ctrl+‚Üì</kbd> to navigate, <kbd>Ctrl+üñ±Ô∏è</kbd> to focus. On Mac, use <kbd>‚åò</kbd> instead of <kbd>Ctrl</kbd>.</div><pre class="alectryon-io highlight"><!-- Generator: Alectryon --><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">From</span> stdpp <span class="kn">Require Import</span> prelude.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">From</span> Coq <span class="kn">Require Import</span> Reals.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">From</span> VLSM.Lib <span class="kn">Require Import</span> Preamble ListExtras StdppListSet ListSetExtras.</span></span></pre><div class="doc">
<a id="lab1"></a><h1 class="section">Measure-related definitions and lemmas</h1>
</div><pre class="alectryon-io highlight"><!-- Generator: Alectryon --><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Definition</span> <span class="nf">pos_R</span> := {r : R | (r &gt; <span class="mi">0</span>)%R}.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
</span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Class</span> <span class="nf">Measurable</span> <span class="nv">V</span> := { weight : V -&gt; pos_R}.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><span class="alectryon-input">#[<span class="kn">global</span>] <span class="kn">Hint Mode</span> Measurable ! : typeclass_instances.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
</span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Definition</span> <span class="nf">sum_weights</span> `{Measurable V} (l : list V) : R :=
  fold_right (<span class="kr">fun</span> <span class="nv">v</span> <span class="nv">r</span> =&gt; (proj1_sig (weight v) + r)%R) <span class="mi">0</span>%R l.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
</span><span class="alectryon-sentence"><input class="alectryon-toggle" id="Measurable-v-chk0" style="display: none" type="checkbox"><label class="alectryon-input" for="Measurable-v-chk0"><span class="kn">Lemma</span> <span class="nf">sum_weights_positive</span>
  `{Measurable V} (l : list V)
  : (<span class="mi">0</span> &lt;= sum_weights l)%R.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>V</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>Measurable V</span></span></span><br><span><var>l</var><span class="hyp-type"><b>: </b><span>list V</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">(<span class="mi">0</span> &lt;= sum_weights l)%R</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="Measurable-v-chk1" style="display: none" type="checkbox"><label class="alectryon-input" for="Measurable-v-chk1"><span class="kn">Proof</span>.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>V</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>Measurable V</span></span></span><br><span><var>l</var><span class="hyp-type"><b>: </b><span>list V</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">(<span class="mi">0</span> &lt;= sum_weights l)%R</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="Measurable-v-chk2" style="display: none" type="checkbox"><label class="alectryon-input" for="Measurable-v-chk2"><span class="nb">induction</span> l; <span class="kp">try</span> <span class="nb">apply</span> Rle_refl.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>V</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>Measurable V</span></span></span><br><span><var>a</var><span class="hyp-type"><b>: </b><span>V</span></span></span><br><span><var>l</var><span class="hyp-type"><b>: </b><span>list V</span></span></span><br><span><var>IHl</var><span class="hyp-type"><b>: </b><span>(<span class="mi">0</span> &lt;= sum_weights l)%R</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">(<span class="mi">0</span> &lt;= sum_weights (a :: l))%R</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="Measurable-v-chk3" style="display: none" type="checkbox"><label class="alectryon-input" for="Measurable-v-chk3"><span class="nb">simpl</span>.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>V</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>Measurable V</span></span></span><br><span><var>a</var><span class="hyp-type"><b>: </b><span>V</span></span></span><br><span><var>l</var><span class="hyp-type"><b>: </b><span>list V</span></span></span><br><span><var>IHl</var><span class="hyp-type"><b>: </b><span>(<span class="mi">0</span> &lt;= sum_weights l)%R</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">(<span class="mi">0</span> &lt;= `(weight a) + sum_weights l)%R</div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="Measurable-v-chk4" style="display: none" type="checkbox"><label class="alectryon-input" for="Measurable-v-chk4"><span class="nb">apply</span> Rplus_le_le_0_compat; [| <span class="bp">done</span>].</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>V</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>Measurable V</span></span></span><br><span><var>a</var><span class="hyp-type"><b>: </b><span>V</span></span></span><br><span><var>l</var><span class="hyp-type"><b>: </b><span>list V</span></span></span><br><span><var>IHl</var><span class="hyp-type"><b>: </b><span>(<span class="mi">0</span> &lt;= sum_weights l)%R</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">(<span class="mi">0</span> &lt;= `(weight a))%R</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="Measurable-v-chk5" style="display: none" type="checkbox"><label class="alectryon-input" for="Measurable-v-chk5"><span class="nb">destruct</span> (weight a); <span class="nb">cbn</span>.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>V</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>Measurable V</span></span></span><br><span><var>a</var><span class="hyp-type"><b>: </b><span>V</span></span></span><br><span><var>l</var><span class="hyp-type"><b>: </b><span>list V</span></span></span><br><span><var>IHl</var><span class="hyp-type"><b>: </b><span>(<span class="mi">0</span> &lt;= sum_weights l)%R</span></span></span><br><span><var>x</var><span class="hyp-type"><b>: </b><span>R</span></span></span><br><span><var>r</var><span class="hyp-type"><b>: </b><span>(x &gt; <span class="mi">0</span>)%R</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">(<span class="mi">0</span> &lt;= x)%R</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><span class="alectryon-input"><span class="bp">by</span> <span class="nb">apply</span> Rlt_le.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Qed</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
</span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Definition</span> <span class="nf">weight_proj1_sig</span> (<span class="nv">w</span> : pos_R) : R := proj1_sig w.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
</span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Coercion</span> <span class="nf">weight_proj1_sig</span> : pos_R &gt;-&gt; R.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
</span><span class="alectryon-sentence"><input class="alectryon-toggle" id="Measurable-v-chk6" style="display: none" type="checkbox"><label class="alectryon-input" for="Measurable-v-chk6"><span class="kn">Lemma</span> <span class="nf">sum_weights_in</span>
  `{EqDecision V} `{Hm : Measurable V}
  : <span class="kr">forall</span> <span class="nv">v</span> (<span class="nv">vs</span>:list V),
  NoDup vs -&gt;
  v ‚àà vs -&gt;
  sum_weights vs = (proj1_sig (weight v) + sum_weights (set_remove v vs))%R.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>V</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>EqDecision0</var><span class="hyp-type"><b>: </b><span>EqDecision V</span></span></span><br><span><var>Hm</var><span class="hyp-type"><b>: </b><span>Measurable V</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="kr">‚àÄ</span> (<span class="nv">v</span> : V) (<span class="nv">vs</span> : list V),
  NoDup vs
  ‚Üí v ‚àà vs
    ‚Üí sum_weights vs =
      (`(weight v) + sum_weights (set_remove v vs))%R</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="Measurable-v-chk7" style="display: none" type="checkbox"><label class="alectryon-input" for="Measurable-v-chk7"><span class="kn">Proof</span>.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>V</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>EqDecision0</var><span class="hyp-type"><b>: </b><span>EqDecision V</span></span></span><br><span><var>Hm</var><span class="hyp-type"><b>: </b><span>Measurable V</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="kr">‚àÄ</span> (<span class="nv">v</span> : V) (<span class="nv">vs</span> : list V),
  NoDup vs
  ‚Üí v ‚àà vs
    ‚Üí sum_weights vs =
      (`(weight v) + sum_weights (set_remove v vs))%R</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="Measurable-v-chk8" style="display: none" type="checkbox"><label class="alectryon-input" for="Measurable-v-chk8"><span class="nb">induction</span> vs; <span class="nb">intros</span>; <span class="nb">inversion</span> H0; <span class="nb">subst</span>; <span class="nb">clear</span> H0.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>V</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>EqDecision0</var><span class="hyp-type"><b>: </b><span>EqDecision V</span></span></span><br><span><var>Hm</var><span class="hyp-type"><b>: </b><span>Measurable V</span></span></span><br><span><var>a</var><span class="hyp-type"><b>: </b><span>V</span></span></span><br><span><var>vs</var><span class="hyp-type"><b>: </b><span>list V</span></span></span><br><span><var>IHvs</var><span class="hyp-type"><b>: </b><span>NoDup vs
‚Üí a ‚àà vs
  ‚Üí sum_weights vs =
    (`(weight a) +
     sum_weights (set_remove a vs))%R</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>NoDup (a :: vs)</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">sum_weights (a :: vs) =
(`(weight a) + sum_weights (set_remove a (a :: vs)))%R</div></blockquote><div class="alectryon-extra-goals"><input class="alectryon-extra-goal-toggle" id="Measurable-v-chk9" style="display: none" type="checkbox"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>V</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>EqDecision0</var><span class="hyp-type"><b>: </b><span>EqDecision V</span></span></span><br><span><var>Hm</var><span class="hyp-type"><b>: </b><span>Measurable V</span></span></span><br><span><var>v, a</var><span class="hyp-type"><b>: </b><span>V</span></span></span><br><span><var>vs</var><span class="hyp-type"><b>: </b><span>list V</span></span></span><br><span><var>IHvs</var><span class="hyp-type"><b>: </b><span>NoDup vs
‚Üí v ‚àà vs
  ‚Üí sum_weights vs =
    (`(weight v) +
     sum_weights (set_remove v vs))%R</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>NoDup (a :: vs)</span></span></span><br><span><var>H3</var><span class="hyp-type"><b>: </b><span>v ‚àà vs</span></span></span><br></div><label class="goal-separator" for="Measurable-v-chk9"><hr></label><div class="goal-conclusion">sum_weights (a :: vs) =
(`(weight v) + sum_weights (set_remove v (a :: vs)))%R</div></blockquote></div></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="Measurable-v-chka" style="display: none" type="checkbox"><label class="alectryon-input" for="Measurable-v-chka">-</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>V</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>EqDecision0</var><span class="hyp-type"><b>: </b><span>EqDecision V</span></span></span><br><span><var>Hm</var><span class="hyp-type"><b>: </b><span>Measurable V</span></span></span><br><span><var>a</var><span class="hyp-type"><b>: </b><span>V</span></span></span><br><span><var>vs</var><span class="hyp-type"><b>: </b><span>list V</span></span></span><br><span><var>IHvs</var><span class="hyp-type"><b>: </b><span>NoDup vs
‚Üí a ‚àà vs
  ‚Üí sum_weights vs =
    (`(weight a) +
     sum_weights (set_remove a vs))%R</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>NoDup (a :: vs)</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">sum_weights (a :: vs) =
(`(weight a) + sum_weights (set_remove a (a :: vs)))%R</div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="Measurable-v-chkb" style="display: none" type="checkbox"><label class="alectryon-input" for="Measurable-v-chkb"><span class="nb">inversion</span> H; <span class="nb">subst</span>; <span class="nb">clear</span> H.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>V</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>EqDecision0</var><span class="hyp-type"><b>: </b><span>EqDecision V</span></span></span><br><span><var>Hm</var><span class="hyp-type"><b>: </b><span>Measurable V</span></span></span><br><span><var>a</var><span class="hyp-type"><b>: </b><span>V</span></span></span><br><span><var>vs</var><span class="hyp-type"><b>: </b><span>list V</span></span></span><br><span><var>IHvs</var><span class="hyp-type"><b>: </b><span>NoDup vs
‚Üí a ‚àà vs
  ‚Üí sum_weights vs =
    (`(weight a) +
     sum_weights (set_remove a vs))%R</span></span></span><br><span><var>H2</var><span class="hyp-type"><b>: </b><span>a ‚àâ vs</span></span></span><br><span><var>H3</var><span class="hyp-type"><b>: </b><span>NoDup vs</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">sum_weights (a :: vs) =
(`(weight a) + sum_weights (set_remove a (a :: vs)))%R</div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="Measurable-v-chkc" style="display: none" type="checkbox"><label class="alectryon-input" for="Measurable-v-chkc"><span class="nb">simpl</span>.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>V</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>EqDecision0</var><span class="hyp-type"><b>: </b><span>EqDecision V</span></span></span><br><span><var>Hm</var><span class="hyp-type"><b>: </b><span>Measurable V</span></span></span><br><span><var>a</var><span class="hyp-type"><b>: </b><span>V</span></span></span><br><span><var>vs</var><span class="hyp-type"><b>: </b><span>list V</span></span></span><br><span><var>IHvs</var><span class="hyp-type"><b>: </b><span>NoDup vs
‚Üí a ‚àà vs
  ‚Üí sum_weights vs =
    (`(weight a) +
     sum_weights (set_remove a vs))%R</span></span></span><br><span><var>H2</var><span class="hyp-type"><b>: </b><span>a ‚àâ vs</span></span></span><br><span><var>H3</var><span class="hyp-type"><b>: </b><span>NoDup vs</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">(`(weight a) + sum_weights vs)%R =
(`(weight a) +
 sum_weights
   (<span class="kr">if</span> decide (a = a)
    <span class="kr">then</span> vs
    <span class="kr">else</span> a :: set_remove a vs))%R</div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="Measurable-v-chkd" style="display: none" type="checkbox"><label class="alectryon-input" for="Measurable-v-chkd"><span class="nb">apply</span> Rplus_eq_compat_l.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>V</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>EqDecision0</var><span class="hyp-type"><b>: </b><span>EqDecision V</span></span></span><br><span><var>Hm</var><span class="hyp-type"><b>: </b><span>Measurable V</span></span></span><br><span><var>a</var><span class="hyp-type"><b>: </b><span>V</span></span></span><br><span><var>vs</var><span class="hyp-type"><b>: </b><span>list V</span></span></span><br><span><var>IHvs</var><span class="hyp-type"><b>: </b><span>NoDup vs
‚Üí a ‚àà vs
  ‚Üí sum_weights vs =
    (`(weight a) +
     sum_weights (set_remove a vs))%R</span></span></span><br><span><var>H2</var><span class="hyp-type"><b>: </b><span>a ‚àâ vs</span></span></span><br><span><var>H3</var><span class="hyp-type"><b>: </b><span>NoDup vs</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">sum_weights vs =
sum_weights
  (<span class="kr">if</span> decide (a = a) <span class="kr">then</span> vs <span class="kr">else</span> a :: set_remove a vs)</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><span class="alectryon-input"><span class="bp">by</span> <span class="nb">rewrite</span> decide_True.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="Measurable-v-chke" style="display: none" type="checkbox"><label class="alectryon-input" for="Measurable-v-chke">-</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>V</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>EqDecision0</var><span class="hyp-type"><b>: </b><span>EqDecision V</span></span></span><br><span><var>Hm</var><span class="hyp-type"><b>: </b><span>Measurable V</span></span></span><br><span><var>v, a</var><span class="hyp-type"><b>: </b><span>V</span></span></span><br><span><var>vs</var><span class="hyp-type"><b>: </b><span>list V</span></span></span><br><span><var>IHvs</var><span class="hyp-type"><b>: </b><span>NoDup vs
‚Üí v ‚àà vs
  ‚Üí sum_weights vs =
    (`(weight v) +
     sum_weights (set_remove v vs))%R</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>NoDup (a :: vs)</span></span></span><br><span><var>H3</var><span class="hyp-type"><b>: </b><span>v ‚àà vs</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">sum_weights (a :: vs) =
(`(weight v) + sum_weights (set_remove v (a :: vs)))%R</div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="Measurable-v-chkf" style="display: none" type="checkbox"><label class="alectryon-input" for="Measurable-v-chkf"><span class="nb">inversion</span> H; <span class="nb">subst</span>; <span class="nb">clear</span> H.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>V</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>EqDecision0</var><span class="hyp-type"><b>: </b><span>EqDecision V</span></span></span><br><span><var>Hm</var><span class="hyp-type"><b>: </b><span>Measurable V</span></span></span><br><span><var>v, a</var><span class="hyp-type"><b>: </b><span>V</span></span></span><br><span><var>vs</var><span class="hyp-type"><b>: </b><span>list V</span></span></span><br><span><var>IHvs</var><span class="hyp-type"><b>: </b><span>NoDup vs
‚Üí v ‚àà vs
  ‚Üí sum_weights vs =
    (`(weight v) +
     sum_weights (set_remove v vs))%R</span></span></span><br><span><var>H3</var><span class="hyp-type"><b>: </b><span>v ‚àà vs</span></span></span><br><span><var>H2</var><span class="hyp-type"><b>: </b><span>a ‚àâ vs</span></span></span><br><span><var>H4</var><span class="hyp-type"><b>: </b><span>NoDup vs</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">sum_weights (a :: vs) =
(`(weight v) + sum_weights (set_remove v (a :: vs)))%R</div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="Measurable-v-chk10" style="display: none" type="checkbox"><label class="alectryon-input" for="Measurable-v-chk10"><span class="nb">simpl</span>.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>V</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>EqDecision0</var><span class="hyp-type"><b>: </b><span>EqDecision V</span></span></span><br><span><var>Hm</var><span class="hyp-type"><b>: </b><span>Measurable V</span></span></span><br><span><var>v, a</var><span class="hyp-type"><b>: </b><span>V</span></span></span><br><span><var>vs</var><span class="hyp-type"><b>: </b><span>list V</span></span></span><br><span><var>IHvs</var><span class="hyp-type"><b>: </b><span>NoDup vs
‚Üí v ‚àà vs
  ‚Üí sum_weights vs =
    (`(weight v) +
     sum_weights (set_remove v vs))%R</span></span></span><br><span><var>H3</var><span class="hyp-type"><b>: </b><span>v ‚àà vs</span></span></span><br><span><var>H2</var><span class="hyp-type"><b>: </b><span>a ‚àâ vs</span></span></span><br><span><var>H4</var><span class="hyp-type"><b>: </b><span>NoDup vs</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">(`(weight a) + sum_weights vs)%R =
(`(weight v) +
 sum_weights
   (<span class="kr">if</span> decide (v = a)
    <span class="kr">then</span> vs
    <span class="kr">else</span> a :: set_remove v vs))%R</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="Measurable-v-chk11" style="display: none" type="checkbox"><label class="alectryon-input" for="Measurable-v-chk11"><span class="nb">pose proof</span> (in_not_in _ _ _ _ H3 H2).</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>V</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>EqDecision0</var><span class="hyp-type"><b>: </b><span>EqDecision V</span></span></span><br><span><var>Hm</var><span class="hyp-type"><b>: </b><span>Measurable V</span></span></span><br><span><var>v, a</var><span class="hyp-type"><b>: </b><span>V</span></span></span><br><span><var>vs</var><span class="hyp-type"><b>: </b><span>list V</span></span></span><br><span><var>IHvs</var><span class="hyp-type"><b>: </b><span>NoDup vs
‚Üí v ‚àà vs
  ‚Üí sum_weights vs =
    (`(weight v) +
     sum_weights (set_remove v vs))%R</span></span></span><br><span><var>H3</var><span class="hyp-type"><b>: </b><span>v ‚àà vs</span></span></span><br><span><var>H2</var><span class="hyp-type"><b>: </b><span>a ‚àâ vs</span></span></span><br><span><var>H4</var><span class="hyp-type"><b>: </b><span>NoDup vs</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>v ‚â† a</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">(`(weight a) + sum_weights vs)%R =
(`(weight v) +
 sum_weights
   (<span class="kr">if</span> decide (v = a)
    <span class="kr">then</span> vs
    <span class="kr">else</span> a :: set_remove v vs))%R</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="Measurable-v-chk12" style="display: none" type="checkbox"><label class="alectryon-input" for="Measurable-v-chk12"><span class="nb">rewrite</span> decide_False; [| <span class="bp">done</span>].</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>V</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>EqDecision0</var><span class="hyp-type"><b>: </b><span>EqDecision V</span></span></span><br><span><var>Hm</var><span class="hyp-type"><b>: </b><span>Measurable V</span></span></span><br><span><var>v, a</var><span class="hyp-type"><b>: </b><span>V</span></span></span><br><span><var>vs</var><span class="hyp-type"><b>: </b><span>list V</span></span></span><br><span><var>IHvs</var><span class="hyp-type"><b>: </b><span>NoDup vs
‚Üí v ‚àà vs
  ‚Üí sum_weights vs =
    (`(weight v) +
     sum_weights (set_remove v vs))%R</span></span></span><br><span><var>H3</var><span class="hyp-type"><b>: </b><span>v ‚àà vs</span></span></span><br><span><var>H2</var><span class="hyp-type"><b>: </b><span>a ‚àâ vs</span></span></span><br><span><var>H4</var><span class="hyp-type"><b>: </b><span>NoDup vs</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>v ‚â† a</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">(`(weight a) + sum_weights vs)%R =
(`(weight v) + sum_weights (a :: set_remove v vs))%R</div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="Measurable-v-chk13" style="display: none" type="checkbox"><label class="alectryon-input" for="Measurable-v-chk13"><span class="nb">simpl</span>.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>V</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>EqDecision0</var><span class="hyp-type"><b>: </b><span>EqDecision V</span></span></span><br><span><var>Hm</var><span class="hyp-type"><b>: </b><span>Measurable V</span></span></span><br><span><var>v, a</var><span class="hyp-type"><b>: </b><span>V</span></span></span><br><span><var>vs</var><span class="hyp-type"><b>: </b><span>list V</span></span></span><br><span><var>IHvs</var><span class="hyp-type"><b>: </b><span>NoDup vs
‚Üí v ‚àà vs
  ‚Üí sum_weights vs =
    (`(weight v) +
     sum_weights (set_remove v vs))%R</span></span></span><br><span><var>H3</var><span class="hyp-type"><b>: </b><span>v ‚àà vs</span></span></span><br><span><var>H2</var><span class="hyp-type"><b>: </b><span>a ‚àâ vs</span></span></span><br><span><var>H4</var><span class="hyp-type"><b>: </b><span>NoDup vs</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>v ‚â† a</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">(`(weight a) + sum_weights vs)%R =
(`(weight v) +
 (`(weight a) + sum_weights (set_remove v vs)))%R</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="Measurable-v-chk14" style="display: none" type="checkbox"><label class="alectryon-input" for="Measurable-v-chk14"><span class="nb">rewrite</span> &lt;- Rplus_assoc.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>V</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>EqDecision0</var><span class="hyp-type"><b>: </b><span>EqDecision V</span></span></span><br><span><var>Hm</var><span class="hyp-type"><b>: </b><span>Measurable V</span></span></span><br><span><var>v, a</var><span class="hyp-type"><b>: </b><span>V</span></span></span><br><span><var>vs</var><span class="hyp-type"><b>: </b><span>list V</span></span></span><br><span><var>IHvs</var><span class="hyp-type"><b>: </b><span>NoDup vs
‚Üí v ‚àà vs
  ‚Üí sum_weights vs =
    (`(weight v) +
     sum_weights (set_remove v vs))%R</span></span></span><br><span><var>H3</var><span class="hyp-type"><b>: </b><span>v ‚àà vs</span></span></span><br><span><var>H2</var><span class="hyp-type"><b>: </b><span>a ‚àâ vs</span></span></span><br><span><var>H4</var><span class="hyp-type"><b>: </b><span>NoDup vs</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>v ‚â† a</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">(`(weight a) + sum_weights vs)%R =
(`(weight v) + `(weight a) +
 sum_weights (set_remove v vs))%R</div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="Measurable-v-chk15" style="display: none" type="checkbox"><label class="alectryon-input" for="Measurable-v-chk15"><span class="nb">rewrite</span> (Rplus_comm (proj1_sig (weight v)) (proj1_sig (weight a))).</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>V</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>EqDecision0</var><span class="hyp-type"><b>: </b><span>EqDecision V</span></span></span><br><span><var>Hm</var><span class="hyp-type"><b>: </b><span>Measurable V</span></span></span><br><span><var>v, a</var><span class="hyp-type"><b>: </b><span>V</span></span></span><br><span><var>vs</var><span class="hyp-type"><b>: </b><span>list V</span></span></span><br><span><var>IHvs</var><span class="hyp-type"><b>: </b><span>NoDup vs
‚Üí v ‚àà vs
  ‚Üí sum_weights vs =
    (`(weight v) +
     sum_weights (set_remove v vs))%R</span></span></span><br><span><var>H3</var><span class="hyp-type"><b>: </b><span>v ‚àà vs</span></span></span><br><span><var>H2</var><span class="hyp-type"><b>: </b><span>a ‚àâ vs</span></span></span><br><span><var>H4</var><span class="hyp-type"><b>: </b><span>NoDup vs</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>v ‚â† a</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">(`(weight a) + sum_weights vs)%R =
(`(weight a) + `(weight v) +
 sum_weights (set_remove v vs))%R</div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="Measurable-v-chk16" style="display: none" type="checkbox"><label class="alectryon-input" for="Measurable-v-chk16"><span class="nb">rewrite</span> Rplus_assoc.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>V</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>EqDecision0</var><span class="hyp-type"><b>: </b><span>EqDecision V</span></span></span><br><span><var>Hm</var><span class="hyp-type"><b>: </b><span>Measurable V</span></span></span><br><span><var>v, a</var><span class="hyp-type"><b>: </b><span>V</span></span></span><br><span><var>vs</var><span class="hyp-type"><b>: </b><span>list V</span></span></span><br><span><var>IHvs</var><span class="hyp-type"><b>: </b><span>NoDup vs
‚Üí v ‚àà vs
  ‚Üí sum_weights vs =
    (`(weight v) +
     sum_weights (set_remove v vs))%R</span></span></span><br><span><var>H3</var><span class="hyp-type"><b>: </b><span>v ‚àà vs</span></span></span><br><span><var>H2</var><span class="hyp-type"><b>: </b><span>a ‚àâ vs</span></span></span><br><span><var>H4</var><span class="hyp-type"><b>: </b><span>NoDup vs</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>v ‚â† a</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">(`(weight a) + sum_weights vs)%R =
(`(weight a) +
 (`(weight v) + sum_weights (set_remove v vs)))%R</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><span class="alectryon-input"><span class="bp">by</span> <span class="nb">apply</span> Rplus_eq_compat_l, IHvs.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Qed</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
</span><span class="alectryon-sentence"><input class="alectryon-toggle" id="Measurable-v-chk17" style="display: none" type="checkbox"><label class="alectryon-input" for="Measurable-v-chk17"><span class="kn">Lemma</span> <span class="nf">sum_weights_subseteq</span>
  `{EqDecision V} `{Hm : Measurable V}
  : <span class="kr">forall</span> (<span class="nv">vs</span> <span class="nv">vs&#39;</span>:list V),
  NoDup vs -&gt;
  NoDup vs&#39; -&gt;
  vs ‚äÜ vs&#39; -&gt;
  (sum_weights vs &lt;= sum_weights vs&#39;)%R.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>V</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>EqDecision0</var><span class="hyp-type"><b>: </b><span>EqDecision V</span></span></span><br><span><var>Hm</var><span class="hyp-type"><b>: </b><span>Measurable V</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="kr">‚àÄ</span> <span class="nv">vs</span> <span class="nv">vs&#39;</span> : list V,
  NoDup vs
  ‚Üí NoDup vs&#39;
    ‚Üí vs ‚äÜ vs&#39; ‚Üí (sum_weights vs &lt;= sum_weights vs&#39;)%R</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="Measurable-v-chk18" style="display: none" type="checkbox"><label class="alectryon-input" for="Measurable-v-chk18"><span class="kn">Proof</span>.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>V</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>EqDecision0</var><span class="hyp-type"><b>: </b><span>EqDecision V</span></span></span><br><span><var>Hm</var><span class="hyp-type"><b>: </b><span>Measurable V</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="kr">‚àÄ</span> <span class="nv">vs</span> <span class="nv">vs&#39;</span> : list V,
  NoDup vs
  ‚Üí NoDup vs&#39;
    ‚Üí vs ‚äÜ vs&#39; ‚Üí (sum_weights vs &lt;= sum_weights vs&#39;)%R</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="Measurable-v-chk19" style="display: none" type="checkbox"><label class="alectryon-input" for="Measurable-v-chk19"><span class="nb">induction</span> vs; <span class="nb">intros</span>; <span class="kp">try</span> <span class="nb">apply</span> sum_weights_positive.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>V</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>EqDecision0</var><span class="hyp-type"><b>: </b><span>EqDecision V</span></span></span><br><span><var>Hm</var><span class="hyp-type"><b>: </b><span>Measurable V</span></span></span><br><span><var>a</var><span class="hyp-type"><b>: </b><span>V</span></span></span><br><span><var>vs</var><span class="hyp-type"><b>: </b><span>list V</span></span></span><br><span><var>IHvs</var><span class="hyp-type"><b>: </b><span><span class="kr">‚àÄ</span> <span class="nv">vs&#39;</span> : list V,
  NoDup vs
  ‚Üí NoDup vs&#39;
    ‚Üí vs ‚äÜ vs&#39;
      ‚Üí (sum_weights vs &lt;= sum_weights vs&#39;)%R</span></span></span><br><span><var>vs'</var><span class="hyp-type"><b>: </b><span>list V</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>NoDup (a :: vs)</span></span></span><br><span><var>H0</var><span class="hyp-type"><b>: </b><span>NoDup vs&#39;</span></span></span><br><span><var>H1</var><span class="hyp-type"><b>: </b><span>a :: vs ‚äÜ vs&#39;</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">(sum_weights (a :: vs) &lt;= sum_weights vs&#39;)%R</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="Measurable-v-chk1a" style="display: none" type="checkbox"><label class="alectryon-input" for="Measurable-v-chk1a"><span class="nb">specialize</span> (sum_weights_in a vs&#39; H0) <span class="kr">as</span> Hvs&#39;.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>V</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>EqDecision0</var><span class="hyp-type"><b>: </b><span>EqDecision V</span></span></span><br><span><var>Hm</var><span class="hyp-type"><b>: </b><span>Measurable V</span></span></span><br><span><var>a</var><span class="hyp-type"><b>: </b><span>V</span></span></span><br><span><var>vs</var><span class="hyp-type"><b>: </b><span>list V</span></span></span><br><span><var>IHvs</var><span class="hyp-type"><b>: </b><span><span class="kr">‚àÄ</span> <span class="nv">vs&#39;</span> : list V,
  NoDup vs
  ‚Üí NoDup vs&#39;
    ‚Üí vs ‚äÜ vs&#39;
      ‚Üí (sum_weights vs &lt;= sum_weights vs&#39;)%R</span></span></span><br><span><var>vs'</var><span class="hyp-type"><b>: </b><span>list V</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>NoDup (a :: vs)</span></span></span><br><span><var>H0</var><span class="hyp-type"><b>: </b><span>NoDup vs&#39;</span></span></span><br><span><var>H1</var><span class="hyp-type"><b>: </b><span>a :: vs ‚äÜ vs&#39;</span></span></span><br><span><var>Hvs'</var><span class="hyp-type"><b>: </b><span>a ‚àà vs&#39;
‚Üí sum_weights vs&#39; =
  (`(weight a) + sum_weights (set_remove a vs&#39;))%R</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">(sum_weights (a :: vs) &lt;= sum_weights vs&#39;)%R</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="Measurable-v-chk1b" style="display: none" type="checkbox"><label class="alectryon-input" for="Measurable-v-chk1b">spec Hvs&#39;; [<span class="bp">by</span> <span class="nb">apply</span> H1; <span class="nb">left</span> |].</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>V</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>EqDecision0</var><span class="hyp-type"><b>: </b><span>EqDecision V</span></span></span><br><span><var>Hm</var><span class="hyp-type"><b>: </b><span>Measurable V</span></span></span><br><span><var>a</var><span class="hyp-type"><b>: </b><span>V</span></span></span><br><span><var>vs</var><span class="hyp-type"><b>: </b><span>list V</span></span></span><br><span><var>IHvs</var><span class="hyp-type"><b>: </b><span><span class="kr">‚àÄ</span> <span class="nv">vs&#39;</span> : list V,
  NoDup vs
  ‚Üí NoDup vs&#39;
    ‚Üí vs ‚äÜ vs&#39;
      ‚Üí (sum_weights vs &lt;= sum_weights vs&#39;)%R</span></span></span><br><span><var>vs'</var><span class="hyp-type"><b>: </b><span>list V</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>NoDup (a :: vs)</span></span></span><br><span><var>H0</var><span class="hyp-type"><b>: </b><span>NoDup vs&#39;</span></span></span><br><span><var>H1</var><span class="hyp-type"><b>: </b><span>a :: vs ‚äÜ vs&#39;</span></span></span><br><span><var>Hvs'</var><span class="hyp-type"><b>: </b><span>sum_weights vs&#39; =
(`(weight a) + sum_weights (set_remove a vs&#39;))%R</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">(sum_weights (a :: vs) &lt;= sum_weights vs&#39;)%R</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="Measurable-v-chk1c" style="display: none" type="checkbox"><label class="alectryon-input" for="Measurable-v-chk1c"><span class="nb">rewrite</span> Hvs&#39;.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>V</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>EqDecision0</var><span class="hyp-type"><b>: </b><span>EqDecision V</span></span></span><br><span><var>Hm</var><span class="hyp-type"><b>: </b><span>Measurable V</span></span></span><br><span><var>a</var><span class="hyp-type"><b>: </b><span>V</span></span></span><br><span><var>vs</var><span class="hyp-type"><b>: </b><span>list V</span></span></span><br><span><var>IHvs</var><span class="hyp-type"><b>: </b><span><span class="kr">‚àÄ</span> <span class="nv">vs&#39;</span> : list V,
  NoDup vs
  ‚Üí NoDup vs&#39;
    ‚Üí vs ‚äÜ vs&#39;
      ‚Üí (sum_weights vs &lt;= sum_weights vs&#39;)%R</span></span></span><br><span><var>vs'</var><span class="hyp-type"><b>: </b><span>list V</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>NoDup (a :: vs)</span></span></span><br><span><var>H0</var><span class="hyp-type"><b>: </b><span>NoDup vs&#39;</span></span></span><br><span><var>H1</var><span class="hyp-type"><b>: </b><span>a :: vs ‚äÜ vs&#39;</span></span></span><br><span><var>Hvs'</var><span class="hyp-type"><b>: </b><span>sum_weights vs&#39; =
(`(weight a) + sum_weights (set_remove a vs&#39;))%R</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">(sum_weights (a :: vs) &lt;=
 `(weight a) + sum_weights (set_remove a vs&#39;))%R</div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="Measurable-v-chk1d" style="display: none" type="checkbox"><label class="alectryon-input" for="Measurable-v-chk1d"><span class="nb">simpl</span>.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>V</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>EqDecision0</var><span class="hyp-type"><b>: </b><span>EqDecision V</span></span></span><br><span><var>Hm</var><span class="hyp-type"><b>: </b><span>Measurable V</span></span></span><br><span><var>a</var><span class="hyp-type"><b>: </b><span>V</span></span></span><br><span><var>vs</var><span class="hyp-type"><b>: </b><span>list V</span></span></span><br><span><var>IHvs</var><span class="hyp-type"><b>: </b><span><span class="kr">‚àÄ</span> <span class="nv">vs&#39;</span> : list V,
  NoDup vs
  ‚Üí NoDup vs&#39;
    ‚Üí vs ‚äÜ vs&#39;
      ‚Üí (sum_weights vs &lt;= sum_weights vs&#39;)%R</span></span></span><br><span><var>vs'</var><span class="hyp-type"><b>: </b><span>list V</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>NoDup (a :: vs)</span></span></span><br><span><var>H0</var><span class="hyp-type"><b>: </b><span>NoDup vs&#39;</span></span></span><br><span><var>H1</var><span class="hyp-type"><b>: </b><span>a :: vs ‚äÜ vs&#39;</span></span></span><br><span><var>Hvs'</var><span class="hyp-type"><b>: </b><span>sum_weights vs&#39; =
(`(weight a) + sum_weights (set_remove a vs&#39;))%R</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">(`(weight a) + sum_weights vs &lt;=
 `(weight a) + sum_weights (set_remove a vs&#39;))%R</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="Measurable-v-chk1e" style="display: none" type="checkbox"><label class="alectryon-input" for="Measurable-v-chk1e"><span class="nb">apply</span> Rplus_le_compat_l.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>V</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>EqDecision0</var><span class="hyp-type"><b>: </b><span>EqDecision V</span></span></span><br><span><var>Hm</var><span class="hyp-type"><b>: </b><span>Measurable V</span></span></span><br><span><var>a</var><span class="hyp-type"><b>: </b><span>V</span></span></span><br><span><var>vs</var><span class="hyp-type"><b>: </b><span>list V</span></span></span><br><span><var>IHvs</var><span class="hyp-type"><b>: </b><span><span class="kr">‚àÄ</span> <span class="nv">vs&#39;</span> : list V,
  NoDup vs
  ‚Üí NoDup vs&#39;
    ‚Üí vs ‚äÜ vs&#39;
      ‚Üí (sum_weights vs &lt;= sum_weights vs&#39;)%R</span></span></span><br><span><var>vs'</var><span class="hyp-type"><b>: </b><span>list V</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>NoDup (a :: vs)</span></span></span><br><span><var>H0</var><span class="hyp-type"><b>: </b><span>NoDup vs&#39;</span></span></span><br><span><var>H1</var><span class="hyp-type"><b>: </b><span>a :: vs ‚äÜ vs&#39;</span></span></span><br><span><var>Hvs'</var><span class="hyp-type"><b>: </b><span>sum_weights vs&#39; =
(`(weight a) + sum_weights (set_remove a vs&#39;))%R</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">(sum_weights vs &lt;= sum_weights (set_remove a vs&#39;))%R</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="Measurable-v-chk1f" style="display: none" type="checkbox"><label class="alectryon-input" for="Measurable-v-chk1f"><span class="nb">inversion</span> H.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>V</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>EqDecision0</var><span class="hyp-type"><b>: </b><span>EqDecision V</span></span></span><br><span><var>Hm</var><span class="hyp-type"><b>: </b><span>Measurable V</span></span></span><br><span><var>a</var><span class="hyp-type"><b>: </b><span>V</span></span></span><br><span><var>vs</var><span class="hyp-type"><b>: </b><span>list V</span></span></span><br><span><var>IHvs</var><span class="hyp-type"><b>: </b><span><span class="kr">‚àÄ</span> <span class="nv">vs&#39;</span> : list V,
  NoDup vs
  ‚Üí NoDup vs&#39;
    ‚Üí vs ‚äÜ vs&#39;
      ‚Üí (sum_weights vs &lt;= sum_weights vs&#39;)%R</span></span></span><br><span><var>vs'</var><span class="hyp-type"><b>: </b><span>list V</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>NoDup (a :: vs)</span></span></span><br><span><var>H0</var><span class="hyp-type"><b>: </b><span>NoDup vs&#39;</span></span></span><br><span><var>H1</var><span class="hyp-type"><b>: </b><span>a :: vs ‚äÜ vs&#39;</span></span></span><br><span><var>Hvs'</var><span class="hyp-type"><b>: </b><span>sum_weights vs&#39; =
(`(weight a) + sum_weights (set_remove a vs&#39;))%R</span></span></span><br><span><var>x</var><span class="hyp-type"><b>: </b><span>V</span></span></span><br><span><var>l</var><span class="hyp-type"><b>: </b><span>list V</span></span></span><br><span><var>H4</var><span class="hyp-type"><b>: </b><span>a ‚àâ vs</span></span></span><br><span><var>H5</var><span class="hyp-type"><b>: </b><span>NoDup vs</span></span></span><br><span><var>H2</var><span class="hyp-type"><b>: </b><span>x = a</span></span></span><br><span><var>H3</var><span class="hyp-type"><b>: </b><span>l = vs</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">(sum_weights vs &lt;= sum_weights (set_remove a vs&#39;))%R</div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="Measurable-v-chk20" style="display: none" type="checkbox"><label class="alectryon-input" for="Measurable-v-chk20"><span class="nb">subst</span>.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>V</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>EqDecision0</var><span class="hyp-type"><b>: </b><span>EqDecision V</span></span></span><br><span><var>Hm</var><span class="hyp-type"><b>: </b><span>Measurable V</span></span></span><br><span><var>a</var><span class="hyp-type"><b>: </b><span>V</span></span></span><br><span><var>vs</var><span class="hyp-type"><b>: </b><span>list V</span></span></span><br><span><var>IHvs</var><span class="hyp-type"><b>: </b><span><span class="kr">‚àÄ</span> <span class="nv">vs&#39;</span> : list V,
  NoDup vs
  ‚Üí NoDup vs&#39;
    ‚Üí vs ‚äÜ vs&#39;
      ‚Üí (sum_weights vs &lt;= sum_weights vs&#39;)%R</span></span></span><br><span><var>vs'</var><span class="hyp-type"><b>: </b><span>list V</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>NoDup (a :: vs)</span></span></span><br><span><var>H0</var><span class="hyp-type"><b>: </b><span>NoDup vs&#39;</span></span></span><br><span><var>H1</var><span class="hyp-type"><b>: </b><span>a :: vs ‚äÜ vs&#39;</span></span></span><br><span><var>Hvs'</var><span class="hyp-type"><b>: </b><span>sum_weights vs&#39; =
(`(weight a) + sum_weights (set_remove a vs&#39;))%R</span></span></span><br><span><var>H4</var><span class="hyp-type"><b>: </b><span>a ‚àâ vs</span></span></span><br><span><var>H5</var><span class="hyp-type"><b>: </b><span>NoDup vs</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">(sum_weights vs &lt;= sum_weights (set_remove a vs&#39;))%R</div></blockquote></div></div></small><span class="alectryon-wsp">  </span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="Measurable-v-chk21" style="display: none" type="checkbox"><label class="alectryon-input" for="Measurable-v-chk21"><span class="nb">clear</span> H.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>V</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>EqDecision0</var><span class="hyp-type"><b>: </b><span>EqDecision V</span></span></span><br><span><var>Hm</var><span class="hyp-type"><b>: </b><span>Measurable V</span></span></span><br><span><var>a</var><span class="hyp-type"><b>: </b><span>V</span></span></span><br><span><var>vs</var><span class="hyp-type"><b>: </b><span>list V</span></span></span><br><span><var>IHvs</var><span class="hyp-type"><b>: </b><span><span class="kr">‚àÄ</span> <span class="nv">vs&#39;</span> : list V,
  NoDup vs
  ‚Üí NoDup vs&#39;
    ‚Üí vs ‚äÜ vs&#39;
      ‚Üí (sum_weights vs &lt;= sum_weights vs&#39;)%R</span></span></span><br><span><var>vs'</var><span class="hyp-type"><b>: </b><span>list V</span></span></span><br><span><var>H0</var><span class="hyp-type"><b>: </b><span>NoDup vs&#39;</span></span></span><br><span><var>H1</var><span class="hyp-type"><b>: </b><span>a :: vs ‚äÜ vs&#39;</span></span></span><br><span><var>Hvs'</var><span class="hyp-type"><b>: </b><span>sum_weights vs&#39; =
(`(weight a) + sum_weights (set_remove a vs&#39;))%R</span></span></span><br><span><var>H4</var><span class="hyp-type"><b>: </b><span>a ‚àâ vs</span></span></span><br><span><var>H5</var><span class="hyp-type"><b>: </b><span>NoDup vs</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">(sum_weights vs &lt;= sum_weights (set_remove a vs&#39;))%R</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="Measurable-v-chk22" style="display: none" type="checkbox"><label class="alectryon-input" for="Measurable-v-chk22"><span class="nb">apply</span> IHvs; [<span class="bp">done</span> | |].</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>V</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>EqDecision0</var><span class="hyp-type"><b>: </b><span>EqDecision V</span></span></span><br><span><var>Hm</var><span class="hyp-type"><b>: </b><span>Measurable V</span></span></span><br><span><var>a</var><span class="hyp-type"><b>: </b><span>V</span></span></span><br><span><var>vs</var><span class="hyp-type"><b>: </b><span>list V</span></span></span><br><span><var>IHvs</var><span class="hyp-type"><b>: </b><span><span class="kr">‚àÄ</span> <span class="nv">vs&#39;</span> : list V,
  NoDup vs
  ‚Üí NoDup vs&#39;
    ‚Üí vs ‚äÜ vs&#39;
      ‚Üí (sum_weights vs &lt;= sum_weights vs&#39;)%R</span></span></span><br><span><var>vs'</var><span class="hyp-type"><b>: </b><span>list V</span></span></span><br><span><var>H0</var><span class="hyp-type"><b>: </b><span>NoDup vs&#39;</span></span></span><br><span><var>H1</var><span class="hyp-type"><b>: </b><span>a :: vs ‚äÜ vs&#39;</span></span></span><br><span><var>Hvs'</var><span class="hyp-type"><b>: </b><span>sum_weights vs&#39; =
(`(weight a) + sum_weights (set_remove a vs&#39;))%R</span></span></span><br><span><var>H4</var><span class="hyp-type"><b>: </b><span>a ‚àâ vs</span></span></span><br><span><var>H5</var><span class="hyp-type"><b>: </b><span>NoDup vs</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">NoDup (set_remove a vs&#39;)</div></blockquote><div class="alectryon-extra-goals"><input class="alectryon-extra-goal-toggle" id="Measurable-v-chk23" style="display: none" type="checkbox"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>V</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>EqDecision0</var><span class="hyp-type"><b>: </b><span>EqDecision V</span></span></span><br><span><var>Hm</var><span class="hyp-type"><b>: </b><span>Measurable V</span></span></span><br><span><var>a</var><span class="hyp-type"><b>: </b><span>V</span></span></span><br><span><var>vs</var><span class="hyp-type"><b>: </b><span>list V</span></span></span><br><span><var>IHvs</var><span class="hyp-type"><b>: </b><span><span class="kr">‚àÄ</span> <span class="nv">vs&#39;</span> : list V,
  NoDup vs
  ‚Üí NoDup vs&#39;
    ‚Üí vs ‚äÜ vs&#39;
      ‚Üí (sum_weights vs &lt;= sum_weights vs&#39;)%R</span></span></span><br><span><var>vs'</var><span class="hyp-type"><b>: </b><span>list V</span></span></span><br><span><var>H0</var><span class="hyp-type"><b>: </b><span>NoDup vs&#39;</span></span></span><br><span><var>H1</var><span class="hyp-type"><b>: </b><span>a :: vs ‚äÜ vs&#39;</span></span></span><br><span><var>Hvs'</var><span class="hyp-type"><b>: </b><span>sum_weights vs&#39; =
(`(weight a) + sum_weights (set_remove a vs&#39;))%R</span></span></span><br><span><var>H4</var><span class="hyp-type"><b>: </b><span>a ‚àâ vs</span></span></span><br><span><var>H5</var><span class="hyp-type"><b>: </b><span>NoDup vs</span></span></span><br></div><label class="goal-separator" for="Measurable-v-chk23"><hr></label><div class="goal-conclusion">vs ‚äÜ set_remove a vs&#39;</div></blockquote></div></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="Measurable-v-chk24" style="display: none" type="checkbox"><label class="alectryon-input" for="Measurable-v-chk24">-</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>V</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>EqDecision0</var><span class="hyp-type"><b>: </b><span>EqDecision V</span></span></span><br><span><var>Hm</var><span class="hyp-type"><b>: </b><span>Measurable V</span></span></span><br><span><var>a</var><span class="hyp-type"><b>: </b><span>V</span></span></span><br><span><var>vs</var><span class="hyp-type"><b>: </b><span>list V</span></span></span><br><span><var>IHvs</var><span class="hyp-type"><b>: </b><span><span class="kr">‚àÄ</span> <span class="nv">vs&#39;</span> : list V,
  NoDup vs
  ‚Üí NoDup vs&#39;
    ‚Üí vs ‚äÜ vs&#39;
      ‚Üí (sum_weights vs &lt;= sum_weights vs&#39;)%R</span></span></span><br><span><var>vs'</var><span class="hyp-type"><b>: </b><span>list V</span></span></span><br><span><var>H0</var><span class="hyp-type"><b>: </b><span>NoDup vs&#39;</span></span></span><br><span><var>H1</var><span class="hyp-type"><b>: </b><span>a :: vs ‚äÜ vs&#39;</span></span></span><br><span><var>Hvs'</var><span class="hyp-type"><b>: </b><span>sum_weights vs&#39; =
(`(weight a) + sum_weights (set_remove a vs&#39;))%R</span></span></span><br><span><var>H4</var><span class="hyp-type"><b>: </b><span>a ‚àâ vs</span></span></span><br><span><var>H5</var><span class="hyp-type"><b>: </b><span>NoDup vs</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">NoDup (set_remove a vs&#39;)</div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="bp">by</span> <span class="nb">apply</span> set_remove_nodup.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="Measurable-v-chk25" style="display: none" type="checkbox"><label class="alectryon-input" for="Measurable-v-chk25">-</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>V</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>EqDecision0</var><span class="hyp-type"><b>: </b><span>EqDecision V</span></span></span><br><span><var>Hm</var><span class="hyp-type"><b>: </b><span>Measurable V</span></span></span><br><span><var>a</var><span class="hyp-type"><b>: </b><span>V</span></span></span><br><span><var>vs</var><span class="hyp-type"><b>: </b><span>list V</span></span></span><br><span><var>IHvs</var><span class="hyp-type"><b>: </b><span><span class="kr">‚àÄ</span> <span class="nv">vs&#39;</span> : list V,
  NoDup vs
  ‚Üí NoDup vs&#39;
    ‚Üí vs ‚äÜ vs&#39;
      ‚Üí (sum_weights vs &lt;= sum_weights vs&#39;)%R</span></span></span><br><span><var>vs'</var><span class="hyp-type"><b>: </b><span>list V</span></span></span><br><span><var>H0</var><span class="hyp-type"><b>: </b><span>NoDup vs&#39;</span></span></span><br><span><var>H1</var><span class="hyp-type"><b>: </b><span>a :: vs ‚äÜ vs&#39;</span></span></span><br><span><var>Hvs'</var><span class="hyp-type"><b>: </b><span>sum_weights vs&#39; =
(`(weight a) + sum_weights (set_remove a vs&#39;))%R</span></span></span><br><span><var>H4</var><span class="hyp-type"><b>: </b><span>a ‚àâ vs</span></span></span><br><span><var>H5</var><span class="hyp-type"><b>: </b><span>NoDup vs</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">vs ‚äÜ set_remove a vs&#39;</div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="Measurable-v-chk26" style="display: none" type="checkbox"><label class="alectryon-input" for="Measurable-v-chk26"><span class="nb">intros</span> v Hv.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>V</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>EqDecision0</var><span class="hyp-type"><b>: </b><span>EqDecision V</span></span></span><br><span><var>Hm</var><span class="hyp-type"><b>: </b><span>Measurable V</span></span></span><br><span><var>a</var><span class="hyp-type"><b>: </b><span>V</span></span></span><br><span><var>vs</var><span class="hyp-type"><b>: </b><span>list V</span></span></span><br><span><var>IHvs</var><span class="hyp-type"><b>: </b><span><span class="kr">‚àÄ</span> <span class="nv">vs&#39;</span> : list V,
  NoDup vs
  ‚Üí NoDup vs&#39;
    ‚Üí vs ‚äÜ vs&#39;
      ‚Üí (sum_weights vs &lt;= sum_weights vs&#39;)%R</span></span></span><br><span><var>vs'</var><span class="hyp-type"><b>: </b><span>list V</span></span></span><br><span><var>H0</var><span class="hyp-type"><b>: </b><span>NoDup vs&#39;</span></span></span><br><span><var>H1</var><span class="hyp-type"><b>: </b><span>a :: vs ‚äÜ vs&#39;</span></span></span><br><span><var>Hvs'</var><span class="hyp-type"><b>: </b><span>sum_weights vs&#39; =
(`(weight a) + sum_weights (set_remove a vs&#39;))%R</span></span></span><br><span><var>H4</var><span class="hyp-type"><b>: </b><span>a ‚àâ vs</span></span></span><br><span><var>H5</var><span class="hyp-type"><b>: </b><span>NoDup vs</span></span></span><br><span><var>v</var><span class="hyp-type"><b>: </b><span>V</span></span></span><br><span><var>Hv</var><span class="hyp-type"><b>: </b><span>v ‚àà vs</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">v ‚àà set_remove a vs&#39;</div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="Measurable-v-chk27" style="display: none" type="checkbox"><label class="alectryon-input" for="Measurable-v-chk27"><span class="nb">apply</span> set_remove_iff; [<span class="bp">done</span> |].</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>V</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>EqDecision0</var><span class="hyp-type"><b>: </b><span>EqDecision V</span></span></span><br><span><var>Hm</var><span class="hyp-type"><b>: </b><span>Measurable V</span></span></span><br><span><var>a</var><span class="hyp-type"><b>: </b><span>V</span></span></span><br><span><var>vs</var><span class="hyp-type"><b>: </b><span>list V</span></span></span><br><span><var>IHvs</var><span class="hyp-type"><b>: </b><span><span class="kr">‚àÄ</span> <span class="nv">vs&#39;</span> : list V,
  NoDup vs
  ‚Üí NoDup vs&#39;
    ‚Üí vs ‚äÜ vs&#39;
      ‚Üí (sum_weights vs &lt;= sum_weights vs&#39;)%R</span></span></span><br><span><var>vs'</var><span class="hyp-type"><b>: </b><span>list V</span></span></span><br><span><var>H0</var><span class="hyp-type"><b>: </b><span>NoDup vs&#39;</span></span></span><br><span><var>H1</var><span class="hyp-type"><b>: </b><span>a :: vs ‚äÜ vs&#39;</span></span></span><br><span><var>Hvs'</var><span class="hyp-type"><b>: </b><span>sum_weights vs&#39; =
(`(weight a) + sum_weights (set_remove a vs&#39;))%R</span></span></span><br><span><var>H4</var><span class="hyp-type"><b>: </b><span>a ‚àâ vs</span></span></span><br><span><var>H5</var><span class="hyp-type"><b>: </b><span>NoDup vs</span></span></span><br><span><var>v</var><span class="hyp-type"><b>: </b><span>V</span></span></span><br><span><var>Hv</var><span class="hyp-type"><b>: </b><span>v ‚àà vs</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">v ‚àà vs&#39; ‚àß v ‚â† a</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="Measurable-v-chk28" style="display: none" type="checkbox"><label class="alectryon-input" for="Measurable-v-chk28"><span class="nb">split</span>.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>V</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>EqDecision0</var><span class="hyp-type"><b>: </b><span>EqDecision V</span></span></span><br><span><var>Hm</var><span class="hyp-type"><b>: </b><span>Measurable V</span></span></span><br><span><var>a</var><span class="hyp-type"><b>: </b><span>V</span></span></span><br><span><var>vs</var><span class="hyp-type"><b>: </b><span>list V</span></span></span><br><span><var>IHvs</var><span class="hyp-type"><b>: </b><span><span class="kr">‚àÄ</span> <span class="nv">vs&#39;</span> : list V,
  NoDup vs
  ‚Üí NoDup vs&#39;
    ‚Üí vs ‚äÜ vs&#39;
      ‚Üí (sum_weights vs &lt;= sum_weights vs&#39;)%R</span></span></span><br><span><var>vs'</var><span class="hyp-type"><b>: </b><span>list V</span></span></span><br><span><var>H0</var><span class="hyp-type"><b>: </b><span>NoDup vs&#39;</span></span></span><br><span><var>H1</var><span class="hyp-type"><b>: </b><span>a :: vs ‚äÜ vs&#39;</span></span></span><br><span><var>Hvs'</var><span class="hyp-type"><b>: </b><span>sum_weights vs&#39; =
(`(weight a) + sum_weights (set_remove a vs&#39;))%R</span></span></span><br><span><var>H4</var><span class="hyp-type"><b>: </b><span>a ‚àâ vs</span></span></span><br><span><var>H5</var><span class="hyp-type"><b>: </b><span>NoDup vs</span></span></span><br><span><var>v</var><span class="hyp-type"><b>: </b><span>V</span></span></span><br><span><var>Hv</var><span class="hyp-type"><b>: </b><span>v ‚àà vs</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">v ‚àà vs&#39;</div></blockquote><div class="alectryon-extra-goals"><input class="alectryon-extra-goal-toggle" id="Measurable-v-chk29" style="display: none" type="checkbox"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>V</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>EqDecision0</var><span class="hyp-type"><b>: </b><span>EqDecision V</span></span></span><br><span><var>Hm</var><span class="hyp-type"><b>: </b><span>Measurable V</span></span></span><br><span><var>a</var><span class="hyp-type"><b>: </b><span>V</span></span></span><br><span><var>vs</var><span class="hyp-type"><b>: </b><span>list V</span></span></span><br><span><var>IHvs</var><span class="hyp-type"><b>: </b><span><span class="kr">‚àÄ</span> <span class="nv">vs&#39;</span> : list V,
  NoDup vs
  ‚Üí NoDup vs&#39;
    ‚Üí vs ‚äÜ vs&#39;
      ‚Üí (sum_weights vs &lt;= sum_weights vs&#39;)%R</span></span></span><br><span><var>vs'</var><span class="hyp-type"><b>: </b><span>list V</span></span></span><br><span><var>H0</var><span class="hyp-type"><b>: </b><span>NoDup vs&#39;</span></span></span><br><span><var>H1</var><span class="hyp-type"><b>: </b><span>a :: vs ‚äÜ vs&#39;</span></span></span><br><span><var>Hvs'</var><span class="hyp-type"><b>: </b><span>sum_weights vs&#39; =
(`(weight a) + sum_weights (set_remove a vs&#39;))%R</span></span></span><br><span><var>H4</var><span class="hyp-type"><b>: </b><span>a ‚àâ vs</span></span></span><br><span><var>H5</var><span class="hyp-type"><b>: </b><span>NoDup vs</span></span></span><br><span><var>v</var><span class="hyp-type"><b>: </b><span>V</span></span></span><br><span><var>Hv</var><span class="hyp-type"><b>: </b><span>v ‚àà vs</span></span></span><br></div><label class="goal-separator" for="Measurable-v-chk29"><hr></label><div class="goal-conclusion">v ‚â† a</div></blockquote></div></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="Measurable-v-chk2a" style="display: none" type="checkbox"><label class="alectryon-input" for="Measurable-v-chk2a">+</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>V</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>EqDecision0</var><span class="hyp-type"><b>: </b><span>EqDecision V</span></span></span><br><span><var>Hm</var><span class="hyp-type"><b>: </b><span>Measurable V</span></span></span><br><span><var>a</var><span class="hyp-type"><b>: </b><span>V</span></span></span><br><span><var>vs</var><span class="hyp-type"><b>: </b><span>list V</span></span></span><br><span><var>IHvs</var><span class="hyp-type"><b>: </b><span><span class="kr">‚àÄ</span> <span class="nv">vs&#39;</span> : list V,
  NoDup vs
  ‚Üí NoDup vs&#39;
    ‚Üí vs ‚äÜ vs&#39;
      ‚Üí (sum_weights vs &lt;= sum_weights vs&#39;)%R</span></span></span><br><span><var>vs'</var><span class="hyp-type"><b>: </b><span>list V</span></span></span><br><span><var>H0</var><span class="hyp-type"><b>: </b><span>NoDup vs&#39;</span></span></span><br><span><var>H1</var><span class="hyp-type"><b>: </b><span>a :: vs ‚äÜ vs&#39;</span></span></span><br><span><var>Hvs'</var><span class="hyp-type"><b>: </b><span>sum_weights vs&#39; =
(`(weight a) + sum_weights (set_remove a vs&#39;))%R</span></span></span><br><span><var>H4</var><span class="hyp-type"><b>: </b><span>a ‚àâ vs</span></span></span><br><span><var>H5</var><span class="hyp-type"><b>: </b><span>NoDup vs</span></span></span><br><span><var>v</var><span class="hyp-type"><b>: </b><span>V</span></span></span><br><span><var>Hv</var><span class="hyp-type"><b>: </b><span>v ‚àà vs</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">v ‚àà vs&#39;</div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="bp">by</span> <span class="nb">apply</span> H1; <span class="nb">right</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="Measurable-v-chk2b" style="display: none" type="checkbox"><label class="alectryon-input" for="Measurable-v-chk2b">+</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>V</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>EqDecision0</var><span class="hyp-type"><b>: </b><span>EqDecision V</span></span></span><br><span><var>Hm</var><span class="hyp-type"><b>: </b><span>Measurable V</span></span></span><br><span><var>a</var><span class="hyp-type"><b>: </b><span>V</span></span></span><br><span><var>vs</var><span class="hyp-type"><b>: </b><span>list V</span></span></span><br><span><var>IHvs</var><span class="hyp-type"><b>: </b><span><span class="kr">‚àÄ</span> <span class="nv">vs&#39;</span> : list V,
  NoDup vs
  ‚Üí NoDup vs&#39;
    ‚Üí vs ‚äÜ vs&#39;
      ‚Üí (sum_weights vs &lt;= sum_weights vs&#39;)%R</span></span></span><br><span><var>vs'</var><span class="hyp-type"><b>: </b><span>list V</span></span></span><br><span><var>H0</var><span class="hyp-type"><b>: </b><span>NoDup vs&#39;</span></span></span><br><span><var>H1</var><span class="hyp-type"><b>: </b><span>a :: vs ‚äÜ vs&#39;</span></span></span><br><span><var>Hvs'</var><span class="hyp-type"><b>: </b><span>sum_weights vs&#39; =
(`(weight a) + sum_weights (set_remove a vs&#39;))%R</span></span></span><br><span><var>H4</var><span class="hyp-type"><b>: </b><span>a ‚àâ vs</span></span></span><br><span><var>H5</var><span class="hyp-type"><b>: </b><span>NoDup vs</span></span></span><br><span><var>v</var><span class="hyp-type"><b>: </b><span>V</span></span></span><br><span><var>Hv</var><span class="hyp-type"><b>: </b><span>v ‚àà vs</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">v ‚â† a</div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="bp">by</span> <span class="nb">intros</span> -&gt;.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Qed</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
</span><span class="alectryon-sentence"><input class="alectryon-toggle" id="Measurable-v-chk2c" style="display: none" type="checkbox"><label class="alectryon-input" for="Measurable-v-chk2c"><span class="kn">Lemma</span> <span class="nf">set_eq_nodup_sum_weight_eq</span>
  `{EqDecision V} `{Hm : Measurable V}
  : <span class="kr">forall</span> (<span class="nv">lv1</span> <span class="nv">lv2</span> : list V),
    NoDup lv1 -&gt;
    NoDup lv2 -&gt;
    set_eq lv1 lv2 -&gt;
    sum_weights lv1 = sum_weights lv2.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>V</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>EqDecision0</var><span class="hyp-type"><b>: </b><span>EqDecision V</span></span></span><br><span><var>Hm</var><span class="hyp-type"><b>: </b><span>Measurable V</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="kr">‚àÄ</span> <span class="nv">lv1</span> <span class="nv">lv2</span> : list V,
  NoDup lv1
  ‚Üí NoDup lv2
    ‚Üí set_eq lv1 lv2
      ‚Üí sum_weights lv1 = sum_weights lv2</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="Measurable-v-chk2d" style="display: none" type="checkbox"><label class="alectryon-input" for="Measurable-v-chk2d"><span class="kn">Proof</span>.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>V</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>EqDecision0</var><span class="hyp-type"><b>: </b><span>EqDecision V</span></span></span><br><span><var>Hm</var><span class="hyp-type"><b>: </b><span>Measurable V</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="kr">‚àÄ</span> <span class="nv">lv1</span> <span class="nv">lv2</span> : list V,
  NoDup lv1
  ‚Üí NoDup lv2
    ‚Üí set_eq lv1 lv2
      ‚Üí sum_weights lv1 = sum_weights lv2</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="Measurable-v-chk2e" style="display: none" type="checkbox"><label class="alectryon-input" for="Measurable-v-chk2e"><span class="nb">intros</span> lv1 lv2 H_nodup1 H_nodup2 [H_eq_l H_eq_r].</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>V</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>EqDecision0</var><span class="hyp-type"><b>: </b><span>EqDecision V</span></span></span><br><span><var>Hm</var><span class="hyp-type"><b>: </b><span>Measurable V</span></span></span><br><span><var>lv1, lv2</var><span class="hyp-type"><b>: </b><span>list V</span></span></span><br><span><var>H_nodup1</var><span class="hyp-type"><b>: </b><span>NoDup lv1</span></span></span><br><span><var>H_nodup2</var><span class="hyp-type"><b>: </b><span>NoDup lv2</span></span></span><br><span><var>H_eq_l</var><span class="hyp-type"><b>: </b><span>lv1 ‚äÜ lv2</span></span></span><br><span><var>H_eq_r</var><span class="hyp-type"><b>: </b><span>lv2 ‚äÜ lv1</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">sum_weights lv1 = sum_weights lv2</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><span class="alectryon-input"><span class="bp">by</span> <span class="nb">apply</span> Rle_antisym; <span class="nb">apply</span> sum_weights_subseteq.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Qed</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
</span><span class="alectryon-sentence"><input class="alectryon-toggle" id="Measurable-v-chk2f" style="display: none" type="checkbox"><label class="alectryon-input" for="Measurable-v-chk2f"><span class="kn">Lemma</span> <span class="nf">sum_weights_app</span>
  `{Hm : Measurable V}
  : <span class="kr">forall</span> (<span class="nv">vs</span> <span class="nv">vs&#39;</span>:list V),
  sum_weights (vs ++ vs&#39;) = (sum_weights vs + sum_weights vs&#39;)%R.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>V</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>Hm</var><span class="hyp-type"><b>: </b><span>Measurable V</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="kr">‚àÄ</span> <span class="nv">vs</span> <span class="nv">vs&#39;</span> : list V,
  sum_weights (vs ++ vs&#39;) =
  (sum_weights vs + sum_weights vs&#39;)%R</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="Measurable-v-chk30" style="display: none" type="checkbox"><label class="alectryon-input" for="Measurable-v-chk30"><span class="kn">Proof</span>.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>V</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>Hm</var><span class="hyp-type"><b>: </b><span>Measurable V</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="kr">‚àÄ</span> <span class="nv">vs</span> <span class="nv">vs&#39;</span> : list V,
  sum_weights (vs ++ vs&#39;) =
  (sum_weights vs + sum_weights vs&#39;)%R</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="Measurable-v-chk31" style="display: none" type="checkbox"><label class="alectryon-input" for="Measurable-v-chk31"><span class="nb">induction</span> vs; <span class="nb">intros</span>; <span class="nb">simpl</span>.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>V</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>Hm</var><span class="hyp-type"><b>: </b><span>Measurable V</span></span></span><br><span><var>vs'</var><span class="hyp-type"><b>: </b><span>list V</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">sum_weights vs&#39; = (<span class="mi">0</span> + sum_weights vs&#39;)%R</div></blockquote><div class="alectryon-extra-goals"><input class="alectryon-extra-goal-toggle" id="Measurable-v-chk32" style="display: none" type="checkbox"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>V</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>Hm</var><span class="hyp-type"><b>: </b><span>Measurable V</span></span></span><br><span><var>a</var><span class="hyp-type"><b>: </b><span>V</span></span></span><br><span><var>vs</var><span class="hyp-type"><b>: </b><span>list V</span></span></span><br><span><var>IHvs</var><span class="hyp-type"><b>: </b><span><span class="kr">‚àÄ</span> <span class="nv">vs&#39;</span> : list V,
  sum_weights (vs ++ vs&#39;) =
  (sum_weights vs + sum_weights vs&#39;)%R</span></span></span><br><span><var>vs'</var><span class="hyp-type"><b>: </b><span>list V</span></span></span><br></div><label class="goal-separator" for="Measurable-v-chk32"><hr></label><div class="goal-conclusion">(`(weight a) + sum_weights (vs ++ vs&#39;))%R =
(`(weight a) + sum_weights vs + sum_weights vs&#39;)%R</div></blockquote></div></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="Measurable-v-chk33" style="display: none" type="checkbox"><label class="alectryon-input" for="Measurable-v-chk33">-</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>V</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>Hm</var><span class="hyp-type"><b>: </b><span>Measurable V</span></span></span><br><span><var>vs'</var><span class="hyp-type"><b>: </b><span>list V</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">sum_weights vs&#39; = (<span class="mi">0</span> + sum_weights vs&#39;)%R</div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="bp">by</span> <span class="nb">rewrite</span> Rplus_0_l.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="Measurable-v-chk34" style="display: none" type="checkbox"><label class="alectryon-input" for="Measurable-v-chk34">-</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>V</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>Hm</var><span class="hyp-type"><b>: </b><span>Measurable V</span></span></span><br><span><var>a</var><span class="hyp-type"><b>: </b><span>V</span></span></span><br><span><var>vs</var><span class="hyp-type"><b>: </b><span>list V</span></span></span><br><span><var>IHvs</var><span class="hyp-type"><b>: </b><span><span class="kr">‚àÄ</span> <span class="nv">vs&#39;</span> : list V,
  sum_weights (vs ++ vs&#39;) =
  (sum_weights vs + sum_weights vs&#39;)%R</span></span></span><br><span><var>vs'</var><span class="hyp-type"><b>: </b><span>list V</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">(`(weight a) + sum_weights (vs ++ vs&#39;))%R =
(`(weight a) + sum_weights vs + sum_weights vs&#39;)%R</div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="bp">by</span> <span class="nb">rewrite</span> IHvs, Rplus_assoc.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Qed</span>.</span></span></pre></article></body></html>