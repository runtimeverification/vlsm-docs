<!DOCTYPE html>
<html class="alectryon-standalone"><head><title>Composition.v</title><meta charset="utf-8"><meta content="Alectryon" name="generator"><meta name="viewport" content="width=device-width, initial-scale=1"><link href="alectryon.css" rel="stylesheet"><link href="pygments.css" rel="stylesheet">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/IBM-type/0.5.4/css/ibm-type.min.css" integrity="sha512-sky5cf9Ts6FY1kstGOBHSybfKqdHR41M0Ldb0BjNiv3ifltoQIsg0zIaQ+wwdwgQ0w9vKFW7Js50lxH9vqNSSw==" crossorigin="anonymous" />
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/firacode/5.2.0/fira_code.min.css" integrity="sha512-MbysAYimH1hH2xYzkkMHB6MqxBqfP0megxsCLknbYqHVwXTCg9IqHbk+ZP/vnhO8UEW6PaXAkKe2vQ+SWACxxA==" crossorigin="anonymous" /><script src="alectryon.js"></script></head><body><article class="alectryon-root alectryon-windowed alectryon-coqdoc"><div class="alectryon-banner">Built with <a href="https://github.com/cpitclaudel/alectryon/">Alectryon</a>, running Coq+SerAPI v8.15.0+0.15.2. Bubbles (<span class="alectryon-bubble"></span>) indicate interactive fragments: hover for details, tap to reveal contents. Use <kbd>Ctrl+‚Üë</kbd> <kbd>Ctrl+‚Üì</kbd> to navigate, <kbd>Ctrl+üñ±Ô∏è</kbd> to focus. On Mac, use <kbd>‚åò</kbd> instead of <kbd>Ctrl</kbd>.</div><pre class="alectryon-io highlight"><!-- Generator: Alectryon --><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">From</span> Cdcl <span class="kn">Require Import</span> Itauto.</span><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><span class="alectryon-input">#[local] <span class="kn">Tactic Notation</span> <span class="s2">&quot;itauto&quot;</span> := itauto <span class="nb">auto</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">From</span> stdpp <span class="kn">Require Import</span> prelude finite.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">From</span> Coq <span class="kn">Require Import</span> Streams FunctionalExtensionality Eqdep_dec.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">From</span> VLSM.Lib <span class="kn">Require Import</span> Preamble ListExtras.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">From</span> VLSM.Core <span class="kn">Require Import</span> VLSM Plans VLSMProjections.</span></span></pre><div class="doc">
<a id="lab1"></a><h1 class="section">VLSM Composition</h1>
</div><pre class="alectryon-io highlight"><!-- Generator: Alectryon --></pre><div class="doc">
  This module provides Coq definitions for composite VLSMs and their projections
  to components.

</div><pre class="alectryon-io highlight"><!-- Generator: Alectryon --><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Section</span> <span class="nf">VLSM_composition</span>.</span></span></pre><div class="doc">
  Let us fix a type for <code>message</code>s, and an <code>index</code> type for the VLSM components
  such that equality on <code>index</code> is decidable.

</div><pre class="alectryon-io highlight"><!-- Generator: Alectryon --><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Context</span>
  {<span class="nv">message</span> : <span class="kt">Type</span>}
  `{EqDecision index}
  (IM : index -&gt; VLSM message)
  .</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
</span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Section</span> <span class="nf">composite_type</span>.</span></span></pre><div class="doc">
<a id="lab2"></a><h2 class="section">The type of a composite VLSM</h2>
<div class="paragraph"> </div>

  Let IM be a family of VLSMs indexed by <code>index</code>. Note that all
  <span class="inlinecode"><span class="id" title="var">VLSM</span></span>s share the same type of <code>message</code>s.

<div class="paragraph"> </div>
</div><pre class="alectryon-io highlight"><!-- Generator: Alectryon --></pre><div class="doc">
  A <span class="inlinecode"><span class="id" title="var">composite_state</span></span> is an indexed family of <span class="inlinecode"><span class="id" title="var">state</span></span>s, yielding for each
  index <code>n</code> a <span class="inlinecode"><span class="id" title="var">state</span></span> of <span class="inlinecode"><span class="id" title="keyword">type</span></span> <code>IT n</code>, the <span class="inlinecode"><span class="id" title="var">VLSMType</span></span> corresponding to
  machine <code>n</code>.

<div class="paragraph"> </div>

  Note that the <span class="inlinecode"><span class="id" title="var">composite_state</span></span> type is the dependent product type of the
  family of <span class="inlinecode"><span class="id" title="var">state</span></span> types corresponding to each index.

</div><pre class="alectryon-io highlight"><!-- Generator: Alectryon --><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Definition</span> <span class="nf">composite_state</span> : <span class="kt">Type</span> :=
  <span class="kr">forall</span> <span class="nv">n</span> : index, vstate (IM n).</span></span></pre><div class="doc">
  A <span class="inlinecode"><span class="id" title="var">composite_label</span></span> is a pair between an index <code>N</code> and a <span class="inlinecode"><span class="id" title="var">label</span></span> of <code>IT n</code>.

<div class="paragraph"> </div>

  Note that the <span class="inlinecode"><span class="id" title="var">composite_label</span></span> type is the dependent sum of the family of
  types <code>[@label _ (IT n) | n &lt;- index]</code>.

</div><pre class="alectryon-io highlight"><!-- Generator: Alectryon --><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Definition</span> <span class="nf">composite_label</span>
  : <span class="kt">Type</span>
  := sigT (<span class="kr">fun</span> <span class="nv">n</span> =&gt; vlabel (IM n)).</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
<span class="c">(* Declaring this a &quot;canonical structure&quot; will make type checking</span>
<span class="c">   guess that a VLSMType should be composite_type instead of just</span>
<span class="c">   failing, if it has to compare composite_state with state or</span>
<span class="c">   vstate of an unsolved VLSMType or VLSM.</span>
<span class="c"> *)</span>
</span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Canonical Structure</span> <span class="nf">composite_type</span> : VLSMType message :=
  {| state := composite_state
   ; label := composite_label
  |}.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
</span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Definition</span> <span class="nf">composite_transition_item</span> : <span class="kt">Type</span> := @transition_item message composite_type.</span></span></pre><div class="doc">
  A very useful operation on <span class="inlinecode"><span class="id" title="var">composite_state</span></span>s is updating the state corresponding
  to a component:

</div><pre class="alectryon-io highlight"><!-- Generator: Alectryon --><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Definition</span> <span class="nf">state_update</span>
           (<span class="nv">s</span> : composite_state)
           (<span class="nv">i</span> : index)
           (<span class="nv">si</span> : vstate (IM i))
           (<span class="nv">j</span> : index)
  : vstate (IM j)
  :=
  <span class="kr">match</span> decide (j = i) <span class="kr">with</span>
  | <span class="nb">left</span> e =&gt; eq_rect_r (<span class="kr">fun</span> <span class="nv">i</span> =&gt; vstate (IM i)) si e
  | _ =&gt; s j
  <span class="kr">end</span>.</span></span></pre><div class="doc">
The next few results describe several properties of the <span class="inlinecode"><span class="id" title="var">state_update</span></span> operation. 
</div><pre class="alectryon-io highlight"><!-- Generator: Alectryon --><span class="alectryon-sentence"><input class="alectryon-toggle" id="Composition-v-chk0" style="display: none" type="checkbox"><label class="alectryon-input" for="Composition-v-chk0"><span class="kn">Lemma</span> <span class="nf">state_update_neq</span>
           (<span class="nv">s</span> : composite_state)
           (<span class="nv">i</span> : index)
           (<span class="nv">si</span> : vstate (IM i))
           (<span class="nv">j</span> : index)
           (<span class="nv">Hneq</span> : j &lt;&gt; i)
  : state_update s i si j = s j.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>message, index</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>EqDecision0</var><span class="hyp-type"><b>: </b><span>EqDecision index</span></span></span><br><span><var>IM</var><span class="hyp-type"><b>: </b><span>index ‚Üí VLSM message</span></span></span><br><span><var>s</var><span class="hyp-type"><b>: </b><span>composite_state</span></span></span><br><span><var>i</var><span class="hyp-type"><b>: </b><span>index</span></span></span><br><span><var>si</var><span class="hyp-type"><b>: </b><span>vstate (IM i)</span></span></span><br><span><var>j</var><span class="hyp-type"><b>: </b><span>index</span></span></span><br><span><var>Hneq</var><span class="hyp-type"><b>: </b><span>j ‚â† i</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">state_update s i si j = s j</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="Composition-v-chk1" style="display: none" type="checkbox"><label class="alectryon-input" for="Composition-v-chk1"><span class="kn">Proof</span>.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>message, index</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>EqDecision0</var><span class="hyp-type"><b>: </b><span>EqDecision index</span></span></span><br><span><var>IM</var><span class="hyp-type"><b>: </b><span>index ‚Üí VLSM message</span></span></span><br><span><var>s</var><span class="hyp-type"><b>: </b><span>composite_state</span></span></span><br><span><var>i</var><span class="hyp-type"><b>: </b><span>index</span></span></span><br><span><var>si</var><span class="hyp-type"><b>: </b><span>vstate (IM i)</span></span></span><br><span><var>j</var><span class="hyp-type"><b>: </b><span>index</span></span></span><br><span><var>Hneq</var><span class="hyp-type"><b>: </b><span>j ‚â† i</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">state_update s i si j = s j</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><span class="alectryon-input"><span class="bp">by</span> <span class="nb">unfold</span> state_update; case_decide.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Qed</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
</span><span class="alectryon-sentence"><input class="alectryon-toggle" id="Composition-v-chk2" style="display: none" type="checkbox"><label class="alectryon-input" for="Composition-v-chk2"><span class="kn">Lemma</span> <span class="nf">state_update_eq</span>
           (<span class="nv">s</span> : composite_state)
           (<span class="nv">i</span> : index)
           (<span class="nv">si</span> : vstate (IM i))
  : state_update s i si i = si.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>message, index</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>EqDecision0</var><span class="hyp-type"><b>: </b><span>EqDecision index</span></span></span><br><span><var>IM</var><span class="hyp-type"><b>: </b><span>index ‚Üí VLSM message</span></span></span><br><span><var>s</var><span class="hyp-type"><b>: </b><span>composite_state</span></span></span><br><span><var>i</var><span class="hyp-type"><b>: </b><span>index</span></span></span><br><span><var>si</var><span class="hyp-type"><b>: </b><span>vstate (IM i)</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">state_update s i si i = si</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="Composition-v-chk3" style="display: none" type="checkbox"><label class="alectryon-input" for="Composition-v-chk3"><span class="kn">Proof</span>.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>message, index</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>EqDecision0</var><span class="hyp-type"><b>: </b><span>EqDecision index</span></span></span><br><span><var>IM</var><span class="hyp-type"><b>: </b><span>index ‚Üí VLSM message</span></span></span><br><span><var>s</var><span class="hyp-type"><b>: </b><span>composite_state</span></span></span><br><span><var>i</var><span class="hyp-type"><b>: </b><span>index</span></span></span><br><span><var>si</var><span class="hyp-type"><b>: </b><span>vstate (IM i)</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">state_update s i si i = si</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="Composition-v-chk4" style="display: none" type="checkbox"><label class="alectryon-input" for="Composition-v-chk4"><span class="nb">unfold</span> state_update.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>message, index</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>EqDecision0</var><span class="hyp-type"><b>: </b><span>EqDecision index</span></span></span><br><span><var>IM</var><span class="hyp-type"><b>: </b><span>index ‚Üí VLSM message</span></span></span><br><span><var>s</var><span class="hyp-type"><b>: </b><span>composite_state</span></span></span><br><span><var>i</var><span class="hyp-type"><b>: </b><span>index</span></span></span><br><span><var>si</var><span class="hyp-type"><b>: </b><span>vstate (IM i)</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="kr">match</span> decide (i = i) <span class="kr">with</span>
| <span class="nb">left</span> e =&gt;
    eq_rect_r (<span class="kr">Œª</span> <span class="nv">i</span> : index, vstate (IM i)) si e
| <span class="nb">right</span> _ =&gt; s i
<span class="kr">end</span> = si</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="Composition-v-chk5" style="display: none" type="checkbox"><label class="alectryon-input" for="Composition-v-chk5">case_decide; [| <span class="bp">done</span>].</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>message, index</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>EqDecision0</var><span class="hyp-type"><b>: </b><span>EqDecision index</span></span></span><br><span><var>IM</var><span class="hyp-type"><b>: </b><span>index ‚Üí VLSM message</span></span></span><br><span><var>s</var><span class="hyp-type"><b>: </b><span>composite_state</span></span></span><br><span><var>i</var><span class="hyp-type"><b>: </b><span>index</span></span></span><br><span><var>si</var><span class="hyp-type"><b>: </b><span>vstate (IM i)</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>i = i</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">eq_rect_r (<span class="kr">Œª</span> <span class="nv">i</span> : index, vstate (IM i)) si H = si</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><span class="alectryon-input"><span class="bp">by</span> <span class="nb">replace</span> H <span class="kr">with</span> (eq_refl i) <span class="bp">by</span> (<span class="nb">apply</span> K_dec_type; <span class="bp">done</span>).</span><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Qed</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
</span><span class="alectryon-sentence"><input class="alectryon-toggle" id="Composition-v-chk6" style="display: none" type="checkbox"><label class="alectryon-input" for="Composition-v-chk6"><span class="kn">Lemma</span> <span class="nf">state_update_id</span>
           (<span class="nv">s</span> : composite_state)
           (<span class="nv">i</span> : index)
           (<span class="nv">si</span> : vstate (IM i))
           (<span class="nv">Heq</span> : s i = si)
  : state_update s i si = s.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>message, index</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>EqDecision0</var><span class="hyp-type"><b>: </b><span>EqDecision index</span></span></span><br><span><var>IM</var><span class="hyp-type"><b>: </b><span>index ‚Üí VLSM message</span></span></span><br><span><var>s</var><span class="hyp-type"><b>: </b><span>composite_state</span></span></span><br><span><var>i</var><span class="hyp-type"><b>: </b><span>index</span></span></span><br><span><var>si</var><span class="hyp-type"><b>: </b><span>vstate (IM i)</span></span></span><br><span><var>Heq</var><span class="hyp-type"><b>: </b><span>s i = si</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">state_update s i si = s</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="Composition-v-chk7" style="display: none" type="checkbox"><label class="alectryon-input" for="Composition-v-chk7"><span class="kn">Proof</span>.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>message, index</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>EqDecision0</var><span class="hyp-type"><b>: </b><span>EqDecision index</span></span></span><br><span><var>IM</var><span class="hyp-type"><b>: </b><span>index ‚Üí VLSM message</span></span></span><br><span><var>s</var><span class="hyp-type"><b>: </b><span>composite_state</span></span></span><br><span><var>i</var><span class="hyp-type"><b>: </b><span>index</span></span></span><br><span><var>si</var><span class="hyp-type"><b>: </b><span>vstate (IM i)</span></span></span><br><span><var>Heq</var><span class="hyp-type"><b>: </b><span>s i = si</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">state_update s i si = s</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="Composition-v-chk8" style="display: none" type="checkbox"><label class="alectryon-input" for="Composition-v-chk8"><span class="nb">apply</span> functional_extensionality_dep_good.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>message, index</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>EqDecision0</var><span class="hyp-type"><b>: </b><span>EqDecision index</span></span></span><br><span><var>IM</var><span class="hyp-type"><b>: </b><span>index ‚Üí VLSM message</span></span></span><br><span><var>s</var><span class="hyp-type"><b>: </b><span>composite_state</span></span></span><br><span><var>i</var><span class="hyp-type"><b>: </b><span>index</span></span></span><br><span><var>si</var><span class="hyp-type"><b>: </b><span>vstate (IM i)</span></span></span><br><span><var>Heq</var><span class="hyp-type"><b>: </b><span>s i = si</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="kr">‚àÄ</span> <span class="nv">x</span> : index, state_update s i si x = s x</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="Composition-v-chk9" style="display: none" type="checkbox"><label class="alectryon-input" for="Composition-v-chk9"><span class="nb">intro</span> j.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>message, index</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>EqDecision0</var><span class="hyp-type"><b>: </b><span>EqDecision index</span></span></span><br><span><var>IM</var><span class="hyp-type"><b>: </b><span>index ‚Üí VLSM message</span></span></span><br><span><var>s</var><span class="hyp-type"><b>: </b><span>composite_state</span></span></span><br><span><var>i</var><span class="hyp-type"><b>: </b><span>index</span></span></span><br><span><var>si</var><span class="hyp-type"><b>: </b><span>vstate (IM i)</span></span></span><br><span><var>Heq</var><span class="hyp-type"><b>: </b><span>s i = si</span></span></span><br><span><var>j</var><span class="hyp-type"><b>: </b><span>index</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">state_update s i si j = s j</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="Composition-v-chka" style="display: none" type="checkbox"><label class="alectryon-input" for="Composition-v-chka"><span class="nb">destruct</span> (decide (j = i)).</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>message, index</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>EqDecision0</var><span class="hyp-type"><b>: </b><span>EqDecision index</span></span></span><br><span><var>IM</var><span class="hyp-type"><b>: </b><span>index ‚Üí VLSM message</span></span></span><br><span><var>s</var><span class="hyp-type"><b>: </b><span>composite_state</span></span></span><br><span><var>i</var><span class="hyp-type"><b>: </b><span>index</span></span></span><br><span><var>si</var><span class="hyp-type"><b>: </b><span>vstate (IM i)</span></span></span><br><span><var>Heq</var><span class="hyp-type"><b>: </b><span>s i = si</span></span></span><br><span><var>j</var><span class="hyp-type"><b>: </b><span>index</span></span></span><br><span><var>e</var><span class="hyp-type"><b>: </b><span>j = i</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">state_update s i si j = s j</div></blockquote><div class="alectryon-extra-goals"><input class="alectryon-extra-goal-toggle" id="Composition-v-chkb" style="display: none" type="checkbox"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>message, index</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>EqDecision0</var><span class="hyp-type"><b>: </b><span>EqDecision index</span></span></span><br><span><var>IM</var><span class="hyp-type"><b>: </b><span>index ‚Üí VLSM message</span></span></span><br><span><var>s</var><span class="hyp-type"><b>: </b><span>composite_state</span></span></span><br><span><var>i</var><span class="hyp-type"><b>: </b><span>index</span></span></span><br><span><var>si</var><span class="hyp-type"><b>: </b><span>vstate (IM i)</span></span></span><br><span><var>Heq</var><span class="hyp-type"><b>: </b><span>s i = si</span></span></span><br><span><var>j</var><span class="hyp-type"><b>: </b><span>index</span></span></span><br><span><var>n</var><span class="hyp-type"><b>: </b><span>j ‚â† i</span></span></span><br></div><label class="goal-separator" for="Composition-v-chkb"><hr></label><div class="goal-conclusion">state_update s i si j = s j</div></blockquote></div></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="Composition-v-chkc" style="display: none" type="checkbox"><label class="alectryon-input" for="Composition-v-chkc">-</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>message, index</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>EqDecision0</var><span class="hyp-type"><b>: </b><span>EqDecision index</span></span></span><br><span><var>IM</var><span class="hyp-type"><b>: </b><span>index ‚Üí VLSM message</span></span></span><br><span><var>s</var><span class="hyp-type"><b>: </b><span>composite_state</span></span></span><br><span><var>i</var><span class="hyp-type"><b>: </b><span>index</span></span></span><br><span><var>si</var><span class="hyp-type"><b>: </b><span>vstate (IM i)</span></span></span><br><span><var>Heq</var><span class="hyp-type"><b>: </b><span>s i = si</span></span></span><br><span><var>j</var><span class="hyp-type"><b>: </b><span>index</span></span></span><br><span><var>e</var><span class="hyp-type"><b>: </b><span>j = i</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">state_update s i si j = s j</div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="Composition-v-chkd" style="display: none" type="checkbox"><label class="alectryon-input" for="Composition-v-chkd"><span class="nb">subst</span>.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>message, index</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>EqDecision0</var><span class="hyp-type"><b>: </b><span>EqDecision index</span></span></span><br><span><var>IM</var><span class="hyp-type"><b>: </b><span>index ‚Üí VLSM message</span></span></span><br><span><var>s</var><span class="hyp-type"><b>: </b><span>composite_state</span></span></span><br><span><var>i</var><span class="hyp-type"><b>: </b><span>index</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">state_update s i (s i) i = s i</div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="nb">apply</span> state_update_eq.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="Composition-v-chke" style="display: none" type="checkbox"><label class="alectryon-input" for="Composition-v-chke">-</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>message, index</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>EqDecision0</var><span class="hyp-type"><b>: </b><span>EqDecision index</span></span></span><br><span><var>IM</var><span class="hyp-type"><b>: </b><span>index ‚Üí VLSM message</span></span></span><br><span><var>s</var><span class="hyp-type"><b>: </b><span>composite_state</span></span></span><br><span><var>i</var><span class="hyp-type"><b>: </b><span>index</span></span></span><br><span><var>si</var><span class="hyp-type"><b>: </b><span>vstate (IM i)</span></span></span><br><span><var>Heq</var><span class="hyp-type"><b>: </b><span>s i = si</span></span></span><br><span><var>j</var><span class="hyp-type"><b>: </b><span>index</span></span></span><br><span><var>n</var><span class="hyp-type"><b>: </b><span>j ‚â† i</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">state_update s i si j = s j</div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="bp">by</span> <span class="nb">apply</span> state_update_neq.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Qed</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
</span><span class="alectryon-sentence"><input class="alectryon-toggle" id="Composition-v-chkf" style="display: none" type="checkbox"><label class="alectryon-input" for="Composition-v-chkf"><span class="kn">Lemma</span> <span class="nf">state_update_twice</span>
           (<span class="nv">s</span> : composite_state)
           (<span class="nv">i</span> : index)
           (<span class="nv">si</span> <span class="nv">si&#39;</span>: vstate (IM i))
  : state_update (state_update s i si) i si&#39; = state_update s i si&#39;.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>message, index</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>EqDecision0</var><span class="hyp-type"><b>: </b><span>EqDecision index</span></span></span><br><span><var>IM</var><span class="hyp-type"><b>: </b><span>index ‚Üí VLSM message</span></span></span><br><span><var>s</var><span class="hyp-type"><b>: </b><span>composite_state</span></span></span><br><span><var>i</var><span class="hyp-type"><b>: </b><span>index</span></span></span><br><span><var>si, si'</var><span class="hyp-type"><b>: </b><span>vstate (IM i)</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">state_update (state_update s i si) i si&#39; =
state_update s i si&#39;</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="Composition-v-chk10" style="display: none" type="checkbox"><label class="alectryon-input" for="Composition-v-chk10"><span class="kn">Proof</span>.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>message, index</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>EqDecision0</var><span class="hyp-type"><b>: </b><span>EqDecision index</span></span></span><br><span><var>IM</var><span class="hyp-type"><b>: </b><span>index ‚Üí VLSM message</span></span></span><br><span><var>s</var><span class="hyp-type"><b>: </b><span>composite_state</span></span></span><br><span><var>i</var><span class="hyp-type"><b>: </b><span>index</span></span></span><br><span><var>si, si'</var><span class="hyp-type"><b>: </b><span>vstate (IM i)</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">state_update (state_update s i si) i si&#39; =
state_update s i si&#39;</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="Composition-v-chk11" style="display: none" type="checkbox"><label class="alectryon-input" for="Composition-v-chk11"><span class="nb">apply</span> functional_extensionality_dep_good.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>message, index</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>EqDecision0</var><span class="hyp-type"><b>: </b><span>EqDecision index</span></span></span><br><span><var>IM</var><span class="hyp-type"><b>: </b><span>index ‚Üí VLSM message</span></span></span><br><span><var>s</var><span class="hyp-type"><b>: </b><span>composite_state</span></span></span><br><span><var>i</var><span class="hyp-type"><b>: </b><span>index</span></span></span><br><span><var>si, si'</var><span class="hyp-type"><b>: </b><span>vstate (IM i)</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="kr">‚àÄ</span> <span class="nv">x</span> : index,
  state_update (state_update s i si) i si&#39; x =
  state_update s i si&#39; x</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="Composition-v-chk12" style="display: none" type="checkbox"><label class="alectryon-input" for="Composition-v-chk12"><span class="nb">intro</span> j.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>message, index</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>EqDecision0</var><span class="hyp-type"><b>: </b><span>EqDecision index</span></span></span><br><span><var>IM</var><span class="hyp-type"><b>: </b><span>index ‚Üí VLSM message</span></span></span><br><span><var>s</var><span class="hyp-type"><b>: </b><span>composite_state</span></span></span><br><span><var>i</var><span class="hyp-type"><b>: </b><span>index</span></span></span><br><span><var>si, si'</var><span class="hyp-type"><b>: </b><span>vstate (IM i)</span></span></span><br><span><var>j</var><span class="hyp-type"><b>: </b><span>index</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">state_update (state_update s i si) i si&#39; j =
state_update s i si&#39; j</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="Composition-v-chk13" style="display: none" type="checkbox"><label class="alectryon-input" for="Composition-v-chk13"><span class="nb">destruct</span> (decide (j = i)).</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>message, index</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>EqDecision0</var><span class="hyp-type"><b>: </b><span>EqDecision index</span></span></span><br><span><var>IM</var><span class="hyp-type"><b>: </b><span>index ‚Üí VLSM message</span></span></span><br><span><var>s</var><span class="hyp-type"><b>: </b><span>composite_state</span></span></span><br><span><var>i</var><span class="hyp-type"><b>: </b><span>index</span></span></span><br><span><var>si, si'</var><span class="hyp-type"><b>: </b><span>vstate (IM i)</span></span></span><br><span><var>j</var><span class="hyp-type"><b>: </b><span>index</span></span></span><br><span><var>e</var><span class="hyp-type"><b>: </b><span>j = i</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">state_update (state_update s i si) i si&#39; j =
state_update s i si&#39; j</div></blockquote><div class="alectryon-extra-goals"><input class="alectryon-extra-goal-toggle" id="Composition-v-chk14" style="display: none" type="checkbox"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>message, index</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>EqDecision0</var><span class="hyp-type"><b>: </b><span>EqDecision index</span></span></span><br><span><var>IM</var><span class="hyp-type"><b>: </b><span>index ‚Üí VLSM message</span></span></span><br><span><var>s</var><span class="hyp-type"><b>: </b><span>composite_state</span></span></span><br><span><var>i</var><span class="hyp-type"><b>: </b><span>index</span></span></span><br><span><var>si, si'</var><span class="hyp-type"><b>: </b><span>vstate (IM i)</span></span></span><br><span><var>j</var><span class="hyp-type"><b>: </b><span>index</span></span></span><br><span><var>n</var><span class="hyp-type"><b>: </b><span>j ‚â† i</span></span></span><br></div><label class="goal-separator" for="Composition-v-chk14"><hr></label><div class="goal-conclusion">state_update (state_update s i si) i si&#39; j =
state_update s i si&#39; j</div></blockquote></div></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="Composition-v-chk15" style="display: none" type="checkbox"><label class="alectryon-input" for="Composition-v-chk15">-</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>message, index</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>EqDecision0</var><span class="hyp-type"><b>: </b><span>EqDecision index</span></span></span><br><span><var>IM</var><span class="hyp-type"><b>: </b><span>index ‚Üí VLSM message</span></span></span><br><span><var>s</var><span class="hyp-type"><b>: </b><span>composite_state</span></span></span><br><span><var>i</var><span class="hyp-type"><b>: </b><span>index</span></span></span><br><span><var>si, si'</var><span class="hyp-type"><b>: </b><span>vstate (IM i)</span></span></span><br><span><var>j</var><span class="hyp-type"><b>: </b><span>index</span></span></span><br><span><var>e</var><span class="hyp-type"><b>: </b><span>j = i</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">state_update (state_update s i si) i si&#39; j =
state_update s i si&#39; j</div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="Composition-v-chk16" style="display: none" type="checkbox"><label class="alectryon-input" for="Composition-v-chk16"><span class="nb">subst</span>.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>message, index</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>EqDecision0</var><span class="hyp-type"><b>: </b><span>EqDecision index</span></span></span><br><span><var>IM</var><span class="hyp-type"><b>: </b><span>index ‚Üí VLSM message</span></span></span><br><span><var>s</var><span class="hyp-type"><b>: </b><span>composite_state</span></span></span><br><span><var>i</var><span class="hyp-type"><b>: </b><span>index</span></span></span><br><span><var>si, si'</var><span class="hyp-type"><b>: </b><span>vstate (IM i)</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">state_update (state_update s i si) i si&#39; i =
state_update s i si&#39; i</div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="Composition-v-chk17" style="display: none" type="checkbox"><label class="alectryon-input" for="Composition-v-chk17"><span class="nb">rewrite</span> state_update_eq.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>message, index</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>EqDecision0</var><span class="hyp-type"><b>: </b><span>EqDecision index</span></span></span><br><span><var>IM</var><span class="hyp-type"><b>: </b><span>index ‚Üí VLSM message</span></span></span><br><span><var>s</var><span class="hyp-type"><b>: </b><span>composite_state</span></span></span><br><span><var>i</var><span class="hyp-type"><b>: </b><span>index</span></span></span><br><span><var>si, si'</var><span class="hyp-type"><b>: </b><span>vstate (IM i)</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">si&#39; = state_update s i si&#39; i</div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="Composition-v-chk18" style="display: none" type="checkbox"><label class="alectryon-input" for="Composition-v-chk18"><span class="nb">symmetry</span>.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>message, index</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>EqDecision0</var><span class="hyp-type"><b>: </b><span>EqDecision index</span></span></span><br><span><var>IM</var><span class="hyp-type"><b>: </b><span>index ‚Üí VLSM message</span></span></span><br><span><var>s</var><span class="hyp-type"><b>: </b><span>composite_state</span></span></span><br><span><var>i</var><span class="hyp-type"><b>: </b><span>index</span></span></span><br><span><var>si, si'</var><span class="hyp-type"><b>: </b><span>vstate (IM i)</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">state_update s i si&#39; i = si&#39;</div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="nb">apply</span> state_update_eq.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="Composition-v-chk19" style="display: none" type="checkbox"><label class="alectryon-input" for="Composition-v-chk19">-</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>message, index</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>EqDecision0</var><span class="hyp-type"><b>: </b><span>EqDecision index</span></span></span><br><span><var>IM</var><span class="hyp-type"><b>: </b><span>index ‚Üí VLSM message</span></span></span><br><span><var>s</var><span class="hyp-type"><b>: </b><span>composite_state</span></span></span><br><span><var>i</var><span class="hyp-type"><b>: </b><span>index</span></span></span><br><span><var>si, si'</var><span class="hyp-type"><b>: </b><span>vstate (IM i)</span></span></span><br><span><var>j</var><span class="hyp-type"><b>: </b><span>index</span></span></span><br><span><var>n</var><span class="hyp-type"><b>: </b><span>j ‚â† i</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">state_update (state_update s i si) i si&#39; j =
state_update s i si&#39; j</div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="bp">by</span> <span class="nb">rewrite</span> !state_update_neq.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Qed</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
</span><span class="alectryon-sentence"><input class="alectryon-toggle" id="Composition-v-chk1a" style="display: none" type="checkbox"><label class="alectryon-input" for="Composition-v-chk1a"><span class="kn">Lemma</span> <span class="nf">state_update_twice_neq</span>
           (<span class="nv">s</span> : composite_state)
           (<span class="nv">i</span> <span class="nv">j</span> : index)
           (<span class="nv">si</span> : vstate (IM i))
           (<span class="nv">sj</span> : vstate (IM j))
           (<span class="nv">Hij</span> : j &lt;&gt; i)
  : state_update (state_update s i si) j sj
  = state_update (state_update s j sj) i si.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>message, index</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>EqDecision0</var><span class="hyp-type"><b>: </b><span>EqDecision index</span></span></span><br><span><var>IM</var><span class="hyp-type"><b>: </b><span>index ‚Üí VLSM message</span></span></span><br><span><var>s</var><span class="hyp-type"><b>: </b><span>composite_state</span></span></span><br><span><var>i, j</var><span class="hyp-type"><b>: </b><span>index</span></span></span><br><span><var>si</var><span class="hyp-type"><b>: </b><span>vstate (IM i)</span></span></span><br><span><var>sj</var><span class="hyp-type"><b>: </b><span>vstate (IM j)</span></span></span><br><span><var>Hij</var><span class="hyp-type"><b>: </b><span>j ‚â† i</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">state_update (state_update s i si) j sj =
state_update (state_update s j sj) i si</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="Composition-v-chk1b" style="display: none" type="checkbox"><label class="alectryon-input" for="Composition-v-chk1b"><span class="kn">Proof</span>.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>message, index</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>EqDecision0</var><span class="hyp-type"><b>: </b><span>EqDecision index</span></span></span><br><span><var>IM</var><span class="hyp-type"><b>: </b><span>index ‚Üí VLSM message</span></span></span><br><span><var>s</var><span class="hyp-type"><b>: </b><span>composite_state</span></span></span><br><span><var>i, j</var><span class="hyp-type"><b>: </b><span>index</span></span></span><br><span><var>si</var><span class="hyp-type"><b>: </b><span>vstate (IM i)</span></span></span><br><span><var>sj</var><span class="hyp-type"><b>: </b><span>vstate (IM j)</span></span></span><br><span><var>Hij</var><span class="hyp-type"><b>: </b><span>j ‚â† i</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">state_update (state_update s i si) j sj =
state_update (state_update s j sj) i si</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="Composition-v-chk1c" style="display: none" type="checkbox"><label class="alectryon-input" for="Composition-v-chk1c"><span class="nb">apply</span> functional_extensionality_dep_good.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>message, index</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>EqDecision0</var><span class="hyp-type"><b>: </b><span>EqDecision index</span></span></span><br><span><var>IM</var><span class="hyp-type"><b>: </b><span>index ‚Üí VLSM message</span></span></span><br><span><var>s</var><span class="hyp-type"><b>: </b><span>composite_state</span></span></span><br><span><var>i, j</var><span class="hyp-type"><b>: </b><span>index</span></span></span><br><span><var>si</var><span class="hyp-type"><b>: </b><span>vstate (IM i)</span></span></span><br><span><var>sj</var><span class="hyp-type"><b>: </b><span>vstate (IM j)</span></span></span><br><span><var>Hij</var><span class="hyp-type"><b>: </b><span>j ‚â† i</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="kr">‚àÄ</span> <span class="nv">x</span> : index,
  state_update (state_update s i si) j sj x =
  state_update (state_update s j sj) i si x</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="Composition-v-chk1d" style="display: none" type="checkbox"><label class="alectryon-input" for="Composition-v-chk1d"><span class="nb">intro</span> k.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>message, index</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>EqDecision0</var><span class="hyp-type"><b>: </b><span>EqDecision index</span></span></span><br><span><var>IM</var><span class="hyp-type"><b>: </b><span>index ‚Üí VLSM message</span></span></span><br><span><var>s</var><span class="hyp-type"><b>: </b><span>composite_state</span></span></span><br><span><var>i, j</var><span class="hyp-type"><b>: </b><span>index</span></span></span><br><span><var>si</var><span class="hyp-type"><b>: </b><span>vstate (IM i)</span></span></span><br><span><var>sj</var><span class="hyp-type"><b>: </b><span>vstate (IM j)</span></span></span><br><span><var>Hij</var><span class="hyp-type"><b>: </b><span>j ‚â† i</span></span></span><br><span><var>k</var><span class="hyp-type"><b>: </b><span>index</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">state_update (state_update s i si) j sj k =
state_update (state_update s j sj) i si k</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="Composition-v-chk1e" style="display: none" type="checkbox"><label class="alectryon-input" for="Composition-v-chk1e"><span class="nb">destruct</span> (decide (k = j)); <span class="nb">destruct</span> (decide (k = i)); <span class="nb">subst</span>
  ; <span class="kp">repeat</span> (<span class="nb">rewrite</span> state_update_eq ; <span class="kp">try</span> (<span class="nb">rewrite</span> state_update_neq; <span class="kp">try</span> <span class="bp">done</span>))
  ; <span class="kp">try</span> <span class="bp">done</span>.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>message, index</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>EqDecision0</var><span class="hyp-type"><b>: </b><span>EqDecision index</span></span></span><br><span><var>IM</var><span class="hyp-type"><b>: </b><span>index ‚Üí VLSM message</span></span></span><br><span><var>s</var><span class="hyp-type"><b>: </b><span>composite_state</span></span></span><br><span><var>i, j</var><span class="hyp-type"><b>: </b><span>index</span></span></span><br><span><var>si</var><span class="hyp-type"><b>: </b><span>vstate (IM i)</span></span></span><br><span><var>sj</var><span class="hyp-type"><b>: </b><span>vstate (IM j)</span></span></span><br><span><var>Hij</var><span class="hyp-type"><b>: </b><span>j ‚â† i</span></span></span><br><span><var>k</var><span class="hyp-type"><b>: </b><span>index</span></span></span><br><span><var>n</var><span class="hyp-type"><b>: </b><span>k ‚â† j</span></span></span><br><span><var>n0</var><span class="hyp-type"><b>: </b><span>k ‚â† i</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">state_update (state_update s i si) j sj k =
state_update (state_update s j sj) i si k</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><span class="alectryon-input"><span class="bp">by</span> <span class="nb">rewrite</span> !state_update_neq.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Qed</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
</span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">End</span> <span class="nf">composite_type</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
</span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Section</span> <span class="nf">sec_composite_vlsm</span>.</span></span></pre><div class="doc">
<a id="lab3"></a><h2 class="section">Constrained VLSM composition</h2>
<div class="paragraph"> </div>

  Assume an non-empty <code>index</code> type and let <code>IT</code> be
  an <code>index</code>ed family of <span class="inlinecode"><span class="id" title="var">VLSMType</span></span>s, and for each index <code>i</code>, let <code>IM i</code> be
  a <span class="inlinecode"><span class="id" title="var">VLSMMachine</span></span> of type <code>IT i</code>.

</div><pre class="alectryon-io highlight"><!-- Generator: Alectryon --></pre><div class="doc">
  A <span class="inlinecode"><span class="id" title="var">composite_state</span></span> has the <span class="inlinecode"><span class="id" title="var">initial_state_prop</span></span>erty if all of its component
  states have the <span class="inlinecode"><span class="id" title="var">initial_state_prop</span></span>erty in the corresponding component signature.

</div><pre class="alectryon-io highlight"><!-- Generator: Alectryon --><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Definition</span> <span class="nf">composite_initial_state_prop</span>
           (<span class="nv">s</span> : composite_state)
  : <span class="kt">Prop</span>
  :=
    <span class="kr">forall</span> <span class="nv">n</span> : index, vinitial_state_prop (IM n) (s n).</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
</span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Definition</span> <span class="nf">composite_initial_state</span>
  := sig composite_initial_state_prop.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
</span><span class="alectryon-sentence"><input class="alectryon-toggle" id="Composition-v-chk1f" style="display: none" type="checkbox"><label class="alectryon-input" for="Composition-v-chk1f"><span class="kn">Definition</span> <span class="nf">composite_s0</span> : composite_initial_state.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>message, index</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>EqDecision0</var><span class="hyp-type"><b>: </b><span>EqDecision index</span></span></span><br><span><var>IM</var><span class="hyp-type"><b>: </b><span>index ‚Üí VLSM message</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">composite_initial_state</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="Composition-v-chk20" style="display: none" type="checkbox"><label class="alectryon-input" for="Composition-v-chk20"><span class="kn">Proof</span>.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>message, index</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>EqDecision0</var><span class="hyp-type"><b>: </b><span>EqDecision index</span></span></span><br><span><var>IM</var><span class="hyp-type"><b>: </b><span>index ‚Üí VLSM message</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">composite_initial_state</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="Composition-v-chk21" style="display: none" type="checkbox"><label class="alectryon-input" for="Composition-v-chk21"><span class="kr">exists</span> (<span class="nv">fun</span> (n : index) =&gt; proj1_sig (vs0 (IM n))).</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>message, index</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>EqDecision0</var><span class="hyp-type"><b>: </b><span>EqDecision index</span></span></span><br><span><var>IM</var><span class="hyp-type"><b>: </b><span>index ‚Üí VLSM message</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">composite_initial_state_prop
  (<span class="kr">Œª</span> <span class="nv">n</span> : index, `(vs0 (IM n)))</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><span class="alectryon-input"><span class="bp">by</span> <span class="nb">intro</span> i; <span class="nb">destruct</span> (vs0 (IM i)) <span class="kr">as</span> [s Hs].</span><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Defined</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
</span><span class="alectryon-sentence"><span class="alectryon-input">#[export] <span class="kn">Instance</span> <span class="nf">composite_initial_state_inh</span> : Inhabited composite_initial_state :=
  {| inhabitant := composite_s0 |}.</span></span></pre><div class="doc">
  A message has the <span class="inlinecode"><span class="id" title="var">initial_message_prop</span></span>erty in the composite
  iff it has the <span class="inlinecode"><span class="id" title="var">initial_message_prop</span></span>erty in any of the components.

</div><pre class="alectryon-io highlight"><!-- Generator: Alectryon --><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Definition</span> <span class="nf">composite_initial_message_prop</span> (<span class="nv">m</span> : message) : <span class="kt">Prop</span>
  :=
    <span class="kr">exists</span> (<span class="nv">n</span> : index) (<span class="nv">mi</span> : vinitial_message (IM n)), proj1_sig mi = m.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
</span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Definition</span> <span class="nf">option_composite_initial_message_prop</span> : option message -&gt; <span class="kt">Prop</span>
  := from_option composite_initial_message_prop <span class="kt">True</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
</span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Definition</span> <span class="nf">lift_to_composite_label</span>
  (<span class="nv">j</span> : index)
  (<span class="nv">lj</span> : vlabel (IM j))
  : composite_label
  := existT j lj.</span></span></pre><div class="doc">
  We can always "lift" state <code>sj</code> from component <code>j</code> to a composite state by
  updating an given composite state to <code>sj</code> on component <code>j</code>.

</div><pre class="alectryon-io highlight"><!-- Generator: Alectryon --><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Definition</span> <span class="nf">lift_to_composite_state</span>
  (<span class="nv">s</span> : composite_state)
  (<span class="nv">j</span> : index)
  (<span class="nv">sj</span> : vstate (IM j))
  : composite_state
  := state_update s j sj.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
</span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Definition</span> <span class="nf">lift_to_composite_transition_item</span>
  (<span class="nv">s</span> : composite_state)
  (<span class="nv">j</span> : index)
  : vtransition_item (IM j) -&gt; composite_transition_item :=
  pre_VLSM_full_projection_transition_item_project (type (IM j)) composite_type
    (lift_to_composite_label j) (lift_to_composite_state s j).</span></span></pre><div class="doc">
  A specialized version of <span class="inlinecode"><span class="id" title="var">lift_to_composite_state</span></span> using the initial composite
  state as the base for lifting.

</div><pre class="alectryon-io highlight"><!-- Generator: Alectryon --><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Definition</span> <span class="nf">lift_to_composite_state&#39;</span>
  := lift_to_composite_state (proj1_sig composite_s0).</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
</span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Definition</span> <span class="nf">lift_to_composite_transition_item&#39;</span>
  := lift_to_composite_transition_item (proj1_sig composite_s0).</span></span></pre><div class="doc">
Composite versions for <span class="inlinecode"><span class="id" title="var">plan_item</span></span> and <span class="inlinecode"><span class="id" title="var">plan</span></span>. 
</div><pre class="alectryon-io highlight"><!-- Generator: Alectryon --><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Definition</span> <span class="nf">composite_plan_item</span> := @plan_item _ composite_type.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Definition</span> <span class="nf">composite_plan</span> := list composite_plan_item.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
</span><span class="alectryon-sentence"><input class="alectryon-toggle" id="Composition-v-chk22" style="display: none" type="checkbox"><label class="alectryon-input" for="Composition-v-chk22"><span class="kn">Definition</span> <span class="nf">lift_to_composite_plan_item</span>
  (<span class="nv">i</span> : index)
  (<span class="nv">a</span> : vplan_item (IM i)) :
  composite_plan_item.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>message, index</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>EqDecision0</var><span class="hyp-type"><b>: </b><span>EqDecision index</span></span></span><br><span><var>IM</var><span class="hyp-type"><b>: </b><span>index ‚Üí VLSM message</span></span></span><br><span><var>i</var><span class="hyp-type"><b>: </b><span>index</span></span></span><br><span><var>a</var><span class="hyp-type"><b>: </b><span>vplan_item (IM i)</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">composite_plan_item</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="Composition-v-chk23" style="display: none" type="checkbox"><label class="alectryon-input" for="Composition-v-chk23"><span class="kn">Proof</span>.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>message, index</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>EqDecision0</var><span class="hyp-type"><b>: </b><span>EqDecision index</span></span></span><br><span><var>IM</var><span class="hyp-type"><b>: </b><span>index ‚Üí VLSM message</span></span></span><br><span><var>i</var><span class="hyp-type"><b>: </b><span>index</span></span></span><br><span><var>a</var><span class="hyp-type"><b>: </b><span>vplan_item (IM i)</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">composite_plan_item</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="Composition-v-chk24" style="display: none" type="checkbox"><label class="alectryon-input" for="Composition-v-chk24"><span class="nb">destruct</span> a.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>message, index</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>EqDecision0</var><span class="hyp-type"><b>: </b><span>EqDecision index</span></span></span><br><span><var>IM</var><span class="hyp-type"><b>: </b><span>index ‚Üí VLSM message</span></span></span><br><span><var>i</var><span class="hyp-type"><b>: </b><span>index</span></span></span><br><span><var>label_a</var><span class="hyp-type"><b>: </b><span>label</span></span></span><br><span><var>input_a</var><span class="hyp-type"><b>: </b><span>option message</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">composite_plan_item</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="Composition-v-chk25" style="display: none" type="checkbox"><label class="alectryon-input" for="Composition-v-chk25"><span class="nb">split</span>.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>message, index</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>EqDecision0</var><span class="hyp-type"><b>: </b><span>EqDecision index</span></span></span><br><span><var>IM</var><span class="hyp-type"><b>: </b><span>index ‚Üí VLSM message</span></span></span><br><span><var>i</var><span class="hyp-type"><b>: </b><span>index</span></span></span><br><span><var>label_a</var><span class="hyp-type"><b>: </b><span>label</span></span></span><br><span><var>input_a</var><span class="hyp-type"><b>: </b><span>option message</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">label</div></blockquote><div class="alectryon-extra-goals"><input class="alectryon-extra-goal-toggle" id="Composition-v-chk26" style="display: none" type="checkbox"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>message, index</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>EqDecision0</var><span class="hyp-type"><b>: </b><span>EqDecision index</span></span></span><br><span><var>IM</var><span class="hyp-type"><b>: </b><span>index ‚Üí VLSM message</span></span></span><br><span><var>i</var><span class="hyp-type"><b>: </b><span>index</span></span></span><br><span><var>label_a</var><span class="hyp-type"><b>: </b><span>label</span></span></span><br><span><var>input_a</var><span class="hyp-type"><b>: </b><span>option message</span></span></span><br></div><label class="goal-separator" for="Composition-v-chk26"><hr></label><div class="goal-conclusion">option message</div></blockquote></div></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="Composition-v-chk27" style="display: none" type="checkbox"><label class="alectryon-input" for="Composition-v-chk27">-</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>message, index</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>EqDecision0</var><span class="hyp-type"><b>: </b><span>EqDecision index</span></span></span><br><span><var>IM</var><span class="hyp-type"><b>: </b><span>index ‚Üí VLSM message</span></span></span><br><span><var>i</var><span class="hyp-type"><b>: </b><span>index</span></span></span><br><span><var>label_a</var><span class="hyp-type"><b>: </b><span>label</span></span></span><br><span><var>input_a</var><span class="hyp-type"><b>: </b><span>option message</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">label</div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="bp">exact</span> (existT i label_a).</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="Composition-v-chk28" style="display: none" type="checkbox"><label class="alectryon-input" for="Composition-v-chk28">-</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>message, index</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>EqDecision0</var><span class="hyp-type"><b>: </b><span>EqDecision index</span></span></span><br><span><var>IM</var><span class="hyp-type"><b>: </b><span>index ‚Üí VLSM message</span></span></span><br><span><var>i</var><span class="hyp-type"><b>: </b><span>index</span></span></span><br><span><var>label_a</var><span class="hyp-type"><b>: </b><span>label</span></span></span><br><span><var>input_a</var><span class="hyp-type"><b>: </b><span>option message</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">option message</div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="bp">exact</span> input_a.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Defined</span>.</span></span></pre><div class="doc">
  The <span class="inlinecode"><span class="id" title="var">transition</span></span> function for the <span class="inlinecode"><span class="id" title="var">composite_vlsm</span></span> takes a transition in
  the component selected by the index in the given <span class="inlinecode"><span class="id" title="var">composite_label</span></span>
  with the contained label,
  and returns the produced message together with the state updated on that
  component:

</div><pre class="alectryon-io highlight"><!-- Generator: Alectryon --><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Definition</span> <span class="nf">composite_transition</span>
  (<span class="nv">l</span> : composite_label)
  (<span class="nv">som</span> : composite_state * option message)
  : composite_state * option message
  :=
  <span class="kr">let</span> (<span class="nv">s</span>, om) := som <span class="kr">in</span>
  <span class="kr">let</span> (<span class="nv">i</span>, li) := l <span class="kr">in</span>
  <span class="kr">let</span> (<span class="nv">si&#39;</span>, om&#39;) := vtransition (IM i) li (s i, om) <span class="kr">in</span>
  (state_update s i si&#39;,  om&#39;).</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
</span><span class="alectryon-sentence"><input class="alectryon-toggle" id="Composition-v-chk29" style="display: none" type="checkbox"><label class="alectryon-input" for="Composition-v-chk29"><span class="kn">Lemma</span> <span class="nf">composite_transition_state_neq</span>
  (<span class="nv">l</span> : composite_label)
  (<span class="nv">s</span> <span class="nv">s&#39;</span> : composite_state)
  (<span class="nv">om</span> <span class="nv">om&#39;</span> : option message)
  (<span class="nv">Ht</span> : composite_transition l (s, om) = (s&#39;, om&#39;))
  (<span class="nv">i</span> : index)
  (<span class="nv">Hi</span> : i &lt;&gt; projT1 l)
  : s&#39; i = s i.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>message, index</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>EqDecision0</var><span class="hyp-type"><b>: </b><span>EqDecision index</span></span></span><br><span><var>IM</var><span class="hyp-type"><b>: </b><span>index ‚Üí VLSM message</span></span></span><br><span><var>l</var><span class="hyp-type"><b>: </b><span>composite_label</span></span></span><br><span><var>s, s'</var><span class="hyp-type"><b>: </b><span>composite_state</span></span></span><br><span><var>om, om'</var><span class="hyp-type"><b>: </b><span>option message</span></span></span><br><span><var>Ht</var><span class="hyp-type"><b>: </b><span>composite_transition l (s, om) = (s&#39;, om&#39;)</span></span></span><br><span><var>i</var><span class="hyp-type"><b>: </b><span>index</span></span></span><br><span><var>Hi</var><span class="hyp-type"><b>: </b><span>i ‚â† projT1 l</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">s&#39; i = s i</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="Composition-v-chk2a" style="display: none" type="checkbox"><label class="alectryon-input" for="Composition-v-chk2a"><span class="kn">Proof</span>.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>message, index</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>EqDecision0</var><span class="hyp-type"><b>: </b><span>EqDecision index</span></span></span><br><span><var>IM</var><span class="hyp-type"><b>: </b><span>index ‚Üí VLSM message</span></span></span><br><span><var>l</var><span class="hyp-type"><b>: </b><span>composite_label</span></span></span><br><span><var>s, s'</var><span class="hyp-type"><b>: </b><span>composite_state</span></span></span><br><span><var>om, om'</var><span class="hyp-type"><b>: </b><span>option message</span></span></span><br><span><var>Ht</var><span class="hyp-type"><b>: </b><span>composite_transition l (s, om) = (s&#39;, om&#39;)</span></span></span><br><span><var>i</var><span class="hyp-type"><b>: </b><span>index</span></span></span><br><span><var>Hi</var><span class="hyp-type"><b>: </b><span>i ‚â† projT1 l</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">s&#39; i = s i</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="Composition-v-chk2b" style="display: none" type="checkbox"><label class="alectryon-input" for="Composition-v-chk2b"><span class="nb">destruct</span> l; <span class="nb">cbn</span> <span class="kr">in</span> Ht; <span class="nb">destruct</span> (vtransition _ _ _).</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>message, index</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>EqDecision0</var><span class="hyp-type"><b>: </b><span>EqDecision index</span></span></span><br><span><var>IM</var><span class="hyp-type"><b>: </b><span>index ‚Üí VLSM message</span></span></span><br><span><var>x</var><span class="hyp-type"><b>: </b><span>index</span></span></span><br><span><var>v</var><span class="hyp-type"><b>: </b><span>vlabel (IM x)</span></span></span><br><span><var>s, s'</var><span class="hyp-type"><b>: </b><span>composite_state</span></span></span><br><span><var>om, om'</var><span class="hyp-type"><b>: </b><span>option message</span></span></span><br><span><var>s0</var><span class="hyp-type"><b>: </b><span>state</span></span></span><br><span><var>o</var><span class="hyp-type"><b>: </b><span>option message</span></span></span><br><span><var>Ht</var><span class="hyp-type"><b>: </b><span>(state_update s x s0, o) = (s&#39;, om&#39;)</span></span></span><br><span><var>i</var><span class="hyp-type"><b>: </b><span>index</span></span></span><br><span><var>Hi</var><span class="hyp-type"><b>: </b><span>i ‚â† projT1 (existT x v)</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">s&#39; i = s i</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><span class="alectryon-input"><span class="bp">by</span> <span class="nb">inversion</span> Ht; <span class="nb">apply</span> state_update_neq.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Qed</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
</span><span class="alectryon-sentence"><input class="alectryon-toggle" id="Composition-v-chk2c" style="display: none" type="checkbox"><label class="alectryon-input" for="Composition-v-chk2c"><span class="kn">Lemma</span> <span class="nf">composite_transition_state_eq</span>
  (<span class="nv">i</span> : index)
  (<span class="nv">li</span> : vlabel (IM i))
  (<span class="nv">s</span> <span class="nv">s&#39;</span> : composite_state)
  (<span class="nv">om</span> <span class="nv">om&#39;</span> : option message)
  (<span class="nv">Ht</span> : composite_transition (existT i li) (s, om) = (s&#39;, om&#39;))
  : s&#39; i = fst (vtransition (IM i) li (s i, om)).</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>message, index</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>EqDecision0</var><span class="hyp-type"><b>: </b><span>EqDecision index</span></span></span><br><span><var>IM</var><span class="hyp-type"><b>: </b><span>index ‚Üí VLSM message</span></span></span><br><span><var>i</var><span class="hyp-type"><b>: </b><span>index</span></span></span><br><span><var>li</var><span class="hyp-type"><b>: </b><span>vlabel (IM i)</span></span></span><br><span><var>s, s'</var><span class="hyp-type"><b>: </b><span>composite_state</span></span></span><br><span><var>om, om'</var><span class="hyp-type"><b>: </b><span>option message</span></span></span><br><span><var>Ht</var><span class="hyp-type"><b>: </b><span>composite_transition (existT i li) (s, om) =
(s&#39;, om&#39;)</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">s&#39; i = (vtransition (IM i) li (s i, om)).<span class="mi">1</span></div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="Composition-v-chk2d" style="display: none" type="checkbox"><label class="alectryon-input" for="Composition-v-chk2d"><span class="kn">Proof</span>.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>message, index</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>EqDecision0</var><span class="hyp-type"><b>: </b><span>EqDecision index</span></span></span><br><span><var>IM</var><span class="hyp-type"><b>: </b><span>index ‚Üí VLSM message</span></span></span><br><span><var>i</var><span class="hyp-type"><b>: </b><span>index</span></span></span><br><span><var>li</var><span class="hyp-type"><b>: </b><span>vlabel (IM i)</span></span></span><br><span><var>s, s'</var><span class="hyp-type"><b>: </b><span>composite_state</span></span></span><br><span><var>om, om'</var><span class="hyp-type"><b>: </b><span>option message</span></span></span><br><span><var>Ht</var><span class="hyp-type"><b>: </b><span>composite_transition (existT i li) (s, om) =
(s&#39;, om&#39;)</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">s&#39; i = (vtransition (IM i) li (s i, om)).<span class="mi">1</span></div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><span class="alectryon-input"><span class="nb">cbn</span> <span class="kr">in</span> Ht; <span class="nb">destruct</span> (vtransition _ _ _); <span class="nb">inversion</span> Ht; <span class="nb">apply</span> state_update_eq.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Qed</span>.</span></span></pre><div class="doc">
  Given a <span class="inlinecode"><span class="id" title="var">composite_label</span></span> <code>(i, li)</code> and a <span class="inlinecode"><span class="id" title="var">composite_state</span></span>-message
  pair <code>(s, om)</code>, <span class="inlinecode"><span class="id" title="var">composite_valid</span></span>ity is defined as <span class="inlinecode"><span class="id" title="var">valid</span></span>ity in
  the <code>i</code>th component <code>IM i</code>.

</div><pre class="alectryon-io highlight"><!-- Generator: Alectryon --><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Definition</span> <span class="nf">composite_valid</span>
  (<span class="nv">l</span> : composite_label)
  (<span class="nv">som</span> : composite_state * option message)
  : <span class="kt">Prop</span>
  :=
  <span class="kr">let</span> (<span class="nv">s</span>, om) := som <span class="kr">in</span>
  <span class="kr">let</span> (<span class="nv">i</span>, li) := l <span class="kr">in</span>
  vvalid (IM i) li (s i, om).</span></span></pre><div class="doc">
  A <code>constraint</code> for a composite VLSM is a <span class="inlinecode"><span class="id" title="var">valid</span></span>ity condition defined
  directly on <span class="inlinecode"><span class="id" title="var">composite_label</span></span>s and <span class="inlinecode"><span class="id" title="var">composite_state</span></span>s, thus being able to
  impose a global condition.

<div class="paragraph"> </div>
<span class="inlinecode"><span class="id" title="var">constrained_composite_valid</span></span>ity interposes such a <code>constraint</code> on top of
  the <span class="inlinecode"><span class="id" title="var">composite_valid</span></span>ity.

</div><pre class="alectryon-io highlight"><!-- Generator: Alectryon --><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Definition</span> <span class="nf">constrained_composite_valid</span>
  (<span class="nv">constraint</span> : composite_label -&gt; composite_state * option message -&gt; <span class="kt">Prop</span>)
  (<span class="nv">l</span> : composite_label)
  (<span class="nv">som</span> : composite_state * option message)
  :=
  composite_valid l som /\ constraint l som.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
</span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Definition</span> <span class="nf">composite_vlsm_machine</span>
  (<span class="nv">constraint</span> : composite_label -&gt; composite_state * option message -&gt; <span class="kt">Prop</span>)
  : VLSMMachine composite_type
  :=
  {| initial_state_prop := composite_initial_state_prop
   ; initial_message_prop := composite_initial_message_prop
   ; transition := composite_transition
   ; valid := constrained_composite_valid constraint
  |}.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
</span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Definition</span> <span class="nf">composite_vlsm</span>
  (<span class="nv">constraint</span> : composite_label -&gt; composite_state * option message -&gt; <span class="kt">Prop</span>)
  : VLSM message
  := mk_vlsm (composite_vlsm_machine constraint).</span></span></pre><div class="doc">
  Composite versions for the generic <span class="inlinecode"><span class="id" title="var">_apply_plan</span></span>-related definitions and
  results.

</div><pre class="alectryon-io highlight"><!-- Generator: Alectryon --><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Definition</span> <span class="nf">composite_apply_plan</span> := (@_apply_plan _ composite_type composite_transition).</span><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Definition</span> <span class="nf">composite_apply_plan_app</span>
  (<span class="nv">start</span> : composite_state)
  (<span class="nv">a</span> <span class="nv">a&#39;</span> : list plan_item)
  : composite_apply_plan start (a ++ a&#39;) =
    <span class="kr">let</span> (<span class="nv">aitems</span>, afinal) := composite_apply_plan start a <span class="kr">in</span>
    <span class="kr">let</span> (<span class="nv">a&#39;items</span>, a&#39;final) := composite_apply_plan afinal a&#39; <span class="kr">in</span>
     (aitems ++ a&#39;items, a&#39;final)
  := (@_apply_plan_app _ composite_type composite_transition start a a&#39;).</span><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Definition</span> <span class="nf">composite_apply_plan_last</span>
  (<span class="nv">start</span> : composite_state)
  (<span class="nv">a</span> : list plan_item)
  (<span class="nv">after_a</span> := composite_apply_plan start a)
  : finite_trace_last start (fst after_a) = snd after_a
  := (@_apply_plan_last _ composite_type composite_transition start a).</span><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Definition</span> <span class="nf">composite_trace_to_plan</span> := (@_trace_to_plan _ composite_type).</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
</span><span class="alectryon-sentence"><input class="alectryon-toggle" id="Composition-v-chk2e" style="display: none" type="checkbox"><label class="alectryon-input" for="Composition-v-chk2e"><span class="kn">Lemma</span> <span class="nf">composite_initial_state_prop_lift</span>
  (<span class="nv">j</span> : index)
  (<span class="nv">sj</span> : vstate (IM j))
  (<span class="nv">Hinitj</span> : vinitial_state_prop (IM j) sj)
  : composite_initial_state_prop (lift_to_composite_state&#39; j sj).</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>message, index</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>EqDecision0</var><span class="hyp-type"><b>: </b><span>EqDecision index</span></span></span><br><span><var>IM</var><span class="hyp-type"><b>: </b><span>index ‚Üí VLSM message</span></span></span><br><span><var>j</var><span class="hyp-type"><b>: </b><span>index</span></span></span><br><span><var>sj</var><span class="hyp-type"><b>: </b><span>vstate (IM j)</span></span></span><br><span><var>Hinitj</var><span class="hyp-type"><b>: </b><span>vinitial_state_prop (IM j) sj</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">composite_initial_state_prop
  (lift_to_composite_state&#39; j sj)</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="Composition-v-chk2f" style="display: none" type="checkbox"><label class="alectryon-input" for="Composition-v-chk2f"><span class="kn">Proof</span>.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>message, index</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>EqDecision0</var><span class="hyp-type"><b>: </b><span>EqDecision index</span></span></span><br><span><var>IM</var><span class="hyp-type"><b>: </b><span>index ‚Üí VLSM message</span></span></span><br><span><var>j</var><span class="hyp-type"><b>: </b><span>index</span></span></span><br><span><var>sj</var><span class="hyp-type"><b>: </b><span>vstate (IM j)</span></span></span><br><span><var>Hinitj</var><span class="hyp-type"><b>: </b><span>vinitial_state_prop (IM j) sj</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">composite_initial_state_prop
  (lift_to_composite_state&#39; j sj)</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="Composition-v-chk30" style="display: none" type="checkbox"><label class="alectryon-input" for="Composition-v-chk30"><span class="nb">intro</span> i.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>message, index</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>EqDecision0</var><span class="hyp-type"><b>: </b><span>EqDecision index</span></span></span><br><span><var>IM</var><span class="hyp-type"><b>: </b><span>index ‚Üí VLSM message</span></span></span><br><span><var>j</var><span class="hyp-type"><b>: </b><span>index</span></span></span><br><span><var>sj</var><span class="hyp-type"><b>: </b><span>vstate (IM j)</span></span></span><br><span><var>Hinitj</var><span class="hyp-type"><b>: </b><span>vinitial_state_prop (IM j) sj</span></span></span><br><span><var>i</var><span class="hyp-type"><b>: </b><span>index</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">vinitial_state_prop (IM i)
  (lift_to_composite_state&#39; j sj i)</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="Composition-v-chk31" style="display: none" type="checkbox"><label class="alectryon-input" for="Composition-v-chk31"><span class="nb">unfold</span> lift_to_composite_state&#39;.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>message, index</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>EqDecision0</var><span class="hyp-type"><b>: </b><span>EqDecision index</span></span></span><br><span><var>IM</var><span class="hyp-type"><b>: </b><span>index ‚Üí VLSM message</span></span></span><br><span><var>j</var><span class="hyp-type"><b>: </b><span>index</span></span></span><br><span><var>sj</var><span class="hyp-type"><b>: </b><span>vstate (IM j)</span></span></span><br><span><var>Hinitj</var><span class="hyp-type"><b>: </b><span>vinitial_state_prop (IM j) sj</span></span></span><br><span><var>i</var><span class="hyp-type"><b>: </b><span>index</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">vinitial_state_prop (IM i)
  (lift_to_composite_state (`composite_s0) j sj i)</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="Composition-v-chk32" style="display: none" type="checkbox"><label class="alectryon-input" for="Composition-v-chk32"><span class="nb">destruct</span> (decide (i = j)); <span class="nb">subst</span>.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>message, index</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>EqDecision0</var><span class="hyp-type"><b>: </b><span>EqDecision index</span></span></span><br><span><var>IM</var><span class="hyp-type"><b>: </b><span>index ‚Üí VLSM message</span></span></span><br><span><var>j</var><span class="hyp-type"><b>: </b><span>index</span></span></span><br><span><var>sj</var><span class="hyp-type"><b>: </b><span>vstate (IM j)</span></span></span><br><span><var>Hinitj</var><span class="hyp-type"><b>: </b><span>vinitial_state_prop (IM j) sj</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">vinitial_state_prop (IM j)
  (lift_to_composite_state (`composite_s0) j sj j)</div></blockquote><div class="alectryon-extra-goals"><input class="alectryon-extra-goal-toggle" id="Composition-v-chk33" style="display: none" type="checkbox"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>message, index</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>EqDecision0</var><span class="hyp-type"><b>: </b><span>EqDecision index</span></span></span><br><span><var>IM</var><span class="hyp-type"><b>: </b><span>index ‚Üí VLSM message</span></span></span><br><span><var>j</var><span class="hyp-type"><b>: </b><span>index</span></span></span><br><span><var>sj</var><span class="hyp-type"><b>: </b><span>vstate (IM j)</span></span></span><br><span><var>Hinitj</var><span class="hyp-type"><b>: </b><span>vinitial_state_prop (IM j) sj</span></span></span><br><span><var>i</var><span class="hyp-type"><b>: </b><span>index</span></span></span><br><span><var>n</var><span class="hyp-type"><b>: </b><span>i ‚â† j</span></span></span><br></div><label class="goal-separator" for="Composition-v-chk33"><hr></label><div class="goal-conclusion">vinitial_state_prop (IM i)
  (lift_to_composite_state (`composite_s0) j sj i)</div></blockquote></div></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="Composition-v-chk34" style="display: none" type="checkbox"><label class="alectryon-input" for="Composition-v-chk34">-</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>message, index</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>EqDecision0</var><span class="hyp-type"><b>: </b><span>EqDecision index</span></span></span><br><span><var>IM</var><span class="hyp-type"><b>: </b><span>index ‚Üí VLSM message</span></span></span><br><span><var>j</var><span class="hyp-type"><b>: </b><span>index</span></span></span><br><span><var>sj</var><span class="hyp-type"><b>: </b><span>vstate (IM j)</span></span></span><br><span><var>Hinitj</var><span class="hyp-type"><b>: </b><span>vinitial_state_prop (IM j) sj</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">vinitial_state_prop (IM j)
  (lift_to_composite_state (`composite_s0) j sj j)</div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="bp">by</span> <span class="nb">rewrite</span> state_update_eq.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="Composition-v-chk35" style="display: none" type="checkbox"><label class="alectryon-input" for="Composition-v-chk35">-</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>message, index</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>EqDecision0</var><span class="hyp-type"><b>: </b><span>EqDecision index</span></span></span><br><span><var>IM</var><span class="hyp-type"><b>: </b><span>index ‚Üí VLSM message</span></span></span><br><span><var>j</var><span class="hyp-type"><b>: </b><span>index</span></span></span><br><span><var>sj</var><span class="hyp-type"><b>: </b><span>vstate (IM j)</span></span></span><br><span><var>Hinitj</var><span class="hyp-type"><b>: </b><span>vinitial_state_prop (IM j) sj</span></span></span><br><span><var>i</var><span class="hyp-type"><b>: </b><span>index</span></span></span><br><span><var>n</var><span class="hyp-type"><b>: </b><span>i ‚â† j</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">vinitial_state_prop (IM i)
  (lift_to_composite_state (`composite_s0) j sj i)</div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="Composition-v-chk36" style="display: none" type="checkbox"><label class="alectryon-input" for="Composition-v-chk36"><span class="nb">rewrite</span> state_update_neq; <span class="nb">cbn</span>; [| <span class="bp">done</span>].</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>message, index</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>EqDecision0</var><span class="hyp-type"><b>: </b><span>EqDecision index</span></span></span><br><span><var>IM</var><span class="hyp-type"><b>: </b><span>index ‚Üí VLSM message</span></span></span><br><span><var>j</var><span class="hyp-type"><b>: </b><span>index</span></span></span><br><span><var>sj</var><span class="hyp-type"><b>: </b><span>vstate (IM j)</span></span></span><br><span><var>Hinitj</var><span class="hyp-type"><b>: </b><span>vinitial_state_prop (IM j) sj</span></span></span><br><span><var>i</var><span class="hyp-type"><b>: </b><span>index</span></span></span><br><span><var>n</var><span class="hyp-type"><b>: </b><span>i ‚â† j</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">vinitial_state_prop (IM i) (`(vs0 (IM i)))</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><span class="alectryon-input"><span class="bp">by</span> <span class="nb">destruct</span> (vs0 _) <span class="kr">as</span> [s Hs].</span><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Qed</span>.</span></span></pre><div class="doc">
<a id="lab4"></a><h2 class="section">Free VLSM composition</h2>
<div class="paragraph"> </div>

  The <span class="inlinecode"><span class="id" title="var">free_constraint</span></span> is defined to be <span class="inlinecode"><span class="id" title="var">True</span></span> for all inputs.
  Thus, the <span class="inlinecode"><span class="id" title="var">free_composite_vlsm</span></span> is the <span class="inlinecode"><span class="id" title="var">composite_vlsm</span></span> using the
  <span class="inlinecode"><span class="id" title="var">free_constraint</span></span>.

</div><pre class="alectryon-io highlight"><!-- Generator: Alectryon --><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Definition</span> <span class="nf">free_constraint</span>
  (<span class="nv">l</span> : composite_label)
  (<span class="nv">som</span> : composite_state * option message)
  : <span class="kt">Prop</span>
  := <span class="kt">True</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
</span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Definition</span> <span class="nf">free_composite_vlsm</span> : VLSM message
  := composite_vlsm free_constraint.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
</span><span class="alectryon-sentence"><input class="alectryon-toggle" id="Composition-v-chk37" style="display: none" type="checkbox"><label class="alectryon-input" for="Composition-v-chk37"><span class="kn">Lemma</span> <span class="nf">lift_to_composite_vlsm_full_projection</span> <span class="nv">j</span>
  : VLSM_full_projection (IM j) free_composite_vlsm (lift_to_composite_label j) (lift_to_composite_state&#39; j).</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>message, index</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>EqDecision0</var><span class="hyp-type"><b>: </b><span>EqDecision index</span></span></span><br><span><var>IM</var><span class="hyp-type"><b>: </b><span>index ‚Üí VLSM message</span></span></span><br><span><var>j</var><span class="hyp-type"><b>: </b><span>index</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">VLSM_full_projection (IM j) free_composite_vlsm
  (lift_to_composite_label j)
  (lift_to_composite_state&#39; j)</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="Composition-v-chk38" style="display: none" type="checkbox"><label class="alectryon-input" for="Composition-v-chk38"><span class="kn">Proof</span>.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>message, index</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>EqDecision0</var><span class="hyp-type"><b>: </b><span>EqDecision index</span></span></span><br><span><var>IM</var><span class="hyp-type"><b>: </b><span>index ‚Üí VLSM message</span></span></span><br><span><var>j</var><span class="hyp-type"><b>: </b><span>index</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">VLSM_full_projection (IM j) free_composite_vlsm
  (lift_to_composite_label j)
  (lift_to_composite_state&#39; j)</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="Composition-v-chk39" style="display: none" type="checkbox"><label class="alectryon-input" for="Composition-v-chk39"><span class="nb">apply</span> basic_VLSM_strong_full_projection; <span class="nb">intro</span>; <span class="nb">intros</span>.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>message, index</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>EqDecision0</var><span class="hyp-type"><b>: </b><span>EqDecision index</span></span></span><br><span><var>IM</var><span class="hyp-type"><b>: </b><span>index ‚Üí VLSM message</span></span></span><br><span><var>j</var><span class="hyp-type"><b>: </b><span>index</span></span></span><br><span><var>l</var><span class="hyp-type"><b>: </b><span>label</span></span></span><br><span><var>s</var><span class="hyp-type"><b>: </b><span>state</span></span></span><br><span><var>om</var><span class="hyp-type"><b>: </b><span>option message</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>vvalid (IM j) l (s, om)</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">vvalid free_composite_vlsm
  (lift_to_composite_label j l)
  (lift_to_composite_state&#39; j s, om)</div></blockquote><div class="alectryon-extra-goals"><input class="alectryon-extra-goal-toggle" id="Composition-v-chk3a" style="display: none" type="checkbox"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>message, index</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>EqDecision0</var><span class="hyp-type"><b>: </b><span>EqDecision index</span></span></span><br><span><var>IM</var><span class="hyp-type"><b>: </b><span>index ‚Üí VLSM message</span></span></span><br><span><var>j</var><span class="hyp-type"><b>: </b><span>index</span></span></span><br><span><var>l</var><span class="hyp-type"><b>: </b><span>label</span></span></span><br><span><var>s</var><span class="hyp-type"><b>: </b><span>state</span></span></span><br><span><var>om</var><span class="hyp-type"><b>: </b><span>option message</span></span></span><br><span><var>s'</var><span class="hyp-type"><b>: </b><span>state</span></span></span><br><span><var>om'</var><span class="hyp-type"><b>: </b><span>option message</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>vtransition (IM j) l (s, om) = (s&#39;, om&#39;)</span></span></span><br></div><label class="goal-separator" for="Composition-v-chk3a"><hr></label><div class="goal-conclusion">vtransition free_composite_vlsm
  (lift_to_composite_label j l)
  (lift_to_composite_state&#39; j s, om) =
(lift_to_composite_state&#39; j s&#39;, om&#39;)</div></blockquote><input class="alectryon-extra-goal-toggle" id="Composition-v-chk3b" style="display: none" type="checkbox"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>message, index</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>EqDecision0</var><span class="hyp-type"><b>: </b><span>EqDecision index</span></span></span><br><span><var>IM</var><span class="hyp-type"><b>: </b><span>index ‚Üí VLSM message</span></span></span><br><span><var>j</var><span class="hyp-type"><b>: </b><span>index</span></span></span><br><span><var>s</var><span class="hyp-type"><b>: </b><span>state</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>vinitial_state_prop (IM j) s</span></span></span><br></div><label class="goal-separator" for="Composition-v-chk3b"><hr></label><div class="goal-conclusion">vinitial_state_prop free_composite_vlsm
  (lift_to_composite_state&#39; j s)</div></blockquote><input class="alectryon-extra-goal-toggle" id="Composition-v-chk3c" style="display: none" type="checkbox"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>message, index</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>EqDecision0</var><span class="hyp-type"><b>: </b><span>EqDecision index</span></span></span><br><span><var>IM</var><span class="hyp-type"><b>: </b><span>index ‚Üí VLSM message</span></span></span><br><span><var>j</var><span class="hyp-type"><b>: </b><span>index</span></span></span><br><span><var>m</var><span class="hyp-type"><b>: </b><span>message</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>vinitial_message_prop (IM j) m</span></span></span><br></div><label class="goal-separator" for="Composition-v-chk3c"><hr></label><div class="goal-conclusion">vinitial_message_prop free_composite_vlsm m</div></blockquote></div></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="Composition-v-chk3d" style="display: none" type="checkbox"><label class="alectryon-input" for="Composition-v-chk3d">-</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>message, index</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>EqDecision0</var><span class="hyp-type"><b>: </b><span>EqDecision index</span></span></span><br><span><var>IM</var><span class="hyp-type"><b>: </b><span>index ‚Üí VLSM message</span></span></span><br><span><var>j</var><span class="hyp-type"><b>: </b><span>index</span></span></span><br><span><var>l</var><span class="hyp-type"><b>: </b><span>label</span></span></span><br><span><var>s</var><span class="hyp-type"><b>: </b><span>state</span></span></span><br><span><var>om</var><span class="hyp-type"><b>: </b><span>option message</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>vvalid (IM j) l (s, om)</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">vvalid free_composite_vlsm
  (lift_to_composite_label j l)
  (lift_to_composite_state&#39; j s, om)</div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="Composition-v-chk3e" style="display: none" type="checkbox"><label class="alectryon-input" for="Composition-v-chk3e"><span class="nb">split</span>; [| <span class="bp">done</span>].</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>message, index</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>EqDecision0</var><span class="hyp-type"><b>: </b><span>EqDecision index</span></span></span><br><span><var>IM</var><span class="hyp-type"><b>: </b><span>index ‚Üí VLSM message</span></span></span><br><span><var>j</var><span class="hyp-type"><b>: </b><span>index</span></span></span><br><span><var>l</var><span class="hyp-type"><b>: </b><span>label</span></span></span><br><span><var>s</var><span class="hyp-type"><b>: </b><span>state</span></span></span><br><span><var>om</var><span class="hyp-type"><b>: </b><span>option message</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>vvalid (IM j) l (s, om)</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">composite_valid (lift_to_composite_label j l)
  (lift_to_composite_state&#39; j s, om)</div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="Composition-v-chk3f" style="display: none" type="checkbox"><label class="alectryon-input" for="Composition-v-chk3f"><span class="nb">simpl</span>.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>message, index</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>EqDecision0</var><span class="hyp-type"><b>: </b><span>EqDecision index</span></span></span><br><span><var>IM</var><span class="hyp-type"><b>: </b><span>index ‚Üí VLSM message</span></span></span><br><span><var>j</var><span class="hyp-type"><b>: </b><span>index</span></span></span><br><span><var>l</var><span class="hyp-type"><b>: </b><span>label</span></span></span><br><span><var>s</var><span class="hyp-type"><b>: </b><span>state</span></span></span><br><span><var>om</var><span class="hyp-type"><b>: </b><span>option message</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>vvalid (IM j) l (s, om)</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">vvalid (IM j) l (lift_to_composite_state&#39; j s j, om)</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="Composition-v-chk40" style="display: none" type="checkbox"><label class="alectryon-input" for="Composition-v-chk40"><span class="nb">unfold</span> lift_to_composite_state&#39;.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>message, index</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>EqDecision0</var><span class="hyp-type"><b>: </b><span>EqDecision index</span></span></span><br><span><var>IM</var><span class="hyp-type"><b>: </b><span>index ‚Üí VLSM message</span></span></span><br><span><var>j</var><span class="hyp-type"><b>: </b><span>index</span></span></span><br><span><var>l</var><span class="hyp-type"><b>: </b><span>label</span></span></span><br><span><var>s</var><span class="hyp-type"><b>: </b><span>state</span></span></span><br><span><var>om</var><span class="hyp-type"><b>: </b><span>option message</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>vvalid (IM j) l (s, om)</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">vvalid (IM j) l
  (lift_to_composite_state (`composite_s0) j s j, om)</div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="Composition-v-chk41" style="display: none" type="checkbox"><label class="alectryon-input" for="Composition-v-chk41"><span class="nb">rewrite</span> state_update_eq.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>message, index</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>EqDecision0</var><span class="hyp-type"><b>: </b><span>EqDecision index</span></span></span><br><span><var>IM</var><span class="hyp-type"><b>: </b><span>index ‚Üí VLSM message</span></span></span><br><span><var>j</var><span class="hyp-type"><b>: </b><span>index</span></span></span><br><span><var>l</var><span class="hyp-type"><b>: </b><span>label</span></span></span><br><span><var>s</var><span class="hyp-type"><b>: </b><span>state</span></span></span><br><span><var>om</var><span class="hyp-type"><b>: </b><span>option message</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>vvalid (IM j) l (s, om)</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">vvalid (IM j) l (s, om)</div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="nb">apply</span> H.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="Composition-v-chk42" style="display: none" type="checkbox"><label class="alectryon-input" for="Composition-v-chk42">-</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>message, index</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>EqDecision0</var><span class="hyp-type"><b>: </b><span>EqDecision index</span></span></span><br><span><var>IM</var><span class="hyp-type"><b>: </b><span>index ‚Üí VLSM message</span></span></span><br><span><var>j</var><span class="hyp-type"><b>: </b><span>index</span></span></span><br><span><var>l</var><span class="hyp-type"><b>: </b><span>label</span></span></span><br><span><var>s</var><span class="hyp-type"><b>: </b><span>state</span></span></span><br><span><var>om</var><span class="hyp-type"><b>: </b><span>option message</span></span></span><br><span><var>s'</var><span class="hyp-type"><b>: </b><span>state</span></span></span><br><span><var>om'</var><span class="hyp-type"><b>: </b><span>option message</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>vtransition (IM j) l (s, om) = (s&#39;, om&#39;)</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">vtransition free_composite_vlsm
  (lift_to_composite_label j l)
  (lift_to_composite_state&#39; j s, om) =
(lift_to_composite_state&#39; j s&#39;, om&#39;)</div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="Composition-v-chk43" style="display: none" type="checkbox"><label class="alectryon-input" for="Composition-v-chk43"><span class="nb">unfold</span> vtransition.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>message, index</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>EqDecision0</var><span class="hyp-type"><b>: </b><span>EqDecision index</span></span></span><br><span><var>IM</var><span class="hyp-type"><b>: </b><span>index ‚Üí VLSM message</span></span></span><br><span><var>j</var><span class="hyp-type"><b>: </b><span>index</span></span></span><br><span><var>l</var><span class="hyp-type"><b>: </b><span>label</span></span></span><br><span><var>s</var><span class="hyp-type"><b>: </b><span>state</span></span></span><br><span><var>om</var><span class="hyp-type"><b>: </b><span>option message</span></span></span><br><span><var>s'</var><span class="hyp-type"><b>: </b><span>state</span></span></span><br><span><var>om'</var><span class="hyp-type"><b>: </b><span>option message</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>vtransition (IM j) l (s, om) = (s&#39;, om&#39;)</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">transition (lift_to_composite_label j l)
  (lift_to_composite_state&#39; j s, om) =
(lift_to_composite_state&#39; j s&#39;, om&#39;)</div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="Composition-v-chk44" style="display: none" type="checkbox"><label class="alectryon-input" for="Composition-v-chk44"><span class="nb">simpl</span>.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>message, index</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>EqDecision0</var><span class="hyp-type"><b>: </b><span>EqDecision index</span></span></span><br><span><var>IM</var><span class="hyp-type"><b>: </b><span>index ‚Üí VLSM message</span></span></span><br><span><var>j</var><span class="hyp-type"><b>: </b><span>index</span></span></span><br><span><var>l</var><span class="hyp-type"><b>: </b><span>label</span></span></span><br><span><var>s</var><span class="hyp-type"><b>: </b><span>state</span></span></span><br><span><var>om</var><span class="hyp-type"><b>: </b><span>option message</span></span></span><br><span><var>s'</var><span class="hyp-type"><b>: </b><span>state</span></span></span><br><span><var>om'</var><span class="hyp-type"><b>: </b><span>option message</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>vtransition (IM j) l (s, om) = (s&#39;, om&#39;)</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">(<span class="kr">let</span> (<span class="nv">si&#39;</span>, om&#39;) :=
   vtransition (IM j) l
     (lift_to_composite_state&#39; j s j, om) <span class="kr">in</span>
 (state_update (lift_to_composite_state&#39; j s) j si&#39;,
 om&#39;)) = (lift_to_composite_state&#39; j s&#39;, om&#39;)</div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="Composition-v-chk45" style="display: none" type="checkbox"><label class="alectryon-input" for="Composition-v-chk45"><span class="nb">unfold</span> lift_to_composite_state&#39; <span class="nb">at</span> <span class="mi">1</span>.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>message, index</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>EqDecision0</var><span class="hyp-type"><b>: </b><span>EqDecision index</span></span></span><br><span><var>IM</var><span class="hyp-type"><b>: </b><span>index ‚Üí VLSM message</span></span></span><br><span><var>j</var><span class="hyp-type"><b>: </b><span>index</span></span></span><br><span><var>l</var><span class="hyp-type"><b>: </b><span>label</span></span></span><br><span><var>s</var><span class="hyp-type"><b>: </b><span>state</span></span></span><br><span><var>om</var><span class="hyp-type"><b>: </b><span>option message</span></span></span><br><span><var>s'</var><span class="hyp-type"><b>: </b><span>state</span></span></span><br><span><var>om'</var><span class="hyp-type"><b>: </b><span>option message</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>vtransition (IM j) l (s, om) = (s&#39;, om&#39;)</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">(<span class="kr">let</span> (<span class="nv">si&#39;</span>, om&#39;) :=
   vtransition (IM j) l
     (lift_to_composite_state (`composite_s0) j s j,
     om) <span class="kr">in</span>
 (state_update (lift_to_composite_state&#39; j s) j si&#39;,
 om&#39;)) = (lift_to_composite_state&#39; j s&#39;, om&#39;)</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="Composition-v-chk46" style="display: none" type="checkbox"><label class="alectryon-input" for="Composition-v-chk46"><span class="nb">rewrite</span> state_update_eq.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>message, index</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>EqDecision0</var><span class="hyp-type"><b>: </b><span>EqDecision index</span></span></span><br><span><var>IM</var><span class="hyp-type"><b>: </b><span>index ‚Üí VLSM message</span></span></span><br><span><var>j</var><span class="hyp-type"><b>: </b><span>index</span></span></span><br><span><var>l</var><span class="hyp-type"><b>: </b><span>label</span></span></span><br><span><var>s</var><span class="hyp-type"><b>: </b><span>state</span></span></span><br><span><var>om</var><span class="hyp-type"><b>: </b><span>option message</span></span></span><br><span><var>s'</var><span class="hyp-type"><b>: </b><span>state</span></span></span><br><span><var>om'</var><span class="hyp-type"><b>: </b><span>option message</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>vtransition (IM j) l (s, om) = (s&#39;, om&#39;)</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">(<span class="kr">let</span> (<span class="nv">si&#39;</span>, om&#39;) := vtransition (IM j) l (s, om) <span class="kr">in</span>
 (state_update (lift_to_composite_state&#39; j s) j si&#39;,
 om&#39;)) = (lift_to_composite_state&#39; j s&#39;, om&#39;)</div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="Composition-v-chk47" style="display: none" type="checkbox"><label class="alectryon-input" for="Composition-v-chk47"><span class="nb">replace</span> (vtransition _ _ _) <span class="kr">with</span> (s&#39;, om&#39;).</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>message, index</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>EqDecision0</var><span class="hyp-type"><b>: </b><span>EqDecision index</span></span></span><br><span><var>IM</var><span class="hyp-type"><b>: </b><span>index ‚Üí VLSM message</span></span></span><br><span><var>j</var><span class="hyp-type"><b>: </b><span>index</span></span></span><br><span><var>l</var><span class="hyp-type"><b>: </b><span>label</span></span></span><br><span><var>s</var><span class="hyp-type"><b>: </b><span>state</span></span></span><br><span><var>om</var><span class="hyp-type"><b>: </b><span>option message</span></span></span><br><span><var>s'</var><span class="hyp-type"><b>: </b><span>state</span></span></span><br><span><var>om'</var><span class="hyp-type"><b>: </b><span>option message</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>vtransition (IM j) l (s, om) = (s&#39;, om&#39;)</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">(state_update (lift_to_composite_state&#39; j s) j s&#39;,
om&#39;) = (lift_to_composite_state&#39; j s&#39;, om&#39;)</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="Composition-v-chk48" style="display: none" type="checkbox"><label class="alectryon-input" for="Composition-v-chk48"><span class="nb">f_equal</span>.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>message, index</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>EqDecision0</var><span class="hyp-type"><b>: </b><span>EqDecision index</span></span></span><br><span><var>IM</var><span class="hyp-type"><b>: </b><span>index ‚Üí VLSM message</span></span></span><br><span><var>j</var><span class="hyp-type"><b>: </b><span>index</span></span></span><br><span><var>l</var><span class="hyp-type"><b>: </b><span>label</span></span></span><br><span><var>s</var><span class="hyp-type"><b>: </b><span>state</span></span></span><br><span><var>om</var><span class="hyp-type"><b>: </b><span>option message</span></span></span><br><span><var>s'</var><span class="hyp-type"><b>: </b><span>state</span></span></span><br><span><var>om'</var><span class="hyp-type"><b>: </b><span>option message</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>vtransition (IM j) l (s, om) = (s&#39;, om&#39;)</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">state_update (lift_to_composite_state&#39; j s) j s&#39; =
lift_to_composite_state&#39; j s&#39;</div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="Composition-v-chk49" style="display: none" type="checkbox"><label class="alectryon-input" for="Composition-v-chk49"><span class="nb">unfold</span> lift_to_composite_state&#39;.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>message, index</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>EqDecision0</var><span class="hyp-type"><b>: </b><span>EqDecision index</span></span></span><br><span><var>IM</var><span class="hyp-type"><b>: </b><span>index ‚Üí VLSM message</span></span></span><br><span><var>j</var><span class="hyp-type"><b>: </b><span>index</span></span></span><br><span><var>l</var><span class="hyp-type"><b>: </b><span>label</span></span></span><br><span><var>s</var><span class="hyp-type"><b>: </b><span>state</span></span></span><br><span><var>om</var><span class="hyp-type"><b>: </b><span>option message</span></span></span><br><span><var>s'</var><span class="hyp-type"><b>: </b><span>state</span></span></span><br><span><var>om'</var><span class="hyp-type"><b>: </b><span>option message</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>vtransition (IM j) l (s, om) = (s&#39;, om&#39;)</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">state_update
  (lift_to_composite_state (`composite_s0) j s) j s&#39; =
lift_to_composite_state (`composite_s0) j s&#39;</div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="nb">apply</span> state_update_twice.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="Composition-v-chk4a" style="display: none" type="checkbox"><label class="alectryon-input" for="Composition-v-chk4a">-</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>message, index</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>EqDecision0</var><span class="hyp-type"><b>: </b><span>EqDecision index</span></span></span><br><span><var>IM</var><span class="hyp-type"><b>: </b><span>index ‚Üí VLSM message</span></span></span><br><span><var>j</var><span class="hyp-type"><b>: </b><span>index</span></span></span><br><span><var>s</var><span class="hyp-type"><b>: </b><span>state</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>vinitial_state_prop (IM j) s</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">vinitial_state_prop free_composite_vlsm
  (lift_to_composite_state&#39; j s)</div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="bp">by</span> <span class="nb">apply</span> composite_initial_state_prop_lift.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="Composition-v-chk4b" style="display: none" type="checkbox"><label class="alectryon-input" for="Composition-v-chk4b">-</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>message, index</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>EqDecision0</var><span class="hyp-type"><b>: </b><span>EqDecision index</span></span></span><br><span><var>IM</var><span class="hyp-type"><b>: </b><span>index ‚Üí VLSM message</span></span></span><br><span><var>j</var><span class="hyp-type"><b>: </b><span>index</span></span></span><br><span><var>m</var><span class="hyp-type"><b>: </b><span>message</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>vinitial_message_prop (IM j) m</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">vinitial_message_prop free_composite_vlsm m</div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="bp">by</span> <span class="kr">exists</span> <span class="nv">j</span>, (exist _ _ H).</span><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Qed</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
</span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Definition</span> <span class="nf">lift_to_composite_finite_trace</span> <span class="nv">j</span>
  : list (vtransition_item (IM j)) -&gt; list composite_transition_item
  := VLSM_full_projection_finite_trace_project (lift_to_composite_vlsm_full_projection j).</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
</span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Definition</span> <span class="nf">lift_to_composite_finite_trace_last</span> <span class="nv">j</span>
  := VLSM_full_projection_finite_trace_last (lift_to_composite_vlsm_full_projection j).</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
</span><span class="alectryon-sentence"><input class="alectryon-toggle" id="Composition-v-chk4c" style="display: none" type="checkbox"><label class="alectryon-input" for="Composition-v-chk4c"><span class="kn">Lemma</span> <span class="nf">constraint_free_incl</span>
  (<span class="nv">constraint</span> : composite_label -&gt; composite_state  * option message -&gt; <span class="kt">Prop</span>)
  : VLSM_incl (composite_vlsm constraint) free_composite_vlsm.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>message, index</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>EqDecision0</var><span class="hyp-type"><b>: </b><span>EqDecision index</span></span></span><br><span><var>IM</var><span class="hyp-type"><b>: </b><span>index ‚Üí VLSM message</span></span></span><br><span><var>constraint</var><span class="hyp-type"><b>: </b><span>composite_label
‚Üí composite_state * option message ‚Üí <span class="kt">Prop</span></span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">VLSM_incl (composite_vlsm constraint)
  free_composite_vlsm</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="Composition-v-chk4d" style="display: none" type="checkbox"><label class="alectryon-input" for="Composition-v-chk4d"><span class="kn">Proof</span>.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>message, index</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>EqDecision0</var><span class="hyp-type"><b>: </b><span>EqDecision index</span></span></span><br><span><var>IM</var><span class="hyp-type"><b>: </b><span>index ‚Üí VLSM message</span></span></span><br><span><var>constraint</var><span class="hyp-type"><b>: </b><span>composite_label
‚Üí composite_state * option message ‚Üí <span class="kt">Prop</span></span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">VLSM_incl (composite_vlsm constraint)
  free_composite_vlsm</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><span class="alectryon-input"><span class="nb">apply</span> basic_VLSM_strong_incl; <span class="nb">firstorder</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Qed</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
</span><span class="alectryon-sentence"><input class="alectryon-toggle" id="Composition-v-chk4e" style="display: none" type="checkbox"><label class="alectryon-input" for="Composition-v-chk4e"><span class="kn">Lemma</span> <span class="nf">composite_pre_loaded_vlsm_incl_pre_loaded_with_all_messages</span>
  (<span class="nv">constraint</span> : composite_label -&gt; composite_state  * option message -&gt; <span class="kt">Prop</span>)
  (<span class="nv">P</span> : message -&gt; <span class="kt">Prop</span>)
  : VLSM_incl (pre_loaded_vlsm (composite_vlsm constraint) P) (pre_loaded_with_all_messages_vlsm free_composite_vlsm).</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>message, index</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>EqDecision0</var><span class="hyp-type"><b>: </b><span>EqDecision index</span></span></span><br><span><var>IM</var><span class="hyp-type"><b>: </b><span>index ‚Üí VLSM message</span></span></span><br><span><var>constraint</var><span class="hyp-type"><b>: </b><span>composite_label
‚Üí composite_state * option message ‚Üí <span class="kt">Prop</span></span></span></span><br><span><var>P</var><span class="hyp-type"><b>: </b><span>message ‚Üí <span class="kt">Prop</span></span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">VLSM_incl
  (pre_loaded_vlsm (composite_vlsm constraint) P)
  (pre_loaded_with_all_messages_vlsm
     free_composite_vlsm)</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="Composition-v-chk4f" style="display: none" type="checkbox"><label class="alectryon-input" for="Composition-v-chk4f"><span class="kn">Proof</span>.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>message, index</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>EqDecision0</var><span class="hyp-type"><b>: </b><span>EqDecision index</span></span></span><br><span><var>IM</var><span class="hyp-type"><b>: </b><span>index ‚Üí VLSM message</span></span></span><br><span><var>constraint</var><span class="hyp-type"><b>: </b><span>composite_label
‚Üí composite_state * option message ‚Üí <span class="kt">Prop</span></span></span></span><br><span><var>P</var><span class="hyp-type"><b>: </b><span>message ‚Üí <span class="kt">Prop</span></span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">VLSM_incl
  (pre_loaded_vlsm (composite_vlsm constraint) P)
  (pre_loaded_with_all_messages_vlsm
     free_composite_vlsm)</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><span class="alectryon-input"><span class="bp">by</span> <span class="nb">apply</span> basic_VLSM_strong_incl; <span class="nb">cbv</span>; [..|itauto|].</span><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Qed</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
</span><span class="alectryon-sentence"><input class="alectryon-toggle" id="Composition-v-chk50" style="display: none" type="checkbox"><label class="alectryon-input" for="Composition-v-chk50"><span class="kn">Lemma</span> <span class="nf">constraint_free_valid_state_message_preservation</span>
  (<span class="nv">constraint</span> : composite_label -&gt; composite_state * option message -&gt; <span class="kt">Prop</span>)
  <span class="nv">s</span> <span class="nv">om</span>
  (<span class="nv">Hsom</span> : valid_state_message_prop (composite_vlsm constraint) s om)
  : valid_state_message_prop free_composite_vlsm s om.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>message, index</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>EqDecision0</var><span class="hyp-type"><b>: </b><span>EqDecision index</span></span></span><br><span><var>IM</var><span class="hyp-type"><b>: </b><span>index ‚Üí VLSM message</span></span></span><br><span><var>constraint</var><span class="hyp-type"><b>: </b><span>composite_label
‚Üí composite_state * option message ‚Üí <span class="kt">Prop</span></span></span></span><br><span><var>s</var><span class="hyp-type"><b>: </b><span>state</span></span></span><br><span><var>om</var><span class="hyp-type"><b>: </b><span>option message</span></span></span><br><span><var>Hsom</var><span class="hyp-type"><b>: </b><span>valid_state_message_prop
  (composite_vlsm constraint) s om</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">valid_state_message_prop free_composite_vlsm s om</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="Composition-v-chk51" style="display: none" type="checkbox"><label class="alectryon-input" for="Composition-v-chk51"><span class="kn">Proof</span>.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>message, index</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>EqDecision0</var><span class="hyp-type"><b>: </b><span>EqDecision index</span></span></span><br><span><var>IM</var><span class="hyp-type"><b>: </b><span>index ‚Üí VLSM message</span></span></span><br><span><var>constraint</var><span class="hyp-type"><b>: </b><span>composite_label
‚Üí composite_state * option message ‚Üí <span class="kt">Prop</span></span></span></span><br><span><var>s</var><span class="hyp-type"><b>: </b><span>state</span></span></span><br><span><var>om</var><span class="hyp-type"><b>: </b><span>option message</span></span></span><br><span><var>Hsom</var><span class="hyp-type"><b>: </b><span>valid_state_message_prop
  (composite_vlsm constraint) s om</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">valid_state_message_prop free_composite_vlsm s om</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="Composition-v-chk52" style="display: none" type="checkbox"><label class="alectryon-input" for="Composition-v-chk52"><span class="nb">revert</span> Hsom.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>message, index</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>EqDecision0</var><span class="hyp-type"><b>: </b><span>EqDecision index</span></span></span><br><span><var>IM</var><span class="hyp-type"><b>: </b><span>index ‚Üí VLSM message</span></span></span><br><span><var>constraint</var><span class="hyp-type"><b>: </b><span>composite_label
‚Üí composite_state * option message ‚Üí <span class="kt">Prop</span></span></span></span><br><span><var>s</var><span class="hyp-type"><b>: </b><span>state</span></span></span><br><span><var>om</var><span class="hyp-type"><b>: </b><span>option message</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">valid_state_message_prop (composite_vlsm constraint) s
  om
‚Üí valid_state_message_prop free_composite_vlsm s om</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><span class="alectryon-input"><span class="bp">by</span> <span class="nb">apply</span> (VLSM_incl_valid_state_message (constraint_free_incl constraint)); <span class="nb">intro</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Qed</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
</span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Section</span> <span class="nf">sec_constraint_subsumption</span>.</span></span></pre><div class="doc">
<a id="lab5"></a><h2 class="section">Constraint subsumption</h2>
</div><pre class="alectryon-io highlight"><!-- Generator: Alectryon --></pre><div class="doc">
  A <code>constraint1</code> is subsumed by <code>constraint2</code> if <code>constraint1</code> is stronger
  than <code>constraint2</code> for any input.

</div><pre class="alectryon-io highlight"><!-- Generator: Alectryon --><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Definition</span> <span class="nf">strong_constraint_subsumption</span>
    (<span class="nv">constraint1</span> <span class="nv">constraint2</span> : composite_label -&gt; composite_state * option message -&gt; <span class="kt">Prop</span>)
    :=
    <span class="kr">forall</span> (<span class="nv">l</span> : composite_label) (<span class="nv">som</span> : composite_state * option message),
      constraint1 l som -&gt; constraint2 l som.</span></span></pre><div class="doc">
  A weaker version of <span class="inlinecode"><span class="id" title="var">strong_constraint_subsumption</span></span> requiring <span class="inlinecode"><span class="id" title="var">input_valid</span></span>ity
  w.r.t. <span class="inlinecode"><span class="id" title="var">pre_loaded_with_all_messages_vlsm</span></span> as a precondition for the subsumption
  property.

<div class="paragraph"> </div>

  This definition is useful in proving <span class="inlinecode"><span class="id" title="var">VLSM_incl</span></span>usions between <span class="inlinecode"><span class="id" title="var">VLSM</span></span>s
  pre-loaded with all messages (Lemma <span class="inlinecode"><span class="id" title="var">preloaded_constraint_subsumption_incl</span></span>).

<div class="paragraph"> </div>

  Although there are currently no explicit cases for its usage, it might be more
  useful than the <span class="inlinecode"><span class="id" title="var">strong_constraint_subsumption</span></span> property in cases where proving
  constraint subsumption relies on the state being valid and/or the message
  being valid.

</div><pre class="alectryon-io highlight"><!-- Generator: Alectryon --><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Definition</span> <span class="nf">preloaded_constraint_subsumption</span>
    (<span class="nv">constraint1</span> <span class="nv">constraint2</span> : composite_label -&gt; composite_state * option message -&gt; <span class="kt">Prop</span>)
    :=
    <span class="kr">forall</span> (<span class="nv">l</span> : composite_label) (<span class="nv">som</span> : state * option message),
        input_valid (pre_loaded_with_all_messages_vlsm (composite_vlsm constraint1)) l som -&gt;
        constraint2 l som.</span></span></pre><div class="doc">
  A weaker version of <span class="inlinecode"><span class="id" title="var">preloaded_constraint_subsumption</span></span> requiring <span class="inlinecode"><span class="id" title="var">input_valid</span></span>ity
  as a precondition for the subsumption property.

<div class="paragraph"> </div>

  This definition is usually useful in proving <span class="inlinecode"><span class="id" title="var">VLSM_incl</span></span>usions between regular
  <span class="inlinecode"><span class="id" title="var">VLSM</span></span>s (Lemma <span class="inlinecode"><span class="id" title="var">constraint_subsumption_incl</span></span>).

<div class="paragraph"> </div>

  It is more useful than the <span class="inlinecode"><span class="id" title="var">strong_constraint_subsumption</span></span> property in cases
  where proving constraint subsumption relies on the state/message being valid
  and/or the message being valid (e.g., Lemma <span class="inlinecode"><span class="id" title="var">Fixed_incl_StrongFixed</span></span>).

</div><pre class="alectryon-io highlight"><!-- Generator: Alectryon --><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Definition</span> <span class="nf">input_valid_constraint_subsumption</span>
    (<span class="nv">constraint1</span> <span class="nv">constraint2</span> : composite_label -&gt; composite_state * option message -&gt; <span class="kt">Prop</span>)
    :=
    <span class="kr">forall</span> (<span class="nv">l</span> : composite_label) (<span class="nv">som</span> : composite_state * option message),
      input_valid (composite_vlsm constraint1) l som -&gt; constraint2 l som.</span></span></pre><div class="doc">
  The weakest form <span class="inlinecode"><span class="id" title="var">constraint_subsumption</span></span> also requires that the input
  state and message are valid for the composition under the second constraint.

</div><pre class="alectryon-io highlight"><!-- Generator: Alectryon --><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Definition</span> <span class="nf">weak_input_valid_constraint_subsumption</span>
    (<span class="nv">constraint1</span> <span class="nv">constraint2</span> : composite_label -&gt; composite_state * option message -&gt; <span class="kt">Prop</span>)
    :=
    <span class="kr">forall</span> (<span class="nv">l</span> : composite_label) (<span class="nv">som</span> : composite_state * option message),
      input_valid (composite_vlsm constraint1) l som -&gt;
      valid_state_prop (composite_vlsm constraint2) som.<span class="mi">1</span> -&gt;
      option_valid_message_prop (composite_vlsm constraint2) som.<span class="mi">2</span> -&gt;
      constraint2 l som.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
</span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Context</span>
  (<span class="nv">constraint1</span> <span class="nv">constraint2</span> : composite_label -&gt; composite_state * option message -&gt; <span class="kt">Prop</span>)
  (<span class="nv">X1</span> := composite_vlsm constraint1)
  (<span class="nv">X2</span> := composite_vlsm constraint2)
  .</span></span></pre><div class="doc">
  Let <code>X1</code>, <code>X2</code> be two compositions of the same family of VLSMs but with
  constraints <code>constraint1</code> and <code>constraint2</code>, respectively. Further assume
  that <code>constraint1</code> is subsumed by <code>constraint2</code>.

<div class="paragraph"> </div>

  We will show that <code>X1</code> is trace-included into <code>X2</code> by applying
  Lemma <span class="inlinecode"><span class="id" title="var">basic_VLSM_incl</span></span>
</div><pre class="alectryon-io highlight"><!-- Generator: Alectryon --><span class="alectryon-wsp"><span class="c">(* begin hide *)</span>
</span><span class="alectryon-sentence"><input class="alectryon-toggle" id="Composition-v-chk53" style="display: none" type="checkbox"><label class="alectryon-input" for="Composition-v-chk53"><span class="kn">Lemma</span> <span class="nf">weak_constraint_subsumption_incl</span>
  (<span class="nv">Hsubsumption</span> : weak_input_valid_constraint_subsumption constraint1 constraint2)
  : VLSM_incl X1 X2.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>message, index</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>EqDecision0</var><span class="hyp-type"><b>: </b><span>EqDecision index</span></span></span><br><span><var>IM</var><span class="hyp-type"><b>: </b><span>index ‚Üí VLSM message</span></span></span><br><span><var>constraint1, constraint2</var><span class="hyp-type"><b>: </b><span>composite_label
‚Üí composite_state * option message
  ‚Üí <span class="kt">Prop</span></span></span></span><br><span><var>X1</var><span><span class="hyp-body"><b>:= </b><span>composite_vlsm constraint1</span></span><span class="hyp-type"><b>: </b><span>VLSM message</span></span></span></span><br><span><var>X2</var><span><span class="hyp-body"><b>:= </b><span>composite_vlsm constraint2</span></span><span class="hyp-type"><b>: </b><span>VLSM message</span></span></span></span><br><span><var>Hsubsumption</var><span class="hyp-type"><b>: </b><span>weak_input_valid_constraint_subsumption
  constraint1 constraint2</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">VLSM_incl X1 X2</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="Composition-v-chk54" style="display: none" type="checkbox"><label class="alectryon-input" for="Composition-v-chk54"><span class="kn">Proof</span>.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>message, index</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>EqDecision0</var><span class="hyp-type"><b>: </b><span>EqDecision index</span></span></span><br><span><var>IM</var><span class="hyp-type"><b>: </b><span>index ‚Üí VLSM message</span></span></span><br><span><var>constraint1, constraint2</var><span class="hyp-type"><b>: </b><span>composite_label
‚Üí composite_state * option message
  ‚Üí <span class="kt">Prop</span></span></span></span><br><span><var>X1</var><span><span class="hyp-body"><b>:= </b><span>composite_vlsm constraint1</span></span><span class="hyp-type"><b>: </b><span>VLSM message</span></span></span></span><br><span><var>X2</var><span><span class="hyp-body"><b>:= </b><span>composite_vlsm constraint2</span></span><span class="hyp-type"><b>: </b><span>VLSM message</span></span></span></span><br><span><var>Hsubsumption</var><span class="hyp-type"><b>: </b><span>weak_input_valid_constraint_subsumption
  constraint1 constraint2</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">VLSM_incl X1 X2</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="Composition-v-chk55" style="display: none" type="checkbox"><label class="alectryon-input" for="Composition-v-chk55"><span class="nb">apply</span> basic_VLSM_incl.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>message, index</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>EqDecision0</var><span class="hyp-type"><b>: </b><span>EqDecision index</span></span></span><br><span><var>IM</var><span class="hyp-type"><b>: </b><span>index ‚Üí VLSM message</span></span></span><br><span><var>constraint1, constraint2</var><span class="hyp-type"><b>: </b><span>composite_label
‚Üí composite_state * option message
  ‚Üí <span class="kt">Prop</span></span></span></span><br><span><var>X1</var><span><span class="hyp-body"><b>:= </b><span>composite_vlsm constraint1</span></span><span class="hyp-type"><b>: </b><span>VLSM message</span></span></span></span><br><span><var>X2</var><span><span class="hyp-body"><b>:= </b><span>composite_vlsm constraint2</span></span><span class="hyp-type"><b>: </b><span>VLSM message</span></span></span></span><br><span><var>Hsubsumption</var><span class="hyp-type"><b>: </b><span>weak_input_valid_constraint_subsumption
  constraint1 constraint2</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">strong_incl_initial_state_preservation
  (composite_vlsm_machine constraint1)
  (composite_vlsm_machine constraint2)</div></blockquote><div class="alectryon-extra-goals"><input class="alectryon-extra-goal-toggle" id="Composition-v-chk56" style="display: none" type="checkbox"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>message, index</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>EqDecision0</var><span class="hyp-type"><b>: </b><span>EqDecision index</span></span></span><br><span><var>IM</var><span class="hyp-type"><b>: </b><span>index ‚Üí VLSM message</span></span></span><br><span><var>constraint1, constraint2</var><span class="hyp-type"><b>: </b><span>composite_label
‚Üí composite_state * option message
  ‚Üí <span class="kt">Prop</span></span></span></span><br><span><var>X1</var><span><span class="hyp-body"><b>:= </b><span>composite_vlsm constraint1</span></span><span class="hyp-type"><b>: </b><span>VLSM message</span></span></span></span><br><span><var>X2</var><span><span class="hyp-body"><b>:= </b><span>composite_vlsm constraint2</span></span><span class="hyp-type"><b>: </b><span>VLSM message</span></span></span></span><br><span><var>Hsubsumption</var><span class="hyp-type"><b>: </b><span>weak_input_valid_constraint_subsumption
  constraint1 constraint2</span></span></span><br></div><label class="goal-separator" for="Composition-v-chk56"><hr></label><div class="goal-conclusion">weak_incl_initial_message_preservation
  (composite_vlsm_machine constraint1)
  (composite_vlsm_machine constraint2)</div></blockquote><input class="alectryon-extra-goal-toggle" id="Composition-v-chk57" style="display: none" type="checkbox"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>message, index</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>EqDecision0</var><span class="hyp-type"><b>: </b><span>EqDecision index</span></span></span><br><span><var>IM</var><span class="hyp-type"><b>: </b><span>index ‚Üí VLSM message</span></span></span><br><span><var>constraint1, constraint2</var><span class="hyp-type"><b>: </b><span>composite_label
‚Üí composite_state * option message
  ‚Üí <span class="kt">Prop</span></span></span></span><br><span><var>X1</var><span><span class="hyp-body"><b>:= </b><span>composite_vlsm constraint1</span></span><span class="hyp-type"><b>: </b><span>VLSM message</span></span></span></span><br><span><var>X2</var><span><span class="hyp-body"><b>:= </b><span>composite_vlsm constraint2</span></span><span class="hyp-type"><b>: </b><span>VLSM message</span></span></span></span><br><span><var>Hsubsumption</var><span class="hyp-type"><b>: </b><span>weak_input_valid_constraint_subsumption
  constraint1 constraint2</span></span></span><br></div><label class="goal-separator" for="Composition-v-chk57"><hr></label><div class="goal-conclusion">weak_incl_valid_preservation
  (composite_vlsm_machine constraint1)
  (composite_vlsm_machine constraint2)</div></blockquote><input class="alectryon-extra-goal-toggle" id="Composition-v-chk58" style="display: none" type="checkbox"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>message, index</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>EqDecision0</var><span class="hyp-type"><b>: </b><span>EqDecision index</span></span></span><br><span><var>IM</var><span class="hyp-type"><b>: </b><span>index ‚Üí VLSM message</span></span></span><br><span><var>constraint1, constraint2</var><span class="hyp-type"><b>: </b><span>composite_label
‚Üí composite_state * option message
  ‚Üí <span class="kt">Prop</span></span></span></span><br><span><var>X1</var><span><span class="hyp-body"><b>:= </b><span>composite_vlsm constraint1</span></span><span class="hyp-type"><b>: </b><span>VLSM message</span></span></span></span><br><span><var>X2</var><span><span class="hyp-body"><b>:= </b><span>composite_vlsm constraint2</span></span><span class="hyp-type"><b>: </b><span>VLSM message</span></span></span></span><br><span><var>Hsubsumption</var><span class="hyp-type"><b>: </b><span>weak_input_valid_constraint_subsumption
  constraint1 constraint2</span></span></span><br></div><label class="goal-separator" for="Composition-v-chk58"><hr></label><div class="goal-conclusion">weak_incl_transition_preservation
  (composite_vlsm_machine constraint1)
  (composite_vlsm_machine constraint2)</div></blockquote></div></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="Composition-v-chk59" style="display: none" type="checkbox"><label class="alectryon-input" for="Composition-v-chk59">-</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>message, index</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>EqDecision0</var><span class="hyp-type"><b>: </b><span>EqDecision index</span></span></span><br><span><var>IM</var><span class="hyp-type"><b>: </b><span>index ‚Üí VLSM message</span></span></span><br><span><var>constraint1, constraint2</var><span class="hyp-type"><b>: </b><span>composite_label
‚Üí composite_state * option message
  ‚Üí <span class="kt">Prop</span></span></span></span><br><span><var>X1</var><span><span class="hyp-body"><b>:= </b><span>composite_vlsm constraint1</span></span><span class="hyp-type"><b>: </b><span>VLSM message</span></span></span></span><br><span><var>X2</var><span><span class="hyp-body"><b>:= </b><span>composite_vlsm constraint2</span></span><span class="hyp-type"><b>: </b><span>VLSM message</span></span></span></span><br><span><var>Hsubsumption</var><span class="hyp-type"><b>: </b><span>weak_input_valid_constraint_subsumption
  constraint1 constraint2</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">strong_incl_initial_state_preservation
  (composite_vlsm_machine constraint1)
  (composite_vlsm_machine constraint2)</div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="bp">by</span> <span class="nb">intros</span> s Hs.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="Composition-v-chk5a" style="display: none" type="checkbox"><label class="alectryon-input" for="Composition-v-chk5a">-</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>message, index</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>EqDecision0</var><span class="hyp-type"><b>: </b><span>EqDecision index</span></span></span><br><span><var>IM</var><span class="hyp-type"><b>: </b><span>index ‚Üí VLSM message</span></span></span><br><span><var>constraint1, constraint2</var><span class="hyp-type"><b>: </b><span>composite_label
‚Üí composite_state * option message
  ‚Üí <span class="kt">Prop</span></span></span></span><br><span><var>X1</var><span><span class="hyp-body"><b>:= </b><span>composite_vlsm constraint1</span></span><span class="hyp-type"><b>: </b><span>VLSM message</span></span></span></span><br><span><var>X2</var><span><span class="hyp-body"><b>:= </b><span>composite_vlsm constraint2</span></span><span class="hyp-type"><b>: </b><span>VLSM message</span></span></span></span><br><span><var>Hsubsumption</var><span class="hyp-type"><b>: </b><span>weak_input_valid_constraint_subsumption
  constraint1 constraint2</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">weak_incl_initial_message_preservation
  (composite_vlsm_machine constraint1)
  (composite_vlsm_machine constraint2)</div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="bp">by</span> <span class="nb">intros</span> _ _ m _ _ Hm; <span class="nb">apply</span> initial_message_is_valid.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="Composition-v-chk5b" style="display: none" type="checkbox"><label class="alectryon-input" for="Composition-v-chk5b">-</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>message, index</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>EqDecision0</var><span class="hyp-type"><b>: </b><span>EqDecision index</span></span></span><br><span><var>IM</var><span class="hyp-type"><b>: </b><span>index ‚Üí VLSM message</span></span></span><br><span><var>constraint1, constraint2</var><span class="hyp-type"><b>: </b><span>composite_label
‚Üí composite_state * option message
  ‚Üí <span class="kt">Prop</span></span></span></span><br><span><var>X1</var><span><span class="hyp-body"><b>:= </b><span>composite_vlsm constraint1</span></span><span class="hyp-type"><b>: </b><span>VLSM message</span></span></span></span><br><span><var>X2</var><span><span class="hyp-body"><b>:= </b><span>composite_vlsm constraint2</span></span><span class="hyp-type"><b>: </b><span>VLSM message</span></span></span></span><br><span><var>Hsubsumption</var><span class="hyp-type"><b>: </b><span>weak_input_valid_constraint_subsumption
  constraint1 constraint2</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">weak_incl_valid_preservation
  (composite_vlsm_machine constraint1)
  (composite_vlsm_machine constraint2)</div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="nb">split</span>; [<span class="nb">apply</span> Hv | <span class="nb">auto</span>].</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="Composition-v-chk5c" style="display: none" type="checkbox"><label class="alectryon-input" for="Composition-v-chk5c">-</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>message, index</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>EqDecision0</var><span class="hyp-type"><b>: </b><span>EqDecision index</span></span></span><br><span><var>IM</var><span class="hyp-type"><b>: </b><span>index ‚Üí VLSM message</span></span></span><br><span><var>constraint1, constraint2</var><span class="hyp-type"><b>: </b><span>composite_label
‚Üí composite_state * option message
  ‚Üí <span class="kt">Prop</span></span></span></span><br><span><var>X1</var><span><span class="hyp-body"><b>:= </b><span>composite_vlsm constraint1</span></span><span class="hyp-type"><b>: </b><span>VLSM message</span></span></span></span><br><span><var>X2</var><span><span class="hyp-body"><b>:= </b><span>composite_vlsm constraint2</span></span><span class="hyp-type"><b>: </b><span>VLSM message</span></span></span></span><br><span><var>Hsubsumption</var><span class="hyp-type"><b>: </b><span>weak_input_valid_constraint_subsumption
  constraint1 constraint2</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">weak_incl_transition_preservation
  (composite_vlsm_machine constraint1)
  (composite_vlsm_machine constraint2)</div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="bp">by</span> <span class="nb">intros</span> l s om s&#39; om&#39; Ht; <span class="nb">apply</span> Ht.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Qed</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
</span><span class="alectryon-sentence"><input class="alectryon-toggle" id="Composition-v-chk5d" style="display: none" type="checkbox"><label class="alectryon-input" for="Composition-v-chk5d"><span class="kn">Lemma</span> <span class="nf">constraint_subsumption_input_valid</span>
  (<span class="nv">Hsubsumption</span> : input_valid_constraint_subsumption constraint1 constraint2)
  (<span class="nv">l</span> : label)
  (<span class="nv">s</span> : state)
  (<span class="nv">om</span> : option message)
  (<span class="nv">Hv</span> : input_valid X1 l (s, om))
  : vvalid X2 l (s, om).</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>message, index</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>EqDecision0</var><span class="hyp-type"><b>: </b><span>EqDecision index</span></span></span><br><span><var>IM</var><span class="hyp-type"><b>: </b><span>index ‚Üí VLSM message</span></span></span><br><span><var>constraint1, constraint2</var><span class="hyp-type"><b>: </b><span>composite_label
‚Üí composite_state * option message
  ‚Üí <span class="kt">Prop</span></span></span></span><br><span><var>X1</var><span><span class="hyp-body"><b>:= </b><span>composite_vlsm constraint1</span></span><span class="hyp-type"><b>: </b><span>VLSM message</span></span></span></span><br><span><var>X2</var><span><span class="hyp-body"><b>:= </b><span>composite_vlsm constraint2</span></span><span class="hyp-type"><b>: </b><span>VLSM message</span></span></span></span><br><span><var>Hsubsumption</var><span class="hyp-type"><b>: </b><span>input_valid_constraint_subsumption
  constraint1 constraint2</span></span></span><br><span><var>l</var><span class="hyp-type"><b>: </b><span>label</span></span></span><br><span><var>s</var><span class="hyp-type"><b>: </b><span>state</span></span></span><br><span><var>om</var><span class="hyp-type"><b>: </b><span>option message</span></span></span><br><span><var>Hv</var><span class="hyp-type"><b>: </b><span>input_valid X1 l (s, om)</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">vvalid X2 l (s, om)</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="Composition-v-chk5e" style="display: none" type="checkbox"><label class="alectryon-input" for="Composition-v-chk5e"><span class="kn">Proof</span>.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>message, index</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>EqDecision0</var><span class="hyp-type"><b>: </b><span>EqDecision index</span></span></span><br><span><var>IM</var><span class="hyp-type"><b>: </b><span>index ‚Üí VLSM message</span></span></span><br><span><var>constraint1, constraint2</var><span class="hyp-type"><b>: </b><span>composite_label
‚Üí composite_state * option message
  ‚Üí <span class="kt">Prop</span></span></span></span><br><span><var>X1</var><span><span class="hyp-body"><b>:= </b><span>composite_vlsm constraint1</span></span><span class="hyp-type"><b>: </b><span>VLSM message</span></span></span></span><br><span><var>X2</var><span><span class="hyp-body"><b>:= </b><span>composite_vlsm constraint2</span></span><span class="hyp-type"><b>: </b><span>VLSM message</span></span></span></span><br><span><var>Hsubsumption</var><span class="hyp-type"><b>: </b><span>input_valid_constraint_subsumption
  constraint1 constraint2</span></span></span><br><span><var>l</var><span class="hyp-type"><b>: </b><span>label</span></span></span><br><span><var>s</var><span class="hyp-type"><b>: </b><span>state</span></span></span><br><span><var>om</var><span class="hyp-type"><b>: </b><span>option message</span></span></span><br><span><var>Hv</var><span class="hyp-type"><b>: </b><span>input_valid X1 l (s, om)</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">vvalid X2 l (s, om)</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><span class="alectryon-input"><span class="bp">by</span> <span class="nb">split</span>; [<span class="nb">apply</span> Hv | <span class="nb">apply</span> Hsubsumption].</span><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Qed</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
</span><span class="alectryon-sentence"><input class="alectryon-toggle" id="Composition-v-chk5f" style="display: none" type="checkbox"><label class="alectryon-input" for="Composition-v-chk5f"><span class="kn">Lemma</span> <span class="nf">constraint_subsumption_valid_state_message_preservation</span>
  (<span class="nv">Hsubsumption</span> : input_valid_constraint_subsumption constraint1 constraint2)
  (<span class="nv">s</span> : state)
  (<span class="nv">om</span> : option message)
  (<span class="nv">Hps</span> : valid_state_message_prop X1 s om)
  : valid_state_message_prop X2 s om.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>message, index</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>EqDecision0</var><span class="hyp-type"><b>: </b><span>EqDecision index</span></span></span><br><span><var>IM</var><span class="hyp-type"><b>: </b><span>index ‚Üí VLSM message</span></span></span><br><span><var>constraint1, constraint2</var><span class="hyp-type"><b>: </b><span>composite_label
‚Üí composite_state * option message
  ‚Üí <span class="kt">Prop</span></span></span></span><br><span><var>X1</var><span><span class="hyp-body"><b>:= </b><span>composite_vlsm constraint1</span></span><span class="hyp-type"><b>: </b><span>VLSM message</span></span></span></span><br><span><var>X2</var><span><span class="hyp-body"><b>:= </b><span>composite_vlsm constraint2</span></span><span class="hyp-type"><b>: </b><span>VLSM message</span></span></span></span><br><span><var>Hsubsumption</var><span class="hyp-type"><b>: </b><span>input_valid_constraint_subsumption
  constraint1 constraint2</span></span></span><br><span><var>s</var><span class="hyp-type"><b>: </b><span>state</span></span></span><br><span><var>om</var><span class="hyp-type"><b>: </b><span>option message</span></span></span><br><span><var>Hps</var><span class="hyp-type"><b>: </b><span>valid_state_message_prop X1 s om</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">valid_state_message_prop X2 s om</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="Composition-v-chk60" style="display: none" type="checkbox"><label class="alectryon-input" for="Composition-v-chk60"><span class="kn">Proof</span>.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>message, index</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>EqDecision0</var><span class="hyp-type"><b>: </b><span>EqDecision index</span></span></span><br><span><var>IM</var><span class="hyp-type"><b>: </b><span>index ‚Üí VLSM message</span></span></span><br><span><var>constraint1, constraint2</var><span class="hyp-type"><b>: </b><span>composite_label
‚Üí composite_state * option message
  ‚Üí <span class="kt">Prop</span></span></span></span><br><span><var>X1</var><span><span class="hyp-body"><b>:= </b><span>composite_vlsm constraint1</span></span><span class="hyp-type"><b>: </b><span>VLSM message</span></span></span></span><br><span><var>X2</var><span><span class="hyp-body"><b>:= </b><span>composite_vlsm constraint2</span></span><span class="hyp-type"><b>: </b><span>VLSM message</span></span></span></span><br><span><var>Hsubsumption</var><span class="hyp-type"><b>: </b><span>input_valid_constraint_subsumption
  constraint1 constraint2</span></span></span><br><span><var>s</var><span class="hyp-type"><b>: </b><span>state</span></span></span><br><span><var>om</var><span class="hyp-type"><b>: </b><span>option message</span></span></span><br><span><var>Hps</var><span class="hyp-type"><b>: </b><span>valid_state_message_prop X1 s om</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">valid_state_message_prop X2 s om</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="Composition-v-chk61" style="display: none" type="checkbox"><label class="alectryon-input" for="Composition-v-chk61"><span class="nb">induction</span> Hps.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>message, index</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>EqDecision0</var><span class="hyp-type"><b>: </b><span>EqDecision index</span></span></span><br><span><var>IM</var><span class="hyp-type"><b>: </b><span>index ‚Üí VLSM message</span></span></span><br><span><var>constraint1, constraint2</var><span class="hyp-type"><b>: </b><span>composite_label
‚Üí composite_state * option message
  ‚Üí <span class="kt">Prop</span></span></span></span><br><span><var>X1</var><span><span class="hyp-body"><b>:= </b><span>composite_vlsm constraint1</span></span><span class="hyp-type"><b>: </b><span>VLSM message</span></span></span></span><br><span><var>X2</var><span><span class="hyp-body"><b>:= </b><span>composite_vlsm constraint2</span></span><span class="hyp-type"><b>: </b><span>VLSM message</span></span></span></span><br><span><var>Hsubsumption</var><span class="hyp-type"><b>: </b><span>input_valid_constraint_subsumption
  constraint1 constraint2</span></span></span><br><span><var>s</var><span class="hyp-type"><b>: </b><span>state</span></span></span><br><span><var>Hs</var><span class="hyp-type"><b>: </b><span>initial_state_prop s</span></span></span><br><span><var>om</var><span class="hyp-type"><b>: </b><span>option message</span></span></span><br><span><var>Hom</var><span class="hyp-type"><b>: </b><span>option_initial_message_prop om</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">valid_state_message_prop X2 s om</div></blockquote><div class="alectryon-extra-goals"><input class="alectryon-extra-goal-toggle" id="Composition-v-chk62" style="display: none" type="checkbox"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>message, index</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>EqDecision0</var><span class="hyp-type"><b>: </b><span>EqDecision index</span></span></span><br><span><var>IM</var><span class="hyp-type"><b>: </b><span>index ‚Üí VLSM message</span></span></span><br><span><var>constraint1, constraint2</var><span class="hyp-type"><b>: </b><span>composite_label
‚Üí composite_state * option message
  ‚Üí <span class="kt">Prop</span></span></span></span><br><span><var>X1</var><span><span class="hyp-body"><b>:= </b><span>composite_vlsm constraint1</span></span><span class="hyp-type"><b>: </b><span>VLSM message</span></span></span></span><br><span><var>X2</var><span><span class="hyp-body"><b>:= </b><span>composite_vlsm constraint2</span></span><span class="hyp-type"><b>: </b><span>VLSM message</span></span></span></span><br><span><var>Hsubsumption</var><span class="hyp-type"><b>: </b><span>input_valid_constraint_subsumption
  constraint1 constraint2</span></span></span><br><span><var>s</var><span class="hyp-type"><b>: </b><span>state</span></span></span><br><span><var>_om</var><span class="hyp-type"><b>: </b><span>option message</span></span></span><br><span><var>Hps1</var><span class="hyp-type"><b>: </b><span>valid_state_message_prop X1 s _om</span></span></span><br><span><var>_s</var><span class="hyp-type"><b>: </b><span>state</span></span></span><br><span><var>om</var><span class="hyp-type"><b>: </b><span>option message</span></span></span><br><span><var>Hps2</var><span class="hyp-type"><b>: </b><span>valid_state_message_prop X1 _s om</span></span></span><br><span><var>l</var><span class="hyp-type"><b>: </b><span>label</span></span></span><br><span><var>Hv</var><span class="hyp-type"><b>: </b><span>valid l (s, om)</span></span></span><br><span><var>s'</var><span class="hyp-type"><b>: </b><span>state</span></span></span><br><span><var>om'</var><span class="hyp-type"><b>: </b><span>option message</span></span></span><br><span><var>Ht</var><span class="hyp-type"><b>: </b><span>transition l (s, om) = (s&#39;, om&#39;)</span></span></span><br><span><var>IHHps1</var><span class="hyp-type"><b>: </b><span>valid_state_message_prop X2 s _om</span></span></span><br><span><var>IHHps2</var><span class="hyp-type"><b>: </b><span>valid_state_message_prop X2 _s om</span></span></span><br></div><label class="goal-separator" for="Composition-v-chk62"><hr></label><div class="goal-conclusion">valid_state_message_prop X2 s&#39; om&#39;</div></blockquote></div></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="Composition-v-chk63" style="display: none" type="checkbox"><label class="alectryon-input" for="Composition-v-chk63">-</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>message, index</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>EqDecision0</var><span class="hyp-type"><b>: </b><span>EqDecision index</span></span></span><br><span><var>IM</var><span class="hyp-type"><b>: </b><span>index ‚Üí VLSM message</span></span></span><br><span><var>constraint1, constraint2</var><span class="hyp-type"><b>: </b><span>composite_label
‚Üí composite_state * option message
  ‚Üí <span class="kt">Prop</span></span></span></span><br><span><var>X1</var><span><span class="hyp-body"><b>:= </b><span>composite_vlsm constraint1</span></span><span class="hyp-type"><b>: </b><span>VLSM message</span></span></span></span><br><span><var>X2</var><span><span class="hyp-body"><b>:= </b><span>composite_vlsm constraint2</span></span><span class="hyp-type"><b>: </b><span>VLSM message</span></span></span></span><br><span><var>Hsubsumption</var><span class="hyp-type"><b>: </b><span>input_valid_constraint_subsumption
  constraint1 constraint2</span></span></span><br><span><var>s</var><span class="hyp-type"><b>: </b><span>state</span></span></span><br><span><var>Hs</var><span class="hyp-type"><b>: </b><span>initial_state_prop s</span></span></span><br><span><var>om</var><span class="hyp-type"><b>: </b><span>option message</span></span></span><br><span><var>Hom</var><span class="hyp-type"><b>: </b><span>option_initial_message_prop om</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">valid_state_message_prop X2 s om</div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="bp">by</span> <span class="nb">apply</span> valid_initial_state_message.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="Composition-v-chk64" style="display: none" type="checkbox"><label class="alectryon-input" for="Composition-v-chk64">-</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>message, index</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>EqDecision0</var><span class="hyp-type"><b>: </b><span>EqDecision index</span></span></span><br><span><var>IM</var><span class="hyp-type"><b>: </b><span>index ‚Üí VLSM message</span></span></span><br><span><var>constraint1, constraint2</var><span class="hyp-type"><b>: </b><span>composite_label
‚Üí composite_state * option message
  ‚Üí <span class="kt">Prop</span></span></span></span><br><span><var>X1</var><span><span class="hyp-body"><b>:= </b><span>composite_vlsm constraint1</span></span><span class="hyp-type"><b>: </b><span>VLSM message</span></span></span></span><br><span><var>X2</var><span><span class="hyp-body"><b>:= </b><span>composite_vlsm constraint2</span></span><span class="hyp-type"><b>: </b><span>VLSM message</span></span></span></span><br><span><var>Hsubsumption</var><span class="hyp-type"><b>: </b><span>input_valid_constraint_subsumption
  constraint1 constraint2</span></span></span><br><span><var>s</var><span class="hyp-type"><b>: </b><span>state</span></span></span><br><span><var>_om</var><span class="hyp-type"><b>: </b><span>option message</span></span></span><br><span><var>Hps1</var><span class="hyp-type"><b>: </b><span>valid_state_message_prop X1 s _om</span></span></span><br><span><var>_s</var><span class="hyp-type"><b>: </b><span>state</span></span></span><br><span><var>om</var><span class="hyp-type"><b>: </b><span>option message</span></span></span><br><span><var>Hps2</var><span class="hyp-type"><b>: </b><span>valid_state_message_prop X1 _s om</span></span></span><br><span><var>l</var><span class="hyp-type"><b>: </b><span>label</span></span></span><br><span><var>Hv</var><span class="hyp-type"><b>: </b><span>valid l (s, om)</span></span></span><br><span><var>s'</var><span class="hyp-type"><b>: </b><span>state</span></span></span><br><span><var>om'</var><span class="hyp-type"><b>: </b><span>option message</span></span></span><br><span><var>Ht</var><span class="hyp-type"><b>: </b><span>transition l (s, om) = (s&#39;, om&#39;)</span></span></span><br><span><var>IHHps1</var><span class="hyp-type"><b>: </b><span>valid_state_message_prop X2 s _om</span></span></span><br><span><var>IHHps2</var><span class="hyp-type"><b>: </b><span>valid_state_message_prop X2 _s om</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">valid_state_message_prop X2 s&#39; om&#39;</div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="Composition-v-chk65" style="display: none" type="checkbox"><label class="alectryon-input" for="Composition-v-chk65"><span class="nb">apply</span> (valid_generated_state_message X2) <span class="kr">with</span> s _om _s om l.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>message, index</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>EqDecision0</var><span class="hyp-type"><b>: </b><span>EqDecision index</span></span></span><br><span><var>IM</var><span class="hyp-type"><b>: </b><span>index ‚Üí VLSM message</span></span></span><br><span><var>constraint1, constraint2</var><span class="hyp-type"><b>: </b><span>composite_label
‚Üí composite_state * option message
  ‚Üí <span class="kt">Prop</span></span></span></span><br><span><var>X1</var><span><span class="hyp-body"><b>:= </b><span>composite_vlsm constraint1</span></span><span class="hyp-type"><b>: </b><span>VLSM message</span></span></span></span><br><span><var>X2</var><span><span class="hyp-body"><b>:= </b><span>composite_vlsm constraint2</span></span><span class="hyp-type"><b>: </b><span>VLSM message</span></span></span></span><br><span><var>Hsubsumption</var><span class="hyp-type"><b>: </b><span>input_valid_constraint_subsumption
  constraint1 constraint2</span></span></span><br><span><var>s</var><span class="hyp-type"><b>: </b><span>state</span></span></span><br><span><var>_om</var><span class="hyp-type"><b>: </b><span>option message</span></span></span><br><span><var>Hps1</var><span class="hyp-type"><b>: </b><span>valid_state_message_prop X1 s _om</span></span></span><br><span><var>_s</var><span class="hyp-type"><b>: </b><span>state</span></span></span><br><span><var>om</var><span class="hyp-type"><b>: </b><span>option message</span></span></span><br><span><var>Hps2</var><span class="hyp-type"><b>: </b><span>valid_state_message_prop X1 _s om</span></span></span><br><span><var>l</var><span class="hyp-type"><b>: </b><span>label</span></span></span><br><span><var>Hv</var><span class="hyp-type"><b>: </b><span>valid l (s, om)</span></span></span><br><span><var>s'</var><span class="hyp-type"><b>: </b><span>state</span></span></span><br><span><var>om'</var><span class="hyp-type"><b>: </b><span>option message</span></span></span><br><span><var>Ht</var><span class="hyp-type"><b>: </b><span>transition l (s, om) = (s&#39;, om&#39;)</span></span></span><br><span><var>IHHps1</var><span class="hyp-type"><b>: </b><span>valid_state_message_prop X2 s _om</span></span></span><br><span><var>IHHps2</var><span class="hyp-type"><b>: </b><span>valid_state_message_prop X2 _s om</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">valid_state_message_prop X2 s _om</div></blockquote><div class="alectryon-extra-goals"><input class="alectryon-extra-goal-toggle" id="Composition-v-chk66" style="display: none" type="checkbox"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>message, index</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>EqDecision0</var><span class="hyp-type"><b>: </b><span>EqDecision index</span></span></span><br><span><var>IM</var><span class="hyp-type"><b>: </b><span>index ‚Üí VLSM message</span></span></span><br><span><var>constraint1, constraint2</var><span class="hyp-type"><b>: </b><span>composite_label
‚Üí composite_state * option message
  ‚Üí <span class="kt">Prop</span></span></span></span><br><span><var>X1</var><span><span class="hyp-body"><b>:= </b><span>composite_vlsm constraint1</span></span><span class="hyp-type"><b>: </b><span>VLSM message</span></span></span></span><br><span><var>X2</var><span><span class="hyp-body"><b>:= </b><span>composite_vlsm constraint2</span></span><span class="hyp-type"><b>: </b><span>VLSM message</span></span></span></span><br><span><var>Hsubsumption</var><span class="hyp-type"><b>: </b><span>input_valid_constraint_subsumption
  constraint1 constraint2</span></span></span><br><span><var>s</var><span class="hyp-type"><b>: </b><span>state</span></span></span><br><span><var>_om</var><span class="hyp-type"><b>: </b><span>option message</span></span></span><br><span><var>Hps1</var><span class="hyp-type"><b>: </b><span>valid_state_message_prop X1 s _om</span></span></span><br><span><var>_s</var><span class="hyp-type"><b>: </b><span>state</span></span></span><br><span><var>om</var><span class="hyp-type"><b>: </b><span>option message</span></span></span><br><span><var>Hps2</var><span class="hyp-type"><b>: </b><span>valid_state_message_prop X1 _s om</span></span></span><br><span><var>l</var><span class="hyp-type"><b>: </b><span>label</span></span></span><br><span><var>Hv</var><span class="hyp-type"><b>: </b><span>valid l (s, om)</span></span></span><br><span><var>s'</var><span class="hyp-type"><b>: </b><span>state</span></span></span><br><span><var>om'</var><span class="hyp-type"><b>: </b><span>option message</span></span></span><br><span><var>Ht</var><span class="hyp-type"><b>: </b><span>transition l (s, om) = (s&#39;, om&#39;)</span></span></span><br><span><var>IHHps1</var><span class="hyp-type"><b>: </b><span>valid_state_message_prop X2 s _om</span></span></span><br><span><var>IHHps2</var><span class="hyp-type"><b>: </b><span>valid_state_message_prop X2 _s om</span></span></span><br></div><label class="goal-separator" for="Composition-v-chk66"><hr></label><div class="goal-conclusion">valid_state_message_prop X2 _s om</div></blockquote><input class="alectryon-extra-goal-toggle" id="Composition-v-chk67" style="display: none" type="checkbox"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>message, index</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>EqDecision0</var><span class="hyp-type"><b>: </b><span>EqDecision index</span></span></span><br><span><var>IM</var><span class="hyp-type"><b>: </b><span>index ‚Üí VLSM message</span></span></span><br><span><var>constraint1, constraint2</var><span class="hyp-type"><b>: </b><span>composite_label
‚Üí composite_state * option message
  ‚Üí <span class="kt">Prop</span></span></span></span><br><span><var>X1</var><span><span class="hyp-body"><b>:= </b><span>composite_vlsm constraint1</span></span><span class="hyp-type"><b>: </b><span>VLSM message</span></span></span></span><br><span><var>X2</var><span><span class="hyp-body"><b>:= </b><span>composite_vlsm constraint2</span></span><span class="hyp-type"><b>: </b><span>VLSM message</span></span></span></span><br><span><var>Hsubsumption</var><span class="hyp-type"><b>: </b><span>input_valid_constraint_subsumption
  constraint1 constraint2</span></span></span><br><span><var>s</var><span class="hyp-type"><b>: </b><span>state</span></span></span><br><span><var>_om</var><span class="hyp-type"><b>: </b><span>option message</span></span></span><br><span><var>Hps1</var><span class="hyp-type"><b>: </b><span>valid_state_message_prop X1 s _om</span></span></span><br><span><var>_s</var><span class="hyp-type"><b>: </b><span>state</span></span></span><br><span><var>om</var><span class="hyp-type"><b>: </b><span>option message</span></span></span><br><span><var>Hps2</var><span class="hyp-type"><b>: </b><span>valid_state_message_prop X1 _s om</span></span></span><br><span><var>l</var><span class="hyp-type"><b>: </b><span>label</span></span></span><br><span><var>Hv</var><span class="hyp-type"><b>: </b><span>valid l (s, om)</span></span></span><br><span><var>s'</var><span class="hyp-type"><b>: </b><span>state</span></span></span><br><span><var>om'</var><span class="hyp-type"><b>: </b><span>option message</span></span></span><br><span><var>Ht</var><span class="hyp-type"><b>: </b><span>transition l (s, om) = (s&#39;, om&#39;)</span></span></span><br><span><var>IHHps1</var><span class="hyp-type"><b>: </b><span>valid_state_message_prop X2 s _om</span></span></span><br><span><var>IHHps2</var><span class="hyp-type"><b>: </b><span>valid_state_message_prop X2 _s om</span></span></span><br></div><label class="goal-separator" for="Composition-v-chk67"><hr></label><div class="goal-conclusion">valid l (s, om)</div></blockquote><input class="alectryon-extra-goal-toggle" id="Composition-v-chk68" style="display: none" type="checkbox"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>message, index</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>EqDecision0</var><span class="hyp-type"><b>: </b><span>EqDecision index</span></span></span><br><span><var>IM</var><span class="hyp-type"><b>: </b><span>index ‚Üí VLSM message</span></span></span><br><span><var>constraint1, constraint2</var><span class="hyp-type"><b>: </b><span>composite_label
‚Üí composite_state * option message
  ‚Üí <span class="kt">Prop</span></span></span></span><br><span><var>X1</var><span><span class="hyp-body"><b>:= </b><span>composite_vlsm constraint1</span></span><span class="hyp-type"><b>: </b><span>VLSM message</span></span></span></span><br><span><var>X2</var><span><span class="hyp-body"><b>:= </b><span>composite_vlsm constraint2</span></span><span class="hyp-type"><b>: </b><span>VLSM message</span></span></span></span><br><span><var>Hsubsumption</var><span class="hyp-type"><b>: </b><span>input_valid_constraint_subsumption
  constraint1 constraint2</span></span></span><br><span><var>s</var><span class="hyp-type"><b>: </b><span>state</span></span></span><br><span><var>_om</var><span class="hyp-type"><b>: </b><span>option message</span></span></span><br><span><var>Hps1</var><span class="hyp-type"><b>: </b><span>valid_state_message_prop X1 s _om</span></span></span><br><span><var>_s</var><span class="hyp-type"><b>: </b><span>state</span></span></span><br><span><var>om</var><span class="hyp-type"><b>: </b><span>option message</span></span></span><br><span><var>Hps2</var><span class="hyp-type"><b>: </b><span>valid_state_message_prop X1 _s om</span></span></span><br><span><var>l</var><span class="hyp-type"><b>: </b><span>label</span></span></span><br><span><var>Hv</var><span class="hyp-type"><b>: </b><span>valid l (s, om)</span></span></span><br><span><var>s'</var><span class="hyp-type"><b>: </b><span>state</span></span></span><br><span><var>om'</var><span class="hyp-type"><b>: </b><span>option message</span></span></span><br><span><var>Ht</var><span class="hyp-type"><b>: </b><span>transition l (s, om) = (s&#39;, om&#39;)</span></span></span><br><span><var>IHHps1</var><span class="hyp-type"><b>: </b><span>valid_state_message_prop X2 s _om</span></span></span><br><span><var>IHHps2</var><span class="hyp-type"><b>: </b><span>valid_state_message_prop X2 _s om</span></span></span><br></div><label class="goal-separator" for="Composition-v-chk68"><hr></label><div class="goal-conclusion">transition l (s, om) = (s&#39;, om&#39;)</div></blockquote></div></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="Composition-v-chk69" style="display: none" type="checkbox"><label class="alectryon-input" for="Composition-v-chk69"><span class="mi">1</span>-<span class="mi">2</span>, <span class="mi">4</span>: <span class="bp">done</span>.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>message, index</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>EqDecision0</var><span class="hyp-type"><b>: </b><span>EqDecision index</span></span></span><br><span><var>IM</var><span class="hyp-type"><b>: </b><span>index ‚Üí VLSM message</span></span></span><br><span><var>constraint1, constraint2</var><span class="hyp-type"><b>: </b><span>composite_label
‚Üí composite_state * option message
  ‚Üí <span class="kt">Prop</span></span></span></span><br><span><var>X1</var><span><span class="hyp-body"><b>:= </b><span>composite_vlsm constraint1</span></span><span class="hyp-type"><b>: </b><span>VLSM message</span></span></span></span><br><span><var>X2</var><span><span class="hyp-body"><b>:= </b><span>composite_vlsm constraint2</span></span><span class="hyp-type"><b>: </b><span>VLSM message</span></span></span></span><br><span><var>Hsubsumption</var><span class="hyp-type"><b>: </b><span>input_valid_constraint_subsumption
  constraint1 constraint2</span></span></span><br><span><var>s</var><span class="hyp-type"><b>: </b><span>state</span></span></span><br><span><var>_om</var><span class="hyp-type"><b>: </b><span>option message</span></span></span><br><span><var>Hps1</var><span class="hyp-type"><b>: </b><span>valid_state_message_prop X1 s _om</span></span></span><br><span><var>_s</var><span class="hyp-type"><b>: </b><span>state</span></span></span><br><span><var>om</var><span class="hyp-type"><b>: </b><span>option message</span></span></span><br><span><var>Hps2</var><span class="hyp-type"><b>: </b><span>valid_state_message_prop X1 _s om</span></span></span><br><span><var>l</var><span class="hyp-type"><b>: </b><span>label</span></span></span><br><span><var>Hv</var><span class="hyp-type"><b>: </b><span>valid l (s, om)</span></span></span><br><span><var>s'</var><span class="hyp-type"><b>: </b><span>state</span></span></span><br><span><var>om'</var><span class="hyp-type"><b>: </b><span>option message</span></span></span><br><span><var>Ht</var><span class="hyp-type"><b>: </b><span>transition l (s, om) = (s&#39;, om&#39;)</span></span></span><br><span><var>IHHps1</var><span class="hyp-type"><b>: </b><span>valid_state_message_prop X2 s _om</span></span></span><br><span><var>IHHps2</var><span class="hyp-type"><b>: </b><span>valid_state_message_prop X2 _s om</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">valid l (s, om)</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="Composition-v-chk6a" style="display: none" type="checkbox"><label class="alectryon-input" for="Composition-v-chk6a"><span class="nb">apply</span> constraint_subsumption_input_valid; [<span class="bp">done</span> |].</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>message, index</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>EqDecision0</var><span class="hyp-type"><b>: </b><span>EqDecision index</span></span></span><br><span><var>IM</var><span class="hyp-type"><b>: </b><span>index ‚Üí VLSM message</span></span></span><br><span><var>constraint1, constraint2</var><span class="hyp-type"><b>: </b><span>composite_label
‚Üí composite_state * option message
  ‚Üí <span class="kt">Prop</span></span></span></span><br><span><var>X1</var><span><span class="hyp-body"><b>:= </b><span>composite_vlsm constraint1</span></span><span class="hyp-type"><b>: </b><span>VLSM message</span></span></span></span><br><span><var>X2</var><span><span class="hyp-body"><b>:= </b><span>composite_vlsm constraint2</span></span><span class="hyp-type"><b>: </b><span>VLSM message</span></span></span></span><br><span><var>Hsubsumption</var><span class="hyp-type"><b>: </b><span>input_valid_constraint_subsumption
  constraint1 constraint2</span></span></span><br><span><var>s</var><span class="hyp-type"><b>: </b><span>state</span></span></span><br><span><var>_om</var><span class="hyp-type"><b>: </b><span>option message</span></span></span><br><span><var>Hps1</var><span class="hyp-type"><b>: </b><span>valid_state_message_prop X1 s _om</span></span></span><br><span><var>_s</var><span class="hyp-type"><b>: </b><span>state</span></span></span><br><span><var>om</var><span class="hyp-type"><b>: </b><span>option message</span></span></span><br><span><var>Hps2</var><span class="hyp-type"><b>: </b><span>valid_state_message_prop X1 _s om</span></span></span><br><span><var>l</var><span class="hyp-type"><b>: </b><span>label</span></span></span><br><span><var>Hv</var><span class="hyp-type"><b>: </b><span>valid l (s, om)</span></span></span><br><span><var>s'</var><span class="hyp-type"><b>: </b><span>state</span></span></span><br><span><var>om'</var><span class="hyp-type"><b>: </b><span>option message</span></span></span><br><span><var>Ht</var><span class="hyp-type"><b>: </b><span>transition l (s, om) = (s&#39;, om&#39;)</span></span></span><br><span><var>IHHps1</var><span class="hyp-type"><b>: </b><span>valid_state_message_prop X2 s _om</span></span></span><br><span><var>IHHps2</var><span class="hyp-type"><b>: </b><span>valid_state_message_prop X2 _s om</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">input_valid X1 l (s, om)</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><span class="alectryon-input"><span class="bp">by</span> split_and!; [<span class="kr">exists</span> <span class="nv">_om</span> | <span class="kr">exists</span> <span class="nv">_s</span>|].</span><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Qed</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
</span><span class="alectryon-sentence"><input class="alectryon-toggle" id="Composition-v-chk6b" style="display: none" type="checkbox"><label class="alectryon-input" for="Composition-v-chk6b"><span class="kn">Lemma</span> <span class="nf">constraint_subsumption_incl</span>
  (<span class="nv">Hsubsumption</span> : input_valid_constraint_subsumption constraint1 constraint2)
  : VLSM_incl X1 X2.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>message, index</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>EqDecision0</var><span class="hyp-type"><b>: </b><span>EqDecision index</span></span></span><br><span><var>IM</var><span class="hyp-type"><b>: </b><span>index ‚Üí VLSM message</span></span></span><br><span><var>constraint1, constraint2</var><span class="hyp-type"><b>: </b><span>composite_label
‚Üí composite_state * option message
  ‚Üí <span class="kt">Prop</span></span></span></span><br><span><var>X1</var><span><span class="hyp-body"><b>:= </b><span>composite_vlsm constraint1</span></span><span class="hyp-type"><b>: </b><span>VLSM message</span></span></span></span><br><span><var>X2</var><span><span class="hyp-body"><b>:= </b><span>composite_vlsm constraint2</span></span><span class="hyp-type"><b>: </b><span>VLSM message</span></span></span></span><br><span><var>Hsubsumption</var><span class="hyp-type"><b>: </b><span>input_valid_constraint_subsumption
  constraint1 constraint2</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">VLSM_incl X1 X2</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="Composition-v-chk6c" style="display: none" type="checkbox"><label class="alectryon-input" for="Composition-v-chk6c"><span class="kn">Proof</span>.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>message, index</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>EqDecision0</var><span class="hyp-type"><b>: </b><span>EqDecision index</span></span></span><br><span><var>IM</var><span class="hyp-type"><b>: </b><span>index ‚Üí VLSM message</span></span></span><br><span><var>constraint1, constraint2</var><span class="hyp-type"><b>: </b><span>composite_label
‚Üí composite_state * option message
  ‚Üí <span class="kt">Prop</span></span></span></span><br><span><var>X1</var><span><span class="hyp-body"><b>:= </b><span>composite_vlsm constraint1</span></span><span class="hyp-type"><b>: </b><span>VLSM message</span></span></span></span><br><span><var>X2</var><span><span class="hyp-body"><b>:= </b><span>composite_vlsm constraint2</span></span><span class="hyp-type"><b>: </b><span>VLSM message</span></span></span></span><br><span><var>Hsubsumption</var><span class="hyp-type"><b>: </b><span>input_valid_constraint_subsumption
  constraint1 constraint2</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">VLSM_incl X1 X2</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="Composition-v-chk6d" style="display: none" type="checkbox"><label class="alectryon-input" for="Composition-v-chk6d"><span class="nb">apply</span> basic_VLSM_incl; <span class="nb">intro</span>; <span class="nb">intros</span>.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>message, index</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>EqDecision0</var><span class="hyp-type"><b>: </b><span>EqDecision index</span></span></span><br><span><var>IM</var><span class="hyp-type"><b>: </b><span>index ‚Üí VLSM message</span></span></span><br><span><var>constraint1, constraint2</var><span class="hyp-type"><b>: </b><span>composite_label
‚Üí composite_state * option message
  ‚Üí <span class="kt">Prop</span></span></span></span><br><span><var>X1</var><span><span class="hyp-body"><b>:= </b><span>composite_vlsm constraint1</span></span><span class="hyp-type"><b>: </b><span>VLSM message</span></span></span></span><br><span><var>X2</var><span><span class="hyp-body"><b>:= </b><span>composite_vlsm constraint2</span></span><span class="hyp-type"><b>: </b><span>VLSM message</span></span></span></span><br><span><var>Hsubsumption</var><span class="hyp-type"><b>: </b><span>input_valid_constraint_subsumption
  constraint1 constraint2</span></span></span><br><span><var>s</var><span class="hyp-type"><b>: </b><span>state</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>vinitial_state_prop
  {|
    vtype := composite_type;
    vmachine := composite_vlsm_machine constraint1
  |} s</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">vinitial_state_prop
  {|
    vtype := composite_type;
    vmachine := composite_vlsm_machine constraint2
  |} (id s)</div></blockquote><div class="alectryon-extra-goals"><input class="alectryon-extra-goal-toggle" id="Composition-v-chk6e" style="display: none" type="checkbox"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>message, index</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>EqDecision0</var><span class="hyp-type"><b>: </b><span>EqDecision index</span></span></span><br><span><var>IM</var><span class="hyp-type"><b>: </b><span>index ‚Üí VLSM message</span></span></span><br><span><var>constraint1, constraint2</var><span class="hyp-type"><b>: </b><span>composite_label
‚Üí composite_state * option message
  ‚Üí <span class="kt">Prop</span></span></span></span><br><span><var>X1</var><span><span class="hyp-body"><b>:= </b><span>composite_vlsm constraint1</span></span><span class="hyp-type"><b>: </b><span>VLSM message</span></span></span></span><br><span><var>X2</var><span><span class="hyp-body"><b>:= </b><span>composite_vlsm constraint2</span></span><span class="hyp-type"><b>: </b><span>VLSM message</span></span></span></span><br><span><var>Hsubsumption</var><span class="hyp-type"><b>: </b><span>input_valid_constraint_subsumption
  constraint1 constraint2</span></span></span><br><span><var>l</var><span class="hyp-type"><b>: </b><span>label</span></span></span><br><span><var>s</var><span class="hyp-type"><b>: </b><span>state</span></span></span><br><span><var>m</var><span class="hyp-type"><b>: </b><span>message</span></span></span><br><span><var>Hv</var><span class="hyp-type"><b>: </b><span>input_valid
  {|
    vtype := composite_type;
    vmachine :=
      composite_vlsm_machine constraint1
  |} l (s, Some m)</span></span></span><br><span><var>HsY</var><span class="hyp-type"><b>: </b><span>valid_state_prop
  {|
    vtype := composite_type;
    vmachine :=
      composite_vlsm_machine constraint2
  |} (id s)</span></span></span><br><span><var>HmX</var><span class="hyp-type"><b>: </b><span>vinitial_message_prop
  {|
    vtype := composite_type;
    vmachine :=
      composite_vlsm_machine constraint1
  |} m</span></span></span><br></div><label class="goal-separator" for="Composition-v-chk6e"><hr></label><div class="goal-conclusion">valid_message_prop
  {|
    vtype := composite_type;
    vmachine := composite_vlsm_machine constraint2
  |} m</div></blockquote><input class="alectryon-extra-goal-toggle" id="Composition-v-chk6f" style="display: none" type="checkbox"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>message, index</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>EqDecision0</var><span class="hyp-type"><b>: </b><span>EqDecision index</span></span></span><br><span><var>IM</var><span class="hyp-type"><b>: </b><span>index ‚Üí VLSM message</span></span></span><br><span><var>constraint1, constraint2</var><span class="hyp-type"><b>: </b><span>composite_label
‚Üí composite_state * option message
  ‚Üí <span class="kt">Prop</span></span></span></span><br><span><var>X1</var><span><span class="hyp-body"><b>:= </b><span>composite_vlsm constraint1</span></span><span class="hyp-type"><b>: </b><span>VLSM message</span></span></span></span><br><span><var>X2</var><span><span class="hyp-body"><b>:= </b><span>composite_vlsm constraint2</span></span><span class="hyp-type"><b>: </b><span>VLSM message</span></span></span></span><br><span><var>Hsubsumption</var><span class="hyp-type"><b>: </b><span>input_valid_constraint_subsumption
  constraint1 constraint2</span></span></span><br><span><var>l</var><span class="hyp-type"><b>: </b><span>label</span></span></span><br><span><var>s</var><span class="hyp-type"><b>: </b><span>state</span></span></span><br><span><var>om</var><span class="hyp-type"><b>: </b><span>option message</span></span></span><br><span><var>Hv</var><span class="hyp-type"><b>: </b><span>input_valid
  {|
    vtype := composite_type;
    vmachine :=
      composite_vlsm_machine constraint1
  |} l (s, om)</span></span></span><br><span><var>HsY</var><span class="hyp-type"><b>: </b><span>valid_state_prop
  {|
    vtype := composite_type;
    vmachine :=
      composite_vlsm_machine constraint2
  |} (id s)</span></span></span><br><span><var>HomY</var><span class="hyp-type"><b>: </b><span>option_valid_message_prop
  {|
    vtype := composite_type;
    vmachine :=
      composite_vlsm_machine constraint2
  |} om</span></span></span><br></div><label class="goal-separator" for="Composition-v-chk6f"><hr></label><div class="goal-conclusion">vvalid
  {|
    vtype := composite_type;
    vmachine := composite_vlsm_machine constraint2
  |} (id l) (id s, om)</div></blockquote><input class="alectryon-extra-goal-toggle" id="Composition-v-chk70" style="display: none" type="checkbox"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>message, index</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>EqDecision0</var><span class="hyp-type"><b>: </b><span>EqDecision index</span></span></span><br><span><var>IM</var><span class="hyp-type"><b>: </b><span>index ‚Üí VLSM message</span></span></span><br><span><var>constraint1, constraint2</var><span class="hyp-type"><b>: </b><span>composite_label
‚Üí composite_state * option message
  ‚Üí <span class="kt">Prop</span></span></span></span><br><span><var>X1</var><span><span class="hyp-body"><b>:= </b><span>composite_vlsm constraint1</span></span><span class="hyp-type"><b>: </b><span>VLSM message</span></span></span></span><br><span><var>X2</var><span><span class="hyp-body"><b>:= </b><span>composite_vlsm constraint2</span></span><span class="hyp-type"><b>: </b><span>VLSM message</span></span></span></span><br><span><var>Hsubsumption</var><span class="hyp-type"><b>: </b><span>input_valid_constraint_subsumption
  constraint1 constraint2</span></span></span><br><span><var>l</var><span class="hyp-type"><b>: </b><span>label</span></span></span><br><span><var>s</var><span class="hyp-type"><b>: </b><span>state</span></span></span><br><span><var>om</var><span class="hyp-type"><b>: </b><span>option message</span></span></span><br><span><var>s'</var><span class="hyp-type"><b>: </b><span>state</span></span></span><br><span><var>om'</var><span class="hyp-type"><b>: </b><span>option message</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>input_valid_transition
  {|
    vtype := composite_type;
    vmachine := composite_vlsm_machine constraint1
  |} l (s, om) (s&#39;, om&#39;)</span></span></span><br></div><label class="goal-separator" for="Composition-v-chk70"><hr></label><div class="goal-conclusion">vtransition
  {|
    vtype := composite_type;
    vmachine := composite_vlsm_machine constraint2
  |} (id l) (id s, om) = 
(id s&#39;, om&#39;)</div></blockquote></div></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="Composition-v-chk71" style="display: none" type="checkbox"><label class="alectryon-input" for="Composition-v-chk71">-</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>message, index</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>EqDecision0</var><span class="hyp-type"><b>: </b><span>EqDecision index</span></span></span><br><span><var>IM</var><span class="hyp-type"><b>: </b><span>index ‚Üí VLSM message</span></span></span><br><span><var>constraint1, constraint2</var><span class="hyp-type"><b>: </b><span>composite_label
‚Üí composite_state * option message
  ‚Üí <span class="kt">Prop</span></span></span></span><br><span><var>X1</var><span><span class="hyp-body"><b>:= </b><span>composite_vlsm constraint1</span></span><span class="hyp-type"><b>: </b><span>VLSM message</span></span></span></span><br><span><var>X2</var><span><span class="hyp-body"><b>:= </b><span>composite_vlsm constraint2</span></span><span class="hyp-type"><b>: </b><span>VLSM message</span></span></span></span><br><span><var>Hsubsumption</var><span class="hyp-type"><b>: </b><span>input_valid_constraint_subsumption
  constraint1 constraint2</span></span></span><br><span><var>s</var><span class="hyp-type"><b>: </b><span>state</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>vinitial_state_prop
  {|
    vtype := composite_type;
    vmachine := composite_vlsm_machine constraint1
  |} s</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">vinitial_state_prop
  {|
    vtype := composite_type;
    vmachine := composite_vlsm_machine constraint2
  |} (id s)</div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="bp">done</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="Composition-v-chk72" style="display: none" type="checkbox"><label class="alectryon-input" for="Composition-v-chk72">-</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>message, index</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>EqDecision0</var><span class="hyp-type"><b>: </b><span>EqDecision index</span></span></span><br><span><var>IM</var><span class="hyp-type"><b>: </b><span>index ‚Üí VLSM message</span></span></span><br><span><var>constraint1, constraint2</var><span class="hyp-type"><b>: </b><span>composite_label
‚Üí composite_state * option message
  ‚Üí <span class="kt">Prop</span></span></span></span><br><span><var>X1</var><span><span class="hyp-body"><b>:= </b><span>composite_vlsm constraint1</span></span><span class="hyp-type"><b>: </b><span>VLSM message</span></span></span></span><br><span><var>X2</var><span><span class="hyp-body"><b>:= </b><span>composite_vlsm constraint2</span></span><span class="hyp-type"><b>: </b><span>VLSM message</span></span></span></span><br><span><var>Hsubsumption</var><span class="hyp-type"><b>: </b><span>input_valid_constraint_subsumption
  constraint1 constraint2</span></span></span><br><span><var>l</var><span class="hyp-type"><b>: </b><span>label</span></span></span><br><span><var>s</var><span class="hyp-type"><b>: </b><span>state</span></span></span><br><span><var>m</var><span class="hyp-type"><b>: </b><span>message</span></span></span><br><span><var>Hv</var><span class="hyp-type"><b>: </b><span>input_valid
  {|
    vtype := composite_type;
    vmachine :=
      composite_vlsm_machine constraint1
  |} l (s, Some m)</span></span></span><br><span><var>HsY</var><span class="hyp-type"><b>: </b><span>valid_state_prop
  {|
    vtype := composite_type;
    vmachine :=
      composite_vlsm_machine constraint2
  |} (id s)</span></span></span><br><span><var>HmX</var><span class="hyp-type"><b>: </b><span>vinitial_message_prop
  {|
    vtype := composite_type;
    vmachine :=
      composite_vlsm_machine constraint1
  |} m</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">valid_message_prop
  {|
    vtype := composite_type;
    vmachine := composite_vlsm_machine constraint2
  |} m</div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="bp">by</span> <span class="nb">apply</span> initial_message_is_valid.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="Composition-v-chk73" style="display: none" type="checkbox"><label class="alectryon-input" for="Composition-v-chk73">-</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>message, index</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>EqDecision0</var><span class="hyp-type"><b>: </b><span>EqDecision index</span></span></span><br><span><var>IM</var><span class="hyp-type"><b>: </b><span>index ‚Üí VLSM message</span></span></span><br><span><var>constraint1, constraint2</var><span class="hyp-type"><b>: </b><span>composite_label
‚Üí composite_state * option message
  ‚Üí <span class="kt">Prop</span></span></span></span><br><span><var>X1</var><span><span class="hyp-body"><b>:= </b><span>composite_vlsm constraint1</span></span><span class="hyp-type"><b>: </b><span>VLSM message</span></span></span></span><br><span><var>X2</var><span><span class="hyp-body"><b>:= </b><span>composite_vlsm constraint2</span></span><span class="hyp-type"><b>: </b><span>VLSM message</span></span></span></span><br><span><var>Hsubsumption</var><span class="hyp-type"><b>: </b><span>input_valid_constraint_subsumption
  constraint1 constraint2</span></span></span><br><span><var>l</var><span class="hyp-type"><b>: </b><span>label</span></span></span><br><span><var>s</var><span class="hyp-type"><b>: </b><span>state</span></span></span><br><span><var>om</var><span class="hyp-type"><b>: </b><span>option message</span></span></span><br><span><var>Hv</var><span class="hyp-type"><b>: </b><span>input_valid
  {|
    vtype := composite_type;
    vmachine :=
      composite_vlsm_machine constraint1
  |} l (s, om)</span></span></span><br><span><var>HsY</var><span class="hyp-type"><b>: </b><span>valid_state_prop
  {|
    vtype := composite_type;
    vmachine :=
      composite_vlsm_machine constraint2
  |} (id s)</span></span></span><br><span><var>HomY</var><span class="hyp-type"><b>: </b><span>option_valid_message_prop
  {|
    vtype := composite_type;
    vmachine :=
      composite_vlsm_machine constraint2
  |} om</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">vvalid
  {|
    vtype := composite_type;
    vmachine := composite_vlsm_machine constraint2
  |} (id l) (id s, om)</div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="bp">by</span> <span class="nb">apply</span> constraint_subsumption_input_valid.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="Composition-v-chk74" style="display: none" type="checkbox"><label class="alectryon-input" for="Composition-v-chk74">-</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>message, index</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>EqDecision0</var><span class="hyp-type"><b>: </b><span>EqDecision index</span></span></span><br><span><var>IM</var><span class="hyp-type"><b>: </b><span>index ‚Üí VLSM message</span></span></span><br><span><var>constraint1, constraint2</var><span class="hyp-type"><b>: </b><span>composite_label
‚Üí composite_state * option message
  ‚Üí <span class="kt">Prop</span></span></span></span><br><span><var>X1</var><span><span class="hyp-body"><b>:= </b><span>composite_vlsm constraint1</span></span><span class="hyp-type"><b>: </b><span>VLSM message</span></span></span></span><br><span><var>X2</var><span><span class="hyp-body"><b>:= </b><span>composite_vlsm constraint2</span></span><span class="hyp-type"><b>: </b><span>VLSM message</span></span></span></span><br><span><var>Hsubsumption</var><span class="hyp-type"><b>: </b><span>input_valid_constraint_subsumption
  constraint1 constraint2</span></span></span><br><span><var>l</var><span class="hyp-type"><b>: </b><span>label</span></span></span><br><span><var>s</var><span class="hyp-type"><b>: </b><span>state</span></span></span><br><span><var>om</var><span class="hyp-type"><b>: </b><span>option message</span></span></span><br><span><var>s'</var><span class="hyp-type"><b>: </b><span>state</span></span></span><br><span><var>om'</var><span class="hyp-type"><b>: </b><span>option message</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>input_valid_transition
  {|
    vtype := composite_type;
    vmachine := composite_vlsm_machine constraint1
  |} l (s, om) (s&#39;, om&#39;)</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">vtransition
  {|
    vtype := composite_type;
    vmachine := composite_vlsm_machine constraint2
  |} (id l) (id s, om) = (id s&#39;, om&#39;)</div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="bp">by</span> <span class="nb">apply</span> H.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Qed</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
</span><span class="alectryon-sentence"><input class="alectryon-toggle" id="Composition-v-chk75" style="display: none" type="checkbox"><label class="alectryon-input" for="Composition-v-chk75"><span class="kn">Lemma</span> <span class="nf">preloaded_constraint_subsumption_input_valid</span>
  (<span class="nv">Hpre_subsumption</span> : preloaded_constraint_subsumption constraint1 constraint2)
  (<span class="nv">l</span> : label)
  (<span class="nv">s</span> : state)
  (<span class="nv">om</span> : option message)
  (<span class="nv">Hv</span> : input_valid (pre_loaded_with_all_messages_vlsm X1) l (s, om))
  : vvalid X2 l (s, om).</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>message, index</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>EqDecision0</var><span class="hyp-type"><b>: </b><span>EqDecision index</span></span></span><br><span><var>IM</var><span class="hyp-type"><b>: </b><span>index ‚Üí VLSM message</span></span></span><br><span><var>constraint1, constraint2</var><span class="hyp-type"><b>: </b><span>composite_label
‚Üí composite_state * option message
  ‚Üí <span class="kt">Prop</span></span></span></span><br><span><var>X1</var><span><span class="hyp-body"><b>:= </b><span>composite_vlsm constraint1</span></span><span class="hyp-type"><b>: </b><span>VLSM message</span></span></span></span><br><span><var>X2</var><span><span class="hyp-body"><b>:= </b><span>composite_vlsm constraint2</span></span><span class="hyp-type"><b>: </b><span>VLSM message</span></span></span></span><br><span><var>Hpre_subsumption</var><span class="hyp-type"><b>: </b><span>preloaded_constraint_subsumption
  constraint1 constraint2</span></span></span><br><span><var>l</var><span class="hyp-type"><b>: </b><span>label</span></span></span><br><span><var>s</var><span class="hyp-type"><b>: </b><span>state</span></span></span><br><span><var>om</var><span class="hyp-type"><b>: </b><span>option message</span></span></span><br><span><var>Hv</var><span class="hyp-type"><b>: </b><span>input_valid
  (pre_loaded_with_all_messages_vlsm X1) l
  (s, om)</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">vvalid X2 l (s, om)</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="Composition-v-chk76" style="display: none" type="checkbox"><label class="alectryon-input" for="Composition-v-chk76"><span class="kn">Proof</span>.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>message, index</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>EqDecision0</var><span class="hyp-type"><b>: </b><span>EqDecision index</span></span></span><br><span><var>IM</var><span class="hyp-type"><b>: </b><span>index ‚Üí VLSM message</span></span></span><br><span><var>constraint1, constraint2</var><span class="hyp-type"><b>: </b><span>composite_label
‚Üí composite_state * option message
  ‚Üí <span class="kt">Prop</span></span></span></span><br><span><var>X1</var><span><span class="hyp-body"><b>:= </b><span>composite_vlsm constraint1</span></span><span class="hyp-type"><b>: </b><span>VLSM message</span></span></span></span><br><span><var>X2</var><span><span class="hyp-body"><b>:= </b><span>composite_vlsm constraint2</span></span><span class="hyp-type"><b>: </b><span>VLSM message</span></span></span></span><br><span><var>Hpre_subsumption</var><span class="hyp-type"><b>: </b><span>preloaded_constraint_subsumption
  constraint1 constraint2</span></span></span><br><span><var>l</var><span class="hyp-type"><b>: </b><span>label</span></span></span><br><span><var>s</var><span class="hyp-type"><b>: </b><span>state</span></span></span><br><span><var>om</var><span class="hyp-type"><b>: </b><span>option message</span></span></span><br><span><var>Hv</var><span class="hyp-type"><b>: </b><span>input_valid
  (pre_loaded_with_all_messages_vlsm X1) l
  (s, om)</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">vvalid X2 l (s, om)</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><span class="alectryon-input"><span class="bp">by</span> <span class="nb">split</span>; [<span class="nb">apply</span> Hv | <span class="nb">apply</span> Hpre_subsumption].</span><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Qed</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
</span><span class="alectryon-sentence"><input class="alectryon-toggle" id="Composition-v-chk77" style="display: none" type="checkbox"><label class="alectryon-input" for="Composition-v-chk77"><span class="kn">Lemma</span> <span class="nf">preloaded_constraint_subsumption_incl</span>
  (<span class="nv">Hpre_subsumption</span> : preloaded_constraint_subsumption constraint1 constraint2)
  : VLSM_incl (pre_loaded_with_all_messages_vlsm X1) (pre_loaded_with_all_messages_vlsm X2).</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>message, index</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>EqDecision0</var><span class="hyp-type"><b>: </b><span>EqDecision index</span></span></span><br><span><var>IM</var><span class="hyp-type"><b>: </b><span>index ‚Üí VLSM message</span></span></span><br><span><var>constraint1, constraint2</var><span class="hyp-type"><b>: </b><span>composite_label
‚Üí composite_state * option message
  ‚Üí <span class="kt">Prop</span></span></span></span><br><span><var>X1</var><span><span class="hyp-body"><b>:= </b><span>composite_vlsm constraint1</span></span><span class="hyp-type"><b>: </b><span>VLSM message</span></span></span></span><br><span><var>X2</var><span><span class="hyp-body"><b>:= </b><span>composite_vlsm constraint2</span></span><span class="hyp-type"><b>: </b><span>VLSM message</span></span></span></span><br><span><var>Hpre_subsumption</var><span class="hyp-type"><b>: </b><span>preloaded_constraint_subsumption
  constraint1 constraint2</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">VLSM_incl (pre_loaded_with_all_messages_vlsm X1)
  (pre_loaded_with_all_messages_vlsm X2)</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="Composition-v-chk78" style="display: none" type="checkbox"><label class="alectryon-input" for="Composition-v-chk78"><span class="kn">Proof</span>.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>message, index</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>EqDecision0</var><span class="hyp-type"><b>: </b><span>EqDecision index</span></span></span><br><span><var>IM</var><span class="hyp-type"><b>: </b><span>index ‚Üí VLSM message</span></span></span><br><span><var>constraint1, constraint2</var><span class="hyp-type"><b>: </b><span>composite_label
‚Üí composite_state * option message
  ‚Üí <span class="kt">Prop</span></span></span></span><br><span><var>X1</var><span><span class="hyp-body"><b>:= </b><span>composite_vlsm constraint1</span></span><span class="hyp-type"><b>: </b><span>VLSM message</span></span></span></span><br><span><var>X2</var><span><span class="hyp-body"><b>:= </b><span>composite_vlsm constraint2</span></span><span class="hyp-type"><b>: </b><span>VLSM message</span></span></span></span><br><span><var>Hpre_subsumption</var><span class="hyp-type"><b>: </b><span>preloaded_constraint_subsumption
  constraint1 constraint2</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">VLSM_incl (pre_loaded_with_all_messages_vlsm X1)
  (pre_loaded_with_all_messages_vlsm X2)</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="Composition-v-chk79" style="display: none" type="checkbox"><label class="alectryon-input" for="Composition-v-chk79"><span class="nb">apply</span> basic_VLSM_incl; <span class="nb">intro</span>; <span class="nb">intros</span>; [<span class="bp">done</span> | | | <span class="nb">apply</span> H].</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>message, index</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>EqDecision0</var><span class="hyp-type"><b>: </b><span>EqDecision index</span></span></span><br><span><var>IM</var><span class="hyp-type"><b>: </b><span>index ‚Üí VLSM message</span></span></span><br><span><var>constraint1, constraint2</var><span class="hyp-type"><b>: </b><span>composite_label
‚Üí composite_state * option message
  ‚Üí <span class="kt">Prop</span></span></span></span><br><span><var>X1</var><span><span class="hyp-body"><b>:= </b><span>composite_vlsm constraint1</span></span><span class="hyp-type"><b>: </b><span>VLSM message</span></span></span></span><br><span><var>X2</var><span><span class="hyp-body"><b>:= </b><span>composite_vlsm constraint2</span></span><span class="hyp-type"><b>: </b><span>VLSM message</span></span></span></span><br><span><var>Hpre_subsumption</var><span class="hyp-type"><b>: </b><span>preloaded_constraint_subsumption
  constraint1 constraint2</span></span></span><br><span><var>l</var><span class="hyp-type"><b>: </b><span>label</span></span></span><br><span><var>s</var><span class="hyp-type"><b>: </b><span>state</span></span></span><br><span><var>m</var><span class="hyp-type"><b>: </b><span>message</span></span></span><br><span><var>Hv</var><span class="hyp-type"><b>: </b><span>input_valid
  {|
    vtype := type X1;
    vmachine :=
      pre_loaded_with_all_messages_vlsm_machine
        X1
  |} l (s, Some m)</span></span></span><br><span><var>HsY</var><span class="hyp-type"><b>: </b><span>valid_state_prop
  {|
    vtype := type X1;
    vmachine :=
      pre_loaded_with_all_messages_vlsm_machine
        X2
  |} (id s)</span></span></span><br><span><var>HmX</var><span class="hyp-type"><b>: </b><span>vinitial_message_prop
  {|
    vtype := type X1;
    vmachine :=
      pre_loaded_with_all_messages_vlsm_machine
        X1
  |} m</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">valid_message_prop
  {|
    vtype := type X1;
    vmachine :=
      pre_loaded_with_all_messages_vlsm_machine X2
  |} m</div></blockquote><div class="alectryon-extra-goals"><input class="alectryon-extra-goal-toggle" id="Composition-v-chk7a" style="display: none" type="checkbox"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>message, index</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>EqDecision0</var><span class="hyp-type"><b>: </b><span>EqDecision index</span></span></span><br><span><var>IM</var><span class="hyp-type"><b>: </b><span>index ‚Üí VLSM message</span></span></span><br><span><var>constraint1, constraint2</var><span class="hyp-type"><b>: </b><span>composite_label
‚Üí composite_state * option message
  ‚Üí <span class="kt">Prop</span></span></span></span><br><span><var>X1</var><span><span class="hyp-body"><b>:= </b><span>composite_vlsm constraint1</span></span><span class="hyp-type"><b>: </b><span>VLSM message</span></span></span></span><br><span><var>X2</var><span><span class="hyp-body"><b>:= </b><span>composite_vlsm constraint2</span></span><span class="hyp-type"><b>: </b><span>VLSM message</span></span></span></span><br><span><var>Hpre_subsumption</var><span class="hyp-type"><b>: </b><span>preloaded_constraint_subsumption
  constraint1 constraint2</span></span></span><br><span><var>l</var><span class="hyp-type"><b>: </b><span>label</span></span></span><br><span><var>s</var><span class="hyp-type"><b>: </b><span>state</span></span></span><br><span><var>om</var><span class="hyp-type"><b>: </b><span>option message</span></span></span><br><span><var>Hv</var><span class="hyp-type"><b>: </b><span>input_valid
  {|
    vtype := type X1;
    vmachine :=
      pre_loaded_with_all_messages_vlsm_machine
        X1
  |} l (s, om)</span></span></span><br><span><var>HsY</var><span class="hyp-type"><b>: </b><span>valid_state_prop
  {|
    vtype := type X1;
    vmachine :=
      pre_loaded_with_all_messages_vlsm_machine
        X2
  |} (id s)</span></span></span><br><span><var>HomY</var><span class="hyp-type"><b>: </b><span>option_valid_message_prop
  {|
    vtype := type X1;
    vmachine :=
      pre_loaded_with_all_messages_vlsm_machine
        X2
  |} om</span></span></span><br></div><label class="goal-separator" for="Composition-v-chk7a"><hr></label><div class="goal-conclusion">vvalid
  {|
    vtype := type X1;
    vmachine :=
      pre_loaded_with_all_messages_vlsm_machine X2
  |} (id l) (id s, om)</div></blockquote></div></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="Composition-v-chk7b" style="display: none" type="checkbox"><label class="alectryon-input" for="Composition-v-chk7b">-</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>message, index</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>EqDecision0</var><span class="hyp-type"><b>: </b><span>EqDecision index</span></span></span><br><span><var>IM</var><span class="hyp-type"><b>: </b><span>index ‚Üí VLSM message</span></span></span><br><span><var>constraint1, constraint2</var><span class="hyp-type"><b>: </b><span>composite_label
‚Üí composite_state * option message
  ‚Üí <span class="kt">Prop</span></span></span></span><br><span><var>X1</var><span><span class="hyp-body"><b>:= </b><span>composite_vlsm constraint1</span></span><span class="hyp-type"><b>: </b><span>VLSM message</span></span></span></span><br><span><var>X2</var><span><span class="hyp-body"><b>:= </b><span>composite_vlsm constraint2</span></span><span class="hyp-type"><b>: </b><span>VLSM message</span></span></span></span><br><span><var>Hpre_subsumption</var><span class="hyp-type"><b>: </b><span>preloaded_constraint_subsumption
  constraint1 constraint2</span></span></span><br><span><var>l</var><span class="hyp-type"><b>: </b><span>label</span></span></span><br><span><var>s</var><span class="hyp-type"><b>: </b><span>state</span></span></span><br><span><var>m</var><span class="hyp-type"><b>: </b><span>message</span></span></span><br><span><var>Hv</var><span class="hyp-type"><b>: </b><span>input_valid
  {|
    vtype := type X1;
    vmachine :=
      pre_loaded_with_all_messages_vlsm_machine
        X1
  |} l (s, Some m)</span></span></span><br><span><var>HsY</var><span class="hyp-type"><b>: </b><span>valid_state_prop
  {|
    vtype := type X1;
    vmachine :=
      pre_loaded_with_all_messages_vlsm_machine
        X2
  |} (id s)</span></span></span><br><span><var>HmX</var><span class="hyp-type"><b>: </b><span>vinitial_message_prop
  {|
    vtype := type X1;
    vmachine :=
      pre_loaded_with_all_messages_vlsm_machine
        X1
  |} m</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">valid_message_prop
  {|
    vtype := type X1;
    vmachine :=
      pre_loaded_with_all_messages_vlsm_machine X2
  |} m</div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="bp">by</span> <span class="nb">apply</span> initial_message_is_valid.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="Composition-v-chk7c" style="display: none" type="checkbox"><label class="alectryon-input" for="Composition-v-chk7c">-</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>message, index</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>EqDecision0</var><span class="hyp-type"><b>: </b><span>EqDecision index</span></span></span><br><span><var>IM</var><span class="hyp-type"><b>: </b><span>index ‚Üí VLSM message</span></span></span><br><span><var>constraint1, constraint2</var><span class="hyp-type"><b>: </b><span>composite_label
‚Üí composite_state * option message
  ‚Üí <span class="kt">Prop</span></span></span></span><br><span><var>X1</var><span><span class="hyp-body"><b>:= </b><span>composite_vlsm constraint1</span></span><span class="hyp-type"><b>: </b><span>VLSM message</span></span></span></span><br><span><var>X2</var><span><span class="hyp-body"><b>:= </b><span>composite_vlsm constraint2</span></span><span class="hyp-type"><b>: </b><span>VLSM message</span></span></span></span><br><span><var>Hpre_subsumption</var><span class="hyp-type"><b>: </b><span>preloaded_constraint_subsumption
  constraint1 constraint2</span></span></span><br><span><var>l</var><span class="hyp-type"><b>: </b><span>label</span></span></span><br><span><var>s</var><span class="hyp-type"><b>: </b><span>state</span></span></span><br><span><var>om</var><span class="hyp-type"><b>: </b><span>option message</span></span></span><br><span><var>Hv</var><span class="hyp-type"><b>: </b><span>input_valid
  {|
    vtype := type X1;
    vmachine :=
      pre_loaded_with_all_messages_vlsm_machine
        X1
  |} l (s, om)</span></span></span><br><span><var>HsY</var><span class="hyp-type"><b>: </b><span>valid_state_prop
  {|
    vtype := type X1;
    vmachine :=
      pre_loaded_with_all_messages_vlsm_machine
        X2
  |} (id s)</span></span></span><br><span><var>HomY</var><span class="hyp-type"><b>: </b><span>option_valid_message_prop
  {|
    vtype := type X1;
    vmachine :=
      pre_loaded_with_all_messages_vlsm_machine
        X2
  |} om</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">vvalid
  {|
    vtype := type X1;
    vmachine :=
      pre_loaded_with_all_messages_vlsm_machine X2
  |} (id l) (id s, om)</div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="bp">by</span> <span class="nb">apply</span> preloaded_constraint_subsumption_input_valid.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Qed</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
</span><span class="alectryon-sentence"><input class="alectryon-toggle" id="Composition-v-chk7d" style="display: none" type="checkbox"><label class="alectryon-input" for="Composition-v-chk7d"><span class="kn">Lemma</span> <span class="nf">weak_constraint_subsumption_weakest</span>
  (<span class="nv">Hsubsumption</span> : input_valid_constraint_subsumption constraint1 constraint2)
  : weak_input_valid_constraint_subsumption constraint1 constraint2.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>message, index</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>EqDecision0</var><span class="hyp-type"><b>: </b><span>EqDecision index</span></span></span><br><span><var>IM</var><span class="hyp-type"><b>: </b><span>index ‚Üí VLSM message</span></span></span><br><span><var>constraint1, constraint2</var><span class="hyp-type"><b>: </b><span>composite_label
‚Üí composite_state * option message
  ‚Üí <span class="kt">Prop</span></span></span></span><br><span><var>X1</var><span><span class="hyp-body"><b>:= </b><span>composite_vlsm constraint1</span></span><span class="hyp-type"><b>: </b><span>VLSM message</span></span></span></span><br><span><var>X2</var><span><span class="hyp-body"><b>:= </b><span>composite_vlsm constraint2</span></span><span class="hyp-type"><b>: </b><span>VLSM message</span></span></span></span><br><span><var>Hsubsumption</var><span class="hyp-type"><b>: </b><span>input_valid_constraint_subsumption
  constraint1 constraint2</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">weak_input_valid_constraint_subsumption constraint1
  constraint2</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="Composition-v-chk7e" style="display: none" type="checkbox"><label class="alectryon-input" for="Composition-v-chk7e"><span class="kn">Proof</span>.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>message, index</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>EqDecision0</var><span class="hyp-type"><b>: </b><span>EqDecision index</span></span></span><br><span><var>IM</var><span class="hyp-type"><b>: </b><span>index ‚Üí VLSM message</span></span></span><br><span><var>constraint1, constraint2</var><span class="hyp-type"><b>: </b><span>composite_label
‚Üí composite_state * option message
  ‚Üí <span class="kt">Prop</span></span></span></span><br><span><var>X1</var><span><span class="hyp-body"><b>:= </b><span>composite_vlsm constraint1</span></span><span class="hyp-type"><b>: </b><span>VLSM message</span></span></span></span><br><span><var>X2</var><span><span class="hyp-body"><b>:= </b><span>composite_vlsm constraint2</span></span><span class="hyp-type"><b>: </b><span>VLSM message</span></span></span></span><br><span><var>Hsubsumption</var><span class="hyp-type"><b>: </b><span>input_valid_constraint_subsumption
  constraint1 constraint2</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">weak_input_valid_constraint_subsumption constraint1
  constraint2</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="Composition-v-chk7f" style="display: none" type="checkbox"><label class="alectryon-input" for="Composition-v-chk7f"><span class="nb">intros</span> l som Hv _ _.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>message, index</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>EqDecision0</var><span class="hyp-type"><b>: </b><span>EqDecision index</span></span></span><br><span><var>IM</var><span class="hyp-type"><b>: </b><span>index ‚Üí VLSM message</span></span></span><br><span><var>constraint1, constraint2</var><span class="hyp-type"><b>: </b><span>composite_label
‚Üí composite_state * option message
  ‚Üí <span class="kt">Prop</span></span></span></span><br><span><var>X1</var><span><span class="hyp-body"><b>:= </b><span>composite_vlsm constraint1</span></span><span class="hyp-type"><b>: </b><span>VLSM message</span></span></span></span><br><span><var>X2</var><span><span class="hyp-body"><b>:= </b><span>composite_vlsm constraint2</span></span><span class="hyp-type"><b>: </b><span>VLSM message</span></span></span></span><br><span><var>Hsubsumption</var><span class="hyp-type"><b>: </b><span>input_valid_constraint_subsumption
  constraint1 constraint2</span></span></span><br><span><var>l</var><span class="hyp-type"><b>: </b><span>composite_label</span></span></span><br><span><var>som</var><span class="hyp-type"><b>: </b><span>(composite_state * option message)%type</span></span></span><br><span><var>Hv</var><span class="hyp-type"><b>: </b><span>input_valid (composite_vlsm constraint1) l som</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">constraint2 l som</div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="nb">auto</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Qed</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
</span><span class="alectryon-sentence"><input class="alectryon-toggle" id="Composition-v-chk80" style="display: none" type="checkbox"><label class="alectryon-input" for="Composition-v-chk80"><span class="kn">Lemma</span> <span class="nf">preloaded_constraint_subsumption_stronger</span>
  (<span class="nv">Hpre_subsumption</span> : preloaded_constraint_subsumption constraint1 constraint2)
  : input_valid_constraint_subsumption constraint1 constraint2.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>message, index</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>EqDecision0</var><span class="hyp-type"><b>: </b><span>EqDecision index</span></span></span><br><span><var>IM</var><span class="hyp-type"><b>: </b><span>index ‚Üí VLSM message</span></span></span><br><span><var>constraint1, constraint2</var><span class="hyp-type"><b>: </b><span>composite_label
‚Üí composite_state * option message
  ‚Üí <span class="kt">Prop</span></span></span></span><br><span><var>X1</var><span><span class="hyp-body"><b>:= </b><span>composite_vlsm constraint1</span></span><span class="hyp-type"><b>: </b><span>VLSM message</span></span></span></span><br><span><var>X2</var><span><span class="hyp-body"><b>:= </b><span>composite_vlsm constraint2</span></span><span class="hyp-type"><b>: </b><span>VLSM message</span></span></span></span><br><span><var>Hpre_subsumption</var><span class="hyp-type"><b>: </b><span>preloaded_constraint_subsumption
  constraint1 constraint2</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">input_valid_constraint_subsumption constraint1
  constraint2</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="Composition-v-chk81" style="display: none" type="checkbox"><label class="alectryon-input" for="Composition-v-chk81"><span class="kn">Proof</span>.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>message, index</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>EqDecision0</var><span class="hyp-type"><b>: </b><span>EqDecision index</span></span></span><br><span><var>IM</var><span class="hyp-type"><b>: </b><span>index ‚Üí VLSM message</span></span></span><br><span><var>constraint1, constraint2</var><span class="hyp-type"><b>: </b><span>composite_label
‚Üí composite_state * option message
  ‚Üí <span class="kt">Prop</span></span></span></span><br><span><var>X1</var><span><span class="hyp-body"><b>:= </b><span>composite_vlsm constraint1</span></span><span class="hyp-type"><b>: </b><span>VLSM message</span></span></span></span><br><span><var>X2</var><span><span class="hyp-body"><b>:= </b><span>composite_vlsm constraint2</span></span><span class="hyp-type"><b>: </b><span>VLSM message</span></span></span></span><br><span><var>Hpre_subsumption</var><span class="hyp-type"><b>: </b><span>preloaded_constraint_subsumption
  constraint1 constraint2</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">input_valid_constraint_subsumption constraint1
  constraint2</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="Composition-v-chk82" style="display: none" type="checkbox"><label class="alectryon-input" for="Composition-v-chk82"><span class="nb">intros</span> l som Hv.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>message, index</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>EqDecision0</var><span class="hyp-type"><b>: </b><span>EqDecision index</span></span></span><br><span><var>IM</var><span class="hyp-type"><b>: </b><span>index ‚Üí VLSM message</span></span></span><br><span><var>constraint1, constraint2</var><span class="hyp-type"><b>: </b><span>composite_label
‚Üí composite_state * option message
  ‚Üí <span class="kt">Prop</span></span></span></span><br><span><var>X1</var><span><span class="hyp-body"><b>:= </b><span>composite_vlsm constraint1</span></span><span class="hyp-type"><b>: </b><span>VLSM message</span></span></span></span><br><span><var>X2</var><span><span class="hyp-body"><b>:= </b><span>composite_vlsm constraint2</span></span><span class="hyp-type"><b>: </b><span>VLSM message</span></span></span></span><br><span><var>Hpre_subsumption</var><span class="hyp-type"><b>: </b><span>preloaded_constraint_subsumption
  constraint1 constraint2</span></span></span><br><span><var>l</var><span class="hyp-type"><b>: </b><span>composite_label</span></span></span><br><span><var>som</var><span class="hyp-type"><b>: </b><span>(composite_state * option message)%type</span></span></span><br><span><var>Hv</var><span class="hyp-type"><b>: </b><span>input_valid (composite_vlsm constraint1) l som</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">constraint2 l som</div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="Composition-v-chk83" style="display: none" type="checkbox"><label class="alectryon-input" for="Composition-v-chk83"><span class="nb">apply</span> (Hpre_subsumption l som).</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>message, index</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>EqDecision0</var><span class="hyp-type"><b>: </b><span>EqDecision index</span></span></span><br><span><var>IM</var><span class="hyp-type"><b>: </b><span>index ‚Üí VLSM message</span></span></span><br><span><var>constraint1, constraint2</var><span class="hyp-type"><b>: </b><span>composite_label
‚Üí composite_state * option message
  ‚Üí <span class="kt">Prop</span></span></span></span><br><span><var>X1</var><span><span class="hyp-body"><b>:= </b><span>composite_vlsm constraint1</span></span><span class="hyp-type"><b>: </b><span>VLSM message</span></span></span></span><br><span><var>X2</var><span><span class="hyp-body"><b>:= </b><span>composite_vlsm constraint2</span></span><span class="hyp-type"><b>: </b><span>VLSM message</span></span></span></span><br><span><var>Hpre_subsumption</var><span class="hyp-type"><b>: </b><span>preloaded_constraint_subsumption
  constraint1 constraint2</span></span></span><br><span><var>l</var><span class="hyp-type"><b>: </b><span>composite_label</span></span></span><br><span><var>som</var><span class="hyp-type"><b>: </b><span>(composite_state * option message)%type</span></span></span><br><span><var>Hv</var><span class="hyp-type"><b>: </b><span>input_valid (composite_vlsm constraint1) l som</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">input_valid
  (pre_loaded_with_all_messages_vlsm
     (composite_vlsm constraint1)) l som</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="Composition-v-chk84" style="display: none" type="checkbox"><label class="alectryon-input" for="Composition-v-chk84"><span class="nb">destruct</span> som.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>message, index</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>EqDecision0</var><span class="hyp-type"><b>: </b><span>EqDecision index</span></span></span><br><span><var>IM</var><span class="hyp-type"><b>: </b><span>index ‚Üí VLSM message</span></span></span><br><span><var>constraint1, constraint2</var><span class="hyp-type"><b>: </b><span>composite_label
‚Üí composite_state * option message
  ‚Üí <span class="kt">Prop</span></span></span></span><br><span><var>X1</var><span><span class="hyp-body"><b>:= </b><span>composite_vlsm constraint1</span></span><span class="hyp-type"><b>: </b><span>VLSM message</span></span></span></span><br><span><var>X2</var><span><span class="hyp-body"><b>:= </b><span>composite_vlsm constraint2</span></span><span class="hyp-type"><b>: </b><span>VLSM message</span></span></span></span><br><span><var>Hpre_subsumption</var><span class="hyp-type"><b>: </b><span>preloaded_constraint_subsumption
  constraint1 constraint2</span></span></span><br><span><var>l</var><span class="hyp-type"><b>: </b><span>composite_label</span></span></span><br><span><var>c</var><span class="hyp-type"><b>: </b><span>composite_state</span></span></span><br><span><var>o</var><span class="hyp-type"><b>: </b><span>option message</span></span></span><br><span><var>Hv</var><span class="hyp-type"><b>: </b><span>input_valid (composite_vlsm constraint1) l (c, o)</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">input_valid
  (pre_loaded_with_all_messages_vlsm
     (composite_vlsm constraint1)) l (c, o)</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="Composition-v-chk85" style="display: none" type="checkbox"><label class="alectryon-input" for="Composition-v-chk85"><span class="nb">revert</span> Hv.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>message, index</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>EqDecision0</var><span class="hyp-type"><b>: </b><span>EqDecision index</span></span></span><br><span><var>IM</var><span class="hyp-type"><b>: </b><span>index ‚Üí VLSM message</span></span></span><br><span><var>constraint1, constraint2</var><span class="hyp-type"><b>: </b><span>composite_label
‚Üí composite_state * option message
  ‚Üí <span class="kt">Prop</span></span></span></span><br><span><var>X1</var><span><span class="hyp-body"><b>:= </b><span>composite_vlsm constraint1</span></span><span class="hyp-type"><b>: </b><span>VLSM message</span></span></span></span><br><span><var>X2</var><span><span class="hyp-body"><b>:= </b><span>composite_vlsm constraint2</span></span><span class="hyp-type"><b>: </b><span>VLSM message</span></span></span></span><br><span><var>Hpre_subsumption</var><span class="hyp-type"><b>: </b><span>preloaded_constraint_subsumption
  constraint1 constraint2</span></span></span><br><span><var>l</var><span class="hyp-type"><b>: </b><span>composite_label</span></span></span><br><span><var>c</var><span class="hyp-type"><b>: </b><span>composite_state</span></span></span><br><span><var>o</var><span class="hyp-type"><b>: </b><span>option message</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">input_valid (composite_vlsm constraint1) l (c, o)
‚Üí input_valid
    (pre_loaded_with_all_messages_vlsm
       (composite_vlsm constraint1)) l (c, o)</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><span class="alectryon-input"><span class="nb">apply</span> (VLSM_incl_input_valid (vlsm_incl_pre_loaded_with_all_messages_vlsm (composite_vlsm constraint1))).</span><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Qed</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
</span><span class="alectryon-sentence"><input class="alectryon-toggle" id="Composition-v-chk86" style="display: none" type="checkbox"><label class="alectryon-input" for="Composition-v-chk86"><span class="kn">Lemma</span> <span class="nf">strong_constraint_subsumption_strongest</span>
  (<span class="nv">Hstrong_subsumption</span> : strong_constraint_subsumption constraint1 constraint2)
  : preloaded_constraint_subsumption constraint1 constraint2.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>message, index</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>EqDecision0</var><span class="hyp-type"><b>: </b><span>EqDecision index</span></span></span><br><span><var>IM</var><span class="hyp-type"><b>: </b><span>index ‚Üí VLSM message</span></span></span><br><span><var>constraint1, constraint2</var><span class="hyp-type"><b>: </b><span>composite_label
‚Üí composite_state * option message
  ‚Üí <span class="kt">Prop</span></span></span></span><br><span><var>X1</var><span><span class="hyp-body"><b>:= </b><span>composite_vlsm constraint1</span></span><span class="hyp-type"><b>: </b><span>VLSM message</span></span></span></span><br><span><var>X2</var><span><span class="hyp-body"><b>:= </b><span>composite_vlsm constraint2</span></span><span class="hyp-type"><b>: </b><span>VLSM message</span></span></span></span><br><span><var>Hstrong_subsumption</var><span class="hyp-type"><b>: </b><span>strong_constraint_subsumption
  constraint1 constraint2</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">preloaded_constraint_subsumption constraint1
  constraint2</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="Composition-v-chk87" style="display: none" type="checkbox"><label class="alectryon-input" for="Composition-v-chk87"><span class="kn">Proof</span>.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>message, index</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>EqDecision0</var><span class="hyp-type"><b>: </b><span>EqDecision index</span></span></span><br><span><var>IM</var><span class="hyp-type"><b>: </b><span>index ‚Üí VLSM message</span></span></span><br><span><var>constraint1, constraint2</var><span class="hyp-type"><b>: </b><span>composite_label
‚Üí composite_state * option message
  ‚Üí <span class="kt">Prop</span></span></span></span><br><span><var>X1</var><span><span class="hyp-body"><b>:= </b><span>composite_vlsm constraint1</span></span><span class="hyp-type"><b>: </b><span>VLSM message</span></span></span></span><br><span><var>X2</var><span><span class="hyp-body"><b>:= </b><span>composite_vlsm constraint2</span></span><span class="hyp-type"><b>: </b><span>VLSM message</span></span></span></span><br><span><var>Hstrong_subsumption</var><span class="hyp-type"><b>: </b><span>strong_constraint_subsumption
  constraint1 constraint2</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">preloaded_constraint_subsumption constraint1
  constraint2</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="Composition-v-chk88" style="display: none" type="checkbox"><label class="alectryon-input" for="Composition-v-chk88"><span class="nb">intros</span> l (s, om) [_ [_ [_ Hc]]].</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>message, index</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>EqDecision0</var><span class="hyp-type"><b>: </b><span>EqDecision index</span></span></span><br><span><var>IM</var><span class="hyp-type"><b>: </b><span>index ‚Üí VLSM message</span></span></span><br><span><var>constraint1, constraint2</var><span class="hyp-type"><b>: </b><span>composite_label
‚Üí composite_state * option message
  ‚Üí <span class="kt">Prop</span></span></span></span><br><span><var>X1</var><span><span class="hyp-body"><b>:= </b><span>composite_vlsm constraint1</span></span><span class="hyp-type"><b>: </b><span>VLSM message</span></span></span></span><br><span><var>X2</var><span><span class="hyp-body"><b>:= </b><span>composite_vlsm constraint2</span></span><span class="hyp-type"><b>: </b><span>VLSM message</span></span></span></span><br><span><var>Hstrong_subsumption</var><span class="hyp-type"><b>: </b><span>strong_constraint_subsumption
  constraint1 constraint2</span></span></span><br><span><var>l</var><span class="hyp-type"><b>: </b><span>composite_label</span></span></span><br><span><var>s</var><span class="hyp-type"><b>: </b><span>state</span></span></span><br><span><var>om</var><span class="hyp-type"><b>: </b><span>option message</span></span></span><br><span><var>Hc</var><span class="hyp-type"><b>: </b><span>constraint1 l (s, om)</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">constraint2 l (s, om)</div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="Composition-v-chk89" style="display: none" type="checkbox"><label class="alectryon-input" for="Composition-v-chk89"><span class="nb">revert</span> Hc.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>message, index</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>EqDecision0</var><span class="hyp-type"><b>: </b><span>EqDecision index</span></span></span><br><span><var>IM</var><span class="hyp-type"><b>: </b><span>index ‚Üí VLSM message</span></span></span><br><span><var>constraint1, constraint2</var><span class="hyp-type"><b>: </b><span>composite_label
‚Üí composite_state * option message
  ‚Üí <span class="kt">Prop</span></span></span></span><br><span><var>X1</var><span><span class="hyp-body"><b>:= </b><span>composite_vlsm constraint1</span></span><span class="hyp-type"><b>: </b><span>VLSM message</span></span></span></span><br><span><var>X2</var><span><span class="hyp-body"><b>:= </b><span>composite_vlsm constraint2</span></span><span class="hyp-type"><b>: </b><span>VLSM message</span></span></span></span><br><span><var>Hstrong_subsumption</var><span class="hyp-type"><b>: </b><span>strong_constraint_subsumption
  constraint1 constraint2</span></span></span><br><span><var>l</var><span class="hyp-type"><b>: </b><span>composite_label</span></span></span><br><span><var>s</var><span class="hyp-type"><b>: </b><span>state</span></span></span><br><span><var>om</var><span class="hyp-type"><b>: </b><span>option message</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">constraint1 l (s, om) ‚Üí constraint2 l (s, om)</div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="nb">apply</span> Hstrong_subsumption.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Qed</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
</span><span class="alectryon-sentence"><input class="alectryon-toggle" id="Composition-v-chk8a" style="display: none" type="checkbox"><label class="alectryon-input" for="Composition-v-chk8a"><span class="kn">Lemma</span> <span class="nf">constraint_subsumption_byzantine_message_prop</span>
  (<span class="nv">Hpre_subsumption</span> : preloaded_constraint_subsumption constraint1 constraint2)
  (<span class="nv">m</span> : message)
  (<span class="nv">Hm</span> : byzantine_message_prop X1 m)
  : byzantine_message_prop X2 m.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>message, index</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>EqDecision0</var><span class="hyp-type"><b>: </b><span>EqDecision index</span></span></span><br><span><var>IM</var><span class="hyp-type"><b>: </b><span>index ‚Üí VLSM message</span></span></span><br><span><var>constraint1, constraint2</var><span class="hyp-type"><b>: </b><span>composite_label
‚Üí composite_state * option message
  ‚Üí <span class="kt">Prop</span></span></span></span><br><span><var>X1</var><span><span class="hyp-body"><b>:= </b><span>composite_vlsm constraint1</span></span><span class="hyp-type"><b>: </b><span>VLSM message</span></span></span></span><br><span><var>X2</var><span><span class="hyp-body"><b>:= </b><span>composite_vlsm constraint2</span></span><span class="hyp-type"><b>: </b><span>VLSM message</span></span></span></span><br><span><var>Hpre_subsumption</var><span class="hyp-type"><b>: </b><span>preloaded_constraint_subsumption
  constraint1 constraint2</span></span></span><br><span><var>m</var><span class="hyp-type"><b>: </b><span>message</span></span></span><br><span><var>Hm</var><span class="hyp-type"><b>: </b><span>byzantine_message_prop X1 m</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">byzantine_message_prop X2 m</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="Composition-v-chk8b" style="display: none" type="checkbox"><label class="alectryon-input" for="Composition-v-chk8b"><span class="kn">Proof</span>.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>message, index</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>EqDecision0</var><span class="hyp-type"><b>: </b><span>EqDecision index</span></span></span><br><span><var>IM</var><span class="hyp-type"><b>: </b><span>index ‚Üí VLSM message</span></span></span><br><span><var>constraint1, constraint2</var><span class="hyp-type"><b>: </b><span>composite_label
‚Üí composite_state * option message
  ‚Üí <span class="kt">Prop</span></span></span></span><br><span><var>X1</var><span><span class="hyp-body"><b>:= </b><span>composite_vlsm constraint1</span></span><span class="hyp-type"><b>: </b><span>VLSM message</span></span></span></span><br><span><var>X2</var><span><span class="hyp-body"><b>:= </b><span>composite_vlsm constraint2</span></span><span class="hyp-type"><b>: </b><span>VLSM message</span></span></span></span><br><span><var>Hpre_subsumption</var><span class="hyp-type"><b>: </b><span>preloaded_constraint_subsumption
  constraint1 constraint2</span></span></span><br><span><var>m</var><span class="hyp-type"><b>: </b><span>message</span></span></span><br><span><var>Hm</var><span class="hyp-type"><b>: </b><span>byzantine_message_prop X1 m</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">byzantine_message_prop X2 m</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="Composition-v-chk8c" style="display: none" type="checkbox"><label class="alectryon-input" for="Composition-v-chk8c"><span class="nb">revert</span> Hm.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>message, index</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>EqDecision0</var><span class="hyp-type"><b>: </b><span>EqDecision index</span></span></span><br><span><var>IM</var><span class="hyp-type"><b>: </b><span>index ‚Üí VLSM message</span></span></span><br><span><var>constraint1, constraint2</var><span class="hyp-type"><b>: </b><span>composite_label
‚Üí composite_state * option message
  ‚Üí <span class="kt">Prop</span></span></span></span><br><span><var>X1</var><span><span class="hyp-body"><b>:= </b><span>composite_vlsm constraint1</span></span><span class="hyp-type"><b>: </b><span>VLSM message</span></span></span></span><br><span><var>X2</var><span><span class="hyp-body"><b>:= </b><span>composite_vlsm constraint2</span></span><span class="hyp-type"><b>: </b><span>VLSM message</span></span></span></span><br><span><var>Hpre_subsumption</var><span class="hyp-type"><b>: </b><span>preloaded_constraint_subsumption
  constraint1 constraint2</span></span></span><br><span><var>m</var><span class="hyp-type"><b>: </b><span>message</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">byzantine_message_prop X1 m
‚Üí byzantine_message_prop X2 m</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><span class="alectryon-input"><span class="nb">apply</span> (VLSM_incl_can_emit (preloaded_constraint_subsumption_incl Hpre_subsumption)).</span><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Qed</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
<span class="c">(* end hide *)</span>
</span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">End</span> <span class="nf">sec_constraint_subsumption</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
</span><span class="alectryon-sentence"><input class="alectryon-toggle" id="Composition-v-chk8d" style="display: none" type="checkbox"><label class="alectryon-input" for="Composition-v-chk8d"><span class="kn">Lemma</span> <span class="nf">preloaded_constraint_free_incl</span>
  (<span class="nv">constraint</span> : composite_label -&gt; composite_state  * option message -&gt; <span class="kt">Prop</span>)
  : VLSM_incl (pre_loaded_with_all_messages_vlsm (composite_vlsm constraint)) (pre_loaded_with_all_messages_vlsm free_composite_vlsm).</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>message, index</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>EqDecision0</var><span class="hyp-type"><b>: </b><span>EqDecision index</span></span></span><br><span><var>IM</var><span class="hyp-type"><b>: </b><span>index ‚Üí VLSM message</span></span></span><br><span><var>constraint</var><span class="hyp-type"><b>: </b><span>composite_label
‚Üí composite_state * option message ‚Üí <span class="kt">Prop</span></span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">VLSM_incl
  (pre_loaded_with_all_messages_vlsm
     (composite_vlsm constraint))
  (pre_loaded_with_all_messages_vlsm
     free_composite_vlsm)</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="Composition-v-chk8e" style="display: none" type="checkbox"><label class="alectryon-input" for="Composition-v-chk8e"><span class="kn">Proof</span>.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>message, index</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>EqDecision0</var><span class="hyp-type"><b>: </b><span>EqDecision index</span></span></span><br><span><var>IM</var><span class="hyp-type"><b>: </b><span>index ‚Üí VLSM message</span></span></span><br><span><var>constraint</var><span class="hyp-type"><b>: </b><span>composite_label
‚Üí composite_state * option message ‚Üí <span class="kt">Prop</span></span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">VLSM_incl
  (pre_loaded_with_all_messages_vlsm
     (composite_vlsm constraint))
  (pre_loaded_with_all_messages_vlsm
     free_composite_vlsm)</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><span class="alectryon-input"><span class="bp">by</span> <span class="nb">apply</span> preloaded_constraint_subsumption_incl.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Qed</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
<span class="c">(* TODO(traiansf): There are many places where, because the lemma below</span>
<span class="c">  was missing, it was either reproved locally, or multiple VLSM_incl_</span>
<span class="c">  lemmas were used to achieve a similar result. It would be nice to</span>
<span class="c">  find those usages and use this lemma instad.</span>
<span class="c">*)</span>
</span><span class="alectryon-sentence"><input class="alectryon-toggle" id="Composition-v-chk8f" style="display: none" type="checkbox"><label class="alectryon-input" for="Composition-v-chk8f"><span class="kn">Lemma</span> <span class="nf">constraint_preloaded_free_incl</span>
  (<span class="nv">constraint</span> : composite_label -&gt; composite_state  * option message -&gt; <span class="kt">Prop</span>)
  : VLSM_incl (composite_vlsm constraint) (pre_loaded_with_all_messages_vlsm free_composite_vlsm).</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>message, index</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>EqDecision0</var><span class="hyp-type"><b>: </b><span>EqDecision index</span></span></span><br><span><var>IM</var><span class="hyp-type"><b>: </b><span>index ‚Üí VLSM message</span></span></span><br><span><var>constraint</var><span class="hyp-type"><b>: </b><span>composite_label
‚Üí composite_state * option message ‚Üí <span class="kt">Prop</span></span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">VLSM_incl (composite_vlsm constraint)
  (pre_loaded_with_all_messages_vlsm
     free_composite_vlsm)</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="Composition-v-chk90" style="display: none" type="checkbox"><label class="alectryon-input" for="Composition-v-chk90"><span class="kn">Proof</span>.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>message, index</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>EqDecision0</var><span class="hyp-type"><b>: </b><span>EqDecision index</span></span></span><br><span><var>IM</var><span class="hyp-type"><b>: </b><span>index ‚Üí VLSM message</span></span></span><br><span><var>constraint</var><span class="hyp-type"><b>: </b><span>composite_label
‚Üí composite_state * option message ‚Üí <span class="kt">Prop</span></span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">VLSM_incl (composite_vlsm constraint)
  (pre_loaded_with_all_messages_vlsm
     free_composite_vlsm)</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="Composition-v-chk91" style="display: none" type="checkbox"><label class="alectryon-input" for="Composition-v-chk91"><span class="nb">eapply</span> VLSM_incl_trans.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>message, index</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>EqDecision0</var><span class="hyp-type"><b>: </b><span>EqDecision index</span></span></span><br><span><var>IM</var><span class="hyp-type"><b>: </b><span>index ‚Üí VLSM message</span></span></span><br><span><var>constraint</var><span class="hyp-type"><b>: </b><span>composite_label
‚Üí composite_state * option message ‚Üí <span class="kt">Prop</span></span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">VLSM_incl
  {|
    vtype := vtype (composite_vlsm constraint);
    vmachine := composite_vlsm_machine constraint
  |}
  {|
    vtype := vtype (composite_vlsm constraint);
    vmachine := <span class="nl">?MY</span>
  |}</div></blockquote><div class="alectryon-extra-goals"><input class="alectryon-extra-goal-toggle" id="Composition-v-chk92" style="display: none" type="checkbox"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>message, index</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>EqDecision0</var><span class="hyp-type"><b>: </b><span>EqDecision index</span></span></span><br><span><var>IM</var><span class="hyp-type"><b>: </b><span>index ‚Üí VLSM message</span></span></span><br><span><var>constraint</var><span class="hyp-type"><b>: </b><span>composite_label
‚Üí composite_state * option message ‚Üí <span class="kt">Prop</span></span></span></span><br></div><label class="goal-separator" for="Composition-v-chk92"><hr></label><div class="goal-conclusion">VLSM_incl
  {|
    vtype := vtype (composite_vlsm constraint);
    vmachine := <span class="nl">?MY</span>
  |}
  {|
    vtype := vtype (composite_vlsm constraint);
    vmachine :=
      pre_loaded_with_all_messages_vlsm_machine
        free_composite_vlsm
  |}</div></blockquote></div></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="Composition-v-chk93" style="display: none" type="checkbox"><label class="alectryon-input" for="Composition-v-chk93">-</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>message, index</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>EqDecision0</var><span class="hyp-type"><b>: </b><span>EqDecision index</span></span></span><br><span><var>IM</var><span class="hyp-type"><b>: </b><span>index ‚Üí VLSM message</span></span></span><br><span><var>constraint</var><span class="hyp-type"><b>: </b><span>composite_label
‚Üí composite_state * option message ‚Üí <span class="kt">Prop</span></span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">VLSM_incl
  {|
    vtype := vtype (composite_vlsm constraint);
    vmachine := composite_vlsm_machine constraint
  |}
  {|
    vtype := vtype (composite_vlsm constraint);
    vmachine := <span class="nl">?MY</span>
  |}</div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="nb">apply</span> vlsm_incl_pre_loaded_with_all_messages_vlsm.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="Composition-v-chk94" style="display: none" type="checkbox"><label class="alectryon-input" for="Composition-v-chk94">-</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>message, index</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>EqDecision0</var><span class="hyp-type"><b>: </b><span>EqDecision index</span></span></span><br><span><var>IM</var><span class="hyp-type"><b>: </b><span>index ‚Üí VLSM message</span></span></span><br><span><var>constraint</var><span class="hyp-type"><b>: </b><span>composite_label
‚Üí composite_state * option message ‚Üí <span class="kt">Prop</span></span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">VLSM_incl
  {|
    vtype := vtype (composite_vlsm constraint);
    vmachine :=
      pre_loaded_with_all_messages_vlsm_machine
        (composite_vlsm constraint)
  |}
  {|
    vtype := vtype (composite_vlsm constraint);
    vmachine :=
      pre_loaded_with_all_messages_vlsm_machine
        free_composite_vlsm
  |}</div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="nb">apply</span> preloaded_constraint_free_incl.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Qed</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
</span><span class="alectryon-sentence"><input class="alectryon-toggle" id="Composition-v-chk95" style="display: none" type="checkbox"><label class="alectryon-input" for="Composition-v-chk95"><span class="kn">Lemma</span> <span class="nf">lift_to_composite_generalized_preloaded_vlsm_full_projection</span>
  (<span class="nv">P</span> <span class="nv">Q</span> : message -&gt; <span class="kt">Prop</span>)
  (<span class="nv">PimpliesQ</span> : <span class="kr">forall</span> <span class="nv">m</span>, P m -&gt; Q m)
  (<span class="nv">j</span> : index)
  : VLSM_full_projection (pre_loaded_vlsm (IM j) P) (pre_loaded_vlsm free_composite_vlsm Q) (lift_to_composite_label j) (lift_to_composite_state&#39; j).</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>message, index</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>EqDecision0</var><span class="hyp-type"><b>: </b><span>EqDecision index</span></span></span><br><span><var>IM</var><span class="hyp-type"><b>: </b><span>index ‚Üí VLSM message</span></span></span><br><span><var>P, Q</var><span class="hyp-type"><b>: </b><span>message ‚Üí <span class="kt">Prop</span></span></span></span><br><span><var>PimpliesQ</var><span class="hyp-type"><b>: </b><span><span class="kr">‚àÄ</span> <span class="nv">m</span> : message, P m ‚Üí Q m</span></span></span><br><span><var>j</var><span class="hyp-type"><b>: </b><span>index</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">VLSM_full_projection (pre_loaded_vlsm (IM j) P)
  (pre_loaded_vlsm free_composite_vlsm Q)
  (lift_to_composite_label j)
  (lift_to_composite_state&#39; j)</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="Composition-v-chk96" style="display: none" type="checkbox"><label class="alectryon-input" for="Composition-v-chk96"><span class="kn">Proof</span>.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>message, index</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>EqDecision0</var><span class="hyp-type"><b>: </b><span>EqDecision index</span></span></span><br><span><var>IM</var><span class="hyp-type"><b>: </b><span>index ‚Üí VLSM message</span></span></span><br><span><var>P, Q</var><span class="hyp-type"><b>: </b><span>message ‚Üí <span class="kt">Prop</span></span></span></span><br><span><var>PimpliesQ</var><span class="hyp-type"><b>: </b><span><span class="kr">‚àÄ</span> <span class="nv">m</span> : message, P m ‚Üí Q m</span></span></span><br><span><var>j</var><span class="hyp-type"><b>: </b><span>index</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">VLSM_full_projection (pre_loaded_vlsm (IM j) P)
  (pre_loaded_vlsm free_composite_vlsm Q)
  (lift_to_composite_label j)
  (lift_to_composite_state&#39; j)</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="Composition-v-chk97" style="display: none" type="checkbox"><label class="alectryon-input" for="Composition-v-chk97"><span class="nb">apply</span> basic_VLSM_full_projection_preloaded_with; <span class="nb">intro</span>; <span class="nb">intros</span>.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>message, index</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>EqDecision0</var><span class="hyp-type"><b>: </b><span>EqDecision index</span></span></span><br><span><var>IM</var><span class="hyp-type"><b>: </b><span>index ‚Üí VLSM message</span></span></span><br><span><var>P, Q</var><span class="hyp-type"><b>: </b><span>message ‚Üí <span class="kt">Prop</span></span></span></span><br><span><var>PimpliesQ</var><span class="hyp-type"><b>: </b><span><span class="kr">‚àÄ</span> <span class="nv">m</span> : message, P m ‚Üí Q m</span></span></span><br><span><var>j</var><span class="hyp-type"><b>: </b><span>index</span></span></span><br><span><var>m</var><span class="hyp-type"><b>: </b><span>message</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>P m</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">Q m</div></blockquote><div class="alectryon-extra-goals"><input class="alectryon-extra-goal-toggle" id="Composition-v-chk98" style="display: none" type="checkbox"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>message, index</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>EqDecision0</var><span class="hyp-type"><b>: </b><span>EqDecision index</span></span></span><br><span><var>IM</var><span class="hyp-type"><b>: </b><span>index ‚Üí VLSM message</span></span></span><br><span><var>P, Q</var><span class="hyp-type"><b>: </b><span>message ‚Üí <span class="kt">Prop</span></span></span></span><br><span><var>PimpliesQ</var><span class="hyp-type"><b>: </b><span><span class="kr">‚àÄ</span> <span class="nv">m</span> : message, P m ‚Üí Q m</span></span></span><br><span><var>j</var><span class="hyp-type"><b>: </b><span>index</span></span></span><br><span><var>l</var><span class="hyp-type"><b>: </b><span>label</span></span></span><br><span><var>s</var><span class="hyp-type"><b>: </b><span>state</span></span></span><br><span><var>om</var><span class="hyp-type"><b>: </b><span>option message</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>vvalid (IM j) l (s, om)</span></span></span><br></div><label class="goal-separator" for="Composition-v-chk98"><hr></label><div class="goal-conclusion">vvalid free_composite_vlsm
  (lift_to_composite_label j l)
  (lift_to_composite_state&#39; j s, om)</div></blockquote><input class="alectryon-extra-goal-toggle" id="Composition-v-chk99" style="display: none" type="checkbox"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>message, index</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>EqDecision0</var><span class="hyp-type"><b>: </b><span>EqDecision index</span></span></span><br><span><var>IM</var><span class="hyp-type"><b>: </b><span>index ‚Üí VLSM message</span></span></span><br><span><var>P, Q</var><span class="hyp-type"><b>: </b><span>message ‚Üí <span class="kt">Prop</span></span></span></span><br><span><var>PimpliesQ</var><span class="hyp-type"><b>: </b><span><span class="kr">‚àÄ</span> <span class="nv">m</span> : message, P m ‚Üí Q m</span></span></span><br><span><var>j</var><span class="hyp-type"><b>: </b><span>index</span></span></span><br><span><var>l</var><span class="hyp-type"><b>: </b><span>label</span></span></span><br><span><var>s</var><span class="hyp-type"><b>: </b><span>state</span></span></span><br><span><var>om</var><span class="hyp-type"><b>: </b><span>option message</span></span></span><br><span><var>s'</var><span class="hyp-type"><b>: </b><span>state</span></span></span><br><span><var>om'</var><span class="hyp-type"><b>: </b><span>option message</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>vtransition (IM j) l (s, om) = (s&#39;, om&#39;)</span></span></span><br></div><label class="goal-separator" for="Composition-v-chk99"><hr></label><div class="goal-conclusion">vtransition free_composite_vlsm
  (lift_to_composite_label j l)
  (lift_to_composite_state&#39; j s, om) =
(lift_to_composite_state&#39; j s&#39;, om&#39;)</div></blockquote><input class="alectryon-extra-goal-toggle" id="Composition-v-chk9a" style="display: none" type="checkbox"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>message, index</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>EqDecision0</var><span class="hyp-type"><b>: </b><span>EqDecision index</span></span></span><br><span><var>IM</var><span class="hyp-type"><b>: </b><span>index ‚Üí VLSM message</span></span></span><br><span><var>P, Q</var><span class="hyp-type"><b>: </b><span>message ‚Üí <span class="kt">Prop</span></span></span></span><br><span><var>PimpliesQ</var><span class="hyp-type"><b>: </b><span><span class="kr">‚àÄ</span> <span class="nv">m</span> : message, P m ‚Üí Q m</span></span></span><br><span><var>j</var><span class="hyp-type"><b>: </b><span>index</span></span></span><br><span><var>s</var><span class="hyp-type"><b>: </b><span>state</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>vinitial_state_prop (IM j) s</span></span></span><br></div><label class="goal-separator" for="Composition-v-chk9a"><hr></label><div class="goal-conclusion">vinitial_state_prop free_composite_vlsm
  (lift_to_composite_state&#39; j s)</div></blockquote><input class="alectryon-extra-goal-toggle" id="Composition-v-chk9b" style="display: none" type="checkbox"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>message, index</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>EqDecision0</var><span class="hyp-type"><b>: </b><span>EqDecision index</span></span></span><br><span><var>IM</var><span class="hyp-type"><b>: </b><span>index ‚Üí VLSM message</span></span></span><br><span><var>P, Q</var><span class="hyp-type"><b>: </b><span>message ‚Üí <span class="kt">Prop</span></span></span></span><br><span><var>PimpliesQ</var><span class="hyp-type"><b>: </b><span><span class="kr">‚àÄ</span> <span class="nv">m</span> : message, P m ‚Üí Q m</span></span></span><br><span><var>j</var><span class="hyp-type"><b>: </b><span>index</span></span></span><br><span><var>m</var><span class="hyp-type"><b>: </b><span>message</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>vinitial_message_prop (IM j) m</span></span></span><br></div><label class="goal-separator" for="Composition-v-chk9b"><hr></label><div class="goal-conclusion">vinitial_message_prop free_composite_vlsm m</div></blockquote></div></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="Composition-v-chk9c" style="display: none" type="checkbox"><label class="alectryon-input" for="Composition-v-chk9c">-</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>message, index</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>EqDecision0</var><span class="hyp-type"><b>: </b><span>EqDecision index</span></span></span><br><span><var>IM</var><span class="hyp-type"><b>: </b><span>index ‚Üí VLSM message</span></span></span><br><span><var>P, Q</var><span class="hyp-type"><b>: </b><span>message ‚Üí <span class="kt">Prop</span></span></span></span><br><span><var>PimpliesQ</var><span class="hyp-type"><b>: </b><span><span class="kr">‚àÄ</span> <span class="nv">m</span> : message, P m ‚Üí Q m</span></span></span><br><span><var>j</var><span class="hyp-type"><b>: </b><span>index</span></span></span><br><span><var>m</var><span class="hyp-type"><b>: </b><span>message</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>P m</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">Q m</div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="bp">by</span> <span class="nb">apply</span> PimpliesQ.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="Composition-v-chk9d" style="display: none" type="checkbox"><label class="alectryon-input" for="Composition-v-chk9d">-</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>message, index</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>EqDecision0</var><span class="hyp-type"><b>: </b><span>EqDecision index</span></span></span><br><span><var>IM</var><span class="hyp-type"><b>: </b><span>index ‚Üí VLSM message</span></span></span><br><span><var>P, Q</var><span class="hyp-type"><b>: </b><span>message ‚Üí <span class="kt">Prop</span></span></span></span><br><span><var>PimpliesQ</var><span class="hyp-type"><b>: </b><span><span class="kr">‚àÄ</span> <span class="nv">m</span> : message, P m ‚Üí Q m</span></span></span><br><span><var>j</var><span class="hyp-type"><b>: </b><span>index</span></span></span><br><span><var>l</var><span class="hyp-type"><b>: </b><span>label</span></span></span><br><span><var>s</var><span class="hyp-type"><b>: </b><span>state</span></span></span><br><span><var>om</var><span class="hyp-type"><b>: </b><span>option message</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>vvalid (IM j) l (s, om)</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">vvalid free_composite_vlsm
  (lift_to_composite_label j l)
  (lift_to_composite_state&#39; j s, om)</div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="Composition-v-chk9e" style="display: none" type="checkbox"><label class="alectryon-input" for="Composition-v-chk9e"><span class="nb">split</span>; <span class="nb">cbn</span>; [| <span class="bp">done</span>].</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>message, index</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>EqDecision0</var><span class="hyp-type"><b>: </b><span>EqDecision index</span></span></span><br><span><var>IM</var><span class="hyp-type"><b>: </b><span>index ‚Üí VLSM message</span></span></span><br><span><var>P, Q</var><span class="hyp-type"><b>: </b><span>message ‚Üí <span class="kt">Prop</span></span></span></span><br><span><var>PimpliesQ</var><span class="hyp-type"><b>: </b><span><span class="kr">‚àÄ</span> <span class="nv">m</span> : message, P m ‚Üí Q m</span></span></span><br><span><var>j</var><span class="hyp-type"><b>: </b><span>index</span></span></span><br><span><var>l</var><span class="hyp-type"><b>: </b><span>label</span></span></span><br><span><var>s</var><span class="hyp-type"><b>: </b><span>state</span></span></span><br><span><var>om</var><span class="hyp-type"><b>: </b><span>option message</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>vvalid (IM j) l (s, om)</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">vvalid (IM j) l (lift_to_composite_state&#39; j s j, om)</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="Composition-v-chk9f" style="display: none" type="checkbox"><label class="alectryon-input" for="Composition-v-chk9f"><span class="nb">unfold</span> lift_to_composite_state&#39;.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>message, index</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>EqDecision0</var><span class="hyp-type"><b>: </b><span>EqDecision index</span></span></span><br><span><var>IM</var><span class="hyp-type"><b>: </b><span>index ‚Üí VLSM message</span></span></span><br><span><var>P, Q</var><span class="hyp-type"><b>: </b><span>message ‚Üí <span class="kt">Prop</span></span></span></span><br><span><var>PimpliesQ</var><span class="hyp-type"><b>: </b><span><span class="kr">‚àÄ</span> <span class="nv">m</span> : message, P m ‚Üí Q m</span></span></span><br><span><var>j</var><span class="hyp-type"><b>: </b><span>index</span></span></span><br><span><var>l</var><span class="hyp-type"><b>: </b><span>label</span></span></span><br><span><var>s</var><span class="hyp-type"><b>: </b><span>state</span></span></span><br><span><var>om</var><span class="hyp-type"><b>: </b><span>option message</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>vvalid (IM j) l (s, om)</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">vvalid (IM j) l
  (lift_to_composite_state (`composite_s0) j s j, om)</div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="Composition-v-chka0" style="display: none" type="checkbox"><label class="alectryon-input" for="Composition-v-chka0"><span class="nb">rewrite</span> state_update_eq.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>message, index</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>EqDecision0</var><span class="hyp-type"><b>: </b><span>EqDecision index</span></span></span><br><span><var>IM</var><span class="hyp-type"><b>: </b><span>index ‚Üí VLSM message</span></span></span><br><span><var>P, Q</var><span class="hyp-type"><b>: </b><span>message ‚Üí <span class="kt">Prop</span></span></span></span><br><span><var>PimpliesQ</var><span class="hyp-type"><b>: </b><span><span class="kr">‚àÄ</span> <span class="nv">m</span> : message, P m ‚Üí Q m</span></span></span><br><span><var>j</var><span class="hyp-type"><b>: </b><span>index</span></span></span><br><span><var>l</var><span class="hyp-type"><b>: </b><span>label</span></span></span><br><span><var>s</var><span class="hyp-type"><b>: </b><span>state</span></span></span><br><span><var>om</var><span class="hyp-type"><b>: </b><span>option message</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>vvalid (IM j) l (s, om)</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">vvalid (IM j) l (s, om)</div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="nb">apply</span> H.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="Composition-v-chka1" style="display: none" type="checkbox"><label class="alectryon-input" for="Composition-v-chka1">-</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>message, index</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>EqDecision0</var><span class="hyp-type"><b>: </b><span>EqDecision index</span></span></span><br><span><var>IM</var><span class="hyp-type"><b>: </b><span>index ‚Üí VLSM message</span></span></span><br><span><var>P, Q</var><span class="hyp-type"><b>: </b><span>message ‚Üí <span class="kt">Prop</span></span></span></span><br><span><var>PimpliesQ</var><span class="hyp-type"><b>: </b><span><span class="kr">‚àÄ</span> <span class="nv">m</span> : message, P m ‚Üí Q m</span></span></span><br><span><var>j</var><span class="hyp-type"><b>: </b><span>index</span></span></span><br><span><var>l</var><span class="hyp-type"><b>: </b><span>label</span></span></span><br><span><var>s</var><span class="hyp-type"><b>: </b><span>state</span></span></span><br><span><var>om</var><span class="hyp-type"><b>: </b><span>option message</span></span></span><br><span><var>s'</var><span class="hyp-type"><b>: </b><span>state</span></span></span><br><span><var>om'</var><span class="hyp-type"><b>: </b><span>option message</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>vtransition (IM j) l (s, om) = (s&#39;, om&#39;)</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">vtransition free_composite_vlsm
  (lift_to_composite_label j l)
  (lift_to_composite_state&#39; j s, om) =
(lift_to_composite_state&#39; j s&#39;, om&#39;)</div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="Composition-v-chka2" style="display: none" type="checkbox"><label class="alectryon-input" for="Composition-v-chka2"><span class="nb">unfold</span> vtransition.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>message, index</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>EqDecision0</var><span class="hyp-type"><b>: </b><span>EqDecision index</span></span></span><br><span><var>IM</var><span class="hyp-type"><b>: </b><span>index ‚Üí VLSM message</span></span></span><br><span><var>P, Q</var><span class="hyp-type"><b>: </b><span>message ‚Üí <span class="kt">Prop</span></span></span></span><br><span><var>PimpliesQ</var><span class="hyp-type"><b>: </b><span><span class="kr">‚àÄ</span> <span class="nv">m</span> : message, P m ‚Üí Q m</span></span></span><br><span><var>j</var><span class="hyp-type"><b>: </b><span>index</span></span></span><br><span><var>l</var><span class="hyp-type"><b>: </b><span>label</span></span></span><br><span><var>s</var><span class="hyp-type"><b>: </b><span>state</span></span></span><br><span><var>om</var><span class="hyp-type"><b>: </b><span>option message</span></span></span><br><span><var>s'</var><span class="hyp-type"><b>: </b><span>state</span></span></span><br><span><var>om'</var><span class="hyp-type"><b>: </b><span>option message</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>vtransition (IM j) l (s, om) = (s&#39;, om&#39;)</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">transition (lift_to_composite_label j l)
  (lift_to_composite_state&#39; j s, om) =
(lift_to_composite_state&#39; j s&#39;, om&#39;)</div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="Composition-v-chka3" style="display: none" type="checkbox"><label class="alectryon-input" for="Composition-v-chka3"><span class="nb">simpl</span>.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>message, index</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>EqDecision0</var><span class="hyp-type"><b>: </b><span>EqDecision index</span></span></span><br><span><var>IM</var><span class="hyp-type"><b>: </b><span>index ‚Üí VLSM message</span></span></span><br><span><var>P, Q</var><span class="hyp-type"><b>: </b><span>message ‚Üí <span class="kt">Prop</span></span></span></span><br><span><var>PimpliesQ</var><span class="hyp-type"><b>: </b><span><span class="kr">‚àÄ</span> <span class="nv">m</span> : message, P m ‚Üí Q m</span></span></span><br><span><var>j</var><span class="hyp-type"><b>: </b><span>index</span></span></span><br><span><var>l</var><span class="hyp-type"><b>: </b><span>label</span></span></span><br><span><var>s</var><span class="hyp-type"><b>: </b><span>state</span></span></span><br><span><var>om</var><span class="hyp-type"><b>: </b><span>option message</span></span></span><br><span><var>s'</var><span class="hyp-type"><b>: </b><span>state</span></span></span><br><span><var>om'</var><span class="hyp-type"><b>: </b><span>option message</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>vtransition (IM j) l (s, om) = (s&#39;, om&#39;)</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">(<span class="kr">let</span> (<span class="nv">si&#39;</span>, om&#39;) :=
   vtransition (IM j) l
     (lift_to_composite_state&#39; j s j, om) <span class="kr">in</span>
 (state_update (lift_to_composite_state&#39; j s) j si&#39;,
 om&#39;)) = (lift_to_composite_state&#39; j s&#39;, om&#39;)</div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="Composition-v-chka4" style="display: none" type="checkbox"><label class="alectryon-input" for="Composition-v-chka4"><span class="nb">unfold</span> lift_to_composite_state&#39; <span class="nb">at</span> <span class="mi">1</span>.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>message, index</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>EqDecision0</var><span class="hyp-type"><b>: </b><span>EqDecision index</span></span></span><br><span><var>IM</var><span class="hyp-type"><b>: </b><span>index ‚Üí VLSM message</span></span></span><br><span><var>P, Q</var><span class="hyp-type"><b>: </b><span>message ‚Üí <span class="kt">Prop</span></span></span></span><br><span><var>PimpliesQ</var><span class="hyp-type"><b>: </b><span><span class="kr">‚àÄ</span> <span class="nv">m</span> : message, P m ‚Üí Q m</span></span></span><br><span><var>j</var><span class="hyp-type"><b>: </b><span>index</span></span></span><br><span><var>l</var><span class="hyp-type"><b>: </b><span>label</span></span></span><br><span><var>s</var><span class="hyp-type"><b>: </b><span>state</span></span></span><br><span><var>om</var><span class="hyp-type"><b>: </b><span>option message</span></span></span><br><span><var>s'</var><span class="hyp-type"><b>: </b><span>state</span></span></span><br><span><var>om'</var><span class="hyp-type"><b>: </b><span>option message</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>vtransition (IM j) l (s, om) = (s&#39;, om&#39;)</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">(<span class="kr">let</span> (<span class="nv">si&#39;</span>, om&#39;) :=
   vtransition (IM j) l
     (lift_to_composite_state (`composite_s0) j s j,
     om) <span class="kr">in</span>
 (state_update (lift_to_composite_state&#39; j s) j si&#39;,
 om&#39;)) = (lift_to_composite_state&#39; j s&#39;, om&#39;)</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="Composition-v-chka5" style="display: none" type="checkbox"><label class="alectryon-input" for="Composition-v-chka5"><span class="nb">rewrite</span> state_update_eq.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>message, index</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>EqDecision0</var><span class="hyp-type"><b>: </b><span>EqDecision index</span></span></span><br><span><var>IM</var><span class="hyp-type"><b>: </b><span>index ‚Üí VLSM message</span></span></span><br><span><var>P, Q</var><span class="hyp-type"><b>: </b><span>message ‚Üí <span class="kt">Prop</span></span></span></span><br><span><var>PimpliesQ</var><span class="hyp-type"><b>: </b><span><span class="kr">‚àÄ</span> <span class="nv">m</span> : message, P m ‚Üí Q m</span></span></span><br><span><var>j</var><span class="hyp-type"><b>: </b><span>index</span></span></span><br><span><var>l</var><span class="hyp-type"><b>: </b><span>label</span></span></span><br><span><var>s</var><span class="hyp-type"><b>: </b><span>state</span></span></span><br><span><var>om</var><span class="hyp-type"><b>: </b><span>option message</span></span></span><br><span><var>s'</var><span class="hyp-type"><b>: </b><span>state</span></span></span><br><span><var>om'</var><span class="hyp-type"><b>: </b><span>option message</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>vtransition (IM j) l (s, om) = (s&#39;, om&#39;)</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">(<span class="kr">let</span> (<span class="nv">si&#39;</span>, om&#39;) := vtransition (IM j) l (s, om) <span class="kr">in</span>
 (state_update (lift_to_composite_state&#39; j s) j si&#39;,
 om&#39;)) = (lift_to_composite_state&#39; j s&#39;, om&#39;)</div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="Composition-v-chka6" style="display: none" type="checkbox"><label class="alectryon-input" for="Composition-v-chka6"><span class="nb">replace</span> (vtransition (IM j) l _) <span class="kr">with</span> (s&#39;, om&#39;).</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>message, index</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>EqDecision0</var><span class="hyp-type"><b>: </b><span>EqDecision index</span></span></span><br><span><var>IM</var><span class="hyp-type"><b>: </b><span>index ‚Üí VLSM message</span></span></span><br><span><var>P, Q</var><span class="hyp-type"><b>: </b><span>message ‚Üí <span class="kt">Prop</span></span></span></span><br><span><var>PimpliesQ</var><span class="hyp-type"><b>: </b><span><span class="kr">‚àÄ</span> <span class="nv">m</span> : message, P m ‚Üí Q m</span></span></span><br><span><var>j</var><span class="hyp-type"><b>: </b><span>index</span></span></span><br><span><var>l</var><span class="hyp-type"><b>: </b><span>label</span></span></span><br><span><var>s</var><span class="hyp-type"><b>: </b><span>state</span></span></span><br><span><var>om</var><span class="hyp-type"><b>: </b><span>option message</span></span></span><br><span><var>s'</var><span class="hyp-type"><b>: </b><span>state</span></span></span><br><span><var>om'</var><span class="hyp-type"><b>: </b><span>option message</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>vtransition (IM j) l (s, om) = (s&#39;, om&#39;)</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">(state_update (lift_to_composite_state&#39; j s) j s&#39;,
om&#39;) = (lift_to_composite_state&#39; j s&#39;, om&#39;)</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="Composition-v-chka7" style="display: none" type="checkbox"><label class="alectryon-input" for="Composition-v-chka7"><span class="nb">f_equal</span>.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>message, index</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>EqDecision0</var><span class="hyp-type"><b>: </b><span>EqDecision index</span></span></span><br><span><var>IM</var><span class="hyp-type"><b>: </b><span>index ‚Üí VLSM message</span></span></span><br><span><var>P, Q</var><span class="hyp-type"><b>: </b><span>message ‚Üí <span class="kt">Prop</span></span></span></span><br><span><var>PimpliesQ</var><span class="hyp-type"><b>: </b><span><span class="kr">‚àÄ</span> <span class="nv">m</span> : message, P m ‚Üí Q m</span></span></span><br><span><var>j</var><span class="hyp-type"><b>: </b><span>index</span></span></span><br><span><var>l</var><span class="hyp-type"><b>: </b><span>label</span></span></span><br><span><var>s</var><span class="hyp-type"><b>: </b><span>state</span></span></span><br><span><var>om</var><span class="hyp-type"><b>: </b><span>option message</span></span></span><br><span><var>s'</var><span class="hyp-type"><b>: </b><span>state</span></span></span><br><span><var>om'</var><span class="hyp-type"><b>: </b><span>option message</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>vtransition (IM j) l (s, om) = (s&#39;, om&#39;)</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">state_update (lift_to_composite_state&#39; j s) j s&#39; =
lift_to_composite_state&#39; j s&#39;</div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="Composition-v-chka8" style="display: none" type="checkbox"><label class="alectryon-input" for="Composition-v-chka8"><span class="nb">unfold</span> lift_to_composite_state&#39;.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>message, index</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>EqDecision0</var><span class="hyp-type"><b>: </b><span>EqDecision index</span></span></span><br><span><var>IM</var><span class="hyp-type"><b>: </b><span>index ‚Üí VLSM message</span></span></span><br><span><var>P, Q</var><span class="hyp-type"><b>: </b><span>message ‚Üí <span class="kt">Prop</span></span></span></span><br><span><var>PimpliesQ</var><span class="hyp-type"><b>: </b><span><span class="kr">‚àÄ</span> <span class="nv">m</span> : message, P m ‚Üí Q m</span></span></span><br><span><var>j</var><span class="hyp-type"><b>: </b><span>index</span></span></span><br><span><var>l</var><span class="hyp-type"><b>: </b><span>label</span></span></span><br><span><var>s</var><span class="hyp-type"><b>: </b><span>state</span></span></span><br><span><var>om</var><span class="hyp-type"><b>: </b><span>option message</span></span></span><br><span><var>s'</var><span class="hyp-type"><b>: </b><span>state</span></span></span><br><span><var>om'</var><span class="hyp-type"><b>: </b><span>option message</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>vtransition (IM j) l (s, om) = (s&#39;, om&#39;)</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">state_update
  (lift_to_composite_state (`composite_s0) j s) j s&#39; =
lift_to_composite_state (`composite_s0) j s&#39;</div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="nb">apply</span> state_update_twice.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="Composition-v-chka9" style="display: none" type="checkbox"><label class="alectryon-input" for="Composition-v-chka9">-</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>message, index</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>EqDecision0</var><span class="hyp-type"><b>: </b><span>EqDecision index</span></span></span><br><span><var>IM</var><span class="hyp-type"><b>: </b><span>index ‚Üí VLSM message</span></span></span><br><span><var>P, Q</var><span class="hyp-type"><b>: </b><span>message ‚Üí <span class="kt">Prop</span></span></span></span><br><span><var>PimpliesQ</var><span class="hyp-type"><b>: </b><span><span class="kr">‚àÄ</span> <span class="nv">m</span> : message, P m ‚Üí Q m</span></span></span><br><span><var>j</var><span class="hyp-type"><b>: </b><span>index</span></span></span><br><span><var>s</var><span class="hyp-type"><b>: </b><span>state</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>vinitial_state_prop (IM j) s</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">vinitial_state_prop free_composite_vlsm
  (lift_to_composite_state&#39; j s)</div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="bp">by</span> <span class="nb">apply</span> composite_initial_state_prop_lift.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="Composition-v-chkaa" style="display: none" type="checkbox"><label class="alectryon-input" for="Composition-v-chkaa">-</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>message, index</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>EqDecision0</var><span class="hyp-type"><b>: </b><span>EqDecision index</span></span></span><br><span><var>IM</var><span class="hyp-type"><b>: </b><span>index ‚Üí VLSM message</span></span></span><br><span><var>P, Q</var><span class="hyp-type"><b>: </b><span>message ‚Üí <span class="kt">Prop</span></span></span></span><br><span><var>PimpliesQ</var><span class="hyp-type"><b>: </b><span><span class="kr">‚àÄ</span> <span class="nv">m</span> : message, P m ‚Üí Q m</span></span></span><br><span><var>j</var><span class="hyp-type"><b>: </b><span>index</span></span></span><br><span><var>m</var><span class="hyp-type"><b>: </b><span>message</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>vinitial_message_prop (IM j) m</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">vinitial_message_prop free_composite_vlsm m</div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="bp">by</span> <span class="kr">exists</span> <span class="nv">j</span>, (exist _ _ H).</span><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Qed</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
</span><span class="alectryon-sentence"><input class="alectryon-toggle" id="Composition-v-chkab" style="display: none" type="checkbox"><label class="alectryon-input" for="Composition-v-chkab"><span class="kn">Lemma</span> <span class="nf">lift_to_composite_preloaded_vlsm_full_projection</span>
  (<span class="nv">j</span> : index)
  : VLSM_full_projection (pre_loaded_with_all_messages_vlsm (IM j)) (pre_loaded_with_all_messages_vlsm free_composite_vlsm) (lift_to_composite_label j) (lift_to_composite_state&#39; j).</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>message, index</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>EqDecision0</var><span class="hyp-type"><b>: </b><span>EqDecision index</span></span></span><br><span><var>IM</var><span class="hyp-type"><b>: </b><span>index ‚Üí VLSM message</span></span></span><br><span><var>j</var><span class="hyp-type"><b>: </b><span>index</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">VLSM_full_projection
  (pre_loaded_with_all_messages_vlsm (IM j))
  (pre_loaded_with_all_messages_vlsm
     free_composite_vlsm) (lift_to_composite_label j)
  (lift_to_composite_state&#39; j)</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="Composition-v-chkac" style="display: none" type="checkbox"><label class="alectryon-input" for="Composition-v-chkac"><span class="kn">Proof</span>.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>message, index</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>EqDecision0</var><span class="hyp-type"><b>: </b><span>EqDecision index</span></span></span><br><span><var>IM</var><span class="hyp-type"><b>: </b><span>index ‚Üí VLSM message</span></span></span><br><span><var>j</var><span class="hyp-type"><b>: </b><span>index</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">VLSM_full_projection
  (pre_loaded_with_all_messages_vlsm (IM j))
  (pre_loaded_with_all_messages_vlsm
     free_composite_vlsm) (lift_to_composite_label j)
  (lift_to_composite_state&#39; j)</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="Composition-v-chkad" style="display: none" type="checkbox"><label class="alectryon-input" for="Composition-v-chkad"><span class="nb">apply</span> basic_VLSM_full_projection_preloaded.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>message, index</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>EqDecision0</var><span class="hyp-type"><b>: </b><span>EqDecision index</span></span></span><br><span><var>IM</var><span class="hyp-type"><b>: </b><span>index ‚Üí VLSM message</span></span></span><br><span><var>j</var><span class="hyp-type"><b>: </b><span>index</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">strong_full_projection_valid_preservation (IM j)
  free_composite_vlsm (lift_to_composite_label j)
  (lift_to_composite_state&#39; j)</div></blockquote><div class="alectryon-extra-goals"><input class="alectryon-extra-goal-toggle" id="Composition-v-chkae" style="display: none" type="checkbox"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>message, index</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>EqDecision0</var><span class="hyp-type"><b>: </b><span>EqDecision index</span></span></span><br><span><var>IM</var><span class="hyp-type"><b>: </b><span>index ‚Üí VLSM message</span></span></span><br><span><var>j</var><span class="hyp-type"><b>: </b><span>index</span></span></span><br></div><label class="goal-separator" for="Composition-v-chkae"><hr></label><div class="goal-conclusion">strong_full_projection_transition_preservation 
  (IM j) free_composite_vlsm
  (lift_to_composite_label j)
  (lift_to_composite_state&#39; j)</div></blockquote><input class="alectryon-extra-goal-toggle" id="Composition-v-chkaf" style="display: none" type="checkbox"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>message, index</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>EqDecision0</var><span class="hyp-type"><b>: </b><span>EqDecision index</span></span></span><br><span><var>IM</var><span class="hyp-type"><b>: </b><span>index ‚Üí VLSM message</span></span></span><br><span><var>j</var><span class="hyp-type"><b>: </b><span>index</span></span></span><br></div><label class="goal-separator" for="Composition-v-chkaf"><hr></label><div class="goal-conclusion">strong_projection_initial_state_preservation 
  (IM j) free_composite_vlsm
  (lift_to_composite_state&#39; j)</div></blockquote></div></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="Composition-v-chkb0" style="display: none" type="checkbox"><label class="alectryon-input" for="Composition-v-chkb0">-</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>message, index</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>EqDecision0</var><span class="hyp-type"><b>: </b><span>EqDecision index</span></span></span><br><span><var>IM</var><span class="hyp-type"><b>: </b><span>index ‚Üí VLSM message</span></span></span><br><span><var>j</var><span class="hyp-type"><b>: </b><span>index</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">strong_full_projection_valid_preservation (IM j)
  free_composite_vlsm (lift_to_composite_label j)
  (lift_to_composite_state&#39; j)</div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="Composition-v-chkb1" style="display: none" type="checkbox"><label class="alectryon-input" for="Composition-v-chkb1"><span class="nb">intro</span>; <span class="nb">intros</span>.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>message, index</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>EqDecision0</var><span class="hyp-type"><b>: </b><span>EqDecision index</span></span></span><br><span><var>IM</var><span class="hyp-type"><b>: </b><span>index ‚Üí VLSM message</span></span></span><br><span><var>j</var><span class="hyp-type"><b>: </b><span>index</span></span></span><br><span><var>l</var><span class="hyp-type"><b>: </b><span>label</span></span></span><br><span><var>s</var><span class="hyp-type"><b>: </b><span>state</span></span></span><br><span><var>om</var><span class="hyp-type"><b>: </b><span>option message</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>vvalid (IM j) l (s, om)</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">vvalid free_composite_vlsm
  (lift_to_composite_label j l)
  (lift_to_composite_state&#39; j s, om)</div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="Composition-v-chkb2" style="display: none" type="checkbox"><label class="alectryon-input" for="Composition-v-chkb2"><span class="nb">split</span>; [| <span class="bp">done</span>].</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>message, index</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>EqDecision0</var><span class="hyp-type"><b>: </b><span>EqDecision index</span></span></span><br><span><var>IM</var><span class="hyp-type"><b>: </b><span>index ‚Üí VLSM message</span></span></span><br><span><var>j</var><span class="hyp-type"><b>: </b><span>index</span></span></span><br><span><var>l</var><span class="hyp-type"><b>: </b><span>label</span></span></span><br><span><var>s</var><span class="hyp-type"><b>: </b><span>state</span></span></span><br><span><var>om</var><span class="hyp-type"><b>: </b><span>option message</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>vvalid (IM j) l (s, om)</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">composite_valid (lift_to_composite_label j l)
  (lift_to_composite_state&#39; j s, om)</div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="Composition-v-chkb3" style="display: none" type="checkbox"><label class="alectryon-input" for="Composition-v-chkb3"><span class="nb">simpl</span>.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>message, index</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>EqDecision0</var><span class="hyp-type"><b>: </b><span>EqDecision index</span></span></span><br><span><var>IM</var><span class="hyp-type"><b>: </b><span>index ‚Üí VLSM message</span></span></span><br><span><var>j</var><span class="hyp-type"><b>: </b><span>index</span></span></span><br><span><var>l</var><span class="hyp-type"><b>: </b><span>label</span></span></span><br><span><var>s</var><span class="hyp-type"><b>: </b><span>state</span></span></span><br><span><var>om</var><span class="hyp-type"><b>: </b><span>option message</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>vvalid (IM j) l (s, om)</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">vvalid (IM j) l (lift_to_composite_state&#39; j s j, om)</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="Composition-v-chkb4" style="display: none" type="checkbox"><label class="alectryon-input" for="Composition-v-chkb4"><span class="nb">unfold</span> lift_to_composite_state&#39;.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>message, index</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>EqDecision0</var><span class="hyp-type"><b>: </b><span>EqDecision index</span></span></span><br><span><var>IM</var><span class="hyp-type"><b>: </b><span>index ‚Üí VLSM message</span></span></span><br><span><var>j</var><span class="hyp-type"><b>: </b><span>index</span></span></span><br><span><var>l</var><span class="hyp-type"><b>: </b><span>label</span></span></span><br><span><var>s</var><span class="hyp-type"><b>: </b><span>state</span></span></span><br><span><var>om</var><span class="hyp-type"><b>: </b><span>option message</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>vvalid (IM j) l (s, om)</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">vvalid (IM j) l
  (lift_to_composite_state (`composite_s0) j s j, om)</div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="Composition-v-chkb5" style="display: none" type="checkbox"><label class="alectryon-input" for="Composition-v-chkb5"><span class="nb">rewrite</span> state_update_eq.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>message, index</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>EqDecision0</var><span class="hyp-type"><b>: </b><span>EqDecision index</span></span></span><br><span><var>IM</var><span class="hyp-type"><b>: </b><span>index ‚Üí VLSM message</span></span></span><br><span><var>j</var><span class="hyp-type"><b>: </b><span>index</span></span></span><br><span><var>l</var><span class="hyp-type"><b>: </b><span>label</span></span></span><br><span><var>s</var><span class="hyp-type"><b>: </b><span>state</span></span></span><br><span><var>om</var><span class="hyp-type"><b>: </b><span>option message</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>vvalid (IM j) l (s, om)</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">vvalid (IM j) l (s, om)</div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="nb">apply</span> H.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="Composition-v-chkb6" style="display: none" type="checkbox"><label class="alectryon-input" for="Composition-v-chkb6">-</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>message, index</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>EqDecision0</var><span class="hyp-type"><b>: </b><span>EqDecision index</span></span></span><br><span><var>IM</var><span class="hyp-type"><b>: </b><span>index ‚Üí VLSM message</span></span></span><br><span><var>j</var><span class="hyp-type"><b>: </b><span>index</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">strong_full_projection_transition_preservation (IM j)
  free_composite_vlsm (lift_to_composite_label j)
  (lift_to_composite_state&#39; j)</div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="Composition-v-chkb7" style="display: none" type="checkbox"><label class="alectryon-input" for="Composition-v-chkb7"><span class="nb">intro</span>; <span class="nb">intros</span>.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>message, index</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>EqDecision0</var><span class="hyp-type"><b>: </b><span>EqDecision index</span></span></span><br><span><var>IM</var><span class="hyp-type"><b>: </b><span>index ‚Üí VLSM message</span></span></span><br><span><var>j</var><span class="hyp-type"><b>: </b><span>index</span></span></span><br><span><var>l</var><span class="hyp-type"><b>: </b><span>label</span></span></span><br><span><var>s</var><span class="hyp-type"><b>: </b><span>state</span></span></span><br><span><var>om</var><span class="hyp-type"><b>: </b><span>option message</span></span></span><br><span><var>s'</var><span class="hyp-type"><b>: </b><span>state</span></span></span><br><span><var>om'</var><span class="hyp-type"><b>: </b><span>option message</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>vtransition (IM j) l (s, om) = (s&#39;, om&#39;)</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">vtransition free_composite_vlsm
  (lift_to_composite_label j l)
  (lift_to_composite_state&#39; j s, om) =
(lift_to_composite_state&#39; j s&#39;, om&#39;)</div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="Composition-v-chkb8" style="display: none" type="checkbox"><label class="alectryon-input" for="Composition-v-chkb8"><span class="nb">unfold</span> vtransition.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>message, index</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>EqDecision0</var><span class="hyp-type"><b>: </b><span>EqDecision index</span></span></span><br><span><var>IM</var><span class="hyp-type"><b>: </b><span>index ‚Üí VLSM message</span></span></span><br><span><var>j</var><span class="hyp-type"><b>: </b><span>index</span></span></span><br><span><var>l</var><span class="hyp-type"><b>: </b><span>label</span></span></span><br><span><var>s</var><span class="hyp-type"><b>: </b><span>state</span></span></span><br><span><var>om</var><span class="hyp-type"><b>: </b><span>option message</span></span></span><br><span><var>s'</var><span class="hyp-type"><b>: </b><span>state</span></span></span><br><span><var>om'</var><span class="hyp-type"><b>: </b><span>option message</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>vtransition (IM j) l (s, om) = (s&#39;, om&#39;)</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">transition (lift_to_composite_label j l)
  (lift_to_composite_state&#39; j s, om) =
(lift_to_composite_state&#39; j s&#39;, om&#39;)</div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="Composition-v-chkb9" style="display: none" type="checkbox"><label class="alectryon-input" for="Composition-v-chkb9"><span class="nb">simpl</span>.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>message, index</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>EqDecision0</var><span class="hyp-type"><b>: </b><span>EqDecision index</span></span></span><br><span><var>IM</var><span class="hyp-type"><b>: </b><span>index ‚Üí VLSM message</span></span></span><br><span><var>j</var><span class="hyp-type"><b>: </b><span>index</span></span></span><br><span><var>l</var><span class="hyp-type"><b>: </b><span>label</span></span></span><br><span><var>s</var><span class="hyp-type"><b>: </b><span>state</span></span></span><br><span><var>om</var><span class="hyp-type"><b>: </b><span>option message</span></span></span><br><span><var>s'</var><span class="hyp-type"><b>: </b><span>state</span></span></span><br><span><var>om'</var><span class="hyp-type"><b>: </b><span>option message</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>vtransition (IM j) l (s, om) = (s&#39;, om&#39;)</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">(<span class="kr">let</span> (<span class="nv">si&#39;</span>, om&#39;) :=
   vtransition (IM j) l
     (lift_to_composite_state&#39; j s j, om) <span class="kr">in</span>
 (state_update (lift_to_composite_state&#39; j s) j si&#39;,
 om&#39;)) = (lift_to_composite_state&#39; j s&#39;, om&#39;)</div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="Composition-v-chkba" style="display: none" type="checkbox"><label class="alectryon-input" for="Composition-v-chkba"><span class="nb">unfold</span> vtransition.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>message, index</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>EqDecision0</var><span class="hyp-type"><b>: </b><span>EqDecision index</span></span></span><br><span><var>IM</var><span class="hyp-type"><b>: </b><span>index ‚Üí VLSM message</span></span></span><br><span><var>j</var><span class="hyp-type"><b>: </b><span>index</span></span></span><br><span><var>l</var><span class="hyp-type"><b>: </b><span>label</span></span></span><br><span><var>s</var><span class="hyp-type"><b>: </b><span>state</span></span></span><br><span><var>om</var><span class="hyp-type"><b>: </b><span>option message</span></span></span><br><span><var>s'</var><span class="hyp-type"><b>: </b><span>state</span></span></span><br><span><var>om'</var><span class="hyp-type"><b>: </b><span>option message</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>vtransition (IM j) l (s, om) = (s&#39;, om&#39;)</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">(<span class="kr">let</span> (<span class="nv">si&#39;</span>, om&#39;) :=
   transition l (lift_to_composite_state&#39; j s j, om) <span class="kr">in</span>
 (state_update (lift_to_composite_state&#39; j s) j si&#39;,
 om&#39;)) = (lift_to_composite_state&#39; j s&#39;, om&#39;)</div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="Composition-v-chkbb" style="display: none" type="checkbox"><label class="alectryon-input" for="Composition-v-chkbb"><span class="nb">simpl</span>.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>message, index</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>EqDecision0</var><span class="hyp-type"><b>: </b><span>EqDecision index</span></span></span><br><span><var>IM</var><span class="hyp-type"><b>: </b><span>index ‚Üí VLSM message</span></span></span><br><span><var>j</var><span class="hyp-type"><b>: </b><span>index</span></span></span><br><span><var>l</var><span class="hyp-type"><b>: </b><span>label</span></span></span><br><span><var>s</var><span class="hyp-type"><b>: </b><span>state</span></span></span><br><span><var>om</var><span class="hyp-type"><b>: </b><span>option message</span></span></span><br><span><var>s'</var><span class="hyp-type"><b>: </b><span>state</span></span></span><br><span><var>om'</var><span class="hyp-type"><b>: </b><span>option message</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>vtransition (IM j) l (s, om) = (s&#39;, om&#39;)</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">(<span class="kr">let</span> (<span class="nv">si&#39;</span>, om&#39;) :=
   transition l (lift_to_composite_state&#39; j s j, om) <span class="kr">in</span>
 (state_update (lift_to_composite_state&#39; j s) j si&#39;,
 om&#39;)) = (lift_to_composite_state&#39; j s&#39;, om&#39;)</div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="Composition-v-chkbc" style="display: none" type="checkbox"><label class="alectryon-input" for="Composition-v-chkbc"><span class="nb">unfold</span> lift_to_composite_state&#39; <span class="nb">at</span> <span class="mi">1</span>.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>message, index</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>EqDecision0</var><span class="hyp-type"><b>: </b><span>EqDecision index</span></span></span><br><span><var>IM</var><span class="hyp-type"><b>: </b><span>index ‚Üí VLSM message</span></span></span><br><span><var>j</var><span class="hyp-type"><b>: </b><span>index</span></span></span><br><span><var>l</var><span class="hyp-type"><b>: </b><span>label</span></span></span><br><span><var>s</var><span class="hyp-type"><b>: </b><span>state</span></span></span><br><span><var>om</var><span class="hyp-type"><b>: </b><span>option message</span></span></span><br><span><var>s'</var><span class="hyp-type"><b>: </b><span>state</span></span></span><br><span><var>om'</var><span class="hyp-type"><b>: </b><span>option message</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>vtransition (IM j) l (s, om) = (s&#39;, om&#39;)</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">(<span class="kr">let</span> (<span class="nv">si&#39;</span>, om&#39;) :=
   transition l
     (lift_to_composite_state (`composite_s0) j s j,
     om) <span class="kr">in</span>
 (state_update (lift_to_composite_state&#39; j s) j si&#39;,
 om&#39;)) = (lift_to_composite_state&#39; j s&#39;, om&#39;)</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="Composition-v-chkbd" style="display: none" type="checkbox"><label class="alectryon-input" for="Composition-v-chkbd"><span class="nb">rewrite</span> state_update_eq.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>message, index</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>EqDecision0</var><span class="hyp-type"><b>: </b><span>EqDecision index</span></span></span><br><span><var>IM</var><span class="hyp-type"><b>: </b><span>index ‚Üí VLSM message</span></span></span><br><span><var>j</var><span class="hyp-type"><b>: </b><span>index</span></span></span><br><span><var>l</var><span class="hyp-type"><b>: </b><span>label</span></span></span><br><span><var>s</var><span class="hyp-type"><b>: </b><span>state</span></span></span><br><span><var>om</var><span class="hyp-type"><b>: </b><span>option message</span></span></span><br><span><var>s'</var><span class="hyp-type"><b>: </b><span>state</span></span></span><br><span><var>om'</var><span class="hyp-type"><b>: </b><span>option message</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>vtransition (IM j) l (s, om) = (s&#39;, om&#39;)</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">(<span class="kr">let</span> (<span class="nv">si&#39;</span>, om&#39;) := transition l (s, om) <span class="kr">in</span>
 (state_update (lift_to_composite_state&#39; j s) j si&#39;,
 om&#39;)) = (lift_to_composite_state&#39; j s&#39;, om&#39;)</div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="Composition-v-chkbe" style="display: none" type="checkbox"><label class="alectryon-input" for="Composition-v-chkbe"><span class="nb">replace</span> (transition l _) <span class="kr">with</span> (s&#39;, om&#39;).</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>message, index</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>EqDecision0</var><span class="hyp-type"><b>: </b><span>EqDecision index</span></span></span><br><span><var>IM</var><span class="hyp-type"><b>: </b><span>index ‚Üí VLSM message</span></span></span><br><span><var>j</var><span class="hyp-type"><b>: </b><span>index</span></span></span><br><span><var>l</var><span class="hyp-type"><b>: </b><span>label</span></span></span><br><span><var>s</var><span class="hyp-type"><b>: </b><span>state</span></span></span><br><span><var>om</var><span class="hyp-type"><b>: </b><span>option message</span></span></span><br><span><var>s'</var><span class="hyp-type"><b>: </b><span>state</span></span></span><br><span><var>om'</var><span class="hyp-type"><b>: </b><span>option message</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>vtransition (IM j) l (s, om) = (s&#39;, om&#39;)</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">(state_update (lift_to_composite_state&#39; j s) j s&#39;,
om&#39;) = (lift_to_composite_state&#39; j s&#39;, om&#39;)</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="Composition-v-chkbf" style="display: none" type="checkbox"><label class="alectryon-input" for="Composition-v-chkbf"><span class="nb">f_equal</span>.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>message, index</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>EqDecision0</var><span class="hyp-type"><b>: </b><span>EqDecision index</span></span></span><br><span><var>IM</var><span class="hyp-type"><b>: </b><span>index ‚Üí VLSM message</span></span></span><br><span><var>j</var><span class="hyp-type"><b>: </b><span>index</span></span></span><br><span><var>l</var><span class="hyp-type"><b>: </b><span>label</span></span></span><br><span><var>s</var><span class="hyp-type"><b>: </b><span>state</span></span></span><br><span><var>om</var><span class="hyp-type"><b>: </b><span>option message</span></span></span><br><span><var>s'</var><span class="hyp-type"><b>: </b><span>state</span></span></span><br><span><var>om'</var><span class="hyp-type"><b>: </b><span>option message</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>vtransition (IM j) l (s, om) = (s&#39;, om&#39;)</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">state_update (lift_to_composite_state&#39; j s) j s&#39; =
lift_to_composite_state&#39; j s&#39;</div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="Composition-v-chkc0" style="display: none" type="checkbox"><label class="alectryon-input" for="Composition-v-chkc0"><span class="nb">unfold</span> lift_to_composite_state&#39;.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>message, index</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>EqDecision0</var><span class="hyp-type"><b>: </b><span>EqDecision index</span></span></span><br><span><var>IM</var><span class="hyp-type"><b>: </b><span>index ‚Üí VLSM message</span></span></span><br><span><var>j</var><span class="hyp-type"><b>: </b><span>index</span></span></span><br><span><var>l</var><span class="hyp-type"><b>: </b><span>label</span></span></span><br><span><var>s</var><span class="hyp-type"><b>: </b><span>state</span></span></span><br><span><var>om</var><span class="hyp-type"><b>: </b><span>option message</span></span></span><br><span><var>s'</var><span class="hyp-type"><b>: </b><span>state</span></span></span><br><span><var>om'</var><span class="hyp-type"><b>: </b><span>option message</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>vtransition (IM j) l (s, om) = (s&#39;, om&#39;)</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">state_update
  (lift_to_composite_state (`composite_s0) j s) j s&#39; =
lift_to_composite_state (`composite_s0) j s&#39;</div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="nb">apply</span> state_update_twice.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="Composition-v-chkc1" style="display: none" type="checkbox"><label class="alectryon-input" for="Composition-v-chkc1">-</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>message, index</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>EqDecision0</var><span class="hyp-type"><b>: </b><span>EqDecision index</span></span></span><br><span><var>IM</var><span class="hyp-type"><b>: </b><span>index ‚Üí VLSM message</span></span></span><br><span><var>j</var><span class="hyp-type"><b>: </b><span>index</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">strong_projection_initial_state_preservation (IM j)
  free_composite_vlsm (lift_to_composite_state&#39; j)</div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="bp">by</span> <span class="nb">intros</span> s H; <span class="nb">apply</span> composite_initial_state_prop_lift.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Qed</span>.</span></span></pre><div class="doc">
  If all messages described by a predicate <code>P</code> are valid for the free
  composition pre-loaded with messages described by a predicate <code>Q</code>, then
  any message which can be emitted by a component pre-loaded with <code>P</code> can
  also be emitted by the free composition pre-loaded with <code>Q</code>.

</div><pre class="alectryon-io highlight"><!-- Generator: Alectryon --><span class="alectryon-sentence"><input class="alectryon-toggle" id="Composition-v-chkc2" style="display: none" type="checkbox"><label class="alectryon-input" for="Composition-v-chkc2"><span class="kn">Lemma</span> <span class="nf">valid_preloaded_lifts_can_be_emitted</span>
  (<span class="nv">P</span> <span class="nv">Q</span> : message -&gt; <span class="kt">Prop</span>)
  (<span class="nv">HPvalid</span> : <span class="kr">forall</span> <span class="nv">dm</span>, P dm -&gt; valid_message_prop (pre_loaded_vlsm free_composite_vlsm Q) dm)
  : <span class="kr">forall</span> <span class="nv">j</span> <span class="nv">m</span>, can_emit (pre_loaded_vlsm (IM j) P) m -&gt;
    can_emit (pre_loaded_vlsm free_composite_vlsm Q) m.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>message, index</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>EqDecision0</var><span class="hyp-type"><b>: </b><span>EqDecision index</span></span></span><br><span><var>IM</var><span class="hyp-type"><b>: </b><span>index ‚Üí VLSM message</span></span></span><br><span><var>P, Q</var><span class="hyp-type"><b>: </b><span>message ‚Üí <span class="kt">Prop</span></span></span></span><br><span><var>HPvalid</var><span class="hyp-type"><b>: </b><span><span class="kr">‚àÄ</span> <span class="nv">dm</span> : message,
  P dm
  ‚Üí valid_message_prop
      (pre_loaded_vlsm free_composite_vlsm Q)
      dm</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="kr">‚àÄ</span> (<span class="nv">j</span> : index) (<span class="nv">m</span> : message),
  can_emit (pre_loaded_vlsm (IM j) P) m
  ‚Üí can_emit (pre_loaded_vlsm free_composite_vlsm Q) m</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="Composition-v-chkc3" style="display: none" type="checkbox"><label class="alectryon-input" for="Composition-v-chkc3"><span class="kn">Proof</span>.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>message, index</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>EqDecision0</var><span class="hyp-type"><b>: </b><span>EqDecision index</span></span></span><br><span><var>IM</var><span class="hyp-type"><b>: </b><span>index ‚Üí VLSM message</span></span></span><br><span><var>P, Q</var><span class="hyp-type"><b>: </b><span>message ‚Üí <span class="kt">Prop</span></span></span></span><br><span><var>HPvalid</var><span class="hyp-type"><b>: </b><span><span class="kr">‚àÄ</span> <span class="nv">dm</span> : message,
  P dm
  ‚Üí valid_message_prop
      (pre_loaded_vlsm free_composite_vlsm Q)
      dm</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="kr">‚àÄ</span> (<span class="nv">j</span> : index) (<span class="nv">m</span> : message),
  can_emit (pre_loaded_vlsm (IM j) P) m
  ‚Üí can_emit (pre_loaded_vlsm free_composite_vlsm Q) m</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="Composition-v-chkc4" style="display: none" type="checkbox"><label class="alectryon-input" for="Composition-v-chkc4"><span class="nb">intros</span> j m Hm.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>message, index</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>EqDecision0</var><span class="hyp-type"><b>: </b><span>EqDecision index</span></span></span><br><span><var>IM</var><span class="hyp-type"><b>: </b><span>index ‚Üí VLSM message</span></span></span><br><span><var>P, Q</var><span class="hyp-type"><b>: </b><span>message ‚Üí <span class="kt">Prop</span></span></span></span><br><span><var>HPvalid</var><span class="hyp-type"><b>: </b><span><span class="kr">‚àÄ</span> <span class="nv">dm</span> : message,
  P dm
  ‚Üí valid_message_prop
      (pre_loaded_vlsm free_composite_vlsm Q)
      dm</span></span></span><br><span><var>j</var><span class="hyp-type"><b>: </b><span>index</span></span></span><br><span><var>m</var><span class="hyp-type"><b>: </b><span>message</span></span></span><br><span><var>Hm</var><span class="hyp-type"><b>: </b><span>can_emit (pre_loaded_vlsm (IM j) P) m</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">can_emit (pre_loaded_vlsm free_composite_vlsm Q) m</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="Composition-v-chkc5" style="display: none" type="checkbox"><label class="alectryon-input" for="Composition-v-chkc5"><span class="nb">eapply</span> VLSM_incl_can_emit.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>message, index</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>EqDecision0</var><span class="hyp-type"><b>: </b><span>EqDecision index</span></span></span><br><span><var>IM</var><span class="hyp-type"><b>: </b><span>index ‚Üí VLSM message</span></span></span><br><span><var>P, Q</var><span class="hyp-type"><b>: </b><span>message ‚Üí <span class="kt">Prop</span></span></span></span><br><span><var>HPvalid</var><span class="hyp-type"><b>: </b><span><span class="kr">‚àÄ</span> <span class="nv">dm</span> : message,
  P dm
  ‚Üí valid_message_prop
      (pre_loaded_vlsm free_composite_vlsm Q)
      dm</span></span></span><br><span><var>j</var><span class="hyp-type"><b>: </b><span>index</span></span></span><br><span><var>m</var><span class="hyp-type"><b>: </b><span>message</span></span></span><br><span><var>Hm</var><span class="hyp-type"><b>: </b><span>can_emit (pre_loaded_vlsm (IM j) P) m</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">VLSM_incl_part <span class="nl">?MX</span>
  (VLSMMachine_pre_loaded_with_messages
     (vmachine free_composite_vlsm) Q)</div></blockquote><div class="alectryon-extra-goals"><input class="alectryon-extra-goal-toggle" id="Composition-v-chkc6" style="display: none" type="checkbox"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>message, index</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>EqDecision0</var><span class="hyp-type"><b>: </b><span>EqDecision index</span></span></span><br><span><var>IM</var><span class="hyp-type"><b>: </b><span>index ‚Üí VLSM message</span></span></span><br><span><var>P, Q</var><span class="hyp-type"><b>: </b><span>message ‚Üí <span class="kt">Prop</span></span></span></span><br><span><var>HPvalid</var><span class="hyp-type"><b>: </b><span><span class="kr">‚àÄ</span> <span class="nv">dm</span> : message,
  P dm
  ‚Üí valid_message_prop
      (pre_loaded_vlsm free_composite_vlsm Q)
      dm</span></span></span><br><span><var>j</var><span class="hyp-type"><b>: </b><span>index</span></span></span><br><span><var>m</var><span class="hyp-type"><b>: </b><span>message</span></span></span><br><span><var>Hm</var><span class="hyp-type"><b>: </b><span>can_emit (pre_loaded_vlsm (IM j) P) m</span></span></span><br></div><label class="goal-separator" for="Composition-v-chkc6"><hr></label><div class="goal-conclusion">can_emit
  {|
    vtype := vtype free_composite_vlsm;
    vmachine := <span class="nl">?MX</span>
  |} m</div></blockquote></div></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="Composition-v-chkc7" style="display: none" type="checkbox"><label class="alectryon-input" for="Composition-v-chkc7">-</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>message, index</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>EqDecision0</var><span class="hyp-type"><b>: </b><span>EqDecision index</span></span></span><br><span><var>IM</var><span class="hyp-type"><b>: </b><span>index ‚Üí VLSM message</span></span></span><br><span><var>P, Q</var><span class="hyp-type"><b>: </b><span>message ‚Üí <span class="kt">Prop</span></span></span></span><br><span><var>HPvalid</var><span class="hyp-type"><b>: </b><span><span class="kr">‚àÄ</span> <span class="nv">dm</span> : message,
  P dm
  ‚Üí valid_message_prop
      (pre_loaded_vlsm free_composite_vlsm Q)
      dm</span></span></span><br><span><var>j</var><span class="hyp-type"><b>: </b><span>index</span></span></span><br><span><var>m</var><span class="hyp-type"><b>: </b><span>message</span></span></span><br><span><var>Hm</var><span class="hyp-type"><b>: </b><span>can_emit (pre_loaded_vlsm (IM j) P) m</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">VLSM_incl_part <span class="nl">?MX</span>
  (VLSMMachine_pre_loaded_with_messages
     (vmachine free_composite_vlsm) Q)</div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="Composition-v-chkc8" style="display: none" type="checkbox"><label class="alectryon-input" for="Composition-v-chkc8"><span class="nb">apply</span> (pre_loaded_vlsm_incl_relaxed _ (<span class="kr">fun</span> <span class="nv">m</span> =&gt; Q m \/ P m)).</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>message, index</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>EqDecision0</var><span class="hyp-type"><b>: </b><span>EqDecision index</span></span></span><br><span><var>IM</var><span class="hyp-type"><b>: </b><span>index ‚Üí VLSM message</span></span></span><br><span><var>P, Q</var><span class="hyp-type"><b>: </b><span>message ‚Üí <span class="kt">Prop</span></span></span></span><br><span><var>HPvalid</var><span class="hyp-type"><b>: </b><span><span class="kr">‚àÄ</span> <span class="nv">dm</span> : message,
  P dm
  ‚Üí valid_message_prop
      (pre_loaded_vlsm free_composite_vlsm Q)
      dm</span></span></span><br><span><var>j</var><span class="hyp-type"><b>: </b><span>index</span></span></span><br><span><var>m</var><span class="hyp-type"><b>: </b><span>message</span></span></span><br><span><var>Hm</var><span class="hyp-type"><b>: </b><span>can_emit (pre_loaded_vlsm (IM j) P) m</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="kr">‚àÄ</span> <span class="nv">m</span> : message,
  Q m ‚à® P m
  ‚Üí Q m
    ‚à® valid_message_prop
        (pre_loaded_vlsm free_composite_vlsm Q) m</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><span class="alectryon-input">itauto.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="Composition-v-chkc9" style="display: none" type="checkbox"><label class="alectryon-input" for="Composition-v-chkc9">-</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>message, index</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>EqDecision0</var><span class="hyp-type"><b>: </b><span>EqDecision index</span></span></span><br><span><var>IM</var><span class="hyp-type"><b>: </b><span>index ‚Üí VLSM message</span></span></span><br><span><var>P, Q</var><span class="hyp-type"><b>: </b><span>message ‚Üí <span class="kt">Prop</span></span></span></span><br><span><var>HPvalid</var><span class="hyp-type"><b>: </b><span><span class="kr">‚àÄ</span> <span class="nv">dm</span> : message,
  P dm
  ‚Üí valid_message_prop
      (pre_loaded_vlsm free_composite_vlsm Q)
      dm</span></span></span><br><span><var>j</var><span class="hyp-type"><b>: </b><span>index</span></span></span><br><span><var>m</var><span class="hyp-type"><b>: </b><span>message</span></span></span><br><span><var>Hm</var><span class="hyp-type"><b>: </b><span>can_emit (pre_loaded_vlsm (IM j) P) m</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">can_emit
  {|
    vtype := vtype free_composite_vlsm;
    vmachine :=
      machine
        (pre_loaded_vlsm free_composite_vlsm
           (<span class="kr">Œª</span> <span class="nv">m</span> : message, Q m ‚à® P m))
  |} m</div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="Composition-v-chkca" style="display: none" type="checkbox"><label class="alectryon-input" for="Composition-v-chkca"><span class="nb">eapply</span> VLSM_full_projection_can_emit; [| <span class="bp">done</span>].</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>message, index</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>EqDecision0</var><span class="hyp-type"><b>: </b><span>EqDecision index</span></span></span><br><span><var>IM</var><span class="hyp-type"><b>: </b><span>index ‚Üí VLSM message</span></span></span><br><span><var>P, Q</var><span class="hyp-type"><b>: </b><span>message ‚Üí <span class="kt">Prop</span></span></span></span><br><span><var>HPvalid</var><span class="hyp-type"><b>: </b><span><span class="kr">‚àÄ</span> <span class="nv">dm</span> : message,
  P dm
  ‚Üí valid_message_prop
      (pre_loaded_vlsm free_composite_vlsm Q)
      dm</span></span></span><br><span><var>j</var><span class="hyp-type"><b>: </b><span>index</span></span></span><br><span><var>m</var><span class="hyp-type"><b>: </b><span>message</span></span></span><br><span><var>Hm</var><span class="hyp-type"><b>: </b><span>can_emit (pre_loaded_vlsm (IM j) P) m</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">VLSM_full_projection (pre_loaded_vlsm (IM j) P)
  {|
    vtype := vtype free_composite_vlsm;
    vmachine :=
      machine
        (pre_loaded_vlsm free_composite_vlsm
           (<span class="kr">Œª</span> <span class="nv">m</span> : message, Q m ‚à® P m))
  |} <span class="nl">?label_project</span> <span class="nl">?state_project</span></div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="Composition-v-chkcb" style="display: none" type="checkbox"><label class="alectryon-input" for="Composition-v-chkcb"><span class="nb">apply</span> lift_to_composite_generalized_preloaded_vlsm_full_projection.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>message, index</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>EqDecision0</var><span class="hyp-type"><b>: </b><span>EqDecision index</span></span></span><br><span><var>IM</var><span class="hyp-type"><b>: </b><span>index ‚Üí VLSM message</span></span></span><br><span><var>P, Q</var><span class="hyp-type"><b>: </b><span>message ‚Üí <span class="kt">Prop</span></span></span></span><br><span><var>HPvalid</var><span class="hyp-type"><b>: </b><span><span class="kr">‚àÄ</span> <span class="nv">dm</span> : message,
  P dm
  ‚Üí valid_message_prop
      (pre_loaded_vlsm free_composite_vlsm Q)
      dm</span></span></span><br><span><var>j</var><span class="hyp-type"><b>: </b><span>index</span></span></span><br><span><var>m</var><span class="hyp-type"><b>: </b><span>message</span></span></span><br><span><var>Hm</var><span class="hyp-type"><b>: </b><span>can_emit (pre_loaded_vlsm (IM j) P) m</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="kr">‚àÄ</span> <span class="nv">m</span> : message, P m ‚Üí Q m ‚à® P m</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><span class="alectryon-input">itauto.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Qed</span>.</span></span></pre><div class="doc">
  As a specialization of <span class="inlinecode"><span class="id" title="var">valid_preloaded_lifts_can_be_emitted</span></span>, if all
  messages described by a predicate <code>P</code> are valid for the free composition,
  then any message which can be emitted by a component pre-loaded with <code>P</code>
  can also be emitted by the free composition.

</div><pre class="alectryon-io highlight"><!-- Generator: Alectryon --><span class="alectryon-sentence"><input class="alectryon-toggle" id="Composition-v-chkcc" style="display: none" type="checkbox"><label class="alectryon-input" for="Composition-v-chkcc"><span class="kn">Lemma</span> <span class="nf">free_valid_preloaded_lifts_can_be_emitted</span>
  (<span class="nv">P</span> : message -&gt; <span class="kt">Prop</span>)
  (<span class="nv">Hdeps</span> : <span class="kr">forall</span> <span class="nv">dm</span>, P dm -&gt; valid_message_prop free_composite_vlsm dm)
  : <span class="kr">forall</span> <span class="nv">i</span> <span class="nv">m</span>, can_emit (pre_loaded_vlsm (IM i) P) m -&gt;
    can_emit free_composite_vlsm m.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>message, index</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>EqDecision0</var><span class="hyp-type"><b>: </b><span>EqDecision index</span></span></span><br><span><var>IM</var><span class="hyp-type"><b>: </b><span>index ‚Üí VLSM message</span></span></span><br><span><var>P</var><span class="hyp-type"><b>: </b><span>message ‚Üí <span class="kt">Prop</span></span></span></span><br><span><var>Hdeps</var><span class="hyp-type"><b>: </b><span><span class="kr">‚àÄ</span> <span class="nv">dm</span> : message,
  P dm
  ‚Üí valid_message_prop free_composite_vlsm dm</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="kr">‚àÄ</span> (<span class="nv">i</span> : index) (<span class="nv">m</span> : message),
  can_emit (pre_loaded_vlsm (IM i) P) m
  ‚Üí can_emit free_composite_vlsm m</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="Composition-v-chkcd" style="display: none" type="checkbox"><label class="alectryon-input" for="Composition-v-chkcd"><span class="kn">Proof</span>.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>message, index</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>EqDecision0</var><span class="hyp-type"><b>: </b><span>EqDecision index</span></span></span><br><span><var>IM</var><span class="hyp-type"><b>: </b><span>index ‚Üí VLSM message</span></span></span><br><span><var>P</var><span class="hyp-type"><b>: </b><span>message ‚Üí <span class="kt">Prop</span></span></span></span><br><span><var>Hdeps</var><span class="hyp-type"><b>: </b><span><span class="kr">‚àÄ</span> <span class="nv">dm</span> : message,
  P dm
  ‚Üí valid_message_prop free_composite_vlsm dm</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="kr">‚àÄ</span> (<span class="nv">i</span> : index) (<span class="nv">m</span> : message),
  can_emit (pre_loaded_vlsm (IM i) P) m
  ‚Üí can_emit free_composite_vlsm m</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="Composition-v-chkce" style="display: none" type="checkbox"><label class="alectryon-input" for="Composition-v-chkce"><span class="nb">intros</span>.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>message, index</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>EqDecision0</var><span class="hyp-type"><b>: </b><span>EqDecision index</span></span></span><br><span><var>IM</var><span class="hyp-type"><b>: </b><span>index ‚Üí VLSM message</span></span></span><br><span><var>P</var><span class="hyp-type"><b>: </b><span>message ‚Üí <span class="kt">Prop</span></span></span></span><br><span><var>Hdeps</var><span class="hyp-type"><b>: </b><span><span class="kr">‚àÄ</span> <span class="nv">dm</span> : message,
  P dm
  ‚Üí valid_message_prop free_composite_vlsm dm</span></span></span><br><span><var>i</var><span class="hyp-type"><b>: </b><span>index</span></span></span><br><span><var>m</var><span class="hyp-type"><b>: </b><span>message</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>can_emit (pre_loaded_vlsm (IM i) P) m</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">can_emit free_composite_vlsm m</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="Composition-v-chkcf" style="display: none" type="checkbox"><label class="alectryon-input" for="Composition-v-chkcf"><span class="nb">eapply</span> VLSM_incl_can_emit.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>message, index</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>EqDecision0</var><span class="hyp-type"><b>: </b><span>EqDecision index</span></span></span><br><span><var>IM</var><span class="hyp-type"><b>: </b><span>index ‚Üí VLSM message</span></span></span><br><span><var>P</var><span class="hyp-type"><b>: </b><span>message ‚Üí <span class="kt">Prop</span></span></span></span><br><span><var>Hdeps</var><span class="hyp-type"><b>: </b><span><span class="kr">‚àÄ</span> <span class="nv">dm</span> : message,
  P dm
  ‚Üí valid_message_prop free_composite_vlsm dm</span></span></span><br><span><var>i</var><span class="hyp-type"><b>: </b><span>index</span></span></span><br><span><var>m</var><span class="hyp-type"><b>: </b><span>message</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>can_emit (pre_loaded_vlsm (IM i) P) m</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">VLSM_incl_part <span class="nl">?MX</span>
  (composite_vlsm_machine free_constraint)</div></blockquote><div class="alectryon-extra-goals"><input class="alectryon-extra-goal-toggle" id="Composition-v-chkd0" style="display: none" type="checkbox"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>message, index</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>EqDecision0</var><span class="hyp-type"><b>: </b><span>EqDecision index</span></span></span><br><span><var>IM</var><span class="hyp-type"><b>: </b><span>index ‚Üí VLSM message</span></span></span><br><span><var>P</var><span class="hyp-type"><b>: </b><span>message ‚Üí <span class="kt">Prop</span></span></span></span><br><span><var>Hdeps</var><span class="hyp-type"><b>: </b><span><span class="kr">‚àÄ</span> <span class="nv">dm</span> : message,
  P dm
  ‚Üí valid_message_prop free_composite_vlsm dm</span></span></span><br><span><var>i</var><span class="hyp-type"><b>: </b><span>index</span></span></span><br><span><var>m</var><span class="hyp-type"><b>: </b><span>message</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>can_emit (pre_loaded_vlsm (IM i) P) m</span></span></span><br></div><label class="goal-separator" for="Composition-v-chkd0"><hr></label><div class="goal-conclusion">can_emit
  {| vtype := composite_type; vmachine := <span class="nl">?MX</span> |} m</div></blockquote></div></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="Composition-v-chkd1" style="display: none" type="checkbox"><label class="alectryon-input" for="Composition-v-chkd1">-</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>message, index</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>EqDecision0</var><span class="hyp-type"><b>: </b><span>EqDecision index</span></span></span><br><span><var>IM</var><span class="hyp-type"><b>: </b><span>index ‚Üí VLSM message</span></span></span><br><span><var>P</var><span class="hyp-type"><b>: </b><span>message ‚Üí <span class="kt">Prop</span></span></span></span><br><span><var>Hdeps</var><span class="hyp-type"><b>: </b><span><span class="kr">‚àÄ</span> <span class="nv">dm</span> : message,
  P dm
  ‚Üí valid_message_prop free_composite_vlsm dm</span></span></span><br><span><var>i</var><span class="hyp-type"><b>: </b><span>index</span></span></span><br><span><var>m</var><span class="hyp-type"><b>: </b><span>message</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>can_emit (pre_loaded_vlsm (IM i) P) m</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">VLSM_incl_part <span class="nl">?MX</span>
  (composite_vlsm_machine free_constraint)</div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="nb">eapply</span> VLSM_eq_proj2, (vlsm_is_pre_loaded_with_False free_composite_vlsm).</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="Composition-v-chkd2" style="display: none" type="checkbox"><label class="alectryon-input" for="Composition-v-chkd2">-</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>message, index</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>EqDecision0</var><span class="hyp-type"><b>: </b><span>EqDecision index</span></span></span><br><span><var>IM</var><span class="hyp-type"><b>: </b><span>index ‚Üí VLSM message</span></span></span><br><span><var>P</var><span class="hyp-type"><b>: </b><span>message ‚Üí <span class="kt">Prop</span></span></span></span><br><span><var>Hdeps</var><span class="hyp-type"><b>: </b><span><span class="kr">‚àÄ</span> <span class="nv">dm</span> : message,
  P dm
  ‚Üí valid_message_prop free_composite_vlsm dm</span></span></span><br><span><var>i</var><span class="hyp-type"><b>: </b><span>index</span></span></span><br><span><var>m</var><span class="hyp-type"><b>: </b><span>message</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>can_emit (pre_loaded_vlsm (IM i) P) m</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">can_emit
  {|
    vtype := composite_type;
    vmachine :=
      machine
        {|
          vtype :=
            {|
              state := composite_state;
              label := composite_label
            |};
          vmachine :=
            machine
              (pre_loaded_vlsm free_composite_vlsm
                 (<span class="kr">Œª</span> <span class="nv">_</span> : message, <span class="kt">False</span>))
        |}
  |} m</div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="Composition-v-chkd3" style="display: none" type="checkbox"><label class="alectryon-input" for="Composition-v-chkd3"><span class="nb">eapply</span> valid_preloaded_lifts_can_be_emitted; [| <span class="bp">done</span>].</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>message, index</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>EqDecision0</var><span class="hyp-type"><b>: </b><span>EqDecision index</span></span></span><br><span><var>IM</var><span class="hyp-type"><b>: </b><span>index ‚Üí VLSM message</span></span></span><br><span><var>P</var><span class="hyp-type"><b>: </b><span>message ‚Üí <span class="kt">Prop</span></span></span></span><br><span><var>Hdeps</var><span class="hyp-type"><b>: </b><span><span class="kr">‚àÄ</span> <span class="nv">dm</span> : message,
  P dm
  ‚Üí valid_message_prop free_composite_vlsm dm</span></span></span><br><span><var>i</var><span class="hyp-type"><b>: </b><span>index</span></span></span><br><span><var>m</var><span class="hyp-type"><b>: </b><span>message</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>can_emit (pre_loaded_vlsm (IM i) P) m</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="kr">‚àÄ</span> <span class="nv">dm</span> : message,
  P dm
  ‚Üí valid_message_prop
      (pre_loaded_vlsm free_composite_vlsm
         (<span class="kr">Œª</span> <span class="nv">_</span> : message, <span class="kt">False</span>)) dm</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="Composition-v-chkd4" style="display: none" type="checkbox"><label class="alectryon-input" for="Composition-v-chkd4"><span class="nb">intros</span> dm Hdm.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>message, index</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>EqDecision0</var><span class="hyp-type"><b>: </b><span>EqDecision index</span></span></span><br><span><var>IM</var><span class="hyp-type"><b>: </b><span>index ‚Üí VLSM message</span></span></span><br><span><var>P</var><span class="hyp-type"><b>: </b><span>message ‚Üí <span class="kt">Prop</span></span></span></span><br><span><var>Hdeps</var><span class="hyp-type"><b>: </b><span><span class="kr">‚àÄ</span> <span class="nv">dm</span> : message,
  P dm
  ‚Üí valid_message_prop free_composite_vlsm dm</span></span></span><br><span><var>i</var><span class="hyp-type"><b>: </b><span>index</span></span></span><br><span><var>m</var><span class="hyp-type"><b>: </b><span>message</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>can_emit (pre_loaded_vlsm (IM i) P) m</span></span></span><br><span><var>dm</var><span class="hyp-type"><b>: </b><span>message</span></span></span><br><span><var>Hdm</var><span class="hyp-type"><b>: </b><span>P dm</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">valid_message_prop
  (pre_loaded_vlsm free_composite_vlsm
     (<span class="kr">Œª</span> <span class="nv">_</span> : message, <span class="kt">False</span>)) dm</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="Composition-v-chkd5" style="display: none" type="checkbox"><label class="alectryon-input" for="Composition-v-chkd5"><span class="nb">eapply</span> VLSM_incl_valid_message.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>message, index</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>EqDecision0</var><span class="hyp-type"><b>: </b><span>EqDecision index</span></span></span><br><span><var>IM</var><span class="hyp-type"><b>: </b><span>index ‚Üí VLSM message</span></span></span><br><span><var>P</var><span class="hyp-type"><b>: </b><span>message ‚Üí <span class="kt">Prop</span></span></span></span><br><span><var>Hdeps</var><span class="hyp-type"><b>: </b><span><span class="kr">‚àÄ</span> <span class="nv">dm</span> : message,
  P dm
  ‚Üí valid_message_prop free_composite_vlsm dm</span></span></span><br><span><var>i</var><span class="hyp-type"><b>: </b><span>index</span></span></span><br><span><var>m</var><span class="hyp-type"><b>: </b><span>message</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>can_emit (pre_loaded_vlsm (IM i) P) m</span></span></span><br><span><var>dm</var><span class="hyp-type"><b>: </b><span>message</span></span></span><br><span><var>Hdm</var><span class="hyp-type"><b>: </b><span>P dm</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">VLSM_incl_part <span class="nl">?MX</span>
  (VLSMMachine_pre_loaded_with_messages
     (vmachine free_composite_vlsm)
     (<span class="kr">Œª</span> <span class="nv">_</span> : message, <span class="kt">False</span>))</div></blockquote><div class="alectryon-extra-goals"><input class="alectryon-extra-goal-toggle" id="Composition-v-chkd6" style="display: none" type="checkbox"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>message, index</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>EqDecision0</var><span class="hyp-type"><b>: </b><span>EqDecision index</span></span></span><br><span><var>IM</var><span class="hyp-type"><b>: </b><span>index ‚Üí VLSM message</span></span></span><br><span><var>P</var><span class="hyp-type"><b>: </b><span>message ‚Üí <span class="kt">Prop</span></span></span></span><br><span><var>Hdeps</var><span class="hyp-type"><b>: </b><span><span class="kr">‚àÄ</span> <span class="nv">dm</span> : message,
  P dm
  ‚Üí valid_message_prop free_composite_vlsm dm</span></span></span><br><span><var>i</var><span class="hyp-type"><b>: </b><span>index</span></span></span><br><span><var>m</var><span class="hyp-type"><b>: </b><span>message</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>can_emit (pre_loaded_vlsm (IM i) P) m</span></span></span><br><span><var>dm</var><span class="hyp-type"><b>: </b><span>message</span></span></span><br><span><var>Hdm</var><span class="hyp-type"><b>: </b><span>P dm</span></span></span><br></div><label class="goal-separator" for="Composition-v-chkd6"><hr></label><div class="goal-conclusion">strong_incl_initial_message_preservation 
  <span class="nl">?MX</span>
  (VLSMMachine_pre_loaded_with_messages
     (vmachine free_composite_vlsm)
     (<span class="kr">Œª</span> <span class="nv">_</span> : message, <span class="kt">False</span>))</div></blockquote><input class="alectryon-extra-goal-toggle" id="Composition-v-chkd7" style="display: none" type="checkbox"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>message, index</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>EqDecision0</var><span class="hyp-type"><b>: </b><span>EqDecision index</span></span></span><br><span><var>IM</var><span class="hyp-type"><b>: </b><span>index ‚Üí VLSM message</span></span></span><br><span><var>P</var><span class="hyp-type"><b>: </b><span>message ‚Üí <span class="kt">Prop</span></span></span></span><br><span><var>Hdeps</var><span class="hyp-type"><b>: </b><span><span class="kr">‚àÄ</span> <span class="nv">dm</span> : message,
  P dm
  ‚Üí valid_message_prop free_composite_vlsm dm</span></span></span><br><span><var>i</var><span class="hyp-type"><b>: </b><span>index</span></span></span><br><span><var>m</var><span class="hyp-type"><b>: </b><span>message</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>can_emit (pre_loaded_vlsm (IM i) P) m</span></span></span><br><span><var>dm</var><span class="hyp-type"><b>: </b><span>message</span></span></span><br><span><var>Hdm</var><span class="hyp-type"><b>: </b><span>P dm</span></span></span><br></div><label class="goal-separator" for="Composition-v-chkd7"><hr></label><div class="goal-conclusion">valid_message_prop
  {|
    vtype := vtype free_composite_vlsm;
    vmachine := <span class="nl">?MX</span>
  |} dm</div></blockquote></div></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="Composition-v-chkd8" style="display: none" type="checkbox"><label class="alectryon-input" for="Composition-v-chkd8">+</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>message, index</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>EqDecision0</var><span class="hyp-type"><b>: </b><span>EqDecision index</span></span></span><br><span><var>IM</var><span class="hyp-type"><b>: </b><span>index ‚Üí VLSM message</span></span></span><br><span><var>P</var><span class="hyp-type"><b>: </b><span>message ‚Üí <span class="kt">Prop</span></span></span></span><br><span><var>Hdeps</var><span class="hyp-type"><b>: </b><span><span class="kr">‚àÄ</span> <span class="nv">dm</span> : message,
  P dm
  ‚Üí valid_message_prop free_composite_vlsm dm</span></span></span><br><span><var>i</var><span class="hyp-type"><b>: </b><span>index</span></span></span><br><span><var>m</var><span class="hyp-type"><b>: </b><span>message</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>can_emit (pre_loaded_vlsm (IM i) P) m</span></span></span><br><span><var>dm</var><span class="hyp-type"><b>: </b><span>message</span></span></span><br><span><var>Hdm</var><span class="hyp-type"><b>: </b><span>P dm</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">VLSM_incl_part <span class="nl">?MX</span>
  (VLSMMachine_pre_loaded_with_messages
     (vmachine free_composite_vlsm)
     (<span class="kr">Œª</span> <span class="nv">_</span> : message, <span class="kt">False</span>))</div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="nb">apply</span> VLSM_eq_proj1, (vlsm_is_pre_loaded_with_False free_composite_vlsm).</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="Composition-v-chkd9" style="display: none" type="checkbox"><label class="alectryon-input" for="Composition-v-chkd9">+</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>message, index</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>EqDecision0</var><span class="hyp-type"><b>: </b><span>EqDecision index</span></span></span><br><span><var>IM</var><span class="hyp-type"><b>: </b><span>index ‚Üí VLSM message</span></span></span><br><span><var>P</var><span class="hyp-type"><b>: </b><span>message ‚Üí <span class="kt">Prop</span></span></span></span><br><span><var>Hdeps</var><span class="hyp-type"><b>: </b><span><span class="kr">‚àÄ</span> <span class="nv">dm</span> : message,
  P dm
  ‚Üí valid_message_prop free_composite_vlsm dm</span></span></span><br><span><var>i</var><span class="hyp-type"><b>: </b><span>index</span></span></span><br><span><var>m</var><span class="hyp-type"><b>: </b><span>message</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>can_emit (pre_loaded_vlsm (IM i) P) m</span></span></span><br><span><var>dm</var><span class="hyp-type"><b>: </b><span>message</span></span></span><br><span><var>Hdm</var><span class="hyp-type"><b>: </b><span>P dm</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">strong_incl_initial_message_preservation
  (machine
     {|
       vtype := composite_type;
       vmachine :=
         composite_vlsm_machine free_constraint
     |})
  (VLSMMachine_pre_loaded_with_messages
     (vmachine free_composite_vlsm)
     (<span class="kr">Œª</span> <span class="nv">_</span> : message, <span class="kt">False</span>))</div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="nb">cbv</span>; itauto.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="Composition-v-chkda" style="display: none" type="checkbox"><label class="alectryon-input" for="Composition-v-chkda">+</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>message, index</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>EqDecision0</var><span class="hyp-type"><b>: </b><span>EqDecision index</span></span></span><br><span><var>IM</var><span class="hyp-type"><b>: </b><span>index ‚Üí VLSM message</span></span></span><br><span><var>P</var><span class="hyp-type"><b>: </b><span>message ‚Üí <span class="kt">Prop</span></span></span></span><br><span><var>Hdeps</var><span class="hyp-type"><b>: </b><span><span class="kr">‚àÄ</span> <span class="nv">dm</span> : message,
  P dm
  ‚Üí valid_message_prop free_composite_vlsm dm</span></span></span><br><span><var>i</var><span class="hyp-type"><b>: </b><span>index</span></span></span><br><span><var>m</var><span class="hyp-type"><b>: </b><span>message</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>can_emit (pre_loaded_vlsm (IM i) P) m</span></span></span><br><span><var>dm</var><span class="hyp-type"><b>: </b><span>message</span></span></span><br><span><var>Hdm</var><span class="hyp-type"><b>: </b><span>P dm</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">valid_message_prop
  {|
    vtype := vtype free_composite_vlsm;
    vmachine :=
      machine
        {|
          vtype := composite_type;
          vmachine :=
            composite_vlsm_machine free_constraint
        |}
  |} dm</div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="bp">by</span> <span class="nb">apply</span> Hdeps.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Qed</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
</span><span class="alectryon-sentence"><input class="alectryon-toggle" id="Composition-v-chkdb" style="display: none" type="checkbox"><label class="alectryon-input" for="Composition-v-chkdb"><span class="kn">Lemma</span> <span class="nf">valid_state_preloaded_composite_free_lift</span>
  (<span class="nv">j</span> : index)
  (<span class="nv">sj</span> : vstate (IM j))
  (<span class="nv">Hp</span> : valid_state_prop (pre_loaded_with_all_messages_vlsm (IM j)) sj)
  : valid_state_prop (pre_loaded_with_all_messages_vlsm free_composite_vlsm) (lift_to_composite_state&#39; j sj).</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>message, index</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>EqDecision0</var><span class="hyp-type"><b>: </b><span>EqDecision index</span></span></span><br><span><var>IM</var><span class="hyp-type"><b>: </b><span>index ‚Üí VLSM message</span></span></span><br><span><var>j</var><span class="hyp-type"><b>: </b><span>index</span></span></span><br><span><var>sj</var><span class="hyp-type"><b>: </b><span>vstate (IM j)</span></span></span><br><span><var>Hp</var><span class="hyp-type"><b>: </b><span>valid_state_prop
  (pre_loaded_with_all_messages_vlsm (IM j)) sj</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">valid_state_prop
  (pre_loaded_with_all_messages_vlsm
     free_composite_vlsm)
  (lift_to_composite_state&#39; j sj)</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="Composition-v-chkdc" style="display: none" type="checkbox"><label class="alectryon-input" for="Composition-v-chkdc"><span class="kn">Proof</span>.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>message, index</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>EqDecision0</var><span class="hyp-type"><b>: </b><span>EqDecision index</span></span></span><br><span><var>IM</var><span class="hyp-type"><b>: </b><span>index ‚Üí VLSM message</span></span></span><br><span><var>j</var><span class="hyp-type"><b>: </b><span>index</span></span></span><br><span><var>sj</var><span class="hyp-type"><b>: </b><span>vstate (IM j)</span></span></span><br><span><var>Hp</var><span class="hyp-type"><b>: </b><span>valid_state_prop
  (pre_loaded_with_all_messages_vlsm (IM j)) sj</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">valid_state_prop
  (pre_loaded_with_all_messages_vlsm
     free_composite_vlsm)
  (lift_to_composite_state&#39; j sj)</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><span class="alectryon-input"><span class="bp">by</span> <span class="nb">apply</span> (VLSM_full_projection_valid_state (lift_to_composite_preloaded_vlsm_full_projection j)).</span><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Qed</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
</span><span class="alectryon-sentence"><input class="alectryon-toggle" id="Composition-v-chkdd" style="display: none" type="checkbox"><label class="alectryon-input" for="Composition-v-chkdd"><span class="kn">Lemma</span> <span class="nf">can_emit_composite_free_lift</span>
  (<span class="nv">P</span> <span class="nv">Q</span> : message -&gt; <span class="kt">Prop</span>)
  (<span class="nv">PimpliesQ</span> : <span class="kr">forall</span> <span class="nv">m</span>, P m -&gt; Q m)
  (<span class="nv">j</span> : index)
  (<span class="nv">m</span> : message)
  (<span class="nv">Htrj</span> : can_emit (pre_loaded_vlsm (IM j) P) m)
  : can_emit (pre_loaded_vlsm free_composite_vlsm Q) m.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>message, index</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>EqDecision0</var><span class="hyp-type"><b>: </b><span>EqDecision index</span></span></span><br><span><var>IM</var><span class="hyp-type"><b>: </b><span>index ‚Üí VLSM message</span></span></span><br><span><var>P, Q</var><span class="hyp-type"><b>: </b><span>message ‚Üí <span class="kt">Prop</span></span></span></span><br><span><var>PimpliesQ</var><span class="hyp-type"><b>: </b><span><span class="kr">‚àÄ</span> <span class="nv">m</span> : message, P m ‚Üí Q m</span></span></span><br><span><var>j</var><span class="hyp-type"><b>: </b><span>index</span></span></span><br><span><var>m</var><span class="hyp-type"><b>: </b><span>message</span></span></span><br><span><var>Htrj</var><span class="hyp-type"><b>: </b><span>can_emit (pre_loaded_vlsm (IM j) P) m</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">can_emit (pre_loaded_vlsm free_composite_vlsm Q) m</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="Composition-v-chkde" style="display: none" type="checkbox"><label class="alectryon-input" for="Composition-v-chkde"><span class="kn">Proof</span>.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>message, index</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>EqDecision0</var><span class="hyp-type"><b>: </b><span>EqDecision index</span></span></span><br><span><var>IM</var><span class="hyp-type"><b>: </b><span>index ‚Üí VLSM message</span></span></span><br><span><var>P, Q</var><span class="hyp-type"><b>: </b><span>message ‚Üí <span class="kt">Prop</span></span></span></span><br><span><var>PimpliesQ</var><span class="hyp-type"><b>: </b><span><span class="kr">‚àÄ</span> <span class="nv">m</span> : message, P m ‚Üí Q m</span></span></span><br><span><var>j</var><span class="hyp-type"><b>: </b><span>index</span></span></span><br><span><var>m</var><span class="hyp-type"><b>: </b><span>message</span></span></span><br><span><var>Htrj</var><span class="hyp-type"><b>: </b><span>can_emit (pre_loaded_vlsm (IM j) P) m</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">can_emit (pre_loaded_vlsm free_composite_vlsm Q) m</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="Composition-v-chkdf" style="display: none" type="checkbox"><label class="alectryon-input" for="Composition-v-chkdf"><span class="nb">eapply</span> VLSM_full_projection_can_emit.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>message, index</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>EqDecision0</var><span class="hyp-type"><b>: </b><span>EqDecision index</span></span></span><br><span><var>IM</var><span class="hyp-type"><b>: </b><span>index ‚Üí VLSM message</span></span></span><br><span><var>P, Q</var><span class="hyp-type"><b>: </b><span>message ‚Üí <span class="kt">Prop</span></span></span></span><br><span><var>PimpliesQ</var><span class="hyp-type"><b>: </b><span><span class="kr">‚àÄ</span> <span class="nv">m</span> : message, P m ‚Üí Q m</span></span></span><br><span><var>j</var><span class="hyp-type"><b>: </b><span>index</span></span></span><br><span><var>m</var><span class="hyp-type"><b>: </b><span>message</span></span></span><br><span><var>Htrj</var><span class="hyp-type"><b>: </b><span>can_emit (pre_loaded_vlsm (IM j) P) m</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">VLSM_full_projection <span class="nl">?X</span>
  (pre_loaded_vlsm free_composite_vlsm Q)
  <span class="nl">?label_project</span> <span class="nl">?state_project</span></div></blockquote><div class="alectryon-extra-goals"><input class="alectryon-extra-goal-toggle" id="Composition-v-chke0" style="display: none" type="checkbox"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>message, index</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>EqDecision0</var><span class="hyp-type"><b>: </b><span>EqDecision index</span></span></span><br><span><var>IM</var><span class="hyp-type"><b>: </b><span>index ‚Üí VLSM message</span></span></span><br><span><var>P, Q</var><span class="hyp-type"><b>: </b><span>message ‚Üí <span class="kt">Prop</span></span></span></span><br><span><var>PimpliesQ</var><span class="hyp-type"><b>: </b><span><span class="kr">‚àÄ</span> <span class="nv">m</span> : message, P m ‚Üí Q m</span></span></span><br><span><var>j</var><span class="hyp-type"><b>: </b><span>index</span></span></span><br><span><var>m</var><span class="hyp-type"><b>: </b><span>message</span></span></span><br><span><var>Htrj</var><span class="hyp-type"><b>: </b><span>can_emit (pre_loaded_vlsm (IM j) P) m</span></span></span><br></div><label class="goal-separator" for="Composition-v-chke0"><hr></label><div class="goal-conclusion">can_emit <span class="nl">?X</span> m</div></blockquote></div></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="Composition-v-chke1" style="display: none" type="checkbox"><label class="alectryon-input" for="Composition-v-chke1">-</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>message, index</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>EqDecision0</var><span class="hyp-type"><b>: </b><span>EqDecision index</span></span></span><br><span><var>IM</var><span class="hyp-type"><b>: </b><span>index ‚Üí VLSM message</span></span></span><br><span><var>P, Q</var><span class="hyp-type"><b>: </b><span>message ‚Üí <span class="kt">Prop</span></span></span></span><br><span><var>PimpliesQ</var><span class="hyp-type"><b>: </b><span><span class="kr">‚àÄ</span> <span class="nv">m</span> : message, P m ‚Üí Q m</span></span></span><br><span><var>j</var><span class="hyp-type"><b>: </b><span>index</span></span></span><br><span><var>m</var><span class="hyp-type"><b>: </b><span>message</span></span></span><br><span><var>Htrj</var><span class="hyp-type"><b>: </b><span>can_emit (pre_loaded_vlsm (IM j) P) m</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">VLSM_full_projection <span class="nl">?X</span>
  (pre_loaded_vlsm free_composite_vlsm Q)
  <span class="nl">?label_project</span> <span class="nl">?state_project</span></div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="bp">by</span> <span class="nb">apply</span> lift_to_composite_generalized_preloaded_vlsm_full_projection.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="Composition-v-chke2" style="display: none" type="checkbox"><label class="alectryon-input" for="Composition-v-chke2">-</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>message, index</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>EqDecision0</var><span class="hyp-type"><b>: </b><span>EqDecision index</span></span></span><br><span><var>IM</var><span class="hyp-type"><b>: </b><span>index ‚Üí VLSM message</span></span></span><br><span><var>P, Q</var><span class="hyp-type"><b>: </b><span>message ‚Üí <span class="kt">Prop</span></span></span></span><br><span><var>PimpliesQ</var><span class="hyp-type"><b>: </b><span><span class="kr">‚àÄ</span> <span class="nv">m</span> : message, P m ‚Üí Q m</span></span></span><br><span><var>j</var><span class="hyp-type"><b>: </b><span>index</span></span></span><br><span><var>m</var><span class="hyp-type"><b>: </b><span>message</span></span></span><br><span><var>Htrj</var><span class="hyp-type"><b>: </b><span>can_emit (pre_loaded_vlsm (IM j) P) m</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">can_emit (pre_loaded_vlsm (IM <span class="nl">?j</span>) P) m</div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="bp">done</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Qed</span>.</span></span></pre><div class="doc">
  Updating a composite initial state with a component initial state
  yields a composite initial state

</div><pre class="alectryon-io highlight"><!-- Generator: Alectryon --><span class="alectryon-sentence"><input class="alectryon-toggle" id="Composition-v-chke3" style="display: none" type="checkbox"><label class="alectryon-input" for="Composition-v-chke3"><span class="kn">Lemma</span> <span class="nf">composite_update_initial_state_with_initial</span>
  (<span class="nv">s</span> : composite_state)
  (<span class="nv">Hs</span> : composite_initial_state_prop s)
  (<span class="nv">i</span> : index)
  (<span class="nv">si</span> : vstate (IM i))
  (<span class="nv">Hsi</span> : vinitial_state_prop (IM i) si)
  : composite_initial_state_prop (state_update s i si).</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>message, index</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>EqDecision0</var><span class="hyp-type"><b>: </b><span>EqDecision index</span></span></span><br><span><var>IM</var><span class="hyp-type"><b>: </b><span>index ‚Üí VLSM message</span></span></span><br><span><var>s</var><span class="hyp-type"><b>: </b><span>composite_state</span></span></span><br><span><var>Hs</var><span class="hyp-type"><b>: </b><span>composite_initial_state_prop s</span></span></span><br><span><var>i</var><span class="hyp-type"><b>: </b><span>index</span></span></span><br><span><var>si</var><span class="hyp-type"><b>: </b><span>vstate (IM i)</span></span></span><br><span><var>Hsi</var><span class="hyp-type"><b>: </b><span>vinitial_state_prop (IM i) si</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">composite_initial_state_prop (state_update s i si)</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="Composition-v-chke4" style="display: none" type="checkbox"><label class="alectryon-input" for="Composition-v-chke4"><span class="kn">Proof</span>.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>message, index</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>EqDecision0</var><span class="hyp-type"><b>: </b><span>EqDecision index</span></span></span><br><span><var>IM</var><span class="hyp-type"><b>: </b><span>index ‚Üí VLSM message</span></span></span><br><span><var>s</var><span class="hyp-type"><b>: </b><span>composite_state</span></span></span><br><span><var>Hs</var><span class="hyp-type"><b>: </b><span>composite_initial_state_prop s</span></span></span><br><span><var>i</var><span class="hyp-type"><b>: </b><span>index</span></span></span><br><span><var>si</var><span class="hyp-type"><b>: </b><span>vstate (IM i)</span></span></span><br><span><var>Hsi</var><span class="hyp-type"><b>: </b><span>vinitial_state_prop (IM i) si</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">composite_initial_state_prop (state_update s i si)</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="Composition-v-chke5" style="display: none" type="checkbox"><label class="alectryon-input" for="Composition-v-chke5"><span class="nb">intro</span> j.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>message, index</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>EqDecision0</var><span class="hyp-type"><b>: </b><span>EqDecision index</span></span></span><br><span><var>IM</var><span class="hyp-type"><b>: </b><span>index ‚Üí VLSM message</span></span></span><br><span><var>s</var><span class="hyp-type"><b>: </b><span>composite_state</span></span></span><br><span><var>Hs</var><span class="hyp-type"><b>: </b><span>composite_initial_state_prop s</span></span></span><br><span><var>i</var><span class="hyp-type"><b>: </b><span>index</span></span></span><br><span><var>si</var><span class="hyp-type"><b>: </b><span>vstate (IM i)</span></span></span><br><span><var>Hsi</var><span class="hyp-type"><b>: </b><span>vinitial_state_prop (IM i) si</span></span></span><br><span><var>j</var><span class="hyp-type"><b>: </b><span>index</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">vinitial_state_prop (IM j) (state_update s i si j)</div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="Composition-v-chke6" style="display: none" type="checkbox"><label class="alectryon-input" for="Composition-v-chke6"><span class="nb">destruct</span> (decide (j = i)); <span class="nb">subst</span>.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>message, index</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>EqDecision0</var><span class="hyp-type"><b>: </b><span>EqDecision index</span></span></span><br><span><var>IM</var><span class="hyp-type"><b>: </b><span>index ‚Üí VLSM message</span></span></span><br><span><var>s</var><span class="hyp-type"><b>: </b><span>composite_state</span></span></span><br><span><var>Hs</var><span class="hyp-type"><b>: </b><span>composite_initial_state_prop s</span></span></span><br><span><var>i</var><span class="hyp-type"><b>: </b><span>index</span></span></span><br><span><var>si</var><span class="hyp-type"><b>: </b><span>vstate (IM i)</span></span></span><br><span><var>Hsi</var><span class="hyp-type"><b>: </b><span>vinitial_state_prop (IM i) si</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">vinitial_state_prop (IM i) (state_update s i si i)</div></blockquote><div class="alectryon-extra-goals"><input class="alectryon-extra-goal-toggle" id="Composition-v-chke7" style="display: none" type="checkbox"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>message, index</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>EqDecision0</var><span class="hyp-type"><b>: </b><span>EqDecision index</span></span></span><br><span><var>IM</var><span class="hyp-type"><b>: </b><span>index ‚Üí VLSM message</span></span></span><br><span><var>s</var><span class="hyp-type"><b>: </b><span>composite_state</span></span></span><br><span><var>Hs</var><span class="hyp-type"><b>: </b><span>composite_initial_state_prop s</span></span></span><br><span><var>i</var><span class="hyp-type"><b>: </b><span>index</span></span></span><br><span><var>si</var><span class="hyp-type"><b>: </b><span>vstate (IM i)</span></span></span><br><span><var>Hsi</var><span class="hyp-type"><b>: </b><span>vinitial_state_prop (IM i) si</span></span></span><br><span><var>j</var><span class="hyp-type"><b>: </b><span>index</span></span></span><br><span><var>n</var><span class="hyp-type"><b>: </b><span>j ‚â† i</span></span></span><br></div><label class="goal-separator" for="Composition-v-chke7"><hr></label><div class="goal-conclusion">vinitial_state_prop (IM j) (state_update s i si j)</div></blockquote></div></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="Composition-v-chke8" style="display: none" type="checkbox"><label class="alectryon-input" for="Composition-v-chke8">-</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>message, index</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>EqDecision0</var><span class="hyp-type"><b>: </b><span>EqDecision index</span></span></span><br><span><var>IM</var><span class="hyp-type"><b>: </b><span>index ‚Üí VLSM message</span></span></span><br><span><var>s</var><span class="hyp-type"><b>: </b><span>composite_state</span></span></span><br><span><var>Hs</var><span class="hyp-type"><b>: </b><span>composite_initial_state_prop s</span></span></span><br><span><var>i</var><span class="hyp-type"><b>: </b><span>index</span></span></span><br><span><var>si</var><span class="hyp-type"><b>: </b><span>vstate (IM i)</span></span></span><br><span><var>Hsi</var><span class="hyp-type"><b>: </b><span>vinitial_state_prop (IM i) si</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">vinitial_state_prop (IM i) (state_update s i si i)</div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="bp">by</span> <span class="nb">rewrite</span> state_update_eq.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="Composition-v-chke9" style="display: none" type="checkbox"><label class="alectryon-input" for="Composition-v-chke9">-</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>message, index</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>EqDecision0</var><span class="hyp-type"><b>: </b><span>EqDecision index</span></span></span><br><span><var>IM</var><span class="hyp-type"><b>: </b><span>index ‚Üí VLSM message</span></span></span><br><span><var>s</var><span class="hyp-type"><b>: </b><span>composite_state</span></span></span><br><span><var>Hs</var><span class="hyp-type"><b>: </b><span>composite_initial_state_prop s</span></span></span><br><span><var>i</var><span class="hyp-type"><b>: </b><span>index</span></span></span><br><span><var>si</var><span class="hyp-type"><b>: </b><span>vstate (IM i)</span></span></span><br><span><var>Hsi</var><span class="hyp-type"><b>: </b><span>vinitial_state_prop (IM i) si</span></span></span><br><span><var>j</var><span class="hyp-type"><b>: </b><span>index</span></span></span><br><span><var>n</var><span class="hyp-type"><b>: </b><span>j ‚â† i</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">vinitial_state_prop (IM j) (state_update s i si j)</div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="bp">by</span> <span class="nb">rewrite</span> state_update_neq.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Qed</span>.</span></span></pre><div class="doc">
  Updating a composite <span class="inlinecode"><span class="id" title="var">valid_state</span></span> for the free composition with
  a component initial state yields a composite <span class="inlinecode"><span class="id" title="var">valid_state</span></span>
</div><pre class="alectryon-io highlight"><!-- Generator: Alectryon --><span class="alectryon-sentence"><input class="alectryon-toggle" id="Composition-v-chkea" style="display: none" type="checkbox"><label class="alectryon-input" for="Composition-v-chkea"><span class="kn">Lemma</span> <span class="nf">pre_composite_free_update_state_with_initial</span>
  (<span class="nv">P</span> : message -&gt; <span class="kt">Prop</span>)
  (<span class="nv">s</span> : composite_state)
  (<span class="nv">Hs</span> : valid_state_prop (pre_loaded_vlsm free_composite_vlsm P) s)
  (<span class="nv">i</span> : index)
  (<span class="nv">si</span> : vstate (IM i))
  (<span class="nv">Hsi</span> : vinitial_state_prop (IM i) si)
  : valid_state_prop (pre_loaded_vlsm free_composite_vlsm P) (state_update s i si).</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>message, index</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>EqDecision0</var><span class="hyp-type"><b>: </b><span>EqDecision index</span></span></span><br><span><var>IM</var><span class="hyp-type"><b>: </b><span>index ‚Üí VLSM message</span></span></span><br><span><var>P</var><span class="hyp-type"><b>: </b><span>message ‚Üí <span class="kt">Prop</span></span></span></span><br><span><var>s</var><span class="hyp-type"><b>: </b><span>composite_state</span></span></span><br><span><var>Hs</var><span class="hyp-type"><b>: </b><span>valid_state_prop
  (pre_loaded_vlsm free_composite_vlsm P) s</span></span></span><br><span><var>i</var><span class="hyp-type"><b>: </b><span>index</span></span></span><br><span><var>si</var><span class="hyp-type"><b>: </b><span>vstate (IM i)</span></span></span><br><span><var>Hsi</var><span class="hyp-type"><b>: </b><span>vinitial_state_prop (IM i) si</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">valid_state_prop
  (pre_loaded_vlsm free_composite_vlsm P)
  (state_update s i si)</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="Composition-v-chkeb" style="display: none" type="checkbox"><label class="alectryon-input" for="Composition-v-chkeb"><span class="kn">Proof</span>.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>message, index</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>EqDecision0</var><span class="hyp-type"><b>: </b><span>EqDecision index</span></span></span><br><span><var>IM</var><span class="hyp-type"><b>: </b><span>index ‚Üí VLSM message</span></span></span><br><span><var>P</var><span class="hyp-type"><b>: </b><span>message ‚Üí <span class="kt">Prop</span></span></span></span><br><span><var>s</var><span class="hyp-type"><b>: </b><span>composite_state</span></span></span><br><span><var>Hs</var><span class="hyp-type"><b>: </b><span>valid_state_prop
  (pre_loaded_vlsm free_composite_vlsm P) s</span></span></span><br><span><var>i</var><span class="hyp-type"><b>: </b><span>index</span></span></span><br><span><var>si</var><span class="hyp-type"><b>: </b><span>vstate (IM i)</span></span></span><br><span><var>Hsi</var><span class="hyp-type"><b>: </b><span>vinitial_state_prop (IM i) si</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">valid_state_prop
  (pre_loaded_vlsm free_composite_vlsm P)
  (state_update s i si)</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="Composition-v-chkec" style="display: none" type="checkbox"><label class="alectryon-input" for="Composition-v-chkec"><span class="nb">induction</span> Hs <span class="nb">using</span> valid_state_prop_ind.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>message, index</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>EqDecision0</var><span class="hyp-type"><b>: </b><span>EqDecision index</span></span></span><br><span><var>IM</var><span class="hyp-type"><b>: </b><span>index ‚Üí VLSM message</span></span></span><br><span><var>P</var><span class="hyp-type"><b>: </b><span>message ‚Üí <span class="kt">Prop</span></span></span></span><br><span><var>s</var><span class="hyp-type"><b>: </b><span>state</span></span></span><br><span><var>Hs</var><span class="hyp-type"><b>: </b><span>initial_state_prop s</span></span></span><br><span><var>i</var><span class="hyp-type"><b>: </b><span>index</span></span></span><br><span><var>si</var><span class="hyp-type"><b>: </b><span>vstate (IM i)</span></span></span><br><span><var>Hsi</var><span class="hyp-type"><b>: </b><span>vinitial_state_prop (IM i) si</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">valid_state_prop
  (pre_loaded_vlsm free_composite_vlsm P)
  (state_update s i si)</div></blockquote><div class="alectryon-extra-goals"><input class="alectryon-extra-goal-toggle" id="Composition-v-chked" style="display: none" type="checkbox"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>message, index</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>EqDecision0</var><span class="hyp-type"><b>: </b><span>EqDecision index</span></span></span><br><span><var>IM</var><span class="hyp-type"><b>: </b><span>index ‚Üí VLSM message</span></span></span><br><span><var>P</var><span class="hyp-type"><b>: </b><span>message ‚Üí <span class="kt">Prop</span></span></span></span><br><span><var>s'</var><span class="hyp-type"><b>: </b><span>state</span></span></span><br><span><var>l</var><span class="hyp-type"><b>: </b><span>label</span></span></span><br><span><var>om, om'</var><span class="hyp-type"><b>: </b><span>option message</span></span></span><br><span><var>s</var><span class="hyp-type"><b>: </b><span>state</span></span></span><br><span><var>Ht</var><span class="hyp-type"><b>: </b><span>input_valid_transition
  (pre_loaded_vlsm free_composite_vlsm P) l
  (s, om) (s&#39;, om&#39;)</span></span></span><br><span><var>i</var><span class="hyp-type"><b>: </b><span>index</span></span></span><br><span><var>si</var><span class="hyp-type"><b>: </b><span>vstate (IM i)</span></span></span><br><span><var>Hsi</var><span class="hyp-type"><b>: </b><span>vinitial_state_prop (IM i) si</span></span></span><br><span><var>IHHs</var><span class="hyp-type"><b>: </b><span>valid_state_prop
  (pre_loaded_vlsm free_composite_vlsm P)
  (state_update s i si)</span></span></span><br></div><label class="goal-separator" for="Composition-v-chked"><hr></label><div class="goal-conclusion">valid_state_prop
  (pre_loaded_vlsm free_composite_vlsm P)
  (state_update s&#39; i si)</div></blockquote></div></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="Composition-v-chkee" style="display: none" type="checkbox"><label class="alectryon-input" for="Composition-v-chkee">-</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>message, index</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>EqDecision0</var><span class="hyp-type"><b>: </b><span>EqDecision index</span></span></span><br><span><var>IM</var><span class="hyp-type"><b>: </b><span>index ‚Üí VLSM message</span></span></span><br><span><var>P</var><span class="hyp-type"><b>: </b><span>message ‚Üí <span class="kt">Prop</span></span></span></span><br><span><var>s</var><span class="hyp-type"><b>: </b><span>state</span></span></span><br><span><var>Hs</var><span class="hyp-type"><b>: </b><span>initial_state_prop s</span></span></span><br><span><var>i</var><span class="hyp-type"><b>: </b><span>index</span></span></span><br><span><var>si</var><span class="hyp-type"><b>: </b><span>vstate (IM i)</span></span></span><br><span><var>Hsi</var><span class="hyp-type"><b>: </b><span>vinitial_state_prop (IM i) si</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">valid_state_prop
  (pre_loaded_vlsm free_composite_vlsm P)
  (state_update s i si)</div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="bp">by</span> <span class="nb">apply</span> initial_state_is_valid, composite_update_initial_state_with_initial.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="Composition-v-chkef" style="display: none" type="checkbox"><label class="alectryon-input" for="Composition-v-chkef">-</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>message, index</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>EqDecision0</var><span class="hyp-type"><b>: </b><span>EqDecision index</span></span></span><br><span><var>IM</var><span class="hyp-type"><b>: </b><span>index ‚Üí VLSM message</span></span></span><br><span><var>P</var><span class="hyp-type"><b>: </b><span>message ‚Üí <span class="kt">Prop</span></span></span></span><br><span><var>s'</var><span class="hyp-type"><b>: </b><span>state</span></span></span><br><span><var>l</var><span class="hyp-type"><b>: </b><span>label</span></span></span><br><span><var>om, om'</var><span class="hyp-type"><b>: </b><span>option message</span></span></span><br><span><var>s</var><span class="hyp-type"><b>: </b><span>state</span></span></span><br><span><var>Ht</var><span class="hyp-type"><b>: </b><span>input_valid_transition
  (pre_loaded_vlsm free_composite_vlsm P) l
  (s, om) (s&#39;, om&#39;)</span></span></span><br><span><var>i</var><span class="hyp-type"><b>: </b><span>index</span></span></span><br><span><var>si</var><span class="hyp-type"><b>: </b><span>vstate (IM i)</span></span></span><br><span><var>Hsi</var><span class="hyp-type"><b>: </b><span>vinitial_state_prop (IM i) si</span></span></span><br><span><var>IHHs</var><span class="hyp-type"><b>: </b><span>valid_state_prop
  (pre_loaded_vlsm free_composite_vlsm P)
  (state_update s i si)</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">valid_state_prop
  (pre_loaded_vlsm free_composite_vlsm P)
  (state_update s&#39; i si)</div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="Composition-v-chkf0" style="display: none" type="checkbox"><label class="alectryon-input" for="Composition-v-chkf0"><span class="nb">destruct</span> Ht <span class="kr">as</span> [[Hps [Hom [Hv _]]] Ht]; <span class="nb">cbn</span> <span class="kr">in</span> Ht, Hv.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>message, index</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>EqDecision0</var><span class="hyp-type"><b>: </b><span>EqDecision index</span></span></span><br><span><var>IM</var><span class="hyp-type"><b>: </b><span>index ‚Üí VLSM message</span></span></span><br><span><var>P</var><span class="hyp-type"><b>: </b><span>message ‚Üí <span class="kt">Prop</span></span></span></span><br><span><var>s'</var><span class="hyp-type"><b>: </b><span>state</span></span></span><br><span><var>l</var><span class="hyp-type"><b>: </b><span>label</span></span></span><br><span><var>om, om'</var><span class="hyp-type"><b>: </b><span>option message</span></span></span><br><span><var>s</var><span class="hyp-type"><b>: </b><span>state</span></span></span><br><span><var>Hps</var><span class="hyp-type"><b>: </b><span>valid_state_prop
  (pre_loaded_vlsm free_composite_vlsm P) s</span></span></span><br><span><var>Hom</var><span class="hyp-type"><b>: </b><span>option_valid_message_prop
  (pre_loaded_vlsm free_composite_vlsm P) om</span></span></span><br><span><var>Hv</var><span class="hyp-type"><b>: </b><span><span class="kr">let</span> (<span class="nv">i</span>, li) := l <span class="kr">in</span> vvalid (IM i) li (s i, om)</span></span></span><br><span><var>Ht</var><span class="hyp-type"><b>: </b><span>(<span class="kr">let</span> (<span class="nv">i</span>, li) := l <span class="kr">in</span>
 <span class="kr">let</span> (<span class="nv">si&#39;</span>, om&#39;) :=
   vtransition (IM i) li (s i, om) <span class="kr">in</span>
 (state_update s i si&#39;, om&#39;)) = 
(s&#39;, om&#39;)</span></span></span><br><span><var>i</var><span class="hyp-type"><b>: </b><span>index</span></span></span><br><span><var>si</var><span class="hyp-type"><b>: </b><span>vstate (IM i)</span></span></span><br><span><var>Hsi</var><span class="hyp-type"><b>: </b><span>vinitial_state_prop (IM i) si</span></span></span><br><span><var>IHHs</var><span class="hyp-type"><b>: </b><span>valid_state_prop
  (pre_loaded_vlsm free_composite_vlsm P)
  (state_update s i si)</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">valid_state_prop
  (pre_loaded_vlsm free_composite_vlsm P)
  (state_update s&#39; i si)</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="Composition-v-chkf1" style="display: none" type="checkbox"><label class="alectryon-input" for="Composition-v-chkf1"><span class="nb">destruct</span> l <span class="kr">as</span> [j lj].</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>message, index</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>EqDecision0</var><span class="hyp-type"><b>: </b><span>EqDecision index</span></span></span><br><span><var>IM</var><span class="hyp-type"><b>: </b><span>index ‚Üí VLSM message</span></span></span><br><span><var>P</var><span class="hyp-type"><b>: </b><span>message ‚Üí <span class="kt">Prop</span></span></span></span><br><span><var>s'</var><span class="hyp-type"><b>: </b><span>state</span></span></span><br><span><var>j</var><span class="hyp-type"><b>: </b><span>index</span></span></span><br><span><var>lj</var><span class="hyp-type"><b>: </b><span>vlabel (IM j)</span></span></span><br><span><var>om, om'</var><span class="hyp-type"><b>: </b><span>option message</span></span></span><br><span><var>s</var><span class="hyp-type"><b>: </b><span>state</span></span></span><br><span><var>Hps</var><span class="hyp-type"><b>: </b><span>valid_state_prop
  (pre_loaded_vlsm free_composite_vlsm P) s</span></span></span><br><span><var>Hom</var><span class="hyp-type"><b>: </b><span>option_valid_message_prop
  (pre_loaded_vlsm free_composite_vlsm P) om</span></span></span><br><span><var>Hv</var><span class="hyp-type"><b>: </b><span>vvalid (IM j) lj (s j, om)</span></span></span><br><span><var>Ht</var><span class="hyp-type"><b>: </b><span>(<span class="kr">let</span> (<span class="nv">si&#39;</span>, om&#39;) :=
   vtransition (IM j) lj (s j, om) <span class="kr">in</span>
 (state_update s j si&#39;, om&#39;)) = 
(s&#39;, om&#39;)</span></span></span><br><span><var>i</var><span class="hyp-type"><b>: </b><span>index</span></span></span><br><span><var>si</var><span class="hyp-type"><b>: </b><span>vstate (IM i)</span></span></span><br><span><var>Hsi</var><span class="hyp-type"><b>: </b><span>vinitial_state_prop (IM i) si</span></span></span><br><span><var>IHHs</var><span class="hyp-type"><b>: </b><span>valid_state_prop
  (pre_loaded_vlsm free_composite_vlsm P)
  (state_update s i si)</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">valid_state_prop
  (pre_loaded_vlsm free_composite_vlsm P)
  (state_update s&#39; i si)</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="Composition-v-chkf2" style="display: none" type="checkbox"><label class="alectryon-input" for="Composition-v-chkf2"><span class="nb">destruct</span> (vtransition _ _ _) <span class="kr">as</span> [sj&#39; omj&#39;] <span class="nb">eqn</span>: Htj.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>message, index</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>EqDecision0</var><span class="hyp-type"><b>: </b><span>EqDecision index</span></span></span><br><span><var>IM</var><span class="hyp-type"><b>: </b><span>index ‚Üí VLSM message</span></span></span><br><span><var>P</var><span class="hyp-type"><b>: </b><span>message ‚Üí <span class="kt">Prop</span></span></span></span><br><span><var>s'</var><span class="hyp-type"><b>: </b><span>state</span></span></span><br><span><var>j</var><span class="hyp-type"><b>: </b><span>index</span></span></span><br><span><var>lj</var><span class="hyp-type"><b>: </b><span>vlabel (IM j)</span></span></span><br><span><var>om, om'</var><span class="hyp-type"><b>: </b><span>option message</span></span></span><br><span><var>s</var><span class="hyp-type"><b>: </b><span>state</span></span></span><br><span><var>Hps</var><span class="hyp-type"><b>: </b><span>valid_state_prop
  (pre_loaded_vlsm free_composite_vlsm P) s</span></span></span><br><span><var>Hom</var><span class="hyp-type"><b>: </b><span>option_valid_message_prop
  (pre_loaded_vlsm free_composite_vlsm P) om</span></span></span><br><span><var>Hv</var><span class="hyp-type"><b>: </b><span>vvalid (IM j) lj (s j, om)</span></span></span><br><span><var>sj'</var><span class="hyp-type"><b>: </b><span>state</span></span></span><br><span><var>omj'</var><span class="hyp-type"><b>: </b><span>option message</span></span></span><br><span><var>Htj</var><span class="hyp-type"><b>: </b><span>vtransition (IM j) lj (s j, om) = (sj&#39;, omj&#39;)</span></span></span><br><span><var>Ht</var><span class="hyp-type"><b>: </b><span>(state_update s j sj&#39;, omj&#39;) = (s&#39;, om&#39;)</span></span></span><br><span><var>i</var><span class="hyp-type"><b>: </b><span>index</span></span></span><br><span><var>si</var><span class="hyp-type"><b>: </b><span>vstate (IM i)</span></span></span><br><span><var>Hsi</var><span class="hyp-type"><b>: </b><span>vinitial_state_prop (IM i) si</span></span></span><br><span><var>IHHs</var><span class="hyp-type"><b>: </b><span>valid_state_prop
  (pre_loaded_vlsm free_composite_vlsm P)
  (state_update s i si)</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">valid_state_prop
  (pre_loaded_vlsm free_composite_vlsm P)
  (state_update s&#39; i si)</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="Composition-v-chkf3" style="display: none" type="checkbox"><label class="alectryon-input" for="Composition-v-chkf3"><span class="nb">inversion_clear</span> Ht.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>message, index</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>EqDecision0</var><span class="hyp-type"><b>: </b><span>EqDecision index</span></span></span><br><span><var>IM</var><span class="hyp-type"><b>: </b><span>index ‚Üí VLSM message</span></span></span><br><span><var>P</var><span class="hyp-type"><b>: </b><span>message ‚Üí <span class="kt">Prop</span></span></span></span><br><span><var>s'</var><span class="hyp-type"><b>: </b><span>state</span></span></span><br><span><var>j</var><span class="hyp-type"><b>: </b><span>index</span></span></span><br><span><var>lj</var><span class="hyp-type"><b>: </b><span>vlabel (IM j)</span></span></span><br><span><var>om, om'</var><span class="hyp-type"><b>: </b><span>option message</span></span></span><br><span><var>s</var><span class="hyp-type"><b>: </b><span>state</span></span></span><br><span><var>Hps</var><span class="hyp-type"><b>: </b><span>valid_state_prop
  (pre_loaded_vlsm free_composite_vlsm P) s</span></span></span><br><span><var>Hom</var><span class="hyp-type"><b>: </b><span>option_valid_message_prop
  (pre_loaded_vlsm free_composite_vlsm P) om</span></span></span><br><span><var>Hv</var><span class="hyp-type"><b>: </b><span>vvalid (IM j) lj (s j, om)</span></span></span><br><span><var>sj'</var><span class="hyp-type"><b>: </b><span>state</span></span></span><br><span><var>omj'</var><span class="hyp-type"><b>: </b><span>option message</span></span></span><br><span><var>Htj</var><span class="hyp-type"><b>: </b><span>vtransition (IM j) lj (s j, om) = (sj&#39;, omj&#39;)</span></span></span><br><span><var>i</var><span class="hyp-type"><b>: </b><span>index</span></span></span><br><span><var>si</var><span class="hyp-type"><b>: </b><span>vstate (IM i)</span></span></span><br><span><var>Hsi</var><span class="hyp-type"><b>: </b><span>vinitial_state_prop (IM i) si</span></span></span><br><span><var>IHHs</var><span class="hyp-type"><b>: </b><span>valid_state_prop
  (pre_loaded_vlsm free_composite_vlsm P)
  (state_update s i si)</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">valid_state_prop
  (pre_loaded_vlsm free_composite_vlsm P)
  (state_update (state_update s j sj&#39;) i si)</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="Composition-v-chkf4" style="display: none" type="checkbox"><label class="alectryon-input" for="Composition-v-chkf4"><span class="nb">destruct</span> (decide (i = j)).</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>message, index</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>EqDecision0</var><span class="hyp-type"><b>: </b><span>EqDecision index</span></span></span><br><span><var>IM</var><span class="hyp-type"><b>: </b><span>index ‚Üí VLSM message</span></span></span><br><span><var>P</var><span class="hyp-type"><b>: </b><span>message ‚Üí <span class="kt">Prop</span></span></span></span><br><span><var>s'</var><span class="hyp-type"><b>: </b><span>state</span></span></span><br><span><var>j</var><span class="hyp-type"><b>: </b><span>index</span></span></span><br><span><var>lj</var><span class="hyp-type"><b>: </b><span>vlabel (IM j)</span></span></span><br><span><var>om, om'</var><span class="hyp-type"><b>: </b><span>option message</span></span></span><br><span><var>s</var><span class="hyp-type"><b>: </b><span>state</span></span></span><br><span><var>Hps</var><span class="hyp-type"><b>: </b><span>valid_state_prop
  (pre_loaded_vlsm free_composite_vlsm P) s</span></span></span><br><span><var>Hom</var><span class="hyp-type"><b>: </b><span>option_valid_message_prop
  (pre_loaded_vlsm free_composite_vlsm P) om</span></span></span><br><span><var>Hv</var><span class="hyp-type"><b>: </b><span>vvalid (IM j) lj (s j, om)</span></span></span><br><span><var>sj'</var><span class="hyp-type"><b>: </b><span>state</span></span></span><br><span><var>omj'</var><span class="hyp-type"><b>: </b><span>option message</span></span></span><br><span><var>Htj</var><span class="hyp-type"><b>: </b><span>vtransition (IM j) lj (s j, om) = (sj&#39;, omj&#39;)</span></span></span><br><span><var>i</var><span class="hyp-type"><b>: </b><span>index</span></span></span><br><span><var>si</var><span class="hyp-type"><b>: </b><span>vstate (IM i)</span></span></span><br><span><var>Hsi</var><span class="hyp-type"><b>: </b><span>vinitial_state_prop (IM i) si</span></span></span><br><span><var>IHHs</var><span class="hyp-type"><b>: </b><span>valid_state_prop
  (pre_loaded_vlsm free_composite_vlsm P)
  (state_update s i si)</span></span></span><br><span><var>e</var><span class="hyp-type"><b>: </b><span>i = j</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">valid_state_prop
  (pre_loaded_vlsm free_composite_vlsm P)
  (state_update (state_update s j sj&#39;) i si)</div></blockquote><div class="alectryon-extra-goals"><input class="alectryon-extra-goal-toggle" id="Composition-v-chkf5" style="display: none" type="checkbox"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>message, index</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>EqDecision0</var><span class="hyp-type"><b>: </b><span>EqDecision index</span></span></span><br><span><var>IM</var><span class="hyp-type"><b>: </b><span>index ‚Üí VLSM message</span></span></span><br><span><var>P</var><span class="hyp-type"><b>: </b><span>message ‚Üí <span class="kt">Prop</span></span></span></span><br><span><var>s'</var><span class="hyp-type"><b>: </b><span>state</span></span></span><br><span><var>j</var><span class="hyp-type"><b>: </b><span>index</span></span></span><br><span><var>lj</var><span class="hyp-type"><b>: </b><span>vlabel (IM j)</span></span></span><br><span><var>om, om'</var><span class="hyp-type"><b>: </b><span>option message</span></span></span><br><span><var>s</var><span class="hyp-type"><b>: </b><span>state</span></span></span><br><span><var>Hps</var><span class="hyp-type"><b>: </b><span>valid_state_prop
  (pre_loaded_vlsm free_composite_vlsm P) s</span></span></span><br><span><var>Hom</var><span class="hyp-type"><b>: </b><span>option_valid_message_prop
  (pre_loaded_vlsm free_composite_vlsm P) om</span></span></span><br><span><var>Hv</var><span class="hyp-type"><b>: </b><span>vvalid (IM j) lj (s j, om)</span></span></span><br><span><var>sj'</var><span class="hyp-type"><b>: </b><span>state</span></span></span><br><span><var>omj'</var><span class="hyp-type"><b>: </b><span>option message</span></span></span><br><span><var>Htj</var><span class="hyp-type"><b>: </b><span>vtransition (IM j) lj (s j, om) = (sj&#39;, omj&#39;)</span></span></span><br><span><var>i</var><span class="hyp-type"><b>: </b><span>index</span></span></span><br><span><var>si</var><span class="hyp-type"><b>: </b><span>vstate (IM i)</span></span></span><br><span><var>Hsi</var><span class="hyp-type"><b>: </b><span>vinitial_state_prop (IM i) si</span></span></span><br><span><var>IHHs</var><span class="hyp-type"><b>: </b><span>valid_state_prop
  (pre_loaded_vlsm free_composite_vlsm P)
  (state_update s i si)</span></span></span><br><span><var>n</var><span class="hyp-type"><b>: </b><span>i ‚â† j</span></span></span><br></div><label class="goal-separator" for="Composition-v-chkf5"><hr></label><div class="goal-conclusion">valid_state_prop
  (pre_loaded_vlsm free_composite_vlsm P)
  (state_update (state_update s j sj&#39;) i si)</div></blockquote></div></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="Composition-v-chkf6" style="display: none" type="checkbox"><label class="alectryon-input" for="Composition-v-chkf6">+</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>message, index</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>EqDecision0</var><span class="hyp-type"><b>: </b><span>EqDecision index</span></span></span><br><span><var>IM</var><span class="hyp-type"><b>: </b><span>index ‚Üí VLSM message</span></span></span><br><span><var>P</var><span class="hyp-type"><b>: </b><span>message ‚Üí <span class="kt">Prop</span></span></span></span><br><span><var>s'</var><span class="hyp-type"><b>: </b><span>state</span></span></span><br><span><var>j</var><span class="hyp-type"><b>: </b><span>index</span></span></span><br><span><var>lj</var><span class="hyp-type"><b>: </b><span>vlabel (IM j)</span></span></span><br><span><var>om, om'</var><span class="hyp-type"><b>: </b><span>option message</span></span></span><br><span><var>s</var><span class="hyp-type"><b>: </b><span>state</span></span></span><br><span><var>Hps</var><span class="hyp-type"><b>: </b><span>valid_state_prop
  (pre_loaded_vlsm free_composite_vlsm P) s</span></span></span><br><span><var>Hom</var><span class="hyp-type"><b>: </b><span>option_valid_message_prop
  (pre_loaded_vlsm free_composite_vlsm P) om</span></span></span><br><span><var>Hv</var><span class="hyp-type"><b>: </b><span>vvalid (IM j) lj (s j, om)</span></span></span><br><span><var>sj'</var><span class="hyp-type"><b>: </b><span>state</span></span></span><br><span><var>omj'</var><span class="hyp-type"><b>: </b><span>option message</span></span></span><br><span><var>Htj</var><span class="hyp-type"><b>: </b><span>vtransition (IM j) lj (s j, om) = (sj&#39;, omj&#39;)</span></span></span><br><span><var>i</var><span class="hyp-type"><b>: </b><span>index</span></span></span><br><span><var>si</var><span class="hyp-type"><b>: </b><span>vstate (IM i)</span></span></span><br><span><var>Hsi</var><span class="hyp-type"><b>: </b><span>vinitial_state_prop (IM i) si</span></span></span><br><span><var>IHHs</var><span class="hyp-type"><b>: </b><span>valid_state_prop
  (pre_loaded_vlsm free_composite_vlsm P)
  (state_update s i si)</span></span></span><br><span><var>e</var><span class="hyp-type"><b>: </b><span>i = j</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">valid_state_prop
  (pre_loaded_vlsm free_composite_vlsm P)
  (state_update (state_update s j sj&#39;) i si)</div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="bp">by</span> <span class="nb">subst</span>; <span class="nb">rewrite</span> state_update_twice.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="Composition-v-chkf7" style="display: none" type="checkbox"><label class="alectryon-input" for="Composition-v-chkf7">+</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>message, index</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>EqDecision0</var><span class="hyp-type"><b>: </b><span>EqDecision index</span></span></span><br><span><var>IM</var><span class="hyp-type"><b>: </b><span>index ‚Üí VLSM message</span></span></span><br><span><var>P</var><span class="hyp-type"><b>: </b><span>message ‚Üí <span class="kt">Prop</span></span></span></span><br><span><var>s'</var><span class="hyp-type"><b>: </b><span>state</span></span></span><br><span><var>j</var><span class="hyp-type"><b>: </b><span>index</span></span></span><br><span><var>lj</var><span class="hyp-type"><b>: </b><span>vlabel (IM j)</span></span></span><br><span><var>om, om'</var><span class="hyp-type"><b>: </b><span>option message</span></span></span><br><span><var>s</var><span class="hyp-type"><b>: </b><span>state</span></span></span><br><span><var>Hps</var><span class="hyp-type"><b>: </b><span>valid_state_prop
  (pre_loaded_vlsm free_composite_vlsm P) s</span></span></span><br><span><var>Hom</var><span class="hyp-type"><b>: </b><span>option_valid_message_prop
  (pre_loaded_vlsm free_composite_vlsm P) om</span></span></span><br><span><var>Hv</var><span class="hyp-type"><b>: </b><span>vvalid (IM j) lj (s j, om)</span></span></span><br><span><var>sj'</var><span class="hyp-type"><b>: </b><span>state</span></span></span><br><span><var>omj'</var><span class="hyp-type"><b>: </b><span>option message</span></span></span><br><span><var>Htj</var><span class="hyp-type"><b>: </b><span>vtransition (IM j) lj (s j, om) = (sj&#39;, omj&#39;)</span></span></span><br><span><var>i</var><span class="hyp-type"><b>: </b><span>index</span></span></span><br><span><var>si</var><span class="hyp-type"><b>: </b><span>vstate (IM i)</span></span></span><br><span><var>Hsi</var><span class="hyp-type"><b>: </b><span>vinitial_state_prop (IM i) si</span></span></span><br><span><var>IHHs</var><span class="hyp-type"><b>: </b><span>valid_state_prop
  (pre_loaded_vlsm free_composite_vlsm P)
  (state_update s i si)</span></span></span><br><span><var>n</var><span class="hyp-type"><b>: </b><span>i ‚â† j</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">valid_state_prop
  (pre_loaded_vlsm free_composite_vlsm P)
  (state_update (state_update s j sj&#39;) i si)</div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="Composition-v-chkf8" style="display: none" type="checkbox"><label class="alectryon-input" for="Composition-v-chkf8"><span class="nb">rewrite</span> state_update_twice_neq <span class="bp">by</span> <span class="bp">done</span>.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>message, index</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>EqDecision0</var><span class="hyp-type"><b>: </b><span>EqDecision index</span></span></span><br><span><var>IM</var><span class="hyp-type"><b>: </b><span>index ‚Üí VLSM message</span></span></span><br><span><var>P</var><span class="hyp-type"><b>: </b><span>message ‚Üí <span class="kt">Prop</span></span></span></span><br><span><var>s'</var><span class="hyp-type"><b>: </b><span>state</span></span></span><br><span><var>j</var><span class="hyp-type"><b>: </b><span>index</span></span></span><br><span><var>lj</var><span class="hyp-type"><b>: </b><span>vlabel (IM j)</span></span></span><br><span><var>om, om'</var><span class="hyp-type"><b>: </b><span>option message</span></span></span><br><span><var>s</var><span class="hyp-type"><b>: </b><span>state</span></span></span><br><span><var>Hps</var><span class="hyp-type"><b>: </b><span>valid_state_prop
  (pre_loaded_vlsm free_composite_vlsm P) s</span></span></span><br><span><var>Hom</var><span class="hyp-type"><b>: </b><span>option_valid_message_prop
  (pre_loaded_vlsm free_composite_vlsm P) om</span></span></span><br><span><var>Hv</var><span class="hyp-type"><b>: </b><span>vvalid (IM j) lj (s j, om)</span></span></span><br><span><var>sj'</var><span class="hyp-type"><b>: </b><span>state</span></span></span><br><span><var>omj'</var><span class="hyp-type"><b>: </b><span>option message</span></span></span><br><span><var>Htj</var><span class="hyp-type"><b>: </b><span>vtransition (IM j) lj (s j, om) = (sj&#39;, omj&#39;)</span></span></span><br><span><var>i</var><span class="hyp-type"><b>: </b><span>index</span></span></span><br><span><var>si</var><span class="hyp-type"><b>: </b><span>vstate (IM i)</span></span></span><br><span><var>Hsi</var><span class="hyp-type"><b>: </b><span>vinitial_state_prop (IM i) si</span></span></span><br><span><var>IHHs</var><span class="hyp-type"><b>: </b><span>valid_state_prop
  (pre_loaded_vlsm free_composite_vlsm P)
  (state_update s i si)</span></span></span><br><span><var>n</var><span class="hyp-type"><b>: </b><span>i ‚â† j</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">valid_state_prop
  (pre_loaded_vlsm free_composite_vlsm P)
  (state_update (state_update s i si) j sj&#39;)</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">      </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="Composition-v-chkf9" style="display: none" type="checkbox"><label class="alectryon-input" for="Composition-v-chkf9"><span class="nb">apply</span> input_valid_transition_destination <span class="kr">with</span> (existT j lj) (state_update s i si) om omj&#39;.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>message, index</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>EqDecision0</var><span class="hyp-type"><b>: </b><span>EqDecision index</span></span></span><br><span><var>IM</var><span class="hyp-type"><b>: </b><span>index ‚Üí VLSM message</span></span></span><br><span><var>P</var><span class="hyp-type"><b>: </b><span>message ‚Üí <span class="kt">Prop</span></span></span></span><br><span><var>s'</var><span class="hyp-type"><b>: </b><span>state</span></span></span><br><span><var>j</var><span class="hyp-type"><b>: </b><span>index</span></span></span><br><span><var>lj</var><span class="hyp-type"><b>: </b><span>vlabel (IM j)</span></span></span><br><span><var>om, om'</var><span class="hyp-type"><b>: </b><span>option message</span></span></span><br><span><var>s</var><span class="hyp-type"><b>: </b><span>state</span></span></span><br><span><var>Hps</var><span class="hyp-type"><b>: </b><span>valid_state_prop
  (pre_loaded_vlsm free_composite_vlsm P) s</span></span></span><br><span><var>Hom</var><span class="hyp-type"><b>: </b><span>option_valid_message_prop
  (pre_loaded_vlsm free_composite_vlsm P) om</span></span></span><br><span><var>Hv</var><span class="hyp-type"><b>: </b><span>vvalid (IM j) lj (s j, om)</span></span></span><br><span><var>sj'</var><span class="hyp-type"><b>: </b><span>state</span></span></span><br><span><var>omj'</var><span class="hyp-type"><b>: </b><span>option message</span></span></span><br><span><var>Htj</var><span class="hyp-type"><b>: </b><span>vtransition (IM j) lj (s j, om) = (sj&#39;, omj&#39;)</span></span></span><br><span><var>i</var><span class="hyp-type"><b>: </b><span>index</span></span></span><br><span><var>si</var><span class="hyp-type"><b>: </b><span>vstate (IM i)</span></span></span><br><span><var>Hsi</var><span class="hyp-type"><b>: </b><span>vinitial_state_prop (IM i) si</span></span></span><br><span><var>IHHs</var><span class="hyp-type"><b>: </b><span>valid_state_prop
  (pre_loaded_vlsm free_composite_vlsm P)
  (state_update s i si)</span></span></span><br><span><var>n</var><span class="hyp-type"><b>: </b><span>i ‚â† j</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">input_valid_transition
  (pre_loaded_vlsm free_composite_vlsm P)
  (existT j lj) (state_update s i si, om)
  (state_update (state_update s i si) j sj&#39;, omj&#39;)</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">      </span><span class="alectryon-sentence"><span class="alectryon-input"><span class="bp">by</span> <span class="kp">repeat</span> <span class="nb">split</span>; [<span class="bp">done</span> | <span class="bp">done</span> |..]; <span class="nb">cbn</span>; <span class="nb">rewrite</span> state_update_neq;
        [..| <span class="nb">rewrite</span> Htj |].</span><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Qed</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
</span><span class="alectryon-sentence"><input class="alectryon-toggle" id="Composition-v-chkfa" style="display: none" type="checkbox"><label class="alectryon-input" for="Composition-v-chkfa"><span class="kn">Lemma</span> <span class="nf">lift_to_composite_valid_preservation</span> :
  <span class="kr">forall</span> (<span class="nv">i</span> : index) (<span class="nv">cs</span> : composite_state),
  <span class="kr">forall</span> <span class="nv">l</span> <span class="nv">s</span> <span class="nv">om</span>, vvalid (IM i) l (s, om) -&gt;
    composite_valid (lift_to_composite_label i l)
      (lift_to_composite_state cs i s, om).</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>message, index</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>EqDecision0</var><span class="hyp-type"><b>: </b><span>EqDecision index</span></span></span><br><span><var>IM</var><span class="hyp-type"><b>: </b><span>index ‚Üí VLSM message</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="kr">‚àÄ</span> (<span class="nv">i</span> : index) (<span class="nv">cs</span> : composite_state) (<span class="nv">l</span> : label) (<span class="nv">s</span> : state) 
  (<span class="nv">om</span> : option message),
  vvalid (IM i) l (s, om)
  ‚Üí composite_valid (lift_to_composite_label i l)
      (lift_to_composite_state cs i s, om)</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="Composition-v-chkfb" style="display: none" type="checkbox"><label class="alectryon-input" for="Composition-v-chkfb"><span class="kn">Proof</span>.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>message, index</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>EqDecision0</var><span class="hyp-type"><b>: </b><span>EqDecision index</span></span></span><br><span><var>IM</var><span class="hyp-type"><b>: </b><span>index ‚Üí VLSM message</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="kr">‚àÄ</span> (<span class="nv">i</span> : index) (<span class="nv">cs</span> : composite_state) (<span class="nv">l</span> : label) (<span class="nv">s</span> : state) 
  (<span class="nv">om</span> : option message),
  vvalid (IM i) l (s, om)
  ‚Üí composite_valid (lift_to_composite_label i l)
      (lift_to_composite_state cs i s, om)</div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="bp">by</span> <span class="nb">intros</span>; <span class="nb">cbn</span>; <span class="nb">rewrite</span> state_update_eq.</span><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Qed</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
</span><span class="alectryon-sentence"><input class="alectryon-toggle" id="Composition-v-chkfc" style="display: none" type="checkbox"><label class="alectryon-input" for="Composition-v-chkfc"><span class="kn">Lemma</span> <span class="nf">lift_to_composite_transition_preservation</span> :
  <span class="kr">forall</span> (<span class="nv">i</span> : index) (<span class="nv">cs</span> : composite_state),
  <span class="kr">forall</span> <span class="nv">l</span> <span class="nv">s</span> <span class="nv">om</span> <span class="nv">s&#39;</span> <span class="nv">om&#39;</span>, vtransition (IM i) l (s, om) = (s&#39;, om&#39;) -&gt;
    composite_transition (lift_to_composite_label i l)
      (lift_to_composite_state cs i s, om)
        =
      (lift_to_composite_state cs i s&#39;, om&#39;).</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>message, index</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>EqDecision0</var><span class="hyp-type"><b>: </b><span>EqDecision index</span></span></span><br><span><var>IM</var><span class="hyp-type"><b>: </b><span>index ‚Üí VLSM message</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="kr">‚àÄ</span> (<span class="nv">i</span> : index) (<span class="nv">cs</span> : composite_state) (<span class="nv">l</span> : label) (<span class="nv">s</span> : state) 
  (<span class="nv">om</span> : option message) (<span class="nv">s&#39;</span> : state) (<span class="nv">om&#39;</span> : option
                                              message),
  vtransition (IM i) l (s, om) = (s&#39;, om&#39;)
  ‚Üí composite_transition (lift_to_composite_label i l)
      (lift_to_composite_state cs i s, om) =
    (lift_to_composite_state cs i s&#39;, om&#39;)</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="Composition-v-chkfd" style="display: none" type="checkbox"><label class="alectryon-input" for="Composition-v-chkfd"><span class="kn">Proof</span>.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>message, index</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>EqDecision0</var><span class="hyp-type"><b>: </b><span>EqDecision index</span></span></span><br><span><var>IM</var><span class="hyp-type"><b>: </b><span>index ‚Üí VLSM message</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="kr">‚àÄ</span> (<span class="nv">i</span> : index) (<span class="nv">cs</span> : composite_state) (<span class="nv">l</span> : label) (<span class="nv">s</span> : state) 
  (<span class="nv">om</span> : option message) (<span class="nv">s&#39;</span> : state) (<span class="nv">om&#39;</span> : option
                                              message),
  vtransition (IM i) l (s, om) = (s&#39;, om&#39;)
  ‚Üí composite_transition (lift_to_composite_label i l)
      (lift_to_composite_state cs i s, om) =
    (lift_to_composite_state cs i s&#39;, om&#39;)</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="Composition-v-chkfe" style="display: none" type="checkbox"><label class="alectryon-input" for="Composition-v-chkfe"><span class="nb">intros</span>; <span class="nb">cbn</span>.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>message, index</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>EqDecision0</var><span class="hyp-type"><b>: </b><span>EqDecision index</span></span></span><br><span><var>IM</var><span class="hyp-type"><b>: </b><span>index ‚Üí VLSM message</span></span></span><br><span><var>i</var><span class="hyp-type"><b>: </b><span>index</span></span></span><br><span><var>cs</var><span class="hyp-type"><b>: </b><span>composite_state</span></span></span><br><span><var>l</var><span class="hyp-type"><b>: </b><span>label</span></span></span><br><span><var>s</var><span class="hyp-type"><b>: </b><span>state</span></span></span><br><span><var>om</var><span class="hyp-type"><b>: </b><span>option message</span></span></span><br><span><var>s'</var><span class="hyp-type"><b>: </b><span>state</span></span></span><br><span><var>om'</var><span class="hyp-type"><b>: </b><span>option message</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>vtransition (IM i) l (s, om) = (s&#39;, om&#39;)</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">(<span class="kr">let</span> (<span class="nv">si&#39;</span>, om&#39;) :=
   vtransition (IM i) l
     (lift_to_composite_state cs i s i, om) <span class="kr">in</span>
 (state_update (lift_to_composite_state cs i s) i si&#39;,
 om&#39;)) = (lift_to_composite_state cs i s&#39;, om&#39;)</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="Composition-v-chkff" style="display: none" type="checkbox"><label class="alectryon-input" for="Composition-v-chkff"><span class="nb">unfold</span> lift_to_composite_state; <span class="nb">rewrite</span> state_update_eq.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>message, index</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>EqDecision0</var><span class="hyp-type"><b>: </b><span>EqDecision index</span></span></span><br><span><var>IM</var><span class="hyp-type"><b>: </b><span>index ‚Üí VLSM message</span></span></span><br><span><var>i</var><span class="hyp-type"><b>: </b><span>index</span></span></span><br><span><var>cs</var><span class="hyp-type"><b>: </b><span>composite_state</span></span></span><br><span><var>l</var><span class="hyp-type"><b>: </b><span>label</span></span></span><br><span><var>s</var><span class="hyp-type"><b>: </b><span>state</span></span></span><br><span><var>om</var><span class="hyp-type"><b>: </b><span>option message</span></span></span><br><span><var>s'</var><span class="hyp-type"><b>: </b><span>state</span></span></span><br><span><var>om'</var><span class="hyp-type"><b>: </b><span>option message</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>vtransition (IM i) l (s, om) = (s&#39;, om&#39;)</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">(<span class="kr">let</span> (<span class="nv">si&#39;</span>, om&#39;) := vtransition (IM i) l (s, om) <span class="kr">in</span>
 (state_update (state_update cs i s) i si&#39;, om&#39;)) =
(state_update cs i s&#39;, om&#39;)</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><span class="alectryon-input"><span class="bp">by</span> <span class="nb">replace</span> (vtransition _ _ _) <span class="kr">with</span> (s&#39;, om&#39;); <span class="nb">rewrite</span> state_update_twice.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Qed</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
</span><span class="alectryon-sentence"><input class="alectryon-toggle" id="Composition-v-chk100" style="display: none" type="checkbox"><label class="alectryon-input" for="Composition-v-chk100"><span class="kn">Lemma</span> <span class="nf">lift_to_composite_initial_message_preservation</span> :
  <span class="kr">forall</span> (<span class="nv">i</span> : index),
      <span class="kr">forall</span> <span class="nv">m</span>, vinitial_message_prop (IM i) m -&gt;
      composite_initial_message_prop m.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>message, index</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>EqDecision0</var><span class="hyp-type"><b>: </b><span>EqDecision index</span></span></span><br><span><var>IM</var><span class="hyp-type"><b>: </b><span>index ‚Üí VLSM message</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="kr">‚àÄ</span> (<span class="nv">i</span> : index) (<span class="nv">m</span> : message),
  vinitial_message_prop (IM i) m
  ‚Üí composite_initial_message_prop m</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="Composition-v-chk101" style="display: none" type="checkbox"><label class="alectryon-input" for="Composition-v-chk101"><span class="kn">Proof</span>.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>message, index</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>EqDecision0</var><span class="hyp-type"><b>: </b><span>EqDecision index</span></span></span><br><span><var>IM</var><span class="hyp-type"><b>: </b><span>index ‚Üí VLSM message</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="kr">‚àÄ</span> (<span class="nv">i</span> : index) (<span class="nv">m</span> : message),
  vinitial_message_prop (IM i) m
  ‚Üí composite_initial_message_prop m</div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="bp">by</span> <span class="nb">intros</span> i m Hm; <span class="kr">exists</span> <span class="nv">i</span>, (exist _ _ Hm).</span><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Qed</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
</span><span class="alectryon-sentence"><input class="alectryon-toggle" id="Composition-v-chk102" style="display: none" type="checkbox"><label class="alectryon-input" for="Composition-v-chk102"><span class="kn">Lemma</span> <span class="nf">pre_lift_to_free_weak_full_projection</span> :
  <span class="kr">forall</span> (<span class="nv">i</span> : index) (<span class="nv">cs</span> : composite_state) (<span class="nv">P</span> : message -&gt; <span class="kt">Prop</span>),
      valid_state_prop (pre_loaded_vlsm free_composite_vlsm P) cs -&gt;
      VLSM_weak_full_projection
        (pre_loaded_vlsm (IM i) P) (pre_loaded_vlsm free_composite_vlsm P)
        (lift_to_composite_label i) (lift_to_composite_state cs i).</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>message, index</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>EqDecision0</var><span class="hyp-type"><b>: </b><span>EqDecision index</span></span></span><br><span><var>IM</var><span class="hyp-type"><b>: </b><span>index ‚Üí VLSM message</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="kr">‚àÄ</span> (<span class="nv">i</span> : index) (<span class="nv">cs</span> : composite_state) (<span class="nv">P</span> : message
                                          ‚Üí <span class="kt">Prop</span>),
  valid_state_prop
    (pre_loaded_vlsm free_composite_vlsm P) cs
  ‚Üí VLSM_weak_full_projection
      (pre_loaded_vlsm (IM i) P)
      (pre_loaded_vlsm free_composite_vlsm P)
      (lift_to_composite_label i)
      (lift_to_composite_state cs i)</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="Composition-v-chk103" style="display: none" type="checkbox"><label class="alectryon-input" for="Composition-v-chk103"><span class="kn">Proof</span>.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>message, index</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>EqDecision0</var><span class="hyp-type"><b>: </b><span>EqDecision index</span></span></span><br><span><var>IM</var><span class="hyp-type"><b>: </b><span>index ‚Üí VLSM message</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="kr">‚àÄ</span> (<span class="nv">i</span> : index) (<span class="nv">cs</span> : composite_state) (<span class="nv">P</span> : message
                                          ‚Üí <span class="kt">Prop</span>),
  valid_state_prop
    (pre_loaded_vlsm free_composite_vlsm P) cs
  ‚Üí VLSM_weak_full_projection
      (pre_loaded_vlsm (IM i) P)
      (pre_loaded_vlsm free_composite_vlsm P)
      (lift_to_composite_label i)
      (lift_to_composite_state cs i)</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="Composition-v-chk104" style="display: none" type="checkbox"><label class="alectryon-input" for="Composition-v-chk104"><span class="nb">intros</span> i cs P Hvsp.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>message, index</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>EqDecision0</var><span class="hyp-type"><b>: </b><span>EqDecision index</span></span></span><br><span><var>IM</var><span class="hyp-type"><b>: </b><span>index ‚Üí VLSM message</span></span></span><br><span><var>i</var><span class="hyp-type"><b>: </b><span>index</span></span></span><br><span><var>cs</var><span class="hyp-type"><b>: </b><span>composite_state</span></span></span><br><span><var>P</var><span class="hyp-type"><b>: </b><span>message ‚Üí <span class="kt">Prop</span></span></span></span><br><span><var>Hvsp</var><span class="hyp-type"><b>: </b><span>valid_state_prop
  (pre_loaded_vlsm free_composite_vlsm P) cs</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">VLSM_weak_full_projection (pre_loaded_vlsm (IM i) P)
  (pre_loaded_vlsm free_composite_vlsm P)
  (lift_to_composite_label i)
  (lift_to_composite_state cs i)</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="Composition-v-chk105" style="display: none" type="checkbox"><label class="alectryon-input" for="Composition-v-chk105"><span class="nb">apply</span> basic_VLSM_weak_full_projection.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>message, index</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>EqDecision0</var><span class="hyp-type"><b>: </b><span>EqDecision index</span></span></span><br><span><var>IM</var><span class="hyp-type"><b>: </b><span>index ‚Üí VLSM message</span></span></span><br><span><var>i</var><span class="hyp-type"><b>: </b><span>index</span></span></span><br><span><var>cs</var><span class="hyp-type"><b>: </b><span>composite_state</span></span></span><br><span><var>P</var><span class="hyp-type"><b>: </b><span>message ‚Üí <span class="kt">Prop</span></span></span></span><br><span><var>Hvsp</var><span class="hyp-type"><b>: </b><span>valid_state_prop
  (pre_loaded_vlsm free_composite_vlsm P) cs</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">weak_full_projection_valid_preservation
  (pre_loaded_vlsm (IM i) P)
  (pre_loaded_vlsm free_composite_vlsm P)
  (lift_to_composite_label i)
  (lift_to_composite_state cs i)</div></blockquote><div class="alectryon-extra-goals"><input class="alectryon-extra-goal-toggle" id="Composition-v-chk106" style="display: none" type="checkbox"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>message, index</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>EqDecision0</var><span class="hyp-type"><b>: </b><span>EqDecision index</span></span></span><br><span><var>IM</var><span class="hyp-type"><b>: </b><span>index ‚Üí VLSM message</span></span></span><br><span><var>i</var><span class="hyp-type"><b>: </b><span>index</span></span></span><br><span><var>cs</var><span class="hyp-type"><b>: </b><span>composite_state</span></span></span><br><span><var>P</var><span class="hyp-type"><b>: </b><span>message ‚Üí <span class="kt">Prop</span></span></span></span><br><span><var>Hvsp</var><span class="hyp-type"><b>: </b><span>valid_state_prop
  (pre_loaded_vlsm free_composite_vlsm P) cs</span></span></span><br></div><label class="goal-separator" for="Composition-v-chk106"><hr></label><div class="goal-conclusion">weak_full_projection_transition_preservation
  (pre_loaded_vlsm (IM i) P)
  (pre_loaded_vlsm free_composite_vlsm P)
  (lift_to_composite_label i)
  (lift_to_composite_state cs i)</div></blockquote><input class="alectryon-extra-goal-toggle" id="Composition-v-chk107" style="display: none" type="checkbox"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>message, index</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>EqDecision0</var><span class="hyp-type"><b>: </b><span>EqDecision index</span></span></span><br><span><var>IM</var><span class="hyp-type"><b>: </b><span>index ‚Üí VLSM message</span></span></span><br><span><var>i</var><span class="hyp-type"><b>: </b><span>index</span></span></span><br><span><var>cs</var><span class="hyp-type"><b>: </b><span>composite_state</span></span></span><br><span><var>P</var><span class="hyp-type"><b>: </b><span>message ‚Üí <span class="kt">Prop</span></span></span></span><br><span><var>Hvsp</var><span class="hyp-type"><b>: </b><span>valid_state_prop
  (pre_loaded_vlsm free_composite_vlsm P) cs</span></span></span><br></div><label class="goal-separator" for="Composition-v-chk107"><hr></label><div class="goal-conclusion">weak_projection_initial_state_preservation
  (pre_loaded_vlsm (IM i) P)
  (pre_loaded_vlsm free_composite_vlsm P)
  (lift_to_composite_state cs i)</div></blockquote><input class="alectryon-extra-goal-toggle" id="Composition-v-chk108" style="display: none" type="checkbox"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>message, index</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>EqDecision0</var><span class="hyp-type"><b>: </b><span>EqDecision index</span></span></span><br><span><var>IM</var><span class="hyp-type"><b>: </b><span>index ‚Üí VLSM message</span></span></span><br><span><var>i</var><span class="hyp-type"><b>: </b><span>index</span></span></span><br><span><var>cs</var><span class="hyp-type"><b>: </b><span>composite_state</span></span></span><br><span><var>P</var><span class="hyp-type"><b>: </b><span>message ‚Üí <span class="kt">Prop</span></span></span></span><br><span><var>Hvsp</var><span class="hyp-type"><b>: </b><span>valid_state_prop
  (pre_loaded_vlsm free_composite_vlsm P) cs</span></span></span><br></div><label class="goal-separator" for="Composition-v-chk108"><hr></label><div class="goal-conclusion">weak_full_projection_initial_message_preservation
  (pre_loaded_vlsm (IM i) P)
  (pre_loaded_vlsm free_composite_vlsm P)
  (lift_to_composite_state cs i)</div></blockquote></div></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="Composition-v-chk109" style="display: none" type="checkbox"><label class="alectryon-input" for="Composition-v-chk109">-</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>message, index</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>EqDecision0</var><span class="hyp-type"><b>: </b><span>EqDecision index</span></span></span><br><span><var>IM</var><span class="hyp-type"><b>: </b><span>index ‚Üí VLSM message</span></span></span><br><span><var>i</var><span class="hyp-type"><b>: </b><span>index</span></span></span><br><span><var>cs</var><span class="hyp-type"><b>: </b><span>composite_state</span></span></span><br><span><var>P</var><span class="hyp-type"><b>: </b><span>message ‚Üí <span class="kt">Prop</span></span></span></span><br><span><var>Hvsp</var><span class="hyp-type"><b>: </b><span>valid_state_prop
  (pre_loaded_vlsm free_composite_vlsm P) cs</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">weak_full_projection_valid_preservation
  (pre_loaded_vlsm (IM i) P)
  (pre_loaded_vlsm free_composite_vlsm P)
  (lift_to_composite_label i)
  (lift_to_composite_state cs i)</div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="Composition-v-chk10a" style="display: none" type="checkbox"><label class="alectryon-input" for="Composition-v-chk10a"><span class="nb">intros</span> l s om (_ &amp; _ &amp; Hv) _ _.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>message, index</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>EqDecision0</var><span class="hyp-type"><b>: </b><span>EqDecision index</span></span></span><br><span><var>IM</var><span class="hyp-type"><b>: </b><span>index ‚Üí VLSM message</span></span></span><br><span><var>i</var><span class="hyp-type"><b>: </b><span>index</span></span></span><br><span><var>cs</var><span class="hyp-type"><b>: </b><span>composite_state</span></span></span><br><span><var>P</var><span class="hyp-type"><b>: </b><span>message ‚Üí <span class="kt">Prop</span></span></span></span><br><span><var>Hvsp</var><span class="hyp-type"><b>: </b><span>valid_state_prop
  (pre_loaded_vlsm free_composite_vlsm P) cs</span></span></span><br><span><var>l</var><span class="hyp-type"><b>: </b><span>label</span></span></span><br><span><var>s</var><span class="hyp-type"><b>: </b><span>state</span></span></span><br><span><var>om</var><span class="hyp-type"><b>: </b><span>option message</span></span></span><br><span><var>Hv</var><span class="hyp-type"><b>: </b><span>valid l (s, om)</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">vvalid (pre_loaded_vlsm free_composite_vlsm P)
  (lift_to_composite_label i l)
  (lift_to_composite_state cs i s, om)</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><span class="alectryon-input"><span class="bp">by</span> <span class="nb">split</span>; [<span class="nb">apply</span> lift_to_composite_valid_preservation |].</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="Composition-v-chk10b" style="display: none" type="checkbox"><label class="alectryon-input" for="Composition-v-chk10b">-</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>message, index</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>EqDecision0</var><span class="hyp-type"><b>: </b><span>EqDecision index</span></span></span><br><span><var>IM</var><span class="hyp-type"><b>: </b><span>index ‚Üí VLSM message</span></span></span><br><span><var>i</var><span class="hyp-type"><b>: </b><span>index</span></span></span><br><span><var>cs</var><span class="hyp-type"><b>: </b><span>composite_state</span></span></span><br><span><var>P</var><span class="hyp-type"><b>: </b><span>message ‚Üí <span class="kt">Prop</span></span></span></span><br><span><var>Hvsp</var><span class="hyp-type"><b>: </b><span>valid_state_prop
  (pre_loaded_vlsm free_composite_vlsm P) cs</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">weak_full_projection_transition_preservation
  (pre_loaded_vlsm (IM i) P)
  (pre_loaded_vlsm free_composite_vlsm P)
  (lift_to_composite_label i)
  (lift_to_composite_state cs i)</div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="bp">by</span> <span class="nb">inversion</span> <span class="mi">1</span>; <span class="nb">apply</span> lift_to_composite_transition_preservation.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="Composition-v-chk10c" style="display: none" type="checkbox"><label class="alectryon-input" for="Composition-v-chk10c">-</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>message, index</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>EqDecision0</var><span class="hyp-type"><b>: </b><span>EqDecision index</span></span></span><br><span><var>IM</var><span class="hyp-type"><b>: </b><span>index ‚Üí VLSM message</span></span></span><br><span><var>i</var><span class="hyp-type"><b>: </b><span>index</span></span></span><br><span><var>cs</var><span class="hyp-type"><b>: </b><span>composite_state</span></span></span><br><span><var>P</var><span class="hyp-type"><b>: </b><span>message ‚Üí <span class="kt">Prop</span></span></span></span><br><span><var>Hvsp</var><span class="hyp-type"><b>: </b><span>valid_state_prop
  (pre_loaded_vlsm free_composite_vlsm P) cs</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">weak_projection_initial_state_preservation
  (pre_loaded_vlsm (IM i) P)
  (pre_loaded_vlsm free_composite_vlsm P)
  (lift_to_composite_state cs i)</div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="bp">by</span> <span class="nb">intros</span> s Hs; <span class="nb">apply</span> pre_composite_free_update_state_with_initial.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="Composition-v-chk10d" style="display: none" type="checkbox"><label class="alectryon-input" for="Composition-v-chk10d">-</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>message, index</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>EqDecision0</var><span class="hyp-type"><b>: </b><span>EqDecision index</span></span></span><br><span><var>IM</var><span class="hyp-type"><b>: </b><span>index ‚Üí VLSM message</span></span></span><br><span><var>i</var><span class="hyp-type"><b>: </b><span>index</span></span></span><br><span><var>cs</var><span class="hyp-type"><b>: </b><span>composite_state</span></span></span><br><span><var>P</var><span class="hyp-type"><b>: </b><span>message ‚Üí <span class="kt">Prop</span></span></span></span><br><span><var>Hvsp</var><span class="hyp-type"><b>: </b><span>valid_state_prop
  (pre_loaded_vlsm free_composite_vlsm P) cs</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">weak_full_projection_initial_message_preservation
  (pre_loaded_vlsm (IM i) P)
  (pre_loaded_vlsm free_composite_vlsm P)
  (lift_to_composite_state cs i)</div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="Composition-v-chk10e" style="display: none" type="checkbox"><label class="alectryon-input" for="Composition-v-chk10e"><span class="nb">intros</span> _ _ m _ _ [Hm | Hp]; <span class="nb">apply</span> initial_message_is_valid; [<span class="nb">left</span> | <span class="bp">by</span> <span class="nb">right</span>].</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>message, index</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>EqDecision0</var><span class="hyp-type"><b>: </b><span>EqDecision index</span></span></span><br><span><var>IM</var><span class="hyp-type"><b>: </b><span>index ‚Üí VLSM message</span></span></span><br><span><var>i</var><span class="hyp-type"><b>: </b><span>index</span></span></span><br><span><var>cs</var><span class="hyp-type"><b>: </b><span>composite_state</span></span></span><br><span><var>P</var><span class="hyp-type"><b>: </b><span>message ‚Üí <span class="kt">Prop</span></span></span></span><br><span><var>Hvsp</var><span class="hyp-type"><b>: </b><span>valid_state_prop
  (pre_loaded_vlsm free_composite_vlsm P) cs</span></span></span><br><span><var>m</var><span class="hyp-type"><b>: </b><span>message</span></span></span><br><span><var>Hm</var><span class="hyp-type"><b>: </b><span>initial_message_prop m</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">initial_message_prop m</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><span class="alectryon-input"><span class="bp">by</span> <span class="nb">eapply</span> lift_to_composite_initial_message_preservation.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Qed</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
</span><span class="alectryon-sentence"><input class="alectryon-toggle" id="Composition-v-chk10f" style="display: none" type="checkbox"><label class="alectryon-input" for="Composition-v-chk10f"><span class="kn">Lemma</span> <span class="nf">lift_to_free_weak_full_projection</span> :
  <span class="kr">forall</span> (<span class="nv">i</span> : index) (<span class="nv">cs</span> : composite_state),
      valid_state_prop free_composite_vlsm cs -&gt;
      VLSM_weak_full_projection (IM i) free_composite_vlsm
        (lift_to_composite_label i) (lift_to_composite_state cs i).</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>message, index</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>EqDecision0</var><span class="hyp-type"><b>: </b><span>EqDecision index</span></span></span><br><span><var>IM</var><span class="hyp-type"><b>: </b><span>index ‚Üí VLSM message</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="kr">‚àÄ</span> (<span class="nv">i</span> : index) (<span class="nv">cs</span> : composite_state),
  valid_state_prop free_composite_vlsm cs
  ‚Üí VLSM_weak_full_projection (IM i)
      free_composite_vlsm (lift_to_composite_label i)
      (lift_to_composite_state cs i)</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="Composition-v-chk110" style="display: none" type="checkbox"><label class="alectryon-input" for="Composition-v-chk110"><span class="kn">Proof</span>.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>message, index</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>EqDecision0</var><span class="hyp-type"><b>: </b><span>EqDecision index</span></span></span><br><span><var>IM</var><span class="hyp-type"><b>: </b><span>index ‚Üí VLSM message</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="kr">‚àÄ</span> (<span class="nv">i</span> : index) (<span class="nv">cs</span> : composite_state),
  valid_state_prop free_composite_vlsm cs
  ‚Üí VLSM_weak_full_projection (IM i)
      free_composite_vlsm (lift_to_composite_label i)
      (lift_to_composite_state cs i)</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="Composition-v-chk111" style="display: none" type="checkbox"><label class="alectryon-input" for="Composition-v-chk111"><span class="nb">constructor</span>; <span class="nb">intros</span>.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>message, index</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>EqDecision0</var><span class="hyp-type"><b>: </b><span>EqDecision index</span></span></span><br><span><var>IM</var><span class="hyp-type"><b>: </b><span>index ‚Üí VLSM message</span></span></span><br><span><var>i</var><span class="hyp-type"><b>: </b><span>index</span></span></span><br><span><var>cs</var><span class="hyp-type"><b>: </b><span>composite_state</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>valid_state_prop free_composite_vlsm cs</span></span></span><br><span><var>sX</var><span class="hyp-type"><b>: </b><span>state</span></span></span><br><span><var>trX</var><span class="hyp-type"><b>: </b><span>list transition_item</span></span></span><br><span><var>H0</var><span class="hyp-type"><b>: </b><span>finite_valid_trace_from (IM i) sX trX</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">finite_valid_trace_from free_composite_vlsm
  (lift_to_composite_state cs i sX)
  (pre_VLSM_full_projection_finite_trace_project
     (type (IM i)) (type free_composite_vlsm)
     (lift_to_composite_label i)
     (lift_to_composite_state cs i) trX)</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="Composition-v-chk112" style="display: none" type="checkbox"><label class="alectryon-input" for="Composition-v-chk112"><span class="nb">apply</span> (VLSM_eq_finite_valid_trace_from (vlsm_is_pre_loaded_with_False free_composite_vlsm)),
        pre_lift_to_free_weak_full_projection.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>message, index</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>EqDecision0</var><span class="hyp-type"><b>: </b><span>EqDecision index</span></span></span><br><span><var>IM</var><span class="hyp-type"><b>: </b><span>index ‚Üí VLSM message</span></span></span><br><span><var>i</var><span class="hyp-type"><b>: </b><span>index</span></span></span><br><span><var>cs</var><span class="hyp-type"><b>: </b><span>composite_state</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>valid_state_prop free_composite_vlsm cs</span></span></span><br><span><var>sX</var><span class="hyp-type"><b>: </b><span>state</span></span></span><br><span><var>trX</var><span class="hyp-type"><b>: </b><span>list transition_item</span></span></span><br><span><var>H0</var><span class="hyp-type"><b>: </b><span>finite_valid_trace_from (IM i) sX trX</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">valid_state_prop
  (pre_loaded_vlsm free_composite_vlsm
     (<span class="kr">Œª</span> <span class="nv">_</span> : message, <span class="kt">False</span>)) cs</div></blockquote><div class="alectryon-extra-goals"><input class="alectryon-extra-goal-toggle" id="Composition-v-chk113" style="display: none" type="checkbox"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>message, index</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>EqDecision0</var><span class="hyp-type"><b>: </b><span>EqDecision index</span></span></span><br><span><var>IM</var><span class="hyp-type"><b>: </b><span>index ‚Üí VLSM message</span></span></span><br><span><var>i</var><span class="hyp-type"><b>: </b><span>index</span></span></span><br><span><var>cs</var><span class="hyp-type"><b>: </b><span>composite_state</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>valid_state_prop free_composite_vlsm cs</span></span></span><br><span><var>sX</var><span class="hyp-type"><b>: </b><span>state</span></span></span><br><span><var>trX</var><span class="hyp-type"><b>: </b><span>list transition_item</span></span></span><br><span><var>H0</var><span class="hyp-type"><b>: </b><span>finite_valid_trace_from (IM i) sX trX</span></span></span><br></div><label class="goal-separator" for="Composition-v-chk113"><hr></label><div class="goal-conclusion">finite_valid_trace_from
  (pre_loaded_vlsm (IM i) (<span class="kr">Œª</span> <span class="nv">_</span> : message, <span class="kt">False</span>)) sX
  trX</div></blockquote></div></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="Composition-v-chk114" style="display: none" type="checkbox"><label class="alectryon-input" for="Composition-v-chk114">-</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>message, index</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>EqDecision0</var><span class="hyp-type"><b>: </b><span>EqDecision index</span></span></span><br><span><var>IM</var><span class="hyp-type"><b>: </b><span>index ‚Üí VLSM message</span></span></span><br><span><var>i</var><span class="hyp-type"><b>: </b><span>index</span></span></span><br><span><var>cs</var><span class="hyp-type"><b>: </b><span>composite_state</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>valid_state_prop free_composite_vlsm cs</span></span></span><br><span><var>sX</var><span class="hyp-type"><b>: </b><span>state</span></span></span><br><span><var>trX</var><span class="hyp-type"><b>: </b><span>list transition_item</span></span></span><br><span><var>H0</var><span class="hyp-type"><b>: </b><span>finite_valid_trace_from (IM i) sX trX</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">valid_state_prop
  (pre_loaded_vlsm free_composite_vlsm
     (<span class="kr">Œª</span> <span class="nv">_</span> : message, <span class="kt">False</span>)) cs</div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="bp">by</span> <span class="nb">apply</span> (VLSM_eq_valid_state (vlsm_is_pre_loaded_with_False free_composite_vlsm)).</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="Composition-v-chk115" style="display: none" type="checkbox"><label class="alectryon-input" for="Composition-v-chk115">-</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>message, index</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>EqDecision0</var><span class="hyp-type"><b>: </b><span>EqDecision index</span></span></span><br><span><var>IM</var><span class="hyp-type"><b>: </b><span>index ‚Üí VLSM message</span></span></span><br><span><var>i</var><span class="hyp-type"><b>: </b><span>index</span></span></span><br><span><var>cs</var><span class="hyp-type"><b>: </b><span>composite_state</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>valid_state_prop free_composite_vlsm cs</span></span></span><br><span><var>sX</var><span class="hyp-type"><b>: </b><span>state</span></span></span><br><span><var>trX</var><span class="hyp-type"><b>: </b><span>list transition_item</span></span></span><br><span><var>H0</var><span class="hyp-type"><b>: </b><span>finite_valid_trace_from (IM i) sX trX</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">finite_valid_trace_from
  (pre_loaded_vlsm (IM i) (<span class="kr">Œª</span> <span class="nv">_</span> : message, <span class="kt">False</span>)) sX
  trX</div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="Composition-v-chk116" style="display: none" type="checkbox"><label class="alectryon-input" for="Composition-v-chk116"><span class="nb">apply</span> (VLSM_eq_finite_valid_trace_from (vlsm_is_pre_loaded_with_False (IM i))).</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>message, index</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>EqDecision0</var><span class="hyp-type"><b>: </b><span>EqDecision index</span></span></span><br><span><var>IM</var><span class="hyp-type"><b>: </b><span>index ‚Üí VLSM message</span></span></span><br><span><var>i</var><span class="hyp-type"><b>: </b><span>index</span></span></span><br><span><var>cs</var><span class="hyp-type"><b>: </b><span>composite_state</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>valid_state_prop free_composite_vlsm cs</span></span></span><br><span><var>sX</var><span class="hyp-type"><b>: </b><span>state</span></span></span><br><span><var>trX</var><span class="hyp-type"><b>: </b><span>list transition_item</span></span></span><br><span><var>H0</var><span class="hyp-type"><b>: </b><span>finite_valid_trace_from (IM i) sX trX</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">finite_valid_trace_from
  {|
    vtype := vtype (IM i); vmachine := machine (IM i)
  |} sX trX</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><span class="alectryon-input"><span class="bp">by</span> <span class="nb">destruct</span> (IM i).</span><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Qed</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
</span><span class="alectryon-sentence"><input class="alectryon-toggle" id="Composition-v-chk117" style="display: none" type="checkbox"><label class="alectryon-input" for="Composition-v-chk117"><span class="kn">Lemma</span> <span class="nf">lift_to_preloaded_free_weak_full_projection</span> :
  <span class="kr">forall</span> (<span class="nv">i</span> : index) (<span class="nv">cs</span> : composite_state),
      valid_state_prop (pre_loaded_with_all_messages_vlsm free_composite_vlsm) cs -&gt;
      VLSM_weak_full_projection
        (pre_loaded_with_all_messages_vlsm (IM i)) (pre_loaded_with_all_messages_vlsm free_composite_vlsm)
        (lift_to_composite_label i) (lift_to_composite_state cs i).</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>message, index</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>EqDecision0</var><span class="hyp-type"><b>: </b><span>EqDecision index</span></span></span><br><span><var>IM</var><span class="hyp-type"><b>: </b><span>index ‚Üí VLSM message</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="kr">‚àÄ</span> (<span class="nv">i</span> : index) (<span class="nv">cs</span> : composite_state),
  valid_state_prop
    (pre_loaded_with_all_messages_vlsm
       free_composite_vlsm) cs
  ‚Üí VLSM_weak_full_projection
      (pre_loaded_with_all_messages_vlsm (IM i))
      (pre_loaded_with_all_messages_vlsm
         free_composite_vlsm)
      (lift_to_composite_label i)
      (lift_to_composite_state cs i)</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="Composition-v-chk118" style="display: none" type="checkbox"><label class="alectryon-input" for="Composition-v-chk118"><span class="kn">Proof</span>.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>message, index</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>EqDecision0</var><span class="hyp-type"><b>: </b><span>EqDecision index</span></span></span><br><span><var>IM</var><span class="hyp-type"><b>: </b><span>index ‚Üí VLSM message</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="kr">‚àÄ</span> (<span class="nv">i</span> : index) (<span class="nv">cs</span> : composite_state),
  valid_state_prop
    (pre_loaded_with_all_messages_vlsm
       free_composite_vlsm) cs
  ‚Üí VLSM_weak_full_projection
      (pre_loaded_with_all_messages_vlsm (IM i))
      (pre_loaded_with_all_messages_vlsm
         free_composite_vlsm)
      (lift_to_composite_label i)
      (lift_to_composite_state cs i)</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="Composition-v-chk119" style="display: none" type="checkbox"><label class="alectryon-input" for="Composition-v-chk119"><span class="nb">constructor</span>; <span class="nb">intros</span>.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>message, index</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>EqDecision0</var><span class="hyp-type"><b>: </b><span>EqDecision index</span></span></span><br><span><var>IM</var><span class="hyp-type"><b>: </b><span>index ‚Üí VLSM message</span></span></span><br><span><var>i</var><span class="hyp-type"><b>: </b><span>index</span></span></span><br><span><var>cs</var><span class="hyp-type"><b>: </b><span>composite_state</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>valid_state_prop
  (pre_loaded_with_all_messages_vlsm
     free_composite_vlsm) cs</span></span></span><br><span><var>sX</var><span class="hyp-type"><b>: </b><span>state</span></span></span><br><span><var>trX</var><span class="hyp-type"><b>: </b><span>list transition_item</span></span></span><br><span><var>H0</var><span class="hyp-type"><b>: </b><span>finite_valid_trace_from
  (pre_loaded_with_all_messages_vlsm (IM i)) sX
  trX</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">finite_valid_trace_from
  (pre_loaded_with_all_messages_vlsm
     free_composite_vlsm)
  (lift_to_composite_state cs i sX)
  (pre_VLSM_full_projection_finite_trace_project
     (type (pre_loaded_with_all_messages_vlsm (IM i)))
     (type
        (pre_loaded_with_all_messages_vlsm
           free_composite_vlsm))
     (lift_to_composite_label i)
     (lift_to_composite_state cs i) trX)</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="Composition-v-chk11a" style="display: none" type="checkbox"><label class="alectryon-input" for="Composition-v-chk11a"><span class="nb">apply</span> (VLSM_eq_finite_valid_trace_from (pre_loaded_with_all_messages_vlsm_is_pre_loaded_with_True free_composite_vlsm)),
        pre_lift_to_free_weak_full_projection.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>message, index</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>EqDecision0</var><span class="hyp-type"><b>: </b><span>EqDecision index</span></span></span><br><span><var>IM</var><span class="hyp-type"><b>: </b><span>index ‚Üí VLSM message</span></span></span><br><span><var>i</var><span class="hyp-type"><b>: </b><span>index</span></span></span><br><span><var>cs</var><span class="hyp-type"><b>: </b><span>composite_state</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>valid_state_prop
  (pre_loaded_with_all_messages_vlsm
     free_composite_vlsm) cs</span></span></span><br><span><var>sX</var><span class="hyp-type"><b>: </b><span>state</span></span></span><br><span><var>trX</var><span class="hyp-type"><b>: </b><span>list transition_item</span></span></span><br><span><var>H0</var><span class="hyp-type"><b>: </b><span>finite_valid_trace_from
  (pre_loaded_with_all_messages_vlsm (IM i)) sX
  trX</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">valid_state_prop
  (pre_loaded_vlsm free_composite_vlsm
     (<span class="kr">Œª</span> <span class="nv">_</span> : message, <span class="kt">True</span>)) cs</div></blockquote><div class="alectryon-extra-goals"><input class="alectryon-extra-goal-toggle" id="Composition-v-chk11b" style="display: none" type="checkbox"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>message, index</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>EqDecision0</var><span class="hyp-type"><b>: </b><span>EqDecision index</span></span></span><br><span><var>IM</var><span class="hyp-type"><b>: </b><span>index ‚Üí VLSM message</span></span></span><br><span><var>i</var><span class="hyp-type"><b>: </b><span>index</span></span></span><br><span><var>cs</var><span class="hyp-type"><b>: </b><span>composite_state</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>valid_state_prop
  (pre_loaded_with_all_messages_vlsm
     free_composite_vlsm) cs</span></span></span><br><span><var>sX</var><span class="hyp-type"><b>: </b><span>state</span></span></span><br><span><var>trX</var><span class="hyp-type"><b>: </b><span>list transition_item</span></span></span><br><span><var>H0</var><span class="hyp-type"><b>: </b><span>finite_valid_trace_from
  (pre_loaded_with_all_messages_vlsm (IM i)) sX
  trX</span></span></span><br></div><label class="goal-separator" for="Composition-v-chk11b"><hr></label><div class="goal-conclusion">finite_valid_trace_from
  (pre_loaded_vlsm (IM i) (<span class="kr">Œª</span> <span class="nv">_</span> : message, <span class="kt">True</span>)) sX
  trX</div></blockquote></div></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="Composition-v-chk11c" style="display: none" type="checkbox"><label class="alectryon-input" for="Composition-v-chk11c">-</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>message, index</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>EqDecision0</var><span class="hyp-type"><b>: </b><span>EqDecision index</span></span></span><br><span><var>IM</var><span class="hyp-type"><b>: </b><span>index ‚Üí VLSM message</span></span></span><br><span><var>i</var><span class="hyp-type"><b>: </b><span>index</span></span></span><br><span><var>cs</var><span class="hyp-type"><b>: </b><span>composite_state</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>valid_state_prop
  (pre_loaded_with_all_messages_vlsm
     free_composite_vlsm) cs</span></span></span><br><span><var>sX</var><span class="hyp-type"><b>: </b><span>state</span></span></span><br><span><var>trX</var><span class="hyp-type"><b>: </b><span>list transition_item</span></span></span><br><span><var>H0</var><span class="hyp-type"><b>: </b><span>finite_valid_trace_from
  (pre_loaded_with_all_messages_vlsm (IM i)) sX
  trX</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">valid_state_prop
  (pre_loaded_vlsm free_composite_vlsm
     (<span class="kr">Œª</span> <span class="nv">_</span> : message, <span class="kt">True</span>)) cs</div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="bp">by</span> <span class="nb">apply</span> (VLSM_eq_valid_state (pre_loaded_with_all_messages_vlsm_is_pre_loaded_with_True free_composite_vlsm)).</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="Composition-v-chk11d" style="display: none" type="checkbox"><label class="alectryon-input" for="Composition-v-chk11d">-</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>message, index</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>EqDecision0</var><span class="hyp-type"><b>: </b><span>EqDecision index</span></span></span><br><span><var>IM</var><span class="hyp-type"><b>: </b><span>index ‚Üí VLSM message</span></span></span><br><span><var>i</var><span class="hyp-type"><b>: </b><span>index</span></span></span><br><span><var>cs</var><span class="hyp-type"><b>: </b><span>composite_state</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>valid_state_prop
  (pre_loaded_with_all_messages_vlsm
     free_composite_vlsm) cs</span></span></span><br><span><var>sX</var><span class="hyp-type"><b>: </b><span>state</span></span></span><br><span><var>trX</var><span class="hyp-type"><b>: </b><span>list transition_item</span></span></span><br><span><var>H0</var><span class="hyp-type"><b>: </b><span>finite_valid_trace_from
  (pre_loaded_with_all_messages_vlsm (IM i)) sX
  trX</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">finite_valid_trace_from
  (pre_loaded_vlsm (IM i) (<span class="kr">Œª</span> <span class="nv">_</span> : message, <span class="kt">True</span>)) sX
  trX</div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="Composition-v-chk11e" style="display: none" type="checkbox"><label class="alectryon-input" for="Composition-v-chk11e"><span class="nb">apply</span> (VLSM_eq_finite_valid_trace_from (pre_loaded_with_all_messages_vlsm_is_pre_loaded_with_True (IM i))).</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>message, index</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>EqDecision0</var><span class="hyp-type"><b>: </b><span>EqDecision index</span></span></span><br><span><var>IM</var><span class="hyp-type"><b>: </b><span>index ‚Üí VLSM message</span></span></span><br><span><var>i</var><span class="hyp-type"><b>: </b><span>index</span></span></span><br><span><var>cs</var><span class="hyp-type"><b>: </b><span>composite_state</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>valid_state_prop
  (pre_loaded_with_all_messages_vlsm
     free_composite_vlsm) cs</span></span></span><br><span><var>sX</var><span class="hyp-type"><b>: </b><span>state</span></span></span><br><span><var>trX</var><span class="hyp-type"><b>: </b><span>list transition_item</span></span></span><br><span><var>H0</var><span class="hyp-type"><b>: </b><span>finite_valid_trace_from
  (pre_loaded_with_all_messages_vlsm (IM i)) sX
  trX</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">finite_valid_trace_from
  {|
    vtype :=
      vtype (pre_loaded_with_all_messages_vlsm (IM i));
    vmachine :=
      machine
        (pre_loaded_with_all_messages_vlsm (IM i))
  |} sX trX</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><span class="alectryon-input"><span class="bp">by</span> <span class="nb">destruct</span> (IM i).</span><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Qed</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
</span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">End</span> <span class="nf">sec_composite_vlsm</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
</span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">End</span> <span class="nf">VLSM_composition</span>.</span></span></pre><div class="doc">
Hint database and tactic for dealing with updates and lifting via <span class="inlinecode"><span class="id" title="var">state_update</span></span>. 
</div><pre class="alectryon-io highlight"><!-- Generator: Alectryon --><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Create HintDb</span> state_update.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
</span><span class="alectryon-sentence"><span class="alectryon-input">#[export] <span class="kn">Hint Rewrite</span> @state_update_neq <span class="nb">using</span> <span class="bp">done</span> : state_update.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><span class="alectryon-input">#[export] <span class="kn">Hint Rewrite</span> @state_update_id <span class="nb">using</span> <span class="bp">done</span> : state_update.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><span class="alectryon-input">#[export] <span class="kn">Hint Rewrite</span> @state_update_eq : state_update.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
</span><span class="alectryon-sentence"><span class="alectryon-input">#[export] <span class="kn">Hint Unfold</span> lift_to_composite_state : state_update.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><span class="alectryon-input">#[export] <span class="kn">Hint Unfold</span> lift_to_composite_state&#39; : state_update.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
</span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Ltac</span> <span class="nf">state_update_simpl</span> :=
  <span class="nb">autounfold with</span> state_update <span class="kr">in</span> *; <span class="nb">autorewrite with</span> state_update <span class="kr">in</span> *.</span></span></pre><div class="doc">
  These basic projection lemmas relate
  the <span class="inlinecode"><span class="id" title="var">valid_state_prop</span></span> and <span class="inlinecode"><span class="id" title="var">input_valid_transition</span></span> of
  a composite VLSM back to those conditions holding
  over projections to individual components of the state.

<div class="paragraph"> </div>

  Because the composition may have validly produced
  messages that are not valid for an individual
  component (by interaction between components),
  We cannot just use properties <span class="inlinecode"><span class="id" title="var">valid_state_message_prop</span></span> <span class="inlinecode">(<span class="id" title="var">IM</span></span> <span class="inlinecode"><span class="id" title="var">i</span>)</span>
  or <span class="inlinecode"><span class="id" title="var">input_valid_transition</span></span> <span class="inlinecode">(<span class="id" title="var">IM</span></span> <span class="inlinecode"><span class="id" title="var">i</span>)</span>.
  For simplicity these lemmas use
  <span class="inlinecode"><span class="id" title="var">pre_loaded_with_all_messages_vlsm</span></span> <span class="inlinecode">(<span class="id" title="var">IM</span></span> <span class="inlinecode"><span class="id" title="var">i</span>)</span>.

<div class="paragraph"> </div>

  This does not precisely reflect the set of
  messages and transitions that can actually be
  seen in projections of transitions of the composite VLSM,
  but seems to be the best we can do with a result
  type that doesn't mention the other components or
  the composition constraint of the composite.

<div class="paragraph"> </div>

  Later in this file a
  <span class="inlinecode"><span class="id" title="var">composite_constrained_projection_vlsm</span></span> is defined
  that shares the states of <span class="inlinecode"><span class="id" title="var">IM</span></span> <span class="inlinecode"><span class="id" title="var">i</span></span> which is more
  precise.
 
</div><pre class="alectryon-io highlight"><!-- Generator: Alectryon --><span class="alectryon-sentence"><input class="alectryon-toggle" id="Composition-v-chk11f" style="display: none" type="checkbox"><label class="alectryon-input" for="Composition-v-chk11f"><span class="kn">Lemma</span> <span class="nf">valid_state_project_preloaded_to_preloaded</span>
      <span class="nv">message</span> `{EqDecision index} (IM : index -&gt; VLSM message) constraint
      (X:=composite_vlsm IM constraint)
      (s: vstate (pre_loaded_with_all_messages_vlsm X)) i:
  valid_state_prop (pre_loaded_with_all_messages_vlsm X) s -&gt;
  valid_state_prop (pre_loaded_with_all_messages_vlsm (IM i)) (s i).</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>message, index</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>EqDecision0</var><span class="hyp-type"><b>: </b><span>EqDecision index</span></span></span><br><span><var>IM</var><span class="hyp-type"><b>: </b><span>index ‚Üí VLSM message</span></span></span><br><span><var>constraint</var><span class="hyp-type"><b>: </b><span>composite_label IM
‚Üí composite_state IM * option message
  ‚Üí <span class="kt">Prop</span></span></span></span><br><span><var>X</var><span><span class="hyp-body"><b>:= </b><span>composite_vlsm IM constraint</span></span><span class="hyp-type"><b>: </b><span>VLSM message</span></span></span></span><br><span><var>s</var><span class="hyp-type"><b>: </b><span>vstate (pre_loaded_with_all_messages_vlsm X)</span></span></span><br><span><var>i</var><span class="hyp-type"><b>: </b><span>index</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">valid_state_prop (pre_loaded_with_all_messages_vlsm X)
  s
‚Üí valid_state_prop
    (pre_loaded_with_all_messages_vlsm (IM i)) (s i)</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="Composition-v-chk120" style="display: none" type="checkbox"><label class="alectryon-input" for="Composition-v-chk120"><span class="kn">Proof</span>.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>message, index</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>EqDecision0</var><span class="hyp-type"><b>: </b><span>EqDecision index</span></span></span><br><span><var>IM</var><span class="hyp-type"><b>: </b><span>index ‚Üí VLSM message</span></span></span><br><span><var>constraint</var><span class="hyp-type"><b>: </b><span>composite_label IM
‚Üí composite_state IM * option message
  ‚Üí <span class="kt">Prop</span></span></span></span><br><span><var>X</var><span><span class="hyp-body"><b>:= </b><span>composite_vlsm IM constraint</span></span><span class="hyp-type"><b>: </b><span>VLSM message</span></span></span></span><br><span><var>s</var><span class="hyp-type"><b>: </b><span>vstate (pre_loaded_with_all_messages_vlsm X)</span></span></span><br><span><var>i</var><span class="hyp-type"><b>: </b><span>index</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">valid_state_prop (pre_loaded_with_all_messages_vlsm X)
  s
‚Üí valid_state_prop
    (pre_loaded_with_all_messages_vlsm (IM i)) (s i)</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="Composition-v-chk121" style="display: none" type="checkbox"><label class="alectryon-input" for="Composition-v-chk121"><span class="nb">intros</span> [om Hproto].</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>message, index</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>EqDecision0</var><span class="hyp-type"><b>: </b><span>EqDecision index</span></span></span><br><span><var>IM</var><span class="hyp-type"><b>: </b><span>index ‚Üí VLSM message</span></span></span><br><span><var>constraint</var><span class="hyp-type"><b>: </b><span>composite_label IM
‚Üí composite_state IM * option message
  ‚Üí <span class="kt">Prop</span></span></span></span><br><span><var>X</var><span><span class="hyp-body"><b>:= </b><span>composite_vlsm IM constraint</span></span><span class="hyp-type"><b>: </b><span>VLSM message</span></span></span></span><br><span><var>s</var><span class="hyp-type"><b>: </b><span>vstate (pre_loaded_with_all_messages_vlsm X)</span></span></span><br><span><var>i</var><span class="hyp-type"><b>: </b><span>index</span></span></span><br><span><var>om</var><span class="hyp-type"><b>: </b><span>option message</span></span></span><br><span><var>Hproto</var><span class="hyp-type"><b>: </b><span>valid_state_message_prop
  (pre_loaded_with_all_messages_vlsm X) s om</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">valid_state_prop
  (pre_loaded_with_all_messages_vlsm (IM i)) (s i)</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="Composition-v-chk122" style="display: none" type="checkbox"><label class="alectryon-input" for="Composition-v-chk122"><span class="nb">apply</span> preloaded_valid_state_prop_iff.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>message, index</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>EqDecision0</var><span class="hyp-type"><b>: </b><span>EqDecision index</span></span></span><br><span><var>IM</var><span class="hyp-type"><b>: </b><span>index ‚Üí VLSM message</span></span></span><br><span><var>constraint</var><span class="hyp-type"><b>: </b><span>composite_label IM
‚Üí composite_state IM * option message
  ‚Üí <span class="kt">Prop</span></span></span></span><br><span><var>X</var><span><span class="hyp-body"><b>:= </b><span>composite_vlsm IM constraint</span></span><span class="hyp-type"><b>: </b><span>VLSM message</span></span></span></span><br><span><var>s</var><span class="hyp-type"><b>: </b><span>vstate (pre_loaded_with_all_messages_vlsm X)</span></span></span><br><span><var>i</var><span class="hyp-type"><b>: </b><span>index</span></span></span><br><span><var>om</var><span class="hyp-type"><b>: </b><span>option message</span></span></span><br><span><var>Hproto</var><span class="hyp-type"><b>: </b><span>valid_state_message_prop
  (pre_loaded_with_all_messages_vlsm X) s om</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">preloaded_valid_state_prop (IM i) (s i)</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="Composition-v-chk123" style="display: none" type="checkbox"><label class="alectryon-input" for="Composition-v-chk123"><span class="nb">induction</span> Hproto.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>message, index</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>EqDecision0</var><span class="hyp-type"><b>: </b><span>EqDecision index</span></span></span><br><span><var>IM</var><span class="hyp-type"><b>: </b><span>index ‚Üí VLSM message</span></span></span><br><span><var>constraint</var><span class="hyp-type"><b>: </b><span>composite_label IM
‚Üí composite_state IM * option message
  ‚Üí <span class="kt">Prop</span></span></span></span><br><span><var>X</var><span><span class="hyp-body"><b>:= </b><span>composite_vlsm IM constraint</span></span><span class="hyp-type"><b>: </b><span>VLSM message</span></span></span></span><br><span><var>i</var><span class="hyp-type"><b>: </b><span>index</span></span></span><br><span><var>s</var><span class="hyp-type"><b>: </b><span>state</span></span></span><br><span><var>Hs</var><span class="hyp-type"><b>: </b><span>initial_state_prop s</span></span></span><br><span><var>om</var><span class="hyp-type"><b>: </b><span>option message</span></span></span><br><span><var>Hom</var><span class="hyp-type"><b>: </b><span>option_initial_message_prop om</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">preloaded_valid_state_prop (IM i) (s i)</div></blockquote><div class="alectryon-extra-goals"><input class="alectryon-extra-goal-toggle" id="Composition-v-chk124" style="display: none" type="checkbox"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>message, index</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>EqDecision0</var><span class="hyp-type"><b>: </b><span>EqDecision index</span></span></span><br><span><var>IM</var><span class="hyp-type"><b>: </b><span>index ‚Üí VLSM message</span></span></span><br><span><var>constraint</var><span class="hyp-type"><b>: </b><span>composite_label IM
‚Üí composite_state IM * option message
  ‚Üí <span class="kt">Prop</span></span></span></span><br><span><var>X</var><span><span class="hyp-body"><b>:= </b><span>composite_vlsm IM constraint</span></span><span class="hyp-type"><b>: </b><span>VLSM message</span></span></span></span><br><span><var>i</var><span class="hyp-type"><b>: </b><span>index</span></span></span><br><span><var>s</var><span class="hyp-type"><b>: </b><span>state</span></span></span><br><span><var>_om</var><span class="hyp-type"><b>: </b><span>option message</span></span></span><br><span><var>Hproto1</var><span class="hyp-type"><b>: </b><span>valid_state_message_prop
  (pre_loaded_with_all_messages_vlsm X) s
  _om</span></span></span><br><span><var>_s</var><span class="hyp-type"><b>: </b><span>state</span></span></span><br><span><var>om</var><span class="hyp-type"><b>: </b><span>option message</span></span></span><br><span><var>Hproto2</var><span class="hyp-type"><b>: </b><span>valid_state_message_prop
  (pre_loaded_with_all_messages_vlsm X) _s
  om</span></span></span><br><span><var>l</var><span class="hyp-type"><b>: </b><span>label</span></span></span><br><span><var>Hv</var><span class="hyp-type"><b>: </b><span>valid l (s, om)</span></span></span><br><span><var>s'</var><span class="hyp-type"><b>: </b><span>state</span></span></span><br><span><var>om'</var><span class="hyp-type"><b>: </b><span>option message</span></span></span><br><span><var>Ht</var><span class="hyp-type"><b>: </b><span>transition l (s, om) = (s&#39;, om&#39;)</span></span></span><br><span><var>IHHproto1</var><span class="hyp-type"><b>: </b><span>preloaded_valid_state_prop (IM i) (s i)</span></span></span><br><span><var>IHHproto2</var><span class="hyp-type"><b>: </b><span>preloaded_valid_state_prop (IM i) (_s i)</span></span></span><br></div><label class="goal-separator" for="Composition-v-chk124"><hr></label><div class="goal-conclusion">preloaded_valid_state_prop (IM i) (s&#39; i)</div></blockquote></div></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="Composition-v-chk125" style="display: none" type="checkbox"><label class="alectryon-input" for="Composition-v-chk125">-</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>message, index</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>EqDecision0</var><span class="hyp-type"><b>: </b><span>EqDecision index</span></span></span><br><span><var>IM</var><span class="hyp-type"><b>: </b><span>index ‚Üí VLSM message</span></span></span><br><span><var>constraint</var><span class="hyp-type"><b>: </b><span>composite_label IM
‚Üí composite_state IM * option message
  ‚Üí <span class="kt">Prop</span></span></span></span><br><span><var>X</var><span><span class="hyp-body"><b>:= </b><span>composite_vlsm IM constraint</span></span><span class="hyp-type"><b>: </b><span>VLSM message</span></span></span></span><br><span><var>i</var><span class="hyp-type"><b>: </b><span>index</span></span></span><br><span><var>s</var><span class="hyp-type"><b>: </b><span>state</span></span></span><br><span><var>Hs</var><span class="hyp-type"><b>: </b><span>initial_state_prop s</span></span></span><br><span><var>om</var><span class="hyp-type"><b>: </b><span>option message</span></span></span><br><span><var>Hom</var><span class="hyp-type"><b>: </b><span>option_initial_message_prop om</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">preloaded_valid_state_prop (IM i) (s i)</div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="Composition-v-chk126" style="display: none" type="checkbox"><label class="alectryon-input" for="Composition-v-chk126"><span class="nb">apply</span> preloaded_valid_initial_state.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>message, index</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>EqDecision0</var><span class="hyp-type"><b>: </b><span>EqDecision index</span></span></span><br><span><var>IM</var><span class="hyp-type"><b>: </b><span>index ‚Üí VLSM message</span></span></span><br><span><var>constraint</var><span class="hyp-type"><b>: </b><span>composite_label IM
‚Üí composite_state IM * option message
  ‚Üí <span class="kt">Prop</span></span></span></span><br><span><var>X</var><span><span class="hyp-body"><b>:= </b><span>composite_vlsm IM constraint</span></span><span class="hyp-type"><b>: </b><span>VLSM message</span></span></span></span><br><span><var>i</var><span class="hyp-type"><b>: </b><span>index</span></span></span><br><span><var>s</var><span class="hyp-type"><b>: </b><span>state</span></span></span><br><span><var>Hs</var><span class="hyp-type"><b>: </b><span>initial_state_prop s</span></span></span><br><span><var>om</var><span class="hyp-type"><b>: </b><span>option message</span></span></span><br><span><var>Hom</var><span class="hyp-type"><b>: </b><span>option_initial_message_prop om</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">initial_state_prop (s i)</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><span class="alectryon-input"><span class="nb">apply</span> (Hs i).</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="Composition-v-chk127" style="display: none" type="checkbox"><label class="alectryon-input" for="Composition-v-chk127">-</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>message, index</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>EqDecision0</var><span class="hyp-type"><b>: </b><span>EqDecision index</span></span></span><br><span><var>IM</var><span class="hyp-type"><b>: </b><span>index ‚Üí VLSM message</span></span></span><br><span><var>constraint</var><span class="hyp-type"><b>: </b><span>composite_label IM
‚Üí composite_state IM * option message
  ‚Üí <span class="kt">Prop</span></span></span></span><br><span><var>X</var><span><span class="hyp-body"><b>:= </b><span>composite_vlsm IM constraint</span></span><span class="hyp-type"><b>: </b><span>VLSM message</span></span></span></span><br><span><var>i</var><span class="hyp-type"><b>: </b><span>index</span></span></span><br><span><var>s</var><span class="hyp-type"><b>: </b><span>state</span></span></span><br><span><var>_om</var><span class="hyp-type"><b>: </b><span>option message</span></span></span><br><span><var>Hproto1</var><span class="hyp-type"><b>: </b><span>valid_state_message_prop
  (pre_loaded_with_all_messages_vlsm X) s
  _om</span></span></span><br><span><var>_s</var><span class="hyp-type"><b>: </b><span>state</span></span></span><br><span><var>om</var><span class="hyp-type"><b>: </b><span>option message</span></span></span><br><span><var>Hproto2</var><span class="hyp-type"><b>: </b><span>valid_state_message_prop
  (pre_loaded_with_all_messages_vlsm X) _s
  om</span></span></span><br><span><var>l</var><span class="hyp-type"><b>: </b><span>label</span></span></span><br><span><var>Hv</var><span class="hyp-type"><b>: </b><span>valid l (s, om)</span></span></span><br><span><var>s'</var><span class="hyp-type"><b>: </b><span>state</span></span></span><br><span><var>om'</var><span class="hyp-type"><b>: </b><span>option message</span></span></span><br><span><var>Ht</var><span class="hyp-type"><b>: </b><span>transition l (s, om) = (s&#39;, om&#39;)</span></span></span><br><span><var>IHHproto1</var><span class="hyp-type"><b>: </b><span>preloaded_valid_state_prop (IM i) (s i)</span></span></span><br><span><var>IHHproto2</var><span class="hyp-type"><b>: </b><span>preloaded_valid_state_prop (IM i) (_s i)</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">preloaded_valid_state_prop (IM i) (s&#39; i)</div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="Composition-v-chk128" style="display: none" type="checkbox"><label class="alectryon-input" for="Composition-v-chk128"><span class="nb">destruct</span> l <span class="kr">as</span> [j lj].</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>message, index</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>EqDecision0</var><span class="hyp-type"><b>: </b><span>EqDecision index</span></span></span><br><span><var>IM</var><span class="hyp-type"><b>: </b><span>index ‚Üí VLSM message</span></span></span><br><span><var>constraint</var><span class="hyp-type"><b>: </b><span>composite_label IM
‚Üí composite_state IM * option message
  ‚Üí <span class="kt">Prop</span></span></span></span><br><span><var>X</var><span><span class="hyp-body"><b>:= </b><span>composite_vlsm IM constraint</span></span><span class="hyp-type"><b>: </b><span>VLSM message</span></span></span></span><br><span><var>i</var><span class="hyp-type"><b>: </b><span>index</span></span></span><br><span><var>s</var><span class="hyp-type"><b>: </b><span>state</span></span></span><br><span><var>_om</var><span class="hyp-type"><b>: </b><span>option message</span></span></span><br><span><var>Hproto1</var><span class="hyp-type"><b>: </b><span>valid_state_message_prop
  (pre_loaded_with_all_messages_vlsm X) s
  _om</span></span></span><br><span><var>_s</var><span class="hyp-type"><b>: </b><span>state</span></span></span><br><span><var>om</var><span class="hyp-type"><b>: </b><span>option message</span></span></span><br><span><var>Hproto2</var><span class="hyp-type"><b>: </b><span>valid_state_message_prop
  (pre_loaded_with_all_messages_vlsm X) _s
  om</span></span></span><br><span><var>j</var><span class="hyp-type"><b>: </b><span>index</span></span></span><br><span><var>lj</var><span class="hyp-type"><b>: </b><span>vlabel (IM j)</span></span></span><br><span><var>Hv</var><span class="hyp-type"><b>: </b><span>valid (existT j lj) (s, om)</span></span></span><br><span><var>s'</var><span class="hyp-type"><b>: </b><span>state</span></span></span><br><span><var>om'</var><span class="hyp-type"><b>: </b><span>option message</span></span></span><br><span><var>Ht</var><span class="hyp-type"><b>: </b><span>transition (existT j lj) (s, om) = (s&#39;, om&#39;)</span></span></span><br><span><var>IHHproto1</var><span class="hyp-type"><b>: </b><span>preloaded_valid_state_prop (IM i) (s i)</span></span></span><br><span><var>IHHproto2</var><span class="hyp-type"><b>: </b><span>preloaded_valid_state_prop (IM i) (_s i)</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">preloaded_valid_state_prop (IM i) (s&#39; i)</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="Composition-v-chk129" style="display: none" type="checkbox"><label class="alectryon-input" for="Composition-v-chk129"><span class="nb">simpl</span> <span class="kr">in</span> Ht.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>message, index</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>EqDecision0</var><span class="hyp-type"><b>: </b><span>EqDecision index</span></span></span><br><span><var>IM</var><span class="hyp-type"><b>: </b><span>index ‚Üí VLSM message</span></span></span><br><span><var>constraint</var><span class="hyp-type"><b>: </b><span>composite_label IM
‚Üí composite_state IM * option message
  ‚Üí <span class="kt">Prop</span></span></span></span><br><span><var>X</var><span><span class="hyp-body"><b>:= </b><span>composite_vlsm IM constraint</span></span><span class="hyp-type"><b>: </b><span>VLSM message</span></span></span></span><br><span><var>i</var><span class="hyp-type"><b>: </b><span>index</span></span></span><br><span><var>s</var><span class="hyp-type"><b>: </b><span>state</span></span></span><br><span><var>_om</var><span class="hyp-type"><b>: </b><span>option message</span></span></span><br><span><var>Hproto1</var><span class="hyp-type"><b>: </b><span>valid_state_message_prop
  (pre_loaded_with_all_messages_vlsm X) s
  _om</span></span></span><br><span><var>_s</var><span class="hyp-type"><b>: </b><span>state</span></span></span><br><span><var>om</var><span class="hyp-type"><b>: </b><span>option message</span></span></span><br><span><var>Hproto2</var><span class="hyp-type"><b>: </b><span>valid_state_message_prop
  (pre_loaded_with_all_messages_vlsm X) _s
  om</span></span></span><br><span><var>j</var><span class="hyp-type"><b>: </b><span>index</span></span></span><br><span><var>lj</var><span class="hyp-type"><b>: </b><span>vlabel (IM j)</span></span></span><br><span><var>Hv</var><span class="hyp-type"><b>: </b><span>valid (existT j lj) (s, om)</span></span></span><br><span><var>s'</var><span class="hyp-type"><b>: </b><span>state</span></span></span><br><span><var>om'</var><span class="hyp-type"><b>: </b><span>option message</span></span></span><br><span><var>Ht</var><span class="hyp-type"><b>: </b><span>vtransition X (existT j lj) (s, om) = (s&#39;, om&#39;)</span></span></span><br><span><var>IHHproto1</var><span class="hyp-type"><b>: </b><span>preloaded_valid_state_prop (IM i) (s i)</span></span></span><br><span><var>IHHproto2</var><span class="hyp-type"><b>: </b><span>preloaded_valid_state_prop (IM i) (_s i)</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">preloaded_valid_state_prop (IM i) (s&#39; i)</div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="Composition-v-chk12a" style="display: none" type="checkbox"><label class="alectryon-input" for="Composition-v-chk12a"><span class="nb">unfold</span> vtransition <span class="kr">in</span> Ht.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>message, index</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>EqDecision0</var><span class="hyp-type"><b>: </b><span>EqDecision index</span></span></span><br><span><var>IM</var><span class="hyp-type"><b>: </b><span>index ‚Üí VLSM message</span></span></span><br><span><var>constraint</var><span class="hyp-type"><b>: </b><span>composite_label IM
‚Üí composite_state IM * option message
  ‚Üí <span class="kt">Prop</span></span></span></span><br><span><var>X</var><span><span class="hyp-body"><b>:= </b><span>composite_vlsm IM constraint</span></span><span class="hyp-type"><b>: </b><span>VLSM message</span></span></span></span><br><span><var>i</var><span class="hyp-type"><b>: </b><span>index</span></span></span><br><span><var>s</var><span class="hyp-type"><b>: </b><span>state</span></span></span><br><span><var>_om</var><span class="hyp-type"><b>: </b><span>option message</span></span></span><br><span><var>Hproto1</var><span class="hyp-type"><b>: </b><span>valid_state_message_prop
  (pre_loaded_with_all_messages_vlsm X) s
  _om</span></span></span><br><span><var>_s</var><span class="hyp-type"><b>: </b><span>state</span></span></span><br><span><var>om</var><span class="hyp-type"><b>: </b><span>option message</span></span></span><br><span><var>Hproto2</var><span class="hyp-type"><b>: </b><span>valid_state_message_prop
  (pre_loaded_with_all_messages_vlsm X) _s
  om</span></span></span><br><span><var>j</var><span class="hyp-type"><b>: </b><span>index</span></span></span><br><span><var>lj</var><span class="hyp-type"><b>: </b><span>vlabel (IM j)</span></span></span><br><span><var>Hv</var><span class="hyp-type"><b>: </b><span>valid (existT j lj) (s, om)</span></span></span><br><span><var>s'</var><span class="hyp-type"><b>: </b><span>state</span></span></span><br><span><var>om'</var><span class="hyp-type"><b>: </b><span>option message</span></span></span><br><span><var>Ht</var><span class="hyp-type"><b>: </b><span>transition (existT j lj) (s, om) = (s&#39;, om&#39;)</span></span></span><br><span><var>IHHproto1</var><span class="hyp-type"><b>: </b><span>preloaded_valid_state_prop (IM i) (s i)</span></span></span><br><span><var>IHHproto2</var><span class="hyp-type"><b>: </b><span>preloaded_valid_state_prop (IM i) (_s i)</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">preloaded_valid_state_prop (IM i) (s&#39; i)</div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="Composition-v-chk12b" style="display: none" type="checkbox"><label class="alectryon-input" for="Composition-v-chk12b"><span class="nb">simpl</span> <span class="kr">in</span> Ht.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>message, index</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>EqDecision0</var><span class="hyp-type"><b>: </b><span>EqDecision index</span></span></span><br><span><var>IM</var><span class="hyp-type"><b>: </b><span>index ‚Üí VLSM message</span></span></span><br><span><var>constraint</var><span class="hyp-type"><b>: </b><span>composite_label IM
‚Üí composite_state IM * option message
  ‚Üí <span class="kt">Prop</span></span></span></span><br><span><var>X</var><span><span class="hyp-body"><b>:= </b><span>composite_vlsm IM constraint</span></span><span class="hyp-type"><b>: </b><span>VLSM message</span></span></span></span><br><span><var>i</var><span class="hyp-type"><b>: </b><span>index</span></span></span><br><span><var>s</var><span class="hyp-type"><b>: </b><span>state</span></span></span><br><span><var>_om</var><span class="hyp-type"><b>: </b><span>option message</span></span></span><br><span><var>Hproto1</var><span class="hyp-type"><b>: </b><span>valid_state_message_prop
  (pre_loaded_with_all_messages_vlsm X) s
  _om</span></span></span><br><span><var>_s</var><span class="hyp-type"><b>: </b><span>state</span></span></span><br><span><var>om</var><span class="hyp-type"><b>: </b><span>option message</span></span></span><br><span><var>Hproto2</var><span class="hyp-type"><b>: </b><span>valid_state_message_prop
  (pre_loaded_with_all_messages_vlsm X) _s
  om</span></span></span><br><span><var>j</var><span class="hyp-type"><b>: </b><span>index</span></span></span><br><span><var>lj</var><span class="hyp-type"><b>: </b><span>vlabel (IM j)</span></span></span><br><span><var>Hv</var><span class="hyp-type"><b>: </b><span>valid (existT j lj) (s, om)</span></span></span><br><span><var>s'</var><span class="hyp-type"><b>: </b><span>state</span></span></span><br><span><var>om'</var><span class="hyp-type"><b>: </b><span>option message</span></span></span><br><span><var>Ht</var><span class="hyp-type"><b>: </b><span>(<span class="kr">let</span> (<span class="nv">si&#39;</span>, om&#39;) :=
   vtransition (IM j) lj (s j, om) <span class="kr">in</span>
 (state_update IM s j si&#39;, om&#39;)) = 
(s&#39;, om&#39;)</span></span></span><br><span><var>IHHproto1</var><span class="hyp-type"><b>: </b><span>preloaded_valid_state_prop (IM i) (s i)</span></span></span><br><span><var>IHHproto2</var><span class="hyp-type"><b>: </b><span>preloaded_valid_state_prop (IM i) (_s i)</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">preloaded_valid_state_prop (IM i) (s&#39; i)</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="Composition-v-chk12c" style="display: none" type="checkbox"><label class="alectryon-input" for="Composition-v-chk12c"><span class="nb">destruct</span> (vtransition (IM j) _ _) <span class="kr">as</span> (si&#39;, _om&#39;) <span class="nb">eqn</span>:Hti.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>message, index</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>EqDecision0</var><span class="hyp-type"><b>: </b><span>EqDecision index</span></span></span><br><span><var>IM</var><span class="hyp-type"><b>: </b><span>index ‚Üí VLSM message</span></span></span><br><span><var>constraint</var><span class="hyp-type"><b>: </b><span>composite_label IM
‚Üí composite_state IM * option message
  ‚Üí <span class="kt">Prop</span></span></span></span><br><span><var>X</var><span><span class="hyp-body"><b>:= </b><span>composite_vlsm IM constraint</span></span><span class="hyp-type"><b>: </b><span>VLSM message</span></span></span></span><br><span><var>i</var><span class="hyp-type"><b>: </b><span>index</span></span></span><br><span><var>s</var><span class="hyp-type"><b>: </b><span>state</span></span></span><br><span><var>_om</var><span class="hyp-type"><b>: </b><span>option message</span></span></span><br><span><var>Hproto1</var><span class="hyp-type"><b>: </b><span>valid_state_message_prop
  (pre_loaded_with_all_messages_vlsm X) s
  _om</span></span></span><br><span><var>_s</var><span class="hyp-type"><b>: </b><span>state</span></span></span><br><span><var>om</var><span class="hyp-type"><b>: </b><span>option message</span></span></span><br><span><var>Hproto2</var><span class="hyp-type"><b>: </b><span>valid_state_message_prop
  (pre_loaded_with_all_messages_vlsm X) _s
  om</span></span></span><br><span><var>j</var><span class="hyp-type"><b>: </b><span>index</span></span></span><br><span><var>lj</var><span class="hyp-type"><b>: </b><span>vlabel (IM j)</span></span></span><br><span><var>Hv</var><span class="hyp-type"><b>: </b><span>valid (existT j lj) (s, om)</span></span></span><br><span><var>s'</var><span class="hyp-type"><b>: </b><span>state</span></span></span><br><span><var>om'</var><span class="hyp-type"><b>: </b><span>option message</span></span></span><br><span><var>si'</var><span class="hyp-type"><b>: </b><span>state</span></span></span><br><span><var>_om'</var><span class="hyp-type"><b>: </b><span>option message</span></span></span><br><span><var>Hti</var><span class="hyp-type"><b>: </b><span>vtransition (IM j) lj (s j, om) = (si&#39;, _om&#39;)</span></span></span><br><span><var>Ht</var><span class="hyp-type"><b>: </b><span>(state_update IM s j si&#39;, _om&#39;) = (s&#39;, om&#39;)</span></span></span><br><span><var>IHHproto1</var><span class="hyp-type"><b>: </b><span>preloaded_valid_state_prop (IM i) (s i)</span></span></span><br><span><var>IHHproto2</var><span class="hyp-type"><b>: </b><span>preloaded_valid_state_prop (IM i) (_s i)</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">preloaded_valid_state_prop (IM i) (s&#39; i)</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="Composition-v-chk12d" style="display: none" type="checkbox"><label class="alectryon-input" for="Composition-v-chk12d"><span class="nb">inversion_clear</span> Ht.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>message, index</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>EqDecision0</var><span class="hyp-type"><b>: </b><span>EqDecision index</span></span></span><br><span><var>IM</var><span class="hyp-type"><b>: </b><span>index ‚Üí VLSM message</span></span></span><br><span><var>constraint</var><span class="hyp-type"><b>: </b><span>composite_label IM
‚Üí composite_state IM * option message
  ‚Üí <span class="kt">Prop</span></span></span></span><br><span><var>X</var><span><span class="hyp-body"><b>:= </b><span>composite_vlsm IM constraint</span></span><span class="hyp-type"><b>: </b><span>VLSM message</span></span></span></span><br><span><var>i</var><span class="hyp-type"><b>: </b><span>index</span></span></span><br><span><var>s</var><span class="hyp-type"><b>: </b><span>state</span></span></span><br><span><var>_om</var><span class="hyp-type"><b>: </b><span>option message</span></span></span><br><span><var>Hproto1</var><span class="hyp-type"><b>: </b><span>valid_state_message_prop
  (pre_loaded_with_all_messages_vlsm X) s
  _om</span></span></span><br><span><var>_s</var><span class="hyp-type"><b>: </b><span>state</span></span></span><br><span><var>om</var><span class="hyp-type"><b>: </b><span>option message</span></span></span><br><span><var>Hproto2</var><span class="hyp-type"><b>: </b><span>valid_state_message_prop
  (pre_loaded_with_all_messages_vlsm X) _s
  om</span></span></span><br><span><var>j</var><span class="hyp-type"><b>: </b><span>index</span></span></span><br><span><var>lj</var><span class="hyp-type"><b>: </b><span>vlabel (IM j)</span></span></span><br><span><var>Hv</var><span class="hyp-type"><b>: </b><span>valid (existT j lj) (s, om)</span></span></span><br><span><var>s'</var><span class="hyp-type"><b>: </b><span>state</span></span></span><br><span><var>om'</var><span class="hyp-type"><b>: </b><span>option message</span></span></span><br><span><var>si'</var><span class="hyp-type"><b>: </b><span>state</span></span></span><br><span><var>_om'</var><span class="hyp-type"><b>: </b><span>option message</span></span></span><br><span><var>Hti</var><span class="hyp-type"><b>: </b><span>vtransition (IM j) lj (s j, om) = (si&#39;, _om&#39;)</span></span></span><br><span><var>IHHproto1</var><span class="hyp-type"><b>: </b><span>preloaded_valid_state_prop (IM i) (s i)</span></span></span><br><span><var>IHHproto2</var><span class="hyp-type"><b>: </b><span>preloaded_valid_state_prop (IM i) (_s i)</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">preloaded_valid_state_prop (IM i)
  (state_update IM s j si&#39; i)</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="Composition-v-chk12e" style="display: none" type="checkbox"><label class="alectryon-input" for="Composition-v-chk12e"><span class="nb">destruct</span> (decide (i = j)); <span class="nb">subst</span>; state_update_simpl; [| <span class="bp">done</span>].</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>message, index</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>EqDecision0</var><span class="hyp-type"><b>: </b><span>EqDecision index</span></span></span><br><span><var>IM</var><span class="hyp-type"><b>: </b><span>index ‚Üí VLSM message</span></span></span><br><span><var>constraint</var><span class="hyp-type"><b>: </b><span>composite_label IM
‚Üí composite_state IM * option message
  ‚Üí <span class="kt">Prop</span></span></span></span><br><span><var>X</var><span><span class="hyp-body"><b>:= </b><span>composite_vlsm IM constraint</span></span><span class="hyp-type"><b>: </b><span>VLSM message</span></span></span></span><br><span><var>s</var><span class="hyp-type"><b>: </b><span>state</span></span></span><br><span><var>_om</var><span class="hyp-type"><b>: </b><span>option message</span></span></span><br><span><var>Hproto1</var><span class="hyp-type"><b>: </b><span>valid_state_message_prop
  (pre_loaded_with_all_messages_vlsm X) s
  _om</span></span></span><br><span><var>_s</var><span class="hyp-type"><b>: </b><span>state</span></span></span><br><span><var>om</var><span class="hyp-type"><b>: </b><span>option message</span></span></span><br><span><var>Hproto2</var><span class="hyp-type"><b>: </b><span>valid_state_message_prop
  (pre_loaded_with_all_messages_vlsm X) _s
  om</span></span></span><br><span><var>j</var><span class="hyp-type"><b>: </b><span>index</span></span></span><br><span><var>lj</var><span class="hyp-type"><b>: </b><span>vlabel (IM j)</span></span></span><br><span><var>Hv</var><span class="hyp-type"><b>: </b><span>valid (existT j lj) (s, om)</span></span></span><br><span><var>s'</var><span class="hyp-type"><b>: </b><span>state</span></span></span><br><span><var>om'</var><span class="hyp-type"><b>: </b><span>option message</span></span></span><br><span><var>si'</var><span class="hyp-type"><b>: </b><span>state</span></span></span><br><span><var>_om'</var><span class="hyp-type"><b>: </b><span>option message</span></span></span><br><span><var>Hti</var><span class="hyp-type"><b>: </b><span>vtransition (IM j) lj (s j, om) = (si&#39;, _om&#39;)</span></span></span><br><span><var>IHHproto2</var><span class="hyp-type"><b>: </b><span>preloaded_valid_state_prop (IM j) (_s j)</span></span></span><br><span><var>IHHproto1</var><span class="hyp-type"><b>: </b><span>preloaded_valid_state_prop (IM j) (s j)</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">preloaded_valid_state_prop (IM j) si&#39;</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><span class="alectryon-input"><span class="bp">by</span> <span class="nb">apply</span> preloaded_protocol_generated <span class="kr">with</span> lj (s j) om _om&#39;; [| <span class="nb">apply</span> Hv |].</span><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Qed</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
</span><span class="alectryon-sentence"><input class="alectryon-toggle" id="Composition-v-chk12f" style="display: none" type="checkbox"><label class="alectryon-input" for="Composition-v-chk12f"><span class="kn">Lemma</span> <span class="nf">valid_state_project_preloaded</span>
      <span class="nv">message</span> `{EqDecision index} (IM : index -&gt; VLSM message) constraint
      (X:=composite_vlsm IM constraint)
      (s: vstate X) i:
  valid_state_prop X s -&gt;
  valid_state_prop (pre_loaded_with_all_messages_vlsm (IM i)) (s i).</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>message, index</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>EqDecision0</var><span class="hyp-type"><b>: </b><span>EqDecision index</span></span></span><br><span><var>IM</var><span class="hyp-type"><b>: </b><span>index ‚Üí VLSM message</span></span></span><br><span><var>constraint</var><span class="hyp-type"><b>: </b><span>composite_label IM
‚Üí composite_state IM * option message
  ‚Üí <span class="kt">Prop</span></span></span></span><br><span><var>X</var><span><span class="hyp-body"><b>:= </b><span>composite_vlsm IM constraint</span></span><span class="hyp-type"><b>: </b><span>VLSM message</span></span></span></span><br><span><var>s</var><span class="hyp-type"><b>: </b><span>vstate X</span></span></span><br><span><var>i</var><span class="hyp-type"><b>: </b><span>index</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">valid_state_prop X s
‚Üí valid_state_prop
    (pre_loaded_with_all_messages_vlsm (IM i)) (s i)</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="Composition-v-chk130" style="display: none" type="checkbox"><label class="alectryon-input" for="Composition-v-chk130"><span class="kn">Proof</span>.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>message, index</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>EqDecision0</var><span class="hyp-type"><b>: </b><span>EqDecision index</span></span></span><br><span><var>IM</var><span class="hyp-type"><b>: </b><span>index ‚Üí VLSM message</span></span></span><br><span><var>constraint</var><span class="hyp-type"><b>: </b><span>composite_label IM
‚Üí composite_state IM * option message
  ‚Üí <span class="kt">Prop</span></span></span></span><br><span><var>X</var><span><span class="hyp-body"><b>:= </b><span>composite_vlsm IM constraint</span></span><span class="hyp-type"><b>: </b><span>VLSM message</span></span></span></span><br><span><var>s</var><span class="hyp-type"><b>: </b><span>vstate X</span></span></span><br><span><var>i</var><span class="hyp-type"><b>: </b><span>index</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">valid_state_prop X s
‚Üí valid_state_prop
    (pre_loaded_with_all_messages_vlsm (IM i)) (s i)</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="Composition-v-chk131" style="display: none" type="checkbox"><label class="alectryon-input" for="Composition-v-chk131"><span class="nb">change</span> (vstate X) <span class="kr">with</span> (vstate (pre_loaded_with_all_messages_vlsm X)) <span class="kr">in</span> s.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>message, index</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>EqDecision0</var><span class="hyp-type"><b>: </b><span>EqDecision index</span></span></span><br><span><var>IM</var><span class="hyp-type"><b>: </b><span>index ‚Üí VLSM message</span></span></span><br><span><var>constraint</var><span class="hyp-type"><b>: </b><span>composite_label IM
‚Üí composite_state IM * option message
  ‚Üí <span class="kt">Prop</span></span></span></span><br><span><var>X</var><span><span class="hyp-body"><b>:= </b><span>composite_vlsm IM constraint</span></span><span class="hyp-type"><b>: </b><span>VLSM message</span></span></span></span><br><span><var>s</var><span class="hyp-type"><b>: </b><span>vstate (pre_loaded_with_all_messages_vlsm X)</span></span></span><br><span><var>i</var><span class="hyp-type"><b>: </b><span>index</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">valid_state_prop X s
‚Üí valid_state_prop
    (pre_loaded_with_all_messages_vlsm (IM i)) (s i)</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="Composition-v-chk132" style="display: none" type="checkbox"><label class="alectryon-input" for="Composition-v-chk132"><span class="nb">intros</span> [om Hproto].</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>message, index</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>EqDecision0</var><span class="hyp-type"><b>: </b><span>EqDecision index</span></span></span><br><span><var>IM</var><span class="hyp-type"><b>: </b><span>index ‚Üí VLSM message</span></span></span><br><span><var>constraint</var><span class="hyp-type"><b>: </b><span>composite_label IM
‚Üí composite_state IM * option message
  ‚Üí <span class="kt">Prop</span></span></span></span><br><span><var>X</var><span><span class="hyp-body"><b>:= </b><span>composite_vlsm IM constraint</span></span><span class="hyp-type"><b>: </b><span>VLSM message</span></span></span></span><br><span><var>s</var><span class="hyp-type"><b>: </b><span>vstate (pre_loaded_with_all_messages_vlsm X)</span></span></span><br><span><var>i</var><span class="hyp-type"><b>: </b><span>index</span></span></span><br><span><var>om</var><span class="hyp-type"><b>: </b><span>option message</span></span></span><br><span><var>Hproto</var><span class="hyp-type"><b>: </b><span>valid_state_message_prop X s om</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">valid_state_prop
  (pre_loaded_with_all_messages_vlsm (IM i)) (s i)</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="Composition-v-chk133" style="display: none" type="checkbox"><label class="alectryon-input" for="Composition-v-chk133"><span class="nb">apply</span> valid_state_project_preloaded_to_preloaded.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>message, index</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>EqDecision0</var><span class="hyp-type"><b>: </b><span>EqDecision index</span></span></span><br><span><var>IM</var><span class="hyp-type"><b>: </b><span>index ‚Üí VLSM message</span></span></span><br><span><var>constraint</var><span class="hyp-type"><b>: </b><span>composite_label IM
‚Üí composite_state IM * option message
  ‚Üí <span class="kt">Prop</span></span></span></span><br><span><var>X</var><span><span class="hyp-body"><b>:= </b><span>composite_vlsm IM constraint</span></span><span class="hyp-type"><b>: </b><span>VLSM message</span></span></span></span><br><span><var>s</var><span class="hyp-type"><b>: </b><span>vstate (pre_loaded_with_all_messages_vlsm X)</span></span></span><br><span><var>i</var><span class="hyp-type"><b>: </b><span>index</span></span></span><br><span><var>om</var><span class="hyp-type"><b>: </b><span>option message</span></span></span><br><span><var>Hproto</var><span class="hyp-type"><b>: </b><span>valid_state_message_prop X s om</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">valid_state_prop
  (pre_loaded_with_all_messages_vlsm
     (composite_vlsm IM constraint)) s</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="Composition-v-chk134" style="display: none" type="checkbox"><label class="alectryon-input" for="Composition-v-chk134"><span class="kr">exists</span> <span class="nv">om</span>.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>message, index</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>EqDecision0</var><span class="hyp-type"><b>: </b><span>EqDecision index</span></span></span><br><span><var>IM</var><span class="hyp-type"><b>: </b><span>index ‚Üí VLSM message</span></span></span><br><span><var>constraint</var><span class="hyp-type"><b>: </b><span>composite_label IM
‚Üí composite_state IM * option message
  ‚Üí <span class="kt">Prop</span></span></span></span><br><span><var>X</var><span><span class="hyp-body"><b>:= </b><span>composite_vlsm IM constraint</span></span><span class="hyp-type"><b>: </b><span>VLSM message</span></span></span></span><br><span><var>s</var><span class="hyp-type"><b>: </b><span>vstate (pre_loaded_with_all_messages_vlsm X)</span></span></span><br><span><var>i</var><span class="hyp-type"><b>: </b><span>index</span></span></span><br><span><var>om</var><span class="hyp-type"><b>: </b><span>option message</span></span></span><br><span><var>Hproto</var><span class="hyp-type"><b>: </b><span>valid_state_message_prop X s om</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">valid_state_message_prop
  (pre_loaded_with_all_messages_vlsm
     (composite_vlsm IM constraint)) s om</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><span class="alectryon-input"><span class="bp">by</span> <span class="nb">apply</span> preloaded_weaken_valid_state_message_prop.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Qed</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
</span><span class="alectryon-sentence"><input class="alectryon-toggle" id="Composition-v-chk135" style="display: none" type="checkbox"><label class="alectryon-input" for="Composition-v-chk135"><span class="kn">Lemma</span> <span class="nf">composite_transition_project_active</span>
      <span class="nv">message</span> `{EqDecision index} (IM : index -&gt; VLSM message)
  : <span class="kr">forall</span> (<span class="nv">l</span> : composite_label IM) (<span class="nv">s</span> : composite_state IM) (<span class="nv">im</span> : option message) (<span class="nv">s&#39;</span> : composite_state IM) (<span class="nv">om</span> : option message),
      composite_transition IM l (s, im) = (s&#39;, om) -&gt;
      vtransition (IM (projT1 l)) (projT2 l) (s (projT1 l), im) = (s&#39; (projT1 l), om).</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>message, index</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>EqDecision0</var><span class="hyp-type"><b>: </b><span>EqDecision index</span></span></span><br><span><var>IM</var><span class="hyp-type"><b>: </b><span>index ‚Üí VLSM message</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="kr">‚àÄ</span> (<span class="nv">l</span> : composite_label IM) (<span class="nv">s</span> : composite_state IM) 
  (<span class="nv">im</span> : option message) (<span class="nv">s&#39;</span> : composite_state IM) 
  (<span class="nv">om</span> : option message),
  composite_transition IM l (s, im) = (s&#39;, om)
  ‚Üí vtransition (IM (projT1 l)) (projT2 l)
      (s (projT1 l), im) = (s&#39; (projT1 l), om)</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="Composition-v-chk136" style="display: none" type="checkbox"><label class="alectryon-input" for="Composition-v-chk136"><span class="kn">Proof</span>.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>message, index</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>EqDecision0</var><span class="hyp-type"><b>: </b><span>EqDecision index</span></span></span><br><span><var>IM</var><span class="hyp-type"><b>: </b><span>index ‚Üí VLSM message</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="kr">‚àÄ</span> (<span class="nv">l</span> : composite_label IM) (<span class="nv">s</span> : composite_state IM) 
  (<span class="nv">im</span> : option message) (<span class="nv">s&#39;</span> : composite_state IM) 
  (<span class="nv">om</span> : option message),
  composite_transition IM l (s, im) = (s&#39;, om)
  ‚Üí vtransition (IM (projT1 l)) (projT2 l)
      (s (projT1 l), im) = (s&#39; (projT1 l), om)</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="Composition-v-chk137" style="display: none" type="checkbox"><label class="alectryon-input" for="Composition-v-chk137"><span class="nb">intros</span>.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>message, index</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>EqDecision0</var><span class="hyp-type"><b>: </b><span>EqDecision index</span></span></span><br><span><var>IM</var><span class="hyp-type"><b>: </b><span>index ‚Üí VLSM message</span></span></span><br><span><var>l</var><span class="hyp-type"><b>: </b><span>composite_label IM</span></span></span><br><span><var>s</var><span class="hyp-type"><b>: </b><span>composite_state IM</span></span></span><br><span><var>im</var><span class="hyp-type"><b>: </b><span>option message</span></span></span><br><span><var>s'</var><span class="hyp-type"><b>: </b><span>composite_state IM</span></span></span><br><span><var>om</var><span class="hyp-type"><b>: </b><span>option message</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>composite_transition IM l (s, im) = (s&#39;, om)</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">vtransition (IM (projT1 l)) (projT2 l)
  (s (projT1 l), im) = (s&#39; (projT1 l), om)</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="Composition-v-chk138" style="display: none" type="checkbox"><label class="alectryon-input" for="Composition-v-chk138"><span class="nb">destruct</span> l;<span class="nb">simpl</span>.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>message, index</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>EqDecision0</var><span class="hyp-type"><b>: </b><span>EqDecision index</span></span></span><br><span><var>IM</var><span class="hyp-type"><b>: </b><span>index ‚Üí VLSM message</span></span></span><br><span><var>x</var><span class="hyp-type"><b>: </b><span>index</span></span></span><br><span><var>v</var><span class="hyp-type"><b>: </b><span>vlabel (IM x)</span></span></span><br><span><var>s</var><span class="hyp-type"><b>: </b><span>composite_state IM</span></span></span><br><span><var>im</var><span class="hyp-type"><b>: </b><span>option message</span></span></span><br><span><var>s'</var><span class="hyp-type"><b>: </b><span>composite_state IM</span></span></span><br><span><var>om</var><span class="hyp-type"><b>: </b><span>option message</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>composite_transition IM (existT x v) (s, im) =
(s&#39;, om)</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">vtransition (IM x) v (s x, im) = (s&#39; x, om)</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="Composition-v-chk139" style="display: none" type="checkbox"><label class="alectryon-input" for="Composition-v-chk139"><span class="nb">simpl</span> <span class="kr">in</span> H.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>message, index</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>EqDecision0</var><span class="hyp-type"><b>: </b><span>EqDecision index</span></span></span><br><span><var>IM</var><span class="hyp-type"><b>: </b><span>index ‚Üí VLSM message</span></span></span><br><span><var>x</var><span class="hyp-type"><b>: </b><span>index</span></span></span><br><span><var>v</var><span class="hyp-type"><b>: </b><span>vlabel (IM x)</span></span></span><br><span><var>s</var><span class="hyp-type"><b>: </b><span>composite_state IM</span></span></span><br><span><var>im</var><span class="hyp-type"><b>: </b><span>option message</span></span></span><br><span><var>s'</var><span class="hyp-type"><b>: </b><span>composite_state IM</span></span></span><br><span><var>om</var><span class="hyp-type"><b>: </b><span>option message</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>(<span class="kr">let</span> (<span class="nv">si&#39;</span>, om&#39;) :=
   vtransition (IM x) v (s x, im) <span class="kr">in</span>
 (state_update IM s x si&#39;, om&#39;)) = 
(s&#39;, om)</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">vtransition (IM x) v (s x, im) = (s&#39; x, om)</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="Composition-v-chk13a" style="display: none" type="checkbox"><label class="alectryon-input" for="Composition-v-chk13a"><span class="nb">destruct</span> (vtransition (IM x) v (s x, im)).</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>message, index</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>EqDecision0</var><span class="hyp-type"><b>: </b><span>EqDecision index</span></span></span><br><span><var>IM</var><span class="hyp-type"><b>: </b><span>index ‚Üí VLSM message</span></span></span><br><span><var>x</var><span class="hyp-type"><b>: </b><span>index</span></span></span><br><span><var>v</var><span class="hyp-type"><b>: </b><span>vlabel (IM x)</span></span></span><br><span><var>s</var><span class="hyp-type"><b>: </b><span>composite_state IM</span></span></span><br><span><var>im</var><span class="hyp-type"><b>: </b><span>option message</span></span></span><br><span><var>s'</var><span class="hyp-type"><b>: </b><span>composite_state IM</span></span></span><br><span><var>om</var><span class="hyp-type"><b>: </b><span>option message</span></span></span><br><span><var>s0</var><span class="hyp-type"><b>: </b><span>state</span></span></span><br><span><var>o</var><span class="hyp-type"><b>: </b><span>option message</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>(state_update IM s x s0, o) = (s&#39;, om)</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">(s0, o) = (s&#39; x, om)</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="Composition-v-chk13b" style="display: none" type="checkbox"><label class="alectryon-input" for="Composition-v-chk13b"><span class="nb">inversion</span> H.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>message, index</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>EqDecision0</var><span class="hyp-type"><b>: </b><span>EqDecision index</span></span></span><br><span><var>IM</var><span class="hyp-type"><b>: </b><span>index ‚Üí VLSM message</span></span></span><br><span><var>x</var><span class="hyp-type"><b>: </b><span>index</span></span></span><br><span><var>v</var><span class="hyp-type"><b>: </b><span>vlabel (IM x)</span></span></span><br><span><var>s</var><span class="hyp-type"><b>: </b><span>composite_state IM</span></span></span><br><span><var>im</var><span class="hyp-type"><b>: </b><span>option message</span></span></span><br><span><var>s'</var><span class="hyp-type"><b>: </b><span>composite_state IM</span></span></span><br><span><var>om</var><span class="hyp-type"><b>: </b><span>option message</span></span></span><br><span><var>s0</var><span class="hyp-type"><b>: </b><span>state</span></span></span><br><span><var>o</var><span class="hyp-type"><b>: </b><span>option message</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>(state_update IM s x s0, o) = (s&#39;, om)</span></span></span><br><span><var>H1</var><span class="hyp-type"><b>: </b><span>state_update IM s x s0 = s&#39;</span></span></span><br><span><var>H2</var><span class="hyp-type"><b>: </b><span>o = om</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">(s0, om) = (state_update IM s x s0 x, om)</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="Composition-v-chk13c" style="display: none" type="checkbox"><label class="alectryon-input" for="Composition-v-chk13c"><span class="nb">f_equal</span>.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>message, index</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>EqDecision0</var><span class="hyp-type"><b>: </b><span>EqDecision index</span></span></span><br><span><var>IM</var><span class="hyp-type"><b>: </b><span>index ‚Üí VLSM message</span></span></span><br><span><var>x</var><span class="hyp-type"><b>: </b><span>index</span></span></span><br><span><var>v</var><span class="hyp-type"><b>: </b><span>vlabel (IM x)</span></span></span><br><span><var>s</var><span class="hyp-type"><b>: </b><span>composite_state IM</span></span></span><br><span><var>im</var><span class="hyp-type"><b>: </b><span>option message</span></span></span><br><span><var>s'</var><span class="hyp-type"><b>: </b><span>composite_state IM</span></span></span><br><span><var>om</var><span class="hyp-type"><b>: </b><span>option message</span></span></span><br><span><var>s0</var><span class="hyp-type"><b>: </b><span>state</span></span></span><br><span><var>o</var><span class="hyp-type"><b>: </b><span>option message</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>(state_update IM s x s0, o) = (s&#39;, om)</span></span></span><br><span><var>H1</var><span class="hyp-type"><b>: </b><span>state_update IM s x s0 = s&#39;</span></span></span><br><span><var>H2</var><span class="hyp-type"><b>: </b><span>o = om</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">s0 = state_update IM s x s0 x</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><span class="alectryon-input"><span class="bp">by</span> state_update_simpl.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Qed</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
</span><span class="alectryon-sentence"><input class="alectryon-toggle" id="Composition-v-chk13d" style="display: none" type="checkbox"><label class="alectryon-input" for="Composition-v-chk13d"><span class="kn">Lemma</span> <span class="nf">input_valid_transition_preloaded_project_active</span>
      {<span class="nv">message</span>} `{EqDecision V} {IM: V -&gt; VLSM message} {constraint}
      (X := composite_vlsm IM constraint)
      l s im s&#39; om:
  input_valid_transition (pre_loaded_with_all_messages_vlsm X) l (s,im) (s&#39;,om) -&gt;
  input_valid_transition (pre_loaded_with_all_messages_vlsm (IM (projT1 l))) (projT2 l)
                         (s (projT1 l), im) (s&#39; (projT1 l), om).</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>message, V</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>EqDecision0</var><span class="hyp-type"><b>: </b><span>EqDecision V</span></span></span><br><span><var>IM</var><span class="hyp-type"><b>: </b><span>V ‚Üí VLSM message</span></span></span><br><span><var>constraint</var><span class="hyp-type"><b>: </b><span>composite_label IM
‚Üí composite_state IM * option message
  ‚Üí <span class="kt">Prop</span></span></span></span><br><span><var>X</var><span><span class="hyp-body"><b>:= </b><span>composite_vlsm IM constraint</span></span><span class="hyp-type"><b>: </b><span>VLSM message</span></span></span></span><br><span><var>l</var><span class="hyp-type"><b>: </b><span>label</span></span></span><br><span><var>s</var><span class="hyp-type"><b>: </b><span>state</span></span></span><br><span><var>im</var><span class="hyp-type"><b>: </b><span>option message</span></span></span><br><span><var>s'</var><span class="hyp-type"><b>: </b><span>state</span></span></span><br><span><var>om</var><span class="hyp-type"><b>: </b><span>option message</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">input_valid_transition
  (pre_loaded_with_all_messages_vlsm X) l (s, im)
  (s&#39;, om)
‚Üí input_valid_transition
    (pre_loaded_with_all_messages_vlsm (IM (projT1 l)))
    (projT2 l) (s (projT1 l), im) (s&#39; (projT1 l), om)</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="Composition-v-chk13e" style="display: none" type="checkbox"><label class="alectryon-input" for="Composition-v-chk13e"><span class="kn">Proof</span>.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>message, V</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>EqDecision0</var><span class="hyp-type"><b>: </b><span>EqDecision V</span></span></span><br><span><var>IM</var><span class="hyp-type"><b>: </b><span>V ‚Üí VLSM message</span></span></span><br><span><var>constraint</var><span class="hyp-type"><b>: </b><span>composite_label IM
‚Üí composite_state IM * option message
  ‚Üí <span class="kt">Prop</span></span></span></span><br><span><var>X</var><span><span class="hyp-body"><b>:= </b><span>composite_vlsm IM constraint</span></span><span class="hyp-type"><b>: </b><span>VLSM message</span></span></span></span><br><span><var>l</var><span class="hyp-type"><b>: </b><span>label</span></span></span><br><span><var>s</var><span class="hyp-type"><b>: </b><span>state</span></span></span><br><span><var>im</var><span class="hyp-type"><b>: </b><span>option message</span></span></span><br><span><var>s'</var><span class="hyp-type"><b>: </b><span>state</span></span></span><br><span><var>om</var><span class="hyp-type"><b>: </b><span>option message</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">input_valid_transition
  (pre_loaded_with_all_messages_vlsm X) l (s, im)
  (s&#39;, om)
‚Üí input_valid_transition
    (pre_loaded_with_all_messages_vlsm (IM (projT1 l)))
    (projT2 l) (s (projT1 l), im) (s&#39; (projT1 l), om)</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="Composition-v-chk13f" style="display: none" type="checkbox"><label class="alectryon-input" for="Composition-v-chk13f"><span class="nb">intro</span> Hptrans.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>message, V</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>EqDecision0</var><span class="hyp-type"><b>: </b><span>EqDecision V</span></span></span><br><span><var>IM</var><span class="hyp-type"><b>: </b><span>V ‚Üí VLSM message</span></span></span><br><span><var>constraint</var><span class="hyp-type"><b>: </b><span>composite_label IM
‚Üí composite_state IM * option message
  ‚Üí <span class="kt">Prop</span></span></span></span><br><span><var>X</var><span><span class="hyp-body"><b>:= </b><span>composite_vlsm IM constraint</span></span><span class="hyp-type"><b>: </b><span>VLSM message</span></span></span></span><br><span><var>l</var><span class="hyp-type"><b>: </b><span>label</span></span></span><br><span><var>s</var><span class="hyp-type"><b>: </b><span>state</span></span></span><br><span><var>im</var><span class="hyp-type"><b>: </b><span>option message</span></span></span><br><span><var>s'</var><span class="hyp-type"><b>: </b><span>state</span></span></span><br><span><var>om</var><span class="hyp-type"><b>: </b><span>option message</span></span></span><br><span><var>Hptrans</var><span class="hyp-type"><b>: </b><span>input_valid_transition
  (pre_loaded_with_all_messages_vlsm X) l
  (s, im) (s&#39;, om)</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">input_valid_transition
  (pre_loaded_with_all_messages_vlsm (IM (projT1 l)))
  (projT2 l) (s (projT1 l), im) (s&#39; (projT1 l), om)</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="Composition-v-chk140" style="display: none" type="checkbox"><label class="alectryon-input" for="Composition-v-chk140"><span class="nb">destruct</span> Hptrans <span class="kr">as</span> [Hpvalid Htrans].</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>message, V</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>EqDecision0</var><span class="hyp-type"><b>: </b><span>EqDecision V</span></span></span><br><span><var>IM</var><span class="hyp-type"><b>: </b><span>V ‚Üí VLSM message</span></span></span><br><span><var>constraint</var><span class="hyp-type"><b>: </b><span>composite_label IM
‚Üí composite_state IM * option message
  ‚Üí <span class="kt">Prop</span></span></span></span><br><span><var>X</var><span><span class="hyp-body"><b>:= </b><span>composite_vlsm IM constraint</span></span><span class="hyp-type"><b>: </b><span>VLSM message</span></span></span></span><br><span><var>l</var><span class="hyp-type"><b>: </b><span>label</span></span></span><br><span><var>s</var><span class="hyp-type"><b>: </b><span>state</span></span></span><br><span><var>im</var><span class="hyp-type"><b>: </b><span>option message</span></span></span><br><span><var>s'</var><span class="hyp-type"><b>: </b><span>state</span></span></span><br><span><var>om</var><span class="hyp-type"><b>: </b><span>option message</span></span></span><br><span><var>Hpvalid</var><span class="hyp-type"><b>: </b><span>input_valid
  (pre_loaded_with_all_messages_vlsm X) l
  (s, im)</span></span></span><br><span><var>Htrans</var><span class="hyp-type"><b>: </b><span>transition l (s, im) = (s&#39;, om)</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">input_valid_transition
  (pre_loaded_with_all_messages_vlsm (IM (projT1 l)))
  (projT2 l) (s (projT1 l), im) (s&#39; (projT1 l), om)</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="Composition-v-chk141" style="display: none" type="checkbox"><label class="alectryon-input" for="Composition-v-chk141"><span class="nb">split</span>.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>message, V</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>EqDecision0</var><span class="hyp-type"><b>: </b><span>EqDecision V</span></span></span><br><span><var>IM</var><span class="hyp-type"><b>: </b><span>V ‚Üí VLSM message</span></span></span><br><span><var>constraint</var><span class="hyp-type"><b>: </b><span>composite_label IM
‚Üí composite_state IM * option message
  ‚Üí <span class="kt">Prop</span></span></span></span><br><span><var>X</var><span><span class="hyp-body"><b>:= </b><span>composite_vlsm IM constraint</span></span><span class="hyp-type"><b>: </b><span>VLSM message</span></span></span></span><br><span><var>l</var><span class="hyp-type"><b>: </b><span>label</span></span></span><br><span><var>s</var><span class="hyp-type"><b>: </b><span>state</span></span></span><br><span><var>im</var><span class="hyp-type"><b>: </b><span>option message</span></span></span><br><span><var>s'</var><span class="hyp-type"><b>: </b><span>state</span></span></span><br><span><var>om</var><span class="hyp-type"><b>: </b><span>option message</span></span></span><br><span><var>Hpvalid</var><span class="hyp-type"><b>: </b><span>input_valid
  (pre_loaded_with_all_messages_vlsm X) l
  (s, im)</span></span></span><br><span><var>Htrans</var><span class="hyp-type"><b>: </b><span>transition l (s, im) = (s&#39;, om)</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">input_valid
  (pre_loaded_with_all_messages_vlsm (IM (projT1 l)))
  (projT2 l) (s (projT1 l), im)</div></blockquote><div class="alectryon-extra-goals"><input class="alectryon-extra-goal-toggle" id="Composition-v-chk142" style="display: none" type="checkbox"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>message, V</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>EqDecision0</var><span class="hyp-type"><b>: </b><span>EqDecision V</span></span></span><br><span><var>IM</var><span class="hyp-type"><b>: </b><span>V ‚Üí VLSM message</span></span></span><br><span><var>constraint</var><span class="hyp-type"><b>: </b><span>composite_label IM
‚Üí composite_state IM * option message
  ‚Üí <span class="kt">Prop</span></span></span></span><br><span><var>X</var><span><span class="hyp-body"><b>:= </b><span>composite_vlsm IM constraint</span></span><span class="hyp-type"><b>: </b><span>VLSM message</span></span></span></span><br><span><var>l</var><span class="hyp-type"><b>: </b><span>label</span></span></span><br><span><var>s</var><span class="hyp-type"><b>: </b><span>state</span></span></span><br><span><var>im</var><span class="hyp-type"><b>: </b><span>option message</span></span></span><br><span><var>s'</var><span class="hyp-type"><b>: </b><span>state</span></span></span><br><span><var>om</var><span class="hyp-type"><b>: </b><span>option message</span></span></span><br><span><var>Hpvalid</var><span class="hyp-type"><b>: </b><span>input_valid
  (pre_loaded_with_all_messages_vlsm X) l
  (s, im)</span></span></span><br><span><var>Htrans</var><span class="hyp-type"><b>: </b><span>transition l (s, im) = (s&#39;, om)</span></span></span><br></div><label class="goal-separator" for="Composition-v-chk142"><hr></label><div class="goal-conclusion">transition (projT2 l) (s (projT1 l), im) =
(s&#39; (projT1 l), om)</div></blockquote></div></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="Composition-v-chk143" style="display: none" type="checkbox"><label class="alectryon-input" for="Composition-v-chk143">-</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>message, V</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>EqDecision0</var><span class="hyp-type"><b>: </b><span>EqDecision V</span></span></span><br><span><var>IM</var><span class="hyp-type"><b>: </b><span>V ‚Üí VLSM message</span></span></span><br><span><var>constraint</var><span class="hyp-type"><b>: </b><span>composite_label IM
‚Üí composite_state IM * option message
  ‚Üí <span class="kt">Prop</span></span></span></span><br><span><var>X</var><span><span class="hyp-body"><b>:= </b><span>composite_vlsm IM constraint</span></span><span class="hyp-type"><b>: </b><span>VLSM message</span></span></span></span><br><span><var>l</var><span class="hyp-type"><b>: </b><span>label</span></span></span><br><span><var>s</var><span class="hyp-type"><b>: </b><span>state</span></span></span><br><span><var>im</var><span class="hyp-type"><b>: </b><span>option message</span></span></span><br><span><var>s'</var><span class="hyp-type"><b>: </b><span>state</span></span></span><br><span><var>om</var><span class="hyp-type"><b>: </b><span>option message</span></span></span><br><span><var>Hpvalid</var><span class="hyp-type"><b>: </b><span>input_valid
  (pre_loaded_with_all_messages_vlsm X) l
  (s, im)</span></span></span><br><span><var>Htrans</var><span class="hyp-type"><b>: </b><span>transition l (s, im) = (s&#39;, om)</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">input_valid
  (pre_loaded_with_all_messages_vlsm (IM (projT1 l)))
  (projT2 l) (s (projT1 l), im)</div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="Composition-v-chk144" style="display: none" type="checkbox"><label class="alectryon-input" for="Composition-v-chk144"><span class="nb">destruct</span> Hpvalid <span class="kr">as</span> [Hproto_s [_ Hcvalid]].</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>message, V</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>EqDecision0</var><span class="hyp-type"><b>: </b><span>EqDecision V</span></span></span><br><span><var>IM</var><span class="hyp-type"><b>: </b><span>V ‚Üí VLSM message</span></span></span><br><span><var>constraint</var><span class="hyp-type"><b>: </b><span>composite_label IM
‚Üí composite_state IM * option message
  ‚Üí <span class="kt">Prop</span></span></span></span><br><span><var>X</var><span><span class="hyp-body"><b>:= </b><span>composite_vlsm IM constraint</span></span><span class="hyp-type"><b>: </b><span>VLSM message</span></span></span></span><br><span><var>l</var><span class="hyp-type"><b>: </b><span>label</span></span></span><br><span><var>s</var><span class="hyp-type"><b>: </b><span>state</span></span></span><br><span><var>im</var><span class="hyp-type"><b>: </b><span>option message</span></span></span><br><span><var>s'</var><span class="hyp-type"><b>: </b><span>state</span></span></span><br><span><var>om</var><span class="hyp-type"><b>: </b><span>option message</span></span></span><br><span><var>Hproto_s</var><span class="hyp-type"><b>: </b><span>valid_state_prop
  (pre_loaded_with_all_messages_vlsm X) s</span></span></span><br><span><var>Hcvalid</var><span class="hyp-type"><b>: </b><span>valid l (s, im)</span></span></span><br><span><var>Htrans</var><span class="hyp-type"><b>: </b><span>transition l (s, im) = (s&#39;, om)</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">input_valid
  (pre_loaded_with_all_messages_vlsm (IM (projT1 l)))
  (projT2 l) (s (projT1 l), im)</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="Composition-v-chk145" style="display: none" type="checkbox"><label class="alectryon-input" for="Composition-v-chk145"><span class="nb">split</span>;[|<span class="nb">split</span>].</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>message, V</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>EqDecision0</var><span class="hyp-type"><b>: </b><span>EqDecision V</span></span></span><br><span><var>IM</var><span class="hyp-type"><b>: </b><span>V ‚Üí VLSM message</span></span></span><br><span><var>constraint</var><span class="hyp-type"><b>: </b><span>composite_label IM
‚Üí composite_state IM * option message
  ‚Üí <span class="kt">Prop</span></span></span></span><br><span><var>X</var><span><span class="hyp-body"><b>:= </b><span>composite_vlsm IM constraint</span></span><span class="hyp-type"><b>: </b><span>VLSM message</span></span></span></span><br><span><var>l</var><span class="hyp-type"><b>: </b><span>label</span></span></span><br><span><var>s</var><span class="hyp-type"><b>: </b><span>state</span></span></span><br><span><var>im</var><span class="hyp-type"><b>: </b><span>option message</span></span></span><br><span><var>s'</var><span class="hyp-type"><b>: </b><span>state</span></span></span><br><span><var>om</var><span class="hyp-type"><b>: </b><span>option message</span></span></span><br><span><var>Hproto_s</var><span class="hyp-type"><b>: </b><span>valid_state_prop
  (pre_loaded_with_all_messages_vlsm X) s</span></span></span><br><span><var>Hcvalid</var><span class="hyp-type"><b>: </b><span>valid l (s, im)</span></span></span><br><span><var>Htrans</var><span class="hyp-type"><b>: </b><span>transition l (s, im) = (s&#39;, om)</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">valid_state_prop
  (pre_loaded_with_all_messages_vlsm (IM (projT1 l)))
  (s (projT1 l))</div></blockquote><div class="alectryon-extra-goals"><input class="alectryon-extra-goal-toggle" id="Composition-v-chk146" style="display: none" type="checkbox"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>message, V</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>EqDecision0</var><span class="hyp-type"><b>: </b><span>EqDecision V</span></span></span><br><span><var>IM</var><span class="hyp-type"><b>: </b><span>V ‚Üí VLSM message</span></span></span><br><span><var>constraint</var><span class="hyp-type"><b>: </b><span>composite_label IM
‚Üí composite_state IM * option message
  ‚Üí <span class="kt">Prop</span></span></span></span><br><span><var>X</var><span><span class="hyp-body"><b>:= </b><span>composite_vlsm IM constraint</span></span><span class="hyp-type"><b>: </b><span>VLSM message</span></span></span></span><br><span><var>l</var><span class="hyp-type"><b>: </b><span>label</span></span></span><br><span><var>s</var><span class="hyp-type"><b>: </b><span>state</span></span></span><br><span><var>im</var><span class="hyp-type"><b>: </b><span>option message</span></span></span><br><span><var>s'</var><span class="hyp-type"><b>: </b><span>state</span></span></span><br><span><var>om</var><span class="hyp-type"><b>: </b><span>option message</span></span></span><br><span><var>Hproto_s</var><span class="hyp-type"><b>: </b><span>valid_state_prop
  (pre_loaded_with_all_messages_vlsm X) s</span></span></span><br><span><var>Hcvalid</var><span class="hyp-type"><b>: </b><span>valid l (s, im)</span></span></span><br><span><var>Htrans</var><span class="hyp-type"><b>: </b><span>transition l (s, im) = (s&#39;, om)</span></span></span><br></div><label class="goal-separator" for="Composition-v-chk146"><hr></label><div class="goal-conclusion">option_valid_message_prop
  (pre_loaded_with_all_messages_vlsm (IM (projT1 l)))
  im</div></blockquote><input class="alectryon-extra-goal-toggle" id="Composition-v-chk147" style="display: none" type="checkbox"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>message, V</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>EqDecision0</var><span class="hyp-type"><b>: </b><span>EqDecision V</span></span></span><br><span><var>IM</var><span class="hyp-type"><b>: </b><span>V ‚Üí VLSM message</span></span></span><br><span><var>constraint</var><span class="hyp-type"><b>: </b><span>composite_label IM
‚Üí composite_state IM * option message
  ‚Üí <span class="kt">Prop</span></span></span></span><br><span><var>X</var><span><span class="hyp-body"><b>:= </b><span>composite_vlsm IM constraint</span></span><span class="hyp-type"><b>: </b><span>VLSM message</span></span></span></span><br><span><var>l</var><span class="hyp-type"><b>: </b><span>label</span></span></span><br><span><var>s</var><span class="hyp-type"><b>: </b><span>state</span></span></span><br><span><var>im</var><span class="hyp-type"><b>: </b><span>option message</span></span></span><br><span><var>s'</var><span class="hyp-type"><b>: </b><span>state</span></span></span><br><span><var>om</var><span class="hyp-type"><b>: </b><span>option message</span></span></span><br><span><var>Hproto_s</var><span class="hyp-type"><b>: </b><span>valid_state_prop
  (pre_loaded_with_all_messages_vlsm X) s</span></span></span><br><span><var>Hcvalid</var><span class="hyp-type"><b>: </b><span>valid l (s, im)</span></span></span><br><span><var>Htrans</var><span class="hyp-type"><b>: </b><span>transition l (s, im) = (s&#39;, om)</span></span></span><br></div><label class="goal-separator" for="Composition-v-chk147"><hr></label><div class="goal-conclusion">valid (projT2 l) (s (projT1 l), im)</div></blockquote></div></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="Composition-v-chk148" style="display: none" type="checkbox"><label class="alectryon-input" for="Composition-v-chk148">+</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>message, V</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>EqDecision0</var><span class="hyp-type"><b>: </b><span>EqDecision V</span></span></span><br><span><var>IM</var><span class="hyp-type"><b>: </b><span>V ‚Üí VLSM message</span></span></span><br><span><var>constraint</var><span class="hyp-type"><b>: </b><span>composite_label IM
‚Üí composite_state IM * option message
  ‚Üí <span class="kt">Prop</span></span></span></span><br><span><var>X</var><span><span class="hyp-body"><b>:= </b><span>composite_vlsm IM constraint</span></span><span class="hyp-type"><b>: </b><span>VLSM message</span></span></span></span><br><span><var>l</var><span class="hyp-type"><b>: </b><span>label</span></span></span><br><span><var>s</var><span class="hyp-type"><b>: </b><span>state</span></span></span><br><span><var>im</var><span class="hyp-type"><b>: </b><span>option message</span></span></span><br><span><var>s'</var><span class="hyp-type"><b>: </b><span>state</span></span></span><br><span><var>om</var><span class="hyp-type"><b>: </b><span>option message</span></span></span><br><span><var>Hproto_s</var><span class="hyp-type"><b>: </b><span>valid_state_prop
  (pre_loaded_with_all_messages_vlsm X) s</span></span></span><br><span><var>Hcvalid</var><span class="hyp-type"><b>: </b><span>valid l (s, im)</span></span></span><br><span><var>Htrans</var><span class="hyp-type"><b>: </b><span>transition l (s, im) = (s&#39;, om)</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">valid_state_prop
  (pre_loaded_with_all_messages_vlsm (IM (projT1 l)))
  (s (projT1 l))</div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="Composition-v-chk149" style="display: none" type="checkbox"><label class="alectryon-input" for="Composition-v-chk149"><span class="nb">revert</span> Hproto_s.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>message, V</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>EqDecision0</var><span class="hyp-type"><b>: </b><span>EqDecision V</span></span></span><br><span><var>IM</var><span class="hyp-type"><b>: </b><span>V ‚Üí VLSM message</span></span></span><br><span><var>constraint</var><span class="hyp-type"><b>: </b><span>composite_label IM
‚Üí composite_state IM * option message
  ‚Üí <span class="kt">Prop</span></span></span></span><br><span><var>X</var><span><span class="hyp-body"><b>:= </b><span>composite_vlsm IM constraint</span></span><span class="hyp-type"><b>: </b><span>VLSM message</span></span></span></span><br><span><var>l</var><span class="hyp-type"><b>: </b><span>label</span></span></span><br><span><var>s</var><span class="hyp-type"><b>: </b><span>state</span></span></span><br><span><var>im</var><span class="hyp-type"><b>: </b><span>option message</span></span></span><br><span><var>s'</var><span class="hyp-type"><b>: </b><span>state</span></span></span><br><span><var>om</var><span class="hyp-type"><b>: </b><span>option message</span></span></span><br><span><var>Hcvalid</var><span class="hyp-type"><b>: </b><span>valid l (s, im)</span></span></span><br><span><var>Htrans</var><span class="hyp-type"><b>: </b><span>transition l (s, im) = (s&#39;, om)</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">valid_state_prop (pre_loaded_with_all_messages_vlsm X)
  s
‚Üí valid_state_prop
    (pre_loaded_with_all_messages_vlsm (IM (projT1 l)))
    (s (projT1 l))</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">      </span><span class="alectryon-sentence"><span class="alectryon-input"><span class="nb">apply</span> valid_state_project_preloaded_to_preloaded.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="Composition-v-chk14a" style="display: none" type="checkbox"><label class="alectryon-input" for="Composition-v-chk14a">+</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>message, V</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>EqDecision0</var><span class="hyp-type"><b>: </b><span>EqDecision V</span></span></span><br><span><var>IM</var><span class="hyp-type"><b>: </b><span>V ‚Üí VLSM message</span></span></span><br><span><var>constraint</var><span class="hyp-type"><b>: </b><span>composite_label IM
‚Üí composite_state IM * option message
  ‚Üí <span class="kt">Prop</span></span></span></span><br><span><var>X</var><span><span class="hyp-body"><b>:= </b><span>composite_vlsm IM constraint</span></span><span class="hyp-type"><b>: </b><span>VLSM message</span></span></span></span><br><span><var>l</var><span class="hyp-type"><b>: </b><span>label</span></span></span><br><span><var>s</var><span class="hyp-type"><b>: </b><span>state</span></span></span><br><span><var>im</var><span class="hyp-type"><b>: </b><span>option message</span></span></span><br><span><var>s'</var><span class="hyp-type"><b>: </b><span>state</span></span></span><br><span><var>om</var><span class="hyp-type"><b>: </b><span>option message</span></span></span><br><span><var>Hproto_s</var><span class="hyp-type"><b>: </b><span>valid_state_prop
  (pre_loaded_with_all_messages_vlsm X) s</span></span></span><br><span><var>Hcvalid</var><span class="hyp-type"><b>: </b><span>valid l (s, im)</span></span></span><br><span><var>Htrans</var><span class="hyp-type"><b>: </b><span>transition l (s, im) = (s&#39;, om)</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">option_valid_message_prop
  (pre_loaded_with_all_messages_vlsm (IM (projT1 l)))
  im</div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="nb">apply</span> any_message_is_valid_in_preloaded.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="Composition-v-chk14b" style="display: none" type="checkbox"><label class="alectryon-input" for="Composition-v-chk14b">+</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>message, V</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>EqDecision0</var><span class="hyp-type"><b>: </b><span>EqDecision V</span></span></span><br><span><var>IM</var><span class="hyp-type"><b>: </b><span>V ‚Üí VLSM message</span></span></span><br><span><var>constraint</var><span class="hyp-type"><b>: </b><span>composite_label IM
‚Üí composite_state IM * option message
  ‚Üí <span class="kt">Prop</span></span></span></span><br><span><var>X</var><span><span class="hyp-body"><b>:= </b><span>composite_vlsm IM constraint</span></span><span class="hyp-type"><b>: </b><span>VLSM message</span></span></span></span><br><span><var>l</var><span class="hyp-type"><b>: </b><span>label</span></span></span><br><span><var>s</var><span class="hyp-type"><b>: </b><span>state</span></span></span><br><span><var>im</var><span class="hyp-type"><b>: </b><span>option message</span></span></span><br><span><var>s'</var><span class="hyp-type"><b>: </b><span>state</span></span></span><br><span><var>om</var><span class="hyp-type"><b>: </b><span>option message</span></span></span><br><span><var>Hproto_s</var><span class="hyp-type"><b>: </b><span>valid_state_prop
  (pre_loaded_with_all_messages_vlsm X) s</span></span></span><br><span><var>Hcvalid</var><span class="hyp-type"><b>: </b><span>valid l (s, im)</span></span></span><br><span><var>Htrans</var><span class="hyp-type"><b>: </b><span>transition l (s, im) = (s&#39;, om)</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">valid (projT2 l) (s (projT1 l), im)</div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="Composition-v-chk14c" style="display: none" type="checkbox"><label class="alectryon-input" for="Composition-v-chk14c"><span class="nb">destruct</span> l.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>message, V</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>EqDecision0</var><span class="hyp-type"><b>: </b><span>EqDecision V</span></span></span><br><span><var>IM</var><span class="hyp-type"><b>: </b><span>V ‚Üí VLSM message</span></span></span><br><span><var>constraint</var><span class="hyp-type"><b>: </b><span>composite_label IM
‚Üí composite_state IM * option message
  ‚Üí <span class="kt">Prop</span></span></span></span><br><span><var>X</var><span><span class="hyp-body"><b>:= </b><span>composite_vlsm IM constraint</span></span><span class="hyp-type"><b>: </b><span>VLSM message</span></span></span></span><br><span><var>x</var><span class="hyp-type"><b>: </b><span>V</span></span></span><br><span><var>v</var><span class="hyp-type"><b>: </b><span>vlabel (IM x)</span></span></span><br><span><var>s</var><span class="hyp-type"><b>: </b><span>state</span></span></span><br><span><var>im</var><span class="hyp-type"><b>: </b><span>option message</span></span></span><br><span><var>s'</var><span class="hyp-type"><b>: </b><span>state</span></span></span><br><span><var>om</var><span class="hyp-type"><b>: </b><span>option message</span></span></span><br><span><var>Hproto_s</var><span class="hyp-type"><b>: </b><span>valid_state_prop
  (pre_loaded_with_all_messages_vlsm X) s</span></span></span><br><span><var>Hcvalid</var><span class="hyp-type"><b>: </b><span>valid (existT x v) (s, im)</span></span></span><br><span><var>Htrans</var><span class="hyp-type"><b>: </b><span>transition (existT x v) (s, im) = (s&#39;, om)</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">valid (projT2 (existT x v))
  (s (projT1 (existT x v)), im)</div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="nb">apply</span> Hcvalid.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="Composition-v-chk14d" style="display: none" type="checkbox"><label class="alectryon-input" for="Composition-v-chk14d">-</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>message, V</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>EqDecision0</var><span class="hyp-type"><b>: </b><span>EqDecision V</span></span></span><br><span><var>IM</var><span class="hyp-type"><b>: </b><span>V ‚Üí VLSM message</span></span></span><br><span><var>constraint</var><span class="hyp-type"><b>: </b><span>composite_label IM
‚Üí composite_state IM * option message
  ‚Üí <span class="kt">Prop</span></span></span></span><br><span><var>X</var><span><span class="hyp-body"><b>:= </b><span>composite_vlsm IM constraint</span></span><span class="hyp-type"><b>: </b><span>VLSM message</span></span></span></span><br><span><var>l</var><span class="hyp-type"><b>: </b><span>label</span></span></span><br><span><var>s</var><span class="hyp-type"><b>: </b><span>state</span></span></span><br><span><var>im</var><span class="hyp-type"><b>: </b><span>option message</span></span></span><br><span><var>s'</var><span class="hyp-type"><b>: </b><span>state</span></span></span><br><span><var>om</var><span class="hyp-type"><b>: </b><span>option message</span></span></span><br><span><var>Hpvalid</var><span class="hyp-type"><b>: </b><span>input_valid
  (pre_loaded_with_all_messages_vlsm X) l
  (s, im)</span></span></span><br><span><var>Htrans</var><span class="hyp-type"><b>: </b><span>transition l (s, im) = (s&#39;, om)</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">transition (projT2 l) (s (projT1 l), im) =
(s&#39; (projT1 l), om)</div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="nb">revert</span> Htrans; rapply composite_transition_project_active.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Qed</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
</span><span class="alectryon-sentence"><input class="alectryon-toggle" id="Composition-v-chk14e" style="display: none" type="checkbox"><label class="alectryon-input" for="Composition-v-chk14e"><span class="kn">Lemma</span> <span class="nf">input_valid_transition_project_active</span>
      {<span class="nv">message</span>} `{EqDecision V} {IM: V -&gt; VLSM message} {constraint}
      (X := composite_vlsm IM constraint)
      l s im s&#39; om:
  input_valid_transition X l (s,im) (s&#39;,om) -&gt;
  input_valid_transition (pre_loaded_with_all_messages_vlsm (IM (projT1 l))) (projT2 l)
                         (s (projT1 l), im) (s&#39; (projT1 l), om).</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>message, V</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>EqDecision0</var><span class="hyp-type"><b>: </b><span>EqDecision V</span></span></span><br><span><var>IM</var><span class="hyp-type"><b>: </b><span>V ‚Üí VLSM message</span></span></span><br><span><var>constraint</var><span class="hyp-type"><b>: </b><span>composite_label IM
‚Üí composite_state IM * option message
  ‚Üí <span class="kt">Prop</span></span></span></span><br><span><var>X</var><span><span class="hyp-body"><b>:= </b><span>composite_vlsm IM constraint</span></span><span class="hyp-type"><b>: </b><span>VLSM message</span></span></span></span><br><span><var>l</var><span class="hyp-type"><b>: </b><span>label</span></span></span><br><span><var>s</var><span class="hyp-type"><b>: </b><span>state</span></span></span><br><span><var>im</var><span class="hyp-type"><b>: </b><span>option message</span></span></span><br><span><var>s'</var><span class="hyp-type"><b>: </b><span>state</span></span></span><br><span><var>om</var><span class="hyp-type"><b>: </b><span>option message</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">input_valid_transition X l (s, im) (s&#39;, om)
‚Üí input_valid_transition
    (pre_loaded_with_all_messages_vlsm (IM (projT1 l)))
    (projT2 l) (s (projT1 l), im) (s&#39; (projT1 l), om)</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="Composition-v-chk14f" style="display: none" type="checkbox"><label class="alectryon-input" for="Composition-v-chk14f"><span class="kn">Proof</span>.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>message, V</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>EqDecision0</var><span class="hyp-type"><b>: </b><span>EqDecision V</span></span></span><br><span><var>IM</var><span class="hyp-type"><b>: </b><span>V ‚Üí VLSM message</span></span></span><br><span><var>constraint</var><span class="hyp-type"><b>: </b><span>composite_label IM
‚Üí composite_state IM * option message
  ‚Üí <span class="kt">Prop</span></span></span></span><br><span><var>X</var><span><span class="hyp-body"><b>:= </b><span>composite_vlsm IM constraint</span></span><span class="hyp-type"><b>: </b><span>VLSM message</span></span></span></span><br><span><var>l</var><span class="hyp-type"><b>: </b><span>label</span></span></span><br><span><var>s</var><span class="hyp-type"><b>: </b><span>state</span></span></span><br><span><var>im</var><span class="hyp-type"><b>: </b><span>option message</span></span></span><br><span><var>s'</var><span class="hyp-type"><b>: </b><span>state</span></span></span><br><span><var>om</var><span class="hyp-type"><b>: </b><span>option message</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">input_valid_transition X l (s, im) (s&#39;, om)
‚Üí input_valid_transition
    (pre_loaded_with_all_messages_vlsm (IM (projT1 l)))
    (projT2 l) (s (projT1 l), im) (s&#39; (projT1 l), om)</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="Composition-v-chk150" style="display: none" type="checkbox"><label class="alectryon-input" for="Composition-v-chk150"><span class="nb">intro</span> Hptrans.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>message, V</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>EqDecision0</var><span class="hyp-type"><b>: </b><span>EqDecision V</span></span></span><br><span><var>IM</var><span class="hyp-type"><b>: </b><span>V ‚Üí VLSM message</span></span></span><br><span><var>constraint</var><span class="hyp-type"><b>: </b><span>composite_label IM
‚Üí composite_state IM * option message
  ‚Üí <span class="kt">Prop</span></span></span></span><br><span><var>X</var><span><span class="hyp-body"><b>:= </b><span>composite_vlsm IM constraint</span></span><span class="hyp-type"><b>: </b><span>VLSM message</span></span></span></span><br><span><var>l</var><span class="hyp-type"><b>: </b><span>label</span></span></span><br><span><var>s</var><span class="hyp-type"><b>: </b><span>state</span></span></span><br><span><var>im</var><span class="hyp-type"><b>: </b><span>option message</span></span></span><br><span><var>s'</var><span class="hyp-type"><b>: </b><span>state</span></span></span><br><span><var>om</var><span class="hyp-type"><b>: </b><span>option message</span></span></span><br><span><var>Hptrans</var><span class="hyp-type"><b>: </b><span>input_valid_transition X l (s, im) (s&#39;, om)</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">input_valid_transition
  (pre_loaded_with_all_messages_vlsm (IM (projT1 l)))
  (projT2 l) (s (projT1 l), im) (s&#39; (projT1 l), om)</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="Composition-v-chk151" style="display: none" type="checkbox"><label class="alectryon-input" for="Composition-v-chk151"><span class="nb">apply</span> preloaded_weaken_input_valid_transition <span class="kr">in</span> Hptrans.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>message, V</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>EqDecision0</var><span class="hyp-type"><b>: </b><span>EqDecision V</span></span></span><br><span><var>IM</var><span class="hyp-type"><b>: </b><span>V ‚Üí VLSM message</span></span></span><br><span><var>constraint</var><span class="hyp-type"><b>: </b><span>composite_label IM
‚Üí composite_state IM * option message
  ‚Üí <span class="kt">Prop</span></span></span></span><br><span><var>X</var><span><span class="hyp-body"><b>:= </b><span>composite_vlsm IM constraint</span></span><span class="hyp-type"><b>: </b><span>VLSM message</span></span></span></span><br><span><var>l</var><span class="hyp-type"><b>: </b><span>label</span></span></span><br><span><var>s</var><span class="hyp-type"><b>: </b><span>state</span></span></span><br><span><var>im</var><span class="hyp-type"><b>: </b><span>option message</span></span></span><br><span><var>s'</var><span class="hyp-type"><b>: </b><span>state</span></span></span><br><span><var>om</var><span class="hyp-type"><b>: </b><span>option message</span></span></span><br><span><var>Hptrans</var><span class="hyp-type"><b>: </b><span>input_valid_transition
  (pre_loaded_with_all_messages_vlsm X) l
  (s, im) (s&#39;, om)</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">input_valid_transition
  (pre_loaded_with_all_messages_vlsm (IM (projT1 l)))
  (projT2 l) (s (projT1 l), im) (s&#39; (projT1 l), om)</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="Composition-v-chk152" style="display: none" type="checkbox"><label class="alectryon-input" for="Composition-v-chk152"><span class="nb">revert</span> Hptrans.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>message, V</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>EqDecision0</var><span class="hyp-type"><b>: </b><span>EqDecision V</span></span></span><br><span><var>IM</var><span class="hyp-type"><b>: </b><span>V ‚Üí VLSM message</span></span></span><br><span><var>constraint</var><span class="hyp-type"><b>: </b><span>composite_label IM
‚Üí composite_state IM * option message
  ‚Üí <span class="kt">Prop</span></span></span></span><br><span><var>X</var><span><span class="hyp-body"><b>:= </b><span>composite_vlsm IM constraint</span></span><span class="hyp-type"><b>: </b><span>VLSM message</span></span></span></span><br><span><var>l</var><span class="hyp-type"><b>: </b><span>label</span></span></span><br><span><var>s</var><span class="hyp-type"><b>: </b><span>state</span></span></span><br><span><var>im</var><span class="hyp-type"><b>: </b><span>option message</span></span></span><br><span><var>s'</var><span class="hyp-type"><b>: </b><span>state</span></span></span><br><span><var>om</var><span class="hyp-type"><b>: </b><span>option message</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">input_valid_transition
  (pre_loaded_with_all_messages_vlsm X) l (s, im)
  (s&#39;, om)
‚Üí input_valid_transition
    (pre_loaded_with_all_messages_vlsm (IM (projT1 l)))
    (projT2 l) (s (projT1 l), im) (s&#39; (projT1 l), om)</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><span class="alectryon-input"><span class="nb">apply</span> input_valid_transition_preloaded_project_active.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Qed</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
</span><span class="alectryon-sentence"><input class="alectryon-toggle" id="Composition-v-chk153" style="display: none" type="checkbox"><label class="alectryon-input" for="Composition-v-chk153"><span class="kn">Lemma</span> <span class="nf">input_valid_transition_preloaded_project_any</span> {<span class="nv">V</span>} (<span class="nv">i</span>:V)
      {<span class="nv">message</span>} `{EqDecision V} {IM: V -&gt; VLSM message} {constraint}
      (X := composite_vlsm IM constraint)
      (l:vlabel X) s im s&#39; om:
  input_valid_transition (pre_loaded_with_all_messages_vlsm X) l (s,im) (s&#39;,om) -&gt;
  (s i = s&#39; i \/
   <span class="kr">exists</span> <span class="nv">li</span>, (l = existT i li) /\
   input_valid_transition (pre_loaded_with_all_messages_vlsm (IM i))
                          li
                          (s i,im) (s&#39; i,om)).</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>V</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>i</var><span class="hyp-type"><b>: </b><span>V</span></span></span><br><span><var>message</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>EqDecision0</var><span class="hyp-type"><b>: </b><span>EqDecision V</span></span></span><br><span><var>IM</var><span class="hyp-type"><b>: </b><span>V ‚Üí VLSM message</span></span></span><br><span><var>constraint</var><span class="hyp-type"><b>: </b><span>composite_label IM
‚Üí composite_state IM * option message
  ‚Üí <span class="kt">Prop</span></span></span></span><br><span><var>X</var><span><span class="hyp-body"><b>:= </b><span>composite_vlsm IM constraint</span></span><span class="hyp-type"><b>: </b><span>VLSM message</span></span></span></span><br><span><var>l</var><span class="hyp-type"><b>: </b><span>vlabel X</span></span></span><br><span><var>s</var><span class="hyp-type"><b>: </b><span>state</span></span></span><br><span><var>im</var><span class="hyp-type"><b>: </b><span>option message</span></span></span><br><span><var>s'</var><span class="hyp-type"><b>: </b><span>state</span></span></span><br><span><var>om</var><span class="hyp-type"><b>: </b><span>option message</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">input_valid_transition
  (pre_loaded_with_all_messages_vlsm X) l (s, im)
  (s&#39;, om)
‚Üí s i = s&#39; i
  ‚à® (<span class="kr">‚àÉ</span> <span class="nv">li</span> : (<span class="kr">Œª</span> <span class="nv">n</span> : V, vlabel (IM n)) i,
       l = existT i li
       ‚àß input_valid_transition
           (pre_loaded_with_all_messages_vlsm (IM i))
           li (s i, im) (s&#39; i, om))</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="Composition-v-chk154" style="display: none" type="checkbox"><label class="alectryon-input" for="Composition-v-chk154"><span class="kn">Proof</span>.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>V</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>i</var><span class="hyp-type"><b>: </b><span>V</span></span></span><br><span><var>message</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>EqDecision0</var><span class="hyp-type"><b>: </b><span>EqDecision V</span></span></span><br><span><var>IM</var><span class="hyp-type"><b>: </b><span>V ‚Üí VLSM message</span></span></span><br><span><var>constraint</var><span class="hyp-type"><b>: </b><span>composite_label IM
‚Üí composite_state IM * option message
  ‚Üí <span class="kt">Prop</span></span></span></span><br><span><var>X</var><span><span class="hyp-body"><b>:= </b><span>composite_vlsm IM constraint</span></span><span class="hyp-type"><b>: </b><span>VLSM message</span></span></span></span><br><span><var>l</var><span class="hyp-type"><b>: </b><span>vlabel X</span></span></span><br><span><var>s</var><span class="hyp-type"><b>: </b><span>state</span></span></span><br><span><var>im</var><span class="hyp-type"><b>: </b><span>option message</span></span></span><br><span><var>s'</var><span class="hyp-type"><b>: </b><span>state</span></span></span><br><span><var>om</var><span class="hyp-type"><b>: </b><span>option message</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">input_valid_transition
  (pre_loaded_with_all_messages_vlsm X) l (s, im)
  (s&#39;, om)
‚Üí s i = s&#39; i
  ‚à® (<span class="kr">‚àÉ</span> <span class="nv">li</span> : (<span class="kr">Œª</span> <span class="nv">n</span> : V, vlabel (IM n)) i,
       l = existT i li
       ‚àß input_valid_transition
           (pre_loaded_with_all_messages_vlsm (IM i))
           li (s i, im) (s&#39; i, om))</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="Composition-v-chk155" style="display: none" type="checkbox"><label class="alectryon-input" for="Composition-v-chk155"><span class="nb">intro</span> Hptrans.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>V</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>i</var><span class="hyp-type"><b>: </b><span>V</span></span></span><br><span><var>message</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>EqDecision0</var><span class="hyp-type"><b>: </b><span>EqDecision V</span></span></span><br><span><var>IM</var><span class="hyp-type"><b>: </b><span>V ‚Üí VLSM message</span></span></span><br><span><var>constraint</var><span class="hyp-type"><b>: </b><span>composite_label IM
‚Üí composite_state IM * option message
  ‚Üí <span class="kt">Prop</span></span></span></span><br><span><var>X</var><span><span class="hyp-body"><b>:= </b><span>composite_vlsm IM constraint</span></span><span class="hyp-type"><b>: </b><span>VLSM message</span></span></span></span><br><span><var>l</var><span class="hyp-type"><b>: </b><span>vlabel X</span></span></span><br><span><var>s</var><span class="hyp-type"><b>: </b><span>state</span></span></span><br><span><var>im</var><span class="hyp-type"><b>: </b><span>option message</span></span></span><br><span><var>s'</var><span class="hyp-type"><b>: </b><span>state</span></span></span><br><span><var>om</var><span class="hyp-type"><b>: </b><span>option message</span></span></span><br><span><var>Hptrans</var><span class="hyp-type"><b>: </b><span>input_valid_transition
  (pre_loaded_with_all_messages_vlsm X) l
  (s, im) (s&#39;, om)</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">s i = s&#39; i
‚à® (<span class="kr">‚àÉ</span> <span class="nv">li</span> : (<span class="kr">Œª</span> <span class="nv">n</span> : V, vlabel (IM n)) i,
     l = existT i li
     ‚àß input_valid_transition
         (pre_loaded_with_all_messages_vlsm (IM i)) li
         (s i, im) (s&#39; i, om))</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="Composition-v-chk156" style="display: none" type="checkbox"><label class="alectryon-input" for="Composition-v-chk156"><span class="nb">destruct</span> l <span class="kr">as</span> [j lj].</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>V</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>i</var><span class="hyp-type"><b>: </b><span>V</span></span></span><br><span><var>message</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>EqDecision0</var><span class="hyp-type"><b>: </b><span>EqDecision V</span></span></span><br><span><var>IM</var><span class="hyp-type"><b>: </b><span>V ‚Üí VLSM message</span></span></span><br><span><var>constraint</var><span class="hyp-type"><b>: </b><span>composite_label IM
‚Üí composite_state IM * option message
  ‚Üí <span class="kt">Prop</span></span></span></span><br><span><var>X</var><span><span class="hyp-body"><b>:= </b><span>composite_vlsm IM constraint</span></span><span class="hyp-type"><b>: </b><span>VLSM message</span></span></span></span><br><span><var>j</var><span class="hyp-type"><b>: </b><span>V</span></span></span><br><span><var>lj</var><span class="hyp-type"><b>: </b><span>vlabel (IM j)</span></span></span><br><span><var>s</var><span class="hyp-type"><b>: </b><span>state</span></span></span><br><span><var>im</var><span class="hyp-type"><b>: </b><span>option message</span></span></span><br><span><var>s'</var><span class="hyp-type"><b>: </b><span>state</span></span></span><br><span><var>om</var><span class="hyp-type"><b>: </b><span>option message</span></span></span><br><span><var>Hptrans</var><span class="hyp-type"><b>: </b><span>input_valid_transition
  (pre_loaded_with_all_messages_vlsm X)
  (existT j lj) (s, im) 
  (s&#39;, om)</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">s i = s&#39; i
‚à® (<span class="kr">‚àÉ</span> <span class="nv">li</span> : vlabel (IM i),
     existT j lj = existT i li
     ‚àß input_valid_transition
         (pre_loaded_with_all_messages_vlsm (IM i)) li
         (s i, im) (s&#39; i, om))</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="Composition-v-chk157" style="display: none" type="checkbox"><label class="alectryon-input" for="Composition-v-chk157"><span class="nb">destruct</span> (decide (i = j)).</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>V</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>i</var><span class="hyp-type"><b>: </b><span>V</span></span></span><br><span><var>message</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>EqDecision0</var><span class="hyp-type"><b>: </b><span>EqDecision V</span></span></span><br><span><var>IM</var><span class="hyp-type"><b>: </b><span>V ‚Üí VLSM message</span></span></span><br><span><var>constraint</var><span class="hyp-type"><b>: </b><span>composite_label IM
‚Üí composite_state IM * option message
  ‚Üí <span class="kt">Prop</span></span></span></span><br><span><var>X</var><span><span class="hyp-body"><b>:= </b><span>composite_vlsm IM constraint</span></span><span class="hyp-type"><b>: </b><span>VLSM message</span></span></span></span><br><span><var>j</var><span class="hyp-type"><b>: </b><span>V</span></span></span><br><span><var>lj</var><span class="hyp-type"><b>: </b><span>vlabel (IM j)</span></span></span><br><span><var>s</var><span class="hyp-type"><b>: </b><span>state</span></span></span><br><span><var>im</var><span class="hyp-type"><b>: </b><span>option message</span></span></span><br><span><var>s'</var><span class="hyp-type"><b>: </b><span>state</span></span></span><br><span><var>om</var><span class="hyp-type"><b>: </b><span>option message</span></span></span><br><span><var>Hptrans</var><span class="hyp-type"><b>: </b><span>input_valid_transition
  (pre_loaded_with_all_messages_vlsm X)
  (existT j lj) (s, im) 
  (s&#39;, om)</span></span></span><br><span><var>e</var><span class="hyp-type"><b>: </b><span>i = j</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">s i = s&#39; i
‚à® (<span class="kr">‚àÉ</span> <span class="nv">li</span> : vlabel (IM i),
     existT j lj = existT i li
     ‚àß input_valid_transition
         (pre_loaded_with_all_messages_vlsm (IM i)) li
         (s i, im) (s&#39; i, om))</div></blockquote><div class="alectryon-extra-goals"><input class="alectryon-extra-goal-toggle" id="Composition-v-chk158" style="display: none" type="checkbox"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>V</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>i</var><span class="hyp-type"><b>: </b><span>V</span></span></span><br><span><var>message</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>EqDecision0</var><span class="hyp-type"><b>: </b><span>EqDecision V</span></span></span><br><span><var>IM</var><span class="hyp-type"><b>: </b><span>V ‚Üí VLSM message</span></span></span><br><span><var>constraint</var><span class="hyp-type"><b>: </b><span>composite_label IM
‚Üí composite_state IM * option message
  ‚Üí <span class="kt">Prop</span></span></span></span><br><span><var>X</var><span><span class="hyp-body"><b>:= </b><span>composite_vlsm IM constraint</span></span><span class="hyp-type"><b>: </b><span>VLSM message</span></span></span></span><br><span><var>j</var><span class="hyp-type"><b>: </b><span>V</span></span></span><br><span><var>lj</var><span class="hyp-type"><b>: </b><span>vlabel (IM j)</span></span></span><br><span><var>s</var><span class="hyp-type"><b>: </b><span>state</span></span></span><br><span><var>im</var><span class="hyp-type"><b>: </b><span>option message</span></span></span><br><span><var>s'</var><span class="hyp-type"><b>: </b><span>state</span></span></span><br><span><var>om</var><span class="hyp-type"><b>: </b><span>option message</span></span></span><br><span><var>Hptrans</var><span class="hyp-type"><b>: </b><span>input_valid_transition
  (pre_loaded_with_all_messages_vlsm X)
  (existT j lj) (s, im) 
  (s&#39;, om)</span></span></span><br><span><var>n</var><span class="hyp-type"><b>: </b><span>i ‚â† j</span></span></span><br></div><label class="goal-separator" for="Composition-v-chk158"><hr></label><div class="goal-conclusion">s i = s&#39; i
‚à® (<span class="kr">‚àÉ</span> <span class="nv">li</span> : vlabel (IM i),
     existT j lj = existT i li
     ‚àß input_valid_transition
         (pre_loaded_with_all_messages_vlsm (IM i)) li
         (s i, im) (s&#39; i, om))</div></blockquote></div></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="Composition-v-chk159" style="display: none" type="checkbox"><label class="alectryon-input" for="Composition-v-chk159">-</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>V</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>i</var><span class="hyp-type"><b>: </b><span>V</span></span></span><br><span><var>message</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>EqDecision0</var><span class="hyp-type"><b>: </b><span>EqDecision V</span></span></span><br><span><var>IM</var><span class="hyp-type"><b>: </b><span>V ‚Üí VLSM message</span></span></span><br><span><var>constraint</var><span class="hyp-type"><b>: </b><span>composite_label IM
‚Üí composite_state IM * option message
  ‚Üí <span class="kt">Prop</span></span></span></span><br><span><var>X</var><span><span class="hyp-body"><b>:= </b><span>composite_vlsm IM constraint</span></span><span class="hyp-type"><b>: </b><span>VLSM message</span></span></span></span><br><span><var>j</var><span class="hyp-type"><b>: </b><span>V</span></span></span><br><span><var>lj</var><span class="hyp-type"><b>: </b><span>vlabel (IM j)</span></span></span><br><span><var>s</var><span class="hyp-type"><b>: </b><span>state</span></span></span><br><span><var>im</var><span class="hyp-type"><b>: </b><span>option message</span></span></span><br><span><var>s'</var><span class="hyp-type"><b>: </b><span>state</span></span></span><br><span><var>om</var><span class="hyp-type"><b>: </b><span>option message</span></span></span><br><span><var>Hptrans</var><span class="hyp-type"><b>: </b><span>input_valid_transition
  (pre_loaded_with_all_messages_vlsm X)
  (existT j lj) (s, im) 
  (s&#39;, om)</span></span></span><br><span><var>e</var><span class="hyp-type"><b>: </b><span>i = j</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">s i = s&#39; i
‚à® (<span class="kr">‚àÉ</span> <span class="nv">li</span> : vlabel (IM i),
     existT j lj = existT i li
     ‚àß input_valid_transition
         (pre_loaded_with_all_messages_vlsm (IM i)) li
         (s i, im) (s&#39; i, om))</div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="Composition-v-chk15a" style="display: none" type="checkbox"><label class="alectryon-input" for="Composition-v-chk15a"><span class="nb">subst</span> j.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>V</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>i</var><span class="hyp-type"><b>: </b><span>V</span></span></span><br><span><var>message</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>EqDecision0</var><span class="hyp-type"><b>: </b><span>EqDecision V</span></span></span><br><span><var>IM</var><span class="hyp-type"><b>: </b><span>V ‚Üí VLSM message</span></span></span><br><span><var>constraint</var><span class="hyp-type"><b>: </b><span>composite_label IM
‚Üí composite_state IM * option message
  ‚Üí <span class="kt">Prop</span></span></span></span><br><span><var>X</var><span><span class="hyp-body"><b>:= </b><span>composite_vlsm IM constraint</span></span><span class="hyp-type"><b>: </b><span>VLSM message</span></span></span></span><br><span><var>lj</var><span class="hyp-type"><b>: </b><span>vlabel (IM i)</span></span></span><br><span><var>s</var><span class="hyp-type"><b>: </b><span>state</span></span></span><br><span><var>im</var><span class="hyp-type"><b>: </b><span>option message</span></span></span><br><span><var>s'</var><span class="hyp-type"><b>: </b><span>state</span></span></span><br><span><var>om</var><span class="hyp-type"><b>: </b><span>option message</span></span></span><br><span><var>Hptrans</var><span class="hyp-type"><b>: </b><span>input_valid_transition
  (pre_loaded_with_all_messages_vlsm X)
  (existT i lj) (s, im) 
  (s&#39;, om)</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">s i = s&#39; i
‚à® (<span class="kr">‚àÉ</span> <span class="nv">li</span> : vlabel (IM i),
     existT i lj = existT i li
     ‚àß input_valid_transition
         (pre_loaded_with_all_messages_vlsm (IM i)) li
         (s i, im) (s&#39; i, om))</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="Composition-v-chk15b" style="display: none" type="checkbox"><label class="alectryon-input" for="Composition-v-chk15b"><span class="nb">right</span>.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>V</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>i</var><span class="hyp-type"><b>: </b><span>V</span></span></span><br><span><var>message</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>EqDecision0</var><span class="hyp-type"><b>: </b><span>EqDecision V</span></span></span><br><span><var>IM</var><span class="hyp-type"><b>: </b><span>V ‚Üí VLSM message</span></span></span><br><span><var>constraint</var><span class="hyp-type"><b>: </b><span>composite_label IM
‚Üí composite_state IM * option message
  ‚Üí <span class="kt">Prop</span></span></span></span><br><span><var>X</var><span><span class="hyp-body"><b>:= </b><span>composite_vlsm IM constraint</span></span><span class="hyp-type"><b>: </b><span>VLSM message</span></span></span></span><br><span><var>lj</var><span class="hyp-type"><b>: </b><span>vlabel (IM i)</span></span></span><br><span><var>s</var><span class="hyp-type"><b>: </b><span>state</span></span></span><br><span><var>im</var><span class="hyp-type"><b>: </b><span>option message</span></span></span><br><span><var>s'</var><span class="hyp-type"><b>: </b><span>state</span></span></span><br><span><var>om</var><span class="hyp-type"><b>: </b><span>option message</span></span></span><br><span><var>Hptrans</var><span class="hyp-type"><b>: </b><span>input_valid_transition
  (pre_loaded_with_all_messages_vlsm X)
  (existT i lj) (s, im) 
  (s&#39;, om)</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="kr">‚àÉ</span> <span class="nv">li</span> : vlabel (IM i),
  existT i lj = existT i li
  ‚àß input_valid_transition
      (pre_loaded_with_all_messages_vlsm (IM i)) li
      (s i, im) (s&#39; i, om)</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="Composition-v-chk15c" style="display: none" type="checkbox"><label class="alectryon-input" for="Composition-v-chk15c"><span class="kr">exists</span> <span class="nv">lj</span>.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>V</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>i</var><span class="hyp-type"><b>: </b><span>V</span></span></span><br><span><var>message</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>EqDecision0</var><span class="hyp-type"><b>: </b><span>EqDecision V</span></span></span><br><span><var>IM</var><span class="hyp-type"><b>: </b><span>V ‚Üí VLSM message</span></span></span><br><span><var>constraint</var><span class="hyp-type"><b>: </b><span>composite_label IM
‚Üí composite_state IM * option message
  ‚Üí <span class="kt">Prop</span></span></span></span><br><span><var>X</var><span><span class="hyp-body"><b>:= </b><span>composite_vlsm IM constraint</span></span><span class="hyp-type"><b>: </b><span>VLSM message</span></span></span></span><br><span><var>lj</var><span class="hyp-type"><b>: </b><span>vlabel (IM i)</span></span></span><br><span><var>s</var><span class="hyp-type"><b>: </b><span>state</span></span></span><br><span><var>im</var><span class="hyp-type"><b>: </b><span>option message</span></span></span><br><span><var>s'</var><span class="hyp-type"><b>: </b><span>state</span></span></span><br><span><var>om</var><span class="hyp-type"><b>: </b><span>option message</span></span></span><br><span><var>Hptrans</var><span class="hyp-type"><b>: </b><span>input_valid_transition
  (pre_loaded_with_all_messages_vlsm X)
  (existT i lj) (s, im) 
  (s&#39;, om)</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">existT i lj = existT i lj
‚àß input_valid_transition
    (pre_loaded_with_all_messages_vlsm (IM i)) lj
    (s i, im) (s&#39; i, om)</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="Composition-v-chk15d" style="display: none" type="checkbox"><label class="alectryon-input" for="Composition-v-chk15d"><span class="nb">split</span>; [<span class="bp">done</span> |].</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>V</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>i</var><span class="hyp-type"><b>: </b><span>V</span></span></span><br><span><var>message</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>EqDecision0</var><span class="hyp-type"><b>: </b><span>EqDecision V</span></span></span><br><span><var>IM</var><span class="hyp-type"><b>: </b><span>V ‚Üí VLSM message</span></span></span><br><span><var>constraint</var><span class="hyp-type"><b>: </b><span>composite_label IM
‚Üí composite_state IM * option message
  ‚Üí <span class="kt">Prop</span></span></span></span><br><span><var>X</var><span><span class="hyp-body"><b>:= </b><span>composite_vlsm IM constraint</span></span><span class="hyp-type"><b>: </b><span>VLSM message</span></span></span></span><br><span><var>lj</var><span class="hyp-type"><b>: </b><span>vlabel (IM i)</span></span></span><br><span><var>s</var><span class="hyp-type"><b>: </b><span>state</span></span></span><br><span><var>im</var><span class="hyp-type"><b>: </b><span>option message</span></span></span><br><span><var>s'</var><span class="hyp-type"><b>: </b><span>state</span></span></span><br><span><var>om</var><span class="hyp-type"><b>: </b><span>option message</span></span></span><br><span><var>Hptrans</var><span class="hyp-type"><b>: </b><span>input_valid_transition
  (pre_loaded_with_all_messages_vlsm X)
  (existT i lj) (s, im) 
  (s&#39;, om)</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">input_valid_transition
  (pre_loaded_with_all_messages_vlsm (IM i)) lj
  (s i, im) (s&#39; i, om)</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="Composition-v-chk15e" style="display: none" type="checkbox"><label class="alectryon-input" for="Composition-v-chk15e"><span class="nb">revert</span> Hptrans.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>V</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>i</var><span class="hyp-type"><b>: </b><span>V</span></span></span><br><span><var>message</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>EqDecision0</var><span class="hyp-type"><b>: </b><span>EqDecision V</span></span></span><br><span><var>IM</var><span class="hyp-type"><b>: </b><span>V ‚Üí VLSM message</span></span></span><br><span><var>constraint</var><span class="hyp-type"><b>: </b><span>composite_label IM
‚Üí composite_state IM * option message
  ‚Üí <span class="kt">Prop</span></span></span></span><br><span><var>X</var><span><span class="hyp-body"><b>:= </b><span>composite_vlsm IM constraint</span></span><span class="hyp-type"><b>: </b><span>VLSM message</span></span></span></span><br><span><var>lj</var><span class="hyp-type"><b>: </b><span>vlabel (IM i)</span></span></span><br><span><var>s</var><span class="hyp-type"><b>: </b><span>state</span></span></span><br><span><var>im</var><span class="hyp-type"><b>: </b><span>option message</span></span></span><br><span><var>s'</var><span class="hyp-type"><b>: </b><span>state</span></span></span><br><span><var>om</var><span class="hyp-type"><b>: </b><span>option message</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">input_valid_transition
  (pre_loaded_with_all_messages_vlsm X) (existT i lj)
  (s, im) (s&#39;, om)
‚Üí input_valid_transition
    (pre_loaded_with_all_messages_vlsm (IM i)) lj
    (s i, im) (s&#39; i, om)</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><span class="alectryon-input"><span class="nb">apply</span> input_valid_transition_preloaded_project_active.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="Composition-v-chk15f" style="display: none" type="checkbox"><label class="alectryon-input" for="Composition-v-chk15f">-</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>V</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>i</var><span class="hyp-type"><b>: </b><span>V</span></span></span><br><span><var>message</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>EqDecision0</var><span class="hyp-type"><b>: </b><span>EqDecision V</span></span></span><br><span><var>IM</var><span class="hyp-type"><b>: </b><span>V ‚Üí VLSM message</span></span></span><br><span><var>constraint</var><span class="hyp-type"><b>: </b><span>composite_label IM
‚Üí composite_state IM * option message
  ‚Üí <span class="kt">Prop</span></span></span></span><br><span><var>X</var><span><span class="hyp-body"><b>:= </b><span>composite_vlsm IM constraint</span></span><span class="hyp-type"><b>: </b><span>VLSM message</span></span></span></span><br><span><var>j</var><span class="hyp-type"><b>: </b><span>V</span></span></span><br><span><var>lj</var><span class="hyp-type"><b>: </b><span>vlabel (IM j)</span></span></span><br><span><var>s</var><span class="hyp-type"><b>: </b><span>state</span></span></span><br><span><var>im</var><span class="hyp-type"><b>: </b><span>option message</span></span></span><br><span><var>s'</var><span class="hyp-type"><b>: </b><span>state</span></span></span><br><span><var>om</var><span class="hyp-type"><b>: </b><span>option message</span></span></span><br><span><var>Hptrans</var><span class="hyp-type"><b>: </b><span>input_valid_transition
  (pre_loaded_with_all_messages_vlsm X)
  (existT j lj) (s, im) 
  (s&#39;, om)</span></span></span><br><span><var>n</var><span class="hyp-type"><b>: </b><span>i ‚â† j</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">s i = s&#39; i
‚à® (<span class="kr">‚àÉ</span> <span class="nv">li</span> : vlabel (IM i),
     existT j lj = existT i li
     ‚àß input_valid_transition
         (pre_loaded_with_all_messages_vlsm (IM i)) li
         (s i, im) (s&#39; i, om))</div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="Composition-v-chk160" style="display: none" type="checkbox"><label class="alectryon-input" for="Composition-v-chk160"><span class="nb">left</span>.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>V</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>i</var><span class="hyp-type"><b>: </b><span>V</span></span></span><br><span><var>message</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>EqDecision0</var><span class="hyp-type"><b>: </b><span>EqDecision V</span></span></span><br><span><var>IM</var><span class="hyp-type"><b>: </b><span>V ‚Üí VLSM message</span></span></span><br><span><var>constraint</var><span class="hyp-type"><b>: </b><span>composite_label IM
‚Üí composite_state IM * option message
  ‚Üí <span class="kt">Prop</span></span></span></span><br><span><var>X</var><span><span class="hyp-body"><b>:= </b><span>composite_vlsm IM constraint</span></span><span class="hyp-type"><b>: </b><span>VLSM message</span></span></span></span><br><span><var>j</var><span class="hyp-type"><b>: </b><span>V</span></span></span><br><span><var>lj</var><span class="hyp-type"><b>: </b><span>vlabel (IM j)</span></span></span><br><span><var>s</var><span class="hyp-type"><b>: </b><span>state</span></span></span><br><span><var>im</var><span class="hyp-type"><b>: </b><span>option message</span></span></span><br><span><var>s'</var><span class="hyp-type"><b>: </b><span>state</span></span></span><br><span><var>om</var><span class="hyp-type"><b>: </b><span>option message</span></span></span><br><span><var>Hptrans</var><span class="hyp-type"><b>: </b><span>input_valid_transition
  (pre_loaded_with_all_messages_vlsm X)
  (existT j lj) (s, im) 
  (s&#39;, om)</span></span></span><br><span><var>n</var><span class="hyp-type"><b>: </b><span>i ‚â† j</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">s i = s&#39; i</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="Composition-v-chk161" style="display: none" type="checkbox"><label class="alectryon-input" for="Composition-v-chk161"><span class="nb">destruct</span> Hptrans <span class="kr">as</span> [Hpvalid Htrans].</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>V</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>i</var><span class="hyp-type"><b>: </b><span>V</span></span></span><br><span><var>message</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>EqDecision0</var><span class="hyp-type"><b>: </b><span>EqDecision V</span></span></span><br><span><var>IM</var><span class="hyp-type"><b>: </b><span>V ‚Üí VLSM message</span></span></span><br><span><var>constraint</var><span class="hyp-type"><b>: </b><span>composite_label IM
‚Üí composite_state IM * option message
  ‚Üí <span class="kt">Prop</span></span></span></span><br><span><var>X</var><span><span class="hyp-body"><b>:= </b><span>composite_vlsm IM constraint</span></span><span class="hyp-type"><b>: </b><span>VLSM message</span></span></span></span><br><span><var>j</var><span class="hyp-type"><b>: </b><span>V</span></span></span><br><span><var>lj</var><span class="hyp-type"><b>: </b><span>vlabel (IM j)</span></span></span><br><span><var>s</var><span class="hyp-type"><b>: </b><span>state</span></span></span><br><span><var>im</var><span class="hyp-type"><b>: </b><span>option message</span></span></span><br><span><var>s'</var><span class="hyp-type"><b>: </b><span>state</span></span></span><br><span><var>om</var><span class="hyp-type"><b>: </b><span>option message</span></span></span><br><span><var>Hpvalid</var><span class="hyp-type"><b>: </b><span>input_valid
  (pre_loaded_with_all_messages_vlsm X)
  (existT j lj) (s, im)</span></span></span><br><span><var>Htrans</var><span class="hyp-type"><b>: </b><span>transition (existT j lj) (s, im) = (s&#39;, om)</span></span></span><br><span><var>n</var><span class="hyp-type"><b>: </b><span>i ‚â† j</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">s i = s&#39; i</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="Composition-v-chk162" style="display: none" type="checkbox"><label class="alectryon-input" for="Composition-v-chk162"><span class="nb">cbn</span> <span class="kr">in</span> Htrans.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>V</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>i</var><span class="hyp-type"><b>: </b><span>V</span></span></span><br><span><var>message</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>EqDecision0</var><span class="hyp-type"><b>: </b><span>EqDecision V</span></span></span><br><span><var>IM</var><span class="hyp-type"><b>: </b><span>V ‚Üí VLSM message</span></span></span><br><span><var>constraint</var><span class="hyp-type"><b>: </b><span>composite_label IM
‚Üí composite_state IM * option message
  ‚Üí <span class="kt">Prop</span></span></span></span><br><span><var>X</var><span><span class="hyp-body"><b>:= </b><span>composite_vlsm IM constraint</span></span><span class="hyp-type"><b>: </b><span>VLSM message</span></span></span></span><br><span><var>j</var><span class="hyp-type"><b>: </b><span>V</span></span></span><br><span><var>lj</var><span class="hyp-type"><b>: </b><span>vlabel (IM j)</span></span></span><br><span><var>s</var><span class="hyp-type"><b>: </b><span>state</span></span></span><br><span><var>im</var><span class="hyp-type"><b>: </b><span>option message</span></span></span><br><span><var>s'</var><span class="hyp-type"><b>: </b><span>state</span></span></span><br><span><var>om</var><span class="hyp-type"><b>: </b><span>option message</span></span></span><br><span><var>Hpvalid</var><span class="hyp-type"><b>: </b><span>input_valid
  (pre_loaded_with_all_messages_vlsm X)
  (existT j lj) (s, im)</span></span></span><br><span><var>Htrans</var><span class="hyp-type"><b>: </b><span>(<span class="kr">let</span> (<span class="nv">si&#39;</span>, om&#39;) :=
   vtransition (IM j) lj (s j, im) <span class="kr">in</span>
 (state_update IM s j si&#39;, om&#39;)) = 
(s&#39;, om)</span></span></span><br><span><var>n</var><span class="hyp-type"><b>: </b><span>i ‚â† j</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">s i = s&#39; i</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="Composition-v-chk163" style="display: none" type="checkbox"><label class="alectryon-input" for="Composition-v-chk163"><span class="nb">destruct</span> (vtransition (IM j) lj (s j, im)).</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>V</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>i</var><span class="hyp-type"><b>: </b><span>V</span></span></span><br><span><var>message</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>EqDecision0</var><span class="hyp-type"><b>: </b><span>EqDecision V</span></span></span><br><span><var>IM</var><span class="hyp-type"><b>: </b><span>V ‚Üí VLSM message</span></span></span><br><span><var>constraint</var><span class="hyp-type"><b>: </b><span>composite_label IM
‚Üí composite_state IM * option message
  ‚Üí <span class="kt">Prop</span></span></span></span><br><span><var>X</var><span><span class="hyp-body"><b>:= </b><span>composite_vlsm IM constraint</span></span><span class="hyp-type"><b>: </b><span>VLSM message</span></span></span></span><br><span><var>j</var><span class="hyp-type"><b>: </b><span>V</span></span></span><br><span><var>lj</var><span class="hyp-type"><b>: </b><span>vlabel (IM j)</span></span></span><br><span><var>s</var><span class="hyp-type"><b>: </b><span>state</span></span></span><br><span><var>im</var><span class="hyp-type"><b>: </b><span>option message</span></span></span><br><span><var>s'</var><span class="hyp-type"><b>: </b><span>state</span></span></span><br><span><var>om</var><span class="hyp-type"><b>: </b><span>option message</span></span></span><br><span><var>Hpvalid</var><span class="hyp-type"><b>: </b><span>input_valid
  (pre_loaded_with_all_messages_vlsm X)
  (existT j lj) (s, im)</span></span></span><br><span><var>s0</var><span class="hyp-type"><b>: </b><span>state</span></span></span><br><span><var>o</var><span class="hyp-type"><b>: </b><span>option message</span></span></span><br><span><var>Htrans</var><span class="hyp-type"><b>: </b><span>(state_update IM s j s0, o) = (s&#39;, om)</span></span></span><br><span><var>n</var><span class="hyp-type"><b>: </b><span>i ‚â† j</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">s i = s&#39; i</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="Composition-v-chk164" style="display: none" type="checkbox"><label class="alectryon-input" for="Composition-v-chk164"><span class="nb">inversion_clear</span> Htrans.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>V</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>i</var><span class="hyp-type"><b>: </b><span>V</span></span></span><br><span><var>message</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>EqDecision0</var><span class="hyp-type"><b>: </b><span>EqDecision V</span></span></span><br><span><var>IM</var><span class="hyp-type"><b>: </b><span>V ‚Üí VLSM message</span></span></span><br><span><var>constraint</var><span class="hyp-type"><b>: </b><span>composite_label IM
‚Üí composite_state IM * option message
  ‚Üí <span class="kt">Prop</span></span></span></span><br><span><var>X</var><span><span class="hyp-body"><b>:= </b><span>composite_vlsm IM constraint</span></span><span class="hyp-type"><b>: </b><span>VLSM message</span></span></span></span><br><span><var>j</var><span class="hyp-type"><b>: </b><span>V</span></span></span><br><span><var>lj</var><span class="hyp-type"><b>: </b><span>vlabel (IM j)</span></span></span><br><span><var>s</var><span class="hyp-type"><b>: </b><span>state</span></span></span><br><span><var>im</var><span class="hyp-type"><b>: </b><span>option message</span></span></span><br><span><var>s'</var><span class="hyp-type"><b>: </b><span>state</span></span></span><br><span><var>om</var><span class="hyp-type"><b>: </b><span>option message</span></span></span><br><span><var>Hpvalid</var><span class="hyp-type"><b>: </b><span>input_valid
  (pre_loaded_with_all_messages_vlsm X)
  (existT j lj) (s, im)</span></span></span><br><span><var>s0</var><span class="hyp-type"><b>: </b><span>state</span></span></span><br><span><var>o</var><span class="hyp-type"><b>: </b><span>option message</span></span></span><br><span><var>n</var><span class="hyp-type"><b>: </b><span>i ‚â† j</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">s i = state_update IM s j s0 i</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><span class="alectryon-input"><span class="bp">by</span> state_update_simpl.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Qed</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
</span><span class="alectryon-sentence"><input class="alectryon-toggle" id="Composition-v-chk165" style="display: none" type="checkbox"><label class="alectryon-input" for="Composition-v-chk165"><span class="kn">Lemma</span> <span class="nf">input_valid_transition_project_any</span> {<span class="nv">V</span>} (<span class="nv">i</span>:V)
      {<span class="nv">message</span>} `{EqDecision V} {IM: V -&gt; VLSM message} {constraint}
      (X := composite_vlsm IM constraint)
      (l:vlabel X) s im s&#39; om:
  input_valid_transition X l (s,im) (s&#39;,om) -&gt;
  (s i = s&#39; i \/
   <span class="kr">exists</span> <span class="nv">li</span>, (l = existT i li) /\
   input_valid_transition (pre_loaded_with_all_messages_vlsm (IM i))
                          li
                          (s i,im) (s&#39; i,om)).</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>V</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>i</var><span class="hyp-type"><b>: </b><span>V</span></span></span><br><span><var>message</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>EqDecision0</var><span class="hyp-type"><b>: </b><span>EqDecision V</span></span></span><br><span><var>IM</var><span class="hyp-type"><b>: </b><span>V ‚Üí VLSM message</span></span></span><br><span><var>constraint</var><span class="hyp-type"><b>: </b><span>composite_label IM
‚Üí composite_state IM * option message
  ‚Üí <span class="kt">Prop</span></span></span></span><br><span><var>X</var><span><span class="hyp-body"><b>:= </b><span>composite_vlsm IM constraint</span></span><span class="hyp-type"><b>: </b><span>VLSM message</span></span></span></span><br><span><var>l</var><span class="hyp-type"><b>: </b><span>vlabel X</span></span></span><br><span><var>s</var><span class="hyp-type"><b>: </b><span>state</span></span></span><br><span><var>im</var><span class="hyp-type"><b>: </b><span>option message</span></span></span><br><span><var>s'</var><span class="hyp-type"><b>: </b><span>state</span></span></span><br><span><var>om</var><span class="hyp-type"><b>: </b><span>option message</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">input_valid_transition X l (s, im) (s&#39;, om)
‚Üí s i = s&#39; i
  ‚à® (<span class="kr">‚àÉ</span> <span class="nv">li</span> : (<span class="kr">Œª</span> <span class="nv">n</span> : V, vlabel (IM n)) i,
       l = existT i li
       ‚àß input_valid_transition
           (pre_loaded_with_all_messages_vlsm (IM i))
           li (s i, im) (s&#39; i, om))</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="Composition-v-chk166" style="display: none" type="checkbox"><label class="alectryon-input" for="Composition-v-chk166"><span class="kn">Proof</span>.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>V</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>i</var><span class="hyp-type"><b>: </b><span>V</span></span></span><br><span><var>message</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>EqDecision0</var><span class="hyp-type"><b>: </b><span>EqDecision V</span></span></span><br><span><var>IM</var><span class="hyp-type"><b>: </b><span>V ‚Üí VLSM message</span></span></span><br><span><var>constraint</var><span class="hyp-type"><b>: </b><span>composite_label IM
‚Üí composite_state IM * option message
  ‚Üí <span class="kt">Prop</span></span></span></span><br><span><var>X</var><span><span class="hyp-body"><b>:= </b><span>composite_vlsm IM constraint</span></span><span class="hyp-type"><b>: </b><span>VLSM message</span></span></span></span><br><span><var>l</var><span class="hyp-type"><b>: </b><span>vlabel X</span></span></span><br><span><var>s</var><span class="hyp-type"><b>: </b><span>state</span></span></span><br><span><var>im</var><span class="hyp-type"><b>: </b><span>option message</span></span></span><br><span><var>s'</var><span class="hyp-type"><b>: </b><span>state</span></span></span><br><span><var>om</var><span class="hyp-type"><b>: </b><span>option message</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">input_valid_transition X l (s, im) (s&#39;, om)
‚Üí s i = s&#39; i
  ‚à® (<span class="kr">‚àÉ</span> <span class="nv">li</span> : (<span class="kr">Œª</span> <span class="nv">n</span> : V, vlabel (IM n)) i,
       l = existT i li
       ‚àß input_valid_transition
           (pre_loaded_with_all_messages_vlsm (IM i))
           li (s i, im) (s&#39; i, om))</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="Composition-v-chk167" style="display: none" type="checkbox"><label class="alectryon-input" for="Composition-v-chk167"><span class="nb">intro</span> Hproto.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>V</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>i</var><span class="hyp-type"><b>: </b><span>V</span></span></span><br><span><var>message</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>EqDecision0</var><span class="hyp-type"><b>: </b><span>EqDecision V</span></span></span><br><span><var>IM</var><span class="hyp-type"><b>: </b><span>V ‚Üí VLSM message</span></span></span><br><span><var>constraint</var><span class="hyp-type"><b>: </b><span>composite_label IM
‚Üí composite_state IM * option message
  ‚Üí <span class="kt">Prop</span></span></span></span><br><span><var>X</var><span><span class="hyp-body"><b>:= </b><span>composite_vlsm IM constraint</span></span><span class="hyp-type"><b>: </b><span>VLSM message</span></span></span></span><br><span><var>l</var><span class="hyp-type"><b>: </b><span>vlabel X</span></span></span><br><span><var>s</var><span class="hyp-type"><b>: </b><span>state</span></span></span><br><span><var>im</var><span class="hyp-type"><b>: </b><span>option message</span></span></span><br><span><var>s'</var><span class="hyp-type"><b>: </b><span>state</span></span></span><br><span><var>om</var><span class="hyp-type"><b>: </b><span>option message</span></span></span><br><span><var>Hproto</var><span class="hyp-type"><b>: </b><span>input_valid_transition X l (s, im) (s&#39;, om)</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">s i = s&#39; i
‚à® (<span class="kr">‚àÉ</span> <span class="nv">li</span> : (<span class="kr">Œª</span> <span class="nv">n</span> : V, vlabel (IM n)) i,
     l = existT i li
     ‚àß input_valid_transition
         (pre_loaded_with_all_messages_vlsm (IM i)) li
         (s i, im) (s&#39; i, om))</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="Composition-v-chk168" style="display: none" type="checkbox"><label class="alectryon-input" for="Composition-v-chk168"><span class="nb">apply</span> preloaded_weaken_input_valid_transition <span class="kr">in</span> Hproto.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>V</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>i</var><span class="hyp-type"><b>: </b><span>V</span></span></span><br><span><var>message</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>EqDecision0</var><span class="hyp-type"><b>: </b><span>EqDecision V</span></span></span><br><span><var>IM</var><span class="hyp-type"><b>: </b><span>V ‚Üí VLSM message</span></span></span><br><span><var>constraint</var><span class="hyp-type"><b>: </b><span>composite_label IM
‚Üí composite_state IM * option message
  ‚Üí <span class="kt">Prop</span></span></span></span><br><span><var>X</var><span><span class="hyp-body"><b>:= </b><span>composite_vlsm IM constraint</span></span><span class="hyp-type"><b>: </b><span>VLSM message</span></span></span></span><br><span><var>l</var><span class="hyp-type"><b>: </b><span>vlabel X</span></span></span><br><span><var>s</var><span class="hyp-type"><b>: </b><span>state</span></span></span><br><span><var>im</var><span class="hyp-type"><b>: </b><span>option message</span></span></span><br><span><var>s'</var><span class="hyp-type"><b>: </b><span>state</span></span></span><br><span><var>om</var><span class="hyp-type"><b>: </b><span>option message</span></span></span><br><span><var>Hproto</var><span class="hyp-type"><b>: </b><span>input_valid_transition
  (pre_loaded_with_all_messages_vlsm X) l
  (s, im) (s&#39;, om)</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">s i = s&#39; i
‚à® (<span class="kr">‚àÉ</span> <span class="nv">li</span> : (<span class="kr">Œª</span> <span class="nv">n</span> : V, vlabel (IM n)) i,
     l = existT i li
     ‚àß input_valid_transition
         (pre_loaded_with_all_messages_vlsm (IM i)) li
         (s i, im) (s&#39; i, om))</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="Composition-v-chk169" style="display: none" type="checkbox"><label class="alectryon-input" for="Composition-v-chk169"><span class="nb">revert</span> Hproto.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>V</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>i</var><span class="hyp-type"><b>: </b><span>V</span></span></span><br><span><var>message</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>EqDecision0</var><span class="hyp-type"><b>: </b><span>EqDecision V</span></span></span><br><span><var>IM</var><span class="hyp-type"><b>: </b><span>V ‚Üí VLSM message</span></span></span><br><span><var>constraint</var><span class="hyp-type"><b>: </b><span>composite_label IM
‚Üí composite_state IM * option message
  ‚Üí <span class="kt">Prop</span></span></span></span><br><span><var>X</var><span><span class="hyp-body"><b>:= </b><span>composite_vlsm IM constraint</span></span><span class="hyp-type"><b>: </b><span>VLSM message</span></span></span></span><br><span><var>l</var><span class="hyp-type"><b>: </b><span>vlabel X</span></span></span><br><span><var>s</var><span class="hyp-type"><b>: </b><span>state</span></span></span><br><span><var>im</var><span class="hyp-type"><b>: </b><span>option message</span></span></span><br><span><var>s'</var><span class="hyp-type"><b>: </b><span>state</span></span></span><br><span><var>om</var><span class="hyp-type"><b>: </b><span>option message</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">input_valid_transition
  (pre_loaded_with_all_messages_vlsm X) l (s, im)
  (s&#39;, om)
‚Üí s i = s&#39; i
  ‚à® (<span class="kr">‚àÉ</span> <span class="nv">li</span> : (<span class="kr">Œª</span> <span class="nv">n</span> : V, vlabel (IM n)) i,
       l = existT i li
       ‚àß input_valid_transition
           (pre_loaded_with_all_messages_vlsm (IM i))
           li (s i, im) (s&#39; i, om))</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><span class="alectryon-input"><span class="nb">apply</span> input_valid_transition_preloaded_project_any.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Qed</span>.</span></span></pre><div class="doc">
  If a message can be emitted by a composition, then it can be emitted by one of the
  components.

</div><pre class="alectryon-io highlight"><!-- Generator: Alectryon --><span class="alectryon-sentence"><input class="alectryon-toggle" id="Composition-v-chk16a" style="display: none" type="checkbox"><label class="alectryon-input" for="Composition-v-chk16a"><span class="kn">Lemma</span> <span class="nf">can_emit_composite_project</span>
  {<span class="nv">message</span>} `{EqDecision V} {IM: V -&gt; VLSM message} {constraint}
  (X := composite_vlsm IM constraint)
  (m : message)
  (Hemit: can_emit (pre_loaded_with_all_messages_vlsm X) m)
  : <span class="kr">exists</span> (<span class="nv">j</span> : V), can_emit (pre_loaded_with_all_messages_vlsm (IM j)) m.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>message, V</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>EqDecision0</var><span class="hyp-type"><b>: </b><span>EqDecision V</span></span></span><br><span><var>IM</var><span class="hyp-type"><b>: </b><span>V ‚Üí VLSM message</span></span></span><br><span><var>constraint</var><span class="hyp-type"><b>: </b><span>composite_label IM
‚Üí composite_state IM * option message
  ‚Üí <span class="kt">Prop</span></span></span></span><br><span><var>X</var><span><span class="hyp-body"><b>:= </b><span>composite_vlsm IM constraint</span></span><span class="hyp-type"><b>: </b><span>VLSM message</span></span></span></span><br><span><var>m</var><span class="hyp-type"><b>: </b><span>message</span></span></span><br><span><var>Hemit</var><span class="hyp-type"><b>: </b><span>can_emit (pre_loaded_with_all_messages_vlsm X)
  m</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="kr">‚àÉ</span> <span class="nv">j</span> : V,
  can_emit (pre_loaded_with_all_messages_vlsm (IM j))
    m</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="Composition-v-chk16b" style="display: none" type="checkbox"><label class="alectryon-input" for="Composition-v-chk16b"><span class="kn">Proof</span>.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>message, V</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>EqDecision0</var><span class="hyp-type"><b>: </b><span>EqDecision V</span></span></span><br><span><var>IM</var><span class="hyp-type"><b>: </b><span>V ‚Üí VLSM message</span></span></span><br><span><var>constraint</var><span class="hyp-type"><b>: </b><span>composite_label IM
‚Üí composite_state IM * option message
  ‚Üí <span class="kt">Prop</span></span></span></span><br><span><var>X</var><span><span class="hyp-body"><b>:= </b><span>composite_vlsm IM constraint</span></span><span class="hyp-type"><b>: </b><span>VLSM message</span></span></span></span><br><span><var>m</var><span class="hyp-type"><b>: </b><span>message</span></span></span><br><span><var>Hemit</var><span class="hyp-type"><b>: </b><span>can_emit (pre_loaded_with_all_messages_vlsm X)
  m</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="kr">‚àÉ</span> <span class="nv">j</span> : V,
  can_emit (pre_loaded_with_all_messages_vlsm (IM j))
    m</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="Composition-v-chk16c" style="display: none" type="checkbox"><label class="alectryon-input" for="Composition-v-chk16c"><span class="nb">apply</span> can_emit_iff <span class="kr">in</span> Hemit.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>message, V</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>EqDecision0</var><span class="hyp-type"><b>: </b><span>EqDecision V</span></span></span><br><span><var>IM</var><span class="hyp-type"><b>: </b><span>V ‚Üí VLSM message</span></span></span><br><span><var>constraint</var><span class="hyp-type"><b>: </b><span>composite_label IM
‚Üí composite_state IM * option message
  ‚Üí <span class="kt">Prop</span></span></span></span><br><span><var>X</var><span><span class="hyp-body"><b>:= </b><span>composite_vlsm IM constraint</span></span><span class="hyp-type"><b>: </b><span>VLSM message</span></span></span></span><br><span><var>m</var><span class="hyp-type"><b>: </b><span>message</span></span></span><br><span><var>Hemit</var><span class="hyp-type"><b>: </b><span><span class="kr">‚àÉ</span> <span class="nv">s</span> : state,
  can_produce
    (pre_loaded_with_all_messages_vlsm X) s m</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="kr">‚àÉ</span> <span class="nv">j</span> : V,
  can_emit (pre_loaded_with_all_messages_vlsm (IM j))
    m</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="Composition-v-chk16d" style="display: none" type="checkbox"><label class="alectryon-input" for="Composition-v-chk16d"><span class="nb">destruct</span> Hemit <span class="kr">as</span> [s2 [(s1, oim) [l Ht]]].</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>message, V</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>EqDecision0</var><span class="hyp-type"><b>: </b><span>EqDecision V</span></span></span><br><span><var>IM</var><span class="hyp-type"><b>: </b><span>V ‚Üí VLSM message</span></span></span><br><span><var>constraint</var><span class="hyp-type"><b>: </b><span>composite_label IM
‚Üí composite_state IM * option message
  ‚Üí <span class="kt">Prop</span></span></span></span><br><span><var>X</var><span><span class="hyp-body"><b>:= </b><span>composite_vlsm IM constraint</span></span><span class="hyp-type"><b>: </b><span>VLSM message</span></span></span></span><br><span><var>m</var><span class="hyp-type"><b>: </b><span>message</span></span></span><br><span><var>s2, s1</var><span class="hyp-type"><b>: </b><span>state</span></span></span><br><span><var>oim</var><span class="hyp-type"><b>: </b><span>option message</span></span></span><br><span><var>l</var><span class="hyp-type"><b>: </b><span>label</span></span></span><br><span><var>Ht</var><span class="hyp-type"><b>: </b><span>input_valid_transition
  (pre_loaded_with_all_messages_vlsm X) l
  (s1, oim) (s2, Some m)</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="kr">‚àÉ</span> <span class="nv">j</span> : V,
  can_emit (pre_loaded_with_all_messages_vlsm (IM j))
    m</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="Composition-v-chk16e" style="display: none" type="checkbox"><label class="alectryon-input" for="Composition-v-chk16e"><span class="kr">exists</span> (<span class="nv">projT1</span> <span class="nv">l</span>).</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>message, V</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>EqDecision0</var><span class="hyp-type"><b>: </b><span>EqDecision V</span></span></span><br><span><var>IM</var><span class="hyp-type"><b>: </b><span>V ‚Üí VLSM message</span></span></span><br><span><var>constraint</var><span class="hyp-type"><b>: </b><span>composite_label IM
‚Üí composite_state IM * option message
  ‚Üí <span class="kt">Prop</span></span></span></span><br><span><var>X</var><span><span class="hyp-body"><b>:= </b><span>composite_vlsm IM constraint</span></span><span class="hyp-type"><b>: </b><span>VLSM message</span></span></span></span><br><span><var>m</var><span class="hyp-type"><b>: </b><span>message</span></span></span><br><span><var>s2, s1</var><span class="hyp-type"><b>: </b><span>state</span></span></span><br><span><var>oim</var><span class="hyp-type"><b>: </b><span>option message</span></span></span><br><span><var>l</var><span class="hyp-type"><b>: </b><span>label</span></span></span><br><span><var>Ht</var><span class="hyp-type"><b>: </b><span>input_valid_transition
  (pre_loaded_with_all_messages_vlsm X) l
  (s1, oim) (s2, Some m)</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">can_emit
  (pre_loaded_with_all_messages_vlsm (IM (projT1 l)))
  m</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="Composition-v-chk16f" style="display: none" type="checkbox"><label class="alectryon-input" for="Composition-v-chk16f"><span class="nb">apply</span> can_emit_iff.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>message, V</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>EqDecision0</var><span class="hyp-type"><b>: </b><span>EqDecision V</span></span></span><br><span><var>IM</var><span class="hyp-type"><b>: </b><span>V ‚Üí VLSM message</span></span></span><br><span><var>constraint</var><span class="hyp-type"><b>: </b><span>composite_label IM
‚Üí composite_state IM * option message
  ‚Üí <span class="kt">Prop</span></span></span></span><br><span><var>X</var><span><span class="hyp-body"><b>:= </b><span>composite_vlsm IM constraint</span></span><span class="hyp-type"><b>: </b><span>VLSM message</span></span></span></span><br><span><var>m</var><span class="hyp-type"><b>: </b><span>message</span></span></span><br><span><var>s2, s1</var><span class="hyp-type"><b>: </b><span>state</span></span></span><br><span><var>oim</var><span class="hyp-type"><b>: </b><span>option message</span></span></span><br><span><var>l</var><span class="hyp-type"><b>: </b><span>label</span></span></span><br><span><var>Ht</var><span class="hyp-type"><b>: </b><span>input_valid_transition
  (pre_loaded_with_all_messages_vlsm X) l
  (s1, oim) (s2, Some m)</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="kr">‚àÉ</span> <span class="nv">s</span> : state,
  can_produce
    (pre_loaded_with_all_messages_vlsm (IM (projT1 l)))
    s m</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="Composition-v-chk170" style="display: none" type="checkbox"><label class="alectryon-input" for="Composition-v-chk170"><span class="kr">exists</span> (<span class="nv">s2</span> (projT1 l)).</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>message, V</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>EqDecision0</var><span class="hyp-type"><b>: </b><span>EqDecision V</span></span></span><br><span><var>IM</var><span class="hyp-type"><b>: </b><span>V ‚Üí VLSM message</span></span></span><br><span><var>constraint</var><span class="hyp-type"><b>: </b><span>composite_label IM
‚Üí composite_state IM * option message
  ‚Üí <span class="kt">Prop</span></span></span></span><br><span><var>X</var><span><span class="hyp-body"><b>:= </b><span>composite_vlsm IM constraint</span></span><span class="hyp-type"><b>: </b><span>VLSM message</span></span></span></span><br><span><var>m</var><span class="hyp-type"><b>: </b><span>message</span></span></span><br><span><var>s2, s1</var><span class="hyp-type"><b>: </b><span>state</span></span></span><br><span><var>oim</var><span class="hyp-type"><b>: </b><span>option message</span></span></span><br><span><var>l</var><span class="hyp-type"><b>: </b><span>label</span></span></span><br><span><var>Ht</var><span class="hyp-type"><b>: </b><span>input_valid_transition
  (pre_loaded_with_all_messages_vlsm X) l
  (s1, oim) (s2, Some m)</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">can_produce
  (pre_loaded_with_all_messages_vlsm (IM (projT1 l)))
  (s2 (projT1 l)) m</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="Composition-v-chk171" style="display: none" type="checkbox"><label class="alectryon-input" for="Composition-v-chk171"><span class="kr">exists</span> (<span class="nv">s1</span> (projT1 l), oim), (projT2 l).</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>message, V</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>EqDecision0</var><span class="hyp-type"><b>: </b><span>EqDecision V</span></span></span><br><span><var>IM</var><span class="hyp-type"><b>: </b><span>V ‚Üí VLSM message</span></span></span><br><span><var>constraint</var><span class="hyp-type"><b>: </b><span>composite_label IM
‚Üí composite_state IM * option message
  ‚Üí <span class="kt">Prop</span></span></span></span><br><span><var>X</var><span><span class="hyp-body"><b>:= </b><span>composite_vlsm IM constraint</span></span><span class="hyp-type"><b>: </b><span>VLSM message</span></span></span></span><br><span><var>m</var><span class="hyp-type"><b>: </b><span>message</span></span></span><br><span><var>s2, s1</var><span class="hyp-type"><b>: </b><span>state</span></span></span><br><span><var>oim</var><span class="hyp-type"><b>: </b><span>option message</span></span></span><br><span><var>l</var><span class="hyp-type"><b>: </b><span>label</span></span></span><br><span><var>Ht</var><span class="hyp-type"><b>: </b><span>input_valid_transition
  (pre_loaded_with_all_messages_vlsm X) l
  (s1, oim) (s2, Some m)</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">input_valid_transition
  (pre_loaded_with_all_messages_vlsm (IM (projT1 l)))
  (projT2 l) (s1 (projT1 l), oim)
  (s2 (projT1 l), Some m)</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="Composition-v-chk172" style="display: none" type="checkbox"><label class="alectryon-input" for="Composition-v-chk172"><span class="nb">revert</span> Ht.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>message, V</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>EqDecision0</var><span class="hyp-type"><b>: </b><span>EqDecision V</span></span></span><br><span><var>IM</var><span class="hyp-type"><b>: </b><span>V ‚Üí VLSM message</span></span></span><br><span><var>constraint</var><span class="hyp-type"><b>: </b><span>composite_label IM
‚Üí composite_state IM * option message
  ‚Üí <span class="kt">Prop</span></span></span></span><br><span><var>X</var><span><span class="hyp-body"><b>:= </b><span>composite_vlsm IM constraint</span></span><span class="hyp-type"><b>: </b><span>VLSM message</span></span></span></span><br><span><var>m</var><span class="hyp-type"><b>: </b><span>message</span></span></span><br><span><var>s2, s1</var><span class="hyp-type"><b>: </b><span>state</span></span></span><br><span><var>oim</var><span class="hyp-type"><b>: </b><span>option message</span></span></span><br><span><var>l</var><span class="hyp-type"><b>: </b><span>label</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">input_valid_transition
  (pre_loaded_with_all_messages_vlsm X) l (s1, oim)
  (s2, Some m)
‚Üí input_valid_transition
    (pre_loaded_with_all_messages_vlsm (IM (projT1 l)))
    (projT2 l) (s1 (projT1 l), oim)
    (s2 (projT1 l), Some m)</div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="nb">apply</span> input_valid_transition_preloaded_project_active.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Qed</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
</span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Section</span> <span class="nf">binary_free_composition</span>.</span></span></pre><div class="doc">
<a id="lab6"></a><h2 class="section">Free composition of two VLSMs</h2>
<div class="paragraph"> </div>

  This serves an example of how composition can be built, but is also being
  used in defining the <span class="inlinecode"><span class="id" title="var">byzantine_trace_prop</span></span>erties.

<div class="paragraph"> </div>

  This instantiates the regular composition using the <span class="inlinecode"><span class="id" title="var">bool</span></span> type as an <code>index</code>.

<div class="paragraph"> </div>
</div><pre class="alectryon-io highlight"><!-- Generator: Alectryon --><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Context</span>
  {<span class="nv">message</span> : <span class="kt">Type</span>}
  (<span class="nv">M1</span> <span class="nv">M2</span> : VLSM message)
  .</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
</span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Definition</span> <span class="nf">binary_index</span> : <span class="kt">Set</span> := bool.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
</span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Definition</span> <span class="nf">first</span> : binary_index := true.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Definition</span> <span class="nf">second</span> : binary_index := false.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
</span><span class="alectryon-sentence"><span class="alectryon-input">#[export] <span class="kn">Instance</span> <span class="nf">binary_index_dec</span> :  EqDecision binary_index := _.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><span class="alectryon-input">#[export] <span class="kn">Instance</span> <span class="nf">binary_index_inhabited</span> : Inhabited binary_index := populate <span class="kp">first</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
</span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Definition</span> <span class="nf">binary_IM</span>
  (<span class="nv">i</span> : binary_index)
  : VLSM message
  :=
  <span class="kr">match</span> i <span class="kr">with</span>
  | true =&gt; M1
  | false =&gt; M2
  <span class="kr">end</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
</span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Definition</span> <span class="nf">binary_free_composition</span>
  : VLSM message
  := free_composite_vlsm binary_IM.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
</span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">End</span> <span class="nf">binary_free_composition</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
</span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Section</span> <span class="nf">composite_decidable_initial_message</span>.</span></span></pre><div class="doc">
<a id="lab7"></a><h2 class="section">Composite decidable initial message</h2>
<div class="paragraph"> </div>

  Here we show that if the <span class="inlinecode"><span class="id" title="var">initial_message_prop</span></span>erty is decidable for every
  component, then it is decidable for a finite composition as well.

<div class="paragraph"> </div>
</div><pre class="alectryon-io highlight"><!-- Generator: Alectryon --><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Context</span>
  {<span class="nv">message</span> : <span class="kt">Type</span>}
  `{finite.Finite index}
  (IM : index -&gt; VLSM message)
  (constraint : composite_label IM -&gt; composite_state IM * option message -&gt; <span class="kt">Prop</span>)
  .</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
</span><span class="alectryon-sentence"><input class="alectryon-toggle" id="Composition-v-chk173" style="display: none" type="checkbox"><label class="alectryon-input" for="Composition-v-chk173"><span class="kn">Lemma</span> <span class="nf">composite_decidable_initial_message</span>
  (<span class="nv">Hdec_init</span> : <span class="kr">forall</span> <span class="nv">i</span>, vdecidable_initial_messages_prop (IM i))
  : decidable_initial_messages_prop (composite_vlsm_machine IM constraint).</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>message, index</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>EqDecision0</var><span class="hyp-type"><b>: </b><span>EqDecision index</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>finite.Finite index</span></span></span><br><span><var>IM</var><span class="hyp-type"><b>: </b><span>index ‚Üí VLSM message</span></span></span><br><span><var>constraint</var><span class="hyp-type"><b>: </b><span>composite_label IM
‚Üí composite_state IM * option message
  ‚Üí <span class="kt">Prop</span></span></span></span><br><span><var>Hdec_init</var><span class="hyp-type"><b>: </b><span><span class="kr">‚àÄ</span> <span class="nv">i</span> : index,
  vdecidable_initial_messages_prop (IM i)</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">decidable_initial_messages_prop
  (composite_vlsm_machine IM constraint)</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="Composition-v-chk174" style="display: none" type="checkbox"><label class="alectryon-input" for="Composition-v-chk174"><span class="kn">Proof</span>.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>message, index</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>EqDecision0</var><span class="hyp-type"><b>: </b><span>EqDecision index</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>finite.Finite index</span></span></span><br><span><var>IM</var><span class="hyp-type"><b>: </b><span>index ‚Üí VLSM message</span></span></span><br><span><var>constraint</var><span class="hyp-type"><b>: </b><span>composite_label IM
‚Üí composite_state IM * option message
  ‚Üí <span class="kt">Prop</span></span></span></span><br><span><var>Hdec_init</var><span class="hyp-type"><b>: </b><span><span class="kr">‚àÄ</span> <span class="nv">i</span> : index,
  vdecidable_initial_messages_prop (IM i)</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">decidable_initial_messages_prop
  (composite_vlsm_machine IM constraint)</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="Composition-v-chk175" style="display: none" type="checkbox"><label class="alectryon-input" for="Composition-v-chk175"><span class="nb">intro</span> m.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>message, index</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>EqDecision0</var><span class="hyp-type"><b>: </b><span>EqDecision index</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>finite.Finite index</span></span></span><br><span><var>IM</var><span class="hyp-type"><b>: </b><span>index ‚Üí VLSM message</span></span></span><br><span><var>constraint</var><span class="hyp-type"><b>: </b><span>composite_label IM
‚Üí composite_state IM * option message
  ‚Üí <span class="kt">Prop</span></span></span></span><br><span><var>Hdec_init</var><span class="hyp-type"><b>: </b><span><span class="kr">‚àÄ</span> <span class="nv">i</span> : index,
  vdecidable_initial_messages_prop (IM i)</span></span></span><br><span><var>m</var><span class="hyp-type"><b>: </b><span>message</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">Decision (initial_message_prop m)</div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="Composition-v-chk176" style="display: none" type="checkbox"><label class="alectryon-input" for="Composition-v-chk176"><span class="nb">simpl</span>.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>message, index</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>EqDecision0</var><span class="hyp-type"><b>: </b><span>EqDecision index</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>finite.Finite index</span></span></span><br><span><var>IM</var><span class="hyp-type"><b>: </b><span>index ‚Üí VLSM message</span></span></span><br><span><var>constraint</var><span class="hyp-type"><b>: </b><span>composite_label IM
‚Üí composite_state IM * option message
  ‚Üí <span class="kt">Prop</span></span></span></span><br><span><var>Hdec_init</var><span class="hyp-type"><b>: </b><span><span class="kr">‚àÄ</span> <span class="nv">i</span> : index,
  vdecidable_initial_messages_prop (IM i)</span></span></span><br><span><var>m</var><span class="hyp-type"><b>: </b><span>message</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">Decision (composite_initial_message_prop IM m)</div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="Composition-v-chk177" style="display: none" type="checkbox"><label class="alectryon-input" for="Composition-v-chk177"><span class="nb">unfold</span> composite_initial_message_prop.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>message, index</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>EqDecision0</var><span class="hyp-type"><b>: </b><span>EqDecision index</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>finite.Finite index</span></span></span><br><span><var>IM</var><span class="hyp-type"><b>: </b><span>index ‚Üí VLSM message</span></span></span><br><span><var>constraint</var><span class="hyp-type"><b>: </b><span>composite_label IM
‚Üí composite_state IM * option message
  ‚Üí <span class="kt">Prop</span></span></span></span><br><span><var>Hdec_init</var><span class="hyp-type"><b>: </b><span><span class="kr">‚àÄ</span> <span class="nv">i</span> : index,
  vdecidable_initial_messages_prop (IM i)</span></span></span><br><span><var>m</var><span class="hyp-type"><b>: </b><span>message</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">Decision
  (<span class="kr">‚àÉ</span> (<span class="nv">n</span> : index) (<span class="nv">mi</span> : vinitial_message (IM n)),
     `mi = m)</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="Composition-v-chk178" style="display: none" type="checkbox"><label class="alectryon-input" for="Composition-v-chk178"><span class="nb">apply</span>
    (Decision_iff
      (P := List.Exists (<span class="kr">fun</span> <span class="nv">i</span> =&gt; vinitial_message_prop (IM i) m) (enum index))
    ).</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>message, index</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>EqDecision0</var><span class="hyp-type"><b>: </b><span>EqDecision index</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>finite.Finite index</span></span></span><br><span><var>IM</var><span class="hyp-type"><b>: </b><span>index ‚Üí VLSM message</span></span></span><br><span><var>constraint</var><span class="hyp-type"><b>: </b><span>composite_label IM
‚Üí composite_state IM * option message
  ‚Üí <span class="kt">Prop</span></span></span></span><br><span><var>Hdec_init</var><span class="hyp-type"><b>: </b><span><span class="kr">‚àÄ</span> <span class="nv">i</span> : index,
  vdecidable_initial_messages_prop (IM i)</span></span></span><br><span><var>m</var><span class="hyp-type"><b>: </b><span>message</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">List.Exists
  (<span class="kr">Œª</span> <span class="nv">i</span> : index, vinitial_message_prop (IM i) m)
  (enum index)
‚Üî (<span class="kr">‚àÉ</span> (<span class="nv">n</span> : index) (<span class="nv">mi</span> : vinitial_message (IM n)),
     `mi = m)</div></blockquote><div class="alectryon-extra-goals"><input class="alectryon-extra-goal-toggle" id="Composition-v-chk179" style="display: none" type="checkbox"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>message, index</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>EqDecision0</var><span class="hyp-type"><b>: </b><span>EqDecision index</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>finite.Finite index</span></span></span><br><span><var>IM</var><span class="hyp-type"><b>: </b><span>index ‚Üí VLSM message</span></span></span><br><span><var>constraint</var><span class="hyp-type"><b>: </b><span>composite_label IM
‚Üí composite_state IM * option message
  ‚Üí <span class="kt">Prop</span></span></span></span><br><span><var>Hdec_init</var><span class="hyp-type"><b>: </b><span><span class="kr">‚àÄ</span> <span class="nv">i</span> : index,
  vdecidable_initial_messages_prop (IM i)</span></span></span><br><span><var>m</var><span class="hyp-type"><b>: </b><span>message</span></span></span><br></div><label class="goal-separator" for="Composition-v-chk179"><hr></label><div class="goal-conclusion">Decision
  (List.Exists
     (<span class="kr">Œª</span> <span class="nv">i</span> : index, vinitial_message_prop (IM i) m)
     (enum index))</div></blockquote></div></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="Composition-v-chk17a" style="display: none" type="checkbox"><label class="alectryon-input" for="Composition-v-chk17a">-</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>message, index</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>EqDecision0</var><span class="hyp-type"><b>: </b><span>EqDecision index</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>finite.Finite index</span></span></span><br><span><var>IM</var><span class="hyp-type"><b>: </b><span>index ‚Üí VLSM message</span></span></span><br><span><var>constraint</var><span class="hyp-type"><b>: </b><span>composite_label IM
‚Üí composite_state IM * option message
  ‚Üí <span class="kt">Prop</span></span></span></span><br><span><var>Hdec_init</var><span class="hyp-type"><b>: </b><span><span class="kr">‚àÄ</span> <span class="nv">i</span> : index,
  vdecidable_initial_messages_prop (IM i)</span></span></span><br><span><var>m</var><span class="hyp-type"><b>: </b><span>message</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">List.Exists
  (<span class="kr">Œª</span> <span class="nv">i</span> : index, vinitial_message_prop (IM i) m)
  (enum index)
‚Üî (<span class="kr">‚àÉ</span> (<span class="nv">n</span> : index) (<span class="nv">mi</span> : vinitial_message (IM n)),
     `mi = m)</div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="Composition-v-chk17b" style="display: none" type="checkbox"><label class="alectryon-input" for="Composition-v-chk17b"><span class="nb">rewrite</span> &lt;- exists_finite.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>message, index</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>EqDecision0</var><span class="hyp-type"><b>: </b><span>EqDecision index</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>finite.Finite index</span></span></span><br><span><var>IM</var><span class="hyp-type"><b>: </b><span>index ‚Üí VLSM message</span></span></span><br><span><var>constraint</var><span class="hyp-type"><b>: </b><span>composite_label IM
‚Üí composite_state IM * option message
  ‚Üí <span class="kt">Prop</span></span></span></span><br><span><var>Hdec_init</var><span class="hyp-type"><b>: </b><span><span class="kr">‚àÄ</span> <span class="nv">i</span> : index,
  vdecidable_initial_messages_prop (IM i)</span></span></span><br><span><var>m</var><span class="hyp-type"><b>: </b><span>message</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">(<span class="kr">‚àÉ</span> <span class="nv">n</span> : index, vinitial_message_prop (IM n) m)
‚Üî (<span class="kr">‚àÉ</span> (<span class="nv">n</span> : index) (<span class="nv">mi</span> : vinitial_message (IM n)),
     `mi = m)</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="Composition-v-chk17c" style="display: none" type="checkbox"><label class="alectryon-input" for="Composition-v-chk17c"><span class="nb">split</span>; <span class="nb">intros</span> [i Hm]; <span class="kr">exists</span> <span class="nv">i</span>.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>message, index</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>EqDecision0</var><span class="hyp-type"><b>: </b><span>EqDecision index</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>finite.Finite index</span></span></span><br><span><var>IM</var><span class="hyp-type"><b>: </b><span>index ‚Üí VLSM message</span></span></span><br><span><var>constraint</var><span class="hyp-type"><b>: </b><span>composite_label IM
‚Üí composite_state IM * option message
  ‚Üí <span class="kt">Prop</span></span></span></span><br><span><var>Hdec_init</var><span class="hyp-type"><b>: </b><span><span class="kr">‚àÄ</span> <span class="nv">i</span> : index,
  vdecidable_initial_messages_prop (IM i)</span></span></span><br><span><var>m</var><span class="hyp-type"><b>: </b><span>message</span></span></span><br><span><var>i</var><span class="hyp-type"><b>: </b><span>index</span></span></span><br><span><var>Hm</var><span class="hyp-type"><b>: </b><span>vinitial_message_prop (IM i) m</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="kr">‚àÉ</span> <span class="nv">mi</span> : vinitial_message (IM i), `mi = m</div></blockquote><div class="alectryon-extra-goals"><input class="alectryon-extra-goal-toggle" id="Composition-v-chk17d" style="display: none" type="checkbox"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>message, index</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>EqDecision0</var><span class="hyp-type"><b>: </b><span>EqDecision index</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>finite.Finite index</span></span></span><br><span><var>IM</var><span class="hyp-type"><b>: </b><span>index ‚Üí VLSM message</span></span></span><br><span><var>constraint</var><span class="hyp-type"><b>: </b><span>composite_label IM
‚Üí composite_state IM * option message
  ‚Üí <span class="kt">Prop</span></span></span></span><br><span><var>Hdec_init</var><span class="hyp-type"><b>: </b><span><span class="kr">‚àÄ</span> <span class="nv">i</span> : index,
  vdecidable_initial_messages_prop (IM i)</span></span></span><br><span><var>m</var><span class="hyp-type"><b>: </b><span>message</span></span></span><br><span><var>i</var><span class="hyp-type"><b>: </b><span>index</span></span></span><br><span><var>Hm</var><span class="hyp-type"><b>: </b><span><span class="kr">‚àÉ</span> <span class="nv">mi</span> : vinitial_message (IM i), `mi = m</span></span></span><br></div><label class="goal-separator" for="Composition-v-chk17d"><hr></label><div class="goal-conclusion">vinitial_message_prop (IM i) m</div></blockquote></div></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="Composition-v-chk17e" style="display: none" type="checkbox"><label class="alectryon-input" for="Composition-v-chk17e">+</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>message, index</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>EqDecision0</var><span class="hyp-type"><b>: </b><span>EqDecision index</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>finite.Finite index</span></span></span><br><span><var>IM</var><span class="hyp-type"><b>: </b><span>index ‚Üí VLSM message</span></span></span><br><span><var>constraint</var><span class="hyp-type"><b>: </b><span>composite_label IM
‚Üí composite_state IM * option message
  ‚Üí <span class="kt">Prop</span></span></span></span><br><span><var>Hdec_init</var><span class="hyp-type"><b>: </b><span><span class="kr">‚àÄ</span> <span class="nv">i</span> : index,
  vdecidable_initial_messages_prop (IM i)</span></span></span><br><span><var>m</var><span class="hyp-type"><b>: </b><span>message</span></span></span><br><span><var>i</var><span class="hyp-type"><b>: </b><span>index</span></span></span><br><span><var>Hm</var><span class="hyp-type"><b>: </b><span>vinitial_message_prop (IM i) m</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="kr">‚àÉ</span> <span class="nv">mi</span> : vinitial_message (IM i), `mi = m</div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="bp">by</span> <span class="kr">exists</span> (<span class="nv">exist</span> <span class="nv">_</span> <span class="nv">_</span> <span class="nv">Hm</span>).</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="Composition-v-chk17f" style="display: none" type="checkbox"><label class="alectryon-input" for="Composition-v-chk17f">+</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>message, index</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>EqDecision0</var><span class="hyp-type"><b>: </b><span>EqDecision index</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>finite.Finite index</span></span></span><br><span><var>IM</var><span class="hyp-type"><b>: </b><span>index ‚Üí VLSM message</span></span></span><br><span><var>constraint</var><span class="hyp-type"><b>: </b><span>composite_label IM
‚Üí composite_state IM * option message
  ‚Üí <span class="kt">Prop</span></span></span></span><br><span><var>Hdec_init</var><span class="hyp-type"><b>: </b><span><span class="kr">‚àÄ</span> <span class="nv">i</span> : index,
  vdecidable_initial_messages_prop (IM i)</span></span></span><br><span><var>m</var><span class="hyp-type"><b>: </b><span>message</span></span></span><br><span><var>i</var><span class="hyp-type"><b>: </b><span>index</span></span></span><br><span><var>Hm</var><span class="hyp-type"><b>: </b><span><span class="kr">‚àÉ</span> <span class="nv">mi</span> : vinitial_message (IM i), `mi = m</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">vinitial_message_prop (IM i) m</div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="bp">by</span> <span class="nb">destruct</span> Hm <span class="kr">as</span> [[im Hinit] [= -&gt;]].</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="Composition-v-chk180" style="display: none" type="checkbox"><label class="alectryon-input" for="Composition-v-chk180">-</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>message, index</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>EqDecision0</var><span class="hyp-type"><b>: </b><span>EqDecision index</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>finite.Finite index</span></span></span><br><span><var>IM</var><span class="hyp-type"><b>: </b><span>index ‚Üí VLSM message</span></span></span><br><span><var>constraint</var><span class="hyp-type"><b>: </b><span>composite_label IM
‚Üí composite_state IM * option message
  ‚Üí <span class="kt">Prop</span></span></span></span><br><span><var>Hdec_init</var><span class="hyp-type"><b>: </b><span><span class="kr">‚àÄ</span> <span class="nv">i</span> : index,
  vdecidable_initial_messages_prop (IM i)</span></span></span><br><span><var>m</var><span class="hyp-type"><b>: </b><span>message</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">Decision
  (List.Exists
     (<span class="kr">Œª</span> <span class="nv">i</span> : index, vinitial_message_prop (IM i) m)
     (enum index))</div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="Composition-v-chk181" style="display: none" type="checkbox"><label class="alectryon-input" for="Composition-v-chk181"><span class="nb">apply</span> @Exists_dec.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>message, index</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>EqDecision0</var><span class="hyp-type"><b>: </b><span>EqDecision index</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>finite.Finite index</span></span></span><br><span><var>IM</var><span class="hyp-type"><b>: </b><span>index ‚Üí VLSM message</span></span></span><br><span><var>constraint</var><span class="hyp-type"><b>: </b><span>composite_label IM
‚Üí composite_state IM * option message
  ‚Üí <span class="kt">Prop</span></span></span></span><br><span><var>Hdec_init</var><span class="hyp-type"><b>: </b><span><span class="kr">‚àÄ</span> <span class="nv">i</span> : index,
  vdecidable_initial_messages_prop (IM i)</span></span></span><br><span><var>m</var><span class="hyp-type"><b>: </b><span>message</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="kr">‚àÄ</span> <span class="nv">x</span> : index, Decision (vinitial_message_prop (IM x) m)</div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="Composition-v-chk182" style="display: none" type="checkbox"><label class="alectryon-input" for="Composition-v-chk182"><span class="nb">intro</span> i.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>message, index</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>EqDecision0</var><span class="hyp-type"><b>: </b><span>EqDecision index</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>finite.Finite index</span></span></span><br><span><var>IM</var><span class="hyp-type"><b>: </b><span>index ‚Üí VLSM message</span></span></span><br><span><var>constraint</var><span class="hyp-type"><b>: </b><span>composite_label IM
‚Üí composite_state IM * option message
  ‚Üí <span class="kt">Prop</span></span></span></span><br><span><var>Hdec_init</var><span class="hyp-type"><b>: </b><span><span class="kr">‚àÄ</span> <span class="nv">i</span> : index,
  vdecidable_initial_messages_prop (IM i)</span></span></span><br><span><var>m</var><span class="hyp-type"><b>: </b><span>message</span></span></span><br><span><var>i</var><span class="hyp-type"><b>: </b><span>index</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">Decision (vinitial_message_prop (IM i) m)</div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="nb">apply</span> Hdec_init.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Qed</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
</span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">End</span> <span class="nf">composite_decidable_initial_message</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
</span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Section</span> <span class="nf">composite_plan_properties</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
</span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Context</span>
  {<span class="nv">message</span> : <span class="kt">Type</span>}
  {<span class="nv">index</span> : <span class="kt">Type</span>}
  `{EqDecision index}
  (IM :index -&gt; VLSM message)
  (Free := free_composite_vlsm IM)
  .</span></span></pre><div class="doc">
<a id="lab8"></a><h2 class="section">Composite Plan Properties</h2>
<div class="paragraph"> </div>

  The following results concern facts about applying a <span class="inlinecode"><span class="id" title="var">plan</span></span> <span class="inlinecode"><span class="id" title="var">Free</span></span> <code>P</code>
  to a <span class="inlinecode"><span class="id" title="var">vstate</span></span> <span class="inlinecode"><span class="id" title="var">Free</span></span> <code>s'</code>, knowing its effects on a different <span class="inlinecode"><span class="id" title="var">vstate</span></span> <span class="inlinecode"><span class="id" title="var">Free</span></span> <code>s</code>
  which shares some relevant features with <code>s'</code>. 

</div><pre class="alectryon-io highlight"><!-- Generator: Alectryon --><span class="alectryon-wsp"><span class="c">(* A transition on component &lt;&lt;i&gt;&gt; is [input_valid] from &lt;&lt;s&#39;&gt;&gt; if it is</span>
<span class="c">   [input_valid] from &lt;&lt;s&gt;&gt; and their &lt;&lt;i&gt;&gt;&#39;th components are equal. *)</span>

</span><span class="alectryon-sentence"><input class="alectryon-toggle" id="Composition-v-chk183" style="display: none" type="checkbox"><label class="alectryon-input" for="Composition-v-chk183"><span class="kn">Lemma</span> <span class="nf">relevant_component_transition</span>
  (<span class="nv">s</span> <span class="nv">s&#39;</span> : vstate Free)
  (<span class="nv">l</span> : vlabel Free)
  (<span class="nv">input</span> : option message)
  (<span class="nv">i</span> := projT1 l)
  (<span class="nv">Heq</span> : (s i) = (s&#39; i))
  (<span class="nv">Hprs</span> : valid_state_prop Free s&#39;)
  (<span class="nv">Hiv</span> : input_valid Free l (s, input)) :
  input_valid Free l (s&#39;, input).</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>message, index</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>EqDecision0</var><span class="hyp-type"><b>: </b><span>EqDecision index</span></span></span><br><span><var>IM</var><span class="hyp-type"><b>: </b><span>index ‚Üí VLSM message</span></span></span><br><span><var>Free</var><span><span class="hyp-body"><b>:= </b><span>free_composite_vlsm IM</span></span><span class="hyp-type"><b>: </b><span>VLSM message</span></span></span></span><br><span><var>s, s'</var><span class="hyp-type"><b>: </b><span>vstate Free</span></span></span><br><span><var>l</var><span class="hyp-type"><b>: </b><span>vlabel Free</span></span></span><br><span><var>input</var><span class="hyp-type"><b>: </b><span>option message</span></span></span><br><span><var>i</var><span><span class="hyp-body"><b>:= </b><span>projT1 l</span></span><span class="hyp-type"><b>: </b><span>index</span></span></span></span><br><span><var>Heq</var><span class="hyp-type"><b>: </b><span>s i = s&#39; i</span></span></span><br><span><var>Hprs</var><span class="hyp-type"><b>: </b><span>valid_state_prop Free s&#39;</span></span></span><br><span><var>Hiv</var><span class="hyp-type"><b>: </b><span>input_valid Free l (s, input)</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">input_valid Free l (s&#39;, input)</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="Composition-v-chk184" style="display: none" type="checkbox"><label class="alectryon-input" for="Composition-v-chk184"><span class="kn">Proof</span>.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>message, index</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>EqDecision0</var><span class="hyp-type"><b>: </b><span>EqDecision index</span></span></span><br><span><var>IM</var><span class="hyp-type"><b>: </b><span>index ‚Üí VLSM message</span></span></span><br><span><var>Free</var><span><span class="hyp-body"><b>:= </b><span>free_composite_vlsm IM</span></span><span class="hyp-type"><b>: </b><span>VLSM message</span></span></span></span><br><span><var>s, s'</var><span class="hyp-type"><b>: </b><span>vstate Free</span></span></span><br><span><var>l</var><span class="hyp-type"><b>: </b><span>vlabel Free</span></span></span><br><span><var>input</var><span class="hyp-type"><b>: </b><span>option message</span></span></span><br><span><var>i</var><span><span class="hyp-body"><b>:= </b><span>projT1 l</span></span><span class="hyp-type"><b>: </b><span>index</span></span></span></span><br><span><var>Heq</var><span class="hyp-type"><b>: </b><span>s i = s&#39; i</span></span></span><br><span><var>Hprs</var><span class="hyp-type"><b>: </b><span>valid_state_prop Free s&#39;</span></span></span><br><span><var>Hiv</var><span class="hyp-type"><b>: </b><span>input_valid Free l (s, input)</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">input_valid Free l (s&#39;, input)</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="Composition-v-chk185" style="display: none" type="checkbox"><label class="alectryon-input" for="Composition-v-chk185"><span class="nb">unfold</span> input_valid <span class="kr">in</span> *.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>message, index</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>EqDecision0</var><span class="hyp-type"><b>: </b><span>EqDecision index</span></span></span><br><span><var>IM</var><span class="hyp-type"><b>: </b><span>index ‚Üí VLSM message</span></span></span><br><span><var>Free</var><span><span class="hyp-body"><b>:= </b><span>free_composite_vlsm IM</span></span><span class="hyp-type"><b>: </b><span>VLSM message</span></span></span></span><br><span><var>s, s'</var><span class="hyp-type"><b>: </b><span>vstate Free</span></span></span><br><span><var>l</var><span class="hyp-type"><b>: </b><span>vlabel Free</span></span></span><br><span><var>input</var><span class="hyp-type"><b>: </b><span>option message</span></span></span><br><span><var>i</var><span><span class="hyp-body"><b>:= </b><span>projT1 l</span></span><span class="hyp-type"><b>: </b><span>index</span></span></span></span><br><span><var>Heq</var><span class="hyp-type"><b>: </b><span>s i = s&#39; i</span></span></span><br><span><var>Hprs</var><span class="hyp-type"><b>: </b><span>valid_state_prop Free s&#39;</span></span></span><br><span><var>Hiv</var><span class="hyp-type"><b>: </b><span>valid_state_prop Free s
‚àß option_valid_message_prop Free input
  ‚àß valid l (s, input)</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">valid_state_prop Free s&#39;
‚àß option_valid_message_prop Free input
  ‚àß valid l (s&#39;, input)</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="Composition-v-chk186" style="display: none" type="checkbox"><label class="alectryon-input" for="Composition-v-chk186">split_and!; <span class="kp">try</span> itauto.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>message, index</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>EqDecision0</var><span class="hyp-type"><b>: </b><span>EqDecision index</span></span></span><br><span><var>IM</var><span class="hyp-type"><b>: </b><span>index ‚Üí VLSM message</span></span></span><br><span><var>Free</var><span><span class="hyp-body"><b>:= </b><span>free_composite_vlsm IM</span></span><span class="hyp-type"><b>: </b><span>VLSM message</span></span></span></span><br><span><var>s, s'</var><span class="hyp-type"><b>: </b><span>vstate Free</span></span></span><br><span><var>l</var><span class="hyp-type"><b>: </b><span>vlabel Free</span></span></span><br><span><var>input</var><span class="hyp-type"><b>: </b><span>option message</span></span></span><br><span><var>i</var><span><span class="hyp-body"><b>:= </b><span>projT1 l</span></span><span class="hyp-type"><b>: </b><span>index</span></span></span></span><br><span><var>Heq</var><span class="hyp-type"><b>: </b><span>s i = s&#39; i</span></span></span><br><span><var>Hprs</var><span class="hyp-type"><b>: </b><span>valid_state_prop Free s&#39;</span></span></span><br><span><var>Hiv</var><span class="hyp-type"><b>: </b><span>valid_state_prop Free s
‚àß option_valid_message_prop Free input
  ‚àß valid l (s, input)</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">valid l (s&#39;, input)</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="Composition-v-chk187" style="display: none" type="checkbox"><label class="alectryon-input" for="Composition-v-chk187"><span class="nb">unfold</span> valid <span class="kr">in</span> *; <span class="nb">simpl</span> <span class="kr">in</span> *.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>message, index</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>EqDecision0</var><span class="hyp-type"><b>: </b><span>EqDecision index</span></span></span><br><span><var>IM</var><span class="hyp-type"><b>: </b><span>index ‚Üí VLSM message</span></span></span><br><span><var>Free</var><span><span class="hyp-body"><b>:= </b><span>free_composite_vlsm IM</span></span><span class="hyp-type"><b>: </b><span>VLSM message</span></span></span></span><br><span><var>s, s'</var><span class="hyp-type"><b>: </b><span>vstate Free</span></span></span><br><span><var>l</var><span class="hyp-type"><b>: </b><span>vlabel Free</span></span></span><br><span><var>input</var><span class="hyp-type"><b>: </b><span>option message</span></span></span><br><span><var>i</var><span><span class="hyp-body"><b>:= </b><span>projT1 l</span></span><span class="hyp-type"><b>: </b><span>index</span></span></span></span><br><span><var>Heq</var><span class="hyp-type"><b>: </b><span>s i = s&#39; i</span></span></span><br><span><var>Hprs</var><span class="hyp-type"><b>: </b><span>valid_state_prop Free s&#39;</span></span></span><br><span><var>Hiv</var><span class="hyp-type"><b>: </b><span>valid_state_prop Free s
‚àß option_valid_message_prop Free input
  ‚àß constrained_composite_valid IM
      (free_constraint IM) l 
      (s, input)</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">constrained_composite_valid IM (free_constraint IM) l
  (s&#39;, input)</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="Composition-v-chk188" style="display: none" type="checkbox"><label class="alectryon-input" for="Composition-v-chk188"><span class="nb">unfold</span> constrained_composite_valid <span class="kr">in</span> *.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>message, index</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>EqDecision0</var><span class="hyp-type"><b>: </b><span>EqDecision index</span></span></span><br><span><var>IM</var><span class="hyp-type"><b>: </b><span>index ‚Üí VLSM message</span></span></span><br><span><var>Free</var><span><span class="hyp-body"><b>:= </b><span>free_composite_vlsm IM</span></span><span class="hyp-type"><b>: </b><span>VLSM message</span></span></span></span><br><span><var>s, s'</var><span class="hyp-type"><b>: </b><span>vstate Free</span></span></span><br><span><var>l</var><span class="hyp-type"><b>: </b><span>vlabel Free</span></span></span><br><span><var>input</var><span class="hyp-type"><b>: </b><span>option message</span></span></span><br><span><var>i</var><span><span class="hyp-body"><b>:= </b><span>projT1 l</span></span><span class="hyp-type"><b>: </b><span>index</span></span></span></span><br><span><var>Heq</var><span class="hyp-type"><b>: </b><span>s i = s&#39; i</span></span></span><br><span><var>Hprs</var><span class="hyp-type"><b>: </b><span>valid_state_prop Free s&#39;</span></span></span><br><span><var>Hiv</var><span class="hyp-type"><b>: </b><span>valid_state_prop Free s
‚àß option_valid_message_prop Free input
  ‚àß composite_valid IM l (s, input)
    ‚àß free_constraint IM l (s, input)</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">composite_valid IM l (s&#39;, input)
‚àß free_constraint IM l (s&#39;, input)</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="Composition-v-chk189" style="display: none" type="checkbox"><label class="alectryon-input" for="Composition-v-chk189"><span class="nb">unfold</span> composite_valid <span class="kr">in</span> *.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>message, index</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>EqDecision0</var><span class="hyp-type"><b>: </b><span>EqDecision index</span></span></span><br><span><var>IM</var><span class="hyp-type"><b>: </b><span>index ‚Üí VLSM message</span></span></span><br><span><var>Free</var><span><span class="hyp-body"><b>:= </b><span>free_composite_vlsm IM</span></span><span class="hyp-type"><b>: </b><span>VLSM message</span></span></span></span><br><span><var>s, s'</var><span class="hyp-type"><b>: </b><span>vstate Free</span></span></span><br><span><var>l</var><span class="hyp-type"><b>: </b><span>vlabel Free</span></span></span><br><span><var>input</var><span class="hyp-type"><b>: </b><span>option message</span></span></span><br><span><var>i</var><span><span class="hyp-body"><b>:= </b><span>projT1 l</span></span><span class="hyp-type"><b>: </b><span>index</span></span></span></span><br><span><var>Heq</var><span class="hyp-type"><b>: </b><span>s i = s&#39; i</span></span></span><br><span><var>Hprs</var><span class="hyp-type"><b>: </b><span>valid_state_prop Free s&#39;</span></span></span><br><span><var>Hiv</var><span class="hyp-type"><b>: </b><span>valid_state_prop Free s
‚àß option_valid_message_prop Free input
  ‚àß (<span class="kr">let</span> (<span class="nv">i</span>, li) := l <span class="kr">in</span>
     vvalid (IM i) li (s i, input))
    ‚àß free_constraint IM l (s, input)</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">(<span class="kr">let</span> (<span class="nv">i</span>, li) := l <span class="kr">in</span> vvalid (IM i) li (s&#39; i, input))
‚àß free_constraint IM l (s&#39;, input)</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="Composition-v-chk18a" style="display: none" type="checkbox"><label class="alectryon-input" for="Composition-v-chk18a"><span class="nb">unfold</span> free_constraint <span class="kr">in</span> *; <span class="nb">simpl</span>.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>message, index</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>EqDecision0</var><span class="hyp-type"><b>: </b><span>EqDecision index</span></span></span><br><span><var>IM</var><span class="hyp-type"><b>: </b><span>index ‚Üí VLSM message</span></span></span><br><span><var>Free</var><span><span class="hyp-body"><b>:= </b><span>free_composite_vlsm IM</span></span><span class="hyp-type"><b>: </b><span>VLSM message</span></span></span></span><br><span><var>s, s'</var><span class="hyp-type"><b>: </b><span>vstate Free</span></span></span><br><span><var>l</var><span class="hyp-type"><b>: </b><span>vlabel Free</span></span></span><br><span><var>input</var><span class="hyp-type"><b>: </b><span>option message</span></span></span><br><span><var>i</var><span><span class="hyp-body"><b>:= </b><span>projT1 l</span></span><span class="hyp-type"><b>: </b><span>index</span></span></span></span><br><span><var>Heq</var><span class="hyp-type"><b>: </b><span>s i = s&#39; i</span></span></span><br><span><var>Hprs</var><span class="hyp-type"><b>: </b><span>valid_state_prop Free s&#39;</span></span></span><br><span><var>Hiv</var><span class="hyp-type"><b>: </b><span>valid_state_prop Free s
‚àß option_valid_message_prop Free input
  ‚àß (<span class="kr">let</span> (<span class="nv">i</span>, li) := l <span class="kr">in</span>
     vvalid (IM i) li (s i, input)) ‚àß <span class="kt">True</span></span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">(<span class="kr">let</span> (<span class="nv">i</span>, li) := l <span class="kr">in</span> vvalid (IM i) li (s&#39; i, input))
‚àß <span class="kt">True</span></div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="Composition-v-chk18b" style="display: none" type="checkbox"><label class="alectryon-input" for="Composition-v-chk18b"><span class="nb">unfold</span> vvalid <span class="kr">in</span> *.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>message, index</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>EqDecision0</var><span class="hyp-type"><b>: </b><span>EqDecision index</span></span></span><br><span><var>IM</var><span class="hyp-type"><b>: </b><span>index ‚Üí VLSM message</span></span></span><br><span><var>Free</var><span><span class="hyp-body"><b>:= </b><span>free_composite_vlsm IM</span></span><span class="hyp-type"><b>: </b><span>VLSM message</span></span></span></span><br><span><var>s, s'</var><span class="hyp-type"><b>: </b><span>vstate Free</span></span></span><br><span><var>l</var><span class="hyp-type"><b>: </b><span>vlabel Free</span></span></span><br><span><var>input</var><span class="hyp-type"><b>: </b><span>option message</span></span></span><br><span><var>i</var><span><span class="hyp-body"><b>:= </b><span>projT1 l</span></span><span class="hyp-type"><b>: </b><span>index</span></span></span></span><br><span><var>Heq</var><span class="hyp-type"><b>: </b><span>s i = s&#39; i</span></span></span><br><span><var>Hprs</var><span class="hyp-type"><b>: </b><span>valid_state_prop Free s&#39;</span></span></span><br><span><var>Hiv</var><span class="hyp-type"><b>: </b><span>valid_state_prop Free s
‚àß option_valid_message_prop Free input
  ‚àß (<span class="kr">let</span> (<span class="nv">i</span>, li) := l <span class="kr">in</span> valid li (s i, input))
    ‚àß <span class="kt">True</span></span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">(<span class="kr">let</span> (<span class="nv">i</span>, li) := l <span class="kr">in</span> valid li (s&#39; i, input)) ‚àß <span class="kt">True</span></div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="Composition-v-chk18c" style="display: none" type="checkbox"><label class="alectryon-input" for="Composition-v-chk18c"><span class="nb">destruct</span> l.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>message, index</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>EqDecision0</var><span class="hyp-type"><b>: </b><span>EqDecision index</span></span></span><br><span><var>IM</var><span class="hyp-type"><b>: </b><span>index ‚Üí VLSM message</span></span></span><br><span><var>Free</var><span><span class="hyp-body"><b>:= </b><span>free_composite_vlsm IM</span></span><span class="hyp-type"><b>: </b><span>VLSM message</span></span></span></span><br><span><var>s, s'</var><span class="hyp-type"><b>: </b><span>vstate Free</span></span></span><br><span><var>x</var><span class="hyp-type"><b>: </b><span>index</span></span></span><br><span><var>v</var><span class="hyp-type"><b>: </b><span>vlabel (IM x)</span></span></span><br><span><var>input</var><span class="hyp-type"><b>: </b><span>option message</span></span></span><br><span><var>i</var><span><span class="hyp-body"><b>:= </b><span>projT1 (existT x v)</span></span><span class="hyp-type"><b>: </b><span>index</span></span></span></span><br><span><var>Heq</var><span class="hyp-type"><b>: </b><span>s i = s&#39; i</span></span></span><br><span><var>Hprs</var><span class="hyp-type"><b>: </b><span>valid_state_prop Free s&#39;</span></span></span><br><span><var>Hiv</var><span class="hyp-type"><b>: </b><span>valid_state_prop Free s
‚àß option_valid_message_prop Free input
  ‚àß valid v (s x, input) ‚àß <span class="kt">True</span></span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">valid v (s&#39; x, input) ‚àß <span class="kt">True</span></div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="Composition-v-chk18d" style="display: none" type="checkbox"><label class="alectryon-input" for="Composition-v-chk18d"><span class="nb">simpl</span> <span class="kr">in</span> i.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>message, index</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>EqDecision0</var><span class="hyp-type"><b>: </b><span>EqDecision index</span></span></span><br><span><var>IM</var><span class="hyp-type"><b>: </b><span>index ‚Üí VLSM message</span></span></span><br><span><var>Free</var><span><span class="hyp-body"><b>:= </b><span>free_composite_vlsm IM</span></span><span class="hyp-type"><b>: </b><span>VLSM message</span></span></span></span><br><span><var>s, s'</var><span class="hyp-type"><b>: </b><span>vstate Free</span></span></span><br><span><var>x</var><span class="hyp-type"><b>: </b><span>index</span></span></span><br><span><var>v</var><span class="hyp-type"><b>: </b><span>vlabel (IM x)</span></span></span><br><span><var>input</var><span class="hyp-type"><b>: </b><span>option message</span></span></span><br><span><var>i</var><span><span class="hyp-body"><b>:= </b><span>x</span></span><span class="hyp-type"><b>: </b><span>index</span></span></span></span><br><span><var>Heq</var><span class="hyp-type"><b>: </b><span>s i = s&#39; i</span></span></span><br><span><var>Hprs</var><span class="hyp-type"><b>: </b><span>valid_state_prop Free s&#39;</span></span></span><br><span><var>Hiv</var><span class="hyp-type"><b>: </b><span>valid_state_prop Free s
‚àß option_valid_message_prop Free input
  ‚àß valid v (s x, input) ‚àß <span class="kt">True</span></span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">valid v (s&#39; x, input) ‚àß <span class="kt">True</span></div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="Composition-v-chk18e" style="display: none" type="checkbox"><label class="alectryon-input" for="Composition-v-chk18e"><span class="nb">unfold</span> i <span class="kr">in</span> Heq.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>message, index</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>EqDecision0</var><span class="hyp-type"><b>: </b><span>EqDecision index</span></span></span><br><span><var>IM</var><span class="hyp-type"><b>: </b><span>index ‚Üí VLSM message</span></span></span><br><span><var>Free</var><span><span class="hyp-body"><b>:= </b><span>free_composite_vlsm IM</span></span><span class="hyp-type"><b>: </b><span>VLSM message</span></span></span></span><br><span><var>s, s'</var><span class="hyp-type"><b>: </b><span>vstate Free</span></span></span><br><span><var>x</var><span class="hyp-type"><b>: </b><span>index</span></span></span><br><span><var>v</var><span class="hyp-type"><b>: </b><span>vlabel (IM x)</span></span></span><br><span><var>input</var><span class="hyp-type"><b>: </b><span>option message</span></span></span><br><span><var>i</var><span><span class="hyp-body"><b>:= </b><span>x</span></span><span class="hyp-type"><b>: </b><span>index</span></span></span></span><br><span><var>Heq</var><span class="hyp-type"><b>: </b><span>s x = s&#39; x</span></span></span><br><span><var>Hprs</var><span class="hyp-type"><b>: </b><span>valid_state_prop Free s&#39;</span></span></span><br><span><var>Hiv</var><span class="hyp-type"><b>: </b><span>valid_state_prop Free s
‚àß option_valid_message_prop Free input
  ‚àß valid v (s x, input) ‚àß <span class="kt">True</span></span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">valid v (s&#39; x, input) ‚àß <span class="kt">True</span></div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="Composition-v-chk18f" style="display: none" type="checkbox"><label class="alectryon-input" for="Composition-v-chk18f"><span class="nb">rewrite</span> &lt;- Heq.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>message, index</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>EqDecision0</var><span class="hyp-type"><b>: </b><span>EqDecision index</span></span></span><br><span><var>IM</var><span class="hyp-type"><b>: </b><span>index ‚Üí VLSM message</span></span></span><br><span><var>Free</var><span><span class="hyp-body"><b>:= </b><span>free_composite_vlsm IM</span></span><span class="hyp-type"><b>: </b><span>VLSM message</span></span></span></span><br><span><var>s, s'</var><span class="hyp-type"><b>: </b><span>vstate Free</span></span></span><br><span><var>x</var><span class="hyp-type"><b>: </b><span>index</span></span></span><br><span><var>v</var><span class="hyp-type"><b>: </b><span>vlabel (IM x)</span></span></span><br><span><var>input</var><span class="hyp-type"><b>: </b><span>option message</span></span></span><br><span><var>i</var><span><span class="hyp-body"><b>:= </b><span>x</span></span><span class="hyp-type"><b>: </b><span>index</span></span></span></span><br><span><var>Heq</var><span class="hyp-type"><b>: </b><span>s x = s&#39; x</span></span></span><br><span><var>Hprs</var><span class="hyp-type"><b>: </b><span>valid_state_prop Free s&#39;</span></span></span><br><span><var>Hiv</var><span class="hyp-type"><b>: </b><span>valid_state_prop Free s
‚àß option_valid_message_prop Free input
  ‚àß valid v (s x, input) ‚àß <span class="kt">True</span></span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">valid v (s x, input) ‚àß <span class="kt">True</span></div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><span class="alectryon-input">itauto.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Qed</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
<span class="c">(* The effect of the transition is also the same *)</span>

</span><span class="alectryon-sentence"><input class="alectryon-toggle" id="Composition-v-chk190" style="display: none" type="checkbox"><label class="alectryon-input" for="Composition-v-chk190"><span class="kn">Lemma</span> <span class="nf">relevant_component_transition2</span>
  (<span class="nv">s</span> <span class="nv">s&#39;</span> : vstate Free)
  (<span class="nv">l</span> : vlabel Free)
  (<span class="nv">input</span> : option message)
  (<span class="nv">i</span> := projT1 l)
  (<span class="nv">Heq</span> : (s i) = (s&#39; i))
  (<span class="nv">Hprs</span> : valid_state_prop Free s&#39;) :
  <span class="kr">let</span> (<span class="nv">dest</span>, output) := vtransition Free l (s, input) <span class="kr">in</span>
  <span class="kr">let</span> (<span class="nv">dest&#39;</span>, output&#39;) := vtransition Free l (s&#39;, input) <span class="kr">in</span>
  output = output&#39; /\ (dest i) = (dest&#39; i).</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>message, index</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>EqDecision0</var><span class="hyp-type"><b>: </b><span>EqDecision index</span></span></span><br><span><var>IM</var><span class="hyp-type"><b>: </b><span>index ‚Üí VLSM message</span></span></span><br><span><var>Free</var><span><span class="hyp-body"><b>:= </b><span>free_composite_vlsm IM</span></span><span class="hyp-type"><b>: </b><span>VLSM message</span></span></span></span><br><span><var>s, s'</var><span class="hyp-type"><b>: </b><span>vstate Free</span></span></span><br><span><var>l</var><span class="hyp-type"><b>: </b><span>vlabel Free</span></span></span><br><span><var>input</var><span class="hyp-type"><b>: </b><span>option message</span></span></span><br><span><var>i</var><span><span class="hyp-body"><b>:= </b><span>projT1 l</span></span><span class="hyp-type"><b>: </b><span>index</span></span></span></span><br><span><var>Heq</var><span class="hyp-type"><b>: </b><span>s i = s&#39; i</span></span></span><br><span><var>Hprs</var><span class="hyp-type"><b>: </b><span>valid_state_prop Free s&#39;</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="kr">let</span> (<span class="nv">dest</span>, output) := vtransition Free l (s, input) <span class="kr">in</span>
<span class="kr">let</span> (<span class="nv">dest&#39;</span>, output&#39;) :=
  vtransition Free l (s&#39;, input) <span class="kr">in</span>
output = output&#39; ‚àß dest i = dest&#39; i</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="Composition-v-chk191" style="display: none" type="checkbox"><label class="alectryon-input" for="Composition-v-chk191"><span class="kn">Proof</span>.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>message, index</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>EqDecision0</var><span class="hyp-type"><b>: </b><span>EqDecision index</span></span></span><br><span><var>IM</var><span class="hyp-type"><b>: </b><span>index ‚Üí VLSM message</span></span></span><br><span><var>Free</var><span><span class="hyp-body"><b>:= </b><span>free_composite_vlsm IM</span></span><span class="hyp-type"><b>: </b><span>VLSM message</span></span></span></span><br><span><var>s, s'</var><span class="hyp-type"><b>: </b><span>vstate Free</span></span></span><br><span><var>l</var><span class="hyp-type"><b>: </b><span>vlabel Free</span></span></span><br><span><var>input</var><span class="hyp-type"><b>: </b><span>option message</span></span></span><br><span><var>i</var><span><span class="hyp-body"><b>:= </b><span>projT1 l</span></span><span class="hyp-type"><b>: </b><span>index</span></span></span></span><br><span><var>Heq</var><span class="hyp-type"><b>: </b><span>s i = s&#39; i</span></span></span><br><span><var>Hprs</var><span class="hyp-type"><b>: </b><span>valid_state_prop Free s&#39;</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="kr">let</span> (<span class="nv">dest</span>, output) := vtransition Free l (s, input) <span class="kr">in</span>
<span class="kr">let</span> (<span class="nv">dest&#39;</span>, output&#39;) :=
  vtransition Free l (s&#39;, input) <span class="kr">in</span>
output = output&#39; ‚àß dest i = dest&#39; i</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="Composition-v-chk192" style="display: none" type="checkbox"><label class="alectryon-input" for="Composition-v-chk192"><span class="nb">unfold</span> vtransition.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>message, index</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>EqDecision0</var><span class="hyp-type"><b>: </b><span>EqDecision index</span></span></span><br><span><var>IM</var><span class="hyp-type"><b>: </b><span>index ‚Üí VLSM message</span></span></span><br><span><var>Free</var><span><span class="hyp-body"><b>:= </b><span>free_composite_vlsm IM</span></span><span class="hyp-type"><b>: </b><span>VLSM message</span></span></span></span><br><span><var>s, s'</var><span class="hyp-type"><b>: </b><span>vstate Free</span></span></span><br><span><var>l</var><span class="hyp-type"><b>: </b><span>vlabel Free</span></span></span><br><span><var>input</var><span class="hyp-type"><b>: </b><span>option message</span></span></span><br><span><var>i</var><span><span class="hyp-body"><b>:= </b><span>projT1 l</span></span><span class="hyp-type"><b>: </b><span>index</span></span></span></span><br><span><var>Heq</var><span class="hyp-type"><b>: </b><span>s i = s&#39; i</span></span></span><br><span><var>Hprs</var><span class="hyp-type"><b>: </b><span>valid_state_prop Free s&#39;</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="kr">let</span> (<span class="nv">dest</span>, output) := transition l (s, input) <span class="kr">in</span>
<span class="kr">let</span> (<span class="nv">dest&#39;</span>, output&#39;) := transition l (s&#39;, input) <span class="kr">in</span>
output = output&#39; ‚àß dest i = dest&#39; i</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="Composition-v-chk193" style="display: none" type="checkbox"><label class="alectryon-input" for="Composition-v-chk193"><span class="nb">unfold</span> transition.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>message, index</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>EqDecision0</var><span class="hyp-type"><b>: </b><span>EqDecision index</span></span></span><br><span><var>IM</var><span class="hyp-type"><b>: </b><span>index ‚Üí VLSM message</span></span></span><br><span><var>Free</var><span><span class="hyp-body"><b>:= </b><span>free_composite_vlsm IM</span></span><span class="hyp-type"><b>: </b><span>VLSM message</span></span></span></span><br><span><var>s, s'</var><span class="hyp-type"><b>: </b><span>vstate Free</span></span></span><br><span><var>l</var><span class="hyp-type"><b>: </b><span>vlabel Free</span></span></span><br><span><var>input</var><span class="hyp-type"><b>: </b><span>option message</span></span></span><br><span><var>i</var><span><span class="hyp-body"><b>:= </b><span>projT1 l</span></span><span class="hyp-type"><b>: </b><span>index</span></span></span></span><br><span><var>Heq</var><span class="hyp-type"><b>: </b><span>s i = s&#39; i</span></span></span><br><span><var>Hprs</var><span class="hyp-type"><b>: </b><span>valid_state_prop Free s&#39;</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="kr">let</span> (<span class="nv">dest</span>, output) :=
  (<span class="kr">let</span>
     (<span class="nv">initial_state_prop</span>, initial_state, _,
      initial_message_prop, initial_message,
      transition, _) := machine Free <span class="kr">in</span>
   transition) l (s, input) <span class="kr">in</span>
<span class="kr">let</span> (<span class="nv">dest&#39;</span>, output&#39;) :=
  (<span class="kr">let</span>
     (<span class="nv">initial_state_prop</span>, initial_state, _,
      initial_message_prop, initial_message,
      transition, _) := machine Free <span class="kr">in</span>
   transition) l (s&#39;, input) <span class="kr">in</span>
output = output&#39; ‚àß dest i = dest&#39; i</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="Composition-v-chk194" style="display: none" type="checkbox"><label class="alectryon-input" for="Composition-v-chk194"><span class="nb">destruct</span> l; <span class="nb">simpl</span>.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>message, index</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>EqDecision0</var><span class="hyp-type"><b>: </b><span>EqDecision index</span></span></span><br><span><var>IM</var><span class="hyp-type"><b>: </b><span>index ‚Üí VLSM message</span></span></span><br><span><var>Free</var><span><span class="hyp-body"><b>:= </b><span>free_composite_vlsm IM</span></span><span class="hyp-type"><b>: </b><span>VLSM message</span></span></span></span><br><span><var>s, s'</var><span class="hyp-type"><b>: </b><span>vstate Free</span></span></span><br><span><var>x</var><span class="hyp-type"><b>: </b><span>index</span></span></span><br><span><var>v</var><span class="hyp-type"><b>: </b><span>vlabel (IM x)</span></span></span><br><span><var>input</var><span class="hyp-type"><b>: </b><span>option message</span></span></span><br><span><var>i</var><span><span class="hyp-body"><b>:= </b><span>projT1 (existT x v)</span></span><span class="hyp-type"><b>: </b><span>index</span></span></span></span><br><span><var>Heq</var><span class="hyp-type"><b>: </b><span>s i = s&#39; i</span></span></span><br><span><var>Hprs</var><span class="hyp-type"><b>: </b><span>valid_state_prop Free s&#39;</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="kr">let</span> (<span class="nv">dest</span>, output) :=
  <span class="kr">let</span> (<span class="nv">si&#39;</span>, om&#39;) :=
    vtransition (IM x) v (s x, input) <span class="kr">in</span>
  (state_update IM s x si&#39;, om&#39;) <span class="kr">in</span>
<span class="kr">let</span> (<span class="nv">dest&#39;</span>, output&#39;) :=
  <span class="kr">let</span> (<span class="nv">si&#39;</span>, om&#39;) :=
    vtransition (IM x) v (s&#39; x, input) <span class="kr">in</span>
  (state_update IM s&#39; x si&#39;, om&#39;) <span class="kr">in</span>
output = output&#39; ‚àß dest i = dest&#39; i</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="Composition-v-chk195" style="display: none" type="checkbox"><label class="alectryon-input" for="Composition-v-chk195"><span class="nb">simpl</span> <span class="kr">in</span> i.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>message, index</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>EqDecision0</var><span class="hyp-type"><b>: </b><span>EqDecision index</span></span></span><br><span><var>IM</var><span class="hyp-type"><b>: </b><span>index ‚Üí VLSM message</span></span></span><br><span><var>Free</var><span><span class="hyp-body"><b>:= </b><span>free_composite_vlsm IM</span></span><span class="hyp-type"><b>: </b><span>VLSM message</span></span></span></span><br><span><var>s, s'</var><span class="hyp-type"><b>: </b><span>vstate Free</span></span></span><br><span><var>x</var><span class="hyp-type"><b>: </b><span>index</span></span></span><br><span><var>v</var><span class="hyp-type"><b>: </b><span>vlabel (IM x)</span></span></span><br><span><var>input</var><span class="hyp-type"><b>: </b><span>option message</span></span></span><br><span><var>i</var><span><span class="hyp-body"><b>:= </b><span>x</span></span><span class="hyp-type"><b>: </b><span>index</span></span></span></span><br><span><var>Heq</var><span class="hyp-type"><b>: </b><span>s i = s&#39; i</span></span></span><br><span><var>Hprs</var><span class="hyp-type"><b>: </b><span>valid_state_prop Free s&#39;</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="kr">let</span> (<span class="nv">dest</span>, output) :=
  <span class="kr">let</span> (<span class="nv">si&#39;</span>, om&#39;) :=
    vtransition (IM x) v (s x, input) <span class="kr">in</span>
  (state_update IM s x si&#39;, om&#39;) <span class="kr">in</span>
<span class="kr">let</span> (<span class="nv">dest&#39;</span>, output&#39;) :=
  <span class="kr">let</span> (<span class="nv">si&#39;</span>, om&#39;) :=
    vtransition (IM x) v (s&#39; x, input) <span class="kr">in</span>
  (state_update IM s&#39; x si&#39;, om&#39;) <span class="kr">in</span>
output = output&#39; ‚àß dest i = dest&#39; i</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="Composition-v-chk196" style="display: none" type="checkbox"><label class="alectryon-input" for="Composition-v-chk196"><span class="nb">unfold</span> i <span class="kr">in</span> Heq.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>message, index</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>EqDecision0</var><span class="hyp-type"><b>: </b><span>EqDecision index</span></span></span><br><span><var>IM</var><span class="hyp-type"><b>: </b><span>index ‚Üí VLSM message</span></span></span><br><span><var>Free</var><span><span class="hyp-body"><b>:= </b><span>free_composite_vlsm IM</span></span><span class="hyp-type"><b>: </b><span>VLSM message</span></span></span></span><br><span><var>s, s'</var><span class="hyp-type"><b>: </b><span>vstate Free</span></span></span><br><span><var>x</var><span class="hyp-type"><b>: </b><span>index</span></span></span><br><span><var>v</var><span class="hyp-type"><b>: </b><span>vlabel (IM x)</span></span></span><br><span><var>input</var><span class="hyp-type"><b>: </b><span>option message</span></span></span><br><span><var>i</var><span><span class="hyp-body"><b>:= </b><span>x</span></span><span class="hyp-type"><b>: </b><span>index</span></span></span></span><br><span><var>Heq</var><span class="hyp-type"><b>: </b><span>s x = s&#39; x</span></span></span><br><span><var>Hprs</var><span class="hyp-type"><b>: </b><span>valid_state_prop Free s&#39;</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="kr">let</span> (<span class="nv">dest</span>, output) :=
  <span class="kr">let</span> (<span class="nv">si&#39;</span>, om&#39;) :=
    vtransition (IM x) v (s x, input) <span class="kr">in</span>
  (state_update IM s x si&#39;, om&#39;) <span class="kr">in</span>
<span class="kr">let</span> (<span class="nv">dest&#39;</span>, output&#39;) :=
  <span class="kr">let</span> (<span class="nv">si&#39;</span>, om&#39;) :=
    vtransition (IM x) v (s&#39; x, input) <span class="kr">in</span>
  (state_update IM s&#39; x si&#39;, om&#39;) <span class="kr">in</span>
output = output&#39; ‚àß dest i = dest&#39; i</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="Composition-v-chk197" style="display: none" type="checkbox"><label class="alectryon-input" for="Composition-v-chk197"><span class="nb">rewrite</span> Heq.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>message, index</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>EqDecision0</var><span class="hyp-type"><b>: </b><span>EqDecision index</span></span></span><br><span><var>IM</var><span class="hyp-type"><b>: </b><span>index ‚Üí VLSM message</span></span></span><br><span><var>Free</var><span><span class="hyp-body"><b>:= </b><span>free_composite_vlsm IM</span></span><span class="hyp-type"><b>: </b><span>VLSM message</span></span></span></span><br><span><var>s, s'</var><span class="hyp-type"><b>: </b><span>vstate Free</span></span></span><br><span><var>x</var><span class="hyp-type"><b>: </b><span>index</span></span></span><br><span><var>v</var><span class="hyp-type"><b>: </b><span>vlabel (IM x)</span></span></span><br><span><var>input</var><span class="hyp-type"><b>: </b><span>option message</span></span></span><br><span><var>i</var><span><span class="hyp-body"><b>:= </b><span>x</span></span><span class="hyp-type"><b>: </b><span>index</span></span></span></span><br><span><var>Heq</var><span class="hyp-type"><b>: </b><span>s x = s&#39; x</span></span></span><br><span><var>Hprs</var><span class="hyp-type"><b>: </b><span>valid_state_prop Free s&#39;</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="kr">let</span> (<span class="nv">dest</span>, output) :=
  <span class="kr">let</span> (<span class="nv">si&#39;</span>, om&#39;) :=
    vtransition (IM x) v (s&#39; x, input) <span class="kr">in</span>
  (state_update IM s x si&#39;, om&#39;) <span class="kr">in</span>
<span class="kr">let</span> (<span class="nv">dest&#39;</span>, output&#39;) :=
  <span class="kr">let</span> (<span class="nv">si&#39;</span>, om&#39;) :=
    vtransition (IM x) v (s&#39; x, input) <span class="kr">in</span>
  (state_update IM s&#39; x si&#39;, om&#39;) <span class="kr">in</span>
output = output&#39; ‚àß dest i = dest&#39; i</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="Composition-v-chk198" style="display: none" type="checkbox"><label class="alectryon-input" for="Composition-v-chk198"><span class="nb">destruct</span> (vtransition (IM x) v (s&#39; x, input)).</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>message, index</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>EqDecision0</var><span class="hyp-type"><b>: </b><span>EqDecision index</span></span></span><br><span><var>IM</var><span class="hyp-type"><b>: </b><span>index ‚Üí VLSM message</span></span></span><br><span><var>Free</var><span><span class="hyp-body"><b>:= </b><span>free_composite_vlsm IM</span></span><span class="hyp-type"><b>: </b><span>VLSM message</span></span></span></span><br><span><var>s, s'</var><span class="hyp-type"><b>: </b><span>vstate Free</span></span></span><br><span><var>x</var><span class="hyp-type"><b>: </b><span>index</span></span></span><br><span><var>v</var><span class="hyp-type"><b>: </b><span>vlabel (IM x)</span></span></span><br><span><var>input</var><span class="hyp-type"><b>: </b><span>option message</span></span></span><br><span><var>i</var><span><span class="hyp-body"><b>:= </b><span>x</span></span><span class="hyp-type"><b>: </b><span>index</span></span></span></span><br><span><var>Heq</var><span class="hyp-type"><b>: </b><span>s x = s&#39; x</span></span></span><br><span><var>Hprs</var><span class="hyp-type"><b>: </b><span>valid_state_prop Free s&#39;</span></span></span><br><span><var>s0</var><span class="hyp-type"><b>: </b><span>state</span></span></span><br><span><var>o</var><span class="hyp-type"><b>: </b><span>option message</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">o = o
‚àß state_update IM s x s0 i = state_update IM s&#39; x s0 i</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="Composition-v-chk199" style="display: none" type="checkbox"><label class="alectryon-input" for="Composition-v-chk199"><span class="nb">split</span>; [<span class="bp">done</span>|].</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>message, index</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>EqDecision0</var><span class="hyp-type"><b>: </b><span>EqDecision index</span></span></span><br><span><var>IM</var><span class="hyp-type"><b>: </b><span>index ‚Üí VLSM message</span></span></span><br><span><var>Free</var><span><span class="hyp-body"><b>:= </b><span>free_composite_vlsm IM</span></span><span class="hyp-type"><b>: </b><span>VLSM message</span></span></span></span><br><span><var>s, s'</var><span class="hyp-type"><b>: </b><span>vstate Free</span></span></span><br><span><var>x</var><span class="hyp-type"><b>: </b><span>index</span></span></span><br><span><var>v</var><span class="hyp-type"><b>: </b><span>vlabel (IM x)</span></span></span><br><span><var>input</var><span class="hyp-type"><b>: </b><span>option message</span></span></span><br><span><var>i</var><span><span class="hyp-body"><b>:= </b><span>x</span></span><span class="hyp-type"><b>: </b><span>index</span></span></span></span><br><span><var>Heq</var><span class="hyp-type"><b>: </b><span>s x = s&#39; x</span></span></span><br><span><var>Hprs</var><span class="hyp-type"><b>: </b><span>valid_state_prop Free s&#39;</span></span></span><br><span><var>s0</var><span class="hyp-type"><b>: </b><span>state</span></span></span><br><span><var>o</var><span class="hyp-type"><b>: </b><span>option message</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">state_update IM s x s0 i = state_update IM s&#39; x s0 i</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="Composition-v-chk19a" style="display: none" type="checkbox"><label class="alectryon-input" for="Composition-v-chk19a"><span class="nb">unfold</span> i.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>message, index</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>EqDecision0</var><span class="hyp-type"><b>: </b><span>EqDecision index</span></span></span><br><span><var>IM</var><span class="hyp-type"><b>: </b><span>index ‚Üí VLSM message</span></span></span><br><span><var>Free</var><span><span class="hyp-body"><b>:= </b><span>free_composite_vlsm IM</span></span><span class="hyp-type"><b>: </b><span>VLSM message</span></span></span></span><br><span><var>s, s'</var><span class="hyp-type"><b>: </b><span>vstate Free</span></span></span><br><span><var>x</var><span class="hyp-type"><b>: </b><span>index</span></span></span><br><span><var>v</var><span class="hyp-type"><b>: </b><span>vlabel (IM x)</span></span></span><br><span><var>input</var><span class="hyp-type"><b>: </b><span>option message</span></span></span><br><span><var>i</var><span><span class="hyp-body"><b>:= </b><span>x</span></span><span class="hyp-type"><b>: </b><span>index</span></span></span></span><br><span><var>Heq</var><span class="hyp-type"><b>: </b><span>s x = s&#39; x</span></span></span><br><span><var>Hprs</var><span class="hyp-type"><b>: </b><span>valid_state_prop Free s&#39;</span></span></span><br><span><var>s0</var><span class="hyp-type"><b>: </b><span>state</span></span></span><br><span><var>o</var><span class="hyp-type"><b>: </b><span>option message</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">state_update IM s x s0 x = state_update IM s&#39; x s0 x</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><span class="alectryon-input"><span class="bp">by</span> state_update_simpl.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Qed</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
</span><span class="alectryon-sentence"><input class="alectryon-toggle" id="Composition-v-chk19b" style="display: none" type="checkbox"><label class="alectryon-input" for="Composition-v-chk19b"><span class="kn">Lemma</span> <span class="nf">relevant_components_one</span>
  (<span class="nv">s</span> <span class="nv">s&#39;</span> : vstate Free)
  (<span class="nv">Hprs&#39;</span> : valid_state_prop Free s&#39;)
  (<span class="nv">ai</span> : vplan_item Free)
  (<span class="nv">i</span> := projT1 (label_a ai))
  (<span class="nv">Heq</span> : (s i) = (s&#39; i))
  (<span class="nv">Hpr</span> : finite_valid_plan_from Free s [ai]) :
  <span class="kr">let</span> <span class="nv">res&#39;</span> := snd (apply_plan Free s&#39; [ai]) <span class="kr">in</span>
  <span class="kr">let</span> <span class="nv">res</span> := snd (apply_plan Free s [ai]) <span class="kr">in</span>
  finite_valid_plan_from Free s&#39; [ai] /\
  (res&#39; i) = res i.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>message, index</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>EqDecision0</var><span class="hyp-type"><b>: </b><span>EqDecision index</span></span></span><br><span><var>IM</var><span class="hyp-type"><b>: </b><span>index ‚Üí VLSM message</span></span></span><br><span><var>Free</var><span><span class="hyp-body"><b>:= </b><span>free_composite_vlsm IM</span></span><span class="hyp-type"><b>: </b><span>VLSM message</span></span></span></span><br><span><var>s, s'</var><span class="hyp-type"><b>: </b><span>vstate Free</span></span></span><br><span><var>Hprs'</var><span class="hyp-type"><b>: </b><span>valid_state_prop Free s&#39;</span></span></span><br><span><var>ai</var><span class="hyp-type"><b>: </b><span>vplan_item Free</span></span></span><br><span><var>i</var><span><span class="hyp-body"><b>:= </b><span>projT1 (label_a ai)</span></span><span class="hyp-type"><b>: </b><span>index</span></span></span></span><br><span><var>Heq</var><span class="hyp-type"><b>: </b><span>s i = s&#39; i</span></span></span><br><span><var>Hpr</var><span class="hyp-type"><b>: </b><span>finite_valid_plan_from Free s [ai]</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="kr">let</span> <span class="nv">res&#39;</span> := (apply_plan Free s&#39; [ai]).<span class="mi">2</span> <span class="kr">in</span>
<span class="kr">let</span> <span class="nv">res</span> := (apply_plan Free s [ai]).<span class="mi">2</span> <span class="kr">in</span>
finite_valid_plan_from Free s&#39; [ai] ‚àß res&#39; i = res i</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="Composition-v-chk19c" style="display: none" type="checkbox"><label class="alectryon-input" for="Composition-v-chk19c"><span class="kn">Proof</span>.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>message, index</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>EqDecision0</var><span class="hyp-type"><b>: </b><span>EqDecision index</span></span></span><br><span><var>IM</var><span class="hyp-type"><b>: </b><span>index ‚Üí VLSM message</span></span></span><br><span><var>Free</var><span><span class="hyp-body"><b>:= </b><span>free_composite_vlsm IM</span></span><span class="hyp-type"><b>: </b><span>VLSM message</span></span></span></span><br><span><var>s, s'</var><span class="hyp-type"><b>: </b><span>vstate Free</span></span></span><br><span><var>Hprs'</var><span class="hyp-type"><b>: </b><span>valid_state_prop Free s&#39;</span></span></span><br><span><var>ai</var><span class="hyp-type"><b>: </b><span>vplan_item Free</span></span></span><br><span><var>i</var><span><span class="hyp-body"><b>:= </b><span>projT1 (label_a ai)</span></span><span class="hyp-type"><b>: </b><span>index</span></span></span></span><br><span><var>Heq</var><span class="hyp-type"><b>: </b><span>s i = s&#39; i</span></span></span><br><span><var>Hpr</var><span class="hyp-type"><b>: </b><span>finite_valid_plan_from Free s [ai]</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="kr">let</span> <span class="nv">res&#39;</span> := (apply_plan Free s&#39; [ai]).<span class="mi">2</span> <span class="kr">in</span>
<span class="kr">let</span> <span class="nv">res</span> := (apply_plan Free s [ai]).<span class="mi">2</span> <span class="kr">in</span>
finite_valid_plan_from Free s&#39; [ai] ‚àß res&#39; i = res i</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="Composition-v-chk19d" style="display: none" type="checkbox"><label class="alectryon-input" for="Composition-v-chk19d"><span class="nb">simpl</span>.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>message, index</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>EqDecision0</var><span class="hyp-type"><b>: </b><span>EqDecision index</span></span></span><br><span><var>IM</var><span class="hyp-type"><b>: </b><span>index ‚Üí VLSM message</span></span></span><br><span><var>Free</var><span><span class="hyp-body"><b>:= </b><span>free_composite_vlsm IM</span></span><span class="hyp-type"><b>: </b><span>VLSM message</span></span></span></span><br><span><var>s, s'</var><span class="hyp-type"><b>: </b><span>vstate Free</span></span></span><br><span><var>Hprs'</var><span class="hyp-type"><b>: </b><span>valid_state_prop Free s&#39;</span></span></span><br><span><var>ai</var><span class="hyp-type"><b>: </b><span>vplan_item Free</span></span></span><br><span><var>i</var><span><span class="hyp-body"><b>:= </b><span>projT1 (label_a ai)</span></span><span class="hyp-type"><b>: </b><span>index</span></span></span></span><br><span><var>Heq</var><span class="hyp-type"><b>: </b><span>s i = s&#39; i</span></span></span><br><span><var>Hpr</var><span class="hyp-type"><b>: </b><span>finite_valid_plan_from Free s [ai]</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">finite_valid_plan_from Free s&#39; [ai]
‚àß (apply_plan Free s&#39; [ai]).<span class="mi">2</span> i =
  (apply_plan Free s [ai]).<span class="mi">2</span> i</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="Composition-v-chk19e" style="display: none" type="checkbox"><label class="alectryon-input" for="Composition-v-chk19e"><span class="nb">unfold</span> finite_valid_plan_from <span class="kr">in</span> *.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>message, index</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>EqDecision0</var><span class="hyp-type"><b>: </b><span>EqDecision index</span></span></span><br><span><var>IM</var><span class="hyp-type"><b>: </b><span>index ‚Üí VLSM message</span></span></span><br><span><var>Free</var><span><span class="hyp-body"><b>:= </b><span>free_composite_vlsm IM</span></span><span class="hyp-type"><b>: </b><span>VLSM message</span></span></span></span><br><span><var>s, s'</var><span class="hyp-type"><b>: </b><span>vstate Free</span></span></span><br><span><var>Hprs'</var><span class="hyp-type"><b>: </b><span>valid_state_prop Free s&#39;</span></span></span><br><span><var>ai</var><span class="hyp-type"><b>: </b><span>vplan_item Free</span></span></span><br><span><var>i</var><span><span class="hyp-body"><b>:= </b><span>projT1 (label_a ai)</span></span><span class="hyp-type"><b>: </b><span>index</span></span></span></span><br><span><var>Heq</var><span class="hyp-type"><b>: </b><span>s i = s&#39; i</span></span></span><br><span><var>Hpr</var><span class="hyp-type"><b>: </b><span>finite_valid_trace_from Free s
  (apply_plan Free s [ai]).<span class="mi">1</span></span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">finite_valid_trace_from Free s&#39;
  (apply_plan Free s&#39; [ai]).<span class="mi">1</span>
‚àß (apply_plan Free s&#39; [ai]).<span class="mi">2</span> i =
  (apply_plan Free s [ai]).<span class="mi">2</span> i</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="Composition-v-chk19f" style="display: none" type="checkbox"><label class="alectryon-input" for="Composition-v-chk19f"><span class="nb">unfold</span> apply_plan, _apply_plan <span class="kr">in</span> *.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>message, index</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>EqDecision0</var><span class="hyp-type"><b>: </b><span>EqDecision index</span></span></span><br><span><var>IM</var><span class="hyp-type"><b>: </b><span>index ‚Üí VLSM message</span></span></span><br><span><var>Free</var><span><span class="hyp-body"><b>:= </b><span>free_composite_vlsm IM</span></span><span class="hyp-type"><b>: </b><span>VLSM message</span></span></span></span><br><span><var>s, s'</var><span class="hyp-type"><b>: </b><span>vstate Free</span></span></span><br><span><var>Hprs'</var><span class="hyp-type"><b>: </b><span>valid_state_prop Free s&#39;</span></span></span><br><span><var>ai</var><span class="hyp-type"><b>: </b><span>vplan_item Free</span></span></span><br><span><var>i</var><span><span class="hyp-body"><b>:= </b><span>projT1 (label_a ai)</span></span><span class="hyp-type"><b>: </b><span>index</span></span></span></span><br><span><var>Heq</var><span class="hyp-type"><b>: </b><span>s i = s&#39; i</span></span></span><br><span><var>Hpr</var><span class="hyp-type"><b>: </b><span>finite_valid_trace_from Free s
  (<span class="kr">let</span> (<span class="nv">final</span>, items) :=
     foldr _apply_plan_folder (s, []) (rev [ai]) <span class="kr">in</span>
   (rev items, final)).<span class="mi">1</span></span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">finite_valid_trace_from Free s&#39;
  (<span class="kr">let</span> (<span class="nv">final</span>, items) :=
     foldr _apply_plan_folder (s&#39;, []) (rev [ai]) <span class="kr">in</span>
   (rev items, final)).<span class="mi">1</span>
‚àß (<span class="kr">let</span> (<span class="nv">final</span>, items) :=
     foldr _apply_plan_folder (s&#39;, []) (rev [ai]) <span class="kr">in</span>
   (rev items, final)).<span class="mi">2</span> i =
  (<span class="kr">let</span> (<span class="nv">final</span>, items) :=
     foldr _apply_plan_folder (s, []) (rev [ai]) <span class="kr">in</span>
   (rev items, final)).<span class="mi">2</span> i</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="Composition-v-chk1a0" style="display: none" type="checkbox"><label class="alectryon-input" for="Composition-v-chk1a0"><span class="nb">destruct</span> ai; <span class="nb">simpl</span> <span class="kr">in</span> *.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>message, index</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>EqDecision0</var><span class="hyp-type"><b>: </b><span>EqDecision index</span></span></span><br><span><var>IM</var><span class="hyp-type"><b>: </b><span>index ‚Üí VLSM message</span></span></span><br><span><var>Free</var><span><span class="hyp-body"><b>:= </b><span>free_composite_vlsm IM</span></span><span class="hyp-type"><b>: </b><span>VLSM message</span></span></span></span><br><span><var>s, s'</var><span class="hyp-type"><b>: </b><span>vstate Free</span></span></span><br><span><var>Hprs'</var><span class="hyp-type"><b>: </b><span>valid_state_prop Free s&#39;</span></span></span><br><span><var>label_a</var><span class="hyp-type"><b>: </b><span>composite_label IM</span></span></span><br><span><var>input_a</var><span class="hyp-type"><b>: </b><span>option message</span></span></span><br><span><var>i</var><span><span class="hyp-body"><b>:= </b><span>projT1 label_a</span></span><span class="hyp-type"><b>: </b><span>index</span></span></span></span><br><span><var>Heq</var><span class="hyp-type"><b>: </b><span>s i = s&#39; i</span></span></span><br><span><var>Hpr</var><span class="hyp-type"><b>: </b><span>finite_valid_trace_from Free s
  (<span class="kr">let</span> (<span class="nv">final</span>, items) :=
     <span class="kr">let</span> (<span class="nv">dest</span>, out) :=
       vtransition Free label_a (s, input_a) <span class="kr">in</span>
     (dest,
     [{|
        l := label_a;
        input := input_a;
        destination := dest;
        output := out
      |}]) <span class="kr">in</span>
   (rev items, final)).<span class="mi">1</span></span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">finite_valid_trace_from Free s&#39;
  (<span class="kr">let</span> (<span class="nv">final</span>, items) :=
     <span class="kr">let</span> (<span class="nv">dest</span>, out) :=
       vtransition Free label_a (s&#39;, input_a) <span class="kr">in</span>
     (dest,
     [{|
        l := label_a;
        input := input_a;
        destination := dest;
        output := out
      |}]) <span class="kr">in</span>
   (rev items, final)).<span class="mi">1</span>
‚àß (<span class="kr">let</span> (<span class="nv">final</span>, items) :=
     <span class="kr">let</span> (<span class="nv">dest</span>, out) :=
       vtransition Free label_a (s&#39;, input_a) <span class="kr">in</span>
     (dest,
     [{|
        l := label_a;
        input := input_a;
        destination := dest;
        output := out
      |}]) <span class="kr">in</span>
   (rev items, final)).<span class="mi">2</span> i =
  (<span class="kr">let</span> (<span class="nv">final</span>, items) :=
     <span class="kr">let</span> (<span class="nv">dest</span>, out) :=
       vtransition Free label_a (s, input_a) <span class="kr">in</span>
     (dest,
     [{|
        l := label_a;
        input := input_a;
        destination := dest;
        output := out
      |}]) <span class="kr">in</span>
   (rev items, final)).<span class="mi">2</span> i</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="Composition-v-chk1a1" style="display: none" type="checkbox"><label class="alectryon-input" for="Composition-v-chk1a1"><span class="kr">match goal with</span>
  |- <span class="kp">context</span> [<span class="kr">let</span> (<span class="nv">_</span>, _) := <span class="kr">let</span> (<span class="nv">_</span>, _) := <span class="nl">?t</span> <span class="kr">in</span> _ <span class="kr">in</span> _] =&gt;
    <span class="nb">destruct</span> t <span class="nb">eqn</span> : eq_trans&#39;
  <span class="kr">end</span>.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>message, index</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>EqDecision0</var><span class="hyp-type"><b>: </b><span>EqDecision index</span></span></span><br><span><var>IM</var><span class="hyp-type"><b>: </b><span>index ‚Üí VLSM message</span></span></span><br><span><var>Free</var><span><span class="hyp-body"><b>:= </b><span>free_composite_vlsm IM</span></span><span class="hyp-type"><b>: </b><span>VLSM message</span></span></span></span><br><span><var>s, s'</var><span class="hyp-type"><b>: </b><span>vstate Free</span></span></span><br><span><var>Hprs'</var><span class="hyp-type"><b>: </b><span>valid_state_prop Free s&#39;</span></span></span><br><span><var>label_a</var><span class="hyp-type"><b>: </b><span>composite_label IM</span></span></span><br><span><var>input_a</var><span class="hyp-type"><b>: </b><span>option message</span></span></span><br><span><var>i</var><span><span class="hyp-body"><b>:= </b><span>projT1 label_a</span></span><span class="hyp-type"><b>: </b><span>index</span></span></span></span><br><span><var>Heq</var><span class="hyp-type"><b>: </b><span>s i = s&#39; i</span></span></span><br><span><var>Hpr</var><span class="hyp-type"><b>: </b><span>finite_valid_trace_from Free s
  (<span class="kr">let</span> (<span class="nv">final</span>, items) :=
     <span class="kr">let</span> (<span class="nv">dest</span>, out) :=
       vtransition Free label_a (s, input_a) <span class="kr">in</span>
     (dest,
     [{|
        l := label_a;
        input := input_a;
        destination := dest;
        output := out
      |}]) <span class="kr">in</span>
   (rev items, final)).<span class="mi">1</span></span></span></span><br><span><var>s0</var><span class="hyp-type"><b>: </b><span>state</span></span></span><br><span><var>o</var><span class="hyp-type"><b>: </b><span>option message</span></span></span><br><span><var>eq_trans'</var><span class="hyp-type"><b>: </b><span>vtransition Free label_a (s&#39;, input_a) =
(s0, o)</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">finite_valid_trace_from Free s&#39;
  (rev
     [{|
        l := label_a;
        input := input_a;
        destination := s0;
        output := o
      |}], s0).<span class="mi">1</span>
‚àß (rev
     [{|
        l := label_a;
        input := input_a;
        destination := s0;
        output := o
      |}], s0).<span class="mi">2</span> i =
  (<span class="kr">let</span> (<span class="nv">final</span>, items) :=
     <span class="kr">let</span> (<span class="nv">dest</span>, out) :=
       vtransition Free label_a (s, input_a) <span class="kr">in</span>
     (dest,
     [{|
        l := label_a;
        input := input_a;
        destination := dest;
        output := out
      |}]) <span class="kr">in</span>
   (rev items, final)).<span class="mi">2</span> i</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="Composition-v-chk1a2" style="display: none" type="checkbox"><label class="alectryon-input" for="Composition-v-chk1a2"><span class="kr">match goal with</span>
  |- <span class="kp">context</span> [<span class="kr">let</span> (<span class="nv">_</span>, _) := <span class="kr">let</span> (<span class="nv">_</span>, _) := <span class="nl">?t</span> <span class="kr">in</span> _ <span class="kr">in</span> _] =&gt;
    <span class="nb">destruct</span> t <span class="nb">eqn</span> : eq_trans
  <span class="kr">end</span>.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>message, index</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>EqDecision0</var><span class="hyp-type"><b>: </b><span>EqDecision index</span></span></span><br><span><var>IM</var><span class="hyp-type"><b>: </b><span>index ‚Üí VLSM message</span></span></span><br><span><var>Free</var><span><span class="hyp-body"><b>:= </b><span>free_composite_vlsm IM</span></span><span class="hyp-type"><b>: </b><span>VLSM message</span></span></span></span><br><span><var>s, s'</var><span class="hyp-type"><b>: </b><span>vstate Free</span></span></span><br><span><var>Hprs'</var><span class="hyp-type"><b>: </b><span>valid_state_prop Free s&#39;</span></span></span><br><span><var>label_a</var><span class="hyp-type"><b>: </b><span>composite_label IM</span></span></span><br><span><var>input_a</var><span class="hyp-type"><b>: </b><span>option message</span></span></span><br><span><var>i</var><span><span class="hyp-body"><b>:= </b><span>projT1 label_a</span></span><span class="hyp-type"><b>: </b><span>index</span></span></span></span><br><span><var>Heq</var><span class="hyp-type"><b>: </b><span>s i = s&#39; i</span></span></span><br><span><var>s1</var><span class="hyp-type"><b>: </b><span>state</span></span></span><br><span><var>o0</var><span class="hyp-type"><b>: </b><span>option message</span></span></span><br><span><var>eq_trans</var><span class="hyp-type"><b>: </b><span>vtransition Free label_a (s, input_a) =
(s1, o0)</span></span></span><br><span><var>Hpr</var><span class="hyp-type"><b>: </b><span>finite_valid_trace_from Free s
  (rev
     [{|
        l := label_a;
        input := input_a;
        destination := s1;
        output := o0
      |}], s1).<span class="mi">1</span></span></span></span><br><span><var>s0</var><span class="hyp-type"><b>: </b><span>state</span></span></span><br><span><var>o</var><span class="hyp-type"><b>: </b><span>option message</span></span></span><br><span><var>eq_trans'</var><span class="hyp-type"><b>: </b><span>vtransition Free label_a (s&#39;, input_a) =
(s0, o)</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">finite_valid_trace_from Free s&#39;
  (rev
     [{|
        l := label_a;
        input := input_a;
        destination := s0;
        output := o
      |}], s0).<span class="mi">1</span>
‚àß (rev
     [{|
        l := label_a;
        input := input_a;
        destination := s0;
        output := o
      |}], s0).<span class="mi">2</span> i =
  (rev
     [{|
        l := label_a;
        input := input_a;
        destination := s1;
        output := o0
      |}], s1).<span class="mi">2</span> i</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="Composition-v-chk1a3" style="display: none" type="checkbox"><label class="alectryon-input" for="Composition-v-chk1a3"><span class="nb">inversion</span> Hpr; <span class="nb">subst</span>.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>message, index</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>EqDecision0</var><span class="hyp-type"><b>: </b><span>EqDecision index</span></span></span><br><span><var>IM</var><span class="hyp-type"><b>: </b><span>index ‚Üí VLSM message</span></span></span><br><span><var>Free</var><span><span class="hyp-body"><b>:= </b><span>free_composite_vlsm IM</span></span><span class="hyp-type"><b>: </b><span>VLSM message</span></span></span></span><br><span><var>s, s'</var><span class="hyp-type"><b>: </b><span>vstate Free</span></span></span><br><span><var>Hprs'</var><span class="hyp-type"><b>: </b><span>valid_state_prop Free s&#39;</span></span></span><br><span><var>label_a</var><span class="hyp-type"><b>: </b><span>composite_label IM</span></span></span><br><span><var>input_a</var><span class="hyp-type"><b>: </b><span>option message</span></span></span><br><span><var>i</var><span><span class="hyp-body"><b>:= </b><span>projT1 label_a</span></span><span class="hyp-type"><b>: </b><span>index</span></span></span></span><br><span><var>Heq</var><span class="hyp-type"><b>: </b><span>s i = s&#39; i</span></span></span><br><span><var>s1</var><span class="hyp-type"><b>: </b><span>state</span></span></span><br><span><var>o0</var><span class="hyp-type"><b>: </b><span>option message</span></span></span><br><span><var>eq_trans</var><span class="hyp-type"><b>: </b><span>vtransition Free label_a (s, input_a) =
(s1, o0)</span></span></span><br><span><var>Hpr</var><span class="hyp-type"><b>: </b><span>finite_valid_trace_from Free s
  (rev
     [{|
        l := label_a;
        input := input_a;
        destination := s1;
        output := o0
      |}], s1).<span class="mi">1</span></span></span></span><br><span><var>s0</var><span class="hyp-type"><b>: </b><span>state</span></span></span><br><span><var>o</var><span class="hyp-type"><b>: </b><span>option message</span></span></span><br><span><var>eq_trans'</var><span class="hyp-type"><b>: </b><span>vtransition Free label_a (s&#39;, input_a) =
(s0, o)</span></span></span><br><span><var>Htl</var><span class="hyp-type"><b>: </b><span>finite_valid_trace_from Free s1 []</span></span></span><br><span><var>Ht</var><span class="hyp-type"><b>: </b><span>input_valid_transition Free label_a 
  (s, input_a) (s1, o0)</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">finite_valid_trace_from Free s&#39;
  (rev
     [{|
        l := label_a;
        input := input_a;
        destination := s0;
        output := o
      |}], s0).<span class="mi">1</span>
‚àß (rev
     [{|
        l := label_a;
        input := input_a;
        destination := s0;
        output := o
      |}], s0).<span class="mi">2</span> i =
  (rev
     [{|
        l := label_a;
        input := input_a;
        destination := s1;
        output := o0
      |}], s1).<span class="mi">2</span> i</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="Composition-v-chk1a4" style="display: none" type="checkbox"><label class="alectryon-input" for="Composition-v-chk1a4"><span class="nb">split</span>.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>message, index</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>EqDecision0</var><span class="hyp-type"><b>: </b><span>EqDecision index</span></span></span><br><span><var>IM</var><span class="hyp-type"><b>: </b><span>index ‚Üí VLSM message</span></span></span><br><span><var>Free</var><span><span class="hyp-body"><b>:= </b><span>free_composite_vlsm IM</span></span><span class="hyp-type"><b>: </b><span>VLSM message</span></span></span></span><br><span><var>s, s'</var><span class="hyp-type"><b>: </b><span>vstate Free</span></span></span><br><span><var>Hprs'</var><span class="hyp-type"><b>: </b><span>valid_state_prop Free s&#39;</span></span></span><br><span><var>label_a</var><span class="hyp-type"><b>: </b><span>composite_label IM</span></span></span><br><span><var>input_a</var><span class="hyp-type"><b>: </b><span>option message</span></span></span><br><span><var>i</var><span><span class="hyp-body"><b>:= </b><span>projT1 label_a</span></span><span class="hyp-type"><b>: </b><span>index</span></span></span></span><br><span><var>Heq</var><span class="hyp-type"><b>: </b><span>s i = s&#39; i</span></span></span><br><span><var>s1</var><span class="hyp-type"><b>: </b><span>state</span></span></span><br><span><var>o0</var><span class="hyp-type"><b>: </b><span>option message</span></span></span><br><span><var>eq_trans</var><span class="hyp-type"><b>: </b><span>vtransition Free label_a (s, input_a) =
(s1, o0)</span></span></span><br><span><var>Hpr</var><span class="hyp-type"><b>: </b><span>finite_valid_trace_from Free s
  (rev
     [{|
        l := label_a;
        input := input_a;
        destination := s1;
        output := o0
      |}], s1).<span class="mi">1</span></span></span></span><br><span><var>s0</var><span class="hyp-type"><b>: </b><span>state</span></span></span><br><span><var>o</var><span class="hyp-type"><b>: </b><span>option message</span></span></span><br><span><var>eq_trans'</var><span class="hyp-type"><b>: </b><span>vtransition Free label_a (s&#39;, input_a) =
(s0, o)</span></span></span><br><span><var>Htl</var><span class="hyp-type"><b>: </b><span>finite_valid_trace_from Free s1 []</span></span></span><br><span><var>Ht</var><span class="hyp-type"><b>: </b><span>input_valid_transition Free label_a 
  (s, input_a) (s1, o0)</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">finite_valid_trace_from Free s&#39;
  (rev
     [{|
        l := label_a;
        input := input_a;
        destination := s0;
        output := o
      |}], s0).<span class="mi">1</span></div></blockquote><div class="alectryon-extra-goals"><input class="alectryon-extra-goal-toggle" id="Composition-v-chk1a5" style="display: none" type="checkbox"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>message, index</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>EqDecision0</var><span class="hyp-type"><b>: </b><span>EqDecision index</span></span></span><br><span><var>IM</var><span class="hyp-type"><b>: </b><span>index ‚Üí VLSM message</span></span></span><br><span><var>Free</var><span><span class="hyp-body"><b>:= </b><span>free_composite_vlsm IM</span></span><span class="hyp-type"><b>: </b><span>VLSM message</span></span></span></span><br><span><var>s, s'</var><span class="hyp-type"><b>: </b><span>vstate Free</span></span></span><br><span><var>Hprs'</var><span class="hyp-type"><b>: </b><span>valid_state_prop Free s&#39;</span></span></span><br><span><var>label_a</var><span class="hyp-type"><b>: </b><span>composite_label IM</span></span></span><br><span><var>input_a</var><span class="hyp-type"><b>: </b><span>option message</span></span></span><br><span><var>i</var><span><span class="hyp-body"><b>:= </b><span>projT1 label_a</span></span><span class="hyp-type"><b>: </b><span>index</span></span></span></span><br><span><var>Heq</var><span class="hyp-type"><b>: </b><span>s i = s&#39; i</span></span></span><br><span><var>s1</var><span class="hyp-type"><b>: </b><span>state</span></span></span><br><span><var>o0</var><span class="hyp-type"><b>: </b><span>option message</span></span></span><br><span><var>eq_trans</var><span class="hyp-type"><b>: </b><span>vtransition Free label_a (s, input_a) =
(s1, o0)</span></span></span><br><span><var>Hpr</var><span class="hyp-type"><b>: </b><span>finite_valid_trace_from Free s
  (rev
     [{|
        l := label_a;
        input := input_a;
        destination := s1;
        output := o0
      |}], s1).<span class="mi">1</span></span></span></span><br><span><var>s0</var><span class="hyp-type"><b>: </b><span>state</span></span></span><br><span><var>o</var><span class="hyp-type"><b>: </b><span>option message</span></span></span><br><span><var>eq_trans'</var><span class="hyp-type"><b>: </b><span>vtransition Free label_a (s&#39;, input_a) =
(s0, o)</span></span></span><br><span><var>Htl</var><span class="hyp-type"><b>: </b><span>finite_valid_trace_from Free s1 []</span></span></span><br><span><var>Ht</var><span class="hyp-type"><b>: </b><span>input_valid_transition Free label_a 
  (s, input_a) (s1, o0)</span></span></span><br></div><label class="goal-separator" for="Composition-v-chk1a5"><hr></label><div class="goal-conclusion">(rev
   [{|
      l := label_a;
      input := input_a;
      destination := s0;
      output := o
    |}], s0).<span class="mi">2</span> i =
(rev
   [{|
      l := label_a;
      input := input_a;
      destination := s1;
      output := o0
    |}], s1).<span class="mi">2</span> i</div></blockquote></div></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="Composition-v-chk1a6" style="display: none" type="checkbox"><label class="alectryon-input" for="Composition-v-chk1a6">-</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>message, index</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>EqDecision0</var><span class="hyp-type"><b>: </b><span>EqDecision index</span></span></span><br><span><var>IM</var><span class="hyp-type"><b>: </b><span>index ‚Üí VLSM message</span></span></span><br><span><var>Free</var><span><span class="hyp-body"><b>:= </b><span>free_composite_vlsm IM</span></span><span class="hyp-type"><b>: </b><span>VLSM message</span></span></span></span><br><span><var>s, s'</var><span class="hyp-type"><b>: </b><span>vstate Free</span></span></span><br><span><var>Hprs'</var><span class="hyp-type"><b>: </b><span>valid_state_prop Free s&#39;</span></span></span><br><span><var>label_a</var><span class="hyp-type"><b>: </b><span>composite_label IM</span></span></span><br><span><var>input_a</var><span class="hyp-type"><b>: </b><span>option message</span></span></span><br><span><var>i</var><span><span class="hyp-body"><b>:= </b><span>projT1 label_a</span></span><span class="hyp-type"><b>: </b><span>index</span></span></span></span><br><span><var>Heq</var><span class="hyp-type"><b>: </b><span>s i = s&#39; i</span></span></span><br><span><var>s1</var><span class="hyp-type"><b>: </b><span>state</span></span></span><br><span><var>o0</var><span class="hyp-type"><b>: </b><span>option message</span></span></span><br><span><var>eq_trans</var><span class="hyp-type"><b>: </b><span>vtransition Free label_a (s, input_a) =
(s1, o0)</span></span></span><br><span><var>Hpr</var><span class="hyp-type"><b>: </b><span>finite_valid_trace_from Free s
  (rev
     [{|
        l := label_a;
        input := input_a;
        destination := s1;
        output := o0
      |}], s1).<span class="mi">1</span></span></span></span><br><span><var>s0</var><span class="hyp-type"><b>: </b><span>state</span></span></span><br><span><var>o</var><span class="hyp-type"><b>: </b><span>option message</span></span></span><br><span><var>eq_trans'</var><span class="hyp-type"><b>: </b><span>vtransition Free label_a (s&#39;, input_a) =
(s0, o)</span></span></span><br><span><var>Htl</var><span class="hyp-type"><b>: </b><span>finite_valid_trace_from Free s1 []</span></span></span><br><span><var>Ht</var><span class="hyp-type"><b>: </b><span>input_valid_transition Free label_a 
  (s, input_a) (s1, o0)</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">finite_valid_trace_from Free s&#39;
  (rev
     [{|
        l := label_a;
        input := input_a;
        destination := s0;
        output := o
      |}], s0).<span class="mi">1</span></div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="Composition-v-chk1a7" style="display: none" type="checkbox"><label class="alectryon-input" for="Composition-v-chk1a7"><span class="nb">assert</span> (Ht&#39; : input_valid_transition Free label_a (s&#39;, input_a) (s0, o)).</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>message, index</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>EqDecision0</var><span class="hyp-type"><b>: </b><span>EqDecision index</span></span></span><br><span><var>IM</var><span class="hyp-type"><b>: </b><span>index ‚Üí VLSM message</span></span></span><br><span><var>Free</var><span><span class="hyp-body"><b>:= </b><span>free_composite_vlsm IM</span></span><span class="hyp-type"><b>: </b><span>VLSM message</span></span></span></span><br><span><var>s, s'</var><span class="hyp-type"><b>: </b><span>vstate Free</span></span></span><br><span><var>Hprs'</var><span class="hyp-type"><b>: </b><span>valid_state_prop Free s&#39;</span></span></span><br><span><var>label_a</var><span class="hyp-type"><b>: </b><span>composite_label IM</span></span></span><br><span><var>input_a</var><span class="hyp-type"><b>: </b><span>option message</span></span></span><br><span><var>i</var><span><span class="hyp-body"><b>:= </b><span>projT1 label_a</span></span><span class="hyp-type"><b>: </b><span>index</span></span></span></span><br><span><var>Heq</var><span class="hyp-type"><b>: </b><span>s i = s&#39; i</span></span></span><br><span><var>s1</var><span class="hyp-type"><b>: </b><span>state</span></span></span><br><span><var>o0</var><span class="hyp-type"><b>: </b><span>option message</span></span></span><br><span><var>eq_trans</var><span class="hyp-type"><b>: </b><span>vtransition Free label_a (s, input_a) =
(s1, o0)</span></span></span><br><span><var>Hpr</var><span class="hyp-type"><b>: </b><span>finite_valid_trace_from Free s
  (rev
     [{|
        l := label_a;
        input := input_a;
        destination := s1;
        output := o0
      |}], s1).<span class="mi">1</span></span></span></span><br><span><var>s0</var><span class="hyp-type"><b>: </b><span>state</span></span></span><br><span><var>o</var><span class="hyp-type"><b>: </b><span>option message</span></span></span><br><span><var>eq_trans'</var><span class="hyp-type"><b>: </b><span>vtransition Free label_a (s&#39;, input_a) =
(s0, o)</span></span></span><br><span><var>Htl</var><span class="hyp-type"><b>: </b><span>finite_valid_trace_from Free s1 []</span></span></span><br><span><var>Ht</var><span class="hyp-type"><b>: </b><span>input_valid_transition Free label_a 
  (s, input_a) (s1, o0)</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">input_valid_transition Free label_a (s&#39;, input_a)
  (s0, o)</div></blockquote><div class="alectryon-extra-goals"><input class="alectryon-extra-goal-toggle" id="Composition-v-chk1a8" style="display: none" type="checkbox"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>message, index</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>EqDecision0</var><span class="hyp-type"><b>: </b><span>EqDecision index</span></span></span><br><span><var>IM</var><span class="hyp-type"><b>: </b><span>index ‚Üí VLSM message</span></span></span><br><span><var>Free</var><span><span class="hyp-body"><b>:= </b><span>free_composite_vlsm IM</span></span><span class="hyp-type"><b>: </b><span>VLSM message</span></span></span></span><br><span><var>s, s'</var><span class="hyp-type"><b>: </b><span>vstate Free</span></span></span><br><span><var>Hprs'</var><span class="hyp-type"><b>: </b><span>valid_state_prop Free s&#39;</span></span></span><br><span><var>label_a</var><span class="hyp-type"><b>: </b><span>composite_label IM</span></span></span><br><span><var>input_a</var><span class="hyp-type"><b>: </b><span>option message</span></span></span><br><span><var>i</var><span><span class="hyp-body"><b>:= </b><span>projT1 label_a</span></span><span class="hyp-type"><b>: </b><span>index</span></span></span></span><br><span><var>Heq</var><span class="hyp-type"><b>: </b><span>s i = s&#39; i</span></span></span><br><span><var>s1</var><span class="hyp-type"><b>: </b><span>state</span></span></span><br><span><var>o0</var><span class="hyp-type"><b>: </b><span>option message</span></span></span><br><span><var>eq_trans</var><span class="hyp-type"><b>: </b><span>vtransition Free label_a (s, input_a) =
(s1, o0)</span></span></span><br><span><var>Hpr</var><span class="hyp-type"><b>: </b><span>finite_valid_trace_from Free s
  (rev
     [{|
        l := label_a;
        input := input_a;
        destination := s1;
        output := o0
      |}], s1).<span class="mi">1</span></span></span></span><br><span><var>s0</var><span class="hyp-type"><b>: </b><span>state</span></span></span><br><span><var>o</var><span class="hyp-type"><b>: </b><span>option message</span></span></span><br><span><var>eq_trans'</var><span class="hyp-type"><b>: </b><span>vtransition Free label_a (s&#39;, input_a) =
(s0, o)</span></span></span><br><span><var>Htl</var><span class="hyp-type"><b>: </b><span>finite_valid_trace_from Free s1 []</span></span></span><br><span><var>Ht</var><span class="hyp-type"><b>: </b><span>input_valid_transition Free label_a 
  (s, input_a) (s1, o0)</span></span></span><br><span><var>Ht'</var><span class="hyp-type"><b>: </b><span>input_valid_transition Free label_a
  (s&#39;, input_a) (s0, o)</span></span></span><br></div><label class="goal-separator" for="Composition-v-chk1a8"><hr></label><div class="goal-conclusion">finite_valid_trace_from Free s&#39;
  (rev
     [{|
        l := label_a;
        input := input_a;
        destination := s0;
        output := o
      |}], s0).<span class="mi">1</span></div></blockquote></div></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="Composition-v-chk1a9" style="display: none" type="checkbox"><label class="alectryon-input" for="Composition-v-chk1a9">{</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>message, index</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>EqDecision0</var><span class="hyp-type"><b>: </b><span>EqDecision index</span></span></span><br><span><var>IM</var><span class="hyp-type"><b>: </b><span>index ‚Üí VLSM message</span></span></span><br><span><var>Free</var><span><span class="hyp-body"><b>:= </b><span>free_composite_vlsm IM</span></span><span class="hyp-type"><b>: </b><span>VLSM message</span></span></span></span><br><span><var>s, s'</var><span class="hyp-type"><b>: </b><span>vstate Free</span></span></span><br><span><var>Hprs'</var><span class="hyp-type"><b>: </b><span>valid_state_prop Free s&#39;</span></span></span><br><span><var>label_a</var><span class="hyp-type"><b>: </b><span>composite_label IM</span></span></span><br><span><var>input_a</var><span class="hyp-type"><b>: </b><span>option message</span></span></span><br><span><var>i</var><span><span class="hyp-body"><b>:= </b><span>projT1 label_a</span></span><span class="hyp-type"><b>: </b><span>index</span></span></span></span><br><span><var>Heq</var><span class="hyp-type"><b>: </b><span>s i = s&#39; i</span></span></span><br><span><var>s1</var><span class="hyp-type"><b>: </b><span>state</span></span></span><br><span><var>o0</var><span class="hyp-type"><b>: </b><span>option message</span></span></span><br><span><var>eq_trans</var><span class="hyp-type"><b>: </b><span>vtransition Free label_a (s, input_a) =
(s1, o0)</span></span></span><br><span><var>Hpr</var><span class="hyp-type"><b>: </b><span>finite_valid_trace_from Free s
  (rev
     [{|
        l := label_a;
        input := input_a;
        destination := s1;
        output := o0
      |}], s1).<span class="mi">1</span></span></span></span><br><span><var>s0</var><span class="hyp-type"><b>: </b><span>state</span></span></span><br><span><var>o</var><span class="hyp-type"><b>: </b><span>option message</span></span></span><br><span><var>eq_trans'</var><span class="hyp-type"><b>: </b><span>vtransition Free label_a (s&#39;, input_a) =
(s0, o)</span></span></span><br><span><var>Htl</var><span class="hyp-type"><b>: </b><span>finite_valid_trace_from Free s1 []</span></span></span><br><span><var>Ht</var><span class="hyp-type"><b>: </b><span>input_valid_transition Free label_a 
  (s, input_a) (s1, o0)</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">input_valid_transition Free label_a (s&#39;, input_a)
  (s0, o)</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">      </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="Composition-v-chk1aa" style="display: none" type="checkbox"><label class="alectryon-input" for="Composition-v-chk1aa"><span class="nb">unfold</span> input_valid_transition <span class="kr">in</span> *.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>message, index</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>EqDecision0</var><span class="hyp-type"><b>: </b><span>EqDecision index</span></span></span><br><span><var>IM</var><span class="hyp-type"><b>: </b><span>index ‚Üí VLSM message</span></span></span><br><span><var>Free</var><span><span class="hyp-body"><b>:= </b><span>free_composite_vlsm IM</span></span><span class="hyp-type"><b>: </b><span>VLSM message</span></span></span></span><br><span><var>s, s'</var><span class="hyp-type"><b>: </b><span>vstate Free</span></span></span><br><span><var>Hprs'</var><span class="hyp-type"><b>: </b><span>valid_state_prop Free s&#39;</span></span></span><br><span><var>label_a</var><span class="hyp-type"><b>: </b><span>composite_label IM</span></span></span><br><span><var>input_a</var><span class="hyp-type"><b>: </b><span>option message</span></span></span><br><span><var>i</var><span><span class="hyp-body"><b>:= </b><span>projT1 label_a</span></span><span class="hyp-type"><b>: </b><span>index</span></span></span></span><br><span><var>Heq</var><span class="hyp-type"><b>: </b><span>s i = s&#39; i</span></span></span><br><span><var>s1</var><span class="hyp-type"><b>: </b><span>state</span></span></span><br><span><var>o0</var><span class="hyp-type"><b>: </b><span>option message</span></span></span><br><span><var>eq_trans</var><span class="hyp-type"><b>: </b><span>vtransition Free label_a (s, input_a) =
(s1, o0)</span></span></span><br><span><var>Hpr</var><span class="hyp-type"><b>: </b><span>finite_valid_trace_from Free s
  (rev
     [{|
        l := label_a;
        input := input_a;
        destination := s1;
        output := o0
      |}], s1).<span class="mi">1</span></span></span></span><br><span><var>s0</var><span class="hyp-type"><b>: </b><span>state</span></span></span><br><span><var>o</var><span class="hyp-type"><b>: </b><span>option message</span></span></span><br><span><var>eq_trans'</var><span class="hyp-type"><b>: </b><span>vtransition Free label_a (s&#39;, input_a) =
(s0, o)</span></span></span><br><span><var>Htl</var><span class="hyp-type"><b>: </b><span>finite_valid_trace_from Free s1 []</span></span></span><br><span><var>Ht</var><span class="hyp-type"><b>: </b><span>input_valid Free label_a (s, input_a)
‚àß transition label_a (s, input_a) = (s1, o0)</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">input_valid Free label_a (s&#39;, input_a)
‚àß transition label_a (s&#39;, input_a) = (s0, o)</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">      </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="Composition-v-chk1ab" style="display: none" type="checkbox"><label class="alectryon-input" for="Composition-v-chk1ab"><span class="nb">destruct</span> Ht <span class="kr">as</span> [Hpr_valid Htrans].</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>message, index</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>EqDecision0</var><span class="hyp-type"><b>: </b><span>EqDecision index</span></span></span><br><span><var>IM</var><span class="hyp-type"><b>: </b><span>index ‚Üí VLSM message</span></span></span><br><span><var>Free</var><span><span class="hyp-body"><b>:= </b><span>free_composite_vlsm IM</span></span><span class="hyp-type"><b>: </b><span>VLSM message</span></span></span></span><br><span><var>s, s'</var><span class="hyp-type"><b>: </b><span>vstate Free</span></span></span><br><span><var>Hprs'</var><span class="hyp-type"><b>: </b><span>valid_state_prop Free s&#39;</span></span></span><br><span><var>label_a</var><span class="hyp-type"><b>: </b><span>composite_label IM</span></span></span><br><span><var>input_a</var><span class="hyp-type"><b>: </b><span>option message</span></span></span><br><span><var>i</var><span><span class="hyp-body"><b>:= </b><span>projT1 label_a</span></span><span class="hyp-type"><b>: </b><span>index</span></span></span></span><br><span><var>Heq</var><span class="hyp-type"><b>: </b><span>s i = s&#39; i</span></span></span><br><span><var>s1</var><span class="hyp-type"><b>: </b><span>state</span></span></span><br><span><var>o0</var><span class="hyp-type"><b>: </b><span>option message</span></span></span><br><span><var>eq_trans</var><span class="hyp-type"><b>: </b><span>vtransition Free label_a (s, input_a) =
(s1, o0)</span></span></span><br><span><var>Hpr</var><span class="hyp-type"><b>: </b><span>finite_valid_trace_from Free s
  (rev
     [{|
        l := label_a;
        input := input_a;
        destination := s1;
        output := o0
      |}], s1).<span class="mi">1</span></span></span></span><br><span><var>s0</var><span class="hyp-type"><b>: </b><span>state</span></span></span><br><span><var>o</var><span class="hyp-type"><b>: </b><span>option message</span></span></span><br><span><var>eq_trans'</var><span class="hyp-type"><b>: </b><span>vtransition Free label_a (s&#39;, input_a) =
(s0, o)</span></span></span><br><span><var>Htl</var><span class="hyp-type"><b>: </b><span>finite_valid_trace_from Free s1 []</span></span></span><br><span><var>Hpr_valid</var><span class="hyp-type"><b>: </b><span>input_valid Free label_a (s, input_a)</span></span></span><br><span><var>Htrans</var><span class="hyp-type"><b>: </b><span>transition label_a (s, input_a) = (s1, o0)</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">input_valid Free label_a (s&#39;, input_a)
‚àß transition label_a (s&#39;, input_a) = (s0, o)</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">      </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="Composition-v-chk1ac" style="display: none" type="checkbox"><label class="alectryon-input" for="Composition-v-chk1ac"><span class="nb">apply</span> relevant_component_transition <span class="kr">with</span> (s&#39; := s&#39;) <span class="kr">in</span> Hpr_valid.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>message, index</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>EqDecision0</var><span class="hyp-type"><b>: </b><span>EqDecision index</span></span></span><br><span><var>IM</var><span class="hyp-type"><b>: </b><span>index ‚Üí VLSM message</span></span></span><br><span><var>Free</var><span><span class="hyp-body"><b>:= </b><span>free_composite_vlsm IM</span></span><span class="hyp-type"><b>: </b><span>VLSM message</span></span></span></span><br><span><var>s, s'</var><span class="hyp-type"><b>: </b><span>vstate Free</span></span></span><br><span><var>Hprs'</var><span class="hyp-type"><b>: </b><span>valid_state_prop Free s&#39;</span></span></span><br><span><var>label_a</var><span class="hyp-type"><b>: </b><span>composite_label IM</span></span></span><br><span><var>input_a</var><span class="hyp-type"><b>: </b><span>option message</span></span></span><br><span><var>i</var><span><span class="hyp-body"><b>:= </b><span>projT1 label_a</span></span><span class="hyp-type"><b>: </b><span>index</span></span></span></span><br><span><var>Heq</var><span class="hyp-type"><b>: </b><span>s i = s&#39; i</span></span></span><br><span><var>s1</var><span class="hyp-type"><b>: </b><span>state</span></span></span><br><span><var>o0</var><span class="hyp-type"><b>: </b><span>option message</span></span></span><br><span><var>eq_trans</var><span class="hyp-type"><b>: </b><span>vtransition Free label_a (s, input_a) =
(s1, o0)</span></span></span><br><span><var>Hpr</var><span class="hyp-type"><b>: </b><span>finite_valid_trace_from Free s
  (rev
     [{|
        l := label_a;
        input := input_a;
        destination := s1;
        output := o0
      |}], s1).<span class="mi">1</span></span></span></span><br><span><var>s0</var><span class="hyp-type"><b>: </b><span>state</span></span></span><br><span><var>o</var><span class="hyp-type"><b>: </b><span>option message</span></span></span><br><span><var>eq_trans'</var><span class="hyp-type"><b>: </b><span>vtransition Free label_a (s&#39;, input_a) =
(s0, o)</span></span></span><br><span><var>Htl</var><span class="hyp-type"><b>: </b><span>finite_valid_trace_from Free s1 []</span></span></span><br><span><var>Hpr_valid</var><span class="hyp-type"><b>: </b><span>input_valid Free label_a (s&#39;, input_a)</span></span></span><br><span><var>Htrans</var><span class="hyp-type"><b>: </b><span>transition label_a (s, input_a) = (s1, o0)</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">input_valid Free label_a (s&#39;, input_a)
‚àß transition label_a (s&#39;, input_a) = (s0, o)</div></blockquote><div class="alectryon-extra-goals"><input class="alectryon-extra-goal-toggle" id="Composition-v-chk1ad" style="display: none" type="checkbox"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>message, index</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>EqDecision0</var><span class="hyp-type"><b>: </b><span>EqDecision index</span></span></span><br><span><var>IM</var><span class="hyp-type"><b>: </b><span>index ‚Üí VLSM message</span></span></span><br><span><var>Free</var><span><span class="hyp-body"><b>:= </b><span>free_composite_vlsm IM</span></span><span class="hyp-type"><b>: </b><span>VLSM message</span></span></span></span><br><span><var>s, s'</var><span class="hyp-type"><b>: </b><span>vstate Free</span></span></span><br><span><var>Hprs'</var><span class="hyp-type"><b>: </b><span>valid_state_prop Free s&#39;</span></span></span><br><span><var>label_a</var><span class="hyp-type"><b>: </b><span>composite_label IM</span></span></span><br><span><var>input_a</var><span class="hyp-type"><b>: </b><span>option message</span></span></span><br><span><var>i</var><span><span class="hyp-body"><b>:= </b><span>projT1 label_a</span></span><span class="hyp-type"><b>: </b><span>index</span></span></span></span><br><span><var>Heq</var><span class="hyp-type"><b>: </b><span>s i = s&#39; i</span></span></span><br><span><var>s1</var><span class="hyp-type"><b>: </b><span>state</span></span></span><br><span><var>o0</var><span class="hyp-type"><b>: </b><span>option message</span></span></span><br><span><var>eq_trans</var><span class="hyp-type"><b>: </b><span>vtransition Free label_a (s, input_a) =
(s1, o0)</span></span></span><br><span><var>Hpr</var><span class="hyp-type"><b>: </b><span>finite_valid_trace_from Free s
  (rev
     [{|
        l := label_a;
        input := input_a;
        destination := s1;
        output := o0
      |}], s1).<span class="mi">1</span></span></span></span><br><span><var>s0</var><span class="hyp-type"><b>: </b><span>state</span></span></span><br><span><var>o</var><span class="hyp-type"><b>: </b><span>option message</span></span></span><br><span><var>eq_trans'</var><span class="hyp-type"><b>: </b><span>vtransition Free label_a (s&#39;, input_a) =
(s0, o)</span></span></span><br><span><var>Htl</var><span class="hyp-type"><b>: </b><span>finite_valid_trace_from Free s1 []</span></span></span><br><span><var>Hpr_valid</var><span class="hyp-type"><b>: </b><span>input_valid Free label_a (s, input_a)</span></span></span><br><span><var>Htrans</var><span class="hyp-type"><b>: </b><span>transition label_a (s, input_a) = (s1, o0)</span></span></span><br></div><label class="goal-separator" for="Composition-v-chk1ad"><hr></label><div class="goal-conclusion">s (projT1 label_a) = s&#39; (projT1 label_a)</div></blockquote><input class="alectryon-extra-goal-toggle" id="Composition-v-chk1ae" style="display: none" type="checkbox"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>message, index</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>EqDecision0</var><span class="hyp-type"><b>: </b><span>EqDecision index</span></span></span><br><span><var>IM</var><span class="hyp-type"><b>: </b><span>index ‚Üí VLSM message</span></span></span><br><span><var>Free</var><span><span class="hyp-body"><b>:= </b><span>free_composite_vlsm IM</span></span><span class="hyp-type"><b>: </b><span>VLSM message</span></span></span></span><br><span><var>s, s'</var><span class="hyp-type"><b>: </b><span>vstate Free</span></span></span><br><span><var>Hprs'</var><span class="hyp-type"><b>: </b><span>valid_state_prop Free s&#39;</span></span></span><br><span><var>label_a</var><span class="hyp-type"><b>: </b><span>composite_label IM</span></span></span><br><span><var>input_a</var><span class="hyp-type"><b>: </b><span>option message</span></span></span><br><span><var>i</var><span><span class="hyp-body"><b>:= </b><span>projT1 label_a</span></span><span class="hyp-type"><b>: </b><span>index</span></span></span></span><br><span><var>Heq</var><span class="hyp-type"><b>: </b><span>s i = s&#39; i</span></span></span><br><span><var>s1</var><span class="hyp-type"><b>: </b><span>state</span></span></span><br><span><var>o0</var><span class="hyp-type"><b>: </b><span>option message</span></span></span><br><span><var>eq_trans</var><span class="hyp-type"><b>: </b><span>vtransition Free label_a (s, input_a) =
(s1, o0)</span></span></span><br><span><var>Hpr</var><span class="hyp-type"><b>: </b><span>finite_valid_trace_from Free s
  (rev
     [{|
        l := label_a;
        input := input_a;
        destination := s1;
        output := o0
      |}], s1).<span class="mi">1</span></span></span></span><br><span><var>s0</var><span class="hyp-type"><b>: </b><span>state</span></span></span><br><span><var>o</var><span class="hyp-type"><b>: </b><span>option message</span></span></span><br><span><var>eq_trans'</var><span class="hyp-type"><b>: </b><span>vtransition Free label_a (s&#39;, input_a) =
(s0, o)</span></span></span><br><span><var>Htl</var><span class="hyp-type"><b>: </b><span>finite_valid_trace_from Free s1 []</span></span></span><br><span><var>Hpr_valid</var><span class="hyp-type"><b>: </b><span>input_valid Free label_a (s, input_a)</span></span></span><br><span><var>Htrans</var><span class="hyp-type"><b>: </b><span>transition label_a (s, input_a) = (s1, o0)</span></span></span><br></div><label class="goal-separator" for="Composition-v-chk1ae"><hr></label><div class="goal-conclusion">valid_state_prop Free s&#39;</div></blockquote></div></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">      </span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kp">all</span> : itauto.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="Composition-v-chk1af" style="display: none" type="checkbox"><label class="alectryon-input" for="Composition-v-chk1af">}</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>message, index</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>EqDecision0</var><span class="hyp-type"><b>: </b><span>EqDecision index</span></span></span><br><span><var>IM</var><span class="hyp-type"><b>: </b><span>index ‚Üí VLSM message</span></span></span><br><span><var>Free</var><span><span class="hyp-body"><b>:= </b><span>free_composite_vlsm IM</span></span><span class="hyp-type"><b>: </b><span>VLSM message</span></span></span></span><br><span><var>s, s'</var><span class="hyp-type"><b>: </b><span>vstate Free</span></span></span><br><span><var>Hprs'</var><span class="hyp-type"><b>: </b><span>valid_state_prop Free s&#39;</span></span></span><br><span><var>label_a</var><span class="hyp-type"><b>: </b><span>composite_label IM</span></span></span><br><span><var>input_a</var><span class="hyp-type"><b>: </b><span>option message</span></span></span><br><span><var>i</var><span><span class="hyp-body"><b>:= </b><span>projT1 label_a</span></span><span class="hyp-type"><b>: </b><span>index</span></span></span></span><br><span><var>Heq</var><span class="hyp-type"><b>: </b><span>s i = s&#39; i</span></span></span><br><span><var>s1</var><span class="hyp-type"><b>: </b><span>state</span></span></span><br><span><var>o0</var><span class="hyp-type"><b>: </b><span>option message</span></span></span><br><span><var>eq_trans</var><span class="hyp-type"><b>: </b><span>vtransition Free label_a (s, input_a) =
(s1, o0)</span></span></span><br><span><var>Hpr</var><span class="hyp-type"><b>: </b><span>finite_valid_trace_from Free s
  (rev
     [{|
        l := label_a;
        input := input_a;
        destination := s1;
        output := o0
      |}], s1).<span class="mi">1</span></span></span></span><br><span><var>s0</var><span class="hyp-type"><b>: </b><span>state</span></span></span><br><span><var>o</var><span class="hyp-type"><b>: </b><span>option message</span></span></span><br><span><var>eq_trans'</var><span class="hyp-type"><b>: </b><span>vtransition Free label_a (s&#39;, input_a) =
(s0, o)</span></span></span><br><span><var>Htl</var><span class="hyp-type"><b>: </b><span>finite_valid_trace_from Free s1 []</span></span></span><br><span><var>Ht</var><span class="hyp-type"><b>: </b><span>input_valid_transition Free label_a 
  (s, input_a) (s1, o0)</span></span></span><br><span><var>Ht'</var><span class="hyp-type"><b>: </b><span>input_valid_transition Free label_a
  (s&#39;, input_a) (s0, o)</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">finite_valid_trace_from Free s&#39;
  (rev
     [{|
        l := label_a;
        input := input_a;
        destination := s0;
        output := o
      |}], s0).<span class="mi">1</span></div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
</span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="Composition-v-chk1b0" style="display: none" type="checkbox"><label class="alectryon-input" for="Composition-v-chk1b0"><span class="nb">apply</span> finite_valid_trace_from_extend; [| <span class="bp">done</span>].</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>message, index</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>EqDecision0</var><span class="hyp-type"><b>: </b><span>EqDecision index</span></span></span><br><span><var>IM</var><span class="hyp-type"><b>: </b><span>index ‚Üí VLSM message</span></span></span><br><span><var>Free</var><span><span class="hyp-body"><b>:= </b><span>free_composite_vlsm IM</span></span><span class="hyp-type"><b>: </b><span>VLSM message</span></span></span></span><br><span><var>s, s'</var><span class="hyp-type"><b>: </b><span>vstate Free</span></span></span><br><span><var>Hprs'</var><span class="hyp-type"><b>: </b><span>valid_state_prop Free s&#39;</span></span></span><br><span><var>label_a</var><span class="hyp-type"><b>: </b><span>composite_label IM</span></span></span><br><span><var>input_a</var><span class="hyp-type"><b>: </b><span>option message</span></span></span><br><span><var>i</var><span><span class="hyp-body"><b>:= </b><span>projT1 label_a</span></span><span class="hyp-type"><b>: </b><span>index</span></span></span></span><br><span><var>Heq</var><span class="hyp-type"><b>: </b><span>s i = s&#39; i</span></span></span><br><span><var>s1</var><span class="hyp-type"><b>: </b><span>state</span></span></span><br><span><var>o0</var><span class="hyp-type"><b>: </b><span>option message</span></span></span><br><span><var>eq_trans</var><span class="hyp-type"><b>: </b><span>vtransition Free label_a (s, input_a) =
(s1, o0)</span></span></span><br><span><var>Hpr</var><span class="hyp-type"><b>: </b><span>finite_valid_trace_from Free s
  (rev
     [{|
        l := label_a;
        input := input_a;
        destination := s1;
        output := o0
      |}], s1).<span class="mi">1</span></span></span></span><br><span><var>s0</var><span class="hyp-type"><b>: </b><span>state</span></span></span><br><span><var>o</var><span class="hyp-type"><b>: </b><span>option message</span></span></span><br><span><var>eq_trans'</var><span class="hyp-type"><b>: </b><span>vtransition Free label_a (s&#39;, input_a) =
(s0, o)</span></span></span><br><span><var>Htl</var><span class="hyp-type"><b>: </b><span>finite_valid_trace_from Free s1 []</span></span></span><br><span><var>Ht</var><span class="hyp-type"><b>: </b><span>input_valid_transition Free label_a 
  (s, input_a) (s1, o0)</span></span></span><br><span><var>Ht'</var><span class="hyp-type"><b>: </b><span>input_valid_transition Free label_a
  (s&#39;, input_a) (s0, o)</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">finite_valid_trace_from Free s0 []</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="Composition-v-chk1b1" style="display: none" type="checkbox"><label class="alectryon-input" for="Composition-v-chk1b1"><span class="nb">apply</span> finite_valid_trace_from_empty.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>message, index</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>EqDecision0</var><span class="hyp-type"><b>: </b><span>EqDecision index</span></span></span><br><span><var>IM</var><span class="hyp-type"><b>: </b><span>index ‚Üí VLSM message</span></span></span><br><span><var>Free</var><span><span class="hyp-body"><b>:= </b><span>free_composite_vlsm IM</span></span><span class="hyp-type"><b>: </b><span>VLSM message</span></span></span></span><br><span><var>s, s'</var><span class="hyp-type"><b>: </b><span>vstate Free</span></span></span><br><span><var>Hprs'</var><span class="hyp-type"><b>: </b><span>valid_state_prop Free s&#39;</span></span></span><br><span><var>label_a</var><span class="hyp-type"><b>: </b><span>composite_label IM</span></span></span><br><span><var>input_a</var><span class="hyp-type"><b>: </b><span>option message</span></span></span><br><span><var>i</var><span><span class="hyp-body"><b>:= </b><span>projT1 label_a</span></span><span class="hyp-type"><b>: </b><span>index</span></span></span></span><br><span><var>Heq</var><span class="hyp-type"><b>: </b><span>s i = s&#39; i</span></span></span><br><span><var>s1</var><span class="hyp-type"><b>: </b><span>state</span></span></span><br><span><var>o0</var><span class="hyp-type"><b>: </b><span>option message</span></span></span><br><span><var>eq_trans</var><span class="hyp-type"><b>: </b><span>vtransition Free label_a (s, input_a) =
(s1, o0)</span></span></span><br><span><var>Hpr</var><span class="hyp-type"><b>: </b><span>finite_valid_trace_from Free s
  (rev
     [{|
        l := label_a;
        input := input_a;
        destination := s1;
        output := o0
      |}], s1).<span class="mi">1</span></span></span></span><br><span><var>s0</var><span class="hyp-type"><b>: </b><span>state</span></span></span><br><span><var>o</var><span class="hyp-type"><b>: </b><span>option message</span></span></span><br><span><var>eq_trans'</var><span class="hyp-type"><b>: </b><span>vtransition Free label_a (s&#39;, input_a) =
(s0, o)</span></span></span><br><span><var>Htl</var><span class="hyp-type"><b>: </b><span>finite_valid_trace_from Free s1 []</span></span></span><br><span><var>Ht</var><span class="hyp-type"><b>: </b><span>input_valid_transition Free label_a 
  (s, input_a) (s1, o0)</span></span></span><br><span><var>Ht'</var><span class="hyp-type"><b>: </b><span>input_valid_transition Free label_a
  (s&#39;, input_a) (s0, o)</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">valid_state_prop Free s0</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><span class="alectryon-input"><span class="bp">by</span> <span class="nb">apply</span> input_valid_transition_destination <span class="kr">in</span> Ht&#39;.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="Composition-v-chk1b2" style="display: none" type="checkbox"><label class="alectryon-input" for="Composition-v-chk1b2">-</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>message, index</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>EqDecision0</var><span class="hyp-type"><b>: </b><span>EqDecision index</span></span></span><br><span><var>IM</var><span class="hyp-type"><b>: </b><span>index ‚Üí VLSM message</span></span></span><br><span><var>Free</var><span><span class="hyp-body"><b>:= </b><span>free_composite_vlsm IM</span></span><span class="hyp-type"><b>: </b><span>VLSM message</span></span></span></span><br><span><var>s, s'</var><span class="hyp-type"><b>: </b><span>vstate Free</span></span></span><br><span><var>Hprs'</var><span class="hyp-type"><b>: </b><span>valid_state_prop Free s&#39;</span></span></span><br><span><var>label_a</var><span class="hyp-type"><b>: </b><span>composite_label IM</span></span></span><br><span><var>input_a</var><span class="hyp-type"><b>: </b><span>option message</span></span></span><br><span><var>i</var><span><span class="hyp-body"><b>:= </b><span>projT1 label_a</span></span><span class="hyp-type"><b>: </b><span>index</span></span></span></span><br><span><var>Heq</var><span class="hyp-type"><b>: </b><span>s i = s&#39; i</span></span></span><br><span><var>s1</var><span class="hyp-type"><b>: </b><span>state</span></span></span><br><span><var>o0</var><span class="hyp-type"><b>: </b><span>option message</span></span></span><br><span><var>eq_trans</var><span class="hyp-type"><b>: </b><span>vtransition Free label_a (s, input_a) =
(s1, o0)</span></span></span><br><span><var>Hpr</var><span class="hyp-type"><b>: </b><span>finite_valid_trace_from Free s
  (rev
     [{|
        l := label_a;
        input := input_a;
        destination := s1;
        output := o0
      |}], s1).<span class="mi">1</span></span></span></span><br><span><var>s0</var><span class="hyp-type"><b>: </b><span>state</span></span></span><br><span><var>o</var><span class="hyp-type"><b>: </b><span>option message</span></span></span><br><span><var>eq_trans'</var><span class="hyp-type"><b>: </b><span>vtransition Free label_a (s&#39;, input_a) =
(s0, o)</span></span></span><br><span><var>Htl</var><span class="hyp-type"><b>: </b><span>finite_valid_trace_from Free s1 []</span></span></span><br><span><var>Ht</var><span class="hyp-type"><b>: </b><span>input_valid_transition Free label_a 
  (s, input_a) (s1, o0)</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">(rev
   [{|
      l := label_a;
      input := input_a;
      destination := s0;
      output := o
    |}], s0).<span class="mi">2</span> i =
(rev
   [{|
      l := label_a;
      input := input_a;
      destination := s1;
      output := o0
    |}], s1).<span class="mi">2</span> i</div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="Composition-v-chk1b3" style="display: none" type="checkbox"><label class="alectryon-input" for="Composition-v-chk1b3"><span class="nb">simpl</span>.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>message, index</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>EqDecision0</var><span class="hyp-type"><b>: </b><span>EqDecision index</span></span></span><br><span><var>IM</var><span class="hyp-type"><b>: </b><span>index ‚Üí VLSM message</span></span></span><br><span><var>Free</var><span><span class="hyp-body"><b>:= </b><span>free_composite_vlsm IM</span></span><span class="hyp-type"><b>: </b><span>VLSM message</span></span></span></span><br><span><var>s, s'</var><span class="hyp-type"><b>: </b><span>vstate Free</span></span></span><br><span><var>Hprs'</var><span class="hyp-type"><b>: </b><span>valid_state_prop Free s&#39;</span></span></span><br><span><var>label_a</var><span class="hyp-type"><b>: </b><span>composite_label IM</span></span></span><br><span><var>input_a</var><span class="hyp-type"><b>: </b><span>option message</span></span></span><br><span><var>i</var><span><span class="hyp-body"><b>:= </b><span>projT1 label_a</span></span><span class="hyp-type"><b>: </b><span>index</span></span></span></span><br><span><var>Heq</var><span class="hyp-type"><b>: </b><span>s i = s&#39; i</span></span></span><br><span><var>s1</var><span class="hyp-type"><b>: </b><span>state</span></span></span><br><span><var>o0</var><span class="hyp-type"><b>: </b><span>option message</span></span></span><br><span><var>eq_trans</var><span class="hyp-type"><b>: </b><span>vtransition Free label_a (s, input_a) =
(s1, o0)</span></span></span><br><span><var>Hpr</var><span class="hyp-type"><b>: </b><span>finite_valid_trace_from Free s
  (rev
     [{|
        l := label_a;
        input := input_a;
        destination := s1;
        output := o0
      |}], s1).<span class="mi">1</span></span></span></span><br><span><var>s0</var><span class="hyp-type"><b>: </b><span>state</span></span></span><br><span><var>o</var><span class="hyp-type"><b>: </b><span>option message</span></span></span><br><span><var>eq_trans'</var><span class="hyp-type"><b>: </b><span>vtransition Free label_a (s&#39;, input_a) =
(s0, o)</span></span></span><br><span><var>Htl</var><span class="hyp-type"><b>: </b><span>finite_valid_trace_from Free s1 []</span></span></span><br><span><var>Ht</var><span class="hyp-type"><b>: </b><span>input_valid_transition Free label_a 
  (s, input_a) (s1, o0)</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">s0 i = s1 i</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="Composition-v-chk1b4" style="display: none" type="checkbox"><label class="alectryon-input" for="Composition-v-chk1b4"><span class="nb">specialize</span> (relevant_component_transition2 s s&#39; label_a input_a) <span class="kr">as</span> Hrel.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>message, index</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>EqDecision0</var><span class="hyp-type"><b>: </b><span>EqDecision index</span></span></span><br><span><var>IM</var><span class="hyp-type"><b>: </b><span>index ‚Üí VLSM message</span></span></span><br><span><var>Free</var><span><span class="hyp-body"><b>:= </b><span>free_composite_vlsm IM</span></span><span class="hyp-type"><b>: </b><span>VLSM message</span></span></span></span><br><span><var>s, s'</var><span class="hyp-type"><b>: </b><span>vstate Free</span></span></span><br><span><var>Hprs'</var><span class="hyp-type"><b>: </b><span>valid_state_prop Free s&#39;</span></span></span><br><span><var>label_a</var><span class="hyp-type"><b>: </b><span>composite_label IM</span></span></span><br><span><var>input_a</var><span class="hyp-type"><b>: </b><span>option message</span></span></span><br><span><var>i</var><span><span class="hyp-body"><b>:= </b><span>projT1 label_a</span></span><span class="hyp-type"><b>: </b><span>index</span></span></span></span><br><span><var>Heq</var><span class="hyp-type"><b>: </b><span>s i = s&#39; i</span></span></span><br><span><var>s1</var><span class="hyp-type"><b>: </b><span>state</span></span></span><br><span><var>o0</var><span class="hyp-type"><b>: </b><span>option message</span></span></span><br><span><var>eq_trans</var><span class="hyp-type"><b>: </b><span>vtransition Free label_a (s, input_a) =
(s1, o0)</span></span></span><br><span><var>Hpr</var><span class="hyp-type"><b>: </b><span>finite_valid_trace_from Free s
  (rev
     [{|
        l := label_a;
        input := input_a;
        destination := s1;
        output := o0
      |}], s1).<span class="mi">1</span></span></span></span><br><span><var>s0</var><span class="hyp-type"><b>: </b><span>state</span></span></span><br><span><var>o</var><span class="hyp-type"><b>: </b><span>option message</span></span></span><br><span><var>eq_trans'</var><span class="hyp-type"><b>: </b><span>vtransition Free label_a (s&#39;, input_a) =
(s0, o)</span></span></span><br><span><var>Htl</var><span class="hyp-type"><b>: </b><span>finite_valid_trace_from Free s1 []</span></span></span><br><span><var>Ht</var><span class="hyp-type"><b>: </b><span>input_valid_transition Free label_a 
  (s, input_a) (s1, o0)</span></span></span><br><span><var>Hrel</var><span class="hyp-type"><b>: </b><span><span class="kr">let</span> <span class="nv">i</span> := projT1 label_a <span class="kr">in</span>
s i = s&#39; i
‚Üí valid_state_prop Free s&#39;
  ‚Üí <span class="kr">let</span> (<span class="nv">dest</span>, output) :=
      vtransition Free label_a (s, input_a) <span class="kr">in</span>
    <span class="kr">let</span> (<span class="nv">dest&#39;</span>, output&#39;) :=
      vtransition Free label_a (s&#39;, input_a) <span class="kr">in</span>
    output = output&#39; ‚àß dest i = dest&#39; i</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">s0 i = s1 i</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="Composition-v-chk1b5" style="display: none" type="checkbox"><label class="alectryon-input" for="Composition-v-chk1b5"><span class="nb">simpl</span> <span class="kr">in</span> Hrel.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>message, index</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>EqDecision0</var><span class="hyp-type"><b>: </b><span>EqDecision index</span></span></span><br><span><var>IM</var><span class="hyp-type"><b>: </b><span>index ‚Üí VLSM message</span></span></span><br><span><var>Free</var><span><span class="hyp-body"><b>:= </b><span>free_composite_vlsm IM</span></span><span class="hyp-type"><b>: </b><span>VLSM message</span></span></span></span><br><span><var>s, s'</var><span class="hyp-type"><b>: </b><span>vstate Free</span></span></span><br><span><var>Hprs'</var><span class="hyp-type"><b>: </b><span>valid_state_prop Free s&#39;</span></span></span><br><span><var>label_a</var><span class="hyp-type"><b>: </b><span>composite_label IM</span></span></span><br><span><var>input_a</var><span class="hyp-type"><b>: </b><span>option message</span></span></span><br><span><var>i</var><span><span class="hyp-body"><b>:= </b><span>projT1 label_a</span></span><span class="hyp-type"><b>: </b><span>index</span></span></span></span><br><span><var>Heq</var><span class="hyp-type"><b>: </b><span>s i = s&#39; i</span></span></span><br><span><var>s1</var><span class="hyp-type"><b>: </b><span>state</span></span></span><br><span><var>o0</var><span class="hyp-type"><b>: </b><span>option message</span></span></span><br><span><var>eq_trans</var><span class="hyp-type"><b>: </b><span>vtransition Free label_a (s, input_a) =
(s1, o0)</span></span></span><br><span><var>Hpr</var><span class="hyp-type"><b>: </b><span>finite_valid_trace_from Free s
  (rev
     [{|
        l := label_a;
        input := input_a;
        destination := s1;
        output := o0
      |}], s1).<span class="mi">1</span></span></span></span><br><span><var>s0</var><span class="hyp-type"><b>: </b><span>state</span></span></span><br><span><var>o</var><span class="hyp-type"><b>: </b><span>option message</span></span></span><br><span><var>eq_trans'</var><span class="hyp-type"><b>: </b><span>vtransition Free label_a (s&#39;, input_a) =
(s0, o)</span></span></span><br><span><var>Htl</var><span class="hyp-type"><b>: </b><span>finite_valid_trace_from Free s1 []</span></span></span><br><span><var>Ht</var><span class="hyp-type"><b>: </b><span>input_valid_transition Free label_a 
  (s, input_a) (s1, o0)</span></span></span><br><span><var>Hrel</var><span class="hyp-type"><b>: </b><span>s (projT1 label_a) = s&#39; (projT1 label_a)
‚Üí valid_state_prop Free s&#39;
  ‚Üí <span class="kr">let</span> (<span class="nv">dest</span>, output) :=
      vtransition Free label_a (s, input_a) <span class="kr">in</span>
    <span class="kr">let</span> (<span class="nv">dest&#39;</span>, output&#39;) :=
      vtransition Free label_a (s&#39;, input_a) <span class="kr">in</span>
    output = output&#39;
    ‚àß dest (projT1 label_a) =
      dest&#39; (projT1 label_a)</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">s0 i = s1 i</div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="Composition-v-chk1b6" style="display: none" type="checkbox"><label class="alectryon-input" for="Composition-v-chk1b6"><span class="nb">unfold</span> i <span class="kr">in</span> Heq.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>message, index</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>EqDecision0</var><span class="hyp-type"><b>: </b><span>EqDecision index</span></span></span><br><span><var>IM</var><span class="hyp-type"><b>: </b><span>index ‚Üí VLSM message</span></span></span><br><span><var>Free</var><span><span class="hyp-body"><b>:= </b><span>free_composite_vlsm IM</span></span><span class="hyp-type"><b>: </b><span>VLSM message</span></span></span></span><br><span><var>s, s'</var><span class="hyp-type"><b>: </b><span>vstate Free</span></span></span><br><span><var>Hprs'</var><span class="hyp-type"><b>: </b><span>valid_state_prop Free s&#39;</span></span></span><br><span><var>label_a</var><span class="hyp-type"><b>: </b><span>composite_label IM</span></span></span><br><span><var>input_a</var><span class="hyp-type"><b>: </b><span>option message</span></span></span><br><span><var>i</var><span><span class="hyp-body"><b>:= </b><span>projT1 label_a</span></span><span class="hyp-type"><b>: </b><span>index</span></span></span></span><br><span><var>Heq</var><span class="hyp-type"><b>: </b><span>s (projT1 label_a) = s&#39; (projT1 label_a)</span></span></span><br><span><var>s1</var><span class="hyp-type"><b>: </b><span>state</span></span></span><br><span><var>o0</var><span class="hyp-type"><b>: </b><span>option message</span></span></span><br><span><var>eq_trans</var><span class="hyp-type"><b>: </b><span>vtransition Free label_a (s, input_a) =
(s1, o0)</span></span></span><br><span><var>Hpr</var><span class="hyp-type"><b>: </b><span>finite_valid_trace_from Free s
  (rev
     [{|
        l := label_a;
        input := input_a;
        destination := s1;
        output := o0
      |}], s1).<span class="mi">1</span></span></span></span><br><span><var>s0</var><span class="hyp-type"><b>: </b><span>state</span></span></span><br><span><var>o</var><span class="hyp-type"><b>: </b><span>option message</span></span></span><br><span><var>eq_trans'</var><span class="hyp-type"><b>: </b><span>vtransition Free label_a (s&#39;, input_a) =
(s0, o)</span></span></span><br><span><var>Htl</var><span class="hyp-type"><b>: </b><span>finite_valid_trace_from Free s1 []</span></span></span><br><span><var>Ht</var><span class="hyp-type"><b>: </b><span>input_valid_transition Free label_a 
  (s, input_a) (s1, o0)</span></span></span><br><span><var>Hrel</var><span class="hyp-type"><b>: </b><span>s (projT1 label_a) = s&#39; (projT1 label_a)
‚Üí valid_state_prop Free s&#39;
  ‚Üí <span class="kr">let</span> (<span class="nv">dest</span>, output) :=
      vtransition Free label_a (s, input_a) <span class="kr">in</span>
    <span class="kr">let</span> (<span class="nv">dest&#39;</span>, output&#39;) :=
      vtransition Free label_a (s&#39;, input_a) <span class="kr">in</span>
    output = output&#39;
    ‚àß dest (projT1 label_a) =
      dest&#39; (projT1 label_a)</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">s0 i = s1 i</div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="Composition-v-chk1b7" style="display: none" type="checkbox"><label class="alectryon-input" for="Composition-v-chk1b7"><span class="nb">specialize</span> (Hrel Heq Hprs&#39;).</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>message, index</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>EqDecision0</var><span class="hyp-type"><b>: </b><span>EqDecision index</span></span></span><br><span><var>IM</var><span class="hyp-type"><b>: </b><span>index ‚Üí VLSM message</span></span></span><br><span><var>Free</var><span><span class="hyp-body"><b>:= </b><span>free_composite_vlsm IM</span></span><span class="hyp-type"><b>: </b><span>VLSM message</span></span></span></span><br><span><var>s, s'</var><span class="hyp-type"><b>: </b><span>vstate Free</span></span></span><br><span><var>Hprs'</var><span class="hyp-type"><b>: </b><span>valid_state_prop Free s&#39;</span></span></span><br><span><var>label_a</var><span class="hyp-type"><b>: </b><span>composite_label IM</span></span></span><br><span><var>input_a</var><span class="hyp-type"><b>: </b><span>option message</span></span></span><br><span><var>i</var><span><span class="hyp-body"><b>:= </b><span>projT1 label_a</span></span><span class="hyp-type"><b>: </b><span>index</span></span></span></span><br><span><var>Heq</var><span class="hyp-type"><b>: </b><span>s (projT1 label_a) = s&#39; (projT1 label_a)</span></span></span><br><span><var>s1</var><span class="hyp-type"><b>: </b><span>state</span></span></span><br><span><var>o0</var><span class="hyp-type"><b>: </b><span>option message</span></span></span><br><span><var>eq_trans</var><span class="hyp-type"><b>: </b><span>vtransition Free label_a (s, input_a) =
(s1, o0)</span></span></span><br><span><var>Hpr</var><span class="hyp-type"><b>: </b><span>finite_valid_trace_from Free s
  (rev
     [{|
        l := label_a;
        input := input_a;
        destination := s1;
        output := o0
      |}], s1).<span class="mi">1</span></span></span></span><br><span><var>s0</var><span class="hyp-type"><b>: </b><span>state</span></span></span><br><span><var>o</var><span class="hyp-type"><b>: </b><span>option message</span></span></span><br><span><var>eq_trans'</var><span class="hyp-type"><b>: </b><span>vtransition Free label_a (s&#39;, input_a) =
(s0, o)</span></span></span><br><span><var>Htl</var><span class="hyp-type"><b>: </b><span>finite_valid_trace_from Free s1 []</span></span></span><br><span><var>Ht</var><span class="hyp-type"><b>: </b><span>input_valid_transition Free label_a 
  (s, input_a) (s1, o0)</span></span></span><br><span><var>Hrel</var><span class="hyp-type"><b>: </b><span><span class="kr">let</span> (<span class="nv">dest</span>, output) :=
  vtransition Free label_a (s, input_a) <span class="kr">in</span>
<span class="kr">let</span> (<span class="nv">dest&#39;</span>, output&#39;) :=
  vtransition Free label_a (s&#39;, input_a) <span class="kr">in</span>
output = output&#39;
‚àß dest (projT1 label_a) =
  dest&#39; (projT1 label_a)</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">s0 i = s1 i</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="Composition-v-chk1b8" style="display: none" type="checkbox"><label class="alectryon-input" for="Composition-v-chk1b8"><span class="kr">match</span> <span class="kp">type of</span> Hrel <span class="kr">with</span>
    | <span class="kr">let</span> (<span class="nv">_</span>, _) := <span class="nl">?t</span> <span class="kr">in</span> _ =&gt; <span class="nb">replace</span> t <span class="kr">with</span> (s1, o0) <span class="kr">in</span> Hrel
    <span class="kr">end</span>.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>message, index</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>EqDecision0</var><span class="hyp-type"><b>: </b><span>EqDecision index</span></span></span><br><span><var>IM</var><span class="hyp-type"><b>: </b><span>index ‚Üí VLSM message</span></span></span><br><span><var>Free</var><span><span class="hyp-body"><b>:= </b><span>free_composite_vlsm IM</span></span><span class="hyp-type"><b>: </b><span>VLSM message</span></span></span></span><br><span><var>s, s'</var><span class="hyp-type"><b>: </b><span>vstate Free</span></span></span><br><span><var>Hprs'</var><span class="hyp-type"><b>: </b><span>valid_state_prop Free s&#39;</span></span></span><br><span><var>label_a</var><span class="hyp-type"><b>: </b><span>composite_label IM</span></span></span><br><span><var>input_a</var><span class="hyp-type"><b>: </b><span>option message</span></span></span><br><span><var>i</var><span><span class="hyp-body"><b>:= </b><span>projT1 label_a</span></span><span class="hyp-type"><b>: </b><span>index</span></span></span></span><br><span><var>Heq</var><span class="hyp-type"><b>: </b><span>s (projT1 label_a) = s&#39; (projT1 label_a)</span></span></span><br><span><var>s1</var><span class="hyp-type"><b>: </b><span>state</span></span></span><br><span><var>o0</var><span class="hyp-type"><b>: </b><span>option message</span></span></span><br><span><var>eq_trans</var><span class="hyp-type"><b>: </b><span>vtransition Free label_a (s, input_a) =
(s1, o0)</span></span></span><br><span><var>Hpr</var><span class="hyp-type"><b>: </b><span>finite_valid_trace_from Free s
  (rev
     [{|
        l := label_a;
        input := input_a;
        destination := s1;
        output := o0
      |}], s1).<span class="mi">1</span></span></span></span><br><span><var>s0</var><span class="hyp-type"><b>: </b><span>state</span></span></span><br><span><var>o</var><span class="hyp-type"><b>: </b><span>option message</span></span></span><br><span><var>eq_trans'</var><span class="hyp-type"><b>: </b><span>vtransition Free label_a (s&#39;, input_a) =
(s0, o)</span></span></span><br><span><var>Htl</var><span class="hyp-type"><b>: </b><span>finite_valid_trace_from Free s1 []</span></span></span><br><span><var>Ht</var><span class="hyp-type"><b>: </b><span>input_valid_transition Free label_a 
  (s, input_a) (s1, o0)</span></span></span><br><span><var>Hrel</var><span class="hyp-type"><b>: </b><span><span class="kr">let</span> (<span class="nv">dest&#39;</span>, output&#39;) :=
  vtransition Free label_a (s&#39;, input_a) <span class="kr">in</span>
o0 = output&#39;
‚àß s1 (projT1 label_a) = dest&#39; (projT1 label_a)</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">s0 i = s1 i</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="Composition-v-chk1b9" style="display: none" type="checkbox"><label class="alectryon-input" for="Composition-v-chk1b9"><span class="kr">match</span> <span class="kp">type of</span> Hrel <span class="kr">with</span>
    | <span class="kr">let</span> (<span class="nv">_</span>, _) := <span class="nl">?t</span> <span class="kr">in</span> _ =&gt; <span class="nb">replace</span> t <span class="kr">with</span> (s0, o) <span class="kr">in</span> Hrel
    <span class="kr">end</span>.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>message, index</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>EqDecision0</var><span class="hyp-type"><b>: </b><span>EqDecision index</span></span></span><br><span><var>IM</var><span class="hyp-type"><b>: </b><span>index ‚Üí VLSM message</span></span></span><br><span><var>Free</var><span><span class="hyp-body"><b>:= </b><span>free_composite_vlsm IM</span></span><span class="hyp-type"><b>: </b><span>VLSM message</span></span></span></span><br><span><var>s, s'</var><span class="hyp-type"><b>: </b><span>vstate Free</span></span></span><br><span><var>Hprs'</var><span class="hyp-type"><b>: </b><span>valid_state_prop Free s&#39;</span></span></span><br><span><var>label_a</var><span class="hyp-type"><b>: </b><span>composite_label IM</span></span></span><br><span><var>input_a</var><span class="hyp-type"><b>: </b><span>option message</span></span></span><br><span><var>i</var><span><span class="hyp-body"><b>:= </b><span>projT1 label_a</span></span><span class="hyp-type"><b>: </b><span>index</span></span></span></span><br><span><var>Heq</var><span class="hyp-type"><b>: </b><span>s (projT1 label_a) = s&#39; (projT1 label_a)</span></span></span><br><span><var>s1</var><span class="hyp-type"><b>: </b><span>state</span></span></span><br><span><var>o0</var><span class="hyp-type"><b>: </b><span>option message</span></span></span><br><span><var>eq_trans</var><span class="hyp-type"><b>: </b><span>vtransition Free label_a (s, input_a) =
(s1, o0)</span></span></span><br><span><var>Hpr</var><span class="hyp-type"><b>: </b><span>finite_valid_trace_from Free s
  (rev
     [{|
        l := label_a;
        input := input_a;
        destination := s1;
        output := o0
      |}], s1).<span class="mi">1</span></span></span></span><br><span><var>s0</var><span class="hyp-type"><b>: </b><span>state</span></span></span><br><span><var>o</var><span class="hyp-type"><b>: </b><span>option message</span></span></span><br><span><var>eq_trans'</var><span class="hyp-type"><b>: </b><span>vtransition Free label_a (s&#39;, input_a) =
(s0, o)</span></span></span><br><span><var>Htl</var><span class="hyp-type"><b>: </b><span>finite_valid_trace_from Free s1 []</span></span></span><br><span><var>Ht</var><span class="hyp-type"><b>: </b><span>input_valid_transition Free label_a 
  (s, input_a) (s1, o0)</span></span></span><br><span><var>Hrel</var><span class="hyp-type"><b>: </b><span>o0 = o
‚àß s1 (projT1 label_a) = s0 (projT1 label_a)</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">s0 i = s1 i</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="Composition-v-chk1ba" style="display: none" type="checkbox"><label class="alectryon-input" for="Composition-v-chk1ba"><span class="nb">unfold</span> i.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>message, index</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>EqDecision0</var><span class="hyp-type"><b>: </b><span>EqDecision index</span></span></span><br><span><var>IM</var><span class="hyp-type"><b>: </b><span>index ‚Üí VLSM message</span></span></span><br><span><var>Free</var><span><span class="hyp-body"><b>:= </b><span>free_composite_vlsm IM</span></span><span class="hyp-type"><b>: </b><span>VLSM message</span></span></span></span><br><span><var>s, s'</var><span class="hyp-type"><b>: </b><span>vstate Free</span></span></span><br><span><var>Hprs'</var><span class="hyp-type"><b>: </b><span>valid_state_prop Free s&#39;</span></span></span><br><span><var>label_a</var><span class="hyp-type"><b>: </b><span>composite_label IM</span></span></span><br><span><var>input_a</var><span class="hyp-type"><b>: </b><span>option message</span></span></span><br><span><var>i</var><span><span class="hyp-body"><b>:= </b><span>projT1 label_a</span></span><span class="hyp-type"><b>: </b><span>index</span></span></span></span><br><span><var>Heq</var><span class="hyp-type"><b>: </b><span>s (projT1 label_a) = s&#39; (projT1 label_a)</span></span></span><br><span><var>s1</var><span class="hyp-type"><b>: </b><span>state</span></span></span><br><span><var>o0</var><span class="hyp-type"><b>: </b><span>option message</span></span></span><br><span><var>eq_trans</var><span class="hyp-type"><b>: </b><span>vtransition Free label_a (s, input_a) =
(s1, o0)</span></span></span><br><span><var>Hpr</var><span class="hyp-type"><b>: </b><span>finite_valid_trace_from Free s
  (rev
     [{|
        l := label_a;
        input := input_a;
        destination := s1;
        output := o0
      |}], s1).<span class="mi">1</span></span></span></span><br><span><var>s0</var><span class="hyp-type"><b>: </b><span>state</span></span></span><br><span><var>o</var><span class="hyp-type"><b>: </b><span>option message</span></span></span><br><span><var>eq_trans'</var><span class="hyp-type"><b>: </b><span>vtransition Free label_a (s&#39;, input_a) =
(s0, o)</span></span></span><br><span><var>Htl</var><span class="hyp-type"><b>: </b><span>finite_valid_trace_from Free s1 []</span></span></span><br><span><var>Ht</var><span class="hyp-type"><b>: </b><span>input_valid_transition Free label_a 
  (s, input_a) (s1, o0)</span></span></span><br><span><var>Hrel</var><span class="hyp-type"><b>: </b><span>o0 = o
‚àß s1 (projT1 label_a) = s0 (projT1 label_a)</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">s0 (projT1 label_a) = s1 (projT1 label_a)</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><span class="alectryon-input">itauto.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Qed</span>.</span></span></pre><div class="doc">
  Transitioning on some index different from <code>i</code> does not affect
  component <code>i</code>.

</div><pre class="alectryon-io highlight"><!-- Generator: Alectryon --><span class="alectryon-sentence"><input class="alectryon-toggle" id="Composition-v-chk1bb" style="display: none" type="checkbox"><label class="alectryon-input" for="Composition-v-chk1bb"><span class="kn">Lemma</span> <span class="nf">irrelevant_components_one</span>
  (<span class="nv">s</span> : state)
  (<span class="nv">ai</span> : composite_plan_item IM)
  (<span class="nv">i</span> : index)
  (<span class="nv">Hdif</span> : i &lt;&gt; projT1 (label_a ai)) :
  <span class="kr">let</span> <span class="nv">res</span> := snd (composite_apply_plan IM s [ai]) <span class="kr">in</span>
  (res i) = (s i).</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>message, index</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>EqDecision0</var><span class="hyp-type"><b>: </b><span>EqDecision index</span></span></span><br><span><var>IM</var><span class="hyp-type"><b>: </b><span>index ‚Üí VLSM message</span></span></span><br><span><var>Free</var><span><span class="hyp-body"><b>:= </b><span>free_composite_vlsm IM</span></span><span class="hyp-type"><b>: </b><span>VLSM message</span></span></span></span><br><span><var>s</var><span class="hyp-type"><b>: </b><span>state</span></span></span><br><span><var>ai</var><span class="hyp-type"><b>: </b><span>composite_plan_item IM</span></span></span><br><span><var>i</var><span class="hyp-type"><b>: </b><span>index</span></span></span><br><span><var>Hdif</var><span class="hyp-type"><b>: </b><span>i ‚â† projT1 (label_a ai)</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="kr">let</span> <span class="nv">res</span> := (composite_apply_plan IM s [ai]).<span class="mi">2</span> <span class="kr">in</span>
res i = s i</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="Composition-v-chk1bc" style="display: none" type="checkbox"><label class="alectryon-input" for="Composition-v-chk1bc"><span class="kn">Proof</span>.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>message, index</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>EqDecision0</var><span class="hyp-type"><b>: </b><span>EqDecision index</span></span></span><br><span><var>IM</var><span class="hyp-type"><b>: </b><span>index ‚Üí VLSM message</span></span></span><br><span><var>Free</var><span><span class="hyp-body"><b>:= </b><span>free_composite_vlsm IM</span></span><span class="hyp-type"><b>: </b><span>VLSM message</span></span></span></span><br><span><var>s</var><span class="hyp-type"><b>: </b><span>state</span></span></span><br><span><var>ai</var><span class="hyp-type"><b>: </b><span>composite_plan_item IM</span></span></span><br><span><var>i</var><span class="hyp-type"><b>: </b><span>index</span></span></span><br><span><var>Hdif</var><span class="hyp-type"><b>: </b><span>i ‚â† projT1 (label_a ai)</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="kr">let</span> <span class="nv">res</span> := (composite_apply_plan IM s [ai]).<span class="mi">2</span> <span class="kr">in</span>
res i = s i</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="Composition-v-chk1bd" style="display: none" type="checkbox"><label class="alectryon-input" for="Composition-v-chk1bd"><span class="nb">unfold</span> composite_apply_plan, apply_plan, _apply_plan.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>message, index</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>EqDecision0</var><span class="hyp-type"><b>: </b><span>EqDecision index</span></span></span><br><span><var>IM</var><span class="hyp-type"><b>: </b><span>index ‚Üí VLSM message</span></span></span><br><span><var>Free</var><span><span class="hyp-body"><b>:= </b><span>free_composite_vlsm IM</span></span><span class="hyp-type"><b>: </b><span>VLSM message</span></span></span></span><br><span><var>s</var><span class="hyp-type"><b>: </b><span>state</span></span></span><br><span><var>ai</var><span class="hyp-type"><b>: </b><span>composite_plan_item IM</span></span></span><br><span><var>i</var><span class="hyp-type"><b>: </b><span>index</span></span></span><br><span><var>Hdif</var><span class="hyp-type"><b>: </b><span>i ‚â† projT1 (label_a ai)</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">(<span class="kr">let</span> (<span class="nv">final</span>, items) :=
   foldr _apply_plan_folder (s, []) (rev [ai]) <span class="kr">in</span>
 (rev items, final)).<span class="mi">2</span> i = s i</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="Composition-v-chk1be" style="display: none" type="checkbox"><label class="alectryon-input" for="Composition-v-chk1be"><span class="nb">simpl</span>.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>message, index</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>EqDecision0</var><span class="hyp-type"><b>: </b><span>EqDecision index</span></span></span><br><span><var>IM</var><span class="hyp-type"><b>: </b><span>index ‚Üí VLSM message</span></span></span><br><span><var>Free</var><span><span class="hyp-body"><b>:= </b><span>free_composite_vlsm IM</span></span><span class="hyp-type"><b>: </b><span>VLSM message</span></span></span></span><br><span><var>s</var><span class="hyp-type"><b>: </b><span>state</span></span></span><br><span><var>ai</var><span class="hyp-type"><b>: </b><span>composite_plan_item IM</span></span></span><br><span><var>i</var><span class="hyp-type"><b>: </b><span>index</span></span></span><br><span><var>Hdif</var><span class="hyp-type"><b>: </b><span>i ‚â† projT1 (label_a ai)</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">(<span class="kr">let</span> (<span class="nv">final</span>, items) :=
   <span class="kr">match</span> ai <span class="kr">with</span>
   | {| label_a := l&#39;; input_a := input&#39; |} =&gt;
       <span class="kr">let</span> (<span class="nv">dest</span>, out) :=
         <span class="kr">let</span> (<span class="nv">i</span>, li) := l&#39; <span class="kr">in</span>
         <span class="kr">let</span> (<span class="nv">si&#39;</span>, om&#39;) :=
           vtransition (IM i) li (s i, input&#39;) <span class="kr">in</span>
         (state_update IM s i si&#39;, om&#39;) <span class="kr">in</span>
       (dest,
       [{|
          l := l&#39;;
          input := input&#39;;
          destination := dest;
          output := out
        |}])
   <span class="kr">end</span> <span class="kr">in</span>
 (rev items, final)).<span class="mi">2</span> i = s i</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="Composition-v-chk1bf" style="display: none" type="checkbox"><label class="alectryon-input" for="Composition-v-chk1bf"><span class="nb">destruct</span> ai.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>message, index</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>EqDecision0</var><span class="hyp-type"><b>: </b><span>EqDecision index</span></span></span><br><span><var>IM</var><span class="hyp-type"><b>: </b><span>index ‚Üí VLSM message</span></span></span><br><span><var>Free</var><span><span class="hyp-body"><b>:= </b><span>free_composite_vlsm IM</span></span><span class="hyp-type"><b>: </b><span>VLSM message</span></span></span></span><br><span><var>s</var><span class="hyp-type"><b>: </b><span>state</span></span></span><br><span><var>label_a</var><span class="hyp-type"><b>: </b><span>label</span></span></span><br><span><var>input_a</var><span class="hyp-type"><b>: </b><span>option message</span></span></span><br><span><var>i</var><span class="hyp-type"><b>: </b><span>index</span></span></span><br><span><var>Hdif</var><span class="hyp-type"><b>: </b><span>i
‚â† projT1
    (Plans.label_a
       {|
         label_a := label_a; input_a := input_a
       |})</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">(<span class="kr">let</span> (<span class="nv">final</span>, items) :=
   <span class="kr">let</span> (<span class="nv">dest</span>, out) :=
     <span class="kr">let</span> (<span class="nv">i</span>, li) := label_a <span class="kr">in</span>
     <span class="kr">let</span> (<span class="nv">si&#39;</span>, om&#39;) :=
       vtransition (IM i) li (s i, input_a) <span class="kr">in</span>
     (state_update IM s i si&#39;, om&#39;) <span class="kr">in</span>
   (dest,
   [{|
      l := label_a;
      input := input_a;
      destination := dest;
      output := out
    |}]) <span class="kr">in</span>
 (rev items, final)).<span class="mi">2</span> i = s i</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="Composition-v-chk1c0" style="display: none" type="checkbox"><label class="alectryon-input" for="Composition-v-chk1c0"><span class="kr">match goal with</span>
  |- <span class="kp">context</span> [<span class="kr">let</span> (<span class="nv">_</span>, _) := <span class="kr">let</span> (<span class="nv">_</span>, _) := <span class="nl">?t</span> <span class="kr">in</span> _ <span class="kr">in</span> _] =&gt;
    <span class="nb">destruct</span> t <span class="nb">eqn</span> : eq_trans
  <span class="kr">end</span>.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>message, index</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>EqDecision0</var><span class="hyp-type"><b>: </b><span>EqDecision index</span></span></span><br><span><var>IM</var><span class="hyp-type"><b>: </b><span>index ‚Üí VLSM message</span></span></span><br><span><var>Free</var><span><span class="hyp-body"><b>:= </b><span>free_composite_vlsm IM</span></span><span class="hyp-type"><b>: </b><span>VLSM message</span></span></span></span><br><span><var>s</var><span class="hyp-type"><b>: </b><span>state</span></span></span><br><span><var>label_a</var><span class="hyp-type"><b>: </b><span>label</span></span></span><br><span><var>input_a</var><span class="hyp-type"><b>: </b><span>option message</span></span></span><br><span><var>i</var><span class="hyp-type"><b>: </b><span>index</span></span></span><br><span><var>Hdif</var><span class="hyp-type"><b>: </b><span>i
‚â† projT1
    (Plans.label_a
       {|
         label_a := label_a; input_a := input_a
       |})</span></span></span><br><span><var>c</var><span class="hyp-type"><b>: </b><span>composite_state IM</span></span></span><br><span><var>o</var><span class="hyp-type"><b>: </b><span>option message</span></span></span><br><span><var>eq_trans</var><span class="hyp-type"><b>: </b><span>(<span class="kr">let</span> (<span class="nv">i</span>, li) := label_a <span class="kr">in</span>
 <span class="kr">let</span> (<span class="nv">si&#39;</span>, om&#39;) :=
   vtransition (IM i) li (s i, input_a) <span class="kr">in</span>
 (state_update IM s i si&#39;, om&#39;)) = 
(c, o)</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">(rev
   [{|
      l := label_a;
      input := input_a;
      destination := c;
      output := o
    |}], c).<span class="mi">2</span> i = s i</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="Composition-v-chk1c1" style="display: none" type="checkbox"><label class="alectryon-input" for="Composition-v-chk1c1"><span class="nb">simpl</span> <span class="kr">in</span> *.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>message, index</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>EqDecision0</var><span class="hyp-type"><b>: </b><span>EqDecision index</span></span></span><br><span><var>IM</var><span class="hyp-type"><b>: </b><span>index ‚Üí VLSM message</span></span></span><br><span><var>Free</var><span><span class="hyp-body"><b>:= </b><span>free_composite_vlsm IM</span></span><span class="hyp-type"><b>: </b><span>VLSM message</span></span></span></span><br><span><var>s</var><span class="hyp-type"><b>: </b><span>composite_state IM</span></span></span><br><span><var>label_a</var><span class="hyp-type"><b>: </b><span>composite_label IM</span></span></span><br><span><var>input_a</var><span class="hyp-type"><b>: </b><span>option message</span></span></span><br><span><var>i</var><span class="hyp-type"><b>: </b><span>index</span></span></span><br><span><var>Hdif</var><span class="hyp-type"><b>: </b><span>i ‚â† projT1 label_a</span></span></span><br><span><var>c</var><span class="hyp-type"><b>: </b><span>composite_state IM</span></span></span><br><span><var>o</var><span class="hyp-type"><b>: </b><span>option message</span></span></span><br><span><var>eq_trans</var><span class="hyp-type"><b>: </b><span>(<span class="kr">let</span> (<span class="nv">i</span>, li) := label_a <span class="kr">in</span>
 <span class="kr">let</span> (<span class="nv">si&#39;</span>, om&#39;) :=
   vtransition (IM i) li (s i, input_a) <span class="kr">in</span>
 (state_update IM s i si&#39;, om&#39;)) = 
(c, o)</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">c i = s i</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="Composition-v-chk1c2" style="display: none" type="checkbox"><label class="alectryon-input" for="Composition-v-chk1c2"><span class="nb">unfold</span> vtransition <span class="kr">in</span> eq_trans.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>message, index</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>EqDecision0</var><span class="hyp-type"><b>: </b><span>EqDecision index</span></span></span><br><span><var>IM</var><span class="hyp-type"><b>: </b><span>index ‚Üí VLSM message</span></span></span><br><span><var>Free</var><span><span class="hyp-body"><b>:= </b><span>free_composite_vlsm IM</span></span><span class="hyp-type"><b>: </b><span>VLSM message</span></span></span></span><br><span><var>s</var><span class="hyp-type"><b>: </b><span>composite_state IM</span></span></span><br><span><var>label_a</var><span class="hyp-type"><b>: </b><span>composite_label IM</span></span></span><br><span><var>input_a</var><span class="hyp-type"><b>: </b><span>option message</span></span></span><br><span><var>i</var><span class="hyp-type"><b>: </b><span>index</span></span></span><br><span><var>Hdif</var><span class="hyp-type"><b>: </b><span>i ‚â† projT1 label_a</span></span></span><br><span><var>c</var><span class="hyp-type"><b>: </b><span>composite_state IM</span></span></span><br><span><var>o</var><span class="hyp-type"><b>: </b><span>option message</span></span></span><br><span><var>eq_trans</var><span class="hyp-type"><b>: </b><span>(<span class="kr">let</span> (<span class="nv">i</span>, li) := label_a <span class="kr">in</span>
 <span class="kr">let</span> (<span class="nv">si&#39;</span>, om&#39;) :=
   transition li (s i, input_a) <span class="kr">in</span>
 (state_update IM s i si&#39;, om&#39;)) = 
(c, o)</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">c i = s i</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="Composition-v-chk1c3" style="display: none" type="checkbox"><label class="alectryon-input" for="Composition-v-chk1c3"><span class="nb">simpl</span> <span class="kr">in</span> eq_trans.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>message, index</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>EqDecision0</var><span class="hyp-type"><b>: </b><span>EqDecision index</span></span></span><br><span><var>IM</var><span class="hyp-type"><b>: </b><span>index ‚Üí VLSM message</span></span></span><br><span><var>Free</var><span><span class="hyp-body"><b>:= </b><span>free_composite_vlsm IM</span></span><span class="hyp-type"><b>: </b><span>VLSM message</span></span></span></span><br><span><var>s</var><span class="hyp-type"><b>: </b><span>composite_state IM</span></span></span><br><span><var>label_a</var><span class="hyp-type"><b>: </b><span>composite_label IM</span></span></span><br><span><var>input_a</var><span class="hyp-type"><b>: </b><span>option message</span></span></span><br><span><var>i</var><span class="hyp-type"><b>: </b><span>index</span></span></span><br><span><var>Hdif</var><span class="hyp-type"><b>: </b><span>i ‚â† projT1 label_a</span></span></span><br><span><var>c</var><span class="hyp-type"><b>: </b><span>composite_state IM</span></span></span><br><span><var>o</var><span class="hyp-type"><b>: </b><span>option message</span></span></span><br><span><var>eq_trans</var><span class="hyp-type"><b>: </b><span>(<span class="kr">let</span> (<span class="nv">i</span>, li) := label_a <span class="kr">in</span>
 <span class="kr">let</span> (<span class="nv">si&#39;</span>, om&#39;) :=
   transition li (s i, input_a) <span class="kr">in</span>
 (state_update IM s i si&#39;, om&#39;)) = 
(c, o)</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">c i = s i</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="Composition-v-chk1c4" style="display: none" type="checkbox"><label class="alectryon-input" for="Composition-v-chk1c4"><span class="nb">destruct</span> label_a; <span class="nb">simpl</span> <span class="kr">in</span> *.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>message, index</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>EqDecision0</var><span class="hyp-type"><b>: </b><span>EqDecision index</span></span></span><br><span><var>IM</var><span class="hyp-type"><b>: </b><span>index ‚Üí VLSM message</span></span></span><br><span><var>Free</var><span><span class="hyp-body"><b>:= </b><span>free_composite_vlsm IM</span></span><span class="hyp-type"><b>: </b><span>VLSM message</span></span></span></span><br><span><var>s</var><span class="hyp-type"><b>: </b><span>composite_state IM</span></span></span><br><span><var>x</var><span class="hyp-type"><b>: </b><span>index</span></span></span><br><span><var>v</var><span class="hyp-type"><b>: </b><span>vlabel (IM x)</span></span></span><br><span><var>input_a</var><span class="hyp-type"><b>: </b><span>option message</span></span></span><br><span><var>i</var><span class="hyp-type"><b>: </b><span>index</span></span></span><br><span><var>Hdif</var><span class="hyp-type"><b>: </b><span>i ‚â† x</span></span></span><br><span><var>c</var><span class="hyp-type"><b>: </b><span>composite_state IM</span></span></span><br><span><var>o</var><span class="hyp-type"><b>: </b><span>option message</span></span></span><br><span><var>eq_trans</var><span class="hyp-type"><b>: </b><span>(<span class="kr">let</span> (<span class="nv">si&#39;</span>, om&#39;) :=
   transition v (s x, input_a) <span class="kr">in</span>
 (state_update IM s x si&#39;, om&#39;)) = 
(c, o)</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">c i = s i</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="Composition-v-chk1c5" style="display: none" type="checkbox"><label class="alectryon-input" for="Composition-v-chk1c5"><span class="kr">match</span> <span class="kp">type of</span> eq_trans <span class="kr">with</span>
  | (<span class="kr">let</span> (<span class="nv">si&#39;</span>, om&#39;) := <span class="nl">?t</span> <span class="kr">in</span> _) = _ =&gt; <span class="nb">destruct</span> t <span class="kr">end</span>.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>message, index</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>EqDecision0</var><span class="hyp-type"><b>: </b><span>EqDecision index</span></span></span><br><span><var>IM</var><span class="hyp-type"><b>: </b><span>index ‚Üí VLSM message</span></span></span><br><span><var>Free</var><span><span class="hyp-body"><b>:= </b><span>free_composite_vlsm IM</span></span><span class="hyp-type"><b>: </b><span>VLSM message</span></span></span></span><br><span><var>s</var><span class="hyp-type"><b>: </b><span>composite_state IM</span></span></span><br><span><var>x</var><span class="hyp-type"><b>: </b><span>index</span></span></span><br><span><var>v</var><span class="hyp-type"><b>: </b><span>vlabel (IM x)</span></span></span><br><span><var>input_a</var><span class="hyp-type"><b>: </b><span>option message</span></span></span><br><span><var>i</var><span class="hyp-type"><b>: </b><span>index</span></span></span><br><span><var>Hdif</var><span class="hyp-type"><b>: </b><span>i ‚â† x</span></span></span><br><span><var>c</var><span class="hyp-type"><b>: </b><span>composite_state IM</span></span></span><br><span><var>o</var><span class="hyp-type"><b>: </b><span>option message</span></span></span><br><span><var>s0</var><span class="hyp-type"><b>: </b><span>state</span></span></span><br><span><var>o0</var><span class="hyp-type"><b>: </b><span>option message</span></span></span><br><span><var>eq_trans</var><span class="hyp-type"><b>: </b><span>(state_update IM s x s0, o0) = (c, o)</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">c i = s i</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="Composition-v-chk1c6" style="display: none" type="checkbox"><label class="alectryon-input" for="Composition-v-chk1c6"><span class="nb">inversion</span> eq_trans.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>message, index</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>EqDecision0</var><span class="hyp-type"><b>: </b><span>EqDecision index</span></span></span><br><span><var>IM</var><span class="hyp-type"><b>: </b><span>index ‚Üí VLSM message</span></span></span><br><span><var>Free</var><span><span class="hyp-body"><b>:= </b><span>free_composite_vlsm IM</span></span><span class="hyp-type"><b>: </b><span>VLSM message</span></span></span></span><br><span><var>s</var><span class="hyp-type"><b>: </b><span>composite_state IM</span></span></span><br><span><var>x</var><span class="hyp-type"><b>: </b><span>index</span></span></span><br><span><var>v</var><span class="hyp-type"><b>: </b><span>vlabel (IM x)</span></span></span><br><span><var>input_a</var><span class="hyp-type"><b>: </b><span>option message</span></span></span><br><span><var>i</var><span class="hyp-type"><b>: </b><span>index</span></span></span><br><span><var>Hdif</var><span class="hyp-type"><b>: </b><span>i ‚â† x</span></span></span><br><span><var>c</var><span class="hyp-type"><b>: </b><span>composite_state IM</span></span></span><br><span><var>o</var><span class="hyp-type"><b>: </b><span>option message</span></span></span><br><span><var>s0</var><span class="hyp-type"><b>: </b><span>state</span></span></span><br><span><var>o0</var><span class="hyp-type"><b>: </b><span>option message</span></span></span><br><span><var>eq_trans</var><span class="hyp-type"><b>: </b><span>(state_update IM s x s0, o0) = (c, o)</span></span></span><br><span><var>H0</var><span class="hyp-type"><b>: </b><span>state_update IM s x s0 = c</span></span></span><br><span><var>H1</var><span class="hyp-type"><b>: </b><span>o0 = o</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">state_update IM s x s0 i = s i</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><span class="alectryon-input"><span class="bp">by</span> state_update_simpl.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Qed</span>.</span></span></pre><div class="doc">
  Same as <span class="inlinecode"><span class="id" title="var">irrelevant_components_one</span></span>, but for
  multiple transitions.

</div><pre class="alectryon-io highlight"><!-- Generator: Alectryon --><span class="alectryon-sentence"><input class="alectryon-toggle" id="Composition-v-chk1c7" style="display: none" type="checkbox"><label class="alectryon-input" for="Composition-v-chk1c7"><span class="kn">Lemma</span> <span class="nf">irrelevant_components</span>
  (<span class="nv">s</span> : state)
  (<span class="nv">a</span> : composite_plan IM)
  (<span class="nv">a_indices</span> := List.map (@projT1 _ _) (List.map (@label_a _ _) a))
  (<span class="nv">i</span> : index)
  (<span class="nv">Hdif</span> : i ‚àâ a_indices) :
  <span class="kr">let</span> <span class="nv">res</span> := snd (composite_apply_plan IM s a) <span class="kr">in</span>
  (res i) = (s i).</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>message, index</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>EqDecision0</var><span class="hyp-type"><b>: </b><span>EqDecision index</span></span></span><br><span><var>IM</var><span class="hyp-type"><b>: </b><span>index ‚Üí VLSM message</span></span></span><br><span><var>Free</var><span><span class="hyp-body"><b>:= </b><span>free_composite_vlsm IM</span></span><span class="hyp-type"><b>: </b><span>VLSM message</span></span></span></span><br><span><var>s</var><span class="hyp-type"><b>: </b><span>state</span></span></span><br><span><var>a</var><span class="hyp-type"><b>: </b><span>composite_plan IM</span></span></span><br><span><var>a_indices</var><span><span class="hyp-body"><b>:= </b><span>List.map projT1 (List.map label_a a)</span></span><span class="hyp-type"><b>: </b><span>list index</span></span></span></span><br><span><var>i</var><span class="hyp-type"><b>: </b><span>index</span></span></span><br><span><var>Hdif</var><span class="hyp-type"><b>: </b><span>i ‚àâ a_indices</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="kr">let</span> <span class="nv">res</span> := (composite_apply_plan IM s a).<span class="mi">2</span> <span class="kr">in</span>
res i = s i</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="Composition-v-chk1c8" style="display: none" type="checkbox"><label class="alectryon-input" for="Composition-v-chk1c8"><span class="kn">Proof</span>.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>message, index</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>EqDecision0</var><span class="hyp-type"><b>: </b><span>EqDecision index</span></span></span><br><span><var>IM</var><span class="hyp-type"><b>: </b><span>index ‚Üí VLSM message</span></span></span><br><span><var>Free</var><span><span class="hyp-body"><b>:= </b><span>free_composite_vlsm IM</span></span><span class="hyp-type"><b>: </b><span>VLSM message</span></span></span></span><br><span><var>s</var><span class="hyp-type"><b>: </b><span>state</span></span></span><br><span><var>a</var><span class="hyp-type"><b>: </b><span>composite_plan IM</span></span></span><br><span><var>a_indices</var><span><span class="hyp-body"><b>:= </b><span>List.map projT1 (List.map label_a a)</span></span><span class="hyp-type"><b>: </b><span>list index</span></span></span></span><br><span><var>i</var><span class="hyp-type"><b>: </b><span>index</span></span></span><br><span><var>Hdif</var><span class="hyp-type"><b>: </b><span>i ‚àâ a_indices</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="kr">let</span> <span class="nv">res</span> := (composite_apply_plan IM s a).<span class="mi">2</span> <span class="kr">in</span>
res i = s i</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="Composition-v-chk1c9" style="display: none" type="checkbox"><label class="alectryon-input" for="Composition-v-chk1c9"><span class="nb">induction</span> a <span class="nb">using</span> rev_ind.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>message, index</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>EqDecision0</var><span class="hyp-type"><b>: </b><span>EqDecision index</span></span></span><br><span><var>IM</var><span class="hyp-type"><b>: </b><span>index ‚Üí VLSM message</span></span></span><br><span><var>Free</var><span><span class="hyp-body"><b>:= </b><span>free_composite_vlsm IM</span></span><span class="hyp-type"><b>: </b><span>VLSM message</span></span></span></span><br><span><var>s</var><span class="hyp-type"><b>: </b><span>state</span></span></span><br><span><var>a_indices</var><span><span class="hyp-body"><b>:= </b><span>List.map projT1 (List.map label_a [])</span></span><span class="hyp-type"><b>: </b><span>list index</span></span></span></span><br><span><var>i</var><span class="hyp-type"><b>: </b><span>index</span></span></span><br><span><var>Hdif</var><span class="hyp-type"><b>: </b><span>i ‚àâ a_indices</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="kr">let</span> <span class="nv">res</span> := (composite_apply_plan IM s []).<span class="mi">2</span> <span class="kr">in</span>
res i = s i</div></blockquote><div class="alectryon-extra-goals"><input class="alectryon-extra-goal-toggle" id="Composition-v-chk1ca" style="display: none" type="checkbox"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>message, index</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>EqDecision0</var><span class="hyp-type"><b>: </b><span>EqDecision index</span></span></span><br><span><var>IM</var><span class="hyp-type"><b>: </b><span>index ‚Üí VLSM message</span></span></span><br><span><var>Free</var><span><span class="hyp-body"><b>:= </b><span>free_composite_vlsm IM</span></span><span class="hyp-type"><b>: </b><span>VLSM message</span></span></span></span><br><span><var>s</var><span class="hyp-type"><b>: </b><span>state</span></span></span><br><span><var>x</var><span class="hyp-type"><b>: </b><span>composite_plan_item IM</span></span></span><br><span><var>a</var><span class="hyp-type"><b>: </b><span>list (composite_plan_item IM)</span></span></span><br><span><var>a_indices</var><span><span class="hyp-body"><b>:= </b><span>List.map projT1
  (List.map label_a (a ++ [x]))</span></span><span class="hyp-type"><b>: </b><span>list index</span></span></span></span><br><span><var>i</var><span class="hyp-type"><b>: </b><span>index</span></span></span><br><span><var>Hdif</var><span class="hyp-type"><b>: </b><span>i ‚àâ a_indices</span></span></span><br><span><var>IHa</var><span class="hyp-type"><b>: </b><span><span class="kr">let</span> <span class="nv">a_indices</span> :=
  List.map projT1 (List.map label_a a) <span class="kr">in</span>
i ‚àâ a_indices
‚Üí <span class="kr">let</span> <span class="nv">res</span> := (composite_apply_plan IM s a).<span class="mi">2</span> <span class="kr">in</span>
  res i = s i</span></span></span><br></div><label class="goal-separator" for="Composition-v-chk1ca"><hr></label><div class="goal-conclusion"><span class="kr">let</span> <span class="nv">res</span> := (composite_apply_plan IM s (a ++ [x])).<span class="mi">2</span> <span class="kr">in</span>
res i = s i</div></blockquote></div></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="Composition-v-chk1cb" style="display: none" type="checkbox"><label class="alectryon-input" for="Composition-v-chk1cb">-</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>message, index</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>EqDecision0</var><span class="hyp-type"><b>: </b><span>EqDecision index</span></span></span><br><span><var>IM</var><span class="hyp-type"><b>: </b><span>index ‚Üí VLSM message</span></span></span><br><span><var>Free</var><span><span class="hyp-body"><b>:= </b><span>free_composite_vlsm IM</span></span><span class="hyp-type"><b>: </b><span>VLSM message</span></span></span></span><br><span><var>s</var><span class="hyp-type"><b>: </b><span>state</span></span></span><br><span><var>a_indices</var><span><span class="hyp-body"><b>:= </b><span>List.map projT1 (List.map label_a [])</span></span><span class="hyp-type"><b>: </b><span>list index</span></span></span></span><br><span><var>i</var><span class="hyp-type"><b>: </b><span>index</span></span></span><br><span><var>Hdif</var><span class="hyp-type"><b>: </b><span>i ‚àâ a_indices</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="kr">let</span> <span class="nv">res</span> := (composite_apply_plan IM s []).<span class="mi">2</span> <span class="kr">in</span>
res i = s i</div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="nb">simpl</span>; itauto.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="Composition-v-chk1cc" style="display: none" type="checkbox"><label class="alectryon-input" for="Composition-v-chk1cc">-</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>message, index</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>EqDecision0</var><span class="hyp-type"><b>: </b><span>EqDecision index</span></span></span><br><span><var>IM</var><span class="hyp-type"><b>: </b><span>index ‚Üí VLSM message</span></span></span><br><span><var>Free</var><span><span class="hyp-body"><b>:= </b><span>free_composite_vlsm IM</span></span><span class="hyp-type"><b>: </b><span>VLSM message</span></span></span></span><br><span><var>s</var><span class="hyp-type"><b>: </b><span>state</span></span></span><br><span><var>x</var><span class="hyp-type"><b>: </b><span>composite_plan_item IM</span></span></span><br><span><var>a</var><span class="hyp-type"><b>: </b><span>list (composite_plan_item IM)</span></span></span><br><span><var>a_indices</var><span><span class="hyp-body"><b>:= </b><span>List.map projT1
  (List.map label_a (a ++ [x]))</span></span><span class="hyp-type"><b>: </b><span>list index</span></span></span></span><br><span><var>i</var><span class="hyp-type"><b>: </b><span>index</span></span></span><br><span><var>Hdif</var><span class="hyp-type"><b>: </b><span>i ‚àâ a_indices</span></span></span><br><span><var>IHa</var><span class="hyp-type"><b>: </b><span><span class="kr">let</span> <span class="nv">a_indices</span> :=
  List.map projT1 (List.map label_a a) <span class="kr">in</span>
i ‚àâ a_indices
‚Üí <span class="kr">let</span> <span class="nv">res</span> := (composite_apply_plan IM s a).<span class="mi">2</span> <span class="kr">in</span>
  res i = s i</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="kr">let</span> <span class="nv">res</span> := (composite_apply_plan IM s (a ++ [x])).<span class="mi">2</span> <span class="kr">in</span>
res i = s i</div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="Composition-v-chk1cd" style="display: none" type="checkbox"><label class="alectryon-input" for="Composition-v-chk1cd"><span class="nb">simpl</span> <span class="kr">in</span> *.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>message, index</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>EqDecision0</var><span class="hyp-type"><b>: </b><span>EqDecision index</span></span></span><br><span><var>IM</var><span class="hyp-type"><b>: </b><span>index ‚Üí VLSM message</span></span></span><br><span><var>Free</var><span><span class="hyp-body"><b>:= </b><span>free_composite_vlsm IM</span></span><span class="hyp-type"><b>: </b><span>VLSM message</span></span></span></span><br><span><var>s</var><span class="hyp-type"><b>: </b><span>composite_state IM</span></span></span><br><span><var>x</var><span class="hyp-type"><b>: </b><span>composite_plan_item IM</span></span></span><br><span><var>a</var><span class="hyp-type"><b>: </b><span>list (composite_plan_item IM)</span></span></span><br><span><var>a_indices</var><span><span class="hyp-body"><b>:= </b><span>List.map projT1
  (List.map label_a (a ++ [x]))</span></span><span class="hyp-type"><b>: </b><span>list index</span></span></span></span><br><span><var>i</var><span class="hyp-type"><b>: </b><span>index</span></span></span><br><span><var>Hdif</var><span class="hyp-type"><b>: </b><span>i ‚àâ a_indices</span></span></span><br><span><var>IHa</var><span class="hyp-type"><b>: </b><span>i ‚àâ List.map projT1 (List.map label_a a)
‚Üí (composite_apply_plan IM s a).<span class="mi">2</span> i = s i</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">(composite_apply_plan IM s (a ++ [x])).<span class="mi">2</span> i = s i</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="Composition-v-chk1ce" style="display: none" type="checkbox"><label class="alectryon-input" for="Composition-v-chk1ce"><span class="nb">rewrite</span> (composite_apply_plan_app IM).</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>message, index</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>EqDecision0</var><span class="hyp-type"><b>: </b><span>EqDecision index</span></span></span><br><span><var>IM</var><span class="hyp-type"><b>: </b><span>index ‚Üí VLSM message</span></span></span><br><span><var>Free</var><span><span class="hyp-body"><b>:= </b><span>free_composite_vlsm IM</span></span><span class="hyp-type"><b>: </b><span>VLSM message</span></span></span></span><br><span><var>s</var><span class="hyp-type"><b>: </b><span>composite_state IM</span></span></span><br><span><var>x</var><span class="hyp-type"><b>: </b><span>composite_plan_item IM</span></span></span><br><span><var>a</var><span class="hyp-type"><b>: </b><span>list (composite_plan_item IM)</span></span></span><br><span><var>a_indices</var><span><span class="hyp-body"><b>:= </b><span>List.map projT1
  (List.map label_a (a ++ [x]))</span></span><span class="hyp-type"><b>: </b><span>list index</span></span></span></span><br><span><var>i</var><span class="hyp-type"><b>: </b><span>index</span></span></span><br><span><var>Hdif</var><span class="hyp-type"><b>: </b><span>i ‚àâ a_indices</span></span></span><br><span><var>IHa</var><span class="hyp-type"><b>: </b><span>i ‚àâ List.map projT1 (List.map label_a a)
‚Üí (composite_apply_plan IM s a).<span class="mi">2</span> i = s i</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">(<span class="kr">let</span> (<span class="nv">aitems</span>, afinal) :=
   composite_apply_plan IM s a <span class="kr">in</span>
 <span class="kr">let</span> (<span class="nv">a&#39;items</span>, a&#39;final) :=
   composite_apply_plan IM afinal [x] <span class="kr">in</span>
 (aitems ++ a&#39;items, a&#39;final)).<span class="mi">2</span> i = s i</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="Composition-v-chk1cf" style="display: none" type="checkbox"><label class="alectryon-input" for="Composition-v-chk1cf"><span class="nb">destruct</span> (composite_apply_plan IM s a) <span class="kr">as</span> (tra, sa) <span class="nb">eqn</span> : eq_a; <span class="nb">simpl</span> <span class="kr">in</span> *.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>message, index</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>EqDecision0</var><span class="hyp-type"><b>: </b><span>EqDecision index</span></span></span><br><span><var>IM</var><span class="hyp-type"><b>: </b><span>index ‚Üí VLSM message</span></span></span><br><span><var>Free</var><span><span class="hyp-body"><b>:= </b><span>free_composite_vlsm IM</span></span><span class="hyp-type"><b>: </b><span>VLSM message</span></span></span></span><br><span><var>s</var><span class="hyp-type"><b>: </b><span>composite_state IM</span></span></span><br><span><var>x</var><span class="hyp-type"><b>: </b><span>composite_plan_item IM</span></span></span><br><span><var>a</var><span class="hyp-type"><b>: </b><span>list (composite_plan_item IM)</span></span></span><br><span><var>a_indices</var><span><span class="hyp-body"><b>:= </b><span>List.map projT1
  (List.map label_a (a ++ [x]))</span></span><span class="hyp-type"><b>: </b><span>list index</span></span></span></span><br><span><var>i</var><span class="hyp-type"><b>: </b><span>index</span></span></span><br><span><var>Hdif</var><span class="hyp-type"><b>: </b><span>i ‚àâ a_indices</span></span></span><br><span><var>tra</var><span class="hyp-type"><b>: </b><span>list transition_item</span></span></span><br><span><var>sa</var><span class="hyp-type"><b>: </b><span>composite_state IM</span></span></span><br><span><var>eq_a</var><span class="hyp-type"><b>: </b><span>composite_apply_plan IM s a = (tra, sa)</span></span></span><br><span><var>IHa</var><span class="hyp-type"><b>: </b><span>i ‚àâ List.map projT1 (List.map label_a a)
‚Üí sa i = s i</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">(<span class="kr">let</span> (<span class="nv">a&#39;items</span>, a&#39;final) :=
   composite_apply_plan IM sa [x] <span class="kr">in</span>
 (tra ++ a&#39;items, a&#39;final)).<span class="mi">2</span> i = s i</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="Composition-v-chk1d0" style="display: none" type="checkbox"><label class="alectryon-input" for="Composition-v-chk1d0"><span class="nb">destruct</span> (composite_apply_plan IM sa [x]) <span class="kr">as</span> (trx, sx) <span class="nb">eqn</span> : eq_x; <span class="nb">simpl</span> <span class="kr">in</span> *.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>message, index</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>EqDecision0</var><span class="hyp-type"><b>: </b><span>EqDecision index</span></span></span><br><span><var>IM</var><span class="hyp-type"><b>: </b><span>index ‚Üí VLSM message</span></span></span><br><span><var>Free</var><span><span class="hyp-body"><b>:= </b><span>free_composite_vlsm IM</span></span><span class="hyp-type"><b>: </b><span>VLSM message</span></span></span></span><br><span><var>s</var><span class="hyp-type"><b>: </b><span>composite_state IM</span></span></span><br><span><var>x</var><span class="hyp-type"><b>: </b><span>composite_plan_item IM</span></span></span><br><span><var>a</var><span class="hyp-type"><b>: </b><span>list (composite_plan_item IM)</span></span></span><br><span><var>a_indices</var><span><span class="hyp-body"><b>:= </b><span>List.map projT1
  (List.map label_a (a ++ [x]))</span></span><span class="hyp-type"><b>: </b><span>list index</span></span></span></span><br><span><var>i</var><span class="hyp-type"><b>: </b><span>index</span></span></span><br><span><var>Hdif</var><span class="hyp-type"><b>: </b><span>i ‚àâ a_indices</span></span></span><br><span><var>tra</var><span class="hyp-type"><b>: </b><span>list transition_item</span></span></span><br><span><var>sa</var><span class="hyp-type"><b>: </b><span>composite_state IM</span></span></span><br><span><var>eq_a</var><span class="hyp-type"><b>: </b><span>composite_apply_plan IM s a = (tra, sa)</span></span></span><br><span><var>IHa</var><span class="hyp-type"><b>: </b><span>i ‚àâ List.map projT1 (List.map label_a a)
‚Üí sa i = s i</span></span></span><br><span><var>trx</var><span class="hyp-type"><b>: </b><span>list transition_item</span></span></span><br><span><var>sx</var><span class="hyp-type"><b>: </b><span>composite_state IM</span></span></span><br><span><var>eq_x</var><span class="hyp-type"><b>: </b><span>composite_apply_plan IM sa [x] = (trx, sx)</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">sx i = s i</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
</span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="Composition-v-chk1d1" style="display: none" type="checkbox"><label class="alectryon-input" for="Composition-v-chk1d1"><span class="nb">unfold</span> a_indices <span class="kr">in</span> Hdif.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>message, index</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>EqDecision0</var><span class="hyp-type"><b>: </b><span>EqDecision index</span></span></span><br><span><var>IM</var><span class="hyp-type"><b>: </b><span>index ‚Üí VLSM message</span></span></span><br><span><var>Free</var><span><span class="hyp-body"><b>:= </b><span>free_composite_vlsm IM</span></span><span class="hyp-type"><b>: </b><span>VLSM message</span></span></span></span><br><span><var>s</var><span class="hyp-type"><b>: </b><span>composite_state IM</span></span></span><br><span><var>x</var><span class="hyp-type"><b>: </b><span>composite_plan_item IM</span></span></span><br><span><var>a</var><span class="hyp-type"><b>: </b><span>list (composite_plan_item IM)</span></span></span><br><span><var>a_indices</var><span><span class="hyp-body"><b>:= </b><span>List.map projT1
  (List.map label_a (a ++ [x]))</span></span><span class="hyp-type"><b>: </b><span>list index</span></span></span></span><br><span><var>i</var><span class="hyp-type"><b>: </b><span>index</span></span></span><br><span><var>Hdif</var><span class="hyp-type"><b>: </b><span>i
‚àâ List.map projT1 (List.map label_a (a ++ [x]))</span></span></span><br><span><var>tra</var><span class="hyp-type"><b>: </b><span>list transition_item</span></span></span><br><span><var>sa</var><span class="hyp-type"><b>: </b><span>composite_state IM</span></span></span><br><span><var>eq_a</var><span class="hyp-type"><b>: </b><span>composite_apply_plan IM s a = (tra, sa)</span></span></span><br><span><var>IHa</var><span class="hyp-type"><b>: </b><span>i ‚àâ List.map projT1 (List.map label_a a)
‚Üí sa i = s i</span></span></span><br><span><var>trx</var><span class="hyp-type"><b>: </b><span>list transition_item</span></span></span><br><span><var>sx</var><span class="hyp-type"><b>: </b><span>composite_state IM</span></span></span><br><span><var>eq_x</var><span class="hyp-type"><b>: </b><span>composite_apply_plan IM sa [x] = (trx, sx)</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">sx i = s i</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="Composition-v-chk1d2" style="display: none" type="checkbox"><label class="alectryon-input" for="Composition-v-chk1d2"><span class="nb">rewrite</span> map_app <span class="kr">in</span> Hdif.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>message, index</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>EqDecision0</var><span class="hyp-type"><b>: </b><span>EqDecision index</span></span></span><br><span><var>IM</var><span class="hyp-type"><b>: </b><span>index ‚Üí VLSM message</span></span></span><br><span><var>Free</var><span><span class="hyp-body"><b>:= </b><span>free_composite_vlsm IM</span></span><span class="hyp-type"><b>: </b><span>VLSM message</span></span></span></span><br><span><var>s</var><span class="hyp-type"><b>: </b><span>composite_state IM</span></span></span><br><span><var>x</var><span class="hyp-type"><b>: </b><span>composite_plan_item IM</span></span></span><br><span><var>a</var><span class="hyp-type"><b>: </b><span>list (composite_plan_item IM)</span></span></span><br><span><var>a_indices</var><span><span class="hyp-body"><b>:= </b><span>List.map projT1
  (List.map label_a (a ++ [x]))</span></span><span class="hyp-type"><b>: </b><span>list index</span></span></span></span><br><span><var>i</var><span class="hyp-type"><b>: </b><span>index</span></span></span><br><span><var>Hdif</var><span class="hyp-type"><b>: </b><span>i
‚àâ List.map projT1
    (List.map label_a a ++ List.map label_a [x])</span></span></span><br><span><var>tra</var><span class="hyp-type"><b>: </b><span>list transition_item</span></span></span><br><span><var>sa</var><span class="hyp-type"><b>: </b><span>composite_state IM</span></span></span><br><span><var>eq_a</var><span class="hyp-type"><b>: </b><span>composite_apply_plan IM s a = (tra, sa)</span></span></span><br><span><var>IHa</var><span class="hyp-type"><b>: </b><span>i ‚àâ List.map projT1 (List.map label_a a)
‚Üí sa i = s i</span></span></span><br><span><var>trx</var><span class="hyp-type"><b>: </b><span>list transition_item</span></span></span><br><span><var>sx</var><span class="hyp-type"><b>: </b><span>composite_state IM</span></span></span><br><span><var>eq_x</var><span class="hyp-type"><b>: </b><span>composite_apply_plan IM sa [x] = (trx, sx)</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">sx i = s i</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="Composition-v-chk1d3" style="display: none" type="checkbox"><label class="alectryon-input" for="Composition-v-chk1d3"><span class="nb">rewrite</span> map_app <span class="kr">in</span> Hdif.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>message, index</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>EqDecision0</var><span class="hyp-type"><b>: </b><span>EqDecision index</span></span></span><br><span><var>IM</var><span class="hyp-type"><b>: </b><span>index ‚Üí VLSM message</span></span></span><br><span><var>Free</var><span><span class="hyp-body"><b>:= </b><span>free_composite_vlsm IM</span></span><span class="hyp-type"><b>: </b><span>VLSM message</span></span></span></span><br><span><var>s</var><span class="hyp-type"><b>: </b><span>composite_state IM</span></span></span><br><span><var>x</var><span class="hyp-type"><b>: </b><span>composite_plan_item IM</span></span></span><br><span><var>a</var><span class="hyp-type"><b>: </b><span>list (composite_plan_item IM)</span></span></span><br><span><var>a_indices</var><span><span class="hyp-body"><b>:= </b><span>List.map projT1
  (List.map label_a (a ++ [x]))</span></span><span class="hyp-type"><b>: </b><span>list index</span></span></span></span><br><span><var>i</var><span class="hyp-type"><b>: </b><span>index</span></span></span><br><span><var>Hdif</var><span class="hyp-type"><b>: </b><span>i
‚àâ List.map projT1 (List.map label_a a) ++
  List.map projT1 (List.map label_a [x])</span></span></span><br><span><var>tra</var><span class="hyp-type"><b>: </b><span>list transition_item</span></span></span><br><span><var>sa</var><span class="hyp-type"><b>: </b><span>composite_state IM</span></span></span><br><span><var>eq_a</var><span class="hyp-type"><b>: </b><span>composite_apply_plan IM s a = (tra, sa)</span></span></span><br><span><var>IHa</var><span class="hyp-type"><b>: </b><span>i ‚àâ List.map projT1 (List.map label_a a)
‚Üí sa i = s i</span></span></span><br><span><var>trx</var><span class="hyp-type"><b>: </b><span>list transition_item</span></span></span><br><span><var>sx</var><span class="hyp-type"><b>: </b><span>composite_state IM</span></span></span><br><span><var>eq_x</var><span class="hyp-type"><b>: </b><span>composite_apply_plan IM sa [x] = (trx, sx)</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">sx i = s i</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
</span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="Composition-v-chk1d4" style="display: none" type="checkbox"><label class="alectryon-input" for="Composition-v-chk1d4">spec IHa.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>message, index</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>EqDecision0</var><span class="hyp-type"><b>: </b><span>EqDecision index</span></span></span><br><span><var>IM</var><span class="hyp-type"><b>: </b><span>index ‚Üí VLSM message</span></span></span><br><span><var>Free</var><span><span class="hyp-body"><b>:= </b><span>free_composite_vlsm IM</span></span><span class="hyp-type"><b>: </b><span>VLSM message</span></span></span></span><br><span><var>s</var><span class="hyp-type"><b>: </b><span>composite_state IM</span></span></span><br><span><var>x</var><span class="hyp-type"><b>: </b><span>composite_plan_item IM</span></span></span><br><span><var>a</var><span class="hyp-type"><b>: </b><span>list (composite_plan_item IM)</span></span></span><br><span><var>a_indices</var><span><span class="hyp-body"><b>:= </b><span>List.map projT1
  (List.map label_a (a ++ [x]))</span></span><span class="hyp-type"><b>: </b><span>list index</span></span></span></span><br><span><var>i</var><span class="hyp-type"><b>: </b><span>index</span></span></span><br><span><var>Hdif</var><span class="hyp-type"><b>: </b><span>i
‚àâ List.map projT1 (List.map label_a a) ++
  List.map projT1 (List.map label_a [x])</span></span></span><br><span><var>tra</var><span class="hyp-type"><b>: </b><span>list transition_item</span></span></span><br><span><var>sa</var><span class="hyp-type"><b>: </b><span>composite_state IM</span></span></span><br><span><var>eq_a</var><span class="hyp-type"><b>: </b><span>composite_apply_plan IM s a = (tra, sa)</span></span></span><br><span><var>IHa</var><span class="hyp-type"><b>: </b><span>i ‚àâ List.map projT1 (List.map label_a a)
‚Üí sa i = s i</span></span></span><br><span><var>trx</var><span class="hyp-type"><b>: </b><span>list transition_item</span></span></span><br><span><var>sx</var><span class="hyp-type"><b>: </b><span>composite_state IM</span></span></span><br><span><var>eq_x</var><span class="hyp-type"><b>: </b><span>composite_apply_plan IM sa [x] = (trx, sx)</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">i ‚àâ List.map projT1 (List.map label_a a)</div></blockquote><div class="alectryon-extra-goals"><input class="alectryon-extra-goal-toggle" id="Composition-v-chk1d5" style="display: none" type="checkbox"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>message, index</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>EqDecision0</var><span class="hyp-type"><b>: </b><span>EqDecision index</span></span></span><br><span><var>IM</var><span class="hyp-type"><b>: </b><span>index ‚Üí VLSM message</span></span></span><br><span><var>Free</var><span><span class="hyp-body"><b>:= </b><span>free_composite_vlsm IM</span></span><span class="hyp-type"><b>: </b><span>VLSM message</span></span></span></span><br><span><var>s</var><span class="hyp-type"><b>: </b><span>composite_state IM</span></span></span><br><span><var>x</var><span class="hyp-type"><b>: </b><span>composite_plan_item IM</span></span></span><br><span><var>a</var><span class="hyp-type"><b>: </b><span>list (composite_plan_item IM)</span></span></span><br><span><var>a_indices</var><span><span class="hyp-body"><b>:= </b><span>List.map projT1
  (List.map label_a (a ++ [x]))</span></span><span class="hyp-type"><b>: </b><span>list index</span></span></span></span><br><span><var>i</var><span class="hyp-type"><b>: </b><span>index</span></span></span><br><span><var>Hdif</var><span class="hyp-type"><b>: </b><span>i
‚àâ List.map projT1 (List.map label_a a) ++
  List.map projT1 (List.map label_a [x])</span></span></span><br><span><var>tra</var><span class="hyp-type"><b>: </b><span>list transition_item</span></span></span><br><span><var>sa</var><span class="hyp-type"><b>: </b><span>composite_state IM</span></span></span><br><span><var>eq_a</var><span class="hyp-type"><b>: </b><span>composite_apply_plan IM s a = (tra, sa)</span></span></span><br><span><var>trx</var><span class="hyp-type"><b>: </b><span>list transition_item</span></span></span><br><span><var>sx</var><span class="hyp-type"><b>: </b><span>composite_state IM</span></span></span><br><span><var>eq_x</var><span class="hyp-type"><b>: </b><span>composite_apply_plan IM sa [x] = (trx, sx)</span></span></span><br><span><var>IHa</var><span class="hyp-type"><b>: </b><span>sa i = s i</span></span></span><br></div><label class="goal-separator" for="Composition-v-chk1d5"><hr></label><div class="goal-conclusion">sx i = s i</div></blockquote></div></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="Composition-v-chk1d6" style="display: none" type="checkbox"><label class="alectryon-input" for="Composition-v-chk1d6">{</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>message, index</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>EqDecision0</var><span class="hyp-type"><b>: </b><span>EqDecision index</span></span></span><br><span><var>IM</var><span class="hyp-type"><b>: </b><span>index ‚Üí VLSM message</span></span></span><br><span><var>Free</var><span><span class="hyp-body"><b>:= </b><span>free_composite_vlsm IM</span></span><span class="hyp-type"><b>: </b><span>VLSM message</span></span></span></span><br><span><var>s</var><span class="hyp-type"><b>: </b><span>composite_state IM</span></span></span><br><span><var>x</var><span class="hyp-type"><b>: </b><span>composite_plan_item IM</span></span></span><br><span><var>a</var><span class="hyp-type"><b>: </b><span>list (composite_plan_item IM)</span></span></span><br><span><var>a_indices</var><span><span class="hyp-body"><b>:= </b><span>List.map projT1
  (List.map label_a (a ++ [x]))</span></span><span class="hyp-type"><b>: </b><span>list index</span></span></span></span><br><span><var>i</var><span class="hyp-type"><b>: </b><span>index</span></span></span><br><span><var>Hdif</var><span class="hyp-type"><b>: </b><span>i
‚àâ List.map projT1 (List.map label_a a) ++
  List.map projT1 (List.map label_a [x])</span></span></span><br><span><var>tra</var><span class="hyp-type"><b>: </b><span>list transition_item</span></span></span><br><span><var>sa</var><span class="hyp-type"><b>: </b><span>composite_state IM</span></span></span><br><span><var>eq_a</var><span class="hyp-type"><b>: </b><span>composite_apply_plan IM s a = (tra, sa)</span></span></span><br><span><var>IHa</var><span class="hyp-type"><b>: </b><span>i ‚àâ List.map projT1 (List.map label_a a)
‚Üí sa i = s i</span></span></span><br><span><var>trx</var><span class="hyp-type"><b>: </b><span>list transition_item</span></span></span><br><span><var>sx</var><span class="hyp-type"><b>: </b><span>composite_state IM</span></span></span><br><span><var>eq_x</var><span class="hyp-type"><b>: </b><span>composite_apply_plan IM sa [x] = (trx, sx)</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">i ‚àâ List.map projT1 (List.map label_a a)</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">      </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="Composition-v-chk1d7" style="display: none" type="checkbox"><label class="alectryon-input" for="Composition-v-chk1d7"><span class="nb">intro</span> Hin.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>message, index</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>EqDecision0</var><span class="hyp-type"><b>: </b><span>EqDecision index</span></span></span><br><span><var>IM</var><span class="hyp-type"><b>: </b><span>index ‚Üí VLSM message</span></span></span><br><span><var>Free</var><span><span class="hyp-body"><b>:= </b><span>free_composite_vlsm IM</span></span><span class="hyp-type"><b>: </b><span>VLSM message</span></span></span></span><br><span><var>s</var><span class="hyp-type"><b>: </b><span>composite_state IM</span></span></span><br><span><var>x</var><span class="hyp-type"><b>: </b><span>composite_plan_item IM</span></span></span><br><span><var>a</var><span class="hyp-type"><b>: </b><span>list (composite_plan_item IM)</span></span></span><br><span><var>a_indices</var><span><span class="hyp-body"><b>:= </b><span>List.map projT1
  (List.map label_a (a ++ [x]))</span></span><span class="hyp-type"><b>: </b><span>list index</span></span></span></span><br><span><var>i</var><span class="hyp-type"><b>: </b><span>index</span></span></span><br><span><var>Hdif</var><span class="hyp-type"><b>: </b><span>i
‚àâ List.map projT1 (List.map label_a a) ++
  List.map projT1 (List.map label_a [x])</span></span></span><br><span><var>tra</var><span class="hyp-type"><b>: </b><span>list transition_item</span></span></span><br><span><var>sa</var><span class="hyp-type"><b>: </b><span>composite_state IM</span></span></span><br><span><var>eq_a</var><span class="hyp-type"><b>: </b><span>composite_apply_plan IM s a = (tra, sa)</span></span></span><br><span><var>IHa</var><span class="hyp-type"><b>: </b><span>i ‚àâ List.map projT1 (List.map label_a a)
‚Üí sa i = s i</span></span></span><br><span><var>trx</var><span class="hyp-type"><b>: </b><span>list transition_item</span></span></span><br><span><var>sx</var><span class="hyp-type"><b>: </b><span>composite_state IM</span></span></span><br><span><var>eq_x</var><span class="hyp-type"><b>: </b><span>composite_apply_plan IM sa [x] = (trx, sx)</span></span></span><br><span><var>Hin</var><span class="hyp-type"><b>: </b><span>i ‚àà List.map projT1 (List.map label_a a)</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="kt">False</span></div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">      </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="Composition-v-chk1d8" style="display: none" type="checkbox"><label class="alectryon-input" for="Composition-v-chk1d8"><span class="bp">contradict</span> Hdif.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>message, index</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>EqDecision0</var><span class="hyp-type"><b>: </b><span>EqDecision index</span></span></span><br><span><var>IM</var><span class="hyp-type"><b>: </b><span>index ‚Üí VLSM message</span></span></span><br><span><var>Free</var><span><span class="hyp-body"><b>:= </b><span>free_composite_vlsm IM</span></span><span class="hyp-type"><b>: </b><span>VLSM message</span></span></span></span><br><span><var>s</var><span class="hyp-type"><b>: </b><span>composite_state IM</span></span></span><br><span><var>x</var><span class="hyp-type"><b>: </b><span>composite_plan_item IM</span></span></span><br><span><var>a</var><span class="hyp-type"><b>: </b><span>list (composite_plan_item IM)</span></span></span><br><span><var>a_indices</var><span><span class="hyp-body"><b>:= </b><span>List.map projT1
  (List.map label_a (a ++ [x]))</span></span><span class="hyp-type"><b>: </b><span>list index</span></span></span></span><br><span><var>i</var><span class="hyp-type"><b>: </b><span>index</span></span></span><br><span><var>tra</var><span class="hyp-type"><b>: </b><span>list transition_item</span></span></span><br><span><var>sa</var><span class="hyp-type"><b>: </b><span>composite_state IM</span></span></span><br><span><var>eq_a</var><span class="hyp-type"><b>: </b><span>composite_apply_plan IM s a = (tra, sa)</span></span></span><br><span><var>IHa</var><span class="hyp-type"><b>: </b><span>i ‚àâ List.map projT1 (List.map label_a a)
‚Üí sa i = s i</span></span></span><br><span><var>trx</var><span class="hyp-type"><b>: </b><span>list transition_item</span></span></span><br><span><var>sx</var><span class="hyp-type"><b>: </b><span>composite_state IM</span></span></span><br><span><var>eq_x</var><span class="hyp-type"><b>: </b><span>composite_apply_plan IM sa [x] = (trx, sx)</span></span></span><br><span><var>Hin</var><span class="hyp-type"><b>: </b><span>i ‚àà List.map projT1 (List.map label_a a)</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">i
‚àà List.map projT1 (List.map label_a a) ++
  List.map projT1 (List.map label_a [x])</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">      </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="Composition-v-chk1d9" style="display: none" type="checkbox"><label class="alectryon-input" for="Composition-v-chk1d9"><span class="nb">apply</span> elem_of_app.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>message, index</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>EqDecision0</var><span class="hyp-type"><b>: </b><span>EqDecision index</span></span></span><br><span><var>IM</var><span class="hyp-type"><b>: </b><span>index ‚Üí VLSM message</span></span></span><br><span><var>Free</var><span><span class="hyp-body"><b>:= </b><span>free_composite_vlsm IM</span></span><span class="hyp-type"><b>: </b><span>VLSM message</span></span></span></span><br><span><var>s</var><span class="hyp-type"><b>: </b><span>composite_state IM</span></span></span><br><span><var>x</var><span class="hyp-type"><b>: </b><span>composite_plan_item IM</span></span></span><br><span><var>a</var><span class="hyp-type"><b>: </b><span>list (composite_plan_item IM)</span></span></span><br><span><var>a_indices</var><span><span class="hyp-body"><b>:= </b><span>List.map projT1
  (List.map label_a (a ++ [x]))</span></span><span class="hyp-type"><b>: </b><span>list index</span></span></span></span><br><span><var>i</var><span class="hyp-type"><b>: </b><span>index</span></span></span><br><span><var>tra</var><span class="hyp-type"><b>: </b><span>list transition_item</span></span></span><br><span><var>sa</var><span class="hyp-type"><b>: </b><span>composite_state IM</span></span></span><br><span><var>eq_a</var><span class="hyp-type"><b>: </b><span>composite_apply_plan IM s a = (tra, sa)</span></span></span><br><span><var>IHa</var><span class="hyp-type"><b>: </b><span>i ‚àâ List.map projT1 (List.map label_a a)
‚Üí sa i = s i</span></span></span><br><span><var>trx</var><span class="hyp-type"><b>: </b><span>list transition_item</span></span></span><br><span><var>sx</var><span class="hyp-type"><b>: </b><span>composite_state IM</span></span></span><br><span><var>eq_x</var><span class="hyp-type"><b>: </b><span>composite_apply_plan IM sa [x] = (trx, sx)</span></span></span><br><span><var>Hin</var><span class="hyp-type"><b>: </b><span>i ‚àà List.map projT1 (List.map label_a a)</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">i ‚àà List.map projT1 (List.map label_a a)
‚à® i ‚àà List.map projT1 (List.map label_a [x])</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">      </span><span class="alectryon-sentence"><span class="alectryon-input"><span class="bp">by</span> <span class="nb">left</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="Composition-v-chk1da" style="display: none" type="checkbox"><label class="alectryon-input" for="Composition-v-chk1da">}</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>message, index</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>EqDecision0</var><span class="hyp-type"><b>: </b><span>EqDecision index</span></span></span><br><span><var>IM</var><span class="hyp-type"><b>: </b><span>index ‚Üí VLSM message</span></span></span><br><span><var>Free</var><span><span class="hyp-body"><b>:= </b><span>free_composite_vlsm IM</span></span><span class="hyp-type"><b>: </b><span>VLSM message</span></span></span></span><br><span><var>s</var><span class="hyp-type"><b>: </b><span>composite_state IM</span></span></span><br><span><var>x</var><span class="hyp-type"><b>: </b><span>composite_plan_item IM</span></span></span><br><span><var>a</var><span class="hyp-type"><b>: </b><span>list (composite_plan_item IM)</span></span></span><br><span><var>a_indices</var><span><span class="hyp-body"><b>:= </b><span>List.map projT1
  (List.map label_a (a ++ [x]))</span></span><span class="hyp-type"><b>: </b><span>list index</span></span></span></span><br><span><var>i</var><span class="hyp-type"><b>: </b><span>index</span></span></span><br><span><var>Hdif</var><span class="hyp-type"><b>: </b><span>i
‚àâ List.map projT1 (List.map label_a a) ++
  List.map projT1 (List.map label_a [x])</span></span></span><br><span><var>tra</var><span class="hyp-type"><b>: </b><span>list transition_item</span></span></span><br><span><var>sa</var><span class="hyp-type"><b>: </b><span>composite_state IM</span></span></span><br><span><var>eq_a</var><span class="hyp-type"><b>: </b><span>composite_apply_plan IM s a = (tra, sa)</span></span></span><br><span><var>trx</var><span class="hyp-type"><b>: </b><span>list transition_item</span></span></span><br><span><var>sx</var><span class="hyp-type"><b>: </b><span>composite_state IM</span></span></span><br><span><var>eq_x</var><span class="hyp-type"><b>: </b><span>composite_apply_plan IM sa [x] = (trx, sx)</span></span></span><br><span><var>IHa</var><span class="hyp-type"><b>: </b><span>sa i = s i</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">sx i = s i</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
</span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="Composition-v-chk1db" style="display: none" type="checkbox"><label class="alectryon-input" for="Composition-v-chk1db"><span class="nb">rewrite</span> &lt;- IHa.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>message, index</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>EqDecision0</var><span class="hyp-type"><b>: </b><span>EqDecision index</span></span></span><br><span><var>IM</var><span class="hyp-type"><b>: </b><span>index ‚Üí VLSM message</span></span></span><br><span><var>Free</var><span><span class="hyp-body"><b>:= </b><span>free_composite_vlsm IM</span></span><span class="hyp-type"><b>: </b><span>VLSM message</span></span></span></span><br><span><var>s</var><span class="hyp-type"><b>: </b><span>composite_state IM</span></span></span><br><span><var>x</var><span class="hyp-type"><b>: </b><span>composite_plan_item IM</span></span></span><br><span><var>a</var><span class="hyp-type"><b>: </b><span>list (composite_plan_item IM)</span></span></span><br><span><var>a_indices</var><span><span class="hyp-body"><b>:= </b><span>List.map projT1
  (List.map label_a (a ++ [x]))</span></span><span class="hyp-type"><b>: </b><span>list index</span></span></span></span><br><span><var>i</var><span class="hyp-type"><b>: </b><span>index</span></span></span><br><span><var>Hdif</var><span class="hyp-type"><b>: </b><span>i
‚àâ List.map projT1 (List.map label_a a) ++
  List.map projT1 (List.map label_a [x])</span></span></span><br><span><var>tra</var><span class="hyp-type"><b>: </b><span>list transition_item</span></span></span><br><span><var>sa</var><span class="hyp-type"><b>: </b><span>composite_state IM</span></span></span><br><span><var>eq_a</var><span class="hyp-type"><b>: </b><span>composite_apply_plan IM s a = (tra, sa)</span></span></span><br><span><var>trx</var><span class="hyp-type"><b>: </b><span>list transition_item</span></span></span><br><span><var>sx</var><span class="hyp-type"><b>: </b><span>composite_state IM</span></span></span><br><span><var>eq_x</var><span class="hyp-type"><b>: </b><span>composite_apply_plan IM sa [x] = (trx, sx)</span></span></span><br><span><var>IHa</var><span class="hyp-type"><b>: </b><span>sa i = s i</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">sx i = sa i</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="Composition-v-chk1dc" style="display: none" type="checkbox"><label class="alectryon-input" for="Composition-v-chk1dc"><span class="nb">replace</span> sx <span class="kr">with</span> (snd (composite_apply_plan IM sa [x])) <span class="bp">by</span> (<span class="nb">rewrite</span> eq_x; <span class="bp">done</span>).</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>message, index</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>EqDecision0</var><span class="hyp-type"><b>: </b><span>EqDecision index</span></span></span><br><span><var>IM</var><span class="hyp-type"><b>: </b><span>index ‚Üí VLSM message</span></span></span><br><span><var>Free</var><span><span class="hyp-body"><b>:= </b><span>free_composite_vlsm IM</span></span><span class="hyp-type"><b>: </b><span>VLSM message</span></span></span></span><br><span><var>s</var><span class="hyp-type"><b>: </b><span>composite_state IM</span></span></span><br><span><var>x</var><span class="hyp-type"><b>: </b><span>composite_plan_item IM</span></span></span><br><span><var>a</var><span class="hyp-type"><b>: </b><span>list (composite_plan_item IM)</span></span></span><br><span><var>a_indices</var><span><span class="hyp-body"><b>:= </b><span>List.map projT1
  (List.map label_a (a ++ [x]))</span></span><span class="hyp-type"><b>: </b><span>list index</span></span></span></span><br><span><var>i</var><span class="hyp-type"><b>: </b><span>index</span></span></span><br><span><var>Hdif</var><span class="hyp-type"><b>: </b><span>i
‚àâ List.map projT1 (List.map label_a a) ++
  List.map projT1 (List.map label_a [x])</span></span></span><br><span><var>tra</var><span class="hyp-type"><b>: </b><span>list transition_item</span></span></span><br><span><var>sa</var><span class="hyp-type"><b>: </b><span>composite_state IM</span></span></span><br><span><var>eq_a</var><span class="hyp-type"><b>: </b><span>composite_apply_plan IM s a = (tra, sa)</span></span></span><br><span><var>trx</var><span class="hyp-type"><b>: </b><span>list transition_item</span></span></span><br><span><var>sx</var><span class="hyp-type"><b>: </b><span>composite_state IM</span></span></span><br><span><var>eq_x</var><span class="hyp-type"><b>: </b><span>composite_apply_plan IM sa [x] = (trx, sx)</span></span></span><br><span><var>IHa</var><span class="hyp-type"><b>: </b><span>sa i = s i</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">(composite_apply_plan IM sa [x]).<span class="mi">2</span> i = sa i</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="Composition-v-chk1dd" style="display: none" type="checkbox"><label class="alectryon-input" for="Composition-v-chk1dd"><span class="nb">apply</span> irrelevant_components_one.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>message, index</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>EqDecision0</var><span class="hyp-type"><b>: </b><span>EqDecision index</span></span></span><br><span><var>IM</var><span class="hyp-type"><b>: </b><span>index ‚Üí VLSM message</span></span></span><br><span><var>Free</var><span><span class="hyp-body"><b>:= </b><span>free_composite_vlsm IM</span></span><span class="hyp-type"><b>: </b><span>VLSM message</span></span></span></span><br><span><var>s</var><span class="hyp-type"><b>: </b><span>composite_state IM</span></span></span><br><span><var>x</var><span class="hyp-type"><b>: </b><span>composite_plan_item IM</span></span></span><br><span><var>a</var><span class="hyp-type"><b>: </b><span>list (composite_plan_item IM)</span></span></span><br><span><var>a_indices</var><span><span class="hyp-body"><b>:= </b><span>List.map projT1
  (List.map label_a (a ++ [x]))</span></span><span class="hyp-type"><b>: </b><span>list index</span></span></span></span><br><span><var>i</var><span class="hyp-type"><b>: </b><span>index</span></span></span><br><span><var>Hdif</var><span class="hyp-type"><b>: </b><span>i
‚àâ List.map projT1 (List.map label_a a) ++
  List.map projT1 (List.map label_a [x])</span></span></span><br><span><var>tra</var><span class="hyp-type"><b>: </b><span>list transition_item</span></span></span><br><span><var>sa</var><span class="hyp-type"><b>: </b><span>composite_state IM</span></span></span><br><span><var>eq_a</var><span class="hyp-type"><b>: </b><span>composite_apply_plan IM s a = (tra, sa)</span></span></span><br><span><var>trx</var><span class="hyp-type"><b>: </b><span>list transition_item</span></span></span><br><span><var>sx</var><span class="hyp-type"><b>: </b><span>composite_state IM</span></span></span><br><span><var>eq_x</var><span class="hyp-type"><b>: </b><span>composite_apply_plan IM sa [x] = (trx, sx)</span></span></span><br><span><var>IHa</var><span class="hyp-type"><b>: </b><span>sa i = s i</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">i ‚â† projT1 (label_a x)</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="Composition-v-chk1de" style="display: none" type="checkbox"><label class="alectryon-input" for="Composition-v-chk1de"><span class="nb">intros</span> contra.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>message, index</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>EqDecision0</var><span class="hyp-type"><b>: </b><span>EqDecision index</span></span></span><br><span><var>IM</var><span class="hyp-type"><b>: </b><span>index ‚Üí VLSM message</span></span></span><br><span><var>Free</var><span><span class="hyp-body"><b>:= </b><span>free_composite_vlsm IM</span></span><span class="hyp-type"><b>: </b><span>VLSM message</span></span></span></span><br><span><var>s</var><span class="hyp-type"><b>: </b><span>composite_state IM</span></span></span><br><span><var>x</var><span class="hyp-type"><b>: </b><span>composite_plan_item IM</span></span></span><br><span><var>a</var><span class="hyp-type"><b>: </b><span>list (composite_plan_item IM)</span></span></span><br><span><var>a_indices</var><span><span class="hyp-body"><b>:= </b><span>List.map projT1
  (List.map label_a (a ++ [x]))</span></span><span class="hyp-type"><b>: </b><span>list index</span></span></span></span><br><span><var>i</var><span class="hyp-type"><b>: </b><span>index</span></span></span><br><span><var>Hdif</var><span class="hyp-type"><b>: </b><span>i
‚àâ List.map projT1 (List.map label_a a) ++
  List.map projT1 (List.map label_a [x])</span></span></span><br><span><var>tra</var><span class="hyp-type"><b>: </b><span>list transition_item</span></span></span><br><span><var>sa</var><span class="hyp-type"><b>: </b><span>composite_state IM</span></span></span><br><span><var>eq_a</var><span class="hyp-type"><b>: </b><span>composite_apply_plan IM s a = (tra, sa)</span></span></span><br><span><var>trx</var><span class="hyp-type"><b>: </b><span>list transition_item</span></span></span><br><span><var>sx</var><span class="hyp-type"><b>: </b><span>composite_state IM</span></span></span><br><span><var>eq_x</var><span class="hyp-type"><b>: </b><span>composite_apply_plan IM sa [x] = (trx, sx)</span></span></span><br><span><var>IHa</var><span class="hyp-type"><b>: </b><span>sa i = s i</span></span></span><br><span><var>contra</var><span class="hyp-type"><b>: </b><span>i = projT1 (label_a x)</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="kt">False</span></div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="Composition-v-chk1df" style="display: none" type="checkbox"><label class="alectryon-input" for="Composition-v-chk1df"><span class="nb">rewrite</span> contra <span class="kr">in</span> Hdif.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>message, index</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>EqDecision0</var><span class="hyp-type"><b>: </b><span>EqDecision index</span></span></span><br><span><var>IM</var><span class="hyp-type"><b>: </b><span>index ‚Üí VLSM message</span></span></span><br><span><var>Free</var><span><span class="hyp-body"><b>:= </b><span>free_composite_vlsm IM</span></span><span class="hyp-type"><b>: </b><span>VLSM message</span></span></span></span><br><span><var>s</var><span class="hyp-type"><b>: </b><span>composite_state IM</span></span></span><br><span><var>x</var><span class="hyp-type"><b>: </b><span>composite_plan_item IM</span></span></span><br><span><var>a</var><span class="hyp-type"><b>: </b><span>list (composite_plan_item IM)</span></span></span><br><span><var>a_indices</var><span><span class="hyp-body"><b>:= </b><span>List.map projT1
  (List.map label_a (a ++ [x]))</span></span><span class="hyp-type"><b>: </b><span>list index</span></span></span></span><br><span><var>i</var><span class="hyp-type"><b>: </b><span>index</span></span></span><br><span><var>Hdif</var><span class="hyp-type"><b>: </b><span>projT1 (label_a x)
‚àâ List.map projT1 (List.map label_a a) ++
  List.map projT1 (List.map label_a [x])</span></span></span><br><span><var>tra</var><span class="hyp-type"><b>: </b><span>list transition_item</span></span></span><br><span><var>sa</var><span class="hyp-type"><b>: </b><span>composite_state IM</span></span></span><br><span><var>eq_a</var><span class="hyp-type"><b>: </b><span>composite_apply_plan IM s a = (tra, sa)</span></span></span><br><span><var>trx</var><span class="hyp-type"><b>: </b><span>list transition_item</span></span></span><br><span><var>sx</var><span class="hyp-type"><b>: </b><span>composite_state IM</span></span></span><br><span><var>eq_x</var><span class="hyp-type"><b>: </b><span>composite_apply_plan IM sa [x] = (trx, sx)</span></span></span><br><span><var>IHa</var><span class="hyp-type"><b>: </b><span>sa i = s i</span></span></span><br><span><var>contra</var><span class="hyp-type"><b>: </b><span>i = projT1 (label_a x)</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="kt">False</span></div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
</span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="Composition-v-chk1e0" style="display: none" type="checkbox"><label class="alectryon-input" for="Composition-v-chk1e0"><span class="nb">rewrite</span> elem_of_app <span class="kr">in</span> Hdif; <span class="nb">simpl</span> <span class="kr">in</span> Hdif.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>message, index</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>EqDecision0</var><span class="hyp-type"><b>: </b><span>EqDecision index</span></span></span><br><span><var>IM</var><span class="hyp-type"><b>: </b><span>index ‚Üí VLSM message</span></span></span><br><span><var>Free</var><span><span class="hyp-body"><b>:= </b><span>free_composite_vlsm IM</span></span><span class="hyp-type"><b>: </b><span>VLSM message</span></span></span></span><br><span><var>s</var><span class="hyp-type"><b>: </b><span>composite_state IM</span></span></span><br><span><var>x</var><span class="hyp-type"><b>: </b><span>composite_plan_item IM</span></span></span><br><span><var>a</var><span class="hyp-type"><b>: </b><span>list (composite_plan_item IM)</span></span></span><br><span><var>a_indices</var><span><span class="hyp-body"><b>:= </b><span>List.map projT1
  (List.map label_a (a ++ [x]))</span></span><span class="hyp-type"><b>: </b><span>list index</span></span></span></span><br><span><var>i</var><span class="hyp-type"><b>: </b><span>index</span></span></span><br><span><var>Hdif</var><span class="hyp-type"><b>: </b><span>¬¨ (projT1 (label_a x)
   ‚àà List.map projT1 (List.map label_a a)
   ‚à® projT1 (label_a x) ‚àà [projT1 (label_a x)])</span></span></span><br><span><var>tra</var><span class="hyp-type"><b>: </b><span>list transition_item</span></span></span><br><span><var>sa</var><span class="hyp-type"><b>: </b><span>composite_state IM</span></span></span><br><span><var>eq_a</var><span class="hyp-type"><b>: </b><span>composite_apply_plan IM s a = (tra, sa)</span></span></span><br><span><var>trx</var><span class="hyp-type"><b>: </b><span>list transition_item</span></span></span><br><span><var>sx</var><span class="hyp-type"><b>: </b><span>composite_state IM</span></span></span><br><span><var>eq_x</var><span class="hyp-type"><b>: </b><span>composite_apply_plan IM sa [x] = (trx, sx)</span></span></span><br><span><var>IHa</var><span class="hyp-type"><b>: </b><span>sa i = s i</span></span></span><br><span><var>contra</var><span class="hyp-type"><b>: </b><span>i = projT1 (label_a x)</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="kt">False</span></div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="Composition-v-chk1e1" style="display: none" type="checkbox"><label class="alectryon-input" for="Composition-v-chk1e1"><span class="bp">contradict</span> Hdif.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>message, index</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>EqDecision0</var><span class="hyp-type"><b>: </b><span>EqDecision index</span></span></span><br><span><var>IM</var><span class="hyp-type"><b>: </b><span>index ‚Üí VLSM message</span></span></span><br><span><var>Free</var><span><span class="hyp-body"><b>:= </b><span>free_composite_vlsm IM</span></span><span class="hyp-type"><b>: </b><span>VLSM message</span></span></span></span><br><span><var>s</var><span class="hyp-type"><b>: </b><span>composite_state IM</span></span></span><br><span><var>x</var><span class="hyp-type"><b>: </b><span>composite_plan_item IM</span></span></span><br><span><var>a</var><span class="hyp-type"><b>: </b><span>list (composite_plan_item IM)</span></span></span><br><span><var>a_indices</var><span><span class="hyp-body"><b>:= </b><span>List.map projT1
  (List.map label_a (a ++ [x]))</span></span><span class="hyp-type"><b>: </b><span>list index</span></span></span></span><br><span><var>i</var><span class="hyp-type"><b>: </b><span>index</span></span></span><br><span><var>tra</var><span class="hyp-type"><b>: </b><span>list transition_item</span></span></span><br><span><var>sa</var><span class="hyp-type"><b>: </b><span>composite_state IM</span></span></span><br><span><var>eq_a</var><span class="hyp-type"><b>: </b><span>composite_apply_plan IM s a = (tra, sa)</span></span></span><br><span><var>trx</var><span class="hyp-type"><b>: </b><span>list transition_item</span></span></span><br><span><var>sx</var><span class="hyp-type"><b>: </b><span>composite_state IM</span></span></span><br><span><var>eq_x</var><span class="hyp-type"><b>: </b><span>composite_apply_plan IM sa [x] = (trx, sx)</span></span></span><br><span><var>IHa</var><span class="hyp-type"><b>: </b><span>sa i = s i</span></span></span><br><span><var>contra</var><span class="hyp-type"><b>: </b><span>i = projT1 (label_a x)</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">projT1 (label_a x)
‚àà List.map projT1 (List.map label_a a)
‚à® projT1 (label_a x) ‚àà [projT1 (label_a x)]</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="Composition-v-chk1e2" style="display: none" type="checkbox"><label class="alectryon-input" for="Composition-v-chk1e2"><span class="nb">subst</span>.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>message, index</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>EqDecision0</var><span class="hyp-type"><b>: </b><span>EqDecision index</span></span></span><br><span><var>IM</var><span class="hyp-type"><b>: </b><span>index ‚Üí VLSM message</span></span></span><br><span><var>Free</var><span><span class="hyp-body"><b>:= </b><span>free_composite_vlsm IM</span></span><span class="hyp-type"><b>: </b><span>VLSM message</span></span></span></span><br><span><var>s</var><span class="hyp-type"><b>: </b><span>composite_state IM</span></span></span><br><span><var>x</var><span class="hyp-type"><b>: </b><span>composite_plan_item IM</span></span></span><br><span><var>a</var><span class="hyp-type"><b>: </b><span>list (composite_plan_item IM)</span></span></span><br><span><var>a_indices</var><span><span class="hyp-body"><b>:= </b><span>List.map projT1
  (List.map label_a (a ++ [x]))</span></span><span class="hyp-type"><b>: </b><span>list index</span></span></span></span><br><span><var>tra</var><span class="hyp-type"><b>: </b><span>list transition_item</span></span></span><br><span><var>sa</var><span class="hyp-type"><b>: </b><span>composite_state IM</span></span></span><br><span><var>eq_a</var><span class="hyp-type"><b>: </b><span>composite_apply_plan IM s a = (tra, sa)</span></span></span><br><span><var>trx</var><span class="hyp-type"><b>: </b><span>list transition_item</span></span></span><br><span><var>sx</var><span class="hyp-type"><b>: </b><span>composite_state IM</span></span></span><br><span><var>eq_x</var><span class="hyp-type"><b>: </b><span>composite_apply_plan IM sa [x] = (trx, sx)</span></span></span><br><span><var>IHa</var><span class="hyp-type"><b>: </b><span>sa (projT1 (label_a x)) = s (projT1 (label_a x))</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">projT1 (label_a x)
‚àà List.map projT1 (List.map label_a a)
‚à® projT1 (label_a x) ‚àà [projT1 (label_a x)]</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><span class="alectryon-input"><span class="nb">right</span>; <span class="nb">left</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Qed</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
<span class="c">(* Same as relevant_components_one but for multiple transitions *)</span>

</span><span class="alectryon-sentence"><input class="alectryon-toggle" id="Composition-v-chk1e3" style="display: none" type="checkbox"><label class="alectryon-input" for="Composition-v-chk1e3"><span class="kn">Lemma</span> <span class="nf">relevant_components</span>
  (<span class="nv">s</span> <span class="nv">s&#39;</span> : vstate Free)
  (<span class="nv">Hprs&#39;</span> : valid_state_prop Free s&#39;)
  (<span class="nv">a</span> : plan Free)
  (<span class="nv">a_indices</span> := List.map (@projT1 _ _) (List.map (@label_a _ _) a))
  (<span class="nv">li</span> : list index)
  (<span class="nv">Heq</span> : <span class="kr">forall</span> (<span class="nv">i</span> : index), i ‚àà li -&gt; (s&#39; i) = (s i))
  (<span class="nv">Hincl</span> : a_indices ‚äÜ li)
  (<span class="nv">Hpr</span> : finite_valid_plan_from Free s a) :
  <span class="kr">let</span> <span class="nv">res&#39;</span> := snd (apply_plan Free s&#39; a) <span class="kr">in</span>
  <span class="kr">let</span> <span class="nv">res</span> := snd (apply_plan Free s a) <span class="kr">in</span>
  finite_valid_plan_from Free s&#39; a /\
  (<span class="kr">forall</span> (<span class="nv">i</span> : index), i ‚àà li -&gt; (res&#39; i) = res i).</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>message, index</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>EqDecision0</var><span class="hyp-type"><b>: </b><span>EqDecision index</span></span></span><br><span><var>IM</var><span class="hyp-type"><b>: </b><span>index ‚Üí VLSM message</span></span></span><br><span><var>Free</var><span><span class="hyp-body"><b>:= </b><span>free_composite_vlsm IM</span></span><span class="hyp-type"><b>: </b><span>VLSM message</span></span></span></span><br><span><var>s, s'</var><span class="hyp-type"><b>: </b><span>vstate Free</span></span></span><br><span><var>Hprs'</var><span class="hyp-type"><b>: </b><span>valid_state_prop Free s&#39;</span></span></span><br><span><var>a</var><span class="hyp-type"><b>: </b><span>plan Free</span></span></span><br><span><var>a_indices</var><span><span class="hyp-body"><b>:= </b><span>List.map projT1 (List.map label_a a)</span></span><span class="hyp-type"><b>: </b><span>list index</span></span></span></span><br><span><var>li</var><span class="hyp-type"><b>: </b><span>list index</span></span></span><br><span><var>Heq</var><span class="hyp-type"><b>: </b><span><span class="kr">‚àÄ</span> <span class="nv">i</span> : index, i ‚àà li ‚Üí s&#39; i = s i</span></span></span><br><span><var>Hincl</var><span class="hyp-type"><b>: </b><span>a_indices ‚äÜ li</span></span></span><br><span><var>Hpr</var><span class="hyp-type"><b>: </b><span>finite_valid_plan_from Free s a</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="kr">let</span> <span class="nv">res&#39;</span> := (apply_plan Free s&#39; a).<span class="mi">2</span> <span class="kr">in</span>
<span class="kr">let</span> <span class="nv">res</span> := (apply_plan Free s a).<span class="mi">2</span> <span class="kr">in</span>
finite_valid_plan_from Free s&#39; a
‚àß (<span class="kr">‚àÄ</span> <span class="nv">i</span> : index, i ‚àà li ‚Üí res&#39; i = res i)</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="Composition-v-chk1e4" style="display: none" type="checkbox"><label class="alectryon-input" for="Composition-v-chk1e4"><span class="kn">Proof</span>.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>message, index</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>EqDecision0</var><span class="hyp-type"><b>: </b><span>EqDecision index</span></span></span><br><span><var>IM</var><span class="hyp-type"><b>: </b><span>index ‚Üí VLSM message</span></span></span><br><span><var>Free</var><span><span class="hyp-body"><b>:= </b><span>free_composite_vlsm IM</span></span><span class="hyp-type"><b>: </b><span>VLSM message</span></span></span></span><br><span><var>s, s'</var><span class="hyp-type"><b>: </b><span>vstate Free</span></span></span><br><span><var>Hprs'</var><span class="hyp-type"><b>: </b><span>valid_state_prop Free s&#39;</span></span></span><br><span><var>a</var><span class="hyp-type"><b>: </b><span>plan Free</span></span></span><br><span><var>a_indices</var><span><span class="hyp-body"><b>:= </b><span>List.map projT1 (List.map label_a a)</span></span><span class="hyp-type"><b>: </b><span>list index</span></span></span></span><br><span><var>li</var><span class="hyp-type"><b>: </b><span>list index</span></span></span><br><span><var>Heq</var><span class="hyp-type"><b>: </b><span><span class="kr">‚àÄ</span> <span class="nv">i</span> : index, i ‚àà li ‚Üí s&#39; i = s i</span></span></span><br><span><var>Hincl</var><span class="hyp-type"><b>: </b><span>a_indices ‚äÜ li</span></span></span><br><span><var>Hpr</var><span class="hyp-type"><b>: </b><span>finite_valid_plan_from Free s a</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="kr">let</span> <span class="nv">res&#39;</span> := (apply_plan Free s&#39; a).<span class="mi">2</span> <span class="kr">in</span>
<span class="kr">let</span> <span class="nv">res</span> := (apply_plan Free s a).<span class="mi">2</span> <span class="kr">in</span>
finite_valid_plan_from Free s&#39; a
‚àß (<span class="kr">‚àÄ</span> <span class="nv">i</span> : index, i ‚àà li ‚Üí res&#39; i = res i)</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="Composition-v-chk1e5" style="display: none" type="checkbox"><label class="alectryon-input" for="Composition-v-chk1e5"><span class="nb">induction</span> a <span class="nb">using</span> rev_ind.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>message, index</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>EqDecision0</var><span class="hyp-type"><b>: </b><span>EqDecision index</span></span></span><br><span><var>IM</var><span class="hyp-type"><b>: </b><span>index ‚Üí VLSM message</span></span></span><br><span><var>Free</var><span><span class="hyp-body"><b>:= </b><span>free_composite_vlsm IM</span></span><span class="hyp-type"><b>: </b><span>VLSM message</span></span></span></span><br><span><var>s, s'</var><span class="hyp-type"><b>: </b><span>vstate Free</span></span></span><br><span><var>Hprs'</var><span class="hyp-type"><b>: </b><span>valid_state_prop Free s&#39;</span></span></span><br><span><var>a_indices</var><span><span class="hyp-body"><b>:= </b><span>List.map projT1 (List.map label_a [])</span></span><span class="hyp-type"><b>: </b><span>list index</span></span></span></span><br><span><var>li</var><span class="hyp-type"><b>: </b><span>list index</span></span></span><br><span><var>Heq</var><span class="hyp-type"><b>: </b><span><span class="kr">‚àÄ</span> <span class="nv">i</span> : index, i ‚àà li ‚Üí s&#39; i = s i</span></span></span><br><span><var>Hincl</var><span class="hyp-type"><b>: </b><span>a_indices ‚äÜ li</span></span></span><br><span><var>Hpr</var><span class="hyp-type"><b>: </b><span>finite_valid_plan_from Free s []</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="kr">let</span> <span class="nv">res&#39;</span> := (apply_plan Free s&#39; []).<span class="mi">2</span> <span class="kr">in</span>
<span class="kr">let</span> <span class="nv">res</span> := (apply_plan Free s []).<span class="mi">2</span> <span class="kr">in</span>
finite_valid_plan_from Free s&#39; []
‚àß (<span class="kr">‚àÄ</span> <span class="nv">i</span> : index, i ‚àà li ‚Üí res&#39; i = res i)</div></blockquote><div class="alectryon-extra-goals"><input class="alectryon-extra-goal-toggle" id="Composition-v-chk1e6" style="display: none" type="checkbox"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>message, index</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>EqDecision0</var><span class="hyp-type"><b>: </b><span>EqDecision index</span></span></span><br><span><var>IM</var><span class="hyp-type"><b>: </b><span>index ‚Üí VLSM message</span></span></span><br><span><var>Free</var><span><span class="hyp-body"><b>:= </b><span>free_composite_vlsm IM</span></span><span class="hyp-type"><b>: </b><span>VLSM message</span></span></span></span><br><span><var>s, s'</var><span class="hyp-type"><b>: </b><span>vstate Free</span></span></span><br><span><var>Hprs'</var><span class="hyp-type"><b>: </b><span>valid_state_prop Free s&#39;</span></span></span><br><span><var>x</var><span class="hyp-type"><b>: </b><span>vplan_item Free</span></span></span><br><span><var>a</var><span class="hyp-type"><b>: </b><span>list (vplan_item Free)</span></span></span><br><span><var>a_indices</var><span><span class="hyp-body"><b>:= </b><span>List.map projT1
  (List.map label_a (a ++ [x]))</span></span><span class="hyp-type"><b>: </b><span>list index</span></span></span></span><br><span><var>li</var><span class="hyp-type"><b>: </b><span>list index</span></span></span><br><span><var>Heq</var><span class="hyp-type"><b>: </b><span><span class="kr">‚àÄ</span> <span class="nv">i</span> : index, i ‚àà li ‚Üí s&#39; i = s i</span></span></span><br><span><var>Hincl</var><span class="hyp-type"><b>: </b><span>a_indices ‚äÜ li</span></span></span><br><span><var>Hpr</var><span class="hyp-type"><b>: </b><span>finite_valid_plan_from Free s (a ++ [x])</span></span></span><br><span><var>IHa</var><span class="hyp-type"><b>: </b><span><span class="kr">let</span> <span class="nv">a_indices</span> :=
  List.map projT1 (List.map label_a a) <span class="kr">in</span>
a_indices ‚äÜ li
‚Üí finite_valid_plan_from Free s a
  ‚Üí <span class="kr">let</span> <span class="nv">res&#39;</span> := (apply_plan Free s&#39; a).<span class="mi">2</span> <span class="kr">in</span>
    <span class="kr">let</span> <span class="nv">res</span> := (apply_plan Free s a).<span class="mi">2</span> <span class="kr">in</span>
    finite_valid_plan_from Free s&#39; a
    ‚àß (<span class="kr">‚àÄ</span> <span class="nv">i</span> : index, i ‚àà li ‚Üí res&#39; i = res i)</span></span></span><br></div><label class="goal-separator" for="Composition-v-chk1e6"><hr></label><div class="goal-conclusion"><span class="kr">let</span> <span class="nv">res&#39;</span> := (apply_plan Free s&#39; (a ++ [x])).<span class="mi">2</span> <span class="kr">in</span>
<span class="kr">let</span> <span class="nv">res</span> := (apply_plan Free s (a ++ [x])).<span class="mi">2</span> <span class="kr">in</span>
finite_valid_plan_from Free s&#39; (a ++ [x])
‚àß (<span class="kr">‚àÄ</span> <span class="nv">i</span> : index, i ‚àà li ‚Üí res&#39; i = res i)</div></blockquote></div></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="Composition-v-chk1e7" style="display: none" type="checkbox"><label class="alectryon-input" for="Composition-v-chk1e7">-</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>message, index</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>EqDecision0</var><span class="hyp-type"><b>: </b><span>EqDecision index</span></span></span><br><span><var>IM</var><span class="hyp-type"><b>: </b><span>index ‚Üí VLSM message</span></span></span><br><span><var>Free</var><span><span class="hyp-body"><b>:= </b><span>free_composite_vlsm IM</span></span><span class="hyp-type"><b>: </b><span>VLSM message</span></span></span></span><br><span><var>s, s'</var><span class="hyp-type"><b>: </b><span>vstate Free</span></span></span><br><span><var>Hprs'</var><span class="hyp-type"><b>: </b><span>valid_state_prop Free s&#39;</span></span></span><br><span><var>a_indices</var><span><span class="hyp-body"><b>:= </b><span>List.map projT1 (List.map label_a [])</span></span><span class="hyp-type"><b>: </b><span>list index</span></span></span></span><br><span><var>li</var><span class="hyp-type"><b>: </b><span>list index</span></span></span><br><span><var>Heq</var><span class="hyp-type"><b>: </b><span><span class="kr">‚àÄ</span> <span class="nv">i</span> : index, i ‚àà li ‚Üí s&#39; i = s i</span></span></span><br><span><var>Hincl</var><span class="hyp-type"><b>: </b><span>a_indices ‚äÜ li</span></span></span><br><span><var>Hpr</var><span class="hyp-type"><b>: </b><span>finite_valid_plan_from Free s []</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="kr">let</span> <span class="nv">res&#39;</span> := (apply_plan Free s&#39; []).<span class="mi">2</span> <span class="kr">in</span>
<span class="kr">let</span> <span class="nv">res</span> := (apply_plan Free s []).<span class="mi">2</span> <span class="kr">in</span>
finite_valid_plan_from Free s&#39; []
‚àß (<span class="kr">‚àÄ</span> <span class="nv">i</span> : index, i ‚àà li ‚Üí res&#39; i = res i)</div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="bp">by</span> <span class="nb">split</span>; [<span class="nb">apply</span> finite_valid_plan_empty|].</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="Composition-v-chk1e8" style="display: none" type="checkbox"><label class="alectryon-input" for="Composition-v-chk1e8">-</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>message, index</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>EqDecision0</var><span class="hyp-type"><b>: </b><span>EqDecision index</span></span></span><br><span><var>IM</var><span class="hyp-type"><b>: </b><span>index ‚Üí VLSM message</span></span></span><br><span><var>Free</var><span><span class="hyp-body"><b>:= </b><span>free_composite_vlsm IM</span></span><span class="hyp-type"><b>: </b><span>VLSM message</span></span></span></span><br><span><var>s, s'</var><span class="hyp-type"><b>: </b><span>vstate Free</span></span></span><br><span><var>Hprs'</var><span class="hyp-type"><b>: </b><span>valid_state_prop Free s&#39;</span></span></span><br><span><var>x</var><span class="hyp-type"><b>: </b><span>vplan_item Free</span></span></span><br><span><var>a</var><span class="hyp-type"><b>: </b><span>list (vplan_item Free)</span></span></span><br><span><var>a_indices</var><span><span class="hyp-body"><b>:= </b><span>List.map projT1
  (List.map label_a (a ++ [x]))</span></span><span class="hyp-type"><b>: </b><span>list index</span></span></span></span><br><span><var>li</var><span class="hyp-type"><b>: </b><span>list index</span></span></span><br><span><var>Heq</var><span class="hyp-type"><b>: </b><span><span class="kr">‚àÄ</span> <span class="nv">i</span> : index, i ‚àà li ‚Üí s&#39; i = s i</span></span></span><br><span><var>Hincl</var><span class="hyp-type"><b>: </b><span>a_indices ‚äÜ li</span></span></span><br><span><var>Hpr</var><span class="hyp-type"><b>: </b><span>finite_valid_plan_from Free s (a ++ [x])</span></span></span><br><span><var>IHa</var><span class="hyp-type"><b>: </b><span><span class="kr">let</span> <span class="nv">a_indices</span> :=
  List.map projT1 (List.map label_a a) <span class="kr">in</span>
a_indices ‚äÜ li
‚Üí finite_valid_plan_from Free s a
  ‚Üí <span class="kr">let</span> <span class="nv">res&#39;</span> := (apply_plan Free s&#39; a).<span class="mi">2</span> <span class="kr">in</span>
    <span class="kr">let</span> <span class="nv">res</span> := (apply_plan Free s a).<span class="mi">2</span> <span class="kr">in</span>
    finite_valid_plan_from Free s&#39; a
    ‚àß (<span class="kr">‚àÄ</span> <span class="nv">i</span> : index, i ‚àà li ‚Üí res&#39; i = res i)</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="kr">let</span> <span class="nv">res&#39;</span> := (apply_plan Free s&#39; (a ++ [x])).<span class="mi">2</span> <span class="kr">in</span>
<span class="kr">let</span> <span class="nv">res</span> := (apply_plan Free s (a ++ [x])).<span class="mi">2</span> <span class="kr">in</span>
finite_valid_plan_from Free s&#39; (a ++ [x])
‚àß (<span class="kr">‚àÄ</span> <span class="nv">i</span> : index, i ‚àà li ‚Üí res&#39; i = res i)</div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="Composition-v-chk1e9" style="display: none" type="checkbox"><label class="alectryon-input" for="Composition-v-chk1e9"><span class="nb">simpl</span> <span class="kr">in</span> *.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>message, index</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>EqDecision0</var><span class="hyp-type"><b>: </b><span>EqDecision index</span></span></span><br><span><var>IM</var><span class="hyp-type"><b>: </b><span>index ‚Üí VLSM message</span></span></span><br><span><var>Free</var><span><span class="hyp-body"><b>:= </b><span>free_composite_vlsm IM</span></span><span class="hyp-type"><b>: </b><span>VLSM message</span></span></span></span><br><span><var>s, s'</var><span class="hyp-type"><b>: </b><span>vstate Free</span></span></span><br><span><var>Hprs'</var><span class="hyp-type"><b>: </b><span>valid_state_prop Free s&#39;</span></span></span><br><span><var>x</var><span class="hyp-type"><b>: </b><span>vplan_item Free</span></span></span><br><span><var>a</var><span class="hyp-type"><b>: </b><span>list (vplan_item Free)</span></span></span><br><span><var>a_indices</var><span><span class="hyp-body"><b>:= </b><span>List.map projT1
  (List.map label_a (a ++ [x]))</span></span><span class="hyp-type"><b>: </b><span>list index</span></span></span></span><br><span><var>li</var><span class="hyp-type"><b>: </b><span>list index</span></span></span><br><span><var>Heq</var><span class="hyp-type"><b>: </b><span><span class="kr">‚àÄ</span> <span class="nv">i</span> : index, i ‚àà li ‚Üí s&#39; i = s i</span></span></span><br><span><var>Hincl</var><span class="hyp-type"><b>: </b><span>a_indices ‚äÜ li</span></span></span><br><span><var>Hpr</var><span class="hyp-type"><b>: </b><span>finite_valid_plan_from Free s (a ++ [x])</span></span></span><br><span><var>IHa</var><span class="hyp-type"><b>: </b><span>List.map projT1 (List.map label_a a) ‚äÜ li
‚Üí finite_valid_plan_from Free s a
  ‚Üí finite_valid_plan_from Free s&#39; a
    ‚àß (<span class="kr">‚àÄ</span> <span class="nv">i</span> : index,
         i ‚àà li
         ‚Üí (apply_plan Free s&#39; a).<span class="mi">2</span> i =
           (apply_plan Free s a).<span class="mi">2</span> i)</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">finite_valid_plan_from Free s&#39; (a ++ [x])
‚àß (<span class="kr">‚àÄ</span> <span class="nv">i</span> : index,
     i ‚àà li
     ‚Üí (apply_plan Free s&#39; (a ++ [x])).<span class="mi">2</span> i =
       (apply_plan Free s (a ++ [x])).<span class="mi">2</span> i)</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="Composition-v-chk1ea" style="display: none" type="checkbox"><label class="alectryon-input" for="Composition-v-chk1ea"><span class="nb">apply</span> finite_valid_plan_from_app_iff <span class="kr">in</span> Hpr.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>message, index</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>EqDecision0</var><span class="hyp-type"><b>: </b><span>EqDecision index</span></span></span><br><span><var>IM</var><span class="hyp-type"><b>: </b><span>index ‚Üí VLSM message</span></span></span><br><span><var>Free</var><span><span class="hyp-body"><b>:= </b><span>free_composite_vlsm IM</span></span><span class="hyp-type"><b>: </b><span>VLSM message</span></span></span></span><br><span><var>s, s'</var><span class="hyp-type"><b>: </b><span>vstate Free</span></span></span><br><span><var>Hprs'</var><span class="hyp-type"><b>: </b><span>valid_state_prop Free s&#39;</span></span></span><br><span><var>x</var><span class="hyp-type"><b>: </b><span>vplan_item Free</span></span></span><br><span><var>a</var><span class="hyp-type"><b>: </b><span>list (vplan_item Free)</span></span></span><br><span><var>a_indices</var><span><span class="hyp-body"><b>:= </b><span>List.map projT1
  (List.map label_a (a ++ [x]))</span></span><span class="hyp-type"><b>: </b><span>list index</span></span></span></span><br><span><var>li</var><span class="hyp-type"><b>: </b><span>list index</span></span></span><br><span><var>Heq</var><span class="hyp-type"><b>: </b><span><span class="kr">‚àÄ</span> <span class="nv">i</span> : index, i ‚àà li ‚Üí s&#39; i = s i</span></span></span><br><span><var>Hincl</var><span class="hyp-type"><b>: </b><span>a_indices ‚äÜ li</span></span></span><br><span><var>Hpr</var><span class="hyp-type"><b>: </b><span>finite_valid_plan_from Free s a
‚àß finite_valid_plan_from Free
    (apply_plan Free s a).<span class="mi">2</span> [x]</span></span></span><br><span><var>IHa</var><span class="hyp-type"><b>: </b><span>List.map projT1 (List.map label_a a) ‚äÜ li
‚Üí finite_valid_plan_from Free s a
  ‚Üí finite_valid_plan_from Free s&#39; a
    ‚àß (<span class="kr">‚àÄ</span> <span class="nv">i</span> : index,
         i ‚àà li
         ‚Üí (apply_plan Free s&#39; a).<span class="mi">2</span> i =
           (apply_plan Free s a).<span class="mi">2</span> i)</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">finite_valid_plan_from Free s&#39; (a ++ [x])
‚àß (<span class="kr">‚àÄ</span> <span class="nv">i</span> : index,
     i ‚àà li
     ‚Üí (apply_plan Free s&#39; (a ++ [x])).<span class="mi">2</span> i =
       (apply_plan Free s (a ++ [x])).<span class="mi">2</span> i)</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="Composition-v-chk1eb" style="display: none" type="checkbox"><label class="alectryon-input" for="Composition-v-chk1eb"><span class="nb">destruct</span> Hpr <span class="kr">as</span> [Hrem Hsingle].</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>message, index</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>EqDecision0</var><span class="hyp-type"><b>: </b><span>EqDecision index</span></span></span><br><span><var>IM</var><span class="hyp-type"><b>: </b><span>index ‚Üí VLSM message</span></span></span><br><span><var>Free</var><span><span class="hyp-body"><b>:= </b><span>free_composite_vlsm IM</span></span><span class="hyp-type"><b>: </b><span>VLSM message</span></span></span></span><br><span><var>s, s'</var><span class="hyp-type"><b>: </b><span>vstate Free</span></span></span><br><span><var>Hprs'</var><span class="hyp-type"><b>: </b><span>valid_state_prop Free s&#39;</span></span></span><br><span><var>x</var><span class="hyp-type"><b>: </b><span>vplan_item Free</span></span></span><br><span><var>a</var><span class="hyp-type"><b>: </b><span>list (vplan_item Free)</span></span></span><br><span><var>a_indices</var><span><span class="hyp-body"><b>:= </b><span>List.map projT1
  (List.map label_a (a ++ [x]))</span></span><span class="hyp-type"><b>: </b><span>list index</span></span></span></span><br><span><var>li</var><span class="hyp-type"><b>: </b><span>list index</span></span></span><br><span><var>Heq</var><span class="hyp-type"><b>: </b><span><span class="kr">‚àÄ</span> <span class="nv">i</span> : index, i ‚àà li ‚Üí s&#39; i = s i</span></span></span><br><span><var>Hincl</var><span class="hyp-type"><b>: </b><span>a_indices ‚äÜ li</span></span></span><br><span><var>Hrem</var><span class="hyp-type"><b>: </b><span>finite_valid_plan_from Free s a</span></span></span><br><span><var>Hsingle</var><span class="hyp-type"><b>: </b><span>finite_valid_plan_from Free
  (apply_plan Free s a).<span class="mi">2</span> [x]</span></span></span><br><span><var>IHa</var><span class="hyp-type"><b>: </b><span>List.map projT1 (List.map label_a a) ‚äÜ li
‚Üí finite_valid_plan_from Free s a
  ‚Üí finite_valid_plan_from Free s&#39; a
    ‚àß (<span class="kr">‚àÄ</span> <span class="nv">i</span> : index,
         i ‚àà li
         ‚Üí (apply_plan Free s&#39; a).<span class="mi">2</span> i =
           (apply_plan Free s a).<span class="mi">2</span> i)</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">finite_valid_plan_from Free s&#39; (a ++ [x])
‚àß (<span class="kr">‚àÄ</span> <span class="nv">i</span> : index,
     i ‚àà li
     ‚Üí (apply_plan Free s&#39; (a ++ [x])).<span class="mi">2</span> i =
       (apply_plan Free s (a ++ [x])).<span class="mi">2</span> i)</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
</span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="Composition-v-chk1ec" style="display: none" type="checkbox"><label class="alectryon-input" for="Composition-v-chk1ec">spec IHa.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>message, index</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>EqDecision0</var><span class="hyp-type"><b>: </b><span>EqDecision index</span></span></span><br><span><var>IM</var><span class="hyp-type"><b>: </b><span>index ‚Üí VLSM message</span></span></span><br><span><var>Free</var><span><span class="hyp-body"><b>:= </b><span>free_composite_vlsm IM</span></span><span class="hyp-type"><b>: </b><span>VLSM message</span></span></span></span><br><span><var>s, s'</var><span class="hyp-type"><b>: </b><span>vstate Free</span></span></span><br><span><var>Hprs'</var><span class="hyp-type"><b>: </b><span>valid_state_prop Free s&#39;</span></span></span><br><span><var>x</var><span class="hyp-type"><b>: </b><span>vplan_item Free</span></span></span><br><span><var>a</var><span class="hyp-type"><b>: </b><span>list (vplan_item Free)</span></span></span><br><span><var>a_indices</var><span><span class="hyp-body"><b>:= </b><span>List.map projT1
  (List.map label_a (a ++ [x]))</span></span><span class="hyp-type"><b>: </b><span>list index</span></span></span></span><br><span><var>li</var><span class="hyp-type"><b>: </b><span>list index</span></span></span><br><span><var>Heq</var><span class="hyp-type"><b>: </b><span><span class="kr">‚àÄ</span> <span class="nv">i</span> : index, i ‚àà li ‚Üí s&#39; i = s i</span></span></span><br><span><var>Hincl</var><span class="hyp-type"><b>: </b><span>a_indices ‚äÜ li</span></span></span><br><span><var>Hrem</var><span class="hyp-type"><b>: </b><span>finite_valid_plan_from Free s a</span></span></span><br><span><var>Hsingle</var><span class="hyp-type"><b>: </b><span>finite_valid_plan_from Free
  (apply_plan Free s a).<span class="mi">2</span> [x]</span></span></span><br><span><var>IHa</var><span class="hyp-type"><b>: </b><span>List.map projT1 (List.map label_a a) ‚äÜ li
‚Üí finite_valid_plan_from Free s a
  ‚Üí finite_valid_plan_from Free s&#39; a
    ‚àß (<span class="kr">‚àÄ</span> <span class="nv">i</span> : index,
         i ‚àà li
         ‚Üí (apply_plan Free s&#39; a).<span class="mi">2</span> i =
           (apply_plan Free s a).<span class="mi">2</span> i)</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">List.map projT1 (List.map label_a a) ‚äÜ li</div></blockquote><div class="alectryon-extra-goals"><input class="alectryon-extra-goal-toggle" id="Composition-v-chk1ed" style="display: none" type="checkbox"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>message, index</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>EqDecision0</var><span class="hyp-type"><b>: </b><span>EqDecision index</span></span></span><br><span><var>IM</var><span class="hyp-type"><b>: </b><span>index ‚Üí VLSM message</span></span></span><br><span><var>Free</var><span><span class="hyp-body"><b>:= </b><span>free_composite_vlsm IM</span></span><span class="hyp-type"><b>: </b><span>VLSM message</span></span></span></span><br><span><var>s, s'</var><span class="hyp-type"><b>: </b><span>vstate Free</span></span></span><br><span><var>Hprs'</var><span class="hyp-type"><b>: </b><span>valid_state_prop Free s&#39;</span></span></span><br><span><var>x</var><span class="hyp-type"><b>: </b><span>vplan_item Free</span></span></span><br><span><var>a</var><span class="hyp-type"><b>: </b><span>list (vplan_item Free)</span></span></span><br><span><var>a_indices</var><span><span class="hyp-body"><b>:= </b><span>List.map projT1
  (List.map label_a (a ++ [x]))</span></span><span class="hyp-type"><b>: </b><span>list index</span></span></span></span><br><span><var>li</var><span class="hyp-type"><b>: </b><span>list index</span></span></span><br><span><var>Heq</var><span class="hyp-type"><b>: </b><span><span class="kr">‚àÄ</span> <span class="nv">i</span> : index, i ‚àà li ‚Üí s&#39; i = s i</span></span></span><br><span><var>Hincl</var><span class="hyp-type"><b>: </b><span>a_indices ‚äÜ li</span></span></span><br><span><var>Hrem</var><span class="hyp-type"><b>: </b><span>finite_valid_plan_from Free s a</span></span></span><br><span><var>Hsingle</var><span class="hyp-type"><b>: </b><span>finite_valid_plan_from Free
  (apply_plan Free s a).<span class="mi">2</span> [x]</span></span></span><br><span><var>IHa</var><span class="hyp-type"><b>: </b><span>finite_valid_plan_from Free s a
‚Üí finite_valid_plan_from Free s&#39; a
  ‚àß (<span class="kr">‚àÄ</span> <span class="nv">i</span> : index,
       i ‚àà li
       ‚Üí (apply_plan Free s&#39; a).<span class="mi">2</span> i =
         (apply_plan Free s a).<span class="mi">2</span> i)</span></span></span><br></div><label class="goal-separator" for="Composition-v-chk1ed"><hr></label><div class="goal-conclusion">finite_valid_plan_from Free s&#39; (a ++ [x])
‚àß (<span class="kr">‚àÄ</span> <span class="nv">i</span> : index,
     i ‚àà li
     ‚Üí (apply_plan Free s&#39; (a ++ [x])).<span class="mi">2</span> i =
       (apply_plan Free s (a ++ [x])).<span class="mi">2</span> i)</div></blockquote></div></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="Composition-v-chk1ee" style="display: none" type="checkbox"><label class="alectryon-input" for="Composition-v-chk1ee">{</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>message, index</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>EqDecision0</var><span class="hyp-type"><b>: </b><span>EqDecision index</span></span></span><br><span><var>IM</var><span class="hyp-type"><b>: </b><span>index ‚Üí VLSM message</span></span></span><br><span><var>Free</var><span><span class="hyp-body"><b>:= </b><span>free_composite_vlsm IM</span></span><span class="hyp-type"><b>: </b><span>VLSM message</span></span></span></span><br><span><var>s, s'</var><span class="hyp-type"><b>: </b><span>vstate Free</span></span></span><br><span><var>Hprs'</var><span class="hyp-type"><b>: </b><span>valid_state_prop Free s&#39;</span></span></span><br><span><var>x</var><span class="hyp-type"><b>: </b><span>vplan_item Free</span></span></span><br><span><var>a</var><span class="hyp-type"><b>: </b><span>list (vplan_item Free)</span></span></span><br><span><var>a_indices</var><span><span class="hyp-body"><b>:= </b><span>List.map projT1
  (List.map label_a (a ++ [x]))</span></span><span class="hyp-type"><b>: </b><span>list index</span></span></span></span><br><span><var>li</var><span class="hyp-type"><b>: </b><span>list index</span></span></span><br><span><var>Heq</var><span class="hyp-type"><b>: </b><span><span class="kr">‚àÄ</span> <span class="nv">i</span> : index, i ‚àà li ‚Üí s&#39; i = s i</span></span></span><br><span><var>Hincl</var><span class="hyp-type"><b>: </b><span>a_indices ‚äÜ li</span></span></span><br><span><var>Hrem</var><span class="hyp-type"><b>: </b><span>finite_valid_plan_from Free s a</span></span></span><br><span><var>Hsingle</var><span class="hyp-type"><b>: </b><span>finite_valid_plan_from Free
  (apply_plan Free s a).<span class="mi">2</span> [x]</span></span></span><br><span><var>IHa</var><span class="hyp-type"><b>: </b><span>List.map projT1 (List.map label_a a) ‚äÜ li
‚Üí finite_valid_plan_from Free s a
  ‚Üí finite_valid_plan_from Free s&#39; a
    ‚àß (<span class="kr">‚àÄ</span> <span class="nv">i</span> : index,
         i ‚àà li
         ‚Üí (apply_plan Free s&#39; a).<span class="mi">2</span> i =
           (apply_plan Free s a).<span class="mi">2</span> i)</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">List.map projT1 (List.map label_a a) ‚äÜ li</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">      </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="Composition-v-chk1ef" style="display: none" type="checkbox"><label class="alectryon-input" for="Composition-v-chk1ef"><span class="nb">remember</span> (List.map (@projT1 _ (<span class="kr">fun</span> <span class="nv">n</span> : index =&gt; vlabel (IM n))) (List.map label_a a)) <span class="kr">as</span> small.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>message, index</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>EqDecision0</var><span class="hyp-type"><b>: </b><span>EqDecision index</span></span></span><br><span><var>IM</var><span class="hyp-type"><b>: </b><span>index ‚Üí VLSM message</span></span></span><br><span><var>Free</var><span><span class="hyp-body"><b>:= </b><span>free_composite_vlsm IM</span></span><span class="hyp-type"><b>: </b><span>VLSM message</span></span></span></span><br><span><var>s, s'</var><span class="hyp-type"><b>: </b><span>vstate Free</span></span></span><br><span><var>Hprs'</var><span class="hyp-type"><b>: </b><span>valid_state_prop Free s&#39;</span></span></span><br><span><var>x</var><span class="hyp-type"><b>: </b><span>vplan_item Free</span></span></span><br><span><var>a</var><span class="hyp-type"><b>: </b><span>list (vplan_item Free)</span></span></span><br><span><var>a_indices</var><span><span class="hyp-body"><b>:= </b><span>List.map projT1
  (List.map label_a (a ++ [x]))</span></span><span class="hyp-type"><b>: </b><span>list index</span></span></span></span><br><span><var>li</var><span class="hyp-type"><b>: </b><span>list index</span></span></span><br><span><var>Heq</var><span class="hyp-type"><b>: </b><span><span class="kr">‚àÄ</span> <span class="nv">i</span> : index, i ‚àà li ‚Üí s&#39; i = s i</span></span></span><br><span><var>Hincl</var><span class="hyp-type"><b>: </b><span>a_indices ‚äÜ li</span></span></span><br><span><var>Hrem</var><span class="hyp-type"><b>: </b><span>finite_valid_plan_from Free s a</span></span></span><br><span><var>Hsingle</var><span class="hyp-type"><b>: </b><span>finite_valid_plan_from Free
  (apply_plan Free s a).<span class="mi">2</span> [x]</span></span></span><br><span><var>IHa</var><span class="hyp-type"><b>: </b><span>List.map projT1 (List.map label_a a) ‚äÜ li
‚Üí finite_valid_plan_from Free s a
  ‚Üí finite_valid_plan_from Free s&#39; a
    ‚àß (<span class="kr">‚àÄ</span> <span class="nv">i</span> : index,
         i ‚àà li
         ‚Üí (apply_plan Free s&#39; a).<span class="mi">2</span> i =
           (apply_plan Free s a).<span class="mi">2</span> i)</span></span></span><br><span><var>small</var><span class="hyp-type"><b>: </b><span>list index</span></span></span><br><span><var>Heqsmall</var><span class="hyp-type"><b>: </b><span>small =
List.map projT1 (List.map label_a a)</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">List.map projT1 (List.map label_a a) ‚äÜ li</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">      </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="Composition-v-chk1f0" style="display: none" type="checkbox"><label class="alectryon-input" for="Composition-v-chk1f0"><span class="nb">transitivity</span> a_indices; [| <span class="bp">done</span>].</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>message, index</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>EqDecision0</var><span class="hyp-type"><b>: </b><span>EqDecision index</span></span></span><br><span><var>IM</var><span class="hyp-type"><b>: </b><span>index ‚Üí VLSM message</span></span></span><br><span><var>Free</var><span><span class="hyp-body"><b>:= </b><span>free_composite_vlsm IM</span></span><span class="hyp-type"><b>: </b><span>VLSM message</span></span></span></span><br><span><var>s, s'</var><span class="hyp-type"><b>: </b><span>vstate Free</span></span></span><br><span><var>Hprs'</var><span class="hyp-type"><b>: </b><span>valid_state_prop Free s&#39;</span></span></span><br><span><var>x</var><span class="hyp-type"><b>: </b><span>vplan_item Free</span></span></span><br><span><var>a</var><span class="hyp-type"><b>: </b><span>list (vplan_item Free)</span></span></span><br><span><var>a_indices</var><span><span class="hyp-body"><b>:= </b><span>List.map projT1
  (List.map label_a (a ++ [x]))</span></span><span class="hyp-type"><b>: </b><span>list index</span></span></span></span><br><span><var>li</var><span class="hyp-type"><b>: </b><span>list index</span></span></span><br><span><var>Heq</var><span class="hyp-type"><b>: </b><span><span class="kr">‚àÄ</span> <span class="nv">i</span> : index, i ‚àà li ‚Üí s&#39; i = s i</span></span></span><br><span><var>Hincl</var><span class="hyp-type"><b>: </b><span>a_indices ‚äÜ li</span></span></span><br><span><var>Hrem</var><span class="hyp-type"><b>: </b><span>finite_valid_plan_from Free s a</span></span></span><br><span><var>Hsingle</var><span class="hyp-type"><b>: </b><span>finite_valid_plan_from Free
  (apply_plan Free s a).<span class="mi">2</span> [x]</span></span></span><br><span><var>IHa</var><span class="hyp-type"><b>: </b><span>List.map projT1 (List.map label_a a) ‚äÜ li
‚Üí finite_valid_plan_from Free s a
  ‚Üí finite_valid_plan_from Free s&#39; a
    ‚àß (<span class="kr">‚àÄ</span> <span class="nv">i</span> : index,
         i ‚àà li
         ‚Üí (apply_plan Free s&#39; a).<span class="mi">2</span> i =
           (apply_plan Free s a).<span class="mi">2</span> i)</span></span></span><br><span><var>small</var><span class="hyp-type"><b>: </b><span>list index</span></span></span><br><span><var>Heqsmall</var><span class="hyp-type"><b>: </b><span>small =
List.map projT1 (List.map label_a a)</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">List.map projT1 (List.map label_a a) ‚äÜ a_indices</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">      </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="Composition-v-chk1f1" style="display: none" type="checkbox"><label class="alectryon-input" for="Composition-v-chk1f1"><span class="nb">unfold</span> a_indices.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>message, index</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>EqDecision0</var><span class="hyp-type"><b>: </b><span>EqDecision index</span></span></span><br><span><var>IM</var><span class="hyp-type"><b>: </b><span>index ‚Üí VLSM message</span></span></span><br><span><var>Free</var><span><span class="hyp-body"><b>:= </b><span>free_composite_vlsm IM</span></span><span class="hyp-type"><b>: </b><span>VLSM message</span></span></span></span><br><span><var>s, s'</var><span class="hyp-type"><b>: </b><span>vstate Free</span></span></span><br><span><var>Hprs'</var><span class="hyp-type"><b>: </b><span>valid_state_prop Free s&#39;</span></span></span><br><span><var>x</var><span class="hyp-type"><b>: </b><span>vplan_item Free</span></span></span><br><span><var>a</var><span class="hyp-type"><b>: </b><span>list (vplan_item Free)</span></span></span><br><span><var>a_indices</var><span><span class="hyp-body"><b>:= </b><span>List.map projT1
  (List.map label_a (a ++ [x]))</span></span><span class="hyp-type"><b>: </b><span>list index</span></span></span></span><br><span><var>li</var><span class="hyp-type"><b>: </b><span>list index</span></span></span><br><span><var>Heq</var><span class="hyp-type"><b>: </b><span><span class="kr">‚àÄ</span> <span class="nv">i</span> : index, i ‚àà li ‚Üí s&#39; i = s i</span></span></span><br><span><var>Hincl</var><span class="hyp-type"><b>: </b><span>a_indices ‚äÜ li</span></span></span><br><span><var>Hrem</var><span class="hyp-type"><b>: </b><span>finite_valid_plan_from Free s a</span></span></span><br><span><var>Hsingle</var><span class="hyp-type"><b>: </b><span>finite_valid_plan_from Free
  (apply_plan Free s a).<span class="mi">2</span> [x]</span></span></span><br><span><var>IHa</var><span class="hyp-type"><b>: </b><span>List.map projT1 (List.map label_a a) ‚äÜ li
‚Üí finite_valid_plan_from Free s a
  ‚Üí finite_valid_plan_from Free s&#39; a
    ‚àß (<span class="kr">‚àÄ</span> <span class="nv">i</span> : index,
         i ‚àà li
         ‚Üí (apply_plan Free s&#39; a).<span class="mi">2</span> i =
           (apply_plan Free s a).<span class="mi">2</span> i)</span></span></span><br><span><var>small</var><span class="hyp-type"><b>: </b><span>list index</span></span></span><br><span><var>Heqsmall</var><span class="hyp-type"><b>: </b><span>small =
List.map projT1 (List.map label_a a)</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">List.map projT1 (List.map label_a a)
‚äÜ List.map projT1 (List.map label_a (a ++ [x]))</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">      </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="Composition-v-chk1f2" style="display: none" type="checkbox"><label class="alectryon-input" for="Composition-v-chk1f2"><span class="nb">intros</span> e H; <span class="nb">simpl</span>.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>message, index</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>EqDecision0</var><span class="hyp-type"><b>: </b><span>EqDecision index</span></span></span><br><span><var>IM</var><span class="hyp-type"><b>: </b><span>index ‚Üí VLSM message</span></span></span><br><span><var>Free</var><span><span class="hyp-body"><b>:= </b><span>free_composite_vlsm IM</span></span><span class="hyp-type"><b>: </b><span>VLSM message</span></span></span></span><br><span><var>s, s'</var><span class="hyp-type"><b>: </b><span>vstate Free</span></span></span><br><span><var>Hprs'</var><span class="hyp-type"><b>: </b><span>valid_state_prop Free s&#39;</span></span></span><br><span><var>x</var><span class="hyp-type"><b>: </b><span>vplan_item Free</span></span></span><br><span><var>a</var><span class="hyp-type"><b>: </b><span>list (vplan_item Free)</span></span></span><br><span><var>a_indices</var><span><span class="hyp-body"><b>:= </b><span>List.map projT1
  (List.map label_a (a ++ [x]))</span></span><span class="hyp-type"><b>: </b><span>list index</span></span></span></span><br><span><var>li</var><span class="hyp-type"><b>: </b><span>list index</span></span></span><br><span><var>Heq</var><span class="hyp-type"><b>: </b><span><span class="kr">‚àÄ</span> <span class="nv">i</span> : index, i ‚àà li ‚Üí s&#39; i = s i</span></span></span><br><span><var>Hincl</var><span class="hyp-type"><b>: </b><span>a_indices ‚äÜ li</span></span></span><br><span><var>Hrem</var><span class="hyp-type"><b>: </b><span>finite_valid_plan_from Free s a</span></span></span><br><span><var>Hsingle</var><span class="hyp-type"><b>: </b><span>finite_valid_plan_from Free
  (apply_plan Free s a).<span class="mi">2</span> [x]</span></span></span><br><span><var>IHa</var><span class="hyp-type"><b>: </b><span>List.map projT1 (List.map label_a a) ‚äÜ li
‚Üí finite_valid_plan_from Free s a
  ‚Üí finite_valid_plan_from Free s&#39; a
    ‚àß (<span class="kr">‚àÄ</span> <span class="nv">i</span> : index,
         i ‚àà li
         ‚Üí (apply_plan Free s&#39; a).<span class="mi">2</span> i =
           (apply_plan Free s a).<span class="mi">2</span> i)</span></span></span><br><span><var>small</var><span class="hyp-type"><b>: </b><span>list index</span></span></span><br><span><var>Heqsmall</var><span class="hyp-type"><b>: </b><span>small =
List.map projT1 (List.map label_a a)</span></span></span><br><span><var>e</var><span class="hyp-type"><b>: </b><span>index</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>e ‚àà List.map projT1 (List.map label_a a)</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">e ‚àà List.map projT1 (List.map label_a (a ++ [x]))</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">      </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="Composition-v-chk1f3" style="display: none" type="checkbox"><label class="alectryon-input" for="Composition-v-chk1f3"><span class="nb">rewrite</span> <span class="mi">2</span> map_app, elem_of_app.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>message, index</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>EqDecision0</var><span class="hyp-type"><b>: </b><span>EqDecision index</span></span></span><br><span><var>IM</var><span class="hyp-type"><b>: </b><span>index ‚Üí VLSM message</span></span></span><br><span><var>Free</var><span><span class="hyp-body"><b>:= </b><span>free_composite_vlsm IM</span></span><span class="hyp-type"><b>: </b><span>VLSM message</span></span></span></span><br><span><var>s, s'</var><span class="hyp-type"><b>: </b><span>vstate Free</span></span></span><br><span><var>Hprs'</var><span class="hyp-type"><b>: </b><span>valid_state_prop Free s&#39;</span></span></span><br><span><var>x</var><span class="hyp-type"><b>: </b><span>vplan_item Free</span></span></span><br><span><var>a</var><span class="hyp-type"><b>: </b><span>list (vplan_item Free)</span></span></span><br><span><var>a_indices</var><span><span class="hyp-body"><b>:= </b><span>List.map projT1
  (List.map label_a (a ++ [x]))</span></span><span class="hyp-type"><b>: </b><span>list index</span></span></span></span><br><span><var>li</var><span class="hyp-type"><b>: </b><span>list index</span></span></span><br><span><var>Heq</var><span class="hyp-type"><b>: </b><span><span class="kr">‚àÄ</span> <span class="nv">i</span> : index, i ‚àà li ‚Üí s&#39; i = s i</span></span></span><br><span><var>Hincl</var><span class="hyp-type"><b>: </b><span>a_indices ‚äÜ li</span></span></span><br><span><var>Hrem</var><span class="hyp-type"><b>: </b><span>finite_valid_plan_from Free s a</span></span></span><br><span><var>Hsingle</var><span class="hyp-type"><b>: </b><span>finite_valid_plan_from Free
  (apply_plan Free s a).<span class="mi">2</span> [x]</span></span></span><br><span><var>IHa</var><span class="hyp-type"><b>: </b><span>List.map projT1 (List.map label_a a) ‚äÜ li
‚Üí finite_valid_plan_from Free s a
  ‚Üí finite_valid_plan_from Free s&#39; a
    ‚àß (<span class="kr">‚àÄ</span> <span class="nv">i</span> : index,
         i ‚àà li
         ‚Üí (apply_plan Free s&#39; a).<span class="mi">2</span> i =
           (apply_plan Free s a).<span class="mi">2</span> i)</span></span></span><br><span><var>small</var><span class="hyp-type"><b>: </b><span>list index</span></span></span><br><span><var>Heqsmall</var><span class="hyp-type"><b>: </b><span>small =
List.map projT1 (List.map label_a a)</span></span></span><br><span><var>e</var><span class="hyp-type"><b>: </b><span>index</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>e ‚àà List.map projT1 (List.map label_a a)</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">e ‚àà List.map projT1 (List.map label_a a)
‚à® e ‚àà List.map projT1 (List.map label_a [x])</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">      </span><span class="alectryon-sentence"><span class="alectryon-input">itauto.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="Composition-v-chk1f4" style="display: none" type="checkbox"><label class="alectryon-input" for="Composition-v-chk1f4">}</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>message, index</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>EqDecision0</var><span class="hyp-type"><b>: </b><span>EqDecision index</span></span></span><br><span><var>IM</var><span class="hyp-type"><b>: </b><span>index ‚Üí VLSM message</span></span></span><br><span><var>Free</var><span><span class="hyp-body"><b>:= </b><span>free_composite_vlsm IM</span></span><span class="hyp-type"><b>: </b><span>VLSM message</span></span></span></span><br><span><var>s, s'</var><span class="hyp-type"><b>: </b><span>vstate Free</span></span></span><br><span><var>Hprs'</var><span class="hyp-type"><b>: </b><span>valid_state_prop Free s&#39;</span></span></span><br><span><var>x</var><span class="hyp-type"><b>: </b><span>vplan_item Free</span></span></span><br><span><var>a</var><span class="hyp-type"><b>: </b><span>list (vplan_item Free)</span></span></span><br><span><var>a_indices</var><span><span class="hyp-body"><b>:= </b><span>List.map projT1
  (List.map label_a (a ++ [x]))</span></span><span class="hyp-type"><b>: </b><span>list index</span></span></span></span><br><span><var>li</var><span class="hyp-type"><b>: </b><span>list index</span></span></span><br><span><var>Heq</var><span class="hyp-type"><b>: </b><span><span class="kr">‚àÄ</span> <span class="nv">i</span> : index, i ‚àà li ‚Üí s&#39; i = s i</span></span></span><br><span><var>Hincl</var><span class="hyp-type"><b>: </b><span>a_indices ‚äÜ li</span></span></span><br><span><var>Hrem</var><span class="hyp-type"><b>: </b><span>finite_valid_plan_from Free s a</span></span></span><br><span><var>Hsingle</var><span class="hyp-type"><b>: </b><span>finite_valid_plan_from Free
  (apply_plan Free s a).<span class="mi">2</span> [x]</span></span></span><br><span><var>IHa</var><span class="hyp-type"><b>: </b><span>finite_valid_plan_from Free s a
‚Üí finite_valid_plan_from Free s&#39; a
  ‚àß (<span class="kr">‚àÄ</span> <span class="nv">i</span> : index,
       i ‚àà li
       ‚Üí (apply_plan Free s&#39; a).<span class="mi">2</span> i =
         (apply_plan Free s a).<span class="mi">2</span> i)</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">finite_valid_plan_from Free s&#39; (a ++ [x])
‚àß (<span class="kr">‚àÄ</span> <span class="nv">i</span> : index,
     i ‚àà li
     ‚Üí (apply_plan Free s&#39; (a ++ [x])).<span class="mi">2</span> i =
       (apply_plan Free s (a ++ [x])).<span class="mi">2</span> i)</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
</span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="Composition-v-chk1f5" style="display: none" type="checkbox"><label class="alectryon-input" for="Composition-v-chk1f5">spec IHa; [<span class="bp">done</span> |].</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>message, index</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>EqDecision0</var><span class="hyp-type"><b>: </b><span>EqDecision index</span></span></span><br><span><var>IM</var><span class="hyp-type"><b>: </b><span>index ‚Üí VLSM message</span></span></span><br><span><var>Free</var><span><span class="hyp-body"><b>:= </b><span>free_composite_vlsm IM</span></span><span class="hyp-type"><b>: </b><span>VLSM message</span></span></span></span><br><span><var>s, s'</var><span class="hyp-type"><b>: </b><span>vstate Free</span></span></span><br><span><var>Hprs'</var><span class="hyp-type"><b>: </b><span>valid_state_prop Free s&#39;</span></span></span><br><span><var>x</var><span class="hyp-type"><b>: </b><span>vplan_item Free</span></span></span><br><span><var>a</var><span class="hyp-type"><b>: </b><span>list (vplan_item Free)</span></span></span><br><span><var>a_indices</var><span><span class="hyp-body"><b>:= </b><span>List.map projT1
  (List.map label_a (a ++ [x]))</span></span><span class="hyp-type"><b>: </b><span>list index</span></span></span></span><br><span><var>li</var><span class="hyp-type"><b>: </b><span>list index</span></span></span><br><span><var>Heq</var><span class="hyp-type"><b>: </b><span><span class="kr">‚àÄ</span> <span class="nv">i</span> : index, i ‚àà li ‚Üí s&#39; i = s i</span></span></span><br><span><var>Hincl</var><span class="hyp-type"><b>: </b><span>a_indices ‚äÜ li</span></span></span><br><span><var>Hrem</var><span class="hyp-type"><b>: </b><span>finite_valid_plan_from Free s a</span></span></span><br><span><var>Hsingle</var><span class="hyp-type"><b>: </b><span>finite_valid_plan_from Free
  (apply_plan Free s a).<span class="mi">2</span> [x]</span></span></span><br><span><var>IHa</var><span class="hyp-type"><b>: </b><span>finite_valid_plan_from Free s&#39; a
‚àß (<span class="kr">‚àÄ</span> <span class="nv">i</span> : index,
     i ‚àà li
     ‚Üí (apply_plan Free s&#39; a).<span class="mi">2</span> i =
       (apply_plan Free s a).<span class="mi">2</span> i)</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">finite_valid_plan_from Free s&#39; (a ++ [x])
‚àß (<span class="kr">‚àÄ</span> <span class="nv">i</span> : index,
     i ‚àà li
     ‚Üí (apply_plan Free s&#39; (a ++ [x])).<span class="mi">2</span> i =
       (apply_plan Free s (a ++ [x])).<span class="mi">2</span> i)</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
</span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="Composition-v-chk1f6" style="display: none" type="checkbox"><label class="alectryon-input" for="Composition-v-chk1f6"><span class="nb">destruct</span> IHa <span class="kr">as</span> [IHapr IHaind].</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>message, index</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>EqDecision0</var><span class="hyp-type"><b>: </b><span>EqDecision index</span></span></span><br><span><var>IM</var><span class="hyp-type"><b>: </b><span>index ‚Üí VLSM message</span></span></span><br><span><var>Free</var><span><span class="hyp-body"><b>:= </b><span>free_composite_vlsm IM</span></span><span class="hyp-type"><b>: </b><span>VLSM message</span></span></span></span><br><span><var>s, s'</var><span class="hyp-type"><b>: </b><span>vstate Free</span></span></span><br><span><var>Hprs'</var><span class="hyp-type"><b>: </b><span>valid_state_prop Free s&#39;</span></span></span><br><span><var>x</var><span class="hyp-type"><b>: </b><span>vplan_item Free</span></span></span><br><span><var>a</var><span class="hyp-type"><b>: </b><span>list (vplan_item Free)</span></span></span><br><span><var>a_indices</var><span><span class="hyp-body"><b>:= </b><span>List.map projT1
  (List.map label_a (a ++ [x]))</span></span><span class="hyp-type"><b>: </b><span>list index</span></span></span></span><br><span><var>li</var><span class="hyp-type"><b>: </b><span>list index</span></span></span><br><span><var>Heq</var><span class="hyp-type"><b>: </b><span><span class="kr">‚àÄ</span> <span class="nv">i</span> : index, i ‚àà li ‚Üí s&#39; i = s i</span></span></span><br><span><var>Hincl</var><span class="hyp-type"><b>: </b><span>a_indices ‚äÜ li</span></span></span><br><span><var>Hrem</var><span class="hyp-type"><b>: </b><span>finite_valid_plan_from Free s a</span></span></span><br><span><var>Hsingle</var><span class="hyp-type"><b>: </b><span>finite_valid_plan_from Free
  (apply_plan Free s a).<span class="mi">2</span> [x]</span></span></span><br><span><var>IHapr</var><span class="hyp-type"><b>: </b><span>finite_valid_plan_from Free s&#39; a</span></span></span><br><span><var>IHaind</var><span class="hyp-type"><b>: </b><span><span class="kr">‚àÄ</span> <span class="nv">i</span> : index,
  i ‚àà li
  ‚Üí (apply_plan Free s&#39; a).<span class="mi">2</span> i =
    (apply_plan Free s a).<span class="mi">2</span> i</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">finite_valid_plan_from Free s&#39; (a ++ [x])
‚àß (<span class="kr">‚àÄ</span> <span class="nv">i</span> : index,
     i ‚àà li
     ‚Üí (apply_plan Free s&#39; (a ++ [x])).<span class="mi">2</span> i =
       (apply_plan Free s (a ++ [x])).<span class="mi">2</span> i)</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
</span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="Composition-v-chk1f7" style="display: none" type="checkbox"><label class="alectryon-input" for="Composition-v-chk1f7"><span class="nb">specialize</span> (relevant_components_one (snd (apply_plan Free s a)) (snd (apply_plan Free s&#39; a))) <span class="kr">as</span> Hrel.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>message, index</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>EqDecision0</var><span class="hyp-type"><b>: </b><span>EqDecision index</span></span></span><br><span><var>IM</var><span class="hyp-type"><b>: </b><span>index ‚Üí VLSM message</span></span></span><br><span><var>Free</var><span><span class="hyp-body"><b>:= </b><span>free_composite_vlsm IM</span></span><span class="hyp-type"><b>: </b><span>VLSM message</span></span></span></span><br><span><var>s, s'</var><span class="hyp-type"><b>: </b><span>vstate Free</span></span></span><br><span><var>Hprs'</var><span class="hyp-type"><b>: </b><span>valid_state_prop Free s&#39;</span></span></span><br><span><var>x</var><span class="hyp-type"><b>: </b><span>vplan_item Free</span></span></span><br><span><var>a</var><span class="hyp-type"><b>: </b><span>list (vplan_item Free)</span></span></span><br><span><var>a_indices</var><span><span class="hyp-body"><b>:= </b><span>List.map projT1
  (List.map label_a (a ++ [x]))</span></span><span class="hyp-type"><b>: </b><span>list index</span></span></span></span><br><span><var>li</var><span class="hyp-type"><b>: </b><span>list index</span></span></span><br><span><var>Heq</var><span class="hyp-type"><b>: </b><span><span class="kr">‚àÄ</span> <span class="nv">i</span> : index, i ‚àà li ‚Üí s&#39; i = s i</span></span></span><br><span><var>Hincl</var><span class="hyp-type"><b>: </b><span>a_indices ‚äÜ li</span></span></span><br><span><var>Hrem</var><span class="hyp-type"><b>: </b><span>finite_valid_plan_from Free s a</span></span></span><br><span><var>Hsingle</var><span class="hyp-type"><b>: </b><span>finite_valid_plan_from Free
  (apply_plan Free s a).<span class="mi">2</span> [x]</span></span></span><br><span><var>IHapr</var><span class="hyp-type"><b>: </b><span>finite_valid_plan_from Free s&#39; a</span></span></span><br><span><var>IHaind</var><span class="hyp-type"><b>: </b><span><span class="kr">‚àÄ</span> <span class="nv">i</span> : index,
  i ‚àà li
  ‚Üí (apply_plan Free s&#39; a).<span class="mi">2</span> i =
    (apply_plan Free s a).<span class="mi">2</span> i</span></span></span><br><span><var>Hrel</var><span class="hyp-type"><b>: </b><span>valid_state_prop Free (apply_plan Free s&#39; a).<span class="mi">2</span>
‚Üí <span class="kr">‚àÄ</span> <span class="nv">ai</span> : vplan_item Free,
    <span class="kr">let</span> <span class="nv">i</span> := projT1 (label_a ai) <span class="kr">in</span>
    (apply_plan Free s a).<span class="mi">2</span> i =
    (apply_plan Free s&#39; a).<span class="mi">2</span> i
    ‚Üí finite_valid_plan_from Free
        (apply_plan Free s a).<span class="mi">2</span> [ai]
      ‚Üí <span class="kr">let</span> <span class="nv">res&#39;</span> :=
          (apply_plan Free
             (apply_plan Free s&#39; a).<span class="mi">2</span> [ai]).<span class="mi">2</span>
          <span class="kr">in</span>
        <span class="kr">let</span> <span class="nv">res</span> :=
          (apply_plan Free
             (apply_plan Free s a).<span class="mi">2</span> [ai]).<span class="mi">2</span> <span class="kr">in</span>
        finite_valid_plan_from Free
          (apply_plan Free s&#39; a).<span class="mi">2</span> [ai]
        ‚àß res&#39; i = res i</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">finite_valid_plan_from Free s&#39; (a ++ [x])
‚àß (<span class="kr">‚àÄ</span> <span class="nv">i</span> : index,
     i ‚àà li
     ‚Üí (apply_plan Free s&#39; (a ++ [x])).<span class="mi">2</span> i =
       (apply_plan Free s (a ++ [x])).<span class="mi">2</span> i)</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
</span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="Composition-v-chk1f8" style="display: none" type="checkbox"><label class="alectryon-input" for="Composition-v-chk1f8">spec Hrel.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>message, index</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>EqDecision0</var><span class="hyp-type"><b>: </b><span>EqDecision index</span></span></span><br><span><var>IM</var><span class="hyp-type"><b>: </b><span>index ‚Üí VLSM message</span></span></span><br><span><var>Free</var><span><span class="hyp-body"><b>:= </b><span>free_composite_vlsm IM</span></span><span class="hyp-type"><b>: </b><span>VLSM message</span></span></span></span><br><span><var>s, s'</var><span class="hyp-type"><b>: </b><span>vstate Free</span></span></span><br><span><var>Hprs'</var><span class="hyp-type"><b>: </b><span>valid_state_prop Free s&#39;</span></span></span><br><span><var>x</var><span class="hyp-type"><b>: </b><span>vplan_item Free</span></span></span><br><span><var>a</var><span class="hyp-type"><b>: </b><span>list (vplan_item Free)</span></span></span><br><span><var>a_indices</var><span><span class="hyp-body"><b>:= </b><span>List.map projT1
  (List.map label_a (a ++ [x]))</span></span><span class="hyp-type"><b>: </b><span>list index</span></span></span></span><br><span><var>li</var><span class="hyp-type"><b>: </b><span>list index</span></span></span><br><span><var>Heq</var><span class="hyp-type"><b>: </b><span><span class="kr">‚àÄ</span> <span class="nv">i</span> : index, i ‚àà li ‚Üí s&#39; i = s i</span></span></span><br><span><var>Hincl</var><span class="hyp-type"><b>: </b><span>a_indices ‚äÜ li</span></span></span><br><span><var>Hrem</var><span class="hyp-type"><b>: </b><span>finite_valid_plan_from Free s a</span></span></span><br><span><var>Hsingle</var><span class="hyp-type"><b>: </b><span>finite_valid_plan_from Free
  (apply_plan Free s a).<span class="mi">2</span> [x]</span></span></span><br><span><var>IHapr</var><span class="hyp-type"><b>: </b><span>finite_valid_plan_from Free s&#39; a</span></span></span><br><span><var>IHaind</var><span class="hyp-type"><b>: </b><span><span class="kr">‚àÄ</span> <span class="nv">i</span> : index,
  i ‚àà li
  ‚Üí (apply_plan Free s&#39; a).<span class="mi">2</span> i =
    (apply_plan Free s a).<span class="mi">2</span> i</span></span></span><br><span><var>Hrel</var><span class="hyp-type"><b>: </b><span>valid_state_prop Free (apply_plan Free s&#39; a).<span class="mi">2</span>
‚Üí <span class="kr">‚àÄ</span> <span class="nv">ai</span> : vplan_item Free,
    <span class="kr">let</span> <span class="nv">i</span> := projT1 (label_a ai) <span class="kr">in</span>
    (apply_plan Free s a).<span class="mi">2</span> i =
    (apply_plan Free s&#39; a).<span class="mi">2</span> i
    ‚Üí finite_valid_plan_from Free
        (apply_plan Free s a).<span class="mi">2</span> [ai]
      ‚Üí <span class="kr">let</span> <span class="nv">res&#39;</span> :=
          (apply_plan Free
             (apply_plan Free s&#39; a).<span class="mi">2</span> [ai]).<span class="mi">2</span>
          <span class="kr">in</span>
        <span class="kr">let</span> <span class="nv">res</span> :=
          (apply_plan Free
             (apply_plan Free s a).<span class="mi">2</span> [ai]).<span class="mi">2</span> <span class="kr">in</span>
        finite_valid_plan_from Free
          (apply_plan Free s&#39; a).<span class="mi">2</span> [ai]
        ‚àß res&#39; i = res i</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">valid_state_prop Free (apply_plan Free s&#39; a).<span class="mi">2</span></div></blockquote><div class="alectryon-extra-goals"><input class="alectryon-extra-goal-toggle" id="Composition-v-chk1f9" style="display: none" type="checkbox"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>message, index</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>EqDecision0</var><span class="hyp-type"><b>: </b><span>EqDecision index</span></span></span><br><span><var>IM</var><span class="hyp-type"><b>: </b><span>index ‚Üí VLSM message</span></span></span><br><span><var>Free</var><span><span class="hyp-body"><b>:= </b><span>free_composite_vlsm IM</span></span><span class="hyp-type"><b>: </b><span>VLSM message</span></span></span></span><br><span><var>s, s'</var><span class="hyp-type"><b>: </b><span>vstate Free</span></span></span><br><span><var>Hprs'</var><span class="hyp-type"><b>: </b><span>valid_state_prop Free s&#39;</span></span></span><br><span><var>x</var><span class="hyp-type"><b>: </b><span>vplan_item Free</span></span></span><br><span><var>a</var><span class="hyp-type"><b>: </b><span>list (vplan_item Free)</span></span></span><br><span><var>a_indices</var><span><span class="hyp-body"><b>:= </b><span>List.map projT1
  (List.map label_a (a ++ [x]))</span></span><span class="hyp-type"><b>: </b><span>list index</span></span></span></span><br><span><var>li</var><span class="hyp-type"><b>: </b><span>list index</span></span></span><br><span><var>Heq</var><span class="hyp-type"><b>: </b><span><span class="kr">‚àÄ</span> <span class="nv">i</span> : index, i ‚àà li ‚Üí s&#39; i = s i</span></span></span><br><span><var>Hincl</var><span class="hyp-type"><b>: </b><span>a_indices ‚äÜ li</span></span></span><br><span><var>Hrem</var><span class="hyp-type"><b>: </b><span>finite_valid_plan_from Free s a</span></span></span><br><span><var>Hsingle</var><span class="hyp-type"><b>: </b><span>finite_valid_plan_from Free
  (apply_plan Free s a).<span class="mi">2</span> [x]</span></span></span><br><span><var>IHapr</var><span class="hyp-type"><b>: </b><span>finite_valid_plan_from Free s&#39; a</span></span></span><br><span><var>IHaind</var><span class="hyp-type"><b>: </b><span><span class="kr">‚àÄ</span> <span class="nv">i</span> : index,
  i ‚àà li
  ‚Üí (apply_plan Free s&#39; a).<span class="mi">2</span> i =
    (apply_plan Free s a).<span class="mi">2</span> i</span></span></span><br><span><var>Hrel</var><span class="hyp-type"><b>: </b><span><span class="kr">‚àÄ</span> <span class="nv">ai</span> : vplan_item Free,
  <span class="kr">let</span> <span class="nv">i</span> := projT1 (label_a ai) <span class="kr">in</span>
  (apply_plan Free s a).<span class="mi">2</span> i =
  (apply_plan Free s&#39; a).<span class="mi">2</span> i
  ‚Üí finite_valid_plan_from Free
      (apply_plan Free s a).<span class="mi">2</span> [ai]
    ‚Üí <span class="kr">let</span> <span class="nv">res&#39;</span> :=
        (apply_plan Free
           (apply_plan Free s&#39; a).<span class="mi">2</span> [ai]).<span class="mi">2</span> <span class="kr">in</span>
      <span class="kr">let</span> <span class="nv">res</span> :=
        (apply_plan Free
           (apply_plan Free s a).<span class="mi">2</span> [ai]).<span class="mi">2</span> <span class="kr">in</span>
      finite_valid_plan_from Free
        (apply_plan Free s&#39; a).<span class="mi">2</span> [ai]
      ‚àß res&#39; i = res i</span></span></span><br></div><label class="goal-separator" for="Composition-v-chk1f9"><hr></label><div class="goal-conclusion">finite_valid_plan_from Free s&#39; (a ++ [x])
‚àß (<span class="kr">‚àÄ</span> <span class="nv">i</span> : index,
     i ‚àà li
     ‚Üí (apply_plan Free s&#39; (a ++ [x])).<span class="mi">2</span> i =
       (apply_plan Free s (a ++ [x])).<span class="mi">2</span> i)</div></blockquote></div></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="Composition-v-chk1fa" style="display: none" type="checkbox"><label class="alectryon-input" for="Composition-v-chk1fa">{</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>message, index</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>EqDecision0</var><span class="hyp-type"><b>: </b><span>EqDecision index</span></span></span><br><span><var>IM</var><span class="hyp-type"><b>: </b><span>index ‚Üí VLSM message</span></span></span><br><span><var>Free</var><span><span class="hyp-body"><b>:= </b><span>free_composite_vlsm IM</span></span><span class="hyp-type"><b>: </b><span>VLSM message</span></span></span></span><br><span><var>s, s'</var><span class="hyp-type"><b>: </b><span>vstate Free</span></span></span><br><span><var>Hprs'</var><span class="hyp-type"><b>: </b><span>valid_state_prop Free s&#39;</span></span></span><br><span><var>x</var><span class="hyp-type"><b>: </b><span>vplan_item Free</span></span></span><br><span><var>a</var><span class="hyp-type"><b>: </b><span>list (vplan_item Free)</span></span></span><br><span><var>a_indices</var><span><span class="hyp-body"><b>:= </b><span>List.map projT1
  (List.map label_a (a ++ [x]))</span></span><span class="hyp-type"><b>: </b><span>list index</span></span></span></span><br><span><var>li</var><span class="hyp-type"><b>: </b><span>list index</span></span></span><br><span><var>Heq</var><span class="hyp-type"><b>: </b><span><span class="kr">‚àÄ</span> <span class="nv">i</span> : index, i ‚àà li ‚Üí s&#39; i = s i</span></span></span><br><span><var>Hincl</var><span class="hyp-type"><b>: </b><span>a_indices ‚äÜ li</span></span></span><br><span><var>Hrem</var><span class="hyp-type"><b>: </b><span>finite_valid_plan_from Free s a</span></span></span><br><span><var>Hsingle</var><span class="hyp-type"><b>: </b><span>finite_valid_plan_from Free
  (apply_plan Free s a).<span class="mi">2</span> [x]</span></span></span><br><span><var>IHapr</var><span class="hyp-type"><b>: </b><span>finite_valid_plan_from Free s&#39; a</span></span></span><br><span><var>IHaind</var><span class="hyp-type"><b>: </b><span><span class="kr">‚àÄ</span> <span class="nv">i</span> : index,
  i ‚àà li
  ‚Üí (apply_plan Free s&#39; a).<span class="mi">2</span> i =
    (apply_plan Free s a).<span class="mi">2</span> i</span></span></span><br><span><var>Hrel</var><span class="hyp-type"><b>: </b><span>valid_state_prop Free (apply_plan Free s&#39; a).<span class="mi">2</span>
‚Üí <span class="kr">‚àÄ</span> <span class="nv">ai</span> : vplan_item Free,
    <span class="kr">let</span> <span class="nv">i</span> := projT1 (label_a ai) <span class="kr">in</span>
    (apply_plan Free s a).<span class="mi">2</span> i =
    (apply_plan Free s&#39; a).<span class="mi">2</span> i
    ‚Üí finite_valid_plan_from Free
        (apply_plan Free s a).<span class="mi">2</span> [ai]
      ‚Üí <span class="kr">let</span> <span class="nv">res&#39;</span> :=
          (apply_plan Free
             (apply_plan Free s&#39; a).<span class="mi">2</span> [ai]).<span class="mi">2</span>
          <span class="kr">in</span>
        <span class="kr">let</span> <span class="nv">res</span> :=
          (apply_plan Free
             (apply_plan Free s a).<span class="mi">2</span> [ai]).<span class="mi">2</span> <span class="kr">in</span>
        finite_valid_plan_from Free
          (apply_plan Free s&#39; a).<span class="mi">2</span> [ai]
        ‚àß res&#39; i = res i</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">valid_state_prop Free (apply_plan Free s&#39; a).<span class="mi">2</span></div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">      </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="Composition-v-chk1fb" style="display: none" type="checkbox"><label class="alectryon-input" for="Composition-v-chk1fb"><span class="nb">apply</span> apply_plan_last_valid.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>message, index</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>EqDecision0</var><span class="hyp-type"><b>: </b><span>EqDecision index</span></span></span><br><span><var>IM</var><span class="hyp-type"><b>: </b><span>index ‚Üí VLSM message</span></span></span><br><span><var>Free</var><span><span class="hyp-body"><b>:= </b><span>free_composite_vlsm IM</span></span><span class="hyp-type"><b>: </b><span>VLSM message</span></span></span></span><br><span><var>s, s'</var><span class="hyp-type"><b>: </b><span>vstate Free</span></span></span><br><span><var>Hprs'</var><span class="hyp-type"><b>: </b><span>valid_state_prop Free s&#39;</span></span></span><br><span><var>x</var><span class="hyp-type"><b>: </b><span>vplan_item Free</span></span></span><br><span><var>a</var><span class="hyp-type"><b>: </b><span>list (vplan_item Free)</span></span></span><br><span><var>a_indices</var><span><span class="hyp-body"><b>:= </b><span>List.map projT1
  (List.map label_a (a ++ [x]))</span></span><span class="hyp-type"><b>: </b><span>list index</span></span></span></span><br><span><var>li</var><span class="hyp-type"><b>: </b><span>list index</span></span></span><br><span><var>Heq</var><span class="hyp-type"><b>: </b><span><span class="kr">‚àÄ</span> <span class="nv">i</span> : index, i ‚àà li ‚Üí s&#39; i = s i</span></span></span><br><span><var>Hincl</var><span class="hyp-type"><b>: </b><span>a_indices ‚äÜ li</span></span></span><br><span><var>Hrem</var><span class="hyp-type"><b>: </b><span>finite_valid_plan_from Free s a</span></span></span><br><span><var>Hsingle</var><span class="hyp-type"><b>: </b><span>finite_valid_plan_from Free
  (apply_plan Free s a).<span class="mi">2</span> [x]</span></span></span><br><span><var>IHapr</var><span class="hyp-type"><b>: </b><span>finite_valid_plan_from Free s&#39; a</span></span></span><br><span><var>IHaind</var><span class="hyp-type"><b>: </b><span><span class="kr">‚àÄ</span> <span class="nv">i</span> : index,
  i ‚àà li
  ‚Üí (apply_plan Free s&#39; a).<span class="mi">2</span> i =
    (apply_plan Free s a).<span class="mi">2</span> i</span></span></span><br><span><var>Hrel</var><span class="hyp-type"><b>: </b><span>valid_state_prop Free (apply_plan Free s&#39; a).<span class="mi">2</span>
‚Üí <span class="kr">‚àÄ</span> <span class="nv">ai</span> : vplan_item Free,
    <span class="kr">let</span> <span class="nv">i</span> := projT1 (label_a ai) <span class="kr">in</span>
    (apply_plan Free s a).<span class="mi">2</span> i =
    (apply_plan Free s&#39; a).<span class="mi">2</span> i
    ‚Üí finite_valid_plan_from Free
        (apply_plan Free s a).<span class="mi">2</span> [ai]
      ‚Üí <span class="kr">let</span> <span class="nv">res&#39;</span> :=
          (apply_plan Free
             (apply_plan Free s&#39; a).<span class="mi">2</span> [ai]).<span class="mi">2</span>
          <span class="kr">in</span>
        <span class="kr">let</span> <span class="nv">res</span> :=
          (apply_plan Free
             (apply_plan Free s a).<span class="mi">2</span> [ai]).<span class="mi">2</span> <span class="kr">in</span>
        finite_valid_plan_from Free
          (apply_plan Free s&#39; a).<span class="mi">2</span> [ai]
        ‚àß res&#39; i = res i</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">finite_valid_plan_from Free s&#39; a</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">      </span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kp">all</span> : itauto.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="Composition-v-chk1fc" style="display: none" type="checkbox"><label class="alectryon-input" for="Composition-v-chk1fc">}</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>message, index</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>EqDecision0</var><span class="hyp-type"><b>: </b><span>EqDecision index</span></span></span><br><span><var>IM</var><span class="hyp-type"><b>: </b><span>index ‚Üí VLSM message</span></span></span><br><span><var>Free</var><span><span class="hyp-body"><b>:= </b><span>free_composite_vlsm IM</span></span><span class="hyp-type"><b>: </b><span>VLSM message</span></span></span></span><br><span><var>s, s'</var><span class="hyp-type"><b>: </b><span>vstate Free</span></span></span><br><span><var>Hprs'</var><span class="hyp-type"><b>: </b><span>valid_state_prop Free s&#39;</span></span></span><br><span><var>x</var><span class="hyp-type"><b>: </b><span>vplan_item Free</span></span></span><br><span><var>a</var><span class="hyp-type"><b>: </b><span>list (vplan_item Free)</span></span></span><br><span><var>a_indices</var><span><span class="hyp-body"><b>:= </b><span>List.map projT1
  (List.map label_a (a ++ [x]))</span></span><span class="hyp-type"><b>: </b><span>list index</span></span></span></span><br><span><var>li</var><span class="hyp-type"><b>: </b><span>list index</span></span></span><br><span><var>Heq</var><span class="hyp-type"><b>: </b><span><span class="kr">‚àÄ</span> <span class="nv">i</span> : index, i ‚àà li ‚Üí s&#39; i = s i</span></span></span><br><span><var>Hincl</var><span class="hyp-type"><b>: </b><span>a_indices ‚äÜ li</span></span></span><br><span><var>Hrem</var><span class="hyp-type"><b>: </b><span>finite_valid_plan_from Free s a</span></span></span><br><span><var>Hsingle</var><span class="hyp-type"><b>: </b><span>finite_valid_plan_from Free
  (apply_plan Free s a).<span class="mi">2</span> [x]</span></span></span><br><span><var>IHapr</var><span class="hyp-type"><b>: </b><span>finite_valid_plan_from Free s&#39; a</span></span></span><br><span><var>IHaind</var><span class="hyp-type"><b>: </b><span><span class="kr">‚àÄ</span> <span class="nv">i</span> : index,
  i ‚àà li
  ‚Üí (apply_plan Free s&#39; a).<span class="mi">2</span> i =
    (apply_plan Free s a).<span class="mi">2</span> i</span></span></span><br><span><var>Hrel</var><span class="hyp-type"><b>: </b><span><span class="kr">‚àÄ</span> <span class="nv">ai</span> : vplan_item Free,
  <span class="kr">let</span> <span class="nv">i</span> := projT1 (label_a ai) <span class="kr">in</span>
  (apply_plan Free s a).<span class="mi">2</span> i =
  (apply_plan Free s&#39; a).<span class="mi">2</span> i
  ‚Üí finite_valid_plan_from Free
      (apply_plan Free s a).<span class="mi">2</span> [ai]
    ‚Üí <span class="kr">let</span> <span class="nv">res&#39;</span> :=
        (apply_plan Free
           (apply_plan Free s&#39; a).<span class="mi">2</span> [ai]).<span class="mi">2</span> <span class="kr">in</span>
      <span class="kr">let</span> <span class="nv">res</span> :=
        (apply_plan Free
           (apply_plan Free s a).<span class="mi">2</span> [ai]).<span class="mi">2</span> <span class="kr">in</span>
      finite_valid_plan_from Free
        (apply_plan Free s&#39; a).<span class="mi">2</span> [ai]
      ‚àß res&#39; i = res i</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">finite_valid_plan_from Free s&#39; (a ++ [x])
‚àß (<span class="kr">‚àÄ</span> <span class="nv">i</span> : index,
     i ‚àà li
     ‚Üí (apply_plan Free s&#39; (a ++ [x])).<span class="mi">2</span> i =
       (apply_plan Free s (a ++ [x])).<span class="mi">2</span> i)</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
</span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="Composition-v-chk1fd" style="display: none" type="checkbox"><label class="alectryon-input" for="Composition-v-chk1fd"><span class="nb">specialize</span> (Hrel x); <span class="nb">simpl</span> <span class="kr">in</span> *.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>message, index</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>EqDecision0</var><span class="hyp-type"><b>: </b><span>EqDecision index</span></span></span><br><span><var>IM</var><span class="hyp-type"><b>: </b><span>index ‚Üí VLSM message</span></span></span><br><span><var>Free</var><span><span class="hyp-body"><b>:= </b><span>free_composite_vlsm IM</span></span><span class="hyp-type"><b>: </b><span>VLSM message</span></span></span></span><br><span><var>s, s'</var><span class="hyp-type"><b>: </b><span>vstate Free</span></span></span><br><span><var>Hprs'</var><span class="hyp-type"><b>: </b><span>valid_state_prop Free s&#39;</span></span></span><br><span><var>x</var><span class="hyp-type"><b>: </b><span>vplan_item Free</span></span></span><br><span><var>a</var><span class="hyp-type"><b>: </b><span>list (vplan_item Free)</span></span></span><br><span><var>a_indices</var><span><span class="hyp-body"><b>:= </b><span>List.map projT1
  (List.map label_a (a ++ [x]))</span></span><span class="hyp-type"><b>: </b><span>list index</span></span></span></span><br><span><var>li</var><span class="hyp-type"><b>: </b><span>list index</span></span></span><br><span><var>Heq</var><span class="hyp-type"><b>: </b><span><span class="kr">‚àÄ</span> <span class="nv">i</span> : index, i ‚àà li ‚Üí s&#39; i = s i</span></span></span><br><span><var>Hincl</var><span class="hyp-type"><b>: </b><span>a_indices ‚äÜ li</span></span></span><br><span><var>Hrem</var><span class="hyp-type"><b>: </b><span>finite_valid_plan_from Free s a</span></span></span><br><span><var>Hsingle</var><span class="hyp-type"><b>: </b><span>finite_valid_plan_from Free
  (apply_plan Free s a).<span class="mi">2</span> [x]</span></span></span><br><span><var>IHapr</var><span class="hyp-type"><b>: </b><span>finite_valid_plan_from Free s&#39; a</span></span></span><br><span><var>IHaind</var><span class="hyp-type"><b>: </b><span><span class="kr">‚àÄ</span> <span class="nv">i</span> : index,
  i ‚àà li
  ‚Üí (apply_plan Free s&#39; a).<span class="mi">2</span> i =
    (apply_plan Free s a).<span class="mi">2</span> i</span></span></span><br><span><var>Hrel</var><span class="hyp-type"><b>: </b><span>(apply_plan Free s a).<span class="mi">2</span> (projT1 (label_a x)) =
(apply_plan Free s&#39; a).<span class="mi">2</span> (projT1 (label_a x))
‚Üí finite_valid_plan_from Free
    (apply_plan Free s a).<span class="mi">2</span> [x]
  ‚Üí finite_valid_plan_from Free
      (apply_plan Free s&#39; a).<span class="mi">2</span> [x]
    ‚àß (apply_plan Free 
         (apply_plan Free s&#39; a).<span class="mi">2</span> [x]).<span class="mi">2</span>
        (projT1 (label_a x)) =
      (apply_plan Free 
         (apply_plan Free s a).<span class="mi">2</span> [x]).<span class="mi">2</span>
        (projT1 (label_a x))</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">finite_valid_plan_from Free s&#39; (a ++ [x])
‚àß (<span class="kr">‚àÄ</span> <span class="nv">i</span> : index,
     i ‚àà li
     ‚Üí (apply_plan Free s&#39; (a ++ [x])).<span class="mi">2</span> i =
       (apply_plan Free s (a ++ [x])).<span class="mi">2</span> i)</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
</span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="Composition-v-chk1fe" style="display: none" type="checkbox"><label class="alectryon-input" for="Composition-v-chk1fe">spec Hrel.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>message, index</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>EqDecision0</var><span class="hyp-type"><b>: </b><span>EqDecision index</span></span></span><br><span><var>IM</var><span class="hyp-type"><b>: </b><span>index ‚Üí VLSM message</span></span></span><br><span><var>Free</var><span><span class="hyp-body"><b>:= </b><span>free_composite_vlsm IM</span></span><span class="hyp-type"><b>: </b><span>VLSM message</span></span></span></span><br><span><var>s, s'</var><span class="hyp-type"><b>: </b><span>vstate Free</span></span></span><br><span><var>Hprs'</var><span class="hyp-type"><b>: </b><span>valid_state_prop Free s&#39;</span></span></span><br><span><var>x</var><span class="hyp-type"><b>: </b><span>vplan_item Free</span></span></span><br><span><var>a</var><span class="hyp-type"><b>: </b><span>list (vplan_item Free)</span></span></span><br><span><var>a_indices</var><span><span class="hyp-body"><b>:= </b><span>List.map projT1
  (List.map label_a (a ++ [x]))</span></span><span class="hyp-type"><b>: </b><span>list index</span></span></span></span><br><span><var>li</var><span class="hyp-type"><b>: </b><span>list index</span></span></span><br><span><var>Heq</var><span class="hyp-type"><b>: </b><span><span class="kr">‚àÄ</span> <span class="nv">i</span> : index, i ‚àà li ‚Üí s&#39; i = s i</span></span></span><br><span><var>Hincl</var><span class="hyp-type"><b>: </b><span>a_indices ‚äÜ li</span></span></span><br><span><var>Hrem</var><span class="hyp-type"><b>: </b><span>finite_valid_plan_from Free s a</span></span></span><br><span><var>Hsingle</var><span class="hyp-type"><b>: </b><span>finite_valid_plan_from Free
  (apply_plan Free s a).<span class="mi">2</span> [x]</span></span></span><br><span><var>IHapr</var><span class="hyp-type"><b>: </b><span>finite_valid_plan_from Free s&#39; a</span></span></span><br><span><var>IHaind</var><span class="hyp-type"><b>: </b><span><span class="kr">‚àÄ</span> <span class="nv">i</span> : index,
  i ‚àà li
  ‚Üí (apply_plan Free s&#39; a).<span class="mi">2</span> i =
    (apply_plan Free s a).<span class="mi">2</span> i</span></span></span><br><span><var>Hrel</var><span class="hyp-type"><b>: </b><span>(apply_plan Free s a).<span class="mi">2</span> (projT1 (label_a x)) =
(apply_plan Free s&#39; a).<span class="mi">2</span> (projT1 (label_a x))
‚Üí finite_valid_plan_from Free
    (apply_plan Free s a).<span class="mi">2</span> [x]
  ‚Üí finite_valid_plan_from Free
      (apply_plan Free s&#39; a).<span class="mi">2</span> [x]
    ‚àß (apply_plan Free 
         (apply_plan Free s&#39; a).<span class="mi">2</span> [x]).<span class="mi">2</span>
        (projT1 (label_a x)) =
      (apply_plan Free 
         (apply_plan Free s a).<span class="mi">2</span> [x]).<span class="mi">2</span>
        (projT1 (label_a x))</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">(apply_plan Free s a).<span class="mi">2</span> (projT1 (label_a x)) =
(apply_plan Free s&#39; a).<span class="mi">2</span> (projT1 (label_a x))</div></blockquote><div class="alectryon-extra-goals"><input class="alectryon-extra-goal-toggle" id="Composition-v-chk1ff" style="display: none" type="checkbox"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>message, index</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>EqDecision0</var><span class="hyp-type"><b>: </b><span>EqDecision index</span></span></span><br><span><var>IM</var><span class="hyp-type"><b>: </b><span>index ‚Üí VLSM message</span></span></span><br><span><var>Free</var><span><span class="hyp-body"><b>:= </b><span>free_composite_vlsm IM</span></span><span class="hyp-type"><b>: </b><span>VLSM message</span></span></span></span><br><span><var>s, s'</var><span class="hyp-type"><b>: </b><span>vstate Free</span></span></span><br><span><var>Hprs'</var><span class="hyp-type"><b>: </b><span>valid_state_prop Free s&#39;</span></span></span><br><span><var>x</var><span class="hyp-type"><b>: </b><span>vplan_item Free</span></span></span><br><span><var>a</var><span class="hyp-type"><b>: </b><span>list (vplan_item Free)</span></span></span><br><span><var>a_indices</var><span><span class="hyp-body"><b>:= </b><span>List.map projT1
  (List.map label_a (a ++ [x]))</span></span><span class="hyp-type"><b>: </b><span>list index</span></span></span></span><br><span><var>li</var><span class="hyp-type"><b>: </b><span>list index</span></span></span><br><span><var>Heq</var><span class="hyp-type"><b>: </b><span><span class="kr">‚àÄ</span> <span class="nv">i</span> : index, i ‚àà li ‚Üí s&#39; i = s i</span></span></span><br><span><var>Hincl</var><span class="hyp-type"><b>: </b><span>a_indices ‚äÜ li</span></span></span><br><span><var>Hrem</var><span class="hyp-type"><b>: </b><span>finite_valid_plan_from Free s a</span></span></span><br><span><var>Hsingle</var><span class="hyp-type"><b>: </b><span>finite_valid_plan_from Free
  (apply_plan Free s a).<span class="mi">2</span> [x]</span></span></span><br><span><var>IHapr</var><span class="hyp-type"><b>: </b><span>finite_valid_plan_from Free s&#39; a</span></span></span><br><span><var>IHaind</var><span class="hyp-type"><b>: </b><span><span class="kr">‚àÄ</span> <span class="nv">i</span> : index,
  i ‚àà li
  ‚Üí (apply_plan Free s&#39; a).<span class="mi">2</span> i =
    (apply_plan Free s a).<span class="mi">2</span> i</span></span></span><br><span><var>Hrel</var><span class="hyp-type"><b>: </b><span>finite_valid_plan_from Free
  (apply_plan Free s a).<span class="mi">2</span> [x]
‚Üí finite_valid_plan_from Free
    (apply_plan Free s&#39; a).<span class="mi">2</span> [x]
  ‚àß (apply_plan Free (apply_plan Free s&#39; a).<span class="mi">2</span>
       [x]).<span class="mi">2</span> (projT1 (label_a x)) =
    (apply_plan Free (apply_plan Free s a).<span class="mi">2</span>
       [x]).<span class="mi">2</span> (projT1 (label_a x))</span></span></span><br></div><label class="goal-separator" for="Composition-v-chk1ff"><hr></label><div class="goal-conclusion">finite_valid_plan_from Free s&#39; (a ++ [x])
‚àß (<span class="kr">‚àÄ</span> <span class="nv">i</span> : index,
     i ‚àà li
     ‚Üí (apply_plan Free s&#39; (a ++ [x])).<span class="mi">2</span> i =
       (apply_plan Free s (a ++ [x])).<span class="mi">2</span> i)</div></blockquote></div></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="Composition-v-chk200" style="display: none" type="checkbox"><label class="alectryon-input" for="Composition-v-chk200">{</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>message, index</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>EqDecision0</var><span class="hyp-type"><b>: </b><span>EqDecision index</span></span></span><br><span><var>IM</var><span class="hyp-type"><b>: </b><span>index ‚Üí VLSM message</span></span></span><br><span><var>Free</var><span><span class="hyp-body"><b>:= </b><span>free_composite_vlsm IM</span></span><span class="hyp-type"><b>: </b><span>VLSM message</span></span></span></span><br><span><var>s, s'</var><span class="hyp-type"><b>: </b><span>vstate Free</span></span></span><br><span><var>Hprs'</var><span class="hyp-type"><b>: </b><span>valid_state_prop Free s&#39;</span></span></span><br><span><var>x</var><span class="hyp-type"><b>: </b><span>vplan_item Free</span></span></span><br><span><var>a</var><span class="hyp-type"><b>: </b><span>list (vplan_item Free)</span></span></span><br><span><var>a_indices</var><span><span class="hyp-body"><b>:= </b><span>List.map projT1
  (List.map label_a (a ++ [x]))</span></span><span class="hyp-type"><b>: </b><span>list index</span></span></span></span><br><span><var>li</var><span class="hyp-type"><b>: </b><span>list index</span></span></span><br><span><var>Heq</var><span class="hyp-type"><b>: </b><span><span class="kr">‚àÄ</span> <span class="nv">i</span> : index, i ‚àà li ‚Üí s&#39; i = s i</span></span></span><br><span><var>Hincl</var><span class="hyp-type"><b>: </b><span>a_indices ‚äÜ li</span></span></span><br><span><var>Hrem</var><span class="hyp-type"><b>: </b><span>finite_valid_plan_from Free s a</span></span></span><br><span><var>Hsingle</var><span class="hyp-type"><b>: </b><span>finite_valid_plan_from Free
  (apply_plan Free s a).<span class="mi">2</span> [x]</span></span></span><br><span><var>IHapr</var><span class="hyp-type"><b>: </b><span>finite_valid_plan_from Free s&#39; a</span></span></span><br><span><var>IHaind</var><span class="hyp-type"><b>: </b><span><span class="kr">‚àÄ</span> <span class="nv">i</span> : index,
  i ‚àà li
  ‚Üí (apply_plan Free s&#39; a).<span class="mi">2</span> i =
    (apply_plan Free s a).<span class="mi">2</span> i</span></span></span><br><span><var>Hrel</var><span class="hyp-type"><b>: </b><span>(apply_plan Free s a).<span class="mi">2</span> (projT1 (label_a x)) =
(apply_plan Free s&#39; a).<span class="mi">2</span> (projT1 (label_a x))
‚Üí finite_valid_plan_from Free
    (apply_plan Free s a).<span class="mi">2</span> [x]
  ‚Üí finite_valid_plan_from Free
      (apply_plan Free s&#39; a).<span class="mi">2</span> [x]
    ‚àß (apply_plan Free 
         (apply_plan Free s&#39; a).<span class="mi">2</span> [x]).<span class="mi">2</span>
        (projT1 (label_a x)) =
      (apply_plan Free 
         (apply_plan Free s a).<span class="mi">2</span> [x]).<span class="mi">2</span>
        (projT1 (label_a x))</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">(apply_plan Free s a).<span class="mi">2</span> (projT1 (label_a x)) =
(apply_plan Free s&#39; a).<span class="mi">2</span> (projT1 (label_a x))</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">      </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="Composition-v-chk201" style="display: none" type="checkbox"><label class="alectryon-input" for="Composition-v-chk201"><span class="nb">specialize</span> (IHaind (projT1 (label_a x))).</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>message, index</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>EqDecision0</var><span class="hyp-type"><b>: </b><span>EqDecision index</span></span></span><br><span><var>IM</var><span class="hyp-type"><b>: </b><span>index ‚Üí VLSM message</span></span></span><br><span><var>Free</var><span><span class="hyp-body"><b>:= </b><span>free_composite_vlsm IM</span></span><span class="hyp-type"><b>: </b><span>VLSM message</span></span></span></span><br><span><var>s, s'</var><span class="hyp-type"><b>: </b><span>vstate Free</span></span></span><br><span><var>Hprs'</var><span class="hyp-type"><b>: </b><span>valid_state_prop Free s&#39;</span></span></span><br><span><var>x</var><span class="hyp-type"><b>: </b><span>vplan_item Free</span></span></span><br><span><var>a</var><span class="hyp-type"><b>: </b><span>list (vplan_item Free)</span></span></span><br><span><var>a_indices</var><span><span class="hyp-body"><b>:= </b><span>List.map projT1
  (List.map label_a (a ++ [x]))</span></span><span class="hyp-type"><b>: </b><span>list index</span></span></span></span><br><span><var>li</var><span class="hyp-type"><b>: </b><span>list index</span></span></span><br><span><var>Heq</var><span class="hyp-type"><b>: </b><span><span class="kr">‚àÄ</span> <span class="nv">i</span> : index, i ‚àà li ‚Üí s&#39; i = s i</span></span></span><br><span><var>Hincl</var><span class="hyp-type"><b>: </b><span>a_indices ‚äÜ li</span></span></span><br><span><var>Hrem</var><span class="hyp-type"><b>: </b><span>finite_valid_plan_from Free s a</span></span></span><br><span><var>Hsingle</var><span class="hyp-type"><b>: </b><span>finite_valid_plan_from Free
  (apply_plan Free s a).<span class="mi">2</span> [x]</span></span></span><br><span><var>IHapr</var><span class="hyp-type"><b>: </b><span>finite_valid_plan_from Free s&#39; a</span></span></span><br><span><var>IHaind</var><span class="hyp-type"><b>: </b><span>projT1 (label_a x) ‚àà li
‚Üí (apply_plan Free s&#39; a).<span class="mi">2</span>
    (projT1 (label_a x)) =
  (apply_plan Free s a).<span class="mi">2</span>
    (projT1 (label_a x))</span></span></span><br><span><var>Hrel</var><span class="hyp-type"><b>: </b><span>(apply_plan Free s a).<span class="mi">2</span> (projT1 (label_a x)) =
(apply_plan Free s&#39; a).<span class="mi">2</span> (projT1 (label_a x))
‚Üí finite_valid_plan_from Free
    (apply_plan Free s a).<span class="mi">2</span> [x]
  ‚Üí finite_valid_plan_from Free
      (apply_plan Free s&#39; a).<span class="mi">2</span> [x]
    ‚àß (apply_plan Free 
         (apply_plan Free s&#39; a).<span class="mi">2</span> [x]).<span class="mi">2</span>
        (projT1 (label_a x)) =
      (apply_plan Free 
         (apply_plan Free s a).<span class="mi">2</span> [x]).<span class="mi">2</span>
        (projT1 (label_a x))</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">(apply_plan Free s a).<span class="mi">2</span> (projT1 (label_a x)) =
(apply_plan Free s&#39; a).<span class="mi">2</span> (projT1 (label_a x))</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">      </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="Composition-v-chk202" style="display: none" type="checkbox"><label class="alectryon-input" for="Composition-v-chk202"><span class="nb">symmetry</span>.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>message, index</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>EqDecision0</var><span class="hyp-type"><b>: </b><span>EqDecision index</span></span></span><br><span><var>IM</var><span class="hyp-type"><b>: </b><span>index ‚Üí VLSM message</span></span></span><br><span><var>Free</var><span><span class="hyp-body"><b>:= </b><span>free_composite_vlsm IM</span></span><span class="hyp-type"><b>: </b><span>VLSM message</span></span></span></span><br><span><var>s, s'</var><span class="hyp-type"><b>: </b><span>vstate Free</span></span></span><br><span><var>Hprs'</var><span class="hyp-type"><b>: </b><span>valid_state_prop Free s&#39;</span></span></span><br><span><var>x</var><span class="hyp-type"><b>: </b><span>vplan_item Free</span></span></span><br><span><var>a</var><span class="hyp-type"><b>: </b><span>list (vplan_item Free)</span></span></span><br><span><var>a_indices</var><span><span class="hyp-body"><b>:= </b><span>List.map projT1
  (List.map label_a (a ++ [x]))</span></span><span class="hyp-type"><b>: </b><span>list index</span></span></span></span><br><span><var>li</var><span class="hyp-type"><b>: </b><span>list index</span></span></span><br><span><var>Heq</var><span class="hyp-type"><b>: </b><span><span class="kr">‚àÄ</span> <span class="nv">i</span> : index, i ‚àà li ‚Üí s&#39; i = s i</span></span></span><br><span><var>Hincl</var><span class="hyp-type"><b>: </b><span>a_indices ‚äÜ li</span></span></span><br><span><var>Hrem</var><span class="hyp-type"><b>: </b><span>finite_valid_plan_from Free s a</span></span></span><br><span><var>Hsingle</var><span class="hyp-type"><b>: </b><span>finite_valid_plan_from Free
  (apply_plan Free s a).<span class="mi">2</span> [x]</span></span></span><br><span><var>IHapr</var><span class="hyp-type"><b>: </b><span>finite_valid_plan_from Free s&#39; a</span></span></span><br><span><var>IHaind</var><span class="hyp-type"><b>: </b><span>projT1 (label_a x) ‚àà li
‚Üí (apply_plan Free s&#39; a).<span class="mi">2</span>
    (projT1 (label_a x)) =
  (apply_plan Free s a).<span class="mi">2</span>
    (projT1 (label_a x))</span></span></span><br><span><var>Hrel</var><span class="hyp-type"><b>: </b><span>(apply_plan Free s a).<span class="mi">2</span> (projT1 (label_a x)) =
(apply_plan Free s&#39; a).<span class="mi">2</span> (projT1 (label_a x))
‚Üí finite_valid_plan_from Free
    (apply_plan Free s a).<span class="mi">2</span> [x]
  ‚Üí finite_valid_plan_from Free
      (apply_plan Free s&#39; a).<span class="mi">2</span> [x]
    ‚àß (apply_plan Free 
         (apply_plan Free s&#39; a).<span class="mi">2</span> [x]).<span class="mi">2</span>
        (projT1 (label_a x)) =
      (apply_plan Free 
         (apply_plan Free s a).<span class="mi">2</span> [x]).<span class="mi">2</span>
        (projT1 (label_a x))</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">(apply_plan Free s&#39; a).<span class="mi">2</span> (projT1 (label_a x)) =
(apply_plan Free s a).<span class="mi">2</span> (projT1 (label_a x))</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">      </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="Composition-v-chk203" style="display: none" type="checkbox"><label class="alectryon-input" for="Composition-v-chk203"><span class="nb">apply</span> IHaind.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>message, index</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>EqDecision0</var><span class="hyp-type"><b>: </b><span>EqDecision index</span></span></span><br><span><var>IM</var><span class="hyp-type"><b>: </b><span>index ‚Üí VLSM message</span></span></span><br><span><var>Free</var><span><span class="hyp-body"><b>:= </b><span>free_composite_vlsm IM</span></span><span class="hyp-type"><b>: </b><span>VLSM message</span></span></span></span><br><span><var>s, s'</var><span class="hyp-type"><b>: </b><span>vstate Free</span></span></span><br><span><var>Hprs'</var><span class="hyp-type"><b>: </b><span>valid_state_prop Free s&#39;</span></span></span><br><span><var>x</var><span class="hyp-type"><b>: </b><span>vplan_item Free</span></span></span><br><span><var>a</var><span class="hyp-type"><b>: </b><span>list (vplan_item Free)</span></span></span><br><span><var>a_indices</var><span><span class="hyp-body"><b>:= </b><span>List.map projT1
  (List.map label_a (a ++ [x]))</span></span><span class="hyp-type"><b>: </b><span>list index</span></span></span></span><br><span><var>li</var><span class="hyp-type"><b>: </b><span>list index</span></span></span><br><span><var>Heq</var><span class="hyp-type"><b>: </b><span><span class="kr">‚àÄ</span> <span class="nv">i</span> : index, i ‚àà li ‚Üí s&#39; i = s i</span></span></span><br><span><var>Hincl</var><span class="hyp-type"><b>: </b><span>a_indices ‚äÜ li</span></span></span><br><span><var>Hrem</var><span class="hyp-type"><b>: </b><span>finite_valid_plan_from Free s a</span></span></span><br><span><var>Hsingle</var><span class="hyp-type"><b>: </b><span>finite_valid_plan_from Free
  (apply_plan Free s a).<span class="mi">2</span> [x]</span></span></span><br><span><var>IHapr</var><span class="hyp-type"><b>: </b><span>finite_valid_plan_from Free s&#39; a</span></span></span><br><span><var>IHaind</var><span class="hyp-type"><b>: </b><span>projT1 (label_a x) ‚àà li
‚Üí (apply_plan Free s&#39; a).<span class="mi">2</span>
    (projT1 (label_a x)) =
  (apply_plan Free s a).<span class="mi">2</span>
    (projT1 (label_a x))</span></span></span><br><span><var>Hrel</var><span class="hyp-type"><b>: </b><span>(apply_plan Free s a).<span class="mi">2</span> (projT1 (label_a x)) =
(apply_plan Free s&#39; a).<span class="mi">2</span> (projT1 (label_a x))
‚Üí finite_valid_plan_from Free
    (apply_plan Free s a).<span class="mi">2</span> [x]
  ‚Üí finite_valid_plan_from Free
      (apply_plan Free s&#39; a).<span class="mi">2</span> [x]
    ‚àß (apply_plan Free 
         (apply_plan Free s&#39; a).<span class="mi">2</span> [x]).<span class="mi">2</span>
        (projT1 (label_a x)) =
      (apply_plan Free 
         (apply_plan Free s a).<span class="mi">2</span> [x]).<span class="mi">2</span>
        (projT1 (label_a x))</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">projT1 (label_a x) ‚àà li</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">      </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="Composition-v-chk204" style="display: none" type="checkbox"><label class="alectryon-input" for="Composition-v-chk204"><span class="nb">specialize</span> (Hincl (projT1 (label_a x))).</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>message, index</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>EqDecision0</var><span class="hyp-type"><b>: </b><span>EqDecision index</span></span></span><br><span><var>IM</var><span class="hyp-type"><b>: </b><span>index ‚Üí VLSM message</span></span></span><br><span><var>Free</var><span><span class="hyp-body"><b>:= </b><span>free_composite_vlsm IM</span></span><span class="hyp-type"><b>: </b><span>VLSM message</span></span></span></span><br><span><var>s, s'</var><span class="hyp-type"><b>: </b><span>vstate Free</span></span></span><br><span><var>Hprs'</var><span class="hyp-type"><b>: </b><span>valid_state_prop Free s&#39;</span></span></span><br><span><var>x</var><span class="hyp-type"><b>: </b><span>vplan_item Free</span></span></span><br><span><var>a</var><span class="hyp-type"><b>: </b><span>list (vplan_item Free)</span></span></span><br><span><var>a_indices</var><span><span class="hyp-body"><b>:= </b><span>List.map projT1
  (List.map label_a (a ++ [x]))</span></span><span class="hyp-type"><b>: </b><span>list index</span></span></span></span><br><span><var>li</var><span class="hyp-type"><b>: </b><span>list index</span></span></span><br><span><var>Heq</var><span class="hyp-type"><b>: </b><span><span class="kr">‚àÄ</span> <span class="nv">i</span> : index, i ‚àà li ‚Üí s&#39; i = s i</span></span></span><br><span><var>Hincl</var><span class="hyp-type"><b>: </b><span>projT1 (label_a x) ‚àà a_indices
‚Üí projT1 (label_a x) ‚àà li</span></span></span><br><span><var>Hrem</var><span class="hyp-type"><b>: </b><span>finite_valid_plan_from Free s a</span></span></span><br><span><var>Hsingle</var><span class="hyp-type"><b>: </b><span>finite_valid_plan_from Free
  (apply_plan Free s a).<span class="mi">2</span> [x]</span></span></span><br><span><var>IHapr</var><span class="hyp-type"><b>: </b><span>finite_valid_plan_from Free s&#39; a</span></span></span><br><span><var>IHaind</var><span class="hyp-type"><b>: </b><span>projT1 (label_a x) ‚àà li
‚Üí (apply_plan Free s&#39; a).<span class="mi">2</span>
    (projT1 (label_a x)) =
  (apply_plan Free s a).<span class="mi">2</span>
    (projT1 (label_a x))</span></span></span><br><span><var>Hrel</var><span class="hyp-type"><b>: </b><span>(apply_plan Free s a).<span class="mi">2</span> (projT1 (label_a x)) =
(apply_plan Free s&#39; a).<span class="mi">2</span> (projT1 (label_a x))
‚Üí finite_valid_plan_from Free
    (apply_plan Free s a).<span class="mi">2</span> [x]
  ‚Üí finite_valid_plan_from Free
      (apply_plan Free s&#39; a).<span class="mi">2</span> [x]
    ‚àß (apply_plan Free 
         (apply_plan Free s&#39; a).<span class="mi">2</span> [x]).<span class="mi">2</span>
        (projT1 (label_a x)) =
      (apply_plan Free 
         (apply_plan Free s a).<span class="mi">2</span> [x]).<span class="mi">2</span>
        (projT1 (label_a x))</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">projT1 (label_a x) ‚àà li</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">      </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="Composition-v-chk205" style="display: none" type="checkbox"><label class="alectryon-input" for="Composition-v-chk205"><span class="nb">apply</span> Hincl.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>message, index</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>EqDecision0</var><span class="hyp-type"><b>: </b><span>EqDecision index</span></span></span><br><span><var>IM</var><span class="hyp-type"><b>: </b><span>index ‚Üí VLSM message</span></span></span><br><span><var>Free</var><span><span class="hyp-body"><b>:= </b><span>free_composite_vlsm IM</span></span><span class="hyp-type"><b>: </b><span>VLSM message</span></span></span></span><br><span><var>s, s'</var><span class="hyp-type"><b>: </b><span>vstate Free</span></span></span><br><span><var>Hprs'</var><span class="hyp-type"><b>: </b><span>valid_state_prop Free s&#39;</span></span></span><br><span><var>x</var><span class="hyp-type"><b>: </b><span>vplan_item Free</span></span></span><br><span><var>a</var><span class="hyp-type"><b>: </b><span>list (vplan_item Free)</span></span></span><br><span><var>a_indices</var><span><span class="hyp-body"><b>:= </b><span>List.map projT1
  (List.map label_a (a ++ [x]))</span></span><span class="hyp-type"><b>: </b><span>list index</span></span></span></span><br><span><var>li</var><span class="hyp-type"><b>: </b><span>list index</span></span></span><br><span><var>Heq</var><span class="hyp-type"><b>: </b><span><span class="kr">‚àÄ</span> <span class="nv">i</span> : index, i ‚àà li ‚Üí s&#39; i = s i</span></span></span><br><span><var>Hincl</var><span class="hyp-type"><b>: </b><span>projT1 (label_a x) ‚àà a_indices
‚Üí projT1 (label_a x) ‚àà li</span></span></span><br><span><var>Hrem</var><span class="hyp-type"><b>: </b><span>finite_valid_plan_from Free s a</span></span></span><br><span><var>Hsingle</var><span class="hyp-type"><b>: </b><span>finite_valid_plan_from Free
  (apply_plan Free s a).<span class="mi">2</span> [x]</span></span></span><br><span><var>IHapr</var><span class="hyp-type"><b>: </b><span>finite_valid_plan_from Free s&#39; a</span></span></span><br><span><var>IHaind</var><span class="hyp-type"><b>: </b><span>projT1 (label_a x) ‚àà li
‚Üí (apply_plan Free s&#39; a).<span class="mi">2</span>
    (projT1 (label_a x)) =
  (apply_plan Free s a).<span class="mi">2</span>
    (projT1 (label_a x))</span></span></span><br><span><var>Hrel</var><span class="hyp-type"><b>: </b><span>(apply_plan Free s a).<span class="mi">2</span> (projT1 (label_a x)) =
(apply_plan Free s&#39; a).<span class="mi">2</span> (projT1 (label_a x))
‚Üí finite_valid_plan_from Free
    (apply_plan Free s a).<span class="mi">2</span> [x]
  ‚Üí finite_valid_plan_from Free
      (apply_plan Free s&#39; a).<span class="mi">2</span> [x]
    ‚àß (apply_plan Free 
         (apply_plan Free s&#39; a).<span class="mi">2</span> [x]).<span class="mi">2</span>
        (projT1 (label_a x)) =
      (apply_plan Free 
         (apply_plan Free s a).<span class="mi">2</span> [x]).<span class="mi">2</span>
        (projT1 (label_a x))</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">projT1 (label_a x) ‚àà a_indices</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">      </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="Composition-v-chk206" style="display: none" type="checkbox"><label class="alectryon-input" for="Composition-v-chk206"><span class="nb">unfold</span> a_indices.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>message, index</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>EqDecision0</var><span class="hyp-type"><b>: </b><span>EqDecision index</span></span></span><br><span><var>IM</var><span class="hyp-type"><b>: </b><span>index ‚Üí VLSM message</span></span></span><br><span><var>Free</var><span><span class="hyp-body"><b>:= </b><span>free_composite_vlsm IM</span></span><span class="hyp-type"><b>: </b><span>VLSM message</span></span></span></span><br><span><var>s, s'</var><span class="hyp-type"><b>: </b><span>vstate Free</span></span></span><br><span><var>Hprs'</var><span class="hyp-type"><b>: </b><span>valid_state_prop Free s&#39;</span></span></span><br><span><var>x</var><span class="hyp-type"><b>: </b><span>vplan_item Free</span></span></span><br><span><var>a</var><span class="hyp-type"><b>: </b><span>list (vplan_item Free)</span></span></span><br><span><var>a_indices</var><span><span class="hyp-body"><b>:= </b><span>List.map projT1
  (List.map label_a (a ++ [x]))</span></span><span class="hyp-type"><b>: </b><span>list index</span></span></span></span><br><span><var>li</var><span class="hyp-type"><b>: </b><span>list index</span></span></span><br><span><var>Heq</var><span class="hyp-type"><b>: </b><span><span class="kr">‚àÄ</span> <span class="nv">i</span> : index, i ‚àà li ‚Üí s&#39; i = s i</span></span></span><br><span><var>Hincl</var><span class="hyp-type"><b>: </b><span>projT1 (label_a x) ‚àà a_indices
‚Üí projT1 (label_a x) ‚àà li</span></span></span><br><span><var>Hrem</var><span class="hyp-type"><b>: </b><span>finite_valid_plan_from Free s a</span></span></span><br><span><var>Hsingle</var><span class="hyp-type"><b>: </b><span>finite_valid_plan_from Free
  (apply_plan Free s a).<span class="mi">2</span> [x]</span></span></span><br><span><var>IHapr</var><span class="hyp-type"><b>: </b><span>finite_valid_plan_from Free s&#39; a</span></span></span><br><span><var>IHaind</var><span class="hyp-type"><b>: </b><span>projT1 (label_a x) ‚àà li
‚Üí (apply_plan Free s&#39; a).<span class="mi">2</span>
    (projT1 (label_a x)) =
  (apply_plan Free s a).<span class="mi">2</span>
    (projT1 (label_a x))</span></span></span><br><span><var>Hrel</var><span class="hyp-type"><b>: </b><span>(apply_plan Free s a).<span class="mi">2</span> (projT1 (label_a x)) =
(apply_plan Free s&#39; a).<span class="mi">2</span> (projT1 (label_a x))
‚Üí finite_valid_plan_from Free
    (apply_plan Free s a).<span class="mi">2</span> [x]
  ‚Üí finite_valid_plan_from Free
      (apply_plan Free s&#39; a).<span class="mi">2</span> [x]
    ‚àß (apply_plan Free 
         (apply_plan Free s&#39; a).<span class="mi">2</span> [x]).<span class="mi">2</span>
        (projT1 (label_a x)) =
      (apply_plan Free 
         (apply_plan Free s a).<span class="mi">2</span> [x]).<span class="mi">2</span>
        (projT1 (label_a x))</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">projT1 (label_a x)
‚àà List.map projT1 (List.map label_a (a ++ [x]))</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">      </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="Composition-v-chk207" style="display: none" type="checkbox"><label class="alectryon-input" for="Composition-v-chk207"><span class="nb">rewrite</span> <span class="mi">2</span> map_app, elem_of_app.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>message, index</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>EqDecision0</var><span class="hyp-type"><b>: </b><span>EqDecision index</span></span></span><br><span><var>IM</var><span class="hyp-type"><b>: </b><span>index ‚Üí VLSM message</span></span></span><br><span><var>Free</var><span><span class="hyp-body"><b>:= </b><span>free_composite_vlsm IM</span></span><span class="hyp-type"><b>: </b><span>VLSM message</span></span></span></span><br><span><var>s, s'</var><span class="hyp-type"><b>: </b><span>vstate Free</span></span></span><br><span><var>Hprs'</var><span class="hyp-type"><b>: </b><span>valid_state_prop Free s&#39;</span></span></span><br><span><var>x</var><span class="hyp-type"><b>: </b><span>vplan_item Free</span></span></span><br><span><var>a</var><span class="hyp-type"><b>: </b><span>list (vplan_item Free)</span></span></span><br><span><var>a_indices</var><span><span class="hyp-body"><b>:= </b><span>List.map projT1
  (List.map label_a (a ++ [x]))</span></span><span class="hyp-type"><b>: </b><span>list index</span></span></span></span><br><span><var>li</var><span class="hyp-type"><b>: </b><span>list index</span></span></span><br><span><var>Heq</var><span class="hyp-type"><b>: </b><span><span class="kr">‚àÄ</span> <span class="nv">i</span> : index, i ‚àà li ‚Üí s&#39; i = s i</span></span></span><br><span><var>Hincl</var><span class="hyp-type"><b>: </b><span>projT1 (label_a x) ‚àà a_indices
‚Üí projT1 (label_a x) ‚àà li</span></span></span><br><span><var>Hrem</var><span class="hyp-type"><b>: </b><span>finite_valid_plan_from Free s a</span></span></span><br><span><var>Hsingle</var><span class="hyp-type"><b>: </b><span>finite_valid_plan_from Free
  (apply_plan Free s a).<span class="mi">2</span> [x]</span></span></span><br><span><var>IHapr</var><span class="hyp-type"><b>: </b><span>finite_valid_plan_from Free s&#39; a</span></span></span><br><span><var>IHaind</var><span class="hyp-type"><b>: </b><span>projT1 (label_a x) ‚àà li
‚Üí (apply_plan Free s&#39; a).<span class="mi">2</span>
    (projT1 (label_a x)) =
  (apply_plan Free s a).<span class="mi">2</span>
    (projT1 (label_a x))</span></span></span><br><span><var>Hrel</var><span class="hyp-type"><b>: </b><span>(apply_plan Free s a).<span class="mi">2</span> (projT1 (label_a x)) =
(apply_plan Free s&#39; a).<span class="mi">2</span> (projT1 (label_a x))
‚Üí finite_valid_plan_from Free
    (apply_plan Free s a).<span class="mi">2</span> [x]
  ‚Üí finite_valid_plan_from Free
      (apply_plan Free s&#39; a).<span class="mi">2</span> [x]
    ‚àß (apply_plan Free 
         (apply_plan Free s&#39; a).<span class="mi">2</span> [x]).<span class="mi">2</span>
        (projT1 (label_a x)) =
      (apply_plan Free 
         (apply_plan Free s a).<span class="mi">2</span> [x]).<span class="mi">2</span>
        (projT1 (label_a x))</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">projT1 (label_a x)
‚àà List.map projT1 (List.map label_a a)
‚à® projT1 (label_a x)
  ‚àà List.map projT1 (List.map label_a [x])</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">      </span><span class="alectryon-sentence"><span class="alectryon-input"><span class="nb">right</span>; <span class="nb">left</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="Composition-v-chk208" style="display: none" type="checkbox"><label class="alectryon-input" for="Composition-v-chk208">}</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>message, index</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>EqDecision0</var><span class="hyp-type"><b>: </b><span>EqDecision index</span></span></span><br><span><var>IM</var><span class="hyp-type"><b>: </b><span>index ‚Üí VLSM message</span></span></span><br><span><var>Free</var><span><span class="hyp-body"><b>:= </b><span>free_composite_vlsm IM</span></span><span class="hyp-type"><b>: </b><span>VLSM message</span></span></span></span><br><span><var>s, s'</var><span class="hyp-type"><b>: </b><span>vstate Free</span></span></span><br><span><var>Hprs'</var><span class="hyp-type"><b>: </b><span>valid_state_prop Free s&#39;</span></span></span><br><span><var>x</var><span class="hyp-type"><b>: </b><span>vplan_item Free</span></span></span><br><span><var>a</var><span class="hyp-type"><b>: </b><span>list (vplan_item Free)</span></span></span><br><span><var>a_indices</var><span><span class="hyp-body"><b>:= </b><span>List.map projT1
  (List.map label_a (a ++ [x]))</span></span><span class="hyp-type"><b>: </b><span>list index</span></span></span></span><br><span><var>li</var><span class="hyp-type"><b>: </b><span>list index</span></span></span><br><span><var>Heq</var><span class="hyp-type"><b>: </b><span><span class="kr">‚àÄ</span> <span class="nv">i</span> : index, i ‚àà li ‚Üí s&#39; i = s i</span></span></span><br><span><var>Hincl</var><span class="hyp-type"><b>: </b><span>a_indices ‚äÜ li</span></span></span><br><span><var>Hrem</var><span class="hyp-type"><b>: </b><span>finite_valid_plan_from Free s a</span></span></span><br><span><var>Hsingle</var><span class="hyp-type"><b>: </b><span>finite_valid_plan_from Free
  (apply_plan Free s a).<span class="mi">2</span> [x]</span></span></span><br><span><var>IHapr</var><span class="hyp-type"><b>: </b><span>finite_valid_plan_from Free s&#39; a</span></span></span><br><span><var>IHaind</var><span class="hyp-type"><b>: </b><span><span class="kr">‚àÄ</span> <span class="nv">i</span> : index,
  i ‚àà li
  ‚Üí (apply_plan Free s&#39; a).<span class="mi">2</span> i =
    (apply_plan Free s a).<span class="mi">2</span> i</span></span></span><br><span><var>Hrel</var><span class="hyp-type"><b>: </b><span>finite_valid_plan_from Free
  (apply_plan Free s a).<span class="mi">2</span> [x]
‚Üí finite_valid_plan_from Free
    (apply_plan Free s&#39; a).<span class="mi">2</span> [x]
  ‚àß (apply_plan Free (apply_plan Free s&#39; a).<span class="mi">2</span>
       [x]).<span class="mi">2</span> (projT1 (label_a x)) =
    (apply_plan Free (apply_plan Free s a).<span class="mi">2</span>
       [x]).<span class="mi">2</span> (projT1 (label_a x))</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">finite_valid_plan_from Free s&#39; (a ++ [x])
‚àß (<span class="kr">‚àÄ</span> <span class="nv">i</span> : index,
     i ‚àà li
     ‚Üí (apply_plan Free s&#39; (a ++ [x])).<span class="mi">2</span> i =
       (apply_plan Free s (a ++ [x])).<span class="mi">2</span> i)</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
</span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="Composition-v-chk209" style="display: none" type="checkbox"><label class="alectryon-input" for="Composition-v-chk209"><span class="nb">specialize</span> (Hrel Hsingle).</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>message, index</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>EqDecision0</var><span class="hyp-type"><b>: </b><span>EqDecision index</span></span></span><br><span><var>IM</var><span class="hyp-type"><b>: </b><span>index ‚Üí VLSM message</span></span></span><br><span><var>Free</var><span><span class="hyp-body"><b>:= </b><span>free_composite_vlsm IM</span></span><span class="hyp-type"><b>: </b><span>VLSM message</span></span></span></span><br><span><var>s, s'</var><span class="hyp-type"><b>: </b><span>vstate Free</span></span></span><br><span><var>Hprs'</var><span class="hyp-type"><b>: </b><span>valid_state_prop Free s&#39;</span></span></span><br><span><var>x</var><span class="hyp-type"><b>: </b><span>vplan_item Free</span></span></span><br><span><var>a</var><span class="hyp-type"><b>: </b><span>list (vplan_item Free)</span></span></span><br><span><var>a_indices</var><span><span class="hyp-body"><b>:= </b><span>List.map projT1
  (List.map label_a (a ++ [x]))</span></span><span class="hyp-type"><b>: </b><span>list index</span></span></span></span><br><span><var>li</var><span class="hyp-type"><b>: </b><span>list index</span></span></span><br><span><var>Heq</var><span class="hyp-type"><b>: </b><span><span class="kr">‚àÄ</span> <span class="nv">i</span> : index, i ‚àà li ‚Üí s&#39; i = s i</span></span></span><br><span><var>Hincl</var><span class="hyp-type"><b>: </b><span>a_indices ‚äÜ li</span></span></span><br><span><var>Hrem</var><span class="hyp-type"><b>: </b><span>finite_valid_plan_from Free s a</span></span></span><br><span><var>Hsingle</var><span class="hyp-type"><b>: </b><span>finite_valid_plan_from Free
  (apply_plan Free s a).<span class="mi">2</span> [x]</span></span></span><br><span><var>IHapr</var><span class="hyp-type"><b>: </b><span>finite_valid_plan_from Free s&#39; a</span></span></span><br><span><var>IHaind</var><span class="hyp-type"><b>: </b><span><span class="kr">‚àÄ</span> <span class="nv">i</span> : index,
  i ‚àà li
  ‚Üí (apply_plan Free s&#39; a).<span class="mi">2</span> i =
    (apply_plan Free s a).<span class="mi">2</span> i</span></span></span><br><span><var>Hrel</var><span class="hyp-type"><b>: </b><span>finite_valid_plan_from Free
  (apply_plan Free s&#39; a).<span class="mi">2</span> [x]
‚àß (apply_plan Free (apply_plan Free s&#39; a).<span class="mi">2</span> [x]).<span class="mi">2</span>
    (projT1 (label_a x)) =
  (apply_plan Free (apply_plan Free s a).<span class="mi">2</span> [x]).<span class="mi">2</span>
    (projT1 (label_a x))</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">finite_valid_plan_from Free s&#39; (a ++ [x])
‚àß (<span class="kr">‚àÄ</span> <span class="nv">i</span> : index,
     i ‚àà li
     ‚Üí (apply_plan Free s&#39; (a ++ [x])).<span class="mi">2</span> i =
       (apply_plan Free s (a ++ [x])).<span class="mi">2</span> i)</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="Composition-v-chk20a" style="display: none" type="checkbox"><label class="alectryon-input" for="Composition-v-chk20a"><span class="nb">destruct</span> Hrel <span class="kr">as</span> [Hrelpr Hrelind].</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>message, index</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>EqDecision0</var><span class="hyp-type"><b>: </b><span>EqDecision index</span></span></span><br><span><var>IM</var><span class="hyp-type"><b>: </b><span>index ‚Üí VLSM message</span></span></span><br><span><var>Free</var><span><span class="hyp-body"><b>:= </b><span>free_composite_vlsm IM</span></span><span class="hyp-type"><b>: </b><span>VLSM message</span></span></span></span><br><span><var>s, s'</var><span class="hyp-type"><b>: </b><span>vstate Free</span></span></span><br><span><var>Hprs'</var><span class="hyp-type"><b>: </b><span>valid_state_prop Free s&#39;</span></span></span><br><span><var>x</var><span class="hyp-type"><b>: </b><span>vplan_item Free</span></span></span><br><span><var>a</var><span class="hyp-type"><b>: </b><span>list (vplan_item Free)</span></span></span><br><span><var>a_indices</var><span><span class="hyp-body"><b>:= </b><span>List.map projT1
  (List.map label_a (a ++ [x]))</span></span><span class="hyp-type"><b>: </b><span>list index</span></span></span></span><br><span><var>li</var><span class="hyp-type"><b>: </b><span>list index</span></span></span><br><span><var>Heq</var><span class="hyp-type"><b>: </b><span><span class="kr">‚àÄ</span> <span class="nv">i</span> : index, i ‚àà li ‚Üí s&#39; i = s i</span></span></span><br><span><var>Hincl</var><span class="hyp-type"><b>: </b><span>a_indices ‚äÜ li</span></span></span><br><span><var>Hrem</var><span class="hyp-type"><b>: </b><span>finite_valid_plan_from Free s a</span></span></span><br><span><var>Hsingle</var><span class="hyp-type"><b>: </b><span>finite_valid_plan_from Free
  (apply_plan Free s a).<span class="mi">2</span> [x]</span></span></span><br><span><var>IHapr</var><span class="hyp-type"><b>: </b><span>finite_valid_plan_from Free s&#39; a</span></span></span><br><span><var>IHaind</var><span class="hyp-type"><b>: </b><span><span class="kr">‚àÄ</span> <span class="nv">i</span> : index,
  i ‚àà li
  ‚Üí (apply_plan Free s&#39; a).<span class="mi">2</span> i =
    (apply_plan Free s a).<span class="mi">2</span> i</span></span></span><br><span><var>Hrelpr</var><span class="hyp-type"><b>: </b><span>finite_valid_plan_from Free
  (apply_plan Free s&#39; a).<span class="mi">2</span> [x]</span></span></span><br><span><var>Hrelind</var><span class="hyp-type"><b>: </b><span>(apply_plan Free (apply_plan Free s&#39; a).<span class="mi">2</span>
   [x]).<span class="mi">2</span> (projT1 (label_a x)) =
(apply_plan Free (apply_plan Free s a).<span class="mi">2</span> [x]).<span class="mi">2</span>
  (projT1 (label_a x))</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">finite_valid_plan_from Free s&#39; (a ++ [x])
‚àß (<span class="kr">‚àÄ</span> <span class="nv">i</span> : index,
     i ‚àà li
     ‚Üí (apply_plan Free s&#39; (a ++ [x])).<span class="mi">2</span> i =
       (apply_plan Free s (a ++ [x])).<span class="mi">2</span> i)</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="Composition-v-chk20b" style="display: none" type="checkbox"><label class="alectryon-input" for="Composition-v-chk20b"><span class="nb">split</span>.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>message, index</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>EqDecision0</var><span class="hyp-type"><b>: </b><span>EqDecision index</span></span></span><br><span><var>IM</var><span class="hyp-type"><b>: </b><span>index ‚Üí VLSM message</span></span></span><br><span><var>Free</var><span><span class="hyp-body"><b>:= </b><span>free_composite_vlsm IM</span></span><span class="hyp-type"><b>: </b><span>VLSM message</span></span></span></span><br><span><var>s, s'</var><span class="hyp-type"><b>: </b><span>vstate Free</span></span></span><br><span><var>Hprs'</var><span class="hyp-type"><b>: </b><span>valid_state_prop Free s&#39;</span></span></span><br><span><var>x</var><span class="hyp-type"><b>: </b><span>vplan_item Free</span></span></span><br><span><var>a</var><span class="hyp-type"><b>: </b><span>list (vplan_item Free)</span></span></span><br><span><var>a_indices</var><span><span class="hyp-body"><b>:= </b><span>List.map projT1
  (List.map label_a (a ++ [x]))</span></span><span class="hyp-type"><b>: </b><span>list index</span></span></span></span><br><span><var>li</var><span class="hyp-type"><b>: </b><span>list index</span></span></span><br><span><var>Heq</var><span class="hyp-type"><b>: </b><span><span class="kr">‚àÄ</span> <span class="nv">i</span> : index, i ‚àà li ‚Üí s&#39; i = s i</span></span></span><br><span><var>Hincl</var><span class="hyp-type"><b>: </b><span>a_indices ‚äÜ li</span></span></span><br><span><var>Hrem</var><span class="hyp-type"><b>: </b><span>finite_valid_plan_from Free s a</span></span></span><br><span><var>Hsingle</var><span class="hyp-type"><b>: </b><span>finite_valid_plan_from Free
  (apply_plan Free s a).<span class="mi">2</span> [x]</span></span></span><br><span><var>IHapr</var><span class="hyp-type"><b>: </b><span>finite_valid_plan_from Free s&#39; a</span></span></span><br><span><var>IHaind</var><span class="hyp-type"><b>: </b><span><span class="kr">‚àÄ</span> <span class="nv">i</span> : index,
  i ‚àà li
  ‚Üí (apply_plan Free s&#39; a).<span class="mi">2</span> i =
    (apply_plan Free s a).<span class="mi">2</span> i</span></span></span><br><span><var>Hrelpr</var><span class="hyp-type"><b>: </b><span>finite_valid_plan_from Free
  (apply_plan Free s&#39; a).<span class="mi">2</span> [x]</span></span></span><br><span><var>Hrelind</var><span class="hyp-type"><b>: </b><span>(apply_plan Free (apply_plan Free s&#39; a).<span class="mi">2</span>
   [x]).<span class="mi">2</span> (projT1 (label_a x)) =
(apply_plan Free (apply_plan Free s a).<span class="mi">2</span> [x]).<span class="mi">2</span>
  (projT1 (label_a x))</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">finite_valid_plan_from Free s&#39; (a ++ [x])</div></blockquote><div class="alectryon-extra-goals"><input class="alectryon-extra-goal-toggle" id="Composition-v-chk20c" style="display: none" type="checkbox"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>message, index</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>EqDecision0</var><span class="hyp-type"><b>: </b><span>EqDecision index</span></span></span><br><span><var>IM</var><span class="hyp-type"><b>: </b><span>index ‚Üí VLSM message</span></span></span><br><span><var>Free</var><span><span class="hyp-body"><b>:= </b><span>free_composite_vlsm IM</span></span><span class="hyp-type"><b>: </b><span>VLSM message</span></span></span></span><br><span><var>s, s'</var><span class="hyp-type"><b>: </b><span>vstate Free</span></span></span><br><span><var>Hprs'</var><span class="hyp-type"><b>: </b><span>valid_state_prop Free s&#39;</span></span></span><br><span><var>x</var><span class="hyp-type"><b>: </b><span>vplan_item Free</span></span></span><br><span><var>a</var><span class="hyp-type"><b>: </b><span>list (vplan_item Free)</span></span></span><br><span><var>a_indices</var><span><span class="hyp-body"><b>:= </b><span>List.map projT1
  (List.map label_a (a ++ [x]))</span></span><span class="hyp-type"><b>: </b><span>list index</span></span></span></span><br><span><var>li</var><span class="hyp-type"><b>: </b><span>list index</span></span></span><br><span><var>Heq</var><span class="hyp-type"><b>: </b><span><span class="kr">‚àÄ</span> <span class="nv">i</span> : index, i ‚àà li ‚Üí s&#39; i = s i</span></span></span><br><span><var>Hincl</var><span class="hyp-type"><b>: </b><span>a_indices ‚äÜ li</span></span></span><br><span><var>Hrem</var><span class="hyp-type"><b>: </b><span>finite_valid_plan_from Free s a</span></span></span><br><span><var>Hsingle</var><span class="hyp-type"><b>: </b><span>finite_valid_plan_from Free
  (apply_plan Free s a).<span class="mi">2</span> [x]</span></span></span><br><span><var>IHapr</var><span class="hyp-type"><b>: </b><span>finite_valid_plan_from Free s&#39; a</span></span></span><br><span><var>IHaind</var><span class="hyp-type"><b>: </b><span><span class="kr">‚àÄ</span> <span class="nv">i</span> : index,
  i ‚àà li
  ‚Üí (apply_plan Free s&#39; a).<span class="mi">2</span> i =
    (apply_plan Free s a).<span class="mi">2</span> i</span></span></span><br><span><var>Hrelpr</var><span class="hyp-type"><b>: </b><span>finite_valid_plan_from Free
  (apply_plan Free s&#39; a).<span class="mi">2</span> [x]</span></span></span><br><span><var>Hrelind</var><span class="hyp-type"><b>: </b><span>(apply_plan Free (apply_plan Free s&#39; a).<span class="mi">2</span>
   [x]).<span class="mi">2</span> (projT1 (label_a x)) =
(apply_plan Free (apply_plan Free s a).<span class="mi">2</span> [x]).<span class="mi">2</span>
  (projT1 (label_a x))</span></span></span><br></div><label class="goal-separator" for="Composition-v-chk20c"><hr></label><div class="goal-conclusion"><span class="kr">‚àÄ</span> <span class="nv">i</span> : index,
  i ‚àà li
  ‚Üí (apply_plan Free s&#39; (a ++ [x])).<span class="mi">2</span> i =
    (apply_plan Free s (a ++ [x])).<span class="mi">2</span> i</div></blockquote></div></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="Composition-v-chk20d" style="display: none" type="checkbox"><label class="alectryon-input" for="Composition-v-chk20d">+</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>message, index</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>EqDecision0</var><span class="hyp-type"><b>: </b><span>EqDecision index</span></span></span><br><span><var>IM</var><span class="hyp-type"><b>: </b><span>index ‚Üí VLSM message</span></span></span><br><span><var>Free</var><span><span class="hyp-body"><b>:= </b><span>free_composite_vlsm IM</span></span><span class="hyp-type"><b>: </b><span>VLSM message</span></span></span></span><br><span><var>s, s'</var><span class="hyp-type"><b>: </b><span>vstate Free</span></span></span><br><span><var>Hprs'</var><span class="hyp-type"><b>: </b><span>valid_state_prop Free s&#39;</span></span></span><br><span><var>x</var><span class="hyp-type"><b>: </b><span>vplan_item Free</span></span></span><br><span><var>a</var><span class="hyp-type"><b>: </b><span>list (vplan_item Free)</span></span></span><br><span><var>a_indices</var><span><span class="hyp-body"><b>:= </b><span>List.map projT1
  (List.map label_a (a ++ [x]))</span></span><span class="hyp-type"><b>: </b><span>list index</span></span></span></span><br><span><var>li</var><span class="hyp-type"><b>: </b><span>list index</span></span></span><br><span><var>Heq</var><span class="hyp-type"><b>: </b><span><span class="kr">‚àÄ</span> <span class="nv">i</span> : index, i ‚àà li ‚Üí s&#39; i = s i</span></span></span><br><span><var>Hincl</var><span class="hyp-type"><b>: </b><span>a_indices ‚äÜ li</span></span></span><br><span><var>Hrem</var><span class="hyp-type"><b>: </b><span>finite_valid_plan_from Free s a</span></span></span><br><span><var>Hsingle</var><span class="hyp-type"><b>: </b><span>finite_valid_plan_from Free
  (apply_plan Free s a).<span class="mi">2</span> [x]</span></span></span><br><span><var>IHapr</var><span class="hyp-type"><b>: </b><span>finite_valid_plan_from Free s&#39; a</span></span></span><br><span><var>IHaind</var><span class="hyp-type"><b>: </b><span><span class="kr">‚àÄ</span> <span class="nv">i</span> : index,
  i ‚àà li
  ‚Üí (apply_plan Free s&#39; a).<span class="mi">2</span> i =
    (apply_plan Free s a).<span class="mi">2</span> i</span></span></span><br><span><var>Hrelpr</var><span class="hyp-type"><b>: </b><span>finite_valid_plan_from Free
  (apply_plan Free s&#39; a).<span class="mi">2</span> [x]</span></span></span><br><span><var>Hrelind</var><span class="hyp-type"><b>: </b><span>(apply_plan Free (apply_plan Free s&#39; a).<span class="mi">2</span>
   [x]).<span class="mi">2</span> (projT1 (label_a x)) =
(apply_plan Free (apply_plan Free s a).<span class="mi">2</span> [x]).<span class="mi">2</span>
  (projT1 (label_a x))</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">finite_valid_plan_from Free s&#39; (a ++ [x])</div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="Composition-v-chk20e" style="display: none" type="checkbox"><label class="alectryon-input" for="Composition-v-chk20e"><span class="nb">apply</span> finite_valid_plan_from_app_iff.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>message, index</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>EqDecision0</var><span class="hyp-type"><b>: </b><span>EqDecision index</span></span></span><br><span><var>IM</var><span class="hyp-type"><b>: </b><span>index ‚Üí VLSM message</span></span></span><br><span><var>Free</var><span><span class="hyp-body"><b>:= </b><span>free_composite_vlsm IM</span></span><span class="hyp-type"><b>: </b><span>VLSM message</span></span></span></span><br><span><var>s, s'</var><span class="hyp-type"><b>: </b><span>vstate Free</span></span></span><br><span><var>Hprs'</var><span class="hyp-type"><b>: </b><span>valid_state_prop Free s&#39;</span></span></span><br><span><var>x</var><span class="hyp-type"><b>: </b><span>vplan_item Free</span></span></span><br><span><var>a</var><span class="hyp-type"><b>: </b><span>list (vplan_item Free)</span></span></span><br><span><var>a_indices</var><span><span class="hyp-body"><b>:= </b><span>List.map projT1
  (List.map label_a (a ++ [x]))</span></span><span class="hyp-type"><b>: </b><span>list index</span></span></span></span><br><span><var>li</var><span class="hyp-type"><b>: </b><span>list index</span></span></span><br><span><var>Heq</var><span class="hyp-type"><b>: </b><span><span class="kr">‚àÄ</span> <span class="nv">i</span> : index, i ‚àà li ‚Üí s&#39; i = s i</span></span></span><br><span><var>Hincl</var><span class="hyp-type"><b>: </b><span>a_indices ‚äÜ li</span></span></span><br><span><var>Hrem</var><span class="hyp-type"><b>: </b><span>finite_valid_plan_from Free s a</span></span></span><br><span><var>Hsingle</var><span class="hyp-type"><b>: </b><span>finite_valid_plan_from Free
  (apply_plan Free s a).<span class="mi">2</span> [x]</span></span></span><br><span><var>IHapr</var><span class="hyp-type"><b>: </b><span>finite_valid_plan_from Free s&#39; a</span></span></span><br><span><var>IHaind</var><span class="hyp-type"><b>: </b><span><span class="kr">‚àÄ</span> <span class="nv">i</span> : index,
  i ‚àà li
  ‚Üí (apply_plan Free s&#39; a).<span class="mi">2</span> i =
    (apply_plan Free s a).<span class="mi">2</span> i</span></span></span><br><span><var>Hrelpr</var><span class="hyp-type"><b>: </b><span>finite_valid_plan_from Free
  (apply_plan Free s&#39; a).<span class="mi">2</span> [x]</span></span></span><br><span><var>Hrelind</var><span class="hyp-type"><b>: </b><span>(apply_plan Free (apply_plan Free s&#39; a).<span class="mi">2</span>
   [x]).<span class="mi">2</span> (projT1 (label_a x)) =
(apply_plan Free (apply_plan Free s a).<span class="mi">2</span> [x]).<span class="mi">2</span>
  (projT1 (label_a x))</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">finite_valid_plan_from Free s&#39; a
‚àß finite_valid_plan_from Free (apply_plan Free s&#39; a).<span class="mi">2</span>
    [x]</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">      </span><span class="alectryon-sentence"><span class="alectryon-input"><span class="nb">split</span>; itauto.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="Composition-v-chk20f" style="display: none" type="checkbox"><label class="alectryon-input" for="Composition-v-chk20f">+</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>message, index</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>EqDecision0</var><span class="hyp-type"><b>: </b><span>EqDecision index</span></span></span><br><span><var>IM</var><span class="hyp-type"><b>: </b><span>index ‚Üí VLSM message</span></span></span><br><span><var>Free</var><span><span class="hyp-body"><b>:= </b><span>free_composite_vlsm IM</span></span><span class="hyp-type"><b>: </b><span>VLSM message</span></span></span></span><br><span><var>s, s'</var><span class="hyp-type"><b>: </b><span>vstate Free</span></span></span><br><span><var>Hprs'</var><span class="hyp-type"><b>: </b><span>valid_state_prop Free s&#39;</span></span></span><br><span><var>x</var><span class="hyp-type"><b>: </b><span>vplan_item Free</span></span></span><br><span><var>a</var><span class="hyp-type"><b>: </b><span>list (vplan_item Free)</span></span></span><br><span><var>a_indices</var><span><span class="hyp-body"><b>:= </b><span>List.map projT1
  (List.map label_a (a ++ [x]))</span></span><span class="hyp-type"><b>: </b><span>list index</span></span></span></span><br><span><var>li</var><span class="hyp-type"><b>: </b><span>list index</span></span></span><br><span><var>Heq</var><span class="hyp-type"><b>: </b><span><span class="kr">‚àÄ</span> <span class="nv">i</span> : index, i ‚àà li ‚Üí s&#39; i = s i</span></span></span><br><span><var>Hincl</var><span class="hyp-type"><b>: </b><span>a_indices ‚äÜ li</span></span></span><br><span><var>Hrem</var><span class="hyp-type"><b>: </b><span>finite_valid_plan_from Free s a</span></span></span><br><span><var>Hsingle</var><span class="hyp-type"><b>: </b><span>finite_valid_plan_from Free
  (apply_plan Free s a).<span class="mi">2</span> [x]</span></span></span><br><span><var>IHapr</var><span class="hyp-type"><b>: </b><span>finite_valid_plan_from Free s&#39; a</span></span></span><br><span><var>IHaind</var><span class="hyp-type"><b>: </b><span><span class="kr">‚àÄ</span> <span class="nv">i</span> : index,
  i ‚àà li
  ‚Üí (apply_plan Free s&#39; a).<span class="mi">2</span> i =
    (apply_plan Free s a).<span class="mi">2</span> i</span></span></span><br><span><var>Hrelpr</var><span class="hyp-type"><b>: </b><span>finite_valid_plan_from Free
  (apply_plan Free s&#39; a).<span class="mi">2</span> [x]</span></span></span><br><span><var>Hrelind</var><span class="hyp-type"><b>: </b><span>(apply_plan Free (apply_plan Free s&#39; a).<span class="mi">2</span>
   [x]).<span class="mi">2</span> (projT1 (label_a x)) =
(apply_plan Free (apply_plan Free s a).<span class="mi">2</span> [x]).<span class="mi">2</span>
  (projT1 (label_a x))</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="kr">‚àÄ</span> <span class="nv">i</span> : index,
  i ‚àà li
  ‚Üí (apply_plan Free s&#39; (a ++ [x])).<span class="mi">2</span> i =
    (apply_plan Free s (a ++ [x])).<span class="mi">2</span> i</div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="Composition-v-chk210" style="display: none" type="checkbox"><label class="alectryon-input" for="Composition-v-chk210"><span class="nb">intros</span> i Hi.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>message, index</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>EqDecision0</var><span class="hyp-type"><b>: </b><span>EqDecision index</span></span></span><br><span><var>IM</var><span class="hyp-type"><b>: </b><span>index ‚Üí VLSM message</span></span></span><br><span><var>Free</var><span><span class="hyp-body"><b>:= </b><span>free_composite_vlsm IM</span></span><span class="hyp-type"><b>: </b><span>VLSM message</span></span></span></span><br><span><var>s, s'</var><span class="hyp-type"><b>: </b><span>vstate Free</span></span></span><br><span><var>Hprs'</var><span class="hyp-type"><b>: </b><span>valid_state_prop Free s&#39;</span></span></span><br><span><var>x</var><span class="hyp-type"><b>: </b><span>vplan_item Free</span></span></span><br><span><var>a</var><span class="hyp-type"><b>: </b><span>list (vplan_item Free)</span></span></span><br><span><var>a_indices</var><span><span class="hyp-body"><b>:= </b><span>List.map projT1
  (List.map label_a (a ++ [x]))</span></span><span class="hyp-type"><b>: </b><span>list index</span></span></span></span><br><span><var>li</var><span class="hyp-type"><b>: </b><span>list index</span></span></span><br><span><var>Heq</var><span class="hyp-type"><b>: </b><span><span class="kr">‚àÄ</span> <span class="nv">i</span> : index, i ‚àà li ‚Üí s&#39; i = s i</span></span></span><br><span><var>Hincl</var><span class="hyp-type"><b>: </b><span>a_indices ‚äÜ li</span></span></span><br><span><var>Hrem</var><span class="hyp-type"><b>: </b><span>finite_valid_plan_from Free s a</span></span></span><br><span><var>Hsingle</var><span class="hyp-type"><b>: </b><span>finite_valid_plan_from Free
  (apply_plan Free s a).<span class="mi">2</span> [x]</span></span></span><br><span><var>IHapr</var><span class="hyp-type"><b>: </b><span>finite_valid_plan_from Free s&#39; a</span></span></span><br><span><var>IHaind</var><span class="hyp-type"><b>: </b><span><span class="kr">‚àÄ</span> <span class="nv">i</span> : index,
  i ‚àà li
  ‚Üí (apply_plan Free s&#39; a).<span class="mi">2</span> i =
    (apply_plan Free s a).<span class="mi">2</span> i</span></span></span><br><span><var>Hrelpr</var><span class="hyp-type"><b>: </b><span>finite_valid_plan_from Free
  (apply_plan Free s&#39; a).<span class="mi">2</span> [x]</span></span></span><br><span><var>Hrelind</var><span class="hyp-type"><b>: </b><span>(apply_plan Free (apply_plan Free s&#39; a).<span class="mi">2</span>
   [x]).<span class="mi">2</span> (projT1 (label_a x)) =
(apply_plan Free (apply_plan Free s a).<span class="mi">2</span> [x]).<span class="mi">2</span>
  (projT1 (label_a x))</span></span></span><br><span><var>i</var><span class="hyp-type"><b>: </b><span>index</span></span></span><br><span><var>Hi</var><span class="hyp-type"><b>: </b><span>i ‚àà li</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">(apply_plan Free s&#39; (a ++ [x])).<span class="mi">2</span> i =
(apply_plan Free s (a ++ [x])).<span class="mi">2</span> i</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">      </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="Composition-v-chk211" style="display: none" type="checkbox"><label class="alectryon-input" for="Composition-v-chk211"><span class="nb">specialize</span> (IHaind i Hi).</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>message, index</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>EqDecision0</var><span class="hyp-type"><b>: </b><span>EqDecision index</span></span></span><br><span><var>IM</var><span class="hyp-type"><b>: </b><span>index ‚Üí VLSM message</span></span></span><br><span><var>Free</var><span><span class="hyp-body"><b>:= </b><span>free_composite_vlsm IM</span></span><span class="hyp-type"><b>: </b><span>VLSM message</span></span></span></span><br><span><var>s, s'</var><span class="hyp-type"><b>: </b><span>vstate Free</span></span></span><br><span><var>Hprs'</var><span class="hyp-type"><b>: </b><span>valid_state_prop Free s&#39;</span></span></span><br><span><var>x</var><span class="hyp-type"><b>: </b><span>vplan_item Free</span></span></span><br><span><var>a</var><span class="hyp-type"><b>: </b><span>list (vplan_item Free)</span></span></span><br><span><var>a_indices</var><span><span class="hyp-body"><b>:= </b><span>List.map projT1
  (List.map label_a (a ++ [x]))</span></span><span class="hyp-type"><b>: </b><span>list index</span></span></span></span><br><span><var>li</var><span class="hyp-type"><b>: </b><span>list index</span></span></span><br><span><var>Heq</var><span class="hyp-type"><b>: </b><span><span class="kr">‚àÄ</span> <span class="nv">i</span> : index, i ‚àà li ‚Üí s&#39; i = s i</span></span></span><br><span><var>Hincl</var><span class="hyp-type"><b>: </b><span>a_indices ‚äÜ li</span></span></span><br><span><var>Hrem</var><span class="hyp-type"><b>: </b><span>finite_valid_plan_from Free s a</span></span></span><br><span><var>Hsingle</var><span class="hyp-type"><b>: </b><span>finite_valid_plan_from Free
  (apply_plan Free s a).<span class="mi">2</span> [x]</span></span></span><br><span><var>IHapr</var><span class="hyp-type"><b>: </b><span>finite_valid_plan_from Free s&#39; a</span></span></span><br><span><var>i</var><span class="hyp-type"><b>: </b><span>index</span></span></span><br><span><var>IHaind</var><span class="hyp-type"><b>: </b><span>(apply_plan Free s&#39; a).<span class="mi">2</span> i =
(apply_plan Free s a).<span class="mi">2</span> i</span></span></span><br><span><var>Hrelpr</var><span class="hyp-type"><b>: </b><span>finite_valid_plan_from Free
  (apply_plan Free s&#39; a).<span class="mi">2</span> [x]</span></span></span><br><span><var>Hrelind</var><span class="hyp-type"><b>: </b><span>(apply_plan Free (apply_plan Free s&#39; a).<span class="mi">2</span>
   [x]).<span class="mi">2</span> (projT1 (label_a x)) =
(apply_plan Free (apply_plan Free s a).<span class="mi">2</span> [x]).<span class="mi">2</span>
  (projT1 (label_a x))</span></span></span><br><span><var>Hi</var><span class="hyp-type"><b>: </b><span>i ‚àà li</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">(apply_plan Free s&#39; (a ++ [x])).<span class="mi">2</span> i =
(apply_plan Free s (a ++ [x])).<span class="mi">2</span> i</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">      </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="Composition-v-chk212" style="display: none" type="checkbox"><label class="alectryon-input" for="Composition-v-chk212"><span class="nb">specialize</span> (Heq i Hi).</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>message, index</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>EqDecision0</var><span class="hyp-type"><b>: </b><span>EqDecision index</span></span></span><br><span><var>IM</var><span class="hyp-type"><b>: </b><span>index ‚Üí VLSM message</span></span></span><br><span><var>Free</var><span><span class="hyp-body"><b>:= </b><span>free_composite_vlsm IM</span></span><span class="hyp-type"><b>: </b><span>VLSM message</span></span></span></span><br><span><var>s, s'</var><span class="hyp-type"><b>: </b><span>vstate Free</span></span></span><br><span><var>Hprs'</var><span class="hyp-type"><b>: </b><span>valid_state_prop Free s&#39;</span></span></span><br><span><var>x</var><span class="hyp-type"><b>: </b><span>vplan_item Free</span></span></span><br><span><var>a</var><span class="hyp-type"><b>: </b><span>list (vplan_item Free)</span></span></span><br><span><var>a_indices</var><span><span class="hyp-body"><b>:= </b><span>List.map projT1
  (List.map label_a (a ++ [x]))</span></span><span class="hyp-type"><b>: </b><span>list index</span></span></span></span><br><span><var>li</var><span class="hyp-type"><b>: </b><span>list index</span></span></span><br><span><var>i</var><span class="hyp-type"><b>: </b><span>index</span></span></span><br><span><var>Heq</var><span class="hyp-type"><b>: </b><span>s&#39; i = s i</span></span></span><br><span><var>Hincl</var><span class="hyp-type"><b>: </b><span>a_indices ‚äÜ li</span></span></span><br><span><var>Hrem</var><span class="hyp-type"><b>: </b><span>finite_valid_plan_from Free s a</span></span></span><br><span><var>Hsingle</var><span class="hyp-type"><b>: </b><span>finite_valid_plan_from Free
  (apply_plan Free s a).<span class="mi">2</span> [x]</span></span></span><br><span><var>IHapr</var><span class="hyp-type"><b>: </b><span>finite_valid_plan_from Free s&#39; a</span></span></span><br><span><var>IHaind</var><span class="hyp-type"><b>: </b><span>(apply_plan Free s&#39; a).<span class="mi">2</span> i =
(apply_plan Free s a).<span class="mi">2</span> i</span></span></span><br><span><var>Hrelpr</var><span class="hyp-type"><b>: </b><span>finite_valid_plan_from Free
  (apply_plan Free s&#39; a).<span class="mi">2</span> [x]</span></span></span><br><span><var>Hrelind</var><span class="hyp-type"><b>: </b><span>(apply_plan Free (apply_plan Free s&#39; a).<span class="mi">2</span>
   [x]).<span class="mi">2</span> (projT1 (label_a x)) =
(apply_plan Free (apply_plan Free s a).<span class="mi">2</span> [x]).<span class="mi">2</span>
  (projT1 (label_a x))</span></span></span><br><span><var>Hi</var><span class="hyp-type"><b>: </b><span>i ‚àà li</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">(apply_plan Free s&#39; (a ++ [x])).<span class="mi">2</span> i =
(apply_plan Free s (a ++ [x])).<span class="mi">2</span> i</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">      </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="Composition-v-chk213" style="display: none" type="checkbox"><label class="alectryon-input" for="Composition-v-chk213"><span class="nb">rewrite</span> !apply_plan_app.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>message, index</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>EqDecision0</var><span class="hyp-type"><b>: </b><span>EqDecision index</span></span></span><br><span><var>IM</var><span class="hyp-type"><b>: </b><span>index ‚Üí VLSM message</span></span></span><br><span><var>Free</var><span><span class="hyp-body"><b>:= </b><span>free_composite_vlsm IM</span></span><span class="hyp-type"><b>: </b><span>VLSM message</span></span></span></span><br><span><var>s, s'</var><span class="hyp-type"><b>: </b><span>vstate Free</span></span></span><br><span><var>Hprs'</var><span class="hyp-type"><b>: </b><span>valid_state_prop Free s&#39;</span></span></span><br><span><var>x</var><span class="hyp-type"><b>: </b><span>vplan_item Free</span></span></span><br><span><var>a</var><span class="hyp-type"><b>: </b><span>list (vplan_item Free)</span></span></span><br><span><var>a_indices</var><span><span class="hyp-body"><b>:= </b><span>List.map projT1
  (List.map label_a (a ++ [x]))</span></span><span class="hyp-type"><b>: </b><span>list index</span></span></span></span><br><span><var>li</var><span class="hyp-type"><b>: </b><span>list index</span></span></span><br><span><var>i</var><span class="hyp-type"><b>: </b><span>index</span></span></span><br><span><var>Heq</var><span class="hyp-type"><b>: </b><span>s&#39; i = s i</span></span></span><br><span><var>Hincl</var><span class="hyp-type"><b>: </b><span>a_indices ‚äÜ li</span></span></span><br><span><var>Hrem</var><span class="hyp-type"><b>: </b><span>finite_valid_plan_from Free s a</span></span></span><br><span><var>Hsingle</var><span class="hyp-type"><b>: </b><span>finite_valid_plan_from Free
  (apply_plan Free s a).<span class="mi">2</span> [x]</span></span></span><br><span><var>IHapr</var><span class="hyp-type"><b>: </b><span>finite_valid_plan_from Free s&#39; a</span></span></span><br><span><var>IHaind</var><span class="hyp-type"><b>: </b><span>(apply_plan Free s&#39; a).<span class="mi">2</span> i =
(apply_plan Free s a).<span class="mi">2</span> i</span></span></span><br><span><var>Hrelpr</var><span class="hyp-type"><b>: </b><span>finite_valid_plan_from Free
  (apply_plan Free s&#39; a).<span class="mi">2</span> [x]</span></span></span><br><span><var>Hrelind</var><span class="hyp-type"><b>: </b><span>(apply_plan Free (apply_plan Free s&#39; a).<span class="mi">2</span>
   [x]).<span class="mi">2</span> (projT1 (label_a x)) =
(apply_plan Free (apply_plan Free s a).<span class="mi">2</span> [x]).<span class="mi">2</span>
  (projT1 (label_a x))</span></span></span><br><span><var>Hi</var><span class="hyp-type"><b>: </b><span>i ‚àà li</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">(<span class="kr">let</span> (<span class="nv">aitems</span>, afinal) := apply_plan Free s&#39; a <span class="kr">in</span>
 <span class="kr">let</span> (<span class="nv">a&#39;items</span>, a&#39;final) :=
   apply_plan Free afinal [x] <span class="kr">in</span>
 (aitems ++ a&#39;items, a&#39;final)).<span class="mi">2</span> i =
(<span class="kr">let</span> (<span class="nv">aitems</span>, afinal) := apply_plan Free s a <span class="kr">in</span>
 <span class="kr">let</span> (<span class="nv">a&#39;items</span>, a&#39;final) :=
   apply_plan Free afinal [x] <span class="kr">in</span>
 (aitems ++ a&#39;items, a&#39;final)).<span class="mi">2</span> i</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">      </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="Composition-v-chk214" style="display: none" type="checkbox"><label class="alectryon-input" for="Composition-v-chk214"><span class="nb">simpl</span> <span class="kr">in</span> *.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>message, index</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>EqDecision0</var><span class="hyp-type"><b>: </b><span>EqDecision index</span></span></span><br><span><var>IM</var><span class="hyp-type"><b>: </b><span>index ‚Üí VLSM message</span></span></span><br><span><var>Free</var><span><span class="hyp-body"><b>:= </b><span>free_composite_vlsm IM</span></span><span class="hyp-type"><b>: </b><span>VLSM message</span></span></span></span><br><span><var>s, s'</var><span class="hyp-type"><b>: </b><span>vstate Free</span></span></span><br><span><var>Hprs'</var><span class="hyp-type"><b>: </b><span>valid_state_prop Free s&#39;</span></span></span><br><span><var>x</var><span class="hyp-type"><b>: </b><span>vplan_item Free</span></span></span><br><span><var>a</var><span class="hyp-type"><b>: </b><span>list (vplan_item Free)</span></span></span><br><span><var>a_indices</var><span><span class="hyp-body"><b>:= </b><span>List.map projT1
  (List.map label_a (a ++ [x]))</span></span><span class="hyp-type"><b>: </b><span>list index</span></span></span></span><br><span><var>li</var><span class="hyp-type"><b>: </b><span>list index</span></span></span><br><span><var>i</var><span class="hyp-type"><b>: </b><span>index</span></span></span><br><span><var>Heq</var><span class="hyp-type"><b>: </b><span>s&#39; i = s i</span></span></span><br><span><var>Hincl</var><span class="hyp-type"><b>: </b><span>a_indices ‚äÜ li</span></span></span><br><span><var>Hrem</var><span class="hyp-type"><b>: </b><span>finite_valid_plan_from Free s a</span></span></span><br><span><var>Hsingle</var><span class="hyp-type"><b>: </b><span>finite_valid_plan_from Free
  (apply_plan Free s a).<span class="mi">2</span> [x]</span></span></span><br><span><var>IHapr</var><span class="hyp-type"><b>: </b><span>finite_valid_plan_from Free s&#39; a</span></span></span><br><span><var>IHaind</var><span class="hyp-type"><b>: </b><span>(apply_plan Free s&#39; a).<span class="mi">2</span> i =
(apply_plan Free s a).<span class="mi">2</span> i</span></span></span><br><span><var>Hrelpr</var><span class="hyp-type"><b>: </b><span>finite_valid_plan_from Free
  (apply_plan Free s&#39; a).<span class="mi">2</span> [x]</span></span></span><br><span><var>Hrelind</var><span class="hyp-type"><b>: </b><span>(apply_plan Free (apply_plan Free s&#39; a).<span class="mi">2</span>
   [x]).<span class="mi">2</span> (projT1 (label_a x)) =
(apply_plan Free (apply_plan Free s a).<span class="mi">2</span> [x]).<span class="mi">2</span>
  (projT1 (label_a x))</span></span></span><br><span><var>Hi</var><span class="hyp-type"><b>: </b><span>i ‚àà li</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">(<span class="kr">let</span> (<span class="nv">aitems</span>, afinal) := apply_plan Free s&#39; a <span class="kr">in</span>
 <span class="kr">let</span> (<span class="nv">a&#39;items</span>, a&#39;final) :=
   apply_plan Free afinal [x] <span class="kr">in</span>
 (aitems ++ a&#39;items, a&#39;final)).<span class="mi">2</span> i =
(<span class="kr">let</span> (<span class="nv">aitems</span>, afinal) := apply_plan Free s a <span class="kr">in</span>
 <span class="kr">let</span> (<span class="nv">a&#39;items</span>, a&#39;final) :=
   apply_plan Free afinal [x] <span class="kr">in</span>
 (aitems ++ a&#39;items, a&#39;final)).<span class="mi">2</span> i</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">      </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="Composition-v-chk215" style="display: none" type="checkbox"><label class="alectryon-input" for="Composition-v-chk215"><span class="nb">destruct</span> (apply_plan Free s&#39; a)
        <span class="kr">as</span> (tra&#39;, sa&#39;) <span class="nb">eqn</span> : eq_as&#39;.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>message, index</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>EqDecision0</var><span class="hyp-type"><b>: </b><span>EqDecision index</span></span></span><br><span><var>IM</var><span class="hyp-type"><b>: </b><span>index ‚Üí VLSM message</span></span></span><br><span><var>Free</var><span><span class="hyp-body"><b>:= </b><span>free_composite_vlsm IM</span></span><span class="hyp-type"><b>: </b><span>VLSM message</span></span></span></span><br><span><var>s, s'</var><span class="hyp-type"><b>: </b><span>vstate Free</span></span></span><br><span><var>Hprs'</var><span class="hyp-type"><b>: </b><span>valid_state_prop Free s&#39;</span></span></span><br><span><var>x</var><span class="hyp-type"><b>: </b><span>vplan_item Free</span></span></span><br><span><var>a</var><span class="hyp-type"><b>: </b><span>list (vplan_item Free)</span></span></span><br><span><var>a_indices</var><span><span class="hyp-body"><b>:= </b><span>List.map projT1
  (List.map label_a (a ++ [x]))</span></span><span class="hyp-type"><b>: </b><span>list index</span></span></span></span><br><span><var>li</var><span class="hyp-type"><b>: </b><span>list index</span></span></span><br><span><var>i</var><span class="hyp-type"><b>: </b><span>index</span></span></span><br><span><var>Heq</var><span class="hyp-type"><b>: </b><span>s&#39; i = s i</span></span></span><br><span><var>Hincl</var><span class="hyp-type"><b>: </b><span>a_indices ‚äÜ li</span></span></span><br><span><var>Hrem</var><span class="hyp-type"><b>: </b><span>finite_valid_plan_from Free s a</span></span></span><br><span><var>Hsingle</var><span class="hyp-type"><b>: </b><span>finite_valid_plan_from Free
  (apply_plan Free s a).<span class="mi">2</span> [x]</span></span></span><br><span><var>IHapr</var><span class="hyp-type"><b>: </b><span>finite_valid_plan_from Free s&#39; a</span></span></span><br><span><var>tra'</var><span class="hyp-type"><b>: </b><span>list transition_item</span></span></span><br><span><var>sa'</var><span class="hyp-type"><b>: </b><span>state</span></span></span><br><span><var>eq_as'</var><span class="hyp-type"><b>: </b><span>apply_plan Free s&#39; a = (tra&#39;, sa&#39;)</span></span></span><br><span><var>IHaind</var><span class="hyp-type"><b>: </b><span>(tra&#39;, sa&#39;).<span class="mi">2</span> i = (apply_plan Free s a).<span class="mi">2</span> i</span></span></span><br><span><var>Hrelpr</var><span class="hyp-type"><b>: </b><span>finite_valid_plan_from Free (tra&#39;, sa&#39;).<span class="mi">2</span> [x]</span></span></span><br><span><var>Hrelind</var><span class="hyp-type"><b>: </b><span>(apply_plan Free (tra&#39;, sa&#39;).<span class="mi">2</span> [x]).<span class="mi">2</span>
  (projT1 (label_a x)) =
(apply_plan Free (apply_plan Free s a).<span class="mi">2</span> [x]).<span class="mi">2</span>
  (projT1 (label_a x))</span></span></span><br><span><var>Hi</var><span class="hyp-type"><b>: </b><span>i ‚àà li</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">(<span class="kr">let</span> (<span class="nv">a&#39;items</span>, a&#39;final) := apply_plan Free sa&#39; [x] <span class="kr">in</span>
 (tra&#39; ++ a&#39;items, a&#39;final)).<span class="mi">2</span> i =
(<span class="kr">let</span> (<span class="nv">aitems</span>, afinal) := apply_plan Free s a <span class="kr">in</span>
 <span class="kr">let</span> (<span class="nv">a&#39;items</span>, a&#39;final) :=
   apply_plan Free afinal [x] <span class="kr">in</span>
 (aitems ++ a&#39;items, a&#39;final)).<span class="mi">2</span> i</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">      </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="Composition-v-chk216" style="display: none" type="checkbox"><label class="alectryon-input" for="Composition-v-chk216"><span class="nb">destruct</span> (apply_plan Free s a)
        <span class="kr">as</span> (tra, sa) <span class="nb">eqn</span> : eq_as.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>message, index</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>EqDecision0</var><span class="hyp-type"><b>: </b><span>EqDecision index</span></span></span><br><span><var>IM</var><span class="hyp-type"><b>: </b><span>index ‚Üí VLSM message</span></span></span><br><span><var>Free</var><span><span class="hyp-body"><b>:= </b><span>free_composite_vlsm IM</span></span><span class="hyp-type"><b>: </b><span>VLSM message</span></span></span></span><br><span><var>s, s'</var><span class="hyp-type"><b>: </b><span>vstate Free</span></span></span><br><span><var>Hprs'</var><span class="hyp-type"><b>: </b><span>valid_state_prop Free s&#39;</span></span></span><br><span><var>x</var><span class="hyp-type"><b>: </b><span>vplan_item Free</span></span></span><br><span><var>a</var><span class="hyp-type"><b>: </b><span>list (vplan_item Free)</span></span></span><br><span><var>a_indices</var><span><span class="hyp-body"><b>:= </b><span>List.map projT1
  (List.map label_a (a ++ [x]))</span></span><span class="hyp-type"><b>: </b><span>list index</span></span></span></span><br><span><var>li</var><span class="hyp-type"><b>: </b><span>list index</span></span></span><br><span><var>i</var><span class="hyp-type"><b>: </b><span>index</span></span></span><br><span><var>Heq</var><span class="hyp-type"><b>: </b><span>s&#39; i = s i</span></span></span><br><span><var>Hincl</var><span class="hyp-type"><b>: </b><span>a_indices ‚äÜ li</span></span></span><br><span><var>Hrem</var><span class="hyp-type"><b>: </b><span>finite_valid_plan_from Free s a</span></span></span><br><span><var>tra</var><span class="hyp-type"><b>: </b><span>list transition_item</span></span></span><br><span><var>sa</var><span class="hyp-type"><b>: </b><span>state</span></span></span><br><span><var>eq_as</var><span class="hyp-type"><b>: </b><span>apply_plan Free s a = (tra, sa)</span></span></span><br><span><var>Hsingle</var><span class="hyp-type"><b>: </b><span>finite_valid_plan_from Free (tra, sa).<span class="mi">2</span> [x]</span></span></span><br><span><var>IHapr</var><span class="hyp-type"><b>: </b><span>finite_valid_plan_from Free s&#39; a</span></span></span><br><span><var>tra'</var><span class="hyp-type"><b>: </b><span>list transition_item</span></span></span><br><span><var>sa'</var><span class="hyp-type"><b>: </b><span>state</span></span></span><br><span><var>eq_as'</var><span class="hyp-type"><b>: </b><span>apply_plan Free s&#39; a = (tra&#39;, sa&#39;)</span></span></span><br><span><var>IHaind</var><span class="hyp-type"><b>: </b><span>(tra&#39;, sa&#39;).<span class="mi">2</span> i = (tra, sa).<span class="mi">2</span> i</span></span></span><br><span><var>Hrelpr</var><span class="hyp-type"><b>: </b><span>finite_valid_plan_from Free (tra&#39;, sa&#39;).<span class="mi">2</span> [x]</span></span></span><br><span><var>Hrelind</var><span class="hyp-type"><b>: </b><span>(apply_plan Free (tra&#39;, sa&#39;).<span class="mi">2</span> [x]).<span class="mi">2</span>
  (projT1 (label_a x)) =
(apply_plan Free (tra, sa).<span class="mi">2</span> [x]).<span class="mi">2</span>
  (projT1 (label_a x))</span></span></span><br><span><var>Hi</var><span class="hyp-type"><b>: </b><span>i ‚àà li</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">(<span class="kr">let</span> (<span class="nv">a&#39;items</span>, a&#39;final) := apply_plan Free sa&#39; [x] <span class="kr">in</span>
 (tra&#39; ++ a&#39;items, a&#39;final)).<span class="mi">2</span> i =
(<span class="kr">let</span> (<span class="nv">a&#39;items</span>, a&#39;final) := apply_plan Free sa [x] <span class="kr">in</span>
 (tra ++ a&#39;items, a&#39;final)).<span class="mi">2</span> i</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">      </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="Composition-v-chk217" style="display: none" type="checkbox"><label class="alectryon-input" for="Composition-v-chk217"><span class="nb">simpl</span> <span class="kr">in</span> *.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>message, index</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>EqDecision0</var><span class="hyp-type"><b>: </b><span>EqDecision index</span></span></span><br><span><var>IM</var><span class="hyp-type"><b>: </b><span>index ‚Üí VLSM message</span></span></span><br><span><var>Free</var><span><span class="hyp-body"><b>:= </b><span>free_composite_vlsm IM</span></span><span class="hyp-type"><b>: </b><span>VLSM message</span></span></span></span><br><span><var>s, s'</var><span class="hyp-type"><b>: </b><span>vstate Free</span></span></span><br><span><var>Hprs'</var><span class="hyp-type"><b>: </b><span>valid_state_prop Free s&#39;</span></span></span><br><span><var>x</var><span class="hyp-type"><b>: </b><span>vplan_item Free</span></span></span><br><span><var>a</var><span class="hyp-type"><b>: </b><span>list (vplan_item Free)</span></span></span><br><span><var>a_indices</var><span><span class="hyp-body"><b>:= </b><span>List.map projT1
  (List.map label_a (a ++ [x]))</span></span><span class="hyp-type"><b>: </b><span>list index</span></span></span></span><br><span><var>li</var><span class="hyp-type"><b>: </b><span>list index</span></span></span><br><span><var>i</var><span class="hyp-type"><b>: </b><span>index</span></span></span><br><span><var>Heq</var><span class="hyp-type"><b>: </b><span>s&#39; i = s i</span></span></span><br><span><var>Hincl</var><span class="hyp-type"><b>: </b><span>a_indices ‚äÜ li</span></span></span><br><span><var>Hrem</var><span class="hyp-type"><b>: </b><span>finite_valid_plan_from Free s a</span></span></span><br><span><var>tra</var><span class="hyp-type"><b>: </b><span>list transition_item</span></span></span><br><span><var>sa</var><span class="hyp-type"><b>: </b><span>composite_state IM</span></span></span><br><span><var>eq_as</var><span class="hyp-type"><b>: </b><span>apply_plan Free s a = (tra, sa)</span></span></span><br><span><var>Hsingle</var><span class="hyp-type"><b>: </b><span>finite_valid_plan_from Free sa [x]</span></span></span><br><span><var>IHapr</var><span class="hyp-type"><b>: </b><span>finite_valid_plan_from Free s&#39; a</span></span></span><br><span><var>tra'</var><span class="hyp-type"><b>: </b><span>list transition_item</span></span></span><br><span><var>sa'</var><span class="hyp-type"><b>: </b><span>composite_state IM</span></span></span><br><span><var>eq_as'</var><span class="hyp-type"><b>: </b><span>apply_plan Free s&#39; a = (tra&#39;, sa&#39;)</span></span></span><br><span><var>IHaind</var><span class="hyp-type"><b>: </b><span>sa&#39; i = sa i</span></span></span><br><span><var>Hrelpr</var><span class="hyp-type"><b>: </b><span>finite_valid_plan_from Free sa&#39; [x]</span></span></span><br><span><var>Hrelind</var><span class="hyp-type"><b>: </b><span>(apply_plan Free sa&#39; [x]).<span class="mi">2</span>
  (projT1 (label_a x)) =
(apply_plan Free sa [x]).<span class="mi">2</span>
  (projT1 (label_a x))</span></span></span><br><span><var>Hi</var><span class="hyp-type"><b>: </b><span>i ‚àà li</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">(<span class="kr">let</span> (<span class="nv">a&#39;items</span>, a&#39;final) := apply_plan Free sa&#39; [x] <span class="kr">in</span>
 (tra&#39; ++ a&#39;items, a&#39;final)).<span class="mi">2</span> i =
(<span class="kr">let</span> (<span class="nv">a&#39;items</span>, a&#39;final) := apply_plan Free sa [x] <span class="kr">in</span>
 (tra ++ a&#39;items, a&#39;final)).<span class="mi">2</span> i</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">      </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="Composition-v-chk218" style="display: none" type="checkbox"><label class="alectryon-input" for="Composition-v-chk218"><span class="nb">destruct</span> (apply_plan Free sa [x])
        <span class="kr">as</span> (trx, sx) <span class="nb">eqn</span> : eq_xsa.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>message, index</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>EqDecision0</var><span class="hyp-type"><b>: </b><span>EqDecision index</span></span></span><br><span><var>IM</var><span class="hyp-type"><b>: </b><span>index ‚Üí VLSM message</span></span></span><br><span><var>Free</var><span><span class="hyp-body"><b>:= </b><span>free_composite_vlsm IM</span></span><span class="hyp-type"><b>: </b><span>VLSM message</span></span></span></span><br><span><var>s, s'</var><span class="hyp-type"><b>: </b><span>vstate Free</span></span></span><br><span><var>Hprs'</var><span class="hyp-type"><b>: </b><span>valid_state_prop Free s&#39;</span></span></span><br><span><var>x</var><span class="hyp-type"><b>: </b><span>vplan_item Free</span></span></span><br><span><var>a</var><span class="hyp-type"><b>: </b><span>list (vplan_item Free)</span></span></span><br><span><var>a_indices</var><span><span class="hyp-body"><b>:= </b><span>List.map projT1
  (List.map label_a (a ++ [x]))</span></span><span class="hyp-type"><b>: </b><span>list index</span></span></span></span><br><span><var>li</var><span class="hyp-type"><b>: </b><span>list index</span></span></span><br><span><var>i</var><span class="hyp-type"><b>: </b><span>index</span></span></span><br><span><var>Heq</var><span class="hyp-type"><b>: </b><span>s&#39; i = s i</span></span></span><br><span><var>Hincl</var><span class="hyp-type"><b>: </b><span>a_indices ‚äÜ li</span></span></span><br><span><var>Hrem</var><span class="hyp-type"><b>: </b><span>finite_valid_plan_from Free s a</span></span></span><br><span><var>tra</var><span class="hyp-type"><b>: </b><span>list transition_item</span></span></span><br><span><var>sa</var><span class="hyp-type"><b>: </b><span>composite_state IM</span></span></span><br><span><var>eq_as</var><span class="hyp-type"><b>: </b><span>apply_plan Free s a = (tra, sa)</span></span></span><br><span><var>Hsingle</var><span class="hyp-type"><b>: </b><span>finite_valid_plan_from Free sa [x]</span></span></span><br><span><var>IHapr</var><span class="hyp-type"><b>: </b><span>finite_valid_plan_from Free s&#39; a</span></span></span><br><span><var>tra'</var><span class="hyp-type"><b>: </b><span>list transition_item</span></span></span><br><span><var>sa'</var><span class="hyp-type"><b>: </b><span>composite_state IM</span></span></span><br><span><var>eq_as'</var><span class="hyp-type"><b>: </b><span>apply_plan Free s&#39; a = (tra&#39;, sa&#39;)</span></span></span><br><span><var>IHaind</var><span class="hyp-type"><b>: </b><span>sa&#39; i = sa i</span></span></span><br><span><var>Hrelpr</var><span class="hyp-type"><b>: </b><span>finite_valid_plan_from Free sa&#39; [x]</span></span></span><br><span><var>trx</var><span class="hyp-type"><b>: </b><span>list transition_item</span></span></span><br><span><var>sx</var><span class="hyp-type"><b>: </b><span>state</span></span></span><br><span><var>eq_xsa</var><span class="hyp-type"><b>: </b><span>apply_plan Free sa [x] = (trx, sx)</span></span></span><br><span><var>Hrelind</var><span class="hyp-type"><b>: </b><span>(apply_plan Free sa&#39; [x]).<span class="mi">2</span>
  (projT1 (label_a x)) =
(trx, sx).<span class="mi">2</span> (projT1 (label_a x))</span></span></span><br><span><var>Hi</var><span class="hyp-type"><b>: </b><span>i ‚àà li</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">(<span class="kr">let</span> (<span class="nv">a&#39;items</span>, a&#39;final) := apply_plan Free sa&#39; [x] <span class="kr">in</span>
 (tra&#39; ++ a&#39;items, a&#39;final)).<span class="mi">2</span> i =
(tra ++ trx, sx).<span class="mi">2</span> i</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">      </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="Composition-v-chk219" style="display: none" type="checkbox"><label class="alectryon-input" for="Composition-v-chk219"><span class="nb">destruct</span> (apply_plan Free sa&#39; [x])
        <span class="kr">as</span> (trx&#39;, sx&#39;) <span class="nb">eqn</span> : eq_xsa&#39;.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>message, index</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>EqDecision0</var><span class="hyp-type"><b>: </b><span>EqDecision index</span></span></span><br><span><var>IM</var><span class="hyp-type"><b>: </b><span>index ‚Üí VLSM message</span></span></span><br><span><var>Free</var><span><span class="hyp-body"><b>:= </b><span>free_composite_vlsm IM</span></span><span class="hyp-type"><b>: </b><span>VLSM message</span></span></span></span><br><span><var>s, s'</var><span class="hyp-type"><b>: </b><span>vstate Free</span></span></span><br><span><var>Hprs'</var><span class="hyp-type"><b>: </b><span>valid_state_prop Free s&#39;</span></span></span><br><span><var>x</var><span class="hyp-type"><b>: </b><span>vplan_item Free</span></span></span><br><span><var>a</var><span class="hyp-type"><b>: </b><span>list (vplan_item Free)</span></span></span><br><span><var>a_indices</var><span><span class="hyp-body"><b>:= </b><span>List.map projT1
  (List.map label_a (a ++ [x]))</span></span><span class="hyp-type"><b>: </b><span>list index</span></span></span></span><br><span><var>li</var><span class="hyp-type"><b>: </b><span>list index</span></span></span><br><span><var>i</var><span class="hyp-type"><b>: </b><span>index</span></span></span><br><span><var>Heq</var><span class="hyp-type"><b>: </b><span>s&#39; i = s i</span></span></span><br><span><var>Hincl</var><span class="hyp-type"><b>: </b><span>a_indices ‚äÜ li</span></span></span><br><span><var>Hrem</var><span class="hyp-type"><b>: </b><span>finite_valid_plan_from Free s a</span></span></span><br><span><var>tra</var><span class="hyp-type"><b>: </b><span>list transition_item</span></span></span><br><span><var>sa</var><span class="hyp-type"><b>: </b><span>composite_state IM</span></span></span><br><span><var>eq_as</var><span class="hyp-type"><b>: </b><span>apply_plan Free s a = (tra, sa)</span></span></span><br><span><var>Hsingle</var><span class="hyp-type"><b>: </b><span>finite_valid_plan_from Free sa [x]</span></span></span><br><span><var>IHapr</var><span class="hyp-type"><b>: </b><span>finite_valid_plan_from Free s&#39; a</span></span></span><br><span><var>tra'</var><span class="hyp-type"><b>: </b><span>list transition_item</span></span></span><br><span><var>sa'</var><span class="hyp-type"><b>: </b><span>composite_state IM</span></span></span><br><span><var>eq_as'</var><span class="hyp-type"><b>: </b><span>apply_plan Free s&#39; a = (tra&#39;, sa&#39;)</span></span></span><br><span><var>IHaind</var><span class="hyp-type"><b>: </b><span>sa&#39; i = sa i</span></span></span><br><span><var>Hrelpr</var><span class="hyp-type"><b>: </b><span>finite_valid_plan_from Free sa&#39; [x]</span></span></span><br><span><var>trx</var><span class="hyp-type"><b>: </b><span>list transition_item</span></span></span><br><span><var>sx</var><span class="hyp-type"><b>: </b><span>state</span></span></span><br><span><var>eq_xsa</var><span class="hyp-type"><b>: </b><span>apply_plan Free sa [x] = (trx, sx)</span></span></span><br><span><var>trx'</var><span class="hyp-type"><b>: </b><span>list transition_item</span></span></span><br><span><var>sx'</var><span class="hyp-type"><b>: </b><span>state</span></span></span><br><span><var>eq_xsa'</var><span class="hyp-type"><b>: </b><span>apply_plan Free sa&#39; [x] = (trx&#39;, sx&#39;)</span></span></span><br><span><var>Hrelind</var><span class="hyp-type"><b>: </b><span>(trx&#39;, sx&#39;).<span class="mi">2</span> (projT1 (label_a x)) =
(trx, sx).<span class="mi">2</span> (projT1 (label_a x))</span></span></span><br><span><var>Hi</var><span class="hyp-type"><b>: </b><span>i ‚àà li</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">(tra&#39; ++ trx&#39;, sx&#39;).<span class="mi">2</span> i = (tra ++ trx, sx).<span class="mi">2</span> i</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">      </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="Composition-v-chk21a" style="display: none" type="checkbox"><label class="alectryon-input" for="Composition-v-chk21a"><span class="nb">simpl</span> <span class="kr">in</span> *.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>message, index</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>EqDecision0</var><span class="hyp-type"><b>: </b><span>EqDecision index</span></span></span><br><span><var>IM</var><span class="hyp-type"><b>: </b><span>index ‚Üí VLSM message</span></span></span><br><span><var>Free</var><span><span class="hyp-body"><b>:= </b><span>free_composite_vlsm IM</span></span><span class="hyp-type"><b>: </b><span>VLSM message</span></span></span></span><br><span><var>s, s'</var><span class="hyp-type"><b>: </b><span>vstate Free</span></span></span><br><span><var>Hprs'</var><span class="hyp-type"><b>: </b><span>valid_state_prop Free s&#39;</span></span></span><br><span><var>x</var><span class="hyp-type"><b>: </b><span>vplan_item Free</span></span></span><br><span><var>a</var><span class="hyp-type"><b>: </b><span>list (vplan_item Free)</span></span></span><br><span><var>a_indices</var><span><span class="hyp-body"><b>:= </b><span>List.map projT1
  (List.map label_a (a ++ [x]))</span></span><span class="hyp-type"><b>: </b><span>list index</span></span></span></span><br><span><var>li</var><span class="hyp-type"><b>: </b><span>list index</span></span></span><br><span><var>i</var><span class="hyp-type"><b>: </b><span>index</span></span></span><br><span><var>Heq</var><span class="hyp-type"><b>: </b><span>s&#39; i = s i</span></span></span><br><span><var>Hincl</var><span class="hyp-type"><b>: </b><span>a_indices ‚äÜ li</span></span></span><br><span><var>Hrem</var><span class="hyp-type"><b>: </b><span>finite_valid_plan_from Free s a</span></span></span><br><span><var>tra</var><span class="hyp-type"><b>: </b><span>list transition_item</span></span></span><br><span><var>sa</var><span class="hyp-type"><b>: </b><span>composite_state IM</span></span></span><br><span><var>eq_as</var><span class="hyp-type"><b>: </b><span>apply_plan Free s a = (tra, sa)</span></span></span><br><span><var>Hsingle</var><span class="hyp-type"><b>: </b><span>finite_valid_plan_from Free sa [x]</span></span></span><br><span><var>IHapr</var><span class="hyp-type"><b>: </b><span>finite_valid_plan_from Free s&#39; a</span></span></span><br><span><var>tra'</var><span class="hyp-type"><b>: </b><span>list transition_item</span></span></span><br><span><var>sa'</var><span class="hyp-type"><b>: </b><span>composite_state IM</span></span></span><br><span><var>eq_as'</var><span class="hyp-type"><b>: </b><span>apply_plan Free s&#39; a = (tra&#39;, sa&#39;)</span></span></span><br><span><var>IHaind</var><span class="hyp-type"><b>: </b><span>sa&#39; i = sa i</span></span></span><br><span><var>Hrelpr</var><span class="hyp-type"><b>: </b><span>finite_valid_plan_from Free sa&#39; [x]</span></span></span><br><span><var>trx</var><span class="hyp-type"><b>: </b><span>list transition_item</span></span></span><br><span><var>sx</var><span class="hyp-type"><b>: </b><span>composite_state IM</span></span></span><br><span><var>eq_xsa</var><span class="hyp-type"><b>: </b><span>apply_plan Free sa [x] = (trx, sx)</span></span></span><br><span><var>trx'</var><span class="hyp-type"><b>: </b><span>list transition_item</span></span></span><br><span><var>sx'</var><span class="hyp-type"><b>: </b><span>composite_state IM</span></span></span><br><span><var>eq_xsa'</var><span class="hyp-type"><b>: </b><span>apply_plan Free sa&#39; [x] = (trx&#39;, sx&#39;)</span></span></span><br><span><var>Hrelind</var><span class="hyp-type"><b>: </b><span>sx&#39; (projT1 (label_a x)) =
sx (projT1 (label_a x))</span></span></span><br><span><var>Hi</var><span class="hyp-type"><b>: </b><span>i ‚àà li</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">sx&#39; i = sx i</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">      </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="Composition-v-chk21b" style="display: none" type="checkbox"><label class="alectryon-input" for="Composition-v-chk21b"><span class="nb">destruct</span> (decide (i = (projT1 (label_a x)))).</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>message, index</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>EqDecision0</var><span class="hyp-type"><b>: </b><span>EqDecision index</span></span></span><br><span><var>IM</var><span class="hyp-type"><b>: </b><span>index ‚Üí VLSM message</span></span></span><br><span><var>Free</var><span><span class="hyp-body"><b>:= </b><span>free_composite_vlsm IM</span></span><span class="hyp-type"><b>: </b><span>VLSM message</span></span></span></span><br><span><var>s, s'</var><span class="hyp-type"><b>: </b><span>vstate Free</span></span></span><br><span><var>Hprs'</var><span class="hyp-type"><b>: </b><span>valid_state_prop Free s&#39;</span></span></span><br><span><var>x</var><span class="hyp-type"><b>: </b><span>vplan_item Free</span></span></span><br><span><var>a</var><span class="hyp-type"><b>: </b><span>list (vplan_item Free)</span></span></span><br><span><var>a_indices</var><span><span class="hyp-body"><b>:= </b><span>List.map projT1
  (List.map label_a (a ++ [x]))</span></span><span class="hyp-type"><b>: </b><span>list index</span></span></span></span><br><span><var>li</var><span class="hyp-type"><b>: </b><span>list index</span></span></span><br><span><var>i</var><span class="hyp-type"><b>: </b><span>index</span></span></span><br><span><var>Heq</var><span class="hyp-type"><b>: </b><span>s&#39; i = s i</span></span></span><br><span><var>Hincl</var><span class="hyp-type"><b>: </b><span>a_indices ‚äÜ li</span></span></span><br><span><var>Hrem</var><span class="hyp-type"><b>: </b><span>finite_valid_plan_from Free s a</span></span></span><br><span><var>tra</var><span class="hyp-type"><b>: </b><span>list transition_item</span></span></span><br><span><var>sa</var><span class="hyp-type"><b>: </b><span>composite_state IM</span></span></span><br><span><var>eq_as</var><span class="hyp-type"><b>: </b><span>apply_plan Free s a = (tra, sa)</span></span></span><br><span><var>Hsingle</var><span class="hyp-type"><b>: </b><span>finite_valid_plan_from Free sa [x]</span></span></span><br><span><var>IHapr</var><span class="hyp-type"><b>: </b><span>finite_valid_plan_from Free s&#39; a</span></span></span><br><span><var>tra'</var><span class="hyp-type"><b>: </b><span>list transition_item</span></span></span><br><span><var>sa'</var><span class="hyp-type"><b>: </b><span>composite_state IM</span></span></span><br><span><var>eq_as'</var><span class="hyp-type"><b>: </b><span>apply_plan Free s&#39; a = (tra&#39;, sa&#39;)</span></span></span><br><span><var>IHaind</var><span class="hyp-type"><b>: </b><span>sa&#39; i = sa i</span></span></span><br><span><var>Hrelpr</var><span class="hyp-type"><b>: </b><span>finite_valid_plan_from Free sa&#39; [x]</span></span></span><br><span><var>trx</var><span class="hyp-type"><b>: </b><span>list transition_item</span></span></span><br><span><var>sx</var><span class="hyp-type"><b>: </b><span>composite_state IM</span></span></span><br><span><var>eq_xsa</var><span class="hyp-type"><b>: </b><span>apply_plan Free sa [x] = (trx, sx)</span></span></span><br><span><var>trx'</var><span class="hyp-type"><b>: </b><span>list transition_item</span></span></span><br><span><var>sx'</var><span class="hyp-type"><b>: </b><span>composite_state IM</span></span></span><br><span><var>eq_xsa'</var><span class="hyp-type"><b>: </b><span>apply_plan Free sa&#39; [x] = (trx&#39;, sx&#39;)</span></span></span><br><span><var>Hrelind</var><span class="hyp-type"><b>: </b><span>sx&#39; (projT1 (label_a x)) =
sx (projT1 (label_a x))</span></span></span><br><span><var>Hi</var><span class="hyp-type"><b>: </b><span>i ‚àà li</span></span></span><br><span><var>e</var><span class="hyp-type"><b>: </b><span>i = projT1 (label_a x)</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">sx&#39; i = sx i</div></blockquote><div class="alectryon-extra-goals"><input class="alectryon-extra-goal-toggle" id="Composition-v-chk21c" style="display: none" type="checkbox"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>message, index</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>EqDecision0</var><span class="hyp-type"><b>: </b><span>EqDecision index</span></span></span><br><span><var>IM</var><span class="hyp-type"><b>: </b><span>index ‚Üí VLSM message</span></span></span><br><span><var>Free</var><span><span class="hyp-body"><b>:= </b><span>free_composite_vlsm IM</span></span><span class="hyp-type"><b>: </b><span>VLSM message</span></span></span></span><br><span><var>s, s'</var><span class="hyp-type"><b>: </b><span>vstate Free</span></span></span><br><span><var>Hprs'</var><span class="hyp-type"><b>: </b><span>valid_state_prop Free s&#39;</span></span></span><br><span><var>x</var><span class="hyp-type"><b>: </b><span>vplan_item Free</span></span></span><br><span><var>a</var><span class="hyp-type"><b>: </b><span>list (vplan_item Free)</span></span></span><br><span><var>a_indices</var><span><span class="hyp-body"><b>:= </b><span>List.map projT1
  (List.map label_a (a ++ [x]))</span></span><span class="hyp-type"><b>: </b><span>list index</span></span></span></span><br><span><var>li</var><span class="hyp-type"><b>: </b><span>list index</span></span></span><br><span><var>i</var><span class="hyp-type"><b>: </b><span>index</span></span></span><br><span><var>Heq</var><span class="hyp-type"><b>: </b><span>s&#39; i = s i</span></span></span><br><span><var>Hincl</var><span class="hyp-type"><b>: </b><span>a_indices ‚äÜ li</span></span></span><br><span><var>Hrem</var><span class="hyp-type"><b>: </b><span>finite_valid_plan_from Free s a</span></span></span><br><span><var>tra</var><span class="hyp-type"><b>: </b><span>list transition_item</span></span></span><br><span><var>sa</var><span class="hyp-type"><b>: </b><span>composite_state IM</span></span></span><br><span><var>eq_as</var><span class="hyp-type"><b>: </b><span>apply_plan Free s a = (tra, sa)</span></span></span><br><span><var>Hsingle</var><span class="hyp-type"><b>: </b><span>finite_valid_plan_from Free sa [x]</span></span></span><br><span><var>IHapr</var><span class="hyp-type"><b>: </b><span>finite_valid_plan_from Free s&#39; a</span></span></span><br><span><var>tra'</var><span class="hyp-type"><b>: </b><span>list transition_item</span></span></span><br><span><var>sa'</var><span class="hyp-type"><b>: </b><span>composite_state IM</span></span></span><br><span><var>eq_as'</var><span class="hyp-type"><b>: </b><span>apply_plan Free s&#39; a = (tra&#39;, sa&#39;)</span></span></span><br><span><var>IHaind</var><span class="hyp-type"><b>: </b><span>sa&#39; i = sa i</span></span></span><br><span><var>Hrelpr</var><span class="hyp-type"><b>: </b><span>finite_valid_plan_from Free sa&#39; [x]</span></span></span><br><span><var>trx</var><span class="hyp-type"><b>: </b><span>list transition_item</span></span></span><br><span><var>sx</var><span class="hyp-type"><b>: </b><span>composite_state IM</span></span></span><br><span><var>eq_xsa</var><span class="hyp-type"><b>: </b><span>apply_plan Free sa [x] = (trx, sx)</span></span></span><br><span><var>trx'</var><span class="hyp-type"><b>: </b><span>list transition_item</span></span></span><br><span><var>sx'</var><span class="hyp-type"><b>: </b><span>composite_state IM</span></span></span><br><span><var>eq_xsa'</var><span class="hyp-type"><b>: </b><span>apply_plan Free sa&#39; [x] = (trx&#39;, sx&#39;)</span></span></span><br><span><var>Hrelind</var><span class="hyp-type"><b>: </b><span>sx&#39; (projT1 (label_a x)) =
sx (projT1 (label_a x))</span></span></span><br><span><var>Hi</var><span class="hyp-type"><b>: </b><span>i ‚àà li</span></span></span><br><span><var>n</var><span class="hyp-type"><b>: </b><span>i ‚â† projT1 (label_a x)</span></span></span><br></div><label class="goal-separator" for="Composition-v-chk21c"><hr></label><div class="goal-conclusion">sx&#39; i = sx i</div></blockquote></div></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">      </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="Composition-v-chk21d" style="display: none" type="checkbox"><label class="alectryon-input" for="Composition-v-chk21d">*</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>message, index</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>EqDecision0</var><span class="hyp-type"><b>: </b><span>EqDecision index</span></span></span><br><span><var>IM</var><span class="hyp-type"><b>: </b><span>index ‚Üí VLSM message</span></span></span><br><span><var>Free</var><span><span class="hyp-body"><b>:= </b><span>free_composite_vlsm IM</span></span><span class="hyp-type"><b>: </b><span>VLSM message</span></span></span></span><br><span><var>s, s'</var><span class="hyp-type"><b>: </b><span>vstate Free</span></span></span><br><span><var>Hprs'</var><span class="hyp-type"><b>: </b><span>valid_state_prop Free s&#39;</span></span></span><br><span><var>x</var><span class="hyp-type"><b>: </b><span>vplan_item Free</span></span></span><br><span><var>a</var><span class="hyp-type"><b>: </b><span>list (vplan_item Free)</span></span></span><br><span><var>a_indices</var><span><span class="hyp-body"><b>:= </b><span>List.map projT1
  (List.map label_a (a ++ [x]))</span></span><span class="hyp-type"><b>: </b><span>list index</span></span></span></span><br><span><var>li</var><span class="hyp-type"><b>: </b><span>list index</span></span></span><br><span><var>i</var><span class="hyp-type"><b>: </b><span>index</span></span></span><br><span><var>Heq</var><span class="hyp-type"><b>: </b><span>s&#39; i = s i</span></span></span><br><span><var>Hincl</var><span class="hyp-type"><b>: </b><span>a_indices ‚äÜ li</span></span></span><br><span><var>Hrem</var><span class="hyp-type"><b>: </b><span>finite_valid_plan_from Free s a</span></span></span><br><span><var>tra</var><span class="hyp-type"><b>: </b><span>list transition_item</span></span></span><br><span><var>sa</var><span class="hyp-type"><b>: </b><span>composite_state IM</span></span></span><br><span><var>eq_as</var><span class="hyp-type"><b>: </b><span>apply_plan Free s a = (tra, sa)</span></span></span><br><span><var>Hsingle</var><span class="hyp-type"><b>: </b><span>finite_valid_plan_from Free sa [x]</span></span></span><br><span><var>IHapr</var><span class="hyp-type"><b>: </b><span>finite_valid_plan_from Free s&#39; a</span></span></span><br><span><var>tra'</var><span class="hyp-type"><b>: </b><span>list transition_item</span></span></span><br><span><var>sa'</var><span class="hyp-type"><b>: </b><span>composite_state IM</span></span></span><br><span><var>eq_as'</var><span class="hyp-type"><b>: </b><span>apply_plan Free s&#39; a = (tra&#39;, sa&#39;)</span></span></span><br><span><var>IHaind</var><span class="hyp-type"><b>: </b><span>sa&#39; i = sa i</span></span></span><br><span><var>Hrelpr</var><span class="hyp-type"><b>: </b><span>finite_valid_plan_from Free sa&#39; [x]</span></span></span><br><span><var>trx</var><span class="hyp-type"><b>: </b><span>list transition_item</span></span></span><br><span><var>sx</var><span class="hyp-type"><b>: </b><span>composite_state IM</span></span></span><br><span><var>eq_xsa</var><span class="hyp-type"><b>: </b><span>apply_plan Free sa [x] = (trx, sx)</span></span></span><br><span><var>trx'</var><span class="hyp-type"><b>: </b><span>list transition_item</span></span></span><br><span><var>sx'</var><span class="hyp-type"><b>: </b><span>composite_state IM</span></span></span><br><span><var>eq_xsa'</var><span class="hyp-type"><b>: </b><span>apply_plan Free sa&#39; [x] = (trx&#39;, sx&#39;)</span></span></span><br><span><var>Hrelind</var><span class="hyp-type"><b>: </b><span>sx&#39; (projT1 (label_a x)) =
sx (projT1 (label_a x))</span></span></span><br><span><var>Hi</var><span class="hyp-type"><b>: </b><span>i ‚àà li</span></span></span><br><span><var>e</var><span class="hyp-type"><b>: </b><span>i = projT1 (label_a x)</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">sx&#39; i = sx i</div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="nb">rewrite</span> e; itauto.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">      </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="Composition-v-chk21e" style="display: none" type="checkbox"><label class="alectryon-input" for="Composition-v-chk21e">*</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>message, index</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>EqDecision0</var><span class="hyp-type"><b>: </b><span>EqDecision index</span></span></span><br><span><var>IM</var><span class="hyp-type"><b>: </b><span>index ‚Üí VLSM message</span></span></span><br><span><var>Free</var><span><span class="hyp-body"><b>:= </b><span>free_composite_vlsm IM</span></span><span class="hyp-type"><b>: </b><span>VLSM message</span></span></span></span><br><span><var>s, s'</var><span class="hyp-type"><b>: </b><span>vstate Free</span></span></span><br><span><var>Hprs'</var><span class="hyp-type"><b>: </b><span>valid_state_prop Free s&#39;</span></span></span><br><span><var>x</var><span class="hyp-type"><b>: </b><span>vplan_item Free</span></span></span><br><span><var>a</var><span class="hyp-type"><b>: </b><span>list (vplan_item Free)</span></span></span><br><span><var>a_indices</var><span><span class="hyp-body"><b>:= </b><span>List.map projT1
  (List.map label_a (a ++ [x]))</span></span><span class="hyp-type"><b>: </b><span>list index</span></span></span></span><br><span><var>li</var><span class="hyp-type"><b>: </b><span>list index</span></span></span><br><span><var>i</var><span class="hyp-type"><b>: </b><span>index</span></span></span><br><span><var>Heq</var><span class="hyp-type"><b>: </b><span>s&#39; i = s i</span></span></span><br><span><var>Hincl</var><span class="hyp-type"><b>: </b><span>a_indices ‚äÜ li</span></span></span><br><span><var>Hrem</var><span class="hyp-type"><b>: </b><span>finite_valid_plan_from Free s a</span></span></span><br><span><var>tra</var><span class="hyp-type"><b>: </b><span>list transition_item</span></span></span><br><span><var>sa</var><span class="hyp-type"><b>: </b><span>composite_state IM</span></span></span><br><span><var>eq_as</var><span class="hyp-type"><b>: </b><span>apply_plan Free s a = (tra, sa)</span></span></span><br><span><var>Hsingle</var><span class="hyp-type"><b>: </b><span>finite_valid_plan_from Free sa [x]</span></span></span><br><span><var>IHapr</var><span class="hyp-type"><b>: </b><span>finite_valid_plan_from Free s&#39; a</span></span></span><br><span><var>tra'</var><span class="hyp-type"><b>: </b><span>list transition_item</span></span></span><br><span><var>sa'</var><span class="hyp-type"><b>: </b><span>composite_state IM</span></span></span><br><span><var>eq_as'</var><span class="hyp-type"><b>: </b><span>apply_plan Free s&#39; a = (tra&#39;, sa&#39;)</span></span></span><br><span><var>IHaind</var><span class="hyp-type"><b>: </b><span>sa&#39; i = sa i</span></span></span><br><span><var>Hrelpr</var><span class="hyp-type"><b>: </b><span>finite_valid_plan_from Free sa&#39; [x]</span></span></span><br><span><var>trx</var><span class="hyp-type"><b>: </b><span>list transition_item</span></span></span><br><span><var>sx</var><span class="hyp-type"><b>: </b><span>composite_state IM</span></span></span><br><span><var>eq_xsa</var><span class="hyp-type"><b>: </b><span>apply_plan Free sa [x] = (trx, sx)</span></span></span><br><span><var>trx'</var><span class="hyp-type"><b>: </b><span>list transition_item</span></span></span><br><span><var>sx'</var><span class="hyp-type"><b>: </b><span>composite_state IM</span></span></span><br><span><var>eq_xsa'</var><span class="hyp-type"><b>: </b><span>apply_plan Free sa&#39; [x] = (trx&#39;, sx&#39;)</span></span></span><br><span><var>Hrelind</var><span class="hyp-type"><b>: </b><span>sx&#39; (projT1 (label_a x)) =
sx (projT1 (label_a x))</span></span></span><br><span><var>Hi</var><span class="hyp-type"><b>: </b><span>i ‚àà li</span></span></span><br><span><var>n</var><span class="hyp-type"><b>: </b><span>i ‚â† projT1 (label_a x)</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">sx&#39; i = sx i</div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="Composition-v-chk21f" style="display: none" type="checkbox"><label class="alectryon-input" for="Composition-v-chk21f"><span class="nb">specialize</span> (irrelevant_components_one sa) <span class="kr">as</span> Hdiff.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>message, index</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>EqDecision0</var><span class="hyp-type"><b>: </b><span>EqDecision index</span></span></span><br><span><var>IM</var><span class="hyp-type"><b>: </b><span>index ‚Üí VLSM message</span></span></span><br><span><var>Free</var><span><span class="hyp-body"><b>:= </b><span>free_composite_vlsm IM</span></span><span class="hyp-type"><b>: </b><span>VLSM message</span></span></span></span><br><span><var>s, s'</var><span class="hyp-type"><b>: </b><span>vstate Free</span></span></span><br><span><var>Hprs'</var><span class="hyp-type"><b>: </b><span>valid_state_prop Free s&#39;</span></span></span><br><span><var>x</var><span class="hyp-type"><b>: </b><span>vplan_item Free</span></span></span><br><span><var>a</var><span class="hyp-type"><b>: </b><span>list (vplan_item Free)</span></span></span><br><span><var>a_indices</var><span><span class="hyp-body"><b>:= </b><span>List.map projT1
  (List.map label_a (a ++ [x]))</span></span><span class="hyp-type"><b>: </b><span>list index</span></span></span></span><br><span><var>li</var><span class="hyp-type"><b>: </b><span>list index</span></span></span><br><span><var>i</var><span class="hyp-type"><b>: </b><span>index</span></span></span><br><span><var>Heq</var><span class="hyp-type"><b>: </b><span>s&#39; i = s i</span></span></span><br><span><var>Hincl</var><span class="hyp-type"><b>: </b><span>a_indices ‚äÜ li</span></span></span><br><span><var>Hrem</var><span class="hyp-type"><b>: </b><span>finite_valid_plan_from Free s a</span></span></span><br><span><var>tra</var><span class="hyp-type"><b>: </b><span>list transition_item</span></span></span><br><span><var>sa</var><span class="hyp-type"><b>: </b><span>composite_state IM</span></span></span><br><span><var>eq_as</var><span class="hyp-type"><b>: </b><span>apply_plan Free s a = (tra, sa)</span></span></span><br><span><var>Hsingle</var><span class="hyp-type"><b>: </b><span>finite_valid_plan_from Free sa [x]</span></span></span><br><span><var>IHapr</var><span class="hyp-type"><b>: </b><span>finite_valid_plan_from Free s&#39; a</span></span></span><br><span><var>tra'</var><span class="hyp-type"><b>: </b><span>list transition_item</span></span></span><br><span><var>sa'</var><span class="hyp-type"><b>: </b><span>composite_state IM</span></span></span><br><span><var>eq_as'</var><span class="hyp-type"><b>: </b><span>apply_plan Free s&#39; a = (tra&#39;, sa&#39;)</span></span></span><br><span><var>IHaind</var><span class="hyp-type"><b>: </b><span>sa&#39; i = sa i</span></span></span><br><span><var>Hrelpr</var><span class="hyp-type"><b>: </b><span>finite_valid_plan_from Free sa&#39; [x]</span></span></span><br><span><var>trx</var><span class="hyp-type"><b>: </b><span>list transition_item</span></span></span><br><span><var>sx</var><span class="hyp-type"><b>: </b><span>composite_state IM</span></span></span><br><span><var>eq_xsa</var><span class="hyp-type"><b>: </b><span>apply_plan Free sa [x] = (trx, sx)</span></span></span><br><span><var>trx'</var><span class="hyp-type"><b>: </b><span>list transition_item</span></span></span><br><span><var>sx'</var><span class="hyp-type"><b>: </b><span>composite_state IM</span></span></span><br><span><var>eq_xsa'</var><span class="hyp-type"><b>: </b><span>apply_plan Free sa&#39; [x] = (trx&#39;, sx&#39;)</span></span></span><br><span><var>Hrelind</var><span class="hyp-type"><b>: </b><span>sx&#39; (projT1 (label_a x)) =
sx (projT1 (label_a x))</span></span></span><br><span><var>Hi</var><span class="hyp-type"><b>: </b><span>i ‚àà li</span></span></span><br><span><var>n</var><span class="hyp-type"><b>: </b><span>i ‚â† projT1 (label_a x)</span></span></span><br><span><var>Hdiff</var><span class="hyp-type"><b>: </b><span><span class="kr">‚àÄ</span> (<span class="nv">ai</span> : composite_plan_item IM) (<span class="nv">i</span> : index),
  i ‚â† projT1 (label_a ai)
  ‚Üí <span class="kr">let</span> <span class="nv">res</span> :=
      (composite_apply_plan IM sa [ai]).<span class="mi">2</span> <span class="kr">in</span>
    res i = sa i</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">sx&#39; i = sx i</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">        </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="Composition-v-chk220" style="display: none" type="checkbox"><label class="alectryon-input" for="Composition-v-chk220"><span class="nb">specialize</span> (Hdiff x i n).</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>message, index</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>EqDecision0</var><span class="hyp-type"><b>: </b><span>EqDecision index</span></span></span><br><span><var>IM</var><span class="hyp-type"><b>: </b><span>index ‚Üí VLSM message</span></span></span><br><span><var>Free</var><span><span class="hyp-body"><b>:= </b><span>free_composite_vlsm IM</span></span><span class="hyp-type"><b>: </b><span>VLSM message</span></span></span></span><br><span><var>s, s'</var><span class="hyp-type"><b>: </b><span>vstate Free</span></span></span><br><span><var>Hprs'</var><span class="hyp-type"><b>: </b><span>valid_state_prop Free s&#39;</span></span></span><br><span><var>x</var><span class="hyp-type"><b>: </b><span>vplan_item Free</span></span></span><br><span><var>a</var><span class="hyp-type"><b>: </b><span>list (vplan_item Free)</span></span></span><br><span><var>a_indices</var><span><span class="hyp-body"><b>:= </b><span>List.map projT1
  (List.map label_a (a ++ [x]))</span></span><span class="hyp-type"><b>: </b><span>list index</span></span></span></span><br><span><var>li</var><span class="hyp-type"><b>: </b><span>list index</span></span></span><br><span><var>i</var><span class="hyp-type"><b>: </b><span>index</span></span></span><br><span><var>Heq</var><span class="hyp-type"><b>: </b><span>s&#39; i = s i</span></span></span><br><span><var>Hincl</var><span class="hyp-type"><b>: </b><span>a_indices ‚äÜ li</span></span></span><br><span><var>Hrem</var><span class="hyp-type"><b>: </b><span>finite_valid_plan_from Free s a</span></span></span><br><span><var>tra</var><span class="hyp-type"><b>: </b><span>list transition_item</span></span></span><br><span><var>sa</var><span class="hyp-type"><b>: </b><span>composite_state IM</span></span></span><br><span><var>eq_as</var><span class="hyp-type"><b>: </b><span>apply_plan Free s a = (tra, sa)</span></span></span><br><span><var>Hsingle</var><span class="hyp-type"><b>: </b><span>finite_valid_plan_from Free sa [x]</span></span></span><br><span><var>IHapr</var><span class="hyp-type"><b>: </b><span>finite_valid_plan_from Free s&#39; a</span></span></span><br><span><var>tra'</var><span class="hyp-type"><b>: </b><span>list transition_item</span></span></span><br><span><var>sa'</var><span class="hyp-type"><b>: </b><span>composite_state IM</span></span></span><br><span><var>eq_as'</var><span class="hyp-type"><b>: </b><span>apply_plan Free s&#39; a = (tra&#39;, sa&#39;)</span></span></span><br><span><var>IHaind</var><span class="hyp-type"><b>: </b><span>sa&#39; i = sa i</span></span></span><br><span><var>Hrelpr</var><span class="hyp-type"><b>: </b><span>finite_valid_plan_from Free sa&#39; [x]</span></span></span><br><span><var>trx</var><span class="hyp-type"><b>: </b><span>list transition_item</span></span></span><br><span><var>sx</var><span class="hyp-type"><b>: </b><span>composite_state IM</span></span></span><br><span><var>eq_xsa</var><span class="hyp-type"><b>: </b><span>apply_plan Free sa [x] = (trx, sx)</span></span></span><br><span><var>trx'</var><span class="hyp-type"><b>: </b><span>list transition_item</span></span></span><br><span><var>sx'</var><span class="hyp-type"><b>: </b><span>composite_state IM</span></span></span><br><span><var>eq_xsa'</var><span class="hyp-type"><b>: </b><span>apply_plan Free sa&#39; [x] = (trx&#39;, sx&#39;)</span></span></span><br><span><var>Hrelind</var><span class="hyp-type"><b>: </b><span>sx&#39; (projT1 (label_a x)) =
sx (projT1 (label_a x))</span></span></span><br><span><var>Hi</var><span class="hyp-type"><b>: </b><span>i ‚àà li</span></span></span><br><span><var>n</var><span class="hyp-type"><b>: </b><span>i ‚â† projT1 (label_a x)</span></span></span><br><span><var>Hdiff</var><span class="hyp-type"><b>: </b><span><span class="kr">let</span> <span class="nv">res</span> := (composite_apply_plan IM sa [x]).<span class="mi">2</span>
  <span class="kr">in</span>
res i = sa i</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">sx&#39; i = sx i</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
</span><span class="alectryon-wsp">        </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="Composition-v-chk221" style="display: none" type="checkbox"><label class="alectryon-input" for="Composition-v-chk221"><span class="nb">specialize</span> (irrelevant_components_one sa&#39;) <span class="kr">as</span> Hdiff0.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>message, index</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>EqDecision0</var><span class="hyp-type"><b>: </b><span>EqDecision index</span></span></span><br><span><var>IM</var><span class="hyp-type"><b>: </b><span>index ‚Üí VLSM message</span></span></span><br><span><var>Free</var><span><span class="hyp-body"><b>:= </b><span>free_composite_vlsm IM</span></span><span class="hyp-type"><b>: </b><span>VLSM message</span></span></span></span><br><span><var>s, s'</var><span class="hyp-type"><b>: </b><span>vstate Free</span></span></span><br><span><var>Hprs'</var><span class="hyp-type"><b>: </b><span>valid_state_prop Free s&#39;</span></span></span><br><span><var>x</var><span class="hyp-type"><b>: </b><span>vplan_item Free</span></span></span><br><span><var>a</var><span class="hyp-type"><b>: </b><span>list (vplan_item Free)</span></span></span><br><span><var>a_indices</var><span><span class="hyp-body"><b>:= </b><span>List.map projT1
  (List.map label_a (a ++ [x]))</span></span><span class="hyp-type"><b>: </b><span>list index</span></span></span></span><br><span><var>li</var><span class="hyp-type"><b>: </b><span>list index</span></span></span><br><span><var>i</var><span class="hyp-type"><b>: </b><span>index</span></span></span><br><span><var>Heq</var><span class="hyp-type"><b>: </b><span>s&#39; i = s i</span></span></span><br><span><var>Hincl</var><span class="hyp-type"><b>: </b><span>a_indices ‚äÜ li</span></span></span><br><span><var>Hrem</var><span class="hyp-type"><b>: </b><span>finite_valid_plan_from Free s a</span></span></span><br><span><var>tra</var><span class="hyp-type"><b>: </b><span>list transition_item</span></span></span><br><span><var>sa</var><span class="hyp-type"><b>: </b><span>composite_state IM</span></span></span><br><span><var>eq_as</var><span class="hyp-type"><b>: </b><span>apply_plan Free s a = (tra, sa)</span></span></span><br><span><var>Hsingle</var><span class="hyp-type"><b>: </b><span>finite_valid_plan_from Free sa [x]</span></span></span><br><span><var>IHapr</var><span class="hyp-type"><b>: </b><span>finite_valid_plan_from Free s&#39; a</span></span></span><br><span><var>tra'</var><span class="hyp-type"><b>: </b><span>list transition_item</span></span></span><br><span><var>sa'</var><span class="hyp-type"><b>: </b><span>composite_state IM</span></span></span><br><span><var>eq_as'</var><span class="hyp-type"><b>: </b><span>apply_plan Free s&#39; a = (tra&#39;, sa&#39;)</span></span></span><br><span><var>IHaind</var><span class="hyp-type"><b>: </b><span>sa&#39; i = sa i</span></span></span><br><span><var>Hrelpr</var><span class="hyp-type"><b>: </b><span>finite_valid_plan_from Free sa&#39; [x]</span></span></span><br><span><var>trx</var><span class="hyp-type"><b>: </b><span>list transition_item</span></span></span><br><span><var>sx</var><span class="hyp-type"><b>: </b><span>composite_state IM</span></span></span><br><span><var>eq_xsa</var><span class="hyp-type"><b>: </b><span>apply_plan Free sa [x] = (trx, sx)</span></span></span><br><span><var>trx'</var><span class="hyp-type"><b>: </b><span>list transition_item</span></span></span><br><span><var>sx'</var><span class="hyp-type"><b>: </b><span>composite_state IM</span></span></span><br><span><var>eq_xsa'</var><span class="hyp-type"><b>: </b><span>apply_plan Free sa&#39; [x] = (trx&#39;, sx&#39;)</span></span></span><br><span><var>Hrelind</var><span class="hyp-type"><b>: </b><span>sx&#39; (projT1 (label_a x)) =
sx (projT1 (label_a x))</span></span></span><br><span><var>Hi</var><span class="hyp-type"><b>: </b><span>i ‚àà li</span></span></span><br><span><var>n</var><span class="hyp-type"><b>: </b><span>i ‚â† projT1 (label_a x)</span></span></span><br><span><var>Hdiff</var><span class="hyp-type"><b>: </b><span><span class="kr">let</span> <span class="nv">res</span> := (composite_apply_plan IM sa [x]).<span class="mi">2</span>
  <span class="kr">in</span>
res i = sa i</span></span></span><br><span><var>Hdiff0</var><span class="hyp-type"><b>: </b><span><span class="kr">‚àÄ</span> (<span class="nv">ai</span> : composite_plan_item IM) (<span class="nv">i</span> : index),
  i ‚â† projT1 (label_a ai)
  ‚Üí <span class="kr">let</span> <span class="nv">res</span> :=
      (composite_apply_plan IM sa&#39; [ai]).<span class="mi">2</span> <span class="kr">in</span>
    res i = sa&#39; i</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">sx&#39; i = sx i</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">        </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="Composition-v-chk222" style="display: none" type="checkbox"><label class="alectryon-input" for="Composition-v-chk222"><span class="nb">specialize</span> (Hdiff0 x i n).</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>message, index</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>EqDecision0</var><span class="hyp-type"><b>: </b><span>EqDecision index</span></span></span><br><span><var>IM</var><span class="hyp-type"><b>: </b><span>index ‚Üí VLSM message</span></span></span><br><span><var>Free</var><span><span class="hyp-body"><b>:= </b><span>free_composite_vlsm IM</span></span><span class="hyp-type"><b>: </b><span>VLSM message</span></span></span></span><br><span><var>s, s'</var><span class="hyp-type"><b>: </b><span>vstate Free</span></span></span><br><span><var>Hprs'</var><span class="hyp-type"><b>: </b><span>valid_state_prop Free s&#39;</span></span></span><br><span><var>x</var><span class="hyp-type"><b>: </b><span>vplan_item Free</span></span></span><br><span><var>a</var><span class="hyp-type"><b>: </b><span>list (vplan_item Free)</span></span></span><br><span><var>a_indices</var><span><span class="hyp-body"><b>:= </b><span>List.map projT1
  (List.map label_a (a ++ [x]))</span></span><span class="hyp-type"><b>: </b><span>list index</span></span></span></span><br><span><var>li</var><span class="hyp-type"><b>: </b><span>list index</span></span></span><br><span><var>i</var><span class="hyp-type"><b>: </b><span>index</span></span></span><br><span><var>Heq</var><span class="hyp-type"><b>: </b><span>s&#39; i = s i</span></span></span><br><span><var>Hincl</var><span class="hyp-type"><b>: </b><span>a_indices ‚äÜ li</span></span></span><br><span><var>Hrem</var><span class="hyp-type"><b>: </b><span>finite_valid_plan_from Free s a</span></span></span><br><span><var>tra</var><span class="hyp-type"><b>: </b><span>list transition_item</span></span></span><br><span><var>sa</var><span class="hyp-type"><b>: </b><span>composite_state IM</span></span></span><br><span><var>eq_as</var><span class="hyp-type"><b>: </b><span>apply_plan Free s a = (tra, sa)</span></span></span><br><span><var>Hsingle</var><span class="hyp-type"><b>: </b><span>finite_valid_plan_from Free sa [x]</span></span></span><br><span><var>IHapr</var><span class="hyp-type"><b>: </b><span>finite_valid_plan_from Free s&#39; a</span></span></span><br><span><var>tra'</var><span class="hyp-type"><b>: </b><span>list transition_item</span></span></span><br><span><var>sa'</var><span class="hyp-type"><b>: </b><span>composite_state IM</span></span></span><br><span><var>eq_as'</var><span class="hyp-type"><b>: </b><span>apply_plan Free s&#39; a = (tra&#39;, sa&#39;)</span></span></span><br><span><var>IHaind</var><span class="hyp-type"><b>: </b><span>sa&#39; i = sa i</span></span></span><br><span><var>Hrelpr</var><span class="hyp-type"><b>: </b><span>finite_valid_plan_from Free sa&#39; [x]</span></span></span><br><span><var>trx</var><span class="hyp-type"><b>: </b><span>list transition_item</span></span></span><br><span><var>sx</var><span class="hyp-type"><b>: </b><span>composite_state IM</span></span></span><br><span><var>eq_xsa</var><span class="hyp-type"><b>: </b><span>apply_plan Free sa [x] = (trx, sx)</span></span></span><br><span><var>trx'</var><span class="hyp-type"><b>: </b><span>list transition_item</span></span></span><br><span><var>sx'</var><span class="hyp-type"><b>: </b><span>composite_state IM</span></span></span><br><span><var>eq_xsa'</var><span class="hyp-type"><b>: </b><span>apply_plan Free sa&#39; [x] = (trx&#39;, sx&#39;)</span></span></span><br><span><var>Hrelind</var><span class="hyp-type"><b>: </b><span>sx&#39; (projT1 (label_a x)) =
sx (projT1 (label_a x))</span></span></span><br><span><var>Hi</var><span class="hyp-type"><b>: </b><span>i ‚àà li</span></span></span><br><span><var>n</var><span class="hyp-type"><b>: </b><span>i ‚â† projT1 (label_a x)</span></span></span><br><span><var>Hdiff</var><span class="hyp-type"><b>: </b><span><span class="kr">let</span> <span class="nv">res</span> := (composite_apply_plan IM sa [x]).<span class="mi">2</span>
  <span class="kr">in</span>
res i = sa i</span></span></span><br><span><var>Hdiff0</var><span class="hyp-type"><b>: </b><span><span class="kr">let</span> <span class="nv">res</span> :=
  (composite_apply_plan IM sa&#39; [x]).<span class="mi">2</span> <span class="kr">in</span>
res i = sa&#39; i</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">sx&#39; i = sx i</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">        </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="Composition-v-chk223" style="display: none" type="checkbox"><label class="alectryon-input" for="Composition-v-chk223"><span class="nb">simpl</span> <span class="kr">in</span> *.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>message, index</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>EqDecision0</var><span class="hyp-type"><b>: </b><span>EqDecision index</span></span></span><br><span><var>IM</var><span class="hyp-type"><b>: </b><span>index ‚Üí VLSM message</span></span></span><br><span><var>Free</var><span><span class="hyp-body"><b>:= </b><span>free_composite_vlsm IM</span></span><span class="hyp-type"><b>: </b><span>VLSM message</span></span></span></span><br><span><var>s, s'</var><span class="hyp-type"><b>: </b><span>vstate Free</span></span></span><br><span><var>Hprs'</var><span class="hyp-type"><b>: </b><span>valid_state_prop Free s&#39;</span></span></span><br><span><var>x</var><span class="hyp-type"><b>: </b><span>vplan_item Free</span></span></span><br><span><var>a</var><span class="hyp-type"><b>: </b><span>list (vplan_item Free)</span></span></span><br><span><var>a_indices</var><span><span class="hyp-body"><b>:= </b><span>List.map projT1
  (List.map label_a (a ++ [x]))</span></span><span class="hyp-type"><b>: </b><span>list index</span></span></span></span><br><span><var>li</var><span class="hyp-type"><b>: </b><span>list index</span></span></span><br><span><var>i</var><span class="hyp-type"><b>: </b><span>index</span></span></span><br><span><var>Heq</var><span class="hyp-type"><b>: </b><span>s&#39; i = s i</span></span></span><br><span><var>Hincl</var><span class="hyp-type"><b>: </b><span>a_indices ‚äÜ li</span></span></span><br><span><var>Hrem</var><span class="hyp-type"><b>: </b><span>finite_valid_plan_from Free s a</span></span></span><br><span><var>tra</var><span class="hyp-type"><b>: </b><span>list transition_item</span></span></span><br><span><var>sa</var><span class="hyp-type"><b>: </b><span>composite_state IM</span></span></span><br><span><var>eq_as</var><span class="hyp-type"><b>: </b><span>apply_plan Free s a = (tra, sa)</span></span></span><br><span><var>Hsingle</var><span class="hyp-type"><b>: </b><span>finite_valid_plan_from Free sa [x]</span></span></span><br><span><var>IHapr</var><span class="hyp-type"><b>: </b><span>finite_valid_plan_from Free s&#39; a</span></span></span><br><span><var>tra'</var><span class="hyp-type"><b>: </b><span>list transition_item</span></span></span><br><span><var>sa'</var><span class="hyp-type"><b>: </b><span>composite_state IM</span></span></span><br><span><var>eq_as'</var><span class="hyp-type"><b>: </b><span>apply_plan Free s&#39; a = (tra&#39;, sa&#39;)</span></span></span><br><span><var>IHaind</var><span class="hyp-type"><b>: </b><span>sa&#39; i = sa i</span></span></span><br><span><var>Hrelpr</var><span class="hyp-type"><b>: </b><span>finite_valid_plan_from Free sa&#39; [x]</span></span></span><br><span><var>trx</var><span class="hyp-type"><b>: </b><span>list transition_item</span></span></span><br><span><var>sx</var><span class="hyp-type"><b>: </b><span>composite_state IM</span></span></span><br><span><var>eq_xsa</var><span class="hyp-type"><b>: </b><span>apply_plan Free sa [x] = (trx, sx)</span></span></span><br><span><var>trx'</var><span class="hyp-type"><b>: </b><span>list transition_item</span></span></span><br><span><var>sx'</var><span class="hyp-type"><b>: </b><span>composite_state IM</span></span></span><br><span><var>eq_xsa'</var><span class="hyp-type"><b>: </b><span>apply_plan Free sa&#39; [x] = (trx&#39;, sx&#39;)</span></span></span><br><span><var>Hrelind</var><span class="hyp-type"><b>: </b><span>sx&#39; (projT1 (label_a x)) =
sx (projT1 (label_a x))</span></span></span><br><span><var>Hi</var><span class="hyp-type"><b>: </b><span>i ‚àà li</span></span></span><br><span><var>n</var><span class="hyp-type"><b>: </b><span>i ‚â† projT1 (label_a x)</span></span></span><br><span><var>Hdiff</var><span class="hyp-type"><b>: </b><span>(composite_apply_plan IM sa [x]).<span class="mi">2</span> i = sa i</span></span></span><br><span><var>Hdiff0</var><span class="hyp-type"><b>: </b><span>(composite_apply_plan IM sa&#39; [x]).<span class="mi">2</span> i = sa&#39; i</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">sx&#39; i = sx i</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">        </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="Composition-v-chk224" style="display: none" type="checkbox"><label class="alectryon-input" for="Composition-v-chk224"><span class="nb">apply</span> (<span class="nb">f_equal</span> snd) <span class="kr">in</span> eq_xsa.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>message, index</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>EqDecision0</var><span class="hyp-type"><b>: </b><span>EqDecision index</span></span></span><br><span><var>IM</var><span class="hyp-type"><b>: </b><span>index ‚Üí VLSM message</span></span></span><br><span><var>Free</var><span><span class="hyp-body"><b>:= </b><span>free_composite_vlsm IM</span></span><span class="hyp-type"><b>: </b><span>VLSM message</span></span></span></span><br><span><var>s, s'</var><span class="hyp-type"><b>: </b><span>vstate Free</span></span></span><br><span><var>Hprs'</var><span class="hyp-type"><b>: </b><span>valid_state_prop Free s&#39;</span></span></span><br><span><var>x</var><span class="hyp-type"><b>: </b><span>vplan_item Free</span></span></span><br><span><var>a</var><span class="hyp-type"><b>: </b><span>list (vplan_item Free)</span></span></span><br><span><var>a_indices</var><span><span class="hyp-body"><b>:= </b><span>List.map projT1
  (List.map label_a (a ++ [x]))</span></span><span class="hyp-type"><b>: </b><span>list index</span></span></span></span><br><span><var>li</var><span class="hyp-type"><b>: </b><span>list index</span></span></span><br><span><var>i</var><span class="hyp-type"><b>: </b><span>index</span></span></span><br><span><var>Heq</var><span class="hyp-type"><b>: </b><span>s&#39; i = s i</span></span></span><br><span><var>Hincl</var><span class="hyp-type"><b>: </b><span>a_indices ‚äÜ li</span></span></span><br><span><var>Hrem</var><span class="hyp-type"><b>: </b><span>finite_valid_plan_from Free s a</span></span></span><br><span><var>tra</var><span class="hyp-type"><b>: </b><span>list transition_item</span></span></span><br><span><var>sa</var><span class="hyp-type"><b>: </b><span>composite_state IM</span></span></span><br><span><var>eq_as</var><span class="hyp-type"><b>: </b><span>apply_plan Free s a = (tra, sa)</span></span></span><br><span><var>Hsingle</var><span class="hyp-type"><b>: </b><span>finite_valid_plan_from Free sa [x]</span></span></span><br><span><var>IHapr</var><span class="hyp-type"><b>: </b><span>finite_valid_plan_from Free s&#39; a</span></span></span><br><span><var>tra'</var><span class="hyp-type"><b>: </b><span>list transition_item</span></span></span><br><span><var>sa'</var><span class="hyp-type"><b>: </b><span>composite_state IM</span></span></span><br><span><var>eq_as'</var><span class="hyp-type"><b>: </b><span>apply_plan Free s&#39; a = (tra&#39;, sa&#39;)</span></span></span><br><span><var>IHaind</var><span class="hyp-type"><b>: </b><span>sa&#39; i = sa i</span></span></span><br><span><var>Hrelpr</var><span class="hyp-type"><b>: </b><span>finite_valid_plan_from Free sa&#39; [x]</span></span></span><br><span><var>trx</var><span class="hyp-type"><b>: </b><span>list transition_item</span></span></span><br><span><var>sx</var><span class="hyp-type"><b>: </b><span>composite_state IM</span></span></span><br><span><var>eq_xsa</var><span class="hyp-type"><b>: </b><span>(apply_plan Free sa [x]).<span class="mi">2</span> = (trx, sx).<span class="mi">2</span></span></span></span><br><span><var>trx'</var><span class="hyp-type"><b>: </b><span>list transition_item</span></span></span><br><span><var>sx'</var><span class="hyp-type"><b>: </b><span>composite_state IM</span></span></span><br><span><var>eq_xsa'</var><span class="hyp-type"><b>: </b><span>apply_plan Free sa&#39; [x] = (trx&#39;, sx&#39;)</span></span></span><br><span><var>Hrelind</var><span class="hyp-type"><b>: </b><span>sx&#39; (projT1 (label_a x)) =
sx (projT1 (label_a x))</span></span></span><br><span><var>Hi</var><span class="hyp-type"><b>: </b><span>i ‚àà li</span></span></span><br><span><var>n</var><span class="hyp-type"><b>: </b><span>i ‚â† projT1 (label_a x)</span></span></span><br><span><var>Hdiff</var><span class="hyp-type"><b>: </b><span>(composite_apply_plan IM sa [x]).<span class="mi">2</span> i = sa i</span></span></span><br><span><var>Hdiff0</var><span class="hyp-type"><b>: </b><span>(composite_apply_plan IM sa&#39; [x]).<span class="mi">2</span> i = sa&#39; i</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">sx&#39; i = sx i</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">        </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="Composition-v-chk225" style="display: none" type="checkbox"><label class="alectryon-input" for="Composition-v-chk225"><span class="nb">apply</span> (<span class="nb">f_equal</span> snd) <span class="kr">in</span> eq_xsa&#39;.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>message, index</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>EqDecision0</var><span class="hyp-type"><b>: </b><span>EqDecision index</span></span></span><br><span><var>IM</var><span class="hyp-type"><b>: </b><span>index ‚Üí VLSM message</span></span></span><br><span><var>Free</var><span><span class="hyp-body"><b>:= </b><span>free_composite_vlsm IM</span></span><span class="hyp-type"><b>: </b><span>VLSM message</span></span></span></span><br><span><var>s, s'</var><span class="hyp-type"><b>: </b><span>vstate Free</span></span></span><br><span><var>Hprs'</var><span class="hyp-type"><b>: </b><span>valid_state_prop Free s&#39;</span></span></span><br><span><var>x</var><span class="hyp-type"><b>: </b><span>vplan_item Free</span></span></span><br><span><var>a</var><span class="hyp-type"><b>: </b><span>list (vplan_item Free)</span></span></span><br><span><var>a_indices</var><span><span class="hyp-body"><b>:= </b><span>List.map projT1
  (List.map label_a (a ++ [x]))</span></span><span class="hyp-type"><b>: </b><span>list index</span></span></span></span><br><span><var>li</var><span class="hyp-type"><b>: </b><span>list index</span></span></span><br><span><var>i</var><span class="hyp-type"><b>: </b><span>index</span></span></span><br><span><var>Heq</var><span class="hyp-type"><b>: </b><span>s&#39; i = s i</span></span></span><br><span><var>Hincl</var><span class="hyp-type"><b>: </b><span>a_indices ‚äÜ li</span></span></span><br><span><var>Hrem</var><span class="hyp-type"><b>: </b><span>finite_valid_plan_from Free s a</span></span></span><br><span><var>tra</var><span class="hyp-type"><b>: </b><span>list transition_item</span></span></span><br><span><var>sa</var><span class="hyp-type"><b>: </b><span>composite_state IM</span></span></span><br><span><var>eq_as</var><span class="hyp-type"><b>: </b><span>apply_plan Free s a = (tra, sa)</span></span></span><br><span><var>Hsingle</var><span class="hyp-type"><b>: </b><span>finite_valid_plan_from Free sa [x]</span></span></span><br><span><var>IHapr</var><span class="hyp-type"><b>: </b><span>finite_valid_plan_from Free s&#39; a</span></span></span><br><span><var>tra'</var><span class="hyp-type"><b>: </b><span>list transition_item</span></span></span><br><span><var>sa'</var><span class="hyp-type"><b>: </b><span>composite_state IM</span></span></span><br><span><var>eq_as'</var><span class="hyp-type"><b>: </b><span>apply_plan Free s&#39; a = (tra&#39;, sa&#39;)</span></span></span><br><span><var>IHaind</var><span class="hyp-type"><b>: </b><span>sa&#39; i = sa i</span></span></span><br><span><var>Hrelpr</var><span class="hyp-type"><b>: </b><span>finite_valid_plan_from Free sa&#39; [x]</span></span></span><br><span><var>trx</var><span class="hyp-type"><b>: </b><span>list transition_item</span></span></span><br><span><var>sx</var><span class="hyp-type"><b>: </b><span>composite_state IM</span></span></span><br><span><var>eq_xsa</var><span class="hyp-type"><b>: </b><span>(apply_plan Free sa [x]).<span class="mi">2</span> = (trx, sx).<span class="mi">2</span></span></span></span><br><span><var>trx'</var><span class="hyp-type"><b>: </b><span>list transition_item</span></span></span><br><span><var>sx'</var><span class="hyp-type"><b>: </b><span>composite_state IM</span></span></span><br><span><var>eq_xsa'</var><span class="hyp-type"><b>: </b><span>(apply_plan Free sa&#39; [x]).<span class="mi">2</span> = (trx&#39;, sx&#39;).<span class="mi">2</span></span></span></span><br><span><var>Hrelind</var><span class="hyp-type"><b>: </b><span>sx&#39; (projT1 (label_a x)) =
sx (projT1 (label_a x))</span></span></span><br><span><var>Hi</var><span class="hyp-type"><b>: </b><span>i ‚àà li</span></span></span><br><span><var>n</var><span class="hyp-type"><b>: </b><span>i ‚â† projT1 (label_a x)</span></span></span><br><span><var>Hdiff</var><span class="hyp-type"><b>: </b><span>(composite_apply_plan IM sa [x]).<span class="mi">2</span> i = sa i</span></span></span><br><span><var>Hdiff0</var><span class="hyp-type"><b>: </b><span>(composite_apply_plan IM sa&#39; [x]).<span class="mi">2</span> i = sa&#39; i</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">sx&#39; i = sx i</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
</span><span class="alectryon-wsp">        </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="Composition-v-chk226" style="display: none" type="checkbox"><label class="alectryon-input" for="Composition-v-chk226"><span class="nb">replace</span> sx&#39; <span class="kr">with</span> (snd (composite_apply_plan IM sa&#39; [x])).</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>message, index</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>EqDecision0</var><span class="hyp-type"><b>: </b><span>EqDecision index</span></span></span><br><span><var>IM</var><span class="hyp-type"><b>: </b><span>index ‚Üí VLSM message</span></span></span><br><span><var>Free</var><span><span class="hyp-body"><b>:= </b><span>free_composite_vlsm IM</span></span><span class="hyp-type"><b>: </b><span>VLSM message</span></span></span></span><br><span><var>s, s'</var><span class="hyp-type"><b>: </b><span>vstate Free</span></span></span><br><span><var>Hprs'</var><span class="hyp-type"><b>: </b><span>valid_state_prop Free s&#39;</span></span></span><br><span><var>x</var><span class="hyp-type"><b>: </b><span>vplan_item Free</span></span></span><br><span><var>a</var><span class="hyp-type"><b>: </b><span>list (vplan_item Free)</span></span></span><br><span><var>a_indices</var><span><span class="hyp-body"><b>:= </b><span>List.map projT1
  (List.map label_a (a ++ [x]))</span></span><span class="hyp-type"><b>: </b><span>list index</span></span></span></span><br><span><var>li</var><span class="hyp-type"><b>: </b><span>list index</span></span></span><br><span><var>i</var><span class="hyp-type"><b>: </b><span>index</span></span></span><br><span><var>Heq</var><span class="hyp-type"><b>: </b><span>s&#39; i = s i</span></span></span><br><span><var>Hincl</var><span class="hyp-type"><b>: </b><span>a_indices ‚äÜ li</span></span></span><br><span><var>Hrem</var><span class="hyp-type"><b>: </b><span>finite_valid_plan_from Free s a</span></span></span><br><span><var>tra</var><span class="hyp-type"><b>: </b><span>list transition_item</span></span></span><br><span><var>sa</var><span class="hyp-type"><b>: </b><span>composite_state IM</span></span></span><br><span><var>eq_as</var><span class="hyp-type"><b>: </b><span>apply_plan Free s a = (tra, sa)</span></span></span><br><span><var>Hsingle</var><span class="hyp-type"><b>: </b><span>finite_valid_plan_from Free sa [x]</span></span></span><br><span><var>IHapr</var><span class="hyp-type"><b>: </b><span>finite_valid_plan_from Free s&#39; a</span></span></span><br><span><var>tra'</var><span class="hyp-type"><b>: </b><span>list transition_item</span></span></span><br><span><var>sa'</var><span class="hyp-type"><b>: </b><span>composite_state IM</span></span></span><br><span><var>eq_as'</var><span class="hyp-type"><b>: </b><span>apply_plan Free s&#39; a = (tra&#39;, sa&#39;)</span></span></span><br><span><var>IHaind</var><span class="hyp-type"><b>: </b><span>sa&#39; i = sa i</span></span></span><br><span><var>Hrelpr</var><span class="hyp-type"><b>: </b><span>finite_valid_plan_from Free sa&#39; [x]</span></span></span><br><span><var>trx</var><span class="hyp-type"><b>: </b><span>list transition_item</span></span></span><br><span><var>sx</var><span class="hyp-type"><b>: </b><span>composite_state IM</span></span></span><br><span><var>eq_xsa</var><span class="hyp-type"><b>: </b><span>(apply_plan Free sa [x]).<span class="mi">2</span> = (trx, sx).<span class="mi">2</span></span></span></span><br><span><var>trx'</var><span class="hyp-type"><b>: </b><span>list transition_item</span></span></span><br><span><var>sx'</var><span class="hyp-type"><b>: </b><span>composite_state IM</span></span></span><br><span><var>eq_xsa'</var><span class="hyp-type"><b>: </b><span>(apply_plan Free sa&#39; [x]).<span class="mi">2</span> = (trx&#39;, sx&#39;).<span class="mi">2</span></span></span></span><br><span><var>Hrelind</var><span class="hyp-type"><b>: </b><span>sx&#39; (projT1 (label_a x)) =
sx (projT1 (label_a x))</span></span></span><br><span><var>Hi</var><span class="hyp-type"><b>: </b><span>i ‚àà li</span></span></span><br><span><var>n</var><span class="hyp-type"><b>: </b><span>i ‚â† projT1 (label_a x)</span></span></span><br><span><var>Hdiff</var><span class="hyp-type"><b>: </b><span>(composite_apply_plan IM sa [x]).<span class="mi">2</span> i = sa i</span></span></span><br><span><var>Hdiff0</var><span class="hyp-type"><b>: </b><span>(composite_apply_plan IM sa&#39; [x]).<span class="mi">2</span> i = sa&#39; i</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">(composite_apply_plan IM sa&#39; [x]).<span class="mi">2</span> i = sx i</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">        </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="Composition-v-chk227" style="display: none" type="checkbox"><label class="alectryon-input" for="Composition-v-chk227"><span class="nb">replace</span> sx <span class="kr">with</span> (snd (composite_apply_plan IM sa [x])).</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>message, index</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>EqDecision0</var><span class="hyp-type"><b>: </b><span>EqDecision index</span></span></span><br><span><var>IM</var><span class="hyp-type"><b>: </b><span>index ‚Üí VLSM message</span></span></span><br><span><var>Free</var><span><span class="hyp-body"><b>:= </b><span>free_composite_vlsm IM</span></span><span class="hyp-type"><b>: </b><span>VLSM message</span></span></span></span><br><span><var>s, s'</var><span class="hyp-type"><b>: </b><span>vstate Free</span></span></span><br><span><var>Hprs'</var><span class="hyp-type"><b>: </b><span>valid_state_prop Free s&#39;</span></span></span><br><span><var>x</var><span class="hyp-type"><b>: </b><span>vplan_item Free</span></span></span><br><span><var>a</var><span class="hyp-type"><b>: </b><span>list (vplan_item Free)</span></span></span><br><span><var>a_indices</var><span><span class="hyp-body"><b>:= </b><span>List.map projT1
  (List.map label_a (a ++ [x]))</span></span><span class="hyp-type"><b>: </b><span>list index</span></span></span></span><br><span><var>li</var><span class="hyp-type"><b>: </b><span>list index</span></span></span><br><span><var>i</var><span class="hyp-type"><b>: </b><span>index</span></span></span><br><span><var>Heq</var><span class="hyp-type"><b>: </b><span>s&#39; i = s i</span></span></span><br><span><var>Hincl</var><span class="hyp-type"><b>: </b><span>a_indices ‚äÜ li</span></span></span><br><span><var>Hrem</var><span class="hyp-type"><b>: </b><span>finite_valid_plan_from Free s a</span></span></span><br><span><var>tra</var><span class="hyp-type"><b>: </b><span>list transition_item</span></span></span><br><span><var>sa</var><span class="hyp-type"><b>: </b><span>composite_state IM</span></span></span><br><span><var>eq_as</var><span class="hyp-type"><b>: </b><span>apply_plan Free s a = (tra, sa)</span></span></span><br><span><var>Hsingle</var><span class="hyp-type"><b>: </b><span>finite_valid_plan_from Free sa [x]</span></span></span><br><span><var>IHapr</var><span class="hyp-type"><b>: </b><span>finite_valid_plan_from Free s&#39; a</span></span></span><br><span><var>tra'</var><span class="hyp-type"><b>: </b><span>list transition_item</span></span></span><br><span><var>sa'</var><span class="hyp-type"><b>: </b><span>composite_state IM</span></span></span><br><span><var>eq_as'</var><span class="hyp-type"><b>: </b><span>apply_plan Free s&#39; a = (tra&#39;, sa&#39;)</span></span></span><br><span><var>IHaind</var><span class="hyp-type"><b>: </b><span>sa&#39; i = sa i</span></span></span><br><span><var>Hrelpr</var><span class="hyp-type"><b>: </b><span>finite_valid_plan_from Free sa&#39; [x]</span></span></span><br><span><var>trx</var><span class="hyp-type"><b>: </b><span>list transition_item</span></span></span><br><span><var>sx</var><span class="hyp-type"><b>: </b><span>composite_state IM</span></span></span><br><span><var>eq_xsa</var><span class="hyp-type"><b>: </b><span>(apply_plan Free sa [x]).<span class="mi">2</span> = (trx, sx).<span class="mi">2</span></span></span></span><br><span><var>trx'</var><span class="hyp-type"><b>: </b><span>list transition_item</span></span></span><br><span><var>sx'</var><span class="hyp-type"><b>: </b><span>composite_state IM</span></span></span><br><span><var>eq_xsa'</var><span class="hyp-type"><b>: </b><span>(apply_plan Free sa&#39; [x]).<span class="mi">2</span> = (trx&#39;, sx&#39;).<span class="mi">2</span></span></span></span><br><span><var>Hrelind</var><span class="hyp-type"><b>: </b><span>sx&#39; (projT1 (label_a x)) =
sx (projT1 (label_a x))</span></span></span><br><span><var>Hi</var><span class="hyp-type"><b>: </b><span>i ‚àà li</span></span></span><br><span><var>n</var><span class="hyp-type"><b>: </b><span>i ‚â† projT1 (label_a x)</span></span></span><br><span><var>Hdiff</var><span class="hyp-type"><b>: </b><span>(composite_apply_plan IM sa [x]).<span class="mi">2</span> i = sa i</span></span></span><br><span><var>Hdiff0</var><span class="hyp-type"><b>: </b><span>(composite_apply_plan IM sa&#39; [x]).<span class="mi">2</span> i = sa&#39; i</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">(composite_apply_plan IM sa&#39; [x]).<span class="mi">2</span> i =
(composite_apply_plan IM sa [x]).<span class="mi">2</span> i</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">        </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="Composition-v-chk228" style="display: none" type="checkbox"><label class="alectryon-input" for="Composition-v-chk228"><span class="nb">setoid_rewrite</span> Hdiff.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>message, index</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>EqDecision0</var><span class="hyp-type"><b>: </b><span>EqDecision index</span></span></span><br><span><var>IM</var><span class="hyp-type"><b>: </b><span>index ‚Üí VLSM message</span></span></span><br><span><var>Free</var><span><span class="hyp-body"><b>:= </b><span>free_composite_vlsm IM</span></span><span class="hyp-type"><b>: </b><span>VLSM message</span></span></span></span><br><span><var>s, s'</var><span class="hyp-type"><b>: </b><span>vstate Free</span></span></span><br><span><var>Hprs'</var><span class="hyp-type"><b>: </b><span>valid_state_prop Free s&#39;</span></span></span><br><span><var>x</var><span class="hyp-type"><b>: </b><span>vplan_item Free</span></span></span><br><span><var>a</var><span class="hyp-type"><b>: </b><span>list (vplan_item Free)</span></span></span><br><span><var>a_indices</var><span><span class="hyp-body"><b>:= </b><span>List.map projT1
  (List.map label_a (a ++ [x]))</span></span><span class="hyp-type"><b>: </b><span>list index</span></span></span></span><br><span><var>li</var><span class="hyp-type"><b>: </b><span>list index</span></span></span><br><span><var>i</var><span class="hyp-type"><b>: </b><span>index</span></span></span><br><span><var>Heq</var><span class="hyp-type"><b>: </b><span>s&#39; i = s i</span></span></span><br><span><var>Hincl</var><span class="hyp-type"><b>: </b><span>a_indices ‚äÜ li</span></span></span><br><span><var>Hrem</var><span class="hyp-type"><b>: </b><span>finite_valid_plan_from Free s a</span></span></span><br><span><var>tra</var><span class="hyp-type"><b>: </b><span>list transition_item</span></span></span><br><span><var>sa</var><span class="hyp-type"><b>: </b><span>composite_state IM</span></span></span><br><span><var>eq_as</var><span class="hyp-type"><b>: </b><span>apply_plan Free s a = (tra, sa)</span></span></span><br><span><var>Hsingle</var><span class="hyp-type"><b>: </b><span>finite_valid_plan_from Free sa [x]</span></span></span><br><span><var>IHapr</var><span class="hyp-type"><b>: </b><span>finite_valid_plan_from Free s&#39; a</span></span></span><br><span><var>tra'</var><span class="hyp-type"><b>: </b><span>list transition_item</span></span></span><br><span><var>sa'</var><span class="hyp-type"><b>: </b><span>composite_state IM</span></span></span><br><span><var>eq_as'</var><span class="hyp-type"><b>: </b><span>apply_plan Free s&#39; a = (tra&#39;, sa&#39;)</span></span></span><br><span><var>IHaind</var><span class="hyp-type"><b>: </b><span>sa&#39; i = sa i</span></span></span><br><span><var>Hrelpr</var><span class="hyp-type"><b>: </b><span>finite_valid_plan_from Free sa&#39; [x]</span></span></span><br><span><var>trx</var><span class="hyp-type"><b>: </b><span>list transition_item</span></span></span><br><span><var>sx</var><span class="hyp-type"><b>: </b><span>composite_state IM</span></span></span><br><span><var>eq_xsa</var><span class="hyp-type"><b>: </b><span>(apply_plan Free sa [x]).<span class="mi">2</span> = (trx, sx).<span class="mi">2</span></span></span></span><br><span><var>trx'</var><span class="hyp-type"><b>: </b><span>list transition_item</span></span></span><br><span><var>sx'</var><span class="hyp-type"><b>: </b><span>composite_state IM</span></span></span><br><span><var>eq_xsa'</var><span class="hyp-type"><b>: </b><span>(apply_plan Free sa&#39; [x]).<span class="mi">2</span> = (trx&#39;, sx&#39;).<span class="mi">2</span></span></span></span><br><span><var>Hrelind</var><span class="hyp-type"><b>: </b><span>sx&#39; (projT1 (label_a x)) =
sx (projT1 (label_a x))</span></span></span><br><span><var>Hi</var><span class="hyp-type"><b>: </b><span>i ‚àà li</span></span></span><br><span><var>n</var><span class="hyp-type"><b>: </b><span>i ‚â† projT1 (label_a x)</span></span></span><br><span><var>Hdiff</var><span class="hyp-type"><b>: </b><span>(composite_apply_plan IM sa [x]).<span class="mi">2</span> i = sa i</span></span></span><br><span><var>Hdiff0</var><span class="hyp-type"><b>: </b><span>(composite_apply_plan IM sa&#39; [x]).<span class="mi">2</span> i = sa&#39; i</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">(composite_apply_plan IM sa&#39; [x]).<span class="mi">2</span> i = sa i</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">        </span><span class="alectryon-sentence"><span class="alectryon-input"><span class="bp">by</span> <span class="nb">setoid_rewrite</span> Hdiff0.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Qed</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
</span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">End</span> <span class="nf">composite_plan_properties</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
</span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Section</span> <span class="nf">empty_composition_properties</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
</span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Context</span> {<span class="nv">message</span> : <span class="kt">Type</span>}
  `{finite.Finite index}
  (IM : index -&gt; VLSM message)
  (constraint : composite_label IM -&gt; composite_state IM * option message -&gt; <span class="kt">Prop</span>)
  (X := composite_vlsm IM constraint)
  (Hempty_index : enum index = [])
  .</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
</span><span class="alectryon-sentence"><input class="alectryon-toggle" id="Composition-v-chk229" style="display: none" type="checkbox"><label class="alectryon-input" for="Composition-v-chk229"><span class="kn">Lemma</span> <span class="nf">empty_composition_no_index</span>
  (<span class="nv">i</span> : index)
  : <span class="kt">False</span>.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>message, index</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>EqDecision0</var><span class="hyp-type"><b>: </b><span>EqDecision index</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>finite.Finite index</span></span></span><br><span><var>IM</var><span class="hyp-type"><b>: </b><span>index ‚Üí VLSM message</span></span></span><br><span><var>constraint</var><span class="hyp-type"><b>: </b><span>composite_label IM
‚Üí composite_state IM * option message
  ‚Üí <span class="kt">Prop</span></span></span></span><br><span><var>X</var><span><span class="hyp-body"><b>:= </b><span>composite_vlsm IM constraint</span></span><span class="hyp-type"><b>: </b><span>VLSM message</span></span></span></span><br><span><var>Hempty_index</var><span class="hyp-type"><b>: </b><span>enum index = []</span></span></span><br><span><var>i</var><span class="hyp-type"><b>: </b><span>index</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="kt">False</span></div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="Composition-v-chk22a" style="display: none" type="checkbox"><label class="alectryon-input" for="Composition-v-chk22a"><span class="kn">Proof</span>.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>message, index</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>EqDecision0</var><span class="hyp-type"><b>: </b><span>EqDecision index</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>finite.Finite index</span></span></span><br><span><var>IM</var><span class="hyp-type"><b>: </b><span>index ‚Üí VLSM message</span></span></span><br><span><var>constraint</var><span class="hyp-type"><b>: </b><span>composite_label IM
‚Üí composite_state IM * option message
  ‚Üí <span class="kt">Prop</span></span></span></span><br><span><var>X</var><span><span class="hyp-body"><b>:= </b><span>composite_vlsm IM constraint</span></span><span class="hyp-type"><b>: </b><span>VLSM message</span></span></span></span><br><span><var>Hempty_index</var><span class="hyp-type"><b>: </b><span>enum index = []</span></span></span><br><span><var>i</var><span class="hyp-type"><b>: </b><span>index</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="kt">False</span></div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><span class="alectryon-input"><span class="nb">specialize</span> (elem_of_enum i); <span class="nb">rewrite</span> Hempty_index; <span class="nb">apply</span> not_elem_of_nil.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Qed</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
</span><span class="alectryon-sentence"><input class="alectryon-toggle" id="Composition-v-chk22b" style="display: none" type="checkbox"><label class="alectryon-input" for="Composition-v-chk22b"><span class="kn">Lemma</span> <span class="nf">empty_composition_single_state</span>
  (<span class="nv">s</span> : composite_state IM)
  : s = (proj1_sig (composite_s0 IM)).</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>message, index</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>EqDecision0</var><span class="hyp-type"><b>: </b><span>EqDecision index</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>finite.Finite index</span></span></span><br><span><var>IM</var><span class="hyp-type"><b>: </b><span>index ‚Üí VLSM message</span></span></span><br><span><var>constraint</var><span class="hyp-type"><b>: </b><span>composite_label IM
‚Üí composite_state IM * option message
  ‚Üí <span class="kt">Prop</span></span></span></span><br><span><var>X</var><span><span class="hyp-body"><b>:= </b><span>composite_vlsm IM constraint</span></span><span class="hyp-type"><b>: </b><span>VLSM message</span></span></span></span><br><span><var>Hempty_index</var><span class="hyp-type"><b>: </b><span>enum index = []</span></span></span><br><span><var>s</var><span class="hyp-type"><b>: </b><span>composite_state IM</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">s = `(composite_s0 IM)</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="Composition-v-chk22c" style="display: none" type="checkbox"><label class="alectryon-input" for="Composition-v-chk22c"><span class="kn">Proof</span>.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>message, index</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>EqDecision0</var><span class="hyp-type"><b>: </b><span>EqDecision index</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>finite.Finite index</span></span></span><br><span><var>IM</var><span class="hyp-type"><b>: </b><span>index ‚Üí VLSM message</span></span></span><br><span><var>constraint</var><span class="hyp-type"><b>: </b><span>composite_label IM
‚Üí composite_state IM * option message
  ‚Üí <span class="kt">Prop</span></span></span></span><br><span><var>X</var><span><span class="hyp-body"><b>:= </b><span>composite_vlsm IM constraint</span></span><span class="hyp-type"><b>: </b><span>VLSM message</span></span></span></span><br><span><var>Hempty_index</var><span class="hyp-type"><b>: </b><span>enum index = []</span></span></span><br><span><var>s</var><span class="hyp-type"><b>: </b><span>composite_state IM</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">s = `(composite_s0 IM)</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><span class="alectryon-input">extensionality i; <span class="nb">elim</span> (empty_composition_no_index i).</span><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Qed</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
</span><span class="alectryon-sentence"><input class="alectryon-toggle" id="Composition-v-chk22d" style="display: none" type="checkbox"><label class="alectryon-input" for="Composition-v-chk22d"><span class="kn">Lemma</span> <span class="nf">empty_composition_no_label</span>
  (<span class="nv">l</span> : composite_label IM)
  : <span class="kt">False</span>.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>message, index</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>EqDecision0</var><span class="hyp-type"><b>: </b><span>EqDecision index</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>finite.Finite index</span></span></span><br><span><var>IM</var><span class="hyp-type"><b>: </b><span>index ‚Üí VLSM message</span></span></span><br><span><var>constraint</var><span class="hyp-type"><b>: </b><span>composite_label IM
‚Üí composite_state IM * option message
  ‚Üí <span class="kt">Prop</span></span></span></span><br><span><var>X</var><span><span class="hyp-body"><b>:= </b><span>composite_vlsm IM constraint</span></span><span class="hyp-type"><b>: </b><span>VLSM message</span></span></span></span><br><span><var>Hempty_index</var><span class="hyp-type"><b>: </b><span>enum index = []</span></span></span><br><span><var>l</var><span class="hyp-type"><b>: </b><span>composite_label IM</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="kt">False</span></div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="Composition-v-chk22e" style="display: none" type="checkbox"><label class="alectryon-input" for="Composition-v-chk22e"><span class="kn">Proof</span>.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>message, index</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>EqDecision0</var><span class="hyp-type"><b>: </b><span>EqDecision index</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>finite.Finite index</span></span></span><br><span><var>IM</var><span class="hyp-type"><b>: </b><span>index ‚Üí VLSM message</span></span></span><br><span><var>constraint</var><span class="hyp-type"><b>: </b><span>composite_label IM
‚Üí composite_state IM * option message
  ‚Üí <span class="kt">Prop</span></span></span></span><br><span><var>X</var><span><span class="hyp-body"><b>:= </b><span>composite_vlsm IM constraint</span></span><span class="hyp-type"><b>: </b><span>VLSM message</span></span></span></span><br><span><var>Hempty_index</var><span class="hyp-type"><b>: </b><span>enum index = []</span></span></span><br><span><var>l</var><span class="hyp-type"><b>: </b><span>composite_label IM</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="kt">False</span></div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="Composition-v-chk22f" style="display: none" type="checkbox"><label class="alectryon-input" for="Composition-v-chk22f"><span class="nb">destruct</span> l <span class="kr">as</span> (i, _).</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>message, index</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>EqDecision0</var><span class="hyp-type"><b>: </b><span>EqDecision index</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>finite.Finite index</span></span></span><br><span><var>IM</var><span class="hyp-type"><b>: </b><span>index ‚Üí VLSM message</span></span></span><br><span><var>constraint</var><span class="hyp-type"><b>: </b><span>composite_label IM
‚Üí composite_state IM * option message
  ‚Üí <span class="kt">Prop</span></span></span></span><br><span><var>X</var><span><span class="hyp-body"><b>:= </b><span>composite_vlsm IM constraint</span></span><span class="hyp-type"><b>: </b><span>VLSM message</span></span></span></span><br><span><var>Hempty_index</var><span class="hyp-type"><b>: </b><span>enum index = []</span></span></span><br><span><var>i</var><span class="hyp-type"><b>: </b><span>index</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="kt">False</span></div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="nb">elim</span> (empty_composition_no_index i).</span><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Qed</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
</span><span class="alectryon-sentence"><input class="alectryon-toggle" id="Composition-v-chk230" style="display: none" type="checkbox"><label class="alectryon-input" for="Composition-v-chk230"><span class="kn">Lemma</span> <span class="nf">empty_composition_no_initial_message</span>
  : <span class="kr">forall</span> <span class="nv">m</span>, ~ composite_initial_message_prop IM m.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>message, index</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>EqDecision0</var><span class="hyp-type"><b>: </b><span>EqDecision index</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>finite.Finite index</span></span></span><br><span><var>IM</var><span class="hyp-type"><b>: </b><span>index ‚Üí VLSM message</span></span></span><br><span><var>constraint</var><span class="hyp-type"><b>: </b><span>composite_label IM
‚Üí composite_state IM * option message
  ‚Üí <span class="kt">Prop</span></span></span></span><br><span><var>X</var><span><span class="hyp-body"><b>:= </b><span>composite_vlsm IM constraint</span></span><span class="hyp-type"><b>: </b><span>VLSM message</span></span></span></span><br><span><var>Hempty_index</var><span class="hyp-type"><b>: </b><span>enum index = []</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="kr">‚àÄ</span> <span class="nv">m</span> : message, ¬¨ composite_initial_message_prop IM m</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="Composition-v-chk231" style="display: none" type="checkbox"><label class="alectryon-input" for="Composition-v-chk231"><span class="kn">Proof</span>.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>message, index</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>EqDecision0</var><span class="hyp-type"><b>: </b><span>EqDecision index</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>finite.Finite index</span></span></span><br><span><var>IM</var><span class="hyp-type"><b>: </b><span>index ‚Üí VLSM message</span></span></span><br><span><var>constraint</var><span class="hyp-type"><b>: </b><span>composite_label IM
‚Üí composite_state IM * option message
  ‚Üí <span class="kt">Prop</span></span></span></span><br><span><var>X</var><span><span class="hyp-body"><b>:= </b><span>composite_vlsm IM constraint</span></span><span class="hyp-type"><b>: </b><span>VLSM message</span></span></span></span><br><span><var>Hempty_index</var><span class="hyp-type"><b>: </b><span>enum index = []</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="kr">‚àÄ</span> <span class="nv">m</span> : message, ¬¨ composite_initial_message_prop IM m</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="Composition-v-chk232" style="display: none" type="checkbox"><label class="alectryon-input" for="Composition-v-chk232"><span class="nb">intros</span> m [i _].</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>message, index</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>EqDecision0</var><span class="hyp-type"><b>: </b><span>EqDecision index</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>finite.Finite index</span></span></span><br><span><var>IM</var><span class="hyp-type"><b>: </b><span>index ‚Üí VLSM message</span></span></span><br><span><var>constraint</var><span class="hyp-type"><b>: </b><span>composite_label IM
‚Üí composite_state IM * option message
  ‚Üí <span class="kt">Prop</span></span></span></span><br><span><var>X</var><span><span class="hyp-body"><b>:= </b><span>composite_vlsm IM constraint</span></span><span class="hyp-type"><b>: </b><span>VLSM message</span></span></span></span><br><span><var>Hempty_index</var><span class="hyp-type"><b>: </b><span>enum index = []</span></span></span><br><span><var>m</var><span class="hyp-type"><b>: </b><span>message</span></span></span><br><span><var>i</var><span class="hyp-type"><b>: </b><span>index</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="kt">False</span></div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="nb">elim</span> (empty_composition_no_index i).</span><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Qed</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
</span><span class="alectryon-sentence"><input class="alectryon-toggle" id="Composition-v-chk233" style="display: none" type="checkbox"><label class="alectryon-input" for="Composition-v-chk233"><span class="kn">Lemma</span> <span class="nf">empty_composition_no_emit</span>
  : <span class="kr">forall</span> <span class="nv">m</span>, ~ can_emit X m.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>message, index</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>EqDecision0</var><span class="hyp-type"><b>: </b><span>EqDecision index</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>finite.Finite index</span></span></span><br><span><var>IM</var><span class="hyp-type"><b>: </b><span>index ‚Üí VLSM message</span></span></span><br><span><var>constraint</var><span class="hyp-type"><b>: </b><span>composite_label IM
‚Üí composite_state IM * option message
  ‚Üí <span class="kt">Prop</span></span></span></span><br><span><var>X</var><span><span class="hyp-body"><b>:= </b><span>composite_vlsm IM constraint</span></span><span class="hyp-type"><b>: </b><span>VLSM message</span></span></span></span><br><span><var>Hempty_index</var><span class="hyp-type"><b>: </b><span>enum index = []</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="kr">‚àÄ</span> <span class="nv">m</span> : message, ¬¨ can_emit X m</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="Composition-v-chk234" style="display: none" type="checkbox"><label class="alectryon-input" for="Composition-v-chk234"><span class="kn">Proof</span>.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>message, index</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>EqDecision0</var><span class="hyp-type"><b>: </b><span>EqDecision index</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>finite.Finite index</span></span></span><br><span><var>IM</var><span class="hyp-type"><b>: </b><span>index ‚Üí VLSM message</span></span></span><br><span><var>constraint</var><span class="hyp-type"><b>: </b><span>composite_label IM
‚Üí composite_state IM * option message
  ‚Üí <span class="kt">Prop</span></span></span></span><br><span><var>X</var><span><span class="hyp-body"><b>:= </b><span>composite_vlsm IM constraint</span></span><span class="hyp-type"><b>: </b><span>VLSM message</span></span></span></span><br><span><var>Hempty_index</var><span class="hyp-type"><b>: </b><span>enum index = []</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="kr">‚àÄ</span> <span class="nv">m</span> : message, ¬¨ can_emit X m</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><span class="alectryon-input"><span class="nb">intros</span> m [s&#39; [l _]]; <span class="nb">elim</span> (empty_composition_no_label l).</span><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Qed</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
</span><span class="alectryon-sentence"><input class="alectryon-toggle" id="Composition-v-chk235" style="display: none" type="checkbox"><label class="alectryon-input" for="Composition-v-chk235"><span class="kn">Lemma</span> <span class="nf">empty_composition_no_valid_message</span>
  : <span class="kr">forall</span> <span class="nv">m</span>, ~ valid_message_prop X m.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>message, index</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>EqDecision0</var><span class="hyp-type"><b>: </b><span>EqDecision index</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>finite.Finite index</span></span></span><br><span><var>IM</var><span class="hyp-type"><b>: </b><span>index ‚Üí VLSM message</span></span></span><br><span><var>constraint</var><span class="hyp-type"><b>: </b><span>composite_label IM
‚Üí composite_state IM * option message
  ‚Üí <span class="kt">Prop</span></span></span></span><br><span><var>X</var><span><span class="hyp-body"><b>:= </b><span>composite_vlsm IM constraint</span></span><span class="hyp-type"><b>: </b><span>VLSM message</span></span></span></span><br><span><var>Hempty_index</var><span class="hyp-type"><b>: </b><span>enum index = []</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="kr">‚àÄ</span> <span class="nv">m</span> : message, ¬¨ valid_message_prop X m</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="Composition-v-chk236" style="display: none" type="checkbox"><label class="alectryon-input" for="Composition-v-chk236"><span class="kn">Proof</span>.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>message, index</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>EqDecision0</var><span class="hyp-type"><b>: </b><span>EqDecision index</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>finite.Finite index</span></span></span><br><span><var>IM</var><span class="hyp-type"><b>: </b><span>index ‚Üí VLSM message</span></span></span><br><span><var>constraint</var><span class="hyp-type"><b>: </b><span>composite_label IM
‚Üí composite_state IM * option message
  ‚Üí <span class="kt">Prop</span></span></span></span><br><span><var>X</var><span><span class="hyp-body"><b>:= </b><span>composite_vlsm IM constraint</span></span><span class="hyp-type"><b>: </b><span>VLSM message</span></span></span></span><br><span><var>Hempty_index</var><span class="hyp-type"><b>: </b><span>enum index = []</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="kr">‚àÄ</span> <span class="nv">m</span> : message, ¬¨ valid_message_prop X m</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="Composition-v-chk237" style="display: none" type="checkbox"><label class="alectryon-input" for="Composition-v-chk237"><span class="nb">intros</span> m Hm.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>message, index</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>EqDecision0</var><span class="hyp-type"><b>: </b><span>EqDecision index</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>finite.Finite index</span></span></span><br><span><var>IM</var><span class="hyp-type"><b>: </b><span>index ‚Üí VLSM message</span></span></span><br><span><var>constraint</var><span class="hyp-type"><b>: </b><span>composite_label IM
‚Üí composite_state IM * option message
  ‚Üí <span class="kt">Prop</span></span></span></span><br><span><var>X</var><span><span class="hyp-body"><b>:= </b><span>composite_vlsm IM constraint</span></span><span class="hyp-type"><b>: </b><span>VLSM message</span></span></span></span><br><span><var>Hempty_index</var><span class="hyp-type"><b>: </b><span>enum index = []</span></span></span><br><span><var>m</var><span class="hyp-type"><b>: </b><span>message</span></span></span><br><span><var>Hm</var><span class="hyp-type"><b>: </b><span>valid_message_prop X m</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="kt">False</span></div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="Composition-v-chk238" style="display: none" type="checkbox"><label class="alectryon-input" for="Composition-v-chk238"><span class="nb">apply</span> emitted_messages_are_valid_iff <span class="kr">in</span> Hm <span class="kr">as</span> [Hinit | Hemit].</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>message, index</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>EqDecision0</var><span class="hyp-type"><b>: </b><span>EqDecision index</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>finite.Finite index</span></span></span><br><span><var>IM</var><span class="hyp-type"><b>: </b><span>index ‚Üí VLSM message</span></span></span><br><span><var>constraint</var><span class="hyp-type"><b>: </b><span>composite_label IM
‚Üí composite_state IM * option message
  ‚Üí <span class="kt">Prop</span></span></span></span><br><span><var>X</var><span><span class="hyp-body"><b>:= </b><span>composite_vlsm IM constraint</span></span><span class="hyp-type"><b>: </b><span>VLSM message</span></span></span></span><br><span><var>Hempty_index</var><span class="hyp-type"><b>: </b><span>enum index = []</span></span></span><br><span><var>m</var><span class="hyp-type"><b>: </b><span>message</span></span></span><br><span><var>Hinit</var><span class="hyp-type"><b>: </b><span>initial_message_prop m</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="kt">False</span></div></blockquote><div class="alectryon-extra-goals"><input class="alectryon-extra-goal-toggle" id="Composition-v-chk239" style="display: none" type="checkbox"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>message, index</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>EqDecision0</var><span class="hyp-type"><b>: </b><span>EqDecision index</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>finite.Finite index</span></span></span><br><span><var>IM</var><span class="hyp-type"><b>: </b><span>index ‚Üí VLSM message</span></span></span><br><span><var>constraint</var><span class="hyp-type"><b>: </b><span>composite_label IM
‚Üí composite_state IM * option message
  ‚Üí <span class="kt">Prop</span></span></span></span><br><span><var>X</var><span><span class="hyp-body"><b>:= </b><span>composite_vlsm IM constraint</span></span><span class="hyp-type"><b>: </b><span>VLSM message</span></span></span></span><br><span><var>Hempty_index</var><span class="hyp-type"><b>: </b><span>enum index = []</span></span></span><br><span><var>m</var><span class="hyp-type"><b>: </b><span>message</span></span></span><br><span><var>Hemit</var><span class="hyp-type"><b>: </b><span>can_emit X m</span></span></span><br></div><label class="goal-separator" for="Composition-v-chk239"><hr></label><div class="goal-conclusion"><span class="kt">False</span></div></blockquote></div></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="Composition-v-chk23a" style="display: none" type="checkbox"><label class="alectryon-input" for="Composition-v-chk23a">-</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>message, index</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>EqDecision0</var><span class="hyp-type"><b>: </b><span>EqDecision index</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>finite.Finite index</span></span></span><br><span><var>IM</var><span class="hyp-type"><b>: </b><span>index ‚Üí VLSM message</span></span></span><br><span><var>constraint</var><span class="hyp-type"><b>: </b><span>composite_label IM
‚Üí composite_state IM * option message
  ‚Üí <span class="kt">Prop</span></span></span></span><br><span><var>X</var><span><span class="hyp-body"><b>:= </b><span>composite_vlsm IM constraint</span></span><span class="hyp-type"><b>: </b><span>VLSM message</span></span></span></span><br><span><var>Hempty_index</var><span class="hyp-type"><b>: </b><span>enum index = []</span></span></span><br><span><var>m</var><span class="hyp-type"><b>: </b><span>message</span></span></span><br><span><var>Hinit</var><span class="hyp-type"><b>: </b><span>initial_message_prop m</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="kt">False</span></div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="nb">elim</span> (empty_composition_no_initial_message _ Hinit).</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="Composition-v-chk23b" style="display: none" type="checkbox"><label class="alectryon-input" for="Composition-v-chk23b">-</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>message, index</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>EqDecision0</var><span class="hyp-type"><b>: </b><span>EqDecision index</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>finite.Finite index</span></span></span><br><span><var>IM</var><span class="hyp-type"><b>: </b><span>index ‚Üí VLSM message</span></span></span><br><span><var>constraint</var><span class="hyp-type"><b>: </b><span>composite_label IM
‚Üí composite_state IM * option message
  ‚Üí <span class="kt">Prop</span></span></span></span><br><span><var>X</var><span><span class="hyp-body"><b>:= </b><span>composite_vlsm IM constraint</span></span><span class="hyp-type"><b>: </b><span>VLSM message</span></span></span></span><br><span><var>Hempty_index</var><span class="hyp-type"><b>: </b><span>enum index = []</span></span></span><br><span><var>m</var><span class="hyp-type"><b>: </b><span>message</span></span></span><br><span><var>Hemit</var><span class="hyp-type"><b>: </b><span>can_emit X m</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="kt">False</span></div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="nb">elim</span> (empty_composition_no_emit _ Hemit).</span><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Qed</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
</span><span class="alectryon-sentence"><input class="alectryon-toggle" id="Composition-v-chk23c" style="display: none" type="checkbox"><label class="alectryon-input" for="Composition-v-chk23c"><span class="kn">Lemma</span> <span class="nf">pre_loaded_empty_composition_no_emit</span>
  (<span class="nv">seed</span> : message -&gt; <span class="kt">Prop</span>)
  (<span class="nv">PreX</span> := pre_loaded_vlsm X seed)
  : <span class="kr">forall</span> <span class="nv">m</span>, ~ can_emit PreX m.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>message, index</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>EqDecision0</var><span class="hyp-type"><b>: </b><span>EqDecision index</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>finite.Finite index</span></span></span><br><span><var>IM</var><span class="hyp-type"><b>: </b><span>index ‚Üí VLSM message</span></span></span><br><span><var>constraint</var><span class="hyp-type"><b>: </b><span>composite_label IM
‚Üí composite_state IM * option message
  ‚Üí <span class="kt">Prop</span></span></span></span><br><span><var>X</var><span><span class="hyp-body"><b>:= </b><span>composite_vlsm IM constraint</span></span><span class="hyp-type"><b>: </b><span>VLSM message</span></span></span></span><br><span><var>Hempty_index</var><span class="hyp-type"><b>: </b><span>enum index = []</span></span></span><br><span><var>seed</var><span class="hyp-type"><b>: </b><span>message ‚Üí <span class="kt">Prop</span></span></span></span><br><span><var>PreX</var><span><span class="hyp-body"><b>:= </b><span>pre_loaded_vlsm X seed</span></span><span class="hyp-type"><b>: </b><span>VLSM message</span></span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="kr">‚àÄ</span> <span class="nv">m</span> : message, ¬¨ can_emit PreX m</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="Composition-v-chk23d" style="display: none" type="checkbox"><label class="alectryon-input" for="Composition-v-chk23d"><span class="kn">Proof</span>.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>message, index</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>EqDecision0</var><span class="hyp-type"><b>: </b><span>EqDecision index</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>finite.Finite index</span></span></span><br><span><var>IM</var><span class="hyp-type"><b>: </b><span>index ‚Üí VLSM message</span></span></span><br><span><var>constraint</var><span class="hyp-type"><b>: </b><span>composite_label IM
‚Üí composite_state IM * option message
  ‚Üí <span class="kt">Prop</span></span></span></span><br><span><var>X</var><span><span class="hyp-body"><b>:= </b><span>composite_vlsm IM constraint</span></span><span class="hyp-type"><b>: </b><span>VLSM message</span></span></span></span><br><span><var>Hempty_index</var><span class="hyp-type"><b>: </b><span>enum index = []</span></span></span><br><span><var>seed</var><span class="hyp-type"><b>: </b><span>message ‚Üí <span class="kt">Prop</span></span></span></span><br><span><var>PreX</var><span><span class="hyp-body"><b>:= </b><span>pre_loaded_vlsm X seed</span></span><span class="hyp-type"><b>: </b><span>VLSM message</span></span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="kr">‚àÄ</span> <span class="nv">m</span> : message, ¬¨ can_emit PreX m</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><span class="alectryon-input"><span class="nb">intros</span> m [s&#39; [l _]]; <span class="nb">elim</span> (empty_composition_no_label l).</span><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Qed</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
</span><span class="alectryon-sentence"><input class="alectryon-toggle" id="Composition-v-chk23e" style="display: none" type="checkbox"><label class="alectryon-input" for="Composition-v-chk23e"><span class="kn">Lemma</span> <span class="nf">pre_loaded_with_all_empty_composition_no_emit</span>
  : <span class="kr">forall</span> <span class="nv">m</span>, ~ can_emit (pre_loaded_with_all_messages_vlsm X) m.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>message, index</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>EqDecision0</var><span class="hyp-type"><b>: </b><span>EqDecision index</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>finite.Finite index</span></span></span><br><span><var>IM</var><span class="hyp-type"><b>: </b><span>index ‚Üí VLSM message</span></span></span><br><span><var>constraint</var><span class="hyp-type"><b>: </b><span>composite_label IM
‚Üí composite_state IM * option message
  ‚Üí <span class="kt">Prop</span></span></span></span><br><span><var>X</var><span><span class="hyp-body"><b>:= </b><span>composite_vlsm IM constraint</span></span><span class="hyp-type"><b>: </b><span>VLSM message</span></span></span></span><br><span><var>Hempty_index</var><span class="hyp-type"><b>: </b><span>enum index = []</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="kr">‚àÄ</span> <span class="nv">m</span> : message,
  ¬¨ can_emit (pre_loaded_with_all_messages_vlsm X) m</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="Composition-v-chk23f" style="display: none" type="checkbox"><label class="alectryon-input" for="Composition-v-chk23f"><span class="kn">Proof</span>.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>message, index</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>EqDecision0</var><span class="hyp-type"><b>: </b><span>EqDecision index</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>finite.Finite index</span></span></span><br><span><var>IM</var><span class="hyp-type"><b>: </b><span>index ‚Üí VLSM message</span></span></span><br><span><var>constraint</var><span class="hyp-type"><b>: </b><span>composite_label IM
‚Üí composite_state IM * option message
  ‚Üí <span class="kt">Prop</span></span></span></span><br><span><var>X</var><span><span class="hyp-body"><b>:= </b><span>composite_vlsm IM constraint</span></span><span class="hyp-type"><b>: </b><span>VLSM message</span></span></span></span><br><span><var>Hempty_index</var><span class="hyp-type"><b>: </b><span>enum index = []</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="kr">‚àÄ</span> <span class="nv">m</span> : message,
  ¬¨ can_emit (pre_loaded_with_all_messages_vlsm X) m</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><span class="alectryon-input"><span class="nb">intros</span> m [s&#39; [l _]]; <span class="nb">elim</span> (empty_composition_no_label l).</span><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Qed</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
</span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">End</span> <span class="nf">empty_composition_properties</span>.</span></span></pre><div class="doc">
<a id="lab9"></a><h2 class="section">Properties of extensionally-equal indexed compositions</h2>
<div class="paragraph"> </div>

  If two indexed sets of VLSMs are extensionally-equal, then we can establish a
  <span class="inlinecode"><span class="id" title="var">VLSM_full_projection</span></span> between their compositions with subsumable constraints
  (and pre-loaded with the same set of messages).

</div><pre class="alectryon-io highlight"><!-- Generator: Alectryon --><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Section</span> <span class="nf">sec_same_IM_full_projection</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
</span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Context</span>
  {<span class="nv">message</span> : <span class="kt">Type</span>}
  `{EqDecision index}
  (IM1 IM2 : index -&gt; VLSM message)
  (Heq : <span class="kr">forall</span> <span class="nv">i</span>, IM1 i = IM2 i)
  .</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
</span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Definition</span> <span class="nf">same_IM_label_rew</span>
  (<span class="nv">l1</span> : composite_label IM1)
  : composite_label IM2 :=
  existT (projT1 l1) (same_VLSM_label_rew (Heq (projT1 l1)) (projT2 l1)).</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
</span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Definition</span> <span class="nf">same_IM_state_rew</span>
  (<span class="nv">s1</span> : composite_state IM1)
  : composite_state IM2 :=
  <span class="kr">fun</span> <span class="nv">i</span> =&gt; same_VLSM_state_rew (Heq i) (s1 i).</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
</span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Section</span> <span class="nf">pre_loaded_constrained</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
</span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Context</span>
  (<span class="nv">constraint1</span> : composite_label IM1 -&gt; composite_state IM1 * option message -&gt; <span class="kt">Prop</span>)
  (<span class="nv">constraint2</span> : composite_label IM2 -&gt; composite_state IM2 * option message -&gt; <span class="kt">Prop</span>)
  (<span class="nv">constraint_projection</span>
    : <span class="kr">forall</span> <span class="nv">s1</span>, valid_state_prop (pre_loaded_with_all_messages_vlsm (free_composite_vlsm IM1)) s1 -&gt;
      <span class="kr">forall</span> <span class="nv">l1</span> <span class="nv">om</span>, constraint1 l1 (s1,om) -&gt;
    constraint2 (same_IM_label_rew l1) (same_IM_state_rew s1, om))
  (<span class="nv">seed</span> : message -&gt; <span class="kt">Prop</span>)
  .</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
</span><span class="alectryon-sentence"><input class="alectryon-toggle" id="Composition-v-chk240" style="display: none" type="checkbox"><label class="alectryon-input" for="Composition-v-chk240"><span class="kn">Lemma</span> <span class="nf">same_IM_full_projection</span>
  : VLSM_full_projection
    (pre_loaded_vlsm (composite_vlsm IM1 constraint1) seed)
    (pre_loaded_vlsm (composite_vlsm IM2 constraint2) seed)
    same_IM_label_rew
    same_IM_state_rew.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>message, index</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>EqDecision0</var><span class="hyp-type"><b>: </b><span>EqDecision index</span></span></span><br><span><var>IM1, IM2</var><span class="hyp-type"><b>: </b><span>index ‚Üí VLSM message</span></span></span><br><span><var>Heq</var><span class="hyp-type"><b>: </b><span><span class="kr">‚àÄ</span> <span class="nv">i</span> : index, IM1 i = IM2 i</span></span></span><br><span><var>constraint1</var><span class="hyp-type"><b>: </b><span>composite_label IM1
‚Üí composite_state IM1 * option message
  ‚Üí <span class="kt">Prop</span></span></span></span><br><span><var>constraint2</var><span class="hyp-type"><b>: </b><span>composite_label IM2
‚Üí composite_state IM2 * option message
  ‚Üí <span class="kt">Prop</span></span></span></span><br><span><var>constraint_projection</var><span class="hyp-type"><b>: </b><span><span class="kr">‚àÄ</span> <span class="nv">s1</span> : state,
  valid_state_prop
    (pre_loaded_with_all_messages_vlsm
       (free_composite_vlsm
          IM1)) s1
  ‚Üí <span class="kr">‚àÄ</span> (<span class="nv">l1</span> : composite_label
              IM1) (<span class="nv">om</span> : 
                    option
                      message),
      constraint1 l1 (s1, om)
      ‚Üí constraint2
          (same_IM_label_rew
             l1)
          (same_IM_state_rew
             s1, om)</span></span></span><br><span><var>seed</var><span class="hyp-type"><b>: </b><span>message ‚Üí <span class="kt">Prop</span></span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">VLSM_full_projection
  (pre_loaded_vlsm (composite_vlsm IM1 constraint1)
     seed)
  (pre_loaded_vlsm (composite_vlsm IM2 constraint2)
     seed) same_IM_label_rew same_IM_state_rew</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="Composition-v-chk241" style="display: none" type="checkbox"><label class="alectryon-input" for="Composition-v-chk241"><span class="kn">Proof</span>.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>message, index</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>EqDecision0</var><span class="hyp-type"><b>: </b><span>EqDecision index</span></span></span><br><span><var>IM1, IM2</var><span class="hyp-type"><b>: </b><span>index ‚Üí VLSM message</span></span></span><br><span><var>Heq</var><span class="hyp-type"><b>: </b><span><span class="kr">‚àÄ</span> <span class="nv">i</span> : index, IM1 i = IM2 i</span></span></span><br><span><var>constraint1</var><span class="hyp-type"><b>: </b><span>composite_label IM1
‚Üí composite_state IM1 * option message
  ‚Üí <span class="kt">Prop</span></span></span></span><br><span><var>constraint2</var><span class="hyp-type"><b>: </b><span>composite_label IM2
‚Üí composite_state IM2 * option message
  ‚Üí <span class="kt">Prop</span></span></span></span><br><span><var>constraint_projection</var><span class="hyp-type"><b>: </b><span><span class="kr">‚àÄ</span> <span class="nv">s1</span> : state,
  valid_state_prop
    (pre_loaded_with_all_messages_vlsm
       (free_composite_vlsm
          IM1)) s1
  ‚Üí <span class="kr">‚àÄ</span> (<span class="nv">l1</span> : composite_label
              IM1) (<span class="nv">om</span> : 
                    option
                      message),
      constraint1 l1 (s1, om)
      ‚Üí constraint2
          (same_IM_label_rew
             l1)
          (same_IM_state_rew
             s1, om)</span></span></span><br><span><var>seed</var><span class="hyp-type"><b>: </b><span>message ‚Üí <span class="kt">Prop</span></span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">VLSM_full_projection
  (pre_loaded_vlsm (composite_vlsm IM1 constraint1)
     seed)
  (pre_loaded_vlsm (composite_vlsm IM2 constraint2)
     seed) same_IM_label_rew same_IM_state_rew</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="Composition-v-chk242" style="display: none" type="checkbox"><label class="alectryon-input" for="Composition-v-chk242"><span class="nb">apply</span> basic_VLSM_full_projection; <span class="nb">intros</span> l **.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>message, index</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>EqDecision0</var><span class="hyp-type"><b>: </b><span>EqDecision index</span></span></span><br><span><var>IM1, IM2</var><span class="hyp-type"><b>: </b><span>index ‚Üí VLSM message</span></span></span><br><span><var>Heq</var><span class="hyp-type"><b>: </b><span><span class="kr">‚àÄ</span> <span class="nv">i</span> : index, IM1 i = IM2 i</span></span></span><br><span><var>constraint1</var><span class="hyp-type"><b>: </b><span>composite_label IM1
‚Üí composite_state IM1 * option message
  ‚Üí <span class="kt">Prop</span></span></span></span><br><span><var>constraint2</var><span class="hyp-type"><b>: </b><span>composite_label IM2
‚Üí composite_state IM2 * option message
  ‚Üí <span class="kt">Prop</span></span></span></span><br><span><var>constraint_projection</var><span class="hyp-type"><b>: </b><span><span class="kr">‚àÄ</span> <span class="nv">s1</span> : state,
  valid_state_prop
    (pre_loaded_with_all_messages_vlsm
       (free_composite_vlsm
          IM1)) s1
  ‚Üí <span class="kr">‚àÄ</span> (<span class="nv">l1</span> : composite_label
              IM1) (<span class="nv">om</span> : 
                    option
                      message),
      constraint1 l1 (s1, om)
      ‚Üí constraint2
          (same_IM_label_rew
             l1)
          (same_IM_state_rew
             s1, om)</span></span></span><br><span><var>seed</var><span class="hyp-type"><b>: </b><span>message ‚Üí <span class="kt">Prop</span></span></span></span><br><span><var>l</var><span class="hyp-type"><b>: </b><span>label</span></span></span><br><span><var>s</var><span class="hyp-type"><b>: </b><span>state</span></span></span><br><span><var>om</var><span class="hyp-type"><b>: </b><span>option message</span></span></span><br><span><var>Hv</var><span class="hyp-type"><b>: </b><span>input_valid
  (pre_loaded_vlsm
     (composite_vlsm IM1 constraint1) seed) l
  (s, om)</span></span></span><br><span><var>HsY</var><span class="hyp-type"><b>: </b><span>valid_state_prop
  (pre_loaded_vlsm
     (composite_vlsm IM2 constraint2) seed)
  (same_IM_state_rew s)</span></span></span><br><span><var>HomY</var><span class="hyp-type"><b>: </b><span>option_valid_message_prop
  (pre_loaded_vlsm
     (composite_vlsm IM2 constraint2) seed) om</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">vvalid
  (pre_loaded_vlsm (composite_vlsm IM2 constraint2)
     seed) (same_IM_label_rew l)
  (same_IM_state_rew s, om)</div></blockquote><div class="alectryon-extra-goals"><input class="alectryon-extra-goal-toggle" id="Composition-v-chk243" style="display: none" type="checkbox"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>message, index</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>EqDecision0</var><span class="hyp-type"><b>: </b><span>EqDecision index</span></span></span><br><span><var>IM1, IM2</var><span class="hyp-type"><b>: </b><span>index ‚Üí VLSM message</span></span></span><br><span><var>Heq</var><span class="hyp-type"><b>: </b><span><span class="kr">‚àÄ</span> <span class="nv">i</span> : index, IM1 i = IM2 i</span></span></span><br><span><var>constraint1</var><span class="hyp-type"><b>: </b><span>composite_label IM1
‚Üí composite_state IM1 * option message
  ‚Üí <span class="kt">Prop</span></span></span></span><br><span><var>constraint2</var><span class="hyp-type"><b>: </b><span>composite_label IM2
‚Üí composite_state IM2 * option message
  ‚Üí <span class="kt">Prop</span></span></span></span><br><span><var>constraint_projection</var><span class="hyp-type"><b>: </b><span><span class="kr">‚àÄ</span> <span class="nv">s1</span> : state,
  valid_state_prop
    (pre_loaded_with_all_messages_vlsm
       (free_composite_vlsm
          IM1)) s1
  ‚Üí <span class="kr">‚àÄ</span> (<span class="nv">l1</span> : composite_label
              IM1) (<span class="nv">om</span> : 
                    option
                      message),
      constraint1 l1 (s1, om)
      ‚Üí constraint2
          (same_IM_label_rew
             l1)
          (same_IM_state_rew
             s1, om)</span></span></span><br><span><var>seed</var><span class="hyp-type"><b>: </b><span>message ‚Üí <span class="kt">Prop</span></span></span></span><br><span><var>l</var><span class="hyp-type"><b>: </b><span>label</span></span></span><br><span><var>s</var><span class="hyp-type"><b>: </b><span>state</span></span></span><br><span><var>om</var><span class="hyp-type"><b>: </b><span>option message</span></span></span><br><span><var>s'</var><span class="hyp-type"><b>: </b><span>state</span></span></span><br><span><var>om'</var><span class="hyp-type"><b>: </b><span>option message</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>input_valid_transition
  (pre_loaded_vlsm
     (composite_vlsm IM1 constraint1) seed) l
  (s, om) (s&#39;, om&#39;)</span></span></span><br></div><label class="goal-separator" for="Composition-v-chk243"><hr></label><div class="goal-conclusion">vtransition
  (pre_loaded_vlsm (composite_vlsm IM2 constraint2)
     seed) (same_IM_label_rew l)
  (same_IM_state_rew s, om) =
(same_IM_state_rew s&#39;, om&#39;)</div></blockquote><input class="alectryon-extra-goal-toggle" id="Composition-v-chk244" style="display: none" type="checkbox"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>message, index</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>EqDecision0</var><span class="hyp-type"><b>: </b><span>EqDecision index</span></span></span><br><span><var>IM1, IM2</var><span class="hyp-type"><b>: </b><span>index ‚Üí VLSM message</span></span></span><br><span><var>Heq</var><span class="hyp-type"><b>: </b><span><span class="kr">‚àÄ</span> <span class="nv">i</span> : index, IM1 i = IM2 i</span></span></span><br><span><var>constraint1</var><span class="hyp-type"><b>: </b><span>composite_label IM1
‚Üí composite_state IM1 * option message
  ‚Üí <span class="kt">Prop</span></span></span></span><br><span><var>constraint2</var><span class="hyp-type"><b>: </b><span>composite_label IM2
‚Üí composite_state IM2 * option message
  ‚Üí <span class="kt">Prop</span></span></span></span><br><span><var>constraint_projection</var><span class="hyp-type"><b>: </b><span><span class="kr">‚àÄ</span> <span class="nv">s1</span> : state,
  valid_state_prop
    (pre_loaded_with_all_messages_vlsm
       (free_composite_vlsm
          IM1)) s1
  ‚Üí <span class="kr">‚àÄ</span> (<span class="nv">l1</span> : composite_label
              IM1) (<span class="nv">om</span> : 
                    option
                      message),
      constraint1 l1 (s1, om)
      ‚Üí constraint2
          (same_IM_label_rew
             l1)
          (same_IM_state_rew
             s1, om)</span></span></span><br><span><var>seed</var><span class="hyp-type"><b>: </b><span>message ‚Üí <span class="kt">Prop</span></span></span></span><br><span><var>l</var><span class="hyp-type"><b>: </b><span>state</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>vinitial_state_prop
  (pre_loaded_vlsm
     (composite_vlsm IM1 constraint1) seed) l</span></span></span><br></div><label class="goal-separator" for="Composition-v-chk244"><hr></label><div class="goal-conclusion">vinitial_state_prop
  (pre_loaded_vlsm (composite_vlsm IM2 constraint2)
     seed) (same_IM_state_rew l)</div></blockquote><input class="alectryon-extra-goal-toggle" id="Composition-v-chk245" style="display: none" type="checkbox"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>message, index</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>EqDecision0</var><span class="hyp-type"><b>: </b><span>EqDecision index</span></span></span><br><span><var>IM1, IM2</var><span class="hyp-type"><b>: </b><span>index ‚Üí VLSM message</span></span></span><br><span><var>Heq</var><span class="hyp-type"><b>: </b><span><span class="kr">‚àÄ</span> <span class="nv">i</span> : index, IM1 i = IM2 i</span></span></span><br><span><var>constraint1</var><span class="hyp-type"><b>: </b><span>composite_label IM1
‚Üí composite_state IM1 * option message
  ‚Üí <span class="kt">Prop</span></span></span></span><br><span><var>constraint2</var><span class="hyp-type"><b>: </b><span>composite_label IM2
‚Üí composite_state IM2 * option message
  ‚Üí <span class="kt">Prop</span></span></span></span><br><span><var>constraint_projection</var><span class="hyp-type"><b>: </b><span><span class="kr">‚àÄ</span> <span class="nv">s1</span> : state,
  valid_state_prop
    (pre_loaded_with_all_messages_vlsm
       (free_composite_vlsm
          IM1)) s1
  ‚Üí <span class="kr">‚àÄ</span> (<span class="nv">l1</span> : composite_label
              IM1) (<span class="nv">om</span> : 
                    option
                      message),
      constraint1 l1 (s1, om)
      ‚Üí constraint2
          (same_IM_label_rew
             l1)
          (same_IM_state_rew
             s1, om)</span></span></span><br><span><var>seed</var><span class="hyp-type"><b>: </b><span>message ‚Üí <span class="kt">Prop</span></span></span></span><br><span><var>l</var><span class="hyp-type"><b>: </b><span>label</span></span></span><br><span><var>s</var><span class="hyp-type"><b>: </b><span>state</span></span></span><br><span><var>m</var><span class="hyp-type"><b>: </b><span>message</span></span></span><br><span><var>Hv</var><span class="hyp-type"><b>: </b><span>input_valid
  (pre_loaded_vlsm
     (composite_vlsm IM1 constraint1) seed) l
  (s, Some m)</span></span></span><br><span><var>HsY</var><span class="hyp-type"><b>: </b><span>valid_state_prop
  (pre_loaded_vlsm
     (composite_vlsm IM2 constraint2) seed)
  (same_IM_state_rew s)</span></span></span><br><span><var>HmX</var><span class="hyp-type"><b>: </b><span>vinitial_message_prop
  (pre_loaded_vlsm
     (composite_vlsm IM1 constraint1) seed) m</span></span></span><br></div><label class="goal-separator" for="Composition-v-chk245"><hr></label><div class="goal-conclusion">valid_message_prop
  (pre_loaded_vlsm (composite_vlsm IM2 constraint2)
     seed) m</div></blockquote></div></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="Composition-v-chk246" style="display: none" type="checkbox"><label class="alectryon-input" for="Composition-v-chk246">-</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>message, index</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>EqDecision0</var><span class="hyp-type"><b>: </b><span>EqDecision index</span></span></span><br><span><var>IM1, IM2</var><span class="hyp-type"><b>: </b><span>index ‚Üí VLSM message</span></span></span><br><span><var>Heq</var><span class="hyp-type"><b>: </b><span><span class="kr">‚àÄ</span> <span class="nv">i</span> : index, IM1 i = IM2 i</span></span></span><br><span><var>constraint1</var><span class="hyp-type"><b>: </b><span>composite_label IM1
‚Üí composite_state IM1 * option message
  ‚Üí <span class="kt">Prop</span></span></span></span><br><span><var>constraint2</var><span class="hyp-type"><b>: </b><span>composite_label IM2
‚Üí composite_state IM2 * option message
  ‚Üí <span class="kt">Prop</span></span></span></span><br><span><var>constraint_projection</var><span class="hyp-type"><b>: </b><span><span class="kr">‚àÄ</span> <span class="nv">s1</span> : state,
  valid_state_prop
    (pre_loaded_with_all_messages_vlsm
       (free_composite_vlsm
          IM1)) s1
  ‚Üí <span class="kr">‚àÄ</span> (<span class="nv">l1</span> : composite_label
              IM1) (<span class="nv">om</span> : 
                    option
                      message),
      constraint1 l1 (s1, om)
      ‚Üí constraint2
          (same_IM_label_rew
             l1)
          (same_IM_state_rew
             s1, om)</span></span></span><br><span><var>seed</var><span class="hyp-type"><b>: </b><span>message ‚Üí <span class="kt">Prop</span></span></span></span><br><span><var>l</var><span class="hyp-type"><b>: </b><span>label</span></span></span><br><span><var>s</var><span class="hyp-type"><b>: </b><span>state</span></span></span><br><span><var>om</var><span class="hyp-type"><b>: </b><span>option message</span></span></span><br><span><var>Hv</var><span class="hyp-type"><b>: </b><span>input_valid
  (pre_loaded_vlsm
     (composite_vlsm IM1 constraint1) seed) l
  (s, om)</span></span></span><br><span><var>HsY</var><span class="hyp-type"><b>: </b><span>valid_state_prop
  (pre_loaded_vlsm
     (composite_vlsm IM2 constraint2) seed)
  (same_IM_state_rew s)</span></span></span><br><span><var>HomY</var><span class="hyp-type"><b>: </b><span>option_valid_message_prop
  (pre_loaded_vlsm
     (composite_vlsm IM2 constraint2) seed) om</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">vvalid
  (pre_loaded_vlsm (composite_vlsm IM2 constraint2)
     seed) (same_IM_label_rew l)
  (same_IM_state_rew s, om)</div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="Composition-v-chk247" style="display: none" type="checkbox"><label class="alectryon-input" for="Composition-v-chk247"><span class="nb">destruct</span> Hv <span class="kr">as</span> [Hs [Hom [Hv Hc]]].</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>message, index</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>EqDecision0</var><span class="hyp-type"><b>: </b><span>EqDecision index</span></span></span><br><span><var>IM1, IM2</var><span class="hyp-type"><b>: </b><span>index ‚Üí VLSM message</span></span></span><br><span><var>Heq</var><span class="hyp-type"><b>: </b><span><span class="kr">‚àÄ</span> <span class="nv">i</span> : index, IM1 i = IM2 i</span></span></span><br><span><var>constraint1</var><span class="hyp-type"><b>: </b><span>composite_label IM1
‚Üí composite_state IM1 * option message
  ‚Üí <span class="kt">Prop</span></span></span></span><br><span><var>constraint2</var><span class="hyp-type"><b>: </b><span>composite_label IM2
‚Üí composite_state IM2 * option message
  ‚Üí <span class="kt">Prop</span></span></span></span><br><span><var>constraint_projection</var><span class="hyp-type"><b>: </b><span><span class="kr">‚àÄ</span> <span class="nv">s1</span> : state,
  valid_state_prop
    (pre_loaded_with_all_messages_vlsm
       (free_composite_vlsm
          IM1)) s1
  ‚Üí <span class="kr">‚àÄ</span> (<span class="nv">l1</span> : composite_label
              IM1) (<span class="nv">om</span> : 
                    option
                      message),
      constraint1 l1 (s1, om)
      ‚Üí constraint2
          (same_IM_label_rew
             l1)
          (same_IM_state_rew
             s1, om)</span></span></span><br><span><var>seed</var><span class="hyp-type"><b>: </b><span>message ‚Üí <span class="kt">Prop</span></span></span></span><br><span><var>l</var><span class="hyp-type"><b>: </b><span>label</span></span></span><br><span><var>s</var><span class="hyp-type"><b>: </b><span>state</span></span></span><br><span><var>om</var><span class="hyp-type"><b>: </b><span>option message</span></span></span><br><span><var>Hs</var><span class="hyp-type"><b>: </b><span>valid_state_prop
  (pre_loaded_vlsm
     (composite_vlsm IM1 constraint1) seed) s</span></span></span><br><span><var>Hom</var><span class="hyp-type"><b>: </b><span>option_valid_message_prop
  (pre_loaded_vlsm
     (composite_vlsm IM1 constraint1) seed) om</span></span></span><br><span><var>Hv</var><span class="hyp-type"><b>: </b><span>composite_valid IM1 l (s, om)</span></span></span><br><span><var>Hc</var><span class="hyp-type"><b>: </b><span>constraint1 l (s, om)</span></span></span><br><span><var>HsY</var><span class="hyp-type"><b>: </b><span>valid_state_prop
  (pre_loaded_vlsm
     (composite_vlsm IM2 constraint2) seed)
  (same_IM_state_rew s)</span></span></span><br><span><var>HomY</var><span class="hyp-type"><b>: </b><span>option_valid_message_prop
  (pre_loaded_vlsm
     (composite_vlsm IM2 constraint2) seed) om</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">vvalid
  (pre_loaded_vlsm (composite_vlsm IM2 constraint2)
     seed) (same_IM_label_rew l)
  (same_IM_state_rew s, om)</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="Composition-v-chk248" style="display: none" type="checkbox"><label class="alectryon-input" for="Composition-v-chk248"><span class="nb">apply</span> constraint_projection <span class="kr">in</span> Hc; <span class="nb">cycle</span> <span class="mi">1</span>.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>message, index</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>EqDecision0</var><span class="hyp-type"><b>: </b><span>EqDecision index</span></span></span><br><span><var>IM1, IM2</var><span class="hyp-type"><b>: </b><span>index ‚Üí VLSM message</span></span></span><br><span><var>Heq</var><span class="hyp-type"><b>: </b><span><span class="kr">‚àÄ</span> <span class="nv">i</span> : index, IM1 i = IM2 i</span></span></span><br><span><var>constraint1</var><span class="hyp-type"><b>: </b><span>composite_label IM1
‚Üí composite_state IM1 * option message
  ‚Üí <span class="kt">Prop</span></span></span></span><br><span><var>constraint2</var><span class="hyp-type"><b>: </b><span>composite_label IM2
‚Üí composite_state IM2 * option message
  ‚Üí <span class="kt">Prop</span></span></span></span><br><span><var>constraint_projection</var><span class="hyp-type"><b>: </b><span><span class="kr">‚àÄ</span> <span class="nv">s1</span> : state,
  valid_state_prop
    (pre_loaded_with_all_messages_vlsm
       (free_composite_vlsm
          IM1)) s1
  ‚Üí <span class="kr">‚àÄ</span> (<span class="nv">l1</span> : composite_label
              IM1) (<span class="nv">om</span> : 
                    option
                      message),
      constraint1 l1 (s1, om)
      ‚Üí constraint2
          (same_IM_label_rew
             l1)
          (same_IM_state_rew
             s1, om)</span></span></span><br><span><var>seed</var><span class="hyp-type"><b>: </b><span>message ‚Üí <span class="kt">Prop</span></span></span></span><br><span><var>l</var><span class="hyp-type"><b>: </b><span>label</span></span></span><br><span><var>s</var><span class="hyp-type"><b>: </b><span>state</span></span></span><br><span><var>om</var><span class="hyp-type"><b>: </b><span>option message</span></span></span><br><span><var>Hs</var><span class="hyp-type"><b>: </b><span>valid_state_prop
  (pre_loaded_vlsm
     (composite_vlsm IM1 constraint1) seed) s</span></span></span><br><span><var>Hom</var><span class="hyp-type"><b>: </b><span>option_valid_message_prop
  (pre_loaded_vlsm
     (composite_vlsm IM1 constraint1) seed) om</span></span></span><br><span><var>Hv</var><span class="hyp-type"><b>: </b><span>composite_valid IM1 l (s, om)</span></span></span><br><span><var>Hc</var><span class="hyp-type"><b>: </b><span>constraint1 l (s, om)</span></span></span><br><span><var>HsY</var><span class="hyp-type"><b>: </b><span>valid_state_prop
  (pre_loaded_vlsm
     (composite_vlsm IM2 constraint2) seed)
  (same_IM_state_rew s)</span></span></span><br><span><var>HomY</var><span class="hyp-type"><b>: </b><span>option_valid_message_prop
  (pre_loaded_vlsm
     (composite_vlsm IM2 constraint2) seed) om</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">valid_state_prop
  (pre_loaded_with_all_messages_vlsm
     (free_composite_vlsm IM1)) s</div></blockquote><div class="alectryon-extra-goals"><input class="alectryon-extra-goal-toggle" id="Composition-v-chk249" style="display: none" type="checkbox"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>message, index</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>EqDecision0</var><span class="hyp-type"><b>: </b><span>EqDecision index</span></span></span><br><span><var>IM1, IM2</var><span class="hyp-type"><b>: </b><span>index ‚Üí VLSM message</span></span></span><br><span><var>Heq</var><span class="hyp-type"><b>: </b><span><span class="kr">‚àÄ</span> <span class="nv">i</span> : index, IM1 i = IM2 i</span></span></span><br><span><var>constraint1</var><span class="hyp-type"><b>: </b><span>composite_label IM1
‚Üí composite_state IM1 * option message
  ‚Üí <span class="kt">Prop</span></span></span></span><br><span><var>constraint2</var><span class="hyp-type"><b>: </b><span>composite_label IM2
‚Üí composite_state IM2 * option message
  ‚Üí <span class="kt">Prop</span></span></span></span><br><span><var>constraint_projection</var><span class="hyp-type"><b>: </b><span><span class="kr">‚àÄ</span> <span class="nv">s1</span> : state,
  valid_state_prop
    (pre_loaded_with_all_messages_vlsm
       (free_composite_vlsm
          IM1)) s1
  ‚Üí <span class="kr">‚àÄ</span> (<span class="nv">l1</span> : composite_label
              IM1) (<span class="nv">om</span> : 
                    option
                      message),
      constraint1 l1 (s1, om)
      ‚Üí constraint2
          (same_IM_label_rew
             l1)
          (same_IM_state_rew
             s1, om)</span></span></span><br><span><var>seed</var><span class="hyp-type"><b>: </b><span>message ‚Üí <span class="kt">Prop</span></span></span></span><br><span><var>l</var><span class="hyp-type"><b>: </b><span>label</span></span></span><br><span><var>s</var><span class="hyp-type"><b>: </b><span>state</span></span></span><br><span><var>om</var><span class="hyp-type"><b>: </b><span>option message</span></span></span><br><span><var>Hs</var><span class="hyp-type"><b>: </b><span>valid_state_prop
  (pre_loaded_vlsm
     (composite_vlsm IM1 constraint1) seed) s</span></span></span><br><span><var>Hom</var><span class="hyp-type"><b>: </b><span>option_valid_message_prop
  (pre_loaded_vlsm
     (composite_vlsm IM1 constraint1) seed) om</span></span></span><br><span><var>Hv</var><span class="hyp-type"><b>: </b><span>composite_valid IM1 l (s, om)</span></span></span><br><span><var>Hc</var><span class="hyp-type"><b>: </b><span>constraint2 (same_IM_label_rew l)
  (same_IM_state_rew s, om)</span></span></span><br><span><var>HsY</var><span class="hyp-type"><b>: </b><span>valid_state_prop
  (pre_loaded_vlsm
     (composite_vlsm IM2 constraint2) seed)
  (same_IM_state_rew s)</span></span></span><br><span><var>HomY</var><span class="hyp-type"><b>: </b><span>option_valid_message_prop
  (pre_loaded_vlsm
     (composite_vlsm IM2 constraint2) seed) om</span></span></span><br></div><label class="goal-separator" for="Composition-v-chk249"><hr></label><div class="goal-conclusion">vvalid
  (pre_loaded_vlsm (composite_vlsm IM2 constraint2)
     seed) (same_IM_label_rew l)
  (same_IM_state_rew s, om)</div></blockquote></div></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="Composition-v-chk24a" style="display: none" type="checkbox"><label class="alectryon-input" for="Composition-v-chk24a">+</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>message, index</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>EqDecision0</var><span class="hyp-type"><b>: </b><span>EqDecision index</span></span></span><br><span><var>IM1, IM2</var><span class="hyp-type"><b>: </b><span>index ‚Üí VLSM message</span></span></span><br><span><var>Heq</var><span class="hyp-type"><b>: </b><span><span class="kr">‚àÄ</span> <span class="nv">i</span> : index, IM1 i = IM2 i</span></span></span><br><span><var>constraint1</var><span class="hyp-type"><b>: </b><span>composite_label IM1
‚Üí composite_state IM1 * option message
  ‚Üí <span class="kt">Prop</span></span></span></span><br><span><var>constraint2</var><span class="hyp-type"><b>: </b><span>composite_label IM2
‚Üí composite_state IM2 * option message
  ‚Üí <span class="kt">Prop</span></span></span></span><br><span><var>constraint_projection</var><span class="hyp-type"><b>: </b><span><span class="kr">‚àÄ</span> <span class="nv">s1</span> : state,
  valid_state_prop
    (pre_loaded_with_all_messages_vlsm
       (free_composite_vlsm
          IM1)) s1
  ‚Üí <span class="kr">‚àÄ</span> (<span class="nv">l1</span> : composite_label
              IM1) (<span class="nv">om</span> : 
                    option
                      message),
      constraint1 l1 (s1, om)
      ‚Üí constraint2
          (same_IM_label_rew
             l1)
          (same_IM_state_rew
             s1, om)</span></span></span><br><span><var>seed</var><span class="hyp-type"><b>: </b><span>message ‚Üí <span class="kt">Prop</span></span></span></span><br><span><var>l</var><span class="hyp-type"><b>: </b><span>label</span></span></span><br><span><var>s</var><span class="hyp-type"><b>: </b><span>state</span></span></span><br><span><var>om</var><span class="hyp-type"><b>: </b><span>option message</span></span></span><br><span><var>Hs</var><span class="hyp-type"><b>: </b><span>valid_state_prop
  (pre_loaded_vlsm
     (composite_vlsm IM1 constraint1) seed) s</span></span></span><br><span><var>Hom</var><span class="hyp-type"><b>: </b><span>option_valid_message_prop
  (pre_loaded_vlsm
     (composite_vlsm IM1 constraint1) seed) om</span></span></span><br><span><var>Hv</var><span class="hyp-type"><b>: </b><span>composite_valid IM1 l (s, om)</span></span></span><br><span><var>Hc</var><span class="hyp-type"><b>: </b><span>constraint1 l (s, om)</span></span></span><br><span><var>HsY</var><span class="hyp-type"><b>: </b><span>valid_state_prop
  (pre_loaded_vlsm
     (composite_vlsm IM2 constraint2) seed)
  (same_IM_state_rew s)</span></span></span><br><span><var>HomY</var><span class="hyp-type"><b>: </b><span>option_valid_message_prop
  (pre_loaded_vlsm
     (composite_vlsm IM2 constraint2) seed) om</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">valid_state_prop
  (pre_loaded_with_all_messages_vlsm
     (free_composite_vlsm IM1)) s</div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="Composition-v-chk24b" style="display: none" type="checkbox"><label class="alectryon-input" for="Composition-v-chk24b"><span class="nb">apply</span> VLSM_incl_valid_state; [| <span class="bp">done</span>].</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>message, index</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>EqDecision0</var><span class="hyp-type"><b>: </b><span>EqDecision index</span></span></span><br><span><var>IM1, IM2</var><span class="hyp-type"><b>: </b><span>index ‚Üí VLSM message</span></span></span><br><span><var>Heq</var><span class="hyp-type"><b>: </b><span><span class="kr">‚àÄ</span> <span class="nv">i</span> : index, IM1 i = IM2 i</span></span></span><br><span><var>constraint1</var><span class="hyp-type"><b>: </b><span>composite_label IM1
‚Üí composite_state IM1 * option message
  ‚Üí <span class="kt">Prop</span></span></span></span><br><span><var>constraint2</var><span class="hyp-type"><b>: </b><span>composite_label IM2
‚Üí composite_state IM2 * option message
  ‚Üí <span class="kt">Prop</span></span></span></span><br><span><var>constraint_projection</var><span class="hyp-type"><b>: </b><span><span class="kr">‚àÄ</span> <span class="nv">s1</span> : state,
  valid_state_prop
    (pre_loaded_with_all_messages_vlsm
       (free_composite_vlsm
          IM1)) s1
  ‚Üí <span class="kr">‚àÄ</span> (<span class="nv">l1</span> : composite_label
              IM1) (<span class="nv">om</span> : 
                    option
                      message),
      constraint1 l1 (s1, om)
      ‚Üí constraint2
          (same_IM_label_rew
             l1)
          (same_IM_state_rew
             s1, om)</span></span></span><br><span><var>seed</var><span class="hyp-type"><b>: </b><span>message ‚Üí <span class="kt">Prop</span></span></span></span><br><span><var>l</var><span class="hyp-type"><b>: </b><span>label</span></span></span><br><span><var>s</var><span class="hyp-type"><b>: </b><span>state</span></span></span><br><span><var>om</var><span class="hyp-type"><b>: </b><span>option message</span></span></span><br><span><var>Hs</var><span class="hyp-type"><b>: </b><span>valid_state_prop
  (pre_loaded_vlsm
     (composite_vlsm IM1 constraint1) seed) s</span></span></span><br><span><var>Hom</var><span class="hyp-type"><b>: </b><span>option_valid_message_prop
  (pre_loaded_vlsm
     (composite_vlsm IM1 constraint1) seed) om</span></span></span><br><span><var>Hv</var><span class="hyp-type"><b>: </b><span>composite_valid IM1 l (s, om)</span></span></span><br><span><var>Hc</var><span class="hyp-type"><b>: </b><span>constraint1 l (s, om)</span></span></span><br><span><var>HsY</var><span class="hyp-type"><b>: </b><span>valid_state_prop
  (pre_loaded_vlsm
     (composite_vlsm IM2 constraint2) seed)
  (same_IM_state_rew s)</span></span></span><br><span><var>HomY</var><span class="hyp-type"><b>: </b><span>option_valid_message_prop
  (pre_loaded_vlsm
     (composite_vlsm IM2 constraint2) seed) om</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">VLSM_incl_part
  (VLSMMachine_pre_loaded_with_messages
     (vmachine (composite_vlsm IM1 constraint1)) seed)
  (pre_loaded_with_all_messages_vlsm_machine
     (free_composite_vlsm IM1))</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">      </span><span class="alectryon-sentence"><span class="alectryon-input"><span class="nb">apply</span> composite_pre_loaded_vlsm_incl_pre_loaded_with_all_messages.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="Composition-v-chk24c" style="display: none" type="checkbox"><label class="alectryon-input" for="Composition-v-chk24c">+</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>message, index</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>EqDecision0</var><span class="hyp-type"><b>: </b><span>EqDecision index</span></span></span><br><span><var>IM1, IM2</var><span class="hyp-type"><b>: </b><span>index ‚Üí VLSM message</span></span></span><br><span><var>Heq</var><span class="hyp-type"><b>: </b><span><span class="kr">‚àÄ</span> <span class="nv">i</span> : index, IM1 i = IM2 i</span></span></span><br><span><var>constraint1</var><span class="hyp-type"><b>: </b><span>composite_label IM1
‚Üí composite_state IM1 * option message
  ‚Üí <span class="kt">Prop</span></span></span></span><br><span><var>constraint2</var><span class="hyp-type"><b>: </b><span>composite_label IM2
‚Üí composite_state IM2 * option message
  ‚Üí <span class="kt">Prop</span></span></span></span><br><span><var>constraint_projection</var><span class="hyp-type"><b>: </b><span><span class="kr">‚àÄ</span> <span class="nv">s1</span> : state,
  valid_state_prop
    (pre_loaded_with_all_messages_vlsm
       (free_composite_vlsm
          IM1)) s1
  ‚Üí <span class="kr">‚àÄ</span> (<span class="nv">l1</span> : composite_label
              IM1) (<span class="nv">om</span> : 
                    option
                      message),
      constraint1 l1 (s1, om)
      ‚Üí constraint2
          (same_IM_label_rew
             l1)
          (same_IM_state_rew
             s1, om)</span></span></span><br><span><var>seed</var><span class="hyp-type"><b>: </b><span>message ‚Üí <span class="kt">Prop</span></span></span></span><br><span><var>l</var><span class="hyp-type"><b>: </b><span>label</span></span></span><br><span><var>s</var><span class="hyp-type"><b>: </b><span>state</span></span></span><br><span><var>om</var><span class="hyp-type"><b>: </b><span>option message</span></span></span><br><span><var>Hs</var><span class="hyp-type"><b>: </b><span>valid_state_prop
  (pre_loaded_vlsm
     (composite_vlsm IM1 constraint1) seed) s</span></span></span><br><span><var>Hom</var><span class="hyp-type"><b>: </b><span>option_valid_message_prop
  (pre_loaded_vlsm
     (composite_vlsm IM1 constraint1) seed) om</span></span></span><br><span><var>Hv</var><span class="hyp-type"><b>: </b><span>composite_valid IM1 l (s, om)</span></span></span><br><span><var>Hc</var><span class="hyp-type"><b>: </b><span>constraint2 (same_IM_label_rew l)
  (same_IM_state_rew s, om)</span></span></span><br><span><var>HsY</var><span class="hyp-type"><b>: </b><span>valid_state_prop
  (pre_loaded_vlsm
     (composite_vlsm IM2 constraint2) seed)
  (same_IM_state_rew s)</span></span></span><br><span><var>HomY</var><span class="hyp-type"><b>: </b><span>option_valid_message_prop
  (pre_loaded_vlsm
     (composite_vlsm IM2 constraint2) seed) om</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">vvalid
  (pre_loaded_vlsm (composite_vlsm IM2 constraint2)
     seed) (same_IM_label_rew l)
  (same_IM_state_rew s, om)</div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="Composition-v-chk24d" style="display: none" type="checkbox"><label class="alectryon-input" for="Composition-v-chk24d"><span class="nb">split</span>; [| <span class="bp">done</span>].</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>message, index</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>EqDecision0</var><span class="hyp-type"><b>: </b><span>EqDecision index</span></span></span><br><span><var>IM1, IM2</var><span class="hyp-type"><b>: </b><span>index ‚Üí VLSM message</span></span></span><br><span><var>Heq</var><span class="hyp-type"><b>: </b><span><span class="kr">‚àÄ</span> <span class="nv">i</span> : index, IM1 i = IM2 i</span></span></span><br><span><var>constraint1</var><span class="hyp-type"><b>: </b><span>composite_label IM1
‚Üí composite_state IM1 * option message
  ‚Üí <span class="kt">Prop</span></span></span></span><br><span><var>constraint2</var><span class="hyp-type"><b>: </b><span>composite_label IM2
‚Üí composite_state IM2 * option message
  ‚Üí <span class="kt">Prop</span></span></span></span><br><span><var>constraint_projection</var><span class="hyp-type"><b>: </b><span><span class="kr">‚àÄ</span> <span class="nv">s1</span> : state,
  valid_state_prop
    (pre_loaded_with_all_messages_vlsm
       (free_composite_vlsm
          IM1)) s1
  ‚Üí <span class="kr">‚àÄ</span> (<span class="nv">l1</span> : composite_label
              IM1) (<span class="nv">om</span> : 
                    option
                      message),
      constraint1 l1 (s1, om)
      ‚Üí constraint2
          (same_IM_label_rew
             l1)
          (same_IM_state_rew
             s1, om)</span></span></span><br><span><var>seed</var><span class="hyp-type"><b>: </b><span>message ‚Üí <span class="kt">Prop</span></span></span></span><br><span><var>l</var><span class="hyp-type"><b>: </b><span>label</span></span></span><br><span><var>s</var><span class="hyp-type"><b>: </b><span>state</span></span></span><br><span><var>om</var><span class="hyp-type"><b>: </b><span>option message</span></span></span><br><span><var>Hs</var><span class="hyp-type"><b>: </b><span>valid_state_prop
  (pre_loaded_vlsm
     (composite_vlsm IM1 constraint1) seed) s</span></span></span><br><span><var>Hom</var><span class="hyp-type"><b>: </b><span>option_valid_message_prop
  (pre_loaded_vlsm
     (composite_vlsm IM1 constraint1) seed) om</span></span></span><br><span><var>Hv</var><span class="hyp-type"><b>: </b><span>composite_valid IM1 l (s, om)</span></span></span><br><span><var>Hc</var><span class="hyp-type"><b>: </b><span>constraint2 (same_IM_label_rew l)
  (same_IM_state_rew s, om)</span></span></span><br><span><var>HsY</var><span class="hyp-type"><b>: </b><span>valid_state_prop
  (pre_loaded_vlsm
     (composite_vlsm IM2 constraint2) seed)
  (same_IM_state_rew s)</span></span></span><br><span><var>HomY</var><span class="hyp-type"><b>: </b><span>option_valid_message_prop
  (pre_loaded_vlsm
     (composite_vlsm IM2 constraint2) seed) om</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">composite_valid IM2 (same_IM_label_rew l)
  (same_IM_state_rew s, om)</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">      </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="Composition-v-chk24e" style="display: none" type="checkbox"><label class="alectryon-input" for="Composition-v-chk24e"><span class="nb">clear</span> Hc.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>message, index</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>EqDecision0</var><span class="hyp-type"><b>: </b><span>EqDecision index</span></span></span><br><span><var>IM1, IM2</var><span class="hyp-type"><b>: </b><span>index ‚Üí VLSM message</span></span></span><br><span><var>Heq</var><span class="hyp-type"><b>: </b><span><span class="kr">‚àÄ</span> <span class="nv">i</span> : index, IM1 i = IM2 i</span></span></span><br><span><var>constraint1</var><span class="hyp-type"><b>: </b><span>composite_label IM1
‚Üí composite_state IM1 * option message
  ‚Üí <span class="kt">Prop</span></span></span></span><br><span><var>constraint2</var><span class="hyp-type"><b>: </b><span>composite_label IM2
‚Üí composite_state IM2 * option message
  ‚Üí <span class="kt">Prop</span></span></span></span><br><span><var>constraint_projection</var><span class="hyp-type"><b>: </b><span><span class="kr">‚àÄ</span> <span class="nv">s1</span> : state,
  valid_state_prop
    (pre_loaded_with_all_messages_vlsm
       (free_composite_vlsm
          IM1)) s1
  ‚Üí <span class="kr">‚àÄ</span> (<span class="nv">l1</span> : composite_label
              IM1) (<span class="nv">om</span> : 
                    option
                      message),
      constraint1 l1 (s1, om)
      ‚Üí constraint2
          (same_IM_label_rew
             l1)
          (same_IM_state_rew
             s1, om)</span></span></span><br><span><var>seed</var><span class="hyp-type"><b>: </b><span>message ‚Üí <span class="kt">Prop</span></span></span></span><br><span><var>l</var><span class="hyp-type"><b>: </b><span>label</span></span></span><br><span><var>s</var><span class="hyp-type"><b>: </b><span>state</span></span></span><br><span><var>om</var><span class="hyp-type"><b>: </b><span>option message</span></span></span><br><span><var>Hs</var><span class="hyp-type"><b>: </b><span>valid_state_prop
  (pre_loaded_vlsm
     (composite_vlsm IM1 constraint1) seed) s</span></span></span><br><span><var>Hom</var><span class="hyp-type"><b>: </b><span>option_valid_message_prop
  (pre_loaded_vlsm
     (composite_vlsm IM1 constraint1) seed) om</span></span></span><br><span><var>Hv</var><span class="hyp-type"><b>: </b><span>composite_valid IM1 l (s, om)</span></span></span><br><span><var>HsY</var><span class="hyp-type"><b>: </b><span>valid_state_prop
  (pre_loaded_vlsm
     (composite_vlsm IM2 constraint2) seed)
  (same_IM_state_rew s)</span></span></span><br><span><var>HomY</var><span class="hyp-type"><b>: </b><span>option_valid_message_prop
  (pre_loaded_vlsm
     (composite_vlsm IM2 constraint2) seed) om</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">composite_valid IM2 (same_IM_label_rew l)
  (same_IM_state_rew s, om)</div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="Composition-v-chk24f" style="display: none" type="checkbox"><label class="alectryon-input" for="Composition-v-chk24f"><span class="nb">revert</span> Hv.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>message, index</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>EqDecision0</var><span class="hyp-type"><b>: </b><span>EqDecision index</span></span></span><br><span><var>IM1, IM2</var><span class="hyp-type"><b>: </b><span>index ‚Üí VLSM message</span></span></span><br><span><var>Heq</var><span class="hyp-type"><b>: </b><span><span class="kr">‚àÄ</span> <span class="nv">i</span> : index, IM1 i = IM2 i</span></span></span><br><span><var>constraint1</var><span class="hyp-type"><b>: </b><span>composite_label IM1
‚Üí composite_state IM1 * option message
  ‚Üí <span class="kt">Prop</span></span></span></span><br><span><var>constraint2</var><span class="hyp-type"><b>: </b><span>composite_label IM2
‚Üí composite_state IM2 * option message
  ‚Üí <span class="kt">Prop</span></span></span></span><br><span><var>constraint_projection</var><span class="hyp-type"><b>: </b><span><span class="kr">‚àÄ</span> <span class="nv">s1</span> : state,
  valid_state_prop
    (pre_loaded_with_all_messages_vlsm
       (free_composite_vlsm
          IM1)) s1
  ‚Üí <span class="kr">‚àÄ</span> (<span class="nv">l1</span> : composite_label
              IM1) (<span class="nv">om</span> : 
                    option
                      message),
      constraint1 l1 (s1, om)
      ‚Üí constraint2
          (same_IM_label_rew
             l1)
          (same_IM_state_rew
             s1, om)</span></span></span><br><span><var>seed</var><span class="hyp-type"><b>: </b><span>message ‚Üí <span class="kt">Prop</span></span></span></span><br><span><var>l</var><span class="hyp-type"><b>: </b><span>label</span></span></span><br><span><var>s</var><span class="hyp-type"><b>: </b><span>state</span></span></span><br><span><var>om</var><span class="hyp-type"><b>: </b><span>option message</span></span></span><br><span><var>Hs</var><span class="hyp-type"><b>: </b><span>valid_state_prop
  (pre_loaded_vlsm
     (composite_vlsm IM1 constraint1) seed) s</span></span></span><br><span><var>Hom</var><span class="hyp-type"><b>: </b><span>option_valid_message_prop
  (pre_loaded_vlsm
     (composite_vlsm IM1 constraint1) seed) om</span></span></span><br><span><var>HsY</var><span class="hyp-type"><b>: </b><span>valid_state_prop
  (pre_loaded_vlsm
     (composite_vlsm IM2 constraint2) seed)
  (same_IM_state_rew s)</span></span></span><br><span><var>HomY</var><span class="hyp-type"><b>: </b><span>option_valid_message_prop
  (pre_loaded_vlsm
     (composite_vlsm IM2 constraint2) seed) om</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">composite_valid IM1 l (s, om)
‚Üí composite_valid IM2 (same_IM_label_rew l)
    (same_IM_state_rew s, om)</div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="Composition-v-chk250" style="display: none" type="checkbox"><label class="alectryon-input" for="Composition-v-chk250"><span class="nb">destruct</span> l <span class="kr">as</span> (i, li).</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>message, index</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>EqDecision0</var><span class="hyp-type"><b>: </b><span>EqDecision index</span></span></span><br><span><var>IM1, IM2</var><span class="hyp-type"><b>: </b><span>index ‚Üí VLSM message</span></span></span><br><span><var>Heq</var><span class="hyp-type"><b>: </b><span><span class="kr">‚àÄ</span> <span class="nv">i</span> : index, IM1 i = IM2 i</span></span></span><br><span><var>constraint1</var><span class="hyp-type"><b>: </b><span>composite_label IM1
‚Üí composite_state IM1 * option message
  ‚Üí <span class="kt">Prop</span></span></span></span><br><span><var>constraint2</var><span class="hyp-type"><b>: </b><span>composite_label IM2
‚Üí composite_state IM2 * option message
  ‚Üí <span class="kt">Prop</span></span></span></span><br><span><var>constraint_projection</var><span class="hyp-type"><b>: </b><span><span class="kr">‚àÄ</span> <span class="nv">s1</span> : state,
  valid_state_prop
    (pre_loaded_with_all_messages_vlsm
       (free_composite_vlsm
          IM1)) s1
  ‚Üí <span class="kr">‚àÄ</span> (<span class="nv">l1</span> : composite_label
              IM1) (<span class="nv">om</span> : 
                    option
                      message),
      constraint1 l1 (s1, om)
      ‚Üí constraint2
          (same_IM_label_rew
             l1)
          (same_IM_state_rew
             s1, om)</span></span></span><br><span><var>seed</var><span class="hyp-type"><b>: </b><span>message ‚Üí <span class="kt">Prop</span></span></span></span><br><span><var>i</var><span class="hyp-type"><b>: </b><span>index</span></span></span><br><span><var>li</var><span class="hyp-type"><b>: </b><span>vlabel (IM1 i)</span></span></span><br><span><var>s</var><span class="hyp-type"><b>: </b><span>state</span></span></span><br><span><var>om</var><span class="hyp-type"><b>: </b><span>option message</span></span></span><br><span><var>Hs</var><span class="hyp-type"><b>: </b><span>valid_state_prop
  (pre_loaded_vlsm
     (composite_vlsm IM1 constraint1) seed) s</span></span></span><br><span><var>Hom</var><span class="hyp-type"><b>: </b><span>option_valid_message_prop
  (pre_loaded_vlsm
     (composite_vlsm IM1 constraint1) seed) om</span></span></span><br><span><var>HsY</var><span class="hyp-type"><b>: </b><span>valid_state_prop
  (pre_loaded_vlsm
     (composite_vlsm IM2 constraint2) seed)
  (same_IM_state_rew s)</span></span></span><br><span><var>HomY</var><span class="hyp-type"><b>: </b><span>option_valid_message_prop
  (pre_loaded_vlsm
     (composite_vlsm IM2 constraint2) seed) om</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">composite_valid IM1 (existT i li) (s, om)
‚Üí composite_valid IM2
    (same_IM_label_rew (existT i li))
    (same_IM_state_rew s, om)</div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="Composition-v-chk251" style="display: none" type="checkbox"><label class="alectryon-input" for="Composition-v-chk251"><span class="nb">cbn</span>.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>message, index</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>EqDecision0</var><span class="hyp-type"><b>: </b><span>EqDecision index</span></span></span><br><span><var>IM1, IM2</var><span class="hyp-type"><b>: </b><span>index ‚Üí VLSM message</span></span></span><br><span><var>Heq</var><span class="hyp-type"><b>: </b><span><span class="kr">‚àÄ</span> <span class="nv">i</span> : index, IM1 i = IM2 i</span></span></span><br><span><var>constraint1</var><span class="hyp-type"><b>: </b><span>composite_label IM1
‚Üí composite_state IM1 * option message
  ‚Üí <span class="kt">Prop</span></span></span></span><br><span><var>constraint2</var><span class="hyp-type"><b>: </b><span>composite_label IM2
‚Üí composite_state IM2 * option message
  ‚Üí <span class="kt">Prop</span></span></span></span><br><span><var>constraint_projection</var><span class="hyp-type"><b>: </b><span><span class="kr">‚àÄ</span> <span class="nv">s1</span> : state,
  valid_state_prop
    (pre_loaded_with_all_messages_vlsm
       (free_composite_vlsm
          IM1)) s1
  ‚Üí <span class="kr">‚àÄ</span> (<span class="nv">l1</span> : composite_label
              IM1) (<span class="nv">om</span> : 
                    option
                      message),
      constraint1 l1 (s1, om)
      ‚Üí constraint2
          (same_IM_label_rew
             l1)
          (same_IM_state_rew
             s1, om)</span></span></span><br><span><var>seed</var><span class="hyp-type"><b>: </b><span>message ‚Üí <span class="kt">Prop</span></span></span></span><br><span><var>i</var><span class="hyp-type"><b>: </b><span>index</span></span></span><br><span><var>li</var><span class="hyp-type"><b>: </b><span>vlabel (IM1 i)</span></span></span><br><span><var>s</var><span class="hyp-type"><b>: </b><span>state</span></span></span><br><span><var>om</var><span class="hyp-type"><b>: </b><span>option message</span></span></span><br><span><var>Hs</var><span class="hyp-type"><b>: </b><span>valid_state_prop
  (pre_loaded_vlsm
     (composite_vlsm IM1 constraint1) seed) s</span></span></span><br><span><var>Hom</var><span class="hyp-type"><b>: </b><span>option_valid_message_prop
  (pre_loaded_vlsm
     (composite_vlsm IM1 constraint1) seed) om</span></span></span><br><span><var>HsY</var><span class="hyp-type"><b>: </b><span>valid_state_prop
  (pre_loaded_vlsm
     (composite_vlsm IM2 constraint2) seed)
  (same_IM_state_rew s)</span></span></span><br><span><var>HomY</var><span class="hyp-type"><b>: </b><span>option_valid_message_prop
  (pre_loaded_vlsm
     (composite_vlsm IM2 constraint2) seed) om</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">vvalid (IM1 i) li (s i, om)
‚Üí vvalid (IM2 i) (same_VLSM_label_rew (Heq i) li)
    (same_IM_state_rew s i, om)</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">      </span><span class="alectryon-sentence"><span class="alectryon-input"><span class="nb">apply</span> same_VLSM_valid_preservation.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="Composition-v-chk252" style="display: none" type="checkbox"><label class="alectryon-input" for="Composition-v-chk252">-</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>message, index</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>EqDecision0</var><span class="hyp-type"><b>: </b><span>EqDecision index</span></span></span><br><span><var>IM1, IM2</var><span class="hyp-type"><b>: </b><span>index ‚Üí VLSM message</span></span></span><br><span><var>Heq</var><span class="hyp-type"><b>: </b><span><span class="kr">‚àÄ</span> <span class="nv">i</span> : index, IM1 i = IM2 i</span></span></span><br><span><var>constraint1</var><span class="hyp-type"><b>: </b><span>composite_label IM1
‚Üí composite_state IM1 * option message
  ‚Üí <span class="kt">Prop</span></span></span></span><br><span><var>constraint2</var><span class="hyp-type"><b>: </b><span>composite_label IM2
‚Üí composite_state IM2 * option message
  ‚Üí <span class="kt">Prop</span></span></span></span><br><span><var>constraint_projection</var><span class="hyp-type"><b>: </b><span><span class="kr">‚àÄ</span> <span class="nv">s1</span> : state,
  valid_state_prop
    (pre_loaded_with_all_messages_vlsm
       (free_composite_vlsm
          IM1)) s1
  ‚Üí <span class="kr">‚àÄ</span> (<span class="nv">l1</span> : composite_label
              IM1) (<span class="nv">om</span> : 
                    option
                      message),
      constraint1 l1 (s1, om)
      ‚Üí constraint2
          (same_IM_label_rew
             l1)
          (same_IM_state_rew
             s1, om)</span></span></span><br><span><var>seed</var><span class="hyp-type"><b>: </b><span>message ‚Üí <span class="kt">Prop</span></span></span></span><br><span><var>l</var><span class="hyp-type"><b>: </b><span>label</span></span></span><br><span><var>s</var><span class="hyp-type"><b>: </b><span>state</span></span></span><br><span><var>om</var><span class="hyp-type"><b>: </b><span>option message</span></span></span><br><span><var>s'</var><span class="hyp-type"><b>: </b><span>state</span></span></span><br><span><var>om'</var><span class="hyp-type"><b>: </b><span>option message</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>input_valid_transition
  (pre_loaded_vlsm
     (composite_vlsm IM1 constraint1) seed) l
  (s, om) (s&#39;, om&#39;)</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">vtransition
  (pre_loaded_vlsm (composite_vlsm IM2 constraint2)
     seed) (same_IM_label_rew l)
  (same_IM_state_rew s, om) =
(same_IM_state_rew s&#39;, om&#39;)</div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="Composition-v-chk253" style="display: none" type="checkbox"><label class="alectryon-input" for="Composition-v-chk253"><span class="nb">apply</span> proj2 <span class="kr">in</span> H.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>message, index</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>EqDecision0</var><span class="hyp-type"><b>: </b><span>EqDecision index</span></span></span><br><span><var>IM1, IM2</var><span class="hyp-type"><b>: </b><span>index ‚Üí VLSM message</span></span></span><br><span><var>Heq</var><span class="hyp-type"><b>: </b><span><span class="kr">‚àÄ</span> <span class="nv">i</span> : index, IM1 i = IM2 i</span></span></span><br><span><var>constraint1</var><span class="hyp-type"><b>: </b><span>composite_label IM1
‚Üí composite_state IM1 * option message
  ‚Üí <span class="kt">Prop</span></span></span></span><br><span><var>constraint2</var><span class="hyp-type"><b>: </b><span>composite_label IM2
‚Üí composite_state IM2 * option message
  ‚Üí <span class="kt">Prop</span></span></span></span><br><span><var>constraint_projection</var><span class="hyp-type"><b>: </b><span><span class="kr">‚àÄ</span> <span class="nv">s1</span> : state,
  valid_state_prop
    (pre_loaded_with_all_messages_vlsm
       (free_composite_vlsm
          IM1)) s1
  ‚Üí <span class="kr">‚àÄ</span> (<span class="nv">l1</span> : composite_label
              IM1) (<span class="nv">om</span> : 
                    option
                      message),
      constraint1 l1 (s1, om)
      ‚Üí constraint2
          (same_IM_label_rew
             l1)
          (same_IM_state_rew
             s1, om)</span></span></span><br><span><var>seed</var><span class="hyp-type"><b>: </b><span>message ‚Üí <span class="kt">Prop</span></span></span></span><br><span><var>l</var><span class="hyp-type"><b>: </b><span>label</span></span></span><br><span><var>s</var><span class="hyp-type"><b>: </b><span>state</span></span></span><br><span><var>om</var><span class="hyp-type"><b>: </b><span>option message</span></span></span><br><span><var>s'</var><span class="hyp-type"><b>: </b><span>state</span></span></span><br><span><var>om'</var><span class="hyp-type"><b>: </b><span>option message</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>transition l (s, om) = (s&#39;, om&#39;)</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">vtransition
  (pre_loaded_vlsm (composite_vlsm IM2 constraint2)
     seed) (same_IM_label_rew l)
  (same_IM_state_rew s, om) =
(same_IM_state_rew s&#39;, om&#39;)</div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="Composition-v-chk254" style="display: none" type="checkbox"><label class="alectryon-input" for="Composition-v-chk254"><span class="nb">revert</span> H.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>message, index</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>EqDecision0</var><span class="hyp-type"><b>: </b><span>EqDecision index</span></span></span><br><span><var>IM1, IM2</var><span class="hyp-type"><b>: </b><span>index ‚Üí VLSM message</span></span></span><br><span><var>Heq</var><span class="hyp-type"><b>: </b><span><span class="kr">‚àÄ</span> <span class="nv">i</span> : index, IM1 i = IM2 i</span></span></span><br><span><var>constraint1</var><span class="hyp-type"><b>: </b><span>composite_label IM1
‚Üí composite_state IM1 * option message
  ‚Üí <span class="kt">Prop</span></span></span></span><br><span><var>constraint2</var><span class="hyp-type"><b>: </b><span>composite_label IM2
‚Üí composite_state IM2 * option message
  ‚Üí <span class="kt">Prop</span></span></span></span><br><span><var>constraint_projection</var><span class="hyp-type"><b>: </b><span><span class="kr">‚àÄ</span> <span class="nv">s1</span> : state,
  valid_state_prop
    (pre_loaded_with_all_messages_vlsm
       (free_composite_vlsm
          IM1)) s1
  ‚Üí <span class="kr">‚àÄ</span> (<span class="nv">l1</span> : composite_label
              IM1) (<span class="nv">om</span> : 
                    option
                      message),
      constraint1 l1 (s1, om)
      ‚Üí constraint2
          (same_IM_label_rew
             l1)
          (same_IM_state_rew
             s1, om)</span></span></span><br><span><var>seed</var><span class="hyp-type"><b>: </b><span>message ‚Üí <span class="kt">Prop</span></span></span></span><br><span><var>l</var><span class="hyp-type"><b>: </b><span>label</span></span></span><br><span><var>s</var><span class="hyp-type"><b>: </b><span>state</span></span></span><br><span><var>om</var><span class="hyp-type"><b>: </b><span>option message</span></span></span><br><span><var>s'</var><span class="hyp-type"><b>: </b><span>state</span></span></span><br><span><var>om'</var><span class="hyp-type"><b>: </b><span>option message</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">transition l (s, om) = (s&#39;, om&#39;)
‚Üí vtransition
    (pre_loaded_vlsm (composite_vlsm IM2 constraint2)
       seed) (same_IM_label_rew l)
    (same_IM_state_rew s, om) =
  (same_IM_state_rew s&#39;, om&#39;)</div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="Composition-v-chk255" style="display: none" type="checkbox"><label class="alectryon-input" for="Composition-v-chk255"><span class="nb">destruct</span> l <span class="kr">as</span> (i, li).</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>message, index</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>EqDecision0</var><span class="hyp-type"><b>: </b><span>EqDecision index</span></span></span><br><span><var>IM1, IM2</var><span class="hyp-type"><b>: </b><span>index ‚Üí VLSM message</span></span></span><br><span><var>Heq</var><span class="hyp-type"><b>: </b><span><span class="kr">‚àÄ</span> <span class="nv">i</span> : index, IM1 i = IM2 i</span></span></span><br><span><var>constraint1</var><span class="hyp-type"><b>: </b><span>composite_label IM1
‚Üí composite_state IM1 * option message
  ‚Üí <span class="kt">Prop</span></span></span></span><br><span><var>constraint2</var><span class="hyp-type"><b>: </b><span>composite_label IM2
‚Üí composite_state IM2 * option message
  ‚Üí <span class="kt">Prop</span></span></span></span><br><span><var>constraint_projection</var><span class="hyp-type"><b>: </b><span><span class="kr">‚àÄ</span> <span class="nv">s1</span> : state,
  valid_state_prop
    (pre_loaded_with_all_messages_vlsm
       (free_composite_vlsm
          IM1)) s1
  ‚Üí <span class="kr">‚àÄ</span> (<span class="nv">l1</span> : composite_label
              IM1) (<span class="nv">om</span> : 
                    option
                      message),
      constraint1 l1 (s1, om)
      ‚Üí constraint2
          (same_IM_label_rew
             l1)
          (same_IM_state_rew
             s1, om)</span></span></span><br><span><var>seed</var><span class="hyp-type"><b>: </b><span>message ‚Üí <span class="kt">Prop</span></span></span></span><br><span><var>i</var><span class="hyp-type"><b>: </b><span>index</span></span></span><br><span><var>li</var><span class="hyp-type"><b>: </b><span>vlabel (IM1 i)</span></span></span><br><span><var>s</var><span class="hyp-type"><b>: </b><span>state</span></span></span><br><span><var>om</var><span class="hyp-type"><b>: </b><span>option message</span></span></span><br><span><var>s'</var><span class="hyp-type"><b>: </b><span>state</span></span></span><br><span><var>om'</var><span class="hyp-type"><b>: </b><span>option message</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">transition (existT i li) (s, om) = (s&#39;, om&#39;)
‚Üí vtransition
    (pre_loaded_vlsm (composite_vlsm IM2 constraint2)
       seed) (same_IM_label_rew (existT i li))
    (same_IM_state_rew s, om) =
  (same_IM_state_rew s&#39;, om&#39;)</div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="Composition-v-chk256" style="display: none" type="checkbox"><label class="alectryon-input" for="Composition-v-chk256"><span class="nb">cbn</span>.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>message, index</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>EqDecision0</var><span class="hyp-type"><b>: </b><span>EqDecision index</span></span></span><br><span><var>IM1, IM2</var><span class="hyp-type"><b>: </b><span>index ‚Üí VLSM message</span></span></span><br><span><var>Heq</var><span class="hyp-type"><b>: </b><span><span class="kr">‚àÄ</span> <span class="nv">i</span> : index, IM1 i = IM2 i</span></span></span><br><span><var>constraint1</var><span class="hyp-type"><b>: </b><span>composite_label IM1
‚Üí composite_state IM1 * option message
  ‚Üí <span class="kt">Prop</span></span></span></span><br><span><var>constraint2</var><span class="hyp-type"><b>: </b><span>composite_label IM2
‚Üí composite_state IM2 * option message
  ‚Üí <span class="kt">Prop</span></span></span></span><br><span><var>constraint_projection</var><span class="hyp-type"><b>: </b><span><span class="kr">‚àÄ</span> <span class="nv">s1</span> : state,
  valid_state_prop
    (pre_loaded_with_all_messages_vlsm
       (free_composite_vlsm
          IM1)) s1
  ‚Üí <span class="kr">‚àÄ</span> (<span class="nv">l1</span> : composite_label
              IM1) (<span class="nv">om</span> : 
                    option
                      message),
      constraint1 l1 (s1, om)
      ‚Üí constraint2
          (same_IM_label_rew
             l1)
          (same_IM_state_rew
             s1, om)</span></span></span><br><span><var>seed</var><span class="hyp-type"><b>: </b><span>message ‚Üí <span class="kt">Prop</span></span></span></span><br><span><var>i</var><span class="hyp-type"><b>: </b><span>index</span></span></span><br><span><var>li</var><span class="hyp-type"><b>: </b><span>vlabel (IM1 i)</span></span></span><br><span><var>s</var><span class="hyp-type"><b>: </b><span>state</span></span></span><br><span><var>om</var><span class="hyp-type"><b>: </b><span>option message</span></span></span><br><span><var>s'</var><span class="hyp-type"><b>: </b><span>state</span></span></span><br><span><var>om'</var><span class="hyp-type"><b>: </b><span>option message</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">(<span class="kr">let</span> (<span class="nv">si&#39;</span>, om&#39;) := vtransition (IM1 i) li (s i, om) <span class="kr">in</span>
 (state_update IM1 s i si&#39;, om&#39;)) = (s&#39;, om&#39;)
‚Üí (<span class="kr">let</span> (<span class="nv">si&#39;</span>, om&#39;) :=
     vtransition (IM2 i)
       (same_VLSM_label_rew (Heq i) li)
       (same_IM_state_rew s i, om) <span class="kr">in</span>
   (state_update IM2 (same_IM_state_rew s) i si&#39;, om&#39;)) =
  (same_IM_state_rew s&#39;, om&#39;)</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="Composition-v-chk257" style="display: none" type="checkbox"><label class="alectryon-input" for="Composition-v-chk257"><span class="nb">destruct</span> (vtransition (IM1 i) _ _) <span class="kr">as</span> (si&#39;1, _om&#39;) <span class="nb">eqn</span>: Ht1.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>message, index</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>EqDecision0</var><span class="hyp-type"><b>: </b><span>EqDecision index</span></span></span><br><span><var>IM1, IM2</var><span class="hyp-type"><b>: </b><span>index ‚Üí VLSM message</span></span></span><br><span><var>Heq</var><span class="hyp-type"><b>: </b><span><span class="kr">‚àÄ</span> <span class="nv">i</span> : index, IM1 i = IM2 i</span></span></span><br><span><var>constraint1</var><span class="hyp-type"><b>: </b><span>composite_label IM1
‚Üí composite_state IM1 * option message
  ‚Üí <span class="kt">Prop</span></span></span></span><br><span><var>constraint2</var><span class="hyp-type"><b>: </b><span>composite_label IM2
‚Üí composite_state IM2 * option message
  ‚Üí <span class="kt">Prop</span></span></span></span><br><span><var>constraint_projection</var><span class="hyp-type"><b>: </b><span><span class="kr">‚àÄ</span> <span class="nv">s1</span> : state,
  valid_state_prop
    (pre_loaded_with_all_messages_vlsm
       (free_composite_vlsm
          IM1)) s1
  ‚Üí <span class="kr">‚àÄ</span> (<span class="nv">l1</span> : composite_label
              IM1) (<span class="nv">om</span> : 
                    option
                      message),
      constraint1 l1 (s1, om)
      ‚Üí constraint2
          (same_IM_label_rew
             l1)
          (same_IM_state_rew
             s1, om)</span></span></span><br><span><var>seed</var><span class="hyp-type"><b>: </b><span>message ‚Üí <span class="kt">Prop</span></span></span></span><br><span><var>i</var><span class="hyp-type"><b>: </b><span>index</span></span></span><br><span><var>li</var><span class="hyp-type"><b>: </b><span>vlabel (IM1 i)</span></span></span><br><span><var>s</var><span class="hyp-type"><b>: </b><span>state</span></span></span><br><span><var>om</var><span class="hyp-type"><b>: </b><span>option message</span></span></span><br><span><var>s'</var><span class="hyp-type"><b>: </b><span>state</span></span></span><br><span><var>om'</var><span class="hyp-type"><b>: </b><span>option message</span></span></span><br><span><var>si'1</var><span class="hyp-type"><b>: </b><span>state</span></span></span><br><span><var>_om'</var><span class="hyp-type"><b>: </b><span>option message</span></span></span><br><span><var>Ht1</var><span class="hyp-type"><b>: </b><span>vtransition (IM1 i) li (s i, om) = (si&#39;1, _om&#39;)</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">(state_update IM1 s i si&#39;1, _om&#39;) = (s&#39;, om&#39;)
‚Üí (<span class="kr">let</span> (<span class="nv">si&#39;</span>, om&#39;) :=
     vtransition (IM2 i)
       (same_VLSM_label_rew (Heq i) li)
       (same_IM_state_rew s i, om) <span class="kr">in</span>
   (state_update IM2 (same_IM_state_rew s) i si&#39;, om&#39;)) =
  (same_IM_state_rew s&#39;, om&#39;)</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="Composition-v-chk258" style="display: none" type="checkbox"><label class="alectryon-input" for="Composition-v-chk258"><span class="nb">unfold</span> same_IM_state_rew <span class="nb">at</span> <span class="mi">1</span>.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>message, index</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>EqDecision0</var><span class="hyp-type"><b>: </b><span>EqDecision index</span></span></span><br><span><var>IM1, IM2</var><span class="hyp-type"><b>: </b><span>index ‚Üí VLSM message</span></span></span><br><span><var>Heq</var><span class="hyp-type"><b>: </b><span><span class="kr">‚àÄ</span> <span class="nv">i</span> : index, IM1 i = IM2 i</span></span></span><br><span><var>constraint1</var><span class="hyp-type"><b>: </b><span>composite_label IM1
‚Üí composite_state IM1 * option message
  ‚Üí <span class="kt">Prop</span></span></span></span><br><span><var>constraint2</var><span class="hyp-type"><b>: </b><span>composite_label IM2
‚Üí composite_state IM2 * option message
  ‚Üí <span class="kt">Prop</span></span></span></span><br><span><var>constraint_projection</var><span class="hyp-type"><b>: </b><span><span class="kr">‚àÄ</span> <span class="nv">s1</span> : state,
  valid_state_prop
    (pre_loaded_with_all_messages_vlsm
       (free_composite_vlsm
          IM1)) s1
  ‚Üí <span class="kr">‚àÄ</span> (<span class="nv">l1</span> : composite_label
              IM1) (<span class="nv">om</span> : 
                    option
                      message),
      constraint1 l1 (s1, om)
      ‚Üí constraint2
          (same_IM_label_rew
             l1)
          (same_IM_state_rew
             s1, om)</span></span></span><br><span><var>seed</var><span class="hyp-type"><b>: </b><span>message ‚Üí <span class="kt">Prop</span></span></span></span><br><span><var>i</var><span class="hyp-type"><b>: </b><span>index</span></span></span><br><span><var>li</var><span class="hyp-type"><b>: </b><span>vlabel (IM1 i)</span></span></span><br><span><var>s</var><span class="hyp-type"><b>: </b><span>state</span></span></span><br><span><var>om</var><span class="hyp-type"><b>: </b><span>option message</span></span></span><br><span><var>s'</var><span class="hyp-type"><b>: </b><span>state</span></span></span><br><span><var>om'</var><span class="hyp-type"><b>: </b><span>option message</span></span></span><br><span><var>si'1</var><span class="hyp-type"><b>: </b><span>state</span></span></span><br><span><var>_om'</var><span class="hyp-type"><b>: </b><span>option message</span></span></span><br><span><var>Ht1</var><span class="hyp-type"><b>: </b><span>vtransition (IM1 i) li (s i, om) = (si&#39;1, _om&#39;)</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">(state_update IM1 s i si&#39;1, _om&#39;) = (s&#39;, om&#39;)
‚Üí (<span class="kr">let</span> (<span class="nv">si&#39;</span>, om&#39;) :=
     vtransition (IM2 i)
       (same_VLSM_label_rew (Heq i) li)
       (same_VLSM_state_rew (Heq i) (s i), om) <span class="kr">in</span>
   (state_update IM2 (same_IM_state_rew s) i si&#39;, om&#39;)) =
  (same_IM_state_rew s&#39;, om&#39;)</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="Composition-v-chk259" style="display: none" type="checkbox"><label class="alectryon-input" for="Composition-v-chk259"><span class="nb">erewrite</span> same_VLSM_transition_preservation; [| <span class="bp">done</span>].</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>message, index</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>EqDecision0</var><span class="hyp-type"><b>: </b><span>EqDecision index</span></span></span><br><span><var>IM1, IM2</var><span class="hyp-type"><b>: </b><span>index ‚Üí VLSM message</span></span></span><br><span><var>Heq</var><span class="hyp-type"><b>: </b><span><span class="kr">‚àÄ</span> <span class="nv">i</span> : index, IM1 i = IM2 i</span></span></span><br><span><var>constraint1</var><span class="hyp-type"><b>: </b><span>composite_label IM1
‚Üí composite_state IM1 * option message
  ‚Üí <span class="kt">Prop</span></span></span></span><br><span><var>constraint2</var><span class="hyp-type"><b>: </b><span>composite_label IM2
‚Üí composite_state IM2 * option message
  ‚Üí <span class="kt">Prop</span></span></span></span><br><span><var>constraint_projection</var><span class="hyp-type"><b>: </b><span><span class="kr">‚àÄ</span> <span class="nv">s1</span> : state,
  valid_state_prop
    (pre_loaded_with_all_messages_vlsm
       (free_composite_vlsm
          IM1)) s1
  ‚Üí <span class="kr">‚àÄ</span> (<span class="nv">l1</span> : composite_label
              IM1) (<span class="nv">om</span> : 
                    option
                      message),
      constraint1 l1 (s1, om)
      ‚Üí constraint2
          (same_IM_label_rew
             l1)
          (same_IM_state_rew
             s1, om)</span></span></span><br><span><var>seed</var><span class="hyp-type"><b>: </b><span>message ‚Üí <span class="kt">Prop</span></span></span></span><br><span><var>i</var><span class="hyp-type"><b>: </b><span>index</span></span></span><br><span><var>li</var><span class="hyp-type"><b>: </b><span>vlabel (IM1 i)</span></span></span><br><span><var>s</var><span class="hyp-type"><b>: </b><span>state</span></span></span><br><span><var>om</var><span class="hyp-type"><b>: </b><span>option message</span></span></span><br><span><var>s'</var><span class="hyp-type"><b>: </b><span>state</span></span></span><br><span><var>om'</var><span class="hyp-type"><b>: </b><span>option message</span></span></span><br><span><var>si'1</var><span class="hyp-type"><b>: </b><span>state</span></span></span><br><span><var>_om'</var><span class="hyp-type"><b>: </b><span>option message</span></span></span><br><span><var>Ht1</var><span class="hyp-type"><b>: </b><span>vtransition (IM1 i) li (s i, om) = (si&#39;1, _om&#39;)</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">(state_update IM1 s i si&#39;1, _om&#39;) = (s&#39;, om&#39;)
‚Üí (state_update IM2 (same_IM_state_rew s) i
     (same_VLSM_state_rew (Heq i) si&#39;1), _om&#39;) =
  (same_IM_state_rew s&#39;, om&#39;)</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="Composition-v-chk25a" style="display: none" type="checkbox"><label class="alectryon-input" for="Composition-v-chk25a"><span class="nb">inversion</span> <span class="mi">1</span>; <span class="nb">subst</span>; <span class="nb">clear</span> H.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>message, index</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>EqDecision0</var><span class="hyp-type"><b>: </b><span>EqDecision index</span></span></span><br><span><var>IM1, IM2</var><span class="hyp-type"><b>: </b><span>index ‚Üí VLSM message</span></span></span><br><span><var>Heq</var><span class="hyp-type"><b>: </b><span><span class="kr">‚àÄ</span> <span class="nv">i</span> : index, IM1 i = IM2 i</span></span></span><br><span><var>constraint1</var><span class="hyp-type"><b>: </b><span>composite_label IM1
‚Üí composite_state IM1 * option message
  ‚Üí <span class="kt">Prop</span></span></span></span><br><span><var>constraint2</var><span class="hyp-type"><b>: </b><span>composite_label IM2
‚Üí composite_state IM2 * option message
  ‚Üí <span class="kt">Prop</span></span></span></span><br><span><var>constraint_projection</var><span class="hyp-type"><b>: </b><span><span class="kr">‚àÄ</span> <span class="nv">s1</span> : state,
  valid_state_prop
    (pre_loaded_with_all_messages_vlsm
       (free_composite_vlsm
          IM1)) s1
  ‚Üí <span class="kr">‚àÄ</span> (<span class="nv">l1</span> : composite_label
              IM1) (<span class="nv">om</span> : 
                    option
                      message),
      constraint1 l1 (s1, om)
      ‚Üí constraint2
          (same_IM_label_rew
             l1)
          (same_IM_state_rew
             s1, om)</span></span></span><br><span><var>seed</var><span class="hyp-type"><b>: </b><span>message ‚Üí <span class="kt">Prop</span></span></span></span><br><span><var>i</var><span class="hyp-type"><b>: </b><span>index</span></span></span><br><span><var>li</var><span class="hyp-type"><b>: </b><span>vlabel (IM1 i)</span></span></span><br><span><var>s</var><span class="hyp-type"><b>: </b><span>state</span></span></span><br><span><var>om, om'</var><span class="hyp-type"><b>: </b><span>option message</span></span></span><br><span><var>si'1</var><span class="hyp-type"><b>: </b><span>state</span></span></span><br><span><var>Ht1</var><span class="hyp-type"><b>: </b><span>vtransition (IM1 i) li (s i, om) = (si&#39;1, om&#39;)</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">(state_update IM2 (same_IM_state_rew s) i
   (same_VLSM_state_rew (Heq i) si&#39;1), om&#39;) =
(same_IM_state_rew (state_update IM1 s i si&#39;1), om&#39;)</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="Composition-v-chk25b" style="display: none" type="checkbox"><label class="alectryon-input" for="Composition-v-chk25b"><span class="nb">f_equal</span>.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>message, index</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>EqDecision0</var><span class="hyp-type"><b>: </b><span>EqDecision index</span></span></span><br><span><var>IM1, IM2</var><span class="hyp-type"><b>: </b><span>index ‚Üí VLSM message</span></span></span><br><span><var>Heq</var><span class="hyp-type"><b>: </b><span><span class="kr">‚àÄ</span> <span class="nv">i</span> : index, IM1 i = IM2 i</span></span></span><br><span><var>constraint1</var><span class="hyp-type"><b>: </b><span>composite_label IM1
‚Üí composite_state IM1 * option message
  ‚Üí <span class="kt">Prop</span></span></span></span><br><span><var>constraint2</var><span class="hyp-type"><b>: </b><span>composite_label IM2
‚Üí composite_state IM2 * option message
  ‚Üí <span class="kt">Prop</span></span></span></span><br><span><var>constraint_projection</var><span class="hyp-type"><b>: </b><span><span class="kr">‚àÄ</span> <span class="nv">s1</span> : state,
  valid_state_prop
    (pre_loaded_with_all_messages_vlsm
       (free_composite_vlsm
          IM1)) s1
  ‚Üí <span class="kr">‚àÄ</span> (<span class="nv">l1</span> : composite_label
              IM1) (<span class="nv">om</span> : 
                    option
                      message),
      constraint1 l1 (s1, om)
      ‚Üí constraint2
          (same_IM_label_rew
             l1)
          (same_IM_state_rew
             s1, om)</span></span></span><br><span><var>seed</var><span class="hyp-type"><b>: </b><span>message ‚Üí <span class="kt">Prop</span></span></span></span><br><span><var>i</var><span class="hyp-type"><b>: </b><span>index</span></span></span><br><span><var>li</var><span class="hyp-type"><b>: </b><span>vlabel (IM1 i)</span></span></span><br><span><var>s</var><span class="hyp-type"><b>: </b><span>state</span></span></span><br><span><var>om, om'</var><span class="hyp-type"><b>: </b><span>option message</span></span></span><br><span><var>si'1</var><span class="hyp-type"><b>: </b><span>state</span></span></span><br><span><var>Ht1</var><span class="hyp-type"><b>: </b><span>vtransition (IM1 i) li (s i, om) = (si&#39;1, om&#39;)</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">state_update IM2 (same_IM_state_rew s) i
  (same_VLSM_state_rew (Heq i) si&#39;1) =
same_IM_state_rew (state_update IM1 s i si&#39;1)</div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="Composition-v-chk25c" style="display: none" type="checkbox"><label class="alectryon-input" for="Composition-v-chk25c">extensionality j.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>message, index</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>EqDecision0</var><span class="hyp-type"><b>: </b><span>EqDecision index</span></span></span><br><span><var>IM1, IM2</var><span class="hyp-type"><b>: </b><span>index ‚Üí VLSM message</span></span></span><br><span><var>Heq</var><span class="hyp-type"><b>: </b><span><span class="kr">‚àÄ</span> <span class="nv">i</span> : index, IM1 i = IM2 i</span></span></span><br><span><var>constraint1</var><span class="hyp-type"><b>: </b><span>composite_label IM1
‚Üí composite_state IM1 * option message
  ‚Üí <span class="kt">Prop</span></span></span></span><br><span><var>constraint2</var><span class="hyp-type"><b>: </b><span>composite_label IM2
‚Üí composite_state IM2 * option message
  ‚Üí <span class="kt">Prop</span></span></span></span><br><span><var>constraint_projection</var><span class="hyp-type"><b>: </b><span><span class="kr">‚àÄ</span> <span class="nv">s1</span> : state,
  valid_state_prop
    (pre_loaded_with_all_messages_vlsm
       (free_composite_vlsm
          IM1)) s1
  ‚Üí <span class="kr">‚àÄ</span> (<span class="nv">l1</span> : composite_label
              IM1) (<span class="nv">om</span> : 
                    option
                      message),
      constraint1 l1 (s1, om)
      ‚Üí constraint2
          (same_IM_label_rew
             l1)
          (same_IM_state_rew
             s1, om)</span></span></span><br><span><var>seed</var><span class="hyp-type"><b>: </b><span>message ‚Üí <span class="kt">Prop</span></span></span></span><br><span><var>i</var><span class="hyp-type"><b>: </b><span>index</span></span></span><br><span><var>li</var><span class="hyp-type"><b>: </b><span>vlabel (IM1 i)</span></span></span><br><span><var>s</var><span class="hyp-type"><b>: </b><span>state</span></span></span><br><span><var>om, om'</var><span class="hyp-type"><b>: </b><span>option message</span></span></span><br><span><var>si'1</var><span class="hyp-type"><b>: </b><span>state</span></span></span><br><span><var>Ht1</var><span class="hyp-type"><b>: </b><span>vtransition (IM1 i) li (s i, om) = (si&#39;1, om&#39;)</span></span></span><br><span><var>j</var><span class="hyp-type"><b>: </b><span>index</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">state_update IM2 (same_IM_state_rew s) i
  (same_VLSM_state_rew (Heq i) si&#39;1) j =
same_IM_state_rew (state_update IM1 s i si&#39;1) j</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="Composition-v-chk25d" style="display: none" type="checkbox"><label class="alectryon-input" for="Composition-v-chk25d"><span class="nb">unfold</span> same_IM_state_rew <span class="nb">at</span> <span class="mi">2</span>.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>message, index</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>EqDecision0</var><span class="hyp-type"><b>: </b><span>EqDecision index</span></span></span><br><span><var>IM1, IM2</var><span class="hyp-type"><b>: </b><span>index ‚Üí VLSM message</span></span></span><br><span><var>Heq</var><span class="hyp-type"><b>: </b><span><span class="kr">‚àÄ</span> <span class="nv">i</span> : index, IM1 i = IM2 i</span></span></span><br><span><var>constraint1</var><span class="hyp-type"><b>: </b><span>composite_label IM1
‚Üí composite_state IM1 * option message
  ‚Üí <span class="kt">Prop</span></span></span></span><br><span><var>constraint2</var><span class="hyp-type"><b>: </b><span>composite_label IM2
‚Üí composite_state IM2 * option message
  ‚Üí <span class="kt">Prop</span></span></span></span><br><span><var>constraint_projection</var><span class="hyp-type"><b>: </b><span><span class="kr">‚àÄ</span> <span class="nv">s1</span> : state,
  valid_state_prop
    (pre_loaded_with_all_messages_vlsm
       (free_composite_vlsm
          IM1)) s1
  ‚Üí <span class="kr">‚àÄ</span> (<span class="nv">l1</span> : composite_label
              IM1) (<span class="nv">om</span> : 
                    option
                      message),
      constraint1 l1 (s1, om)
      ‚Üí constraint2
          (same_IM_label_rew
             l1)
          (same_IM_state_rew
             s1, om)</span></span></span><br><span><var>seed</var><span class="hyp-type"><b>: </b><span>message ‚Üí <span class="kt">Prop</span></span></span></span><br><span><var>i</var><span class="hyp-type"><b>: </b><span>index</span></span></span><br><span><var>li</var><span class="hyp-type"><b>: </b><span>vlabel (IM1 i)</span></span></span><br><span><var>s</var><span class="hyp-type"><b>: </b><span>state</span></span></span><br><span><var>om, om'</var><span class="hyp-type"><b>: </b><span>option message</span></span></span><br><span><var>si'1</var><span class="hyp-type"><b>: </b><span>state</span></span></span><br><span><var>Ht1</var><span class="hyp-type"><b>: </b><span>vtransition (IM1 i) li (s i, om) = (si&#39;1, om&#39;)</span></span></span><br><span><var>j</var><span class="hyp-type"><b>: </b><span>index</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">state_update IM2 (same_IM_state_rew s) i
  (same_VLSM_state_rew (Heq i) si&#39;1) j =
same_VLSM_state_rew (Heq j)
  (state_update IM1 s i si&#39;1 j)</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><span class="alectryon-input"><span class="bp">by</span> <span class="nb">destruct</span> (decide (i = j)); <span class="nb">subst</span>; state_update_simpl.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="Composition-v-chk25e" style="display: none" type="checkbox"><label class="alectryon-input" for="Composition-v-chk25e">-</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>message, index</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>EqDecision0</var><span class="hyp-type"><b>: </b><span>EqDecision index</span></span></span><br><span><var>IM1, IM2</var><span class="hyp-type"><b>: </b><span>index ‚Üí VLSM message</span></span></span><br><span><var>Heq</var><span class="hyp-type"><b>: </b><span><span class="kr">‚àÄ</span> <span class="nv">i</span> : index, IM1 i = IM2 i</span></span></span><br><span><var>constraint1</var><span class="hyp-type"><b>: </b><span>composite_label IM1
‚Üí composite_state IM1 * option message
  ‚Üí <span class="kt">Prop</span></span></span></span><br><span><var>constraint2</var><span class="hyp-type"><b>: </b><span>composite_label IM2
‚Üí composite_state IM2 * option message
  ‚Üí <span class="kt">Prop</span></span></span></span><br><span><var>constraint_projection</var><span class="hyp-type"><b>: </b><span><span class="kr">‚àÄ</span> <span class="nv">s1</span> : state,
  valid_state_prop
    (pre_loaded_with_all_messages_vlsm
       (free_composite_vlsm
          IM1)) s1
  ‚Üí <span class="kr">‚àÄ</span> (<span class="nv">l1</span> : composite_label
              IM1) (<span class="nv">om</span> : 
                    option
                      message),
      constraint1 l1 (s1, om)
      ‚Üí constraint2
          (same_IM_label_rew
             l1)
          (same_IM_state_rew
             s1, om)</span></span></span><br><span><var>seed</var><span class="hyp-type"><b>: </b><span>message ‚Üí <span class="kt">Prop</span></span></span></span><br><span><var>l</var><span class="hyp-type"><b>: </b><span>state</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>vinitial_state_prop
  (pre_loaded_vlsm
     (composite_vlsm IM1 constraint1) seed) l</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">vinitial_state_prop
  (pre_loaded_vlsm (composite_vlsm IM2 constraint2)
     seed) (same_IM_state_rew l)</div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="Composition-v-chk25f" style="display: none" type="checkbox"><label class="alectryon-input" for="Composition-v-chk25f"><span class="nb">intros</span> i.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>message, index</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>EqDecision0</var><span class="hyp-type"><b>: </b><span>EqDecision index</span></span></span><br><span><var>IM1, IM2</var><span class="hyp-type"><b>: </b><span>index ‚Üí VLSM message</span></span></span><br><span><var>Heq</var><span class="hyp-type"><b>: </b><span><span class="kr">‚àÄ</span> <span class="nv">i</span> : index, IM1 i = IM2 i</span></span></span><br><span><var>constraint1</var><span class="hyp-type"><b>: </b><span>composite_label IM1
‚Üí composite_state IM1 * option message
  ‚Üí <span class="kt">Prop</span></span></span></span><br><span><var>constraint2</var><span class="hyp-type"><b>: </b><span>composite_label IM2
‚Üí composite_state IM2 * option message
  ‚Üí <span class="kt">Prop</span></span></span></span><br><span><var>constraint_projection</var><span class="hyp-type"><b>: </b><span><span class="kr">‚àÄ</span> <span class="nv">s1</span> : state,
  valid_state_prop
    (pre_loaded_with_all_messages_vlsm
       (free_composite_vlsm
          IM1)) s1
  ‚Üí <span class="kr">‚àÄ</span> (<span class="nv">l1</span> : composite_label
              IM1) (<span class="nv">om</span> : 
                    option
                      message),
      constraint1 l1 (s1, om)
      ‚Üí constraint2
          (same_IM_label_rew
             l1)
          (same_IM_state_rew
             s1, om)</span></span></span><br><span><var>seed</var><span class="hyp-type"><b>: </b><span>message ‚Üí <span class="kt">Prop</span></span></span></span><br><span><var>l</var><span class="hyp-type"><b>: </b><span>state</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>vinitial_state_prop
  (pre_loaded_vlsm
     (composite_vlsm IM1 constraint1) seed) l</span></span></span><br><span><var>i</var><span class="hyp-type"><b>: </b><span>index</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">vinitial_state_prop (IM2 i) (same_IM_state_rew l i)</div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="nb">apply</span> same_VLSM_initial_state_preservation, H.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="Composition-v-chk260" style="display: none" type="checkbox"><label class="alectryon-input" for="Composition-v-chk260">-</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>message, index</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>EqDecision0</var><span class="hyp-type"><b>: </b><span>EqDecision index</span></span></span><br><span><var>IM1, IM2</var><span class="hyp-type"><b>: </b><span>index ‚Üí VLSM message</span></span></span><br><span><var>Heq</var><span class="hyp-type"><b>: </b><span><span class="kr">‚àÄ</span> <span class="nv">i</span> : index, IM1 i = IM2 i</span></span></span><br><span><var>constraint1</var><span class="hyp-type"><b>: </b><span>composite_label IM1
‚Üí composite_state IM1 * option message
  ‚Üí <span class="kt">Prop</span></span></span></span><br><span><var>constraint2</var><span class="hyp-type"><b>: </b><span>composite_label IM2
‚Üí composite_state IM2 * option message
  ‚Üí <span class="kt">Prop</span></span></span></span><br><span><var>constraint_projection</var><span class="hyp-type"><b>: </b><span><span class="kr">‚àÄ</span> <span class="nv">s1</span> : state,
  valid_state_prop
    (pre_loaded_with_all_messages_vlsm
       (free_composite_vlsm
          IM1)) s1
  ‚Üí <span class="kr">‚àÄ</span> (<span class="nv">l1</span> : composite_label
              IM1) (<span class="nv">om</span> : 
                    option
                      message),
      constraint1 l1 (s1, om)
      ‚Üí constraint2
          (same_IM_label_rew
             l1)
          (same_IM_state_rew
             s1, om)</span></span></span><br><span><var>seed</var><span class="hyp-type"><b>: </b><span>message ‚Üí <span class="kt">Prop</span></span></span></span><br><span><var>l</var><span class="hyp-type"><b>: </b><span>label</span></span></span><br><span><var>s</var><span class="hyp-type"><b>: </b><span>state</span></span></span><br><span><var>m</var><span class="hyp-type"><b>: </b><span>message</span></span></span><br><span><var>Hv</var><span class="hyp-type"><b>: </b><span>input_valid
  (pre_loaded_vlsm
     (composite_vlsm IM1 constraint1) seed) l
  (s, Some m)</span></span></span><br><span><var>HsY</var><span class="hyp-type"><b>: </b><span>valid_state_prop
  (pre_loaded_vlsm
     (composite_vlsm IM2 constraint2) seed)
  (same_IM_state_rew s)</span></span></span><br><span><var>HmX</var><span class="hyp-type"><b>: </b><span>vinitial_message_prop
  (pre_loaded_vlsm
     (composite_vlsm IM1 constraint1) seed) m</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">valid_message_prop
  (pre_loaded_vlsm (composite_vlsm IM2 constraint2)
     seed) m</div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="Composition-v-chk261" style="display: none" type="checkbox"><label class="alectryon-input" for="Composition-v-chk261"><span class="nb">apply</span> initial_message_is_valid.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>message, index</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>EqDecision0</var><span class="hyp-type"><b>: </b><span>EqDecision index</span></span></span><br><span><var>IM1, IM2</var><span class="hyp-type"><b>: </b><span>index ‚Üí VLSM message</span></span></span><br><span><var>Heq</var><span class="hyp-type"><b>: </b><span><span class="kr">‚àÄ</span> <span class="nv">i</span> : index, IM1 i = IM2 i</span></span></span><br><span><var>constraint1</var><span class="hyp-type"><b>: </b><span>composite_label IM1
‚Üí composite_state IM1 * option message
  ‚Üí <span class="kt">Prop</span></span></span></span><br><span><var>constraint2</var><span class="hyp-type"><b>: </b><span>composite_label IM2
‚Üí composite_state IM2 * option message
  ‚Üí <span class="kt">Prop</span></span></span></span><br><span><var>constraint_projection</var><span class="hyp-type"><b>: </b><span><span class="kr">‚àÄ</span> <span class="nv">s1</span> : state,
  valid_state_prop
    (pre_loaded_with_all_messages_vlsm
       (free_composite_vlsm
          IM1)) s1
  ‚Üí <span class="kr">‚àÄ</span> (<span class="nv">l1</span> : composite_label
              IM1) (<span class="nv">om</span> : 
                    option
                      message),
      constraint1 l1 (s1, om)
      ‚Üí constraint2
          (same_IM_label_rew
             l1)
          (same_IM_state_rew
             s1, om)</span></span></span><br><span><var>seed</var><span class="hyp-type"><b>: </b><span>message ‚Üí <span class="kt">Prop</span></span></span></span><br><span><var>l</var><span class="hyp-type"><b>: </b><span>label</span></span></span><br><span><var>s</var><span class="hyp-type"><b>: </b><span>state</span></span></span><br><span><var>m</var><span class="hyp-type"><b>: </b><span>message</span></span></span><br><span><var>Hv</var><span class="hyp-type"><b>: </b><span>input_valid
  (pre_loaded_vlsm
     (composite_vlsm IM1 constraint1) seed) l
  (s, Some m)</span></span></span><br><span><var>HsY</var><span class="hyp-type"><b>: </b><span>valid_state_prop
  (pre_loaded_vlsm
     (composite_vlsm IM2 constraint2) seed)
  (same_IM_state_rew s)</span></span></span><br><span><var>HmX</var><span class="hyp-type"><b>: </b><span>vinitial_message_prop
  (pre_loaded_vlsm
     (composite_vlsm IM1 constraint1) seed) m</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">initial_message_prop m</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="Composition-v-chk262" style="display: none" type="checkbox"><label class="alectryon-input" for="Composition-v-chk262"><span class="nb">destruct</span> HmX <span class="kr">as</span> [[i [[im Him] Hi]] | Hseed]; [| <span class="bp">by</span> <span class="nb">right</span>].</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>message, index</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>EqDecision0</var><span class="hyp-type"><b>: </b><span>EqDecision index</span></span></span><br><span><var>IM1, IM2</var><span class="hyp-type"><b>: </b><span>index ‚Üí VLSM message</span></span></span><br><span><var>Heq</var><span class="hyp-type"><b>: </b><span><span class="kr">‚àÄ</span> <span class="nv">i</span> : index, IM1 i = IM2 i</span></span></span><br><span><var>constraint1</var><span class="hyp-type"><b>: </b><span>composite_label IM1
‚Üí composite_state IM1 * option message
  ‚Üí <span class="kt">Prop</span></span></span></span><br><span><var>constraint2</var><span class="hyp-type"><b>: </b><span>composite_label IM2
‚Üí composite_state IM2 * option message
  ‚Üí <span class="kt">Prop</span></span></span></span><br><span><var>constraint_projection</var><span class="hyp-type"><b>: </b><span><span class="kr">‚àÄ</span> <span class="nv">s1</span> : state,
  valid_state_prop
    (pre_loaded_with_all_messages_vlsm
       (free_composite_vlsm
          IM1)) s1
  ‚Üí <span class="kr">‚àÄ</span> (<span class="nv">l1</span> : composite_label
              IM1) (<span class="nv">om</span> : 
                    option
                      message),
      constraint1 l1 (s1, om)
      ‚Üí constraint2
          (same_IM_label_rew
             l1)
          (same_IM_state_rew
             s1, om)</span></span></span><br><span><var>seed</var><span class="hyp-type"><b>: </b><span>message ‚Üí <span class="kt">Prop</span></span></span></span><br><span><var>l</var><span class="hyp-type"><b>: </b><span>label</span></span></span><br><span><var>s</var><span class="hyp-type"><b>: </b><span>state</span></span></span><br><span><var>m</var><span class="hyp-type"><b>: </b><span>message</span></span></span><br><span><var>Hv</var><span class="hyp-type"><b>: </b><span>input_valid
  (pre_loaded_vlsm
     (composite_vlsm IM1 constraint1) seed) l
  (s, Some m)</span></span></span><br><span><var>HsY</var><span class="hyp-type"><b>: </b><span>valid_state_prop
  (pre_loaded_vlsm
     (composite_vlsm IM2 constraint2) seed)
  (same_IM_state_rew s)</span></span></span><br><span><var>i</var><span class="hyp-type"><b>: </b><span>index</span></span></span><br><span><var>im</var><span class="hyp-type"><b>: </b><span>message</span></span></span><br><span><var>Him</var><span class="hyp-type"><b>: </b><span>initial_message_prop im</span></span></span><br><span><var>Hi</var><span class="hyp-type"><b>: </b><span>`(im ‚Üæ Him) = m</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">initial_message_prop m</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="Composition-v-chk263" style="display: none" type="checkbox"><label class="alectryon-input" for="Composition-v-chk263"><span class="nb">simpl</span> <span class="kr">in</span> Hi.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>message, index</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>EqDecision0</var><span class="hyp-type"><b>: </b><span>EqDecision index</span></span></span><br><span><var>IM1, IM2</var><span class="hyp-type"><b>: </b><span>index ‚Üí VLSM message</span></span></span><br><span><var>Heq</var><span class="hyp-type"><b>: </b><span><span class="kr">‚àÄ</span> <span class="nv">i</span> : index, IM1 i = IM2 i</span></span></span><br><span><var>constraint1</var><span class="hyp-type"><b>: </b><span>composite_label IM1
‚Üí composite_state IM1 * option message
  ‚Üí <span class="kt">Prop</span></span></span></span><br><span><var>constraint2</var><span class="hyp-type"><b>: </b><span>composite_label IM2
‚Üí composite_state IM2 * option message
  ‚Üí <span class="kt">Prop</span></span></span></span><br><span><var>constraint_projection</var><span class="hyp-type"><b>: </b><span><span class="kr">‚àÄ</span> <span class="nv">s1</span> : state,
  valid_state_prop
    (pre_loaded_with_all_messages_vlsm
       (free_composite_vlsm
          IM1)) s1
  ‚Üí <span class="kr">‚àÄ</span> (<span class="nv">l1</span> : composite_label
              IM1) (<span class="nv">om</span> : 
                    option
                      message),
      constraint1 l1 (s1, om)
      ‚Üí constraint2
          (same_IM_label_rew
             l1)
          (same_IM_state_rew
             s1, om)</span></span></span><br><span><var>seed</var><span class="hyp-type"><b>: </b><span>message ‚Üí <span class="kt">Prop</span></span></span></span><br><span><var>l</var><span class="hyp-type"><b>: </b><span>label</span></span></span><br><span><var>s</var><span class="hyp-type"><b>: </b><span>state</span></span></span><br><span><var>m</var><span class="hyp-type"><b>: </b><span>message</span></span></span><br><span><var>Hv</var><span class="hyp-type"><b>: </b><span>input_valid
  (pre_loaded_vlsm
     (composite_vlsm IM1 constraint1) seed) l
  (s, Some m)</span></span></span><br><span><var>HsY</var><span class="hyp-type"><b>: </b><span>valid_state_prop
  (pre_loaded_vlsm
     (composite_vlsm IM2 constraint2) seed)
  (same_IM_state_rew s)</span></span></span><br><span><var>i</var><span class="hyp-type"><b>: </b><span>index</span></span></span><br><span><var>im</var><span class="hyp-type"><b>: </b><span>message</span></span></span><br><span><var>Him</var><span class="hyp-type"><b>: </b><span>initial_message_prop im</span></span></span><br><span><var>Hi</var><span class="hyp-type"><b>: </b><span>im = m</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">initial_message_prop m</div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="Composition-v-chk264" style="display: none" type="checkbox"><label class="alectryon-input" for="Composition-v-chk264"><span class="nb">subst</span> im.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>message, index</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>EqDecision0</var><span class="hyp-type"><b>: </b><span>EqDecision index</span></span></span><br><span><var>IM1, IM2</var><span class="hyp-type"><b>: </b><span>index ‚Üí VLSM message</span></span></span><br><span><var>Heq</var><span class="hyp-type"><b>: </b><span><span class="kr">‚àÄ</span> <span class="nv">i</span> : index, IM1 i = IM2 i</span></span></span><br><span><var>constraint1</var><span class="hyp-type"><b>: </b><span>composite_label IM1
‚Üí composite_state IM1 * option message
  ‚Üí <span class="kt">Prop</span></span></span></span><br><span><var>constraint2</var><span class="hyp-type"><b>: </b><span>composite_label IM2
‚Üí composite_state IM2 * option message
  ‚Üí <span class="kt">Prop</span></span></span></span><br><span><var>constraint_projection</var><span class="hyp-type"><b>: </b><span><span class="kr">‚àÄ</span> <span class="nv">s1</span> : state,
  valid_state_prop
    (pre_loaded_with_all_messages_vlsm
       (free_composite_vlsm
          IM1)) s1
  ‚Üí <span class="kr">‚àÄ</span> (<span class="nv">l1</span> : composite_label
              IM1) (<span class="nv">om</span> : 
                    option
                      message),
      constraint1 l1 (s1, om)
      ‚Üí constraint2
          (same_IM_label_rew
             l1)
          (same_IM_state_rew
             s1, om)</span></span></span><br><span><var>seed</var><span class="hyp-type"><b>: </b><span>message ‚Üí <span class="kt">Prop</span></span></span></span><br><span><var>l</var><span class="hyp-type"><b>: </b><span>label</span></span></span><br><span><var>s</var><span class="hyp-type"><b>: </b><span>state</span></span></span><br><span><var>m</var><span class="hyp-type"><b>: </b><span>message</span></span></span><br><span><var>Hv</var><span class="hyp-type"><b>: </b><span>input_valid
  (pre_loaded_vlsm
     (composite_vlsm IM1 constraint1) seed) l
  (s, Some m)</span></span></span><br><span><var>HsY</var><span class="hyp-type"><b>: </b><span>valid_state_prop
  (pre_loaded_vlsm
     (composite_vlsm IM2 constraint2) seed)
  (same_IM_state_rew s)</span></span></span><br><span><var>i</var><span class="hyp-type"><b>: </b><span>index</span></span></span><br><span><var>Him</var><span class="hyp-type"><b>: </b><span>initial_message_prop m</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">initial_message_prop m</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="Composition-v-chk265" style="display: none" type="checkbox"><label class="alectryon-input" for="Composition-v-chk265"><span class="nb">cbn</span>.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>message, index</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>EqDecision0</var><span class="hyp-type"><b>: </b><span>EqDecision index</span></span></span><br><span><var>IM1, IM2</var><span class="hyp-type"><b>: </b><span>index ‚Üí VLSM message</span></span></span><br><span><var>Heq</var><span class="hyp-type"><b>: </b><span><span class="kr">‚àÄ</span> <span class="nv">i</span> : index, IM1 i = IM2 i</span></span></span><br><span><var>constraint1</var><span class="hyp-type"><b>: </b><span>composite_label IM1
‚Üí composite_state IM1 * option message
  ‚Üí <span class="kt">Prop</span></span></span></span><br><span><var>constraint2</var><span class="hyp-type"><b>: </b><span>composite_label IM2
‚Üí composite_state IM2 * option message
  ‚Üí <span class="kt">Prop</span></span></span></span><br><span><var>constraint_projection</var><span class="hyp-type"><b>: </b><span><span class="kr">‚àÄ</span> <span class="nv">s1</span> : state,
  valid_state_prop
    (pre_loaded_with_all_messages_vlsm
       (free_composite_vlsm
          IM1)) s1
  ‚Üí <span class="kr">‚àÄ</span> (<span class="nv">l1</span> : composite_label
              IM1) (<span class="nv">om</span> : 
                    option
                      message),
      constraint1 l1 (s1, om)
      ‚Üí constraint2
          (same_IM_label_rew
             l1)
          (same_IM_state_rew
             s1, om)</span></span></span><br><span><var>seed</var><span class="hyp-type"><b>: </b><span>message ‚Üí <span class="kt">Prop</span></span></span></span><br><span><var>l</var><span class="hyp-type"><b>: </b><span>label</span></span></span><br><span><var>s</var><span class="hyp-type"><b>: </b><span>state</span></span></span><br><span><var>m</var><span class="hyp-type"><b>: </b><span>message</span></span></span><br><span><var>Hv</var><span class="hyp-type"><b>: </b><span>input_valid
  (pre_loaded_vlsm
     (composite_vlsm IM1 constraint1) seed) l
  (s, Some m)</span></span></span><br><span><var>HsY</var><span class="hyp-type"><b>: </b><span>valid_state_prop
  (pre_loaded_vlsm
     (composite_vlsm IM2 constraint2) seed)
  (same_IM_state_rew s)</span></span></span><br><span><var>i</var><span class="hyp-type"><b>: </b><span>index</span></span></span><br><span><var>Him</var><span class="hyp-type"><b>: </b><span>initial_message_prop m</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">composite_initial_message_prop IM2 m ‚à® seed m</div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="Composition-v-chk266" style="display: none" type="checkbox"><label class="alectryon-input" for="Composition-v-chk266"><span class="nb">unfold</span> composite_initial_message_prop.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>message, index</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>EqDecision0</var><span class="hyp-type"><b>: </b><span>EqDecision index</span></span></span><br><span><var>IM1, IM2</var><span class="hyp-type"><b>: </b><span>index ‚Üí VLSM message</span></span></span><br><span><var>Heq</var><span class="hyp-type"><b>: </b><span><span class="kr">‚àÄ</span> <span class="nv">i</span> : index, IM1 i = IM2 i</span></span></span><br><span><var>constraint1</var><span class="hyp-type"><b>: </b><span>composite_label IM1
‚Üí composite_state IM1 * option message
  ‚Üí <span class="kt">Prop</span></span></span></span><br><span><var>constraint2</var><span class="hyp-type"><b>: </b><span>composite_label IM2
‚Üí composite_state IM2 * option message
  ‚Üí <span class="kt">Prop</span></span></span></span><br><span><var>constraint_projection</var><span class="hyp-type"><b>: </b><span><span class="kr">‚àÄ</span> <span class="nv">s1</span> : state,
  valid_state_prop
    (pre_loaded_with_all_messages_vlsm
       (free_composite_vlsm
          IM1)) s1
  ‚Üí <span class="kr">‚àÄ</span> (<span class="nv">l1</span> : composite_label
              IM1) (<span class="nv">om</span> : 
                    option
                      message),
      constraint1 l1 (s1, om)
      ‚Üí constraint2
          (same_IM_label_rew
             l1)
          (same_IM_state_rew
             s1, om)</span></span></span><br><span><var>seed</var><span class="hyp-type"><b>: </b><span>message ‚Üí <span class="kt">Prop</span></span></span></span><br><span><var>l</var><span class="hyp-type"><b>: </b><span>label</span></span></span><br><span><var>s</var><span class="hyp-type"><b>: </b><span>state</span></span></span><br><span><var>m</var><span class="hyp-type"><b>: </b><span>message</span></span></span><br><span><var>Hv</var><span class="hyp-type"><b>: </b><span>input_valid
  (pre_loaded_vlsm
     (composite_vlsm IM1 constraint1) seed) l
  (s, Some m)</span></span></span><br><span><var>HsY</var><span class="hyp-type"><b>: </b><span>valid_state_prop
  (pre_loaded_vlsm
     (composite_vlsm IM2 constraint2) seed)
  (same_IM_state_rew s)</span></span></span><br><span><var>i</var><span class="hyp-type"><b>: </b><span>index</span></span></span><br><span><var>Him</var><span class="hyp-type"><b>: </b><span>initial_message_prop m</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">(<span class="kr">‚àÉ</span> (<span class="nv">n</span> : index) (<span class="nv">mi</span> : vinitial_message (IM2 n)),
   `mi = m) ‚à® seed m</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="Composition-v-chk267" style="display: none" type="checkbox"><label class="alectryon-input" for="Composition-v-chk267"><span class="nb">left</span>.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>message, index</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>EqDecision0</var><span class="hyp-type"><b>: </b><span>EqDecision index</span></span></span><br><span><var>IM1, IM2</var><span class="hyp-type"><b>: </b><span>index ‚Üí VLSM message</span></span></span><br><span><var>Heq</var><span class="hyp-type"><b>: </b><span><span class="kr">‚àÄ</span> <span class="nv">i</span> : index, IM1 i = IM2 i</span></span></span><br><span><var>constraint1</var><span class="hyp-type"><b>: </b><span>composite_label IM1
‚Üí composite_state IM1 * option message
  ‚Üí <span class="kt">Prop</span></span></span></span><br><span><var>constraint2</var><span class="hyp-type"><b>: </b><span>composite_label IM2
‚Üí composite_state IM2 * option message
  ‚Üí <span class="kt">Prop</span></span></span></span><br><span><var>constraint_projection</var><span class="hyp-type"><b>: </b><span><span class="kr">‚àÄ</span> <span class="nv">s1</span> : state,
  valid_state_prop
    (pre_loaded_with_all_messages_vlsm
       (free_composite_vlsm
          IM1)) s1
  ‚Üí <span class="kr">‚àÄ</span> (<span class="nv">l1</span> : composite_label
              IM1) (<span class="nv">om</span> : 
                    option
                      message),
      constraint1 l1 (s1, om)
      ‚Üí constraint2
          (same_IM_label_rew
             l1)
          (same_IM_state_rew
             s1, om)</span></span></span><br><span><var>seed</var><span class="hyp-type"><b>: </b><span>message ‚Üí <span class="kt">Prop</span></span></span></span><br><span><var>l</var><span class="hyp-type"><b>: </b><span>label</span></span></span><br><span><var>s</var><span class="hyp-type"><b>: </b><span>state</span></span></span><br><span><var>m</var><span class="hyp-type"><b>: </b><span>message</span></span></span><br><span><var>Hv</var><span class="hyp-type"><b>: </b><span>input_valid
  (pre_loaded_vlsm
     (composite_vlsm IM1 constraint1) seed) l
  (s, Some m)</span></span></span><br><span><var>HsY</var><span class="hyp-type"><b>: </b><span>valid_state_prop
  (pre_loaded_vlsm
     (composite_vlsm IM2 constraint2) seed)
  (same_IM_state_rew s)</span></span></span><br><span><var>i</var><span class="hyp-type"><b>: </b><span>index</span></span></span><br><span><var>Him</var><span class="hyp-type"><b>: </b><span>initial_message_prop m</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="kr">‚àÉ</span> (<span class="nv">n</span> : index) (<span class="nv">mi</span> : vinitial_message (IM2 n)), `mi = m</div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="Composition-v-chk268" style="display: none" type="checkbox"><label class="alectryon-input" for="Composition-v-chk268"><span class="kr">exists</span> <span class="nv">i</span>.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>message, index</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>EqDecision0</var><span class="hyp-type"><b>: </b><span>EqDecision index</span></span></span><br><span><var>IM1, IM2</var><span class="hyp-type"><b>: </b><span>index ‚Üí VLSM message</span></span></span><br><span><var>Heq</var><span class="hyp-type"><b>: </b><span><span class="kr">‚àÄ</span> <span class="nv">i</span> : index, IM1 i = IM2 i</span></span></span><br><span><var>constraint1</var><span class="hyp-type"><b>: </b><span>composite_label IM1
‚Üí composite_state IM1 * option message
  ‚Üí <span class="kt">Prop</span></span></span></span><br><span><var>constraint2</var><span class="hyp-type"><b>: </b><span>composite_label IM2
‚Üí composite_state IM2 * option message
  ‚Üí <span class="kt">Prop</span></span></span></span><br><span><var>constraint_projection</var><span class="hyp-type"><b>: </b><span><span class="kr">‚àÄ</span> <span class="nv">s1</span> : state,
  valid_state_prop
    (pre_loaded_with_all_messages_vlsm
       (free_composite_vlsm
          IM1)) s1
  ‚Üí <span class="kr">‚àÄ</span> (<span class="nv">l1</span> : composite_label
              IM1) (<span class="nv">om</span> : 
                    option
                      message),
      constraint1 l1 (s1, om)
      ‚Üí constraint2
          (same_IM_label_rew
             l1)
          (same_IM_state_rew
             s1, om)</span></span></span><br><span><var>seed</var><span class="hyp-type"><b>: </b><span>message ‚Üí <span class="kt">Prop</span></span></span></span><br><span><var>l</var><span class="hyp-type"><b>: </b><span>label</span></span></span><br><span><var>s</var><span class="hyp-type"><b>: </b><span>state</span></span></span><br><span><var>m</var><span class="hyp-type"><b>: </b><span>message</span></span></span><br><span><var>Hv</var><span class="hyp-type"><b>: </b><span>input_valid
  (pre_loaded_vlsm
     (composite_vlsm IM1 constraint1) seed) l
  (s, Some m)</span></span></span><br><span><var>HsY</var><span class="hyp-type"><b>: </b><span>valid_state_prop
  (pre_loaded_vlsm
     (composite_vlsm IM2 constraint2) seed)
  (same_IM_state_rew s)</span></span></span><br><span><var>i</var><span class="hyp-type"><b>: </b><span>index</span></span></span><br><span><var>Him</var><span class="hyp-type"><b>: </b><span>initial_message_prop m</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="kr">‚àÉ</span> <span class="nv">mi</span> : vinitial_message (IM2 i), `mi = m</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="Composition-v-chk269" style="display: none" type="checkbox"><label class="alectryon-input" for="Composition-v-chk269"><span class="nb">assert</span> (Hm : vinitial_message_prop (IM2 i) m).</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>message, index</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>EqDecision0</var><span class="hyp-type"><b>: </b><span>EqDecision index</span></span></span><br><span><var>IM1, IM2</var><span class="hyp-type"><b>: </b><span>index ‚Üí VLSM message</span></span></span><br><span><var>Heq</var><span class="hyp-type"><b>: </b><span><span class="kr">‚àÄ</span> <span class="nv">i</span> : index, IM1 i = IM2 i</span></span></span><br><span><var>constraint1</var><span class="hyp-type"><b>: </b><span>composite_label IM1
‚Üí composite_state IM1 * option message
  ‚Üí <span class="kt">Prop</span></span></span></span><br><span><var>constraint2</var><span class="hyp-type"><b>: </b><span>composite_label IM2
‚Üí composite_state IM2 * option message
  ‚Üí <span class="kt">Prop</span></span></span></span><br><span><var>constraint_projection</var><span class="hyp-type"><b>: </b><span><span class="kr">‚àÄ</span> <span class="nv">s1</span> : state,
  valid_state_prop
    (pre_loaded_with_all_messages_vlsm
       (free_composite_vlsm
          IM1)) s1
  ‚Üí <span class="kr">‚àÄ</span> (<span class="nv">l1</span> : composite_label
              IM1) (<span class="nv">om</span> : 
                    option
                      message),
      constraint1 l1 (s1, om)
      ‚Üí constraint2
          (same_IM_label_rew
             l1)
          (same_IM_state_rew
             s1, om)</span></span></span><br><span><var>seed</var><span class="hyp-type"><b>: </b><span>message ‚Üí <span class="kt">Prop</span></span></span></span><br><span><var>l</var><span class="hyp-type"><b>: </b><span>label</span></span></span><br><span><var>s</var><span class="hyp-type"><b>: </b><span>state</span></span></span><br><span><var>m</var><span class="hyp-type"><b>: </b><span>message</span></span></span><br><span><var>Hv</var><span class="hyp-type"><b>: </b><span>input_valid
  (pre_loaded_vlsm
     (composite_vlsm IM1 constraint1) seed) l
  (s, Some m)</span></span></span><br><span><var>HsY</var><span class="hyp-type"><b>: </b><span>valid_state_prop
  (pre_loaded_vlsm
     (composite_vlsm IM2 constraint2) seed)
  (same_IM_state_rew s)</span></span></span><br><span><var>i</var><span class="hyp-type"><b>: </b><span>index</span></span></span><br><span><var>Him</var><span class="hyp-type"><b>: </b><span>initial_message_prop m</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">vinitial_message_prop (IM2 i) m</div></blockquote><div class="alectryon-extra-goals"><input class="alectryon-extra-goal-toggle" id="Composition-v-chk26a" style="display: none" type="checkbox"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>message, index</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>EqDecision0</var><span class="hyp-type"><b>: </b><span>EqDecision index</span></span></span><br><span><var>IM1, IM2</var><span class="hyp-type"><b>: </b><span>index ‚Üí VLSM message</span></span></span><br><span><var>Heq</var><span class="hyp-type"><b>: </b><span><span class="kr">‚àÄ</span> <span class="nv">i</span> : index, IM1 i = IM2 i</span></span></span><br><span><var>constraint1</var><span class="hyp-type"><b>: </b><span>composite_label IM1
‚Üí composite_state IM1 * option message
  ‚Üí <span class="kt">Prop</span></span></span></span><br><span><var>constraint2</var><span class="hyp-type"><b>: </b><span>composite_label IM2
‚Üí composite_state IM2 * option message
  ‚Üí <span class="kt">Prop</span></span></span></span><br><span><var>constraint_projection</var><span class="hyp-type"><b>: </b><span><span class="kr">‚àÄ</span> <span class="nv">s1</span> : state,
  valid_state_prop
    (pre_loaded_with_all_messages_vlsm
       (free_composite_vlsm
          IM1)) s1
  ‚Üí <span class="kr">‚àÄ</span> (<span class="nv">l1</span> : composite_label
              IM1) (<span class="nv">om</span> : 
                    option
                      message),
      constraint1 l1 (s1, om)
      ‚Üí constraint2
          (same_IM_label_rew
             l1)
          (same_IM_state_rew
             s1, om)</span></span></span><br><span><var>seed</var><span class="hyp-type"><b>: </b><span>message ‚Üí <span class="kt">Prop</span></span></span></span><br><span><var>l</var><span class="hyp-type"><b>: </b><span>label</span></span></span><br><span><var>s</var><span class="hyp-type"><b>: </b><span>state</span></span></span><br><span><var>m</var><span class="hyp-type"><b>: </b><span>message</span></span></span><br><span><var>Hv</var><span class="hyp-type"><b>: </b><span>input_valid
  (pre_loaded_vlsm
     (composite_vlsm IM1 constraint1) seed) l
  (s, Some m)</span></span></span><br><span><var>HsY</var><span class="hyp-type"><b>: </b><span>valid_state_prop
  (pre_loaded_vlsm
     (composite_vlsm IM2 constraint2) seed)
  (same_IM_state_rew s)</span></span></span><br><span><var>i</var><span class="hyp-type"><b>: </b><span>index</span></span></span><br><span><var>Him</var><span class="hyp-type"><b>: </b><span>initial_message_prop m</span></span></span><br><span><var>Hm</var><span class="hyp-type"><b>: </b><span>vinitial_message_prop (IM2 i) m</span></span></span><br></div><label class="goal-separator" for="Composition-v-chk26a"><hr></label><div class="goal-conclusion"><span class="kr">‚àÉ</span> <span class="nv">mi</span> : vinitial_message (IM2 i), `mi = m</div></blockquote></div></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="Composition-v-chk26b" style="display: none" type="checkbox"><label class="alectryon-input" for="Composition-v-chk26b">+</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>message, index</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>EqDecision0</var><span class="hyp-type"><b>: </b><span>EqDecision index</span></span></span><br><span><var>IM1, IM2</var><span class="hyp-type"><b>: </b><span>index ‚Üí VLSM message</span></span></span><br><span><var>Heq</var><span class="hyp-type"><b>: </b><span><span class="kr">‚àÄ</span> <span class="nv">i</span> : index, IM1 i = IM2 i</span></span></span><br><span><var>constraint1</var><span class="hyp-type"><b>: </b><span>composite_label IM1
‚Üí composite_state IM1 * option message
  ‚Üí <span class="kt">Prop</span></span></span></span><br><span><var>constraint2</var><span class="hyp-type"><b>: </b><span>composite_label IM2
‚Üí composite_state IM2 * option message
  ‚Üí <span class="kt">Prop</span></span></span></span><br><span><var>constraint_projection</var><span class="hyp-type"><b>: </b><span><span class="kr">‚àÄ</span> <span class="nv">s1</span> : state,
  valid_state_prop
    (pre_loaded_with_all_messages_vlsm
       (free_composite_vlsm
          IM1)) s1
  ‚Üí <span class="kr">‚àÄ</span> (<span class="nv">l1</span> : composite_label
              IM1) (<span class="nv">om</span> : 
                    option
                      message),
      constraint1 l1 (s1, om)
      ‚Üí constraint2
          (same_IM_label_rew
             l1)
          (same_IM_state_rew
             s1, om)</span></span></span><br><span><var>seed</var><span class="hyp-type"><b>: </b><span>message ‚Üí <span class="kt">Prop</span></span></span></span><br><span><var>l</var><span class="hyp-type"><b>: </b><span>label</span></span></span><br><span><var>s</var><span class="hyp-type"><b>: </b><span>state</span></span></span><br><span><var>m</var><span class="hyp-type"><b>: </b><span>message</span></span></span><br><span><var>Hv</var><span class="hyp-type"><b>: </b><span>input_valid
  (pre_loaded_vlsm
     (composite_vlsm IM1 constraint1) seed) l
  (s, Some m)</span></span></span><br><span><var>HsY</var><span class="hyp-type"><b>: </b><span>valid_state_prop
  (pre_loaded_vlsm
     (composite_vlsm IM2 constraint2) seed)
  (same_IM_state_rew s)</span></span></span><br><span><var>i</var><span class="hyp-type"><b>: </b><span>index</span></span></span><br><span><var>Him</var><span class="hyp-type"><b>: </b><span>initial_message_prop m</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">vinitial_message_prop (IM2 i) m</div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="nb">eapply</span> same_VLSM_initial_message_preservation; <span class="nb">eauto</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="Composition-v-chk26c" style="display: none" type="checkbox"><label class="alectryon-input" for="Composition-v-chk26c">+</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>message, index</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>EqDecision0</var><span class="hyp-type"><b>: </b><span>EqDecision index</span></span></span><br><span><var>IM1, IM2</var><span class="hyp-type"><b>: </b><span>index ‚Üí VLSM message</span></span></span><br><span><var>Heq</var><span class="hyp-type"><b>: </b><span><span class="kr">‚àÄ</span> <span class="nv">i</span> : index, IM1 i = IM2 i</span></span></span><br><span><var>constraint1</var><span class="hyp-type"><b>: </b><span>composite_label IM1
‚Üí composite_state IM1 * option message
  ‚Üí <span class="kt">Prop</span></span></span></span><br><span><var>constraint2</var><span class="hyp-type"><b>: </b><span>composite_label IM2
‚Üí composite_state IM2 * option message
  ‚Üí <span class="kt">Prop</span></span></span></span><br><span><var>constraint_projection</var><span class="hyp-type"><b>: </b><span><span class="kr">‚àÄ</span> <span class="nv">s1</span> : state,
  valid_state_prop
    (pre_loaded_with_all_messages_vlsm
       (free_composite_vlsm
          IM1)) s1
  ‚Üí <span class="kr">‚àÄ</span> (<span class="nv">l1</span> : composite_label
              IM1) (<span class="nv">om</span> : 
                    option
                      message),
      constraint1 l1 (s1, om)
      ‚Üí constraint2
          (same_IM_label_rew
             l1)
          (same_IM_state_rew
             s1, om)</span></span></span><br><span><var>seed</var><span class="hyp-type"><b>: </b><span>message ‚Üí <span class="kt">Prop</span></span></span></span><br><span><var>l</var><span class="hyp-type"><b>: </b><span>label</span></span></span><br><span><var>s</var><span class="hyp-type"><b>: </b><span>state</span></span></span><br><span><var>m</var><span class="hyp-type"><b>: </b><span>message</span></span></span><br><span><var>Hv</var><span class="hyp-type"><b>: </b><span>input_valid
  (pre_loaded_vlsm
     (composite_vlsm IM1 constraint1) seed) l
  (s, Some m)</span></span></span><br><span><var>HsY</var><span class="hyp-type"><b>: </b><span>valid_state_prop
  (pre_loaded_vlsm
     (composite_vlsm IM2 constraint2) seed)
  (same_IM_state_rew s)</span></span></span><br><span><var>i</var><span class="hyp-type"><b>: </b><span>index</span></span></span><br><span><var>Him</var><span class="hyp-type"><b>: </b><span>initial_message_prop m</span></span></span><br><span><var>Hm</var><span class="hyp-type"><b>: </b><span>vinitial_message_prop (IM2 i) m</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="kr">‚àÉ</span> <span class="nv">mi</span> : vinitial_message (IM2 i), `mi = m</div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="bp">by</span> <span class="kr">exists</span> (<span class="nv">exist</span> <span class="nv">_</span> <span class="nv">m</span> <span class="nv">Hm</span>).</span><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Qed</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
</span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">End</span> <span class="nf">pre_loaded_constrained</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
</span><span class="alectryon-sentence"><input class="alectryon-toggle" id="Composition-v-chk26d" style="display: none" type="checkbox"><label class="alectryon-input" for="Composition-v-chk26d"><span class="kn">Lemma</span> <span class="nf">same_IM_preloaded_free_full_projection</span>
  : VLSM_full_projection
    (pre_loaded_with_all_messages_vlsm (free_composite_vlsm IM1))
    (pre_loaded_with_all_messages_vlsm (free_composite_vlsm IM2))
    same_IM_label_rew
    same_IM_state_rew.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>message, index</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>EqDecision0</var><span class="hyp-type"><b>: </b><span>EqDecision index</span></span></span><br><span><var>IM1, IM2</var><span class="hyp-type"><b>: </b><span>index ‚Üí VLSM message</span></span></span><br><span><var>Heq</var><span class="hyp-type"><b>: </b><span><span class="kr">‚àÄ</span> <span class="nv">i</span> : index, IM1 i = IM2 i</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">VLSM_full_projection
  (pre_loaded_with_all_messages_vlsm
     (free_composite_vlsm IM1))
  (pre_loaded_with_all_messages_vlsm
     (free_composite_vlsm IM2)) same_IM_label_rew
  same_IM_state_rew</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="Composition-v-chk26e" style="display: none" type="checkbox"><label class="alectryon-input" for="Composition-v-chk26e"><span class="kn">Proof</span>.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>message, index</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>EqDecision0</var><span class="hyp-type"><b>: </b><span>EqDecision index</span></span></span><br><span><var>IM1, IM2</var><span class="hyp-type"><b>: </b><span>index ‚Üí VLSM message</span></span></span><br><span><var>Heq</var><span class="hyp-type"><b>: </b><span><span class="kr">‚àÄ</span> <span class="nv">i</span> : index, IM1 i = IM2 i</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">VLSM_full_projection
  (pre_loaded_with_all_messages_vlsm
     (free_composite_vlsm IM1))
  (pre_loaded_with_all_messages_vlsm
     (free_composite_vlsm IM2)) same_IM_label_rew
  same_IM_state_rew</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="Composition-v-chk26f" style="display: none" type="checkbox"><label class="alectryon-input" for="Composition-v-chk26f"><span class="nb">constructor</span>.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>message, index</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>EqDecision0</var><span class="hyp-type"><b>: </b><span>EqDecision index</span></span></span><br><span><var>IM1, IM2</var><span class="hyp-type"><b>: </b><span>index ‚Üí VLSM message</span></span></span><br><span><var>Heq</var><span class="hyp-type"><b>: </b><span><span class="kr">‚àÄ</span> <span class="nv">i</span> : index, IM1 i = IM2 i</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="kr">‚àÄ</span> (<span class="nv">sX</span> : state) (<span class="nv">trX</span> : list transition_item),
  finite_valid_trace
    (pre_loaded_with_all_messages_vlsm
       (free_composite_vlsm IM1)) sX trX
  ‚Üí finite_valid_trace
      (pre_loaded_with_all_messages_vlsm
         (free_composite_vlsm IM2))
      (same_IM_state_rew sX)
      (pre_VLSM_full_projection_finite_trace_project
         (type
            (pre_loaded_with_all_messages_vlsm
               (free_composite_vlsm IM1)))
         (type
            (pre_loaded_with_all_messages_vlsm
               (free_composite_vlsm IM2)))
         same_IM_label_rew same_IM_state_rew trX)</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="Composition-v-chk270" style="display: none" type="checkbox"><label class="alectryon-input" for="Composition-v-chk270"><span class="nb">intros</span> s1 tr1 Htr1.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>message, index</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>EqDecision0</var><span class="hyp-type"><b>: </b><span>EqDecision index</span></span></span><br><span><var>IM1, IM2</var><span class="hyp-type"><b>: </b><span>index ‚Üí VLSM message</span></span></span><br><span><var>Heq</var><span class="hyp-type"><b>: </b><span><span class="kr">‚àÄ</span> <span class="nv">i</span> : index, IM1 i = IM2 i</span></span></span><br><span><var>s1</var><span class="hyp-type"><b>: </b><span>state</span></span></span><br><span><var>tr1</var><span class="hyp-type"><b>: </b><span>list transition_item</span></span></span><br><span><var>Htr1</var><span class="hyp-type"><b>: </b><span>finite_valid_trace
  (pre_loaded_with_all_messages_vlsm
     (free_composite_vlsm IM1)) s1 tr1</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">finite_valid_trace
  (pre_loaded_with_all_messages_vlsm
     (free_composite_vlsm IM2)) (same_IM_state_rew s1)
  (pre_VLSM_full_projection_finite_trace_project
     (type
        (pre_loaded_with_all_messages_vlsm
           (free_composite_vlsm IM1)))
     (type
        (pre_loaded_with_all_messages_vlsm
           (free_composite_vlsm IM2)))
     same_IM_label_rew same_IM_state_rew tr1)</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="Composition-v-chk271" style="display: none" type="checkbox"><label class="alectryon-input" for="Composition-v-chk271"><span class="nb">specialize</span> (pre_loaded_with_all_messages_vlsm_is_pre_loaded_with_True (free_composite_vlsm IM1)) <span class="kr">as</span> Heq1.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>message, index</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>EqDecision0</var><span class="hyp-type"><b>: </b><span>EqDecision index</span></span></span><br><span><var>IM1, IM2</var><span class="hyp-type"><b>: </b><span>index ‚Üí VLSM message</span></span></span><br><span><var>Heq</var><span class="hyp-type"><b>: </b><span><span class="kr">‚àÄ</span> <span class="nv">i</span> : index, IM1 i = IM2 i</span></span></span><br><span><var>s1</var><span class="hyp-type"><b>: </b><span>state</span></span></span><br><span><var>tr1</var><span class="hyp-type"><b>: </b><span>list transition_item</span></span></span><br><span><var>Htr1</var><span class="hyp-type"><b>: </b><span>finite_valid_trace
  (pre_loaded_with_all_messages_vlsm
     (free_composite_vlsm IM1)) s1 tr1</span></span></span><br><span><var>Heq1</var><span class="hyp-type"><b>: </b><span>VLSM_eq
  (pre_loaded_with_all_messages_vlsm
     (free_composite_vlsm IM1))
  (pre_loaded_vlsm (free_composite_vlsm IM1)
     (<span class="kr">Œª</span> <span class="nv">_</span> : message, <span class="kt">True</span>))</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">finite_valid_trace
  (pre_loaded_with_all_messages_vlsm
     (free_composite_vlsm IM2)) (same_IM_state_rew s1)
  (pre_VLSM_full_projection_finite_trace_project
     (type
        (pre_loaded_with_all_messages_vlsm
           (free_composite_vlsm IM1)))
     (type
        (pre_loaded_with_all_messages_vlsm
           (free_composite_vlsm IM2)))
     same_IM_label_rew same_IM_state_rew tr1)</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="Composition-v-chk272" style="display: none" type="checkbox"><label class="alectryon-input" for="Composition-v-chk272"><span class="nb">apply</span> (VLSM_eq_finite_valid_trace Heq1) <span class="kr">in</span> Htr1.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>message, index</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>EqDecision0</var><span class="hyp-type"><b>: </b><span>EqDecision index</span></span></span><br><span><var>IM1, IM2</var><span class="hyp-type"><b>: </b><span>index ‚Üí VLSM message</span></span></span><br><span><var>Heq</var><span class="hyp-type"><b>: </b><span><span class="kr">‚àÄ</span> <span class="nv">i</span> : index, IM1 i = IM2 i</span></span></span><br><span><var>s1</var><span class="hyp-type"><b>: </b><span>state</span></span></span><br><span><var>tr1</var><span class="hyp-type"><b>: </b><span>list transition_item</span></span></span><br><span><var>Htr1</var><span class="hyp-type"><b>: </b><span>finite_valid_trace
  {|
    vtype :=
      vtype
        (pre_loaded_with_all_messages_vlsm
           (free_composite_vlsm IM1));
    vmachine :=
      machine
        (pre_loaded_vlsm
           (free_composite_vlsm IM1)
           (<span class="kr">Œª</span> <span class="nv">_</span> : message, <span class="kt">True</span>))
  |} s1 tr1</span></span></span><br><span><var>Heq1</var><span class="hyp-type"><b>: </b><span>VLSM_eq
  (pre_loaded_with_all_messages_vlsm
     (free_composite_vlsm IM1))
  (pre_loaded_vlsm (free_composite_vlsm IM1)
     (<span class="kr">Œª</span> <span class="nv">_</span> : message, <span class="kt">True</span>))</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">finite_valid_trace
  (pre_loaded_with_all_messages_vlsm
     (free_composite_vlsm IM2)) (same_IM_state_rew s1)
  (pre_VLSM_full_projection_finite_trace_project
     (type
        (pre_loaded_with_all_messages_vlsm
           (free_composite_vlsm IM1)))
     (type
        (pre_loaded_with_all_messages_vlsm
           (free_composite_vlsm IM2)))
     same_IM_label_rew same_IM_state_rew tr1)</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="Composition-v-chk273" style="display: none" type="checkbox"><label class="alectryon-input" for="Composition-v-chk273"><span class="nb">clear</span> Heq1.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>message, index</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>EqDecision0</var><span class="hyp-type"><b>: </b><span>EqDecision index</span></span></span><br><span><var>IM1, IM2</var><span class="hyp-type"><b>: </b><span>index ‚Üí VLSM message</span></span></span><br><span><var>Heq</var><span class="hyp-type"><b>: </b><span><span class="kr">‚àÄ</span> <span class="nv">i</span> : index, IM1 i = IM2 i</span></span></span><br><span><var>s1</var><span class="hyp-type"><b>: </b><span>state</span></span></span><br><span><var>tr1</var><span class="hyp-type"><b>: </b><span>list transition_item</span></span></span><br><span><var>Htr1</var><span class="hyp-type"><b>: </b><span>finite_valid_trace
  {|
    vtype :=
      vtype
        (pre_loaded_with_all_messages_vlsm
           (free_composite_vlsm IM1));
    vmachine :=
      machine
        (pre_loaded_vlsm
           (free_composite_vlsm IM1)
           (<span class="kr">Œª</span> <span class="nv">_</span> : message, <span class="kt">True</span>))
  |} s1 tr1</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">finite_valid_trace
  (pre_loaded_with_all_messages_vlsm
     (free_composite_vlsm IM2)) (same_IM_state_rew s1)
  (pre_VLSM_full_projection_finite_trace_project
     (type
        (pre_loaded_with_all_messages_vlsm
           (free_composite_vlsm IM1)))
     (type
        (pre_loaded_with_all_messages_vlsm
           (free_composite_vlsm IM2)))
     same_IM_label_rew same_IM_state_rew tr1)</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="Composition-v-chk274" style="display: none" type="checkbox"><label class="alectryon-input" for="Composition-v-chk274"><span class="nb">specialize</span> (same_IM_full_projection (free_constraint IM1) (free_constraint IM2))
    <span class="kr">as</span> Hproj.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>message, index</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>EqDecision0</var><span class="hyp-type"><b>: </b><span>EqDecision index</span></span></span><br><span><var>IM1, IM2</var><span class="hyp-type"><b>: </b><span>index ‚Üí VLSM message</span></span></span><br><span><var>Heq</var><span class="hyp-type"><b>: </b><span><span class="kr">‚àÄ</span> <span class="nv">i</span> : index, IM1 i = IM2 i</span></span></span><br><span><var>s1</var><span class="hyp-type"><b>: </b><span>state</span></span></span><br><span><var>tr1</var><span class="hyp-type"><b>: </b><span>list transition_item</span></span></span><br><span><var>Htr1</var><span class="hyp-type"><b>: </b><span>finite_valid_trace
  {|
    vtype :=
      vtype
        (pre_loaded_with_all_messages_vlsm
           (free_composite_vlsm IM1));
    vmachine :=
      machine
        (pre_loaded_vlsm
           (free_composite_vlsm IM1)
           (<span class="kr">Œª</span> <span class="nv">_</span> : message, <span class="kt">True</span>))
  |} s1 tr1</span></span></span><br><span><var>Hproj</var><span class="hyp-type"><b>: </b><span>(<span class="kr">‚àÄ</span> <span class="nv">s1</span> : state,
   valid_state_prop
     (pre_loaded_with_all_messages_vlsm
        (free_composite_vlsm IM1)) s1
   ‚Üí <span class="kr">‚àÄ</span> (<span class="nv">l1</span> : composite_label IM1) 
       (<span class="nv">om</span> : option message),
       free_constraint IM1 l1 (s1, om)
       ‚Üí free_constraint IM2
           (same_IM_label_rew l1)
           (same_IM_state_rew s1, om))
‚Üí <span class="kr">‚àÄ</span> <span class="nv">seed</span> : message ‚Üí <span class="kt">Prop</span>,
    VLSM_full_projection
      (pre_loaded_vlsm
         (composite_vlsm IM1
            (free_constraint IM1)) seed)
      (pre_loaded_vlsm
         (composite_vlsm IM2
            (free_constraint IM2)) seed)
      same_IM_label_rew same_IM_state_rew</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">finite_valid_trace
  (pre_loaded_with_all_messages_vlsm
     (free_composite_vlsm IM2)) (same_IM_state_rew s1)
  (pre_VLSM_full_projection_finite_trace_project
     (type
        (pre_loaded_with_all_messages_vlsm
           (free_composite_vlsm IM1)))
     (type
        (pre_loaded_with_all_messages_vlsm
           (free_composite_vlsm IM2)))
     same_IM_label_rew same_IM_state_rew tr1)</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="Composition-v-chk275" style="display: none" type="checkbox"><label class="alectryon-input" for="Composition-v-chk275">spec Hproj; [<span class="bp">done</span> |].</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>message, index</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>EqDecision0</var><span class="hyp-type"><b>: </b><span>EqDecision index</span></span></span><br><span><var>IM1, IM2</var><span class="hyp-type"><b>: </b><span>index ‚Üí VLSM message</span></span></span><br><span><var>Heq</var><span class="hyp-type"><b>: </b><span><span class="kr">‚àÄ</span> <span class="nv">i</span> : index, IM1 i = IM2 i</span></span></span><br><span><var>s1</var><span class="hyp-type"><b>: </b><span>state</span></span></span><br><span><var>tr1</var><span class="hyp-type"><b>: </b><span>list transition_item</span></span></span><br><span><var>Htr1</var><span class="hyp-type"><b>: </b><span>finite_valid_trace
  {|
    vtype :=
      vtype
        (pre_loaded_with_all_messages_vlsm
           (free_composite_vlsm IM1));
    vmachine :=
      machine
        (pre_loaded_vlsm
           (free_composite_vlsm IM1)
           (<span class="kr">Œª</span> <span class="nv">_</span> : message, <span class="kt">True</span>))
  |} s1 tr1</span></span></span><br><span><var>Hproj</var><span class="hyp-type"><b>: </b><span><span class="kr">‚àÄ</span> <span class="nv">seed</span> : message ‚Üí <span class="kt">Prop</span>,
  VLSM_full_projection
    (pre_loaded_vlsm
       (composite_vlsm IM1
          (free_constraint IM1)) seed)
    (pre_loaded_vlsm
       (composite_vlsm IM2
          (free_constraint IM2)) seed)
    same_IM_label_rew same_IM_state_rew</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">finite_valid_trace
  (pre_loaded_with_all_messages_vlsm
     (free_composite_vlsm IM2)) (same_IM_state_rew s1)
  (pre_VLSM_full_projection_finite_trace_project
     (type
        (pre_loaded_with_all_messages_vlsm
           (free_composite_vlsm IM1)))
     (type
        (pre_loaded_with_all_messages_vlsm
           (free_composite_vlsm IM2)))
     same_IM_label_rew same_IM_state_rew tr1)</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="Composition-v-chk276" style="display: none" type="checkbox"><label class="alectryon-input" for="Composition-v-chk276"><span class="nb">specialize</span> (Hproj (<span class="kr">fun</span> <span class="nv">_</span> =&gt; <span class="kt">True</span>)).</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>message, index</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>EqDecision0</var><span class="hyp-type"><b>: </b><span>EqDecision index</span></span></span><br><span><var>IM1, IM2</var><span class="hyp-type"><b>: </b><span>index ‚Üí VLSM message</span></span></span><br><span><var>Heq</var><span class="hyp-type"><b>: </b><span><span class="kr">‚àÄ</span> <span class="nv">i</span> : index, IM1 i = IM2 i</span></span></span><br><span><var>s1</var><span class="hyp-type"><b>: </b><span>state</span></span></span><br><span><var>tr1</var><span class="hyp-type"><b>: </b><span>list transition_item</span></span></span><br><span><var>Htr1</var><span class="hyp-type"><b>: </b><span>finite_valid_trace
  {|
    vtype :=
      vtype
        (pre_loaded_with_all_messages_vlsm
           (free_composite_vlsm IM1));
    vmachine :=
      machine
        (pre_loaded_vlsm
           (free_composite_vlsm IM1)
           (<span class="kr">Œª</span> <span class="nv">_</span> : message, <span class="kt">True</span>))
  |} s1 tr1</span></span></span><br><span><var>Hproj</var><span class="hyp-type"><b>: </b><span>VLSM_full_projection
  (pre_loaded_vlsm
     (composite_vlsm IM1 (free_constraint IM1))
     (<span class="kr">Œª</span> <span class="nv">_</span> : message, <span class="kt">True</span>))
  (pre_loaded_vlsm
     (composite_vlsm IM2 (free_constraint IM2))
     (<span class="kr">Œª</span> <span class="nv">_</span> : message, <span class="kt">True</span>)) same_IM_label_rew
  same_IM_state_rew</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">finite_valid_trace
  (pre_loaded_with_all_messages_vlsm
     (free_composite_vlsm IM2)) (same_IM_state_rew s1)
  (pre_VLSM_full_projection_finite_trace_project
     (type
        (pre_loaded_with_all_messages_vlsm
           (free_composite_vlsm IM1)))
     (type
        (pre_loaded_with_all_messages_vlsm
           (free_composite_vlsm IM2)))
     same_IM_label_rew same_IM_state_rew tr1)</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="Composition-v-chk277" style="display: none" type="checkbox"><label class="alectryon-input" for="Composition-v-chk277"><span class="nb">apply</span> (VLSM_full_projection_finite_valid_trace Hproj) <span class="kr">in</span> Htr1.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>message, index</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>EqDecision0</var><span class="hyp-type"><b>: </b><span>EqDecision index</span></span></span><br><span><var>IM1, IM2</var><span class="hyp-type"><b>: </b><span>index ‚Üí VLSM message</span></span></span><br><span><var>Heq</var><span class="hyp-type"><b>: </b><span><span class="kr">‚àÄ</span> <span class="nv">i</span> : index, IM1 i = IM2 i</span></span></span><br><span><var>s1</var><span class="hyp-type"><b>: </b><span>state</span></span></span><br><span><var>tr1</var><span class="hyp-type"><b>: </b><span>list transition_item</span></span></span><br><span><var>Hproj</var><span class="hyp-type"><b>: </b><span>VLSM_full_projection
  (pre_loaded_vlsm
     (composite_vlsm IM1 (free_constraint IM1))
     (<span class="kr">Œª</span> <span class="nv">_</span> : message, <span class="kt">True</span>))
  (pre_loaded_vlsm
     (composite_vlsm IM2 (free_constraint IM2))
     (<span class="kr">Œª</span> <span class="nv">_</span> : message, <span class="kt">True</span>)) same_IM_label_rew
  same_IM_state_rew</span></span></span><br><span><var>Htr1</var><span class="hyp-type"><b>: </b><span>finite_valid_trace
  (pre_loaded_vlsm
     (composite_vlsm IM2 (free_constraint IM2))
     (<span class="kr">Œª</span> <span class="nv">_</span> : message, <span class="kt">True</span>))
  (same_IM_state_rew s1)
  (VLSM_full_projection_finite_trace_project
     Hproj tr1)</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">finite_valid_trace
  (pre_loaded_with_all_messages_vlsm
     (free_composite_vlsm IM2)) (same_IM_state_rew s1)
  (pre_VLSM_full_projection_finite_trace_project
     (type
        (pre_loaded_with_all_messages_vlsm
           (free_composite_vlsm IM1)))
     (type
        (pre_loaded_with_all_messages_vlsm
           (free_composite_vlsm IM2)))
     same_IM_label_rew same_IM_state_rew tr1)</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="Composition-v-chk278" style="display: none" type="checkbox"><label class="alectryon-input" for="Composition-v-chk278"><span class="nb">specialize</span> (pre_loaded_with_all_messages_vlsm_is_pre_loaded_with_True (free_composite_vlsm IM2)) <span class="kr">as</span> Heq2.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>message, index</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>EqDecision0</var><span class="hyp-type"><b>: </b><span>EqDecision index</span></span></span><br><span><var>IM1, IM2</var><span class="hyp-type"><b>: </b><span>index ‚Üí VLSM message</span></span></span><br><span><var>Heq</var><span class="hyp-type"><b>: </b><span><span class="kr">‚àÄ</span> <span class="nv">i</span> : index, IM1 i = IM2 i</span></span></span><br><span><var>s1</var><span class="hyp-type"><b>: </b><span>state</span></span></span><br><span><var>tr1</var><span class="hyp-type"><b>: </b><span>list transition_item</span></span></span><br><span><var>Hproj</var><span class="hyp-type"><b>: </b><span>VLSM_full_projection
  (pre_loaded_vlsm
     (composite_vlsm IM1 (free_constraint IM1))
     (<span class="kr">Œª</span> <span class="nv">_</span> : message, <span class="kt">True</span>))
  (pre_loaded_vlsm
     (composite_vlsm IM2 (free_constraint IM2))
     (<span class="kr">Œª</span> <span class="nv">_</span> : message, <span class="kt">True</span>)) same_IM_label_rew
  same_IM_state_rew</span></span></span><br><span><var>Htr1</var><span class="hyp-type"><b>: </b><span>finite_valid_trace
  (pre_loaded_vlsm
     (composite_vlsm IM2 (free_constraint IM2))
     (<span class="kr">Œª</span> <span class="nv">_</span> : message, <span class="kt">True</span>))
  (same_IM_state_rew s1)
  (VLSM_full_projection_finite_trace_project
     Hproj tr1)</span></span></span><br><span><var>Heq2</var><span class="hyp-type"><b>: </b><span>VLSM_eq
  (pre_loaded_with_all_messages_vlsm
     (free_composite_vlsm IM2))
  (pre_loaded_vlsm (free_composite_vlsm IM2)
     (<span class="kr">Œª</span> <span class="nv">_</span> : message, <span class="kt">True</span>))</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">finite_valid_trace
  (pre_loaded_with_all_messages_vlsm
     (free_composite_vlsm IM2)) (same_IM_state_rew s1)
  (pre_VLSM_full_projection_finite_trace_project
     (type
        (pre_loaded_with_all_messages_vlsm
           (free_composite_vlsm IM1)))
     (type
        (pre_loaded_with_all_messages_vlsm
           (free_composite_vlsm IM2)))
     same_IM_label_rew same_IM_state_rew tr1)</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><span class="alectryon-input"><span class="bp">by</span> <span class="nb">apply</span> (VLSM_eq_finite_valid_trace Heq2).</span><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Qed</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
</span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">End</span> <span class="nf">sec_same_IM_full_projection</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
</span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Arguments</span> same_IM_label_rew {_ _ _ _} _ _ : <span class="nb">assert</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Arguments</span> same_IM_state_rew {_ _ _ _} _ _ _ : <span class="nb">assert</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
</span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Section</span> <span class="nf">sec_composite_valid_transition</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
</span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Context</span>
  {<span class="nv">message</span> : <span class="kt">Type</span>}
  `{EqDecision index}
  (IM : index -&gt; VLSM message)
  (Free := free_composite_vlsm IM)
  (RFree := pre_loaded_with_all_messages_vlsm Free)
  .</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
</span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Record</span> <span class="nf">CompositeValidTransition</span> <span class="nv">l</span> <span class="nv">s1</span> <span class="nv">iom</span> <span class="nv">s2</span> <span class="nv">oom</span> : <span class="kt">Prop</span> :=
  {
    cvt_valid : composite_valid IM l (s1, iom);
    cvt_transition : composite_transition IM l (s1, iom) = (s2, oom)
  }.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
</span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Definition</span> <span class="nf">composite_valid_transition_item</span>
  (<span class="nv">s</span> : composite_state IM) (<span class="nv">item</span> : composite_transition_item IM) : <span class="kt">Prop</span> :=
  CompositeValidTransition (l item) s (input item) (destination item) (output item).</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
</span><span class="alectryon-sentence"><input class="alectryon-toggle" id="Composition-v-chk279" style="display: none" type="checkbox"><label class="alectryon-input" for="Composition-v-chk279"><span class="kn">Lemma</span> <span class="nf">composite_valid_transition_reachable_iff</span> <span class="nv">l</span> <span class="nv">s1</span> <span class="nv">iom</span> <span class="nv">s2</span> <span class="nv">oom</span> :
  CompositeValidTransition l s1 iom s2 oom &lt;-&gt; ValidTransition RFree l s1 iom s2 oom.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>message, index</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>EqDecision0</var><span class="hyp-type"><b>: </b><span>EqDecision index</span></span></span><br><span><var>IM</var><span class="hyp-type"><b>: </b><span>index ‚Üí VLSM message</span></span></span><br><span><var>Free</var><span><span class="hyp-body"><b>:= </b><span>free_composite_vlsm IM</span></span><span class="hyp-type"><b>: </b><span>VLSM message</span></span></span></span><br><span><var>RFree</var><span><span class="hyp-body"><b>:= </b><span>pre_loaded_with_all_messages_vlsm Free</span></span><span class="hyp-type"><b>: </b><span>VLSM message</span></span></span></span><br><span><var>l</var><span class="hyp-type"><b>: </b><span>composite_label IM</span></span></span><br><span><var>s1</var><span class="hyp-type"><b>: </b><span>composite_state IM</span></span></span><br><span><var>iom</var><span class="hyp-type"><b>: </b><span>option message</span></span></span><br><span><var>s2</var><span class="hyp-type"><b>: </b><span>composite_state IM</span></span></span><br><span><var>oom</var><span class="hyp-type"><b>: </b><span>option message</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">CompositeValidTransition l s1 iom s2 oom
‚Üî ValidTransition RFree l s1 iom s2 oom</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="Composition-v-chk27a" style="display: none" type="checkbox"><label class="alectryon-input" for="Composition-v-chk27a"><span class="kn">Proof</span>.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>message, index</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>EqDecision0</var><span class="hyp-type"><b>: </b><span>EqDecision index</span></span></span><br><span><var>IM</var><span class="hyp-type"><b>: </b><span>index ‚Üí VLSM message</span></span></span><br><span><var>Free</var><span><span class="hyp-body"><b>:= </b><span>free_composite_vlsm IM</span></span><span class="hyp-type"><b>: </b><span>VLSM message</span></span></span></span><br><span><var>RFree</var><span><span class="hyp-body"><b>:= </b><span>pre_loaded_with_all_messages_vlsm Free</span></span><span class="hyp-type"><b>: </b><span>VLSM message</span></span></span></span><br><span><var>l</var><span class="hyp-type"><b>: </b><span>composite_label IM</span></span></span><br><span><var>s1</var><span class="hyp-type"><b>: </b><span>composite_state IM</span></span></span><br><span><var>iom</var><span class="hyp-type"><b>: </b><span>option message</span></span></span><br><span><var>s2</var><span class="hyp-type"><b>: </b><span>composite_state IM</span></span></span><br><span><var>oom</var><span class="hyp-type"><b>: </b><span>option message</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">CompositeValidTransition l s1 iom s2 oom
‚Üî ValidTransition RFree l s1 iom s2 oom</div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="bp">by</span> <span class="nb">firstorder</span>.</span><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Qed</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
</span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Inductive</span> <span class="nf">CompositeValidTransitionNext</span> (<span class="nv">s1</span> <span class="nv">s2</span> : composite_state IM) : <span class="kt">Prop</span> :=
| composite_transition_next : <span class="kr">forall</span> <span class="nv">l</span> <span class="nv">iom</span> <span class="nv">oom</span>,
    CompositeValidTransition l s1 iom s2 oom -&gt;
    CompositeValidTransitionNext s1 s2.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
</span><span class="alectryon-sentence"><input class="alectryon-toggle" id="Composition-v-chk27b" style="display: none" type="checkbox"><label class="alectryon-input" for="Composition-v-chk27b"><span class="kn">Lemma</span> <span class="nf">composite_valid_transition_next</span> :
  <span class="kr">forall</span> <span class="nv">l</span> <span class="nv">s1</span> <span class="nv">iom</span> <span class="nv">s2</span> <span class="nv">oom</span>,
    CompositeValidTransition l s1 iom s2 oom -&gt; CompositeValidTransitionNext s1 s2.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>message, index</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>EqDecision0</var><span class="hyp-type"><b>: </b><span>EqDecision index</span></span></span><br><span><var>IM</var><span class="hyp-type"><b>: </b><span>index ‚Üí VLSM message</span></span></span><br><span><var>Free</var><span><span class="hyp-body"><b>:= </b><span>free_composite_vlsm IM</span></span><span class="hyp-type"><b>: </b><span>VLSM message</span></span></span></span><br><span><var>RFree</var><span><span class="hyp-body"><b>:= </b><span>pre_loaded_with_all_messages_vlsm Free</span></span><span class="hyp-type"><b>: </b><span>VLSM message</span></span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="kr">‚àÄ</span> (<span class="nv">l</span> : composite_label IM) (<span class="nv">s1</span> : composite_state IM) 
  (<span class="nv">iom</span> : option message) (<span class="nv">s2</span> : composite_state IM) 
  (<span class="nv">oom</span> : option message),
  CompositeValidTransition l s1 iom s2 oom
  ‚Üí CompositeValidTransitionNext s1 s2</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="Composition-v-chk27c" style="display: none" type="checkbox"><label class="alectryon-input" for="Composition-v-chk27c"><span class="kn">Proof</span>.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>message, index</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>EqDecision0</var><span class="hyp-type"><b>: </b><span>EqDecision index</span></span></span><br><span><var>IM</var><span class="hyp-type"><b>: </b><span>index ‚Üí VLSM message</span></span></span><br><span><var>Free</var><span><span class="hyp-body"><b>:= </b><span>free_composite_vlsm IM</span></span><span class="hyp-type"><b>: </b><span>VLSM message</span></span></span></span><br><span><var>RFree</var><span><span class="hyp-body"><b>:= </b><span>pre_loaded_with_all_messages_vlsm Free</span></span><span class="hyp-type"><b>: </b><span>VLSM message</span></span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="kr">‚àÄ</span> (<span class="nv">l</span> : composite_label IM) (<span class="nv">s1</span> : composite_state IM) 
  (<span class="nv">iom</span> : option message) (<span class="nv">s2</span> : composite_state IM) 
  (<span class="nv">oom</span> : option message),
  CompositeValidTransition l s1 iom s2 oom
  ‚Üí CompositeValidTransitionNext s1 s2</div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="bp">by</span> <span class="nb">intros</span> * [Hv Ht]; <span class="nb">econstructor</span>.</span><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Qed</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
</span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Definition</span> <span class="nf">composite_valid_transition_future</span> : relation (composite_state IM) :=
  tc CompositeValidTransitionNext.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
</span><span class="alectryon-sentence"><input class="alectryon-toggle" id="Composition-v-chk27d" style="display: none" type="checkbox"><label class="alectryon-input" for="Composition-v-chk27d"><span class="kn">Lemma</span> <span class="nf">CompositeValidTransitionNext_reachable_iff</span> <span class="nv">s1</span> <span class="nv">s2</span> :
  CompositeValidTransitionNext s1 s2 &lt;-&gt; ValidTransitionNext RFree s1 s2.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>message, index</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>EqDecision0</var><span class="hyp-type"><b>: </b><span>EqDecision index</span></span></span><br><span><var>IM</var><span class="hyp-type"><b>: </b><span>index ‚Üí VLSM message</span></span></span><br><span><var>Free</var><span><span class="hyp-body"><b>:= </b><span>free_composite_vlsm IM</span></span><span class="hyp-type"><b>: </b><span>VLSM message</span></span></span></span><br><span><var>RFree</var><span><span class="hyp-body"><b>:= </b><span>pre_loaded_with_all_messages_vlsm Free</span></span><span class="hyp-type"><b>: </b><span>VLSM message</span></span></span></span><br><span><var>s1, s2</var><span class="hyp-type"><b>: </b><span>composite_state IM</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">CompositeValidTransitionNext s1 s2
‚Üî ValidTransitionNext RFree s1 s2</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="Composition-v-chk27e" style="display: none" type="checkbox"><label class="alectryon-input" for="Composition-v-chk27e"><span class="kn">Proof</span>.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>message, index</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>EqDecision0</var><span class="hyp-type"><b>: </b><span>EqDecision index</span></span></span><br><span><var>IM</var><span class="hyp-type"><b>: </b><span>index ‚Üí VLSM message</span></span></span><br><span><var>Free</var><span><span class="hyp-body"><b>:= </b><span>free_composite_vlsm IM</span></span><span class="hyp-type"><b>: </b><span>VLSM message</span></span></span></span><br><span><var>RFree</var><span><span class="hyp-body"><b>:= </b><span>pre_loaded_with_all_messages_vlsm Free</span></span><span class="hyp-type"><b>: </b><span>VLSM message</span></span></span></span><br><span><var>s1, s2</var><span class="hyp-type"><b>: </b><span>composite_state IM</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">CompositeValidTransitionNext s1 s2
‚Üî ValidTransitionNext RFree s1 s2</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><span class="alectryon-input"><span class="bp">by</span> <span class="nb">split</span>; <span class="nb">intros</span> []; <span class="nb">econstructor</span>; <span class="nb">apply</span> composite_valid_transition_reachable_iff.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Qed</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
</span><span class="alectryon-sentence"><input class="alectryon-toggle" id="Composition-v-chk27f" style="display: none" type="checkbox"><label class="alectryon-input" for="Composition-v-chk27f"><span class="kn">Lemma</span> <span class="nf">composite_valid_transition_projection</span> :
  <span class="kr">forall</span> <span class="nv">l</span> <span class="nv">s1</span> <span class="nv">iom</span> <span class="nv">s2</span> <span class="nv">oom</span>,
    CompositeValidTransition l s1 iom s2 oom -&gt;
    ValidTransition (IM (projT1 l)) (projT2 l) (s1 (projT1 l)) iom (s2 (projT1 l)) oom /\
    s2 = state_update IM s1 (projT1 l) (s2 (projT1 l)).</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>message, index</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>EqDecision0</var><span class="hyp-type"><b>: </b><span>EqDecision index</span></span></span><br><span><var>IM</var><span class="hyp-type"><b>: </b><span>index ‚Üí VLSM message</span></span></span><br><span><var>Free</var><span><span class="hyp-body"><b>:= </b><span>free_composite_vlsm IM</span></span><span class="hyp-type"><b>: </b><span>VLSM message</span></span></span></span><br><span><var>RFree</var><span><span class="hyp-body"><b>:= </b><span>pre_loaded_with_all_messages_vlsm Free</span></span><span class="hyp-type"><b>: </b><span>VLSM message</span></span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="kr">‚àÄ</span> (<span class="nv">l</span> : composite_label IM) (<span class="nv">s1</span> : composite_state IM) 
  (<span class="nv">iom</span> : option message) (<span class="nv">s2</span> : composite_state IM) 
  (<span class="nv">oom</span> : option message),
  CompositeValidTransition l s1 iom s2 oom
  ‚Üí ValidTransition (IM (projT1 l)) (projT2 l)
      (s1 (projT1 l)) iom (s2 (projT1 l)) oom
    ‚àß s2 =
      state_update IM s1 (projT1 l) (s2 (projT1 l))</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="Composition-v-chk280" style="display: none" type="checkbox"><label class="alectryon-input" for="Composition-v-chk280"><span class="kn">Proof</span>.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>message, index</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>EqDecision0</var><span class="hyp-type"><b>: </b><span>EqDecision index</span></span></span><br><span><var>IM</var><span class="hyp-type"><b>: </b><span>index ‚Üí VLSM message</span></span></span><br><span><var>Free</var><span><span class="hyp-body"><b>:= </b><span>free_composite_vlsm IM</span></span><span class="hyp-type"><b>: </b><span>VLSM message</span></span></span></span><br><span><var>RFree</var><span><span class="hyp-body"><b>:= </b><span>pre_loaded_with_all_messages_vlsm Free</span></span><span class="hyp-type"><b>: </b><span>VLSM message</span></span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="kr">‚àÄ</span> (<span class="nv">l</span> : composite_label IM) (<span class="nv">s1</span> : composite_state IM) 
  (<span class="nv">iom</span> : option message) (<span class="nv">s2</span> : composite_state IM) 
  (<span class="nv">oom</span> : option message),
  CompositeValidTransition l s1 iom s2 oom
  ‚Üí ValidTransition (IM (projT1 l)) (projT2 l)
      (s1 (projT1 l)) iom (s2 (projT1 l)) oom
    ‚àß s2 =
      state_update IM s1 (projT1 l) (s2 (projT1 l))</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="Composition-v-chk281" style="display: none" type="checkbox"><label class="alectryon-input" for="Composition-v-chk281"><span class="nb">intros</span> [i li] * [Hv Ht]; <span class="nb">cbn</span> <span class="kr">in</span> Ht; <span class="nb">destruct</span> (vtransition _ _ _) <span class="nb">eqn</span>:Hti.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>message, index</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>EqDecision0</var><span class="hyp-type"><b>: </b><span>EqDecision index</span></span></span><br><span><var>IM</var><span class="hyp-type"><b>: </b><span>index ‚Üí VLSM message</span></span></span><br><span><var>Free</var><span><span class="hyp-body"><b>:= </b><span>free_composite_vlsm IM</span></span><span class="hyp-type"><b>: </b><span>VLSM message</span></span></span></span><br><span><var>RFree</var><span><span class="hyp-body"><b>:= </b><span>pre_loaded_with_all_messages_vlsm Free</span></span><span class="hyp-type"><b>: </b><span>VLSM message</span></span></span></span><br><span><var>i</var><span class="hyp-type"><b>: </b><span>index</span></span></span><br><span><var>li</var><span class="hyp-type"><b>: </b><span>vlabel (IM i)</span></span></span><br><span><var>s1</var><span class="hyp-type"><b>: </b><span>composite_state IM</span></span></span><br><span><var>iom</var><span class="hyp-type"><b>: </b><span>option message</span></span></span><br><span><var>s2</var><span class="hyp-type"><b>: </b><span>composite_state IM</span></span></span><br><span><var>oom</var><span class="hyp-type"><b>: </b><span>option message</span></span></span><br><span><var>Hv</var><span class="hyp-type"><b>: </b><span>composite_valid IM (existT i li) (s1, iom)</span></span></span><br><span><var>s</var><span class="hyp-type"><b>: </b><span>state</span></span></span><br><span><var>o</var><span class="hyp-type"><b>: </b><span>option message</span></span></span><br><span><var>Hti</var><span class="hyp-type"><b>: </b><span>vtransition (IM i) li (s1 i, iom) = (s, o)</span></span></span><br><span><var>Ht</var><span class="hyp-type"><b>: </b><span>(state_update IM s1 i s, o) = (s2, oom)</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">ValidTransition (IM (projT1 (existT i li)))
  (projT2 (existT i li)) (s1 (projT1 (existT i li)))
  iom (s2 (projT1 (existT i li))) oom
‚àß s2 =
  state_update IM s1 (projT1 (existT i li))
    (s2 (projT1 (existT i li)))</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><span class="alectryon-input"><span class="bp">by</span> <span class="nb">inversion</span> Ht; <span class="nb">subst</span>; <span class="nb">cbn</span>; state_update_simpl.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Qed</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
</span><span class="alectryon-sentence"><input class="alectryon-toggle" id="Composition-v-chk282" style="display: none" type="checkbox"><label class="alectryon-input" for="Composition-v-chk282"><span class="kn">Lemma</span> <span class="nf">composite_valid_transition_projection_inv</span> :
  <span class="kr">forall</span> <span class="nv">i</span> <span class="nv">li</span> <span class="nv">si1</span> <span class="nv">iom</span> <span class="nv">si2</span> <span class="nv">oom</span>,
    ValidTransition (IM i) li si1 iom si2 oom -&gt;
    <span class="kr">forall</span> <span class="nv">s1</span>, s1 i = si1 -&gt; <span class="kr">forall</span> <span class="nv">s2</span>, s2 = state_update IM s1 i si2 -&gt;
    CompositeValidTransition (existT i li) s1 iom s2 oom.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>message, index</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>EqDecision0</var><span class="hyp-type"><b>: </b><span>EqDecision index</span></span></span><br><span><var>IM</var><span class="hyp-type"><b>: </b><span>index ‚Üí VLSM message</span></span></span><br><span><var>Free</var><span><span class="hyp-body"><b>:= </b><span>free_composite_vlsm IM</span></span><span class="hyp-type"><b>: </b><span>VLSM message</span></span></span></span><br><span><var>RFree</var><span><span class="hyp-body"><b>:= </b><span>pre_loaded_with_all_messages_vlsm Free</span></span><span class="hyp-type"><b>: </b><span>VLSM message</span></span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="kr">‚àÄ</span> (<span class="nv">i</span> : index) (<span class="nv">li</span> : label) (<span class="nv">si1</span> : state) (<span class="nv">iom</span> : option
                                                 message) 
  (<span class="nv">si2</span> : state) (<span class="nv">oom</span> : option message),
  ValidTransition (IM i) li si1 iom si2 oom
  ‚Üí <span class="kr">‚àÄ</span> <span class="nv">s1</span> : <span class="kr">‚àÄ</span> <span class="nv">x</span> : index, state,
      s1 i = si1
      ‚Üí <span class="kr">‚àÄ</span> <span class="nv">s2</span> : <span class="kr">‚àÄ</span> <span class="nv">j</span> : index, vstate (IM j),
          s2 = state_update IM s1 i si2
          ‚Üí CompositeValidTransition (existT i li) s1
              iom s2 oom</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="Composition-v-chk283" style="display: none" type="checkbox"><label class="alectryon-input" for="Composition-v-chk283"><span class="kn">Proof</span>.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>message, index</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>EqDecision0</var><span class="hyp-type"><b>: </b><span>EqDecision index</span></span></span><br><span><var>IM</var><span class="hyp-type"><b>: </b><span>index ‚Üí VLSM message</span></span></span><br><span><var>Free</var><span><span class="hyp-body"><b>:= </b><span>free_composite_vlsm IM</span></span><span class="hyp-type"><b>: </b><span>VLSM message</span></span></span></span><br><span><var>RFree</var><span><span class="hyp-body"><b>:= </b><span>pre_loaded_with_all_messages_vlsm Free</span></span><span class="hyp-type"><b>: </b><span>VLSM message</span></span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="kr">‚àÄ</span> (<span class="nv">i</span> : index) (<span class="nv">li</span> : label) (<span class="nv">si1</span> : state) (<span class="nv">iom</span> : option
                                                 message) 
  (<span class="nv">si2</span> : state) (<span class="nv">oom</span> : option message),
  ValidTransition (IM i) li si1 iom si2 oom
  ‚Üí <span class="kr">‚àÄ</span> <span class="nv">s1</span> : <span class="kr">‚àÄ</span> <span class="nv">x</span> : index, state,
      s1 i = si1
      ‚Üí <span class="kr">‚àÄ</span> <span class="nv">s2</span> : <span class="kr">‚àÄ</span> <span class="nv">j</span> : index, vstate (IM j),
          s2 = state_update IM s1 i si2
          ‚Üí CompositeValidTransition (existT i li) s1
              iom s2 oom</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="Composition-v-chk284" style="display: none" type="checkbox"><label class="alectryon-input" for="Composition-v-chk284"><span class="nb">intros</span> * [Hv Ht] s1 &lt;- s2 -&gt;; <span class="nb">split</span>; [<span class="bp">done</span> |].</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>message, index</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>EqDecision0</var><span class="hyp-type"><b>: </b><span>EqDecision index</span></span></span><br><span><var>IM</var><span class="hyp-type"><b>: </b><span>index ‚Üí VLSM message</span></span></span><br><span><var>Free</var><span><span class="hyp-body"><b>:= </b><span>free_composite_vlsm IM</span></span><span class="hyp-type"><b>: </b><span>VLSM message</span></span></span></span><br><span><var>RFree</var><span><span class="hyp-body"><b>:= </b><span>pre_loaded_with_all_messages_vlsm Free</span></span><span class="hyp-type"><b>: </b><span>VLSM message</span></span></span></span><br><span><var>i</var><span class="hyp-type"><b>: </b><span>index</span></span></span><br><span><var>li</var><span class="hyp-type"><b>: </b><span>label</span></span></span><br><span><var>iom</var><span class="hyp-type"><b>: </b><span>option message</span></span></span><br><span><var>si2</var><span class="hyp-type"><b>: </b><span>state</span></span></span><br><span><var>oom</var><span class="hyp-type"><b>: </b><span>option message</span></span></span><br><span><var>s1</var><span class="hyp-type"><b>: </b><span><span class="kr">‚àÄ</span> <span class="nv">x</span> : index, state</span></span></span><br><span><var>Ht</var><span class="hyp-type"><b>: </b><span>vtransition (IM i) li (s1 i, iom) = (si2, oom)</span></span></span><br><span><var>Hv</var><span class="hyp-type"><b>: </b><span>vvalid (IM i) li (s1 i, iom)</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">composite_transition IM (existT i li) (s1, iom) =
(state_update IM s1 i si2, oom)</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><span class="alectryon-input"><span class="bp">by</span> <span class="nb">cbn</span>; <span class="nb">replace</span> (vtransition _ _ _) <span class="kr">with</span> (si2, oom).</span><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Qed</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
</span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Inductive</span> <span class="nf">CompositeValidTransitionsFromTo</span>
  : composite_state IM -&gt; composite_state IM -&gt; list (composite_transition_item IM) -&gt; <span class="kt">Prop</span> :=
| cvtft_empty : <span class="kr">forall</span> <span class="nv">s</span>, CompositeValidTransitionsFromTo s s []
| cvtft_cons : <span class="kr">forall</span> <span class="nv">s</span> <span class="nv">s&#39;</span> <span class="nv">tr</span> <span class="nv">item</span>,
    CompositeValidTransitionsFromTo s s&#39; tr -&gt;
    composite_valid_transition_item s&#39; item -&gt;
    CompositeValidTransitionsFromTo s (destination item) (tr ++ [item]).</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
</span><span class="alectryon-sentence"><input class="alectryon-toggle" id="Composition-v-chk285" style="display: none" type="checkbox"><label class="alectryon-input" for="Composition-v-chk285"><span class="kn">Lemma</span> <span class="nf">CompositeValidTransitionsFromTo_trace</span> : <span class="kr">forall</span> <span class="nv">s</span> <span class="nv">s&#39;</span> <span class="nv">tr</span>,
  finite_valid_trace_from_to RFree s s&#39; tr -&gt;
  CompositeValidTransitionsFromTo s s&#39; tr.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>message, index</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>EqDecision0</var><span class="hyp-type"><b>: </b><span>EqDecision index</span></span></span><br><span><var>IM</var><span class="hyp-type"><b>: </b><span>index ‚Üí VLSM message</span></span></span><br><span><var>Free</var><span><span class="hyp-body"><b>:= </b><span>free_composite_vlsm IM</span></span><span class="hyp-type"><b>: </b><span>VLSM message</span></span></span></span><br><span><var>RFree</var><span><span class="hyp-body"><b>:= </b><span>pre_loaded_with_all_messages_vlsm Free</span></span><span class="hyp-type"><b>: </b><span>VLSM message</span></span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="kr">‚àÄ</span> (<span class="nv">s</span> <span class="nv">s&#39;</span> : state) (<span class="nv">tr</span> : list transition_item),
  finite_valid_trace_from_to RFree s s&#39; tr
  ‚Üí CompositeValidTransitionsFromTo s s&#39; tr</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="Composition-v-chk286" style="display: none" type="checkbox"><label class="alectryon-input" for="Composition-v-chk286"><span class="kn">Proof</span>.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>message, index</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>EqDecision0</var><span class="hyp-type"><b>: </b><span>EqDecision index</span></span></span><br><span><var>IM</var><span class="hyp-type"><b>: </b><span>index ‚Üí VLSM message</span></span></span><br><span><var>Free</var><span><span class="hyp-body"><b>:= </b><span>free_composite_vlsm IM</span></span><span class="hyp-type"><b>: </b><span>VLSM message</span></span></span></span><br><span><var>RFree</var><span><span class="hyp-body"><b>:= </b><span>pre_loaded_with_all_messages_vlsm Free</span></span><span class="hyp-type"><b>: </b><span>VLSM message</span></span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="kr">‚àÄ</span> (<span class="nv">s</span> <span class="nv">s&#39;</span> : state) (<span class="nv">tr</span> : list transition_item),
  finite_valid_trace_from_to RFree s s&#39; tr
  ‚Üí CompositeValidTransitionsFromTo s s&#39; tr</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="Composition-v-chk287" style="display: none" type="checkbox"><label class="alectryon-input" for="Composition-v-chk287"><span class="nb">induction</span> <span class="mi">1</span> <span class="nb">using</span> finite_valid_trace_from_to_rev_ind; [<span class="bp">by</span> <span class="nb">constructor</span> |].</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>message, index</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>EqDecision0</var><span class="hyp-type"><b>: </b><span>EqDecision index</span></span></span><br><span><var>IM</var><span class="hyp-type"><b>: </b><span>index ‚Üí VLSM message</span></span></span><br><span><var>Free</var><span><span class="hyp-body"><b>:= </b><span>free_composite_vlsm IM</span></span><span class="hyp-type"><b>: </b><span>VLSM message</span></span></span></span><br><span><var>RFree</var><span><span class="hyp-body"><b>:= </b><span>pre_loaded_with_all_messages_vlsm Free</span></span><span class="hyp-type"><b>: </b><span>VLSM message</span></span></span></span><br><span><var>si, s</var><span class="hyp-type"><b>: </b><span>state</span></span></span><br><span><var>tr</var><span class="hyp-type"><b>: </b><span>list transition_item</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>finite_valid_trace_from_to RFree si s tr</span></span></span><br><span><var>sf</var><span class="hyp-type"><b>: </b><span>state</span></span></span><br><span><var>iom, oom</var><span class="hyp-type"><b>: </b><span>option message</span></span></span><br><span><var>l</var><span class="hyp-type"><b>: </b><span>label</span></span></span><br><span><var>Ht</var><span class="hyp-type"><b>: </b><span>input_valid_transition RFree l (s, iom) (sf, oom)</span></span></span><br><span><var>IHfinite_valid_trace_from_to</var><span class="hyp-type"><b>: </b><span>CompositeValidTransitionsFromTo
  si s tr</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">CompositeValidTransitionsFromTo si sf
  (tr ++
   [{|
      l := l;
      input := iom;
      destination := sf;
      output := oom
    |}])</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="Composition-v-chk288" style="display: none" type="checkbox"><label class="alectryon-input" for="Composition-v-chk288"><span class="nb">remember</span> {| destination := sf |} <span class="kr">as</span> item.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>message, index</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>EqDecision0</var><span class="hyp-type"><b>: </b><span>EqDecision index</span></span></span><br><span><var>IM</var><span class="hyp-type"><b>: </b><span>index ‚Üí VLSM message</span></span></span><br><span><var>Free</var><span><span class="hyp-body"><b>:= </b><span>free_composite_vlsm IM</span></span><span class="hyp-type"><b>: </b><span>VLSM message</span></span></span></span><br><span><var>RFree</var><span><span class="hyp-body"><b>:= </b><span>pre_loaded_with_all_messages_vlsm Free</span></span><span class="hyp-type"><b>: </b><span>VLSM message</span></span></span></span><br><span><var>si, s</var><span class="hyp-type"><b>: </b><span>state</span></span></span><br><span><var>tr</var><span class="hyp-type"><b>: </b><span>list transition_item</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>finite_valid_trace_from_to RFree si s tr</span></span></span><br><span><var>sf</var><span class="hyp-type"><b>: </b><span>state</span></span></span><br><span><var>iom, oom</var><span class="hyp-type"><b>: </b><span>option message</span></span></span><br><span><var>l</var><span class="hyp-type"><b>: </b><span>label</span></span></span><br><span><var>Ht</var><span class="hyp-type"><b>: </b><span>input_valid_transition RFree l (s, iom) (sf, oom)</span></span></span><br><span><var>IHfinite_valid_trace_from_to</var><span class="hyp-type"><b>: </b><span>CompositeValidTransitionsFromTo
  si s tr</span></span></span><br><span><var>item</var><span class="hyp-type"><b>: </b><span>transition_item</span></span></span><br><span><var>Heqitem</var><span class="hyp-type"><b>: </b><span>item =
{|
  l := l;
  input := iom;
  destination := sf;
  output := oom
|}</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">CompositeValidTransitionsFromTo si sf (tr ++ [item])</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="Composition-v-chk289" style="display: none" type="checkbox"><label class="alectryon-input" for="Composition-v-chk289"><span class="nb">replace</span> sf <span class="kr">with</span> (destination item) <span class="bp">by</span> (<span class="nb">subst</span>; <span class="bp">done</span>).</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>message, index</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>EqDecision0</var><span class="hyp-type"><b>: </b><span>EqDecision index</span></span></span><br><span><var>IM</var><span class="hyp-type"><b>: </b><span>index ‚Üí VLSM message</span></span></span><br><span><var>Free</var><span><span class="hyp-body"><b>:= </b><span>free_composite_vlsm IM</span></span><span class="hyp-type"><b>: </b><span>VLSM message</span></span></span></span><br><span><var>RFree</var><span><span class="hyp-body"><b>:= </b><span>pre_loaded_with_all_messages_vlsm Free</span></span><span class="hyp-type"><b>: </b><span>VLSM message</span></span></span></span><br><span><var>si, s</var><span class="hyp-type"><b>: </b><span>state</span></span></span><br><span><var>tr</var><span class="hyp-type"><b>: </b><span>list transition_item</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>finite_valid_trace_from_to RFree si s tr</span></span></span><br><span><var>sf</var><span class="hyp-type"><b>: </b><span>state</span></span></span><br><span><var>iom, oom</var><span class="hyp-type"><b>: </b><span>option message</span></span></span><br><span><var>l</var><span class="hyp-type"><b>: </b><span>label</span></span></span><br><span><var>Ht</var><span class="hyp-type"><b>: </b><span>input_valid_transition RFree l (s, iom) (sf, oom)</span></span></span><br><span><var>IHfinite_valid_trace_from_to</var><span class="hyp-type"><b>: </b><span>CompositeValidTransitionsFromTo
  si s tr</span></span></span><br><span><var>item</var><span class="hyp-type"><b>: </b><span>transition_item</span></span></span><br><span><var>Heqitem</var><span class="hyp-type"><b>: </b><span>item =
{|
  l := l;
  input := iom;
  destination := sf;
  output := oom
|}</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">CompositeValidTransitionsFromTo si (destination item)
  (tr ++ [item])</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="Composition-v-chk28a" style="display: none" type="checkbox"><label class="alectryon-input" for="Composition-v-chk28a"><span class="nb">econstructor</span>; [<span class="bp">done</span> |]; <span class="nb">subst</span>.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>message, index</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>EqDecision0</var><span class="hyp-type"><b>: </b><span>EqDecision index</span></span></span><br><span><var>IM</var><span class="hyp-type"><b>: </b><span>index ‚Üí VLSM message</span></span></span><br><span><var>Free</var><span><span class="hyp-body"><b>:= </b><span>free_composite_vlsm IM</span></span><span class="hyp-type"><b>: </b><span>VLSM message</span></span></span></span><br><span><var>RFree</var><span><span class="hyp-body"><b>:= </b><span>pre_loaded_with_all_messages_vlsm Free</span></span><span class="hyp-type"><b>: </b><span>VLSM message</span></span></span></span><br><span><var>si, s</var><span class="hyp-type"><b>: </b><span>state</span></span></span><br><span><var>tr</var><span class="hyp-type"><b>: </b><span>list transition_item</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>finite_valid_trace_from_to RFree si s tr</span></span></span><br><span><var>sf</var><span class="hyp-type"><b>: </b><span>state</span></span></span><br><span><var>iom, oom</var><span class="hyp-type"><b>: </b><span>option message</span></span></span><br><span><var>l</var><span class="hyp-type"><b>: </b><span>label</span></span></span><br><span><var>Ht</var><span class="hyp-type"><b>: </b><span>input_valid_transition RFree l (s, iom) (sf, oom)</span></span></span><br><span><var>IHfinite_valid_trace_from_to</var><span class="hyp-type"><b>: </b><span>CompositeValidTransitionsFromTo
  si s tr</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">composite_valid_transition_item s
  {|
    l := l;
    input := iom;
    destination := sf;
    output := oom
  |}</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><span class="alectryon-input"><span class="bp">by</span> <span class="nb">apply</span> composite_valid_transition_reachable_iff, input_valid_transition_forget_input.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Qed</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
</span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">End</span> <span class="nf">sec_composite_valid_transition</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
</span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Section</span> <span class="nf">sec_composite_history_vlsm</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
</span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Context</span>
  {<span class="nv">message</span> : <span class="kt">Type</span>}
  `{EqDecision index}
  (IM : index -&gt; VLSM message)
  `{<span class="kr">forall</span> <span class="nv">i</span>, HistoryVLSM (IM i)}
  (Free := free_composite_vlsm IM)
  (RFree := pre_loaded_with_all_messages_vlsm Free)
  .</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
</span><span class="alectryon-sentence"><input class="alectryon-toggle" id="Composition-v-chk28b" style="display: none" type="checkbox"><label class="alectryon-input" for="Composition-v-chk28b"><span class="kn">Lemma</span> <span class="nf">not_CompositeValidTransitionNext_initial</span> :
  <span class="kr">forall</span> <span class="nv">s2</span>, composite_initial_state_prop IM s2 -&gt;
  <span class="kr">forall</span> <span class="nv">s1</span>, ~ CompositeValidTransitionNext IM s1 s2.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>message, index</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>EqDecision0</var><span class="hyp-type"><b>: </b><span>EqDecision index</span></span></span><br><span><var>IM</var><span class="hyp-type"><b>: </b><span>index ‚Üí VLSM message</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span><span class="kr">‚àÄ</span> <span class="nv">i</span> : index, HistoryVLSM (IM i)</span></span></span><br><span><var>Free</var><span><span class="hyp-body"><b>:= </b><span>free_composite_vlsm IM</span></span><span class="hyp-type"><b>: </b><span>VLSM message</span></span></span></span><br><span><var>RFree</var><span><span class="hyp-body"><b>:= </b><span>pre_loaded_with_all_messages_vlsm Free</span></span><span class="hyp-type"><b>: </b><span>VLSM message</span></span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="kr">‚àÄ</span> <span class="nv">s2</span> : composite_state IM,
  composite_initial_state_prop IM s2
  ‚Üí <span class="kr">‚àÄ</span> <span class="nv">s1</span> : composite_state IM,
      ¬¨ CompositeValidTransitionNext IM s1 s2</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="Composition-v-chk28c" style="display: none" type="checkbox"><label class="alectryon-input" for="Composition-v-chk28c"><span class="kn">Proof</span>.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>message, index</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>EqDecision0</var><span class="hyp-type"><b>: </b><span>EqDecision index</span></span></span><br><span><var>IM</var><span class="hyp-type"><b>: </b><span>index ‚Üí VLSM message</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span><span class="kr">‚àÄ</span> <span class="nv">i</span> : index, HistoryVLSM (IM i)</span></span></span><br><span><var>Free</var><span><span class="hyp-body"><b>:= </b><span>free_composite_vlsm IM</span></span><span class="hyp-type"><b>: </b><span>VLSM message</span></span></span></span><br><span><var>RFree</var><span><span class="hyp-body"><b>:= </b><span>pre_loaded_with_all_messages_vlsm Free</span></span><span class="hyp-type"><b>: </b><span>VLSM message</span></span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="kr">‚àÄ</span> <span class="nv">s2</span> : composite_state IM,
  composite_initial_state_prop IM s2
  ‚Üí <span class="kr">‚àÄ</span> <span class="nv">s1</span> : composite_state IM,
      ¬¨ CompositeValidTransitionNext IM s1 s2</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="Composition-v-chk28d" style="display: none" type="checkbox"><label class="alectryon-input" for="Composition-v-chk28d"><span class="nb">intros</span> s2 Hs2 s1 [* Hs1].</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>message, index</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>EqDecision0</var><span class="hyp-type"><b>: </b><span>EqDecision index</span></span></span><br><span><var>IM</var><span class="hyp-type"><b>: </b><span>index ‚Üí VLSM message</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span><span class="kr">‚àÄ</span> <span class="nv">i</span> : index, HistoryVLSM (IM i)</span></span></span><br><span><var>Free</var><span><span class="hyp-body"><b>:= </b><span>free_composite_vlsm IM</span></span><span class="hyp-type"><b>: </b><span>VLSM message</span></span></span></span><br><span><var>RFree</var><span><span class="hyp-body"><b>:= </b><span>pre_loaded_with_all_messages_vlsm Free</span></span><span class="hyp-type"><b>: </b><span>VLSM message</span></span></span></span><br><span><var>s2</var><span class="hyp-type"><b>: </b><span>composite_state IM</span></span></span><br><span><var>Hs2</var><span class="hyp-type"><b>: </b><span>composite_initial_state_prop IM s2</span></span></span><br><span><var>s1</var><span class="hyp-type"><b>: </b><span>composite_state IM</span></span></span><br><span><var>l</var><span class="hyp-type"><b>: </b><span>composite_label IM</span></span></span><br><span><var>iom, oom</var><span class="hyp-type"><b>: </b><span>option message</span></span></span><br><span><var>Hs1</var><span class="hyp-type"><b>: </b><span>CompositeValidTransition IM l s1 iom s2 oom</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="kt">False</span></div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="Composition-v-chk28e" style="display: none" type="checkbox"><label class="alectryon-input" for="Composition-v-chk28e"><span class="nb">apply</span> composite_valid_transition_projection, proj1, valid_transition_next <span class="kr">in</span> Hs1; <span class="nb">cbn</span> <span class="kr">in</span> Hs1.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>message, index</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>EqDecision0</var><span class="hyp-type"><b>: </b><span>EqDecision index</span></span></span><br><span><var>IM</var><span class="hyp-type"><b>: </b><span>index ‚Üí VLSM message</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span><span class="kr">‚àÄ</span> <span class="nv">i</span> : index, HistoryVLSM (IM i)</span></span></span><br><span><var>Free</var><span><span class="hyp-body"><b>:= </b><span>free_composite_vlsm IM</span></span><span class="hyp-type"><b>: </b><span>VLSM message</span></span></span></span><br><span><var>RFree</var><span><span class="hyp-body"><b>:= </b><span>pre_loaded_with_all_messages_vlsm Free</span></span><span class="hyp-type"><b>: </b><span>VLSM message</span></span></span></span><br><span><var>s2</var><span class="hyp-type"><b>: </b><span>composite_state IM</span></span></span><br><span><var>Hs2</var><span class="hyp-type"><b>: </b><span>composite_initial_state_prop IM s2</span></span></span><br><span><var>s1</var><span class="hyp-type"><b>: </b><span>composite_state IM</span></span></span><br><span><var>l</var><span class="hyp-type"><b>: </b><span>composite_label IM</span></span></span><br><span><var>iom, oom</var><span class="hyp-type"><b>: </b><span>option message</span></span></span><br><span><var>Hs1</var><span class="hyp-type"><b>: </b><span>ValidTransitionNext (IM (projT1 l))
  (s1 (projT1 l)) (s2 (projT1 l))</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="kt">False</span></div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><span class="alectryon-input"><span class="bp">by</span> <span class="bp">contradict</span> Hs1; <span class="nb">apply</span> not_ValidTransitionNext_initial, Hs2.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Qed</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
</span><span class="alectryon-sentence"><input class="alectryon-toggle" id="Composition-v-chk28f" style="display: none" type="checkbox"><label class="alectryon-input" for="Composition-v-chk28f"><span class="kn">Lemma</span> <span class="nf">composite_quasi_unique_transition_to_state</span> :
  <span class="kr">forall</span> [s],
  <span class="kr">forall</span> [l1 s1 iom1 oom1], CompositeValidTransition IM l1 s1 iom1 s oom1 -&gt;
  <span class="kr">forall</span> [l2 s2 iom2 oom2], CompositeValidTransition IM l2 s2 iom2 s oom2 -&gt;
  projT1 l1 = projT1 l2 -&gt;
  l1 = l2 /\ s1 = s2 /\ iom1 = iom2 /\ oom1 = oom2.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>message, index</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>EqDecision0</var><span class="hyp-type"><b>: </b><span>EqDecision index</span></span></span><br><span><var>IM</var><span class="hyp-type"><b>: </b><span>index ‚Üí VLSM message</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span><span class="kr">‚àÄ</span> <span class="nv">i</span> : index, HistoryVLSM (IM i)</span></span></span><br><span><var>Free</var><span><span class="hyp-body"><b>:= </b><span>free_composite_vlsm IM</span></span><span class="hyp-type"><b>: </b><span>VLSM message</span></span></span></span><br><span><var>RFree</var><span><span class="hyp-body"><b>:= </b><span>pre_loaded_with_all_messages_vlsm Free</span></span><span class="hyp-type"><b>: </b><span>VLSM message</span></span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="kr">‚àÄ</span> (<span class="nv">s</span> : composite_state IM) (<span class="nv">l1</span> : composite_label IM) 
  (<span class="nv">s1</span> : composite_state IM) (<span class="nv">iom1</span>
                             <span class="nv">oom1</span> : option message),
  CompositeValidTransition IM l1 s1 iom1 s oom1
  ‚Üí <span class="kr">‚àÄ</span> (<span class="nv">l2</span> : composite_label IM) (<span class="nv">s2</span> : composite_state
                                        IM) (<span class="nv">iom2</span>
                                             <span class="nv">oom2</span> : 
                                             option
                                               message),
      CompositeValidTransition IM l2 s2 iom2 s oom2
      ‚Üí projT1 l1 = projT1 l2
        ‚Üí l1 = l2
          ‚àß s1 = s2 ‚àß iom1 = iom2 ‚àß oom1 = oom2</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="Composition-v-chk290" style="display: none" type="checkbox"><label class="alectryon-input" for="Composition-v-chk290"><span class="kn">Proof</span>.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>message, index</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>EqDecision0</var><span class="hyp-type"><b>: </b><span>EqDecision index</span></span></span><br><span><var>IM</var><span class="hyp-type"><b>: </b><span>index ‚Üí VLSM message</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span><span class="kr">‚àÄ</span> <span class="nv">i</span> : index, HistoryVLSM (IM i)</span></span></span><br><span><var>Free</var><span><span class="hyp-body"><b>:= </b><span>free_composite_vlsm IM</span></span><span class="hyp-type"><b>: </b><span>VLSM message</span></span></span></span><br><span><var>RFree</var><span><span class="hyp-body"><b>:= </b><span>pre_loaded_with_all_messages_vlsm Free</span></span><span class="hyp-type"><b>: </b><span>VLSM message</span></span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="kr">‚àÄ</span> (<span class="nv">s</span> : composite_state IM) (<span class="nv">l1</span> : composite_label IM) 
  (<span class="nv">s1</span> : composite_state IM) (<span class="nv">iom1</span>
                             <span class="nv">oom1</span> : option message),
  CompositeValidTransition IM l1 s1 iom1 s oom1
  ‚Üí <span class="kr">‚àÄ</span> (<span class="nv">l2</span> : composite_label IM) (<span class="nv">s2</span> : composite_state
                                        IM) (<span class="nv">iom2</span>
                                             <span class="nv">oom2</span> : 
                                             option
                                               message),
      CompositeValidTransition IM l2 s2 iom2 s oom2
      ‚Üí projT1 l1 = projT1 l2
        ‚Üí l1 = l2
          ‚àß s1 = s2 ‚àß iom1 = iom2 ‚àß oom1 = oom2</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="Composition-v-chk291" style="display: none" type="checkbox"><label class="alectryon-input" for="Composition-v-chk291"><span class="nb">intros</span> ? [i li1] * Ht1 [_i li2] * Ht2 [=]; <span class="nb">subst</span> _i.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>message, index</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>EqDecision0</var><span class="hyp-type"><b>: </b><span>EqDecision index</span></span></span><br><span><var>IM</var><span class="hyp-type"><b>: </b><span>index ‚Üí VLSM message</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span><span class="kr">‚àÄ</span> <span class="nv">i</span> : index, HistoryVLSM (IM i)</span></span></span><br><span><var>Free</var><span><span class="hyp-body"><b>:= </b><span>free_composite_vlsm IM</span></span><span class="hyp-type"><b>: </b><span>VLSM message</span></span></span></span><br><span><var>RFree</var><span><span class="hyp-body"><b>:= </b><span>pre_loaded_with_all_messages_vlsm Free</span></span><span class="hyp-type"><b>: </b><span>VLSM message</span></span></span></span><br><span><var>s</var><span class="hyp-type"><b>: </b><span>composite_state IM</span></span></span><br><span><var>i</var><span class="hyp-type"><b>: </b><span>index</span></span></span><br><span><var>li1</var><span class="hyp-type"><b>: </b><span>vlabel (IM i)</span></span></span><br><span><var>s1</var><span class="hyp-type"><b>: </b><span>composite_state IM</span></span></span><br><span><var>iom1, oom1</var><span class="hyp-type"><b>: </b><span>option message</span></span></span><br><span><var>Ht1</var><span class="hyp-type"><b>: </b><span>CompositeValidTransition IM 
  (existT i li1) s1 iom1 s oom1</span></span></span><br><span><var>li2</var><span class="hyp-type"><b>: </b><span>vlabel (IM i)</span></span></span><br><span><var>s2</var><span class="hyp-type"><b>: </b><span>composite_state IM</span></span></span><br><span><var>iom2, oom2</var><span class="hyp-type"><b>: </b><span>option message</span></span></span><br><span><var>Ht2</var><span class="hyp-type"><b>: </b><span>CompositeValidTransition IM 
  (existT i li2) s2 iom2 s oom2</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">existT i li1 = existT i li2
‚àß s1 = s2 ‚àß iom1 = iom2 ‚àß oom1 = oom2</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="Composition-v-chk292" style="display: none" type="checkbox"><label class="alectryon-input" for="Composition-v-chk292"><span class="nb">apply</span> composite_valid_transition_projection <span class="kr">in</span> Ht1, Ht2; <span class="nb">cbn</span> <span class="kr">in</span> Ht1, Ht2.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>message, index</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>EqDecision0</var><span class="hyp-type"><b>: </b><span>EqDecision index</span></span></span><br><span><var>IM</var><span class="hyp-type"><b>: </b><span>index ‚Üí VLSM message</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span><span class="kr">‚àÄ</span> <span class="nv">i</span> : index, HistoryVLSM (IM i)</span></span></span><br><span><var>Free</var><span><span class="hyp-body"><b>:= </b><span>free_composite_vlsm IM</span></span><span class="hyp-type"><b>: </b><span>VLSM message</span></span></span></span><br><span><var>RFree</var><span><span class="hyp-body"><b>:= </b><span>pre_loaded_with_all_messages_vlsm Free</span></span><span class="hyp-type"><b>: </b><span>VLSM message</span></span></span></span><br><span><var>s</var><span class="hyp-type"><b>: </b><span>composite_state IM</span></span></span><br><span><var>i</var><span class="hyp-type"><b>: </b><span>index</span></span></span><br><span><var>li1</var><span class="hyp-type"><b>: </b><span>vlabel (IM i)</span></span></span><br><span><var>s1</var><span class="hyp-type"><b>: </b><span>composite_state IM</span></span></span><br><span><var>iom1, oom1</var><span class="hyp-type"><b>: </b><span>option message</span></span></span><br><span><var>Ht1</var><span class="hyp-type"><b>: </b><span>ValidTransition (IM i) li1 
  (s1 i) iom1 (s i) oom1
‚àß s = state_update IM s1 i (s i)</span></span></span><br><span><var>li2</var><span class="hyp-type"><b>: </b><span>vlabel (IM i)</span></span></span><br><span><var>s2</var><span class="hyp-type"><b>: </b><span>composite_state IM</span></span></span><br><span><var>iom2, oom2</var><span class="hyp-type"><b>: </b><span>option message</span></span></span><br><span><var>Ht2</var><span class="hyp-type"><b>: </b><span>ValidTransition (IM i) li2 
  (s2 i) iom2 (s i) oom2
‚àß s = state_update IM s2 i (s i)</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">existT i li1 = existT i li2
‚àß s1 = s2 ‚àß iom1 = iom2 ‚àß oom1 = oom2</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="Composition-v-chk293" style="display: none" type="checkbox"><label class="alectryon-input" for="Composition-v-chk293"><span class="nb">destruct</span> Ht1 <span class="kr">as</span> [Ht1 Heq_s], Ht2 <span class="kr">as</span> [Ht2 Heqs].</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>message, index</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>EqDecision0</var><span class="hyp-type"><b>: </b><span>EqDecision index</span></span></span><br><span><var>IM</var><span class="hyp-type"><b>: </b><span>index ‚Üí VLSM message</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span><span class="kr">‚àÄ</span> <span class="nv">i</span> : index, HistoryVLSM (IM i)</span></span></span><br><span><var>Free</var><span><span class="hyp-body"><b>:= </b><span>free_composite_vlsm IM</span></span><span class="hyp-type"><b>: </b><span>VLSM message</span></span></span></span><br><span><var>RFree</var><span><span class="hyp-body"><b>:= </b><span>pre_loaded_with_all_messages_vlsm Free</span></span><span class="hyp-type"><b>: </b><span>VLSM message</span></span></span></span><br><span><var>s</var><span class="hyp-type"><b>: </b><span>composite_state IM</span></span></span><br><span><var>i</var><span class="hyp-type"><b>: </b><span>index</span></span></span><br><span><var>li1</var><span class="hyp-type"><b>: </b><span>vlabel (IM i)</span></span></span><br><span><var>s1</var><span class="hyp-type"><b>: </b><span>composite_state IM</span></span></span><br><span><var>iom1, oom1</var><span class="hyp-type"><b>: </b><span>option message</span></span></span><br><span><var>Ht1</var><span class="hyp-type"><b>: </b><span>ValidTransition (IM i) li1 
  (s1 i) iom1 (s i) oom1</span></span></span><br><span><var>Heq_s</var><span class="hyp-type"><b>: </b><span>s = state_update IM s1 i (s i)</span></span></span><br><span><var>li2</var><span class="hyp-type"><b>: </b><span>vlabel (IM i)</span></span></span><br><span><var>s2</var><span class="hyp-type"><b>: </b><span>composite_state IM</span></span></span><br><span><var>iom2, oom2</var><span class="hyp-type"><b>: </b><span>option message</span></span></span><br><span><var>Ht2</var><span class="hyp-type"><b>: </b><span>ValidTransition (IM i) li2 
  (s2 i) iom2 (s i) oom2</span></span></span><br><span><var>Heqs</var><span class="hyp-type"><b>: </b><span>s = state_update IM s2 i (s i)</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">existT i li1 = existT i li2
‚àß s1 = s2 ‚àß iom1 = iom2 ‚àß oom1 = oom2</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="Composition-v-chk294" style="display: none" type="checkbox"><label class="alectryon-input" for="Composition-v-chk294"><span class="nb">rewrite</span> Heq_s <span class="kr">in</span> Heqs <span class="nb">at</span> <span class="mi">1</span>; <span class="nb">clear</span> Heq_s.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>message, index</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>EqDecision0</var><span class="hyp-type"><b>: </b><span>EqDecision index</span></span></span><br><span><var>IM</var><span class="hyp-type"><b>: </b><span>index ‚Üí VLSM message</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span><span class="kr">‚àÄ</span> <span class="nv">i</span> : index, HistoryVLSM (IM i)</span></span></span><br><span><var>Free</var><span><span class="hyp-body"><b>:= </b><span>free_composite_vlsm IM</span></span><span class="hyp-type"><b>: </b><span>VLSM message</span></span></span></span><br><span><var>RFree</var><span><span class="hyp-body"><b>:= </b><span>pre_loaded_with_all_messages_vlsm Free</span></span><span class="hyp-type"><b>: </b><span>VLSM message</span></span></span></span><br><span><var>s</var><span class="hyp-type"><b>: </b><span>composite_state IM</span></span></span><br><span><var>i</var><span class="hyp-type"><b>: </b><span>index</span></span></span><br><span><var>li1</var><span class="hyp-type"><b>: </b><span>vlabel (IM i)</span></span></span><br><span><var>s1</var><span class="hyp-type"><b>: </b><span>composite_state IM</span></span></span><br><span><var>iom1, oom1</var><span class="hyp-type"><b>: </b><span>option message</span></span></span><br><span><var>Ht1</var><span class="hyp-type"><b>: </b><span>ValidTransition (IM i) li1 
  (s1 i) iom1 (s i) oom1</span></span></span><br><span><var>li2</var><span class="hyp-type"><b>: </b><span>vlabel (IM i)</span></span></span><br><span><var>s2</var><span class="hyp-type"><b>: </b><span>composite_state IM</span></span></span><br><span><var>iom2, oom2</var><span class="hyp-type"><b>: </b><span>option message</span></span></span><br><span><var>Ht2</var><span class="hyp-type"><b>: </b><span>ValidTransition (IM i) li2 
  (s2 i) iom2 (s i) oom2</span></span></span><br><span><var>Heqs</var><span class="hyp-type"><b>: </b><span>state_update IM s1 i (s i) =
state_update IM s2 i (s i)</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">existT i li1 = existT i li2
‚àß s1 = s2 ‚àß iom1 = iom2 ‚àß oom1 = oom2</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="Composition-v-chk295" style="display: none" type="checkbox"><label class="alectryon-input" for="Composition-v-chk295"><span class="nb">specialize</span> (unique_transition_to_state Ht1 Ht2) <span class="kr">as</span> Heq;
    destruct_and! Heq; <span class="nb">subst</span>; <span class="kp">repeat</span> <span class="nb">split</span>.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>message, index</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>EqDecision0</var><span class="hyp-type"><b>: </b><span>EqDecision index</span></span></span><br><span><var>IM</var><span class="hyp-type"><b>: </b><span>index ‚Üí VLSM message</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span><span class="kr">‚àÄ</span> <span class="nv">i</span> : index, HistoryVLSM (IM i)</span></span></span><br><span><var>Free</var><span><span class="hyp-body"><b>:= </b><span>free_composite_vlsm IM</span></span><span class="hyp-type"><b>: </b><span>VLSM message</span></span></span></span><br><span><var>RFree</var><span><span class="hyp-body"><b>:= </b><span>pre_loaded_with_all_messages_vlsm Free</span></span><span class="hyp-type"><b>: </b><span>VLSM message</span></span></span></span><br><span><var>s</var><span class="hyp-type"><b>: </b><span>composite_state IM</span></span></span><br><span><var>i</var><span class="hyp-type"><b>: </b><span>index</span></span></span><br><span><var>s1</var><span class="hyp-type"><b>: </b><span>composite_state IM</span></span></span><br><span><var>li2</var><span class="hyp-type"><b>: </b><span>vlabel (IM i)</span></span></span><br><span><var>iom2, oom2</var><span class="hyp-type"><b>: </b><span>option message</span></span></span><br><span><var>Ht1</var><span class="hyp-type"><b>: </b><span>ValidTransition (IM i) li2 
  (s1 i) iom2 (s i) oom2</span></span></span><br><span><var>s2</var><span class="hyp-type"><b>: </b><span>composite_state IM</span></span></span><br><span><var>Ht2</var><span class="hyp-type"><b>: </b><span>ValidTransition (IM i) li2 
  (s2 i) iom2 (s i) oom2</span></span></span><br><span><var>Heqs</var><span class="hyp-type"><b>: </b><span>state_update IM s1 i (s i) =
state_update IM s2 i (s i)</span></span></span><br><span><var>H2</var><span class="hyp-type"><b>: </b><span>s1 i = s2 i</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">s1 = s2</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="Composition-v-chk296" style="display: none" type="checkbox"><label class="alectryon-input" for="Composition-v-chk296">extensionality j.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>message, index</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>EqDecision0</var><span class="hyp-type"><b>: </b><span>EqDecision index</span></span></span><br><span><var>IM</var><span class="hyp-type"><b>: </b><span>index ‚Üí VLSM message</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span><span class="kr">‚àÄ</span> <span class="nv">i</span> : index, HistoryVLSM (IM i)</span></span></span><br><span><var>Free</var><span><span class="hyp-body"><b>:= </b><span>free_composite_vlsm IM</span></span><span class="hyp-type"><b>: </b><span>VLSM message</span></span></span></span><br><span><var>RFree</var><span><span class="hyp-body"><b>:= </b><span>pre_loaded_with_all_messages_vlsm Free</span></span><span class="hyp-type"><b>: </b><span>VLSM message</span></span></span></span><br><span><var>s</var><span class="hyp-type"><b>: </b><span>composite_state IM</span></span></span><br><span><var>i</var><span class="hyp-type"><b>: </b><span>index</span></span></span><br><span><var>s1</var><span class="hyp-type"><b>: </b><span>composite_state IM</span></span></span><br><span><var>li2</var><span class="hyp-type"><b>: </b><span>vlabel (IM i)</span></span></span><br><span><var>iom2, oom2</var><span class="hyp-type"><b>: </b><span>option message</span></span></span><br><span><var>Ht1</var><span class="hyp-type"><b>: </b><span>ValidTransition (IM i) li2 
  (s1 i) iom2 (s i) oom2</span></span></span><br><span><var>s2</var><span class="hyp-type"><b>: </b><span>composite_state IM</span></span></span><br><span><var>Ht2</var><span class="hyp-type"><b>: </b><span>ValidTransition (IM i) li2 
  (s2 i) iom2 (s i) oom2</span></span></span><br><span><var>Heqs</var><span class="hyp-type"><b>: </b><span>state_update IM s1 i (s i) =
state_update IM s2 i (s i)</span></span></span><br><span><var>H2</var><span class="hyp-type"><b>: </b><span>s1 i = s2 i</span></span></span><br><span><var>j</var><span class="hyp-type"><b>: </b><span>index</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">s1 j = s2 j</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="Composition-v-chk297" style="display: none" type="checkbox"><label class="alectryon-input" for="Composition-v-chk297"><span class="nb">destruct</span> (decide (i = j)); <span class="nb">subst</span>; [<span class="bp">done</span> |].</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>message, index</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>EqDecision0</var><span class="hyp-type"><b>: </b><span>EqDecision index</span></span></span><br><span><var>IM</var><span class="hyp-type"><b>: </b><span>index ‚Üí VLSM message</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span><span class="kr">‚àÄ</span> <span class="nv">i</span> : index, HistoryVLSM (IM i)</span></span></span><br><span><var>Free</var><span><span class="hyp-body"><b>:= </b><span>free_composite_vlsm IM</span></span><span class="hyp-type"><b>: </b><span>VLSM message</span></span></span></span><br><span><var>RFree</var><span><span class="hyp-body"><b>:= </b><span>pre_loaded_with_all_messages_vlsm Free</span></span><span class="hyp-type"><b>: </b><span>VLSM message</span></span></span></span><br><span><var>s</var><span class="hyp-type"><b>: </b><span>composite_state IM</span></span></span><br><span><var>i</var><span class="hyp-type"><b>: </b><span>index</span></span></span><br><span><var>s1</var><span class="hyp-type"><b>: </b><span>composite_state IM</span></span></span><br><span><var>li2</var><span class="hyp-type"><b>: </b><span>vlabel (IM i)</span></span></span><br><span><var>iom2, oom2</var><span class="hyp-type"><b>: </b><span>option message</span></span></span><br><span><var>Ht1</var><span class="hyp-type"><b>: </b><span>ValidTransition (IM i) li2 
  (s1 i) iom2 (s i) oom2</span></span></span><br><span><var>s2</var><span class="hyp-type"><b>: </b><span>composite_state IM</span></span></span><br><span><var>Ht2</var><span class="hyp-type"><b>: </b><span>ValidTransition (IM i) li2 
  (s2 i) iom2 (s i) oom2</span></span></span><br><span><var>Heqs</var><span class="hyp-type"><b>: </b><span>state_update IM s1 i (s i) =
state_update IM s2 i (s i)</span></span></span><br><span><var>H2</var><span class="hyp-type"><b>: </b><span>s1 i = s2 i</span></span></span><br><span><var>j</var><span class="hyp-type"><b>: </b><span>index</span></span></span><br><span><var>n</var><span class="hyp-type"><b>: </b><span>i ‚â† j</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">s1 j = s2 j</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="Composition-v-chk298" style="display: none" type="checkbox"><label class="alectryon-input" for="Composition-v-chk298"><span class="nb">apply</span> <span class="nb">f_equal</span> <span class="kr">with</span> (f := <span class="kr">fun</span> <span class="nv">s</span> =&gt; s j) <span class="kr">in</span> Heqs.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>message, index</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>EqDecision0</var><span class="hyp-type"><b>: </b><span>EqDecision index</span></span></span><br><span><var>IM</var><span class="hyp-type"><b>: </b><span>index ‚Üí VLSM message</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span><span class="kr">‚àÄ</span> <span class="nv">i</span> : index, HistoryVLSM (IM i)</span></span></span><br><span><var>Free</var><span><span class="hyp-body"><b>:= </b><span>free_composite_vlsm IM</span></span><span class="hyp-type"><b>: </b><span>VLSM message</span></span></span></span><br><span><var>RFree</var><span><span class="hyp-body"><b>:= </b><span>pre_loaded_with_all_messages_vlsm Free</span></span><span class="hyp-type"><b>: </b><span>VLSM message</span></span></span></span><br><span><var>s</var><span class="hyp-type"><b>: </b><span>composite_state IM</span></span></span><br><span><var>i</var><span class="hyp-type"><b>: </b><span>index</span></span></span><br><span><var>s1</var><span class="hyp-type"><b>: </b><span>composite_state IM</span></span></span><br><span><var>li2</var><span class="hyp-type"><b>: </b><span>vlabel (IM i)</span></span></span><br><span><var>iom2, oom2</var><span class="hyp-type"><b>: </b><span>option message</span></span></span><br><span><var>Ht1</var><span class="hyp-type"><b>: </b><span>ValidTransition (IM i) li2 
  (s1 i) iom2 (s i) oom2</span></span></span><br><span><var>s2</var><span class="hyp-type"><b>: </b><span>composite_state IM</span></span></span><br><span><var>Ht2</var><span class="hyp-type"><b>: </b><span>ValidTransition (IM i) li2 
  (s2 i) iom2 (s i) oom2</span></span></span><br><span><var>j</var><span class="hyp-type"><b>: </b><span>index</span></span></span><br><span><var>Heqs</var><span class="hyp-type"><b>: </b><span>state_update IM s1 i (s i) j =
state_update IM s2 i (s i) j</span></span></span><br><span><var>H2</var><span class="hyp-type"><b>: </b><span>s1 i = s2 i</span></span></span><br><span><var>n</var><span class="hyp-type"><b>: </b><span>i ‚â† j</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">s1 j = s2 j</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><span class="alectryon-input"><span class="bp">by</span> state_update_simpl.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Qed</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
</span><span class="alectryon-sentence"><input class="alectryon-toggle" id="Composition-v-chk299" style="display: none" type="checkbox"><label class="alectryon-input" for="Composition-v-chk299"><span class="kn">Lemma</span> <span class="nf">CompositeValidTransition_reflects_rechability</span> :
  <span class="kr">forall</span> <span class="nv">l</span> <span class="nv">s1</span> <span class="nv">iom</span> <span class="nv">s2</span> <span class="nv">oom</span>,
  CompositeValidTransition IM l s1 iom s2 oom -&gt;
  valid_state_prop RFree s2 -&gt;
  input_valid_transition RFree l (s1, iom) (s2, oom).</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>message, index</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>EqDecision0</var><span class="hyp-type"><b>: </b><span>EqDecision index</span></span></span><br><span><var>IM</var><span class="hyp-type"><b>: </b><span>index ‚Üí VLSM message</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span><span class="kr">‚àÄ</span> <span class="nv">i</span> : index, HistoryVLSM (IM i)</span></span></span><br><span><var>Free</var><span><span class="hyp-body"><b>:= </b><span>free_composite_vlsm IM</span></span><span class="hyp-type"><b>: </b><span>VLSM message</span></span></span></span><br><span><var>RFree</var><span><span class="hyp-body"><b>:= </b><span>pre_loaded_with_all_messages_vlsm Free</span></span><span class="hyp-type"><b>: </b><span>VLSM message</span></span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="kr">‚àÄ</span> (<span class="nv">l</span> : composite_label IM) (<span class="nv">s1</span> : composite_state IM) 
  (<span class="nv">iom</span> : option message) (<span class="nv">s2</span> : composite_state IM) 
  (<span class="nv">oom</span> : option message),
  CompositeValidTransition IM l s1 iom s2 oom
  ‚Üí valid_state_prop RFree s2
    ‚Üí input_valid_transition RFree l (s1, iom)
        (s2, oom)</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="Composition-v-chk29a" style="display: none" type="checkbox"><label class="alectryon-input" for="Composition-v-chk29a"><span class="kn">Proof</span>.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>message, index</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>EqDecision0</var><span class="hyp-type"><b>: </b><span>EqDecision index</span></span></span><br><span><var>IM</var><span class="hyp-type"><b>: </b><span>index ‚Üí VLSM message</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span><span class="kr">‚àÄ</span> <span class="nv">i</span> : index, HistoryVLSM (IM i)</span></span></span><br><span><var>Free</var><span><span class="hyp-body"><b>:= </b><span>free_composite_vlsm IM</span></span><span class="hyp-type"><b>: </b><span>VLSM message</span></span></span></span><br><span><var>RFree</var><span><span class="hyp-body"><b>:= </b><span>pre_loaded_with_all_messages_vlsm Free</span></span><span class="hyp-type"><b>: </b><span>VLSM message</span></span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="kr">‚àÄ</span> (<span class="nv">l</span> : composite_label IM) (<span class="nv">s1</span> : composite_state IM) 
  (<span class="nv">iom</span> : option message) (<span class="nv">s2</span> : composite_state IM) 
  (<span class="nv">oom</span> : option message),
  CompositeValidTransition IM l s1 iom s2 oom
  ‚Üí valid_state_prop RFree s2
    ‚Üí input_valid_transition RFree l (s1, iom)
        (s2, oom)</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="Composition-v-chk29b" style="display: none" type="checkbox"><label class="alectryon-input" for="Composition-v-chk29b"><span class="nb">intros</span> * Hnext Hs2; <span class="nb">revert</span> l s1 iom oom Hnext.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>message, index</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>EqDecision0</var><span class="hyp-type"><b>: </b><span>EqDecision index</span></span></span><br><span><var>IM</var><span class="hyp-type"><b>: </b><span>index ‚Üí VLSM message</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span><span class="kr">‚àÄ</span> <span class="nv">i</span> : index, HistoryVLSM (IM i)</span></span></span><br><span><var>Free</var><span><span class="hyp-body"><b>:= </b><span>free_composite_vlsm IM</span></span><span class="hyp-type"><b>: </b><span>VLSM message</span></span></span></span><br><span><var>RFree</var><span><span class="hyp-body"><b>:= </b><span>pre_loaded_with_all_messages_vlsm Free</span></span><span class="hyp-type"><b>: </b><span>VLSM message</span></span></span></span><br><span><var>s2</var><span class="hyp-type"><b>: </b><span>composite_state IM</span></span></span><br><span><var>Hs2</var><span class="hyp-type"><b>: </b><span>valid_state_prop RFree s2</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="kr">‚àÄ</span> (<span class="nv">l</span> : composite_label IM) (<span class="nv">s1</span> : composite_state IM) 
  (<span class="nv">iom</span> <span class="nv">oom</span> : option message),
  CompositeValidTransition IM l s1 iom s2 oom
  ‚Üí input_valid_transition RFree l (s1, iom) (s2, oom)</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="Composition-v-chk29c" style="display: none" type="checkbox"><label class="alectryon-input" for="Composition-v-chk29c"><span class="nb">induction</span> Hs2 <span class="nb">using</span> valid_state_prop_ind; <span class="nb">intros</span> * Hnext.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>message, index</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>EqDecision0</var><span class="hyp-type"><b>: </b><span>EqDecision index</span></span></span><br><span><var>IM</var><span class="hyp-type"><b>: </b><span>index ‚Üí VLSM message</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span><span class="kr">‚àÄ</span> <span class="nv">i</span> : index, HistoryVLSM (IM i)</span></span></span><br><span><var>Free</var><span><span class="hyp-body"><b>:= </b><span>free_composite_vlsm IM</span></span><span class="hyp-type"><b>: </b><span>VLSM message</span></span></span></span><br><span><var>RFree</var><span><span class="hyp-body"><b>:= </b><span>pre_loaded_with_all_messages_vlsm Free</span></span><span class="hyp-type"><b>: </b><span>VLSM message</span></span></span></span><br><span><var>s</var><span class="hyp-type"><b>: </b><span>state</span></span></span><br><span><var>Hs</var><span class="hyp-type"><b>: </b><span>initial_state_prop s</span></span></span><br><span><var>l</var><span class="hyp-type"><b>: </b><span>composite_label IM</span></span></span><br><span><var>s1</var><span class="hyp-type"><b>: </b><span>composite_state IM</span></span></span><br><span><var>iom, oom</var><span class="hyp-type"><b>: </b><span>option message</span></span></span><br><span><var>Hnext</var><span class="hyp-type"><b>: </b><span>CompositeValidTransition IM l s1 iom s oom</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">input_valid_transition RFree l (s1, iom) (s, oom)</div></blockquote><div class="alectryon-extra-goals"><input class="alectryon-extra-goal-toggle" id="Composition-v-chk29d" style="display: none" type="checkbox"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>message, index</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>EqDecision0</var><span class="hyp-type"><b>: </b><span>EqDecision index</span></span></span><br><span><var>IM</var><span class="hyp-type"><b>: </b><span>index ‚Üí VLSM message</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span><span class="kr">‚àÄ</span> <span class="nv">i</span> : index, HistoryVLSM (IM i)</span></span></span><br><span><var>Free</var><span><span class="hyp-body"><b>:= </b><span>free_composite_vlsm IM</span></span><span class="hyp-type"><b>: </b><span>VLSM message</span></span></span></span><br><span><var>RFree</var><span><span class="hyp-body"><b>:= </b><span>pre_loaded_with_all_messages_vlsm Free</span></span><span class="hyp-type"><b>: </b><span>VLSM message</span></span></span></span><br><span><var>s'</var><span class="hyp-type"><b>: </b><span>state</span></span></span><br><span><var>l</var><span class="hyp-type"><b>: </b><span>label</span></span></span><br><span><var>om, om'</var><span class="hyp-type"><b>: </b><span>option message</span></span></span><br><span><var>s</var><span class="hyp-type"><b>: </b><span>state</span></span></span><br><span><var>Ht</var><span class="hyp-type"><b>: </b><span>input_valid_transition RFree l (s, om) (s&#39;, om&#39;)</span></span></span><br><span><var>IHHs2</var><span class="hyp-type"><b>: </b><span><span class="kr">‚àÄ</span> (<span class="nv">l</span> : composite_label IM) 
  (<span class="nv">s1</span> : composite_state IM) 
  (<span class="nv">iom</span> <span class="nv">oom</span> : option message),
  CompositeValidTransition IM l s1 iom s oom
  ‚Üí input_valid_transition RFree l 
      (s1, iom) (s, oom)</span></span></span><br><span><var>l0</var><span class="hyp-type"><b>: </b><span>composite_label IM</span></span></span><br><span><var>s1</var><span class="hyp-type"><b>: </b><span>composite_state IM</span></span></span><br><span><var>iom, oom</var><span class="hyp-type"><b>: </b><span>option message</span></span></span><br><span><var>Hnext</var><span class="hyp-type"><b>: </b><span>CompositeValidTransition IM l0 s1 iom s&#39; oom</span></span></span><br></div><label class="goal-separator" for="Composition-v-chk29d"><hr></label><div class="goal-conclusion">input_valid_transition RFree l0 (s1, iom) (s&#39;, oom)</div></blockquote></div></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="Composition-v-chk29e" style="display: none" type="checkbox"><label class="alectryon-input" for="Composition-v-chk29e">-</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>message, index</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>EqDecision0</var><span class="hyp-type"><b>: </b><span>EqDecision index</span></span></span><br><span><var>IM</var><span class="hyp-type"><b>: </b><span>index ‚Üí VLSM message</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span><span class="kr">‚àÄ</span> <span class="nv">i</span> : index, HistoryVLSM (IM i)</span></span></span><br><span><var>Free</var><span><span class="hyp-body"><b>:= </b><span>free_composite_vlsm IM</span></span><span class="hyp-type"><b>: </b><span>VLSM message</span></span></span></span><br><span><var>RFree</var><span><span class="hyp-body"><b>:= </b><span>pre_loaded_with_all_messages_vlsm Free</span></span><span class="hyp-type"><b>: </b><span>VLSM message</span></span></span></span><br><span><var>s</var><span class="hyp-type"><b>: </b><span>state</span></span></span><br><span><var>Hs</var><span class="hyp-type"><b>: </b><span>initial_state_prop s</span></span></span><br><span><var>l</var><span class="hyp-type"><b>: </b><span>composite_label IM</span></span></span><br><span><var>s1</var><span class="hyp-type"><b>: </b><span>composite_state IM</span></span></span><br><span><var>iom, oom</var><span class="hyp-type"><b>: </b><span>option message</span></span></span><br><span><var>Hnext</var><span class="hyp-type"><b>: </b><span>CompositeValidTransition IM l s1 iom s oom</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">input_valid_transition RFree l (s1, iom) (s, oom)</div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="Composition-v-chk29f" style="display: none" type="checkbox"><label class="alectryon-input" for="Composition-v-chk29f"><span class="nb">apply</span> composite_valid_transition_next <span class="kr">in</span> Hnext.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>message, index</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>EqDecision0</var><span class="hyp-type"><b>: </b><span>EqDecision index</span></span></span><br><span><var>IM</var><span class="hyp-type"><b>: </b><span>index ‚Üí VLSM message</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span><span class="kr">‚àÄ</span> <span class="nv">i</span> : index, HistoryVLSM (IM i)</span></span></span><br><span><var>Free</var><span><span class="hyp-body"><b>:= </b><span>free_composite_vlsm IM</span></span><span class="hyp-type"><b>: </b><span>VLSM message</span></span></span></span><br><span><var>RFree</var><span><span class="hyp-body"><b>:= </b><span>pre_loaded_with_all_messages_vlsm Free</span></span><span class="hyp-type"><b>: </b><span>VLSM message</span></span></span></span><br><span><var>s</var><span class="hyp-type"><b>: </b><span>state</span></span></span><br><span><var>Hs</var><span class="hyp-type"><b>: </b><span>initial_state_prop s</span></span></span><br><span><var>l</var><span class="hyp-type"><b>: </b><span>composite_label IM</span></span></span><br><span><var>s1</var><span class="hyp-type"><b>: </b><span>composite_state IM</span></span></span><br><span><var>iom, oom</var><span class="hyp-type"><b>: </b><span>option message</span></span></span><br><span><var>Hnext</var><span class="hyp-type"><b>: </b><span>CompositeValidTransitionNext IM s1 s</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">input_valid_transition RFree l (s1, iom) (s, oom)</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><span class="alectryon-input"><span class="bp">by</span> <span class="bp">contradict</span> Hnext; <span class="nb">apply</span> not_CompositeValidTransitionNext_initial.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="Composition-v-chk2a0" style="display: none" type="checkbox"><label class="alectryon-input" for="Composition-v-chk2a0">-</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>message, index</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>EqDecision0</var><span class="hyp-type"><b>: </b><span>EqDecision index</span></span></span><br><span><var>IM</var><span class="hyp-type"><b>: </b><span>index ‚Üí VLSM message</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span><span class="kr">‚àÄ</span> <span class="nv">i</span> : index, HistoryVLSM (IM i)</span></span></span><br><span><var>Free</var><span><span class="hyp-body"><b>:= </b><span>free_composite_vlsm IM</span></span><span class="hyp-type"><b>: </b><span>VLSM message</span></span></span></span><br><span><var>RFree</var><span><span class="hyp-body"><b>:= </b><span>pre_loaded_with_all_messages_vlsm Free</span></span><span class="hyp-type"><b>: </b><span>VLSM message</span></span></span></span><br><span><var>s'</var><span class="hyp-type"><b>: </b><span>state</span></span></span><br><span><var>l</var><span class="hyp-type"><b>: </b><span>label</span></span></span><br><span><var>om, om'</var><span class="hyp-type"><b>: </b><span>option message</span></span></span><br><span><var>s</var><span class="hyp-type"><b>: </b><span>state</span></span></span><br><span><var>Ht</var><span class="hyp-type"><b>: </b><span>input_valid_transition RFree l (s, om) (s&#39;, om&#39;)</span></span></span><br><span><var>IHHs2</var><span class="hyp-type"><b>: </b><span><span class="kr">‚àÄ</span> (<span class="nv">l</span> : composite_label IM) 
  (<span class="nv">s1</span> : composite_state IM) 
  (<span class="nv">iom</span> <span class="nv">oom</span> : option message),
  CompositeValidTransition IM l s1 iom s oom
  ‚Üí input_valid_transition RFree l 
      (s1, iom) (s, oom)</span></span></span><br><span><var>l0</var><span class="hyp-type"><b>: </b><span>composite_label IM</span></span></span><br><span><var>s1</var><span class="hyp-type"><b>: </b><span>composite_state IM</span></span></span><br><span><var>iom, oom</var><span class="hyp-type"><b>: </b><span>option message</span></span></span><br><span><var>Hnext</var><span class="hyp-type"><b>: </b><span>CompositeValidTransition IM l0 s1 iom s&#39; oom</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">input_valid_transition RFree l0 (s1, iom) (s&#39;, oom)</div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="Composition-v-chk2a1" style="display: none" type="checkbox"><label class="alectryon-input" for="Composition-v-chk2a1"><span class="nb">destruct</span> l <span class="kr">as</span> [i li], l0 <span class="kr">as</span> [j lj].</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>message, index</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>EqDecision0</var><span class="hyp-type"><b>: </b><span>EqDecision index</span></span></span><br><span><var>IM</var><span class="hyp-type"><b>: </b><span>index ‚Üí VLSM message</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span><span class="kr">‚àÄ</span> <span class="nv">i</span> : index, HistoryVLSM (IM i)</span></span></span><br><span><var>Free</var><span><span class="hyp-body"><b>:= </b><span>free_composite_vlsm IM</span></span><span class="hyp-type"><b>: </b><span>VLSM message</span></span></span></span><br><span><var>RFree</var><span><span class="hyp-body"><b>:= </b><span>pre_loaded_with_all_messages_vlsm Free</span></span><span class="hyp-type"><b>: </b><span>VLSM message</span></span></span></span><br><span><var>s'</var><span class="hyp-type"><b>: </b><span>state</span></span></span><br><span><var>i</var><span class="hyp-type"><b>: </b><span>index</span></span></span><br><span><var>li</var><span class="hyp-type"><b>: </b><span>vlabel (IM i)</span></span></span><br><span><var>om, om'</var><span class="hyp-type"><b>: </b><span>option message</span></span></span><br><span><var>s</var><span class="hyp-type"><b>: </b><span>state</span></span></span><br><span><var>Ht</var><span class="hyp-type"><b>: </b><span>input_valid_transition RFree 
  (existT i li) (s, om) 
  (s&#39;, om&#39;)</span></span></span><br><span><var>IHHs2</var><span class="hyp-type"><b>: </b><span><span class="kr">‚àÄ</span> (<span class="nv">l</span> : composite_label IM) 
  (<span class="nv">s1</span> : composite_state IM) 
  (<span class="nv">iom</span> <span class="nv">oom</span> : option message),
  CompositeValidTransition IM l s1 iom s oom
  ‚Üí input_valid_transition RFree l 
      (s1, iom) (s, oom)</span></span></span><br><span><var>j</var><span class="hyp-type"><b>: </b><span>index</span></span></span><br><span><var>lj</var><span class="hyp-type"><b>: </b><span>vlabel (IM j)</span></span></span><br><span><var>s1</var><span class="hyp-type"><b>: </b><span>composite_state IM</span></span></span><br><span><var>iom, oom</var><span class="hyp-type"><b>: </b><span>option message</span></span></span><br><span><var>Hnext</var><span class="hyp-type"><b>: </b><span>CompositeValidTransition IM 
  (existT j lj) s1 iom s&#39; oom</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">input_valid_transition RFree (existT j lj) (s1, iom)
  (s&#39;, oom)</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="Composition-v-chk2a2" style="display: none" type="checkbox"><label class="alectryon-input" for="Composition-v-chk2a2"><span class="nb">destruct</span> (decide (i = j)).</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>message, index</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>EqDecision0</var><span class="hyp-type"><b>: </b><span>EqDecision index</span></span></span><br><span><var>IM</var><span class="hyp-type"><b>: </b><span>index ‚Üí VLSM message</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span><span class="kr">‚àÄ</span> <span class="nv">i</span> : index, HistoryVLSM (IM i)</span></span></span><br><span><var>Free</var><span><span class="hyp-body"><b>:= </b><span>free_composite_vlsm IM</span></span><span class="hyp-type"><b>: </b><span>VLSM message</span></span></span></span><br><span><var>RFree</var><span><span class="hyp-body"><b>:= </b><span>pre_loaded_with_all_messages_vlsm Free</span></span><span class="hyp-type"><b>: </b><span>VLSM message</span></span></span></span><br><span><var>s'</var><span class="hyp-type"><b>: </b><span>state</span></span></span><br><span><var>i</var><span class="hyp-type"><b>: </b><span>index</span></span></span><br><span><var>li</var><span class="hyp-type"><b>: </b><span>vlabel (IM i)</span></span></span><br><span><var>om, om'</var><span class="hyp-type"><b>: </b><span>option message</span></span></span><br><span><var>s</var><span class="hyp-type"><b>: </b><span>state</span></span></span><br><span><var>Ht</var><span class="hyp-type"><b>: </b><span>input_valid_transition RFree 
  (existT i li) (s, om) 
  (s&#39;, om&#39;)</span></span></span><br><span><var>IHHs2</var><span class="hyp-type"><b>: </b><span><span class="kr">‚àÄ</span> (<span class="nv">l</span> : composite_label IM) 
  (<span class="nv">s1</span> : composite_state IM) 
  (<span class="nv">iom</span> <span class="nv">oom</span> : option message),
  CompositeValidTransition IM l s1 iom s oom
  ‚Üí input_valid_transition RFree l 
      (s1, iom) (s, oom)</span></span></span><br><span><var>j</var><span class="hyp-type"><b>: </b><span>index</span></span></span><br><span><var>lj</var><span class="hyp-type"><b>: </b><span>vlabel (IM j)</span></span></span><br><span><var>s1</var><span class="hyp-type"><b>: </b><span>composite_state IM</span></span></span><br><span><var>iom, oom</var><span class="hyp-type"><b>: </b><span>option message</span></span></span><br><span><var>Hnext</var><span class="hyp-type"><b>: </b><span>CompositeValidTransition IM 
  (existT j lj) s1 iom s&#39; oom</span></span></span><br><span><var>e</var><span class="hyp-type"><b>: </b><span>i = j</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">input_valid_transition RFree (existT j lj) (s1, iom)
  (s&#39;, oom)</div></blockquote><div class="alectryon-extra-goals"><input class="alectryon-extra-goal-toggle" id="Composition-v-chk2a3" style="display: none" type="checkbox"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>message, index</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>EqDecision0</var><span class="hyp-type"><b>: </b><span>EqDecision index</span></span></span><br><span><var>IM</var><span class="hyp-type"><b>: </b><span>index ‚Üí VLSM message</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span><span class="kr">‚àÄ</span> <span class="nv">i</span> : index, HistoryVLSM (IM i)</span></span></span><br><span><var>Free</var><span><span class="hyp-body"><b>:= </b><span>free_composite_vlsm IM</span></span><span class="hyp-type"><b>: </b><span>VLSM message</span></span></span></span><br><span><var>RFree</var><span><span class="hyp-body"><b>:= </b><span>pre_loaded_with_all_messages_vlsm Free</span></span><span class="hyp-type"><b>: </b><span>VLSM message</span></span></span></span><br><span><var>s'</var><span class="hyp-type"><b>: </b><span>state</span></span></span><br><span><var>i</var><span class="hyp-type"><b>: </b><span>index</span></span></span><br><span><var>li</var><span class="hyp-type"><b>: </b><span>vlabel (IM i)</span></span></span><br><span><var>om, om'</var><span class="hyp-type"><b>: </b><span>option message</span></span></span><br><span><var>s</var><span class="hyp-type"><b>: </b><span>state</span></span></span><br><span><var>Ht</var><span class="hyp-type"><b>: </b><span>input_valid_transition RFree 
  (existT i li) (s, om) 
  (s&#39;, om&#39;)</span></span></span><br><span><var>IHHs2</var><span class="hyp-type"><b>: </b><span><span class="kr">‚àÄ</span> (<span class="nv">l</span> : composite_label IM) 
  (<span class="nv">s1</span> : composite_state IM) 
  (<span class="nv">iom</span> <span class="nv">oom</span> : option message),
  CompositeValidTransition IM l s1 iom s oom
  ‚Üí input_valid_transition RFree l 
      (s1, iom) (s, oom)</span></span></span><br><span><var>j</var><span class="hyp-type"><b>: </b><span>index</span></span></span><br><span><var>lj</var><span class="hyp-type"><b>: </b><span>vlabel (IM j)</span></span></span><br><span><var>s1</var><span class="hyp-type"><b>: </b><span>composite_state IM</span></span></span><br><span><var>iom, oom</var><span class="hyp-type"><b>: </b><span>option message</span></span></span><br><span><var>Hnext</var><span class="hyp-type"><b>: </b><span>CompositeValidTransition IM 
  (existT j lj) s1 iom s&#39; oom</span></span></span><br><span><var>n</var><span class="hyp-type"><b>: </b><span>i ‚â† j</span></span></span><br></div><label class="goal-separator" for="Composition-v-chk2a3"><hr></label><div class="goal-conclusion">input_valid_transition RFree 
  (existT j lj) (s1, iom) 
  (s&#39;, oom)</div></blockquote></div></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="Composition-v-chk2a4" style="display: none" type="checkbox"><label class="alectryon-input" for="Composition-v-chk2a4">+</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>message, index</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>EqDecision0</var><span class="hyp-type"><b>: </b><span>EqDecision index</span></span></span><br><span><var>IM</var><span class="hyp-type"><b>: </b><span>index ‚Üí VLSM message</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span><span class="kr">‚àÄ</span> <span class="nv">i</span> : index, HistoryVLSM (IM i)</span></span></span><br><span><var>Free</var><span><span class="hyp-body"><b>:= </b><span>free_composite_vlsm IM</span></span><span class="hyp-type"><b>: </b><span>VLSM message</span></span></span></span><br><span><var>RFree</var><span><span class="hyp-body"><b>:= </b><span>pre_loaded_with_all_messages_vlsm Free</span></span><span class="hyp-type"><b>: </b><span>VLSM message</span></span></span></span><br><span><var>s'</var><span class="hyp-type"><b>: </b><span>state</span></span></span><br><span><var>i</var><span class="hyp-type"><b>: </b><span>index</span></span></span><br><span><var>li</var><span class="hyp-type"><b>: </b><span>vlabel (IM i)</span></span></span><br><span><var>om, om'</var><span class="hyp-type"><b>: </b><span>option message</span></span></span><br><span><var>s</var><span class="hyp-type"><b>: </b><span>state</span></span></span><br><span><var>Ht</var><span class="hyp-type"><b>: </b><span>input_valid_transition RFree 
  (existT i li) (s, om) 
  (s&#39;, om&#39;)</span></span></span><br><span><var>IHHs2</var><span class="hyp-type"><b>: </b><span><span class="kr">‚àÄ</span> (<span class="nv">l</span> : composite_label IM) 
  (<span class="nv">s1</span> : composite_state IM) 
  (<span class="nv">iom</span> <span class="nv">oom</span> : option message),
  CompositeValidTransition IM l s1 iom s oom
  ‚Üí input_valid_transition RFree l 
      (s1, iom) (s, oom)</span></span></span><br><span><var>j</var><span class="hyp-type"><b>: </b><span>index</span></span></span><br><span><var>lj</var><span class="hyp-type"><b>: </b><span>vlabel (IM j)</span></span></span><br><span><var>s1</var><span class="hyp-type"><b>: </b><span>composite_state IM</span></span></span><br><span><var>iom, oom</var><span class="hyp-type"><b>: </b><span>option message</span></span></span><br><span><var>Hnext</var><span class="hyp-type"><b>: </b><span>CompositeValidTransition IM 
  (existT j lj) s1 iom s&#39; oom</span></span></span><br><span><var>e</var><span class="hyp-type"><b>: </b><span>i = j</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">input_valid_transition RFree (existT j lj) (s1, iom)
  (s&#39;, oom)</div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="Composition-v-chk2a5" style="display: none" type="checkbox"><label class="alectryon-input" for="Composition-v-chk2a5"><span class="nb">subst</span>; <span class="nb">apply</span> input_valid_transition_forget_input <span class="kr">in</span> Ht <span class="kr">as</span> Hvt.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>message, index</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>EqDecision0</var><span class="hyp-type"><b>: </b><span>EqDecision index</span></span></span><br><span><var>IM</var><span class="hyp-type"><b>: </b><span>index ‚Üí VLSM message</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span><span class="kr">‚àÄ</span> <span class="nv">i</span> : index, HistoryVLSM (IM i)</span></span></span><br><span><var>Free</var><span><span class="hyp-body"><b>:= </b><span>free_composite_vlsm IM</span></span><span class="hyp-type"><b>: </b><span>VLSM message</span></span></span></span><br><span><var>RFree</var><span><span class="hyp-body"><b>:= </b><span>pre_loaded_with_all_messages_vlsm Free</span></span><span class="hyp-type"><b>: </b><span>VLSM message</span></span></span></span><br><span><var>s'</var><span class="hyp-type"><b>: </b><span>state</span></span></span><br><span><var>j</var><span class="hyp-type"><b>: </b><span>index</span></span></span><br><span><var>li</var><span class="hyp-type"><b>: </b><span>vlabel (IM j)</span></span></span><br><span><var>om, om'</var><span class="hyp-type"><b>: </b><span>option message</span></span></span><br><span><var>s</var><span class="hyp-type"><b>: </b><span>state</span></span></span><br><span><var>Ht</var><span class="hyp-type"><b>: </b><span>input_valid_transition RFree 
  (existT j li) (s, om) 
  (s&#39;, om&#39;)</span></span></span><br><span><var>IHHs2</var><span class="hyp-type"><b>: </b><span><span class="kr">‚àÄ</span> (<span class="nv">l</span> : composite_label IM) 
  (<span class="nv">s1</span> : composite_state IM) 
  (<span class="nv">iom</span> <span class="nv">oom</span> : option message),
  CompositeValidTransition IM l s1 iom s oom
  ‚Üí input_valid_transition RFree l 
      (s1, iom) (s, oom)</span></span></span><br><span><var>lj</var><span class="hyp-type"><b>: </b><span>vlabel (IM j)</span></span></span><br><span><var>s1</var><span class="hyp-type"><b>: </b><span>composite_state IM</span></span></span><br><span><var>iom, oom</var><span class="hyp-type"><b>: </b><span>option message</span></span></span><br><span><var>Hnext</var><span class="hyp-type"><b>: </b><span>CompositeValidTransition IM 
  (existT j lj) s1 iom s&#39; oom</span></span></span><br><span><var>Hvt</var><span class="hyp-type"><b>: </b><span>ValidTransition RFree (existT j li) s om s&#39; om&#39;</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">input_valid_transition RFree (existT j lj) (s1, iom)
  (s&#39;, oom)</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">      </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="Composition-v-chk2a6" style="display: none" type="checkbox"><label class="alectryon-input" for="Composition-v-chk2a6"><span class="nb">apply</span> composite_valid_transition_reachable_iff <span class="kr">in</span> Hvt.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>message, index</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>EqDecision0</var><span class="hyp-type"><b>: </b><span>EqDecision index</span></span></span><br><span><var>IM</var><span class="hyp-type"><b>: </b><span>index ‚Üí VLSM message</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span><span class="kr">‚àÄ</span> <span class="nv">i</span> : index, HistoryVLSM (IM i)</span></span></span><br><span><var>Free</var><span><span class="hyp-body"><b>:= </b><span>free_composite_vlsm IM</span></span><span class="hyp-type"><b>: </b><span>VLSM message</span></span></span></span><br><span><var>RFree</var><span><span class="hyp-body"><b>:= </b><span>pre_loaded_with_all_messages_vlsm Free</span></span><span class="hyp-type"><b>: </b><span>VLSM message</span></span></span></span><br><span><var>s'</var><span class="hyp-type"><b>: </b><span>state</span></span></span><br><span><var>j</var><span class="hyp-type"><b>: </b><span>index</span></span></span><br><span><var>li</var><span class="hyp-type"><b>: </b><span>vlabel (IM j)</span></span></span><br><span><var>om, om'</var><span class="hyp-type"><b>: </b><span>option message</span></span></span><br><span><var>s</var><span class="hyp-type"><b>: </b><span>state</span></span></span><br><span><var>Ht</var><span class="hyp-type"><b>: </b><span>input_valid_transition RFree 
  (existT j li) (s, om) 
  (s&#39;, om&#39;)</span></span></span><br><span><var>IHHs2</var><span class="hyp-type"><b>: </b><span><span class="kr">‚àÄ</span> (<span class="nv">l</span> : composite_label IM) 
  (<span class="nv">s1</span> : composite_state IM) 
  (<span class="nv">iom</span> <span class="nv">oom</span> : option message),
  CompositeValidTransition IM l s1 iom s oom
  ‚Üí input_valid_transition RFree l 
      (s1, iom) (s, oom)</span></span></span><br><span><var>lj</var><span class="hyp-type"><b>: </b><span>vlabel (IM j)</span></span></span><br><span><var>s1</var><span class="hyp-type"><b>: </b><span>composite_state IM</span></span></span><br><span><var>iom, oom</var><span class="hyp-type"><b>: </b><span>option message</span></span></span><br><span><var>Hnext</var><span class="hyp-type"><b>: </b><span>CompositeValidTransition IM 
  (existT j lj) s1 iom s&#39; oom</span></span></span><br><span><var>Hvt</var><span class="hyp-type"><b>: </b><span>CompositeValidTransition IM 
  (existT j li) s om s&#39; om&#39;</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">input_valid_transition RFree (existT j lj) (s1, iom)
  (s&#39;, oom)</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">      </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="Composition-v-chk2a7" style="display: none" type="checkbox"><label class="alectryon-input" for="Composition-v-chk2a7"><span class="nb">specialize</span> (composite_quasi_unique_transition_to_state Hnext Hvt eq_refl) <span class="kr">as</span> Heq.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>message, index</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>EqDecision0</var><span class="hyp-type"><b>: </b><span>EqDecision index</span></span></span><br><span><var>IM</var><span class="hyp-type"><b>: </b><span>index ‚Üí VLSM message</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span><span class="kr">‚àÄ</span> <span class="nv">i</span> : index, HistoryVLSM (IM i)</span></span></span><br><span><var>Free</var><span><span class="hyp-body"><b>:= </b><span>free_composite_vlsm IM</span></span><span class="hyp-type"><b>: </b><span>VLSM message</span></span></span></span><br><span><var>RFree</var><span><span class="hyp-body"><b>:= </b><span>pre_loaded_with_all_messages_vlsm Free</span></span><span class="hyp-type"><b>: </b><span>VLSM message</span></span></span></span><br><span><var>s'</var><span class="hyp-type"><b>: </b><span>state</span></span></span><br><span><var>j</var><span class="hyp-type"><b>: </b><span>index</span></span></span><br><span><var>li</var><span class="hyp-type"><b>: </b><span>vlabel (IM j)</span></span></span><br><span><var>om, om'</var><span class="hyp-type"><b>: </b><span>option message</span></span></span><br><span><var>s</var><span class="hyp-type"><b>: </b><span>state</span></span></span><br><span><var>Ht</var><span class="hyp-type"><b>: </b><span>input_valid_transition RFree 
  (existT j li) (s, om) 
  (s&#39;, om&#39;)</span></span></span><br><span><var>IHHs2</var><span class="hyp-type"><b>: </b><span><span class="kr">‚àÄ</span> (<span class="nv">l</span> : composite_label IM) 
  (<span class="nv">s1</span> : composite_state IM) 
  (<span class="nv">iom</span> <span class="nv">oom</span> : option message),
  CompositeValidTransition IM l s1 iom s oom
  ‚Üí input_valid_transition RFree l 
      (s1, iom) (s, oom)</span></span></span><br><span><var>lj</var><span class="hyp-type"><b>: </b><span>vlabel (IM j)</span></span></span><br><span><var>s1</var><span class="hyp-type"><b>: </b><span>composite_state IM</span></span></span><br><span><var>iom, oom</var><span class="hyp-type"><b>: </b><span>option message</span></span></span><br><span><var>Hnext</var><span class="hyp-type"><b>: </b><span>CompositeValidTransition IM 
  (existT j lj) s1 iom s&#39; oom</span></span></span><br><span><var>Hvt</var><span class="hyp-type"><b>: </b><span>CompositeValidTransition IM 
  (existT j li) s om s&#39; om&#39;</span></span></span><br><span><var>Heq</var><span class="hyp-type"><b>: </b><span>existT j lj = existT j li
‚àß s1 = s ‚àß iom = om ‚àß oom = om&#39;</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">input_valid_transition RFree (existT j lj) (s1, iom)
  (s&#39;, oom)</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">      </span><span class="alectryon-sentence"><span class="alectryon-input"><span class="bp">by</span> destruct_and! Heq; <span class="nb">simplify_eq</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="Composition-v-chk2a8" style="display: none" type="checkbox"><label class="alectryon-input" for="Composition-v-chk2a8">+</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>message, index</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>EqDecision0</var><span class="hyp-type"><b>: </b><span>EqDecision index</span></span></span><br><span><var>IM</var><span class="hyp-type"><b>: </b><span>index ‚Üí VLSM message</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span><span class="kr">‚àÄ</span> <span class="nv">i</span> : index, HistoryVLSM (IM i)</span></span></span><br><span><var>Free</var><span><span class="hyp-body"><b>:= </b><span>free_composite_vlsm IM</span></span><span class="hyp-type"><b>: </b><span>VLSM message</span></span></span></span><br><span><var>RFree</var><span><span class="hyp-body"><b>:= </b><span>pre_loaded_with_all_messages_vlsm Free</span></span><span class="hyp-type"><b>: </b><span>VLSM message</span></span></span></span><br><span><var>s'</var><span class="hyp-type"><b>: </b><span>state</span></span></span><br><span><var>i</var><span class="hyp-type"><b>: </b><span>index</span></span></span><br><span><var>li</var><span class="hyp-type"><b>: </b><span>vlabel (IM i)</span></span></span><br><span><var>om, om'</var><span class="hyp-type"><b>: </b><span>option message</span></span></span><br><span><var>s</var><span class="hyp-type"><b>: </b><span>state</span></span></span><br><span><var>Ht</var><span class="hyp-type"><b>: </b><span>input_valid_transition RFree 
  (existT i li) (s, om) 
  (s&#39;, om&#39;)</span></span></span><br><span><var>IHHs2</var><span class="hyp-type"><b>: </b><span><span class="kr">‚àÄ</span> (<span class="nv">l</span> : composite_label IM) 
  (<span class="nv">s1</span> : composite_state IM) 
  (<span class="nv">iom</span> <span class="nv">oom</span> : option message),
  CompositeValidTransition IM l s1 iom s oom
  ‚Üí input_valid_transition RFree l 
      (s1, iom) (s, oom)</span></span></span><br><span><var>j</var><span class="hyp-type"><b>: </b><span>index</span></span></span><br><span><var>lj</var><span class="hyp-type"><b>: </b><span>vlabel (IM j)</span></span></span><br><span><var>s1</var><span class="hyp-type"><b>: </b><span>composite_state IM</span></span></span><br><span><var>iom, oom</var><span class="hyp-type"><b>: </b><span>option message</span></span></span><br><span><var>Hnext</var><span class="hyp-type"><b>: </b><span>CompositeValidTransition IM 
  (existT j lj) s1 iom s&#39; oom</span></span></span><br><span><var>n</var><span class="hyp-type"><b>: </b><span>i ‚â† j</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">input_valid_transition RFree (existT j lj) (s1, iom)
  (s&#39;, oom)</div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="Composition-v-chk2a9" style="display: none" type="checkbox"><label class="alectryon-input" for="Composition-v-chk2a9"><span class="nb">apply</span> input_valid_transition_forget_input <span class="kr">in</span> Ht <span class="kr">as</span> Hti.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>message, index</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>EqDecision0</var><span class="hyp-type"><b>: </b><span>EqDecision index</span></span></span><br><span><var>IM</var><span class="hyp-type"><b>: </b><span>index ‚Üí VLSM message</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span><span class="kr">‚àÄ</span> <span class="nv">i</span> : index, HistoryVLSM (IM i)</span></span></span><br><span><var>Free</var><span><span class="hyp-body"><b>:= </b><span>free_composite_vlsm IM</span></span><span class="hyp-type"><b>: </b><span>VLSM message</span></span></span></span><br><span><var>RFree</var><span><span class="hyp-body"><b>:= </b><span>pre_loaded_with_all_messages_vlsm Free</span></span><span class="hyp-type"><b>: </b><span>VLSM message</span></span></span></span><br><span><var>s'</var><span class="hyp-type"><b>: </b><span>state</span></span></span><br><span><var>i</var><span class="hyp-type"><b>: </b><span>index</span></span></span><br><span><var>li</var><span class="hyp-type"><b>: </b><span>vlabel (IM i)</span></span></span><br><span><var>om, om'</var><span class="hyp-type"><b>: </b><span>option message</span></span></span><br><span><var>s</var><span class="hyp-type"><b>: </b><span>state</span></span></span><br><span><var>Ht</var><span class="hyp-type"><b>: </b><span>input_valid_transition RFree 
  (existT i li) (s, om) 
  (s&#39;, om&#39;)</span></span></span><br><span><var>IHHs2</var><span class="hyp-type"><b>: </b><span><span class="kr">‚àÄ</span> (<span class="nv">l</span> : composite_label IM) 
  (<span class="nv">s1</span> : composite_state IM) 
  (<span class="nv">iom</span> <span class="nv">oom</span> : option message),
  CompositeValidTransition IM l s1 iom s oom
  ‚Üí input_valid_transition RFree l 
      (s1, iom) (s, oom)</span></span></span><br><span><var>j</var><span class="hyp-type"><b>: </b><span>index</span></span></span><br><span><var>lj</var><span class="hyp-type"><b>: </b><span>vlabel (IM j)</span></span></span><br><span><var>s1</var><span class="hyp-type"><b>: </b><span>composite_state IM</span></span></span><br><span><var>iom, oom</var><span class="hyp-type"><b>: </b><span>option message</span></span></span><br><span><var>Hnext</var><span class="hyp-type"><b>: </b><span>CompositeValidTransition IM 
  (existT j lj) s1 iom s&#39; oom</span></span></span><br><span><var>n</var><span class="hyp-type"><b>: </b><span>i ‚â† j</span></span></span><br><span><var>Hti</var><span class="hyp-type"><b>: </b><span>ValidTransition RFree (existT i li) s om s&#39; om&#39;</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">input_valid_transition RFree (existT j lj) (s1, iom)
  (s&#39;, oom)</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">      </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="Composition-v-chk2aa" style="display: none" type="checkbox"><label class="alectryon-input" for="Composition-v-chk2aa"><span class="nb">apply</span> composite_valid_transition_reachable_iff,
        composite_valid_transition_projection <span class="kr">in</span> Hti;
        <span class="nb">cbn</span> <span class="kr">in</span> Hti; <span class="nb">destruct</span> Hti <span class="kr">as</span> [[Hvi Hti] Heqs&#39;].</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>message, index</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>EqDecision0</var><span class="hyp-type"><b>: </b><span>EqDecision index</span></span></span><br><span><var>IM</var><span class="hyp-type"><b>: </b><span>index ‚Üí VLSM message</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span><span class="kr">‚àÄ</span> <span class="nv">i</span> : index, HistoryVLSM (IM i)</span></span></span><br><span><var>Free</var><span><span class="hyp-body"><b>:= </b><span>free_composite_vlsm IM</span></span><span class="hyp-type"><b>: </b><span>VLSM message</span></span></span></span><br><span><var>RFree</var><span><span class="hyp-body"><b>:= </b><span>pre_loaded_with_all_messages_vlsm Free</span></span><span class="hyp-type"><b>: </b><span>VLSM message</span></span></span></span><br><span><var>s'</var><span class="hyp-type"><b>: </b><span>state</span></span></span><br><span><var>i</var><span class="hyp-type"><b>: </b><span>index</span></span></span><br><span><var>li</var><span class="hyp-type"><b>: </b><span>vlabel (IM i)</span></span></span><br><span><var>om, om'</var><span class="hyp-type"><b>: </b><span>option message</span></span></span><br><span><var>s</var><span class="hyp-type"><b>: </b><span>state</span></span></span><br><span><var>Ht</var><span class="hyp-type"><b>: </b><span>input_valid_transition RFree 
  (existT i li) (s, om) 
  (s&#39;, om&#39;)</span></span></span><br><span><var>IHHs2</var><span class="hyp-type"><b>: </b><span><span class="kr">‚àÄ</span> (<span class="nv">l</span> : composite_label IM) 
  (<span class="nv">s1</span> : composite_state IM) 
  (<span class="nv">iom</span> <span class="nv">oom</span> : option message),
  CompositeValidTransition IM l s1 iom s oom
  ‚Üí input_valid_transition RFree l 
      (s1, iom) (s, oom)</span></span></span><br><span><var>j</var><span class="hyp-type"><b>: </b><span>index</span></span></span><br><span><var>lj</var><span class="hyp-type"><b>: </b><span>vlabel (IM j)</span></span></span><br><span><var>s1</var><span class="hyp-type"><b>: </b><span>composite_state IM</span></span></span><br><span><var>iom, oom</var><span class="hyp-type"><b>: </b><span>option message</span></span></span><br><span><var>Hnext</var><span class="hyp-type"><b>: </b><span>CompositeValidTransition IM 
  (existT j lj) s1 iom s&#39; oom</span></span></span><br><span><var>n</var><span class="hyp-type"><b>: </b><span>i ‚â† j</span></span></span><br><span><var>Hvi</var><span class="hyp-type"><b>: </b><span>vvalid (IM i) li (s i, om)</span></span></span><br><span><var>Hti</var><span class="hyp-type"><b>: </b><span>vtransition (IM i) li (s i, om) = (s&#39; i, om&#39;)</span></span></span><br><span><var>Heqs'</var><span class="hyp-type"><b>: </b><span>s&#39; = state_update IM s i (s&#39; i)</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">input_valid_transition RFree (existT j lj) (s1, iom)
  (s&#39;, oom)</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">      </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="Composition-v-chk2ab" style="display: none" type="checkbox"><label class="alectryon-input" for="Composition-v-chk2ab"><span class="nb">apply</span> composite_valid_transition_projection <span class="kr">in</span> Hnext;
        <span class="nb">cbn</span> <span class="kr">in</span> Hnext; <span class="nb">destruct</span> Hnext <span class="kr">as</span> [[Hvj Htj] Heq_s&#39;].</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>message, index</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>EqDecision0</var><span class="hyp-type"><b>: </b><span>EqDecision index</span></span></span><br><span><var>IM</var><span class="hyp-type"><b>: </b><span>index ‚Üí VLSM message</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span><span class="kr">‚àÄ</span> <span class="nv">i</span> : index, HistoryVLSM (IM i)</span></span></span><br><span><var>Free</var><span><span class="hyp-body"><b>:= </b><span>free_composite_vlsm IM</span></span><span class="hyp-type"><b>: </b><span>VLSM message</span></span></span></span><br><span><var>RFree</var><span><span class="hyp-body"><b>:= </b><span>pre_loaded_with_all_messages_vlsm Free</span></span><span class="hyp-type"><b>: </b><span>VLSM message</span></span></span></span><br><span><var>s'</var><span class="hyp-type"><b>: </b><span>state</span></span></span><br><span><var>i</var><span class="hyp-type"><b>: </b><span>index</span></span></span><br><span><var>li</var><span class="hyp-type"><b>: </b><span>vlabel (IM i)</span></span></span><br><span><var>om, om'</var><span class="hyp-type"><b>: </b><span>option message</span></span></span><br><span><var>s</var><span class="hyp-type"><b>: </b><span>state</span></span></span><br><span><var>Ht</var><span class="hyp-type"><b>: </b><span>input_valid_transition RFree 
  (existT i li) (s, om) 
  (s&#39;, om&#39;)</span></span></span><br><span><var>IHHs2</var><span class="hyp-type"><b>: </b><span><span class="kr">‚àÄ</span> (<span class="nv">l</span> : composite_label IM) 
  (<span class="nv">s1</span> : composite_state IM) 
  (<span class="nv">iom</span> <span class="nv">oom</span> : option message),
  CompositeValidTransition IM l s1 iom s oom
  ‚Üí input_valid_transition RFree l 
      (s1, iom) (s, oom)</span></span></span><br><span><var>j</var><span class="hyp-type"><b>: </b><span>index</span></span></span><br><span><var>lj</var><span class="hyp-type"><b>: </b><span>vlabel (IM j)</span></span></span><br><span><var>s1</var><span class="hyp-type"><b>: </b><span>composite_state IM</span></span></span><br><span><var>iom, oom</var><span class="hyp-type"><b>: </b><span>option message</span></span></span><br><span><var>Hvj</var><span class="hyp-type"><b>: </b><span>vvalid (IM j) lj (s1 j, iom)</span></span></span><br><span><var>Htj</var><span class="hyp-type"><b>: </b><span>vtransition (IM j) lj (s1 j, iom) = (s&#39; j, oom)</span></span></span><br><span><var>Heq_s'</var><span class="hyp-type"><b>: </b><span>s&#39; = state_update IM s1 j (s&#39; j)</span></span></span><br><span><var>n</var><span class="hyp-type"><b>: </b><span>i ‚â† j</span></span></span><br><span><var>Hvi</var><span class="hyp-type"><b>: </b><span>vvalid (IM i) li (s i, om)</span></span></span><br><span><var>Hti</var><span class="hyp-type"><b>: </b><span>vtransition (IM i) li (s i, om) = (s&#39; i, om&#39;)</span></span></span><br><span><var>Heqs'</var><span class="hyp-type"><b>: </b><span>s&#39; = state_update IM s i (s&#39; i)</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">input_valid_transition RFree (existT j lj) (s1, iom)
  (s&#39;, oom)</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">      </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="Composition-v-chk2ac" style="display: none" type="checkbox"><label class="alectryon-input" for="Composition-v-chk2ac"><span class="nb">rewrite</span> Heq_s&#39; <span class="kr">in</span> Heqs&#39;; state_update_simpl.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>message, index</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>EqDecision0</var><span class="hyp-type"><b>: </b><span>EqDecision index</span></span></span><br><span><var>IM</var><span class="hyp-type"><b>: </b><span>index ‚Üí VLSM message</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span><span class="kr">‚àÄ</span> <span class="nv">i</span> : index, HistoryVLSM (IM i)</span></span></span><br><span><var>Free</var><span><span class="hyp-body"><b>:= </b><span>free_composite_vlsm IM</span></span><span class="hyp-type"><b>: </b><span>VLSM message</span></span></span></span><br><span><var>RFree</var><span><span class="hyp-body"><b>:= </b><span>pre_loaded_with_all_messages_vlsm Free</span></span><span class="hyp-type"><b>: </b><span>VLSM message</span></span></span></span><br><span><var>s'</var><span class="hyp-type"><b>: </b><span>state</span></span></span><br><span><var>i</var><span class="hyp-type"><b>: </b><span>index</span></span></span><br><span><var>li</var><span class="hyp-type"><b>: </b><span>vlabel (IM i)</span></span></span><br><span><var>om, om'</var><span class="hyp-type"><b>: </b><span>option message</span></span></span><br><span><var>s</var><span class="hyp-type"><b>: </b><span>state</span></span></span><br><span><var>Ht</var><span class="hyp-type"><b>: </b><span>input_valid_transition RFree 
  (existT i li) (s, om) 
  (s&#39;, om&#39;)</span></span></span><br><span><var>IHHs2</var><span class="hyp-type"><b>: </b><span><span class="kr">‚àÄ</span> (<span class="nv">l</span> : composite_label IM) 
  (<span class="nv">s1</span> : composite_state IM) 
  (<span class="nv">iom</span> <span class="nv">oom</span> : option message),
  CompositeValidTransition IM l s1 iom s oom
  ‚Üí input_valid_transition RFree l 
      (s1, iom) (s, oom)</span></span></span><br><span><var>j</var><span class="hyp-type"><b>: </b><span>index</span></span></span><br><span><var>lj</var><span class="hyp-type"><b>: </b><span>vlabel (IM j)</span></span></span><br><span><var>s1</var><span class="hyp-type"><b>: </b><span>composite_state IM</span></span></span><br><span><var>iom, oom</var><span class="hyp-type"><b>: </b><span>option message</span></span></span><br><span><var>Hvj</var><span class="hyp-type"><b>: </b><span>vvalid (IM j) lj (s1 j, iom)</span></span></span><br><span><var>Htj</var><span class="hyp-type"><b>: </b><span>vtransition (IM j) lj (s1 j, iom) = (s&#39; j, oom)</span></span></span><br><span><var>Heq_s'</var><span class="hyp-type"><b>: </b><span>s&#39; = state_update IM s1 j (s&#39; j)</span></span></span><br><span><var>n</var><span class="hyp-type"><b>: </b><span>i ‚â† j</span></span></span><br><span><var>Hvi</var><span class="hyp-type"><b>: </b><span>vvalid (IM i) li (s i, om)</span></span></span><br><span><var>Hti</var><span class="hyp-type"><b>: </b><span>vtransition (IM i) li (s i, om) = (s&#39; i, om&#39;)</span></span></span><br><span><var>Heqs'</var><span class="hyp-type"><b>: </b><span>state_update IM s1 j (s&#39; j) =
state_update IM s i (s1 i)</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">input_valid_transition RFree (existT j lj) (s1, iom)
  (s&#39;, oom)</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">      </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="Composition-v-chk2ad" style="display: none" type="checkbox"><label class="alectryon-input" for="Composition-v-chk2ad"><span class="nb">specialize</span> (IHHs2 (existT j lj) (state_update IM s j (s1 j)) iom oom).</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>message, index</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>EqDecision0</var><span class="hyp-type"><b>: </b><span>EqDecision index</span></span></span><br><span><var>IM</var><span class="hyp-type"><b>: </b><span>index ‚Üí VLSM message</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span><span class="kr">‚àÄ</span> <span class="nv">i</span> : index, HistoryVLSM (IM i)</span></span></span><br><span><var>Free</var><span><span class="hyp-body"><b>:= </b><span>free_composite_vlsm IM</span></span><span class="hyp-type"><b>: </b><span>VLSM message</span></span></span></span><br><span><var>RFree</var><span><span class="hyp-body"><b>:= </b><span>pre_loaded_with_all_messages_vlsm Free</span></span><span class="hyp-type"><b>: </b><span>VLSM message</span></span></span></span><br><span><var>s'</var><span class="hyp-type"><b>: </b><span>state</span></span></span><br><span><var>i</var><span class="hyp-type"><b>: </b><span>index</span></span></span><br><span><var>li</var><span class="hyp-type"><b>: </b><span>vlabel (IM i)</span></span></span><br><span><var>om, om'</var><span class="hyp-type"><b>: </b><span>option message</span></span></span><br><span><var>s</var><span class="hyp-type"><b>: </b><span>state</span></span></span><br><span><var>Ht</var><span class="hyp-type"><b>: </b><span>input_valid_transition RFree 
  (existT i li) (s, om) 
  (s&#39;, om&#39;)</span></span></span><br><span><var>j</var><span class="hyp-type"><b>: </b><span>index</span></span></span><br><span><var>lj</var><span class="hyp-type"><b>: </b><span>vlabel (IM j)</span></span></span><br><span><var>s1</var><span class="hyp-type"><b>: </b><span>composite_state IM</span></span></span><br><span><var>iom, oom</var><span class="hyp-type"><b>: </b><span>option message</span></span></span><br><span><var>IHHs2</var><span class="hyp-type"><b>: </b><span>CompositeValidTransition IM 
  (existT j lj) (state_update IM s j (s1 j))
  iom s oom
‚Üí input_valid_transition RFree 
    (existT j lj)
    (state_update IM s j (s1 j), iom) 
    (s, oom)</span></span></span><br><span><var>Hvj</var><span class="hyp-type"><b>: </b><span>vvalid (IM j) lj (s1 j, iom)</span></span></span><br><span><var>Htj</var><span class="hyp-type"><b>: </b><span>vtransition (IM j) lj (s1 j, iom) = (s&#39; j, oom)</span></span></span><br><span><var>Heq_s'</var><span class="hyp-type"><b>: </b><span>s&#39; = state_update IM s1 j (s&#39; j)</span></span></span><br><span><var>n</var><span class="hyp-type"><b>: </b><span>i ‚â† j</span></span></span><br><span><var>Hvi</var><span class="hyp-type"><b>: </b><span>vvalid (IM i) li (s i, om)</span></span></span><br><span><var>Hti</var><span class="hyp-type"><b>: </b><span>vtransition (IM i) li (s i, om) = (s&#39; i, om&#39;)</span></span></span><br><span><var>Heqs'</var><span class="hyp-type"><b>: </b><span>state_update IM s1 j (s&#39; j) =
state_update IM s i (s1 i)</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">input_valid_transition RFree (existT j lj) (s1, iom)
  (s&#39;, oom)</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">      </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="Composition-v-chk2ae" style="display: none" type="checkbox"><label class="alectryon-input" for="Composition-v-chk2ae">spec IHHs2.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>message, index</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>EqDecision0</var><span class="hyp-type"><b>: </b><span>EqDecision index</span></span></span><br><span><var>IM</var><span class="hyp-type"><b>: </b><span>index ‚Üí VLSM message</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span><span class="kr">‚àÄ</span> <span class="nv">i</span> : index, HistoryVLSM (IM i)</span></span></span><br><span><var>Free</var><span><span class="hyp-body"><b>:= </b><span>free_composite_vlsm IM</span></span><span class="hyp-type"><b>: </b><span>VLSM message</span></span></span></span><br><span><var>RFree</var><span><span class="hyp-body"><b>:= </b><span>pre_loaded_with_all_messages_vlsm Free</span></span><span class="hyp-type"><b>: </b><span>VLSM message</span></span></span></span><br><span><var>s'</var><span class="hyp-type"><b>: </b><span>state</span></span></span><br><span><var>i</var><span class="hyp-type"><b>: </b><span>index</span></span></span><br><span><var>li</var><span class="hyp-type"><b>: </b><span>vlabel (IM i)</span></span></span><br><span><var>om, om'</var><span class="hyp-type"><b>: </b><span>option message</span></span></span><br><span><var>s</var><span class="hyp-type"><b>: </b><span>state</span></span></span><br><span><var>Ht</var><span class="hyp-type"><b>: </b><span>input_valid_transition RFree 
  (existT i li) (s, om) 
  (s&#39;, om&#39;)</span></span></span><br><span><var>j</var><span class="hyp-type"><b>: </b><span>index</span></span></span><br><span><var>lj</var><span class="hyp-type"><b>: </b><span>vlabel (IM j)</span></span></span><br><span><var>s1</var><span class="hyp-type"><b>: </b><span>composite_state IM</span></span></span><br><span><var>iom, oom</var><span class="hyp-type"><b>: </b><span>option message</span></span></span><br><span><var>IHHs2</var><span class="hyp-type"><b>: </b><span>CompositeValidTransition IM 
  (existT j lj) (state_update IM s j (s1 j))
  iom s oom
‚Üí input_valid_transition RFree 
    (existT j lj)
    (state_update IM s j (s1 j), iom) 
    (s, oom)</span></span></span><br><span><var>Hvj</var><span class="hyp-type"><b>: </b><span>vvalid (IM j) lj (s1 j, iom)</span></span></span><br><span><var>Htj</var><span class="hyp-type"><b>: </b><span>vtransition (IM j) lj (s1 j, iom) = (s&#39; j, oom)</span></span></span><br><span><var>Heq_s'</var><span class="hyp-type"><b>: </b><span>s&#39; = state_update IM s1 j (s&#39; j)</span></span></span><br><span><var>n</var><span class="hyp-type"><b>: </b><span>i ‚â† j</span></span></span><br><span><var>Hvi</var><span class="hyp-type"><b>: </b><span>vvalid (IM i) li (s i, om)</span></span></span><br><span><var>Hti</var><span class="hyp-type"><b>: </b><span>vtransition (IM i) li (s i, om) = (s&#39; i, om&#39;)</span></span></span><br><span><var>Heqs'</var><span class="hyp-type"><b>: </b><span>state_update IM s1 j (s&#39; j) =
state_update IM s i (s1 i)</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">CompositeValidTransition IM (existT j lj)
  (state_update IM s j (s1 j)) iom s oom</div></blockquote><div class="alectryon-extra-goals"><input class="alectryon-extra-goal-toggle" id="Composition-v-chk2af" style="display: none" type="checkbox"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>message, index</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>EqDecision0</var><span class="hyp-type"><b>: </b><span>EqDecision index</span></span></span><br><span><var>IM</var><span class="hyp-type"><b>: </b><span>index ‚Üí VLSM message</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span><span class="kr">‚àÄ</span> <span class="nv">i</span> : index, HistoryVLSM (IM i)</span></span></span><br><span><var>Free</var><span><span class="hyp-body"><b>:= </b><span>free_composite_vlsm IM</span></span><span class="hyp-type"><b>: </b><span>VLSM message</span></span></span></span><br><span><var>RFree</var><span><span class="hyp-body"><b>:= </b><span>pre_loaded_with_all_messages_vlsm Free</span></span><span class="hyp-type"><b>: </b><span>VLSM message</span></span></span></span><br><span><var>s'</var><span class="hyp-type"><b>: </b><span>state</span></span></span><br><span><var>i</var><span class="hyp-type"><b>: </b><span>index</span></span></span><br><span><var>li</var><span class="hyp-type"><b>: </b><span>vlabel (IM i)</span></span></span><br><span><var>om, om'</var><span class="hyp-type"><b>: </b><span>option message</span></span></span><br><span><var>s</var><span class="hyp-type"><b>: </b><span>state</span></span></span><br><span><var>Ht</var><span class="hyp-type"><b>: </b><span>input_valid_transition RFree 
  (existT i li) (s, om) 
  (s&#39;, om&#39;)</span></span></span><br><span><var>j</var><span class="hyp-type"><b>: </b><span>index</span></span></span><br><span><var>lj</var><span class="hyp-type"><b>: </b><span>vlabel (IM j)</span></span></span><br><span><var>s1</var><span class="hyp-type"><b>: </b><span>composite_state IM</span></span></span><br><span><var>iom, oom</var><span class="hyp-type"><b>: </b><span>option message</span></span></span><br><span><var>Hvj</var><span class="hyp-type"><b>: </b><span>vvalid (IM j) lj (s1 j, iom)</span></span></span><br><span><var>Htj</var><span class="hyp-type"><b>: </b><span>vtransition (IM j) lj (s1 j, iom) = (s&#39; j, oom)</span></span></span><br><span><var>Heq_s'</var><span class="hyp-type"><b>: </b><span>s&#39; = state_update IM s1 j (s&#39; j)</span></span></span><br><span><var>n</var><span class="hyp-type"><b>: </b><span>i ‚â† j</span></span></span><br><span><var>Hvi</var><span class="hyp-type"><b>: </b><span>vvalid (IM i) li (s i, om)</span></span></span><br><span><var>Hti</var><span class="hyp-type"><b>: </b><span>vtransition (IM i) li (s i, om) = (s&#39; i, om&#39;)</span></span></span><br><span><var>Heqs'</var><span class="hyp-type"><b>: </b><span>state_update IM s1 j (s&#39; j) =
state_update IM s i (s1 i)</span></span></span><br><span><var>IHHs2</var><span class="hyp-type"><b>: </b><span>input_valid_transition RFree 
  (existT j lj)
  (state_update IM s j (s1 j), iom) 
  (s, oom)</span></span></span><br></div><label class="goal-separator" for="Composition-v-chk2af"><hr></label><div class="goal-conclusion">input_valid_transition RFree 
  (existT j lj) (s1, iom) 
  (s&#39;, oom)</div></blockquote></div></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">      </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="Composition-v-chk2b0" style="display: none" type="checkbox"><label class="alectryon-input" for="Composition-v-chk2b0">{</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>message, index</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>EqDecision0</var><span class="hyp-type"><b>: </b><span>EqDecision index</span></span></span><br><span><var>IM</var><span class="hyp-type"><b>: </b><span>index ‚Üí VLSM message</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span><span class="kr">‚àÄ</span> <span class="nv">i</span> : index, HistoryVLSM (IM i)</span></span></span><br><span><var>Free</var><span><span class="hyp-body"><b>:= </b><span>free_composite_vlsm IM</span></span><span class="hyp-type"><b>: </b><span>VLSM message</span></span></span></span><br><span><var>RFree</var><span><span class="hyp-body"><b>:= </b><span>pre_loaded_with_all_messages_vlsm Free</span></span><span class="hyp-type"><b>: </b><span>VLSM message</span></span></span></span><br><span><var>s'</var><span class="hyp-type"><b>: </b><span>state</span></span></span><br><span><var>i</var><span class="hyp-type"><b>: </b><span>index</span></span></span><br><span><var>li</var><span class="hyp-type"><b>: </b><span>vlabel (IM i)</span></span></span><br><span><var>om, om'</var><span class="hyp-type"><b>: </b><span>option message</span></span></span><br><span><var>s</var><span class="hyp-type"><b>: </b><span>state</span></span></span><br><span><var>Ht</var><span class="hyp-type"><b>: </b><span>input_valid_transition RFree 
  (existT i li) (s, om) 
  (s&#39;, om&#39;)</span></span></span><br><span><var>j</var><span class="hyp-type"><b>: </b><span>index</span></span></span><br><span><var>lj</var><span class="hyp-type"><b>: </b><span>vlabel (IM j)</span></span></span><br><span><var>s1</var><span class="hyp-type"><b>: </b><span>composite_state IM</span></span></span><br><span><var>iom, oom</var><span class="hyp-type"><b>: </b><span>option message</span></span></span><br><span><var>IHHs2</var><span class="hyp-type"><b>: </b><span>CompositeValidTransition IM 
  (existT j lj) (state_update IM s j (s1 j))
  iom s oom
‚Üí input_valid_transition RFree 
    (existT j lj)
    (state_update IM s j (s1 j), iom) 
    (s, oom)</span></span></span><br><span><var>Hvj</var><span class="hyp-type"><b>: </b><span>vvalid (IM j) lj (s1 j, iom)</span></span></span><br><span><var>Htj</var><span class="hyp-type"><b>: </b><span>vtransition (IM j) lj (s1 j, iom) = (s&#39; j, oom)</span></span></span><br><span><var>Heq_s'</var><span class="hyp-type"><b>: </b><span>s&#39; = state_update IM s1 j (s&#39; j)</span></span></span><br><span><var>n</var><span class="hyp-type"><b>: </b><span>i ‚â† j</span></span></span><br><span><var>Hvi</var><span class="hyp-type"><b>: </b><span>vvalid (IM i) li (s i, om)</span></span></span><br><span><var>Hti</var><span class="hyp-type"><b>: </b><span>vtransition (IM i) li (s i, om) = (s&#39; i, om&#39;)</span></span></span><br><span><var>Heqs'</var><span class="hyp-type"><b>: </b><span>state_update IM s1 j (s&#39; j) =
state_update IM s i (s1 i)</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">CompositeValidTransition IM (existT j lj)
  (state_update IM s j (s1 j)) iom s oom</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">        </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="Composition-v-chk2b1" style="display: none" type="checkbox"><label class="alectryon-input" for="Composition-v-chk2b1"><span class="nb">apply</span> composite_valid_transition_projection_inv <span class="kr">with</span> (s1 j) (s&#39; j); [<span class="bp">done</span> | |].</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>message, index</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>EqDecision0</var><span class="hyp-type"><b>: </b><span>EqDecision index</span></span></span><br><span><var>IM</var><span class="hyp-type"><b>: </b><span>index ‚Üí VLSM message</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span><span class="kr">‚àÄ</span> <span class="nv">i</span> : index, HistoryVLSM (IM i)</span></span></span><br><span><var>Free</var><span><span class="hyp-body"><b>:= </b><span>free_composite_vlsm IM</span></span><span class="hyp-type"><b>: </b><span>VLSM message</span></span></span></span><br><span><var>RFree</var><span><span class="hyp-body"><b>:= </b><span>pre_loaded_with_all_messages_vlsm Free</span></span><span class="hyp-type"><b>: </b><span>VLSM message</span></span></span></span><br><span><var>s'</var><span class="hyp-type"><b>: </b><span>state</span></span></span><br><span><var>i</var><span class="hyp-type"><b>: </b><span>index</span></span></span><br><span><var>li</var><span class="hyp-type"><b>: </b><span>vlabel (IM i)</span></span></span><br><span><var>om, om'</var><span class="hyp-type"><b>: </b><span>option message</span></span></span><br><span><var>s</var><span class="hyp-type"><b>: </b><span>state</span></span></span><br><span><var>Ht</var><span class="hyp-type"><b>: </b><span>input_valid_transition RFree 
  (existT i li) (s, om) 
  (s&#39;, om&#39;)</span></span></span><br><span><var>j</var><span class="hyp-type"><b>: </b><span>index</span></span></span><br><span><var>lj</var><span class="hyp-type"><b>: </b><span>vlabel (IM j)</span></span></span><br><span><var>s1</var><span class="hyp-type"><b>: </b><span>composite_state IM</span></span></span><br><span><var>iom, oom</var><span class="hyp-type"><b>: </b><span>option message</span></span></span><br><span><var>IHHs2</var><span class="hyp-type"><b>: </b><span>CompositeValidTransition IM 
  (existT j lj) (state_update IM s j (s1 j))
  iom s oom
‚Üí input_valid_transition RFree 
    (existT j lj)
    (state_update IM s j (s1 j), iom) 
    (s, oom)</span></span></span><br><span><var>Hvj</var><span class="hyp-type"><b>: </b><span>vvalid (IM j) lj (s1 j, iom)</span></span></span><br><span><var>Htj</var><span class="hyp-type"><b>: </b><span>vtransition (IM j) lj (s1 j, iom) = (s&#39; j, oom)</span></span></span><br><span><var>Heq_s'</var><span class="hyp-type"><b>: </b><span>s&#39; = state_update IM s1 j (s&#39; j)</span></span></span><br><span><var>n</var><span class="hyp-type"><b>: </b><span>i ‚â† j</span></span></span><br><span><var>Hvi</var><span class="hyp-type"><b>: </b><span>vvalid (IM i) li (s i, om)</span></span></span><br><span><var>Hti</var><span class="hyp-type"><b>: </b><span>vtransition (IM i) li (s i, om) = (s&#39; i, om&#39;)</span></span></span><br><span><var>Heqs'</var><span class="hyp-type"><b>: </b><span>state_update IM s1 j (s&#39; j) =
state_update IM s i (s1 i)</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">state_update IM s j (s1 j) j = s1 j</div></blockquote><div class="alectryon-extra-goals"><input class="alectryon-extra-goal-toggle" id="Composition-v-chk2b2" style="display: none" type="checkbox"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>message, index</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>EqDecision0</var><span class="hyp-type"><b>: </b><span>EqDecision index</span></span></span><br><span><var>IM</var><span class="hyp-type"><b>: </b><span>index ‚Üí VLSM message</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span><span class="kr">‚àÄ</span> <span class="nv">i</span> : index, HistoryVLSM (IM i)</span></span></span><br><span><var>Free</var><span><span class="hyp-body"><b>:= </b><span>free_composite_vlsm IM</span></span><span class="hyp-type"><b>: </b><span>VLSM message</span></span></span></span><br><span><var>RFree</var><span><span class="hyp-body"><b>:= </b><span>pre_loaded_with_all_messages_vlsm Free</span></span><span class="hyp-type"><b>: </b><span>VLSM message</span></span></span></span><br><span><var>s'</var><span class="hyp-type"><b>: </b><span>state</span></span></span><br><span><var>i</var><span class="hyp-type"><b>: </b><span>index</span></span></span><br><span><var>li</var><span class="hyp-type"><b>: </b><span>vlabel (IM i)</span></span></span><br><span><var>om, om'</var><span class="hyp-type"><b>: </b><span>option message</span></span></span><br><span><var>s</var><span class="hyp-type"><b>: </b><span>state</span></span></span><br><span><var>Ht</var><span class="hyp-type"><b>: </b><span>input_valid_transition RFree 
  (existT i li) (s, om) 
  (s&#39;, om&#39;)</span></span></span><br><span><var>j</var><span class="hyp-type"><b>: </b><span>index</span></span></span><br><span><var>lj</var><span class="hyp-type"><b>: </b><span>vlabel (IM j)</span></span></span><br><span><var>s1</var><span class="hyp-type"><b>: </b><span>composite_state IM</span></span></span><br><span><var>iom, oom</var><span class="hyp-type"><b>: </b><span>option message</span></span></span><br><span><var>IHHs2</var><span class="hyp-type"><b>: </b><span>CompositeValidTransition IM 
  (existT j lj) (state_update IM s j (s1 j))
  iom s oom
‚Üí input_valid_transition RFree 
    (existT j lj)
    (state_update IM s j (s1 j), iom) 
    (s, oom)</span></span></span><br><span><var>Hvj</var><span class="hyp-type"><b>: </b><span>vvalid (IM j) lj (s1 j, iom)</span></span></span><br><span><var>Htj</var><span class="hyp-type"><b>: </b><span>vtransition (IM j) lj (s1 j, iom) = (s&#39; j, oom)</span></span></span><br><span><var>Heq_s'</var><span class="hyp-type"><b>: </b><span>s&#39; = state_update IM s1 j (s&#39; j)</span></span></span><br><span><var>n</var><span class="hyp-type"><b>: </b><span>i ‚â† j</span></span></span><br><span><var>Hvi</var><span class="hyp-type"><b>: </b><span>vvalid (IM i) li (s i, om)</span></span></span><br><span><var>Hti</var><span class="hyp-type"><b>: </b><span>vtransition (IM i) li (s i, om) = (s&#39; i, om&#39;)</span></span></span><br><span><var>Heqs'</var><span class="hyp-type"><b>: </b><span>state_update IM s1 j (s&#39; j) =
state_update IM s i (s1 i)</span></span></span><br></div><label class="goal-separator" for="Composition-v-chk2b2"><hr></label><div class="goal-conclusion">s =
state_update IM (state_update IM s j (s1 j)) j (s&#39; j)</div></blockquote></div></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">        </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="Composition-v-chk2b3" style="display: none" type="checkbox"><label class="alectryon-input" for="Composition-v-chk2b3">-</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>message, index</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>EqDecision0</var><span class="hyp-type"><b>: </b><span>EqDecision index</span></span></span><br><span><var>IM</var><span class="hyp-type"><b>: </b><span>index ‚Üí VLSM message</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span><span class="kr">‚àÄ</span> <span class="nv">i</span> : index, HistoryVLSM (IM i)</span></span></span><br><span><var>Free</var><span><span class="hyp-body"><b>:= </b><span>free_composite_vlsm IM</span></span><span class="hyp-type"><b>: </b><span>VLSM message</span></span></span></span><br><span><var>RFree</var><span><span class="hyp-body"><b>:= </b><span>pre_loaded_with_all_messages_vlsm Free</span></span><span class="hyp-type"><b>: </b><span>VLSM message</span></span></span></span><br><span><var>s'</var><span class="hyp-type"><b>: </b><span>state</span></span></span><br><span><var>i</var><span class="hyp-type"><b>: </b><span>index</span></span></span><br><span><var>li</var><span class="hyp-type"><b>: </b><span>vlabel (IM i)</span></span></span><br><span><var>om, om'</var><span class="hyp-type"><b>: </b><span>option message</span></span></span><br><span><var>s</var><span class="hyp-type"><b>: </b><span>state</span></span></span><br><span><var>Ht</var><span class="hyp-type"><b>: </b><span>input_valid_transition RFree 
  (existT i li) (s, om) 
  (s&#39;, om&#39;)</span></span></span><br><span><var>j</var><span class="hyp-type"><b>: </b><span>index</span></span></span><br><span><var>lj</var><span class="hyp-type"><b>: </b><span>vlabel (IM j)</span></span></span><br><span><var>s1</var><span class="hyp-type"><b>: </b><span>composite_state IM</span></span></span><br><span><var>iom, oom</var><span class="hyp-type"><b>: </b><span>option message</span></span></span><br><span><var>IHHs2</var><span class="hyp-type"><b>: </b><span>CompositeValidTransition IM 
  (existT j lj) (state_update IM s j (s1 j))
  iom s oom
‚Üí input_valid_transition RFree 
    (existT j lj)
    (state_update IM s j (s1 j), iom) 
    (s, oom)</span></span></span><br><span><var>Hvj</var><span class="hyp-type"><b>: </b><span>vvalid (IM j) lj (s1 j, iom)</span></span></span><br><span><var>Htj</var><span class="hyp-type"><b>: </b><span>vtransition (IM j) lj (s1 j, iom) = (s&#39; j, oom)</span></span></span><br><span><var>Heq_s'</var><span class="hyp-type"><b>: </b><span>s&#39; = state_update IM s1 j (s&#39; j)</span></span></span><br><span><var>n</var><span class="hyp-type"><b>: </b><span>i ‚â† j</span></span></span><br><span><var>Hvi</var><span class="hyp-type"><b>: </b><span>vvalid (IM i) li (s i, om)</span></span></span><br><span><var>Hti</var><span class="hyp-type"><b>: </b><span>vtransition (IM i) li (s i, om) = (s&#39; i, om&#39;)</span></span></span><br><span><var>Heqs'</var><span class="hyp-type"><b>: </b><span>state_update IM s1 j (s&#39; j) =
state_update IM s i (s1 i)</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">state_update IM s j (s1 j) j = s1 j</div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="bp">by</span> state_update_simpl.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">        </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="Composition-v-chk2b4" style="display: none" type="checkbox"><label class="alectryon-input" for="Composition-v-chk2b4">-</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>message, index</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>EqDecision0</var><span class="hyp-type"><b>: </b><span>EqDecision index</span></span></span><br><span><var>IM</var><span class="hyp-type"><b>: </b><span>index ‚Üí VLSM message</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span><span class="kr">‚àÄ</span> <span class="nv">i</span> : index, HistoryVLSM (IM i)</span></span></span><br><span><var>Free</var><span><span class="hyp-body"><b>:= </b><span>free_composite_vlsm IM</span></span><span class="hyp-type"><b>: </b><span>VLSM message</span></span></span></span><br><span><var>RFree</var><span><span class="hyp-body"><b>:= </b><span>pre_loaded_with_all_messages_vlsm Free</span></span><span class="hyp-type"><b>: </b><span>VLSM message</span></span></span></span><br><span><var>s'</var><span class="hyp-type"><b>: </b><span>state</span></span></span><br><span><var>i</var><span class="hyp-type"><b>: </b><span>index</span></span></span><br><span><var>li</var><span class="hyp-type"><b>: </b><span>vlabel (IM i)</span></span></span><br><span><var>om, om'</var><span class="hyp-type"><b>: </b><span>option message</span></span></span><br><span><var>s</var><span class="hyp-type"><b>: </b><span>state</span></span></span><br><span><var>Ht</var><span class="hyp-type"><b>: </b><span>input_valid_transition RFree 
  (existT i li) (s, om) 
  (s&#39;, om&#39;)</span></span></span><br><span><var>j</var><span class="hyp-type"><b>: </b><span>index</span></span></span><br><span><var>lj</var><span class="hyp-type"><b>: </b><span>vlabel (IM j)</span></span></span><br><span><var>s1</var><span class="hyp-type"><b>: </b><span>composite_state IM</span></span></span><br><span><var>iom, oom</var><span class="hyp-type"><b>: </b><span>option message</span></span></span><br><span><var>IHHs2</var><span class="hyp-type"><b>: </b><span>CompositeValidTransition IM 
  (existT j lj) (state_update IM s j (s1 j))
  iom s oom
‚Üí input_valid_transition RFree 
    (existT j lj)
    (state_update IM s j (s1 j), iom) 
    (s, oom)</span></span></span><br><span><var>Hvj</var><span class="hyp-type"><b>: </b><span>vvalid (IM j) lj (s1 j, iom)</span></span></span><br><span><var>Htj</var><span class="hyp-type"><b>: </b><span>vtransition (IM j) lj (s1 j, iom) = (s&#39; j, oom)</span></span></span><br><span><var>Heq_s'</var><span class="hyp-type"><b>: </b><span>s&#39; = state_update IM s1 j (s&#39; j)</span></span></span><br><span><var>n</var><span class="hyp-type"><b>: </b><span>i ‚â† j</span></span></span><br><span><var>Hvi</var><span class="hyp-type"><b>: </b><span>vvalid (IM i) li (s i, om)</span></span></span><br><span><var>Hti</var><span class="hyp-type"><b>: </b><span>vtransition (IM i) li (s i, om) = (s&#39; i, om&#39;)</span></span></span><br><span><var>Heqs'</var><span class="hyp-type"><b>: </b><span>state_update IM s1 j (s&#39; j) =
state_update IM s i (s1 i)</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">s =
state_update IM (state_update IM s j (s1 j)) j (s&#39; j)</div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="Composition-v-chk2b5" style="display: none" type="checkbox"><label class="alectryon-input" for="Composition-v-chk2b5"><span class="nb">rewrite</span> state_update_twice.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>message, index</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>EqDecision0</var><span class="hyp-type"><b>: </b><span>EqDecision index</span></span></span><br><span><var>IM</var><span class="hyp-type"><b>: </b><span>index ‚Üí VLSM message</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span><span class="kr">‚àÄ</span> <span class="nv">i</span> : index, HistoryVLSM (IM i)</span></span></span><br><span><var>Free</var><span><span class="hyp-body"><b>:= </b><span>free_composite_vlsm IM</span></span><span class="hyp-type"><b>: </b><span>VLSM message</span></span></span></span><br><span><var>RFree</var><span><span class="hyp-body"><b>:= </b><span>pre_loaded_with_all_messages_vlsm Free</span></span><span class="hyp-type"><b>: </b><span>VLSM message</span></span></span></span><br><span><var>s'</var><span class="hyp-type"><b>: </b><span>state</span></span></span><br><span><var>i</var><span class="hyp-type"><b>: </b><span>index</span></span></span><br><span><var>li</var><span class="hyp-type"><b>: </b><span>vlabel (IM i)</span></span></span><br><span><var>om, om'</var><span class="hyp-type"><b>: </b><span>option message</span></span></span><br><span><var>s</var><span class="hyp-type"><b>: </b><span>state</span></span></span><br><span><var>Ht</var><span class="hyp-type"><b>: </b><span>input_valid_transition RFree 
  (existT i li) (s, om) 
  (s&#39;, om&#39;)</span></span></span><br><span><var>j</var><span class="hyp-type"><b>: </b><span>index</span></span></span><br><span><var>lj</var><span class="hyp-type"><b>: </b><span>vlabel (IM j)</span></span></span><br><span><var>s1</var><span class="hyp-type"><b>: </b><span>composite_state IM</span></span></span><br><span><var>iom, oom</var><span class="hyp-type"><b>: </b><span>option message</span></span></span><br><span><var>IHHs2</var><span class="hyp-type"><b>: </b><span>CompositeValidTransition IM 
  (existT j lj) (state_update IM s j (s1 j))
  iom s oom
‚Üí input_valid_transition RFree 
    (existT j lj)
    (state_update IM s j (s1 j), iom) 
    (s, oom)</span></span></span><br><span><var>Hvj</var><span class="hyp-type"><b>: </b><span>vvalid (IM j) lj (s1 j, iom)</span></span></span><br><span><var>Htj</var><span class="hyp-type"><b>: </b><span>vtransition (IM j) lj (s1 j, iom) = (s&#39; j, oom)</span></span></span><br><span><var>Heq_s'</var><span class="hyp-type"><b>: </b><span>s&#39; = state_update IM s1 j (s&#39; j)</span></span></span><br><span><var>n</var><span class="hyp-type"><b>: </b><span>i ‚â† j</span></span></span><br><span><var>Hvi</var><span class="hyp-type"><b>: </b><span>vvalid (IM i) li (s i, om)</span></span></span><br><span><var>Hti</var><span class="hyp-type"><b>: </b><span>vtransition (IM i) li (s i, om) = (s&#39; i, om&#39;)</span></span></span><br><span><var>Heqs'</var><span class="hyp-type"><b>: </b><span>state_update IM s1 j (s&#39; j) =
state_update IM s i (s1 i)</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">s = state_update IM s j (s&#39; j)</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">          </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="Composition-v-chk2b6" style="display: none" type="checkbox"><label class="alectryon-input" for="Composition-v-chk2b6"><span class="nb">symmetry</span>; <span class="nb">apply</span> state_update_id.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>message, index</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>EqDecision0</var><span class="hyp-type"><b>: </b><span>EqDecision index</span></span></span><br><span><var>IM</var><span class="hyp-type"><b>: </b><span>index ‚Üí VLSM message</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span><span class="kr">‚àÄ</span> <span class="nv">i</span> : index, HistoryVLSM (IM i)</span></span></span><br><span><var>Free</var><span><span class="hyp-body"><b>:= </b><span>free_composite_vlsm IM</span></span><span class="hyp-type"><b>: </b><span>VLSM message</span></span></span></span><br><span><var>RFree</var><span><span class="hyp-body"><b>:= </b><span>pre_loaded_with_all_messages_vlsm Free</span></span><span class="hyp-type"><b>: </b><span>VLSM message</span></span></span></span><br><span><var>s'</var><span class="hyp-type"><b>: </b><span>state</span></span></span><br><span><var>i</var><span class="hyp-type"><b>: </b><span>index</span></span></span><br><span><var>li</var><span class="hyp-type"><b>: </b><span>vlabel (IM i)</span></span></span><br><span><var>om, om'</var><span class="hyp-type"><b>: </b><span>option message</span></span></span><br><span><var>s</var><span class="hyp-type"><b>: </b><span>state</span></span></span><br><span><var>Ht</var><span class="hyp-type"><b>: </b><span>input_valid_transition RFree 
  (existT i li) (s, om) 
  (s&#39;, om&#39;)</span></span></span><br><span><var>j</var><span class="hyp-type"><b>: </b><span>index</span></span></span><br><span><var>lj</var><span class="hyp-type"><b>: </b><span>vlabel (IM j)</span></span></span><br><span><var>s1</var><span class="hyp-type"><b>: </b><span>composite_state IM</span></span></span><br><span><var>iom, oom</var><span class="hyp-type"><b>: </b><span>option message</span></span></span><br><span><var>IHHs2</var><span class="hyp-type"><b>: </b><span>CompositeValidTransition IM 
  (existT j lj) (state_update IM s j (s1 j))
  iom s oom
‚Üí input_valid_transition RFree 
    (existT j lj)
    (state_update IM s j (s1 j), iom) 
    (s, oom)</span></span></span><br><span><var>Hvj</var><span class="hyp-type"><b>: </b><span>vvalid (IM j) lj (s1 j, iom)</span></span></span><br><span><var>Htj</var><span class="hyp-type"><b>: </b><span>vtransition (IM j) lj (s1 j, iom) = (s&#39; j, oom)</span></span></span><br><span><var>Heq_s'</var><span class="hyp-type"><b>: </b><span>s&#39; = state_update IM s1 j (s&#39; j)</span></span></span><br><span><var>n</var><span class="hyp-type"><b>: </b><span>i ‚â† j</span></span></span><br><span><var>Hvi</var><span class="hyp-type"><b>: </b><span>vvalid (IM i) li (s i, om)</span></span></span><br><span><var>Hti</var><span class="hyp-type"><b>: </b><span>vtransition (IM i) li (s i, om) = (s&#39; i, om&#39;)</span></span></span><br><span><var>Heqs'</var><span class="hyp-type"><b>: </b><span>state_update IM s1 j (s&#39; j) =
state_update IM s i (s1 i)</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">s j = s&#39; j</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">          </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="Composition-v-chk2b7" style="display: none" type="checkbox"><label class="alectryon-input" for="Composition-v-chk2b7"><span class="nb">apply</span> <span class="nb">f_equal</span> <span class="kr">with</span> (f := <span class="kr">fun</span> <span class="nv">s</span> =&gt; s j) <span class="kr">in</span> Heqs&#39;.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>message, index</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>EqDecision0</var><span class="hyp-type"><b>: </b><span>EqDecision index</span></span></span><br><span><var>IM</var><span class="hyp-type"><b>: </b><span>index ‚Üí VLSM message</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span><span class="kr">‚àÄ</span> <span class="nv">i</span> : index, HistoryVLSM (IM i)</span></span></span><br><span><var>Free</var><span><span class="hyp-body"><b>:= </b><span>free_composite_vlsm IM</span></span><span class="hyp-type"><b>: </b><span>VLSM message</span></span></span></span><br><span><var>RFree</var><span><span class="hyp-body"><b>:= </b><span>pre_loaded_with_all_messages_vlsm Free</span></span><span class="hyp-type"><b>: </b><span>VLSM message</span></span></span></span><br><span><var>s'</var><span class="hyp-type"><b>: </b><span>state</span></span></span><br><span><var>i</var><span class="hyp-type"><b>: </b><span>index</span></span></span><br><span><var>li</var><span class="hyp-type"><b>: </b><span>vlabel (IM i)</span></span></span><br><span><var>om, om'</var><span class="hyp-type"><b>: </b><span>option message</span></span></span><br><span><var>s</var><span class="hyp-type"><b>: </b><span>state</span></span></span><br><span><var>Ht</var><span class="hyp-type"><b>: </b><span>input_valid_transition RFree 
  (existT i li) (s, om) 
  (s&#39;, om&#39;)</span></span></span><br><span><var>j</var><span class="hyp-type"><b>: </b><span>index</span></span></span><br><span><var>lj</var><span class="hyp-type"><b>: </b><span>vlabel (IM j)</span></span></span><br><span><var>s1</var><span class="hyp-type"><b>: </b><span>composite_state IM</span></span></span><br><span><var>iom, oom</var><span class="hyp-type"><b>: </b><span>option message</span></span></span><br><span><var>IHHs2</var><span class="hyp-type"><b>: </b><span>CompositeValidTransition IM 
  (existT j lj) (state_update IM s j (s1 j))
  iom s oom
‚Üí input_valid_transition RFree 
    (existT j lj)
    (state_update IM s j (s1 j), iom) 
    (s, oom)</span></span></span><br><span><var>Hvj</var><span class="hyp-type"><b>: </b><span>vvalid (IM j) lj (s1 j, iom)</span></span></span><br><span><var>Htj</var><span class="hyp-type"><b>: </b><span>vtransition (IM j) lj (s1 j, iom) = (s&#39; j, oom)</span></span></span><br><span><var>Heq_s'</var><span class="hyp-type"><b>: </b><span>s&#39; = state_update IM s1 j (s&#39; j)</span></span></span><br><span><var>n</var><span class="hyp-type"><b>: </b><span>i ‚â† j</span></span></span><br><span><var>Hvi</var><span class="hyp-type"><b>: </b><span>vvalid (IM i) li (s i, om)</span></span></span><br><span><var>Hti</var><span class="hyp-type"><b>: </b><span>vtransition (IM i) li (s i, om) = (s&#39; i, om&#39;)</span></span></span><br><span><var>Heqs'</var><span class="hyp-type"><b>: </b><span>state_update IM s1 j (s&#39; j) j =
state_update IM s i (s1 i) j</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">s j = s&#39; j</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">          </span><span class="alectryon-sentence"><span class="alectryon-input"><span class="bp">by</span> state_update_simpl.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">      </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="Composition-v-chk2b8" style="display: none" type="checkbox"><label class="alectryon-input" for="Composition-v-chk2b8">}</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>message, index</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>EqDecision0</var><span class="hyp-type"><b>: </b><span>EqDecision index</span></span></span><br><span><var>IM</var><span class="hyp-type"><b>: </b><span>index ‚Üí VLSM message</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span><span class="kr">‚àÄ</span> <span class="nv">i</span> : index, HistoryVLSM (IM i)</span></span></span><br><span><var>Free</var><span><span class="hyp-body"><b>:= </b><span>free_composite_vlsm IM</span></span><span class="hyp-type"><b>: </b><span>VLSM message</span></span></span></span><br><span><var>RFree</var><span><span class="hyp-body"><b>:= </b><span>pre_loaded_with_all_messages_vlsm Free</span></span><span class="hyp-type"><b>: </b><span>VLSM message</span></span></span></span><br><span><var>s'</var><span class="hyp-type"><b>: </b><span>state</span></span></span><br><span><var>i</var><span class="hyp-type"><b>: </b><span>index</span></span></span><br><span><var>li</var><span class="hyp-type"><b>: </b><span>vlabel (IM i)</span></span></span><br><span><var>om, om'</var><span class="hyp-type"><b>: </b><span>option message</span></span></span><br><span><var>s</var><span class="hyp-type"><b>: </b><span>state</span></span></span><br><span><var>Ht</var><span class="hyp-type"><b>: </b><span>input_valid_transition RFree 
  (existT i li) (s, om) 
  (s&#39;, om&#39;)</span></span></span><br><span><var>j</var><span class="hyp-type"><b>: </b><span>index</span></span></span><br><span><var>lj</var><span class="hyp-type"><b>: </b><span>vlabel (IM j)</span></span></span><br><span><var>s1</var><span class="hyp-type"><b>: </b><span>composite_state IM</span></span></span><br><span><var>iom, oom</var><span class="hyp-type"><b>: </b><span>option message</span></span></span><br><span><var>Hvj</var><span class="hyp-type"><b>: </b><span>vvalid (IM j) lj (s1 j, iom)</span></span></span><br><span><var>Htj</var><span class="hyp-type"><b>: </b><span>vtransition (IM j) lj (s1 j, iom) = (s&#39; j, oom)</span></span></span><br><span><var>Heq_s'</var><span class="hyp-type"><b>: </b><span>s&#39; = state_update IM s1 j (s&#39; j)</span></span></span><br><span><var>n</var><span class="hyp-type"><b>: </b><span>i ‚â† j</span></span></span><br><span><var>Hvi</var><span class="hyp-type"><b>: </b><span>vvalid (IM i) li (s i, om)</span></span></span><br><span><var>Hti</var><span class="hyp-type"><b>: </b><span>vtransition (IM i) li (s i, om) = (s&#39; i, om&#39;)</span></span></span><br><span><var>Heqs'</var><span class="hyp-type"><b>: </b><span>state_update IM s1 j (s&#39; j) =
state_update IM s i (s1 i)</span></span></span><br><span><var>IHHs2</var><span class="hyp-type"><b>: </b><span>input_valid_transition RFree 
  (existT j lj)
  (state_update IM s j (s1 j), iom) 
  (s, oom)</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">input_valid_transition RFree (existT j lj) (s1, iom)
  (s&#39;, oom)</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">      </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="Composition-v-chk2b9" style="display: none" type="checkbox"><label class="alectryon-input" for="Composition-v-chk2b9"><span class="nb">assert</span> (Hss1 : input_valid_transition RFree (existT i li)
                  (state_update IM s j (s1 j), om) (s1, om&#39;)).</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>message, index</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>EqDecision0</var><span class="hyp-type"><b>: </b><span>EqDecision index</span></span></span><br><span><var>IM</var><span class="hyp-type"><b>: </b><span>index ‚Üí VLSM message</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span><span class="kr">‚àÄ</span> <span class="nv">i</span> : index, HistoryVLSM (IM i)</span></span></span><br><span><var>Free</var><span><span class="hyp-body"><b>:= </b><span>free_composite_vlsm IM</span></span><span class="hyp-type"><b>: </b><span>VLSM message</span></span></span></span><br><span><var>RFree</var><span><span class="hyp-body"><b>:= </b><span>pre_loaded_with_all_messages_vlsm Free</span></span><span class="hyp-type"><b>: </b><span>VLSM message</span></span></span></span><br><span><var>s'</var><span class="hyp-type"><b>: </b><span>state</span></span></span><br><span><var>i</var><span class="hyp-type"><b>: </b><span>index</span></span></span><br><span><var>li</var><span class="hyp-type"><b>: </b><span>vlabel (IM i)</span></span></span><br><span><var>om, om'</var><span class="hyp-type"><b>: </b><span>option message</span></span></span><br><span><var>s</var><span class="hyp-type"><b>: </b><span>state</span></span></span><br><span><var>Ht</var><span class="hyp-type"><b>: </b><span>input_valid_transition RFree 
  (existT i li) (s, om) 
  (s&#39;, om&#39;)</span></span></span><br><span><var>j</var><span class="hyp-type"><b>: </b><span>index</span></span></span><br><span><var>lj</var><span class="hyp-type"><b>: </b><span>vlabel (IM j)</span></span></span><br><span><var>s1</var><span class="hyp-type"><b>: </b><span>composite_state IM</span></span></span><br><span><var>iom, oom</var><span class="hyp-type"><b>: </b><span>option message</span></span></span><br><span><var>Hvj</var><span class="hyp-type"><b>: </b><span>vvalid (IM j) lj (s1 j, iom)</span></span></span><br><span><var>Htj</var><span class="hyp-type"><b>: </b><span>vtransition (IM j) lj (s1 j, iom) = (s&#39; j, oom)</span></span></span><br><span><var>Heq_s'</var><span class="hyp-type"><b>: </b><span>s&#39; = state_update IM s1 j (s&#39; j)</span></span></span><br><span><var>n</var><span class="hyp-type"><b>: </b><span>i ‚â† j</span></span></span><br><span><var>Hvi</var><span class="hyp-type"><b>: </b><span>vvalid (IM i) li (s i, om)</span></span></span><br><span><var>Hti</var><span class="hyp-type"><b>: </b><span>vtransition (IM i) li (s i, om) = (s&#39; i, om&#39;)</span></span></span><br><span><var>Heqs'</var><span class="hyp-type"><b>: </b><span>state_update IM s1 j (s&#39; j) =
state_update IM s i (s1 i)</span></span></span><br><span><var>IHHs2</var><span class="hyp-type"><b>: </b><span>input_valid_transition RFree 
  (existT j lj)
  (state_update IM s j (s1 j), iom) 
  (s, oom)</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">input_valid_transition RFree (existT i li)
  (state_update IM s j (s1 j), om) (s1, om&#39;)</div></blockquote><div class="alectryon-extra-goals"><input class="alectryon-extra-goal-toggle" id="Composition-v-chk2ba" style="display: none" type="checkbox"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>message, index</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>EqDecision0</var><span class="hyp-type"><b>: </b><span>EqDecision index</span></span></span><br><span><var>IM</var><span class="hyp-type"><b>: </b><span>index ‚Üí VLSM message</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span><span class="kr">‚àÄ</span> <span class="nv">i</span> : index, HistoryVLSM (IM i)</span></span></span><br><span><var>Free</var><span><span class="hyp-body"><b>:= </b><span>free_composite_vlsm IM</span></span><span class="hyp-type"><b>: </b><span>VLSM message</span></span></span></span><br><span><var>RFree</var><span><span class="hyp-body"><b>:= </b><span>pre_loaded_with_all_messages_vlsm Free</span></span><span class="hyp-type"><b>: </b><span>VLSM message</span></span></span></span><br><span><var>s'</var><span class="hyp-type"><b>: </b><span>state</span></span></span><br><span><var>i</var><span class="hyp-type"><b>: </b><span>index</span></span></span><br><span><var>li</var><span class="hyp-type"><b>: </b><span>vlabel (IM i)</span></span></span><br><span><var>om, om'</var><span class="hyp-type"><b>: </b><span>option message</span></span></span><br><span><var>s</var><span class="hyp-type"><b>: </b><span>state</span></span></span><br><span><var>Ht</var><span class="hyp-type"><b>: </b><span>input_valid_transition RFree 
  (existT i li) (s, om) 
  (s&#39;, om&#39;)</span></span></span><br><span><var>j</var><span class="hyp-type"><b>: </b><span>index</span></span></span><br><span><var>lj</var><span class="hyp-type"><b>: </b><span>vlabel (IM j)</span></span></span><br><span><var>s1</var><span class="hyp-type"><b>: </b><span>composite_state IM</span></span></span><br><span><var>iom, oom</var><span class="hyp-type"><b>: </b><span>option message</span></span></span><br><span><var>Hvj</var><span class="hyp-type"><b>: </b><span>vvalid (IM j) lj (s1 j, iom)</span></span></span><br><span><var>Htj</var><span class="hyp-type"><b>: </b><span>vtransition (IM j) lj (s1 j, iom) = (s&#39; j, oom)</span></span></span><br><span><var>Heq_s'</var><span class="hyp-type"><b>: </b><span>s&#39; = state_update IM s1 j (s&#39; j)</span></span></span><br><span><var>n</var><span class="hyp-type"><b>: </b><span>i ‚â† j</span></span></span><br><span><var>Hvi</var><span class="hyp-type"><b>: </b><span>vvalid (IM i) li (s i, om)</span></span></span><br><span><var>Hti</var><span class="hyp-type"><b>: </b><span>vtransition (IM i) li (s i, om) = (s&#39; i, om&#39;)</span></span></span><br><span><var>Heqs'</var><span class="hyp-type"><b>: </b><span>state_update IM s1 j (s&#39; j) =
state_update IM s i (s1 i)</span></span></span><br><span><var>IHHs2</var><span class="hyp-type"><b>: </b><span>input_valid_transition RFree 
  (existT j lj)
  (state_update IM s j (s1 j), iom) 
  (s, oom)</span></span></span><br><span><var>Hss1</var><span class="hyp-type"><b>: </b><span>input_valid_transition RFree 
  (existT i li)
  (state_update IM s j (s1 j), om) 
  (s1, om&#39;)</span></span></span><br></div><label class="goal-separator" for="Composition-v-chk2ba"><hr></label><div class="goal-conclusion">input_valid_transition RFree 
  (existT j lj) (s1, iom) 
  (s&#39;, oom)</div></blockquote></div></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">      </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="Composition-v-chk2bb" style="display: none" type="checkbox"><label class="alectryon-input" for="Composition-v-chk2bb">{</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>message, index</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>EqDecision0</var><span class="hyp-type"><b>: </b><span>EqDecision index</span></span></span><br><span><var>IM</var><span class="hyp-type"><b>: </b><span>index ‚Üí VLSM message</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span><span class="kr">‚àÄ</span> <span class="nv">i</span> : index, HistoryVLSM (IM i)</span></span></span><br><span><var>Free</var><span><span class="hyp-body"><b>:= </b><span>free_composite_vlsm IM</span></span><span class="hyp-type"><b>: </b><span>VLSM message</span></span></span></span><br><span><var>RFree</var><span><span class="hyp-body"><b>:= </b><span>pre_loaded_with_all_messages_vlsm Free</span></span><span class="hyp-type"><b>: </b><span>VLSM message</span></span></span></span><br><span><var>s'</var><span class="hyp-type"><b>: </b><span>state</span></span></span><br><span><var>i</var><span class="hyp-type"><b>: </b><span>index</span></span></span><br><span><var>li</var><span class="hyp-type"><b>: </b><span>vlabel (IM i)</span></span></span><br><span><var>om, om'</var><span class="hyp-type"><b>: </b><span>option message</span></span></span><br><span><var>s</var><span class="hyp-type"><b>: </b><span>state</span></span></span><br><span><var>Ht</var><span class="hyp-type"><b>: </b><span>input_valid_transition RFree 
  (existT i li) (s, om) 
  (s&#39;, om&#39;)</span></span></span><br><span><var>j</var><span class="hyp-type"><b>: </b><span>index</span></span></span><br><span><var>lj</var><span class="hyp-type"><b>: </b><span>vlabel (IM j)</span></span></span><br><span><var>s1</var><span class="hyp-type"><b>: </b><span>composite_state IM</span></span></span><br><span><var>iom, oom</var><span class="hyp-type"><b>: </b><span>option message</span></span></span><br><span><var>Hvj</var><span class="hyp-type"><b>: </b><span>vvalid (IM j) lj (s1 j, iom)</span></span></span><br><span><var>Htj</var><span class="hyp-type"><b>: </b><span>vtransition (IM j) lj (s1 j, iom) = (s&#39; j, oom)</span></span></span><br><span><var>Heq_s'</var><span class="hyp-type"><b>: </b><span>s&#39; = state_update IM s1 j (s&#39; j)</span></span></span><br><span><var>n</var><span class="hyp-type"><b>: </b><span>i ‚â† j</span></span></span><br><span><var>Hvi</var><span class="hyp-type"><b>: </b><span>vvalid (IM i) li (s i, om)</span></span></span><br><span><var>Hti</var><span class="hyp-type"><b>: </b><span>vtransition (IM i) li (s i, om) = (s&#39; i, om&#39;)</span></span></span><br><span><var>Heqs'</var><span class="hyp-type"><b>: </b><span>state_update IM s1 j (s&#39; j) =
state_update IM s i (s1 i)</span></span></span><br><span><var>IHHs2</var><span class="hyp-type"><b>: </b><span>input_valid_transition RFree 
  (existT j lj)
  (state_update IM s j (s1 j), iom) 
  (s, oom)</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">input_valid_transition RFree (existT i li)
  (state_update IM s j (s1 j), om) (s1, om&#39;)</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">        </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="Composition-v-chk2bc" style="display: none" type="checkbox"><label class="alectryon-input" for="Composition-v-chk2bc"><span class="kp">repeat</span> <span class="nb">split</span>; [<span class="nb">apply</span> IHHs2 | <span class="nb">apply</span> any_message_is_valid_in_preloaded |..]
        ; <span class="nb">cbn</span>; state_update_simpl; [<span class="bp">done</span> |].</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>message, index</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>EqDecision0</var><span class="hyp-type"><b>: </b><span>EqDecision index</span></span></span><br><span><var>IM</var><span class="hyp-type"><b>: </b><span>index ‚Üí VLSM message</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span><span class="kr">‚àÄ</span> <span class="nv">i</span> : index, HistoryVLSM (IM i)</span></span></span><br><span><var>Free</var><span><span class="hyp-body"><b>:= </b><span>free_composite_vlsm IM</span></span><span class="hyp-type"><b>: </b><span>VLSM message</span></span></span></span><br><span><var>RFree</var><span><span class="hyp-body"><b>:= </b><span>pre_loaded_with_all_messages_vlsm Free</span></span><span class="hyp-type"><b>: </b><span>VLSM message</span></span></span></span><br><span><var>s'</var><span class="hyp-type"><b>: </b><span>state</span></span></span><br><span><var>i</var><span class="hyp-type"><b>: </b><span>index</span></span></span><br><span><var>li</var><span class="hyp-type"><b>: </b><span>vlabel (IM i)</span></span></span><br><span><var>om, om'</var><span class="hyp-type"><b>: </b><span>option message</span></span></span><br><span><var>s</var><span class="hyp-type"><b>: </b><span>state</span></span></span><br><span><var>Ht</var><span class="hyp-type"><b>: </b><span>input_valid_transition RFree 
  (existT i li) (s, om) 
  (s&#39;, om&#39;)</span></span></span><br><span><var>j</var><span class="hyp-type"><b>: </b><span>index</span></span></span><br><span><var>lj</var><span class="hyp-type"><b>: </b><span>vlabel (IM j)</span></span></span><br><span><var>s1</var><span class="hyp-type"><b>: </b><span>composite_state IM</span></span></span><br><span><var>iom, oom</var><span class="hyp-type"><b>: </b><span>option message</span></span></span><br><span><var>Hvj</var><span class="hyp-type"><b>: </b><span>vvalid (IM j) lj (s1 j, iom)</span></span></span><br><span><var>Htj</var><span class="hyp-type"><b>: </b><span>vtransition (IM j) lj (s1 j, iom) = (s&#39; j, oom)</span></span></span><br><span><var>Heq_s'</var><span class="hyp-type"><b>: </b><span>s&#39; = state_update IM s1 j (s&#39; j)</span></span></span><br><span><var>n</var><span class="hyp-type"><b>: </b><span>i ‚â† j</span></span></span><br><span><var>Hvi</var><span class="hyp-type"><b>: </b><span>vvalid (IM i) li (s i, om)</span></span></span><br><span><var>Hti</var><span class="hyp-type"><b>: </b><span>vtransition (IM i) li (s i, om) = (s&#39; i, om&#39;)</span></span></span><br><span><var>Heqs'</var><span class="hyp-type"><b>: </b><span>state_update IM s1 j (s&#39; j) =
state_update IM s i (s1 i)</span></span></span><br><span><var>IHHs2</var><span class="hyp-type"><b>: </b><span>input_valid_transition RFree 
  (existT j lj)
  (state_update IM s j (s1 j), iom) 
  (s, oom)</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">(<span class="kr">let</span> (<span class="nv">si&#39;</span>, om&#39;) := vtransition (IM i) li (s i, om) <span class="kr">in</span>
 (state_update IM (state_update IM s j (s1 j)) i si&#39;,
 om&#39;)) = (s1, om&#39;)</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">        </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="Composition-v-chk2bd" style="display: none" type="checkbox"><label class="alectryon-input" for="Composition-v-chk2bd"><span class="nb">replace</span> (vtransition _ _ _) <span class="kr">with</span> (s&#39; i, om&#39;).</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>message, index</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>EqDecision0</var><span class="hyp-type"><b>: </b><span>EqDecision index</span></span></span><br><span><var>IM</var><span class="hyp-type"><b>: </b><span>index ‚Üí VLSM message</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span><span class="kr">‚àÄ</span> <span class="nv">i</span> : index, HistoryVLSM (IM i)</span></span></span><br><span><var>Free</var><span><span class="hyp-body"><b>:= </b><span>free_composite_vlsm IM</span></span><span class="hyp-type"><b>: </b><span>VLSM message</span></span></span></span><br><span><var>RFree</var><span><span class="hyp-body"><b>:= </b><span>pre_loaded_with_all_messages_vlsm Free</span></span><span class="hyp-type"><b>: </b><span>VLSM message</span></span></span></span><br><span><var>s'</var><span class="hyp-type"><b>: </b><span>state</span></span></span><br><span><var>i</var><span class="hyp-type"><b>: </b><span>index</span></span></span><br><span><var>li</var><span class="hyp-type"><b>: </b><span>vlabel (IM i)</span></span></span><br><span><var>om, om'</var><span class="hyp-type"><b>: </b><span>option message</span></span></span><br><span><var>s</var><span class="hyp-type"><b>: </b><span>state</span></span></span><br><span><var>Ht</var><span class="hyp-type"><b>: </b><span>input_valid_transition RFree 
  (existT i li) (s, om) 
  (s&#39;, om&#39;)</span></span></span><br><span><var>j</var><span class="hyp-type"><b>: </b><span>index</span></span></span><br><span><var>lj</var><span class="hyp-type"><b>: </b><span>vlabel (IM j)</span></span></span><br><span><var>s1</var><span class="hyp-type"><b>: </b><span>composite_state IM</span></span></span><br><span><var>iom, oom</var><span class="hyp-type"><b>: </b><span>option message</span></span></span><br><span><var>Hvj</var><span class="hyp-type"><b>: </b><span>vvalid (IM j) lj (s1 j, iom)</span></span></span><br><span><var>Htj</var><span class="hyp-type"><b>: </b><span>vtransition (IM j) lj (s1 j, iom) = (s&#39; j, oom)</span></span></span><br><span><var>Heq_s'</var><span class="hyp-type"><b>: </b><span>s&#39; = state_update IM s1 j (s&#39; j)</span></span></span><br><span><var>n</var><span class="hyp-type"><b>: </b><span>i ‚â† j</span></span></span><br><span><var>Hvi</var><span class="hyp-type"><b>: </b><span>vvalid (IM i) li (s i, om)</span></span></span><br><span><var>Hti</var><span class="hyp-type"><b>: </b><span>vtransition (IM i) li (s i, om) = (s&#39; i, om&#39;)</span></span></span><br><span><var>Heqs'</var><span class="hyp-type"><b>: </b><span>state_update IM s1 j (s&#39; j) =
state_update IM s i (s1 i)</span></span></span><br><span><var>IHHs2</var><span class="hyp-type"><b>: </b><span>input_valid_transition RFree 
  (existT j lj)
  (state_update IM s j (s1 j), iom) 
  (s, oom)</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">(state_update IM (state_update IM s j (s1 j)) i (s&#39; i),
om&#39;) = (s1, om&#39;)</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">        </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="Composition-v-chk2be" style="display: none" type="checkbox"><label class="alectryon-input" for="Composition-v-chk2be"><span class="nb">f_equal</span>; extensionality k; <span class="nb">apply</span> <span class="nb">f_equal</span> <span class="kr">with</span> (f := <span class="kr">fun</span> <span class="nv">s</span> =&gt; s k) <span class="kr">in</span> Heqs&#39;.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>message, index</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>EqDecision0</var><span class="hyp-type"><b>: </b><span>EqDecision index</span></span></span><br><span><var>IM</var><span class="hyp-type"><b>: </b><span>index ‚Üí VLSM message</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span><span class="kr">‚àÄ</span> <span class="nv">i</span> : index, HistoryVLSM (IM i)</span></span></span><br><span><var>Free</var><span><span class="hyp-body"><b>:= </b><span>free_composite_vlsm IM</span></span><span class="hyp-type"><b>: </b><span>VLSM message</span></span></span></span><br><span><var>RFree</var><span><span class="hyp-body"><b>:= </b><span>pre_loaded_with_all_messages_vlsm Free</span></span><span class="hyp-type"><b>: </b><span>VLSM message</span></span></span></span><br><span><var>s'</var><span class="hyp-type"><b>: </b><span>state</span></span></span><br><span><var>i</var><span class="hyp-type"><b>: </b><span>index</span></span></span><br><span><var>li</var><span class="hyp-type"><b>: </b><span>vlabel (IM i)</span></span></span><br><span><var>om, om'</var><span class="hyp-type"><b>: </b><span>option message</span></span></span><br><span><var>s</var><span class="hyp-type"><b>: </b><span>state</span></span></span><br><span><var>Ht</var><span class="hyp-type"><b>: </b><span>input_valid_transition RFree 
  (existT i li) (s, om) 
  (s&#39;, om&#39;)</span></span></span><br><span><var>j</var><span class="hyp-type"><b>: </b><span>index</span></span></span><br><span><var>lj</var><span class="hyp-type"><b>: </b><span>vlabel (IM j)</span></span></span><br><span><var>s1</var><span class="hyp-type"><b>: </b><span>composite_state IM</span></span></span><br><span><var>iom, oom</var><span class="hyp-type"><b>: </b><span>option message</span></span></span><br><span><var>Hvj</var><span class="hyp-type"><b>: </b><span>vvalid (IM j) lj (s1 j, iom)</span></span></span><br><span><var>Htj</var><span class="hyp-type"><b>: </b><span>vtransition (IM j) lj (s1 j, iom) = (s&#39; j, oom)</span></span></span><br><span><var>Heq_s'</var><span class="hyp-type"><b>: </b><span>s&#39; = state_update IM s1 j (s&#39; j)</span></span></span><br><span><var>n</var><span class="hyp-type"><b>: </b><span>i ‚â† j</span></span></span><br><span><var>Hvi</var><span class="hyp-type"><b>: </b><span>vvalid (IM i) li (s i, om)</span></span></span><br><span><var>Hti</var><span class="hyp-type"><b>: </b><span>vtransition (IM i) li (s i, om) = (s&#39; i, om&#39;)</span></span></span><br><span><var>k</var><span class="hyp-type"><b>: </b><span>index</span></span></span><br><span><var>Heqs'</var><span class="hyp-type"><b>: </b><span>state_update IM s1 j (s&#39; j) k =
state_update IM s i (s1 i) k</span></span></span><br><span><var>IHHs2</var><span class="hyp-type"><b>: </b><span>input_valid_transition RFree 
  (existT j lj)
  (state_update IM s j (s1 j), iom) 
  (s, oom)</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">state_update IM (state_update IM s j (s1 j)) i (s&#39; i)
  k = s1 k</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">        </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="Composition-v-chk2bf" style="display: none" type="checkbox"><label class="alectryon-input" for="Composition-v-chk2bf"><span class="nb">rewrite</span> Heq_s&#39;.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>message, index</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>EqDecision0</var><span class="hyp-type"><b>: </b><span>EqDecision index</span></span></span><br><span><var>IM</var><span class="hyp-type"><b>: </b><span>index ‚Üí VLSM message</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span><span class="kr">‚àÄ</span> <span class="nv">i</span> : index, HistoryVLSM (IM i)</span></span></span><br><span><var>Free</var><span><span class="hyp-body"><b>:= </b><span>free_composite_vlsm IM</span></span><span class="hyp-type"><b>: </b><span>VLSM message</span></span></span></span><br><span><var>RFree</var><span><span class="hyp-body"><b>:= </b><span>pre_loaded_with_all_messages_vlsm Free</span></span><span class="hyp-type"><b>: </b><span>VLSM message</span></span></span></span><br><span><var>s'</var><span class="hyp-type"><b>: </b><span>state</span></span></span><br><span><var>i</var><span class="hyp-type"><b>: </b><span>index</span></span></span><br><span><var>li</var><span class="hyp-type"><b>: </b><span>vlabel (IM i)</span></span></span><br><span><var>om, om'</var><span class="hyp-type"><b>: </b><span>option message</span></span></span><br><span><var>s</var><span class="hyp-type"><b>: </b><span>state</span></span></span><br><span><var>Ht</var><span class="hyp-type"><b>: </b><span>input_valid_transition RFree 
  (existT i li) (s, om) 
  (s&#39;, om&#39;)</span></span></span><br><span><var>j</var><span class="hyp-type"><b>: </b><span>index</span></span></span><br><span><var>lj</var><span class="hyp-type"><b>: </b><span>vlabel (IM j)</span></span></span><br><span><var>s1</var><span class="hyp-type"><b>: </b><span>composite_state IM</span></span></span><br><span><var>iom, oom</var><span class="hyp-type"><b>: </b><span>option message</span></span></span><br><span><var>Hvj</var><span class="hyp-type"><b>: </b><span>vvalid (IM j) lj (s1 j, iom)</span></span></span><br><span><var>Htj</var><span class="hyp-type"><b>: </b><span>vtransition (IM j) lj (s1 j, iom) = (s&#39; j, oom)</span></span></span><br><span><var>Heq_s'</var><span class="hyp-type"><b>: </b><span>s&#39; = state_update IM s1 j (s&#39; j)</span></span></span><br><span><var>n</var><span class="hyp-type"><b>: </b><span>i ‚â† j</span></span></span><br><span><var>Hvi</var><span class="hyp-type"><b>: </b><span>vvalid (IM i) li (s i, om)</span></span></span><br><span><var>Hti</var><span class="hyp-type"><b>: </b><span>vtransition (IM i) li (s i, om) = (s&#39; i, om&#39;)</span></span></span><br><span><var>k</var><span class="hyp-type"><b>: </b><span>index</span></span></span><br><span><var>Heqs'</var><span class="hyp-type"><b>: </b><span>state_update IM s1 j (s&#39; j) k =
state_update IM s i (s1 i) k</span></span></span><br><span><var>IHHs2</var><span class="hyp-type"><b>: </b><span>input_valid_transition RFree 
  (existT j lj)
  (state_update IM s j (s1 j), iom) 
  (s, oom)</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">state_update IM (state_update IM s j (s1 j)) i
  (state_update IM s1 j (s&#39; j) i) k = s1 k</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">        </span><span class="alectryon-sentence"><span class="alectryon-input"><span class="bp">by</span> <span class="nb">destruct</span> (decide (i = k)), (decide (j = k)); <span class="nb">subst</span>; state_update_simpl.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">      </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="Composition-v-chk2c0" style="display: none" type="checkbox"><label class="alectryon-input" for="Composition-v-chk2c0">}</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>message, index</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>EqDecision0</var><span class="hyp-type"><b>: </b><span>EqDecision index</span></span></span><br><span><var>IM</var><span class="hyp-type"><b>: </b><span>index ‚Üí VLSM message</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span><span class="kr">‚àÄ</span> <span class="nv">i</span> : index, HistoryVLSM (IM i)</span></span></span><br><span><var>Free</var><span><span class="hyp-body"><b>:= </b><span>free_composite_vlsm IM</span></span><span class="hyp-type"><b>: </b><span>VLSM message</span></span></span></span><br><span><var>RFree</var><span><span class="hyp-body"><b>:= </b><span>pre_loaded_with_all_messages_vlsm Free</span></span><span class="hyp-type"><b>: </b><span>VLSM message</span></span></span></span><br><span><var>s'</var><span class="hyp-type"><b>: </b><span>state</span></span></span><br><span><var>i</var><span class="hyp-type"><b>: </b><span>index</span></span></span><br><span><var>li</var><span class="hyp-type"><b>: </b><span>vlabel (IM i)</span></span></span><br><span><var>om, om'</var><span class="hyp-type"><b>: </b><span>option message</span></span></span><br><span><var>s</var><span class="hyp-type"><b>: </b><span>state</span></span></span><br><span><var>Ht</var><span class="hyp-type"><b>: </b><span>input_valid_transition RFree 
  (existT i li) (s, om) 
  (s&#39;, om&#39;)</span></span></span><br><span><var>j</var><span class="hyp-type"><b>: </b><span>index</span></span></span><br><span><var>lj</var><span class="hyp-type"><b>: </b><span>vlabel (IM j)</span></span></span><br><span><var>s1</var><span class="hyp-type"><b>: </b><span>composite_state IM</span></span></span><br><span><var>iom, oom</var><span class="hyp-type"><b>: </b><span>option message</span></span></span><br><span><var>Hvj</var><span class="hyp-type"><b>: </b><span>vvalid (IM j) lj (s1 j, iom)</span></span></span><br><span><var>Htj</var><span class="hyp-type"><b>: </b><span>vtransition (IM j) lj (s1 j, iom) = (s&#39; j, oom)</span></span></span><br><span><var>Heq_s'</var><span class="hyp-type"><b>: </b><span>s&#39; = state_update IM s1 j (s&#39; j)</span></span></span><br><span><var>n</var><span class="hyp-type"><b>: </b><span>i ‚â† j</span></span></span><br><span><var>Hvi</var><span class="hyp-type"><b>: </b><span>vvalid (IM i) li (s i, om)</span></span></span><br><span><var>Hti</var><span class="hyp-type"><b>: </b><span>vtransition (IM i) li (s i, om) = (s&#39; i, om&#39;)</span></span></span><br><span><var>Heqs'</var><span class="hyp-type"><b>: </b><span>state_update IM s1 j (s&#39; j) =
state_update IM s i (s1 i)</span></span></span><br><span><var>IHHs2</var><span class="hyp-type"><b>: </b><span>input_valid_transition RFree 
  (existT j lj)
  (state_update IM s j (s1 j), iom) 
  (s, oom)</span></span></span><br><span><var>Hss1</var><span class="hyp-type"><b>: </b><span>input_valid_transition RFree 
  (existT i li)
  (state_update IM s j (s1 j), om) 
  (s1, om&#39;)</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">input_valid_transition RFree (existT j lj) (s1, iom)
  (s&#39;, oom)</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">      </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="Composition-v-chk2c1" style="display: none" type="checkbox"><label class="alectryon-input" for="Composition-v-chk2c1"><span class="kp">repeat</span> <span class="nb">split</span>; <span class="nb">cbn</span>.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>message, index</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>EqDecision0</var><span class="hyp-type"><b>: </b><span>EqDecision index</span></span></span><br><span><var>IM</var><span class="hyp-type"><b>: </b><span>index ‚Üí VLSM message</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span><span class="kr">‚àÄ</span> <span class="nv">i</span> : index, HistoryVLSM (IM i)</span></span></span><br><span><var>Free</var><span><span class="hyp-body"><b>:= </b><span>free_composite_vlsm IM</span></span><span class="hyp-type"><b>: </b><span>VLSM message</span></span></span></span><br><span><var>RFree</var><span><span class="hyp-body"><b>:= </b><span>pre_loaded_with_all_messages_vlsm Free</span></span><span class="hyp-type"><b>: </b><span>VLSM message</span></span></span></span><br><span><var>s'</var><span class="hyp-type"><b>: </b><span>state</span></span></span><br><span><var>i</var><span class="hyp-type"><b>: </b><span>index</span></span></span><br><span><var>li</var><span class="hyp-type"><b>: </b><span>vlabel (IM i)</span></span></span><br><span><var>om, om'</var><span class="hyp-type"><b>: </b><span>option message</span></span></span><br><span><var>s</var><span class="hyp-type"><b>: </b><span>state</span></span></span><br><span><var>Ht</var><span class="hyp-type"><b>: </b><span>input_valid_transition RFree 
  (existT i li) (s, om) 
  (s&#39;, om&#39;)</span></span></span><br><span><var>j</var><span class="hyp-type"><b>: </b><span>index</span></span></span><br><span><var>lj</var><span class="hyp-type"><b>: </b><span>vlabel (IM j)</span></span></span><br><span><var>s1</var><span class="hyp-type"><b>: </b><span>composite_state IM</span></span></span><br><span><var>iom, oom</var><span class="hyp-type"><b>: </b><span>option message</span></span></span><br><span><var>Hvj</var><span class="hyp-type"><b>: </b><span>vvalid (IM j) lj (s1 j, iom)</span></span></span><br><span><var>Htj</var><span class="hyp-type"><b>: </b><span>vtransition (IM j) lj (s1 j, iom) = (s&#39; j, oom)</span></span></span><br><span><var>Heq_s'</var><span class="hyp-type"><b>: </b><span>s&#39; = state_update IM s1 j (s&#39; j)</span></span></span><br><span><var>n</var><span class="hyp-type"><b>: </b><span>i ‚â† j</span></span></span><br><span><var>Hvi</var><span class="hyp-type"><b>: </b><span>vvalid (IM i) li (s i, om)</span></span></span><br><span><var>Hti</var><span class="hyp-type"><b>: </b><span>vtransition (IM i) li (s i, om) = (s&#39; i, om&#39;)</span></span></span><br><span><var>Heqs'</var><span class="hyp-type"><b>: </b><span>state_update IM s1 j (s&#39; j) =
state_update IM s i (s1 i)</span></span></span><br><span><var>IHHs2</var><span class="hyp-type"><b>: </b><span>input_valid_transition RFree 
  (existT j lj)
  (state_update IM s j (s1 j), iom) 
  (s, oom)</span></span></span><br><span><var>Hss1</var><span class="hyp-type"><b>: </b><span>input_valid_transition RFree 
  (existT i li)
  (state_update IM s j (s1 j), om) 
  (s1, om&#39;)</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">valid_state_prop RFree s1</div></blockquote><div class="alectryon-extra-goals"><input class="alectryon-extra-goal-toggle" id="Composition-v-chk2c2" style="display: none" type="checkbox"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>message, index</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>EqDecision0</var><span class="hyp-type"><b>: </b><span>EqDecision index</span></span></span><br><span><var>IM</var><span class="hyp-type"><b>: </b><span>index ‚Üí VLSM message</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span><span class="kr">‚àÄ</span> <span class="nv">i</span> : index, HistoryVLSM (IM i)</span></span></span><br><span><var>Free</var><span><span class="hyp-body"><b>:= </b><span>free_composite_vlsm IM</span></span><span class="hyp-type"><b>: </b><span>VLSM message</span></span></span></span><br><span><var>RFree</var><span><span class="hyp-body"><b>:= </b><span>pre_loaded_with_all_messages_vlsm Free</span></span><span class="hyp-type"><b>: </b><span>VLSM message</span></span></span></span><br><span><var>s'</var><span class="hyp-type"><b>: </b><span>state</span></span></span><br><span><var>i</var><span class="hyp-type"><b>: </b><span>index</span></span></span><br><span><var>li</var><span class="hyp-type"><b>: </b><span>vlabel (IM i)</span></span></span><br><span><var>om, om'</var><span class="hyp-type"><b>: </b><span>option message</span></span></span><br><span><var>s</var><span class="hyp-type"><b>: </b><span>state</span></span></span><br><span><var>Ht</var><span class="hyp-type"><b>: </b><span>input_valid_transition RFree 
  (existT i li) (s, om) 
  (s&#39;, om&#39;)</span></span></span><br><span><var>j</var><span class="hyp-type"><b>: </b><span>index</span></span></span><br><span><var>lj</var><span class="hyp-type"><b>: </b><span>vlabel (IM j)</span></span></span><br><span><var>s1</var><span class="hyp-type"><b>: </b><span>composite_state IM</span></span></span><br><span><var>iom, oom</var><span class="hyp-type"><b>: </b><span>option message</span></span></span><br><span><var>Hvj</var><span class="hyp-type"><b>: </b><span>vvalid (IM j) lj (s1 j, iom)</span></span></span><br><span><var>Htj</var><span class="hyp-type"><b>: </b><span>vtransition (IM j) lj (s1 j, iom) = (s&#39; j, oom)</span></span></span><br><span><var>Heq_s'</var><span class="hyp-type"><b>: </b><span>s&#39; = state_update IM s1 j (s&#39; j)</span></span></span><br><span><var>n</var><span class="hyp-type"><b>: </b><span>i ‚â† j</span></span></span><br><span><var>Hvi</var><span class="hyp-type"><b>: </b><span>vvalid (IM i) li (s i, om)</span></span></span><br><span><var>Hti</var><span class="hyp-type"><b>: </b><span>vtransition (IM i) li (s i, om) = (s&#39; i, om&#39;)</span></span></span><br><span><var>Heqs'</var><span class="hyp-type"><b>: </b><span>state_update IM s1 j (s&#39; j) =
state_update IM s i (s1 i)</span></span></span><br><span><var>IHHs2</var><span class="hyp-type"><b>: </b><span>input_valid_transition RFree 
  (existT j lj)
  (state_update IM s j (s1 j), iom) 
  (s, oom)</span></span></span><br><span><var>Hss1</var><span class="hyp-type"><b>: </b><span>input_valid_transition RFree 
  (existT i li)
  (state_update IM s j (s1 j), om) 
  (s1, om&#39;)</span></span></span><br></div><label class="goal-separator" for="Composition-v-chk2c2"><hr></label><div class="goal-conclusion">option_valid_message_prop RFree iom</div></blockquote><input class="alectryon-extra-goal-toggle" id="Composition-v-chk2c3" style="display: none" type="checkbox"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>message, index</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>EqDecision0</var><span class="hyp-type"><b>: </b><span>EqDecision index</span></span></span><br><span><var>IM</var><span class="hyp-type"><b>: </b><span>index ‚Üí VLSM message</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span><span class="kr">‚àÄ</span> <span class="nv">i</span> : index, HistoryVLSM (IM i)</span></span></span><br><span><var>Free</var><span><span class="hyp-body"><b>:= </b><span>free_composite_vlsm IM</span></span><span class="hyp-type"><b>: </b><span>VLSM message</span></span></span></span><br><span><var>RFree</var><span><span class="hyp-body"><b>:= </b><span>pre_loaded_with_all_messages_vlsm Free</span></span><span class="hyp-type"><b>: </b><span>VLSM message</span></span></span></span><br><span><var>s'</var><span class="hyp-type"><b>: </b><span>state</span></span></span><br><span><var>i</var><span class="hyp-type"><b>: </b><span>index</span></span></span><br><span><var>li</var><span class="hyp-type"><b>: </b><span>vlabel (IM i)</span></span></span><br><span><var>om, om'</var><span class="hyp-type"><b>: </b><span>option message</span></span></span><br><span><var>s</var><span class="hyp-type"><b>: </b><span>state</span></span></span><br><span><var>Ht</var><span class="hyp-type"><b>: </b><span>input_valid_transition RFree 
  (existT i li) (s, om) 
  (s&#39;, om&#39;)</span></span></span><br><span><var>j</var><span class="hyp-type"><b>: </b><span>index</span></span></span><br><span><var>lj</var><span class="hyp-type"><b>: </b><span>vlabel (IM j)</span></span></span><br><span><var>s1</var><span class="hyp-type"><b>: </b><span>composite_state IM</span></span></span><br><span><var>iom, oom</var><span class="hyp-type"><b>: </b><span>option message</span></span></span><br><span><var>Hvj</var><span class="hyp-type"><b>: </b><span>vvalid (IM j) lj (s1 j, iom)</span></span></span><br><span><var>Htj</var><span class="hyp-type"><b>: </b><span>vtransition (IM j) lj (s1 j, iom) = (s&#39; j, oom)</span></span></span><br><span><var>Heq_s'</var><span class="hyp-type"><b>: </b><span>s&#39; = state_update IM s1 j (s&#39; j)</span></span></span><br><span><var>n</var><span class="hyp-type"><b>: </b><span>i ‚â† j</span></span></span><br><span><var>Hvi</var><span class="hyp-type"><b>: </b><span>vvalid (IM i) li (s i, om)</span></span></span><br><span><var>Hti</var><span class="hyp-type"><b>: </b><span>vtransition (IM i) li (s i, om) = (s&#39; i, om&#39;)</span></span></span><br><span><var>Heqs'</var><span class="hyp-type"><b>: </b><span>state_update IM s1 j (s&#39; j) =
state_update IM s i (s1 i)</span></span></span><br><span><var>IHHs2</var><span class="hyp-type"><b>: </b><span>input_valid_transition RFree 
  (existT j lj)
  (state_update IM s j (s1 j), iom) 
  (s, oom)</span></span></span><br><span><var>Hss1</var><span class="hyp-type"><b>: </b><span>input_valid_transition RFree 
  (existT i li)
  (state_update IM s j (s1 j), om) 
  (s1, om&#39;)</span></span></span><br></div><label class="goal-separator" for="Composition-v-chk2c3"><hr></label><div class="goal-conclusion">vvalid (IM j) lj (s1 j, iom)</div></blockquote><input class="alectryon-extra-goal-toggle" id="Composition-v-chk2c4" style="display: none" type="checkbox"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>message, index</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>EqDecision0</var><span class="hyp-type"><b>: </b><span>EqDecision index</span></span></span><br><span><var>IM</var><span class="hyp-type"><b>: </b><span>index ‚Üí VLSM message</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span><span class="kr">‚àÄ</span> <span class="nv">i</span> : index, HistoryVLSM (IM i)</span></span></span><br><span><var>Free</var><span><span class="hyp-body"><b>:= </b><span>free_composite_vlsm IM</span></span><span class="hyp-type"><b>: </b><span>VLSM message</span></span></span></span><br><span><var>RFree</var><span><span class="hyp-body"><b>:= </b><span>pre_loaded_with_all_messages_vlsm Free</span></span><span class="hyp-type"><b>: </b><span>VLSM message</span></span></span></span><br><span><var>s'</var><span class="hyp-type"><b>: </b><span>state</span></span></span><br><span><var>i</var><span class="hyp-type"><b>: </b><span>index</span></span></span><br><span><var>li</var><span class="hyp-type"><b>: </b><span>vlabel (IM i)</span></span></span><br><span><var>om, om'</var><span class="hyp-type"><b>: </b><span>option message</span></span></span><br><span><var>s</var><span class="hyp-type"><b>: </b><span>state</span></span></span><br><span><var>Ht</var><span class="hyp-type"><b>: </b><span>input_valid_transition RFree 
  (existT i li) (s, om) 
  (s&#39;, om&#39;)</span></span></span><br><span><var>j</var><span class="hyp-type"><b>: </b><span>index</span></span></span><br><span><var>lj</var><span class="hyp-type"><b>: </b><span>vlabel (IM j)</span></span></span><br><span><var>s1</var><span class="hyp-type"><b>: </b><span>composite_state IM</span></span></span><br><span><var>iom, oom</var><span class="hyp-type"><b>: </b><span>option message</span></span></span><br><span><var>Hvj</var><span class="hyp-type"><b>: </b><span>vvalid (IM j) lj (s1 j, iom)</span></span></span><br><span><var>Htj</var><span class="hyp-type"><b>: </b><span>vtransition (IM j) lj (s1 j, iom) = (s&#39; j, oom)</span></span></span><br><span><var>Heq_s'</var><span class="hyp-type"><b>: </b><span>s&#39; = state_update IM s1 j (s&#39; j)</span></span></span><br><span><var>n</var><span class="hyp-type"><b>: </b><span>i ‚â† j</span></span></span><br><span><var>Hvi</var><span class="hyp-type"><b>: </b><span>vvalid (IM i) li (s i, om)</span></span></span><br><span><var>Hti</var><span class="hyp-type"><b>: </b><span>vtransition (IM i) li (s i, om) = (s&#39; i, om&#39;)</span></span></span><br><span><var>Heqs'</var><span class="hyp-type"><b>: </b><span>state_update IM s1 j (s&#39; j) =
state_update IM s i (s1 i)</span></span></span><br><span><var>IHHs2</var><span class="hyp-type"><b>: </b><span>input_valid_transition RFree 
  (existT j lj)
  (state_update IM s j (s1 j), iom) 
  (s, oom)</span></span></span><br><span><var>Hss1</var><span class="hyp-type"><b>: </b><span>input_valid_transition RFree 
  (existT i li)
  (state_update IM s j (s1 j), om) 
  (s1, om&#39;)</span></span></span><br></div><label class="goal-separator" for="Composition-v-chk2c4"><hr></label><div class="goal-conclusion">(<span class="kr">let</span> (<span class="nv">si&#39;</span>, om&#39;) :=
   vtransition (IM j) lj (s1 j, iom) <span class="kr">in</span>
 (state_update IM s1 j si&#39;, om&#39;)) = 
(s&#39;, oom)</div></blockquote></div></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">      </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="Composition-v-chk2c5" style="display: none" type="checkbox"><label class="alectryon-input" for="Composition-v-chk2c5">*</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>message, index</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>EqDecision0</var><span class="hyp-type"><b>: </b><span>EqDecision index</span></span></span><br><span><var>IM</var><span class="hyp-type"><b>: </b><span>index ‚Üí VLSM message</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span><span class="kr">‚àÄ</span> <span class="nv">i</span> : index, HistoryVLSM (IM i)</span></span></span><br><span><var>Free</var><span><span class="hyp-body"><b>:= </b><span>free_composite_vlsm IM</span></span><span class="hyp-type"><b>: </b><span>VLSM message</span></span></span></span><br><span><var>RFree</var><span><span class="hyp-body"><b>:= </b><span>pre_loaded_with_all_messages_vlsm Free</span></span><span class="hyp-type"><b>: </b><span>VLSM message</span></span></span></span><br><span><var>s'</var><span class="hyp-type"><b>: </b><span>state</span></span></span><br><span><var>i</var><span class="hyp-type"><b>: </b><span>index</span></span></span><br><span><var>li</var><span class="hyp-type"><b>: </b><span>vlabel (IM i)</span></span></span><br><span><var>om, om'</var><span class="hyp-type"><b>: </b><span>option message</span></span></span><br><span><var>s</var><span class="hyp-type"><b>: </b><span>state</span></span></span><br><span><var>Ht</var><span class="hyp-type"><b>: </b><span>input_valid_transition RFree 
  (existT i li) (s, om) 
  (s&#39;, om&#39;)</span></span></span><br><span><var>j</var><span class="hyp-type"><b>: </b><span>index</span></span></span><br><span><var>lj</var><span class="hyp-type"><b>: </b><span>vlabel (IM j)</span></span></span><br><span><var>s1</var><span class="hyp-type"><b>: </b><span>composite_state IM</span></span></span><br><span><var>iom, oom</var><span class="hyp-type"><b>: </b><span>option message</span></span></span><br><span><var>Hvj</var><span class="hyp-type"><b>: </b><span>vvalid (IM j) lj (s1 j, iom)</span></span></span><br><span><var>Htj</var><span class="hyp-type"><b>: </b><span>vtransition (IM j) lj (s1 j, iom) = (s&#39; j, oom)</span></span></span><br><span><var>Heq_s'</var><span class="hyp-type"><b>: </b><span>s&#39; = state_update IM s1 j (s&#39; j)</span></span></span><br><span><var>n</var><span class="hyp-type"><b>: </b><span>i ‚â† j</span></span></span><br><span><var>Hvi</var><span class="hyp-type"><b>: </b><span>vvalid (IM i) li (s i, om)</span></span></span><br><span><var>Hti</var><span class="hyp-type"><b>: </b><span>vtransition (IM i) li (s i, om) = (s&#39; i, om&#39;)</span></span></span><br><span><var>Heqs'</var><span class="hyp-type"><b>: </b><span>state_update IM s1 j (s&#39; j) =
state_update IM s i (s1 i)</span></span></span><br><span><var>IHHs2</var><span class="hyp-type"><b>: </b><span>input_valid_transition RFree 
  (existT j lj)
  (state_update IM s j (s1 j), iom) 
  (s, oom)</span></span></span><br><span><var>Hss1</var><span class="hyp-type"><b>: </b><span>input_valid_transition RFree 
  (existT i li)
  (state_update IM s j (s1 j), om) 
  (s1, om&#39;)</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">valid_state_prop RFree s1</div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="bp">by</span> <span class="nb">eapply</span> input_valid_transition_destination.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">      </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="Composition-v-chk2c6" style="display: none" type="checkbox"><label class="alectryon-input" for="Composition-v-chk2c6">*</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>message, index</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>EqDecision0</var><span class="hyp-type"><b>: </b><span>EqDecision index</span></span></span><br><span><var>IM</var><span class="hyp-type"><b>: </b><span>index ‚Üí VLSM message</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span><span class="kr">‚àÄ</span> <span class="nv">i</span> : index, HistoryVLSM (IM i)</span></span></span><br><span><var>Free</var><span><span class="hyp-body"><b>:= </b><span>free_composite_vlsm IM</span></span><span class="hyp-type"><b>: </b><span>VLSM message</span></span></span></span><br><span><var>RFree</var><span><span class="hyp-body"><b>:= </b><span>pre_loaded_with_all_messages_vlsm Free</span></span><span class="hyp-type"><b>: </b><span>VLSM message</span></span></span></span><br><span><var>s'</var><span class="hyp-type"><b>: </b><span>state</span></span></span><br><span><var>i</var><span class="hyp-type"><b>: </b><span>index</span></span></span><br><span><var>li</var><span class="hyp-type"><b>: </b><span>vlabel (IM i)</span></span></span><br><span><var>om, om'</var><span class="hyp-type"><b>: </b><span>option message</span></span></span><br><span><var>s</var><span class="hyp-type"><b>: </b><span>state</span></span></span><br><span><var>Ht</var><span class="hyp-type"><b>: </b><span>input_valid_transition RFree 
  (existT i li) (s, om) 
  (s&#39;, om&#39;)</span></span></span><br><span><var>j</var><span class="hyp-type"><b>: </b><span>index</span></span></span><br><span><var>lj</var><span class="hyp-type"><b>: </b><span>vlabel (IM j)</span></span></span><br><span><var>s1</var><span class="hyp-type"><b>: </b><span>composite_state IM</span></span></span><br><span><var>iom, oom</var><span class="hyp-type"><b>: </b><span>option message</span></span></span><br><span><var>Hvj</var><span class="hyp-type"><b>: </b><span>vvalid (IM j) lj (s1 j, iom)</span></span></span><br><span><var>Htj</var><span class="hyp-type"><b>: </b><span>vtransition (IM j) lj (s1 j, iom) = (s&#39; j, oom)</span></span></span><br><span><var>Heq_s'</var><span class="hyp-type"><b>: </b><span>s&#39; = state_update IM s1 j (s&#39; j)</span></span></span><br><span><var>n</var><span class="hyp-type"><b>: </b><span>i ‚â† j</span></span></span><br><span><var>Hvi</var><span class="hyp-type"><b>: </b><span>vvalid (IM i) li (s i, om)</span></span></span><br><span><var>Hti</var><span class="hyp-type"><b>: </b><span>vtransition (IM i) li (s i, om) = (s&#39; i, om&#39;)</span></span></span><br><span><var>Heqs'</var><span class="hyp-type"><b>: </b><span>state_update IM s1 j (s&#39; j) =
state_update IM s i (s1 i)</span></span></span><br><span><var>IHHs2</var><span class="hyp-type"><b>: </b><span>input_valid_transition RFree 
  (existT j lj)
  (state_update IM s j (s1 j), iom) 
  (s, oom)</span></span></span><br><span><var>Hss1</var><span class="hyp-type"><b>: </b><span>input_valid_transition RFree 
  (existT i li)
  (state_update IM s j (s1 j), om) 
  (s1, om&#39;)</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">option_valid_message_prop RFree iom</div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="bp">by</span> <span class="nb">apply</span> any_message_is_valid_in_preloaded.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">      </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="Composition-v-chk2c7" style="display: none" type="checkbox"><label class="alectryon-input" for="Composition-v-chk2c7">*</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>message, index</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>EqDecision0</var><span class="hyp-type"><b>: </b><span>EqDecision index</span></span></span><br><span><var>IM</var><span class="hyp-type"><b>: </b><span>index ‚Üí VLSM message</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span><span class="kr">‚àÄ</span> <span class="nv">i</span> : index, HistoryVLSM (IM i)</span></span></span><br><span><var>Free</var><span><span class="hyp-body"><b>:= </b><span>free_composite_vlsm IM</span></span><span class="hyp-type"><b>: </b><span>VLSM message</span></span></span></span><br><span><var>RFree</var><span><span class="hyp-body"><b>:= </b><span>pre_loaded_with_all_messages_vlsm Free</span></span><span class="hyp-type"><b>: </b><span>VLSM message</span></span></span></span><br><span><var>s'</var><span class="hyp-type"><b>: </b><span>state</span></span></span><br><span><var>i</var><span class="hyp-type"><b>: </b><span>index</span></span></span><br><span><var>li</var><span class="hyp-type"><b>: </b><span>vlabel (IM i)</span></span></span><br><span><var>om, om'</var><span class="hyp-type"><b>: </b><span>option message</span></span></span><br><span><var>s</var><span class="hyp-type"><b>: </b><span>state</span></span></span><br><span><var>Ht</var><span class="hyp-type"><b>: </b><span>input_valid_transition RFree 
  (existT i li) (s, om) 
  (s&#39;, om&#39;)</span></span></span><br><span><var>j</var><span class="hyp-type"><b>: </b><span>index</span></span></span><br><span><var>lj</var><span class="hyp-type"><b>: </b><span>vlabel (IM j)</span></span></span><br><span><var>s1</var><span class="hyp-type"><b>: </b><span>composite_state IM</span></span></span><br><span><var>iom, oom</var><span class="hyp-type"><b>: </b><span>option message</span></span></span><br><span><var>Hvj</var><span class="hyp-type"><b>: </b><span>vvalid (IM j) lj (s1 j, iom)</span></span></span><br><span><var>Htj</var><span class="hyp-type"><b>: </b><span>vtransition (IM j) lj (s1 j, iom) = (s&#39; j, oom)</span></span></span><br><span><var>Heq_s'</var><span class="hyp-type"><b>: </b><span>s&#39; = state_update IM s1 j (s&#39; j)</span></span></span><br><span><var>n</var><span class="hyp-type"><b>: </b><span>i ‚â† j</span></span></span><br><span><var>Hvi</var><span class="hyp-type"><b>: </b><span>vvalid (IM i) li (s i, om)</span></span></span><br><span><var>Hti</var><span class="hyp-type"><b>: </b><span>vtransition (IM i) li (s i, om) = (s&#39; i, om&#39;)</span></span></span><br><span><var>Heqs'</var><span class="hyp-type"><b>: </b><span>state_update IM s1 j (s&#39; j) =
state_update IM s i (s1 i)</span></span></span><br><span><var>IHHs2</var><span class="hyp-type"><b>: </b><span>input_valid_transition RFree 
  (existT j lj)
  (state_update IM s j (s1 j), iom) 
  (s, oom)</span></span></span><br><span><var>Hss1</var><span class="hyp-type"><b>: </b><span>input_valid_transition RFree 
  (existT i li)
  (state_update IM s j (s1 j), om) 
  (s1, om&#39;)</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">vvalid (IM j) lj (s1 j, iom)</div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="bp">done</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">      </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="Composition-v-chk2c8" style="display: none" type="checkbox"><label class="alectryon-input" for="Composition-v-chk2c8">*</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>message, index</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>EqDecision0</var><span class="hyp-type"><b>: </b><span>EqDecision index</span></span></span><br><span><var>IM</var><span class="hyp-type"><b>: </b><span>index ‚Üí VLSM message</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span><span class="kr">‚àÄ</span> <span class="nv">i</span> : index, HistoryVLSM (IM i)</span></span></span><br><span><var>Free</var><span><span class="hyp-body"><b>:= </b><span>free_composite_vlsm IM</span></span><span class="hyp-type"><b>: </b><span>VLSM message</span></span></span></span><br><span><var>RFree</var><span><span class="hyp-body"><b>:= </b><span>pre_loaded_with_all_messages_vlsm Free</span></span><span class="hyp-type"><b>: </b><span>VLSM message</span></span></span></span><br><span><var>s'</var><span class="hyp-type"><b>: </b><span>state</span></span></span><br><span><var>i</var><span class="hyp-type"><b>: </b><span>index</span></span></span><br><span><var>li</var><span class="hyp-type"><b>: </b><span>vlabel (IM i)</span></span></span><br><span><var>om, om'</var><span class="hyp-type"><b>: </b><span>option message</span></span></span><br><span><var>s</var><span class="hyp-type"><b>: </b><span>state</span></span></span><br><span><var>Ht</var><span class="hyp-type"><b>: </b><span>input_valid_transition RFree 
  (existT i li) (s, om) 
  (s&#39;, om&#39;)</span></span></span><br><span><var>j</var><span class="hyp-type"><b>: </b><span>index</span></span></span><br><span><var>lj</var><span class="hyp-type"><b>: </b><span>vlabel (IM j)</span></span></span><br><span><var>s1</var><span class="hyp-type"><b>: </b><span>composite_state IM</span></span></span><br><span><var>iom, oom</var><span class="hyp-type"><b>: </b><span>option message</span></span></span><br><span><var>Hvj</var><span class="hyp-type"><b>: </b><span>vvalid (IM j) lj (s1 j, iom)</span></span></span><br><span><var>Htj</var><span class="hyp-type"><b>: </b><span>vtransition (IM j) lj (s1 j, iom) = (s&#39; j, oom)</span></span></span><br><span><var>Heq_s'</var><span class="hyp-type"><b>: </b><span>s&#39; = state_update IM s1 j (s&#39; j)</span></span></span><br><span><var>n</var><span class="hyp-type"><b>: </b><span>i ‚â† j</span></span></span><br><span><var>Hvi</var><span class="hyp-type"><b>: </b><span>vvalid (IM i) li (s i, om)</span></span></span><br><span><var>Hti</var><span class="hyp-type"><b>: </b><span>vtransition (IM i) li (s i, om) = (s&#39; i, om&#39;)</span></span></span><br><span><var>Heqs'</var><span class="hyp-type"><b>: </b><span>state_update IM s1 j (s&#39; j) =
state_update IM s i (s1 i)</span></span></span><br><span><var>IHHs2</var><span class="hyp-type"><b>: </b><span>input_valid_transition RFree 
  (existT j lj)
  (state_update IM s j (s1 j), iom) 
  (s, oom)</span></span></span><br><span><var>Hss1</var><span class="hyp-type"><b>: </b><span>input_valid_transition RFree 
  (existT i li)
  (state_update IM s j (s1 j), om) 
  (s1, om&#39;)</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">(<span class="kr">let</span> (<span class="nv">si&#39;</span>, om&#39;) :=
   vtransition (IM j) lj (s1 j, iom) <span class="kr">in</span>
 (state_update IM s1 j si&#39;, om&#39;)) = (s&#39;, oom)</div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="bp">by</span> <span class="nb">replace</span> (vtransition _ _ _) <span class="kr">with</span> (s&#39; j, oom); <span class="nb">f_equal</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Qed</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
</span><span class="alectryon-sentence"><input class="alectryon-toggle" id="Composition-v-chk2c9" style="display: none" type="checkbox"><label class="alectryon-input" for="Composition-v-chk2c9"><span class="kn">Lemma</span> <span class="nf">CompositeValidTransitionNext_reflects_rechability</span> :
  <span class="kr">forall</span> <span class="nv">s1</span> <span class="nv">s2</span>, CompositeValidTransitionNext IM s1 s2 -&gt;
    valid_state_prop RFree s2 -&gt; valid_state_prop RFree s1.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>message, index</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>EqDecision0</var><span class="hyp-type"><b>: </b><span>EqDecision index</span></span></span><br><span><var>IM</var><span class="hyp-type"><b>: </b><span>index ‚Üí VLSM message</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span><span class="kr">‚àÄ</span> <span class="nv">i</span> : index, HistoryVLSM (IM i)</span></span></span><br><span><var>Free</var><span><span class="hyp-body"><b>:= </b><span>free_composite_vlsm IM</span></span><span class="hyp-type"><b>: </b><span>VLSM message</span></span></span></span><br><span><var>RFree</var><span><span class="hyp-body"><b>:= </b><span>pre_loaded_with_all_messages_vlsm Free</span></span><span class="hyp-type"><b>: </b><span>VLSM message</span></span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="kr">‚àÄ</span> <span class="nv">s1</span> <span class="nv">s2</span> : composite_state IM,
  CompositeValidTransitionNext IM s1 s2
  ‚Üí valid_state_prop RFree s2
    ‚Üí valid_state_prop RFree s1</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="Composition-v-chk2ca" style="display: none" type="checkbox"><label class="alectryon-input" for="Composition-v-chk2ca"><span class="kn">Proof</span>.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>message, index</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>EqDecision0</var><span class="hyp-type"><b>: </b><span>EqDecision index</span></span></span><br><span><var>IM</var><span class="hyp-type"><b>: </b><span>index ‚Üí VLSM message</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span><span class="kr">‚àÄ</span> <span class="nv">i</span> : index, HistoryVLSM (IM i)</span></span></span><br><span><var>Free</var><span><span class="hyp-body"><b>:= </b><span>free_composite_vlsm IM</span></span><span class="hyp-type"><b>: </b><span>VLSM message</span></span></span></span><br><span><var>RFree</var><span><span class="hyp-body"><b>:= </b><span>pre_loaded_with_all_messages_vlsm Free</span></span><span class="hyp-type"><b>: </b><span>VLSM message</span></span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="kr">‚àÄ</span> <span class="nv">s1</span> <span class="nv">s2</span> : composite_state IM,
  CompositeValidTransitionNext IM s1 s2
  ‚Üí valid_state_prop RFree s2
    ‚Üí valid_state_prop RFree s1</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><span class="alectryon-input"><span class="bp">by</span> <span class="nb">intros</span> s1 s2 []; <span class="nb">eapply</span> CompositeValidTransition_reflects_rechability.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Qed</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
</span><span class="alectryon-sentence"><input class="alectryon-toggle" id="Composition-v-chk2cb" style="display: none" type="checkbox"><label class="alectryon-input" for="Composition-v-chk2cb"><span class="kn">Lemma</span> <span class="nf">composite_valid_transition_future_reflects_rechability</span> :
  <span class="kr">forall</span> <span class="nv">s1</span> <span class="nv">s2</span>, composite_valid_transition_future IM s1 s2 -&gt;
    valid_state_prop RFree s2 -&gt; valid_state_prop RFree s1.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>message, index</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>EqDecision0</var><span class="hyp-type"><b>: </b><span>EqDecision index</span></span></span><br><span><var>IM</var><span class="hyp-type"><b>: </b><span>index ‚Üí VLSM message</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span><span class="kr">‚àÄ</span> <span class="nv">i</span> : index, HistoryVLSM (IM i)</span></span></span><br><span><var>Free</var><span><span class="hyp-body"><b>:= </b><span>free_composite_vlsm IM</span></span><span class="hyp-type"><b>: </b><span>VLSM message</span></span></span></span><br><span><var>RFree</var><span><span class="hyp-body"><b>:= </b><span>pre_loaded_with_all_messages_vlsm Free</span></span><span class="hyp-type"><b>: </b><span>VLSM message</span></span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="kr">‚àÄ</span> <span class="nv">s1</span> <span class="nv">s2</span> : composite_state IM,
  composite_valid_transition_future IM s1 s2
  ‚Üí valid_state_prop RFree s2
    ‚Üí valid_state_prop RFree s1</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="Composition-v-chk2cc" style="display: none" type="checkbox"><label class="alectryon-input" for="Composition-v-chk2cc"><span class="kn">Proof</span>.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>message, index</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>EqDecision0</var><span class="hyp-type"><b>: </b><span>EqDecision index</span></span></span><br><span><var>IM</var><span class="hyp-type"><b>: </b><span>index ‚Üí VLSM message</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span><span class="kr">‚àÄ</span> <span class="nv">i</span> : index, HistoryVLSM (IM i)</span></span></span><br><span><var>Free</var><span><span class="hyp-body"><b>:= </b><span>free_composite_vlsm IM</span></span><span class="hyp-type"><b>: </b><span>VLSM message</span></span></span></span><br><span><var>RFree</var><span><span class="hyp-body"><b>:= </b><span>pre_loaded_with_all_messages_vlsm Free</span></span><span class="hyp-type"><b>: </b><span>VLSM message</span></span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="kr">‚àÄ</span> <span class="nv">s1</span> <span class="nv">s2</span> : composite_state IM,
  composite_valid_transition_future IM s1 s2
  ‚Üí valid_state_prop RFree s2
    ‚Üí valid_state_prop RFree s1</div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="bp">by</span> <span class="nb">apply</span> tc_reflect, CompositeValidTransitionNext_reflects_rechability.</span><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Qed</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
</span><span class="alectryon-sentence"><input class="alectryon-toggle" id="Composition-v-chk2cd" style="display: none" type="checkbox"><label class="alectryon-input" for="Composition-v-chk2cd"><span class="kn">Lemma</span> <span class="nf">composite_valid_transitions_from_to_reflects_reachability</span> :
  <span class="kr">forall</span> <span class="nv">s</span> <span class="nv">s&#39;</span> <span class="nv">tr</span>,
  CompositeValidTransitionsFromTo IM s s&#39; tr -&gt;
  valid_state_prop RFree s&#39; -&gt; finite_valid_trace_from_to RFree s s&#39; tr.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>message, index</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>EqDecision0</var><span class="hyp-type"><b>: </b><span>EqDecision index</span></span></span><br><span><var>IM</var><span class="hyp-type"><b>: </b><span>index ‚Üí VLSM message</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span><span class="kr">‚àÄ</span> <span class="nv">i</span> : index, HistoryVLSM (IM i)</span></span></span><br><span><var>Free</var><span><span class="hyp-body"><b>:= </b><span>free_composite_vlsm IM</span></span><span class="hyp-type"><b>: </b><span>VLSM message</span></span></span></span><br><span><var>RFree</var><span><span class="hyp-body"><b>:= </b><span>pre_loaded_with_all_messages_vlsm Free</span></span><span class="hyp-type"><b>: </b><span>VLSM message</span></span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="kr">‚àÄ</span> (<span class="nv">s</span> <span class="nv">s&#39;</span> : composite_state IM) (<span class="nv">tr</span> : list
                                      (composite_transition_item
                                         IM)),
  CompositeValidTransitionsFromTo IM s s&#39; tr
  ‚Üí valid_state_prop RFree s&#39;
    ‚Üí finite_valid_trace_from_to RFree s s&#39; tr</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="Composition-v-chk2ce" style="display: none" type="checkbox"><label class="alectryon-input" for="Composition-v-chk2ce"><span class="kn">Proof</span>.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>message, index</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>EqDecision0</var><span class="hyp-type"><b>: </b><span>EqDecision index</span></span></span><br><span><var>IM</var><span class="hyp-type"><b>: </b><span>index ‚Üí VLSM message</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span><span class="kr">‚àÄ</span> <span class="nv">i</span> : index, HistoryVLSM (IM i)</span></span></span><br><span><var>Free</var><span><span class="hyp-body"><b>:= </b><span>free_composite_vlsm IM</span></span><span class="hyp-type"><b>: </b><span>VLSM message</span></span></span></span><br><span><var>RFree</var><span><span class="hyp-body"><b>:= </b><span>pre_loaded_with_all_messages_vlsm Free</span></span><span class="hyp-type"><b>: </b><span>VLSM message</span></span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="kr">‚àÄ</span> (<span class="nv">s</span> <span class="nv">s&#39;</span> : composite_state IM) (<span class="nv">tr</span> : list
                                      (composite_transition_item
                                         IM)),
  CompositeValidTransitionsFromTo IM s s&#39; tr
  ‚Üí valid_state_prop RFree s&#39;
    ‚Üí finite_valid_trace_from_to RFree s s&#39; tr</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="Composition-v-chk2cf" style="display: none" type="checkbox"><label class="alectryon-input" for="Composition-v-chk2cf"><span class="nb">induction</span> <span class="mi">1</span>; <span class="nb">intros</span>; [<span class="bp">by</span> <span class="nb">constructor</span> |].</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>message, index</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>EqDecision0</var><span class="hyp-type"><b>: </b><span>EqDecision index</span></span></span><br><span><var>IM</var><span class="hyp-type"><b>: </b><span>index ‚Üí VLSM message</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span><span class="kr">‚àÄ</span> <span class="nv">i</span> : index, HistoryVLSM (IM i)</span></span></span><br><span><var>Free</var><span><span class="hyp-body"><b>:= </b><span>free_composite_vlsm IM</span></span><span class="hyp-type"><b>: </b><span>VLSM message</span></span></span></span><br><span><var>RFree</var><span><span class="hyp-body"><b>:= </b><span>pre_loaded_with_all_messages_vlsm Free</span></span><span class="hyp-type"><b>: </b><span>VLSM message</span></span></span></span><br><span><var>s, s'</var><span class="hyp-type"><b>: </b><span>composite_state IM</span></span></span><br><span><var>tr</var><span class="hyp-type"><b>: </b><span>list (composite_transition_item IM)</span></span></span><br><span><var>item</var><span class="hyp-type"><b>: </b><span>composite_transition_item IM</span></span></span><br><span><var>H0</var><span class="hyp-type"><b>: </b><span>CompositeValidTransitionsFromTo IM s s&#39; tr</span></span></span><br><span><var>H1</var><span class="hyp-type"><b>: </b><span>composite_valid_transition_item IM s&#39; item</span></span></span><br><span><var>IHCompositeValidTransitionsFromTo</var><span class="hyp-type"><b>: </b><span>valid_state_prop
  RFree s&#39;
‚Üí finite_valid_trace_from_to
    RFree s s&#39; tr</span></span></span><br><span><var>H2</var><span class="hyp-type"><b>: </b><span>valid_state_prop RFree (destination item)</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">finite_valid_trace_from_to RFree s (destination item)
  (tr ++ [item])</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="Composition-v-chk2d0" style="display: none" type="checkbox"><label class="alectryon-input" for="Composition-v-chk2d0"><span class="nb">assert</span> (Hitem : input_valid_transition RFree (l item) (s&#39;, input item)
                          (destination item, output item))
    <span class="bp">by</span> (<span class="nb">apply</span> CompositeValidTransition_reflects_rechability; <span class="bp">done</span>).</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>message, index</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>EqDecision0</var><span class="hyp-type"><b>: </b><span>EqDecision index</span></span></span><br><span><var>IM</var><span class="hyp-type"><b>: </b><span>index ‚Üí VLSM message</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span><span class="kr">‚àÄ</span> <span class="nv">i</span> : index, HistoryVLSM (IM i)</span></span></span><br><span><var>Free</var><span><span class="hyp-body"><b>:= </b><span>free_composite_vlsm IM</span></span><span class="hyp-type"><b>: </b><span>VLSM message</span></span></span></span><br><span><var>RFree</var><span><span class="hyp-body"><b>:= </b><span>pre_loaded_with_all_messages_vlsm Free</span></span><span class="hyp-type"><b>: </b><span>VLSM message</span></span></span></span><br><span><var>s, s'</var><span class="hyp-type"><b>: </b><span>composite_state IM</span></span></span><br><span><var>tr</var><span class="hyp-type"><b>: </b><span>list (composite_transition_item IM)</span></span></span><br><span><var>item</var><span class="hyp-type"><b>: </b><span>composite_transition_item IM</span></span></span><br><span><var>H0</var><span class="hyp-type"><b>: </b><span>CompositeValidTransitionsFromTo IM s s&#39; tr</span></span></span><br><span><var>H1</var><span class="hyp-type"><b>: </b><span>composite_valid_transition_item IM s&#39; item</span></span></span><br><span><var>IHCompositeValidTransitionsFromTo</var><span class="hyp-type"><b>: </b><span>valid_state_prop
  RFree s&#39;
‚Üí finite_valid_trace_from_to
    RFree s s&#39; tr</span></span></span><br><span><var>H2</var><span class="hyp-type"><b>: </b><span>valid_state_prop RFree (destination item)</span></span></span><br><span><var>Hitem</var><span class="hyp-type"><b>: </b><span>input_valid_transition RFree 
  (l item) 
  (s&#39;, input item)
  (destination item, output item)</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">finite_valid_trace_from_to RFree s (destination item)
  (tr ++ [item])</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="Composition-v-chk2d1" style="display: none" type="checkbox"><label class="alectryon-input" for="Composition-v-chk2d1"><span class="nb">eapply</span> finite_valid_trace_from_to_app.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>message, index</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>EqDecision0</var><span class="hyp-type"><b>: </b><span>EqDecision index</span></span></span><br><span><var>IM</var><span class="hyp-type"><b>: </b><span>index ‚Üí VLSM message</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span><span class="kr">‚àÄ</span> <span class="nv">i</span> : index, HistoryVLSM (IM i)</span></span></span><br><span><var>Free</var><span><span class="hyp-body"><b>:= </b><span>free_composite_vlsm IM</span></span><span class="hyp-type"><b>: </b><span>VLSM message</span></span></span></span><br><span><var>RFree</var><span><span class="hyp-body"><b>:= </b><span>pre_loaded_with_all_messages_vlsm Free</span></span><span class="hyp-type"><b>: </b><span>VLSM message</span></span></span></span><br><span><var>s, s'</var><span class="hyp-type"><b>: </b><span>composite_state IM</span></span></span><br><span><var>tr</var><span class="hyp-type"><b>: </b><span>list (composite_transition_item IM)</span></span></span><br><span><var>item</var><span class="hyp-type"><b>: </b><span>composite_transition_item IM</span></span></span><br><span><var>H0</var><span class="hyp-type"><b>: </b><span>CompositeValidTransitionsFromTo IM s s&#39; tr</span></span></span><br><span><var>H1</var><span class="hyp-type"><b>: </b><span>composite_valid_transition_item IM s&#39; item</span></span></span><br><span><var>IHCompositeValidTransitionsFromTo</var><span class="hyp-type"><b>: </b><span>valid_state_prop
  RFree s&#39;
‚Üí finite_valid_trace_from_to
    RFree s s&#39; tr</span></span></span><br><span><var>H2</var><span class="hyp-type"><b>: </b><span>valid_state_prop RFree (destination item)</span></span></span><br><span><var>Hitem</var><span class="hyp-type"><b>: </b><span>input_valid_transition RFree 
  (l item) 
  (s&#39;, input item)
  (destination item, output item)</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">finite_valid_trace_from_to RFree s <span class="nl">?m</span> tr</div></blockquote><div class="alectryon-extra-goals"><input class="alectryon-extra-goal-toggle" id="Composition-v-chk2d2" style="display: none" type="checkbox"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>message, index</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>EqDecision0</var><span class="hyp-type"><b>: </b><span>EqDecision index</span></span></span><br><span><var>IM</var><span class="hyp-type"><b>: </b><span>index ‚Üí VLSM message</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span><span class="kr">‚àÄ</span> <span class="nv">i</span> : index, HistoryVLSM (IM i)</span></span></span><br><span><var>Free</var><span><span class="hyp-body"><b>:= </b><span>free_composite_vlsm IM</span></span><span class="hyp-type"><b>: </b><span>VLSM message</span></span></span></span><br><span><var>RFree</var><span><span class="hyp-body"><b>:= </b><span>pre_loaded_with_all_messages_vlsm Free</span></span><span class="hyp-type"><b>: </b><span>VLSM message</span></span></span></span><br><span><var>s, s'</var><span class="hyp-type"><b>: </b><span>composite_state IM</span></span></span><br><span><var>tr</var><span class="hyp-type"><b>: </b><span>list (composite_transition_item IM)</span></span></span><br><span><var>item</var><span class="hyp-type"><b>: </b><span>composite_transition_item IM</span></span></span><br><span><var>H0</var><span class="hyp-type"><b>: </b><span>CompositeValidTransitionsFromTo IM s s&#39; tr</span></span></span><br><span><var>H1</var><span class="hyp-type"><b>: </b><span>composite_valid_transition_item IM s&#39; item</span></span></span><br><span><var>IHCompositeValidTransitionsFromTo</var><span class="hyp-type"><b>: </b><span>valid_state_prop
  RFree s&#39;
‚Üí finite_valid_trace_from_to
    RFree s s&#39; tr</span></span></span><br><span><var>H2</var><span class="hyp-type"><b>: </b><span>valid_state_prop RFree (destination item)</span></span></span><br><span><var>Hitem</var><span class="hyp-type"><b>: </b><span>input_valid_transition RFree 
  (l item) 
  (s&#39;, input item)
  (destination item, output item)</span></span></span><br></div><label class="goal-separator" for="Composition-v-chk2d2"><hr></label><div class="goal-conclusion">finite_valid_trace_from_to RFree 
  <span class="nl">?m</span> (destination item) [item]</div></blockquote></div></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="Composition-v-chk2d3" style="display: none" type="checkbox"><label class="alectryon-input" for="Composition-v-chk2d3">-</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>message, index</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>EqDecision0</var><span class="hyp-type"><b>: </b><span>EqDecision index</span></span></span><br><span><var>IM</var><span class="hyp-type"><b>: </b><span>index ‚Üí VLSM message</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span><span class="kr">‚àÄ</span> <span class="nv">i</span> : index, HistoryVLSM (IM i)</span></span></span><br><span><var>Free</var><span><span class="hyp-body"><b>:= </b><span>free_composite_vlsm IM</span></span><span class="hyp-type"><b>: </b><span>VLSM message</span></span></span></span><br><span><var>RFree</var><span><span class="hyp-body"><b>:= </b><span>pre_loaded_with_all_messages_vlsm Free</span></span><span class="hyp-type"><b>: </b><span>VLSM message</span></span></span></span><br><span><var>s, s'</var><span class="hyp-type"><b>: </b><span>composite_state IM</span></span></span><br><span><var>tr</var><span class="hyp-type"><b>: </b><span>list (composite_transition_item IM)</span></span></span><br><span><var>item</var><span class="hyp-type"><b>: </b><span>composite_transition_item IM</span></span></span><br><span><var>H0</var><span class="hyp-type"><b>: </b><span>CompositeValidTransitionsFromTo IM s s&#39; tr</span></span></span><br><span><var>H1</var><span class="hyp-type"><b>: </b><span>composite_valid_transition_item IM s&#39; item</span></span></span><br><span><var>IHCompositeValidTransitionsFromTo</var><span class="hyp-type"><b>: </b><span>valid_state_prop
  RFree s&#39;
‚Üí finite_valid_trace_from_to
    RFree s s&#39; tr</span></span></span><br><span><var>H2</var><span class="hyp-type"><b>: </b><span>valid_state_prop RFree (destination item)</span></span></span><br><span><var>Hitem</var><span class="hyp-type"><b>: </b><span>input_valid_transition RFree 
  (l item) 
  (s&#39;, input item)
  (destination item, output item)</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">finite_valid_trace_from_to RFree s <span class="nl">?m</span> tr</div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="Composition-v-chk2d4" style="display: none" type="checkbox"><label class="alectryon-input" for="Composition-v-chk2d4"><span class="nb">apply</span> IHCompositeValidTransitionsFromTo.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>message, index</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>EqDecision0</var><span class="hyp-type"><b>: </b><span>EqDecision index</span></span></span><br><span><var>IM</var><span class="hyp-type"><b>: </b><span>index ‚Üí VLSM message</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span><span class="kr">‚àÄ</span> <span class="nv">i</span> : index, HistoryVLSM (IM i)</span></span></span><br><span><var>Free</var><span><span class="hyp-body"><b>:= </b><span>free_composite_vlsm IM</span></span><span class="hyp-type"><b>: </b><span>VLSM message</span></span></span></span><br><span><var>RFree</var><span><span class="hyp-body"><b>:= </b><span>pre_loaded_with_all_messages_vlsm Free</span></span><span class="hyp-type"><b>: </b><span>VLSM message</span></span></span></span><br><span><var>s, s'</var><span class="hyp-type"><b>: </b><span>composite_state IM</span></span></span><br><span><var>tr</var><span class="hyp-type"><b>: </b><span>list (composite_transition_item IM)</span></span></span><br><span><var>item</var><span class="hyp-type"><b>: </b><span>composite_transition_item IM</span></span></span><br><span><var>H0</var><span class="hyp-type"><b>: </b><span>CompositeValidTransitionsFromTo IM s s&#39; tr</span></span></span><br><span><var>H1</var><span class="hyp-type"><b>: </b><span>composite_valid_transition_item IM s&#39; item</span></span></span><br><span><var>IHCompositeValidTransitionsFromTo</var><span class="hyp-type"><b>: </b><span>valid_state_prop
  RFree s&#39;
‚Üí finite_valid_trace_from_to
    RFree s s&#39; tr</span></span></span><br><span><var>H2</var><span class="hyp-type"><b>: </b><span>valid_state_prop RFree (destination item)</span></span></span><br><span><var>Hitem</var><span class="hyp-type"><b>: </b><span>input_valid_transition RFree 
  (l item) 
  (s&#39;, input item)
  (destination item, output item)</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">valid_state_prop RFree s&#39;</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><span class="alectryon-input"><span class="bp">by</span> <span class="nb">eapply</span> input_valid_transition_origin.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="Composition-v-chk2d5" style="display: none" type="checkbox"><label class="alectryon-input" for="Composition-v-chk2d5">-</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>message, index</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>EqDecision0</var><span class="hyp-type"><b>: </b><span>EqDecision index</span></span></span><br><span><var>IM</var><span class="hyp-type"><b>: </b><span>index ‚Üí VLSM message</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span><span class="kr">‚àÄ</span> <span class="nv">i</span> : index, HistoryVLSM (IM i)</span></span></span><br><span><var>Free</var><span><span class="hyp-body"><b>:= </b><span>free_composite_vlsm IM</span></span><span class="hyp-type"><b>: </b><span>VLSM message</span></span></span></span><br><span><var>RFree</var><span><span class="hyp-body"><b>:= </b><span>pre_loaded_with_all_messages_vlsm Free</span></span><span class="hyp-type"><b>: </b><span>VLSM message</span></span></span></span><br><span><var>s, s'</var><span class="hyp-type"><b>: </b><span>composite_state IM</span></span></span><br><span><var>tr</var><span class="hyp-type"><b>: </b><span>list (composite_transition_item IM)</span></span></span><br><span><var>item</var><span class="hyp-type"><b>: </b><span>composite_transition_item IM</span></span></span><br><span><var>H0</var><span class="hyp-type"><b>: </b><span>CompositeValidTransitionsFromTo IM s s&#39; tr</span></span></span><br><span><var>H1</var><span class="hyp-type"><b>: </b><span>composite_valid_transition_item IM s&#39; item</span></span></span><br><span><var>IHCompositeValidTransitionsFromTo</var><span class="hyp-type"><b>: </b><span>valid_state_prop
  RFree s&#39;
‚Üí finite_valid_trace_from_to
    RFree s s&#39; tr</span></span></span><br><span><var>H2</var><span class="hyp-type"><b>: </b><span>valid_state_prop RFree (destination item)</span></span></span><br><span><var>Hitem</var><span class="hyp-type"><b>: </b><span>input_valid_transition RFree 
  (l item) 
  (s&#39;, input item)
  (destination item, output item)</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">finite_valid_trace_from_to RFree s&#39; (destination item)
  [item]</div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="bp">by</span> <span class="nb">destruct</span> item; <span class="nb">apply</span> finite_valid_trace_from_to_singleton.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Qed</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
</span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">End</span> <span class="nf">sec_composite_history_vlsm</span>.</span></span></pre></article></body></html>