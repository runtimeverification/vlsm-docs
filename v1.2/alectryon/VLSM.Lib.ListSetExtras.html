<!DOCTYPE html>
<html class="alectryon-standalone"><head><title>ListSetExtras.v</title><meta charset="utf-8"><meta content="Alectryon" name="generator"><meta name="viewport" content="width=device-width, initial-scale=1"><link href="alectryon.css" rel="stylesheet"><link href="pygments.css" rel="stylesheet">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/IBM-type/0.5.4/css/ibm-type.min.css" integrity="sha512-sky5cf9Ts6FY1kstGOBHSybfKqdHR41M0Ldb0BjNiv3ifltoQIsg0zIaQ+wwdwgQ0w9vKFW7Js50lxH9vqNSSw==" crossorigin="anonymous" />
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/firacode/5.2.0/fira_code.min.css" integrity="sha512-MbysAYimH1hH2xYzkkMHB6MqxBqfP0megxsCLknbYqHVwXTCg9IqHbk+ZP/vnhO8UEW6PaXAkKe2vQ+SWACxxA==" crossorigin="anonymous" /><script src="alectryon.js"></script></head><body><article class="alectryon-root alectryon-windowed alectryon-coqdoc"><div class="alectryon-banner">Built with <a href="https://github.com/cpitclaudel/alectryon/">Alectryon</a>, running Coq+SerAPI v8.15.0+0.15.2. Bubbles (<span class="alectryon-bubble"></span>) indicate interactive fragments: hover for details, tap to reveal contents. Use <kbd>Ctrl+↑</kbd> <kbd>Ctrl+↓</kbd> to navigate, <kbd>Ctrl+🖱️</kbd> to focus. On Mac, use <kbd>⌘</kbd> instead of <kbd>Ctrl</kbd>.</div><pre class="alectryon-io highlight"><!-- Generator: Alectryon --><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">From</span> Cdcl <span class="kn">Require Import</span> Itauto.</span><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><span class="alectryon-input">#[local] <span class="kn">Tactic Notation</span> <span class="s2">&quot;itauto&quot;</span> := itauto <span class="nb">auto</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">From</span> stdpp <span class="kn">Require Import</span> prelude.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">From</span> VLSM.Lib <span class="kn">Require Import</span> Preamble ListExtras StdppExtras StdppListSet.</span></span></pre><div class="doc">
<a id="lab1"></a><h1 class="section">List set utility definitions and lemmas</h1>
</div><pre class="alectryon-io highlight"><!-- Generator: Alectryon --><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Definition</span> <span class="nf">set_eq</span> {<span class="nv">A</span>} (<span class="nv">s1</span> <span class="nv">s2</span> : <span class="nb">set</span> A) : <span class="kt">Prop</span> :=
  s1 ⊆ s2 /\ s2 ⊆ s1.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
</span><span class="alectryon-sentence"><input class="alectryon-toggle" id="ListSetExtras-v-chk0" style="display: none" type="checkbox"><label class="alectryon-input" for="ListSetExtras-v-chk0">#[export] <span class="kn">Instance</span> <span class="nf">set_eq_dec</span> `{EqDecision A} : RelDecision (@set_eq A).</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>A</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>EqDecision0</var><span class="hyp-type"><b>: </b><span>EqDecision A</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">RelDecision set_eq</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="ListSetExtras-v-chk1" style="display: none" type="checkbox"><label class="alectryon-input" for="ListSetExtras-v-chk1"><span class="kn">Proof</span>.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>A</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>EqDecision0</var><span class="hyp-type"><b>: </b><span>EqDecision A</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">RelDecision set_eq</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><span class="alectryon-input"><span class="bp">by</span> <span class="nb">intros</span> s1 s2; <span class="nb">typeclasses eauto</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Qed</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
</span><span class="alectryon-sentence"><input class="alectryon-toggle" id="ListSetExtras-v-chk2" style="display: none" type="checkbox"><label class="alectryon-input" for="ListSetExtras-v-chk2"><span class="kn">Lemma</span> <span class="nf">set_eq_extract_forall</span>
  {<span class="nv">A</span> : <span class="kt">Type</span>}
  (<span class="nv">l1</span> <span class="nv">l2</span> : <span class="nb">set</span> A)
  : set_eq l1 l2 &lt;-&gt; <span class="kr">forall</span> <span class="nv">a</span>, (a ∈ l1 &lt;-&gt; a ∈ l2).</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>A</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>l1, l2</var><span class="hyp-type"><b>: </b><span><span class="nb">set</span> A</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">set_eq l1 l2 ↔ (<span class="kr">∀</span> <span class="nv">a</span> : A, a ∈ l1 ↔ a ∈ l2)</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="ListSetExtras-v-chk3" style="display: none" type="checkbox"><label class="alectryon-input" for="ListSetExtras-v-chk3"><span class="kn">Proof</span>.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>A</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>l1, l2</var><span class="hyp-type"><b>: </b><span><span class="nb">set</span> A</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">set_eq l1 l2 ↔ (<span class="kr">∀</span> <span class="nv">a</span> : A, a ∈ l1 ↔ a ∈ l2)</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="ListSetExtras-v-chk4" style="display: none" type="checkbox"><label class="alectryon-input" for="ListSetExtras-v-chk4"><span class="nb">unfold</span> set_eq.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>A</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>l1, l2</var><span class="hyp-type"><b>: </b><span><span class="nb">set</span> A</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">l1 ⊆ l2 ⊆ l1 ↔ (<span class="kr">∀</span> <span class="nv">a</span> : A, a ∈ l1 ↔ a ∈ l2)</div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="nb">firstorder</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Qed</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
</span><span class="alectryon-sentence"><input class="alectryon-toggle" id="ListSetExtras-v-chk5" style="display: none" type="checkbox"><label class="alectryon-input" for="ListSetExtras-v-chk5"><span class="kn">Lemma</span> <span class="nf">set_eq_fin_set</span> `{FinSet A Cm} (s1 s2 : Cm) :
  s1 ≡ s2 &lt;-&gt; set_eq (elements s1) (elements s2).</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>A, Cm</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>ElemOf A Cm</span></span></span><br><span><var>H0</var><span class="hyp-type"><b>: </b><span>Empty Cm</span></span></span><br><span><var>H1</var><span class="hyp-type"><b>: </b><span>Singleton A Cm</span></span></span><br><span><var>H2</var><span class="hyp-type"><b>: </b><span>Union Cm</span></span></span><br><span><var>H3</var><span class="hyp-type"><b>: </b><span>Intersection Cm</span></span></span><br><span><var>H4</var><span class="hyp-type"><b>: </b><span>Difference Cm</span></span></span><br><span><var>H5</var><span class="hyp-type"><b>: </b><span>Elements A Cm</span></span></span><br><span><var>EqDecision0</var><span class="hyp-type"><b>: </b><span>EqDecision A</span></span></span><br><span><var>H6</var><span class="hyp-type"><b>: </b><span>FinSet A Cm</span></span></span><br><span><var>s1, s2</var><span class="hyp-type"><b>: </b><span>Cm</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">s1 ≡ s2 ↔ set_eq (elements s1) (elements s2)</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="ListSetExtras-v-chk6" style="display: none" type="checkbox"><label class="alectryon-input" for="ListSetExtras-v-chk6"><span class="kn">Proof</span>.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>A, Cm</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>ElemOf A Cm</span></span></span><br><span><var>H0</var><span class="hyp-type"><b>: </b><span>Empty Cm</span></span></span><br><span><var>H1</var><span class="hyp-type"><b>: </b><span>Singleton A Cm</span></span></span><br><span><var>H2</var><span class="hyp-type"><b>: </b><span>Union Cm</span></span></span><br><span><var>H3</var><span class="hyp-type"><b>: </b><span>Intersection Cm</span></span></span><br><span><var>H4</var><span class="hyp-type"><b>: </b><span>Difference Cm</span></span></span><br><span><var>H5</var><span class="hyp-type"><b>: </b><span>Elements A Cm</span></span></span><br><span><var>EqDecision0</var><span class="hyp-type"><b>: </b><span>EqDecision A</span></span></span><br><span><var>H6</var><span class="hyp-type"><b>: </b><span>FinSet A Cm</span></span></span><br><span><var>s1, s2</var><span class="hyp-type"><b>: </b><span>Cm</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">s1 ≡ s2 ↔ set_eq (elements s1) (elements s2)</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="ListSetExtras-v-chk7" style="display: none" type="checkbox"><label class="alectryon-input" for="ListSetExtras-v-chk7"><span class="nb">rewrite</span> set_eq_extract_forall, set_equiv.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>A, Cm</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>ElemOf A Cm</span></span></span><br><span><var>H0</var><span class="hyp-type"><b>: </b><span>Empty Cm</span></span></span><br><span><var>H1</var><span class="hyp-type"><b>: </b><span>Singleton A Cm</span></span></span><br><span><var>H2</var><span class="hyp-type"><b>: </b><span>Union Cm</span></span></span><br><span><var>H3</var><span class="hyp-type"><b>: </b><span>Intersection Cm</span></span></span><br><span><var>H4</var><span class="hyp-type"><b>: </b><span>Difference Cm</span></span></span><br><span><var>H5</var><span class="hyp-type"><b>: </b><span>Elements A Cm</span></span></span><br><span><var>EqDecision0</var><span class="hyp-type"><b>: </b><span>EqDecision A</span></span></span><br><span><var>H6</var><span class="hyp-type"><b>: </b><span>FinSet A Cm</span></span></span><br><span><var>s1, s2</var><span class="hyp-type"><b>: </b><span>Cm</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">(<span class="kr">∀</span> <span class="nv">x</span> : A, x ∈ s1 ↔ x ∈ s2)
↔ (<span class="kr">∀</span> <span class="nv">a</span> : A, a ∈ elements s1 ↔ a ∈ elements s2)</div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="bp">by</span> <span class="nb">setoid_rewrite</span> elem_of_elements.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Qed</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
</span><span class="alectryon-sentence"><input class="alectryon-toggle" id="ListSetExtras-v-chk8" style="display: none" type="checkbox"><label class="alectryon-input" for="ListSetExtras-v-chk8"><span class="kn">Lemma</span> <span class="nf">set_eq_proj1</span> {<span class="nv">A</span>} : <span class="kr">forall</span> (<span class="nv">s1</span> <span class="nv">s2</span> : <span class="nb">set</span> A),
  set_eq s1 s2 -&gt;
  s1 ⊆ s2.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>A</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="kr">∀</span> <span class="nv">s1</span> <span class="nv">s2</span> : <span class="nb">set</span> A, set_eq s1 s2 → s1 ⊆ s2</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="ListSetExtras-v-chk9" style="display: none" type="checkbox"><label class="alectryon-input" for="ListSetExtras-v-chk9"><span class="kn">Proof</span>.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>A</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="kr">∀</span> <span class="nv">s1</span> <span class="nv">s2</span> : <span class="nb">set</span> A, set_eq s1 s2 → s1 ⊆ s2</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><span class="alectryon-input"><span class="bp">by</span> <span class="nb">intros</span> s1 s2 [].</span><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Qed</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
</span><span class="alectryon-sentence"><input class="alectryon-toggle" id="ListSetExtras-v-chka" style="display: none" type="checkbox"><label class="alectryon-input" for="ListSetExtras-v-chka"><span class="kn">Lemma</span> <span class="nf">set_eq_proj2</span> {<span class="nv">A</span>} : <span class="kr">forall</span> (<span class="nv">s1</span> <span class="nv">s2</span> : <span class="nb">set</span> A),
  set_eq s1 s2 -&gt;
  s2 ⊆ s1.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>A</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="kr">∀</span> <span class="nv">s1</span> <span class="nv">s2</span> : <span class="nb">set</span> A, set_eq s1 s2 → s2 ⊆ s1</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="ListSetExtras-v-chkb" style="display: none" type="checkbox"><label class="alectryon-input" for="ListSetExtras-v-chkb"><span class="kn">Proof</span>.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>A</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="kr">∀</span> <span class="nv">s1</span> <span class="nv">s2</span> : <span class="nb">set</span> A, set_eq s1 s2 → s2 ⊆ s1</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><span class="alectryon-input"><span class="bp">by</span> <span class="nb">intros</span> s1 s2 [].</span><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Qed</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
</span><span class="alectryon-sentence"><input class="alectryon-toggle" id="ListSetExtras-v-chkc" style="display: none" type="checkbox"><label class="alectryon-input" for="ListSetExtras-v-chkc"><span class="kn">Lemma</span> <span class="nf">set_eq_refl</span> {<span class="nv">A</span>} : <span class="kr">forall</span> (<span class="nv">s</span> : list A), set_eq s s.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>A</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="kr">∀</span> <span class="nv">s</span> : list A, set_eq s s</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="ListSetExtras-v-chkd" style="display: none" type="checkbox"><label class="alectryon-input" for="ListSetExtras-v-chkd"><span class="kn">Proof</span>.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>A</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="kr">∀</span> <span class="nv">s</span> : list A, set_eq s s</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><span class="alectryon-input"><span class="bp">by</span> <span class="nb">induction</span> s.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Qed</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
</span><span class="alectryon-sentence"><input class="alectryon-toggle" id="ListSetExtras-v-chke" style="display: none" type="checkbox"><label class="alectryon-input" for="ListSetExtras-v-chke"><span class="kn">Lemma</span> <span class="nf">set_eq_comm</span> {<span class="nv">A</span>} : <span class="kr">forall</span> <span class="nv">s1</span> <span class="nv">s2</span> : <span class="nb">set</span> A,
  set_eq s1 s2 &lt;-&gt; set_eq s2 s1.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>A</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="kr">∀</span> <span class="nv">s1</span> <span class="nv">s2</span> : <span class="nb">set</span> A, set_eq s1 s2 ↔ set_eq s2 s1</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="ListSetExtras-v-chkf" style="display: none" type="checkbox"><label class="alectryon-input" for="ListSetExtras-v-chkf"><span class="kn">Proof</span>.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>A</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="kr">∀</span> <span class="nv">s1</span> <span class="nv">s2</span> : <span class="nb">set</span> A, set_eq s1 s2 ↔ set_eq s2 s1</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><span class="alectryon-input"><span class="nb">firstorder</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Qed</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
</span><span class="alectryon-sentence"><input class="alectryon-toggle" id="ListSetExtras-v-chk10" style="display: none" type="checkbox"><label class="alectryon-input" for="ListSetExtras-v-chk10"><span class="kn">Lemma</span> <span class="nf">set_eq_tran</span> {<span class="nv">A</span>} : <span class="kr">forall</span> <span class="nv">s1</span> <span class="nv">s2</span> <span class="nv">s3</span> : <span class="nb">set</span> A,
  set_eq s1 s2 -&gt;
  set_eq s2 s3 -&gt;
  set_eq s1 s3.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>A</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="kr">∀</span> <span class="nv">s1</span> <span class="nv">s2</span> <span class="nv">s3</span> : <span class="nb">set</span> A,
  set_eq s1 s2 → set_eq s2 s3 → set_eq s1 s3</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="ListSetExtras-v-chk11" style="display: none" type="checkbox"><label class="alectryon-input" for="ListSetExtras-v-chk11"><span class="kn">Proof</span>.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>A</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="kr">∀</span> <span class="nv">s1</span> <span class="nv">s2</span> <span class="nv">s3</span> : <span class="nb">set</span> A,
  set_eq s1 s2 → set_eq s2 s3 → set_eq s1 s3</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="ListSetExtras-v-chk12" style="display: none" type="checkbox"><label class="alectryon-input" for="ListSetExtras-v-chk12"><span class="nb">intros</span>.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>A</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>s1, s2, s3</var><span class="hyp-type"><b>: </b><span><span class="nb">set</span> A</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>set_eq s1 s2</span></span></span><br><span><var>H0</var><span class="hyp-type"><b>: </b><span>set_eq s2 s3</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">set_eq s1 s3</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><span class="alectryon-input"><span class="nb">split</span>; <span class="nb">apply</span> PreOrder_Transitive <span class="kr">with</span> s2; <span class="nb">apply</span> H || <span class="nb">apply</span> H0.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Qed</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
</span><span class="alectryon-sentence"><input class="alectryon-toggle" id="ListSetExtras-v-chk13" style="display: none" type="checkbox"><label class="alectryon-input" for="ListSetExtras-v-chk13"><span class="kn">Lemma</span> <span class="nf">set_eq_empty_iff</span>
  {<span class="nv">A</span>}
  : <span class="kr">forall</span> (<span class="nv">l</span> : list A),
    set_eq l [] &lt;-&gt; l = [].</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>A</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="kr">∀</span> <span class="nv">l</span> : list A, set_eq l [] ↔ l = []</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="ListSetExtras-v-chk14" style="display: none" type="checkbox"><label class="alectryon-input" for="ListSetExtras-v-chk14"><span class="kn">Proof</span>.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>A</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="kr">∀</span> <span class="nv">l</span> : list A, set_eq l [] ↔ l = []</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="ListSetExtras-v-chk15" style="display: none" type="checkbox"><label class="alectryon-input" for="ListSetExtras-v-chk15"><span class="nb">split</span>; <span class="nb">intros</span>; [|<span class="nb">subst</span>; <span class="nb">apply</span> set_eq_refl].</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>A</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>l</var><span class="hyp-type"><b>: </b><span>list A</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>set_eq l []</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">l = []</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="ListSetExtras-v-chk16" style="display: none" type="checkbox"><label class="alectryon-input" for="ListSetExtras-v-chk16"><span class="nb">destruct</span> l <span class="kr">as</span> [| hd tl]; [<span class="bp">done</span> |].</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>A</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>hd</var><span class="hyp-type"><b>: </b><span>A</span></span></span><br><span><var>tl</var><span class="hyp-type"><b>: </b><span>list A</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>set_eq (hd :: tl) []</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">hd :: tl = []</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="ListSetExtras-v-chk17" style="display: none" type="checkbox"><label class="alectryon-input" for="ListSetExtras-v-chk17"><span class="nb">destruct</span> H.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>A</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>hd</var><span class="hyp-type"><b>: </b><span>A</span></span></span><br><span><var>tl</var><span class="hyp-type"><b>: </b><span>list A</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>hd :: tl ⊆ []</span></span></span><br><span><var>H0</var><span class="hyp-type"><b>: </b><span>[] ⊆ hd :: tl</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">hd :: tl = []</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="ListSetExtras-v-chk18" style="display: none" type="checkbox"><label class="alectryon-input" for="ListSetExtras-v-chk18">spec H hd (elem_of_list_here hd tl).</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>A</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>hd</var><span class="hyp-type"><b>: </b><span>A</span></span></span><br><span><var>tl</var><span class="hyp-type"><b>: </b><span>list A</span></span></span><br><span><var>H0</var><span class="hyp-type"><b>: </b><span>[] ⊆ hd :: tl</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>hd ∈ []</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">hd :: tl = []</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><span class="alectryon-input"><span class="bp">by</span> <span class="nb">inversion</span> H.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Qed</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
</span><span class="alectryon-sentence"><input class="alectryon-toggle" id="ListSetExtras-v-chk19" style="display: none" type="checkbox"><label class="alectryon-input" for="ListSetExtras-v-chk19"><span class="kn">Lemma</span> <span class="nf">set_eq_cons</span> {<span class="nv">A</span>} : <span class="kr">forall</span> (<span class="nv">a</span> : A) (<span class="nv">s1</span> <span class="nv">s2</span> : <span class="nb">set</span> A),
  set_eq s1 s2 -&gt;
  set_eq (a :: s1) (a :: s2).</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>A</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="kr">∀</span> (<span class="nv">a</span> : A) (<span class="nv">s1</span> <span class="nv">s2</span> : <span class="nb">set</span> A),
  set_eq s1 s2 → set_eq (a :: s1) (a :: s2)</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="ListSetExtras-v-chk1a" style="display: none" type="checkbox"><label class="alectryon-input" for="ListSetExtras-v-chk1a"><span class="kn">Proof</span>.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>A</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="kr">∀</span> (<span class="nv">a</span> : A) (<span class="nv">s1</span> <span class="nv">s2</span> : <span class="nb">set</span> A),
  set_eq s1 s2 → set_eq (a :: s1) (a :: s2)</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="ListSetExtras-v-chk1b" style="display: none" type="checkbox"><label class="alectryon-input" for="ListSetExtras-v-chk1b"><span class="nb">intros</span> a s1 s2 Heq.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>A</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>a</var><span class="hyp-type"><b>: </b><span>A</span></span></span><br><span><var>s1, s2</var><span class="hyp-type"><b>: </b><span><span class="nb">set</span> A</span></span></span><br><span><var>Heq</var><span class="hyp-type"><b>: </b><span>set_eq s1 s2</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">set_eq (a :: s1) (a :: s2)</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="ListSetExtras-v-chk1c" style="display: none" type="checkbox"><label class="alectryon-input" for="ListSetExtras-v-chk1c"><span class="nb">rewrite</span> !set_eq_extract_forall <span class="kr">in</span> *.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>A</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>a</var><span class="hyp-type"><b>: </b><span>A</span></span></span><br><span><var>s1, s2</var><span class="hyp-type"><b>: </b><span><span class="nb">set</span> A</span></span></span><br><span><var>Heq</var><span class="hyp-type"><b>: </b><span><span class="kr">∀</span> <span class="nv">a</span> : A, a ∈ s1 ↔ a ∈ s2</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="kr">∀</span> <span class="nv">a0</span> : A, a0 ∈ a :: s1 ↔ a0 ∈ a :: s2</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="ListSetExtras-v-chk1d" style="display: none" type="checkbox"><label class="alectryon-input" for="ListSetExtras-v-chk1d"><span class="nb">setoid_rewrite</span> elem_of_cons.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>A</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>a</var><span class="hyp-type"><b>: </b><span>A</span></span></span><br><span><var>s1, s2</var><span class="hyp-type"><b>: </b><span><span class="nb">set</span> A</span></span></span><br><span><var>Heq</var><span class="hyp-type"><b>: </b><span><span class="kr">∀</span> <span class="nv">a</span> : A, a ∈ s1 ↔ a ∈ s2</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="kr">∀</span> <span class="nv">a0</span> : A, a0 = a ∨ a0 ∈ s1 ↔ a0 = a ∨ a0 ∈ s2</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><span class="alectryon-input"><span class="nb">firstorder</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Qed</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
</span><span class="alectryon-sentence"><input class="alectryon-toggle" id="ListSetExtras-v-chk1e" style="display: none" type="checkbox"><label class="alectryon-input" for="ListSetExtras-v-chk1e"><span class="kn">Lemma</span> <span class="nf">set_eq_Forall</span>
  {<span class="nv">A</span> : <span class="kt">Type</span>}
  (<span class="nv">s1</span> <span class="nv">s2</span> : <span class="nb">set</span> A)
  (<span class="nv">H12</span> : set_eq s1 s2)
  (<span class="nv">P</span> : A -&gt; <span class="kt">Prop</span>)
  : Forall P s1 &lt;-&gt; Forall P s2.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>A</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>s1, s2</var><span class="hyp-type"><b>: </b><span><span class="nb">set</span> A</span></span></span><br><span><var>H12</var><span class="hyp-type"><b>: </b><span>set_eq s1 s2</span></span></span><br><span><var>P</var><span class="hyp-type"><b>: </b><span>A → <span class="kt">Prop</span></span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">Forall P s1 ↔ Forall P s2</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="ListSetExtras-v-chk1f" style="display: none" type="checkbox"><label class="alectryon-input" for="ListSetExtras-v-chk1f"><span class="kn">Proof</span>.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>A</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>s1, s2</var><span class="hyp-type"><b>: </b><span><span class="nb">set</span> A</span></span></span><br><span><var>H12</var><span class="hyp-type"><b>: </b><span>set_eq s1 s2</span></span></span><br><span><var>P</var><span class="hyp-type"><b>: </b><span>A → <span class="kt">Prop</span></span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">Forall P s1 ↔ Forall P s2</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="ListSetExtras-v-chk20" style="display: none" type="checkbox"><label class="alectryon-input" for="ListSetExtras-v-chk20"><span class="nb">rewrite</span> !Forall_forall.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>A</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>s1, s2</var><span class="hyp-type"><b>: </b><span><span class="nb">set</span> A</span></span></span><br><span><var>H12</var><span class="hyp-type"><b>: </b><span>set_eq s1 s2</span></span></span><br><span><var>P</var><span class="hyp-type"><b>: </b><span>A → <span class="kt">Prop</span></span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">(<span class="kr">∀</span> <span class="nv">x</span> : A, x ∈ s1 → P x) ↔ (<span class="kr">∀</span> <span class="nv">x</span> : A, x ∈ s2 → P x)</div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="nb">firstorder</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Qed</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
</span><span class="alectryon-sentence"><input class="alectryon-toggle" id="ListSetExtras-v-chk21" style="display: none" type="checkbox"><label class="alectryon-input" for="ListSetExtras-v-chk21"><span class="kn">Lemma</span> <span class="nf">set_union_comm</span> `{EqDecision A}  : <span class="kr">forall</span> (<span class="nv">s1</span> <span class="nv">s2</span> : list A),
  set_eq (set_union s1 s2) (set_union s2 s1).</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>A</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>EqDecision0</var><span class="hyp-type"><b>: </b><span>EqDecision A</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="kr">∀</span> <span class="nv">s1</span> <span class="nv">s2</span> : list A,
  set_eq (set_union s1 s2) (set_union s2 s1)</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="ListSetExtras-v-chk22" style="display: none" type="checkbox"><label class="alectryon-input" for="ListSetExtras-v-chk22"><span class="kn">Proof</span>.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>A</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>EqDecision0</var><span class="hyp-type"><b>: </b><span>EqDecision A</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="kr">∀</span> <span class="nv">s1</span> <span class="nv">s2</span> : list A,
  set_eq (set_union s1 s2) (set_union s2 s1)</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><span class="alectryon-input"><span class="nb">intros</span> s1 s2; <span class="nb">split</span>; <span class="nb">intro</span> x; <span class="nb">rewrite</span> !set_union_iff; itauto.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Qed</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
</span><span class="alectryon-sentence"><input class="alectryon-toggle" id="ListSetExtras-v-chk23" style="display: none" type="checkbox"><label class="alectryon-input" for="ListSetExtras-v-chk23"><span class="kn">Lemma</span> <span class="nf">set_union_empty</span> `{EqDecision A}  : <span class="kr">forall</span> (<span class="nv">s1</span> <span class="nv">s2</span> : list A),
  set_union s1 s2 = [] -&gt;
  s1 = [] /\ s2 = [].</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>A</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>EqDecision0</var><span class="hyp-type"><b>: </b><span>EqDecision A</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="kr">∀</span> <span class="nv">s1</span> <span class="nv">s2</span> : list A,
  set_union s1 s2 = [] → s1 = [] ∧ s2 = []</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="ListSetExtras-v-chk24" style="display: none" type="checkbox"><label class="alectryon-input" for="ListSetExtras-v-chk24"><span class="kn">Proof</span>.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>A</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>EqDecision0</var><span class="hyp-type"><b>: </b><span>EqDecision A</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="kr">∀</span> <span class="nv">s1</span> <span class="nv">s2</span> : list A,
  set_union s1 s2 = [] → s1 = [] ∧ s2 = []</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="ListSetExtras-v-chk25" style="display: none" type="checkbox"><label class="alectryon-input" for="ListSetExtras-v-chk25"><span class="nb">intros</span>.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>A</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>EqDecision0</var><span class="hyp-type"><b>: </b><span>EqDecision A</span></span></span><br><span><var>s1, s2</var><span class="hyp-type"><b>: </b><span>list A</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>set_union s1 s2 = []</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">s1 = [] ∧ s2 = []</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="ListSetExtras-v-chk26" style="display: none" type="checkbox"><label class="alectryon-input" for="ListSetExtras-v-chk26"><span class="nb">destruct</span> s2; [<span class="bp">done</span> |].</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>A</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>EqDecision0</var><span class="hyp-type"><b>: </b><span>EqDecision A</span></span></span><br><span><var>s1</var><span class="hyp-type"><b>: </b><span>list A</span></span></span><br><span><var>a</var><span class="hyp-type"><b>: </b><span>A</span></span></span><br><span><var>s2</var><span class="hyp-type"><b>: </b><span>list A</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>set_union s1 (a :: s2) = []</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">s1 = [] ∧ a :: s2 = []</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><span class="alectryon-input"><span class="bp">by</span> <span class="nb">cbn</span> <span class="kr">in</span> H; <span class="nb">apply</span> set_add_not_empty <span class="kr">in</span> H.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Qed</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
</span><span class="alectryon-sentence"><input class="alectryon-toggle" id="ListSetExtras-v-chk27" style="display: none" type="checkbox"><label class="alectryon-input" for="ListSetExtras-v-chk27"><span class="kn">Lemma</span> <span class="nf">set_union_nodup_left</span> `{EqDecision A} (l l&#39; : <span class="nb">set</span> A)
  : NoDup l -&gt; NoDup (set_union l l&#39;).</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>A</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>EqDecision0</var><span class="hyp-type"><b>: </b><span>EqDecision A</span></span></span><br><span><var>l, l'</var><span class="hyp-type"><b>: </b><span><span class="nb">set</span> A</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">NoDup l → NoDup (set_union l l&#39;)</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="ListSetExtras-v-chk28" style="display: none" type="checkbox"><label class="alectryon-input" for="ListSetExtras-v-chk28"><span class="kn">Proof</span>.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>A</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>EqDecision0</var><span class="hyp-type"><b>: </b><span>EqDecision A</span></span></span><br><span><var>l, l'</var><span class="hyp-type"><b>: </b><span><span class="nb">set</span> A</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">NoDup l → NoDup (set_union l l&#39;)</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="ListSetExtras-v-chk29" style="display: none" type="checkbox"><label class="alectryon-input" for="ListSetExtras-v-chk29"><span class="nb">intro</span> Hl.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>A</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>EqDecision0</var><span class="hyp-type"><b>: </b><span>EqDecision A</span></span></span><br><span><var>l, l'</var><span class="hyp-type"><b>: </b><span><span class="nb">set</span> A</span></span></span><br><span><var>Hl</var><span class="hyp-type"><b>: </b><span>NoDup l</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">NoDup (set_union l l&#39;)</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="ListSetExtras-v-chk2a" style="display: none" type="checkbox"><label class="alectryon-input" for="ListSetExtras-v-chk2a"><span class="nb">induction</span> l&#39; <span class="kr">as</span> [| x&#39; l&#39; IH]; [<span class="bp">done</span> |].</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>A</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>EqDecision0</var><span class="hyp-type"><b>: </b><span>EqDecision A</span></span></span><br><span><var>l</var><span class="hyp-type"><b>: </b><span><span class="nb">set</span> A</span></span></span><br><span><var>x'</var><span class="hyp-type"><b>: </b><span>A</span></span></span><br><span><var>l'</var><span class="hyp-type"><b>: </b><span>list A</span></span></span><br><span><var>Hl</var><span class="hyp-type"><b>: </b><span>NoDup l</span></span></span><br><span><var>IH</var><span class="hyp-type"><b>: </b><span>NoDup (set_union l l&#39;)</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">NoDup (set_union l (x&#39; :: l&#39;))</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><span class="alectryon-input"><span class="bp">by</span> <span class="nb">apply</span> set_add_nodup.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Qed</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
</span><span class="alectryon-sentence"><input class="alectryon-toggle" id="ListSetExtras-v-chk2b" style="display: none" type="checkbox"><label class="alectryon-input" for="ListSetExtras-v-chk2b"><span class="kn">Lemma</span> <span class="nf">set_union_subseteq_left</span> `{EqDecision A}  : <span class="kr">forall</span> (<span class="nv">s1</span> <span class="nv">s2</span> : list A),
  s1 ⊆ (set_union s1 s2).</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>A</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>EqDecision0</var><span class="hyp-type"><b>: </b><span>EqDecision A</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="kr">∀</span> <span class="nv">s1</span> <span class="nv">s2</span> : list A, s1 ⊆ set_union s1 s2</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="ListSetExtras-v-chk2c" style="display: none" type="checkbox"><label class="alectryon-input" for="ListSetExtras-v-chk2c"><span class="kn">Proof</span>.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>A</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>EqDecision0</var><span class="hyp-type"><b>: </b><span>EqDecision A</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="kr">∀</span> <span class="nv">s1</span> <span class="nv">s2</span> : list A, s1 ⊆ set_union s1 s2</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><span class="alectryon-input"><span class="bp">by</span> <span class="nb">intros</span>; <span class="nb">intros</span> x H; <span class="nb">apply</span> set_union_intro; <span class="nb">left</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Qed</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
</span><span class="alectryon-sentence"><input class="alectryon-toggle" id="ListSetExtras-v-chk2d" style="display: none" type="checkbox"><label class="alectryon-input" for="ListSetExtras-v-chk2d"><span class="kn">Lemma</span> <span class="nf">set_union_subseteq_right</span> `{EqDecision A}  : <span class="kr">forall</span> (<span class="nv">s1</span> <span class="nv">s2</span> : list A),
  s2 ⊆ (set_union s1 s2).</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>A</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>EqDecision0</var><span class="hyp-type"><b>: </b><span>EqDecision A</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="kr">∀</span> <span class="nv">s1</span> <span class="nv">s2</span> : list A, s2 ⊆ set_union s1 s2</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="ListSetExtras-v-chk2e" style="display: none" type="checkbox"><label class="alectryon-input" for="ListSetExtras-v-chk2e"><span class="kn">Proof</span>.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>A</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>EqDecision0</var><span class="hyp-type"><b>: </b><span>EqDecision A</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="kr">∀</span> <span class="nv">s1</span> <span class="nv">s2</span> : list A, s2 ⊆ set_union s1 s2</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><span class="alectryon-input"><span class="bp">by</span> <span class="nb">intros</span>; <span class="nb">intros</span> x H; <span class="nb">apply</span> set_union_intro; <span class="nb">right</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Qed</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
</span><span class="alectryon-sentence"><input class="alectryon-toggle" id="ListSetExtras-v-chk2f" style="display: none" type="checkbox"><label class="alectryon-input" for="ListSetExtras-v-chk2f"><span class="kn">Lemma</span> <span class="nf">set_union_subseteq_iff</span> `{EqDecision A}  : <span class="kr">forall</span> (<span class="nv">s1</span> <span class="nv">s2</span> <span class="nv">s</span> : list A),
  set_union s1 s2 ⊆ s &lt;-&gt; s1 ⊆ s /\ s2 ⊆ s.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>A</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>EqDecision0</var><span class="hyp-type"><b>: </b><span>EqDecision A</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="kr">∀</span> <span class="nv">s1</span> <span class="nv">s2</span> <span class="nv">s</span> : list A,
  set_union s1 s2 ⊆ s ↔ s1 ⊆ s ∧ s2 ⊆ s</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="ListSetExtras-v-chk30" style="display: none" type="checkbox"><label class="alectryon-input" for="ListSetExtras-v-chk30"><span class="kn">Proof</span>.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>A</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>EqDecision0</var><span class="hyp-type"><b>: </b><span>EqDecision A</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="kr">∀</span> <span class="nv">s1</span> <span class="nv">s2</span> <span class="nv">s</span> : list A,
  set_union s1 s2 ⊆ s ↔ s1 ⊆ s ∧ s2 ⊆ s</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="ListSetExtras-v-chk31" style="display: none" type="checkbox"><label class="alectryon-input" for="ListSetExtras-v-chk31"><span class="nb">intros</span>.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>A</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>EqDecision0</var><span class="hyp-type"><b>: </b><span>EqDecision A</span></span></span><br><span><var>s1, s2, s</var><span class="hyp-type"><b>: </b><span>list A</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">set_union s1 s2 ⊆ s ↔ s1 ⊆ s ∧ s2 ⊆ s</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="ListSetExtras-v-chk32" style="display: none" type="checkbox"><label class="alectryon-input" for="ListSetExtras-v-chk32"><span class="nb">unfold</span> subseteq, list_subseteq.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>A</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>EqDecision0</var><span class="hyp-type"><b>: </b><span>EqDecision A</span></span></span><br><span><var>s1, s2, s</var><span class="hyp-type"><b>: </b><span>list A</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">(<span class="kr">∀</span> <span class="nv">x</span> : A, x ∈ set_union s1 s2 → x ∈ s)
↔ (<span class="kr">∀</span> <span class="nv">x</span> : A, x ∈ s1 → x ∈ s)
  ∧ (<span class="kr">∀</span> <span class="nv">x</span> : A, x ∈ s2 → x ∈ s)</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="ListSetExtras-v-chk33" style="display: none" type="checkbox"><label class="alectryon-input" for="ListSetExtras-v-chk33"><span class="nb">setoid_rewrite</span> set_union_iff.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>A</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>EqDecision0</var><span class="hyp-type"><b>: </b><span>EqDecision A</span></span></span><br><span><var>s1, s2, s</var><span class="hyp-type"><b>: </b><span>list A</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">(<span class="kr">∀</span> <span class="nv">x</span> : A, x ∈ s1 ∨ x ∈ s2 → x ∈ s)
↔ (<span class="kr">∀</span> <span class="nv">x</span> : A, x ∈ s1 → x ∈ s)
  ∧ (<span class="kr">∀</span> <span class="nv">x</span> : A, x ∈ s2 → x ∈ s)</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><span class="alectryon-input"><span class="nb">split</span>; itauto.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Qed</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
</span><span class="alectryon-sentence"><input class="alectryon-toggle" id="ListSetExtras-v-chk34" style="display: none" type="checkbox"><label class="alectryon-input" for="ListSetExtras-v-chk34"><span class="kn">Lemma</span> <span class="nf">set_union_iterated_nodup</span> `{EqDecision A}
  (ss : list (list A))
  (H : <span class="kr">forall</span> <span class="nv">s</span>, s ∈ ss -&gt; NoDup s) :
  NoDup (fold_right set_union [] ss).</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>A</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>EqDecision0</var><span class="hyp-type"><b>: </b><span>EqDecision A</span></span></span><br><span><var>ss</var><span class="hyp-type"><b>: </b><span>list (list A)</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span><span class="kr">∀</span> <span class="nv">s</span> : list A, s ∈ ss → NoDup s</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">NoDup (foldr set_union [] ss)</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="ListSetExtras-v-chk35" style="display: none" type="checkbox"><label class="alectryon-input" for="ListSetExtras-v-chk35"><span class="kn">Proof</span>.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>A</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>EqDecision0</var><span class="hyp-type"><b>: </b><span>EqDecision A</span></span></span><br><span><var>ss</var><span class="hyp-type"><b>: </b><span>list (list A)</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span><span class="kr">∀</span> <span class="nv">s</span> : list A, s ∈ ss → NoDup s</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">NoDup (foldr set_union [] ss)</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="ListSetExtras-v-chk36" style="display: none" type="checkbox"><label class="alectryon-input" for="ListSetExtras-v-chk36"><span class="nb">intros</span>.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>A</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>EqDecision0</var><span class="hyp-type"><b>: </b><span>EqDecision A</span></span></span><br><span><var>ss</var><span class="hyp-type"><b>: </b><span>list (list A)</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span><span class="kr">∀</span> <span class="nv">s</span> : list A, s ∈ ss → NoDup s</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">NoDup (foldr set_union [] ss)</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="ListSetExtras-v-chk37" style="display: none" type="checkbox"><label class="alectryon-input" for="ListSetExtras-v-chk37"><span class="nb">generalize dependent</span> ss.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>A</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>EqDecision0</var><span class="hyp-type"><b>: </b><span>EqDecision A</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="kr">∀</span> <span class="nv">ss</span> : list (list A),
  (<span class="kr">∀</span> <span class="nv">s</span> : list A, s ∈ ss → NoDup s)
  → NoDup (foldr set_union [] ss)</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="ListSetExtras-v-chk38" style="display: none" type="checkbox"><label class="alectryon-input" for="ListSetExtras-v-chk38"><span class="nb">induction</span> ss.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>A</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>EqDecision0</var><span class="hyp-type"><b>: </b><span>EqDecision A</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">(<span class="kr">∀</span> <span class="nv">s</span> : list A, s ∈ [] → NoDup s)
→ NoDup (foldr set_union [] [])</div></blockquote><div class="alectryon-extra-goals"><input class="alectryon-extra-goal-toggle" id="ListSetExtras-v-chk39" style="display: none" type="checkbox"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>A</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>EqDecision0</var><span class="hyp-type"><b>: </b><span>EqDecision A</span></span></span><br><span><var>a</var><span class="hyp-type"><b>: </b><span>list A</span></span></span><br><span><var>ss</var><span class="hyp-type"><b>: </b><span>list (list A)</span></span></span><br><span><var>IHss</var><span class="hyp-type"><b>: </b><span>(<span class="kr">∀</span> <span class="nv">s</span> : list A, s ∈ ss → NoDup s)
→ NoDup (foldr set_union [] ss)</span></span></span><br></div><label class="goal-separator" for="ListSetExtras-v-chk39"><hr></label><div class="goal-conclusion">(<span class="kr">∀</span> <span class="nv">s</span> : list A, s ∈ a :: ss → NoDup s)
→ NoDup (foldr set_union [] (a :: ss))</div></blockquote></div></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="ListSetExtras-v-chk3a" style="display: none" type="checkbox"><label class="alectryon-input" for="ListSetExtras-v-chk3a">-</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>A</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>EqDecision0</var><span class="hyp-type"><b>: </b><span>EqDecision A</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">(<span class="kr">∀</span> <span class="nv">s</span> : list A, s ∈ [] → NoDup s)
→ NoDup (foldr set_union [] [])</div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="bp">by</span> <span class="nb">intros</span>; <span class="nb">apply</span> NoDup_nil.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="ListSetExtras-v-chk3b" style="display: none" type="checkbox"><label class="alectryon-input" for="ListSetExtras-v-chk3b">-</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>A</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>EqDecision0</var><span class="hyp-type"><b>: </b><span>EqDecision A</span></span></span><br><span><var>a</var><span class="hyp-type"><b>: </b><span>list A</span></span></span><br><span><var>ss</var><span class="hyp-type"><b>: </b><span>list (list A)</span></span></span><br><span><var>IHss</var><span class="hyp-type"><b>: </b><span>(<span class="kr">∀</span> <span class="nv">s</span> : list A, s ∈ ss → NoDup s)
→ NoDup (foldr set_union [] ss)</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">(<span class="kr">∀</span> <span class="nv">s</span> : list A, s ∈ a :: ss → NoDup s)
→ NoDup (foldr set_union [] (a :: ss))</div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="ListSetExtras-v-chk3c" style="display: none" type="checkbox"><label class="alectryon-input" for="ListSetExtras-v-chk3c"><span class="nb">intros</span>.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>A</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>EqDecision0</var><span class="hyp-type"><b>: </b><span>EqDecision A</span></span></span><br><span><var>a</var><span class="hyp-type"><b>: </b><span>list A</span></span></span><br><span><var>ss</var><span class="hyp-type"><b>: </b><span>list (list A)</span></span></span><br><span><var>IHss</var><span class="hyp-type"><b>: </b><span>(<span class="kr">∀</span> <span class="nv">s</span> : list A, s ∈ ss → NoDup s)
→ NoDup (foldr set_union [] ss)</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span><span class="kr">∀</span> <span class="nv">s</span> : list A, s ∈ a :: ss → NoDup s</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">NoDup (foldr set_union [] (a :: ss))</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="ListSetExtras-v-chk3d" style="display: none" type="checkbox"><label class="alectryon-input" for="ListSetExtras-v-chk3d"><span class="nb">simpl</span>.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>A</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>EqDecision0</var><span class="hyp-type"><b>: </b><span>EqDecision A</span></span></span><br><span><var>a</var><span class="hyp-type"><b>: </b><span>list A</span></span></span><br><span><var>ss</var><span class="hyp-type"><b>: </b><span>list (list A)</span></span></span><br><span><var>IHss</var><span class="hyp-type"><b>: </b><span>(<span class="kr">∀</span> <span class="nv">s</span> : list A, s ∈ ss → NoDup s)
→ NoDup (foldr set_union [] ss)</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span><span class="kr">∀</span> <span class="nv">s</span> : list A, s ∈ a :: ss → NoDup s</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">NoDup (set_union a (foldr set_union [] ss))</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="ListSetExtras-v-chk3e" style="display: none" type="checkbox"><label class="alectryon-input" for="ListSetExtras-v-chk3e"><span class="nb">apply</span> set_union_nodup.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>A</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>EqDecision0</var><span class="hyp-type"><b>: </b><span>EqDecision A</span></span></span><br><span><var>a</var><span class="hyp-type"><b>: </b><span>list A</span></span></span><br><span><var>ss</var><span class="hyp-type"><b>: </b><span>list (list A)</span></span></span><br><span><var>IHss</var><span class="hyp-type"><b>: </b><span>(<span class="kr">∀</span> <span class="nv">s</span> : list A, s ∈ ss → NoDup s)
→ NoDup (foldr set_union [] ss)</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span><span class="kr">∀</span> <span class="nv">s</span> : list A, s ∈ a :: ss → NoDup s</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">NoDup a</div></blockquote><div class="alectryon-extra-goals"><input class="alectryon-extra-goal-toggle" id="ListSetExtras-v-chk3f" style="display: none" type="checkbox"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>A</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>EqDecision0</var><span class="hyp-type"><b>: </b><span>EqDecision A</span></span></span><br><span><var>a</var><span class="hyp-type"><b>: </b><span>list A</span></span></span><br><span><var>ss</var><span class="hyp-type"><b>: </b><span>list (list A)</span></span></span><br><span><var>IHss</var><span class="hyp-type"><b>: </b><span>(<span class="kr">∀</span> <span class="nv">s</span> : list A, s ∈ ss → NoDup s)
→ NoDup (foldr set_union [] ss)</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span><span class="kr">∀</span> <span class="nv">s</span> : list A, s ∈ a :: ss → NoDup s</span></span></span><br></div><label class="goal-separator" for="ListSetExtras-v-chk3f"><hr></label><div class="goal-conclusion">NoDup (foldr set_union [] ss)</div></blockquote></div></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="ListSetExtras-v-chk40" style="display: none" type="checkbox"><label class="alectryon-input" for="ListSetExtras-v-chk40">+</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>A</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>EqDecision0</var><span class="hyp-type"><b>: </b><span>EqDecision A</span></span></span><br><span><var>a</var><span class="hyp-type"><b>: </b><span>list A</span></span></span><br><span><var>ss</var><span class="hyp-type"><b>: </b><span>list (list A)</span></span></span><br><span><var>IHss</var><span class="hyp-type"><b>: </b><span>(<span class="kr">∀</span> <span class="nv">s</span> : list A, s ∈ ss → NoDup s)
→ NoDup (foldr set_union [] ss)</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span><span class="kr">∀</span> <span class="nv">s</span> : list A, s ∈ a :: ss → NoDup s</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">NoDup a</div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="nb">apply</span> H; <span class="nb">left</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="ListSetExtras-v-chk41" style="display: none" type="checkbox"><label class="alectryon-input" for="ListSetExtras-v-chk41">+</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>A</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>EqDecision0</var><span class="hyp-type"><b>: </b><span>EqDecision A</span></span></span><br><span><var>a</var><span class="hyp-type"><b>: </b><span>list A</span></span></span><br><span><var>ss</var><span class="hyp-type"><b>: </b><span>list (list A)</span></span></span><br><span><var>IHss</var><span class="hyp-type"><b>: </b><span>(<span class="kr">∀</span> <span class="nv">s</span> : list A, s ∈ ss → NoDup s)
→ NoDup (foldr set_union [] ss)</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span><span class="kr">∀</span> <span class="nv">s</span> : list A, s ∈ a :: ss → NoDup s</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">NoDup (foldr set_union [] ss)</div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="ListSetExtras-v-chk42" style="display: none" type="checkbox"><label class="alectryon-input" for="ListSetExtras-v-chk42"><span class="nb">apply</span> IHss.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>A</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>EqDecision0</var><span class="hyp-type"><b>: </b><span>EqDecision A</span></span></span><br><span><var>a</var><span class="hyp-type"><b>: </b><span>list A</span></span></span><br><span><var>ss</var><span class="hyp-type"><b>: </b><span>list (list A)</span></span></span><br><span><var>IHss</var><span class="hyp-type"><b>: </b><span>(<span class="kr">∀</span> <span class="nv">s</span> : list A, s ∈ ss → NoDup s)
→ NoDup (foldr set_union [] ss)</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span><span class="kr">∀</span> <span class="nv">s</span> : list A, s ∈ a :: ss → NoDup s</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="kr">∀</span> <span class="nv">s</span> : list A, s ∈ ss → NoDup s</div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="bp">by</span> <span class="nb">intros</span>; <span class="nb">apply</span> H; <span class="nb">right</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Qed</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
</span><span class="alectryon-sentence"><input class="alectryon-toggle" id="ListSetExtras-v-chk43" style="display: none" type="checkbox"><label class="alectryon-input" for="ListSetExtras-v-chk43"><span class="kn">Lemma</span> <span class="nf">set_union_in_iterated</span>
  `{EqDecision A}
  (ss : list (<span class="nb">set</span> A))
  (a : A)
  : a ∈ (fold_right set_union [] ss) &lt;-&gt; Exists (<span class="kr">fun</span> <span class="nv">s</span> =&gt; a ∈ s) ss.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>A</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>EqDecision0</var><span class="hyp-type"><b>: </b><span>EqDecision A</span></span></span><br><span><var>ss</var><span class="hyp-type"><b>: </b><span>list (<span class="nb">set</span> A)</span></span></span><br><span><var>a</var><span class="hyp-type"><b>: </b><span>A</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">a ∈ foldr set_union [] ss
↔ Exists (<span class="kr">λ</span> <span class="nv">s</span> : <span class="nb">set</span> A, a ∈ s) ss</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="ListSetExtras-v-chk44" style="display: none" type="checkbox"><label class="alectryon-input" for="ListSetExtras-v-chk44"><span class="kn">Proof</span>.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>A</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>EqDecision0</var><span class="hyp-type"><b>: </b><span>EqDecision A</span></span></span><br><span><var>ss</var><span class="hyp-type"><b>: </b><span>list (<span class="nb">set</span> A)</span></span></span><br><span><var>a</var><span class="hyp-type"><b>: </b><span>A</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">a ∈ foldr set_union [] ss
↔ Exists (<span class="kr">λ</span> <span class="nv">s</span> : <span class="nb">set</span> A, a ∈ s) ss</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="ListSetExtras-v-chk45" style="display: none" type="checkbox"><label class="alectryon-input" for="ListSetExtras-v-chk45"><span class="nb">rewrite</span> Exists_exists.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>A</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>EqDecision0</var><span class="hyp-type"><b>: </b><span>EqDecision A</span></span></span><br><span><var>ss</var><span class="hyp-type"><b>: </b><span>list (<span class="nb">set</span> A)</span></span></span><br><span><var>a</var><span class="hyp-type"><b>: </b><span>A</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">a ∈ foldr set_union [] ss
↔ (<span class="kr">∃</span> <span class="nv">x</span> : <span class="nb">set</span> A, x ∈ ss ∧ a ∈ x)</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="ListSetExtras-v-chk46" style="display: none" type="checkbox"><label class="alectryon-input" for="ListSetExtras-v-chk46"><span class="nb">induction</span> ss; <span class="nb">split</span>; <span class="nb">simpl</span>.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>A</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>EqDecision0</var><span class="hyp-type"><b>: </b><span>EqDecision A</span></span></span><br><span><var>a</var><span class="hyp-type"><b>: </b><span>A</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">a ∈ [] → <span class="kr">∃</span> <span class="nv">x</span> : <span class="nb">set</span> A, x ∈ [] ∧ a ∈ x</div></blockquote><div class="alectryon-extra-goals"><input class="alectryon-extra-goal-toggle" id="ListSetExtras-v-chk47" style="display: none" type="checkbox"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>A</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>EqDecision0</var><span class="hyp-type"><b>: </b><span>EqDecision A</span></span></span><br><span><var>a</var><span class="hyp-type"><b>: </b><span>A</span></span></span><br></div><label class="goal-separator" for="ListSetExtras-v-chk47"><hr></label><div class="goal-conclusion">(<span class="kr">∃</span> <span class="nv">x</span> : <span class="nb">set</span> A, x ∈ [] ∧ a ∈ x) → a ∈ []</div></blockquote><input class="alectryon-extra-goal-toggle" id="ListSetExtras-v-chk48" style="display: none" type="checkbox"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>A</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>EqDecision0</var><span class="hyp-type"><b>: </b><span>EqDecision A</span></span></span><br><span><var>a0</var><span class="hyp-type"><b>: </b><span><span class="nb">set</span> A</span></span></span><br><span><var>ss</var><span class="hyp-type"><b>: </b><span>list (<span class="nb">set</span> A)</span></span></span><br><span><var>a</var><span class="hyp-type"><b>: </b><span>A</span></span></span><br><span><var>IHss</var><span class="hyp-type"><b>: </b><span>a ∈ foldr set_union [] ss
↔ (<span class="kr">∃</span> <span class="nv">x</span> : <span class="nb">set</span> A, x ∈ ss ∧ a ∈ x)</span></span></span><br></div><label class="goal-separator" for="ListSetExtras-v-chk48"><hr></label><div class="goal-conclusion">a ∈ set_union a0 (foldr set_union [] ss)
→ <span class="kr">∃</span> <span class="nv">x</span> : <span class="nb">set</span> A, x ∈ a0 :: ss ∧ a ∈ x</div></blockquote><input class="alectryon-extra-goal-toggle" id="ListSetExtras-v-chk49" style="display: none" type="checkbox"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>A</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>EqDecision0</var><span class="hyp-type"><b>: </b><span>EqDecision A</span></span></span><br><span><var>a0</var><span class="hyp-type"><b>: </b><span><span class="nb">set</span> A</span></span></span><br><span><var>ss</var><span class="hyp-type"><b>: </b><span>list (<span class="nb">set</span> A)</span></span></span><br><span><var>a</var><span class="hyp-type"><b>: </b><span>A</span></span></span><br><span><var>IHss</var><span class="hyp-type"><b>: </b><span>a ∈ foldr set_union [] ss
↔ (<span class="kr">∃</span> <span class="nv">x</span> : <span class="nb">set</span> A, x ∈ ss ∧ a ∈ x)</span></span></span><br></div><label class="goal-separator" for="ListSetExtras-v-chk49"><hr></label><div class="goal-conclusion">(<span class="kr">∃</span> <span class="nv">x</span> : <span class="nb">set</span> A, x ∈ a0 :: ss ∧ a ∈ x)
→ a ∈ set_union a0 (foldr set_union [] ss)</div></blockquote></div></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="ListSetExtras-v-chk4a" style="display: none" type="checkbox"><label class="alectryon-input" for="ListSetExtras-v-chk4a">-</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>A</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>EqDecision0</var><span class="hyp-type"><b>: </b><span>EqDecision A</span></span></span><br><span><var>a</var><span class="hyp-type"><b>: </b><span>A</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">a ∈ [] → <span class="kr">∃</span> <span class="nv">x</span> : <span class="nb">set</span> A, x ∈ [] ∧ a ∈ x</div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="nb">intro</span> H; <span class="nb">inversion</span> H.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="ListSetExtras-v-chk4b" style="display: none" type="checkbox"><label class="alectryon-input" for="ListSetExtras-v-chk4b">-</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>A</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>EqDecision0</var><span class="hyp-type"><b>: </b><span>EqDecision A</span></span></span><br><span><var>a</var><span class="hyp-type"><b>: </b><span>A</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">(<span class="kr">∃</span> <span class="nv">x</span> : <span class="nb">set</span> A, x ∈ [] ∧ a ∈ x) → a ∈ []</div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="nb">intros</span> [x [Hin _]]; <span class="nb">inversion</span> Hin.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="ListSetExtras-v-chk4c" style="display: none" type="checkbox"><label class="alectryon-input" for="ListSetExtras-v-chk4c">-</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>A</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>EqDecision0</var><span class="hyp-type"><b>: </b><span>EqDecision A</span></span></span><br><span><var>a0</var><span class="hyp-type"><b>: </b><span><span class="nb">set</span> A</span></span></span><br><span><var>ss</var><span class="hyp-type"><b>: </b><span>list (<span class="nb">set</span> A)</span></span></span><br><span><var>a</var><span class="hyp-type"><b>: </b><span>A</span></span></span><br><span><var>IHss</var><span class="hyp-type"><b>: </b><span>a ∈ foldr set_union [] ss
↔ (<span class="kr">∃</span> <span class="nv">x</span> : <span class="nb">set</span> A, x ∈ ss ∧ a ∈ x)</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">a ∈ set_union a0 (foldr set_union [] ss)
→ <span class="kr">∃</span> <span class="nv">x</span> : <span class="nb">set</span> A, x ∈ a0 :: ss ∧ a ∈ x</div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="ListSetExtras-v-chk4d" style="display: none" type="checkbox"><label class="alectryon-input" for="ListSetExtras-v-chk4d"><span class="nb">intro</span> Hin.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>A</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>EqDecision0</var><span class="hyp-type"><b>: </b><span>EqDecision A</span></span></span><br><span><var>a0</var><span class="hyp-type"><b>: </b><span><span class="nb">set</span> A</span></span></span><br><span><var>ss</var><span class="hyp-type"><b>: </b><span>list (<span class="nb">set</span> A)</span></span></span><br><span><var>a</var><span class="hyp-type"><b>: </b><span>A</span></span></span><br><span><var>IHss</var><span class="hyp-type"><b>: </b><span>a ∈ foldr set_union [] ss
↔ (<span class="kr">∃</span> <span class="nv">x</span> : <span class="nb">set</span> A, x ∈ ss ∧ a ∈ x)</span></span></span><br><span><var>Hin</var><span class="hyp-type"><b>: </b><span>a ∈ set_union a0 (foldr set_union [] ss)</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="kr">∃</span> <span class="nv">x</span> : <span class="nb">set</span> A, x ∈ a0 :: ss ∧ a ∈ x</div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="ListSetExtras-v-chk4e" style="display: none" type="checkbox"><label class="alectryon-input" for="ListSetExtras-v-chk4e"><span class="nb">apply</span> set_union_iff <span class="kr">in</span> Hin.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>A</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>EqDecision0</var><span class="hyp-type"><b>: </b><span>EqDecision A</span></span></span><br><span><var>a0</var><span class="hyp-type"><b>: </b><span><span class="nb">set</span> A</span></span></span><br><span><var>ss</var><span class="hyp-type"><b>: </b><span>list (<span class="nb">set</span> A)</span></span></span><br><span><var>a</var><span class="hyp-type"><b>: </b><span>A</span></span></span><br><span><var>IHss</var><span class="hyp-type"><b>: </b><span>a ∈ foldr set_union [] ss
↔ (<span class="kr">∃</span> <span class="nv">x</span> : <span class="nb">set</span> A, x ∈ ss ∧ a ∈ x)</span></span></span><br><span><var>Hin</var><span class="hyp-type"><b>: </b><span>a ∈ a0 ∨ a ∈ foldr set_union [] ss</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="kr">∃</span> <span class="nv">x</span> : <span class="nb">set</span> A, x ∈ a0 :: ss ∧ a ∈ x</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="ListSetExtras-v-chk4f" style="display: none" type="checkbox"><label class="alectryon-input" for="ListSetExtras-v-chk4f"><span class="nb">destruct</span> Hin <span class="kr">as</span> [Hina0 | Hinss].</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>A</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>EqDecision0</var><span class="hyp-type"><b>: </b><span>EqDecision A</span></span></span><br><span><var>a0</var><span class="hyp-type"><b>: </b><span><span class="nb">set</span> A</span></span></span><br><span><var>ss</var><span class="hyp-type"><b>: </b><span>list (<span class="nb">set</span> A)</span></span></span><br><span><var>a</var><span class="hyp-type"><b>: </b><span>A</span></span></span><br><span><var>IHss</var><span class="hyp-type"><b>: </b><span>a ∈ foldr set_union [] ss
↔ (<span class="kr">∃</span> <span class="nv">x</span> : <span class="nb">set</span> A, x ∈ ss ∧ a ∈ x)</span></span></span><br><span><var>Hina0</var><span class="hyp-type"><b>: </b><span>a ∈ a0</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="kr">∃</span> <span class="nv">x</span> : <span class="nb">set</span> A, x ∈ a0 :: ss ∧ a ∈ x</div></blockquote><div class="alectryon-extra-goals"><input class="alectryon-extra-goal-toggle" id="ListSetExtras-v-chk50" style="display: none" type="checkbox"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>A</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>EqDecision0</var><span class="hyp-type"><b>: </b><span>EqDecision A</span></span></span><br><span><var>a0</var><span class="hyp-type"><b>: </b><span><span class="nb">set</span> A</span></span></span><br><span><var>ss</var><span class="hyp-type"><b>: </b><span>list (<span class="nb">set</span> A)</span></span></span><br><span><var>a</var><span class="hyp-type"><b>: </b><span>A</span></span></span><br><span><var>IHss</var><span class="hyp-type"><b>: </b><span>a ∈ foldr set_union [] ss
↔ (<span class="kr">∃</span> <span class="nv">x</span> : <span class="nb">set</span> A, x ∈ ss ∧ a ∈ x)</span></span></span><br><span><var>Hinss</var><span class="hyp-type"><b>: </b><span>a ∈ foldr set_union [] ss</span></span></span><br></div><label class="goal-separator" for="ListSetExtras-v-chk50"><hr></label><div class="goal-conclusion"><span class="kr">∃</span> <span class="nv">x</span> : <span class="nb">set</span> A, x ∈ a0 :: ss ∧ a ∈ x</div></blockquote></div></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="ListSetExtras-v-chk51" style="display: none" type="checkbox"><label class="alectryon-input" for="ListSetExtras-v-chk51">+</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>A</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>EqDecision0</var><span class="hyp-type"><b>: </b><span>EqDecision A</span></span></span><br><span><var>a0</var><span class="hyp-type"><b>: </b><span><span class="nb">set</span> A</span></span></span><br><span><var>ss</var><span class="hyp-type"><b>: </b><span>list (<span class="nb">set</span> A)</span></span></span><br><span><var>a</var><span class="hyp-type"><b>: </b><span>A</span></span></span><br><span><var>IHss</var><span class="hyp-type"><b>: </b><span>a ∈ foldr set_union [] ss
↔ (<span class="kr">∃</span> <span class="nv">x</span> : <span class="nb">set</span> A, x ∈ ss ∧ a ∈ x)</span></span></span><br><span><var>Hina0</var><span class="hyp-type"><b>: </b><span>a ∈ a0</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="kr">∃</span> <span class="nv">x</span> : <span class="nb">set</span> A, x ∈ a0 :: ss ∧ a ∈ x</div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="ListSetExtras-v-chk52" style="display: none" type="checkbox"><label class="alectryon-input" for="ListSetExtras-v-chk52"><span class="kr">exists</span> <span class="nv">a0</span>.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>A</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>EqDecision0</var><span class="hyp-type"><b>: </b><span>EqDecision A</span></span></span><br><span><var>a0</var><span class="hyp-type"><b>: </b><span><span class="nb">set</span> A</span></span></span><br><span><var>ss</var><span class="hyp-type"><b>: </b><span>list (<span class="nb">set</span> A)</span></span></span><br><span><var>a</var><span class="hyp-type"><b>: </b><span>A</span></span></span><br><span><var>IHss</var><span class="hyp-type"><b>: </b><span>a ∈ foldr set_union [] ss
↔ (<span class="kr">∃</span> <span class="nv">x</span> : <span class="nb">set</span> A, x ∈ ss ∧ a ∈ x)</span></span></span><br><span><var>Hina0</var><span class="hyp-type"><b>: </b><span>a ∈ a0</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">a0 ∈ a0 :: ss ∧ a ∈ a0</div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="ListSetExtras-v-chk53" style="display: none" type="checkbox"><label class="alectryon-input" for="ListSetExtras-v-chk53"><span class="nb">rewrite</span> elem_of_cons.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>A</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>EqDecision0</var><span class="hyp-type"><b>: </b><span>EqDecision A</span></span></span><br><span><var>a0</var><span class="hyp-type"><b>: </b><span><span class="nb">set</span> A</span></span></span><br><span><var>ss</var><span class="hyp-type"><b>: </b><span>list (<span class="nb">set</span> A)</span></span></span><br><span><var>a</var><span class="hyp-type"><b>: </b><span>A</span></span></span><br><span><var>IHss</var><span class="hyp-type"><b>: </b><span>a ∈ foldr set_union [] ss
↔ (<span class="kr">∃</span> <span class="nv">x</span> : <span class="nb">set</span> A, x ∈ ss ∧ a ∈ x)</span></span></span><br><span><var>Hina0</var><span class="hyp-type"><b>: </b><span>a ∈ a0</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">(a0 = a0 ∨ a0 ∈ ss) ∧ a ∈ a0</div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="bp">by</span> <span class="nb">split</span>; [<span class="nb">left</span> |].</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="ListSetExtras-v-chk54" style="display: none" type="checkbox"><label class="alectryon-input" for="ListSetExtras-v-chk54">+</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>A</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>EqDecision0</var><span class="hyp-type"><b>: </b><span>EqDecision A</span></span></span><br><span><var>a0</var><span class="hyp-type"><b>: </b><span><span class="nb">set</span> A</span></span></span><br><span><var>ss</var><span class="hyp-type"><b>: </b><span>list (<span class="nb">set</span> A)</span></span></span><br><span><var>a</var><span class="hyp-type"><b>: </b><span>A</span></span></span><br><span><var>IHss</var><span class="hyp-type"><b>: </b><span>a ∈ foldr set_union [] ss
↔ (<span class="kr">∃</span> <span class="nv">x</span> : <span class="nb">set</span> A, x ∈ ss ∧ a ∈ x)</span></span></span><br><span><var>Hinss</var><span class="hyp-type"><b>: </b><span>a ∈ foldr set_union [] ss</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="kr">∃</span> <span class="nv">x</span> : <span class="nb">set</span> A, x ∈ a0 :: ss ∧ a ∈ x</div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="ListSetExtras-v-chk55" style="display: none" type="checkbox"><label class="alectryon-input" for="ListSetExtras-v-chk55"><span class="nb">apply</span> IHss <span class="kr">in</span> Hinss.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>A</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>EqDecision0</var><span class="hyp-type"><b>: </b><span>EqDecision A</span></span></span><br><span><var>a0</var><span class="hyp-type"><b>: </b><span><span class="nb">set</span> A</span></span></span><br><span><var>ss</var><span class="hyp-type"><b>: </b><span>list (<span class="nb">set</span> A)</span></span></span><br><span><var>a</var><span class="hyp-type"><b>: </b><span>A</span></span></span><br><span><var>IHss</var><span class="hyp-type"><b>: </b><span>a ∈ foldr set_union [] ss
↔ (<span class="kr">∃</span> <span class="nv">x</span> : <span class="nb">set</span> A, x ∈ ss ∧ a ∈ x)</span></span></span><br><span><var>Hinss</var><span class="hyp-type"><b>: </b><span><span class="kr">∃</span> <span class="nv">x</span> : <span class="nb">set</span> A, x ∈ ss ∧ a ∈ x</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="kr">∃</span> <span class="nv">x</span> : <span class="nb">set</span> A, x ∈ a0 :: ss ∧ a ∈ x</div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="ListSetExtras-v-chk56" style="display: none" type="checkbox"><label class="alectryon-input" for="ListSetExtras-v-chk56"><span class="nb">destruct</span> Hinss <span class="kr">as</span> [x [Hinss Hinx]].</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>A</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>EqDecision0</var><span class="hyp-type"><b>: </b><span>EqDecision A</span></span></span><br><span><var>a0</var><span class="hyp-type"><b>: </b><span><span class="nb">set</span> A</span></span></span><br><span><var>ss</var><span class="hyp-type"><b>: </b><span>list (<span class="nb">set</span> A)</span></span></span><br><span><var>a</var><span class="hyp-type"><b>: </b><span>A</span></span></span><br><span><var>IHss</var><span class="hyp-type"><b>: </b><span>a ∈ foldr set_union [] ss
↔ (<span class="kr">∃</span> <span class="nv">x</span> : <span class="nb">set</span> A, x ∈ ss ∧ a ∈ x)</span></span></span><br><span><var>x</var><span class="hyp-type"><b>: </b><span><span class="nb">set</span> A</span></span></span><br><span><var>Hinss</var><span class="hyp-type"><b>: </b><span>x ∈ ss</span></span></span><br><span><var>Hinx</var><span class="hyp-type"><b>: </b><span>a ∈ x</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="kr">∃</span> <span class="nv">x</span> : <span class="nb">set</span> A, x ∈ a0 :: ss ∧ a ∈ x</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">      </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="ListSetExtras-v-chk57" style="display: none" type="checkbox"><label class="alectryon-input" for="ListSetExtras-v-chk57"><span class="nb">setoid_rewrite</span> elem_of_cons.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>A</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>EqDecision0</var><span class="hyp-type"><b>: </b><span>EqDecision A</span></span></span><br><span><var>a0</var><span class="hyp-type"><b>: </b><span><span class="nb">set</span> A</span></span></span><br><span><var>ss</var><span class="hyp-type"><b>: </b><span>list (<span class="nb">set</span> A)</span></span></span><br><span><var>a</var><span class="hyp-type"><b>: </b><span>A</span></span></span><br><span><var>IHss</var><span class="hyp-type"><b>: </b><span>a ∈ foldr set_union [] ss
↔ (<span class="kr">∃</span> <span class="nv">x</span> : <span class="nb">set</span> A, x ∈ ss ∧ a ∈ x)</span></span></span><br><span><var>x</var><span class="hyp-type"><b>: </b><span><span class="nb">set</span> A</span></span></span><br><span><var>Hinss</var><span class="hyp-type"><b>: </b><span>x ∈ ss</span></span></span><br><span><var>Hinx</var><span class="hyp-type"><b>: </b><span>a ∈ x</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="kr">∃</span> <span class="nv">x</span> : <span class="nb">set</span> A, (x = a0 ∨ x ∈ ss) ∧ a ∈ x</div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="nb">eauto</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="ListSetExtras-v-chk58" style="display: none" type="checkbox"><label class="alectryon-input" for="ListSetExtras-v-chk58">-</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>A</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>EqDecision0</var><span class="hyp-type"><b>: </b><span>EqDecision A</span></span></span><br><span><var>a0</var><span class="hyp-type"><b>: </b><span><span class="nb">set</span> A</span></span></span><br><span><var>ss</var><span class="hyp-type"><b>: </b><span>list (<span class="nb">set</span> A)</span></span></span><br><span><var>a</var><span class="hyp-type"><b>: </b><span>A</span></span></span><br><span><var>IHss</var><span class="hyp-type"><b>: </b><span>a ∈ foldr set_union [] ss
↔ (<span class="kr">∃</span> <span class="nv">x</span> : <span class="nb">set</span> A, x ∈ ss ∧ a ∈ x)</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">(<span class="kr">∃</span> <span class="nv">x</span> : <span class="nb">set</span> A, x ∈ a0 :: ss ∧ a ∈ x)
→ a ∈ set_union a0 (foldr set_union [] ss)</div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="ListSetExtras-v-chk59" style="display: none" type="checkbox"><label class="alectryon-input" for="ListSetExtras-v-chk59"><span class="nb">rewrite</span> set_union_iff.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>A</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>EqDecision0</var><span class="hyp-type"><b>: </b><span>EqDecision A</span></span></span><br><span><var>a0</var><span class="hyp-type"><b>: </b><span><span class="nb">set</span> A</span></span></span><br><span><var>ss</var><span class="hyp-type"><b>: </b><span>list (<span class="nb">set</span> A)</span></span></span><br><span><var>a</var><span class="hyp-type"><b>: </b><span>A</span></span></span><br><span><var>IHss</var><span class="hyp-type"><b>: </b><span>a ∈ foldr set_union [] ss
↔ (<span class="kr">∃</span> <span class="nv">x</span> : <span class="nb">set</span> A, x ∈ ss ∧ a ∈ x)</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">(<span class="kr">∃</span> <span class="nv">x</span> : <span class="nb">set</span> A, x ∈ a0 :: ss ∧ a ∈ x)
→ a ∈ a0 ∨ a ∈ foldr set_union [] ss</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="ListSetExtras-v-chk5a" style="display: none" type="checkbox"><label class="alectryon-input" for="ListSetExtras-v-chk5a"><span class="nb">intros</span> [x [Hx Ha]].</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>A</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>EqDecision0</var><span class="hyp-type"><b>: </b><span>EqDecision A</span></span></span><br><span><var>a0</var><span class="hyp-type"><b>: </b><span><span class="nb">set</span> A</span></span></span><br><span><var>ss</var><span class="hyp-type"><b>: </b><span>list (<span class="nb">set</span> A)</span></span></span><br><span><var>a</var><span class="hyp-type"><b>: </b><span>A</span></span></span><br><span><var>IHss</var><span class="hyp-type"><b>: </b><span>a ∈ foldr set_union [] ss
↔ (<span class="kr">∃</span> <span class="nv">x</span> : <span class="nb">set</span> A, x ∈ ss ∧ a ∈ x)</span></span></span><br><span><var>x</var><span class="hyp-type"><b>: </b><span><span class="nb">set</span> A</span></span></span><br><span><var>Hx</var><span class="hyp-type"><b>: </b><span>x ∈ a0 :: ss</span></span></span><br><span><var>Ha</var><span class="hyp-type"><b>: </b><span>a ∈ x</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">a ∈ a0 ∨ a ∈ foldr set_union [] ss</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="ListSetExtras-v-chk5b" style="display: none" type="checkbox"><label class="alectryon-input" for="ListSetExtras-v-chk5b"><span class="nb">apply</span> elem_of_cons <span class="kr">in</span> Hx.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>A</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>EqDecision0</var><span class="hyp-type"><b>: </b><span>EqDecision A</span></span></span><br><span><var>a0</var><span class="hyp-type"><b>: </b><span><span class="nb">set</span> A</span></span></span><br><span><var>ss</var><span class="hyp-type"><b>: </b><span>list (<span class="nb">set</span> A)</span></span></span><br><span><var>a</var><span class="hyp-type"><b>: </b><span>A</span></span></span><br><span><var>IHss</var><span class="hyp-type"><b>: </b><span>a ∈ foldr set_union [] ss
↔ (<span class="kr">∃</span> <span class="nv">x</span> : <span class="nb">set</span> A, x ∈ ss ∧ a ∈ x)</span></span></span><br><span><var>x</var><span class="hyp-type"><b>: </b><span><span class="nb">set</span> A</span></span></span><br><span><var>Hx</var><span class="hyp-type"><b>: </b><span>x = a0 ∨ x ∈ ss</span></span></span><br><span><var>Ha</var><span class="hyp-type"><b>: </b><span>a ∈ x</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">a ∈ a0 ∨ a ∈ foldr set_union [] ss</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="ListSetExtras-v-chk5c" style="display: none" type="checkbox"><label class="alectryon-input" for="ListSetExtras-v-chk5c"><span class="nb">destruct</span> Hx; <span class="nb">subst</span>.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>A</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>EqDecision0</var><span class="hyp-type"><b>: </b><span>EqDecision A</span></span></span><br><span><var>a0</var><span class="hyp-type"><b>: </b><span><span class="nb">set</span> A</span></span></span><br><span><var>ss</var><span class="hyp-type"><b>: </b><span>list (<span class="nb">set</span> A)</span></span></span><br><span><var>a</var><span class="hyp-type"><b>: </b><span>A</span></span></span><br><span><var>IHss</var><span class="hyp-type"><b>: </b><span>a ∈ foldr set_union [] ss
↔ (<span class="kr">∃</span> <span class="nv">x</span> : <span class="nb">set</span> A, x ∈ ss ∧ a ∈ x)</span></span></span><br><span><var>Ha</var><span class="hyp-type"><b>: </b><span>a ∈ a0</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">a ∈ a0 ∨ a ∈ foldr set_union [] ss</div></blockquote><div class="alectryon-extra-goals"><input class="alectryon-extra-goal-toggle" id="ListSetExtras-v-chk5d" style="display: none" type="checkbox"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>A</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>EqDecision0</var><span class="hyp-type"><b>: </b><span>EqDecision A</span></span></span><br><span><var>a0</var><span class="hyp-type"><b>: </b><span><span class="nb">set</span> A</span></span></span><br><span><var>ss</var><span class="hyp-type"><b>: </b><span>list (<span class="nb">set</span> A)</span></span></span><br><span><var>a</var><span class="hyp-type"><b>: </b><span>A</span></span></span><br><span><var>IHss</var><span class="hyp-type"><b>: </b><span>a ∈ foldr set_union [] ss
↔ (<span class="kr">∃</span> <span class="nv">x</span> : <span class="nb">set</span> A, x ∈ ss ∧ a ∈ x)</span></span></span><br><span><var>x</var><span class="hyp-type"><b>: </b><span><span class="nb">set</span> A</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>x ∈ ss</span></span></span><br><span><var>Ha</var><span class="hyp-type"><b>: </b><span>a ∈ x</span></span></span><br></div><label class="goal-separator" for="ListSetExtras-v-chk5d"><hr></label><div class="goal-conclusion">a ∈ a0 ∨ a ∈ foldr set_union [] ss</div></blockquote></div></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="ListSetExtras-v-chk5e" style="display: none" type="checkbox"><label class="alectryon-input" for="ListSetExtras-v-chk5e">+</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>A</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>EqDecision0</var><span class="hyp-type"><b>: </b><span>EqDecision A</span></span></span><br><span><var>a0</var><span class="hyp-type"><b>: </b><span><span class="nb">set</span> A</span></span></span><br><span><var>ss</var><span class="hyp-type"><b>: </b><span>list (<span class="nb">set</span> A)</span></span></span><br><span><var>a</var><span class="hyp-type"><b>: </b><span>A</span></span></span><br><span><var>IHss</var><span class="hyp-type"><b>: </b><span>a ∈ foldr set_union [] ss
↔ (<span class="kr">∃</span> <span class="nv">x</span> : <span class="nb">set</span> A, x ∈ ss ∧ a ∈ x)</span></span></span><br><span><var>Ha</var><span class="hyp-type"><b>: </b><span>a ∈ a0</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">a ∈ a0 ∨ a ∈ foldr set_union [] ss</div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="bp">by</span> <span class="nb">left</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="ListSetExtras-v-chk5f" style="display: none" type="checkbox"><label class="alectryon-input" for="ListSetExtras-v-chk5f">+</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>A</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>EqDecision0</var><span class="hyp-type"><b>: </b><span>EqDecision A</span></span></span><br><span><var>a0</var><span class="hyp-type"><b>: </b><span><span class="nb">set</span> A</span></span></span><br><span><var>ss</var><span class="hyp-type"><b>: </b><span>list (<span class="nb">set</span> A)</span></span></span><br><span><var>a</var><span class="hyp-type"><b>: </b><span>A</span></span></span><br><span><var>IHss</var><span class="hyp-type"><b>: </b><span>a ∈ foldr set_union [] ss
↔ (<span class="kr">∃</span> <span class="nv">x</span> : <span class="nb">set</span> A, x ∈ ss ∧ a ∈ x)</span></span></span><br><span><var>x</var><span class="hyp-type"><b>: </b><span><span class="nb">set</span> A</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>x ∈ ss</span></span></span><br><span><var>Ha</var><span class="hyp-type"><b>: </b><span>a ∈ x</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">a ∈ a0 ∨ a ∈ foldr set_union [] ss</div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="ListSetExtras-v-chk60" style="display: none" type="checkbox"><label class="alectryon-input" for="ListSetExtras-v-chk60"><span class="nb">right</span>.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>A</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>EqDecision0</var><span class="hyp-type"><b>: </b><span>EqDecision A</span></span></span><br><span><var>a0</var><span class="hyp-type"><b>: </b><span><span class="nb">set</span> A</span></span></span><br><span><var>ss</var><span class="hyp-type"><b>: </b><span>list (<span class="nb">set</span> A)</span></span></span><br><span><var>a</var><span class="hyp-type"><b>: </b><span>A</span></span></span><br><span><var>IHss</var><span class="hyp-type"><b>: </b><span>a ∈ foldr set_union [] ss
↔ (<span class="kr">∃</span> <span class="nv">x</span> : <span class="nb">set</span> A, x ∈ ss ∧ a ∈ x)</span></span></span><br><span><var>x</var><span class="hyp-type"><b>: </b><span><span class="nb">set</span> A</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>x ∈ ss</span></span></span><br><span><var>Ha</var><span class="hyp-type"><b>: </b><span>a ∈ x</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">a ∈ foldr set_union [] ss</div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="ListSetExtras-v-chk61" style="display: none" type="checkbox"><label class="alectryon-input" for="ListSetExtras-v-chk61"><span class="nb">apply</span> IHss.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>A</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>EqDecision0</var><span class="hyp-type"><b>: </b><span>EqDecision A</span></span></span><br><span><var>a0</var><span class="hyp-type"><b>: </b><span><span class="nb">set</span> A</span></span></span><br><span><var>ss</var><span class="hyp-type"><b>: </b><span>list (<span class="nb">set</span> A)</span></span></span><br><span><var>a</var><span class="hyp-type"><b>: </b><span>A</span></span></span><br><span><var>IHss</var><span class="hyp-type"><b>: </b><span>a ∈ foldr set_union [] ss
↔ (<span class="kr">∃</span> <span class="nv">x</span> : <span class="nb">set</span> A, x ∈ ss ∧ a ∈ x)</span></span></span><br><span><var>x</var><span class="hyp-type"><b>: </b><span><span class="nb">set</span> A</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>x ∈ ss</span></span></span><br><span><var>Ha</var><span class="hyp-type"><b>: </b><span>a ∈ x</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="kr">∃</span> <span class="nv">x</span> : <span class="nb">set</span> A, x ∈ ss ∧ a ∈ x</div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="bp">by</span> <span class="kr">exists</span> <span class="nv">x</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Qed</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
</span><span class="alectryon-sentence"><input class="alectryon-toggle" id="ListSetExtras-v-chk62" style="display: none" type="checkbox"><label class="alectryon-input" for="ListSetExtras-v-chk62"><span class="kn">Lemma</span> <span class="nf">set_union_iterated_subseteq</span>
  `{EqDecision A}
  (ss ss&#39;: list (<span class="nb">set</span> A))
  (Hincl : ss ⊆ ss&#39;) :
  (fold_right set_union [] ss) ⊆
  (fold_right set_union [] ss&#39;).</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>A</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>EqDecision0</var><span class="hyp-type"><b>: </b><span>EqDecision A</span></span></span><br><span><var>ss, ss'</var><span class="hyp-type"><b>: </b><span>list (<span class="nb">set</span> A)</span></span></span><br><span><var>Hincl</var><span class="hyp-type"><b>: </b><span>ss ⊆ ss&#39;</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">foldr set_union [] ss ⊆ foldr set_union [] ss&#39;</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="ListSetExtras-v-chk63" style="display: none" type="checkbox"><label class="alectryon-input" for="ListSetExtras-v-chk63"><span class="kn">Proof</span>.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>A</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>EqDecision0</var><span class="hyp-type"><b>: </b><span>EqDecision A</span></span></span><br><span><var>ss, ss'</var><span class="hyp-type"><b>: </b><span>list (<span class="nb">set</span> A)</span></span></span><br><span><var>Hincl</var><span class="hyp-type"><b>: </b><span>ss ⊆ ss&#39;</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">foldr set_union [] ss ⊆ foldr set_union [] ss&#39;</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="ListSetExtras-v-chk64" style="display: none" type="checkbox"><label class="alectryon-input" for="ListSetExtras-v-chk64"><span class="nb">intros</span> a H.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>A</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>EqDecision0</var><span class="hyp-type"><b>: </b><span>EqDecision A</span></span></span><br><span><var>ss, ss'</var><span class="hyp-type"><b>: </b><span>list (<span class="nb">set</span> A)</span></span></span><br><span><var>Hincl</var><span class="hyp-type"><b>: </b><span>ss ⊆ ss&#39;</span></span></span><br><span><var>a</var><span class="hyp-type"><b>: </b><span>A</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>a ∈ foldr set_union [] ss</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">a ∈ foldr set_union [] ss&#39;</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="ListSetExtras-v-chk65" style="display: none" type="checkbox"><label class="alectryon-input" for="ListSetExtras-v-chk65"><span class="nb">apply</span> set_union_in_iterated <span class="kr">in</span> H.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>A</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>EqDecision0</var><span class="hyp-type"><b>: </b><span>EqDecision A</span></span></span><br><span><var>ss, ss'</var><span class="hyp-type"><b>: </b><span>list (<span class="nb">set</span> A)</span></span></span><br><span><var>Hincl</var><span class="hyp-type"><b>: </b><span>ss ⊆ ss&#39;</span></span></span><br><span><var>a</var><span class="hyp-type"><b>: </b><span>A</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>Exists (<span class="kr">λ</span> <span class="nv">s</span> : <span class="nb">set</span> A, a ∈ s) ss</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">a ∈ foldr set_union [] ss&#39;</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="ListSetExtras-v-chk66" style="display: none" type="checkbox"><label class="alectryon-input" for="ListSetExtras-v-chk66"><span class="nb">apply</span> set_union_in_iterated.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>A</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>EqDecision0</var><span class="hyp-type"><b>: </b><span>EqDecision A</span></span></span><br><span><var>ss, ss'</var><span class="hyp-type"><b>: </b><span>list (<span class="nb">set</span> A)</span></span></span><br><span><var>Hincl</var><span class="hyp-type"><b>: </b><span>ss ⊆ ss&#39;</span></span></span><br><span><var>a</var><span class="hyp-type"><b>: </b><span>A</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>Exists (<span class="kr">λ</span> <span class="nv">s</span> : <span class="nb">set</span> A, a ∈ s) ss</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">Exists (<span class="kr">λ</span> <span class="nv">s</span> : <span class="nb">set</span> A, a ∈ s) ss&#39;</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="ListSetExtras-v-chk67" style="display: none" type="checkbox"><label class="alectryon-input" for="ListSetExtras-v-chk67"><span class="nb">rewrite</span> Exists_exists <span class="kr">in</span> *.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>A</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>EqDecision0</var><span class="hyp-type"><b>: </b><span>EqDecision A</span></span></span><br><span><var>ss, ss'</var><span class="hyp-type"><b>: </b><span>list (<span class="nb">set</span> A)</span></span></span><br><span><var>Hincl</var><span class="hyp-type"><b>: </b><span>ss ⊆ ss&#39;</span></span></span><br><span><var>a</var><span class="hyp-type"><b>: </b><span>A</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span><span class="kr">∃</span> <span class="nv">x</span> : <span class="nb">set</span> A, x ∈ ss ∧ a ∈ x</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="kr">∃</span> <span class="nv">x</span> : <span class="nb">set</span> A, x ∈ ss&#39; ∧ a ∈ x</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="ListSetExtras-v-chk68" style="display: none" type="checkbox"><label class="alectryon-input" for="ListSetExtras-v-chk68"><span class="nb">destruct</span> H <span class="kr">as</span> [x [Hx Ha]].</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>A</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>EqDecision0</var><span class="hyp-type"><b>: </b><span>EqDecision A</span></span></span><br><span><var>ss, ss'</var><span class="hyp-type"><b>: </b><span>list (<span class="nb">set</span> A)</span></span></span><br><span><var>Hincl</var><span class="hyp-type"><b>: </b><span>ss ⊆ ss&#39;</span></span></span><br><span><var>a</var><span class="hyp-type"><b>: </b><span>A</span></span></span><br><span><var>x</var><span class="hyp-type"><b>: </b><span><span class="nb">set</span> A</span></span></span><br><span><var>Hx</var><span class="hyp-type"><b>: </b><span>x ∈ ss</span></span></span><br><span><var>Ha</var><span class="hyp-type"><b>: </b><span>a ∈ x</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="kr">∃</span> <span class="nv">x</span> : <span class="nb">set</span> A, x ∈ ss&#39; ∧ a ∈ x</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="ListSetExtras-v-chk69" style="display: none" type="checkbox"><label class="alectryon-input" for="ListSetExtras-v-chk69"><span class="kr">exists</span> <span class="nv">x</span>.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>A</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>EqDecision0</var><span class="hyp-type"><b>: </b><span>EqDecision A</span></span></span><br><span><var>ss, ss'</var><span class="hyp-type"><b>: </b><span>list (<span class="nb">set</span> A)</span></span></span><br><span><var>Hincl</var><span class="hyp-type"><b>: </b><span>ss ⊆ ss&#39;</span></span></span><br><span><var>a</var><span class="hyp-type"><b>: </b><span>A</span></span></span><br><span><var>x</var><span class="hyp-type"><b>: </b><span><span class="nb">set</span> A</span></span></span><br><span><var>Hx</var><span class="hyp-type"><b>: </b><span>x ∈ ss</span></span></span><br><span><var>Ha</var><span class="hyp-type"><b>: </b><span>a ∈ x</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">x ∈ ss&#39; ∧ a ∈ x</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="ListSetExtras-v-chk6a" style="display: none" type="checkbox"><label class="alectryon-input" for="ListSetExtras-v-chk6a"><span class="nb">unfold</span> incl <span class="kr">in</span> Hincl.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>A</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>EqDecision0</var><span class="hyp-type"><b>: </b><span>EqDecision A</span></span></span><br><span><var>ss, ss'</var><span class="hyp-type"><b>: </b><span>list (<span class="nb">set</span> A)</span></span></span><br><span><var>Hincl</var><span class="hyp-type"><b>: </b><span>ss ⊆ ss&#39;</span></span></span><br><span><var>a</var><span class="hyp-type"><b>: </b><span>A</span></span></span><br><span><var>x</var><span class="hyp-type"><b>: </b><span><span class="nb">set</span> A</span></span></span><br><span><var>Hx</var><span class="hyp-type"><b>: </b><span>x ∈ ss</span></span></span><br><span><var>Ha</var><span class="hyp-type"><b>: </b><span>a ∈ x</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">x ∈ ss&#39; ∧ a ∈ x</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="ListSetExtras-v-chk6b" style="display: none" type="checkbox"><label class="alectryon-input" for="ListSetExtras-v-chk6b"><span class="nb">split</span>; [| <span class="bp">done</span>].</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>A</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>EqDecision0</var><span class="hyp-type"><b>: </b><span>EqDecision A</span></span></span><br><span><var>ss, ss'</var><span class="hyp-type"><b>: </b><span>list (<span class="nb">set</span> A)</span></span></span><br><span><var>Hincl</var><span class="hyp-type"><b>: </b><span>ss ⊆ ss&#39;</span></span></span><br><span><var>a</var><span class="hyp-type"><b>: </b><span>A</span></span></span><br><span><var>x</var><span class="hyp-type"><b>: </b><span><span class="nb">set</span> A</span></span></span><br><span><var>Hx</var><span class="hyp-type"><b>: </b><span>x ∈ ss</span></span></span><br><span><var>Ha</var><span class="hyp-type"><b>: </b><span>a ∈ x</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">x ∈ ss&#39;</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><span class="alectryon-input"><span class="bp">by</span> <span class="nb">apply</span> Hincl.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Qed</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
</span><span class="alectryon-sentence"><input class="alectryon-toggle" id="ListSetExtras-v-chk6c" style="display: none" type="checkbox"><label class="alectryon-input" for="ListSetExtras-v-chk6c"><span class="kn">Lemma</span> <span class="nf">set_union_empty_left</span> `{EqDecision A}  : <span class="kr">forall</span> (<span class="nv">s</span> : list A),
  NoDup s -&gt; set_eq (set_union [] s) s.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>A</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>EqDecision0</var><span class="hyp-type"><b>: </b><span>EqDecision A</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="kr">∀</span> <span class="nv">s</span> : list A, NoDup s → set_eq (set_union [] s) s</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="ListSetExtras-v-chk6d" style="display: none" type="checkbox"><label class="alectryon-input" for="ListSetExtras-v-chk6d"><span class="kn">Proof</span>.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>A</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>EqDecision0</var><span class="hyp-type"><b>: </b><span>EqDecision A</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="kr">∀</span> <span class="nv">s</span> : list A, NoDup s → set_eq (set_union [] s) s</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="ListSetExtras-v-chk6e" style="display: none" type="checkbox"><label class="alectryon-input" for="ListSetExtras-v-chk6e"><span class="nb">intros</span>.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>A</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>EqDecision0</var><span class="hyp-type"><b>: </b><span>EqDecision A</span></span></span><br><span><var>s</var><span class="hyp-type"><b>: </b><span>list A</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>NoDup s</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">set_eq (set_union [] s) s</div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="ListSetExtras-v-chk6f" style="display: none" type="checkbox"><label class="alectryon-input" for="ListSetExtras-v-chk6f"><span class="nb">split</span>; <span class="nb">intros</span> x Hin.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>A</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>EqDecision0</var><span class="hyp-type"><b>: </b><span>EqDecision A</span></span></span><br><span><var>s</var><span class="hyp-type"><b>: </b><span>list A</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>NoDup s</span></span></span><br><span><var>x</var><span class="hyp-type"><b>: </b><span>A</span></span></span><br><span><var>Hin</var><span class="hyp-type"><b>: </b><span>x ∈ set_union [] s</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">x ∈ s</div></blockquote><div class="alectryon-extra-goals"><input class="alectryon-extra-goal-toggle" id="ListSetExtras-v-chk70" style="display: none" type="checkbox"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>A</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>EqDecision0</var><span class="hyp-type"><b>: </b><span>EqDecision A</span></span></span><br><span><var>s</var><span class="hyp-type"><b>: </b><span>list A</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>NoDup s</span></span></span><br><span><var>x</var><span class="hyp-type"><b>: </b><span>A</span></span></span><br><span><var>Hin</var><span class="hyp-type"><b>: </b><span>x ∈ s</span></span></span><br></div><label class="goal-separator" for="ListSetExtras-v-chk70"><hr></label><div class="goal-conclusion">x ∈ set_union [] s</div></blockquote></div></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="ListSetExtras-v-chk71" style="display: none" type="checkbox"><label class="alectryon-input" for="ListSetExtras-v-chk71">-</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>A</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>EqDecision0</var><span class="hyp-type"><b>: </b><span>EqDecision A</span></span></span><br><span><var>s</var><span class="hyp-type"><b>: </b><span>list A</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>NoDup s</span></span></span><br><span><var>x</var><span class="hyp-type"><b>: </b><span>A</span></span></span><br><span><var>Hin</var><span class="hyp-type"><b>: </b><span>x ∈ set_union [] s</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">x ∈ s</div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="ListSetExtras-v-chk72" style="display: none" type="checkbox"><label class="alectryon-input" for="ListSetExtras-v-chk72"><span class="nb">apply</span> set_union_elim <span class="kr">in</span> Hin.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>A</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>EqDecision0</var><span class="hyp-type"><b>: </b><span>EqDecision A</span></span></span><br><span><var>s</var><span class="hyp-type"><b>: </b><span>list A</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>NoDup s</span></span></span><br><span><var>x</var><span class="hyp-type"><b>: </b><span>A</span></span></span><br><span><var>Hin</var><span class="hyp-type"><b>: </b><span>x ∈ [] ∨ x ∈ s</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">x ∈ s</div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="ListSetExtras-v-chk73" style="display: none" type="checkbox"><label class="alectryon-input" for="ListSetExtras-v-chk73"><span class="nb">destruct</span> Hin.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>A</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>EqDecision0</var><span class="hyp-type"><b>: </b><span>EqDecision A</span></span></span><br><span><var>s</var><span class="hyp-type"><b>: </b><span>list A</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>NoDup s</span></span></span><br><span><var>x</var><span class="hyp-type"><b>: </b><span>A</span></span></span><br><span><var>H0</var><span class="hyp-type"><b>: </b><span>x ∈ []</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">x ∈ s</div></blockquote><div class="alectryon-extra-goals"><input class="alectryon-extra-goal-toggle" id="ListSetExtras-v-chk74" style="display: none" type="checkbox"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>A</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>EqDecision0</var><span class="hyp-type"><b>: </b><span>EqDecision A</span></span></span><br><span><var>s</var><span class="hyp-type"><b>: </b><span>list A</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>NoDup s</span></span></span><br><span><var>x</var><span class="hyp-type"><b>: </b><span>A</span></span></span><br><span><var>H0</var><span class="hyp-type"><b>: </b><span>x ∈ s</span></span></span><br></div><label class="goal-separator" for="ListSetExtras-v-chk74"><hr></label><div class="goal-conclusion">x ∈ s</div></blockquote></div></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="ListSetExtras-v-chk75" style="display: none" type="checkbox"><label class="alectryon-input" for="ListSetExtras-v-chk75">+</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>A</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>EqDecision0</var><span class="hyp-type"><b>: </b><span>EqDecision A</span></span></span><br><span><var>s</var><span class="hyp-type"><b>: </b><span>list A</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>NoDup s</span></span></span><br><span><var>x</var><span class="hyp-type"><b>: </b><span>A</span></span></span><br><span><var>H0</var><span class="hyp-type"><b>: </b><span>x ∈ []</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">x ∈ s</div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="nb">inversion</span> H0.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="ListSetExtras-v-chk76" style="display: none" type="checkbox"><label class="alectryon-input" for="ListSetExtras-v-chk76">+</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>A</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>EqDecision0</var><span class="hyp-type"><b>: </b><span>EqDecision A</span></span></span><br><span><var>s</var><span class="hyp-type"><b>: </b><span>list A</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>NoDup s</span></span></span><br><span><var>x</var><span class="hyp-type"><b>: </b><span>A</span></span></span><br><span><var>H0</var><span class="hyp-type"><b>: </b><span>x ∈ s</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">x ∈ s</div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="bp">done</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="ListSetExtras-v-chk77" style="display: none" type="checkbox"><label class="alectryon-input" for="ListSetExtras-v-chk77">-</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>A</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>EqDecision0</var><span class="hyp-type"><b>: </b><span>EqDecision A</span></span></span><br><span><var>s</var><span class="hyp-type"><b>: </b><span>list A</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>NoDup s</span></span></span><br><span><var>x</var><span class="hyp-type"><b>: </b><span>A</span></span></span><br><span><var>Hin</var><span class="hyp-type"><b>: </b><span>x ∈ s</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">x ∈ set_union [] s</div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="bp">by</span> <span class="nb">apply</span> set_union_intro; <span class="nb">right</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Qed</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
</span><span class="alectryon-sentence"><input class="alectryon-toggle" id="ListSetExtras-v-chk78" style="display: none" type="checkbox"><label class="alectryon-input" for="ListSetExtras-v-chk78"><span class="kn">Lemma</span> <span class="nf">map_list_subseteq</span> {<span class="nv">A</span> <span class="nv">B</span>} : <span class="kr">forall</span> (<span class="nv">f</span> : B -&gt; A) (<span class="nv">s</span> <span class="nv">s&#39;</span> : list B),
  s ⊆ s&#39; -&gt; (map f s) ⊆ (map f s&#39;).</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>A, B</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="kr">∀</span> (<span class="nv">f</span> : B → A) (<span class="nv">s</span> <span class="nv">s&#39;</span> : list B),
  s ⊆ s&#39; → map f s ⊆ map f s&#39;</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="ListSetExtras-v-chk79" style="display: none" type="checkbox"><label class="alectryon-input" for="ListSetExtras-v-chk79"><span class="kn">Proof</span>.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>A, B</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="kr">∀</span> (<span class="nv">f</span> : B → A) (<span class="nv">s</span> <span class="nv">s&#39;</span> : list B),
  s ⊆ s&#39; → map f s ⊆ map f s&#39;</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="ListSetExtras-v-chk7a" style="display: none" type="checkbox"><label class="alectryon-input" for="ListSetExtras-v-chk7a"><span class="nb">intro</span> f; <span class="nb">induction</span> s; <span class="nb">intros</span>; <span class="nb">simpl</span>.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>A, B</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>f</var><span class="hyp-type"><b>: </b><span>B → A</span></span></span><br><span><var>s'</var><span class="hyp-type"><b>: </b><span>list B</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>[] ⊆ s&#39;</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">[] ⊆ map f s&#39;</div></blockquote><div class="alectryon-extra-goals"><input class="alectryon-extra-goal-toggle" id="ListSetExtras-v-chk7b" style="display: none" type="checkbox"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>A, B</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>f</var><span class="hyp-type"><b>: </b><span>B → A</span></span></span><br><span><var>a</var><span class="hyp-type"><b>: </b><span>B</span></span></span><br><span><var>s</var><span class="hyp-type"><b>: </b><span>list B</span></span></span><br><span><var>IHs</var><span class="hyp-type"><b>: </b><span><span class="kr">∀</span> <span class="nv">s&#39;</span> : list B, s ⊆ s&#39; → map f s ⊆ map f s&#39;</span></span></span><br><span><var>s'</var><span class="hyp-type"><b>: </b><span>list B</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>a :: s ⊆ s&#39;</span></span></span><br></div><label class="goal-separator" for="ListSetExtras-v-chk7b"><hr></label><div class="goal-conclusion">f a :: map f s ⊆ map f s&#39;</div></blockquote></div></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="ListSetExtras-v-chk7c" style="display: none" type="checkbox"><label class="alectryon-input" for="ListSetExtras-v-chk7c">-</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>A, B</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>f</var><span class="hyp-type"><b>: </b><span>B → A</span></span></span><br><span><var>s'</var><span class="hyp-type"><b>: </b><span>list B</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>[] ⊆ s&#39;</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">[] ⊆ map f s&#39;</div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="nb">apply</span> list_subseteq_nil.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="ListSetExtras-v-chk7d" style="display: none" type="checkbox"><label class="alectryon-input" for="ListSetExtras-v-chk7d">-</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>A, B</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>f</var><span class="hyp-type"><b>: </b><span>B → A</span></span></span><br><span><var>a</var><span class="hyp-type"><b>: </b><span>B</span></span></span><br><span><var>s</var><span class="hyp-type"><b>: </b><span>list B</span></span></span><br><span><var>IHs</var><span class="hyp-type"><b>: </b><span><span class="kr">∀</span> <span class="nv">s&#39;</span> : list B, s ⊆ s&#39; → map f s ⊆ map f s&#39;</span></span></span><br><span><var>s'</var><span class="hyp-type"><b>: </b><span>list B</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>a :: s ⊆ s&#39;</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">f a :: map f s ⊆ map f s&#39;</div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="ListSetExtras-v-chk7e" style="display: none" type="checkbox"><label class="alectryon-input" for="ListSetExtras-v-chk7e"><span class="nb">assert</span> (s ⊆ s&#39;) <span class="kr">as</span> Hs.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>A, B</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>f</var><span class="hyp-type"><b>: </b><span>B → A</span></span></span><br><span><var>a</var><span class="hyp-type"><b>: </b><span>B</span></span></span><br><span><var>s</var><span class="hyp-type"><b>: </b><span>list B</span></span></span><br><span><var>IHs</var><span class="hyp-type"><b>: </b><span><span class="kr">∀</span> <span class="nv">s&#39;</span> : list B, s ⊆ s&#39; → map f s ⊆ map f s&#39;</span></span></span><br><span><var>s'</var><span class="hyp-type"><b>: </b><span>list B</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>a :: s ⊆ s&#39;</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">s ⊆ s&#39;</div></blockquote><div class="alectryon-extra-goals"><input class="alectryon-extra-goal-toggle" id="ListSetExtras-v-chk7f" style="display: none" type="checkbox"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>A, B</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>f</var><span class="hyp-type"><b>: </b><span>B → A</span></span></span><br><span><var>a</var><span class="hyp-type"><b>: </b><span>B</span></span></span><br><span><var>s</var><span class="hyp-type"><b>: </b><span>list B</span></span></span><br><span><var>IHs</var><span class="hyp-type"><b>: </b><span><span class="kr">∀</span> <span class="nv">s&#39;</span> : list B, s ⊆ s&#39; → map f s ⊆ map f s&#39;</span></span></span><br><span><var>s'</var><span class="hyp-type"><b>: </b><span>list B</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>a :: s ⊆ s&#39;</span></span></span><br><span><var>Hs</var><span class="hyp-type"><b>: </b><span>s ⊆ s&#39;</span></span></span><br></div><label class="goal-separator" for="ListSetExtras-v-chk7f"><hr></label><div class="goal-conclusion">f a :: map f s ⊆ map f s&#39;</div></blockquote></div></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="ListSetExtras-v-chk80" style="display: none" type="checkbox"><label class="alectryon-input" for="ListSetExtras-v-chk80">{</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>A, B</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>f</var><span class="hyp-type"><b>: </b><span>B → A</span></span></span><br><span><var>a</var><span class="hyp-type"><b>: </b><span>B</span></span></span><br><span><var>s</var><span class="hyp-type"><b>: </b><span>list B</span></span></span><br><span><var>IHs</var><span class="hyp-type"><b>: </b><span><span class="kr">∀</span> <span class="nv">s&#39;</span> : list B, s ⊆ s&#39; → map f s ⊆ map f s&#39;</span></span></span><br><span><var>s'</var><span class="hyp-type"><b>: </b><span>list B</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>a :: s ⊆ s&#39;</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">s ⊆ s&#39;</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="ListSetExtras-v-chk81" style="display: none" type="checkbox"><label class="alectryon-input" for="ListSetExtras-v-chk81"><span class="nb">intros</span> b Hs.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>A, B</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>f</var><span class="hyp-type"><b>: </b><span>B → A</span></span></span><br><span><var>a</var><span class="hyp-type"><b>: </b><span>B</span></span></span><br><span><var>s</var><span class="hyp-type"><b>: </b><span>list B</span></span></span><br><span><var>IHs</var><span class="hyp-type"><b>: </b><span><span class="kr">∀</span> <span class="nv">s&#39;</span> : list B, s ⊆ s&#39; → map f s ⊆ map f s&#39;</span></span></span><br><span><var>s'</var><span class="hyp-type"><b>: </b><span>list B</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>a :: s ⊆ s&#39;</span></span></span><br><span><var>b</var><span class="hyp-type"><b>: </b><span>B</span></span></span><br><span><var>Hs</var><span class="hyp-type"><b>: </b><span>b ∈ s</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">b ∈ s&#39;</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><span class="alectryon-input"><span class="bp">by</span> <span class="nb">apply</span> H; <span class="nb">right</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="ListSetExtras-v-chk82" style="display: none" type="checkbox"><label class="alectryon-input" for="ListSetExtras-v-chk82">}</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>A, B</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>f</var><span class="hyp-type"><b>: </b><span>B → A</span></span></span><br><span><var>a</var><span class="hyp-type"><b>: </b><span>B</span></span></span><br><span><var>s</var><span class="hyp-type"><b>: </b><span>list B</span></span></span><br><span><var>IHs</var><span class="hyp-type"><b>: </b><span><span class="kr">∀</span> <span class="nv">s&#39;</span> : list B, s ⊆ s&#39; → map f s ⊆ map f s&#39;</span></span></span><br><span><var>s'</var><span class="hyp-type"><b>: </b><span>list B</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>a :: s ⊆ s&#39;</span></span></span><br><span><var>Hs</var><span class="hyp-type"><b>: </b><span>s ⊆ s&#39;</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">f a :: map f s ⊆ map f s&#39;</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="ListSetExtras-v-chk83" style="display: none" type="checkbox"><label class="alectryon-input" for="ListSetExtras-v-chk83">spec IHs s&#39; Hs.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>A, B</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>f</var><span class="hyp-type"><b>: </b><span>B → A</span></span></span><br><span><var>a</var><span class="hyp-type"><b>: </b><span>B</span></span></span><br><span><var>s, s'</var><span class="hyp-type"><b>: </b><span>list B</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>a :: s ⊆ s&#39;</span></span></span><br><span><var>Hs</var><span class="hyp-type"><b>: </b><span>s ⊆ s&#39;</span></span></span><br><span><var>IHs</var><span class="hyp-type"><b>: </b><span>map f s ⊆ map f s&#39;</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">f a :: map f s ⊆ map f s&#39;</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="ListSetExtras-v-chk84" style="display: none" type="checkbox"><label class="alectryon-input" for="ListSetExtras-v-chk84"><span class="nb">intros</span> b Hs&#39;.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>A, B</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>f</var><span class="hyp-type"><b>: </b><span>B → A</span></span></span><br><span><var>a</var><span class="hyp-type"><b>: </b><span>B</span></span></span><br><span><var>s, s'</var><span class="hyp-type"><b>: </b><span>list B</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>a :: s ⊆ s&#39;</span></span></span><br><span><var>Hs</var><span class="hyp-type"><b>: </b><span>s ⊆ s&#39;</span></span></span><br><span><var>IHs</var><span class="hyp-type"><b>: </b><span>map f s ⊆ map f s&#39;</span></span></span><br><span><var>b</var><span class="hyp-type"><b>: </b><span>A</span></span></span><br><span><var>Hs'</var><span class="hyp-type"><b>: </b><span>b ∈ f a :: map f s</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">b ∈ map f s&#39;</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="ListSetExtras-v-chk85" style="display: none" type="checkbox"><label class="alectryon-input" for="ListSetExtras-v-chk85"><span class="nb">apply</span> elem_of_cons <span class="kr">in</span> Hs&#39;.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>A, B</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>f</var><span class="hyp-type"><b>: </b><span>B → A</span></span></span><br><span><var>a</var><span class="hyp-type"><b>: </b><span>B</span></span></span><br><span><var>s, s'</var><span class="hyp-type"><b>: </b><span>list B</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>a :: s ⊆ s&#39;</span></span></span><br><span><var>Hs</var><span class="hyp-type"><b>: </b><span>s ⊆ s&#39;</span></span></span><br><span><var>IHs</var><span class="hyp-type"><b>: </b><span>map f s ⊆ map f s&#39;</span></span></span><br><span><var>b</var><span class="hyp-type"><b>: </b><span>A</span></span></span><br><span><var>Hs'</var><span class="hyp-type"><b>: </b><span>b = f a ∨ b ∈ map f s</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">b ∈ map f s&#39;</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="ListSetExtras-v-chk86" style="display: none" type="checkbox"><label class="alectryon-input" for="ListSetExtras-v-chk86"><span class="nb">destruct</span> Hs&#39;.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>A, B</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>f</var><span class="hyp-type"><b>: </b><span>B → A</span></span></span><br><span><var>a</var><span class="hyp-type"><b>: </b><span>B</span></span></span><br><span><var>s, s'</var><span class="hyp-type"><b>: </b><span>list B</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>a :: s ⊆ s&#39;</span></span></span><br><span><var>Hs</var><span class="hyp-type"><b>: </b><span>s ⊆ s&#39;</span></span></span><br><span><var>IHs</var><span class="hyp-type"><b>: </b><span>map f s ⊆ map f s&#39;</span></span></span><br><span><var>b</var><span class="hyp-type"><b>: </b><span>A</span></span></span><br><span><var>H0</var><span class="hyp-type"><b>: </b><span>b = f a</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">b ∈ map f s&#39;</div></blockquote><div class="alectryon-extra-goals"><input class="alectryon-extra-goal-toggle" id="ListSetExtras-v-chk87" style="display: none" type="checkbox"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>A, B</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>f</var><span class="hyp-type"><b>: </b><span>B → A</span></span></span><br><span><var>a</var><span class="hyp-type"><b>: </b><span>B</span></span></span><br><span><var>s, s'</var><span class="hyp-type"><b>: </b><span>list B</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>a :: s ⊆ s&#39;</span></span></span><br><span><var>Hs</var><span class="hyp-type"><b>: </b><span>s ⊆ s&#39;</span></span></span><br><span><var>IHs</var><span class="hyp-type"><b>: </b><span>map f s ⊆ map f s&#39;</span></span></span><br><span><var>b</var><span class="hyp-type"><b>: </b><span>A</span></span></span><br><span><var>H0</var><span class="hyp-type"><b>: </b><span>b ∈ map f s</span></span></span><br></div><label class="goal-separator" for="ListSetExtras-v-chk87"><hr></label><div class="goal-conclusion">b ∈ map f s&#39;</div></blockquote></div></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="ListSetExtras-v-chk88" style="display: none" type="checkbox"><label class="alectryon-input" for="ListSetExtras-v-chk88">*</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>A, B</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>f</var><span class="hyp-type"><b>: </b><span>B → A</span></span></span><br><span><var>a</var><span class="hyp-type"><b>: </b><span>B</span></span></span><br><span><var>s, s'</var><span class="hyp-type"><b>: </b><span>list B</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>a :: s ⊆ s&#39;</span></span></span><br><span><var>Hs</var><span class="hyp-type"><b>: </b><span>s ⊆ s&#39;</span></span></span><br><span><var>IHs</var><span class="hyp-type"><b>: </b><span>map f s ⊆ map f s&#39;</span></span></span><br><span><var>b</var><span class="hyp-type"><b>: </b><span>A</span></span></span><br><span><var>H0</var><span class="hyp-type"><b>: </b><span>b = f a</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">b ∈ map f s&#39;</div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="ListSetExtras-v-chk89" style="display: none" type="checkbox"><label class="alectryon-input" for="ListSetExtras-v-chk89"><span class="nb">subst</span>.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>A, B</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>f</var><span class="hyp-type"><b>: </b><span>B → A</span></span></span><br><span><var>a</var><span class="hyp-type"><b>: </b><span>B</span></span></span><br><span><var>s, s'</var><span class="hyp-type"><b>: </b><span>list B</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>a :: s ⊆ s&#39;</span></span></span><br><span><var>Hs</var><span class="hyp-type"><b>: </b><span>s ⊆ s&#39;</span></span></span><br><span><var>IHs</var><span class="hyp-type"><b>: </b><span>map f s ⊆ map f s&#39;</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">f a ∈ map f s&#39;</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="ListSetExtras-v-chk8a" style="display: none" type="checkbox"><label class="alectryon-input" for="ListSetExtras-v-chk8a"><span class="nb">apply</span> elem_of_list_fmap_1.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>A, B</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>f</var><span class="hyp-type"><b>: </b><span>B → A</span></span></span><br><span><var>a</var><span class="hyp-type"><b>: </b><span>B</span></span></span><br><span><var>s, s'</var><span class="hyp-type"><b>: </b><span>list B</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>a :: s ⊆ s&#39;</span></span></span><br><span><var>Hs</var><span class="hyp-type"><b>: </b><span>s ⊆ s&#39;</span></span></span><br><span><var>IHs</var><span class="hyp-type"><b>: </b><span>map f s ⊆ map f s&#39;</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">a ∈ s&#39;</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="ListSetExtras-v-chk8b" style="display: none" type="checkbox"><label class="alectryon-input" for="ListSetExtras-v-chk8b"><span class="nb">apply</span> H.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>A, B</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>f</var><span class="hyp-type"><b>: </b><span>B → A</span></span></span><br><span><var>a</var><span class="hyp-type"><b>: </b><span>B</span></span></span><br><span><var>s, s'</var><span class="hyp-type"><b>: </b><span>list B</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>a :: s ⊆ s&#39;</span></span></span><br><span><var>Hs</var><span class="hyp-type"><b>: </b><span>s ⊆ s&#39;</span></span></span><br><span><var>IHs</var><span class="hyp-type"><b>: </b><span>map f s ⊆ map f s&#39;</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">a ∈ a :: s</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><span class="alectryon-input"><span class="nb">left</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="ListSetExtras-v-chk8c" style="display: none" type="checkbox"><label class="alectryon-input" for="ListSetExtras-v-chk8c">*</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>A, B</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>f</var><span class="hyp-type"><b>: </b><span>B → A</span></span></span><br><span><var>a</var><span class="hyp-type"><b>: </b><span>B</span></span></span><br><span><var>s, s'</var><span class="hyp-type"><b>: </b><span>list B</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>a :: s ⊆ s&#39;</span></span></span><br><span><var>Hs</var><span class="hyp-type"><b>: </b><span>s ⊆ s&#39;</span></span></span><br><span><var>IHs</var><span class="hyp-type"><b>: </b><span>map f s ⊆ map f s&#39;</span></span></span><br><span><var>b</var><span class="hyp-type"><b>: </b><span>A</span></span></span><br><span><var>H0</var><span class="hyp-type"><b>: </b><span>b ∈ map f s</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">b ∈ map f s&#39;</div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="bp">by</span> <span class="nb">apply</span> IHs.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Qed</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
</span><span class="alectryon-sentence"><input class="alectryon-toggle" id="ListSetExtras-v-chk8d" style="display: none" type="checkbox"><label class="alectryon-input" for="ListSetExtras-v-chk8d"><span class="kn">Lemma</span> <span class="nf">map_set_eq</span> {<span class="nv">A</span> <span class="nv">B</span>} (<span class="nv">f</span> : B -&gt; A) : <span class="kr">forall</span> <span class="nv">s</span> <span class="nv">s&#39;</span>,
  set_eq s s&#39; -&gt;
  set_eq (map f s) (map f s&#39;).</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>A, B</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>f</var><span class="hyp-type"><b>: </b><span>B → A</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="kr">∀</span> <span class="nv">s</span> <span class="nv">s&#39;</span> : <span class="nb">set</span> B,
  set_eq s s&#39; → set_eq (map f s) (map f s&#39;)</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="ListSetExtras-v-chk8e" style="display: none" type="checkbox"><label class="alectryon-input" for="ListSetExtras-v-chk8e"><span class="kn">Proof</span>.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>A, B</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>f</var><span class="hyp-type"><b>: </b><span>B → A</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="kr">∀</span> <span class="nv">s</span> <span class="nv">s&#39;</span> : <span class="nb">set</span> B,
  set_eq s s&#39; → set_eq (map f s) (map f s&#39;)</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><span class="alectryon-input"><span class="nb">split</span>; <span class="nb">apply</span> map_list_subseteq; <span class="nb">apply</span> H.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Qed</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
</span><span class="alectryon-sentence"><input class="alectryon-toggle" id="ListSetExtras-v-chk8f" style="display: none" type="checkbox"><label class="alectryon-input" for="ListSetExtras-v-chk8f"><span class="kn">Lemma</span> <span class="nf">set_map_nodup</span> {<span class="nv">A</span> <span class="nv">B</span>} `{EqDecision A} (f : B -&gt; A) : <span class="kr">forall</span> (<span class="nv">s</span> : <span class="nb">set</span> B),
  NoDup (set_map f s).</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>A, B</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>EqDecision0</var><span class="hyp-type"><b>: </b><span>EqDecision A</span></span></span><br><span><var>f</var><span class="hyp-type"><b>: </b><span>B → A</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="kr">∀</span> <span class="nv">s</span> : <span class="nb">set</span> B, NoDup (set_map f s)</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="ListSetExtras-v-chk90" style="display: none" type="checkbox"><label class="alectryon-input" for="ListSetExtras-v-chk90"><span class="kn">Proof</span>.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>A, B</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>EqDecision0</var><span class="hyp-type"><b>: </b><span>EqDecision A</span></span></span><br><span><var>f</var><span class="hyp-type"><b>: </b><span>B → A</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="kr">∀</span> <span class="nv">s</span> : <span class="nb">set</span> B, NoDup (set_map f s)</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="ListSetExtras-v-chk91" style="display: none" type="checkbox"><label class="alectryon-input" for="ListSetExtras-v-chk91"><span class="nb">induction</span> s; <span class="nb">simpl</span>; <span class="kp">try</span> <span class="nb">constructor</span>.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>A, B</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>EqDecision0</var><span class="hyp-type"><b>: </b><span>EqDecision A</span></span></span><br><span><var>f</var><span class="hyp-type"><b>: </b><span>B → A</span></span></span><br><span><var>a</var><span class="hyp-type"><b>: </b><span>B</span></span></span><br><span><var>s</var><span class="hyp-type"><b>: </b><span>list B</span></span></span><br><span><var>IHs</var><span class="hyp-type"><b>: </b><span>NoDup (set_map f s)</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">NoDup (set_add (f a) (set_map f s))</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><span class="alectryon-input"><span class="bp">by</span> <span class="nb">apply</span> set_add_nodup.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Qed</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
</span><span class="alectryon-sentence"><input class="alectryon-toggle" id="ListSetExtras-v-chk92" style="display: none" type="checkbox"><label class="alectryon-input" for="ListSetExtras-v-chk92"><span class="kn">Lemma</span> <span class="nf">set_map_elem_of</span> {<span class="nv">A</span> <span class="nv">B</span>} `{EqDecision A} (f : B -&gt; A) : <span class="kr">forall</span> <span class="nv">x</span> <span class="nv">s</span>,
  x ∈ s -&gt;
  (f x) ∈ (set_map f s).</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>A, B</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>EqDecision0</var><span class="hyp-type"><b>: </b><span>EqDecision A</span></span></span><br><span><var>f</var><span class="hyp-type"><b>: </b><span>B → A</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="kr">∀</span> (<span class="nv">x</span> : B) (<span class="nv">s</span> : <span class="nb">set</span> B), x ∈ s → f x ∈ set_map f s</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="ListSetExtras-v-chk93" style="display: none" type="checkbox"><label class="alectryon-input" for="ListSetExtras-v-chk93"><span class="kn">Proof</span>.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>A, B</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>EqDecision0</var><span class="hyp-type"><b>: </b><span>EqDecision A</span></span></span><br><span><var>f</var><span class="hyp-type"><b>: </b><span>B → A</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="kr">∀</span> (<span class="nv">x</span> : B) (<span class="nv">s</span> : <span class="nb">set</span> B), x ∈ s → f x ∈ set_map f s</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="ListSetExtras-v-chk94" style="display: none" type="checkbox"><label class="alectryon-input" for="ListSetExtras-v-chk94"><span class="nb">induction</span> s; <span class="nb">intros</span>; <span class="nb">inversion</span> H; <span class="nb">subst</span>; <span class="nb">clear</span> H; <span class="nb">simpl</span>.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>A, B</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>EqDecision0</var><span class="hyp-type"><b>: </b><span>EqDecision A</span></span></span><br><span><var>f</var><span class="hyp-type"><b>: </b><span>B → A</span></span></span><br><span><var>a</var><span class="hyp-type"><b>: </b><span>B</span></span></span><br><span><var>s</var><span class="hyp-type"><b>: </b><span>list B</span></span></span><br><span><var>IHs</var><span class="hyp-type"><b>: </b><span>a ∈ s → f a ∈ set_map f s</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">f a ∈ set_add (f a) (set_map f s)</div></blockquote><div class="alectryon-extra-goals"><input class="alectryon-extra-goal-toggle" id="ListSetExtras-v-chk95" style="display: none" type="checkbox"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>A, B</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>EqDecision0</var><span class="hyp-type"><b>: </b><span>EqDecision A</span></span></span><br><span><var>f</var><span class="hyp-type"><b>: </b><span>B → A</span></span></span><br><span><var>x, a</var><span class="hyp-type"><b>: </b><span>B</span></span></span><br><span><var>s</var><span class="hyp-type"><b>: </b><span>list B</span></span></span><br><span><var>IHs</var><span class="hyp-type"><b>: </b><span>x ∈ s → f x ∈ set_map f s</span></span></span><br><span><var>H2</var><span class="hyp-type"><b>: </b><span>x ∈ s</span></span></span><br></div><label class="goal-separator" for="ListSetExtras-v-chk95"><hr></label><div class="goal-conclusion">f x ∈ set_add (f a) (set_map f s)</div></blockquote></div></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="ListSetExtras-v-chk96" style="display: none" type="checkbox"><label class="alectryon-input" for="ListSetExtras-v-chk96">-</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>A, B</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>EqDecision0</var><span class="hyp-type"><b>: </b><span>EqDecision A</span></span></span><br><span><var>f</var><span class="hyp-type"><b>: </b><span>B → A</span></span></span><br><span><var>a</var><span class="hyp-type"><b>: </b><span>B</span></span></span><br><span><var>s</var><span class="hyp-type"><b>: </b><span>list B</span></span></span><br><span><var>IHs</var><span class="hyp-type"><b>: </b><span>a ∈ s → f a ∈ set_map f s</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">f a ∈ set_add (f a) (set_map f s)</div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="bp">by</span> <span class="nb">apply</span> set_add_intro2.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="ListSetExtras-v-chk97" style="display: none" type="checkbox"><label class="alectryon-input" for="ListSetExtras-v-chk97">-</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>A, B</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>EqDecision0</var><span class="hyp-type"><b>: </b><span>EqDecision A</span></span></span><br><span><var>f</var><span class="hyp-type"><b>: </b><span>B → A</span></span></span><br><span><var>x, a</var><span class="hyp-type"><b>: </b><span>B</span></span></span><br><span><var>s</var><span class="hyp-type"><b>: </b><span>list B</span></span></span><br><span><var>IHs</var><span class="hyp-type"><b>: </b><span>x ∈ s → f x ∈ set_map f s</span></span></span><br><span><var>H2</var><span class="hyp-type"><b>: </b><span>x ∈ s</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">f x ∈ set_add (f a) (set_map f s)</div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="bp">by</span> <span class="nb">apply</span> set_add_intro1, IHs.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Qed</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
</span><span class="alectryon-sentence"><input class="alectryon-toggle" id="ListSetExtras-v-chk98" style="display: none" type="checkbox"><label class="alectryon-input" for="ListSetExtras-v-chk98"><span class="kn">Lemma</span> <span class="nf">set_map_exists</span> {<span class="nv">A</span> <span class="nv">B</span>} `{EqDecision A} (f : B -&gt; A) : <span class="kr">forall</span> <span class="nv">y</span> <span class="nv">s</span>,
  y ∈ (set_map f s) &lt;-&gt;
  <span class="kr">exists</span> <span class="nv">x</span>, x ∈ s /\ f x = y.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>A, B</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>EqDecision0</var><span class="hyp-type"><b>: </b><span>EqDecision A</span></span></span><br><span><var>f</var><span class="hyp-type"><b>: </b><span>B → A</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="kr">∀</span> (<span class="nv">y</span> : A) (<span class="nv">s</span> : <span class="nb">set</span> B),
  y ∈ set_map f s ↔ (<span class="kr">∃</span> <span class="nv">x</span> : B, x ∈ s ∧ f x = y)</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="ListSetExtras-v-chk99" style="display: none" type="checkbox"><label class="alectryon-input" for="ListSetExtras-v-chk99"><span class="kn">Proof</span>.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>A, B</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>EqDecision0</var><span class="hyp-type"><b>: </b><span>EqDecision A</span></span></span><br><span><var>f</var><span class="hyp-type"><b>: </b><span>B → A</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="kr">∀</span> (<span class="nv">y</span> : A) (<span class="nv">s</span> : <span class="nb">set</span> B),
  y ∈ set_map f s ↔ (<span class="kr">∃</span> <span class="nv">x</span> : B, x ∈ s ∧ f x = y)</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="ListSetExtras-v-chk9a" style="display: none" type="checkbox"><label class="alectryon-input" for="ListSetExtras-v-chk9a"><span class="nb">intros</span>.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>A, B</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>EqDecision0</var><span class="hyp-type"><b>: </b><span>EqDecision A</span></span></span><br><span><var>f</var><span class="hyp-type"><b>: </b><span>B → A</span></span></span><br><span><var>y</var><span class="hyp-type"><b>: </b><span>A</span></span></span><br><span><var>s</var><span class="hyp-type"><b>: </b><span><span class="nb">set</span> B</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">y ∈ set_map f s ↔ (<span class="kr">∃</span> <span class="nv">x</span> : B, x ∈ s ∧ f x = y)</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="ListSetExtras-v-chk9b" style="display: none" type="checkbox"><label class="alectryon-input" for="ListSetExtras-v-chk9b"><span class="nb">induction</span> s; <span class="nb">split</span>; <span class="nb">intros</span>; <span class="nb">simpl</span> <span class="kr">in</span> H.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>A, B</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>EqDecision0</var><span class="hyp-type"><b>: </b><span>EqDecision A</span></span></span><br><span><var>f</var><span class="hyp-type"><b>: </b><span>B → A</span></span></span><br><span><var>y</var><span class="hyp-type"><b>: </b><span>A</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>y ∈ empty_set</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="kr">∃</span> <span class="nv">x</span> : B, x ∈ [] ∧ f x = y</div></blockquote><div class="alectryon-extra-goals"><input class="alectryon-extra-goal-toggle" id="ListSetExtras-v-chk9c" style="display: none" type="checkbox"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>A, B</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>EqDecision0</var><span class="hyp-type"><b>: </b><span>EqDecision A</span></span></span><br><span><var>f</var><span class="hyp-type"><b>: </b><span>B → A</span></span></span><br><span><var>y</var><span class="hyp-type"><b>: </b><span>A</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span><span class="kr">∃</span> <span class="nv">x</span> : B, x ∈ [] ∧ f x = y</span></span></span><br></div><label class="goal-separator" for="ListSetExtras-v-chk9c"><hr></label><div class="goal-conclusion">y ∈ set_map f []</div></blockquote><input class="alectryon-extra-goal-toggle" id="ListSetExtras-v-chk9d" style="display: none" type="checkbox"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>A, B</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>EqDecision0</var><span class="hyp-type"><b>: </b><span>EqDecision A</span></span></span><br><span><var>f</var><span class="hyp-type"><b>: </b><span>B → A</span></span></span><br><span><var>y</var><span class="hyp-type"><b>: </b><span>A</span></span></span><br><span><var>a</var><span class="hyp-type"><b>: </b><span>B</span></span></span><br><span><var>s</var><span class="hyp-type"><b>: </b><span>list B</span></span></span><br><span><var>IHs</var><span class="hyp-type"><b>: </b><span>y ∈ set_map f s ↔ (<span class="kr">∃</span> <span class="nv">x</span> : B, x ∈ s ∧ f x = y)</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>y ∈ set_add (f a) (set_map f s)</span></span></span><br></div><label class="goal-separator" for="ListSetExtras-v-chk9d"><hr></label><div class="goal-conclusion"><span class="kr">∃</span> <span class="nv">x</span> : B, x ∈ a :: s ∧ f x = y</div></blockquote><input class="alectryon-extra-goal-toggle" id="ListSetExtras-v-chk9e" style="display: none" type="checkbox"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>A, B</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>EqDecision0</var><span class="hyp-type"><b>: </b><span>EqDecision A</span></span></span><br><span><var>f</var><span class="hyp-type"><b>: </b><span>B → A</span></span></span><br><span><var>y</var><span class="hyp-type"><b>: </b><span>A</span></span></span><br><span><var>a</var><span class="hyp-type"><b>: </b><span>B</span></span></span><br><span><var>s</var><span class="hyp-type"><b>: </b><span>list B</span></span></span><br><span><var>IHs</var><span class="hyp-type"><b>: </b><span>y ∈ set_map f s ↔ (<span class="kr">∃</span> <span class="nv">x</span> : B, x ∈ s ∧ f x = y)</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span><span class="kr">∃</span> <span class="nv">x</span> : B, x ∈ a :: s ∧ f x = y</span></span></span><br></div><label class="goal-separator" for="ListSetExtras-v-chk9e"><hr></label><div class="goal-conclusion">y ∈ set_map f (a :: s)</div></blockquote></div></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="ListSetExtras-v-chk9f" style="display: none" type="checkbox"><label class="alectryon-input" for="ListSetExtras-v-chk9f">-</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>A, B</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>EqDecision0</var><span class="hyp-type"><b>: </b><span>EqDecision A</span></span></span><br><span><var>f</var><span class="hyp-type"><b>: </b><span>B → A</span></span></span><br><span><var>y</var><span class="hyp-type"><b>: </b><span>A</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>y ∈ empty_set</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="kr">∃</span> <span class="nv">x</span> : B, x ∈ [] ∧ f x = y</div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="nb">inversion</span> H.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="ListSetExtras-v-chka0" style="display: none" type="checkbox"><label class="alectryon-input" for="ListSetExtras-v-chka0">-</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>A, B</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>EqDecision0</var><span class="hyp-type"><b>: </b><span>EqDecision A</span></span></span><br><span><var>f</var><span class="hyp-type"><b>: </b><span>B → A</span></span></span><br><span><var>y</var><span class="hyp-type"><b>: </b><span>A</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span><span class="kr">∃</span> <span class="nv">x</span> : B, x ∈ [] ∧ f x = y</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">y ∈ set_map f []</div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="ListSetExtras-v-chka1" style="display: none" type="checkbox"><label class="alectryon-input" for="ListSetExtras-v-chka1"><span class="nb">destruct</span> H <span class="kr">as</span> [x [Hx Hf]].</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>A, B</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>EqDecision0</var><span class="hyp-type"><b>: </b><span>EqDecision A</span></span></span><br><span><var>f</var><span class="hyp-type"><b>: </b><span>B → A</span></span></span><br><span><var>y</var><span class="hyp-type"><b>: </b><span>A</span></span></span><br><span><var>x</var><span class="hyp-type"><b>: </b><span>B</span></span></span><br><span><var>Hx</var><span class="hyp-type"><b>: </b><span>x ∈ []</span></span></span><br><span><var>Hf</var><span class="hyp-type"><b>: </b><span>f x = y</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">y ∈ set_map f []</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><span class="alectryon-input"><span class="nb">inversion</span> Hx.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="ListSetExtras-v-chka2" style="display: none" type="checkbox"><label class="alectryon-input" for="ListSetExtras-v-chka2">-</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>A, B</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>EqDecision0</var><span class="hyp-type"><b>: </b><span>EqDecision A</span></span></span><br><span><var>f</var><span class="hyp-type"><b>: </b><span>B → A</span></span></span><br><span><var>y</var><span class="hyp-type"><b>: </b><span>A</span></span></span><br><span><var>a</var><span class="hyp-type"><b>: </b><span>B</span></span></span><br><span><var>s</var><span class="hyp-type"><b>: </b><span>list B</span></span></span><br><span><var>IHs</var><span class="hyp-type"><b>: </b><span>y ∈ set_map f s ↔ (<span class="kr">∃</span> <span class="nv">x</span> : B, x ∈ s ∧ f x = y)</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>y ∈ set_add (f a) (set_map f s)</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="kr">∃</span> <span class="nv">x</span> : B, x ∈ a :: s ∧ f x = y</div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="ListSetExtras-v-chka3" style="display: none" type="checkbox"><label class="alectryon-input" for="ListSetExtras-v-chka3"><span class="nb">apply</span> set_add_iff <span class="kr">in</span> H.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>A, B</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>EqDecision0</var><span class="hyp-type"><b>: </b><span>EqDecision A</span></span></span><br><span><var>f</var><span class="hyp-type"><b>: </b><span>B → A</span></span></span><br><span><var>y</var><span class="hyp-type"><b>: </b><span>A</span></span></span><br><span><var>a</var><span class="hyp-type"><b>: </b><span>B</span></span></span><br><span><var>s</var><span class="hyp-type"><b>: </b><span>list B</span></span></span><br><span><var>IHs</var><span class="hyp-type"><b>: </b><span>y ∈ set_map f s ↔ (<span class="kr">∃</span> <span class="nv">x</span> : B, x ∈ s ∧ f x = y)</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>y = f a ∨ y ∈ set_map f s</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="kr">∃</span> <span class="nv">x</span> : B, x ∈ a :: s ∧ f x = y</div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="ListSetExtras-v-chka4" style="display: none" type="checkbox"><label class="alectryon-input" for="ListSetExtras-v-chka4"><span class="nb">destruct</span> H <span class="kr">as</span> [Heq | Hin]; <span class="nb">subst</span>.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>A, B</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>EqDecision0</var><span class="hyp-type"><b>: </b><span>EqDecision A</span></span></span><br><span><var>f</var><span class="hyp-type"><b>: </b><span>B → A</span></span></span><br><span><var>a</var><span class="hyp-type"><b>: </b><span>B</span></span></span><br><span><var>s</var><span class="hyp-type"><b>: </b><span>list B</span></span></span><br><span><var>IHs</var><span class="hyp-type"><b>: </b><span>f a ∈ set_map f s ↔ (<span class="kr">∃</span> <span class="nv">x</span> : B, x ∈ s ∧ f x = f a)</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="kr">∃</span> <span class="nv">x</span> : B, x ∈ a :: s ∧ f x = f a</div></blockquote><div class="alectryon-extra-goals"><input class="alectryon-extra-goal-toggle" id="ListSetExtras-v-chka5" style="display: none" type="checkbox"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>A, B</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>EqDecision0</var><span class="hyp-type"><b>: </b><span>EqDecision A</span></span></span><br><span><var>f</var><span class="hyp-type"><b>: </b><span>B → A</span></span></span><br><span><var>y</var><span class="hyp-type"><b>: </b><span>A</span></span></span><br><span><var>a</var><span class="hyp-type"><b>: </b><span>B</span></span></span><br><span><var>s</var><span class="hyp-type"><b>: </b><span>list B</span></span></span><br><span><var>IHs</var><span class="hyp-type"><b>: </b><span>y ∈ set_map f s ↔ (<span class="kr">∃</span> <span class="nv">x</span> : B, x ∈ s ∧ f x = y)</span></span></span><br><span><var>Hin</var><span class="hyp-type"><b>: </b><span>y ∈ set_map f s</span></span></span><br></div><label class="goal-separator" for="ListSetExtras-v-chka5"><hr></label><div class="goal-conclusion"><span class="kr">∃</span> <span class="nv">x</span> : B, x ∈ a :: s ∧ f x = y</div></blockquote></div></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="ListSetExtras-v-chka6" style="display: none" type="checkbox"><label class="alectryon-input" for="ListSetExtras-v-chka6">+</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>A, B</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>EqDecision0</var><span class="hyp-type"><b>: </b><span>EqDecision A</span></span></span><br><span><var>f</var><span class="hyp-type"><b>: </b><span>B → A</span></span></span><br><span><var>a</var><span class="hyp-type"><b>: </b><span>B</span></span></span><br><span><var>s</var><span class="hyp-type"><b>: </b><span>list B</span></span></span><br><span><var>IHs</var><span class="hyp-type"><b>: </b><span>f a ∈ set_map f s ↔ (<span class="kr">∃</span> <span class="nv">x</span> : B, x ∈ s ∧ f x = f a)</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="kr">∃</span> <span class="nv">x</span> : B, x ∈ a :: s ∧ f x = f a</div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="ListSetExtras-v-chka7" style="display: none" type="checkbox"><label class="alectryon-input" for="ListSetExtras-v-chka7"><span class="kr">exists</span> <span class="nv">a</span>.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>A, B</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>EqDecision0</var><span class="hyp-type"><b>: </b><span>EqDecision A</span></span></span><br><span><var>f</var><span class="hyp-type"><b>: </b><span>B → A</span></span></span><br><span><var>a</var><span class="hyp-type"><b>: </b><span>B</span></span></span><br><span><var>s</var><span class="hyp-type"><b>: </b><span>list B</span></span></span><br><span><var>IHs</var><span class="hyp-type"><b>: </b><span>f a ∈ set_map f s ↔ (<span class="kr">∃</span> <span class="nv">x</span> : B, x ∈ s ∧ f x = f a)</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">a ∈ a :: s ∧ f a = f a</div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="bp">by</span> <span class="nb">split</span>; [<span class="nb">left</span> |].</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="ListSetExtras-v-chka8" style="display: none" type="checkbox"><label class="alectryon-input" for="ListSetExtras-v-chka8">+</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>A, B</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>EqDecision0</var><span class="hyp-type"><b>: </b><span>EqDecision A</span></span></span><br><span><var>f</var><span class="hyp-type"><b>: </b><span>B → A</span></span></span><br><span><var>y</var><span class="hyp-type"><b>: </b><span>A</span></span></span><br><span><var>a</var><span class="hyp-type"><b>: </b><span>B</span></span></span><br><span><var>s</var><span class="hyp-type"><b>: </b><span>list B</span></span></span><br><span><var>IHs</var><span class="hyp-type"><b>: </b><span>y ∈ set_map f s ↔ (<span class="kr">∃</span> <span class="nv">x</span> : B, x ∈ s ∧ f x = y)</span></span></span><br><span><var>Hin</var><span class="hyp-type"><b>: </b><span>y ∈ set_map f s</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="kr">∃</span> <span class="nv">x</span> : B, x ∈ a :: s ∧ f x = y</div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="ListSetExtras-v-chka9" style="display: none" type="checkbox"><label class="alectryon-input" for="ListSetExtras-v-chka9"><span class="nb">apply</span> IHs <span class="kr">in</span> Hin.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>A, B</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>EqDecision0</var><span class="hyp-type"><b>: </b><span>EqDecision A</span></span></span><br><span><var>f</var><span class="hyp-type"><b>: </b><span>B → A</span></span></span><br><span><var>y</var><span class="hyp-type"><b>: </b><span>A</span></span></span><br><span><var>a</var><span class="hyp-type"><b>: </b><span>B</span></span></span><br><span><var>s</var><span class="hyp-type"><b>: </b><span>list B</span></span></span><br><span><var>IHs</var><span class="hyp-type"><b>: </b><span>y ∈ set_map f s ↔ (<span class="kr">∃</span> <span class="nv">x</span> : B, x ∈ s ∧ f x = y)</span></span></span><br><span><var>Hin</var><span class="hyp-type"><b>: </b><span><span class="kr">∃</span> <span class="nv">x</span> : B, x ∈ s ∧ f x = y</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="kr">∃</span> <span class="nv">x</span> : B, x ∈ a :: s ∧ f x = y</div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="ListSetExtras-v-chkaa" style="display: none" type="checkbox"><label class="alectryon-input" for="ListSetExtras-v-chkaa"><span class="nb">destruct</span> Hin <span class="kr">as</span> [x [Hin Heq]]; <span class="nb">subst</span>.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>A, B</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>EqDecision0</var><span class="hyp-type"><b>: </b><span>EqDecision A</span></span></span><br><span><var>f</var><span class="hyp-type"><b>: </b><span>B → A</span></span></span><br><span><var>a</var><span class="hyp-type"><b>: </b><span>B</span></span></span><br><span><var>s</var><span class="hyp-type"><b>: </b><span>list B</span></span></span><br><span><var>x</var><span class="hyp-type"><b>: </b><span>B</span></span></span><br><span><var>IHs</var><span class="hyp-type"><b>: </b><span>f x ∈ set_map f s
↔ (<span class="kr">∃</span> <span class="nv">x0</span> : B, x0 ∈ s ∧ f x0 = f x)</span></span></span><br><span><var>Hin</var><span class="hyp-type"><b>: </b><span>x ∈ s</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="kr">∃</span> <span class="nv">x0</span> : B, x0 ∈ a :: s ∧ f x0 = f x</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">      </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="ListSetExtras-v-chkab" style="display: none" type="checkbox"><label class="alectryon-input" for="ListSetExtras-v-chkab"><span class="kr">exists</span> <span class="nv">x</span>.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>A, B</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>EqDecision0</var><span class="hyp-type"><b>: </b><span>EqDecision A</span></span></span><br><span><var>f</var><span class="hyp-type"><b>: </b><span>B → A</span></span></span><br><span><var>a</var><span class="hyp-type"><b>: </b><span>B</span></span></span><br><span><var>s</var><span class="hyp-type"><b>: </b><span>list B</span></span></span><br><span><var>x</var><span class="hyp-type"><b>: </b><span>B</span></span></span><br><span><var>IHs</var><span class="hyp-type"><b>: </b><span>f x ∈ set_map f s
↔ (<span class="kr">∃</span> <span class="nv">x0</span> : B, x0 ∈ s ∧ f x0 = f x)</span></span></span><br><span><var>Hin</var><span class="hyp-type"><b>: </b><span>x ∈ s</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">x ∈ a :: s ∧ f x = f x</div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="bp">by</span> <span class="nb">split</span>; [<span class="nb">right</span> |].</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="ListSetExtras-v-chkac" style="display: none" type="checkbox"><label class="alectryon-input" for="ListSetExtras-v-chkac">-</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>A, B</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>EqDecision0</var><span class="hyp-type"><b>: </b><span>EqDecision A</span></span></span><br><span><var>f</var><span class="hyp-type"><b>: </b><span>B → A</span></span></span><br><span><var>y</var><span class="hyp-type"><b>: </b><span>A</span></span></span><br><span><var>a</var><span class="hyp-type"><b>: </b><span>B</span></span></span><br><span><var>s</var><span class="hyp-type"><b>: </b><span>list B</span></span></span><br><span><var>IHs</var><span class="hyp-type"><b>: </b><span>y ∈ set_map f s ↔ (<span class="kr">∃</span> <span class="nv">x</span> : B, x ∈ s ∧ f x = y)</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span><span class="kr">∃</span> <span class="nv">x</span> : B, x ∈ a :: s ∧ f x = y</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">y ∈ set_map f (a :: s)</div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="ListSetExtras-v-chkad" style="display: none" type="checkbox"><label class="alectryon-input" for="ListSetExtras-v-chkad"><span class="nb">simpl</span>.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>A, B</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>EqDecision0</var><span class="hyp-type"><b>: </b><span>EqDecision A</span></span></span><br><span><var>f</var><span class="hyp-type"><b>: </b><span>B → A</span></span></span><br><span><var>y</var><span class="hyp-type"><b>: </b><span>A</span></span></span><br><span><var>a</var><span class="hyp-type"><b>: </b><span>B</span></span></span><br><span><var>s</var><span class="hyp-type"><b>: </b><span>list B</span></span></span><br><span><var>IHs</var><span class="hyp-type"><b>: </b><span>y ∈ set_map f s ↔ (<span class="kr">∃</span> <span class="nv">x</span> : B, x ∈ s ∧ f x = y)</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span><span class="kr">∃</span> <span class="nv">x</span> : B, x ∈ a :: s ∧ f x = y</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">y ∈ set_add (f a) (set_map f s)</div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="ListSetExtras-v-chkae" style="display: none" type="checkbox"><label class="alectryon-input" for="ListSetExtras-v-chkae"><span class="nb">destruct</span> H <span class="kr">as</span> [x [Hx Hf]]; <span class="nb">subst</span>; <span class="nb">simpl</span>; <span class="nb">apply</span> set_add_iff.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>A, B</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>EqDecision0</var><span class="hyp-type"><b>: </b><span>EqDecision A</span></span></span><br><span><var>f</var><span class="hyp-type"><b>: </b><span>B → A</span></span></span><br><span><var>a</var><span class="hyp-type"><b>: </b><span>B</span></span></span><br><span><var>s</var><span class="hyp-type"><b>: </b><span>list B</span></span></span><br><span><var>x</var><span class="hyp-type"><b>: </b><span>B</span></span></span><br><span><var>IHs</var><span class="hyp-type"><b>: </b><span>f x ∈ set_map f s
↔ (<span class="kr">∃</span> <span class="nv">x0</span> : B, x0 ∈ s ∧ f x0 = f x)</span></span></span><br><span><var>Hx</var><span class="hyp-type"><b>: </b><span>x ∈ a :: s</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">f x = f a ∨ f x ∈ set_map f s</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="ListSetExtras-v-chkaf" style="display: none" type="checkbox"><label class="alectryon-input" for="ListSetExtras-v-chkaf"><span class="nb">apply</span> elem_of_cons <span class="kr">in</span> Hx.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>A, B</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>EqDecision0</var><span class="hyp-type"><b>: </b><span>EqDecision A</span></span></span><br><span><var>f</var><span class="hyp-type"><b>: </b><span>B → A</span></span></span><br><span><var>a</var><span class="hyp-type"><b>: </b><span>B</span></span></span><br><span><var>s</var><span class="hyp-type"><b>: </b><span>list B</span></span></span><br><span><var>x</var><span class="hyp-type"><b>: </b><span>B</span></span></span><br><span><var>IHs</var><span class="hyp-type"><b>: </b><span>f x ∈ set_map f s
↔ (<span class="kr">∃</span> <span class="nv">x0</span> : B, x0 ∈ s ∧ f x0 = f x)</span></span></span><br><span><var>Hx</var><span class="hyp-type"><b>: </b><span>x = a ∨ x ∈ s</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">f x = f a ∨ f x ∈ set_map f s</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="ListSetExtras-v-chkb0" style="display: none" type="checkbox"><label class="alectryon-input" for="ListSetExtras-v-chkb0"><span class="nb">destruct</span> Hx.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>A, B</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>EqDecision0</var><span class="hyp-type"><b>: </b><span>EqDecision A</span></span></span><br><span><var>f</var><span class="hyp-type"><b>: </b><span>B → A</span></span></span><br><span><var>a</var><span class="hyp-type"><b>: </b><span>B</span></span></span><br><span><var>s</var><span class="hyp-type"><b>: </b><span>list B</span></span></span><br><span><var>x</var><span class="hyp-type"><b>: </b><span>B</span></span></span><br><span><var>IHs</var><span class="hyp-type"><b>: </b><span>f x ∈ set_map f s
↔ (<span class="kr">∃</span> <span class="nv">x0</span> : B, x0 ∈ s ∧ f x0 = f x)</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>x = a</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">f x = f a ∨ f x ∈ set_map f s</div></blockquote><div class="alectryon-extra-goals"><input class="alectryon-extra-goal-toggle" id="ListSetExtras-v-chkb1" style="display: none" type="checkbox"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>A, B</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>EqDecision0</var><span class="hyp-type"><b>: </b><span>EqDecision A</span></span></span><br><span><var>f</var><span class="hyp-type"><b>: </b><span>B → A</span></span></span><br><span><var>a</var><span class="hyp-type"><b>: </b><span>B</span></span></span><br><span><var>s</var><span class="hyp-type"><b>: </b><span>list B</span></span></span><br><span><var>x</var><span class="hyp-type"><b>: </b><span>B</span></span></span><br><span><var>IHs</var><span class="hyp-type"><b>: </b><span>f x ∈ set_map f s
↔ (<span class="kr">∃</span> <span class="nv">x0</span> : B, x0 ∈ s ∧ f x0 = f x)</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>x ∈ s</span></span></span><br></div><label class="goal-separator" for="ListSetExtras-v-chkb1"><hr></label><div class="goal-conclusion">f x = f a ∨ f x ∈ set_map f s</div></blockquote></div></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="ListSetExtras-v-chkb2" style="display: none" type="checkbox"><label class="alectryon-input" for="ListSetExtras-v-chkb2">+</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>A, B</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>EqDecision0</var><span class="hyp-type"><b>: </b><span>EqDecision A</span></span></span><br><span><var>f</var><span class="hyp-type"><b>: </b><span>B → A</span></span></span><br><span><var>a</var><span class="hyp-type"><b>: </b><span>B</span></span></span><br><span><var>s</var><span class="hyp-type"><b>: </b><span>list B</span></span></span><br><span><var>x</var><span class="hyp-type"><b>: </b><span>B</span></span></span><br><span><var>IHs</var><span class="hyp-type"><b>: </b><span>f x ∈ set_map f s
↔ (<span class="kr">∃</span> <span class="nv">x0</span> : B, x0 ∈ s ∧ f x0 = f x)</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>x = a</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">f x = f a ∨ f x ∈ set_map f s</div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="bp">by</span> <span class="nb">subst</span>; <span class="nb">left</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="ListSetExtras-v-chkb3" style="display: none" type="checkbox"><label class="alectryon-input" for="ListSetExtras-v-chkb3">+</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>A, B</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>EqDecision0</var><span class="hyp-type"><b>: </b><span>EqDecision A</span></span></span><br><span><var>f</var><span class="hyp-type"><b>: </b><span>B → A</span></span></span><br><span><var>a</var><span class="hyp-type"><b>: </b><span>B</span></span></span><br><span><var>s</var><span class="hyp-type"><b>: </b><span>list B</span></span></span><br><span><var>x</var><span class="hyp-type"><b>: </b><span>B</span></span></span><br><span><var>IHs</var><span class="hyp-type"><b>: </b><span>f x ∈ set_map f s
↔ (<span class="kr">∃</span> <span class="nv">x0</span> : B, x0 ∈ s ∧ f x0 = f x)</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>x ∈ s</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">f x = f a ∨ f x ∈ set_map f s</div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="bp">by</span> <span class="nb">right</span>; <span class="nb">apply</span> IHs; <span class="kr">exists</span> <span class="nv">x</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Qed</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
</span><span class="alectryon-sentence"><input class="alectryon-toggle" id="ListSetExtras-v-chkb4" style="display: none" type="checkbox"><label class="alectryon-input" for="ListSetExtras-v-chkb4"><span class="kn">Lemma</span> <span class="nf">set_map_subseteq</span> {<span class="nv">A</span> <span class="nv">B</span>} `{EqDecision A} (f : B -&gt; A) : <span class="kr">forall</span> <span class="nv">s</span> <span class="nv">s&#39;</span>,
  s ⊆ s&#39; -&gt;
  (set_map f s) ⊆ (set_map f s&#39;).</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>A, B</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>EqDecision0</var><span class="hyp-type"><b>: </b><span>EqDecision A</span></span></span><br><span><var>f</var><span class="hyp-type"><b>: </b><span>B → A</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="kr">∀</span> <span class="nv">s</span> <span class="nv">s&#39;</span> : <span class="nb">set</span> B, s ⊆ s&#39; → set_map f s ⊆ set_map f s&#39;</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="ListSetExtras-v-chkb5" style="display: none" type="checkbox"><label class="alectryon-input" for="ListSetExtras-v-chkb5"><span class="kn">Proof</span>.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>A, B</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>EqDecision0</var><span class="hyp-type"><b>: </b><span>EqDecision A</span></span></span><br><span><var>f</var><span class="hyp-type"><b>: </b><span>B → A</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="kr">∀</span> <span class="nv">s</span> <span class="nv">s&#39;</span> : <span class="nb">set</span> B, s ⊆ s&#39; → set_map f s ⊆ set_map f s&#39;</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="ListSetExtras-v-chkb6" style="display: none" type="checkbox"><label class="alectryon-input" for="ListSetExtras-v-chkb6"><span class="nb">induction</span> s; <span class="nb">intros</span>; <span class="nb">intro</span> msg; <span class="nb">intros</span>.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>A, B</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>EqDecision0</var><span class="hyp-type"><b>: </b><span>EqDecision A</span></span></span><br><span><var>f</var><span class="hyp-type"><b>: </b><span>B → A</span></span></span><br><span><var>s'</var><span class="hyp-type"><b>: </b><span><span class="nb">set</span> B</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>[] ⊆ s&#39;</span></span></span><br><span><var>msg</var><span class="hyp-type"><b>: </b><span>A</span></span></span><br><span><var>H0</var><span class="hyp-type"><b>: </b><span>msg ∈ set_map f []</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">msg ∈ set_map f s&#39;</div></blockquote><div class="alectryon-extra-goals"><input class="alectryon-extra-goal-toggle" id="ListSetExtras-v-chkb7" style="display: none" type="checkbox"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>A, B</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>EqDecision0</var><span class="hyp-type"><b>: </b><span>EqDecision A</span></span></span><br><span><var>f</var><span class="hyp-type"><b>: </b><span>B → A</span></span></span><br><span><var>a</var><span class="hyp-type"><b>: </b><span>B</span></span></span><br><span><var>s</var><span class="hyp-type"><b>: </b><span>list B</span></span></span><br><span><var>IHs</var><span class="hyp-type"><b>: </b><span><span class="kr">∀</span> <span class="nv">s&#39;</span> : <span class="nb">set</span> B,
  s ⊆ s&#39; → set_map f s ⊆ set_map f s&#39;</span></span></span><br><span><var>s'</var><span class="hyp-type"><b>: </b><span><span class="nb">set</span> B</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>a :: s ⊆ s&#39;</span></span></span><br><span><var>msg</var><span class="hyp-type"><b>: </b><span>A</span></span></span><br><span><var>H0</var><span class="hyp-type"><b>: </b><span>msg ∈ set_map f (a :: s)</span></span></span><br></div><label class="goal-separator" for="ListSetExtras-v-chkb7"><hr></label><div class="goal-conclusion">msg ∈ set_map f s&#39;</div></blockquote></div></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="ListSetExtras-v-chkb8" style="display: none" type="checkbox"><label class="alectryon-input" for="ListSetExtras-v-chkb8">-</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>A, B</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>EqDecision0</var><span class="hyp-type"><b>: </b><span>EqDecision A</span></span></span><br><span><var>f</var><span class="hyp-type"><b>: </b><span>B → A</span></span></span><br><span><var>s'</var><span class="hyp-type"><b>: </b><span><span class="nb">set</span> B</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>[] ⊆ s&#39;</span></span></span><br><span><var>msg</var><span class="hyp-type"><b>: </b><span>A</span></span></span><br><span><var>H0</var><span class="hyp-type"><b>: </b><span>msg ∈ set_map f []</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">msg ∈ set_map f s&#39;</div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="nb">inversion</span> H0.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="ListSetExtras-v-chkb9" style="display: none" type="checkbox"><label class="alectryon-input" for="ListSetExtras-v-chkb9">-</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>A, B</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>EqDecision0</var><span class="hyp-type"><b>: </b><span>EqDecision A</span></span></span><br><span><var>f</var><span class="hyp-type"><b>: </b><span>B → A</span></span></span><br><span><var>a</var><span class="hyp-type"><b>: </b><span>B</span></span></span><br><span><var>s</var><span class="hyp-type"><b>: </b><span>list B</span></span></span><br><span><var>IHs</var><span class="hyp-type"><b>: </b><span><span class="kr">∀</span> <span class="nv">s&#39;</span> : <span class="nb">set</span> B,
  s ⊆ s&#39; → set_map f s ⊆ set_map f s&#39;</span></span></span><br><span><var>s'</var><span class="hyp-type"><b>: </b><span><span class="nb">set</span> B</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>a :: s ⊆ s&#39;</span></span></span><br><span><var>msg</var><span class="hyp-type"><b>: </b><span>A</span></span></span><br><span><var>H0</var><span class="hyp-type"><b>: </b><span>msg ∈ set_map f (a :: s)</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">msg ∈ set_map f s&#39;</div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="ListSetExtras-v-chkba" style="display: none" type="checkbox"><label class="alectryon-input" for="ListSetExtras-v-chkba"><span class="nb">simpl</span> <span class="kr">in</span> H0.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>A, B</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>EqDecision0</var><span class="hyp-type"><b>: </b><span>EqDecision A</span></span></span><br><span><var>f</var><span class="hyp-type"><b>: </b><span>B → A</span></span></span><br><span><var>a</var><span class="hyp-type"><b>: </b><span>B</span></span></span><br><span><var>s</var><span class="hyp-type"><b>: </b><span>list B</span></span></span><br><span><var>IHs</var><span class="hyp-type"><b>: </b><span><span class="kr">∀</span> <span class="nv">s&#39;</span> : <span class="nb">set</span> B,
  s ⊆ s&#39; → set_map f s ⊆ set_map f s&#39;</span></span></span><br><span><var>s'</var><span class="hyp-type"><b>: </b><span><span class="nb">set</span> B</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>a :: s ⊆ s&#39;</span></span></span><br><span><var>msg</var><span class="hyp-type"><b>: </b><span>A</span></span></span><br><span><var>H0</var><span class="hyp-type"><b>: </b><span>msg ∈ set_add (f a) (set_map f s)</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">msg ∈ set_map f s&#39;</div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="ListSetExtras-v-chkbb" style="display: none" type="checkbox"><label class="alectryon-input" for="ListSetExtras-v-chkbb"><span class="nb">apply</span> set_add_elim <span class="kr">in</span> H0.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>A, B</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>EqDecision0</var><span class="hyp-type"><b>: </b><span>EqDecision A</span></span></span><br><span><var>f</var><span class="hyp-type"><b>: </b><span>B → A</span></span></span><br><span><var>a</var><span class="hyp-type"><b>: </b><span>B</span></span></span><br><span><var>s</var><span class="hyp-type"><b>: </b><span>list B</span></span></span><br><span><var>IHs</var><span class="hyp-type"><b>: </b><span><span class="kr">∀</span> <span class="nv">s&#39;</span> : <span class="nb">set</span> B,
  s ⊆ s&#39; → set_map f s ⊆ set_map f s&#39;</span></span></span><br><span><var>s'</var><span class="hyp-type"><b>: </b><span><span class="nb">set</span> B</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>a :: s ⊆ s&#39;</span></span></span><br><span><var>msg</var><span class="hyp-type"><b>: </b><span>A</span></span></span><br><span><var>H0</var><span class="hyp-type"><b>: </b><span>msg = f a ∨ msg ∈ set_map f s</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">msg ∈ set_map f s&#39;</div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="ListSetExtras-v-chkbc" style="display: none" type="checkbox"><label class="alectryon-input" for="ListSetExtras-v-chkbc"><span class="nb">destruct</span> H0.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>A, B</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>EqDecision0</var><span class="hyp-type"><b>: </b><span>EqDecision A</span></span></span><br><span><var>f</var><span class="hyp-type"><b>: </b><span>B → A</span></span></span><br><span><var>a</var><span class="hyp-type"><b>: </b><span>B</span></span></span><br><span><var>s</var><span class="hyp-type"><b>: </b><span>list B</span></span></span><br><span><var>IHs</var><span class="hyp-type"><b>: </b><span><span class="kr">∀</span> <span class="nv">s&#39;</span> : <span class="nb">set</span> B,
  s ⊆ s&#39; → set_map f s ⊆ set_map f s&#39;</span></span></span><br><span><var>s'</var><span class="hyp-type"><b>: </b><span><span class="nb">set</span> B</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>a :: s ⊆ s&#39;</span></span></span><br><span><var>msg</var><span class="hyp-type"><b>: </b><span>A</span></span></span><br><span><var>H0</var><span class="hyp-type"><b>: </b><span>msg = f a</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">msg ∈ set_map f s&#39;</div></blockquote><div class="alectryon-extra-goals"><input class="alectryon-extra-goal-toggle" id="ListSetExtras-v-chkbd" style="display: none" type="checkbox"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>A, B</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>EqDecision0</var><span class="hyp-type"><b>: </b><span>EqDecision A</span></span></span><br><span><var>f</var><span class="hyp-type"><b>: </b><span>B → A</span></span></span><br><span><var>a</var><span class="hyp-type"><b>: </b><span>B</span></span></span><br><span><var>s</var><span class="hyp-type"><b>: </b><span>list B</span></span></span><br><span><var>IHs</var><span class="hyp-type"><b>: </b><span><span class="kr">∀</span> <span class="nv">s&#39;</span> : <span class="nb">set</span> B,
  s ⊆ s&#39; → set_map f s ⊆ set_map f s&#39;</span></span></span><br><span><var>s'</var><span class="hyp-type"><b>: </b><span><span class="nb">set</span> B</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>a :: s ⊆ s&#39;</span></span></span><br><span><var>msg</var><span class="hyp-type"><b>: </b><span>A</span></span></span><br><span><var>H0</var><span class="hyp-type"><b>: </b><span>msg ∈ set_map f s</span></span></span><br></div><label class="goal-separator" for="ListSetExtras-v-chkbd"><hr></label><div class="goal-conclusion">msg ∈ set_map f s&#39;</div></blockquote></div></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="ListSetExtras-v-chkbe" style="display: none" type="checkbox"><label class="alectryon-input" for="ListSetExtras-v-chkbe">+</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>A, B</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>EqDecision0</var><span class="hyp-type"><b>: </b><span>EqDecision A</span></span></span><br><span><var>f</var><span class="hyp-type"><b>: </b><span>B → A</span></span></span><br><span><var>a</var><span class="hyp-type"><b>: </b><span>B</span></span></span><br><span><var>s</var><span class="hyp-type"><b>: </b><span>list B</span></span></span><br><span><var>IHs</var><span class="hyp-type"><b>: </b><span><span class="kr">∀</span> <span class="nv">s&#39;</span> : <span class="nb">set</span> B,
  s ⊆ s&#39; → set_map f s ⊆ set_map f s&#39;</span></span></span><br><span><var>s'</var><span class="hyp-type"><b>: </b><span><span class="nb">set</span> B</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>a :: s ⊆ s&#39;</span></span></span><br><span><var>msg</var><span class="hyp-type"><b>: </b><span>A</span></span></span><br><span><var>H0</var><span class="hyp-type"><b>: </b><span>msg = f a</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">msg ∈ set_map f s&#39;</div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="ListSetExtras-v-chkbf" style="display: none" type="checkbox"><label class="alectryon-input" for="ListSetExtras-v-chkbf"><span class="nb">subst</span>.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>A, B</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>EqDecision0</var><span class="hyp-type"><b>: </b><span>EqDecision A</span></span></span><br><span><var>f</var><span class="hyp-type"><b>: </b><span>B → A</span></span></span><br><span><var>a</var><span class="hyp-type"><b>: </b><span>B</span></span></span><br><span><var>s</var><span class="hyp-type"><b>: </b><span>list B</span></span></span><br><span><var>IHs</var><span class="hyp-type"><b>: </b><span><span class="kr">∀</span> <span class="nv">s&#39;</span> : <span class="nb">set</span> B,
  s ⊆ s&#39; → set_map f s ⊆ set_map f s&#39;</span></span></span><br><span><var>s'</var><span class="hyp-type"><b>: </b><span><span class="nb">set</span> B</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>a :: s ⊆ s&#39;</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">f a ∈ set_map f s&#39;</div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="ListSetExtras-v-chkc0" style="display: none" type="checkbox"><label class="alectryon-input" for="ListSetExtras-v-chkc0"><span class="nb">apply</span> set_map_elem_of.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>A, B</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>EqDecision0</var><span class="hyp-type"><b>: </b><span>EqDecision A</span></span></span><br><span><var>f</var><span class="hyp-type"><b>: </b><span>B → A</span></span></span><br><span><var>a</var><span class="hyp-type"><b>: </b><span>B</span></span></span><br><span><var>s</var><span class="hyp-type"><b>: </b><span>list B</span></span></span><br><span><var>IHs</var><span class="hyp-type"><b>: </b><span><span class="kr">∀</span> <span class="nv">s&#39;</span> : <span class="nb">set</span> B,
  s ⊆ s&#39; → set_map f s ⊆ set_map f s&#39;</span></span></span><br><span><var>s'</var><span class="hyp-type"><b>: </b><span><span class="nb">set</span> B</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>a :: s ⊆ s&#39;</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">a ∈ s&#39;</div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="ListSetExtras-v-chkc1" style="display: none" type="checkbox"><label class="alectryon-input" for="ListSetExtras-v-chkc1"><span class="nb">apply</span> H.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>A, B</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>EqDecision0</var><span class="hyp-type"><b>: </b><span>EqDecision A</span></span></span><br><span><var>f</var><span class="hyp-type"><b>: </b><span>B → A</span></span></span><br><span><var>a</var><span class="hyp-type"><b>: </b><span>B</span></span></span><br><span><var>s</var><span class="hyp-type"><b>: </b><span>list B</span></span></span><br><span><var>IHs</var><span class="hyp-type"><b>: </b><span><span class="kr">∀</span> <span class="nv">s&#39;</span> : <span class="nb">set</span> B,
  s ⊆ s&#39; → set_map f s ⊆ set_map f s&#39;</span></span></span><br><span><var>s'</var><span class="hyp-type"><b>: </b><span><span class="nb">set</span> B</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>a :: s ⊆ s&#39;</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">a ∈ a :: s</div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="nb">left</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="ListSetExtras-v-chkc2" style="display: none" type="checkbox"><label class="alectryon-input" for="ListSetExtras-v-chkc2">+</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>A, B</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>EqDecision0</var><span class="hyp-type"><b>: </b><span>EqDecision A</span></span></span><br><span><var>f</var><span class="hyp-type"><b>: </b><span>B → A</span></span></span><br><span><var>a</var><span class="hyp-type"><b>: </b><span>B</span></span></span><br><span><var>s</var><span class="hyp-type"><b>: </b><span>list B</span></span></span><br><span><var>IHs</var><span class="hyp-type"><b>: </b><span><span class="kr">∀</span> <span class="nv">s&#39;</span> : <span class="nb">set</span> B,
  s ⊆ s&#39; → set_map f s ⊆ set_map f s&#39;</span></span></span><br><span><var>s'</var><span class="hyp-type"><b>: </b><span><span class="nb">set</span> B</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>a :: s ⊆ s&#39;</span></span></span><br><span><var>msg</var><span class="hyp-type"><b>: </b><span>A</span></span></span><br><span><var>H0</var><span class="hyp-type"><b>: </b><span>msg ∈ set_map f s</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">msg ∈ set_map f s&#39;</div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="ListSetExtras-v-chkc3" style="display: none" type="checkbox"><label class="alectryon-input" for="ListSetExtras-v-chkc3"><span class="nb">apply</span> IHs; [| <span class="bp">done</span>].</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>A, B</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>EqDecision0</var><span class="hyp-type"><b>: </b><span>EqDecision A</span></span></span><br><span><var>f</var><span class="hyp-type"><b>: </b><span>B → A</span></span></span><br><span><var>a</var><span class="hyp-type"><b>: </b><span>B</span></span></span><br><span><var>s</var><span class="hyp-type"><b>: </b><span>list B</span></span></span><br><span><var>IHs</var><span class="hyp-type"><b>: </b><span><span class="kr">∀</span> <span class="nv">s&#39;</span> : <span class="nb">set</span> B,
  s ⊆ s&#39; → set_map f s ⊆ set_map f s&#39;</span></span></span><br><span><var>s'</var><span class="hyp-type"><b>: </b><span><span class="nb">set</span> B</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>a :: s ⊆ s&#39;</span></span></span><br><span><var>msg</var><span class="hyp-type"><b>: </b><span>A</span></span></span><br><span><var>H0</var><span class="hyp-type"><b>: </b><span>msg ∈ set_map f s</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">s ⊆ s&#39;</div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="bp">by</span> <span class="nb">intros</span> x Hel; <span class="nb">apply</span> H; <span class="nb">right</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Qed</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
</span><span class="alectryon-sentence"><input class="alectryon-toggle" id="ListSetExtras-v-chkc4" style="display: none" type="checkbox"><label class="alectryon-input" for="ListSetExtras-v-chkc4"><span class="kn">Lemma</span> <span class="nf">set_map_eq</span> {<span class="nv">A</span> <span class="nv">B</span>} `{EqDecision A} (f : B -&gt; A) : <span class="kr">forall</span> <span class="nv">s</span> <span class="nv">s&#39;</span>,
  set_eq s s&#39; -&gt;
  set_eq (set_map f s) (set_map f s&#39;).</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>A, B</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>EqDecision0</var><span class="hyp-type"><b>: </b><span>EqDecision A</span></span></span><br><span><var>f</var><span class="hyp-type"><b>: </b><span>B → A</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="kr">∀</span> <span class="nv">s</span> <span class="nv">s&#39;</span> : <span class="nb">set</span> B,
  set_eq s s&#39; → set_eq (set_map f s) (set_map f s&#39;)</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="ListSetExtras-v-chkc5" style="display: none" type="checkbox"><label class="alectryon-input" for="ListSetExtras-v-chkc5"><span class="kn">Proof</span>.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>A, B</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>EqDecision0</var><span class="hyp-type"><b>: </b><span>EqDecision A</span></span></span><br><span><var>f</var><span class="hyp-type"><b>: </b><span>B → A</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="kr">∀</span> <span class="nv">s</span> <span class="nv">s&#39;</span> : <span class="nb">set</span> B,
  set_eq s s&#39; → set_eq (set_map f s) (set_map f s&#39;)</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><span class="alectryon-input"><span class="bp">by</span> <span class="nb">split</span>; <span class="nb">destruct</span> H; <span class="nb">apply</span> set_map_subseteq.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Qed</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
</span><span class="alectryon-sentence"><input class="alectryon-toggle" id="ListSetExtras-v-chkc6" style="display: none" type="checkbox"><label class="alectryon-input" for="ListSetExtras-v-chkc6"><span class="kn">Lemma</span> <span class="nf">set_map_singleton</span> {<span class="nv">A</span> <span class="nv">B</span>} `{EqDecision A} (f : B -&gt; A) : <span class="kr">forall</span> <span class="nv">s</span> <span class="nv">a</span>,
  set_map f s = [a] -&gt;
  <span class="kr">forall</span> <span class="nv">b</span>, b ∈ s -&gt; f b = a.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>A, B</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>EqDecision0</var><span class="hyp-type"><b>: </b><span>EqDecision A</span></span></span><br><span><var>f</var><span class="hyp-type"><b>: </b><span>B → A</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="kr">∀</span> (<span class="nv">s</span> : <span class="nb">set</span> B) (<span class="nv">a</span> : A),
  set_map f s = [a] → <span class="kr">∀</span> <span class="nv">b</span> : B, b ∈ s → f b = a</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="ListSetExtras-v-chkc7" style="display: none" type="checkbox"><label class="alectryon-input" for="ListSetExtras-v-chkc7"><span class="kn">Proof</span>.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>A, B</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>EqDecision0</var><span class="hyp-type"><b>: </b><span>EqDecision A</span></span></span><br><span><var>f</var><span class="hyp-type"><b>: </b><span>B → A</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="kr">∀</span> (<span class="nv">s</span> : <span class="nb">set</span> B) (<span class="nv">a</span> : A),
  set_map f s = [a] → <span class="kr">∀</span> <span class="nv">b</span> : B, b ∈ s → f b = a</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="ListSetExtras-v-chkc8" style="display: none" type="checkbox"><label class="alectryon-input" for="ListSetExtras-v-chkc8"><span class="nb">intros</span>.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>A, B</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>EqDecision0</var><span class="hyp-type"><b>: </b><span>EqDecision A</span></span></span><br><span><var>f</var><span class="hyp-type"><b>: </b><span>B → A</span></span></span><br><span><var>s</var><span class="hyp-type"><b>: </b><span><span class="nb">set</span> B</span></span></span><br><span><var>a</var><span class="hyp-type"><b>: </b><span>A</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>set_map f s = [a]</span></span></span><br><span><var>b</var><span class="hyp-type"><b>: </b><span>B</span></span></span><br><span><var>H0</var><span class="hyp-type"><b>: </b><span>b ∈ s</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">f b = a</div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="ListSetExtras-v-chkc9" style="display: none" type="checkbox"><label class="alectryon-input" for="ListSetExtras-v-chkc9"><span class="nb">apply</span> (set_map_elem_of f) <span class="kr">in</span> H0.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>A, B</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>EqDecision0</var><span class="hyp-type"><b>: </b><span>EqDecision A</span></span></span><br><span><var>f</var><span class="hyp-type"><b>: </b><span>B → A</span></span></span><br><span><var>s</var><span class="hyp-type"><b>: </b><span><span class="nb">set</span> B</span></span></span><br><span><var>a</var><span class="hyp-type"><b>: </b><span>A</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>set_map f s = [a]</span></span></span><br><span><var>b</var><span class="hyp-type"><b>: </b><span>B</span></span></span><br><span><var>H0</var><span class="hyp-type"><b>: </b><span>f b ∈ set_map f s</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">f b = a</div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="ListSetExtras-v-chkca" style="display: none" type="checkbox"><label class="alectryon-input" for="ListSetExtras-v-chkca"><span class="nb">rewrite</span> H <span class="kr">in</span> H0.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>A, B</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>EqDecision0</var><span class="hyp-type"><b>: </b><span>EqDecision A</span></span></span><br><span><var>f</var><span class="hyp-type"><b>: </b><span>B → A</span></span></span><br><span><var>s</var><span class="hyp-type"><b>: </b><span><span class="nb">set</span> B</span></span></span><br><span><var>a</var><span class="hyp-type"><b>: </b><span>A</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>set_map f s = [a]</span></span></span><br><span><var>b</var><span class="hyp-type"><b>: </b><span>B</span></span></span><br><span><var>H0</var><span class="hyp-type"><b>: </b><span>f b ∈ [a]</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">f b = a</div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="ListSetExtras-v-chkcb" style="display: none" type="checkbox"><label class="alectryon-input" for="ListSetExtras-v-chkcb"><span class="nb">apply</span> elem_of_cons <span class="kr">in</span> H0.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>A, B</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>EqDecision0</var><span class="hyp-type"><b>: </b><span>EqDecision A</span></span></span><br><span><var>f</var><span class="hyp-type"><b>: </b><span>B → A</span></span></span><br><span><var>s</var><span class="hyp-type"><b>: </b><span><span class="nb">set</span> B</span></span></span><br><span><var>a</var><span class="hyp-type"><b>: </b><span>A</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>set_map f s = [a]</span></span></span><br><span><var>b</var><span class="hyp-type"><b>: </b><span>B</span></span></span><br><span><var>H0</var><span class="hyp-type"><b>: </b><span>f b = a ∨ f b ∈ []</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">f b = a</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><span class="alectryon-input"><span class="nb">destruct</span> H0; [<span class="bp">done</span> | <span class="nb">inversion</span> H0].</span><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Qed</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
</span><span class="alectryon-sentence"><input class="alectryon-toggle" id="ListSetExtras-v-chkcc" style="display: none" type="checkbox"><label class="alectryon-input" for="ListSetExtras-v-chkcc"><span class="kn">Lemma</span> <span class="nf">filter_set_add</span> `{StrictlyComparable X} P
  `{<span class="kr">∀</span> (<span class="nv">x</span>:X), Decision (P x)} :
  <span class="kr">forall</span> (<span class="nv">l</span>:list X) <span class="nv">x</span>, ~ P x -&gt;
  filter P l = filter P (set_add x l).</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>X</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>StrictlyComparable X</span></span></span><br><span><var>P</var><span class="hyp-type"><b>: </b><span>X → <span class="kt">Prop</span></span></span></span><br><span><var>H0</var><span class="hyp-type"><b>: </b><span><span class="kr">∀</span> <span class="nv">x</span> : X, Decision (P x)</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="kr">∀</span> (<span class="nv">l</span> : list X) (<span class="nv">x</span> : X),
  ¬ P x → filter P l = filter P (set_add x l)</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="ListSetExtras-v-chkcd" style="display: none" type="checkbox"><label class="alectryon-input" for="ListSetExtras-v-chkcd"><span class="kn">Proof</span>.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>X</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>StrictlyComparable X</span></span></span><br><span><var>P</var><span class="hyp-type"><b>: </b><span>X → <span class="kt">Prop</span></span></span></span><br><span><var>H0</var><span class="hyp-type"><b>: </b><span><span class="kr">∀</span> <span class="nv">x</span> : X, Decision (P x)</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="kr">∀</span> (<span class="nv">l</span> : list X) (<span class="nv">x</span> : X),
  ¬ P x → filter P l = filter P (set_add x l)</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="ListSetExtras-v-chkce" style="display: none" type="checkbox"><label class="alectryon-input" for="ListSetExtras-v-chkce"><span class="nb">induction</span> l <span class="kr">as</span> [|hd tl IHl]; <span class="nb">intros</span> x H_false; <span class="nb">cbn</span>.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>X</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>StrictlyComparable X</span></span></span><br><span><var>P</var><span class="hyp-type"><b>: </b><span>X → <span class="kt">Prop</span></span></span></span><br><span><var>H0</var><span class="hyp-type"><b>: </b><span><span class="kr">∀</span> <span class="nv">x</span> : X, Decision (P x)</span></span></span><br><span><var>x</var><span class="hyp-type"><b>: </b><span>X</span></span></span><br><span><var>H_false</var><span class="hyp-type"><b>: </b><span>¬ P x</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">[] = (<span class="kr">if</span> decide (P x) <span class="kr">then</span> [x] <span class="kr">else</span> [])</div></blockquote><div class="alectryon-extra-goals"><input class="alectryon-extra-goal-toggle" id="ListSetExtras-v-chkcf" style="display: none" type="checkbox"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>X</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>StrictlyComparable X</span></span></span><br><span><var>P</var><span class="hyp-type"><b>: </b><span>X → <span class="kt">Prop</span></span></span></span><br><span><var>H0</var><span class="hyp-type"><b>: </b><span><span class="kr">∀</span> <span class="nv">x</span> : X, Decision (P x)</span></span></span><br><span><var>hd</var><span class="hyp-type"><b>: </b><span>X</span></span></span><br><span><var>tl</var><span class="hyp-type"><b>: </b><span>list X</span></span></span><br><span><var>IHl</var><span class="hyp-type"><b>: </b><span><span class="kr">∀</span> <span class="nv">x</span> : X,
  ¬ P x → filter P tl = filter P (set_add x tl)</span></span></span><br><span><var>x</var><span class="hyp-type"><b>: </b><span>X</span></span></span><br><span><var>H_false</var><span class="hyp-type"><b>: </b><span>¬ P x</span></span></span><br></div><label class="goal-separator" for="ListSetExtras-v-chkcf"><hr></label><div class="goal-conclusion">(<span class="kr">if</span> decide (P hd)
 <span class="kr">then</span> hd :: filter P tl
 <span class="kr">else</span> filter P tl) =
filter P
  (<span class="kr">if</span> decide (x = hd)
   <span class="kr">then</span> hd :: tl
   <span class="kr">else</span> hd :: set_add x tl)</div></blockquote></div></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="ListSetExtras-v-chkd0" style="display: none" type="checkbox"><label class="alectryon-input" for="ListSetExtras-v-chkd0">-</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>X</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>StrictlyComparable X</span></span></span><br><span><var>P</var><span class="hyp-type"><b>: </b><span>X → <span class="kt">Prop</span></span></span></span><br><span><var>H0</var><span class="hyp-type"><b>: </b><span><span class="kr">∀</span> <span class="nv">x</span> : X, Decision (P x)</span></span></span><br><span><var>x</var><span class="hyp-type"><b>: </b><span>X</span></span></span><br><span><var>H_false</var><span class="hyp-type"><b>: </b><span>¬ P x</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">[] = (<span class="kr">if</span> decide (P x) <span class="kr">then</span> [x] <span class="kr">else</span> [])</div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="bp">by</span> <span class="nb">rewrite</span> decide_False.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="ListSetExtras-v-chkd1" style="display: none" type="checkbox"><label class="alectryon-input" for="ListSetExtras-v-chkd1">-</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>X</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>StrictlyComparable X</span></span></span><br><span><var>P</var><span class="hyp-type"><b>: </b><span>X → <span class="kt">Prop</span></span></span></span><br><span><var>H0</var><span class="hyp-type"><b>: </b><span><span class="kr">∀</span> <span class="nv">x</span> : X, Decision (P x)</span></span></span><br><span><var>hd</var><span class="hyp-type"><b>: </b><span>X</span></span></span><br><span><var>tl</var><span class="hyp-type"><b>: </b><span>list X</span></span></span><br><span><var>IHl</var><span class="hyp-type"><b>: </b><span><span class="kr">∀</span> <span class="nv">x</span> : X,
  ¬ P x → filter P tl = filter P (set_add x tl)</span></span></span><br><span><var>x</var><span class="hyp-type"><b>: </b><span>X</span></span></span><br><span><var>H_false</var><span class="hyp-type"><b>: </b><span>¬ P x</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">(<span class="kr">if</span> decide (P hd)
 <span class="kr">then</span> hd :: filter P tl
 <span class="kr">else</span> filter P tl) =
filter P
  (<span class="kr">if</span> decide (x = hd)
   <span class="kr">then</span> hd :: tl
   <span class="kr">else</span> hd :: set_add x tl)</div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="ListSetExtras-v-chkd2" style="display: none" type="checkbox"><label class="alectryon-input" for="ListSetExtras-v-chkd2"><span class="nb">destruct</span> (decide (x = hd)); <span class="nb">cbn</span>; [<span class="bp">done</span> |].</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>X</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>StrictlyComparable X</span></span></span><br><span><var>P</var><span class="hyp-type"><b>: </b><span>X → <span class="kt">Prop</span></span></span></span><br><span><var>H0</var><span class="hyp-type"><b>: </b><span><span class="kr">∀</span> <span class="nv">x</span> : X, Decision (P x)</span></span></span><br><span><var>hd</var><span class="hyp-type"><b>: </b><span>X</span></span></span><br><span><var>tl</var><span class="hyp-type"><b>: </b><span>list X</span></span></span><br><span><var>IHl</var><span class="hyp-type"><b>: </b><span><span class="kr">∀</span> <span class="nv">x</span> : X,
  ¬ P x → filter P tl = filter P (set_add x tl)</span></span></span><br><span><var>x</var><span class="hyp-type"><b>: </b><span>X</span></span></span><br><span><var>H_false</var><span class="hyp-type"><b>: </b><span>¬ P x</span></span></span><br><span><var>n</var><span class="hyp-type"><b>: </b><span>x ≠ hd</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">(<span class="kr">if</span> decide (P hd)
 <span class="kr">then</span> hd :: filter P tl
 <span class="kr">else</span> filter P tl) =
(<span class="kr">if</span> decide (P hd)
 <span class="kr">then</span> hd :: filter P (set_add x tl)
 <span class="kr">else</span> filter P (set_add x tl))</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><span class="alectryon-input"><span class="bp">by</span> <span class="nb">destruct</span> (decide (P hd)); <span class="nb">rewrite</span> &lt;- IHl.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Qed</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
</span><span class="alectryon-sentence"><input class="alectryon-toggle" id="ListSetExtras-v-chkd3" style="display: none" type="checkbox"><label class="alectryon-input" for="ListSetExtras-v-chkd3"><span class="kn">Lemma</span> <span class="nf">set_add_ignore</span> `{StrictlyComparable X} :
  <span class="kr">forall</span> (<span class="nv">l</span> : list X) (<span class="nv">x</span> : X),
    x ∈ l -&gt;
    set_add x l = l.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>X</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>StrictlyComparable X</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="kr">∀</span> (<span class="nv">l</span> : list X) (<span class="nv">x</span> : X), x ∈ l → set_add x l = l</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="ListSetExtras-v-chkd4" style="display: none" type="checkbox"><label class="alectryon-input" for="ListSetExtras-v-chkd4"><span class="kn">Proof</span>.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>X</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>StrictlyComparable X</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="kr">∀</span> (<span class="nv">l</span> : list X) (<span class="nv">x</span> : X), x ∈ l → set_add x l = l</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="ListSetExtras-v-chkd5" style="display: none" type="checkbox"><label class="alectryon-input" for="ListSetExtras-v-chkd5"><span class="nb">induction</span> l <span class="kr">as</span> [|hd tl IHl]; <span class="nb">inversion</span> <span class="mi">1</span>; <span class="nb">subst</span>; <span class="nb">cbn</span>.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>X</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>StrictlyComparable X</span></span></span><br><span><var>hd</var><span class="hyp-type"><b>: </b><span>X</span></span></span><br><span><var>tl</var><span class="hyp-type"><b>: </b><span>list X</span></span></span><br><span><var>IHl</var><span class="hyp-type"><b>: </b><span><span class="kr">∀</span> <span class="nv">x</span> : X, x ∈ tl → set_add x tl = tl</span></span></span><br><span><var>H0</var><span class="hyp-type"><b>: </b><span>hd ∈ hd :: tl</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">(<span class="kr">if</span> decide (hd = hd)
 <span class="kr">then</span> hd :: tl
 <span class="kr">else</span> hd :: set_add hd tl) = hd :: tl</div></blockquote><div class="alectryon-extra-goals"><input class="alectryon-extra-goal-toggle" id="ListSetExtras-v-chkd6" style="display: none" type="checkbox"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>X</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>StrictlyComparable X</span></span></span><br><span><var>hd</var><span class="hyp-type"><b>: </b><span>X</span></span></span><br><span><var>tl</var><span class="hyp-type"><b>: </b><span>list X</span></span></span><br><span><var>IHl</var><span class="hyp-type"><b>: </b><span><span class="kr">∀</span> <span class="nv">x</span> : X, x ∈ tl → set_add x tl = tl</span></span></span><br><span><var>x</var><span class="hyp-type"><b>: </b><span>X</span></span></span><br><span><var>H0</var><span class="hyp-type"><b>: </b><span>x ∈ hd :: tl</span></span></span><br><span><var>H3</var><span class="hyp-type"><b>: </b><span>x ∈ tl</span></span></span><br></div><label class="goal-separator" for="ListSetExtras-v-chkd6"><hr></label><div class="goal-conclusion">(<span class="kr">if</span> decide (x = hd)
 <span class="kr">then</span> hd :: tl
 <span class="kr">else</span> hd :: set_add x tl) = hd :: tl</div></blockquote></div></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="ListSetExtras-v-chkd7" style="display: none" type="checkbox"><label class="alectryon-input" for="ListSetExtras-v-chkd7">-</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>X</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>StrictlyComparable X</span></span></span><br><span><var>hd</var><span class="hyp-type"><b>: </b><span>X</span></span></span><br><span><var>tl</var><span class="hyp-type"><b>: </b><span>list X</span></span></span><br><span><var>IHl</var><span class="hyp-type"><b>: </b><span><span class="kr">∀</span> <span class="nv">x</span> : X, x ∈ tl → set_add x tl = tl</span></span></span><br><span><var>H0</var><span class="hyp-type"><b>: </b><span>hd ∈ hd :: tl</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">(<span class="kr">if</span> decide (hd = hd)
 <span class="kr">then</span> hd :: tl
 <span class="kr">else</span> hd :: set_add hd tl) = hd :: tl</div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="bp">by</span> <span class="nb">rewrite</span> decide_True.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="ListSetExtras-v-chkd8" style="display: none" type="checkbox"><label class="alectryon-input" for="ListSetExtras-v-chkd8">-</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>X</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>StrictlyComparable X</span></span></span><br><span><var>hd</var><span class="hyp-type"><b>: </b><span>X</span></span></span><br><span><var>tl</var><span class="hyp-type"><b>: </b><span>list X</span></span></span><br><span><var>IHl</var><span class="hyp-type"><b>: </b><span><span class="kr">∀</span> <span class="nv">x</span> : X, x ∈ tl → set_add x tl = tl</span></span></span><br><span><var>x</var><span class="hyp-type"><b>: </b><span>X</span></span></span><br><span><var>H0</var><span class="hyp-type"><b>: </b><span>x ∈ hd :: tl</span></span></span><br><span><var>H3</var><span class="hyp-type"><b>: </b><span>x ∈ tl</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">(<span class="kr">if</span> decide (x = hd)
 <span class="kr">then</span> hd :: tl
 <span class="kr">else</span> hd :: set_add x tl) = hd :: tl</div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="bp">by</span> case_decide; [| <span class="nb">rewrite</span> IHl].</span><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Qed</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
</span><span class="alectryon-sentence"><input class="alectryon-toggle" id="ListSetExtras-v-chkd9" style="display: none" type="checkbox"><label class="alectryon-input" for="ListSetExtras-v-chkd9"><span class="kn">Lemma</span> <span class="nf">set_add_new</span> `{EqDecision A}:
  <span class="kr">forall</span> (<span class="nv">x</span>:A) <span class="nv">l</span>, ~x ∈ l -&gt; set_add x l = l++[x].</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>A</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>EqDecision0</var><span class="hyp-type"><b>: </b><span>EqDecision A</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="kr">∀</span> (<span class="nv">x</span> : A) (<span class="nv">l</span> : <span class="nb">set</span> A), x ∉ l → set_add x l = l ++ [x]</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="ListSetExtras-v-chkda" style="display: none" type="checkbox"><label class="alectryon-input" for="ListSetExtras-v-chkda"><span class="kn">Proof</span>.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>A</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>EqDecision0</var><span class="hyp-type"><b>: </b><span>EqDecision A</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="kr">∀</span> (<span class="nv">x</span> : A) (<span class="nv">l</span> : <span class="nb">set</span> A), x ∉ l → set_add x l = l ++ [x]</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="ListSetExtras-v-chkdb" style="display: none" type="checkbox"><label class="alectryon-input" for="ListSetExtras-v-chkdb"><span class="nb">induction</span> l; <span class="nb">cbn</span>; [<span class="bp">done</span> |]; <span class="nb">intros</span> H_not_in.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>A</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>EqDecision0</var><span class="hyp-type"><b>: </b><span>EqDecision A</span></span></span><br><span><var>x, a</var><span class="hyp-type"><b>: </b><span>A</span></span></span><br><span><var>l</var><span class="hyp-type"><b>: </b><span>list A</span></span></span><br><span><var>IHl</var><span class="hyp-type"><b>: </b><span>x ∉ l → set_add x l = l ++ [x]</span></span></span><br><span><var>H_not_in</var><span class="hyp-type"><b>: </b><span>x ∉ a :: l</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">(<span class="kr">if</span> decide (x = a) <span class="kr">then</span> a :: l <span class="kr">else</span> a :: set_add x l) =
a :: l ++ [x]</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="ListSetExtras-v-chkdc" style="display: none" type="checkbox"><label class="alectryon-input" for="ListSetExtras-v-chkdc"><span class="nb">rewrite</span> decide_False; <span class="nb">cycle</span> <span class="mi">1</span>.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>A</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>EqDecision0</var><span class="hyp-type"><b>: </b><span>EqDecision A</span></span></span><br><span><var>x, a</var><span class="hyp-type"><b>: </b><span>A</span></span></span><br><span><var>l</var><span class="hyp-type"><b>: </b><span>list A</span></span></span><br><span><var>IHl</var><span class="hyp-type"><b>: </b><span>x ∉ l → set_add x l = l ++ [x]</span></span></span><br><span><var>H_not_in</var><span class="hyp-type"><b>: </b><span>x ∉ a :: l</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">x ≠ a</div></blockquote><div class="alectryon-extra-goals"><input class="alectryon-extra-goal-toggle" id="ListSetExtras-v-chkdd" style="display: none" type="checkbox"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>A</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>EqDecision0</var><span class="hyp-type"><b>: </b><span>EqDecision A</span></span></span><br><span><var>x, a</var><span class="hyp-type"><b>: </b><span>A</span></span></span><br><span><var>l</var><span class="hyp-type"><b>: </b><span>list A</span></span></span><br><span><var>IHl</var><span class="hyp-type"><b>: </b><span>x ∉ l → set_add x l = l ++ [x]</span></span></span><br><span><var>H_not_in</var><span class="hyp-type"><b>: </b><span>x ∉ a :: l</span></span></span><br></div><label class="goal-separator" for="ListSetExtras-v-chkdd"><hr></label><div class="goal-conclusion">a :: set_add x l = a :: l ++ [x]</div></blockquote></div></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="ListSetExtras-v-chkde" style="display: none" type="checkbox"><label class="alectryon-input" for="ListSetExtras-v-chkde">-</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>A</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>EqDecision0</var><span class="hyp-type"><b>: </b><span>EqDecision A</span></span></span><br><span><var>x, a</var><span class="hyp-type"><b>: </b><span>A</span></span></span><br><span><var>l</var><span class="hyp-type"><b>: </b><span>list A</span></span></span><br><span><var>IHl</var><span class="hyp-type"><b>: </b><span>x ∉ l → set_add x l = l ++ [x]</span></span></span><br><span><var>H_not_in</var><span class="hyp-type"><b>: </b><span>x ∉ a :: l</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">x ≠ a</div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="bp">by</span> <span class="nb">intros</span> -&gt;; <span class="nb">apply</span> H_not_in; <span class="nb">left</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="ListSetExtras-v-chkdf" style="display: none" type="checkbox"><label class="alectryon-input" for="ListSetExtras-v-chkdf">-</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>A</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>EqDecision0</var><span class="hyp-type"><b>: </b><span>EqDecision A</span></span></span><br><span><var>x, a</var><span class="hyp-type"><b>: </b><span>A</span></span></span><br><span><var>l</var><span class="hyp-type"><b>: </b><span>list A</span></span></span><br><span><var>IHl</var><span class="hyp-type"><b>: </b><span>x ∉ l → set_add x l = l ++ [x]</span></span></span><br><span><var>H_not_in</var><span class="hyp-type"><b>: </b><span>x ∉ a :: l</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">a :: set_add x l = a :: l ++ [x]</div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="ListSetExtras-v-chke0" style="display: none" type="checkbox"><label class="alectryon-input" for="ListSetExtras-v-chke0"><span class="nb">rewrite</span> elem_of_cons <span class="kr">in</span> H_not_in.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>A</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>EqDecision0</var><span class="hyp-type"><b>: </b><span>EqDecision A</span></span></span><br><span><var>x, a</var><span class="hyp-type"><b>: </b><span>A</span></span></span><br><span><var>l</var><span class="hyp-type"><b>: </b><span>list A</span></span></span><br><span><var>IHl</var><span class="hyp-type"><b>: </b><span>x ∉ l → set_add x l = l ++ [x]</span></span></span><br><span><var>H_not_in</var><span class="hyp-type"><b>: </b><span>¬ (x = a ∨ x ∈ l)</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">a :: set_add x l = a :: l ++ [x]</div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="nb">rewrite</span> IHl; itauto.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Qed</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
</span><span class="alectryon-sentence"><input class="alectryon-toggle" id="ListSetExtras-v-chke1" style="display: none" type="checkbox"><label class="alectryon-input" for="ListSetExtras-v-chke1"><span class="kn">Lemma</span> <span class="nf">set_remove_not_elem_of</span> `{EqDecision A} : <span class="kr">forall</span> <span class="nv">x</span> (<span class="nv">s</span> : list A),
  ~ x ∈ s -&gt;
  set_remove x s = s.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>A</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>EqDecision0</var><span class="hyp-type"><b>: </b><span>EqDecision A</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="kr">∀</span> (<span class="nv">x</span> : A) (<span class="nv">s</span> : list A), x ∉ s → set_remove x s = s</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="ListSetExtras-v-chke2" style="display: none" type="checkbox"><label class="alectryon-input" for="ListSetExtras-v-chke2"><span class="kn">Proof</span>.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>A</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>EqDecision0</var><span class="hyp-type"><b>: </b><span>EqDecision A</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="kr">∀</span> (<span class="nv">x</span> : A) (<span class="nv">s</span> : list A), x ∉ s → set_remove x s = s</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="ListSetExtras-v-chke3" style="display: none" type="checkbox"><label class="alectryon-input" for="ListSetExtras-v-chke3"><span class="nb">induction</span> s; <span class="nb">cbn</span>; <span class="nb">intros</span>; [<span class="bp">done</span> |].</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>A</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>EqDecision0</var><span class="hyp-type"><b>: </b><span>EqDecision A</span></span></span><br><span><var>x, a</var><span class="hyp-type"><b>: </b><span>A</span></span></span><br><span><var>s</var><span class="hyp-type"><b>: </b><span>list A</span></span></span><br><span><var>IHs</var><span class="hyp-type"><b>: </b><span>x ∉ s → set_remove x s = s</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>x ∉ a :: s</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">(<span class="kr">if</span> decide (x = a) <span class="kr">then</span> s <span class="kr">else</span> a :: set_remove x s) =
a :: s</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="ListSetExtras-v-chke4" style="display: none" type="checkbox"><label class="alectryon-input" for="ListSetExtras-v-chke4"><span class="nb">rewrite</span> decide_False; <span class="nb">cycle</span> <span class="mi">1</span>.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>A</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>EqDecision0</var><span class="hyp-type"><b>: </b><span>EqDecision A</span></span></span><br><span><var>x, a</var><span class="hyp-type"><b>: </b><span>A</span></span></span><br><span><var>s</var><span class="hyp-type"><b>: </b><span>list A</span></span></span><br><span><var>IHs</var><span class="hyp-type"><b>: </b><span>x ∉ s → set_remove x s = s</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>x ∉ a :: s</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">x ≠ a</div></blockquote><div class="alectryon-extra-goals"><input class="alectryon-extra-goal-toggle" id="ListSetExtras-v-chke5" style="display: none" type="checkbox"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>A</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>EqDecision0</var><span class="hyp-type"><b>: </b><span>EqDecision A</span></span></span><br><span><var>x, a</var><span class="hyp-type"><b>: </b><span>A</span></span></span><br><span><var>s</var><span class="hyp-type"><b>: </b><span>list A</span></span></span><br><span><var>IHs</var><span class="hyp-type"><b>: </b><span>x ∉ s → set_remove x s = s</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>x ∉ a :: s</span></span></span><br></div><label class="goal-separator" for="ListSetExtras-v-chke5"><hr></label><div class="goal-conclusion">a :: set_remove x s = a :: s</div></blockquote></div></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="ListSetExtras-v-chke6" style="display: none" type="checkbox"><label class="alectryon-input" for="ListSetExtras-v-chke6">+</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>A</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>EqDecision0</var><span class="hyp-type"><b>: </b><span>EqDecision A</span></span></span><br><span><var>x, a</var><span class="hyp-type"><b>: </b><span>A</span></span></span><br><span><var>s</var><span class="hyp-type"><b>: </b><span>list A</span></span></span><br><span><var>IHs</var><span class="hyp-type"><b>: </b><span>x ∉ s → set_remove x s = s</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>x ∉ a :: s</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">x ≠ a</div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="bp">by</span> <span class="nb">intros</span> -&gt;; <span class="bp">contradict</span> H; <span class="nb">left</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="ListSetExtras-v-chke7" style="display: none" type="checkbox"><label class="alectryon-input" for="ListSetExtras-v-chke7">+</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>A</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>EqDecision0</var><span class="hyp-type"><b>: </b><span>EqDecision A</span></span></span><br><span><var>x, a</var><span class="hyp-type"><b>: </b><span>A</span></span></span><br><span><var>s</var><span class="hyp-type"><b>: </b><span>list A</span></span></span><br><span><var>IHs</var><span class="hyp-type"><b>: </b><span>x ∉ s → set_remove x s = s</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>x ∉ a :: s</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">a :: set_remove x s = a :: s</div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="ListSetExtras-v-chke8" style="display: none" type="checkbox"><label class="alectryon-input" for="ListSetExtras-v-chke8"><span class="nb">rewrite</span> IHs; [<span class="bp">done</span> |].</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>A</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>EqDecision0</var><span class="hyp-type"><b>: </b><span>EqDecision A</span></span></span><br><span><var>x, a</var><span class="hyp-type"><b>: </b><span>A</span></span></span><br><span><var>s</var><span class="hyp-type"><b>: </b><span>list A</span></span></span><br><span><var>IHs</var><span class="hyp-type"><b>: </b><span>x ∉ s → set_remove x s = s</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>x ∉ a :: s</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">x ∉ s</div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="ListSetExtras-v-chke9" style="display: none" type="checkbox"><label class="alectryon-input" for="ListSetExtras-v-chke9"><span class="nb">rewrite</span> elem_of_cons <span class="kr">in</span> H.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>A</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>EqDecision0</var><span class="hyp-type"><b>: </b><span>EqDecision A</span></span></span><br><span><var>x, a</var><span class="hyp-type"><b>: </b><span>A</span></span></span><br><span><var>s</var><span class="hyp-type"><b>: </b><span>list A</span></span></span><br><span><var>IHs</var><span class="hyp-type"><b>: </b><span>x ∉ s → set_remove x s = s</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>¬ (x = a ∨ x ∈ s)</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">x ∉ s</div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><span class="alectryon-input">itauto.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Qed</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
</span><span class="alectryon-sentence"><input class="alectryon-toggle" id="ListSetExtras-v-chkea" style="display: none" type="checkbox"><label class="alectryon-input" for="ListSetExtras-v-chkea"><span class="kn">Lemma</span> <span class="nf">set_remove_elim</span> `{EqDecision A} : <span class="kr">forall</span> <span class="nv">x</span> (<span class="nv">s</span> : list A),
  NoDup s -&gt; ~ x ∈ (set_remove x s).</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>A</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>EqDecision0</var><span class="hyp-type"><b>: </b><span>EqDecision A</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="kr">∀</span> (<span class="nv">x</span> : A) (<span class="nv">s</span> : list A), NoDup s → x ∉ set_remove x s</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="ListSetExtras-v-chkeb" style="display: none" type="checkbox"><label class="alectryon-input" for="ListSetExtras-v-chkeb"><span class="kn">Proof</span>.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>A</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>EqDecision0</var><span class="hyp-type"><b>: </b><span>EqDecision A</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="kr">∀</span> (<span class="nv">x</span> : A) (<span class="nv">s</span> : list A), NoDup s → x ∉ set_remove x s</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="ListSetExtras-v-chkec" style="display: none" type="checkbox"><label class="alectryon-input" for="ListSetExtras-v-chkec"><span class="nb">intros</span> x s HND Hnelem.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>A</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>EqDecision0</var><span class="hyp-type"><b>: </b><span>EqDecision A</span></span></span><br><span><var>x</var><span class="hyp-type"><b>: </b><span>A</span></span></span><br><span><var>s</var><span class="hyp-type"><b>: </b><span>list A</span></span></span><br><span><var>HND</var><span class="hyp-type"><b>: </b><span>NoDup s</span></span></span><br><span><var>Hnelem</var><span class="hyp-type"><b>: </b><span>x ∈ set_remove x s</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="kt">False</span></div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="nb">apply</span> set_remove_iff <span class="kr">in</span> Hnelem; itauto.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Qed</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
</span><span class="alectryon-sentence"><input class="alectryon-toggle" id="ListSetExtras-v-chked" style="display: none" type="checkbox"><label class="alectryon-input" for="ListSetExtras-v-chked"><span class="kn">Lemma</span> <span class="nf">set_remove_first</span> `{EqDecision A} : <span class="kr">forall</span> <span class="nv">x</span> <span class="nv">y</span> (<span class="nv">s</span> : list A),
  x = y -&gt; set_remove x (y::s) = s.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>A</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>EqDecision0</var><span class="hyp-type"><b>: </b><span>EqDecision A</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="kr">∀</span> (<span class="nv">x</span> <span class="nv">y</span> : A) (<span class="nv">s</span> : list A),
  x = y → set_remove x (y :: s) = s</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="ListSetExtras-v-chkee" style="display: none" type="checkbox"><label class="alectryon-input" for="ListSetExtras-v-chkee"><span class="kn">Proof</span>.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>A</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>EqDecision0</var><span class="hyp-type"><b>: </b><span>EqDecision A</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="kr">∀</span> (<span class="nv">x</span> <span class="nv">y</span> : A) (<span class="nv">s</span> : list A),
  x = y → set_remove x (y :: s) = s</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><span class="alectryon-input"><span class="bp">by</span> <span class="nb">intros</span> x y s -&gt;; <span class="nb">cbn</span>; <span class="nb">rewrite</span> decide_True.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Qed</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
</span><span class="alectryon-sentence"><input class="alectryon-toggle" id="ListSetExtras-v-chkef" style="display: none" type="checkbox"><label class="alectryon-input" for="ListSetExtras-v-chkef"><span class="kn">Lemma</span> <span class="nf">set_remove_nodup_1</span> `{EqDecision A} : <span class="kr">forall</span> <span class="nv">x</span> (<span class="nv">s</span> : list A),
  NoDup (set_remove x s) -&gt;
  ~ x ∈ (set_remove x s) -&gt;
  NoDup s.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>A</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>EqDecision0</var><span class="hyp-type"><b>: </b><span>EqDecision A</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="kr">∀</span> (<span class="nv">x</span> : A) (<span class="nv">s</span> : list A),
  NoDup (set_remove x s)
  → x ∉ set_remove x s → NoDup s</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="ListSetExtras-v-chkf0" style="display: none" type="checkbox"><label class="alectryon-input" for="ListSetExtras-v-chkf0"><span class="kn">Proof</span>.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>A</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>EqDecision0</var><span class="hyp-type"><b>: </b><span>EqDecision A</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="kr">∀</span> (<span class="nv">x</span> : A) (<span class="nv">s</span> : list A),
  NoDup (set_remove x s)
  → x ∉ set_remove x s → NoDup s</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="ListSetExtras-v-chkf1" style="display: none" type="checkbox"><label class="alectryon-input" for="ListSetExtras-v-chkf1"><span class="nb">induction</span> s; <span class="nb">intros</span>.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>A</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>EqDecision0</var><span class="hyp-type"><b>: </b><span>EqDecision A</span></span></span><br><span><var>x</var><span class="hyp-type"><b>: </b><span>A</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>NoDup (set_remove x [])</span></span></span><br><span><var>H0</var><span class="hyp-type"><b>: </b><span>x ∉ set_remove x []</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">NoDup []</div></blockquote><div class="alectryon-extra-goals"><input class="alectryon-extra-goal-toggle" id="ListSetExtras-v-chkf2" style="display: none" type="checkbox"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>A</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>EqDecision0</var><span class="hyp-type"><b>: </b><span>EqDecision A</span></span></span><br><span><var>x, a</var><span class="hyp-type"><b>: </b><span>A</span></span></span><br><span><var>s</var><span class="hyp-type"><b>: </b><span>list A</span></span></span><br><span><var>IHs</var><span class="hyp-type"><b>: </b><span>NoDup (set_remove x s)
→ x ∉ set_remove x s → NoDup s</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>NoDup (set_remove x (a :: s))</span></span></span><br><span><var>H0</var><span class="hyp-type"><b>: </b><span>x ∉ set_remove x (a :: s)</span></span></span><br></div><label class="goal-separator" for="ListSetExtras-v-chkf2"><hr></label><div class="goal-conclusion">NoDup (a :: s)</div></blockquote></div></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="ListSetExtras-v-chkf3" style="display: none" type="checkbox"><label class="alectryon-input" for="ListSetExtras-v-chkf3">-</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>A</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>EqDecision0</var><span class="hyp-type"><b>: </b><span>EqDecision A</span></span></span><br><span><var>x</var><span class="hyp-type"><b>: </b><span>A</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>NoDup (set_remove x [])</span></span></span><br><span><var>H0</var><span class="hyp-type"><b>: </b><span>x ∉ set_remove x []</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">NoDup []</div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="nb">constructor</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="ListSetExtras-v-chkf4" style="display: none" type="checkbox"><label class="alectryon-input" for="ListSetExtras-v-chkf4">-</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>A</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>EqDecision0</var><span class="hyp-type"><b>: </b><span>EqDecision A</span></span></span><br><span><var>x, a</var><span class="hyp-type"><b>: </b><span>A</span></span></span><br><span><var>s</var><span class="hyp-type"><b>: </b><span>list A</span></span></span><br><span><var>IHs</var><span class="hyp-type"><b>: </b><span>NoDup (set_remove x s)
→ x ∉ set_remove x s → NoDup s</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>NoDup (set_remove x (a :: s))</span></span></span><br><span><var>H0</var><span class="hyp-type"><b>: </b><span>x ∉ set_remove x (a :: s)</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">NoDup (a :: s)</div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="ListSetExtras-v-chkf5" style="display: none" type="checkbox"><label class="alectryon-input" for="ListSetExtras-v-chkf5"><span class="nb">simpl</span> <span class="kr">in</span> H0 .</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>A</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>EqDecision0</var><span class="hyp-type"><b>: </b><span>EqDecision A</span></span></span><br><span><var>x, a</var><span class="hyp-type"><b>: </b><span>A</span></span></span><br><span><var>s</var><span class="hyp-type"><b>: </b><span>list A</span></span></span><br><span><var>IHs</var><span class="hyp-type"><b>: </b><span>NoDup (set_remove x s)
→ x ∉ set_remove x s → NoDup s</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>NoDup (set_remove x (a :: s))</span></span></span><br><span><var>H0</var><span class="hyp-type"><b>: </b><span>x
∉ (<span class="kr">if</span> decide (x = a)
   <span class="kr">then</span> s
   <span class="kr">else</span> a :: set_remove x s)</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">NoDup (a :: s)</div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="ListSetExtras-v-chkf6" style="display: none" type="checkbox"><label class="alectryon-input" for="ListSetExtras-v-chkf6"><span class="nb">destruct</span> (decide (x = a)).</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>A</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>EqDecision0</var><span class="hyp-type"><b>: </b><span>EqDecision A</span></span></span><br><span><var>x, a</var><span class="hyp-type"><b>: </b><span>A</span></span></span><br><span><var>s</var><span class="hyp-type"><b>: </b><span>list A</span></span></span><br><span><var>IHs</var><span class="hyp-type"><b>: </b><span>NoDup (set_remove x s)
→ x ∉ set_remove x s → NoDup s</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>NoDup (set_remove x (a :: s))</span></span></span><br><span><var>e</var><span class="hyp-type"><b>: </b><span>x = a</span></span></span><br><span><var>H0</var><span class="hyp-type"><b>: </b><span>x ∉ s</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">NoDup (a :: s)</div></blockquote><div class="alectryon-extra-goals"><input class="alectryon-extra-goal-toggle" id="ListSetExtras-v-chkf7" style="display: none" type="checkbox"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>A</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>EqDecision0</var><span class="hyp-type"><b>: </b><span>EqDecision A</span></span></span><br><span><var>x, a</var><span class="hyp-type"><b>: </b><span>A</span></span></span><br><span><var>s</var><span class="hyp-type"><b>: </b><span>list A</span></span></span><br><span><var>IHs</var><span class="hyp-type"><b>: </b><span>NoDup (set_remove x s)
→ x ∉ set_remove x s → NoDup s</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>NoDup (set_remove x (a :: s))</span></span></span><br><span><var>n</var><span class="hyp-type"><b>: </b><span>x ≠ a</span></span></span><br><span><var>H0</var><span class="hyp-type"><b>: </b><span>x ∉ a :: set_remove x s</span></span></span><br></div><label class="goal-separator" for="ListSetExtras-v-chkf7"><hr></label><div class="goal-conclusion">NoDup (a :: s)</div></blockquote></div></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="ListSetExtras-v-chkf8" style="display: none" type="checkbox"><label class="alectryon-input" for="ListSetExtras-v-chkf8">+</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>A</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>EqDecision0</var><span class="hyp-type"><b>: </b><span>EqDecision A</span></span></span><br><span><var>x, a</var><span class="hyp-type"><b>: </b><span>A</span></span></span><br><span><var>s</var><span class="hyp-type"><b>: </b><span>list A</span></span></span><br><span><var>IHs</var><span class="hyp-type"><b>: </b><span>NoDup (set_remove x s)
→ x ∉ set_remove x s → NoDup s</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>NoDup (set_remove x (a :: s))</span></span></span><br><span><var>e</var><span class="hyp-type"><b>: </b><span>x = a</span></span></span><br><span><var>H0</var><span class="hyp-type"><b>: </b><span>x ∉ s</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">NoDup (a :: s)</div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="ListSetExtras-v-chkf9" style="display: none" type="checkbox"><label class="alectryon-input" for="ListSetExtras-v-chkf9"><span class="nb">cbn</span> <span class="kr">in</span> H; <span class="nb">subst</span>.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>A</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>EqDecision0</var><span class="hyp-type"><b>: </b><span>EqDecision A</span></span></span><br><span><var>a</var><span class="hyp-type"><b>: </b><span>A</span></span></span><br><span><var>s</var><span class="hyp-type"><b>: </b><span>list A</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>NoDup
  (<span class="kr">if</span> decide (a = a)
   <span class="kr">then</span> s
   <span class="kr">else</span> a :: set_remove a s)</span></span></span><br><span><var>IHs</var><span class="hyp-type"><b>: </b><span>NoDup (set_remove a s)
→ a ∉ set_remove a s → NoDup s</span></span></span><br><span><var>H0</var><span class="hyp-type"><b>: </b><span>a ∉ s</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">NoDup (a :: s)</div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="ListSetExtras-v-chkfa" style="display: none" type="checkbox"><label class="alectryon-input" for="ListSetExtras-v-chkfa"><span class="nb">constructor</span>; [<span class="bp">done</span> |].</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>A</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>EqDecision0</var><span class="hyp-type"><b>: </b><span>EqDecision A</span></span></span><br><span><var>a</var><span class="hyp-type"><b>: </b><span>A</span></span></span><br><span><var>s</var><span class="hyp-type"><b>: </b><span>list A</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>NoDup
  (<span class="kr">if</span> decide (a = a)
   <span class="kr">then</span> s
   <span class="kr">else</span> a :: set_remove a s)</span></span></span><br><span><var>IHs</var><span class="hyp-type"><b>: </b><span>NoDup (set_remove a s)
→ a ∉ set_remove a s → NoDup s</span></span></span><br><span><var>H0</var><span class="hyp-type"><b>: </b><span>a ∉ s</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">NoDup s</div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="bp">by</span> <span class="nb">rewrite</span> decide_True <span class="kr">in</span> H.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="ListSetExtras-v-chkfb" style="display: none" type="checkbox"><label class="alectryon-input" for="ListSetExtras-v-chkfb">+</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>A</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>EqDecision0</var><span class="hyp-type"><b>: </b><span>EqDecision A</span></span></span><br><span><var>x, a</var><span class="hyp-type"><b>: </b><span>A</span></span></span><br><span><var>s</var><span class="hyp-type"><b>: </b><span>list A</span></span></span><br><span><var>IHs</var><span class="hyp-type"><b>: </b><span>NoDup (set_remove x s)
→ x ∉ set_remove x s → NoDup s</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>NoDup (set_remove x (a :: s))</span></span></span><br><span><var>n</var><span class="hyp-type"><b>: </b><span>x ≠ a</span></span></span><br><span><var>H0</var><span class="hyp-type"><b>: </b><span>x ∉ a :: set_remove x s</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">NoDup (a :: s)</div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="ListSetExtras-v-chkfc" style="display: none" type="checkbox"><label class="alectryon-input" for="ListSetExtras-v-chkfc"><span class="nb">rewrite</span> elem_of_cons <span class="kr">in</span> H0.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>A</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>EqDecision0</var><span class="hyp-type"><b>: </b><span>EqDecision A</span></span></span><br><span><var>x, a</var><span class="hyp-type"><b>: </b><span>A</span></span></span><br><span><var>s</var><span class="hyp-type"><b>: </b><span>list A</span></span></span><br><span><var>IHs</var><span class="hyp-type"><b>: </b><span>NoDup (set_remove x s)
→ x ∉ set_remove x s → NoDup s</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>NoDup (set_remove x (a :: s))</span></span></span><br><span><var>n</var><span class="hyp-type"><b>: </b><span>x ≠ a</span></span></span><br><span><var>H0</var><span class="hyp-type"><b>: </b><span>¬ (x = a ∨ x ∈ set_remove x s)</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">NoDup (a :: s)</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">      </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="ListSetExtras-v-chkfd" style="display: none" type="checkbox"><label class="alectryon-input" for="ListSetExtras-v-chkfd"><span class="nb">simpl</span> <span class="kr">in</span> H.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>A</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>EqDecision0</var><span class="hyp-type"><b>: </b><span>EqDecision A</span></span></span><br><span><var>x, a</var><span class="hyp-type"><b>: </b><span>A</span></span></span><br><span><var>s</var><span class="hyp-type"><b>: </b><span>list A</span></span></span><br><span><var>IHs</var><span class="hyp-type"><b>: </b><span>NoDup (set_remove x s)
→ x ∉ set_remove x s → NoDup s</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>NoDup
  (<span class="kr">if</span> decide (x = a)
   <span class="kr">then</span> s
   <span class="kr">else</span> a :: set_remove x s)</span></span></span><br><span><var>n</var><span class="hyp-type"><b>: </b><span>x ≠ a</span></span></span><br><span><var>H0</var><span class="hyp-type"><b>: </b><span>¬ (x = a ∨ x ∈ set_remove x s)</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">NoDup (a :: s)</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">      </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="ListSetExtras-v-chkfe" style="display: none" type="checkbox"><label class="alectryon-input" for="ListSetExtras-v-chkfe"><span class="nb">rewrite</span> decide_False <span class="kr">in</span> H; <span class="nb">auto</span>.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>A</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>EqDecision0</var><span class="hyp-type"><b>: </b><span>EqDecision A</span></span></span><br><span><var>x, a</var><span class="hyp-type"><b>: </b><span>A</span></span></span><br><span><var>s</var><span class="hyp-type"><b>: </b><span>list A</span></span></span><br><span><var>IHs</var><span class="hyp-type"><b>: </b><span>NoDup (set_remove x s)
→ x ∉ set_remove x s → NoDup s</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>NoDup (a :: set_remove x s)</span></span></span><br><span><var>n</var><span class="hyp-type"><b>: </b><span>x ≠ a</span></span></span><br><span><var>H0</var><span class="hyp-type"><b>: </b><span>¬ (x = a ∨ x ∈ set_remove x s)</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">NoDup (a :: s)</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">      </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="ListSetExtras-v-chkff" style="display: none" type="checkbox"><label class="alectryon-input" for="ListSetExtras-v-chkff"><span class="nb">inversion</span> H; <span class="nb">subst</span>.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>A</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>EqDecision0</var><span class="hyp-type"><b>: </b><span>EqDecision A</span></span></span><br><span><var>x, a</var><span class="hyp-type"><b>: </b><span>A</span></span></span><br><span><var>s</var><span class="hyp-type"><b>: </b><span>list A</span></span></span><br><span><var>IHs</var><span class="hyp-type"><b>: </b><span>NoDup (set_remove x s)
→ x ∉ set_remove x s → NoDup s</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>NoDup (a :: set_remove x s)</span></span></span><br><span><var>n</var><span class="hyp-type"><b>: </b><span>x ≠ a</span></span></span><br><span><var>H0</var><span class="hyp-type"><b>: </b><span>¬ (x = a ∨ x ∈ set_remove x s)</span></span></span><br><span><var>H3</var><span class="hyp-type"><b>: </b><span>a ∉ set_remove x s</span></span></span><br><span><var>H4</var><span class="hyp-type"><b>: </b><span>NoDup (set_remove x s)</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">NoDup (a :: s)</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">      </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="ListSetExtras-v-chk100" style="display: none" type="checkbox"><label class="alectryon-input" for="ListSetExtras-v-chk100"><span class="nb">constructor</span>.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>A</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>EqDecision0</var><span class="hyp-type"><b>: </b><span>EqDecision A</span></span></span><br><span><var>x, a</var><span class="hyp-type"><b>: </b><span>A</span></span></span><br><span><var>s</var><span class="hyp-type"><b>: </b><span>list A</span></span></span><br><span><var>IHs</var><span class="hyp-type"><b>: </b><span>NoDup (set_remove x s)
→ x ∉ set_remove x s → NoDup s</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>NoDup (a :: set_remove x s)</span></span></span><br><span><var>n</var><span class="hyp-type"><b>: </b><span>x ≠ a</span></span></span><br><span><var>H0</var><span class="hyp-type"><b>: </b><span>¬ (x = a ∨ x ∈ set_remove x s)</span></span></span><br><span><var>H3</var><span class="hyp-type"><b>: </b><span>a ∉ set_remove x s</span></span></span><br><span><var>H4</var><span class="hyp-type"><b>: </b><span>NoDup (set_remove x s)</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">a ∉ s</div></blockquote><div class="alectryon-extra-goals"><input class="alectryon-extra-goal-toggle" id="ListSetExtras-v-chk101" style="display: none" type="checkbox"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>A</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>EqDecision0</var><span class="hyp-type"><b>: </b><span>EqDecision A</span></span></span><br><span><var>x, a</var><span class="hyp-type"><b>: </b><span>A</span></span></span><br><span><var>s</var><span class="hyp-type"><b>: </b><span>list A</span></span></span><br><span><var>IHs</var><span class="hyp-type"><b>: </b><span>NoDup (set_remove x s)
→ x ∉ set_remove x s → NoDup s</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>NoDup (a :: set_remove x s)</span></span></span><br><span><var>n</var><span class="hyp-type"><b>: </b><span>x ≠ a</span></span></span><br><span><var>H0</var><span class="hyp-type"><b>: </b><span>¬ (x = a ∨ x ∈ set_remove x s)</span></span></span><br><span><var>H3</var><span class="hyp-type"><b>: </b><span>a ∉ set_remove x s</span></span></span><br><span><var>H4</var><span class="hyp-type"><b>: </b><span>NoDup (set_remove x s)</span></span></span><br></div><label class="goal-separator" for="ListSetExtras-v-chk101"><hr></label><div class="goal-conclusion">NoDup s</div></blockquote></div></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">      </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="ListSetExtras-v-chk102" style="display: none" type="checkbox"><label class="alectryon-input" for="ListSetExtras-v-chk102">*</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>A</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>EqDecision0</var><span class="hyp-type"><b>: </b><span>EqDecision A</span></span></span><br><span><var>x, a</var><span class="hyp-type"><b>: </b><span>A</span></span></span><br><span><var>s</var><span class="hyp-type"><b>: </b><span>list A</span></span></span><br><span><var>IHs</var><span class="hyp-type"><b>: </b><span>NoDup (set_remove x s)
→ x ∉ set_remove x s → NoDup s</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>NoDup (a :: set_remove x s)</span></span></span><br><span><var>n</var><span class="hyp-type"><b>: </b><span>x ≠ a</span></span></span><br><span><var>H0</var><span class="hyp-type"><b>: </b><span>¬ (x = a ∨ x ∈ set_remove x s)</span></span></span><br><span><var>H3</var><span class="hyp-type"><b>: </b><span>a ∉ set_remove x s</span></span></span><br><span><var>H4</var><span class="hyp-type"><b>: </b><span>NoDup (set_remove x s)</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">a ∉ s</div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="nb">intro</span> Ha; <span class="nb">apply</span> (set_remove_3 _ x) <span class="kr">in</span> Ha; <span class="nb">auto</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">      </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="ListSetExtras-v-chk103" style="display: none" type="checkbox"><label class="alectryon-input" for="ListSetExtras-v-chk103">*</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>A</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>EqDecision0</var><span class="hyp-type"><b>: </b><span>EqDecision A</span></span></span><br><span><var>x, a</var><span class="hyp-type"><b>: </b><span>A</span></span></span><br><span><var>s</var><span class="hyp-type"><b>: </b><span>list A</span></span></span><br><span><var>IHs</var><span class="hyp-type"><b>: </b><span>NoDup (set_remove x s)
→ x ∉ set_remove x s → NoDup s</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>NoDup (a :: set_remove x s)</span></span></span><br><span><var>n</var><span class="hyp-type"><b>: </b><span>x ≠ a</span></span></span><br><span><var>H0</var><span class="hyp-type"><b>: </b><span>¬ (x = a ∨ x ∈ set_remove x s)</span></span></span><br><span><var>H3</var><span class="hyp-type"><b>: </b><span>a ∉ set_remove x s</span></span></span><br><span><var>H4</var><span class="hyp-type"><b>: </b><span>NoDup (set_remove x s)</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">NoDup s</div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="ListSetExtras-v-chk104" style="display: none" type="checkbox"><label class="alectryon-input" for="ListSetExtras-v-chk104"><span class="nb">apply</span> IHs; [<span class="bp">done</span> |].</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>A</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>EqDecision0</var><span class="hyp-type"><b>: </b><span>EqDecision A</span></span></span><br><span><var>x, a</var><span class="hyp-type"><b>: </b><span>A</span></span></span><br><span><var>s</var><span class="hyp-type"><b>: </b><span>list A</span></span></span><br><span><var>IHs</var><span class="hyp-type"><b>: </b><span>NoDup (set_remove x s)
→ x ∉ set_remove x s → NoDup s</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>NoDup (a :: set_remove x s)</span></span></span><br><span><var>n</var><span class="hyp-type"><b>: </b><span>x ≠ a</span></span></span><br><span><var>H0</var><span class="hyp-type"><b>: </b><span>¬ (x = a ∨ x ∈ set_remove x s)</span></span></span><br><span><var>H3</var><span class="hyp-type"><b>: </b><span>a ∉ set_remove x s</span></span></span><br><span><var>H4</var><span class="hyp-type"><b>: </b><span>NoDup (set_remove x s)</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">x ∉ set_remove x s</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">        </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="ListSetExtras-v-chk105" style="display: none" type="checkbox"><label class="alectryon-input" for="ListSetExtras-v-chk105"><span class="nb">intro</span> Hx.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>A</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>EqDecision0</var><span class="hyp-type"><b>: </b><span>EqDecision A</span></span></span><br><span><var>x, a</var><span class="hyp-type"><b>: </b><span>A</span></span></span><br><span><var>s</var><span class="hyp-type"><b>: </b><span>list A</span></span></span><br><span><var>IHs</var><span class="hyp-type"><b>: </b><span>NoDup (set_remove x s)
→ x ∉ set_remove x s → NoDup s</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>NoDup (a :: set_remove x s)</span></span></span><br><span><var>n</var><span class="hyp-type"><b>: </b><span>x ≠ a</span></span></span><br><span><var>H0</var><span class="hyp-type"><b>: </b><span>¬ (x = a ∨ x ∈ set_remove x s)</span></span></span><br><span><var>H3</var><span class="hyp-type"><b>: </b><span>a ∉ set_remove x s</span></span></span><br><span><var>H4</var><span class="hyp-type"><b>: </b><span>NoDup (set_remove x s)</span></span></span><br><span><var>Hx</var><span class="hyp-type"><b>: </b><span>x ∈ set_remove x s</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="kt">False</span></div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">        </span><span class="alectryon-sentence"><span class="alectryon-input"><span class="bp">by</span> <span class="bp">contradict</span> H0; <span class="nb">right</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Qed</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
</span><span class="alectryon-sentence"><input class="alectryon-toggle" id="ListSetExtras-v-chk106" style="display: none" type="checkbox"><label class="alectryon-input" for="ListSetExtras-v-chk106"><span class="kn">Lemma</span> <span class="nf">set_remove_elem_of_iff</span> `{EqDecision A} :  <span class="kr">forall</span> <span class="nv">x</span> <span class="nv">y</span> (<span class="nv">s</span> : list A),
  NoDup s -&gt;
  y ∈ s -&gt;
  x ∈ s &lt;-&gt; x = y \/ x ∈ (set_remove y s).</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>A</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>EqDecision0</var><span class="hyp-type"><b>: </b><span>EqDecision A</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="kr">∀</span> (<span class="nv">x</span> <span class="nv">y</span> : A) (<span class="nv">s</span> : list A),
  NoDup s → y ∈ s → x ∈ s ↔ x = y ∨ x ∈ set_remove y s</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="ListSetExtras-v-chk107" style="display: none" type="checkbox"><label class="alectryon-input" for="ListSetExtras-v-chk107"><span class="kn">Proof</span>.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>A</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>EqDecision0</var><span class="hyp-type"><b>: </b><span>EqDecision A</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="kr">∀</span> (<span class="nv">x</span> <span class="nv">y</span> : A) (<span class="nv">s</span> : list A),
  NoDup s → y ∈ s → x ∈ s ↔ x = y ∨ x ∈ set_remove y s</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="ListSetExtras-v-chk108" style="display: none" type="checkbox"><label class="alectryon-input" for="ListSetExtras-v-chk108"><span class="nb">intros</span>.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>A</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>EqDecision0</var><span class="hyp-type"><b>: </b><span>EqDecision A</span></span></span><br><span><var>x, y</var><span class="hyp-type"><b>: </b><span>A</span></span></span><br><span><var>s</var><span class="hyp-type"><b>: </b><span>list A</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>NoDup s</span></span></span><br><span><var>H0</var><span class="hyp-type"><b>: </b><span>y ∈ s</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">x ∈ s ↔ x = y ∨ x ∈ set_remove y s</div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="ListSetExtras-v-chk109" style="display: none" type="checkbox"><label class="alectryon-input" for="ListSetExtras-v-chk109"><span class="nb">split</span>; <span class="nb">intros</span>.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>A</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>EqDecision0</var><span class="hyp-type"><b>: </b><span>EqDecision A</span></span></span><br><span><var>x, y</var><span class="hyp-type"><b>: </b><span>A</span></span></span><br><span><var>s</var><span class="hyp-type"><b>: </b><span>list A</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>NoDup s</span></span></span><br><span><var>H0</var><span class="hyp-type"><b>: </b><span>y ∈ s</span></span></span><br><span><var>H1</var><span class="hyp-type"><b>: </b><span>x ∈ s</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">x = y ∨ x ∈ set_remove y s</div></blockquote><div class="alectryon-extra-goals"><input class="alectryon-extra-goal-toggle" id="ListSetExtras-v-chk10a" style="display: none" type="checkbox"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>A</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>EqDecision0</var><span class="hyp-type"><b>: </b><span>EqDecision A</span></span></span><br><span><var>x, y</var><span class="hyp-type"><b>: </b><span>A</span></span></span><br><span><var>s</var><span class="hyp-type"><b>: </b><span>list A</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>NoDup s</span></span></span><br><span><var>H0</var><span class="hyp-type"><b>: </b><span>y ∈ s</span></span></span><br><span><var>H1</var><span class="hyp-type"><b>: </b><span>x = y ∨ x ∈ set_remove y s</span></span></span><br></div><label class="goal-separator" for="ListSetExtras-v-chk10a"><hr></label><div class="goal-conclusion">x ∈ s</div></blockquote></div></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="ListSetExtras-v-chk10b" style="display: none" type="checkbox"><label class="alectryon-input" for="ListSetExtras-v-chk10b">-</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>A</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>EqDecision0</var><span class="hyp-type"><b>: </b><span>EqDecision A</span></span></span><br><span><var>x, y</var><span class="hyp-type"><b>: </b><span>A</span></span></span><br><span><var>s</var><span class="hyp-type"><b>: </b><span>list A</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>NoDup s</span></span></span><br><span><var>H0</var><span class="hyp-type"><b>: </b><span>y ∈ s</span></span></span><br><span><var>H1</var><span class="hyp-type"><b>: </b><span>x ∈ s</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">x = y ∨ x ∈ set_remove y s</div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="ListSetExtras-v-chk10c" style="display: none" type="checkbox"><label class="alectryon-input" for="ListSetExtras-v-chk10c"><span class="nb">destruct</span> (decide (x = y)).</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>A</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>EqDecision0</var><span class="hyp-type"><b>: </b><span>EqDecision A</span></span></span><br><span><var>x, y</var><span class="hyp-type"><b>: </b><span>A</span></span></span><br><span><var>s</var><span class="hyp-type"><b>: </b><span>list A</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>NoDup s</span></span></span><br><span><var>H0</var><span class="hyp-type"><b>: </b><span>y ∈ s</span></span></span><br><span><var>H1</var><span class="hyp-type"><b>: </b><span>x ∈ s</span></span></span><br><span><var>e</var><span class="hyp-type"><b>: </b><span>x = y</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">x = y ∨ x ∈ set_remove y s</div></blockquote><div class="alectryon-extra-goals"><input class="alectryon-extra-goal-toggle" id="ListSetExtras-v-chk10d" style="display: none" type="checkbox"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>A</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>EqDecision0</var><span class="hyp-type"><b>: </b><span>EqDecision A</span></span></span><br><span><var>x, y</var><span class="hyp-type"><b>: </b><span>A</span></span></span><br><span><var>s</var><span class="hyp-type"><b>: </b><span>list A</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>NoDup s</span></span></span><br><span><var>H0</var><span class="hyp-type"><b>: </b><span>y ∈ s</span></span></span><br><span><var>H1</var><span class="hyp-type"><b>: </b><span>x ∈ s</span></span></span><br><span><var>n</var><span class="hyp-type"><b>: </b><span>x ≠ y</span></span></span><br></div><label class="goal-separator" for="ListSetExtras-v-chk10d"><hr></label><div class="goal-conclusion">x = y ∨ x ∈ set_remove y s</div></blockquote></div></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="ListSetExtras-v-chk10e" style="display: none" type="checkbox"><label class="alectryon-input" for="ListSetExtras-v-chk10e">+</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>A</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>EqDecision0</var><span class="hyp-type"><b>: </b><span>EqDecision A</span></span></span><br><span><var>x, y</var><span class="hyp-type"><b>: </b><span>A</span></span></span><br><span><var>s</var><span class="hyp-type"><b>: </b><span>list A</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>NoDup s</span></span></span><br><span><var>H0</var><span class="hyp-type"><b>: </b><span>y ∈ s</span></span></span><br><span><var>H1</var><span class="hyp-type"><b>: </b><span>x ∈ s</span></span></span><br><span><var>e</var><span class="hyp-type"><b>: </b><span>x = y</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">x = y ∨ x ∈ set_remove y s</div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="bp">by</span> <span class="nb">left</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="ListSetExtras-v-chk10f" style="display: none" type="checkbox"><label class="alectryon-input" for="ListSetExtras-v-chk10f">+</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>A</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>EqDecision0</var><span class="hyp-type"><b>: </b><span>EqDecision A</span></span></span><br><span><var>x, y</var><span class="hyp-type"><b>: </b><span>A</span></span></span><br><span><var>s</var><span class="hyp-type"><b>: </b><span>list A</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>NoDup s</span></span></span><br><span><var>H0</var><span class="hyp-type"><b>: </b><span>y ∈ s</span></span></span><br><span><var>H1</var><span class="hyp-type"><b>: </b><span>x ∈ s</span></span></span><br><span><var>n</var><span class="hyp-type"><b>: </b><span>x ≠ y</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">x = y ∨ x ∈ set_remove y s</div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="bp">by</span> <span class="nb">right</span>; <span class="nb">apply</span> set_remove_3.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="ListSetExtras-v-chk110" style="display: none" type="checkbox"><label class="alectryon-input" for="ListSetExtras-v-chk110">-</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>A</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>EqDecision0</var><span class="hyp-type"><b>: </b><span>EqDecision A</span></span></span><br><span><var>x, y</var><span class="hyp-type"><b>: </b><span>A</span></span></span><br><span><var>s</var><span class="hyp-type"><b>: </b><span>list A</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>NoDup s</span></span></span><br><span><var>H0</var><span class="hyp-type"><b>: </b><span>y ∈ s</span></span></span><br><span><var>H1</var><span class="hyp-type"><b>: </b><span>x = y ∨ x ∈ set_remove y s</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">x ∈ s</div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="ListSetExtras-v-chk111" style="display: none" type="checkbox"><label class="alectryon-input" for="ListSetExtras-v-chk111"><span class="nb">destruct</span> H1 <span class="kr">as</span> [Heq | Hin].</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>A</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>EqDecision0</var><span class="hyp-type"><b>: </b><span>EqDecision A</span></span></span><br><span><var>x, y</var><span class="hyp-type"><b>: </b><span>A</span></span></span><br><span><var>s</var><span class="hyp-type"><b>: </b><span>list A</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>NoDup s</span></span></span><br><span><var>H0</var><span class="hyp-type"><b>: </b><span>y ∈ s</span></span></span><br><span><var>Heq</var><span class="hyp-type"><b>: </b><span>x = y</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">x ∈ s</div></blockquote><div class="alectryon-extra-goals"><input class="alectryon-extra-goal-toggle" id="ListSetExtras-v-chk112" style="display: none" type="checkbox"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>A</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>EqDecision0</var><span class="hyp-type"><b>: </b><span>EqDecision A</span></span></span><br><span><var>x, y</var><span class="hyp-type"><b>: </b><span>A</span></span></span><br><span><var>s</var><span class="hyp-type"><b>: </b><span>list A</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>NoDup s</span></span></span><br><span><var>H0</var><span class="hyp-type"><b>: </b><span>y ∈ s</span></span></span><br><span><var>Hin</var><span class="hyp-type"><b>: </b><span>x ∈ set_remove y s</span></span></span><br></div><label class="goal-separator" for="ListSetExtras-v-chk112"><hr></label><div class="goal-conclusion">x ∈ s</div></blockquote></div></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="ListSetExtras-v-chk113" style="display: none" type="checkbox"><label class="alectryon-input" for="ListSetExtras-v-chk113">+</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>A</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>EqDecision0</var><span class="hyp-type"><b>: </b><span>EqDecision A</span></span></span><br><span><var>x, y</var><span class="hyp-type"><b>: </b><span>A</span></span></span><br><span><var>s</var><span class="hyp-type"><b>: </b><span>list A</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>NoDup s</span></span></span><br><span><var>H0</var><span class="hyp-type"><b>: </b><span>y ∈ s</span></span></span><br><span><var>Heq</var><span class="hyp-type"><b>: </b><span>x = y</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">x ∈ s</div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="bp">by</span> <span class="nb">subst</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="ListSetExtras-v-chk114" style="display: none" type="checkbox"><label class="alectryon-input" for="ListSetExtras-v-chk114">+</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>A</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>EqDecision0</var><span class="hyp-type"><b>: </b><span>EqDecision A</span></span></span><br><span><var>x, y</var><span class="hyp-type"><b>: </b><span>A</span></span></span><br><span><var>s</var><span class="hyp-type"><b>: </b><span>list A</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>NoDup s</span></span></span><br><span><var>H0</var><span class="hyp-type"><b>: </b><span>y ∈ s</span></span></span><br><span><var>Hin</var><span class="hyp-type"><b>: </b><span>x ∈ set_remove y s</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">x ∈ s</div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="bp">by</span> <span class="nb">apply</span> set_remove_1 <span class="kr">in</span> Hin.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Qed</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
</span><span class="alectryon-sentence"><input class="alectryon-toggle" id="ListSetExtras-v-chk115" style="display: none" type="checkbox"><label class="alectryon-input" for="ListSetExtras-v-chk115"><span class="kn">Lemma</span> <span class="nf">set_add_length</span>
  `{EqDecision A}
  (x : A)
  (s : <span class="nb">set</span> A)
  (Hx : x ∉ s)
  : S (length s) = length (set_add x s).</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>A</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>EqDecision0</var><span class="hyp-type"><b>: </b><span>EqDecision A</span></span></span><br><span><var>x</var><span class="hyp-type"><b>: </b><span>A</span></span></span><br><span><var>s</var><span class="hyp-type"><b>: </b><span><span class="nb">set</span> A</span></span></span><br><span><var>Hx</var><span class="hyp-type"><b>: </b><span>x ∉ s</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">S (length s) = length (set_add x s)</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="ListSetExtras-v-chk116" style="display: none" type="checkbox"><label class="alectryon-input" for="ListSetExtras-v-chk116"><span class="kn">Proof</span>.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>A</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>EqDecision0</var><span class="hyp-type"><b>: </b><span>EqDecision A</span></span></span><br><span><var>x</var><span class="hyp-type"><b>: </b><span>A</span></span></span><br><span><var>s</var><span class="hyp-type"><b>: </b><span><span class="nb">set</span> A</span></span></span><br><span><var>Hx</var><span class="hyp-type"><b>: </b><span>x ∉ s</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">S (length s) = length (set_add x s)</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="ListSetExtras-v-chk117" style="display: none" type="checkbox"><label class="alectryon-input" for="ListSetExtras-v-chk117"><span class="nb">revert</span> x Hx.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>A</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>EqDecision0</var><span class="hyp-type"><b>: </b><span>EqDecision A</span></span></span><br><span><var>s</var><span class="hyp-type"><b>: </b><span><span class="nb">set</span> A</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="kr">∀</span> <span class="nv">x</span> : A, x ∉ s → S (length s) = length (set_add x s)</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="ListSetExtras-v-chk118" style="display: none" type="checkbox"><label class="alectryon-input" for="ListSetExtras-v-chk118"><span class="nb">induction</span> s; <span class="nb">intros</span>; [<span class="bp">done</span> |].</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>A</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>EqDecision0</var><span class="hyp-type"><b>: </b><span>EqDecision A</span></span></span><br><span><var>a</var><span class="hyp-type"><b>: </b><span>A</span></span></span><br><span><var>s</var><span class="hyp-type"><b>: </b><span>list A</span></span></span><br><span><var>IHs</var><span class="hyp-type"><b>: </b><span><span class="kr">∀</span> <span class="nv">x</span> : A,
  x ∉ s → S (length s) = length (set_add x s)</span></span></span><br><span><var>x</var><span class="hyp-type"><b>: </b><span>A</span></span></span><br><span><var>Hx</var><span class="hyp-type"><b>: </b><span>x ∉ a :: s</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">S (length (a :: s)) = length (set_add x (a :: s))</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="ListSetExtras-v-chk119" style="display: none" type="checkbox"><label class="alectryon-input" for="ListSetExtras-v-chk119"><span class="nb">simpl</span>.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>A</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>EqDecision0</var><span class="hyp-type"><b>: </b><span>EqDecision A</span></span></span><br><span><var>a</var><span class="hyp-type"><b>: </b><span>A</span></span></span><br><span><var>s</var><span class="hyp-type"><b>: </b><span>list A</span></span></span><br><span><var>IHs</var><span class="hyp-type"><b>: </b><span><span class="kr">∀</span> <span class="nv">x</span> : A,
  x ∉ s → S (length s) = length (set_add x s)</span></span></span><br><span><var>x</var><span class="hyp-type"><b>: </b><span>A</span></span></span><br><span><var>Hx</var><span class="hyp-type"><b>: </b><span>x ∉ a :: s</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">S (S (length s)) =
length
  (<span class="kr">if</span> decide (x = a) <span class="kr">then</span> a :: s <span class="kr">else</span> a :: set_add x s)</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="ListSetExtras-v-chk11a" style="display: none" type="checkbox"><label class="alectryon-input" for="ListSetExtras-v-chk11a"><span class="nb">destruct</span> (decide (x = a)); [<span class="nb">subst</span>; <span class="nb">elim</span> Hx; <span class="nb">left</span>|].</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>A</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>EqDecision0</var><span class="hyp-type"><b>: </b><span>EqDecision A</span></span></span><br><span><var>a</var><span class="hyp-type"><b>: </b><span>A</span></span></span><br><span><var>s</var><span class="hyp-type"><b>: </b><span>list A</span></span></span><br><span><var>IHs</var><span class="hyp-type"><b>: </b><span><span class="kr">∀</span> <span class="nv">x</span> : A,
  x ∉ s → S (length s) = length (set_add x s)</span></span></span><br><span><var>x</var><span class="hyp-type"><b>: </b><span>A</span></span></span><br><span><var>Hx</var><span class="hyp-type"><b>: </b><span>x ∉ a :: s</span></span></span><br><span><var>n</var><span class="hyp-type"><b>: </b><span>x ≠ a</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">S (S (length s)) = length (a :: set_add x s)</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="ListSetExtras-v-chk11b" style="display: none" type="checkbox"><label class="alectryon-input" for="ListSetExtras-v-chk11b"><span class="nb">simpl</span>.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>A</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>EqDecision0</var><span class="hyp-type"><b>: </b><span>EqDecision A</span></span></span><br><span><var>a</var><span class="hyp-type"><b>: </b><span>A</span></span></span><br><span><var>s</var><span class="hyp-type"><b>: </b><span>list A</span></span></span><br><span><var>IHs</var><span class="hyp-type"><b>: </b><span><span class="kr">∀</span> <span class="nv">x</span> : A,
  x ∉ s → S (length s) = length (set_add x s)</span></span></span><br><span><var>x</var><span class="hyp-type"><b>: </b><span>A</span></span></span><br><span><var>Hx</var><span class="hyp-type"><b>: </b><span>x ∉ a :: s</span></span></span><br><span><var>n</var><span class="hyp-type"><b>: </b><span>x ≠ a</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">S (S (length s)) = S (length (set_add x s))</div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="ListSetExtras-v-chk11c" style="display: none" type="checkbox"><label class="alectryon-input" for="ListSetExtras-v-chk11c"><span class="nb">f_equal</span>.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>A</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>EqDecision0</var><span class="hyp-type"><b>: </b><span>EqDecision A</span></span></span><br><span><var>a</var><span class="hyp-type"><b>: </b><span>A</span></span></span><br><span><var>s</var><span class="hyp-type"><b>: </b><span>list A</span></span></span><br><span><var>IHs</var><span class="hyp-type"><b>: </b><span><span class="kr">∀</span> <span class="nv">x</span> : A,
  x ∉ s → S (length s) = length (set_add x s)</span></span></span><br><span><var>x</var><span class="hyp-type"><b>: </b><span>A</span></span></span><br><span><var>Hx</var><span class="hyp-type"><b>: </b><span>x ∉ a :: s</span></span></span><br><span><var>n</var><span class="hyp-type"><b>: </b><span>x ≠ a</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">S (length s) = length (set_add x s)</div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="ListSetExtras-v-chk11d" style="display: none" type="checkbox"><label class="alectryon-input" for="ListSetExtras-v-chk11d"><span class="nb">apply</span> IHs.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>A</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>EqDecision0</var><span class="hyp-type"><b>: </b><span>EqDecision A</span></span></span><br><span><var>a</var><span class="hyp-type"><b>: </b><span>A</span></span></span><br><span><var>s</var><span class="hyp-type"><b>: </b><span>list A</span></span></span><br><span><var>IHs</var><span class="hyp-type"><b>: </b><span><span class="kr">∀</span> <span class="nv">x</span> : A,
  x ∉ s → S (length s) = length (set_add x s)</span></span></span><br><span><var>x</var><span class="hyp-type"><b>: </b><span>A</span></span></span><br><span><var>Hx</var><span class="hyp-type"><b>: </b><span>x ∉ a :: s</span></span></span><br><span><var>n</var><span class="hyp-type"><b>: </b><span>x ≠ a</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">x ∉ s</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><span class="alectryon-input"><span class="bp">by</span> <span class="nb">intro</span> Hs; <span class="nb">elim</span> Hx; <span class="nb">right</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Qed</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
</span><span class="alectryon-sentence"><input class="alectryon-toggle" id="ListSetExtras-v-chk11e" style="display: none" type="checkbox"><label class="alectryon-input" for="ListSetExtras-v-chk11e"><span class="kn">Lemma</span> <span class="nf">set_remove_length</span>
  `{EqDecision A}
  (x : A)
  (s : <span class="nb">set</span> A)
  (Hx : x ∈ s)
  : length s = S (length (set_remove x s)).</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>A</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>EqDecision0</var><span class="hyp-type"><b>: </b><span>EqDecision A</span></span></span><br><span><var>x</var><span class="hyp-type"><b>: </b><span>A</span></span></span><br><span><var>s</var><span class="hyp-type"><b>: </b><span><span class="nb">set</span> A</span></span></span><br><span><var>Hx</var><span class="hyp-type"><b>: </b><span>x ∈ s</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">length s = S (length (set_remove x s))</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="ListSetExtras-v-chk11f" style="display: none" type="checkbox"><label class="alectryon-input" for="ListSetExtras-v-chk11f"><span class="kn">Proof</span>.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>A</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>EqDecision0</var><span class="hyp-type"><b>: </b><span>EqDecision A</span></span></span><br><span><var>x</var><span class="hyp-type"><b>: </b><span>A</span></span></span><br><span><var>s</var><span class="hyp-type"><b>: </b><span><span class="nb">set</span> A</span></span></span><br><span><var>Hx</var><span class="hyp-type"><b>: </b><span>x ∈ s</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">length s = S (length (set_remove x s))</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="ListSetExtras-v-chk120" style="display: none" type="checkbox"><label class="alectryon-input" for="ListSetExtras-v-chk120"><span class="nb">generalize dependent</span> x.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>A</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>EqDecision0</var><span class="hyp-type"><b>: </b><span>EqDecision A</span></span></span><br><span><var>s</var><span class="hyp-type"><b>: </b><span><span class="nb">set</span> A</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="kr">∀</span> <span class="nv">x</span> : A,
  x ∈ s → length s = S (length (set_remove x s))</div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="ListSetExtras-v-chk121" style="display: none" type="checkbox"><label class="alectryon-input" for="ListSetExtras-v-chk121"><span class="nb">induction</span> s; <span class="nb">intros</span>; <span class="nb">inversion</span> Hx; <span class="nb">subst</span>.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>A</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>EqDecision0</var><span class="hyp-type"><b>: </b><span>EqDecision A</span></span></span><br><span><var>a</var><span class="hyp-type"><b>: </b><span>A</span></span></span><br><span><var>s</var><span class="hyp-type"><b>: </b><span>list A</span></span></span><br><span><var>IHs</var><span class="hyp-type"><b>: </b><span><span class="kr">∀</span> <span class="nv">x</span> : A,
  x ∈ s → length s = S (length (set_remove x s))</span></span></span><br><span><var>Hx</var><span class="hyp-type"><b>: </b><span>a ∈ a :: s</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">length (a :: s) = S (length (set_remove a (a :: s)))</div></blockquote><div class="alectryon-extra-goals"><input class="alectryon-extra-goal-toggle" id="ListSetExtras-v-chk122" style="display: none" type="checkbox"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>A</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>EqDecision0</var><span class="hyp-type"><b>: </b><span>EqDecision A</span></span></span><br><span><var>a</var><span class="hyp-type"><b>: </b><span>A</span></span></span><br><span><var>s</var><span class="hyp-type"><b>: </b><span>list A</span></span></span><br><span><var>IHs</var><span class="hyp-type"><b>: </b><span><span class="kr">∀</span> <span class="nv">x</span> : A,
  x ∈ s → length s = S (length (set_remove x s))</span></span></span><br><span><var>x</var><span class="hyp-type"><b>: </b><span>A</span></span></span><br><span><var>Hx</var><span class="hyp-type"><b>: </b><span>x ∈ a :: s</span></span></span><br><span><var>H1</var><span class="hyp-type"><b>: </b><span>x ∈ s</span></span></span><br></div><label class="goal-separator" for="ListSetExtras-v-chk122"><hr></label><div class="goal-conclusion">length (a :: s) = S (length (set_remove x (a :: s)))</div></blockquote></div></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="ListSetExtras-v-chk123" style="display: none" type="checkbox"><label class="alectryon-input" for="ListSetExtras-v-chk123">-</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>A</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>EqDecision0</var><span class="hyp-type"><b>: </b><span>EqDecision A</span></span></span><br><span><var>a</var><span class="hyp-type"><b>: </b><span>A</span></span></span><br><span><var>s</var><span class="hyp-type"><b>: </b><span>list A</span></span></span><br><span><var>IHs</var><span class="hyp-type"><b>: </b><span><span class="kr">∀</span> <span class="nv">x</span> : A,
  x ∈ s → length s = S (length (set_remove x s))</span></span></span><br><span><var>Hx</var><span class="hyp-type"><b>: </b><span>a ∈ a :: s</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">length (a :: s) = S (length (set_remove a (a :: s)))</div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="bp">by</span> <span class="nb">rewrite</span> set_remove_first.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="ListSetExtras-v-chk124" style="display: none" type="checkbox"><label class="alectryon-input" for="ListSetExtras-v-chk124">-</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>A</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>EqDecision0</var><span class="hyp-type"><b>: </b><span>EqDecision A</span></span></span><br><span><var>a</var><span class="hyp-type"><b>: </b><span>A</span></span></span><br><span><var>s</var><span class="hyp-type"><b>: </b><span>list A</span></span></span><br><span><var>IHs</var><span class="hyp-type"><b>: </b><span><span class="kr">∀</span> <span class="nv">x</span> : A,
  x ∈ s → length s = S (length (set_remove x s))</span></span></span><br><span><var>x</var><span class="hyp-type"><b>: </b><span>A</span></span></span><br><span><var>Hx</var><span class="hyp-type"><b>: </b><span>x ∈ a :: s</span></span></span><br><span><var>H1</var><span class="hyp-type"><b>: </b><span>x ∈ s</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">length (a :: s) = S (length (set_remove x (a :: s)))</div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="ListSetExtras-v-chk125" style="display: none" type="checkbox"><label class="alectryon-input" for="ListSetExtras-v-chk125"><span class="nb">cbn</span>.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>A</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>EqDecision0</var><span class="hyp-type"><b>: </b><span>EqDecision A</span></span></span><br><span><var>a</var><span class="hyp-type"><b>: </b><span>A</span></span></span><br><span><var>s</var><span class="hyp-type"><b>: </b><span>list A</span></span></span><br><span><var>IHs</var><span class="hyp-type"><b>: </b><span><span class="kr">∀</span> <span class="nv">x</span> : A,
  x ∈ s → length s = S (length (set_remove x s))</span></span></span><br><span><var>x</var><span class="hyp-type"><b>: </b><span>A</span></span></span><br><span><var>Hx</var><span class="hyp-type"><b>: </b><span>x ∈ a :: s</span></span></span><br><span><var>H1</var><span class="hyp-type"><b>: </b><span>x ∈ s</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">S (length s) =
S
  (length
     (<span class="kr">if</span> decide (x = a)
      <span class="kr">then</span> s
      <span class="kr">else</span> a :: set_remove x s))</div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="nb">destruct</span> (decide (x = a)); <span class="nb">firstorder</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Qed</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
</span><span class="alectryon-sentence"><input class="alectryon-toggle" id="ListSetExtras-v-chk126" style="display: none" type="checkbox"><label class="alectryon-input" for="ListSetExtras-v-chk126"><span class="kn">Lemma</span> <span class="nf">set_eq_remove</span> `{EqDecision A} : <span class="kr">forall</span> <span class="nv">x</span> (<span class="nv">s1</span> <span class="nv">s2</span> : list A),
  NoDup s1 -&gt;
  NoDup s2 -&gt;
  set_eq s1 s2 -&gt;
  set_eq (set_remove x s1) (set_remove x s2).</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>A</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>EqDecision0</var><span class="hyp-type"><b>: </b><span>EqDecision A</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="kr">∀</span> (<span class="nv">x</span> : A) (<span class="nv">s1</span> <span class="nv">s2</span> : list A),
  NoDup s1
  → NoDup s2
    → set_eq s1 s2
      → set_eq (set_remove x s1) (set_remove x s2)</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="ListSetExtras-v-chk127" style="display: none" type="checkbox"><label class="alectryon-input" for="ListSetExtras-v-chk127"><span class="kn">Proof</span>.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>A</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>EqDecision0</var><span class="hyp-type"><b>: </b><span>EqDecision A</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="kr">∀</span> (<span class="nv">x</span> : A) (<span class="nv">s1</span> <span class="nv">s2</span> : list A),
  NoDup s1
  → NoDup s2
    → set_eq s1 s2
      → set_eq (set_remove x s1) (set_remove x s2)</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="ListSetExtras-v-chk128" style="display: none" type="checkbox"><label class="alectryon-input" for="ListSetExtras-v-chk128"><span class="nb">intros</span> x s1 s2 HND1 HND2 [].</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>A</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>EqDecision0</var><span class="hyp-type"><b>: </b><span>EqDecision A</span></span></span><br><span><var>x</var><span class="hyp-type"><b>: </b><span>A</span></span></span><br><span><var>s1, s2</var><span class="hyp-type"><b>: </b><span>list A</span></span></span><br><span><var>HND1</var><span class="hyp-type"><b>: </b><span>NoDup s1</span></span></span><br><span><var>HND2</var><span class="hyp-type"><b>: </b><span>NoDup s2</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>s1 ⊆ s2</span></span></span><br><span><var>H0</var><span class="hyp-type"><b>: </b><span>s2 ⊆ s1</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">set_eq (set_remove x s1) (set_remove x s2)</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><span class="alectryon-input"><span class="nb">split</span>; <span class="nb">intros</span> a Hin; <span class="nb">rewrite</span> set_remove_iff <span class="kr">in</span> *; itauto.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Qed</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
</span><span class="alectryon-sentence"><input class="alectryon-toggle" id="ListSetExtras-v-chk129" style="display: none" type="checkbox"><label class="alectryon-input" for="ListSetExtras-v-chk129"><span class="kn">Lemma</span> <span class="nf">subseteq_remove_union</span> `{EqDecision A} : <span class="kr">forall</span> <span class="nv">x</span> (<span class="nv">s1</span> <span class="nv">s2</span> : list A),
  NoDup s1 -&gt;
  NoDup s2 -&gt;
  (set_remove x (set_union s1 s2)) ⊆
  (set_union s1 (set_remove x s2)).</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>A</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>EqDecision0</var><span class="hyp-type"><b>: </b><span>EqDecision A</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="kr">∀</span> (<span class="nv">x</span> : A) (<span class="nv">s1</span> <span class="nv">s2</span> : list A),
  NoDup s1
  → NoDup s2
    → set_remove x (set_union s1 s2)
      ⊆ set_union s1 (set_remove x s2)</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="ListSetExtras-v-chk12a" style="display: none" type="checkbox"><label class="alectryon-input" for="ListSetExtras-v-chk12a"><span class="kn">Proof</span>.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>A</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>EqDecision0</var><span class="hyp-type"><b>: </b><span>EqDecision A</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="kr">∀</span> (<span class="nv">x</span> : A) (<span class="nv">s1</span> <span class="nv">s2</span> : list A),
  NoDup s1
  → NoDup s2
    → set_remove x (set_union s1 s2)
      ⊆ set_union s1 (set_remove x s2)</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="ListSetExtras-v-chk12b" style="display: none" type="checkbox"><label class="alectryon-input" for="ListSetExtras-v-chk12b"><span class="nb">intros</span>.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>A</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>EqDecision0</var><span class="hyp-type"><b>: </b><span>EqDecision A</span></span></span><br><span><var>x</var><span class="hyp-type"><b>: </b><span>A</span></span></span><br><span><var>s1, s2</var><span class="hyp-type"><b>: </b><span>list A</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>NoDup s1</span></span></span><br><span><var>H0</var><span class="hyp-type"><b>: </b><span>NoDup s2</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">set_remove x (set_union s1 s2)
⊆ set_union s1 (set_remove x s2)</div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="ListSetExtras-v-chk12c" style="display: none" type="checkbox"><label class="alectryon-input" for="ListSetExtras-v-chk12c"><span class="nb">intros</span> y Hin.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>A</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>EqDecision0</var><span class="hyp-type"><b>: </b><span>EqDecision A</span></span></span><br><span><var>x</var><span class="hyp-type"><b>: </b><span>A</span></span></span><br><span><var>s1, s2</var><span class="hyp-type"><b>: </b><span>list A</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>NoDup s1</span></span></span><br><span><var>H0</var><span class="hyp-type"><b>: </b><span>NoDup s2</span></span></span><br><span><var>y</var><span class="hyp-type"><b>: </b><span>A</span></span></span><br><span><var>Hin</var><span class="hyp-type"><b>: </b><span>y ∈ set_remove x (set_union s1 s2)</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">y ∈ set_union s1 (set_remove x s2)</div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="ListSetExtras-v-chk12d" style="display: none" type="checkbox"><label class="alectryon-input" for="ListSetExtras-v-chk12d"><span class="nb">apply</span> set_remove_iff <span class="kr">in</span> Hin.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>A</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>EqDecision0</var><span class="hyp-type"><b>: </b><span>EqDecision A</span></span></span><br><span><var>x</var><span class="hyp-type"><b>: </b><span>A</span></span></span><br><span><var>s1, s2</var><span class="hyp-type"><b>: </b><span>list A</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>NoDup s1</span></span></span><br><span><var>H0</var><span class="hyp-type"><b>: </b><span>NoDup s2</span></span></span><br><span><var>y</var><span class="hyp-type"><b>: </b><span>A</span></span></span><br><span><var>Hin</var><span class="hyp-type"><b>: </b><span>y ∈ set_union s1 s2 ∧ y ≠ x</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">y ∈ set_union s1 (set_remove x s2)</div></blockquote><div class="alectryon-extra-goals"><input class="alectryon-extra-goal-toggle" id="ListSetExtras-v-chk12e" style="display: none" type="checkbox"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>A</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>EqDecision0</var><span class="hyp-type"><b>: </b><span>EqDecision A</span></span></span><br><span><var>x</var><span class="hyp-type"><b>: </b><span>A</span></span></span><br><span><var>s1, s2</var><span class="hyp-type"><b>: </b><span>list A</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>NoDup s1</span></span></span><br><span><var>H0</var><span class="hyp-type"><b>: </b><span>NoDup s2</span></span></span><br><span><var>y</var><span class="hyp-type"><b>: </b><span>A</span></span></span><br><span><var>Hin</var><span class="hyp-type"><b>: </b><span>y ∈ set_remove x (set_union s1 s2)</span></span></span><br><span><var>H1</var><span class="hyp-type"><b>: </b><span><span class="kr">∀</span> (<span class="nv">a</span> <span class="nv">b</span> : A) (<span class="nv">l</span> : <span class="nb">set</span> A),
  NoDup l → a ∈ set_remove b l → a ∈ l ∧ a ≠ b</span></span></span><br></div><label class="goal-separator" for="ListSetExtras-v-chk12e"><hr></label><div class="goal-conclusion">NoDup (set_union s1 s2)</div></blockquote></div></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="ListSetExtras-v-chk12f" style="display: none" type="checkbox"><label class="alectryon-input" for="ListSetExtras-v-chk12f">-</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>A</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>EqDecision0</var><span class="hyp-type"><b>: </b><span>EqDecision A</span></span></span><br><span><var>x</var><span class="hyp-type"><b>: </b><span>A</span></span></span><br><span><var>s1, s2</var><span class="hyp-type"><b>: </b><span>list A</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>NoDup s1</span></span></span><br><span><var>H0</var><span class="hyp-type"><b>: </b><span>NoDup s2</span></span></span><br><span><var>y</var><span class="hyp-type"><b>: </b><span>A</span></span></span><br><span><var>Hin</var><span class="hyp-type"><b>: </b><span>y ∈ set_union s1 s2 ∧ y ≠ x</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">y ∈ set_union s1 (set_remove x s2)</div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="ListSetExtras-v-chk130" style="display: none" type="checkbox"><label class="alectryon-input" for="ListSetExtras-v-chk130"><span class="nb">apply</span> set_union_intro.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>A</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>EqDecision0</var><span class="hyp-type"><b>: </b><span>EqDecision A</span></span></span><br><span><var>x</var><span class="hyp-type"><b>: </b><span>A</span></span></span><br><span><var>s1, s2</var><span class="hyp-type"><b>: </b><span>list A</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>NoDup s1</span></span></span><br><span><var>H0</var><span class="hyp-type"><b>: </b><span>NoDup s2</span></span></span><br><span><var>y</var><span class="hyp-type"><b>: </b><span>A</span></span></span><br><span><var>Hin</var><span class="hyp-type"><b>: </b><span>y ∈ set_union s1 s2 ∧ y ≠ x</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">y ∈ s1 ∨ y ∈ set_remove x s2</div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="ListSetExtras-v-chk131" style="display: none" type="checkbox"><label class="alectryon-input" for="ListSetExtras-v-chk131"><span class="nb">destruct</span> Hin.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>A</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>EqDecision0</var><span class="hyp-type"><b>: </b><span>EqDecision A</span></span></span><br><span><var>x</var><span class="hyp-type"><b>: </b><span>A</span></span></span><br><span><var>s1, s2</var><span class="hyp-type"><b>: </b><span>list A</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>NoDup s1</span></span></span><br><span><var>H0</var><span class="hyp-type"><b>: </b><span>NoDup s2</span></span></span><br><span><var>y</var><span class="hyp-type"><b>: </b><span>A</span></span></span><br><span><var>H1</var><span class="hyp-type"><b>: </b><span>y ∈ set_union s1 s2</span></span></span><br><span><var>H2</var><span class="hyp-type"><b>: </b><span>y ≠ x</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">y ∈ s1 ∨ y ∈ set_remove x s2</div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="ListSetExtras-v-chk132" style="display: none" type="checkbox"><label class="alectryon-input" for="ListSetExtras-v-chk132"><span class="nb">apply</span> set_union_elim <span class="kr">in</span> H1.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>A</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>EqDecision0</var><span class="hyp-type"><b>: </b><span>EqDecision A</span></span></span><br><span><var>x</var><span class="hyp-type"><b>: </b><span>A</span></span></span><br><span><var>s1, s2</var><span class="hyp-type"><b>: </b><span>list A</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>NoDup s1</span></span></span><br><span><var>H0</var><span class="hyp-type"><b>: </b><span>NoDup s2</span></span></span><br><span><var>y</var><span class="hyp-type"><b>: </b><span>A</span></span></span><br><span><var>H1</var><span class="hyp-type"><b>: </b><span>y ∈ s1 ∨ y ∈ s2</span></span></span><br><span><var>H2</var><span class="hyp-type"><b>: </b><span>y ≠ x</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">y ∈ s1 ∨ y ∈ set_remove x s2</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><span class="alectryon-input"><span class="nb">rewrite</span> set_remove_iff; itauto.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="ListSetExtras-v-chk133" style="display: none" type="checkbox"><label class="alectryon-input" for="ListSetExtras-v-chk133">-</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>A</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>EqDecision0</var><span class="hyp-type"><b>: </b><span>EqDecision A</span></span></span><br><span><var>x</var><span class="hyp-type"><b>: </b><span>A</span></span></span><br><span><var>s1, s2</var><span class="hyp-type"><b>: </b><span>list A</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>NoDup s1</span></span></span><br><span><var>H0</var><span class="hyp-type"><b>: </b><span>NoDup s2</span></span></span><br><span><var>y</var><span class="hyp-type"><b>: </b><span>A</span></span></span><br><span><var>Hin</var><span class="hyp-type"><b>: </b><span>y ∈ set_remove x (set_union s1 s2)</span></span></span><br><span><var>H1</var><span class="hyp-type"><b>: </b><span><span class="kr">∀</span> (<span class="nv">a</span> <span class="nv">b</span> : A) (<span class="nv">l</span> : <span class="nb">set</span> A),
  NoDup l → a ∈ set_remove b l → a ∈ l ∧ a ≠ b</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">NoDup (set_union s1 s2)</div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="bp">by</span> <span class="nb">apply</span> set_union_nodup.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Qed</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
</span><span class="alectryon-sentence"><input class="alectryon-toggle" id="ListSetExtras-v-chk134" style="display: none" type="checkbox"><label class="alectryon-input" for="ListSetExtras-v-chk134"><span class="kn">Lemma</span> <span class="nf">set_eq_remove_union_elem_of</span>  `{EqDecision A} : <span class="kr">forall</span> <span class="nv">x</span> (<span class="nv">s1</span> <span class="nv">s2</span> : list A),
  NoDup s1 -&gt;
  NoDup s2 -&gt;
  x ∈ s1 -&gt;
  set_eq (set_union s1 (set_remove x s2)) (set_union s1 s2).</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>A</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>EqDecision0</var><span class="hyp-type"><b>: </b><span>EqDecision A</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="kr">∀</span> (<span class="nv">x</span> : A) (<span class="nv">s1</span> <span class="nv">s2</span> : list A),
  NoDup s1
  → NoDup s2
    → x ∈ s1
      → set_eq (set_union s1 (set_remove x s2))
          (set_union s1 s2)</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="ListSetExtras-v-chk135" style="display: none" type="checkbox"><label class="alectryon-input" for="ListSetExtras-v-chk135"><span class="kn">Proof</span>.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>A</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>EqDecision0</var><span class="hyp-type"><b>: </b><span>EqDecision A</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="kr">∀</span> (<span class="nv">x</span> : A) (<span class="nv">s1</span> <span class="nv">s2</span> : list A),
  NoDup s1
  → NoDup s2
    → x ∈ s1
      → set_eq (set_union s1 (set_remove x s2))
          (set_union s1 s2)</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="ListSetExtras-v-chk136" style="display: none" type="checkbox"><label class="alectryon-input" for="ListSetExtras-v-chk136"><span class="nb">split</span>; <span class="nb">intros</span> msg Hin; <span class="nb">apply</span> set_union_iff; <span class="nb">apply</span> set_union_iff <span class="kr">in</span> Hin
  ; <span class="nb">destruct</span> Hin; <span class="kp">try</span> <span class="bp">by</span> <span class="nb">left</span>.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>A</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>EqDecision0</var><span class="hyp-type"><b>: </b><span>EqDecision A</span></span></span><br><span><var>x</var><span class="hyp-type"><b>: </b><span>A</span></span></span><br><span><var>s1, s2</var><span class="hyp-type"><b>: </b><span>list A</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>NoDup s1</span></span></span><br><span><var>H0</var><span class="hyp-type"><b>: </b><span>NoDup s2</span></span></span><br><span><var>H1</var><span class="hyp-type"><b>: </b><span>x ∈ s1</span></span></span><br><span><var>msg</var><span class="hyp-type"><b>: </b><span>A</span></span></span><br><span><var>H2</var><span class="hyp-type"><b>: </b><span>msg ∈ set_remove x s2</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">msg ∈ s1 ∨ msg ∈ s2</div></blockquote><div class="alectryon-extra-goals"><input class="alectryon-extra-goal-toggle" id="ListSetExtras-v-chk137" style="display: none" type="checkbox"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>A</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>EqDecision0</var><span class="hyp-type"><b>: </b><span>EqDecision A</span></span></span><br><span><var>x</var><span class="hyp-type"><b>: </b><span>A</span></span></span><br><span><var>s1, s2</var><span class="hyp-type"><b>: </b><span>list A</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>NoDup s1</span></span></span><br><span><var>H0</var><span class="hyp-type"><b>: </b><span>NoDup s2</span></span></span><br><span><var>H1</var><span class="hyp-type"><b>: </b><span>x ∈ s1</span></span></span><br><span><var>msg</var><span class="hyp-type"><b>: </b><span>A</span></span></span><br><span><var>H2</var><span class="hyp-type"><b>: </b><span>msg ∈ s2</span></span></span><br></div><label class="goal-separator" for="ListSetExtras-v-chk137"><hr></label><div class="goal-conclusion">msg ∈ s1 ∨ msg ∈ set_remove x s2</div></blockquote></div></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="ListSetExtras-v-chk138" style="display: none" type="checkbox"><label class="alectryon-input" for="ListSetExtras-v-chk138">-</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>A</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>EqDecision0</var><span class="hyp-type"><b>: </b><span>EqDecision A</span></span></span><br><span><var>x</var><span class="hyp-type"><b>: </b><span>A</span></span></span><br><span><var>s1, s2</var><span class="hyp-type"><b>: </b><span>list A</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>NoDup s1</span></span></span><br><span><var>H0</var><span class="hyp-type"><b>: </b><span>NoDup s2</span></span></span><br><span><var>H1</var><span class="hyp-type"><b>: </b><span>x ∈ s1</span></span></span><br><span><var>msg</var><span class="hyp-type"><b>: </b><span>A</span></span></span><br><span><var>H2</var><span class="hyp-type"><b>: </b><span>msg ∈ set_remove x s2</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">msg ∈ s1 ∨ msg ∈ s2</div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="nb">apply</span> set_remove_iff <span class="kr">in</span> H2; itauto.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="ListSetExtras-v-chk139" style="display: none" type="checkbox"><label class="alectryon-input" for="ListSetExtras-v-chk139">-</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>A</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>EqDecision0</var><span class="hyp-type"><b>: </b><span>EqDecision A</span></span></span><br><span><var>x</var><span class="hyp-type"><b>: </b><span>A</span></span></span><br><span><var>s1, s2</var><span class="hyp-type"><b>: </b><span>list A</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>NoDup s1</span></span></span><br><span><var>H0</var><span class="hyp-type"><b>: </b><span>NoDup s2</span></span></span><br><span><var>H1</var><span class="hyp-type"><b>: </b><span>x ∈ s1</span></span></span><br><span><var>msg</var><span class="hyp-type"><b>: </b><span>A</span></span></span><br><span><var>H2</var><span class="hyp-type"><b>: </b><span>msg ∈ s2</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">msg ∈ s1 ∨ msg ∈ set_remove x s2</div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="ListSetExtras-v-chk13a" style="display: none" type="checkbox"><label class="alectryon-input" for="ListSetExtras-v-chk13a"><span class="nb">destruct</span> (decide (msg = x)); <span class="nb">subst</span>.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>A</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>EqDecision0</var><span class="hyp-type"><b>: </b><span>EqDecision A</span></span></span><br><span><var>x</var><span class="hyp-type"><b>: </b><span>A</span></span></span><br><span><var>s1, s2</var><span class="hyp-type"><b>: </b><span>list A</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>NoDup s1</span></span></span><br><span><var>H0</var><span class="hyp-type"><b>: </b><span>NoDup s2</span></span></span><br><span><var>H1</var><span class="hyp-type"><b>: </b><span>x ∈ s1</span></span></span><br><span><var>H2</var><span class="hyp-type"><b>: </b><span>x ∈ s2</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">x ∈ s1 ∨ x ∈ set_remove x s2</div></blockquote><div class="alectryon-extra-goals"><input class="alectryon-extra-goal-toggle" id="ListSetExtras-v-chk13b" style="display: none" type="checkbox"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>A</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>EqDecision0</var><span class="hyp-type"><b>: </b><span>EqDecision A</span></span></span><br><span><var>x</var><span class="hyp-type"><b>: </b><span>A</span></span></span><br><span><var>s1, s2</var><span class="hyp-type"><b>: </b><span>list A</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>NoDup s1</span></span></span><br><span><var>H0</var><span class="hyp-type"><b>: </b><span>NoDup s2</span></span></span><br><span><var>H1</var><span class="hyp-type"><b>: </b><span>x ∈ s1</span></span></span><br><span><var>msg</var><span class="hyp-type"><b>: </b><span>A</span></span></span><br><span><var>H2</var><span class="hyp-type"><b>: </b><span>msg ∈ s2</span></span></span><br><span><var>n</var><span class="hyp-type"><b>: </b><span>msg ≠ x</span></span></span><br></div><label class="goal-separator" for="ListSetExtras-v-chk13b"><hr></label><div class="goal-conclusion">msg ∈ s1 ∨ msg ∈ set_remove x s2</div></blockquote></div></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="ListSetExtras-v-chk13c" style="display: none" type="checkbox"><label class="alectryon-input" for="ListSetExtras-v-chk13c">+</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>A</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>EqDecision0</var><span class="hyp-type"><b>: </b><span>EqDecision A</span></span></span><br><span><var>x</var><span class="hyp-type"><b>: </b><span>A</span></span></span><br><span><var>s1, s2</var><span class="hyp-type"><b>: </b><span>list A</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>NoDup s1</span></span></span><br><span><var>H0</var><span class="hyp-type"><b>: </b><span>NoDup s2</span></span></span><br><span><var>H1</var><span class="hyp-type"><b>: </b><span>x ∈ s1</span></span></span><br><span><var>H2</var><span class="hyp-type"><b>: </b><span>x ∈ s2</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">x ∈ s1 ∨ x ∈ set_remove x s2</div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="bp">by</span> <span class="nb">left</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="ListSetExtras-v-chk13d" style="display: none" type="checkbox"><label class="alectryon-input" for="ListSetExtras-v-chk13d">+</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>A</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>EqDecision0</var><span class="hyp-type"><b>: </b><span>EqDecision A</span></span></span><br><span><var>x</var><span class="hyp-type"><b>: </b><span>A</span></span></span><br><span><var>s1, s2</var><span class="hyp-type"><b>: </b><span>list A</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>NoDup s1</span></span></span><br><span><var>H0</var><span class="hyp-type"><b>: </b><span>NoDup s2</span></span></span><br><span><var>H1</var><span class="hyp-type"><b>: </b><span>x ∈ s1</span></span></span><br><span><var>msg</var><span class="hyp-type"><b>: </b><span>A</span></span></span><br><span><var>H2</var><span class="hyp-type"><b>: </b><span>msg ∈ s2</span></span></span><br><span><var>n</var><span class="hyp-type"><b>: </b><span>msg ≠ x</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">msg ∈ s1 ∨ msg ∈ set_remove x s2</div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="bp">by</span> <span class="nb">right</span>; <span class="nb">apply</span> set_remove_iff.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Qed</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
</span><span class="alectryon-sentence"><input class="alectryon-toggle" id="ListSetExtras-v-chk13e" style="display: none" type="checkbox"><label class="alectryon-input" for="ListSetExtras-v-chk13e"><span class="kn">Lemma</span> <span class="nf">set_eq_remove_union_not_elem_of</span>  `{EqDecision A} : <span class="kr">forall</span> <span class="nv">x</span> (<span class="nv">s1</span> <span class="nv">s2</span> : list A),
  NoDup s1 -&gt;
  NoDup s2 -&gt;
  ~ x ∈ s1 -&gt;
  set_eq (set_union s1 (set_remove x s2)) (set_remove x (set_union s1 s2)).</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>A</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>EqDecision0</var><span class="hyp-type"><b>: </b><span>EqDecision A</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="kr">∀</span> (<span class="nv">x</span> : A) (<span class="nv">s1</span> <span class="nv">s2</span> : list A),
  NoDup s1
  → NoDup s2
    → x ∉ s1
      → set_eq (set_union s1 (set_remove x s2))
          (set_remove x (set_union s1 s2))</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="ListSetExtras-v-chk13f" style="display: none" type="checkbox"><label class="alectryon-input" for="ListSetExtras-v-chk13f"><span class="kn">Proof</span>.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>A</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>EqDecision0</var><span class="hyp-type"><b>: </b><span>EqDecision A</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="kr">∀</span> (<span class="nv">x</span> : A) (<span class="nv">s1</span> <span class="nv">s2</span> : list A),
  NoDup s1
  → NoDup s2
    → x ∉ s1
      → set_eq (set_union s1 (set_remove x s2))
          (set_remove x (set_union s1 s2))</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="ListSetExtras-v-chk140" style="display: none" type="checkbox"><label class="alectryon-input" for="ListSetExtras-v-chk140"><span class="nb">intros</span>.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>A</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>EqDecision0</var><span class="hyp-type"><b>: </b><span>EqDecision A</span></span></span><br><span><var>x</var><span class="hyp-type"><b>: </b><span>A</span></span></span><br><span><var>s1, s2</var><span class="hyp-type"><b>: </b><span>list A</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>NoDup s1</span></span></span><br><span><var>H0</var><span class="hyp-type"><b>: </b><span>NoDup s2</span></span></span><br><span><var>H1</var><span class="hyp-type"><b>: </b><span>x ∉ s1</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">set_eq (set_union s1 (set_remove x s2))
  (set_remove x (set_union s1 s2))</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="ListSetExtras-v-chk141" style="display: none" type="checkbox"><label class="alectryon-input" for="ListSetExtras-v-chk141"><span class="nb">assert</span> (HnodupUs1s2 := H0).</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>A</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>EqDecision0</var><span class="hyp-type"><b>: </b><span>EqDecision A</span></span></span><br><span><var>x</var><span class="hyp-type"><b>: </b><span>A</span></span></span><br><span><var>s1, s2</var><span class="hyp-type"><b>: </b><span>list A</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>NoDup s1</span></span></span><br><span><var>H0</var><span class="hyp-type"><b>: </b><span>NoDup s2</span></span></span><br><span><var>H1</var><span class="hyp-type"><b>: </b><span>x ∉ s1</span></span></span><br><span><var>HnodupUs1s2</var><span class="hyp-type"><b>: </b><span>NoDup s2</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">set_eq (set_union s1 (set_remove x s2))
  (set_remove x (set_union s1 s2))</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="ListSetExtras-v-chk142" style="display: none" type="checkbox"><label class="alectryon-input" for="ListSetExtras-v-chk142"><span class="nb">apply</span> (set_union_nodup _ _ H) <span class="kr">in</span> HnodupUs1s2.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>A</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>EqDecision0</var><span class="hyp-type"><b>: </b><span>EqDecision A</span></span></span><br><span><var>x</var><span class="hyp-type"><b>: </b><span>A</span></span></span><br><span><var>s1, s2</var><span class="hyp-type"><b>: </b><span>list A</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>NoDup s1</span></span></span><br><span><var>H0</var><span class="hyp-type"><b>: </b><span>NoDup s2</span></span></span><br><span><var>H1</var><span class="hyp-type"><b>: </b><span>x ∉ s1</span></span></span><br><span><var>HnodupUs1s2</var><span class="hyp-type"><b>: </b><span>NoDup (set_union s1 s2)</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">set_eq (set_union s1 (set_remove x s2))
  (set_remove x (set_union s1 s2))</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="ListSetExtras-v-chk143" style="display: none" type="checkbox"><label class="alectryon-input" for="ListSetExtras-v-chk143"><span class="nb">split</span>; <span class="nb">intros</span> msg Hin.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>A</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>EqDecision0</var><span class="hyp-type"><b>: </b><span>EqDecision A</span></span></span><br><span><var>x</var><span class="hyp-type"><b>: </b><span>A</span></span></span><br><span><var>s1, s2</var><span class="hyp-type"><b>: </b><span>list A</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>NoDup s1</span></span></span><br><span><var>H0</var><span class="hyp-type"><b>: </b><span>NoDup s2</span></span></span><br><span><var>H1</var><span class="hyp-type"><b>: </b><span>x ∉ s1</span></span></span><br><span><var>HnodupUs1s2</var><span class="hyp-type"><b>: </b><span>NoDup (set_union s1 s2)</span></span></span><br><span><var>msg</var><span class="hyp-type"><b>: </b><span>A</span></span></span><br><span><var>Hin</var><span class="hyp-type"><b>: </b><span>msg ∈ set_union s1 (set_remove x s2)</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">msg ∈ set_remove x (set_union s1 s2)</div></blockquote><div class="alectryon-extra-goals"><input class="alectryon-extra-goal-toggle" id="ListSetExtras-v-chk144" style="display: none" type="checkbox"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>A</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>EqDecision0</var><span class="hyp-type"><b>: </b><span>EqDecision A</span></span></span><br><span><var>x</var><span class="hyp-type"><b>: </b><span>A</span></span></span><br><span><var>s1, s2</var><span class="hyp-type"><b>: </b><span>list A</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>NoDup s1</span></span></span><br><span><var>H0</var><span class="hyp-type"><b>: </b><span>NoDup s2</span></span></span><br><span><var>H1</var><span class="hyp-type"><b>: </b><span>x ∉ s1</span></span></span><br><span><var>HnodupUs1s2</var><span class="hyp-type"><b>: </b><span>NoDup (set_union s1 s2)</span></span></span><br><span><var>msg</var><span class="hyp-type"><b>: </b><span>A</span></span></span><br><span><var>Hin</var><span class="hyp-type"><b>: </b><span>msg ∈ set_remove x (set_union s1 s2)</span></span></span><br></div><label class="goal-separator" for="ListSetExtras-v-chk144"><hr></label><div class="goal-conclusion">msg ∈ set_union s1 (set_remove x s2)</div></blockquote></div></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="ListSetExtras-v-chk145" style="display: none" type="checkbox"><label class="alectryon-input" for="ListSetExtras-v-chk145">-</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>A</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>EqDecision0</var><span class="hyp-type"><b>: </b><span>EqDecision A</span></span></span><br><span><var>x</var><span class="hyp-type"><b>: </b><span>A</span></span></span><br><span><var>s1, s2</var><span class="hyp-type"><b>: </b><span>list A</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>NoDup s1</span></span></span><br><span><var>H0</var><span class="hyp-type"><b>: </b><span>NoDup s2</span></span></span><br><span><var>H1</var><span class="hyp-type"><b>: </b><span>x ∉ s1</span></span></span><br><span><var>HnodupUs1s2</var><span class="hyp-type"><b>: </b><span>NoDup (set_union s1 s2)</span></span></span><br><span><var>msg</var><span class="hyp-type"><b>: </b><span>A</span></span></span><br><span><var>Hin</var><span class="hyp-type"><b>: </b><span>msg ∈ set_union s1 (set_remove x s2)</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">msg ∈ set_remove x (set_union s1 s2)</div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="ListSetExtras-v-chk146" style="display: none" type="checkbox"><label class="alectryon-input" for="ListSetExtras-v-chk146"><span class="nb">apply</span> set_remove_iff; [<span class="bp">done</span> |].</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>A</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>EqDecision0</var><span class="hyp-type"><b>: </b><span>EqDecision A</span></span></span><br><span><var>x</var><span class="hyp-type"><b>: </b><span>A</span></span></span><br><span><var>s1, s2</var><span class="hyp-type"><b>: </b><span>list A</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>NoDup s1</span></span></span><br><span><var>H0</var><span class="hyp-type"><b>: </b><span>NoDup s2</span></span></span><br><span><var>H1</var><span class="hyp-type"><b>: </b><span>x ∉ s1</span></span></span><br><span><var>HnodupUs1s2</var><span class="hyp-type"><b>: </b><span>NoDup (set_union s1 s2)</span></span></span><br><span><var>msg</var><span class="hyp-type"><b>: </b><span>A</span></span></span><br><span><var>Hin</var><span class="hyp-type"><b>: </b><span>msg ∈ set_union s1 (set_remove x s2)</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">msg ∈ set_union s1 s2 ∧ msg ≠ x</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="ListSetExtras-v-chk147" style="display: none" type="checkbox"><label class="alectryon-input" for="ListSetExtras-v-chk147"><span class="nb">apply</span> set_union_iff <span class="kr">in</span> Hin <span class="kr">as</span> []; <span class="nb">split</span>.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>A</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>EqDecision0</var><span class="hyp-type"><b>: </b><span>EqDecision A</span></span></span><br><span><var>x</var><span class="hyp-type"><b>: </b><span>A</span></span></span><br><span><var>s1, s2</var><span class="hyp-type"><b>: </b><span>list A</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>NoDup s1</span></span></span><br><span><var>H0</var><span class="hyp-type"><b>: </b><span>NoDup s2</span></span></span><br><span><var>H1</var><span class="hyp-type"><b>: </b><span>x ∉ s1</span></span></span><br><span><var>HnodupUs1s2</var><span class="hyp-type"><b>: </b><span>NoDup (set_union s1 s2)</span></span></span><br><span><var>msg</var><span class="hyp-type"><b>: </b><span>A</span></span></span><br><span><var>H2</var><span class="hyp-type"><b>: </b><span>msg ∈ s1</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">msg ∈ set_union s1 s2</div></blockquote><div class="alectryon-extra-goals"><input class="alectryon-extra-goal-toggle" id="ListSetExtras-v-chk148" style="display: none" type="checkbox"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>A</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>EqDecision0</var><span class="hyp-type"><b>: </b><span>EqDecision A</span></span></span><br><span><var>x</var><span class="hyp-type"><b>: </b><span>A</span></span></span><br><span><var>s1, s2</var><span class="hyp-type"><b>: </b><span>list A</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>NoDup s1</span></span></span><br><span><var>H0</var><span class="hyp-type"><b>: </b><span>NoDup s2</span></span></span><br><span><var>H1</var><span class="hyp-type"><b>: </b><span>x ∉ s1</span></span></span><br><span><var>HnodupUs1s2</var><span class="hyp-type"><b>: </b><span>NoDup (set_union s1 s2)</span></span></span><br><span><var>msg</var><span class="hyp-type"><b>: </b><span>A</span></span></span><br><span><var>H2</var><span class="hyp-type"><b>: </b><span>msg ∈ s1</span></span></span><br></div><label class="goal-separator" for="ListSetExtras-v-chk148"><hr></label><div class="goal-conclusion">msg ≠ x</div></blockquote><input class="alectryon-extra-goal-toggle" id="ListSetExtras-v-chk149" style="display: none" type="checkbox"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>A</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>EqDecision0</var><span class="hyp-type"><b>: </b><span>EqDecision A</span></span></span><br><span><var>x</var><span class="hyp-type"><b>: </b><span>A</span></span></span><br><span><var>s1, s2</var><span class="hyp-type"><b>: </b><span>list A</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>NoDup s1</span></span></span><br><span><var>H0</var><span class="hyp-type"><b>: </b><span>NoDup s2</span></span></span><br><span><var>H1</var><span class="hyp-type"><b>: </b><span>x ∉ s1</span></span></span><br><span><var>HnodupUs1s2</var><span class="hyp-type"><b>: </b><span>NoDup (set_union s1 s2)</span></span></span><br><span><var>msg</var><span class="hyp-type"><b>: </b><span>A</span></span></span><br><span><var>H2</var><span class="hyp-type"><b>: </b><span>msg ∈ set_remove x s2</span></span></span><br></div><label class="goal-separator" for="ListSetExtras-v-chk149"><hr></label><div class="goal-conclusion">msg ∈ set_union s1 s2</div></blockquote><input class="alectryon-extra-goal-toggle" id="ListSetExtras-v-chk14a" style="display: none" type="checkbox"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>A</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>EqDecision0</var><span class="hyp-type"><b>: </b><span>EqDecision A</span></span></span><br><span><var>x</var><span class="hyp-type"><b>: </b><span>A</span></span></span><br><span><var>s1, s2</var><span class="hyp-type"><b>: </b><span>list A</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>NoDup s1</span></span></span><br><span><var>H0</var><span class="hyp-type"><b>: </b><span>NoDup s2</span></span></span><br><span><var>H1</var><span class="hyp-type"><b>: </b><span>x ∉ s1</span></span></span><br><span><var>HnodupUs1s2</var><span class="hyp-type"><b>: </b><span>NoDup (set_union s1 s2)</span></span></span><br><span><var>msg</var><span class="hyp-type"><b>: </b><span>A</span></span></span><br><span><var>H2</var><span class="hyp-type"><b>: </b><span>msg ∈ set_remove x s2</span></span></span><br></div><label class="goal-separator" for="ListSetExtras-v-chk14a"><hr></label><div class="goal-conclusion">msg ≠ x</div></blockquote></div></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="ListSetExtras-v-chk14b" style="display: none" type="checkbox"><label class="alectryon-input" for="ListSetExtras-v-chk14b">+</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>A</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>EqDecision0</var><span class="hyp-type"><b>: </b><span>EqDecision A</span></span></span><br><span><var>x</var><span class="hyp-type"><b>: </b><span>A</span></span></span><br><span><var>s1, s2</var><span class="hyp-type"><b>: </b><span>list A</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>NoDup s1</span></span></span><br><span><var>H0</var><span class="hyp-type"><b>: </b><span>NoDup s2</span></span></span><br><span><var>H1</var><span class="hyp-type"><b>: </b><span>x ∉ s1</span></span></span><br><span><var>HnodupUs1s2</var><span class="hyp-type"><b>: </b><span>NoDup (set_union s1 s2)</span></span></span><br><span><var>msg</var><span class="hyp-type"><b>: </b><span>A</span></span></span><br><span><var>H2</var><span class="hyp-type"><b>: </b><span>msg ∈ s1</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">msg ∈ set_union s1 s2</div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="bp">by</span> <span class="nb">apply</span> set_union_iff; <span class="nb">left</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="ListSetExtras-v-chk14c" style="display: none" type="checkbox"><label class="alectryon-input" for="ListSetExtras-v-chk14c">+</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>A</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>EqDecision0</var><span class="hyp-type"><b>: </b><span>EqDecision A</span></span></span><br><span><var>x</var><span class="hyp-type"><b>: </b><span>A</span></span></span><br><span><var>s1, s2</var><span class="hyp-type"><b>: </b><span>list A</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>NoDup s1</span></span></span><br><span><var>H0</var><span class="hyp-type"><b>: </b><span>NoDup s2</span></span></span><br><span><var>H1</var><span class="hyp-type"><b>: </b><span>x ∉ s1</span></span></span><br><span><var>HnodupUs1s2</var><span class="hyp-type"><b>: </b><span>NoDup (set_union s1 s2)</span></span></span><br><span><var>msg</var><span class="hyp-type"><b>: </b><span>A</span></span></span><br><span><var>H2</var><span class="hyp-type"><b>: </b><span>msg ∈ s1</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">msg ≠ x</div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="bp">by</span> <span class="nb">intro</span>; <span class="nb">subst</span>; <span class="nb">apply</span> H1.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="ListSetExtras-v-chk14d" style="display: none" type="checkbox"><label class="alectryon-input" for="ListSetExtras-v-chk14d">+</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>A</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>EqDecision0</var><span class="hyp-type"><b>: </b><span>EqDecision A</span></span></span><br><span><var>x</var><span class="hyp-type"><b>: </b><span>A</span></span></span><br><span><var>s1, s2</var><span class="hyp-type"><b>: </b><span>list A</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>NoDup s1</span></span></span><br><span><var>H0</var><span class="hyp-type"><b>: </b><span>NoDup s2</span></span></span><br><span><var>H1</var><span class="hyp-type"><b>: </b><span>x ∉ s1</span></span></span><br><span><var>HnodupUs1s2</var><span class="hyp-type"><b>: </b><span>NoDup (set_union s1 s2)</span></span></span><br><span><var>msg</var><span class="hyp-type"><b>: </b><span>A</span></span></span><br><span><var>H2</var><span class="hyp-type"><b>: </b><span>msg ∈ set_remove x s2</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">msg ∈ set_union s1 s2</div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="ListSetExtras-v-chk14e" style="display: none" type="checkbox"><label class="alectryon-input" for="ListSetExtras-v-chk14e"><span class="nb">apply</span> set_remove_iff <span class="kr">in</span> H2 <span class="kr">as</span> []; [| <span class="bp">done</span>].</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>A</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>EqDecision0</var><span class="hyp-type"><b>: </b><span>EqDecision A</span></span></span><br><span><var>x</var><span class="hyp-type"><b>: </b><span>A</span></span></span><br><span><var>s1, s2</var><span class="hyp-type"><b>: </b><span>list A</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>NoDup s1</span></span></span><br><span><var>H0</var><span class="hyp-type"><b>: </b><span>NoDup s2</span></span></span><br><span><var>H1</var><span class="hyp-type"><b>: </b><span>x ∉ s1</span></span></span><br><span><var>HnodupUs1s2</var><span class="hyp-type"><b>: </b><span>NoDup (set_union s1 s2)</span></span></span><br><span><var>msg</var><span class="hyp-type"><b>: </b><span>A</span></span></span><br><span><var>H2</var><span class="hyp-type"><b>: </b><span>msg ∈ s2</span></span></span><br><span><var>H3</var><span class="hyp-type"><b>: </b><span>msg ≠ x</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">msg ∈ set_union s1 s2</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">      </span><span class="alectryon-sentence"><span class="alectryon-input"><span class="bp">by</span> <span class="nb">apply</span> set_union_iff; <span class="nb">right</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="ListSetExtras-v-chk14f" style="display: none" type="checkbox"><label class="alectryon-input" for="ListSetExtras-v-chk14f">+</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>A</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>EqDecision0</var><span class="hyp-type"><b>: </b><span>EqDecision A</span></span></span><br><span><var>x</var><span class="hyp-type"><b>: </b><span>A</span></span></span><br><span><var>s1, s2</var><span class="hyp-type"><b>: </b><span>list A</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>NoDup s1</span></span></span><br><span><var>H0</var><span class="hyp-type"><b>: </b><span>NoDup s2</span></span></span><br><span><var>H1</var><span class="hyp-type"><b>: </b><span>x ∉ s1</span></span></span><br><span><var>HnodupUs1s2</var><span class="hyp-type"><b>: </b><span>NoDup (set_union s1 s2)</span></span></span><br><span><var>msg</var><span class="hyp-type"><b>: </b><span>A</span></span></span><br><span><var>H2</var><span class="hyp-type"><b>: </b><span>msg ∈ set_remove x s2</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">msg ≠ x</div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="ListSetExtras-v-chk150" style="display: none" type="checkbox"><label class="alectryon-input" for="ListSetExtras-v-chk150"><span class="nb">intro</span>; <span class="nb">subst</span>.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>A</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>EqDecision0</var><span class="hyp-type"><b>: </b><span>EqDecision A</span></span></span><br><span><var>x</var><span class="hyp-type"><b>: </b><span>A</span></span></span><br><span><var>s1, s2</var><span class="hyp-type"><b>: </b><span>list A</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>NoDup s1</span></span></span><br><span><var>H0</var><span class="hyp-type"><b>: </b><span>NoDup s2</span></span></span><br><span><var>H1</var><span class="hyp-type"><b>: </b><span>x ∉ s1</span></span></span><br><span><var>HnodupUs1s2</var><span class="hyp-type"><b>: </b><span>NoDup (set_union s1 s2)</span></span></span><br><span><var>H2</var><span class="hyp-type"><b>: </b><span>x ∈ set_remove x s2</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="kt">False</span></div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">      </span><span class="alectryon-sentence"><span class="alectryon-input"><span class="nb">apply</span> set_remove_iff <span class="kr">in</span> H2; itauto.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="ListSetExtras-v-chk151" style="display: none" type="checkbox"><label class="alectryon-input" for="ListSetExtras-v-chk151">-</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>A</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>EqDecision0</var><span class="hyp-type"><b>: </b><span>EqDecision A</span></span></span><br><span><var>x</var><span class="hyp-type"><b>: </b><span>A</span></span></span><br><span><var>s1, s2</var><span class="hyp-type"><b>: </b><span>list A</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>NoDup s1</span></span></span><br><span><var>H0</var><span class="hyp-type"><b>: </b><span>NoDup s2</span></span></span><br><span><var>H1</var><span class="hyp-type"><b>: </b><span>x ∉ s1</span></span></span><br><span><var>HnodupUs1s2</var><span class="hyp-type"><b>: </b><span>NoDup (set_union s1 s2)</span></span></span><br><span><var>msg</var><span class="hyp-type"><b>: </b><span>A</span></span></span><br><span><var>Hin</var><span class="hyp-type"><b>: </b><span>msg ∈ set_remove x (set_union s1 s2)</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">msg ∈ set_union s1 (set_remove x s2)</div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="ListSetExtras-v-chk152" style="display: none" type="checkbox"><label class="alectryon-input" for="ListSetExtras-v-chk152"><span class="nb">apply</span> set_union_iff.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>A</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>EqDecision0</var><span class="hyp-type"><b>: </b><span>EqDecision A</span></span></span><br><span><var>x</var><span class="hyp-type"><b>: </b><span>A</span></span></span><br><span><var>s1, s2</var><span class="hyp-type"><b>: </b><span>list A</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>NoDup s1</span></span></span><br><span><var>H0</var><span class="hyp-type"><b>: </b><span>NoDup s2</span></span></span><br><span><var>H1</var><span class="hyp-type"><b>: </b><span>x ∉ s1</span></span></span><br><span><var>HnodupUs1s2</var><span class="hyp-type"><b>: </b><span>NoDup (set_union s1 s2)</span></span></span><br><span><var>msg</var><span class="hyp-type"><b>: </b><span>A</span></span></span><br><span><var>Hin</var><span class="hyp-type"><b>: </b><span>msg ∈ set_remove x (set_union s1 s2)</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">msg ∈ s1 ∨ msg ∈ set_remove x s2</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="ListSetExtras-v-chk153" style="display: none" type="checkbox"><label class="alectryon-input" for="ListSetExtras-v-chk153"><span class="nb">apply</span> set_remove_iff <span class="kr">in</span> Hin <span class="kr">as</span> []; [| <span class="bp">done</span>].</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>A</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>EqDecision0</var><span class="hyp-type"><b>: </b><span>EqDecision A</span></span></span><br><span><var>x</var><span class="hyp-type"><b>: </b><span>A</span></span></span><br><span><var>s1, s2</var><span class="hyp-type"><b>: </b><span>list A</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>NoDup s1</span></span></span><br><span><var>H0</var><span class="hyp-type"><b>: </b><span>NoDup s2</span></span></span><br><span><var>H1</var><span class="hyp-type"><b>: </b><span>x ∉ s1</span></span></span><br><span><var>HnodupUs1s2</var><span class="hyp-type"><b>: </b><span>NoDup (set_union s1 s2)</span></span></span><br><span><var>msg</var><span class="hyp-type"><b>: </b><span>A</span></span></span><br><span><var>H2</var><span class="hyp-type"><b>: </b><span>msg ∈ set_union s1 s2</span></span></span><br><span><var>H3</var><span class="hyp-type"><b>: </b><span>msg ≠ x</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">msg ∈ s1 ∨ msg ∈ set_remove x s2</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="ListSetExtras-v-chk154" style="display: none" type="checkbox"><label class="alectryon-input" for="ListSetExtras-v-chk154"><span class="nb">apply</span> set_union_iff <span class="kr">in</span> H2 <span class="kr">as</span> []; [<span class="bp">by</span> <span class="nb">left</span> |].</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>A</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>EqDecision0</var><span class="hyp-type"><b>: </b><span>EqDecision A</span></span></span><br><span><var>x</var><span class="hyp-type"><b>: </b><span>A</span></span></span><br><span><var>s1, s2</var><span class="hyp-type"><b>: </b><span>list A</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>NoDup s1</span></span></span><br><span><var>H0</var><span class="hyp-type"><b>: </b><span>NoDup s2</span></span></span><br><span><var>H1</var><span class="hyp-type"><b>: </b><span>x ∉ s1</span></span></span><br><span><var>HnodupUs1s2</var><span class="hyp-type"><b>: </b><span>NoDup (set_union s1 s2)</span></span></span><br><span><var>msg</var><span class="hyp-type"><b>: </b><span>A</span></span></span><br><span><var>H2</var><span class="hyp-type"><b>: </b><span>msg ∈ s2</span></span></span><br><span><var>H3</var><span class="hyp-type"><b>: </b><span>msg ≠ x</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">msg ∈ s1 ∨ msg ∈ set_remove x s2</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><span class="alectryon-input"><span class="bp">by</span> <span class="nb">right</span>; <span class="nb">apply</span> set_remove_iff.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Qed</span>.</span></span></pre><div class="doc">
  An improved version of the <span class="inlinecode"><span class="id" title="var">set_diff_nodup</span></span> Lemma not requiring <span class="inlinecode"><span class="id" title="var">NoDup</span></span>
  for the second argument.

</div><pre class="alectryon-io highlight"><!-- Generator: Alectryon --><span class="alectryon-wsp"><span class="c">(* TODO(palmskog): consider submitting a PR to Coq&#39;s stdlib. *)</span>
</span><span class="alectryon-sentence"><input class="alectryon-toggle" id="ListSetExtras-v-chk155" style="display: none" type="checkbox"><label class="alectryon-input" for="ListSetExtras-v-chk155"><span class="kn">Lemma</span> <span class="nf">set_diff_nodup&#39;</span> `{EqDecision A} (l l&#39; : list A)
  : NoDup l -&gt; NoDup (set_diff l l&#39;).</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>A</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>EqDecision0</var><span class="hyp-type"><b>: </b><span>EqDecision A</span></span></span><br><span><var>l, l'</var><span class="hyp-type"><b>: </b><span>list A</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">NoDup l → NoDup (set_diff l l&#39;)</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="ListSetExtras-v-chk156" style="display: none" type="checkbox"><label class="alectryon-input" for="ListSetExtras-v-chk156"><span class="kn">Proof</span>.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>A</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>EqDecision0</var><span class="hyp-type"><b>: </b><span>EqDecision A</span></span></span><br><span><var>l, l'</var><span class="hyp-type"><b>: </b><span>list A</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">NoDup l → NoDup (set_diff l l&#39;)</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="ListSetExtras-v-chk157" style="display: none" type="checkbox"><label class="alectryon-input" for="ListSetExtras-v-chk157"><span class="nb">induction</span> <span class="mi">1</span> <span class="kr">as</span> [|x l H H&#39; IH]; <span class="nb">simpl</span>.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>A</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>EqDecision0</var><span class="hyp-type"><b>: </b><span>EqDecision A</span></span></span><br><span><var>l'</var><span class="hyp-type"><b>: </b><span>list A</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">NoDup []</div></blockquote><div class="alectryon-extra-goals"><input class="alectryon-extra-goal-toggle" id="ListSetExtras-v-chk158" style="display: none" type="checkbox"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>A</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>EqDecision0</var><span class="hyp-type"><b>: </b><span>EqDecision A</span></span></span><br><span><var>l'</var><span class="hyp-type"><b>: </b><span>list A</span></span></span><br><span><var>x</var><span class="hyp-type"><b>: </b><span>A</span></span></span><br><span><var>l</var><span class="hyp-type"><b>: </b><span>list A</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>x ∉ l</span></span></span><br><span><var>H'</var><span class="hyp-type"><b>: </b><span>NoDup l</span></span></span><br><span><var>IH</var><span class="hyp-type"><b>: </b><span>NoDup (set_diff l l&#39;)</span></span></span><br></div><label class="goal-separator" for="ListSetExtras-v-chk158"><hr></label><div class="goal-conclusion">NoDup
  (<span class="kr">if</span> decide (x ∈ l&#39;)
   <span class="kr">then</span> set_diff l l&#39;
   <span class="kr">else</span> set_add x (set_diff l l&#39;))</div></blockquote></div></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="ListSetExtras-v-chk159" style="display: none" type="checkbox"><label class="alectryon-input" for="ListSetExtras-v-chk159">-</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>A</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>EqDecision0</var><span class="hyp-type"><b>: </b><span>EqDecision A</span></span></span><br><span><var>l'</var><span class="hyp-type"><b>: </b><span>list A</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">NoDup []</div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="nb">constructor</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="ListSetExtras-v-chk15a" style="display: none" type="checkbox"><label class="alectryon-input" for="ListSetExtras-v-chk15a">-</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>A</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>EqDecision0</var><span class="hyp-type"><b>: </b><span>EqDecision A</span></span></span><br><span><var>l'</var><span class="hyp-type"><b>: </b><span>list A</span></span></span><br><span><var>x</var><span class="hyp-type"><b>: </b><span>A</span></span></span><br><span><var>l</var><span class="hyp-type"><b>: </b><span>list A</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>x ∉ l</span></span></span><br><span><var>H'</var><span class="hyp-type"><b>: </b><span>NoDup l</span></span></span><br><span><var>IH</var><span class="hyp-type"><b>: </b><span>NoDup (set_diff l l&#39;)</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">NoDup
  (<span class="kr">if</span> decide (x ∈ l&#39;)
   <span class="kr">then</span> set_diff l l&#39;
   <span class="kr">else</span> set_add x (set_diff l l&#39;))</div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="ListSetExtras-v-chk15b" style="display: none" type="checkbox"><label class="alectryon-input" for="ListSetExtras-v-chk15b">case_decide.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>A</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>EqDecision0</var><span class="hyp-type"><b>: </b><span>EqDecision A</span></span></span><br><span><var>l'</var><span class="hyp-type"><b>: </b><span>list A</span></span></span><br><span><var>x</var><span class="hyp-type"><b>: </b><span>A</span></span></span><br><span><var>l</var><span class="hyp-type"><b>: </b><span>list A</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>x ∉ l</span></span></span><br><span><var>H'</var><span class="hyp-type"><b>: </b><span>NoDup l</span></span></span><br><span><var>IH</var><span class="hyp-type"><b>: </b><span>NoDup (set_diff l l&#39;)</span></span></span><br><span><var>H0</var><span class="hyp-type"><b>: </b><span>x ∈ l&#39;</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">NoDup (set_diff l l&#39;)</div></blockquote><div class="alectryon-extra-goals"><input class="alectryon-extra-goal-toggle" id="ListSetExtras-v-chk15c" style="display: none" type="checkbox"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>A</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>EqDecision0</var><span class="hyp-type"><b>: </b><span>EqDecision A</span></span></span><br><span><var>l'</var><span class="hyp-type"><b>: </b><span>list A</span></span></span><br><span><var>x</var><span class="hyp-type"><b>: </b><span>A</span></span></span><br><span><var>l</var><span class="hyp-type"><b>: </b><span>list A</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>x ∉ l</span></span></span><br><span><var>H'</var><span class="hyp-type"><b>: </b><span>NoDup l</span></span></span><br><span><var>IH</var><span class="hyp-type"><b>: </b><span>NoDup (set_diff l l&#39;)</span></span></span><br><span><var>H0</var><span class="hyp-type"><b>: </b><span>x ∉ l&#39;</span></span></span><br></div><label class="goal-separator" for="ListSetExtras-v-chk15c"><hr></label><div class="goal-conclusion">NoDup (set_add x (set_diff l l&#39;))</div></blockquote></div></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="ListSetExtras-v-chk15d" style="display: none" type="checkbox"><label class="alectryon-input" for="ListSetExtras-v-chk15d">+</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>A</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>EqDecision0</var><span class="hyp-type"><b>: </b><span>EqDecision A</span></span></span><br><span><var>l'</var><span class="hyp-type"><b>: </b><span>list A</span></span></span><br><span><var>x</var><span class="hyp-type"><b>: </b><span>A</span></span></span><br><span><var>l</var><span class="hyp-type"><b>: </b><span>list A</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>x ∉ l</span></span></span><br><span><var>H'</var><span class="hyp-type"><b>: </b><span>NoDup l</span></span></span><br><span><var>IH</var><span class="hyp-type"><b>: </b><span>NoDup (set_diff l l&#39;)</span></span></span><br><span><var>H0</var><span class="hyp-type"><b>: </b><span>x ∈ l&#39;</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">NoDup (set_diff l l&#39;)</div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="bp">by</span> <span class="nb">apply</span> IH.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="ListSetExtras-v-chk15e" style="display: none" type="checkbox"><label class="alectryon-input" for="ListSetExtras-v-chk15e">+</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>A</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>EqDecision0</var><span class="hyp-type"><b>: </b><span>EqDecision A</span></span></span><br><span><var>l'</var><span class="hyp-type"><b>: </b><span>list A</span></span></span><br><span><var>x</var><span class="hyp-type"><b>: </b><span>A</span></span></span><br><span><var>l</var><span class="hyp-type"><b>: </b><span>list A</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>x ∉ l</span></span></span><br><span><var>H'</var><span class="hyp-type"><b>: </b><span>NoDup l</span></span></span><br><span><var>IH</var><span class="hyp-type"><b>: </b><span>NoDup (set_diff l l&#39;)</span></span></span><br><span><var>H0</var><span class="hyp-type"><b>: </b><span>x ∉ l&#39;</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">NoDup (set_add x (set_diff l l&#39;))</div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="bp">by</span> <span class="nb">apply</span> set_add_nodup, IH.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Qed</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
</span><span class="alectryon-sentence"><input class="alectryon-toggle" id="ListSetExtras-v-chk15f" style="display: none" type="checkbox"><label class="alectryon-input" for="ListSetExtras-v-chk15f"><span class="kn">Lemma</span> <span class="nf">diff_app_nodup</span> `{EqDecision A} : <span class="kr">forall</span> (<span class="nv">s1</span> <span class="nv">s2</span> : list A),
  NoDup s1 -&gt;
  NoDup s2 -&gt;
  NoDup ((set_diff s1 s2) ++ s2).</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>A</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>EqDecision0</var><span class="hyp-type"><b>: </b><span>EqDecision A</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="kr">∀</span> <span class="nv">s1</span> <span class="nv">s2</span> : list A,
  NoDup s1 → NoDup s2 → NoDup (set_diff s1 s2 ++ s2)</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="ListSetExtras-v-chk160" style="display: none" type="checkbox"><label class="alectryon-input" for="ListSetExtras-v-chk160"><span class="kn">Proof</span>.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>A</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>EqDecision0</var><span class="hyp-type"><b>: </b><span>EqDecision A</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="kr">∀</span> <span class="nv">s1</span> <span class="nv">s2</span> : list A,
  NoDup s1 → NoDup s2 → NoDup (set_diff s1 s2 ++ s2)</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="ListSetExtras-v-chk161" style="display: none" type="checkbox"><label class="alectryon-input" for="ListSetExtras-v-chk161"><span class="nb">intros</span>.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>A</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>EqDecision0</var><span class="hyp-type"><b>: </b><span>EqDecision A</span></span></span><br><span><var>s1, s2</var><span class="hyp-type"><b>: </b><span>list A</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>NoDup s1</span></span></span><br><span><var>H0</var><span class="hyp-type"><b>: </b><span>NoDup s2</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">NoDup (set_diff s1 s2 ++ s2)</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="ListSetExtras-v-chk162" style="display: none" type="checkbox"><label class="alectryon-input" for="ListSetExtras-v-chk162"><span class="nb">apply</span> nodup_append; [| <span class="bp">done</span> | |].</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>A</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>EqDecision0</var><span class="hyp-type"><b>: </b><span>EqDecision A</span></span></span><br><span><var>s1, s2</var><span class="hyp-type"><b>: </b><span>list A</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>NoDup s1</span></span></span><br><span><var>H0</var><span class="hyp-type"><b>: </b><span>NoDup s2</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">NoDup (set_diff s1 s2)</div></blockquote><div class="alectryon-extra-goals"><input class="alectryon-extra-goal-toggle" id="ListSetExtras-v-chk163" style="display: none" type="checkbox"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>A</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>EqDecision0</var><span class="hyp-type"><b>: </b><span>EqDecision A</span></span></span><br><span><var>s1, s2</var><span class="hyp-type"><b>: </b><span>list A</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>NoDup s1</span></span></span><br><span><var>H0</var><span class="hyp-type"><b>: </b><span>NoDup s2</span></span></span><br></div><label class="goal-separator" for="ListSetExtras-v-chk163"><hr></label><div class="goal-conclusion"><span class="kr">∀</span> <span class="nv">a</span> : A, a ∈ set_diff s1 s2 → a ∉ s2</div></blockquote><input class="alectryon-extra-goal-toggle" id="ListSetExtras-v-chk164" style="display: none" type="checkbox"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>A</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>EqDecision0</var><span class="hyp-type"><b>: </b><span>EqDecision A</span></span></span><br><span><var>s1, s2</var><span class="hyp-type"><b>: </b><span>list A</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>NoDup s1</span></span></span><br><span><var>H0</var><span class="hyp-type"><b>: </b><span>NoDup s2</span></span></span><br></div><label class="goal-separator" for="ListSetExtras-v-chk164"><hr></label><div class="goal-conclusion"><span class="kr">∀</span> <span class="nv">a</span> : A, a ∈ s2 → a ∉ set_diff s1 s2</div></blockquote></div></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="ListSetExtras-v-chk165" style="display: none" type="checkbox"><label class="alectryon-input" for="ListSetExtras-v-chk165">-</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>A</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>EqDecision0</var><span class="hyp-type"><b>: </b><span>EqDecision A</span></span></span><br><span><var>s1, s2</var><span class="hyp-type"><b>: </b><span>list A</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>NoDup s1</span></span></span><br><span><var>H0</var><span class="hyp-type"><b>: </b><span>NoDup s2</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">NoDup (set_diff s1 s2)</div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="bp">by</span> <span class="nb">apply</span> set_diff_nodup.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="ListSetExtras-v-chk166" style="display: none" type="checkbox"><label class="alectryon-input" for="ListSetExtras-v-chk166">-</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>A</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>EqDecision0</var><span class="hyp-type"><b>: </b><span>EqDecision A</span></span></span><br><span><var>s1, s2</var><span class="hyp-type"><b>: </b><span>list A</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>NoDup s1</span></span></span><br><span><var>H0</var><span class="hyp-type"><b>: </b><span>NoDup s2</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="kr">∀</span> <span class="nv">a</span> : A, a ∈ set_diff s1 s2 → a ∉ s2</div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="bp">by</span> <span class="nb">intros</span>; <span class="nb">apply</span> (set_diff_elim2 a s1).</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="ListSetExtras-v-chk167" style="display: none" type="checkbox"><label class="alectryon-input" for="ListSetExtras-v-chk167">-</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>A</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>EqDecision0</var><span class="hyp-type"><b>: </b><span>EqDecision A</span></span></span><br><span><var>s1, s2</var><span class="hyp-type"><b>: </b><span>list A</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>NoDup s1</span></span></span><br><span><var>H0</var><span class="hyp-type"><b>: </b><span>NoDup s2</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="kr">∀</span> <span class="nv">a</span> : A, a ∈ s2 → a ∉ set_diff s1 s2</div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="ListSetExtras-v-chk168" style="display: none" type="checkbox"><label class="alectryon-input" for="ListSetExtras-v-chk168"><span class="nb">setoid_rewrite</span> set_diff_iff.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>A</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>EqDecision0</var><span class="hyp-type"><b>: </b><span>EqDecision A</span></span></span><br><span><var>s1, s2</var><span class="hyp-type"><b>: </b><span>list A</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>NoDup s1</span></span></span><br><span><var>H0</var><span class="hyp-type"><b>: </b><span>NoDup s2</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="kr">∀</span> <span class="nv">a</span> : A, a ∈ s2 → ¬ (a ∈ s1 ∧ a ∉ s2)</div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><span class="alectryon-input">itauto.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Qed</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
</span><span class="alectryon-sentence"><input class="alectryon-toggle" id="ListSetExtras-v-chk169" style="display: none" type="checkbox"><label class="alectryon-input" for="ListSetExtras-v-chk169"><span class="kn">Lemma</span> <span class="nf">add_remove_inverse</span> `{EqDecision X}:
  <span class="kr">forall</span> (<span class="nv">lv</span> : list X) (<span class="nv">v</span> : X),
    ~ v ∈ lv -&gt;
    set_remove v (set_add v lv) = lv.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>X</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>EqDecision0</var><span class="hyp-type"><b>: </b><span>EqDecision X</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="kr">∀</span> (<span class="nv">lv</span> : list X) (<span class="nv">v</span> : X),
  v ∉ lv → set_remove v (set_add v lv) = lv</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="ListSetExtras-v-chk16a" style="display: none" type="checkbox"><label class="alectryon-input" for="ListSetExtras-v-chk16a"><span class="kn">Proof</span>.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>X</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>EqDecision0</var><span class="hyp-type"><b>: </b><span>EqDecision X</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="kr">∀</span> (<span class="nv">lv</span> : list X) (<span class="nv">v</span> : X),
  v ∉ lv → set_remove v (set_add v lv) = lv</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="ListSetExtras-v-chk16b" style="display: none" type="checkbox"><label class="alectryon-input" for="ListSetExtras-v-chk16b"><span class="nb">induction</span> lv <span class="kr">as</span> [| hd tl IHlv]; <span class="nb">cbn</span>; <span class="nb">intros</span>.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>X</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>EqDecision0</var><span class="hyp-type"><b>: </b><span>EqDecision X</span></span></span><br><span><var>v</var><span class="hyp-type"><b>: </b><span>X</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>v ∉ []</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">(<span class="kr">if</span> decide (v = v) <span class="kr">then</span> [] <span class="kr">else</span> v :: empty_set) = []</div></blockquote><div class="alectryon-extra-goals"><input class="alectryon-extra-goal-toggle" id="ListSetExtras-v-chk16c" style="display: none" type="checkbox"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>X</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>EqDecision0</var><span class="hyp-type"><b>: </b><span>EqDecision X</span></span></span><br><span><var>hd</var><span class="hyp-type"><b>: </b><span>X</span></span></span><br><span><var>tl</var><span class="hyp-type"><b>: </b><span>list X</span></span></span><br><span><var>IHlv</var><span class="hyp-type"><b>: </b><span><span class="kr">∀</span> <span class="nv">v</span> : X,
  v ∉ tl → set_remove v (set_add v tl) = tl</span></span></span><br><span><var>v</var><span class="hyp-type"><b>: </b><span>X</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>v ∉ hd :: tl</span></span></span><br></div><label class="goal-separator" for="ListSetExtras-v-chk16c"><hr></label><div class="goal-conclusion">set_remove v
  (<span class="kr">if</span> decide (v = hd)
   <span class="kr">then</span> hd :: tl
   <span class="kr">else</span> hd :: set_add v tl) = 
hd :: tl</div></blockquote></div></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="ListSetExtras-v-chk16d" style="display: none" type="checkbox"><label class="alectryon-input" for="ListSetExtras-v-chk16d">-</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>X</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>EqDecision0</var><span class="hyp-type"><b>: </b><span>EqDecision X</span></span></span><br><span><var>v</var><span class="hyp-type"><b>: </b><span>X</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>v ∉ []</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">(<span class="kr">if</span> decide (v = v) <span class="kr">then</span> [] <span class="kr">else</span> v :: empty_set) = []</div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="bp">by</span> <span class="nb">rewrite</span> decide_True.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="ListSetExtras-v-chk16e" style="display: none" type="checkbox"><label class="alectryon-input" for="ListSetExtras-v-chk16e">-</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>X</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>EqDecision0</var><span class="hyp-type"><b>: </b><span>EqDecision X</span></span></span><br><span><var>hd</var><span class="hyp-type"><b>: </b><span>X</span></span></span><br><span><var>tl</var><span class="hyp-type"><b>: </b><span>list X</span></span></span><br><span><var>IHlv</var><span class="hyp-type"><b>: </b><span><span class="kr">∀</span> <span class="nv">v</span> : X,
  v ∉ tl → set_remove v (set_add v tl) = tl</span></span></span><br><span><var>v</var><span class="hyp-type"><b>: </b><span>X</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>v ∉ hd :: tl</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">set_remove v
  (<span class="kr">if</span> decide (v = hd)
   <span class="kr">then</span> hd :: tl
   <span class="kr">else</span> hd :: set_add v tl) = 
hd :: tl</div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="ListSetExtras-v-chk16f" style="display: none" type="checkbox"><label class="alectryon-input" for="ListSetExtras-v-chk16f"><span class="nb">rewrite</span> elem_of_cons <span class="kr">in</span> H.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>X</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>EqDecision0</var><span class="hyp-type"><b>: </b><span>EqDecision X</span></span></span><br><span><var>hd</var><span class="hyp-type"><b>: </b><span>X</span></span></span><br><span><var>tl</var><span class="hyp-type"><b>: </b><span>list X</span></span></span><br><span><var>IHlv</var><span class="hyp-type"><b>: </b><span><span class="kr">∀</span> <span class="nv">v</span> : X,
  v ∉ tl → set_remove v (set_add v tl) = tl</span></span></span><br><span><var>v</var><span class="hyp-type"><b>: </b><span>X</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>¬ (v = hd ∨ v ∈ tl)</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">set_remove v
  (<span class="kr">if</span> decide (v = hd)
   <span class="kr">then</span> hd :: tl
   <span class="kr">else</span> hd :: set_add v tl) = 
hd :: tl</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="ListSetExtras-v-chk170" style="display: none" type="checkbox"><label class="alectryon-input" for="ListSetExtras-v-chk170"><span class="nb">destruct</span> (decide (v = hd)) <span class="nb">eqn</span>: Heq; <span class="nb">subst</span>; <span class="nb">cbn</span>; [itauto |].</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>X</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>EqDecision0</var><span class="hyp-type"><b>: </b><span>EqDecision X</span></span></span><br><span><var>hd</var><span class="hyp-type"><b>: </b><span>X</span></span></span><br><span><var>tl</var><span class="hyp-type"><b>: </b><span>list X</span></span></span><br><span><var>IHlv</var><span class="hyp-type"><b>: </b><span><span class="kr">∀</span> <span class="nv">v</span> : X,
  v ∉ tl → set_remove v (set_add v tl) = tl</span></span></span><br><span><var>v</var><span class="hyp-type"><b>: </b><span>X</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>¬ (v = hd ∨ v ∈ tl)</span></span></span><br><span><var>n</var><span class="hyp-type"><b>: </b><span>v ≠ hd</span></span></span><br><span><var>Heq</var><span class="hyp-type"><b>: </b><span>decide (v = hd) = <span class="nb">right</span> n</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">(<span class="kr">if</span> decide (v = hd)
 <span class="kr">then</span> set_add v tl
 <span class="kr">else</span> hd :: set_remove v (set_add v tl)) = 
hd :: tl</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><span class="alectryon-input"><span class="nb">rewrite</span> Heq, IHlv; itauto.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Qed</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
</span><span class="alectryon-sentence"><input class="alectryon-toggle" id="ListSetExtras-v-chk171" style="display: none" type="checkbox"><label class="alectryon-input" for="ListSetExtras-v-chk171"><span class="kn">Lemma</span> <span class="nf">set_union_iterated_empty</span> `{EqDecision A} :
  <span class="kr">forall</span> <span class="nv">ss</span> : list (<span class="nb">set</span> A),
    (<span class="kr">forall</span> <span class="nv">s</span> : list A, s ∈ ss -&gt; s = []) -&gt; fold_right set_union [] ss = [].</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>A</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>EqDecision0</var><span class="hyp-type"><b>: </b><span>EqDecision A</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="kr">∀</span> <span class="nv">ss</span> : list (<span class="nb">set</span> A),
  (<span class="kr">∀</span> <span class="nv">s</span> : list A, s ∈ ss → s = [])
  → foldr set_union [] ss = []</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="ListSetExtras-v-chk172" style="display: none" type="checkbox"><label class="alectryon-input" for="ListSetExtras-v-chk172"><span class="kn">Proof</span>.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>A</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>EqDecision0</var><span class="hyp-type"><b>: </b><span>EqDecision A</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="kr">∀</span> <span class="nv">ss</span> : list (<span class="nb">set</span> A),
  (<span class="kr">∀</span> <span class="nv">s</span> : list A, s ∈ ss → s = [])
  → foldr set_union [] ss = []</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="ListSetExtras-v-chk173" style="display: none" type="checkbox"><label class="alectryon-input" for="ListSetExtras-v-chk173"><span class="nb">induction</span> ss; [<span class="bp">done</span> |]; <span class="nb">cbn</span>; <span class="nb">intros</span> H.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>A</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>EqDecision0</var><span class="hyp-type"><b>: </b><span>EqDecision A</span></span></span><br><span><var>a</var><span class="hyp-type"><b>: </b><span><span class="nb">set</span> A</span></span></span><br><span><var>ss</var><span class="hyp-type"><b>: </b><span>list (<span class="nb">set</span> A)</span></span></span><br><span><var>IHss</var><span class="hyp-type"><b>: </b><span>(<span class="kr">∀</span> <span class="nv">s</span> : list A, s ∈ ss → s = [])
→ foldr set_union [] ss = []</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span><span class="kr">∀</span> <span class="nv">s</span> : list A, s ∈ a :: ss → s = []</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">set_union a (foldr set_union [] ss) = []</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="ListSetExtras-v-chk174" style="display: none" type="checkbox"><label class="alectryon-input" for="ListSetExtras-v-chk174"><span class="nb">rewrite</span> IHss; <span class="nb">cycle</span> <span class="mi">1</span>.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>A</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>EqDecision0</var><span class="hyp-type"><b>: </b><span>EqDecision A</span></span></span><br><span><var>a</var><span class="hyp-type"><b>: </b><span><span class="nb">set</span> A</span></span></span><br><span><var>ss</var><span class="hyp-type"><b>: </b><span>list (<span class="nb">set</span> A)</span></span></span><br><span><var>IHss</var><span class="hyp-type"><b>: </b><span>(<span class="kr">∀</span> <span class="nv">s</span> : list A, s ∈ ss → s = [])
→ foldr set_union [] ss = []</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span><span class="kr">∀</span> <span class="nv">s</span> : list A, s ∈ a :: ss → s = []</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="kr">∀</span> <span class="nv">s</span> : list A, s ∈ ss → s = []</div></blockquote><div class="alectryon-extra-goals"><input class="alectryon-extra-goal-toggle" id="ListSetExtras-v-chk175" style="display: none" type="checkbox"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>A</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>EqDecision0</var><span class="hyp-type"><b>: </b><span>EqDecision A</span></span></span><br><span><var>a</var><span class="hyp-type"><b>: </b><span><span class="nb">set</span> A</span></span></span><br><span><var>ss</var><span class="hyp-type"><b>: </b><span>list (<span class="nb">set</span> A)</span></span></span><br><span><var>IHss</var><span class="hyp-type"><b>: </b><span>(<span class="kr">∀</span> <span class="nv">s</span> : list A, s ∈ ss → s = [])
→ foldr set_union [] ss = []</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span><span class="kr">∀</span> <span class="nv">s</span> : list A, s ∈ a :: ss → s = []</span></span></span><br></div><label class="goal-separator" for="ListSetExtras-v-chk175"><hr></label><div class="goal-conclusion">set_union a [] = []</div></blockquote></div></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="ListSetExtras-v-chk176" style="display: none" type="checkbox"><label class="alectryon-input" for="ListSetExtras-v-chk176">-</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>A</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>EqDecision0</var><span class="hyp-type"><b>: </b><span>EqDecision A</span></span></span><br><span><var>a</var><span class="hyp-type"><b>: </b><span><span class="nb">set</span> A</span></span></span><br><span><var>ss</var><span class="hyp-type"><b>: </b><span>list (<span class="nb">set</span> A)</span></span></span><br><span><var>IHss</var><span class="hyp-type"><b>: </b><span>(<span class="kr">∀</span> <span class="nv">s</span> : list A, s ∈ ss → s = [])
→ foldr set_union [] ss = []</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span><span class="kr">∀</span> <span class="nv">s</span> : list A, s ∈ a :: ss → s = []</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="kr">∀</span> <span class="nv">s</span> : list A, s ∈ ss → s = []</div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="bp">by</span> <span class="nb">intros</span> s Hel; <span class="nb">apply</span> H; <span class="nb">right</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="ListSetExtras-v-chk177" style="display: none" type="checkbox"><label class="alectryon-input" for="ListSetExtras-v-chk177">-</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>A</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>EqDecision0</var><span class="hyp-type"><b>: </b><span>EqDecision A</span></span></span><br><span><var>a</var><span class="hyp-type"><b>: </b><span><span class="nb">set</span> A</span></span></span><br><span><var>ss</var><span class="hyp-type"><b>: </b><span>list (<span class="nb">set</span> A)</span></span></span><br><span><var>IHss</var><span class="hyp-type"><b>: </b><span>(<span class="kr">∀</span> <span class="nv">s</span> : list A, s ∈ ss → s = [])
→ foldr set_union [] ss = []</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span><span class="kr">∀</span> <span class="nv">s</span> : list A, s ∈ a :: ss → s = []</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">set_union a [] = []</div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="bp">by</span> <span class="nb">cbn</span>; <span class="nb">apply</span> H; <span class="nb">left</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Qed</span>.</span></span></pre><div class="doc">
  For each element X of l1, exactly one occurrence of X is removed
  from l2. If no such occurrence exists, nothing happens. 

</div><pre class="alectryon-io highlight"><!-- Generator: Alectryon --><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Definition</span> <span class="nf">set_remove_list</span> `{EqDecision A} (l1 l2 : list A) : list A :=
  fold_right set_remove l2 l1.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
</span><span class="alectryon-sentence"><input class="alectryon-toggle" id="ListSetExtras-v-chk178" style="display: none" type="checkbox"><label class="alectryon-input" for="ListSetExtras-v-chk178"><span class="kn">Example</span> <span class="nf">set_remove_list1</span> : set_remove_list [<span class="mi">3</span>;<span class="mi">1</span>;<span class="mi">3</span>] [<span class="mi">1</span>;<span class="mi">1</span>;<span class="mi">2</span>;<span class="mi">3</span>;<span class="mi">3</span>;<span class="mi">3</span>;<span class="mi">3</span>] = [<span class="mi">1</span>;<span class="mi">2</span>;<span class="mi">3</span>;<span class="mi">3</span>].</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><span class="goal-separator"><hr></span><div class="goal-conclusion">set_remove_list [<span class="mi">3</span>; <span class="mi">1</span>; <span class="mi">3</span>] [<span class="mi">1</span>; <span class="mi">1</span>; <span class="mi">2</span>; <span class="mi">3</span>; <span class="mi">3</span>; <span class="mi">3</span>; <span class="mi">3</span>] =
[<span class="mi">1</span>; <span class="mi">2</span>; <span class="mi">3</span>; <span class="mi">3</span>]</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="ListSetExtras-v-chk179" style="display: none" type="checkbox"><label class="alectryon-input" for="ListSetExtras-v-chk179"><span class="kn">Proof</span>.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><span class="goal-separator"><hr></span><div class="goal-conclusion">set_remove_list [<span class="mi">3</span>; <span class="mi">1</span>; <span class="mi">3</span>] [<span class="mi">1</span>; <span class="mi">1</span>; <span class="mi">2</span>; <span class="mi">3</span>; <span class="mi">3</span>; <span class="mi">3</span>; <span class="mi">3</span>] =
[<span class="mi">1</span>; <span class="mi">2</span>; <span class="mi">3</span>; <span class="mi">3</span>]</div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="bp">done</span>.</span><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Qed</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
</span><span class="alectryon-sentence"><input class="alectryon-toggle" id="ListSetExtras-v-chk17a" style="display: none" type="checkbox"><label class="alectryon-input" for="ListSetExtras-v-chk17a"><span class="kn">Example</span> <span class="nf">set_remove_list2</span> : set_remove_list [<span class="mi">4</span>] [<span class="mi">1</span>;<span class="mi">2</span>;<span class="mi">3</span>] = [<span class="mi">1</span>;<span class="mi">2</span>;<span class="mi">3</span>].</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><span class="goal-separator"><hr></span><div class="goal-conclusion">set_remove_list [<span class="mi">4</span>] [<span class="mi">1</span>; <span class="mi">2</span>; <span class="mi">3</span>] = [<span class="mi">1</span>; <span class="mi">2</span>; <span class="mi">3</span>]</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="ListSetExtras-v-chk17b" style="display: none" type="checkbox"><label class="alectryon-input" for="ListSetExtras-v-chk17b"><span class="kn">Proof</span>.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><span class="goal-separator"><hr></span><div class="goal-conclusion">set_remove_list [<span class="mi">4</span>] [<span class="mi">1</span>; <span class="mi">2</span>; <span class="mi">3</span>] = [<span class="mi">1</span>; <span class="mi">2</span>; <span class="mi">3</span>]</div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="bp">done</span>.</span><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Qed</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
</span><span class="alectryon-sentence"><input class="alectryon-toggle" id="ListSetExtras-v-chk17c" style="display: none" type="checkbox"><label class="alectryon-input" for="ListSetExtras-v-chk17c"><span class="kn">Lemma</span> <span class="nf">set_remove_list_1</span>
  `{EqDecision A}
  (a : A)
  (l1 l2 : list A)
  (Hin : a ∈ (set_remove_list l1 l2)) :
  a ∈ l2.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>A</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>EqDecision0</var><span class="hyp-type"><b>: </b><span>EqDecision A</span></span></span><br><span><var>a</var><span class="hyp-type"><b>: </b><span>A</span></span></span><br><span><var>l1, l2</var><span class="hyp-type"><b>: </b><span>list A</span></span></span><br><span><var>Hin</var><span class="hyp-type"><b>: </b><span>a ∈ set_remove_list l1 l2</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">a ∈ l2</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="ListSetExtras-v-chk17d" style="display: none" type="checkbox"><label class="alectryon-input" for="ListSetExtras-v-chk17d"><span class="kn">Proof</span>.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>A</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>EqDecision0</var><span class="hyp-type"><b>: </b><span>EqDecision A</span></span></span><br><span><var>a</var><span class="hyp-type"><b>: </b><span>A</span></span></span><br><span><var>l1, l2</var><span class="hyp-type"><b>: </b><span>list A</span></span></span><br><span><var>Hin</var><span class="hyp-type"><b>: </b><span>a ∈ set_remove_list l1 l2</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">a ∈ l2</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="ListSetExtras-v-chk17e" style="display: none" type="checkbox"><label class="alectryon-input" for="ListSetExtras-v-chk17e"><span class="nb">unfold</span> set_remove_list <span class="kr">in</span> Hin.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>A</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>EqDecision0</var><span class="hyp-type"><b>: </b><span>EqDecision A</span></span></span><br><span><var>a</var><span class="hyp-type"><b>: </b><span>A</span></span></span><br><span><var>l1, l2</var><span class="hyp-type"><b>: </b><span>list A</span></span></span><br><span><var>Hin</var><span class="hyp-type"><b>: </b><span>a ∈ foldr set_remove l2 l1</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">a ∈ l2</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="ListSetExtras-v-chk17f" style="display: none" type="checkbox"><label class="alectryon-input" for="ListSetExtras-v-chk17f"><span class="nb">induction</span> l1.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>A</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>EqDecision0</var><span class="hyp-type"><b>: </b><span>EqDecision A</span></span></span><br><span><var>a</var><span class="hyp-type"><b>: </b><span>A</span></span></span><br><span><var>l2</var><span class="hyp-type"><b>: </b><span>list A</span></span></span><br><span><var>Hin</var><span class="hyp-type"><b>: </b><span>a ∈ foldr set_remove l2 []</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">a ∈ l2</div></blockquote><div class="alectryon-extra-goals"><input class="alectryon-extra-goal-toggle" id="ListSetExtras-v-chk180" style="display: none" type="checkbox"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>A</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>EqDecision0</var><span class="hyp-type"><b>: </b><span>EqDecision A</span></span></span><br><span><var>a, a0</var><span class="hyp-type"><b>: </b><span>A</span></span></span><br><span><var>l1, l2</var><span class="hyp-type"><b>: </b><span>list A</span></span></span><br><span><var>Hin</var><span class="hyp-type"><b>: </b><span>a ∈ foldr set_remove l2 (a0 :: l1)</span></span></span><br><span><var>IHl1</var><span class="hyp-type"><b>: </b><span>a ∈ foldr set_remove l2 l1 → a ∈ l2</span></span></span><br></div><label class="goal-separator" for="ListSetExtras-v-chk180"><hr></label><div class="goal-conclusion">a ∈ l2</div></blockquote></div></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="ListSetExtras-v-chk181" style="display: none" type="checkbox"><label class="alectryon-input" for="ListSetExtras-v-chk181">-</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>A</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>EqDecision0</var><span class="hyp-type"><b>: </b><span>EqDecision A</span></span></span><br><span><var>a</var><span class="hyp-type"><b>: </b><span>A</span></span></span><br><span><var>l2</var><span class="hyp-type"><b>: </b><span>list A</span></span></span><br><span><var>Hin</var><span class="hyp-type"><b>: </b><span>a ∈ foldr set_remove l2 []</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">a ∈ l2</div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="nb">simpl</span> <span class="kr">in</span> Hin; itauto.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="ListSetExtras-v-chk182" style="display: none" type="checkbox"><label class="alectryon-input" for="ListSetExtras-v-chk182">-</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>A</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>EqDecision0</var><span class="hyp-type"><b>: </b><span>EqDecision A</span></span></span><br><span><var>a, a0</var><span class="hyp-type"><b>: </b><span>A</span></span></span><br><span><var>l1, l2</var><span class="hyp-type"><b>: </b><span>list A</span></span></span><br><span><var>Hin</var><span class="hyp-type"><b>: </b><span>a ∈ foldr set_remove l2 (a0 :: l1)</span></span></span><br><span><var>IHl1</var><span class="hyp-type"><b>: </b><span>a ∈ foldr set_remove l2 l1 → a ∈ l2</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">a ∈ l2</div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="ListSetExtras-v-chk183" style="display: none" type="checkbox"><label class="alectryon-input" for="ListSetExtras-v-chk183"><span class="nb">simpl</span> <span class="kr">in</span> Hin.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>A</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>EqDecision0</var><span class="hyp-type"><b>: </b><span>EqDecision A</span></span></span><br><span><var>a, a0</var><span class="hyp-type"><b>: </b><span>A</span></span></span><br><span><var>l1, l2</var><span class="hyp-type"><b>: </b><span>list A</span></span></span><br><span><var>Hin</var><span class="hyp-type"><b>: </b><span>a ∈ set_remove a0 (foldr set_remove l2 l1)</span></span></span><br><span><var>IHl1</var><span class="hyp-type"><b>: </b><span>a ∈ foldr set_remove l2 l1 → a ∈ l2</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">a ∈ l2</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><span class="alectryon-input"><span class="bp">by</span> <span class="nb">apply</span> set_remove_1, IHl1 <span class="kr">in</span> Hin.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Qed</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
</span><span class="alectryon-sentence"><input class="alectryon-toggle" id="ListSetExtras-v-chk184" style="display: none" type="checkbox"><label class="alectryon-input" for="ListSetExtras-v-chk184"><span class="kn">Lemma</span> <span class="nf">set_prod_nodup</span> `(s1: <span class="nb">set</span> A) `(s2: <span class="nb">set</span> B):
  NoDup s1 -&gt;
  NoDup s2 -&gt;
  NoDup (set_prod s1 s2).</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>A</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>s1</var><span class="hyp-type"><b>: </b><span><span class="nb">set</span> A</span></span></span><br><span><var>B</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>s2</var><span class="hyp-type"><b>: </b><span><span class="nb">set</span> B</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">NoDup s1 → NoDup s2 → NoDup (set_prod s1 s2)</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="ListSetExtras-v-chk185" style="display: none" type="checkbox"><label class="alectryon-input" for="ListSetExtras-v-chk185"><span class="kn">Proof</span>.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>A</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>s1</var><span class="hyp-type"><b>: </b><span><span class="nb">set</span> A</span></span></span><br><span><var>B</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>s2</var><span class="hyp-type"><b>: </b><span><span class="nb">set</span> B</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">NoDup s1 → NoDup s2 → NoDup (set_prod s1 s2)</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="ListSetExtras-v-chk186" style="display: none" type="checkbox"><label class="alectryon-input" for="ListSetExtras-v-chk186"><span class="nb">intros</span> Hs1 HS2.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>A</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>s1</var><span class="hyp-type"><b>: </b><span><span class="nb">set</span> A</span></span></span><br><span><var>B</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>s2</var><span class="hyp-type"><b>: </b><span><span class="nb">set</span> B</span></span></span><br><span><var>Hs1</var><span class="hyp-type"><b>: </b><span>NoDup s1</span></span></span><br><span><var>HS2</var><span class="hyp-type"><b>: </b><span>NoDup s2</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">NoDup (set_prod s1 s2)</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="ListSetExtras-v-chk187" style="display: none" type="checkbox"><label class="alectryon-input" for="ListSetExtras-v-chk187"><span class="nb">induction</span> Hs1.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>A, B</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>s2</var><span class="hyp-type"><b>: </b><span><span class="nb">set</span> B</span></span></span><br><span><var>HS2</var><span class="hyp-type"><b>: </b><span>NoDup s2</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">NoDup (set_prod [] s2)</div></blockquote><div class="alectryon-extra-goals"><input class="alectryon-extra-goal-toggle" id="ListSetExtras-v-chk188" style="display: none" type="checkbox"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>A, B</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>s2</var><span class="hyp-type"><b>: </b><span><span class="nb">set</span> B</span></span></span><br><span><var>x</var><span class="hyp-type"><b>: </b><span>A</span></span></span><br><span><var>l</var><span class="hyp-type"><b>: </b><span>list A</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>x ∉ l</span></span></span><br><span><var>Hs1</var><span class="hyp-type"><b>: </b><span>NoDup l</span></span></span><br><span><var>HS2</var><span class="hyp-type"><b>: </b><span>NoDup s2</span></span></span><br><span><var>IHHs1</var><span class="hyp-type"><b>: </b><span>NoDup (set_prod l s2)</span></span></span><br></div><label class="goal-separator" for="ListSetExtras-v-chk188"><hr></label><div class="goal-conclusion">NoDup (set_prod (x :: l) s2)</div></blockquote></div></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="ListSetExtras-v-chk189" style="display: none" type="checkbox"><label class="alectryon-input" for="ListSetExtras-v-chk189">+</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>A, B</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>s2</var><span class="hyp-type"><b>: </b><span><span class="nb">set</span> B</span></span></span><br><span><var>HS2</var><span class="hyp-type"><b>: </b><span>NoDup s2</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">NoDup (set_prod [] s2)</div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="nb">constructor</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="ListSetExtras-v-chk18a" style="display: none" type="checkbox"><label class="alectryon-input" for="ListSetExtras-v-chk18a">+</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>A, B</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>s2</var><span class="hyp-type"><b>: </b><span><span class="nb">set</span> B</span></span></span><br><span><var>x</var><span class="hyp-type"><b>: </b><span>A</span></span></span><br><span><var>l</var><span class="hyp-type"><b>: </b><span>list A</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>x ∉ l</span></span></span><br><span><var>Hs1</var><span class="hyp-type"><b>: </b><span>NoDup l</span></span></span><br><span><var>HS2</var><span class="hyp-type"><b>: </b><span>NoDup s2</span></span></span><br><span><var>IHHs1</var><span class="hyp-type"><b>: </b><span>NoDup (set_prod l s2)</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">NoDup (set_prod (x :: l) s2)</div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="ListSetExtras-v-chk18b" style="display: none" type="checkbox"><label class="alectryon-input" for="ListSetExtras-v-chk18b"><span class="nb">simpl</span>.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>A, B</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>s2</var><span class="hyp-type"><b>: </b><span><span class="nb">set</span> B</span></span></span><br><span><var>x</var><span class="hyp-type"><b>: </b><span>A</span></span></span><br><span><var>l</var><span class="hyp-type"><b>: </b><span>list A</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>x ∉ l</span></span></span><br><span><var>Hs1</var><span class="hyp-type"><b>: </b><span>NoDup l</span></span></span><br><span><var>HS2</var><span class="hyp-type"><b>: </b><span>NoDup s2</span></span></span><br><span><var>IHHs1</var><span class="hyp-type"><b>: </b><span>NoDup (set_prod l s2)</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">NoDup (map (<span class="kr">λ</span> <span class="nv">y</span> : B, (x, y)) s2 ++ set_prod l s2)</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="ListSetExtras-v-chk18c" style="display: none" type="checkbox"><label class="alectryon-input" for="ListSetExtras-v-chk18c"><span class="nb">apply</span> nodup_append.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>A, B</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>s2</var><span class="hyp-type"><b>: </b><span><span class="nb">set</span> B</span></span></span><br><span><var>x</var><span class="hyp-type"><b>: </b><span>A</span></span></span><br><span><var>l</var><span class="hyp-type"><b>: </b><span>list A</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>x ∉ l</span></span></span><br><span><var>Hs1</var><span class="hyp-type"><b>: </b><span>NoDup l</span></span></span><br><span><var>HS2</var><span class="hyp-type"><b>: </b><span>NoDup s2</span></span></span><br><span><var>IHHs1</var><span class="hyp-type"><b>: </b><span>NoDup (set_prod l s2)</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">NoDup (map (<span class="kr">λ</span> <span class="nv">y</span> : B, (x, y)) s2)</div></blockquote><div class="alectryon-extra-goals"><input class="alectryon-extra-goal-toggle" id="ListSetExtras-v-chk18d" style="display: none" type="checkbox"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>A, B</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>s2</var><span class="hyp-type"><b>: </b><span><span class="nb">set</span> B</span></span></span><br><span><var>x</var><span class="hyp-type"><b>: </b><span>A</span></span></span><br><span><var>l</var><span class="hyp-type"><b>: </b><span>list A</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>x ∉ l</span></span></span><br><span><var>Hs1</var><span class="hyp-type"><b>: </b><span>NoDup l</span></span></span><br><span><var>HS2</var><span class="hyp-type"><b>: </b><span>NoDup s2</span></span></span><br><span><var>IHHs1</var><span class="hyp-type"><b>: </b><span>NoDup (set_prod l s2)</span></span></span><br></div><label class="goal-separator" for="ListSetExtras-v-chk18d"><hr></label><div class="goal-conclusion">NoDup (set_prod l s2)</div></blockquote><input class="alectryon-extra-goal-toggle" id="ListSetExtras-v-chk18e" style="display: none" type="checkbox"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>A, B</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>s2</var><span class="hyp-type"><b>: </b><span><span class="nb">set</span> B</span></span></span><br><span><var>x</var><span class="hyp-type"><b>: </b><span>A</span></span></span><br><span><var>l</var><span class="hyp-type"><b>: </b><span>list A</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>x ∉ l</span></span></span><br><span><var>Hs1</var><span class="hyp-type"><b>: </b><span>NoDup l</span></span></span><br><span><var>HS2</var><span class="hyp-type"><b>: </b><span>NoDup s2</span></span></span><br><span><var>IHHs1</var><span class="hyp-type"><b>: </b><span>NoDup (set_prod l s2)</span></span></span><br></div><label class="goal-separator" for="ListSetExtras-v-chk18e"><hr></label><div class="goal-conclusion"><span class="kr">∀</span> <span class="nv">a</span> : A * B,
  a ∈ map (<span class="kr">λ</span> <span class="nv">y</span> : B, (x, y)) s2 → a ∉ set_prod l s2</div></blockquote><input class="alectryon-extra-goal-toggle" id="ListSetExtras-v-chk18f" style="display: none" type="checkbox"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>A, B</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>s2</var><span class="hyp-type"><b>: </b><span><span class="nb">set</span> B</span></span></span><br><span><var>x</var><span class="hyp-type"><b>: </b><span>A</span></span></span><br><span><var>l</var><span class="hyp-type"><b>: </b><span>list A</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>x ∉ l</span></span></span><br><span><var>Hs1</var><span class="hyp-type"><b>: </b><span>NoDup l</span></span></span><br><span><var>HS2</var><span class="hyp-type"><b>: </b><span>NoDup s2</span></span></span><br><span><var>IHHs1</var><span class="hyp-type"><b>: </b><span>NoDup (set_prod l s2)</span></span></span><br></div><label class="goal-separator" for="ListSetExtras-v-chk18f"><hr></label><div class="goal-conclusion"><span class="kr">∀</span> <span class="nv">a</span> : A * B,
  a ∈ set_prod l s2 → a ∉ map (<span class="kr">λ</span> <span class="nv">y</span> : B, (x, y)) s2</div></blockquote></div></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="ListSetExtras-v-chk190" style="display: none" type="checkbox"><label class="alectryon-input" for="ListSetExtras-v-chk190">*</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>A, B</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>s2</var><span class="hyp-type"><b>: </b><span><span class="nb">set</span> B</span></span></span><br><span><var>x</var><span class="hyp-type"><b>: </b><span>A</span></span></span><br><span><var>l</var><span class="hyp-type"><b>: </b><span>list A</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>x ∉ l</span></span></span><br><span><var>Hs1</var><span class="hyp-type"><b>: </b><span>NoDup l</span></span></span><br><span><var>HS2</var><span class="hyp-type"><b>: </b><span>NoDup s2</span></span></span><br><span><var>IHHs1</var><span class="hyp-type"><b>: </b><span>NoDup (set_prod l s2)</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">NoDup (map (<span class="kr">λ</span> <span class="nv">y</span> : B, (x, y)) s2)</div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="nb">apply</span> NoDup_fmap; [<span class="bp">congruence</span> | <span class="bp">done</span>].</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="ListSetExtras-v-chk191" style="display: none" type="checkbox"><label class="alectryon-input" for="ListSetExtras-v-chk191">*</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>A, B</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>s2</var><span class="hyp-type"><b>: </b><span><span class="nb">set</span> B</span></span></span><br><span><var>x</var><span class="hyp-type"><b>: </b><span>A</span></span></span><br><span><var>l</var><span class="hyp-type"><b>: </b><span>list A</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>x ∉ l</span></span></span><br><span><var>Hs1</var><span class="hyp-type"><b>: </b><span>NoDup l</span></span></span><br><span><var>HS2</var><span class="hyp-type"><b>: </b><span>NoDup s2</span></span></span><br><span><var>IHHs1</var><span class="hyp-type"><b>: </b><span>NoDup (set_prod l s2)</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">NoDup (set_prod l s2)</div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="bp">done</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="ListSetExtras-v-chk192" style="display: none" type="checkbox"><label class="alectryon-input" for="ListSetExtras-v-chk192">*</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>A, B</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>s2</var><span class="hyp-type"><b>: </b><span><span class="nb">set</span> B</span></span></span><br><span><var>x</var><span class="hyp-type"><b>: </b><span>A</span></span></span><br><span><var>l</var><span class="hyp-type"><b>: </b><span>list A</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>x ∉ l</span></span></span><br><span><var>Hs1</var><span class="hyp-type"><b>: </b><span>NoDup l</span></span></span><br><span><var>HS2</var><span class="hyp-type"><b>: </b><span>NoDup s2</span></span></span><br><span><var>IHHs1</var><span class="hyp-type"><b>: </b><span>NoDup (set_prod l s2)</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="kr">∀</span> <span class="nv">a</span> : A * B,
  a ∈ map (<span class="kr">λ</span> <span class="nv">y</span> : B, (x, y)) s2 → a ∉ set_prod l s2</div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="ListSetExtras-v-chk193" style="display: none" type="checkbox"><label class="alectryon-input" for="ListSetExtras-v-chk193"><span class="nb">intros</span> [a b].</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>A, B</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>s2</var><span class="hyp-type"><b>: </b><span><span class="nb">set</span> B</span></span></span><br><span><var>x</var><span class="hyp-type"><b>: </b><span>A</span></span></span><br><span><var>l</var><span class="hyp-type"><b>: </b><span>list A</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>x ∉ l</span></span></span><br><span><var>Hs1</var><span class="hyp-type"><b>: </b><span>NoDup l</span></span></span><br><span><var>HS2</var><span class="hyp-type"><b>: </b><span>NoDup s2</span></span></span><br><span><var>IHHs1</var><span class="hyp-type"><b>: </b><span>NoDup (set_prod l s2)</span></span></span><br><span><var>a</var><span class="hyp-type"><b>: </b><span>A</span></span></span><br><span><var>b</var><span class="hyp-type"><b>: </b><span>B</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">(a, b) ∈ map (<span class="kr">λ</span> <span class="nv">y</span> : B, (x, y)) s2
→ (a, b) ∉ set_prod l s2</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">      </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="ListSetExtras-v-chk194" style="display: none" type="checkbox"><label class="alectryon-input" for="ListSetExtras-v-chk194"><span class="nb">rewrite</span> elem_of_list_fmap, elem_of_list_prod.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>A, B</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>s2</var><span class="hyp-type"><b>: </b><span><span class="nb">set</span> B</span></span></span><br><span><var>x</var><span class="hyp-type"><b>: </b><span>A</span></span></span><br><span><var>l</var><span class="hyp-type"><b>: </b><span>list A</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>x ∉ l</span></span></span><br><span><var>Hs1</var><span class="hyp-type"><b>: </b><span>NoDup l</span></span></span><br><span><var>HS2</var><span class="hyp-type"><b>: </b><span>NoDup s2</span></span></span><br><span><var>IHHs1</var><span class="hyp-type"><b>: </b><span>NoDup (set_prod l s2)</span></span></span><br><span><var>a</var><span class="hyp-type"><b>: </b><span>A</span></span></span><br><span><var>b</var><span class="hyp-type"><b>: </b><span>B</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">(<span class="kr">∃</span> <span class="nv">y</span> : B, (a, b) = (x, y) ∧ y ∈ s2)
→ ¬ (a ∈ l ∧ b ∈ s2)</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">      </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="ListSetExtras-v-chk195" style="display: none" type="checkbox"><label class="alectryon-input" for="ListSetExtras-v-chk195"><span class="nb">intros</span> [_ [[= &lt;- _] _]].</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>A, B</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>s2</var><span class="hyp-type"><b>: </b><span><span class="nb">set</span> B</span></span></span><br><span><var>l</var><span class="hyp-type"><b>: </b><span>list A</span></span></span><br><span><var>a</var><span class="hyp-type"><b>: </b><span>A</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>a ∉ l</span></span></span><br><span><var>Hs1</var><span class="hyp-type"><b>: </b><span>NoDup l</span></span></span><br><span><var>HS2</var><span class="hyp-type"><b>: </b><span>NoDup s2</span></span></span><br><span><var>IHHs1</var><span class="hyp-type"><b>: </b><span>NoDup (set_prod l s2)</span></span></span><br><span><var>b</var><span class="hyp-type"><b>: </b><span>B</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">¬ (a ∈ l ∧ b ∈ s2)</div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><span class="alectryon-input">itauto.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="ListSetExtras-v-chk196" style="display: none" type="checkbox"><label class="alectryon-input" for="ListSetExtras-v-chk196">*</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>A, B</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>s2</var><span class="hyp-type"><b>: </b><span><span class="nb">set</span> B</span></span></span><br><span><var>x</var><span class="hyp-type"><b>: </b><span>A</span></span></span><br><span><var>l</var><span class="hyp-type"><b>: </b><span>list A</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>x ∉ l</span></span></span><br><span><var>Hs1</var><span class="hyp-type"><b>: </b><span>NoDup l</span></span></span><br><span><var>HS2</var><span class="hyp-type"><b>: </b><span>NoDup s2</span></span></span><br><span><var>IHHs1</var><span class="hyp-type"><b>: </b><span>NoDup (set_prod l s2)</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="kr">∀</span> <span class="nv">a</span> : A * B,
  a ∈ set_prod l s2 → a ∉ map (<span class="kr">λ</span> <span class="nv">y</span> : B, (x, y)) s2</div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="ListSetExtras-v-chk197" style="display: none" type="checkbox"><label class="alectryon-input" for="ListSetExtras-v-chk197"><span class="nb">intros</span> [a b].</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>A, B</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>s2</var><span class="hyp-type"><b>: </b><span><span class="nb">set</span> B</span></span></span><br><span><var>x</var><span class="hyp-type"><b>: </b><span>A</span></span></span><br><span><var>l</var><span class="hyp-type"><b>: </b><span>list A</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>x ∉ l</span></span></span><br><span><var>Hs1</var><span class="hyp-type"><b>: </b><span>NoDup l</span></span></span><br><span><var>HS2</var><span class="hyp-type"><b>: </b><span>NoDup s2</span></span></span><br><span><var>IHHs1</var><span class="hyp-type"><b>: </b><span>NoDup (set_prod l s2)</span></span></span><br><span><var>a</var><span class="hyp-type"><b>: </b><span>A</span></span></span><br><span><var>b</var><span class="hyp-type"><b>: </b><span>B</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">(a, b) ∈ set_prod l s2
→ (a, b) ∉ map (<span class="kr">λ</span> <span class="nv">y</span> : B, (x, y)) s2</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">      </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="ListSetExtras-v-chk198" style="display: none" type="checkbox"><label class="alectryon-input" for="ListSetExtras-v-chk198"><span class="nb">rewrite</span> elem_of_list_prod, elem_of_list_fmap.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>A, B</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>s2</var><span class="hyp-type"><b>: </b><span><span class="nb">set</span> B</span></span></span><br><span><var>x</var><span class="hyp-type"><b>: </b><span>A</span></span></span><br><span><var>l</var><span class="hyp-type"><b>: </b><span>list A</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>x ∉ l</span></span></span><br><span><var>Hs1</var><span class="hyp-type"><b>: </b><span>NoDup l</span></span></span><br><span><var>HS2</var><span class="hyp-type"><b>: </b><span>NoDup s2</span></span></span><br><span><var>IHHs1</var><span class="hyp-type"><b>: </b><span>NoDup (set_prod l s2)</span></span></span><br><span><var>a</var><span class="hyp-type"><b>: </b><span>A</span></span></span><br><span><var>b</var><span class="hyp-type"><b>: </b><span>B</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">a ∈ l ∧ b ∈ s2 → ¬ (<span class="kr">∃</span> <span class="nv">y</span> : B, (a, b) = (x, y) ∧ y ∈ s2)</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">      </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="ListSetExtras-v-chk199" style="display: none" type="checkbox"><label class="alectryon-input" for="ListSetExtras-v-chk199"><span class="nb">intros</span> [Ha _] [_ [[= Hax _] _]].</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>A, B</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>s2</var><span class="hyp-type"><b>: </b><span><span class="nb">set</span> B</span></span></span><br><span><var>x</var><span class="hyp-type"><b>: </b><span>A</span></span></span><br><span><var>l</var><span class="hyp-type"><b>: </b><span>list A</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>x ∉ l</span></span></span><br><span><var>Hs1</var><span class="hyp-type"><b>: </b><span>NoDup l</span></span></span><br><span><var>HS2</var><span class="hyp-type"><b>: </b><span>NoDup s2</span></span></span><br><span><var>IHHs1</var><span class="hyp-type"><b>: </b><span>NoDup (set_prod l s2)</span></span></span><br><span><var>a</var><span class="hyp-type"><b>: </b><span>A</span></span></span><br><span><var>b</var><span class="hyp-type"><b>: </b><span>B</span></span></span><br><span><var>Ha</var><span class="hyp-type"><b>: </b><span>a ∈ l</span></span></span><br><span><var>Hax</var><span class="hyp-type"><b>: </b><span>a = x</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="kt">False</span></div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="bp">congruence</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Qed</span>.</span></span></pre><div class="doc">
  An alternative to <span class="inlinecode"><span class="id" title="var">set_diff</span></span>.
  Unlike <span class="inlinecode"><span class="id" title="var">set_diff</span></span>, the result may contain
  duplicates if the first argument list <code>l</code> does.

<div class="paragraph"> </div>

  This definition exists to make proving
  <span class="inlinecode"><span class="id" title="var">len_set_diff_decrease</span></span> more convenient,
  because <span class="inlinecode"><span class="id" title="var">length</span></span> of <span class="inlinecode"><span class="id" title="var">filter</span></span> can be simplified
  step by step while doing induction over <code>l</code>.
 
</div><pre class="alectryon-io highlight"><!-- Generator: Alectryon --><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Definition</span> <span class="nf">set_diff_filter</span> `{EqDecision A} (l r : list A) :=
  filter (.∉ r) l.</span></span></pre><div class="doc">
  The characteristic membership property, parallel to
  <span class="inlinecode"><span class="id" title="var">set_diff_iff</span></span>.
 
</div><pre class="alectryon-io highlight"><!-- Generator: Alectryon --><span class="alectryon-sentence"><input class="alectryon-toggle" id="ListSetExtras-v-chk19a" style="display: none" type="checkbox"><label class="alectryon-input" for="ListSetExtras-v-chk19a"><span class="kn">Lemma</span> <span class="nf">set_diff_filter_iff</span> `{EqDecision A} (a:A) l r:
  a ∈ (set_diff_filter l r) &lt;-&gt; (a ∈ l /\ ~a ∈ r).</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>A</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>EqDecision0</var><span class="hyp-type"><b>: </b><span>EqDecision A</span></span></span><br><span><var>a</var><span class="hyp-type"><b>: </b><span>A</span></span></span><br><span><var>l, r</var><span class="hyp-type"><b>: </b><span>list A</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">a ∈ set_diff_filter l r ↔ a ∈ l ∧ a ∉ r</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="ListSetExtras-v-chk19b" style="display: none" type="checkbox"><label class="alectryon-input" for="ListSetExtras-v-chk19b"><span class="kn">Proof</span>.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>A</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>EqDecision0</var><span class="hyp-type"><b>: </b><span>EqDecision A</span></span></span><br><span><var>a</var><span class="hyp-type"><b>: </b><span>A</span></span></span><br><span><var>l, r</var><span class="hyp-type"><b>: </b><span>list A</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">a ∈ set_diff_filter l r ↔ a ∈ l ∧ a ∉ r</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="ListSetExtras-v-chk19c" style="display: none" type="checkbox"><label class="alectryon-input" for="ListSetExtras-v-chk19c"><span class="nb">induction</span> l;<span class="nb">simpl</span>.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>A</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>EqDecision0</var><span class="hyp-type"><b>: </b><span>EqDecision A</span></span></span><br><span><var>a</var><span class="hyp-type"><b>: </b><span>A</span></span></span><br><span><var>r</var><span class="hyp-type"><b>: </b><span>list A</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">a ∈ set_diff_filter [] r ↔ a ∈ [] ∧ a ∉ r</div></blockquote><div class="alectryon-extra-goals"><input class="alectryon-extra-goal-toggle" id="ListSetExtras-v-chk19d" style="display: none" type="checkbox"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>A</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>EqDecision0</var><span class="hyp-type"><b>: </b><span>EqDecision A</span></span></span><br><span><var>a, a0</var><span class="hyp-type"><b>: </b><span>A</span></span></span><br><span><var>l, r</var><span class="hyp-type"><b>: </b><span>list A</span></span></span><br><span><var>IHl</var><span class="hyp-type"><b>: </b><span>a ∈ set_diff_filter l r ↔ a ∈ l ∧ a ∉ r</span></span></span><br></div><label class="goal-separator" for="ListSetExtras-v-chk19d"><hr></label><div class="goal-conclusion">a ∈ set_diff_filter (a0 :: l) r ↔ a ∈ a0 :: l ∧ a ∉ r</div></blockquote></div></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="ListSetExtras-v-chk19e" style="display: none" type="checkbox"><label class="alectryon-input" for="ListSetExtras-v-chk19e">-</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>A</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>EqDecision0</var><span class="hyp-type"><b>: </b><span>EqDecision A</span></span></span><br><span><var>a</var><span class="hyp-type"><b>: </b><span>A</span></span></span><br><span><var>r</var><span class="hyp-type"><b>: </b><span>list A</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">a ∈ set_diff_filter [] r ↔ a ∈ [] ∧ a ∉ r</div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="ListSetExtras-v-chk19f" style="display: none" type="checkbox"><label class="alectryon-input" for="ListSetExtras-v-chk19f"><span class="nb">cbn</span>.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>A</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>EqDecision0</var><span class="hyp-type"><b>: </b><span>EqDecision A</span></span></span><br><span><var>a</var><span class="hyp-type"><b>: </b><span>A</span></span></span><br><span><var>r</var><span class="hyp-type"><b>: </b><span>list A</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">a ∈ [] ↔ a ∈ [] ∧ a ∉ r</div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="ListSetExtras-v-chk1a0" style="display: none" type="checkbox"><label class="alectryon-input" for="ListSetExtras-v-chk1a0"><span class="nb">split</span>; <span class="nb">intros</span>; [|itauto].</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>A</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>EqDecision0</var><span class="hyp-type"><b>: </b><span>EqDecision A</span></span></span><br><span><var>a</var><span class="hyp-type"><b>: </b><span>A</span></span></span><br><span><var>r</var><span class="hyp-type"><b>: </b><span>list A</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>a ∈ []</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">a ∈ [] ∧ a ∉ r</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><span class="alectryon-input"><span class="nb">inversion</span> H.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="ListSetExtras-v-chk1a1" style="display: none" type="checkbox"><label class="alectryon-input" for="ListSetExtras-v-chk1a1">-</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>A</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>EqDecision0</var><span class="hyp-type"><b>: </b><span>EqDecision A</span></span></span><br><span><var>a, a0</var><span class="hyp-type"><b>: </b><span>A</span></span></span><br><span><var>l, r</var><span class="hyp-type"><b>: </b><span>list A</span></span></span><br><span><var>IHl</var><span class="hyp-type"><b>: </b><span>a ∈ set_diff_filter l r ↔ a ∈ l ∧ a ∉ r</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">a ∈ set_diff_filter (a0 :: l) r ↔ a ∈ a0 :: l ∧ a ∉ r</div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="ListSetExtras-v-chk1a2" style="display: none" type="checkbox"><label class="alectryon-input" for="ListSetExtras-v-chk1a2"><span class="nb">unfold</span> set_diff_filter <span class="kr">in</span> *.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>A</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>EqDecision0</var><span class="hyp-type"><b>: </b><span>EqDecision A</span></span></span><br><span><var>a, a0</var><span class="hyp-type"><b>: </b><span>A</span></span></span><br><span><var>l, r</var><span class="hyp-type"><b>: </b><span>list A</span></span></span><br><span><var>IHl</var><span class="hyp-type"><b>: </b><span>a ∈ filter (<span class="kr">λ</span> <span class="nv">x</span> : A, x ∉ r) l ↔ a ∈ l ∧ a ∉ r</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">a ∈ filter (<span class="kr">λ</span> <span class="nv">x</span> : A, x ∉ r) (a0 :: l)
↔ a ∈ a0 :: l ∧ a ∉ r</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="ListSetExtras-v-chk1a3" style="display: none" type="checkbox"><label class="alectryon-input" for="ListSetExtras-v-chk1a3"><span class="nb">rewrite</span> filter_cons.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>A</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>EqDecision0</var><span class="hyp-type"><b>: </b><span>EqDecision A</span></span></span><br><span><var>a, a0</var><span class="hyp-type"><b>: </b><span>A</span></span></span><br><span><var>l, r</var><span class="hyp-type"><b>: </b><span>list A</span></span></span><br><span><var>IHl</var><span class="hyp-type"><b>: </b><span>a ∈ filter (<span class="kr">λ</span> <span class="nv">x</span> : A, x ∉ r) l ↔ a ∈ l ∧ a ∉ r</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">a
∈ (<span class="kr">if</span> decide (a0 ∉ r)
   <span class="kr">then</span> a0 :: filter (<span class="kr">λ</span> <span class="nv">x</span> : A, x ∉ r) l
   <span class="kr">else</span> filter (<span class="kr">λ</span> <span class="nv">x</span> : A, x ∉ r) l)
↔ a ∈ a0 :: l ∧ a ∉ r</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="ListSetExtras-v-chk1a4" style="display: none" type="checkbox"><label class="alectryon-input" for="ListSetExtras-v-chk1a4"><span class="nb">destruct</span> (decide (~ a0 ∈ r)).</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>A</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>EqDecision0</var><span class="hyp-type"><b>: </b><span>EqDecision A</span></span></span><br><span><var>a, a0</var><span class="hyp-type"><b>: </b><span>A</span></span></span><br><span><var>l, r</var><span class="hyp-type"><b>: </b><span>list A</span></span></span><br><span><var>IHl</var><span class="hyp-type"><b>: </b><span>a ∈ filter (<span class="kr">λ</span> <span class="nv">x</span> : A, x ∉ r) l ↔ a ∈ l ∧ a ∉ r</span></span></span><br><span><var>n</var><span class="hyp-type"><b>: </b><span>a0 ∉ r</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">a ∈ a0 :: filter (<span class="kr">λ</span> <span class="nv">x</span> : A, x ∉ r) l
↔ a ∈ a0 :: l ∧ a ∉ r</div></blockquote><div class="alectryon-extra-goals"><input class="alectryon-extra-goal-toggle" id="ListSetExtras-v-chk1a5" style="display: none" type="checkbox"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>A</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>EqDecision0</var><span class="hyp-type"><b>: </b><span>EqDecision A</span></span></span><br><span><var>a, a0</var><span class="hyp-type"><b>: </b><span>A</span></span></span><br><span><var>l, r</var><span class="hyp-type"><b>: </b><span>list A</span></span></span><br><span><var>IHl</var><span class="hyp-type"><b>: </b><span>a ∈ filter (<span class="kr">λ</span> <span class="nv">x</span> : A, x ∉ r) l ↔ a ∈ l ∧ a ∉ r</span></span></span><br><span><var>n</var><span class="hyp-type"><b>: </b><span>¬ (a0 ∉ r)</span></span></span><br></div><label class="goal-separator" for="ListSetExtras-v-chk1a5"><hr></label><div class="goal-conclusion">a ∈ filter (<span class="kr">λ</span> <span class="nv">x</span> : A, x ∉ r) l ↔ a ∈ a0 :: l ∧ a ∉ r</div></blockquote></div></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="ListSetExtras-v-chk1a6" style="display: none" type="checkbox"><label class="alectryon-input" for="ListSetExtras-v-chk1a6">*</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>A</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>EqDecision0</var><span class="hyp-type"><b>: </b><span>EqDecision A</span></span></span><br><span><var>a, a0</var><span class="hyp-type"><b>: </b><span>A</span></span></span><br><span><var>l, r</var><span class="hyp-type"><b>: </b><span>list A</span></span></span><br><span><var>IHl</var><span class="hyp-type"><b>: </b><span>a ∈ filter (<span class="kr">λ</span> <span class="nv">x</span> : A, x ∉ r) l ↔ a ∈ l ∧ a ∉ r</span></span></span><br><span><var>n</var><span class="hyp-type"><b>: </b><span>a0 ∉ r</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">a ∈ a0 :: filter (<span class="kr">λ</span> <span class="nv">x</span> : A, x ∉ r) l
↔ a ∈ a0 :: l ∧ a ∉ r</div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="ListSetExtras-v-chk1a7" style="display: none" type="checkbox"><label class="alectryon-input" for="ListSetExtras-v-chk1a7"><span class="nb">rewrite</span> <span class="mi">2</span> elem_of_cons, IHl.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>A</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>EqDecision0</var><span class="hyp-type"><b>: </b><span>EqDecision A</span></span></span><br><span><var>a, a0</var><span class="hyp-type"><b>: </b><span>A</span></span></span><br><span><var>l, r</var><span class="hyp-type"><b>: </b><span>list A</span></span></span><br><span><var>IHl</var><span class="hyp-type"><b>: </b><span>a ∈ filter (<span class="kr">λ</span> <span class="nv">x</span> : A, x ∉ r) l ↔ a ∈ l ∧ a ∉ r</span></span></span><br><span><var>n</var><span class="hyp-type"><b>: </b><span>a0 ∉ r</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">a = a0 ∨ a ∈ l ∧ a ∉ r ↔ (a = a0 ∨ a ∈ l) ∧ a ∉ r</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">      </span><span class="alectryon-sentence"><span class="alectryon-input"><span class="nb">split</span>; itauto <span class="bp">congruence</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="ListSetExtras-v-chk1a8" style="display: none" type="checkbox"><label class="alectryon-input" for="ListSetExtras-v-chk1a8">*</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>A</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>EqDecision0</var><span class="hyp-type"><b>: </b><span>EqDecision A</span></span></span><br><span><var>a, a0</var><span class="hyp-type"><b>: </b><span>A</span></span></span><br><span><var>l, r</var><span class="hyp-type"><b>: </b><span>list A</span></span></span><br><span><var>IHl</var><span class="hyp-type"><b>: </b><span>a ∈ filter (<span class="kr">λ</span> <span class="nv">x</span> : A, x ∉ r) l ↔ a ∈ l ∧ a ∉ r</span></span></span><br><span><var>n</var><span class="hyp-type"><b>: </b><span>¬ (a0 ∉ r)</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">a ∈ filter (<span class="kr">λ</span> <span class="nv">x</span> : A, x ∉ r) l ↔ a ∈ a0 :: l ∧ a ∉ r</div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="ListSetExtras-v-chk1a9" style="display: none" type="checkbox"><label class="alectryon-input" for="ListSetExtras-v-chk1a9"><span class="nb">rewrite</span> elem_of_cons.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>A</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>EqDecision0</var><span class="hyp-type"><b>: </b><span>EqDecision A</span></span></span><br><span><var>a, a0</var><span class="hyp-type"><b>: </b><span>A</span></span></span><br><span><var>l, r</var><span class="hyp-type"><b>: </b><span>list A</span></span></span><br><span><var>IHl</var><span class="hyp-type"><b>: </b><span>a ∈ filter (<span class="kr">λ</span> <span class="nv">x</span> : A, x ∉ r) l ↔ a ∈ l ∧ a ∉ r</span></span></span><br><span><var>n</var><span class="hyp-type"><b>: </b><span>¬ (a0 ∉ r)</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">a ∈ filter (<span class="kr">λ</span> <span class="nv">x</span> : A, x ∉ r) l
↔ (a = a0 ∨ a ∈ l) ∧ a ∉ r</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">      </span><span class="alectryon-sentence"><span class="alectryon-input"><span class="nb">split</span>;itauto <span class="bp">congruence</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Qed</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
</span><span class="alectryon-sentence"><input class="alectryon-toggle" id="ListSetExtras-v-chk1aa" style="display: none" type="checkbox"><label class="alectryon-input" for="ListSetExtras-v-chk1aa"><span class="kn">Lemma</span> <span class="nf">set_diff_filter_nodup</span> `{EqDecision A} (l r:list A):
  NoDup l -&gt; NoDup (set_diff_filter l r).</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>A</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>EqDecision0</var><span class="hyp-type"><b>: </b><span>EqDecision A</span></span></span><br><span><var>l, r</var><span class="hyp-type"><b>: </b><span>list A</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">NoDup l → NoDup (set_diff_filter l r)</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="ListSetExtras-v-chk1ab" style="display: none" type="checkbox"><label class="alectryon-input" for="ListSetExtras-v-chk1ab"><span class="kn">Proof</span>.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>A</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>EqDecision0</var><span class="hyp-type"><b>: </b><span>EqDecision A</span></span></span><br><span><var>l, r</var><span class="hyp-type"><b>: </b><span>list A</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">NoDup l → NoDup (set_diff_filter l r)</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="ListSetExtras-v-chk1ac" style="display: none" type="checkbox"><label class="alectryon-input" for="ListSetExtras-v-chk1ac"><span class="nb">intros</span> H.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>A</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>EqDecision0</var><span class="hyp-type"><b>: </b><span>EqDecision A</span></span></span><br><span><var>l, r</var><span class="hyp-type"><b>: </b><span>list A</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>NoDup l</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">NoDup (set_diff_filter l r)</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><span class="alectryon-input"><span class="bp">by</span> <span class="nb">apply</span> NoDup_filter.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Qed</span>.</span></span></pre><div class="doc">
  Prove that subtracting a superset cannot produce
  a smaller result.
  This lemma is used to prove <span class="inlinecode"><span class="id" title="var">len_set_diff_decrease</span></span>.
 
</div><pre class="alectryon-io highlight"><!-- Generator: Alectryon --><span class="alectryon-sentence"><input class="alectryon-toggle" id="ListSetExtras-v-chk1ad" style="display: none" type="checkbox"><label class="alectryon-input" for="ListSetExtras-v-chk1ad"><span class="kn">Lemma</span> <span class="nf">len_set_diff_incl_le</span> `{EqDecision A} (l a b: list A)
      (H_subseteq: <span class="kr">forall</span> <span class="nv">x</span>, x ∈ b -&gt; x ∈ a):
  length (set_diff_filter l a) &lt;= length (set_diff_filter l b).</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>A</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>EqDecision0</var><span class="hyp-type"><b>: </b><span>EqDecision A</span></span></span><br><span><var>l, a, b</var><span class="hyp-type"><b>: </b><span>list A</span></span></span><br><span><var>H_subseteq</var><span class="hyp-type"><b>: </b><span><span class="kr">∀</span> <span class="nv">x</span> : A, x ∈ b → x ∈ a</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">length (set_diff_filter l a)
≤ length (set_diff_filter l b)</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="ListSetExtras-v-chk1ae" style="display: none" type="checkbox"><label class="alectryon-input" for="ListSetExtras-v-chk1ae"><span class="kn">Proof</span>.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>A</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>EqDecision0</var><span class="hyp-type"><b>: </b><span>EqDecision A</span></span></span><br><span><var>l, a, b</var><span class="hyp-type"><b>: </b><span>list A</span></span></span><br><span><var>H_subseteq</var><span class="hyp-type"><b>: </b><span><span class="kr">∀</span> <span class="nv">x</span> : A, x ∈ b → x ∈ a</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">length (set_diff_filter l a)
≤ length (set_diff_filter l b)</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="ListSetExtras-v-chk1af" style="display: none" type="checkbox"><label class="alectryon-input" for="ListSetExtras-v-chk1af"><span class="nb">induction</span> l; [<span class="bp">done</span> |].</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>A</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>EqDecision0</var><span class="hyp-type"><b>: </b><span>EqDecision A</span></span></span><br><span><var>a0</var><span class="hyp-type"><b>: </b><span>A</span></span></span><br><span><var>l, a, b</var><span class="hyp-type"><b>: </b><span>list A</span></span></span><br><span><var>H_subseteq</var><span class="hyp-type"><b>: </b><span><span class="kr">∀</span> <span class="nv">x</span> : A, x ∈ b → x ∈ a</span></span></span><br><span><var>IHl</var><span class="hyp-type"><b>: </b><span>length (set_diff_filter l a)
≤ length (set_diff_filter l b)</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">length (set_diff_filter (a0 :: l) a)
≤ length (set_diff_filter (a0 :: l) b)</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="ListSetExtras-v-chk1b0" style="display: none" type="checkbox"><label class="alectryon-input" for="ListSetExtras-v-chk1b0"><span class="nb">unfold</span> set_diff_filter.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>A</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>EqDecision0</var><span class="hyp-type"><b>: </b><span>EqDecision A</span></span></span><br><span><var>a0</var><span class="hyp-type"><b>: </b><span>A</span></span></span><br><span><var>l, a, b</var><span class="hyp-type"><b>: </b><span>list A</span></span></span><br><span><var>H_subseteq</var><span class="hyp-type"><b>: </b><span><span class="kr">∀</span> <span class="nv">x</span> : A, x ∈ b → x ∈ a</span></span></span><br><span><var>IHl</var><span class="hyp-type"><b>: </b><span>length (set_diff_filter l a)
≤ length (set_diff_filter l b)</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">length (filter (<span class="kr">λ</span> <span class="nv">x</span> : A, x ∉ a) (a0 :: l))
≤ length (filter (<span class="kr">λ</span> <span class="nv">x</span> : A, x ∉ b) (a0 :: l))</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="ListSetExtras-v-chk1b1" style="display: none" type="checkbox"><label class="alectryon-input" for="ListSetExtras-v-chk1b1"><span class="nb">rewrite</span> <span class="mi">2</span> filter_cons.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>A</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>EqDecision0</var><span class="hyp-type"><b>: </b><span>EqDecision A</span></span></span><br><span><var>a0</var><span class="hyp-type"><b>: </b><span>A</span></span></span><br><span><var>l, a, b</var><span class="hyp-type"><b>: </b><span>list A</span></span></span><br><span><var>H_subseteq</var><span class="hyp-type"><b>: </b><span><span class="kr">∀</span> <span class="nv">x</span> : A, x ∈ b → x ∈ a</span></span></span><br><span><var>IHl</var><span class="hyp-type"><b>: </b><span>length (set_diff_filter l a)
≤ length (set_diff_filter l b)</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">length
  (<span class="kr">if</span> decide (a0 ∉ a)
   <span class="kr">then</span> a0 :: filter (<span class="kr">λ</span> <span class="nv">x</span> : A, x ∉ a) l
   <span class="kr">else</span> filter (<span class="kr">λ</span> <span class="nv">x</span> : A, x ∉ a) l)
≤ length
    (<span class="kr">if</span> decide (a0 ∉ b)
     <span class="kr">then</span> a0 :: filter (<span class="kr">λ</span> <span class="nv">x</span> : A, x ∉ b) l
     <span class="kr">else</span> filter (<span class="kr">λ</span> <span class="nv">x</span> : A, x ∉ b) l)</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="ListSetExtras-v-chk1b2" style="display: none" type="checkbox"><label class="alectryon-input" for="ListSetExtras-v-chk1b2"><span class="nb">destruct</span> (decide (~ a0 ∈ a)); <span class="nb">destruct</span> (decide (~ a0 ∈ b)).</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>A</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>EqDecision0</var><span class="hyp-type"><b>: </b><span>EqDecision A</span></span></span><br><span><var>a0</var><span class="hyp-type"><b>: </b><span>A</span></span></span><br><span><var>l, a, b</var><span class="hyp-type"><b>: </b><span>list A</span></span></span><br><span><var>H_subseteq</var><span class="hyp-type"><b>: </b><span><span class="kr">∀</span> <span class="nv">x</span> : A, x ∈ b → x ∈ a</span></span></span><br><span><var>IHl</var><span class="hyp-type"><b>: </b><span>length (set_diff_filter l a)
≤ length (set_diff_filter l b)</span></span></span><br><span><var>n</var><span class="hyp-type"><b>: </b><span>a0 ∉ a</span></span></span><br><span><var>n0</var><span class="hyp-type"><b>: </b><span>a0 ∉ b</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">length (a0 :: filter (<span class="kr">λ</span> <span class="nv">x</span> : A, x ∉ a) l)
≤ length (a0 :: filter (<span class="kr">λ</span> <span class="nv">x</span> : A, x ∉ b) l)</div></blockquote><div class="alectryon-extra-goals"><input class="alectryon-extra-goal-toggle" id="ListSetExtras-v-chk1b3" style="display: none" type="checkbox"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>A</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>EqDecision0</var><span class="hyp-type"><b>: </b><span>EqDecision A</span></span></span><br><span><var>a0</var><span class="hyp-type"><b>: </b><span>A</span></span></span><br><span><var>l, a, b</var><span class="hyp-type"><b>: </b><span>list A</span></span></span><br><span><var>H_subseteq</var><span class="hyp-type"><b>: </b><span><span class="kr">∀</span> <span class="nv">x</span> : A, x ∈ b → x ∈ a</span></span></span><br><span><var>IHl</var><span class="hyp-type"><b>: </b><span>length (set_diff_filter l a)
≤ length (set_diff_filter l b)</span></span></span><br><span><var>n</var><span class="hyp-type"><b>: </b><span>a0 ∉ a</span></span></span><br><span><var>n0</var><span class="hyp-type"><b>: </b><span>¬ (a0 ∉ b)</span></span></span><br></div><label class="goal-separator" for="ListSetExtras-v-chk1b3"><hr></label><div class="goal-conclusion">length (a0 :: filter (<span class="kr">λ</span> <span class="nv">x</span> : A, x ∉ a) l)
≤ length (filter (<span class="kr">λ</span> <span class="nv">x</span> : A, x ∉ b) l)</div></blockquote><input class="alectryon-extra-goal-toggle" id="ListSetExtras-v-chk1b4" style="display: none" type="checkbox"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>A</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>EqDecision0</var><span class="hyp-type"><b>: </b><span>EqDecision A</span></span></span><br><span><var>a0</var><span class="hyp-type"><b>: </b><span>A</span></span></span><br><span><var>l, a, b</var><span class="hyp-type"><b>: </b><span>list A</span></span></span><br><span><var>H_subseteq</var><span class="hyp-type"><b>: </b><span><span class="kr">∀</span> <span class="nv">x</span> : A, x ∈ b → x ∈ a</span></span></span><br><span><var>IHl</var><span class="hyp-type"><b>: </b><span>length (set_diff_filter l a)
≤ length (set_diff_filter l b)</span></span></span><br><span><var>n</var><span class="hyp-type"><b>: </b><span>¬ (a0 ∉ a)</span></span></span><br><span><var>n0</var><span class="hyp-type"><b>: </b><span>a0 ∉ b</span></span></span><br></div><label class="goal-separator" for="ListSetExtras-v-chk1b4"><hr></label><div class="goal-conclusion">length (filter (<span class="kr">λ</span> <span class="nv">x</span> : A, x ∉ a) l)
≤ length (a0 :: filter (<span class="kr">λ</span> <span class="nv">x</span> : A, x ∉ b) l)</div></blockquote><input class="alectryon-extra-goal-toggle" id="ListSetExtras-v-chk1b5" style="display: none" type="checkbox"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>A</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>EqDecision0</var><span class="hyp-type"><b>: </b><span>EqDecision A</span></span></span><br><span><var>a0</var><span class="hyp-type"><b>: </b><span>A</span></span></span><br><span><var>l, a, b</var><span class="hyp-type"><b>: </b><span>list A</span></span></span><br><span><var>H_subseteq</var><span class="hyp-type"><b>: </b><span><span class="kr">∀</span> <span class="nv">x</span> : A, x ∈ b → x ∈ a</span></span></span><br><span><var>IHl</var><span class="hyp-type"><b>: </b><span>length (set_diff_filter l a)
≤ length (set_diff_filter l b)</span></span></span><br><span><var>n</var><span class="hyp-type"><b>: </b><span>¬ (a0 ∉ a)</span></span></span><br><span><var>n0</var><span class="hyp-type"><b>: </b><span>¬ (a0 ∉ b)</span></span></span><br></div><label class="goal-separator" for="ListSetExtras-v-chk1b5"><hr></label><div class="goal-conclusion">length (filter (<span class="kr">λ</span> <span class="nv">x</span> : A, x ∉ a) l)
≤ length (filter (<span class="kr">λ</span> <span class="nv">x</span> : A, x ∉ b) l)</div></blockquote></div></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="ListSetExtras-v-chk1b6" style="display: none" type="checkbox"><label class="alectryon-input" for="ListSetExtras-v-chk1b6">-</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>A</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>EqDecision0</var><span class="hyp-type"><b>: </b><span>EqDecision A</span></span></span><br><span><var>a0</var><span class="hyp-type"><b>: </b><span>A</span></span></span><br><span><var>l, a, b</var><span class="hyp-type"><b>: </b><span>list A</span></span></span><br><span><var>H_subseteq</var><span class="hyp-type"><b>: </b><span><span class="kr">∀</span> <span class="nv">x</span> : A, x ∈ b → x ∈ a</span></span></span><br><span><var>IHl</var><span class="hyp-type"><b>: </b><span>length (set_diff_filter l a)
≤ length (set_diff_filter l b)</span></span></span><br><span><var>n</var><span class="hyp-type"><b>: </b><span>a0 ∉ a</span></span></span><br><span><var>n0</var><span class="hyp-type"><b>: </b><span>a0 ∉ b</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">length (a0 :: filter (<span class="kr">λ</span> <span class="nv">x</span> : A, x ∉ a) l)
≤ length (a0 :: filter (<span class="kr">λ</span> <span class="nv">x</span> : A, x ∉ b) l)</div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="ListSetExtras-v-chk1b7" style="display: none" type="checkbox"><label class="alectryon-input" for="ListSetExtras-v-chk1b7"><span class="nb">simpl</span>.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>A</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>EqDecision0</var><span class="hyp-type"><b>: </b><span>EqDecision A</span></span></span><br><span><var>a0</var><span class="hyp-type"><b>: </b><span>A</span></span></span><br><span><var>l, a, b</var><span class="hyp-type"><b>: </b><span>list A</span></span></span><br><span><var>H_subseteq</var><span class="hyp-type"><b>: </b><span><span class="kr">∀</span> <span class="nv">x</span> : A, x ∈ b → x ∈ a</span></span></span><br><span><var>IHl</var><span class="hyp-type"><b>: </b><span>length (set_diff_filter l a)
≤ length (set_diff_filter l b)</span></span></span><br><span><var>n</var><span class="hyp-type"><b>: </b><span>a0 ∉ a</span></span></span><br><span><var>n0</var><span class="hyp-type"><b>: </b><span>a0 ∉ b</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">S (length (filter (<span class="kr">λ</span> <span class="nv">x</span> : A, x ∉ a) l))
≤ S (length (filter (<span class="kr">λ</span> <span class="nv">x</span> : A, x ∉ b) l))</div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="ListSetExtras-v-chk1b8" style="display: none" type="checkbox"><label class="alectryon-input" for="ListSetExtras-v-chk1b8"><span class="nb">unfold</span> set_diff_filter <span class="kr">in</span> IHl.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>A</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>EqDecision0</var><span class="hyp-type"><b>: </b><span>EqDecision A</span></span></span><br><span><var>a0</var><span class="hyp-type"><b>: </b><span>A</span></span></span><br><span><var>l, a, b</var><span class="hyp-type"><b>: </b><span>list A</span></span></span><br><span><var>H_subseteq</var><span class="hyp-type"><b>: </b><span><span class="kr">∀</span> <span class="nv">x</span> : A, x ∈ b → x ∈ a</span></span></span><br><span><var>IHl</var><span class="hyp-type"><b>: </b><span>length (filter (<span class="kr">λ</span> <span class="nv">x</span> : A, x ∉ a) l)
≤ length (filter (<span class="kr">λ</span> <span class="nv">x</span> : A, x ∉ b) l)</span></span></span><br><span><var>n</var><span class="hyp-type"><b>: </b><span>a0 ∉ a</span></span></span><br><span><var>n0</var><span class="hyp-type"><b>: </b><span>a0 ∉ b</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">S (length (filter (<span class="kr">λ</span> <span class="nv">x</span> : A, x ∉ a) l))
≤ S (length (filter (<span class="kr">λ</span> <span class="nv">x</span> : A, x ∉ b) l))</div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="bp">lia</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="ListSetExtras-v-chk1b9" style="display: none" type="checkbox"><label class="alectryon-input" for="ListSetExtras-v-chk1b9">-</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>A</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>EqDecision0</var><span class="hyp-type"><b>: </b><span>EqDecision A</span></span></span><br><span><var>a0</var><span class="hyp-type"><b>: </b><span>A</span></span></span><br><span><var>l, a, b</var><span class="hyp-type"><b>: </b><span>list A</span></span></span><br><span><var>H_subseteq</var><span class="hyp-type"><b>: </b><span><span class="kr">∀</span> <span class="nv">x</span> : A, x ∈ b → x ∈ a</span></span></span><br><span><var>IHl</var><span class="hyp-type"><b>: </b><span>length (set_diff_filter l a)
≤ length (set_diff_filter l b)</span></span></span><br><span><var>n</var><span class="hyp-type"><b>: </b><span>a0 ∉ a</span></span></span><br><span><var>n0</var><span class="hyp-type"><b>: </b><span>¬ (a0 ∉ b)</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">length (a0 :: filter (<span class="kr">λ</span> <span class="nv">x</span> : A, x ∉ a) l)
≤ length (filter (<span class="kr">λ</span> <span class="nv">x</span> : A, x ∉ b) l)</div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><span class="alectryon-input">itauto.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="ListSetExtras-v-chk1ba" style="display: none" type="checkbox"><label class="alectryon-input" for="ListSetExtras-v-chk1ba">-</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>A</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>EqDecision0</var><span class="hyp-type"><b>: </b><span>EqDecision A</span></span></span><br><span><var>a0</var><span class="hyp-type"><b>: </b><span>A</span></span></span><br><span><var>l, a, b</var><span class="hyp-type"><b>: </b><span>list A</span></span></span><br><span><var>H_subseteq</var><span class="hyp-type"><b>: </b><span><span class="kr">∀</span> <span class="nv">x</span> : A, x ∈ b → x ∈ a</span></span></span><br><span><var>IHl</var><span class="hyp-type"><b>: </b><span>length (set_diff_filter l a)
≤ length (set_diff_filter l b)</span></span></span><br><span><var>n</var><span class="hyp-type"><b>: </b><span>¬ (a0 ∉ a)</span></span></span><br><span><var>n0</var><span class="hyp-type"><b>: </b><span>a0 ∉ b</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">length (filter (<span class="kr">λ</span> <span class="nv">x</span> : A, x ∉ a) l)
≤ length (a0 :: filter (<span class="kr">λ</span> <span class="nv">x</span> : A, x ∉ b) l)</div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="ListSetExtras-v-chk1bb" style="display: none" type="checkbox"><label class="alectryon-input" for="ListSetExtras-v-chk1bb"><span class="nb">simpl</span>.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>A</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>EqDecision0</var><span class="hyp-type"><b>: </b><span>EqDecision A</span></span></span><br><span><var>a0</var><span class="hyp-type"><b>: </b><span>A</span></span></span><br><span><var>l, a, b</var><span class="hyp-type"><b>: </b><span>list A</span></span></span><br><span><var>H_subseteq</var><span class="hyp-type"><b>: </b><span><span class="kr">∀</span> <span class="nv">x</span> : A, x ∈ b → x ∈ a</span></span></span><br><span><var>IHl</var><span class="hyp-type"><b>: </b><span>length (set_diff_filter l a)
≤ length (set_diff_filter l b)</span></span></span><br><span><var>n</var><span class="hyp-type"><b>: </b><span>¬ (a0 ∉ a)</span></span></span><br><span><var>n0</var><span class="hyp-type"><b>: </b><span>a0 ∉ b</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">length (filter (<span class="kr">λ</span> <span class="nv">x</span> : A, x ∉ a) l)
≤ S (length (filter (<span class="kr">λ</span> <span class="nv">x</span> : A, x ∉ b) l))</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="ListSetExtras-v-chk1bc" style="display: none" type="checkbox"><label class="alectryon-input" for="ListSetExtras-v-chk1bc"><span class="nb">apply</span> le_S.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>A</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>EqDecision0</var><span class="hyp-type"><b>: </b><span>EqDecision A</span></span></span><br><span><var>a0</var><span class="hyp-type"><b>: </b><span>A</span></span></span><br><span><var>l, a, b</var><span class="hyp-type"><b>: </b><span>list A</span></span></span><br><span><var>H_subseteq</var><span class="hyp-type"><b>: </b><span><span class="kr">∀</span> <span class="nv">x</span> : A, x ∈ b → x ∈ a</span></span></span><br><span><var>IHl</var><span class="hyp-type"><b>: </b><span>length (set_diff_filter l a)
≤ length (set_diff_filter l b)</span></span></span><br><span><var>n</var><span class="hyp-type"><b>: </b><span>¬ (a0 ∉ a)</span></span></span><br><span><var>n0</var><span class="hyp-type"><b>: </b><span>a0 ∉ b</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">length (filter (<span class="kr">λ</span> <span class="nv">x</span> : A, x ∉ a) l)
≤ length (filter (<span class="kr">λ</span> <span class="nv">x</span> : A, x ∉ b) l)</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><span class="alectryon-input"><span class="nb">apply</span> IHl.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="ListSetExtras-v-chk1bd" style="display: none" type="checkbox"><label class="alectryon-input" for="ListSetExtras-v-chk1bd">-</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>A</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>EqDecision0</var><span class="hyp-type"><b>: </b><span>EqDecision A</span></span></span><br><span><var>a0</var><span class="hyp-type"><b>: </b><span>A</span></span></span><br><span><var>l, a, b</var><span class="hyp-type"><b>: </b><span>list A</span></span></span><br><span><var>H_subseteq</var><span class="hyp-type"><b>: </b><span><span class="kr">∀</span> <span class="nv">x</span> : A, x ∈ b → x ∈ a</span></span></span><br><span><var>IHl</var><span class="hyp-type"><b>: </b><span>length (set_diff_filter l a)
≤ length (set_diff_filter l b)</span></span></span><br><span><var>n</var><span class="hyp-type"><b>: </b><span>¬ (a0 ∉ a)</span></span></span><br><span><var>n0</var><span class="hyp-type"><b>: </b><span>¬ (a0 ∉ b)</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">length (filter (<span class="kr">λ</span> <span class="nv">x</span> : A, x ∉ a) l)
≤ length (filter (<span class="kr">λ</span> <span class="nv">x</span> : A, x ∉ b) l)</div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="nb">apply</span> IHl.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Qed</span>.</span></span></pre><div class="doc">
  Prove that strictly increasing the set to be subtracted,
  by adding an element actually found in <code>l</code> will decrease
  the size of the result.
 
</div><pre class="alectryon-io highlight"><!-- Generator: Alectryon --><span class="alectryon-sentence"><input class="alectryon-toggle" id="ListSetExtras-v-chk1be" style="display: none" type="checkbox"><label class="alectryon-input" for="ListSetExtras-v-chk1be"><span class="kn">Lemma</span> <span class="nf">len_set_diff_decrease</span> `{EqDecision A} (new:A) (l a b: list A)
      (H_subseteq: <span class="kr">forall</span> <span class="nv">x</span>, x ∈ b -&gt; x ∈ a)
      (H_new_is_new: new ∈ a /\ ~new ∈ b)
      (H_new_is_relevant: new ∈ l):
  length (set_diff_filter l a) &lt; length (set_diff_filter l b).</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>A</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>EqDecision0</var><span class="hyp-type"><b>: </b><span>EqDecision A</span></span></span><br><span><var>new</var><span class="hyp-type"><b>: </b><span>A</span></span></span><br><span><var>l, a, b</var><span class="hyp-type"><b>: </b><span>list A</span></span></span><br><span><var>H_subseteq</var><span class="hyp-type"><b>: </b><span><span class="kr">∀</span> <span class="nv">x</span> : A, x ∈ b → x ∈ a</span></span></span><br><span><var>H_new_is_new</var><span class="hyp-type"><b>: </b><span>new ∈ a ∧ new ∉ b</span></span></span><br><span><var>H_new_is_relevant</var><span class="hyp-type"><b>: </b><span>new ∈ l</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">length (set_diff_filter l a) &lt;
length (set_diff_filter l b)</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="ListSetExtras-v-chk1bf" style="display: none" type="checkbox"><label class="alectryon-input" for="ListSetExtras-v-chk1bf"><span class="kn">Proof</span>.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>A</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>EqDecision0</var><span class="hyp-type"><b>: </b><span>EqDecision A</span></span></span><br><span><var>new</var><span class="hyp-type"><b>: </b><span>A</span></span></span><br><span><var>l, a, b</var><span class="hyp-type"><b>: </b><span>list A</span></span></span><br><span><var>H_subseteq</var><span class="hyp-type"><b>: </b><span><span class="kr">∀</span> <span class="nv">x</span> : A, x ∈ b → x ∈ a</span></span></span><br><span><var>H_new_is_new</var><span class="hyp-type"><b>: </b><span>new ∈ a ∧ new ∉ b</span></span></span><br><span><var>H_new_is_relevant</var><span class="hyp-type"><b>: </b><span>new ∈ l</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">length (set_diff_filter l a) &lt;
length (set_diff_filter l b)</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="ListSetExtras-v-chk1c0" style="display: none" type="checkbox"><label class="alectryon-input" for="ListSetExtras-v-chk1c0"><span class="nb">induction</span> l; [<span class="nb">inversion</span> H_new_is_relevant|];
    <span class="nb">apply</span> elem_of_cons <span class="kr">in</span> H_new_is_relevant; <span class="nb">destruct</span> H_new_is_relevant.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>A</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>EqDecision0</var><span class="hyp-type"><b>: </b><span>EqDecision A</span></span></span><br><span><var>new, a0</var><span class="hyp-type"><b>: </b><span>A</span></span></span><br><span><var>l, a, b</var><span class="hyp-type"><b>: </b><span>list A</span></span></span><br><span><var>H_subseteq</var><span class="hyp-type"><b>: </b><span><span class="kr">∀</span> <span class="nv">x</span> : A, x ∈ b → x ∈ a</span></span></span><br><span><var>H_new_is_new</var><span class="hyp-type"><b>: </b><span>new ∈ a ∧ new ∉ b</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>new = a0</span></span></span><br><span><var>IHl</var><span class="hyp-type"><b>: </b><span>new ∈ l
→ length (set_diff_filter l a) &lt;
  length (set_diff_filter l b)</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">length (set_diff_filter (a0 :: l) a) &lt;
length (set_diff_filter (a0 :: l) b)</div></blockquote><div class="alectryon-extra-goals"><input class="alectryon-extra-goal-toggle" id="ListSetExtras-v-chk1c1" style="display: none" type="checkbox"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>A</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>EqDecision0</var><span class="hyp-type"><b>: </b><span>EqDecision A</span></span></span><br><span><var>new, a0</var><span class="hyp-type"><b>: </b><span>A</span></span></span><br><span><var>l, a, b</var><span class="hyp-type"><b>: </b><span>list A</span></span></span><br><span><var>H_subseteq</var><span class="hyp-type"><b>: </b><span><span class="kr">∀</span> <span class="nv">x</span> : A, x ∈ b → x ∈ a</span></span></span><br><span><var>H_new_is_new</var><span class="hyp-type"><b>: </b><span>new ∈ a ∧ new ∉ b</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>new ∈ l</span></span></span><br><span><var>IHl</var><span class="hyp-type"><b>: </b><span>new ∈ l
→ length (set_diff_filter l a) &lt;
  length (set_diff_filter l b)</span></span></span><br></div><label class="goal-separator" for="ListSetExtras-v-chk1c1"><hr></label><div class="goal-conclusion">length (set_diff_filter (a0 :: l) a) &lt;
length (set_diff_filter (a0 :: l) b)</div></blockquote></div></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="ListSetExtras-v-chk1c2" style="display: none" type="checkbox"><label class="alectryon-input" for="ListSetExtras-v-chk1c2">-</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>A</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>EqDecision0</var><span class="hyp-type"><b>: </b><span>EqDecision A</span></span></span><br><span><var>new, a0</var><span class="hyp-type"><b>: </b><span>A</span></span></span><br><span><var>l, a, b</var><span class="hyp-type"><b>: </b><span>list A</span></span></span><br><span><var>H_subseteq</var><span class="hyp-type"><b>: </b><span><span class="kr">∀</span> <span class="nv">x</span> : A, x ∈ b → x ∈ a</span></span></span><br><span><var>H_new_is_new</var><span class="hyp-type"><b>: </b><span>new ∈ a ∧ new ∉ b</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>new = a0</span></span></span><br><span><var>IHl</var><span class="hyp-type"><b>: </b><span>new ∈ l
→ length (set_diff_filter l a) &lt;
  length (set_diff_filter l b)</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">length (set_diff_filter (a0 :: l) a) &lt;
length (set_diff_filter (a0 :: l) b)</div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="ListSetExtras-v-chk1c3" style="display: none" type="checkbox"><label class="alectryon-input" for="ListSetExtras-v-chk1c3"><span class="nb">subst</span> a0.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>A</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>EqDecision0</var><span class="hyp-type"><b>: </b><span>EqDecision A</span></span></span><br><span><var>new</var><span class="hyp-type"><b>: </b><span>A</span></span></span><br><span><var>l, a, b</var><span class="hyp-type"><b>: </b><span>list A</span></span></span><br><span><var>H_subseteq</var><span class="hyp-type"><b>: </b><span><span class="kr">∀</span> <span class="nv">x</span> : A, x ∈ b → x ∈ a</span></span></span><br><span><var>H_new_is_new</var><span class="hyp-type"><b>: </b><span>new ∈ a ∧ new ∉ b</span></span></span><br><span><var>IHl</var><span class="hyp-type"><b>: </b><span>new ∈ l
→ length (set_diff_filter l a) &lt;
  length (set_diff_filter l b)</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">length (set_diff_filter (new :: l) a) &lt;
length (set_diff_filter (new :: l) b)</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="ListSetExtras-v-chk1c4" style="display: none" type="checkbox"><label class="alectryon-input" for="ListSetExtras-v-chk1c4"><span class="nb">unfold</span> set_diff_filter.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>A</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>EqDecision0</var><span class="hyp-type"><b>: </b><span>EqDecision A</span></span></span><br><span><var>new</var><span class="hyp-type"><b>: </b><span>A</span></span></span><br><span><var>l, a, b</var><span class="hyp-type"><b>: </b><span>list A</span></span></span><br><span><var>H_subseteq</var><span class="hyp-type"><b>: </b><span><span class="kr">∀</span> <span class="nv">x</span> : A, x ∈ b → x ∈ a</span></span></span><br><span><var>H_new_is_new</var><span class="hyp-type"><b>: </b><span>new ∈ a ∧ new ∉ b</span></span></span><br><span><var>IHl</var><span class="hyp-type"><b>: </b><span>new ∈ l
→ length (set_diff_filter l a) &lt;
  length (set_diff_filter l b)</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">length (filter (<span class="kr">λ</span> <span class="nv">x</span> : A, x ∉ a) (new :: l)) &lt;
length (filter (<span class="kr">λ</span> <span class="nv">x</span> : A, x ∉ b) (new :: l))</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="ListSetExtras-v-chk1c5" style="display: none" type="checkbox"><label class="alectryon-input" for="ListSetExtras-v-chk1c5"><span class="nb">rewrite</span> <span class="mi">2</span> filter_cons.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>A</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>EqDecision0</var><span class="hyp-type"><b>: </b><span>EqDecision A</span></span></span><br><span><var>new</var><span class="hyp-type"><b>: </b><span>A</span></span></span><br><span><var>l, a, b</var><span class="hyp-type"><b>: </b><span>list A</span></span></span><br><span><var>H_subseteq</var><span class="hyp-type"><b>: </b><span><span class="kr">∀</span> <span class="nv">x</span> : A, x ∈ b → x ∈ a</span></span></span><br><span><var>H_new_is_new</var><span class="hyp-type"><b>: </b><span>new ∈ a ∧ new ∉ b</span></span></span><br><span><var>IHl</var><span class="hyp-type"><b>: </b><span>new ∈ l
→ length (set_diff_filter l a) &lt;
  length (set_diff_filter l b)</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">length
  (<span class="kr">if</span> decide (new ∉ a)
   <span class="kr">then</span> new :: filter (<span class="kr">λ</span> <span class="nv">x</span> : A, x ∉ a) l
   <span class="kr">else</span> filter (<span class="kr">λ</span> <span class="nv">x</span> : A, x ∉ a) l) &lt;
length
  (<span class="kr">if</span> decide (new ∉ b)
   <span class="kr">then</span> new :: filter (<span class="kr">λ</span> <span class="nv">x</span> : A, x ∉ b) l
   <span class="kr">else</span> filter (<span class="kr">λ</span> <span class="nv">x</span> : A, x ∉ b) l)</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="ListSetExtras-v-chk1c6" style="display: none" type="checkbox"><label class="alectryon-input" for="ListSetExtras-v-chk1c6"><span class="nb">destruct</span> (decide (~ new ∈ a)); [<span class="bp">tauto</span>|].</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>A</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>EqDecision0</var><span class="hyp-type"><b>: </b><span>EqDecision A</span></span></span><br><span><var>new</var><span class="hyp-type"><b>: </b><span>A</span></span></span><br><span><var>l, a, b</var><span class="hyp-type"><b>: </b><span>list A</span></span></span><br><span><var>H_subseteq</var><span class="hyp-type"><b>: </b><span><span class="kr">∀</span> <span class="nv">x</span> : A, x ∈ b → x ∈ a</span></span></span><br><span><var>H_new_is_new</var><span class="hyp-type"><b>: </b><span>new ∈ a ∧ new ∉ b</span></span></span><br><span><var>IHl</var><span class="hyp-type"><b>: </b><span>new ∈ l
→ length (set_diff_filter l a) &lt;
  length (set_diff_filter l b)</span></span></span><br><span><var>n</var><span class="hyp-type"><b>: </b><span>¬ (new ∉ a)</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">length (filter (<span class="kr">λ</span> <span class="nv">x</span> : A, x ∉ a) l) &lt;
length
  (<span class="kr">if</span> decide (new ∉ b)
   <span class="kr">then</span> new :: filter (<span class="kr">λ</span> <span class="nv">x</span> : A, x ∉ b) l
   <span class="kr">else</span> filter (<span class="kr">λ</span> <span class="nv">x</span> : A, x ∉ b) l)</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="ListSetExtras-v-chk1c7" style="display: none" type="checkbox"><label class="alectryon-input" for="ListSetExtras-v-chk1c7"><span class="nb">destruct</span> (decide (~ new ∈ b));[|<span class="bp">contradict</span> n0; itauto].</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>A</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>EqDecision0</var><span class="hyp-type"><b>: </b><span>EqDecision A</span></span></span><br><span><var>new</var><span class="hyp-type"><b>: </b><span>A</span></span></span><br><span><var>l, a, b</var><span class="hyp-type"><b>: </b><span>list A</span></span></span><br><span><var>H_subseteq</var><span class="hyp-type"><b>: </b><span><span class="kr">∀</span> <span class="nv">x</span> : A, x ∈ b → x ∈ a</span></span></span><br><span><var>H_new_is_new</var><span class="hyp-type"><b>: </b><span>new ∈ a ∧ new ∉ b</span></span></span><br><span><var>IHl</var><span class="hyp-type"><b>: </b><span>new ∈ l
→ length (set_diff_filter l a) &lt;
  length (set_diff_filter l b)</span></span></span><br><span><var>n</var><span class="hyp-type"><b>: </b><span>¬ (new ∉ a)</span></span></span><br><span><var>n0</var><span class="hyp-type"><b>: </b><span>new ∉ b</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">length (filter (<span class="kr">λ</span> <span class="nv">x</span> : A, x ∉ a) l) &lt;
length (new :: filter (<span class="kr">λ</span> <span class="nv">x</span> : A, x ∉ b) l)</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="ListSetExtras-v-chk1c8" style="display: none" type="checkbox"><label class="alectryon-input" for="ListSetExtras-v-chk1c8"><span class="nb">simpl</span>.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>A</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>EqDecision0</var><span class="hyp-type"><b>: </b><span>EqDecision A</span></span></span><br><span><var>new</var><span class="hyp-type"><b>: </b><span>A</span></span></span><br><span><var>l, a, b</var><span class="hyp-type"><b>: </b><span>list A</span></span></span><br><span><var>H_subseteq</var><span class="hyp-type"><b>: </b><span><span class="kr">∀</span> <span class="nv">x</span> : A, x ∈ b → x ∈ a</span></span></span><br><span><var>H_new_is_new</var><span class="hyp-type"><b>: </b><span>new ∈ a ∧ new ∉ b</span></span></span><br><span><var>IHl</var><span class="hyp-type"><b>: </b><span>new ∈ l
→ length (set_diff_filter l a) &lt;
  length (set_diff_filter l b)</span></span></span><br><span><var>n</var><span class="hyp-type"><b>: </b><span>¬ (new ∉ a)</span></span></span><br><span><var>n0</var><span class="hyp-type"><b>: </b><span>new ∉ b</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">length (filter (<span class="kr">λ</span> <span class="nv">x</span> : A, x ∉ a) l) &lt;
S (length (filter (<span class="kr">λ</span> <span class="nv">x</span> : A, x ∉ b) l))</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><span class="alectryon-input"><span class="bp">by</span> <span class="nb">apply</span> le_n_S, len_set_diff_incl_le.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="ListSetExtras-v-chk1c9" style="display: none" type="checkbox"><label class="alectryon-input" for="ListSetExtras-v-chk1c9">-</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>A</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>EqDecision0</var><span class="hyp-type"><b>: </b><span>EqDecision A</span></span></span><br><span><var>new, a0</var><span class="hyp-type"><b>: </b><span>A</span></span></span><br><span><var>l, a, b</var><span class="hyp-type"><b>: </b><span>list A</span></span></span><br><span><var>H_subseteq</var><span class="hyp-type"><b>: </b><span><span class="kr">∀</span> <span class="nv">x</span> : A, x ∈ b → x ∈ a</span></span></span><br><span><var>H_new_is_new</var><span class="hyp-type"><b>: </b><span>new ∈ a ∧ new ∉ b</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>new ∈ l</span></span></span><br><span><var>IHl</var><span class="hyp-type"><b>: </b><span>new ∈ l
→ length (set_diff_filter l a) &lt;
  length (set_diff_filter l b)</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">length (set_diff_filter (a0 :: l) a) &lt;
length (set_diff_filter (a0 :: l) b)</div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="ListSetExtras-v-chk1ca" style="display: none" type="checkbox"><label class="alectryon-input" for="ListSetExtras-v-chk1ca"><span class="nb">specialize</span> (IHl H);<span class="nb">clear</span> H.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>A</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>EqDecision0</var><span class="hyp-type"><b>: </b><span>EqDecision A</span></span></span><br><span><var>new, a0</var><span class="hyp-type"><b>: </b><span>A</span></span></span><br><span><var>l, a, b</var><span class="hyp-type"><b>: </b><span>list A</span></span></span><br><span><var>H_subseteq</var><span class="hyp-type"><b>: </b><span><span class="kr">∀</span> <span class="nv">x</span> : A, x ∈ b → x ∈ a</span></span></span><br><span><var>H_new_is_new</var><span class="hyp-type"><b>: </b><span>new ∈ a ∧ new ∉ b</span></span></span><br><span><var>IHl</var><span class="hyp-type"><b>: </b><span>length (set_diff_filter l a) &lt;
length (set_diff_filter l b)</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">length (set_diff_filter (a0 :: l) a) &lt;
length (set_diff_filter (a0 :: l) b)</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="ListSetExtras-v-chk1cb" style="display: none" type="checkbox"><label class="alectryon-input" for="ListSetExtras-v-chk1cb"><span class="nb">unfold</span> set_diff_filter.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>A</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>EqDecision0</var><span class="hyp-type"><b>: </b><span>EqDecision A</span></span></span><br><span><var>new, a0</var><span class="hyp-type"><b>: </b><span>A</span></span></span><br><span><var>l, a, b</var><span class="hyp-type"><b>: </b><span>list A</span></span></span><br><span><var>H_subseteq</var><span class="hyp-type"><b>: </b><span><span class="kr">∀</span> <span class="nv">x</span> : A, x ∈ b → x ∈ a</span></span></span><br><span><var>H_new_is_new</var><span class="hyp-type"><b>: </b><span>new ∈ a ∧ new ∉ b</span></span></span><br><span><var>IHl</var><span class="hyp-type"><b>: </b><span>length (set_diff_filter l a) &lt;
length (set_diff_filter l b)</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">length (filter (<span class="kr">λ</span> <span class="nv">x</span> : A, x ∉ a) (a0 :: l)) &lt;
length (filter (<span class="kr">λ</span> <span class="nv">x</span> : A, x ∉ b) (a0 :: l))</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="ListSetExtras-v-chk1cc" style="display: none" type="checkbox"><label class="alectryon-input" for="ListSetExtras-v-chk1cc"><span class="nb">rewrite</span> <span class="mi">2</span> filter_cons.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>A</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>EqDecision0</var><span class="hyp-type"><b>: </b><span>EqDecision A</span></span></span><br><span><var>new, a0</var><span class="hyp-type"><b>: </b><span>A</span></span></span><br><span><var>l, a, b</var><span class="hyp-type"><b>: </b><span>list A</span></span></span><br><span><var>H_subseteq</var><span class="hyp-type"><b>: </b><span><span class="kr">∀</span> <span class="nv">x</span> : A, x ∈ b → x ∈ a</span></span></span><br><span><var>H_new_is_new</var><span class="hyp-type"><b>: </b><span>new ∈ a ∧ new ∉ b</span></span></span><br><span><var>IHl</var><span class="hyp-type"><b>: </b><span>length (set_diff_filter l a) &lt;
length (set_diff_filter l b)</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">length
  (<span class="kr">if</span> decide (a0 ∉ a)
   <span class="kr">then</span> a0 :: filter (<span class="kr">λ</span> <span class="nv">x</span> : A, x ∉ a) l
   <span class="kr">else</span> filter (<span class="kr">λ</span> <span class="nv">x</span> : A, x ∉ a) l) &lt;
length
  (<span class="kr">if</span> decide (a0 ∉ b)
   <span class="kr">then</span> a0 :: filter (<span class="kr">λ</span> <span class="nv">x</span> : A, x ∉ b) l
   <span class="kr">else</span> filter (<span class="kr">λ</span> <span class="nv">x</span> : A, x ∉ b) l)</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="ListSetExtras-v-chk1cd" style="display: none" type="checkbox"><label class="alectryon-input" for="ListSetExtras-v-chk1cd"><span class="nb">destruct</span> (decide (~ a0 ∈ a)); <span class="nb">destruct</span> (decide (~ a0 ∈ b)).</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>A</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>EqDecision0</var><span class="hyp-type"><b>: </b><span>EqDecision A</span></span></span><br><span><var>new, a0</var><span class="hyp-type"><b>: </b><span>A</span></span></span><br><span><var>l, a, b</var><span class="hyp-type"><b>: </b><span>list A</span></span></span><br><span><var>H_subseteq</var><span class="hyp-type"><b>: </b><span><span class="kr">∀</span> <span class="nv">x</span> : A, x ∈ b → x ∈ a</span></span></span><br><span><var>H_new_is_new</var><span class="hyp-type"><b>: </b><span>new ∈ a ∧ new ∉ b</span></span></span><br><span><var>IHl</var><span class="hyp-type"><b>: </b><span>length (set_diff_filter l a) &lt;
length (set_diff_filter l b)</span></span></span><br><span><var>n</var><span class="hyp-type"><b>: </b><span>a0 ∉ a</span></span></span><br><span><var>n0</var><span class="hyp-type"><b>: </b><span>a0 ∉ b</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">length (a0 :: filter (<span class="kr">λ</span> <span class="nv">x</span> : A, x ∉ a) l) &lt;
length (a0 :: filter (<span class="kr">λ</span> <span class="nv">x</span> : A, x ∉ b) l)</div></blockquote><div class="alectryon-extra-goals"><input class="alectryon-extra-goal-toggle" id="ListSetExtras-v-chk1ce" style="display: none" type="checkbox"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>A</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>EqDecision0</var><span class="hyp-type"><b>: </b><span>EqDecision A</span></span></span><br><span><var>new, a0</var><span class="hyp-type"><b>: </b><span>A</span></span></span><br><span><var>l, a, b</var><span class="hyp-type"><b>: </b><span>list A</span></span></span><br><span><var>H_subseteq</var><span class="hyp-type"><b>: </b><span><span class="kr">∀</span> <span class="nv">x</span> : A, x ∈ b → x ∈ a</span></span></span><br><span><var>H_new_is_new</var><span class="hyp-type"><b>: </b><span>new ∈ a ∧ new ∉ b</span></span></span><br><span><var>IHl</var><span class="hyp-type"><b>: </b><span>length (set_diff_filter l a) &lt;
length (set_diff_filter l b)</span></span></span><br><span><var>n</var><span class="hyp-type"><b>: </b><span>a0 ∉ a</span></span></span><br><span><var>n0</var><span class="hyp-type"><b>: </b><span>¬ (a0 ∉ b)</span></span></span><br></div><label class="goal-separator" for="ListSetExtras-v-chk1ce"><hr></label><div class="goal-conclusion">length (a0 :: filter (<span class="kr">λ</span> <span class="nv">x</span> : A, x ∉ a) l) &lt;
length (filter (<span class="kr">λ</span> <span class="nv">x</span> : A, x ∉ b) l)</div></blockquote><input class="alectryon-extra-goal-toggle" id="ListSetExtras-v-chk1cf" style="display: none" type="checkbox"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>A</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>EqDecision0</var><span class="hyp-type"><b>: </b><span>EqDecision A</span></span></span><br><span><var>new, a0</var><span class="hyp-type"><b>: </b><span>A</span></span></span><br><span><var>l, a, b</var><span class="hyp-type"><b>: </b><span>list A</span></span></span><br><span><var>H_subseteq</var><span class="hyp-type"><b>: </b><span><span class="kr">∀</span> <span class="nv">x</span> : A, x ∈ b → x ∈ a</span></span></span><br><span><var>H_new_is_new</var><span class="hyp-type"><b>: </b><span>new ∈ a ∧ new ∉ b</span></span></span><br><span><var>IHl</var><span class="hyp-type"><b>: </b><span>length (set_diff_filter l a) &lt;
length (set_diff_filter l b)</span></span></span><br><span><var>n</var><span class="hyp-type"><b>: </b><span>¬ (a0 ∉ a)</span></span></span><br><span><var>n0</var><span class="hyp-type"><b>: </b><span>a0 ∉ b</span></span></span><br></div><label class="goal-separator" for="ListSetExtras-v-chk1cf"><hr></label><div class="goal-conclusion">length (filter (<span class="kr">λ</span> <span class="nv">x</span> : A, x ∉ a) l) &lt;
length (a0 :: filter (<span class="kr">λ</span> <span class="nv">x</span> : A, x ∉ b) l)</div></blockquote><input class="alectryon-extra-goal-toggle" id="ListSetExtras-v-chk1d0" style="display: none" type="checkbox"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>A</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>EqDecision0</var><span class="hyp-type"><b>: </b><span>EqDecision A</span></span></span><br><span><var>new, a0</var><span class="hyp-type"><b>: </b><span>A</span></span></span><br><span><var>l, a, b</var><span class="hyp-type"><b>: </b><span>list A</span></span></span><br><span><var>H_subseteq</var><span class="hyp-type"><b>: </b><span><span class="kr">∀</span> <span class="nv">x</span> : A, x ∈ b → x ∈ a</span></span></span><br><span><var>H_new_is_new</var><span class="hyp-type"><b>: </b><span>new ∈ a ∧ new ∉ b</span></span></span><br><span><var>IHl</var><span class="hyp-type"><b>: </b><span>length (set_diff_filter l a) &lt;
length (set_diff_filter l b)</span></span></span><br><span><var>n</var><span class="hyp-type"><b>: </b><span>¬ (a0 ∉ a)</span></span></span><br><span><var>n0</var><span class="hyp-type"><b>: </b><span>¬ (a0 ∉ b)</span></span></span><br></div><label class="goal-separator" for="ListSetExtras-v-chk1d0"><hr></label><div class="goal-conclusion">length (filter (<span class="kr">λ</span> <span class="nv">x</span> : A, x ∉ a) l) &lt;
length (filter (<span class="kr">λ</span> <span class="nv">x</span> : A, x ∉ b) l)</div></blockquote></div></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="ListSetExtras-v-chk1d1" style="display: none" type="checkbox"><label class="alectryon-input" for="ListSetExtras-v-chk1d1">+</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>A</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>EqDecision0</var><span class="hyp-type"><b>: </b><span>EqDecision A</span></span></span><br><span><var>new, a0</var><span class="hyp-type"><b>: </b><span>A</span></span></span><br><span><var>l, a, b</var><span class="hyp-type"><b>: </b><span>list A</span></span></span><br><span><var>H_subseteq</var><span class="hyp-type"><b>: </b><span><span class="kr">∀</span> <span class="nv">x</span> : A, x ∈ b → x ∈ a</span></span></span><br><span><var>H_new_is_new</var><span class="hyp-type"><b>: </b><span>new ∈ a ∧ new ∉ b</span></span></span><br><span><var>IHl</var><span class="hyp-type"><b>: </b><span>length (set_diff_filter l a) &lt;
length (set_diff_filter l b)</span></span></span><br><span><var>n</var><span class="hyp-type"><b>: </b><span>a0 ∉ a</span></span></span><br><span><var>n0</var><span class="hyp-type"><b>: </b><span>a0 ∉ b</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">length (a0 :: filter (<span class="kr">λ</span> <span class="nv">x</span> : A, x ∉ a) l) &lt;
length (a0 :: filter (<span class="kr">λ</span> <span class="nv">x</span> : A, x ∉ b) l)</div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="ListSetExtras-v-chk1d2" style="display: none" type="checkbox"><label class="alectryon-input" for="ListSetExtras-v-chk1d2"><span class="nb">simpl</span>.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>A</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>EqDecision0</var><span class="hyp-type"><b>: </b><span>EqDecision A</span></span></span><br><span><var>new, a0</var><span class="hyp-type"><b>: </b><span>A</span></span></span><br><span><var>l, a, b</var><span class="hyp-type"><b>: </b><span>list A</span></span></span><br><span><var>H_subseteq</var><span class="hyp-type"><b>: </b><span><span class="kr">∀</span> <span class="nv">x</span> : A, x ∈ b → x ∈ a</span></span></span><br><span><var>H_new_is_new</var><span class="hyp-type"><b>: </b><span>new ∈ a ∧ new ∉ b</span></span></span><br><span><var>IHl</var><span class="hyp-type"><b>: </b><span>length (set_diff_filter l a) &lt;
length (set_diff_filter l b)</span></span></span><br><span><var>n</var><span class="hyp-type"><b>: </b><span>a0 ∉ a</span></span></span><br><span><var>n0</var><span class="hyp-type"><b>: </b><span>a0 ∉ b</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">S (length (filter (<span class="kr">λ</span> <span class="nv">x</span> : A, x ∉ a) l)) &lt;
S (length (filter (<span class="kr">λ</span> <span class="nv">x</span> : A, x ∉ b) l))</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">      </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="ListSetExtras-v-chk1d3" style="display: none" type="checkbox"><label class="alectryon-input" for="ListSetExtras-v-chk1d3"><span class="nb">rewrite</span> &lt;- Nat.succ_lt_mono.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>A</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>EqDecision0</var><span class="hyp-type"><b>: </b><span>EqDecision A</span></span></span><br><span><var>new, a0</var><span class="hyp-type"><b>: </b><span>A</span></span></span><br><span><var>l, a, b</var><span class="hyp-type"><b>: </b><span>list A</span></span></span><br><span><var>H_subseteq</var><span class="hyp-type"><b>: </b><span><span class="kr">∀</span> <span class="nv">x</span> : A, x ∈ b → x ∈ a</span></span></span><br><span><var>H_new_is_new</var><span class="hyp-type"><b>: </b><span>new ∈ a ∧ new ∉ b</span></span></span><br><span><var>IHl</var><span class="hyp-type"><b>: </b><span>length (set_diff_filter l a) &lt;
length (set_diff_filter l b)</span></span></span><br><span><var>n</var><span class="hyp-type"><b>: </b><span>a0 ∉ a</span></span></span><br><span><var>n0</var><span class="hyp-type"><b>: </b><span>a0 ∉ b</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">length (filter (<span class="kr">λ</span> <span class="nv">x</span> : A, x ∉ a) l) &lt;
length (filter (<span class="kr">λ</span> <span class="nv">x</span> : A, x ∉ b) l)</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">      </span><span class="alectryon-sentence"><span class="alectryon-input"><span class="nb">apply</span> IHl.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="ListSetExtras-v-chk1d4" style="display: none" type="checkbox"><label class="alectryon-input" for="ListSetExtras-v-chk1d4">+</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>A</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>EqDecision0</var><span class="hyp-type"><b>: </b><span>EqDecision A</span></span></span><br><span><var>new, a0</var><span class="hyp-type"><b>: </b><span>A</span></span></span><br><span><var>l, a, b</var><span class="hyp-type"><b>: </b><span>list A</span></span></span><br><span><var>H_subseteq</var><span class="hyp-type"><b>: </b><span><span class="kr">∀</span> <span class="nv">x</span> : A, x ∈ b → x ∈ a</span></span></span><br><span><var>H_new_is_new</var><span class="hyp-type"><b>: </b><span>new ∈ a ∧ new ∉ b</span></span></span><br><span><var>IHl</var><span class="hyp-type"><b>: </b><span>length (set_diff_filter l a) &lt;
length (set_diff_filter l b)</span></span></span><br><span><var>n</var><span class="hyp-type"><b>: </b><span>a0 ∉ a</span></span></span><br><span><var>n0</var><span class="hyp-type"><b>: </b><span>¬ (a0 ∉ b)</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">length (a0 :: filter (<span class="kr">λ</span> <span class="nv">x</span> : A, x ∉ a) l) &lt;
length (filter (<span class="kr">λ</span> <span class="nv">x</span> : A, x ∉ b) l)</div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="ListSetExtras-v-chk1d5" style="display: none" type="checkbox"><label class="alectryon-input" for="ListSetExtras-v-chk1d5"><span class="bp">contradict</span> n.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>A</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>EqDecision0</var><span class="hyp-type"><b>: </b><span>EqDecision A</span></span></span><br><span><var>new, a0</var><span class="hyp-type"><b>: </b><span>A</span></span></span><br><span><var>l, a, b</var><span class="hyp-type"><b>: </b><span>list A</span></span></span><br><span><var>H_subseteq</var><span class="hyp-type"><b>: </b><span><span class="kr">∀</span> <span class="nv">x</span> : A, x ∈ b → x ∈ a</span></span></span><br><span><var>H_new_is_new</var><span class="hyp-type"><b>: </b><span>new ∈ a ∧ new ∉ b</span></span></span><br><span><var>IHl</var><span class="hyp-type"><b>: </b><span>length (set_diff_filter l a) &lt;
length (set_diff_filter l b)</span></span></span><br><span><var>n0</var><span class="hyp-type"><b>: </b><span>¬ (a0 ∉ b)</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">a0 ∈ a</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">      </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="ListSetExtras-v-chk1d6" style="display: none" type="checkbox"><label class="alectryon-input" for="ListSetExtras-v-chk1d6"><span class="nb">apply</span> H_subseteq.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>A</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>EqDecision0</var><span class="hyp-type"><b>: </b><span>EqDecision A</span></span></span><br><span><var>new, a0</var><span class="hyp-type"><b>: </b><span>A</span></span></span><br><span><var>l, a, b</var><span class="hyp-type"><b>: </b><span>list A</span></span></span><br><span><var>H_subseteq</var><span class="hyp-type"><b>: </b><span><span class="kr">∀</span> <span class="nv">x</span> : A, x ∈ b → x ∈ a</span></span></span><br><span><var>H_new_is_new</var><span class="hyp-type"><b>: </b><span>new ∈ a ∧ new ∉ b</span></span></span><br><span><var>IHl</var><span class="hyp-type"><b>: </b><span>length (set_diff_filter l a) &lt;
length (set_diff_filter l b)</span></span></span><br><span><var>n0</var><span class="hyp-type"><b>: </b><span>¬ (a0 ∉ b)</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">a0 ∈ b</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">      </span><span class="alectryon-sentence"><span class="alectryon-input"><span class="bp">by</span> <span class="nb">destruct</span> (decide (a0 ∈ b)).</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="ListSetExtras-v-chk1d7" style="display: none" type="checkbox"><label class="alectryon-input" for="ListSetExtras-v-chk1d7">+</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>A</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>EqDecision0</var><span class="hyp-type"><b>: </b><span>EqDecision A</span></span></span><br><span><var>new, a0</var><span class="hyp-type"><b>: </b><span>A</span></span></span><br><span><var>l, a, b</var><span class="hyp-type"><b>: </b><span>list A</span></span></span><br><span><var>H_subseteq</var><span class="hyp-type"><b>: </b><span><span class="kr">∀</span> <span class="nv">x</span> : A, x ∈ b → x ∈ a</span></span></span><br><span><var>H_new_is_new</var><span class="hyp-type"><b>: </b><span>new ∈ a ∧ new ∉ b</span></span></span><br><span><var>IHl</var><span class="hyp-type"><b>: </b><span>length (set_diff_filter l a) &lt;
length (set_diff_filter l b)</span></span></span><br><span><var>n</var><span class="hyp-type"><b>: </b><span>¬ (a0 ∉ a)</span></span></span><br><span><var>n0</var><span class="hyp-type"><b>: </b><span>a0 ∉ b</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">length (filter (<span class="kr">λ</span> <span class="nv">x</span> : A, x ∉ a) l) &lt;
length (a0 :: filter (<span class="kr">λ</span> <span class="nv">x</span> : A, x ∉ b) l)</div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="ListSetExtras-v-chk1d8" style="display: none" type="checkbox"><label class="alectryon-input" for="ListSetExtras-v-chk1d8"><span class="nb">simpl</span>.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>A</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>EqDecision0</var><span class="hyp-type"><b>: </b><span>EqDecision A</span></span></span><br><span><var>new, a0</var><span class="hyp-type"><b>: </b><span>A</span></span></span><br><span><var>l, a, b</var><span class="hyp-type"><b>: </b><span>list A</span></span></span><br><span><var>H_subseteq</var><span class="hyp-type"><b>: </b><span><span class="kr">∀</span> <span class="nv">x</span> : A, x ∈ b → x ∈ a</span></span></span><br><span><var>H_new_is_new</var><span class="hyp-type"><b>: </b><span>new ∈ a ∧ new ∉ b</span></span></span><br><span><var>IHl</var><span class="hyp-type"><b>: </b><span>length (set_diff_filter l a) &lt;
length (set_diff_filter l b)</span></span></span><br><span><var>n</var><span class="hyp-type"><b>: </b><span>¬ (a0 ∉ a)</span></span></span><br><span><var>n0</var><span class="hyp-type"><b>: </b><span>a0 ∉ b</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">length (filter (<span class="kr">λ</span> <span class="nv">x</span> : A, x ∉ a) l) &lt;
S (length (filter (<span class="kr">λ</span> <span class="nv">x</span> : A, x ∉ b) l))</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">      </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="ListSetExtras-v-chk1d9" style="display: none" type="checkbox"><label class="alectryon-input" for="ListSetExtras-v-chk1d9"><span class="nb">apply</span> Nat.lt_lt_succ_r.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>A</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>EqDecision0</var><span class="hyp-type"><b>: </b><span>EqDecision A</span></span></span><br><span><var>new, a0</var><span class="hyp-type"><b>: </b><span>A</span></span></span><br><span><var>l, a, b</var><span class="hyp-type"><b>: </b><span>list A</span></span></span><br><span><var>H_subseteq</var><span class="hyp-type"><b>: </b><span><span class="kr">∀</span> <span class="nv">x</span> : A, x ∈ b → x ∈ a</span></span></span><br><span><var>H_new_is_new</var><span class="hyp-type"><b>: </b><span>new ∈ a ∧ new ∉ b</span></span></span><br><span><var>IHl</var><span class="hyp-type"><b>: </b><span>length (set_diff_filter l a) &lt;
length (set_diff_filter l b)</span></span></span><br><span><var>n</var><span class="hyp-type"><b>: </b><span>¬ (a0 ∉ a)</span></span></span><br><span><var>n0</var><span class="hyp-type"><b>: </b><span>a0 ∉ b</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">length (filter (<span class="kr">λ</span> <span class="nv">x</span> : A, x ∉ a) l) &lt;
length (filter (<span class="kr">λ</span> <span class="nv">x</span> : A, x ∉ b) l)</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">      </span><span class="alectryon-sentence"><span class="alectryon-input"><span class="nb">apply</span> IHl.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="ListSetExtras-v-chk1da" style="display: none" type="checkbox"><label class="alectryon-input" for="ListSetExtras-v-chk1da">+</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>A</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>EqDecision0</var><span class="hyp-type"><b>: </b><span>EqDecision A</span></span></span><br><span><var>new, a0</var><span class="hyp-type"><b>: </b><span>A</span></span></span><br><span><var>l, a, b</var><span class="hyp-type"><b>: </b><span>list A</span></span></span><br><span><var>H_subseteq</var><span class="hyp-type"><b>: </b><span><span class="kr">∀</span> <span class="nv">x</span> : A, x ∈ b → x ∈ a</span></span></span><br><span><var>H_new_is_new</var><span class="hyp-type"><b>: </b><span>new ∈ a ∧ new ∉ b</span></span></span><br><span><var>IHl</var><span class="hyp-type"><b>: </b><span>length (set_diff_filter l a) &lt;
length (set_diff_filter l b)</span></span></span><br><span><var>n</var><span class="hyp-type"><b>: </b><span>¬ (a0 ∉ a)</span></span></span><br><span><var>n0</var><span class="hyp-type"><b>: </b><span>¬ (a0 ∉ b)</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">length (filter (<span class="kr">λ</span> <span class="nv">x</span> : A, x ∉ a) l) &lt;
length (filter (<span class="kr">λ</span> <span class="nv">x</span> : A, x ∉ b) l)</div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="nb">apply</span> IHl.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Qed</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
</span><span class="alectryon-sentence"><input class="alectryon-toggle" id="ListSetExtras-v-chk1db" style="display: none" type="checkbox"><label class="alectryon-input" for="ListSetExtras-v-chk1db"><span class="kn">Lemma</span> <span class="nf">len_set_diff_map_set_add</span> `{EqDecision B} (new:B) `{EqDecision A} (f: B -&gt; A)
      (a: list B) (l: list A)
      (H_new_is_new: ~(f new) ∈ (map f a))
      (H_new_is_relevant: (f new) ∈ l):
  length (set_diff_filter l (map f (set_add new a))) &lt;
    length (set_diff_filter l (map f a)).</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>B</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>EqDecision0</var><span class="hyp-type"><b>: </b><span>EqDecision B</span></span></span><br><span><var>new</var><span class="hyp-type"><b>: </b><span>B</span></span></span><br><span><var>A</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>EqDecision1</var><span class="hyp-type"><b>: </b><span>EqDecision A</span></span></span><br><span><var>f</var><span class="hyp-type"><b>: </b><span>B → A</span></span></span><br><span><var>a</var><span class="hyp-type"><b>: </b><span>list B</span></span></span><br><span><var>l</var><span class="hyp-type"><b>: </b><span>list A</span></span></span><br><span><var>H_new_is_new</var><span class="hyp-type"><b>: </b><span>f new ∉ map f a</span></span></span><br><span><var>H_new_is_relevant</var><span class="hyp-type"><b>: </b><span>f new ∈ l</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">length (set_diff_filter l (map f (set_add new a))) &lt;
length (set_diff_filter l (map f a))</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="ListSetExtras-v-chk1dc" style="display: none" type="checkbox"><label class="alectryon-input" for="ListSetExtras-v-chk1dc"><span class="kn">Proof</span>.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>B</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>EqDecision0</var><span class="hyp-type"><b>: </b><span>EqDecision B</span></span></span><br><span><var>new</var><span class="hyp-type"><b>: </b><span>B</span></span></span><br><span><var>A</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>EqDecision1</var><span class="hyp-type"><b>: </b><span>EqDecision A</span></span></span><br><span><var>f</var><span class="hyp-type"><b>: </b><span>B → A</span></span></span><br><span><var>a</var><span class="hyp-type"><b>: </b><span>list B</span></span></span><br><span><var>l</var><span class="hyp-type"><b>: </b><span>list A</span></span></span><br><span><var>H_new_is_new</var><span class="hyp-type"><b>: </b><span>f new ∉ map f a</span></span></span><br><span><var>H_new_is_relevant</var><span class="hyp-type"><b>: </b><span>f new ∈ l</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">length (set_diff_filter l (map f (set_add new a))) &lt;
length (set_diff_filter l (map f a))</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="ListSetExtras-v-chk1dd" style="display: none" type="checkbox"><label class="alectryon-input" for="ListSetExtras-v-chk1dd"><span class="nb">apply</span> len_set_diff_decrease <span class="kr">with</span> (f new).</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>B</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>EqDecision0</var><span class="hyp-type"><b>: </b><span>EqDecision B</span></span></span><br><span><var>new</var><span class="hyp-type"><b>: </b><span>B</span></span></span><br><span><var>A</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>EqDecision1</var><span class="hyp-type"><b>: </b><span>EqDecision A</span></span></span><br><span><var>f</var><span class="hyp-type"><b>: </b><span>B → A</span></span></span><br><span><var>a</var><span class="hyp-type"><b>: </b><span>list B</span></span></span><br><span><var>l</var><span class="hyp-type"><b>: </b><span>list A</span></span></span><br><span><var>H_new_is_new</var><span class="hyp-type"><b>: </b><span>f new ∉ map f a</span></span></span><br><span><var>H_new_is_relevant</var><span class="hyp-type"><b>: </b><span>f new ∈ l</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="kr">∀</span> <span class="nv">x</span> : A, x ∈ map f a → x ∈ map f (set_add new a)</div></blockquote><div class="alectryon-extra-goals"><input class="alectryon-extra-goal-toggle" id="ListSetExtras-v-chk1de" style="display: none" type="checkbox"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>B</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>EqDecision0</var><span class="hyp-type"><b>: </b><span>EqDecision B</span></span></span><br><span><var>new</var><span class="hyp-type"><b>: </b><span>B</span></span></span><br><span><var>A</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>EqDecision1</var><span class="hyp-type"><b>: </b><span>EqDecision A</span></span></span><br><span><var>f</var><span class="hyp-type"><b>: </b><span>B → A</span></span></span><br><span><var>a</var><span class="hyp-type"><b>: </b><span>list B</span></span></span><br><span><var>l</var><span class="hyp-type"><b>: </b><span>list A</span></span></span><br><span><var>H_new_is_new</var><span class="hyp-type"><b>: </b><span>f new ∉ map f a</span></span></span><br><span><var>H_new_is_relevant</var><span class="hyp-type"><b>: </b><span>f new ∈ l</span></span></span><br></div><label class="goal-separator" for="ListSetExtras-v-chk1de"><hr></label><div class="goal-conclusion">f new ∈ map f (set_add new a) ∧ f new ∉ map f a</div></blockquote><input class="alectryon-extra-goal-toggle" id="ListSetExtras-v-chk1df" style="display: none" type="checkbox"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>B</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>EqDecision0</var><span class="hyp-type"><b>: </b><span>EqDecision B</span></span></span><br><span><var>new</var><span class="hyp-type"><b>: </b><span>B</span></span></span><br><span><var>A</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>EqDecision1</var><span class="hyp-type"><b>: </b><span>EqDecision A</span></span></span><br><span><var>f</var><span class="hyp-type"><b>: </b><span>B → A</span></span></span><br><span><var>a</var><span class="hyp-type"><b>: </b><span>list B</span></span></span><br><span><var>l</var><span class="hyp-type"><b>: </b><span>list A</span></span></span><br><span><var>H_new_is_new</var><span class="hyp-type"><b>: </b><span>f new ∉ map f a</span></span></span><br><span><var>H_new_is_relevant</var><span class="hyp-type"><b>: </b><span>f new ∈ l</span></span></span><br></div><label class="goal-separator" for="ListSetExtras-v-chk1df"><hr></label><div class="goal-conclusion">f new ∈ l</div></blockquote></div></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="ListSetExtras-v-chk1e0" style="display: none" type="checkbox"><label class="alectryon-input" for="ListSetExtras-v-chk1e0">-</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>B</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>EqDecision0</var><span class="hyp-type"><b>: </b><span>EqDecision B</span></span></span><br><span><var>new</var><span class="hyp-type"><b>: </b><span>B</span></span></span><br><span><var>A</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>EqDecision1</var><span class="hyp-type"><b>: </b><span>EqDecision A</span></span></span><br><span><var>f</var><span class="hyp-type"><b>: </b><span>B → A</span></span></span><br><span><var>a</var><span class="hyp-type"><b>: </b><span>list B</span></span></span><br><span><var>l</var><span class="hyp-type"><b>: </b><span>list A</span></span></span><br><span><var>H_new_is_new</var><span class="hyp-type"><b>: </b><span>f new ∉ map f a</span></span></span><br><span><var>H_new_is_relevant</var><span class="hyp-type"><b>: </b><span>f new ∈ l</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="kr">∀</span> <span class="nv">x</span> : A, x ∈ map f a → x ∈ map f (set_add new a)</div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="ListSetExtras-v-chk1e1" style="display: none" type="checkbox"><label class="alectryon-input" for="ListSetExtras-v-chk1e1"><span class="nb">intro</span> x.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>B</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>EqDecision0</var><span class="hyp-type"><b>: </b><span>EqDecision B</span></span></span><br><span><var>new</var><span class="hyp-type"><b>: </b><span>B</span></span></span><br><span><var>A</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>EqDecision1</var><span class="hyp-type"><b>: </b><span>EqDecision A</span></span></span><br><span><var>f</var><span class="hyp-type"><b>: </b><span>B → A</span></span></span><br><span><var>a</var><span class="hyp-type"><b>: </b><span>list B</span></span></span><br><span><var>l</var><span class="hyp-type"><b>: </b><span>list A</span></span></span><br><span><var>H_new_is_new</var><span class="hyp-type"><b>: </b><span>f new ∉ map f a</span></span></span><br><span><var>H_new_is_relevant</var><span class="hyp-type"><b>: </b><span>f new ∈ l</span></span></span><br><span><var>x</var><span class="hyp-type"><b>: </b><span>A</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">x ∈ map f a → x ∈ map f (set_add new a)</div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="ListSetExtras-v-chk1e2" style="display: none" type="checkbox"><label class="alectryon-input" for="ListSetExtras-v-chk1e2"><span class="nb">rewrite</span> <span class="mi">2</span> elem_of_list_fmap.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>B</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>EqDecision0</var><span class="hyp-type"><b>: </b><span>EqDecision B</span></span></span><br><span><var>new</var><span class="hyp-type"><b>: </b><span>B</span></span></span><br><span><var>A</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>EqDecision1</var><span class="hyp-type"><b>: </b><span>EqDecision A</span></span></span><br><span><var>f</var><span class="hyp-type"><b>: </b><span>B → A</span></span></span><br><span><var>a</var><span class="hyp-type"><b>: </b><span>list B</span></span></span><br><span><var>l</var><span class="hyp-type"><b>: </b><span>list A</span></span></span><br><span><var>H_new_is_new</var><span class="hyp-type"><b>: </b><span>f new ∉ map f a</span></span></span><br><span><var>H_new_is_relevant</var><span class="hyp-type"><b>: </b><span>f new ∈ l</span></span></span><br><span><var>x</var><span class="hyp-type"><b>: </b><span>A</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">(<span class="kr">∃</span> <span class="nv">y</span> : B, x = f y ∧ y ∈ a)
→ <span class="kr">∃</span> <span class="nv">y</span> : B, x = f y ∧ y ∈ set_add new a</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="ListSetExtras-v-chk1e3" style="display: none" type="checkbox"><label class="alectryon-input" for="ListSetExtras-v-chk1e3"><span class="nb">intros</span> [x0 [Hx0 Hin]].</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>B</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>EqDecision0</var><span class="hyp-type"><b>: </b><span>EqDecision B</span></span></span><br><span><var>new</var><span class="hyp-type"><b>: </b><span>B</span></span></span><br><span><var>A</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>EqDecision1</var><span class="hyp-type"><b>: </b><span>EqDecision A</span></span></span><br><span><var>f</var><span class="hyp-type"><b>: </b><span>B → A</span></span></span><br><span><var>a</var><span class="hyp-type"><b>: </b><span>list B</span></span></span><br><span><var>l</var><span class="hyp-type"><b>: </b><span>list A</span></span></span><br><span><var>H_new_is_new</var><span class="hyp-type"><b>: </b><span>f new ∉ map f a</span></span></span><br><span><var>H_new_is_relevant</var><span class="hyp-type"><b>: </b><span>f new ∈ l</span></span></span><br><span><var>x</var><span class="hyp-type"><b>: </b><span>A</span></span></span><br><span><var>x0</var><span class="hyp-type"><b>: </b><span>B</span></span></span><br><span><var>Hx0</var><span class="hyp-type"><b>: </b><span>x = f x0</span></span></span><br><span><var>Hin</var><span class="hyp-type"><b>: </b><span>x0 ∈ a</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="kr">∃</span> <span class="nv">y</span> : B, x = f y ∧ y ∈ set_add new a</div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="ListSetExtras-v-chk1e4" style="display: none" type="checkbox"><label class="alectryon-input" for="ListSetExtras-v-chk1e4"><span class="kr">exists</span> <span class="nv">x0</span>.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>B</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>EqDecision0</var><span class="hyp-type"><b>: </b><span>EqDecision B</span></span></span><br><span><var>new</var><span class="hyp-type"><b>: </b><span>B</span></span></span><br><span><var>A</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>EqDecision1</var><span class="hyp-type"><b>: </b><span>EqDecision A</span></span></span><br><span><var>f</var><span class="hyp-type"><b>: </b><span>B → A</span></span></span><br><span><var>a</var><span class="hyp-type"><b>: </b><span>list B</span></span></span><br><span><var>l</var><span class="hyp-type"><b>: </b><span>list A</span></span></span><br><span><var>H_new_is_new</var><span class="hyp-type"><b>: </b><span>f new ∉ map f a</span></span></span><br><span><var>H_new_is_relevant</var><span class="hyp-type"><b>: </b><span>f new ∈ l</span></span></span><br><span><var>x</var><span class="hyp-type"><b>: </b><span>A</span></span></span><br><span><var>x0</var><span class="hyp-type"><b>: </b><span>B</span></span></span><br><span><var>Hx0</var><span class="hyp-type"><b>: </b><span>x = f x0</span></span></span><br><span><var>Hin</var><span class="hyp-type"><b>: </b><span>x0 ∈ a</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">x = f x0 ∧ x0 ∈ set_add new a</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="ListSetExtras-v-chk1e5" style="display: none" type="checkbox"><label class="alectryon-input" for="ListSetExtras-v-chk1e5"><span class="nb">rewrite</span> set_add_iff.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>B</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>EqDecision0</var><span class="hyp-type"><b>: </b><span>EqDecision B</span></span></span><br><span><var>new</var><span class="hyp-type"><b>: </b><span>B</span></span></span><br><span><var>A</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>EqDecision1</var><span class="hyp-type"><b>: </b><span>EqDecision A</span></span></span><br><span><var>f</var><span class="hyp-type"><b>: </b><span>B → A</span></span></span><br><span><var>a</var><span class="hyp-type"><b>: </b><span>list B</span></span></span><br><span><var>l</var><span class="hyp-type"><b>: </b><span>list A</span></span></span><br><span><var>H_new_is_new</var><span class="hyp-type"><b>: </b><span>f new ∉ map f a</span></span></span><br><span><var>H_new_is_relevant</var><span class="hyp-type"><b>: </b><span>f new ∈ l</span></span></span><br><span><var>x</var><span class="hyp-type"><b>: </b><span>A</span></span></span><br><span><var>x0</var><span class="hyp-type"><b>: </b><span>B</span></span></span><br><span><var>Hx0</var><span class="hyp-type"><b>: </b><span>x = f x0</span></span></span><br><span><var>Hin</var><span class="hyp-type"><b>: </b><span>x0 ∈ a</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">x = f x0 ∧ (x0 = new ∨ x0 ∈ a)</div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><span class="alectryon-input">itauto.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="ListSetExtras-v-chk1e6" style="display: none" type="checkbox"><label class="alectryon-input" for="ListSetExtras-v-chk1e6">-</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>B</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>EqDecision0</var><span class="hyp-type"><b>: </b><span>EqDecision B</span></span></span><br><span><var>new</var><span class="hyp-type"><b>: </b><span>B</span></span></span><br><span><var>A</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>EqDecision1</var><span class="hyp-type"><b>: </b><span>EqDecision A</span></span></span><br><span><var>f</var><span class="hyp-type"><b>: </b><span>B → A</span></span></span><br><span><var>a</var><span class="hyp-type"><b>: </b><span>list B</span></span></span><br><span><var>l</var><span class="hyp-type"><b>: </b><span>list A</span></span></span><br><span><var>H_new_is_new</var><span class="hyp-type"><b>: </b><span>f new ∉ map f a</span></span></span><br><span><var>H_new_is_relevant</var><span class="hyp-type"><b>: </b><span>f new ∈ l</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">f new ∈ map f (set_add new a) ∧ f new ∉ map f a</div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="ListSetExtras-v-chk1e7" style="display: none" type="checkbox"><label class="alectryon-input" for="ListSetExtras-v-chk1e7"><span class="nb">split</span>; [| <span class="bp">done</span>].</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>B</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>EqDecision0</var><span class="hyp-type"><b>: </b><span>EqDecision B</span></span></span><br><span><var>new</var><span class="hyp-type"><b>: </b><span>B</span></span></span><br><span><var>A</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>EqDecision1</var><span class="hyp-type"><b>: </b><span>EqDecision A</span></span></span><br><span><var>f</var><span class="hyp-type"><b>: </b><span>B → A</span></span></span><br><span><var>a</var><span class="hyp-type"><b>: </b><span>list B</span></span></span><br><span><var>l</var><span class="hyp-type"><b>: </b><span>list A</span></span></span><br><span><var>H_new_is_new</var><span class="hyp-type"><b>: </b><span>f new ∉ map f a</span></span></span><br><span><var>H_new_is_relevant</var><span class="hyp-type"><b>: </b><span>f new ∈ l</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">f new ∈ map f (set_add new a)</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="ListSetExtras-v-chk1e8" style="display: none" type="checkbox"><label class="alectryon-input" for="ListSetExtras-v-chk1e8"><span class="nb">apply</span> elem_of_list_fmap_1.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>B</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>EqDecision0</var><span class="hyp-type"><b>: </b><span>EqDecision B</span></span></span><br><span><var>new</var><span class="hyp-type"><b>: </b><span>B</span></span></span><br><span><var>A</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>EqDecision1</var><span class="hyp-type"><b>: </b><span>EqDecision A</span></span></span><br><span><var>f</var><span class="hyp-type"><b>: </b><span>B → A</span></span></span><br><span><var>a</var><span class="hyp-type"><b>: </b><span>list B</span></span></span><br><span><var>l</var><span class="hyp-type"><b>: </b><span>list A</span></span></span><br><span><var>H_new_is_new</var><span class="hyp-type"><b>: </b><span>f new ∉ map f a</span></span></span><br><span><var>H_new_is_relevant</var><span class="hyp-type"><b>: </b><span>f new ∈ l</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">new ∈ set_add new a</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><span class="alectryon-input"><span class="bp">by</span> <span class="nb">apply</span> set_add_iff; <span class="nb">left</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="ListSetExtras-v-chk1e9" style="display: none" type="checkbox"><label class="alectryon-input" for="ListSetExtras-v-chk1e9">-</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>B</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>EqDecision0</var><span class="hyp-type"><b>: </b><span>EqDecision B</span></span></span><br><span><var>new</var><span class="hyp-type"><b>: </b><span>B</span></span></span><br><span><var>A</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>EqDecision1</var><span class="hyp-type"><b>: </b><span>EqDecision A</span></span></span><br><span><var>f</var><span class="hyp-type"><b>: </b><span>B → A</span></span></span><br><span><var>a</var><span class="hyp-type"><b>: </b><span>list B</span></span></span><br><span><var>l</var><span class="hyp-type"><b>: </b><span>list A</span></span></span><br><span><var>H_new_is_new</var><span class="hyp-type"><b>: </b><span>f new ∉ map f a</span></span></span><br><span><var>H_new_is_relevant</var><span class="hyp-type"><b>: </b><span>f new ∈ l</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">f new ∈ l</div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="bp">done</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Qed</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
</span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Add</span> Parametric Relation A : (<span class="nb">set</span> A) (@set_eq A)
 <span class="bp">reflexivity</span> proved <span class="bp">by</span> (@set_eq_refl A)
 <span class="nb">transitivity</span> proved <span class="bp">by</span> (@set_eq_tran A) <span class="kr">as</span> set_eq_rel.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
</span><span class="alectryon-sentence"><input class="alectryon-toggle" id="ListSetExtras-v-chk1ea" style="display: none" type="checkbox"><label class="alectryon-input" for="ListSetExtras-v-chk1ea"><span class="kn">Add Parametric Morphism</span> <span class="nv">A</span> : (@elem_of_list A)
  <span class="kn">with signature</span> @eq A ==&gt; @set_eq A ==&gt; iff <span class="kr">as</span> set_eq_elem_of.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>A</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="kr">∀</span> (<span class="nv">y</span> : A) (<span class="nv">x</span> <span class="nv">y0</span> : <span class="nb">set</span> A),
  set_eq x y0 → elem_of_list y x ↔ elem_of_list y y0</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="ListSetExtras-v-chk1eb" style="display: none" type="checkbox"><label class="alectryon-input" for="ListSetExtras-v-chk1eb"><span class="kn">Proof</span>.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>A</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="kr">∀</span> (<span class="nv">y</span> : A) (<span class="nv">x</span> <span class="nv">y0</span> : <span class="nb">set</span> A),
  set_eq x y0 → elem_of_list y x ↔ elem_of_list y y0</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="ListSetExtras-v-chk1ec" style="display: none" type="checkbox"><label class="alectryon-input" for="ListSetExtras-v-chk1ec"><span class="nb">intros</span> a l1 l2 H.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>A</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>a</var><span class="hyp-type"><b>: </b><span>A</span></span></span><br><span><var>l1, l2</var><span class="hyp-type"><b>: </b><span><span class="nb">set</span> A</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>set_eq l1 l2</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">elem_of_list a l1 ↔ elem_of_list a l2</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><span class="alectryon-input"><span class="nb">split</span>;<span class="nb">apply</span> H.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Qed</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
</span><span class="alectryon-sentence"><input class="alectryon-toggle" id="ListSetExtras-v-chk1ed" style="display: none" type="checkbox"><label class="alectryon-input" for="ListSetExtras-v-chk1ed"><span class="kn">Add Parametric Morphism</span> <span class="nv">A</span> : (@elem_of_list A)
  <span class="kn">with signature</span> @eq A ==&gt; @list_subseteq A ==&gt; Basics.impl <span class="kr">as</span> set_elem_of_subseteq.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>A</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="kr">∀</span> (<span class="nv">y</span> : A) (<span class="nv">x</span> <span class="nv">y0</span> : list A),
  list_subseteq x y0
  → impl (elem_of_list y x) (elem_of_list y y0)</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="ListSetExtras-v-chk1ee" style="display: none" type="checkbox"><label class="alectryon-input" for="ListSetExtras-v-chk1ee"><span class="kn">Proof</span>.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>A</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="kr">∀</span> (<span class="nv">y</span> : A) (<span class="nv">x</span> <span class="nv">y0</span> : list A),
  list_subseteq x y0
  → impl (elem_of_list y x) (elem_of_list y y0)</div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="nb">firstorder</span>.</span><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Qed</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
</span><span class="alectryon-sentence"><input class="alectryon-toggle" id="ListSetExtras-v-chk1ef" style="display: none" type="checkbox"><label class="alectryon-input" for="ListSetExtras-v-chk1ef"><span class="kn">Lemma</span> <span class="nf">set_union_iterated_preserves_prop</span>
  `{EqDecision A}
  (ss : list (<span class="nb">set</span> A))
  (P : A -&gt; <span class="kt">Prop</span>)
  (Hp : <span class="kr">forall</span> (<span class="nv">s</span> : <span class="nb">set</span> A), <span class="kr">forall</span> (<span class="nv">a</span> : A), (s ∈ ss /\ a ∈ s) -&gt; P a) :
  <span class="kr">forall</span> (<span class="nv">a</span> : A), a ∈ (fold_right set_union [] ss) -&gt; P a.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>A</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>EqDecision0</var><span class="hyp-type"><b>: </b><span>EqDecision A</span></span></span><br><span><var>ss</var><span class="hyp-type"><b>: </b><span>list (<span class="nb">set</span> A)</span></span></span><br><span><var>P</var><span class="hyp-type"><b>: </b><span>A → <span class="kt">Prop</span></span></span></span><br><span><var>Hp</var><span class="hyp-type"><b>: </b><span><span class="kr">∀</span> (<span class="nv">s</span> : <span class="nb">set</span> A) (<span class="nv">a</span> : A), s ∈ ss ∧ a ∈ s → P a</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="kr">∀</span> <span class="nv">a</span> : A, a ∈ foldr set_union [] ss → P a</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="ListSetExtras-v-chk1f0" style="display: none" type="checkbox"><label class="alectryon-input" for="ListSetExtras-v-chk1f0"><span class="kn">Proof</span>.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>A</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>EqDecision0</var><span class="hyp-type"><b>: </b><span>EqDecision A</span></span></span><br><span><var>ss</var><span class="hyp-type"><b>: </b><span>list (<span class="nb">set</span> A)</span></span></span><br><span><var>P</var><span class="hyp-type"><b>: </b><span>A → <span class="kt">Prop</span></span></span></span><br><span><var>Hp</var><span class="hyp-type"><b>: </b><span><span class="kr">∀</span> (<span class="nv">s</span> : <span class="nb">set</span> A) (<span class="nv">a</span> : A), s ∈ ss ∧ a ∈ s → P a</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="kr">∀</span> <span class="nv">a</span> : A, a ∈ foldr set_union [] ss → P a</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="ListSetExtras-v-chk1f1" style="display: none" type="checkbox"><label class="alectryon-input" for="ListSetExtras-v-chk1f1"><span class="nb">intros</span>.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>A</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>EqDecision0</var><span class="hyp-type"><b>: </b><span>EqDecision A</span></span></span><br><span><var>ss</var><span class="hyp-type"><b>: </b><span>list (<span class="nb">set</span> A)</span></span></span><br><span><var>P</var><span class="hyp-type"><b>: </b><span>A → <span class="kt">Prop</span></span></span></span><br><span><var>Hp</var><span class="hyp-type"><b>: </b><span><span class="kr">∀</span> (<span class="nv">s</span> : <span class="nb">set</span> A) (<span class="nv">a</span> : A), s ∈ ss ∧ a ∈ s → P a</span></span></span><br><span><var>a</var><span class="hyp-type"><b>: </b><span>A</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>a ∈ foldr set_union [] ss</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">P a</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="ListSetExtras-v-chk1f2" style="display: none" type="checkbox"><label class="alectryon-input" for="ListSetExtras-v-chk1f2"><span class="nb">apply</span> set_union_in_iterated <span class="kr">in</span> H.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>A</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>EqDecision0</var><span class="hyp-type"><b>: </b><span>EqDecision A</span></span></span><br><span><var>ss</var><span class="hyp-type"><b>: </b><span>list (<span class="nb">set</span> A)</span></span></span><br><span><var>P</var><span class="hyp-type"><b>: </b><span>A → <span class="kt">Prop</span></span></span></span><br><span><var>Hp</var><span class="hyp-type"><b>: </b><span><span class="kr">∀</span> (<span class="nv">s</span> : <span class="nb">set</span> A) (<span class="nv">a</span> : A), s ∈ ss ∧ a ∈ s → P a</span></span></span><br><span><var>a</var><span class="hyp-type"><b>: </b><span>A</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>Exists (<span class="kr">λ</span> <span class="nv">s</span> : <span class="nb">set</span> A, a ∈ s) ss</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">P a</div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="ListSetExtras-v-chk1f3" style="display: none" type="checkbox"><label class="alectryon-input" for="ListSetExtras-v-chk1f3"><span class="nb">rewrite</span> Exists_exists <span class="kr">in</span> H.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>A</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>EqDecision0</var><span class="hyp-type"><b>: </b><span>EqDecision A</span></span></span><br><span><var>ss</var><span class="hyp-type"><b>: </b><span>list (<span class="nb">set</span> A)</span></span></span><br><span><var>P</var><span class="hyp-type"><b>: </b><span>A → <span class="kt">Prop</span></span></span></span><br><span><var>Hp</var><span class="hyp-type"><b>: </b><span><span class="kr">∀</span> (<span class="nv">s</span> : <span class="nb">set</span> A) (<span class="nv">a</span> : A), s ∈ ss ∧ a ∈ s → P a</span></span></span><br><span><var>a</var><span class="hyp-type"><b>: </b><span>A</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span><span class="kr">∃</span> <span class="nv">x</span> : <span class="nb">set</span> A, x ∈ ss ∧ a ∈ x</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">P a</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="ListSetExtras-v-chk1f4" style="display: none" type="checkbox"><label class="alectryon-input" for="ListSetExtras-v-chk1f4"><span class="nb">destruct</span> H <span class="kr">as</span> [s [Hins Hina]].</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>A</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>EqDecision0</var><span class="hyp-type"><b>: </b><span>EqDecision A</span></span></span><br><span><var>ss</var><span class="hyp-type"><b>: </b><span>list (<span class="nb">set</span> A)</span></span></span><br><span><var>P</var><span class="hyp-type"><b>: </b><span>A → <span class="kt">Prop</span></span></span></span><br><span><var>Hp</var><span class="hyp-type"><b>: </b><span><span class="kr">∀</span> (<span class="nv">s</span> : <span class="nb">set</span> A) (<span class="nv">a</span> : A), s ∈ ss ∧ a ∈ s → P a</span></span></span><br><span><var>a</var><span class="hyp-type"><b>: </b><span>A</span></span></span><br><span><var>s</var><span class="hyp-type"><b>: </b><span><span class="nb">set</span> A</span></span></span><br><span><var>Hins</var><span class="hyp-type"><b>: </b><span>s ∈ ss</span></span></span><br><span><var>Hina</var><span class="hyp-type"><b>: </b><span>a ∈ s</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">P a</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="ListSetExtras-v-chk1f5" style="display: none" type="checkbox"><label class="alectryon-input" for="ListSetExtras-v-chk1f5"><span class="nb">apply</span> Hp <span class="kr">with</span> (s := s).</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>A</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>EqDecision0</var><span class="hyp-type"><b>: </b><span>EqDecision A</span></span></span><br><span><var>ss</var><span class="hyp-type"><b>: </b><span>list (<span class="nb">set</span> A)</span></span></span><br><span><var>P</var><span class="hyp-type"><b>: </b><span>A → <span class="kt">Prop</span></span></span></span><br><span><var>Hp</var><span class="hyp-type"><b>: </b><span><span class="kr">∀</span> (<span class="nv">s</span> : <span class="nb">set</span> A) (<span class="nv">a</span> : A), s ∈ ss ∧ a ∈ s → P a</span></span></span><br><span><var>a</var><span class="hyp-type"><b>: </b><span>A</span></span></span><br><span><var>s</var><span class="hyp-type"><b>: </b><span><span class="nb">set</span> A</span></span></span><br><span><var>Hins</var><span class="hyp-type"><b>: </b><span>s ∈ ss</span></span></span><br><span><var>Hina</var><span class="hyp-type"><b>: </b><span>a ∈ s</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">s ∈ ss ∧ a ∈ s</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><span class="alectryon-input">itauto.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Qed</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
</span><span class="alectryon-sentence"><input class="alectryon-toggle" id="ListSetExtras-v-chk1f6" style="display: none" type="checkbox"><label class="alectryon-input" for="ListSetExtras-v-chk1f6"><span class="kn">Lemma</span> <span class="nf">filter_set_eq</span> {<span class="nv">X</span>} <span class="nv">P</span> <span class="nv">Q</span>
 `{<span class="kr">∀</span> (<span class="nv">x</span>:X), Decision (P x)} `{<span class="kr">∀</span> (<span class="nv">x</span>:X), Decision (Q x)}
   (l : list X)
   (resf := filter P l)
   (resg := filter Q l) :
   set_eq resf resg -&gt; resf = resg.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>X</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>P, Q</var><span class="hyp-type"><b>: </b><span>X → <span class="kt">Prop</span></span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span><span class="kr">∀</span> <span class="nv">x</span> : X, Decision (P x)</span></span></span><br><span><var>H0</var><span class="hyp-type"><b>: </b><span><span class="kr">∀</span> <span class="nv">x</span> : X, Decision (Q x)</span></span></span><br><span><var>l</var><span class="hyp-type"><b>: </b><span>list X</span></span></span><br><span><var>resf</var><span><span class="hyp-body"><b>:= </b><span>filter P l</span></span><span class="hyp-type"><b>: </b><span>list X</span></span></span></span><br><span><var>resg</var><span><span class="hyp-body"><b>:= </b><span>filter Q l</span></span><span class="hyp-type"><b>: </b><span>list X</span></span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">set_eq resf resg → resf = resg</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="ListSetExtras-v-chk1f7" style="display: none" type="checkbox"><label class="alectryon-input" for="ListSetExtras-v-chk1f7"><span class="kn">Proof</span>.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>X</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>P, Q</var><span class="hyp-type"><b>: </b><span>X → <span class="kt">Prop</span></span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span><span class="kr">∀</span> <span class="nv">x</span> : X, Decision (P x)</span></span></span><br><span><var>H0</var><span class="hyp-type"><b>: </b><span><span class="kr">∀</span> <span class="nv">x</span> : X, Decision (Q x)</span></span></span><br><span><var>l</var><span class="hyp-type"><b>: </b><span>list X</span></span></span><br><span><var>resf</var><span><span class="hyp-body"><b>:= </b><span>filter P l</span></span><span class="hyp-type"><b>: </b><span>list X</span></span></span></span><br><span><var>resg</var><span><span class="hyp-body"><b>:= </b><span>filter Q l</span></span><span class="hyp-type"><b>: </b><span>list X</span></span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">set_eq resf resg → resf = resg</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="ListSetExtras-v-chk1f8" style="display: none" type="checkbox"><label class="alectryon-input" for="ListSetExtras-v-chk1f8"><span class="nb">intros</span>.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>X</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>P, Q</var><span class="hyp-type"><b>: </b><span>X → <span class="kt">Prop</span></span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span><span class="kr">∀</span> <span class="nv">x</span> : X, Decision (P x)</span></span></span><br><span><var>H0</var><span class="hyp-type"><b>: </b><span><span class="kr">∀</span> <span class="nv">x</span> : X, Decision (Q x)</span></span></span><br><span><var>l</var><span class="hyp-type"><b>: </b><span>list X</span></span></span><br><span><var>resf</var><span><span class="hyp-body"><b>:= </b><span>filter P l</span></span><span class="hyp-type"><b>: </b><span>list X</span></span></span></span><br><span><var>resg</var><span><span class="hyp-body"><b>:= </b><span>filter Q l</span></span><span class="hyp-type"><b>: </b><span>list X</span></span></span></span><br><span><var>H1</var><span class="hyp-type"><b>: </b><span>set_eq resf resg</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">resf = resg</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="ListSetExtras-v-chk1f9" style="display: none" type="checkbox"><label class="alectryon-input" for="ListSetExtras-v-chk1f9"><span class="nb">unfold</span> resf, resg <span class="kr">in</span> *.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>X</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>P, Q</var><span class="hyp-type"><b>: </b><span>X → <span class="kt">Prop</span></span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span><span class="kr">∀</span> <span class="nv">x</span> : X, Decision (P x)</span></span></span><br><span><var>H0</var><span class="hyp-type"><b>: </b><span><span class="kr">∀</span> <span class="nv">x</span> : X, Decision (Q x)</span></span></span><br><span><var>l</var><span class="hyp-type"><b>: </b><span>list X</span></span></span><br><span><var>resf</var><span><span class="hyp-body"><b>:= </b><span>filter P l</span></span><span class="hyp-type"><b>: </b><span>list X</span></span></span></span><br><span><var>resg</var><span><span class="hyp-body"><b>:= </b><span>filter Q l</span></span><span class="hyp-type"><b>: </b><span>list X</span></span></span></span><br><span><var>H1</var><span class="hyp-type"><b>: </b><span>set_eq (filter P l) (filter Q l)</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">filter P l = filter Q l</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="ListSetExtras-v-chk1fa" style="display: none" type="checkbox"><label class="alectryon-input" for="ListSetExtras-v-chk1fa"><span class="nb">apply</span> filter_ext_elem_of.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>X</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>P, Q</var><span class="hyp-type"><b>: </b><span>X → <span class="kt">Prop</span></span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span><span class="kr">∀</span> <span class="nv">x</span> : X, Decision (P x)</span></span></span><br><span><var>H0</var><span class="hyp-type"><b>: </b><span><span class="kr">∀</span> <span class="nv">x</span> : X, Decision (Q x)</span></span></span><br><span><var>l</var><span class="hyp-type"><b>: </b><span>list X</span></span></span><br><span><var>resf</var><span><span class="hyp-body"><b>:= </b><span>filter P l</span></span><span class="hyp-type"><b>: </b><span>list X</span></span></span></span><br><span><var>resg</var><span><span class="hyp-body"><b>:= </b><span>filter Q l</span></span><span class="hyp-type"><b>: </b><span>list X</span></span></span></span><br><span><var>H1</var><span class="hyp-type"><b>: </b><span>set_eq (filter P l) (filter Q l)</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="kr">∀</span> <span class="nv">a</span> : X, a ∈ l → P a ↔ Q a</div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="ListSetExtras-v-chk1fb" style="display: none" type="checkbox"><label class="alectryon-input" for="ListSetExtras-v-chk1fb"><span class="nb">intros</span>.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>X</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>P, Q</var><span class="hyp-type"><b>: </b><span>X → <span class="kt">Prop</span></span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span><span class="kr">∀</span> <span class="nv">x</span> : X, Decision (P x)</span></span></span><br><span><var>H0</var><span class="hyp-type"><b>: </b><span><span class="kr">∀</span> <span class="nv">x</span> : X, Decision (Q x)</span></span></span><br><span><var>l</var><span class="hyp-type"><b>: </b><span>list X</span></span></span><br><span><var>resf</var><span><span class="hyp-body"><b>:= </b><span>filter P l</span></span><span class="hyp-type"><b>: </b><span>list X</span></span></span></span><br><span><var>resg</var><span><span class="hyp-body"><b>:= </b><span>filter Q l</span></span><span class="hyp-type"><b>: </b><span>list X</span></span></span></span><br><span><var>H1</var><span class="hyp-type"><b>: </b><span>set_eq (filter P l) (filter Q l)</span></span></span><br><span><var>a</var><span class="hyp-type"><b>: </b><span>X</span></span></span><br><span><var>H2</var><span class="hyp-type"><b>: </b><span>a ∈ l</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">P a ↔ Q a</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="ListSetExtras-v-chk1fc" style="display: none" type="checkbox"><label class="alectryon-input" for="ListSetExtras-v-chk1fc"><span class="nb">unfold</span> set_eq <span class="kr">in</span> H1.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>X</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>P, Q</var><span class="hyp-type"><b>: </b><span>X → <span class="kt">Prop</span></span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span><span class="kr">∀</span> <span class="nv">x</span> : X, Decision (P x)</span></span></span><br><span><var>H0</var><span class="hyp-type"><b>: </b><span><span class="kr">∀</span> <span class="nv">x</span> : X, Decision (Q x)</span></span></span><br><span><var>l</var><span class="hyp-type"><b>: </b><span>list X</span></span></span><br><span><var>resf</var><span><span class="hyp-body"><b>:= </b><span>filter P l</span></span><span class="hyp-type"><b>: </b><span>list X</span></span></span></span><br><span><var>resg</var><span><span class="hyp-body"><b>:= </b><span>filter Q l</span></span><span class="hyp-type"><b>: </b><span>list X</span></span></span></span><br><span><var>H1</var><span class="hyp-type"><b>: </b><span>filter P l ⊆ filter Q l ⊆ filter P l</span></span></span><br><span><var>a</var><span class="hyp-type"><b>: </b><span>X</span></span></span><br><span><var>H2</var><span class="hyp-type"><b>: </b><span>a ∈ l</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">P a ↔ Q a</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="ListSetExtras-v-chk1fd" style="display: none" type="checkbox"><label class="alectryon-input" for="ListSetExtras-v-chk1fd"><span class="nb">destruct</span> H1 <span class="kr">as</span> [H1 H1&#39;].</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>X</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>P, Q</var><span class="hyp-type"><b>: </b><span>X → <span class="kt">Prop</span></span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span><span class="kr">∀</span> <span class="nv">x</span> : X, Decision (P x)</span></span></span><br><span><var>H0</var><span class="hyp-type"><b>: </b><span><span class="kr">∀</span> <span class="nv">x</span> : X, Decision (Q x)</span></span></span><br><span><var>l</var><span class="hyp-type"><b>: </b><span>list X</span></span></span><br><span><var>resf</var><span><span class="hyp-body"><b>:= </b><span>filter P l</span></span><span class="hyp-type"><b>: </b><span>list X</span></span></span></span><br><span><var>resg</var><span><span class="hyp-body"><b>:= </b><span>filter Q l</span></span><span class="hyp-type"><b>: </b><span>list X</span></span></span></span><br><span><var>H1</var><span class="hyp-type"><b>: </b><span>filter P l ⊆ filter Q l</span></span></span><br><span><var>H1'</var><span class="hyp-type"><b>: </b><span>filter Q l ⊆ filter P l</span></span></span><br><span><var>a</var><span class="hyp-type"><b>: </b><span>X</span></span></span><br><span><var>H2</var><span class="hyp-type"><b>: </b><span>a ∈ l</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">P a ↔ Q a</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="ListSetExtras-v-chk1fe" style="display: none" type="checkbox"><label class="alectryon-input" for="ListSetExtras-v-chk1fe"><span class="nb">unfold</span> incl <span class="kr">in</span> *.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>X</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>P, Q</var><span class="hyp-type"><b>: </b><span>X → <span class="kt">Prop</span></span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span><span class="kr">∀</span> <span class="nv">x</span> : X, Decision (P x)</span></span></span><br><span><var>H0</var><span class="hyp-type"><b>: </b><span><span class="kr">∀</span> <span class="nv">x</span> : X, Decision (Q x)</span></span></span><br><span><var>l</var><span class="hyp-type"><b>: </b><span>list X</span></span></span><br><span><var>resf</var><span><span class="hyp-body"><b>:= </b><span>filter P l</span></span><span class="hyp-type"><b>: </b><span>list X</span></span></span></span><br><span><var>resg</var><span><span class="hyp-body"><b>:= </b><span>filter Q l</span></span><span class="hyp-type"><b>: </b><span>list X</span></span></span></span><br><span><var>H1</var><span class="hyp-type"><b>: </b><span>filter P l ⊆ filter Q l</span></span></span><br><span><var>H1'</var><span class="hyp-type"><b>: </b><span>filter Q l ⊆ filter P l</span></span></span><br><span><var>a</var><span class="hyp-type"><b>: </b><span>X</span></span></span><br><span><var>H2</var><span class="hyp-type"><b>: </b><span>a ∈ l</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">P a ↔ Q a</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="ListSetExtras-v-chk1ff" style="display: none" type="checkbox"><label class="alectryon-input" for="ListSetExtras-v-chk1ff"><span class="nb">specialize</span> (H1 a).</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>X</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>P, Q</var><span class="hyp-type"><b>: </b><span>X → <span class="kt">Prop</span></span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span><span class="kr">∀</span> <span class="nv">x</span> : X, Decision (P x)</span></span></span><br><span><var>H0</var><span class="hyp-type"><b>: </b><span><span class="kr">∀</span> <span class="nv">x</span> : X, Decision (Q x)</span></span></span><br><span><var>l</var><span class="hyp-type"><b>: </b><span>list X</span></span></span><br><span><var>resf</var><span><span class="hyp-body"><b>:= </b><span>filter P l</span></span><span class="hyp-type"><b>: </b><span>list X</span></span></span></span><br><span><var>resg</var><span><span class="hyp-body"><b>:= </b><span>filter Q l</span></span><span class="hyp-type"><b>: </b><span>list X</span></span></span></span><br><span><var>a</var><span class="hyp-type"><b>: </b><span>X</span></span></span><br><span><var>H1</var><span class="hyp-type"><b>: </b><span>a ∈ filter P l → a ∈ filter Q l</span></span></span><br><span><var>H1'</var><span class="hyp-type"><b>: </b><span>filter Q l ⊆ filter P l</span></span></span><br><span><var>H2</var><span class="hyp-type"><b>: </b><span>a ∈ l</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">P a ↔ Q a</div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="ListSetExtras-v-chk200" style="display: none" type="checkbox"><label class="alectryon-input" for="ListSetExtras-v-chk200"><span class="nb">specialize</span> (H1&#39; a).</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>X</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>P, Q</var><span class="hyp-type"><b>: </b><span>X → <span class="kt">Prop</span></span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span><span class="kr">∀</span> <span class="nv">x</span> : X, Decision (P x)</span></span></span><br><span><var>H0</var><span class="hyp-type"><b>: </b><span><span class="kr">∀</span> <span class="nv">x</span> : X, Decision (Q x)</span></span></span><br><span><var>l</var><span class="hyp-type"><b>: </b><span>list X</span></span></span><br><span><var>resf</var><span><span class="hyp-body"><b>:= </b><span>filter P l</span></span><span class="hyp-type"><b>: </b><span>list X</span></span></span></span><br><span><var>resg</var><span><span class="hyp-body"><b>:= </b><span>filter Q l</span></span><span class="hyp-type"><b>: </b><span>list X</span></span></span></span><br><span><var>a</var><span class="hyp-type"><b>: </b><span>X</span></span></span><br><span><var>H1</var><span class="hyp-type"><b>: </b><span>a ∈ filter P l → a ∈ filter Q l</span></span></span><br><span><var>H1'</var><span class="hyp-type"><b>: </b><span>a ∈ filter Q l → a ∈ filter P l</span></span></span><br><span><var>H2</var><span class="hyp-type"><b>: </b><span>a ∈ l</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">P a ↔ Q a</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="ListSetExtras-v-chk201" style="display: none" type="checkbox"><label class="alectryon-input" for="ListSetExtras-v-chk201"><span class="nb">split</span>; <span class="nb">intros</span>.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>X</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>P, Q</var><span class="hyp-type"><b>: </b><span>X → <span class="kt">Prop</span></span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span><span class="kr">∀</span> <span class="nv">x</span> : X, Decision (P x)</span></span></span><br><span><var>H0</var><span class="hyp-type"><b>: </b><span><span class="kr">∀</span> <span class="nv">x</span> : X, Decision (Q x)</span></span></span><br><span><var>l</var><span class="hyp-type"><b>: </b><span>list X</span></span></span><br><span><var>resf</var><span><span class="hyp-body"><b>:= </b><span>filter P l</span></span><span class="hyp-type"><b>: </b><span>list X</span></span></span></span><br><span><var>resg</var><span><span class="hyp-body"><b>:= </b><span>filter Q l</span></span><span class="hyp-type"><b>: </b><span>list X</span></span></span></span><br><span><var>a</var><span class="hyp-type"><b>: </b><span>X</span></span></span><br><span><var>H1</var><span class="hyp-type"><b>: </b><span>a ∈ filter P l → a ∈ filter Q l</span></span></span><br><span><var>H1'</var><span class="hyp-type"><b>: </b><span>a ∈ filter Q l → a ∈ filter P l</span></span></span><br><span><var>H2</var><span class="hyp-type"><b>: </b><span>a ∈ l</span></span></span><br><span><var>H3</var><span class="hyp-type"><b>: </b><span>P a</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">Q a</div></blockquote><div class="alectryon-extra-goals"><input class="alectryon-extra-goal-toggle" id="ListSetExtras-v-chk202" style="display: none" type="checkbox"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>X</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>P, Q</var><span class="hyp-type"><b>: </b><span>X → <span class="kt">Prop</span></span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span><span class="kr">∀</span> <span class="nv">x</span> : X, Decision (P x)</span></span></span><br><span><var>H0</var><span class="hyp-type"><b>: </b><span><span class="kr">∀</span> <span class="nv">x</span> : X, Decision (Q x)</span></span></span><br><span><var>l</var><span class="hyp-type"><b>: </b><span>list X</span></span></span><br><span><var>resf</var><span><span class="hyp-body"><b>:= </b><span>filter P l</span></span><span class="hyp-type"><b>: </b><span>list X</span></span></span></span><br><span><var>resg</var><span><span class="hyp-body"><b>:= </b><span>filter Q l</span></span><span class="hyp-type"><b>: </b><span>list X</span></span></span></span><br><span><var>a</var><span class="hyp-type"><b>: </b><span>X</span></span></span><br><span><var>H1</var><span class="hyp-type"><b>: </b><span>a ∈ filter P l → a ∈ filter Q l</span></span></span><br><span><var>H1'</var><span class="hyp-type"><b>: </b><span>a ∈ filter Q l → a ∈ filter P l</span></span></span><br><span><var>H2</var><span class="hyp-type"><b>: </b><span>a ∈ l</span></span></span><br><span><var>H3</var><span class="hyp-type"><b>: </b><span>Q a</span></span></span><br></div><label class="goal-separator" for="ListSetExtras-v-chk202"><hr></label><div class="goal-conclusion">P a</div></blockquote></div></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="ListSetExtras-v-chk203" style="display: none" type="checkbox"><label class="alectryon-input" for="ListSetExtras-v-chk203">-</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>X</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>P, Q</var><span class="hyp-type"><b>: </b><span>X → <span class="kt">Prop</span></span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span><span class="kr">∀</span> <span class="nv">x</span> : X, Decision (P x)</span></span></span><br><span><var>H0</var><span class="hyp-type"><b>: </b><span><span class="kr">∀</span> <span class="nv">x</span> : X, Decision (Q x)</span></span></span><br><span><var>l</var><span class="hyp-type"><b>: </b><span>list X</span></span></span><br><span><var>resf</var><span><span class="hyp-body"><b>:= </b><span>filter P l</span></span><span class="hyp-type"><b>: </b><span>list X</span></span></span></span><br><span><var>resg</var><span><span class="hyp-body"><b>:= </b><span>filter Q l</span></span><span class="hyp-type"><b>: </b><span>list X</span></span></span></span><br><span><var>a</var><span class="hyp-type"><b>: </b><span>X</span></span></span><br><span><var>H1</var><span class="hyp-type"><b>: </b><span>a ∈ filter P l → a ∈ filter Q l</span></span></span><br><span><var>H1'</var><span class="hyp-type"><b>: </b><span>a ∈ filter Q l → a ∈ filter P l</span></span></span><br><span><var>H2</var><span class="hyp-type"><b>: </b><span>a ∈ l</span></span></span><br><span><var>H3</var><span class="hyp-type"><b>: </b><span>P a</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">Q a</div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="bp">by</span> <span class="nb">eapply</span> elem_of_list_filter, H1, elem_of_list_filter.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="ListSetExtras-v-chk204" style="display: none" type="checkbox"><label class="alectryon-input" for="ListSetExtras-v-chk204">-</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>X</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>P, Q</var><span class="hyp-type"><b>: </b><span>X → <span class="kt">Prop</span></span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span><span class="kr">∀</span> <span class="nv">x</span> : X, Decision (P x)</span></span></span><br><span><var>H0</var><span class="hyp-type"><b>: </b><span><span class="kr">∀</span> <span class="nv">x</span> : X, Decision (Q x)</span></span></span><br><span><var>l</var><span class="hyp-type"><b>: </b><span>list X</span></span></span><br><span><var>resf</var><span><span class="hyp-body"><b>:= </b><span>filter P l</span></span><span class="hyp-type"><b>: </b><span>list X</span></span></span></span><br><span><var>resg</var><span><span class="hyp-body"><b>:= </b><span>filter Q l</span></span><span class="hyp-type"><b>: </b><span>list X</span></span></span></span><br><span><var>a</var><span class="hyp-type"><b>: </b><span>X</span></span></span><br><span><var>H1</var><span class="hyp-type"><b>: </b><span>a ∈ filter P l → a ∈ filter Q l</span></span></span><br><span><var>H1'</var><span class="hyp-type"><b>: </b><span>a ∈ filter Q l → a ∈ filter P l</span></span></span><br><span><var>H2</var><span class="hyp-type"><b>: </b><span>a ∈ l</span></span></span><br><span><var>H3</var><span class="hyp-type"><b>: </b><span>Q a</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">P a</div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="bp">by</span> <span class="nb">eapply</span> elem_of_list_filter, H1&#39;, elem_of_list_filter.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Qed</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
</span><span class="alectryon-sentence"><input class="alectryon-toggle" id="ListSetExtras-v-chk205" style="display: none" type="checkbox"><label class="alectryon-input" for="ListSetExtras-v-chk205"><span class="kn">Lemma</span> <span class="nf">subseteq_appr</span> : <span class="kr">forall</span> <span class="nv">A</span> (<span class="nv">l</span> <span class="nv">m</span> <span class="nv">n</span> : list A), l ⊆ n -&gt; l ⊆ (m ++ n).</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="kr">∀</span> (<span class="nv">A</span> : <span class="kt">Type</span>) (<span class="nv">l</span> <span class="nv">m</span> <span class="nv">n</span> : list A), l ⊆ n → l ⊆ m ++ n</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="ListSetExtras-v-chk206" style="display: none" type="checkbox"><label class="alectryon-input" for="ListSetExtras-v-chk206"><span class="kn">Proof</span>.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="kr">∀</span> (<span class="nv">A</span> : <span class="kt">Type</span>) (<span class="nv">l</span> <span class="nv">m</span> <span class="nv">n</span> : list A), l ⊆ n → l ⊆ m ++ n</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="ListSetExtras-v-chk207" style="display: none" type="checkbox"><label class="alectryon-input" for="ListSetExtras-v-chk207"><span class="nb">intros</span> A l m n x y yinl.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>A</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>l, m, n</var><span class="hyp-type"><b>: </b><span>list A</span></span></span><br><span><var>x</var><span class="hyp-type"><b>: </b><span>l ⊆ n</span></span></span><br><span><var>y</var><span class="hyp-type"><b>: </b><span>A</span></span></span><br><span><var>yinl</var><span class="hyp-type"><b>: </b><span>y ∈ l</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">y ∈ m ++ n</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="ListSetExtras-v-chk208" style="display: none" type="checkbox"><label class="alectryon-input" for="ListSetExtras-v-chk208"><span class="nb">apply</span> x <span class="kr">in</span> yinl.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>A</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>l, m, n</var><span class="hyp-type"><b>: </b><span>list A</span></span></span><br><span><var>x</var><span class="hyp-type"><b>: </b><span>l ⊆ n</span></span></span><br><span><var>y</var><span class="hyp-type"><b>: </b><span>A</span></span></span><br><span><var>yinl</var><span class="hyp-type"><b>: </b><span>y ∈ n</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">y ∈ m ++ n</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><span class="alectryon-input"><span class="bp">by</span> <span class="nb">apply</span> elem_of_app; <span class="nb">right</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Qed</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
</span><span class="alectryon-sentence"><input class="alectryon-toggle" id="ListSetExtras-v-chk209" style="display: none" type="checkbox"><label class="alectryon-input" for="ListSetExtras-v-chk209"><span class="kn">Lemma</span> <span class="nf">elem_of_union_fold</span>
  `{EqDecision A}
  (haystack : list (list A))
  (a : A) :
  a ∈ (fold_right set_union [] haystack)
  &lt;-&gt;
  <span class="kr">exists</span> (<span class="nv">needle</span> : list A), (a ∈ needle) /\ (needle ∈ haystack).</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>A</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>EqDecision0</var><span class="hyp-type"><b>: </b><span>EqDecision A</span></span></span><br><span><var>haystack</var><span class="hyp-type"><b>: </b><span>list (list A)</span></span></span><br><span><var>a</var><span class="hyp-type"><b>: </b><span>A</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">a ∈ foldr set_union [] haystack
↔ (<span class="kr">∃</span> <span class="nv">needle</span> : list A, a ∈ needle ∧ needle ∈ haystack)</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="ListSetExtras-v-chk20a" style="display: none" type="checkbox"><label class="alectryon-input" for="ListSetExtras-v-chk20a"><span class="kn">Proof</span>.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>A</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>EqDecision0</var><span class="hyp-type"><b>: </b><span>EqDecision A</span></span></span><br><span><var>haystack</var><span class="hyp-type"><b>: </b><span>list (list A)</span></span></span><br><span><var>a</var><span class="hyp-type"><b>: </b><span>A</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">a ∈ foldr set_union [] haystack
↔ (<span class="kr">∃</span> <span class="nv">needle</span> : list A, a ∈ needle ∧ needle ∈ haystack)</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="ListSetExtras-v-chk20b" style="display: none" type="checkbox"><label class="alectryon-input" for="ListSetExtras-v-chk20b"><span class="nb">split</span>.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>A</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>EqDecision0</var><span class="hyp-type"><b>: </b><span>EqDecision A</span></span></span><br><span><var>haystack</var><span class="hyp-type"><b>: </b><span>list (list A)</span></span></span><br><span><var>a</var><span class="hyp-type"><b>: </b><span>A</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">a ∈ foldr set_union [] haystack
→ <span class="kr">∃</span> <span class="nv">needle</span> : list A, a ∈ needle ∧ needle ∈ haystack</div></blockquote><div class="alectryon-extra-goals"><input class="alectryon-extra-goal-toggle" id="ListSetExtras-v-chk20c" style="display: none" type="checkbox"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>A</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>EqDecision0</var><span class="hyp-type"><b>: </b><span>EqDecision A</span></span></span><br><span><var>haystack</var><span class="hyp-type"><b>: </b><span>list (list A)</span></span></span><br><span><var>a</var><span class="hyp-type"><b>: </b><span>A</span></span></span><br></div><label class="goal-separator" for="ListSetExtras-v-chk20c"><hr></label><div class="goal-conclusion">(<span class="kr">∃</span> <span class="nv">needle</span> : list A, a ∈ needle ∧ needle ∈ haystack)
→ a ∈ foldr set_union [] haystack</div></blockquote></div></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="ListSetExtras-v-chk20d" style="display: none" type="checkbox"><label class="alectryon-input" for="ListSetExtras-v-chk20d">-</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>A</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>EqDecision0</var><span class="hyp-type"><b>: </b><span>EqDecision A</span></span></span><br><span><var>haystack</var><span class="hyp-type"><b>: </b><span>list (list A)</span></span></span><br><span><var>a</var><span class="hyp-type"><b>: </b><span>A</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">a ∈ foldr set_union [] haystack
→ <span class="kr">∃</span> <span class="nv">needle</span> : list A, a ∈ needle ∧ needle ∈ haystack</div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="ListSetExtras-v-chk20e" style="display: none" type="checkbox"><label class="alectryon-input" for="ListSetExtras-v-chk20e"><span class="nb">generalize dependent</span> a.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>A</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>EqDecision0</var><span class="hyp-type"><b>: </b><span>EqDecision A</span></span></span><br><span><var>haystack</var><span class="hyp-type"><b>: </b><span>list (list A)</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="kr">∀</span> <span class="nv">a</span> : A,
  a ∈ foldr set_union [] haystack
  → <span class="kr">∃</span> <span class="nv">needle</span> : list A, a ∈ needle ∧ needle ∈ haystack</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="ListSetExtras-v-chk20f" style="display: none" type="checkbox"><label class="alectryon-input" for="ListSetExtras-v-chk20f"><span class="nb">generalize dependent</span> haystack.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>A</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>EqDecision0</var><span class="hyp-type"><b>: </b><span>EqDecision A</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="kr">∀</span> (<span class="nv">haystack</span> : list (list A)) (<span class="nv">a</span> : A),
  a ∈ foldr set_union [] haystack
  → <span class="kr">∃</span> <span class="nv">needle</span> : list A, a ∈ needle ∧ needle ∈ haystack</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="ListSetExtras-v-chk210" style="display: none" type="checkbox"><label class="alectryon-input" for="ListSetExtras-v-chk210"><span class="nb">induction</span> haystack.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>A</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>EqDecision0</var><span class="hyp-type"><b>: </b><span>EqDecision A</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="kr">∀</span> <span class="nv">a</span> : A,
  a ∈ foldr set_union [] []
  → <span class="kr">∃</span> <span class="nv">needle</span> : list A, a ∈ needle ∧ needle ∈ []</div></blockquote><div class="alectryon-extra-goals"><input class="alectryon-extra-goal-toggle" id="ListSetExtras-v-chk211" style="display: none" type="checkbox"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>A</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>EqDecision0</var><span class="hyp-type"><b>: </b><span>EqDecision A</span></span></span><br><span><var>a</var><span class="hyp-type"><b>: </b><span>list A</span></span></span><br><span><var>haystack</var><span class="hyp-type"><b>: </b><span>list (list A)</span></span></span><br><span><var>IHhaystack</var><span class="hyp-type"><b>: </b><span><span class="kr">∀</span> <span class="nv">a</span> : A,
  a ∈ foldr set_union [] haystack
  → <span class="kr">∃</span> <span class="nv">needle</span> : list A,
      a ∈ needle ∧ needle ∈ haystack</span></span></span><br></div><label class="goal-separator" for="ListSetExtras-v-chk211"><hr></label><div class="goal-conclusion"><span class="kr">∀</span> <span class="nv">a0</span> : A,
  a0 ∈ foldr set_union [] (a :: haystack)
  → <span class="kr">∃</span> <span class="nv">needle</span> : list A,
      a0 ∈ needle ∧ needle ∈ a :: haystack</div></blockquote></div></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="ListSetExtras-v-chk212" style="display: none" type="checkbox"><label class="alectryon-input" for="ListSetExtras-v-chk212">+</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>A</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>EqDecision0</var><span class="hyp-type"><b>: </b><span>EqDecision A</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="kr">∀</span> <span class="nv">a</span> : A,
  a ∈ foldr set_union [] []
  → <span class="kr">∃</span> <span class="nv">needle</span> : list A, a ∈ needle ∧ needle ∈ []</div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="ListSetExtras-v-chk213" style="display: none" type="checkbox"><label class="alectryon-input" for="ListSetExtras-v-chk213"><span class="nb">intros</span>.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>A</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>EqDecision0</var><span class="hyp-type"><b>: </b><span>EqDecision A</span></span></span><br><span><var>a</var><span class="hyp-type"><b>: </b><span>A</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>a ∈ foldr set_union [] []</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="kr">∃</span> <span class="nv">needle</span> : list A, a ∈ needle ∧ needle ∈ []</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">      </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="ListSetExtras-v-chk214" style="display: none" type="checkbox"><label class="alectryon-input" for="ListSetExtras-v-chk214"><span class="nb">simpl</span> <span class="kr">in</span> H.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>A</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>EqDecision0</var><span class="hyp-type"><b>: </b><span>EqDecision A</span></span></span><br><span><var>a</var><span class="hyp-type"><b>: </b><span>A</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>a ∈ []</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="kr">∃</span> <span class="nv">needle</span> : list A, a ∈ needle ∧ needle ∈ []</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">      </span><span class="alectryon-sentence"><span class="alectryon-input"><span class="nb">inversion</span> H.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="ListSetExtras-v-chk215" style="display: none" type="checkbox"><label class="alectryon-input" for="ListSetExtras-v-chk215">+</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>A</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>EqDecision0</var><span class="hyp-type"><b>: </b><span>EqDecision A</span></span></span><br><span><var>a</var><span class="hyp-type"><b>: </b><span>list A</span></span></span><br><span><var>haystack</var><span class="hyp-type"><b>: </b><span>list (list A)</span></span></span><br><span><var>IHhaystack</var><span class="hyp-type"><b>: </b><span><span class="kr">∀</span> <span class="nv">a</span> : A,
  a ∈ foldr set_union [] haystack
  → <span class="kr">∃</span> <span class="nv">needle</span> : list A,
      a ∈ needle ∧ needle ∈ haystack</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="kr">∀</span> <span class="nv">a0</span> : A,
  a0 ∈ foldr set_union [] (a :: haystack)
  → <span class="kr">∃</span> <span class="nv">needle</span> : list A,
      a0 ∈ needle ∧ needle ∈ a :: haystack</div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="ListSetExtras-v-chk216" style="display: none" type="checkbox"><label class="alectryon-input" for="ListSetExtras-v-chk216"><span class="nb">intros</span>.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>A</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>EqDecision0</var><span class="hyp-type"><b>: </b><span>EqDecision A</span></span></span><br><span><var>a</var><span class="hyp-type"><b>: </b><span>list A</span></span></span><br><span><var>haystack</var><span class="hyp-type"><b>: </b><span>list (list A)</span></span></span><br><span><var>IHhaystack</var><span class="hyp-type"><b>: </b><span><span class="kr">∀</span> <span class="nv">a</span> : A,
  a ∈ foldr set_union [] haystack
  → <span class="kr">∃</span> <span class="nv">needle</span> : list A,
      a ∈ needle ∧ needle ∈ haystack</span></span></span><br><span><var>a0</var><span class="hyp-type"><b>: </b><span>A</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>a0 ∈ foldr set_union [] (a :: haystack)</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="kr">∃</span> <span class="nv">needle</span> : list A,
  a0 ∈ needle ∧ needle ∈ a :: haystack</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">      </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="ListSetExtras-v-chk217" style="display: none" type="checkbox"><label class="alectryon-input" for="ListSetExtras-v-chk217"><span class="nb">unfold</span> fold_right <span class="kr">in</span> H.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>A</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>EqDecision0</var><span class="hyp-type"><b>: </b><span>EqDecision A</span></span></span><br><span><var>a</var><span class="hyp-type"><b>: </b><span>list A</span></span></span><br><span><var>haystack</var><span class="hyp-type"><b>: </b><span>list (list A)</span></span></span><br><span><var>IHhaystack</var><span class="hyp-type"><b>: </b><span><span class="kr">∀</span> <span class="nv">a</span> : A,
  a ∈ foldr set_union [] haystack
  → <span class="kr">∃</span> <span class="nv">needle</span> : list A,
      a ∈ needle ∧ needle ∈ haystack</span></span></span><br><span><var>a0</var><span class="hyp-type"><b>: </b><span>A</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>a0
∈ set_union a
    ((<span class="kr">fix</span> fold_right (l : list (<span class="nb">set</span> A)) : <span class="nb">set</span> A :=
        <span class="kr">match</span> l <span class="kr">with</span>
        | [] =&gt; []
        | b :: t =&gt; set_union b (fold_right t)
        <span class="kr">end</span>) haystack)</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="kr">∃</span> <span class="nv">needle</span> : list A,
  a0 ∈ needle ∧ needle ∈ a :: haystack</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">      </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="ListSetExtras-v-chk218" style="display: none" type="checkbox"><label class="alectryon-input" for="ListSetExtras-v-chk218"><span class="nb">rewrite</span> set_union_iff <span class="kr">in</span> H.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>A</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>EqDecision0</var><span class="hyp-type"><b>: </b><span>EqDecision A</span></span></span><br><span><var>a</var><span class="hyp-type"><b>: </b><span>list A</span></span></span><br><span><var>haystack</var><span class="hyp-type"><b>: </b><span>list (list A)</span></span></span><br><span><var>IHhaystack</var><span class="hyp-type"><b>: </b><span><span class="kr">∀</span> <span class="nv">a</span> : A,
  a ∈ foldr set_union [] haystack
  → <span class="kr">∃</span> <span class="nv">needle</span> : list A,
      a ∈ needle ∧ needle ∈ haystack</span></span></span><br><span><var>a0</var><span class="hyp-type"><b>: </b><span>A</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>a0 ∈ a
∨ a0
  ∈ (<span class="kr">fix</span> fold_right (l : list (<span class="nb">set</span> A)) : <span class="nb">set</span> A :=
       <span class="kr">match</span> l <span class="kr">with</span>
       | [] =&gt; []
       | b :: t =&gt; set_union b (fold_right t)
       <span class="kr">end</span>) haystack</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="kr">∃</span> <span class="nv">needle</span> : list A,
  a0 ∈ needle ∧ needle ∈ a :: haystack</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">      </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="ListSetExtras-v-chk219" style="display: none" type="checkbox"><label class="alectryon-input" for="ListSetExtras-v-chk219"><span class="nb">destruct</span> H.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>A</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>EqDecision0</var><span class="hyp-type"><b>: </b><span>EqDecision A</span></span></span><br><span><var>a</var><span class="hyp-type"><b>: </b><span>list A</span></span></span><br><span><var>haystack</var><span class="hyp-type"><b>: </b><span>list (list A)</span></span></span><br><span><var>IHhaystack</var><span class="hyp-type"><b>: </b><span><span class="kr">∀</span> <span class="nv">a</span> : A,
  a ∈ foldr set_union [] haystack
  → <span class="kr">∃</span> <span class="nv">needle</span> : list A,
      a ∈ needle ∧ needle ∈ haystack</span></span></span><br><span><var>a0</var><span class="hyp-type"><b>: </b><span>A</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>a0 ∈ a</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="kr">∃</span> <span class="nv">needle</span> : list A,
  a0 ∈ needle ∧ needle ∈ a :: haystack</div></blockquote><div class="alectryon-extra-goals"><input class="alectryon-extra-goal-toggle" id="ListSetExtras-v-chk21a" style="display: none" type="checkbox"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>A</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>EqDecision0</var><span class="hyp-type"><b>: </b><span>EqDecision A</span></span></span><br><span><var>a</var><span class="hyp-type"><b>: </b><span>list A</span></span></span><br><span><var>haystack</var><span class="hyp-type"><b>: </b><span>list (list A)</span></span></span><br><span><var>IHhaystack</var><span class="hyp-type"><b>: </b><span><span class="kr">∀</span> <span class="nv">a</span> : A,
  a ∈ foldr set_union [] haystack
  → <span class="kr">∃</span> <span class="nv">needle</span> : list A,
      a ∈ needle ∧ needle ∈ haystack</span></span></span><br><span><var>a0</var><span class="hyp-type"><b>: </b><span>A</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>a0
∈ (<span class="kr">fix</span> fold_right (l : list (<span class="nb">set</span> A)) : <span class="nb">set</span> A :=
     <span class="kr">match</span> l <span class="kr">with</span>
     | [] =&gt; []
     | b :: t =&gt; set_union b (fold_right t)
     <span class="kr">end</span>) haystack</span></span></span><br></div><label class="goal-separator" for="ListSetExtras-v-chk21a"><hr></label><div class="goal-conclusion"><span class="kr">∃</span> <span class="nv">needle</span> : list A,
  a0 ∈ needle ∧ needle ∈ a :: haystack</div></blockquote></div></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">      </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="ListSetExtras-v-chk21b" style="display: none" type="checkbox"><label class="alectryon-input" for="ListSetExtras-v-chk21b">*</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>A</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>EqDecision0</var><span class="hyp-type"><b>: </b><span>EqDecision A</span></span></span><br><span><var>a</var><span class="hyp-type"><b>: </b><span>list A</span></span></span><br><span><var>haystack</var><span class="hyp-type"><b>: </b><span>list (list A)</span></span></span><br><span><var>IHhaystack</var><span class="hyp-type"><b>: </b><span><span class="kr">∀</span> <span class="nv">a</span> : A,
  a ∈ foldr set_union [] haystack
  → <span class="kr">∃</span> <span class="nv">needle</span> : list A,
      a ∈ needle ∧ needle ∈ haystack</span></span></span><br><span><var>a0</var><span class="hyp-type"><b>: </b><span>A</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>a0 ∈ a</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="kr">∃</span> <span class="nv">needle</span> : list A,
  a0 ∈ needle ∧ needle ∈ a :: haystack</div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="ListSetExtras-v-chk21c" style="display: none" type="checkbox"><label class="alectryon-input" for="ListSetExtras-v-chk21c"><span class="nb">setoid_rewrite</span> elem_of_cons.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>A</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>EqDecision0</var><span class="hyp-type"><b>: </b><span>EqDecision A</span></span></span><br><span><var>a</var><span class="hyp-type"><b>: </b><span>list A</span></span></span><br><span><var>haystack</var><span class="hyp-type"><b>: </b><span>list (list A)</span></span></span><br><span><var>IHhaystack</var><span class="hyp-type"><b>: </b><span><span class="kr">∀</span> <span class="nv">a</span> : A,
  a ∈ foldr set_union [] haystack
  → <span class="kr">∃</span> <span class="nv">needle</span> : list A,
      a ∈ needle ∧ needle ∈ haystack</span></span></span><br><span><var>a0</var><span class="hyp-type"><b>: </b><span>A</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>a0 ∈ a</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="kr">∃</span> <span class="nv">needle</span> : list A,
  a0 ∈ needle ∧ (needle = a ∨ needle ∈ haystack)</div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="nb">eauto</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">      </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="ListSetExtras-v-chk21d" style="display: none" type="checkbox"><label class="alectryon-input" for="ListSetExtras-v-chk21d">*</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>A</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>EqDecision0</var><span class="hyp-type"><b>: </b><span>EqDecision A</span></span></span><br><span><var>a</var><span class="hyp-type"><b>: </b><span>list A</span></span></span><br><span><var>haystack</var><span class="hyp-type"><b>: </b><span>list (list A)</span></span></span><br><span><var>IHhaystack</var><span class="hyp-type"><b>: </b><span><span class="kr">∀</span> <span class="nv">a</span> : A,
  a ∈ foldr set_union [] haystack
  → <span class="kr">∃</span> <span class="nv">needle</span> : list A,
      a ∈ needle ∧ needle ∈ haystack</span></span></span><br><span><var>a0</var><span class="hyp-type"><b>: </b><span>A</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>a0
∈ (<span class="kr">fix</span> fold_right (l : list (<span class="nb">set</span> A)) : <span class="nb">set</span> A :=
     <span class="kr">match</span> l <span class="kr">with</span>
     | [] =&gt; []
     | b :: t =&gt; set_union b (fold_right t)
     <span class="kr">end</span>) haystack</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="kr">∃</span> <span class="nv">needle</span> : list A,
  a0 ∈ needle ∧ needle ∈ a :: haystack</div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="ListSetExtras-v-chk21e" style="display: none" type="checkbox"><label class="alectryon-input" for="ListSetExtras-v-chk21e"><span class="nb">destruct</span> (IHhaystack a0 H) <span class="kr">as</span> (needle &amp; Hin1 &amp; Hin2).</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>A</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>EqDecision0</var><span class="hyp-type"><b>: </b><span>EqDecision A</span></span></span><br><span><var>a</var><span class="hyp-type"><b>: </b><span>list A</span></span></span><br><span><var>haystack</var><span class="hyp-type"><b>: </b><span>list (list A)</span></span></span><br><span><var>IHhaystack</var><span class="hyp-type"><b>: </b><span><span class="kr">∀</span> <span class="nv">a</span> : A,
  a ∈ foldr set_union [] haystack
  → <span class="kr">∃</span> <span class="nv">needle</span> : list A,
      a ∈ needle ∧ needle ∈ haystack</span></span></span><br><span><var>a0</var><span class="hyp-type"><b>: </b><span>A</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>a0
∈ (<span class="kr">fix</span> fold_right (l : list (<span class="nb">set</span> A)) : <span class="nb">set</span> A :=
     <span class="kr">match</span> l <span class="kr">with</span>
     | [] =&gt; []
     | b :: t =&gt; set_union b (fold_right t)
     <span class="kr">end</span>) haystack</span></span></span><br><span><var>needle</var><span class="hyp-type"><b>: </b><span>list A</span></span></span><br><span><var>Hin1</var><span class="hyp-type"><b>: </b><span>a0 ∈ needle</span></span></span><br><span><var>Hin2</var><span class="hyp-type"><b>: </b><span>needle ∈ haystack</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="kr">∃</span> <span class="nv">needle</span> : list A,
  a0 ∈ needle ∧ needle ∈ a :: haystack</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">        </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="ListSetExtras-v-chk21f" style="display: none" type="checkbox"><label class="alectryon-input" for="ListSetExtras-v-chk21f"><span class="nb">setoid_rewrite</span> elem_of_cons.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>A</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>EqDecision0</var><span class="hyp-type"><b>: </b><span>EqDecision A</span></span></span><br><span><var>a</var><span class="hyp-type"><b>: </b><span>list A</span></span></span><br><span><var>haystack</var><span class="hyp-type"><b>: </b><span>list (list A)</span></span></span><br><span><var>IHhaystack</var><span class="hyp-type"><b>: </b><span><span class="kr">∀</span> <span class="nv">a</span> : A,
  a ∈ foldr set_union [] haystack
  → <span class="kr">∃</span> <span class="nv">needle</span> : list A,
      a ∈ needle ∧ needle ∈ haystack</span></span></span><br><span><var>a0</var><span class="hyp-type"><b>: </b><span>A</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>a0
∈ (<span class="kr">fix</span> fold_right (l : list (<span class="nb">set</span> A)) : <span class="nb">set</span> A :=
     <span class="kr">match</span> l <span class="kr">with</span>
     | [] =&gt; []
     | b :: t =&gt; set_union b (fold_right t)
     <span class="kr">end</span>) haystack</span></span></span><br><span><var>needle</var><span class="hyp-type"><b>: </b><span>list A</span></span></span><br><span><var>Hin1</var><span class="hyp-type"><b>: </b><span>a0 ∈ needle</span></span></span><br><span><var>Hin2</var><span class="hyp-type"><b>: </b><span>needle ∈ haystack</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="kr">∃</span> <span class="nv">needle</span> : list A,
  a0 ∈ needle ∧ (needle = a ∨ needle ∈ haystack)</div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="nb">eauto</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">   </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="ListSetExtras-v-chk220" style="display: none" type="checkbox"><label class="alectryon-input" for="ListSetExtras-v-chk220">-</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>A</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>EqDecision0</var><span class="hyp-type"><b>: </b><span>EqDecision A</span></span></span><br><span><var>haystack</var><span class="hyp-type"><b>: </b><span>list (list A)</span></span></span><br><span><var>a</var><span class="hyp-type"><b>: </b><span>A</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">(<span class="kr">∃</span> <span class="nv">needle</span> : list A, a ∈ needle ∧ needle ∈ haystack)
→ a ∈ foldr set_union [] haystack</div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="ListSetExtras-v-chk221" style="display: none" type="checkbox"><label class="alectryon-input" for="ListSetExtras-v-chk221"><span class="nb">generalize dependent</span> a.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>A</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>EqDecision0</var><span class="hyp-type"><b>: </b><span>EqDecision A</span></span></span><br><span><var>haystack</var><span class="hyp-type"><b>: </b><span>list (list A)</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="kr">∀</span> <span class="nv">a</span> : A,
  (<span class="kr">∃</span> <span class="nv">needle</span> : list A, a ∈ needle ∧ needle ∈ haystack)
  → a ∈ foldr set_union [] haystack</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">     </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="ListSetExtras-v-chk222" style="display: none" type="checkbox"><label class="alectryon-input" for="ListSetExtras-v-chk222"><span class="nb">generalize dependent</span> haystack.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>A</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>EqDecision0</var><span class="hyp-type"><b>: </b><span>EqDecision A</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="kr">∀</span> (<span class="nv">haystack</span> : list (list A)) (<span class="nv">a</span> : A),
  (<span class="kr">∃</span> <span class="nv">needle</span> : list A, a ∈ needle ∧ needle ∈ haystack)
  → a ∈ foldr set_union [] haystack</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">     </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="ListSetExtras-v-chk223" style="display: none" type="checkbox"><label class="alectryon-input" for="ListSetExtras-v-chk223"><span class="nb">induction</span> haystack.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>A</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>EqDecision0</var><span class="hyp-type"><b>: </b><span>EqDecision A</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="kr">∀</span> <span class="nv">a</span> : A,
  (<span class="kr">∃</span> <span class="nv">needle</span> : list A, a ∈ needle ∧ needle ∈ [])
  → a ∈ foldr set_union [] []</div></blockquote><div class="alectryon-extra-goals"><input class="alectryon-extra-goal-toggle" id="ListSetExtras-v-chk224" style="display: none" type="checkbox"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>A</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>EqDecision0</var><span class="hyp-type"><b>: </b><span>EqDecision A</span></span></span><br><span><var>a</var><span class="hyp-type"><b>: </b><span>list A</span></span></span><br><span><var>haystack</var><span class="hyp-type"><b>: </b><span>list (list A)</span></span></span><br><span><var>IHhaystack</var><span class="hyp-type"><b>: </b><span><span class="kr">∀</span> <span class="nv">a</span> : A,
  (<span class="kr">∃</span> <span class="nv">needle</span> : list A,
     a ∈ needle ∧ needle ∈ haystack)
  → a ∈ foldr set_union [] haystack</span></span></span><br></div><label class="goal-separator" for="ListSetExtras-v-chk224"><hr></label><div class="goal-conclusion"><span class="kr">∀</span> <span class="nv">a0</span> : A,
  (<span class="kr">∃</span> <span class="nv">needle</span> : list A,
     a0 ∈ needle ∧ needle ∈ a :: haystack)
  → a0 ∈ foldr set_union [] (a :: haystack)</div></blockquote></div></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">     </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="ListSetExtras-v-chk225" style="display: none" type="checkbox"><label class="alectryon-input" for="ListSetExtras-v-chk225">+</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>A</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>EqDecision0</var><span class="hyp-type"><b>: </b><span>EqDecision A</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="kr">∀</span> <span class="nv">a</span> : A,
  (<span class="kr">∃</span> <span class="nv">needle</span> : list A, a ∈ needle ∧ needle ∈ [])
  → a ∈ foldr set_union [] []</div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="ListSetExtras-v-chk226" style="display: none" type="checkbox"><label class="alectryon-input" for="ListSetExtras-v-chk226"><span class="nb">intros</span>.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>A</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>EqDecision0</var><span class="hyp-type"><b>: </b><span>EqDecision A</span></span></span><br><span><var>a</var><span class="hyp-type"><b>: </b><span>A</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span><span class="kr">∃</span> <span class="nv">needle</span> : list A, a ∈ needle ∧ needle ∈ []</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">a ∈ foldr set_union [] []</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">       </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="ListSetExtras-v-chk227" style="display: none" type="checkbox"><label class="alectryon-input" for="ListSetExtras-v-chk227"><span class="nb">simpl</span> <span class="kr">in</span> *.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>A</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>EqDecision0</var><span class="hyp-type"><b>: </b><span>EqDecision A</span></span></span><br><span><var>a</var><span class="hyp-type"><b>: </b><span>A</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span><span class="kr">∃</span> <span class="nv">needle</span> : list A, a ∈ needle ∧ needle ∈ []</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">a ∈ []</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">       </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="ListSetExtras-v-chk228" style="display: none" type="checkbox"><label class="alectryon-input" for="ListSetExtras-v-chk228"><span class="nb">destruct</span> H.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>A</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>EqDecision0</var><span class="hyp-type"><b>: </b><span>EqDecision A</span></span></span><br><span><var>a</var><span class="hyp-type"><b>: </b><span>A</span></span></span><br><span><var>x</var><span class="hyp-type"><b>: </b><span>list A</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>a ∈ x ∧ x ∈ []</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">a ∈ []</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">       </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="ListSetExtras-v-chk229" style="display: none" type="checkbox"><label class="alectryon-input" for="ListSetExtras-v-chk229"><span class="nb">destruct</span> H <span class="kr">as</span> [Ha Hx].</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>A</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>EqDecision0</var><span class="hyp-type"><b>: </b><span>EqDecision A</span></span></span><br><span><var>a</var><span class="hyp-type"><b>: </b><span>A</span></span></span><br><span><var>x</var><span class="hyp-type"><b>: </b><span>list A</span></span></span><br><span><var>Ha</var><span class="hyp-type"><b>: </b><span>a ∈ x</span></span></span><br><span><var>Hx</var><span class="hyp-type"><b>: </b><span>x ∈ []</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">a ∈ []</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">       </span><span class="alectryon-sentence"><span class="alectryon-input"><span class="nb">inversion</span> Hx.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">     </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="ListSetExtras-v-chk22a" style="display: none" type="checkbox"><label class="alectryon-input" for="ListSetExtras-v-chk22a">+</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>A</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>EqDecision0</var><span class="hyp-type"><b>: </b><span>EqDecision A</span></span></span><br><span><var>a</var><span class="hyp-type"><b>: </b><span>list A</span></span></span><br><span><var>haystack</var><span class="hyp-type"><b>: </b><span>list (list A)</span></span></span><br><span><var>IHhaystack</var><span class="hyp-type"><b>: </b><span><span class="kr">∀</span> <span class="nv">a</span> : A,
  (<span class="kr">∃</span> <span class="nv">needle</span> : list A,
     a ∈ needle ∧ needle ∈ haystack)
  → a ∈ foldr set_union [] haystack</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="kr">∀</span> <span class="nv">a0</span> : A,
  (<span class="kr">∃</span> <span class="nv">needle</span> : list A,
     a0 ∈ needle ∧ needle ∈ a :: haystack)
  → a0 ∈ foldr set_union [] (a :: haystack)</div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="ListSetExtras-v-chk22b" style="display: none" type="checkbox"><label class="alectryon-input" for="ListSetExtras-v-chk22b"><span class="nb">intros</span>.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>A</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>EqDecision0</var><span class="hyp-type"><b>: </b><span>EqDecision A</span></span></span><br><span><var>a</var><span class="hyp-type"><b>: </b><span>list A</span></span></span><br><span><var>haystack</var><span class="hyp-type"><b>: </b><span>list (list A)</span></span></span><br><span><var>IHhaystack</var><span class="hyp-type"><b>: </b><span><span class="kr">∀</span> <span class="nv">a</span> : A,
  (<span class="kr">∃</span> <span class="nv">needle</span> : list A,
     a ∈ needle ∧ needle ∈ haystack)
  → a ∈ foldr set_union [] haystack</span></span></span><br><span><var>a0</var><span class="hyp-type"><b>: </b><span>A</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span><span class="kr">∃</span> <span class="nv">needle</span> : list A,
  a0 ∈ needle ∧ needle ∈ a :: haystack</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">a0 ∈ foldr set_union [] (a :: haystack)</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">       </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="ListSetExtras-v-chk22c" style="display: none" type="checkbox"><label class="alectryon-input" for="ListSetExtras-v-chk22c"><span class="nb">destruct</span> H <span class="kr">as</span> [needle [Hin Hin2]].</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>A</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>EqDecision0</var><span class="hyp-type"><b>: </b><span>EqDecision A</span></span></span><br><span><var>a</var><span class="hyp-type"><b>: </b><span>list A</span></span></span><br><span><var>haystack</var><span class="hyp-type"><b>: </b><span>list (list A)</span></span></span><br><span><var>IHhaystack</var><span class="hyp-type"><b>: </b><span><span class="kr">∀</span> <span class="nv">a</span> : A,
  (<span class="kr">∃</span> <span class="nv">needle</span> : list A,
     a ∈ needle ∧ needle ∈ haystack)
  → a ∈ foldr set_union [] haystack</span></span></span><br><span><var>a0</var><span class="hyp-type"><b>: </b><span>A</span></span></span><br><span><var>needle</var><span class="hyp-type"><b>: </b><span>list A</span></span></span><br><span><var>Hin</var><span class="hyp-type"><b>: </b><span>a0 ∈ needle</span></span></span><br><span><var>Hin2</var><span class="hyp-type"><b>: </b><span>needle ∈ a :: haystack</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">a0 ∈ foldr set_union [] (a :: haystack)</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">       </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="ListSetExtras-v-chk22d" style="display: none" type="checkbox"><label class="alectryon-input" for="ListSetExtras-v-chk22d"><span class="nb">rewrite</span> elem_of_cons <span class="kr">in</span> Hin2.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>A</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>EqDecision0</var><span class="hyp-type"><b>: </b><span>EqDecision A</span></span></span><br><span><var>a</var><span class="hyp-type"><b>: </b><span>list A</span></span></span><br><span><var>haystack</var><span class="hyp-type"><b>: </b><span>list (list A)</span></span></span><br><span><var>IHhaystack</var><span class="hyp-type"><b>: </b><span><span class="kr">∀</span> <span class="nv">a</span> : A,
  (<span class="kr">∃</span> <span class="nv">needle</span> : list A,
     a ∈ needle ∧ needle ∈ haystack)
  → a ∈ foldr set_union [] haystack</span></span></span><br><span><var>a0</var><span class="hyp-type"><b>: </b><span>A</span></span></span><br><span><var>needle</var><span class="hyp-type"><b>: </b><span>list A</span></span></span><br><span><var>Hin</var><span class="hyp-type"><b>: </b><span>a0 ∈ needle</span></span></span><br><span><var>Hin2</var><span class="hyp-type"><b>: </b><span>needle = a ∨ needle ∈ haystack</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">a0 ∈ foldr set_union [] (a :: haystack)</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">       </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="ListSetExtras-v-chk22e" style="display: none" type="checkbox"><label class="alectryon-input" for="ListSetExtras-v-chk22e"><span class="nb">destruct</span> Hin2.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>A</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>EqDecision0</var><span class="hyp-type"><b>: </b><span>EqDecision A</span></span></span><br><span><var>a</var><span class="hyp-type"><b>: </b><span>list A</span></span></span><br><span><var>haystack</var><span class="hyp-type"><b>: </b><span>list (list A)</span></span></span><br><span><var>IHhaystack</var><span class="hyp-type"><b>: </b><span><span class="kr">∀</span> <span class="nv">a</span> : A,
  (<span class="kr">∃</span> <span class="nv">needle</span> : list A,
     a ∈ needle ∧ needle ∈ haystack)
  → a ∈ foldr set_union [] haystack</span></span></span><br><span><var>a0</var><span class="hyp-type"><b>: </b><span>A</span></span></span><br><span><var>needle</var><span class="hyp-type"><b>: </b><span>list A</span></span></span><br><span><var>Hin</var><span class="hyp-type"><b>: </b><span>a0 ∈ needle</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>needle = a</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">a0 ∈ foldr set_union [] (a :: haystack)</div></blockquote><div class="alectryon-extra-goals"><input class="alectryon-extra-goal-toggle" id="ListSetExtras-v-chk22f" style="display: none" type="checkbox"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>A</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>EqDecision0</var><span class="hyp-type"><b>: </b><span>EqDecision A</span></span></span><br><span><var>a</var><span class="hyp-type"><b>: </b><span>list A</span></span></span><br><span><var>haystack</var><span class="hyp-type"><b>: </b><span>list (list A)</span></span></span><br><span><var>IHhaystack</var><span class="hyp-type"><b>: </b><span><span class="kr">∀</span> <span class="nv">a</span> : A,
  (<span class="kr">∃</span> <span class="nv">needle</span> : list A,
     a ∈ needle ∧ needle ∈ haystack)
  → a ∈ foldr set_union [] haystack</span></span></span><br><span><var>a0</var><span class="hyp-type"><b>: </b><span>A</span></span></span><br><span><var>needle</var><span class="hyp-type"><b>: </b><span>list A</span></span></span><br><span><var>Hin</var><span class="hyp-type"><b>: </b><span>a0 ∈ needle</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>needle ∈ haystack</span></span></span><br></div><label class="goal-separator" for="ListSetExtras-v-chk22f"><hr></label><div class="goal-conclusion">a0 ∈ foldr set_union [] (a :: haystack)</div></blockquote></div></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">       </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="ListSetExtras-v-chk230" style="display: none" type="checkbox"><label class="alectryon-input" for="ListSetExtras-v-chk230">*</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>A</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>EqDecision0</var><span class="hyp-type"><b>: </b><span>EqDecision A</span></span></span><br><span><var>a</var><span class="hyp-type"><b>: </b><span>list A</span></span></span><br><span><var>haystack</var><span class="hyp-type"><b>: </b><span>list (list A)</span></span></span><br><span><var>IHhaystack</var><span class="hyp-type"><b>: </b><span><span class="kr">∀</span> <span class="nv">a</span> : A,
  (<span class="kr">∃</span> <span class="nv">needle</span> : list A,
     a ∈ needle ∧ needle ∈ haystack)
  → a ∈ foldr set_union [] haystack</span></span></span><br><span><var>a0</var><span class="hyp-type"><b>: </b><span>A</span></span></span><br><span><var>needle</var><span class="hyp-type"><b>: </b><span>list A</span></span></span><br><span><var>Hin</var><span class="hyp-type"><b>: </b><span>a0 ∈ needle</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>needle = a</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">a0 ∈ foldr set_union [] (a :: haystack)</div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="ListSetExtras-v-chk231" style="display: none" type="checkbox"><label class="alectryon-input" for="ListSetExtras-v-chk231"><span class="nb">cbn</span>.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>A</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>EqDecision0</var><span class="hyp-type"><b>: </b><span>EqDecision A</span></span></span><br><span><var>a</var><span class="hyp-type"><b>: </b><span>list A</span></span></span><br><span><var>haystack</var><span class="hyp-type"><b>: </b><span>list (list A)</span></span></span><br><span><var>IHhaystack</var><span class="hyp-type"><b>: </b><span><span class="kr">∀</span> <span class="nv">a</span> : A,
  (<span class="kr">∃</span> <span class="nv">needle</span> : list A,
     a ∈ needle ∧ needle ∈ haystack)
  → a ∈ foldr set_union [] haystack</span></span></span><br><span><var>a0</var><span class="hyp-type"><b>: </b><span>A</span></span></span><br><span><var>needle</var><span class="hyp-type"><b>: </b><span>list A</span></span></span><br><span><var>Hin</var><span class="hyp-type"><b>: </b><span>a0 ∈ needle</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>needle = a</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">a0 ∈ set_union a (foldr set_union [] haystack)</div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="nb">rewrite</span> set_union_iff, &lt;- H; <span class="nb">auto</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">       </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="ListSetExtras-v-chk232" style="display: none" type="checkbox"><label class="alectryon-input" for="ListSetExtras-v-chk232">*</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>A</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>EqDecision0</var><span class="hyp-type"><b>: </b><span>EqDecision A</span></span></span><br><span><var>a</var><span class="hyp-type"><b>: </b><span>list A</span></span></span><br><span><var>haystack</var><span class="hyp-type"><b>: </b><span>list (list A)</span></span></span><br><span><var>IHhaystack</var><span class="hyp-type"><b>: </b><span><span class="kr">∀</span> <span class="nv">a</span> : A,
  (<span class="kr">∃</span> <span class="nv">needle</span> : list A,
     a ∈ needle ∧ needle ∈ haystack)
  → a ∈ foldr set_union [] haystack</span></span></span><br><span><var>a0</var><span class="hyp-type"><b>: </b><span>A</span></span></span><br><span><var>needle</var><span class="hyp-type"><b>: </b><span>list A</span></span></span><br><span><var>Hin</var><span class="hyp-type"><b>: </b><span>a0 ∈ needle</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>needle ∈ haystack</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">a0 ∈ foldr set_union [] (a :: haystack)</div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="ListSetExtras-v-chk233" style="display: none" type="checkbox"><label class="alectryon-input" for="ListSetExtras-v-chk233"><span class="nb">simpl</span>.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>A</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>EqDecision0</var><span class="hyp-type"><b>: </b><span>EqDecision A</span></span></span><br><span><var>a</var><span class="hyp-type"><b>: </b><span>list A</span></span></span><br><span><var>haystack</var><span class="hyp-type"><b>: </b><span>list (list A)</span></span></span><br><span><var>IHhaystack</var><span class="hyp-type"><b>: </b><span><span class="kr">∀</span> <span class="nv">a</span> : A,
  (<span class="kr">∃</span> <span class="nv">needle</span> : list A,
     a ∈ needle ∧ needle ∈ haystack)
  → a ∈ foldr set_union [] haystack</span></span></span><br><span><var>a0</var><span class="hyp-type"><b>: </b><span>A</span></span></span><br><span><var>needle</var><span class="hyp-type"><b>: </b><span>list A</span></span></span><br><span><var>Hin</var><span class="hyp-type"><b>: </b><span>a0 ∈ needle</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>needle ∈ haystack</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">a0 ∈ set_union a (foldr set_union [] haystack)</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">         </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="ListSetExtras-v-chk234" style="display: none" type="checkbox"><label class="alectryon-input" for="ListSetExtras-v-chk234"><span class="nb">rewrite</span> set_union_iff.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>A</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>EqDecision0</var><span class="hyp-type"><b>: </b><span>EqDecision A</span></span></span><br><span><var>a</var><span class="hyp-type"><b>: </b><span>list A</span></span></span><br><span><var>haystack</var><span class="hyp-type"><b>: </b><span>list (list A)</span></span></span><br><span><var>IHhaystack</var><span class="hyp-type"><b>: </b><span><span class="kr">∀</span> <span class="nv">a</span> : A,
  (<span class="kr">∃</span> <span class="nv">needle</span> : list A,
     a ∈ needle ∧ needle ∈ haystack)
  → a ∈ foldr set_union [] haystack</span></span></span><br><span><var>a0</var><span class="hyp-type"><b>: </b><span>A</span></span></span><br><span><var>needle</var><span class="hyp-type"><b>: </b><span>list A</span></span></span><br><span><var>Hin</var><span class="hyp-type"><b>: </b><span>a0 ∈ needle</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>needle ∈ haystack</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">a0 ∈ a ∨ a0 ∈ foldr set_union [] haystack</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">         </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="ListSetExtras-v-chk235" style="display: none" type="checkbox"><label class="alectryon-input" for="ListSetExtras-v-chk235"><span class="nb">right</span>.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>A</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>EqDecision0</var><span class="hyp-type"><b>: </b><span>EqDecision A</span></span></span><br><span><var>a</var><span class="hyp-type"><b>: </b><span>list A</span></span></span><br><span><var>haystack</var><span class="hyp-type"><b>: </b><span>list (list A)</span></span></span><br><span><var>IHhaystack</var><span class="hyp-type"><b>: </b><span><span class="kr">∀</span> <span class="nv">a</span> : A,
  (<span class="kr">∃</span> <span class="nv">needle</span> : list A,
     a ∈ needle ∧ needle ∈ haystack)
  → a ∈ foldr set_union [] haystack</span></span></span><br><span><var>a0</var><span class="hyp-type"><b>: </b><span>A</span></span></span><br><span><var>needle</var><span class="hyp-type"><b>: </b><span>list A</span></span></span><br><span><var>Hin</var><span class="hyp-type"><b>: </b><span>a0 ∈ needle</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>needle ∈ haystack</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">a0 ∈ foldr set_union [] haystack</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">         </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="ListSetExtras-v-chk236" style="display: none" type="checkbox"><label class="alectryon-input" for="ListSetExtras-v-chk236"><span class="nb">apply</span> IHhaystack.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>A</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>EqDecision0</var><span class="hyp-type"><b>: </b><span>EqDecision A</span></span></span><br><span><var>a</var><span class="hyp-type"><b>: </b><span>list A</span></span></span><br><span><var>haystack</var><span class="hyp-type"><b>: </b><span>list (list A)</span></span></span><br><span><var>IHhaystack</var><span class="hyp-type"><b>: </b><span><span class="kr">∀</span> <span class="nv">a</span> : A,
  (<span class="kr">∃</span> <span class="nv">needle</span> : list A,
     a ∈ needle ∧ needle ∈ haystack)
  → a ∈ foldr set_union [] haystack</span></span></span><br><span><var>a0</var><span class="hyp-type"><b>: </b><span>A</span></span></span><br><span><var>needle</var><span class="hyp-type"><b>: </b><span>list A</span></span></span><br><span><var>Hin</var><span class="hyp-type"><b>: </b><span>a0 ∈ needle</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>needle ∈ haystack</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="kr">∃</span> <span class="nv">needle</span> : list A, a0 ∈ needle ∧ needle ∈ haystack</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">         </span><span class="alectryon-sentence"><span class="alectryon-input"><span class="bp">by</span> <span class="kr">exists</span> <span class="nv">needle</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Qed</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
</span><span class="alectryon-sentence"><input class="alectryon-toggle" id="ListSetExtras-v-chk237" style="display: none" type="checkbox"><label class="alectryon-input" for="ListSetExtras-v-chk237"><span class="kn">Lemma</span> <span class="nf">subseteq_Forall</span> (<span class="nv">A</span>:<span class="kt">Type</span>) (<span class="nv">P</span> : A -&gt; <span class="kt">Prop</span>) (<span class="nv">l1</span> <span class="nv">l2</span> : list A) :
 l2 ⊆ l1 -&gt; Forall P l1 -&gt; Forall P l2.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>A</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>P</var><span class="hyp-type"><b>: </b><span>A → <span class="kt">Prop</span></span></span></span><br><span><var>l1, l2</var><span class="hyp-type"><b>: </b><span>list A</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">l2 ⊆ l1 → Forall P l1 → Forall P l2</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="ListSetExtras-v-chk238" style="display: none" type="checkbox"><label class="alectryon-input" for="ListSetExtras-v-chk238"><span class="kn">Proof</span>.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>A</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>P</var><span class="hyp-type"><b>: </b><span>A → <span class="kt">Prop</span></span></span></span><br><span><var>l1, l2</var><span class="hyp-type"><b>: </b><span>list A</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">l2 ⊆ l1 → Forall P l1 → Forall P l2</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="ListSetExtras-v-chk239" style="display: none" type="checkbox"><label class="alectryon-input" for="ListSetExtras-v-chk239"><span class="nb">intros</span> Hsub Hfor.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>A</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>P</var><span class="hyp-type"><b>: </b><span>A → <span class="kt">Prop</span></span></span></span><br><span><var>l1, l2</var><span class="hyp-type"><b>: </b><span>list A</span></span></span><br><span><var>Hsub</var><span class="hyp-type"><b>: </b><span>l2 ⊆ l1</span></span></span><br><span><var>Hfor</var><span class="hyp-type"><b>: </b><span>Forall P l1</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">Forall P l2</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="ListSetExtras-v-chk23a" style="display: none" type="checkbox"><label class="alectryon-input" for="ListSetExtras-v-chk23a"><span class="nb">apply</span> Forall_forall.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>A</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>P</var><span class="hyp-type"><b>: </b><span>A → <span class="kt">Prop</span></span></span></span><br><span><var>l1, l2</var><span class="hyp-type"><b>: </b><span>list A</span></span></span><br><span><var>Hsub</var><span class="hyp-type"><b>: </b><span>l2 ⊆ l1</span></span></span><br><span><var>Hfor</var><span class="hyp-type"><b>: </b><span>Forall P l1</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="kr">∀</span> <span class="nv">x</span> : A, x ∈ l2 → P x</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="ListSetExtras-v-chk23b" style="display: none" type="checkbox"><label class="alectryon-input" for="ListSetExtras-v-chk23b"><span class="nb">rewrite</span> Forall_forall <span class="kr">in</span> Hfor.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>A</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>P</var><span class="hyp-type"><b>: </b><span>A → <span class="kt">Prop</span></span></span></span><br><span><var>l1, l2</var><span class="hyp-type"><b>: </b><span>list A</span></span></span><br><span><var>Hsub</var><span class="hyp-type"><b>: </b><span>l2 ⊆ l1</span></span></span><br><span><var>Hfor</var><span class="hyp-type"><b>: </b><span><span class="kr">∀</span> <span class="nv">x</span> : A, x ∈ l1 → P x</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="kr">∀</span> <span class="nv">x</span> : A, x ∈ l2 → P x</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="ListSetExtras-v-chk23c" style="display: none" type="checkbox"><label class="alectryon-input" for="ListSetExtras-v-chk23c"><span class="nb">intros</span>.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>A</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>P</var><span class="hyp-type"><b>: </b><span>A → <span class="kt">Prop</span></span></span></span><br><span><var>l1, l2</var><span class="hyp-type"><b>: </b><span>list A</span></span></span><br><span><var>Hsub</var><span class="hyp-type"><b>: </b><span>l2 ⊆ l1</span></span></span><br><span><var>Hfor</var><span class="hyp-type"><b>: </b><span><span class="kr">∀</span> <span class="nv">x</span> : A, x ∈ l1 → P x</span></span></span><br><span><var>x</var><span class="hyp-type"><b>: </b><span>A</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>x ∈ l2</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">P x</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><span class="alectryon-input"><span class="bp">by</span> <span class="nb">apply</span> Hfor, Hsub.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Qed</span>.</span></span></pre></article></body></html>