<!DOCTYPE html>
<html class="alectryon-standalone"><head><title>TraceableVLSM.v</title><meta charset="utf-8"><meta content="Alectryon" name="generator"><meta name="viewport" content="width=device-width, initial-scale=1"><link href="alectryon.css" rel="stylesheet"><link href="pygments.css" rel="stylesheet">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/IBM-type/0.5.4/css/ibm-type.min.css" integrity="sha512-sky5cf9Ts6FY1kstGOBHSybfKqdHR41M0Ldb0BjNiv3ifltoQIsg0zIaQ+wwdwgQ0w9vKFW7Js50lxH9vqNSSw==" crossorigin="anonymous" />
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/firacode/5.2.0/fira_code.min.css" integrity="sha512-MbysAYimH1hH2xYzkkMHB6MqxBqfP0megxsCLknbYqHVwXTCg9IqHbk+ZP/vnhO8UEW6PaXAkKe2vQ+SWACxxA==" crossorigin="anonymous" /><script src="alectryon.js"></script></head><body><article class="alectryon-root alectryon-windowed alectryon-coqdoc"><div class="alectryon-banner">Built with <a href="https://github.com/cpitclaudel/alectryon/">Alectryon</a>, running Coq+SerAPI v8.15.0+0.15.2. Bubbles (<span class="alectryon-bubble"></span>) indicate interactive fragments: hover for details, tap to reveal contents. Use <kbd>Ctrl+‚Üë</kbd> <kbd>Ctrl+‚Üì</kbd> to navigate, <kbd>Ctrl+üñ±Ô∏è</kbd> to focus. On Mac, use <kbd>‚åò</kbd> instead of <kbd>Ctrl</kbd>.</div><pre class="alectryon-io highlight"><!-- Generator: Alectryon --><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">From</span> Cdcl <span class="kn">Require Import</span> Itauto.</span><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><span class="alectryon-input">#[local] <span class="kn">Tactic Notation</span> <span class="s2">&quot;itauto&quot;</span> := itauto <span class="nb">auto</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">From</span> stdpp <span class="kn">Require Import</span> prelude finite.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">From</span> VLSM.Lib <span class="kn">Require Import</span> EquationsExtras.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">From</span> VLSM.Lib <span class="kn">Require Import</span> Preamble ListSetExtras ListExtras.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">From</span> VLSM.Core <span class="kn">Require Import</span> VLSM Composition VLSMEmbedding.</span></span></pre><div class="doc">
<a id="lab1"></a><h1 class="section">Traceable VLSMs</h1>
<div class="paragraph"> </div>

  This section introduces <span class="inlinecode"><span class="id" title="var">TraceableVLSM</span></span>s, characterized by the fact that from
  any ram-state we can derive the possible (valid) transitions leading
  to that state.

<div class="paragraph"> </div>

  We derive several properties of these machines and their composition,
  including the possibility of extracting a ram-trace from a ram-state
  (see <span class="inlinecode"><span class="id" title="var">reachable_composite_state_to_trace</span></span>) as well as that of extracting
  a trace with monotonic global equivocation
  (see <span class="inlinecode"><span class="id" title="var">state_to_minimal_equivocation_trace_equivocation_monotonic</span></span>).

</div><pre class="alectryon-io highlight"><!-- Generator: Alectryon --></pre><div class="doc">
  A class with a measure of size for states which is monotonic for valid transitions.

</div><pre class="alectryon-io highlight"><!-- Generator: Alectryon --><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Class</span> <span class="nf">TransitionMonotoneVLSM</span> `(X : VLSM message) (state_size : vstate X -&gt; nat) :=
{
  transition_monotonicity :
    <span class="kr">forall</span> <span class="nv">s1</span> <span class="nv">s2</span> : vstate X, ValidTransitionNext X s1 s2 -&gt; state_size s1 &lt; state_size s2
}.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
</span><span class="alectryon-sentence"><span class="alectryon-input">#[<span class="kn">global</span>] <span class="kn">Hint Mode</span> TransitionMonotoneVLSM - ! - : typeclass_instances.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
</span><span class="alectryon-sentence"><input class="alectryon-toggle" id="TraceableVLSM-v-chk0" style="display: none" type="checkbox"><label class="alectryon-input" for="TraceableVLSM-v-chk0">#[export] <span class="kn">Instance</span> <span class="nf">pre_loaded_TransitionMonotoneVLSM</span>
  `(X : VLSM message) (state_size : vstate X -&gt; nat)
  `{!TransitionMonotoneVLSM X state_size}
  : TransitionMonotoneVLSM (pre_loaded_with_all_messages_vlsm X) state_size.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>message</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>X</var><span class="hyp-type"><b>: </b><span>VLSM message</span></span></span><br><span><var>state_size</var><span class="hyp-type"><b>: </b><span>vstate X ‚Üí nat</span></span></span><br><span><var>TransitionMonotoneVLSM0</var><span class="hyp-type"><b>: </b><span>TransitionMonotoneVLSM X
  state_size</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">TransitionMonotoneVLSM
  (pre_loaded_with_all_messages_vlsm X) state_size</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="TraceableVLSM-v-chk1" style="display: none" type="checkbox"><label class="alectryon-input" for="TraceableVLSM-v-chk1"><span class="kn">Proof</span>.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>message</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>X</var><span class="hyp-type"><b>: </b><span>VLSM message</span></span></span><br><span><var>state_size</var><span class="hyp-type"><b>: </b><span>vstate X ‚Üí nat</span></span></span><br><span><var>TransitionMonotoneVLSM0</var><span class="hyp-type"><b>: </b><span>TransitionMonotoneVLSM X
  state_size</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">TransitionMonotoneVLSM
  (pre_loaded_with_all_messages_vlsm X) state_size</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="TraceableVLSM-v-chk2" style="display: none" type="checkbox"><label class="alectryon-input" for="TraceableVLSM-v-chk2"><span class="nb">constructor</span>; <span class="nb">intros</span> s1 s2 Ht.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>message</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>X</var><span class="hyp-type"><b>: </b><span>VLSM message</span></span></span><br><span><var>state_size</var><span class="hyp-type"><b>: </b><span>vstate X ‚Üí nat</span></span></span><br><span><var>TransitionMonotoneVLSM0</var><span class="hyp-type"><b>: </b><span>TransitionMonotoneVLSM X
  state_size</span></span></span><br><span><var>s1, s2</var><span class="hyp-type"><b>: </b><span>vstate (pre_loaded_with_all_messages_vlsm X)</span></span></span><br><span><var>Ht</var><span class="hyp-type"><b>: </b><span>ValidTransitionNext
  (pre_loaded_with_all_messages_vlsm X) s1 s2</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">state_size s1 &lt; state_size s2</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><span class="alectryon-input"><span class="bp">by</span> <span class="nb">apply</span> transition_monotonicity, ValidTransitionNext_preloaded_iff.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Qed</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
</span><span class="alectryon-sentence"><input class="alectryon-toggle" id="TraceableVLSM-v-chk3" style="display: none" type="checkbox"><label class="alectryon-input" for="TraceableVLSM-v-chk3"><span class="kn">Lemma</span> <span class="nf">transition_monotone_in_futures</span>
  `(X : VLSM message) `{TransitionMonotoneVLSM _ X}
  [s sf : vstate X] (Hfutures : in_futures X s sf) :
  state_size s &lt;= state_size sf.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>message</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>X</var><span class="hyp-type"><b>: </b><span>VLSM message</span></span></span><br><span><var>state_size</var><span class="hyp-type"><b>: </b><span>vstate X ‚Üí nat</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>TransitionMonotoneVLSM X state_size</span></span></span><br><span><var>s, sf</var><span class="hyp-type"><b>: </b><span>vstate X</span></span></span><br><span><var>Hfutures</var><span class="hyp-type"><b>: </b><span>in_futures X s sf</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">state_size s ‚â§ state_size sf</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="TraceableVLSM-v-chk4" style="display: none" type="checkbox"><label class="alectryon-input" for="TraceableVLSM-v-chk4"><span class="kn">Proof</span>.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>message</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>X</var><span class="hyp-type"><b>: </b><span>VLSM message</span></span></span><br><span><var>state_size</var><span class="hyp-type"><b>: </b><span>vstate X ‚Üí nat</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>TransitionMonotoneVLSM X state_size</span></span></span><br><span><var>s, sf</var><span class="hyp-type"><b>: </b><span>vstate X</span></span></span><br><span><var>Hfutures</var><span class="hyp-type"><b>: </b><span>in_futures X s sf</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">state_size s ‚â§ state_size sf</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="TraceableVLSM-v-chk5" style="display: none" type="checkbox"><label class="alectryon-input" for="TraceableVLSM-v-chk5"><span class="nb">destruct</span> Hfutures <span class="kr">as</span> [tr Htr].</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>message</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>X</var><span class="hyp-type"><b>: </b><span>VLSM message</span></span></span><br><span><var>state_size</var><span class="hyp-type"><b>: </b><span>vstate X ‚Üí nat</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>TransitionMonotoneVLSM X state_size</span></span></span><br><span><var>s, sf</var><span class="hyp-type"><b>: </b><span>vstate X</span></span></span><br><span><var>tr</var><span class="hyp-type"><b>: </b><span>list transition_item</span></span></span><br><span><var>Htr</var><span class="hyp-type"><b>: </b><span>finite_valid_trace_from_to X s sf tr</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">state_size s ‚â§ state_size sf</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="TraceableVLSM-v-chk6" style="display: none" type="checkbox"><label class="alectryon-input" for="TraceableVLSM-v-chk6"><span class="nb">induction</span> Htr; [<span class="bp">done</span> |].</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>message</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>X</var><span class="hyp-type"><b>: </b><span>VLSM message</span></span></span><br><span><var>state_size</var><span class="hyp-type"><b>: </b><span>vstate X ‚Üí nat</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>TransitionMonotoneVLSM X state_size</span></span></span><br><span><var>s, f</var><span class="hyp-type"><b>: </b><span>state</span></span></span><br><span><var>tl</var><span class="hyp-type"><b>: </b><span>list transition_item</span></span></span><br><span><var>Htr</var><span class="hyp-type"><b>: </b><span>finite_valid_trace_from_to X s f tl</span></span></span><br><span><var>s'</var><span class="hyp-type"><b>: </b><span>state</span></span></span><br><span><var>iom, oom</var><span class="hyp-type"><b>: </b><span>option message</span></span></span><br><span><var>l</var><span class="hyp-type"><b>: </b><span>label</span></span></span><br><span><var>Ht</var><span class="hyp-type"><b>: </b><span>input_valid_transition X l (s&#39;, iom) (s, oom)</span></span></span><br><span><var>IHHtr</var><span class="hyp-type"><b>: </b><span>state_size s ‚â§ state_size f</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">state_size s&#39; ‚â§ state_size f</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="TraceableVLSM-v-chk7" style="display: none" type="checkbox"><label class="alectryon-input" for="TraceableVLSM-v-chk7"><span class="nb">apply</span> input_valid_transition_forget_input,
    valid_transition_next, transition_monotonicity <span class="kr">in</span> Ht.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>message</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>X</var><span class="hyp-type"><b>: </b><span>VLSM message</span></span></span><br><span><var>state_size</var><span class="hyp-type"><b>: </b><span>vstate X ‚Üí nat</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>TransitionMonotoneVLSM X state_size</span></span></span><br><span><var>s, f</var><span class="hyp-type"><b>: </b><span>state</span></span></span><br><span><var>tl</var><span class="hyp-type"><b>: </b><span>list transition_item</span></span></span><br><span><var>Htr</var><span class="hyp-type"><b>: </b><span>finite_valid_trace_from_to X s f tl</span></span></span><br><span><var>s'</var><span class="hyp-type"><b>: </b><span>state</span></span></span><br><span><var>iom, oom</var><span class="hyp-type"><b>: </b><span>option message</span></span></span><br><span><var>l</var><span class="hyp-type"><b>: </b><span>label</span></span></span><br><span><var>Ht</var><span class="hyp-type"><b>: </b><span>state_size s&#39; &lt; state_size s</span></span></span><br><span><var>IHHtr</var><span class="hyp-type"><b>: </b><span>state_size s ‚â§ state_size f</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">state_size s&#39; ‚â§ state_size f</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><span class="alectryon-input"><span class="bp">by</span> <span class="bp">lia</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Qed</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
</span><span class="alectryon-sentence"><input class="alectryon-toggle" id="TraceableVLSM-v-chk8" style="display: none" type="checkbox"><label class="alectryon-input" for="TraceableVLSM-v-chk8"><span class="kn">Lemma</span> <span class="nf">transition_monotone_empty_trace</span>
  `(X : VLSM message) `{TransitionMonotoneVLSM _ X} :
  <span class="kr">forall</span> [s : vstate X] [tr : list (vtransition_item X)],
    finite_valid_trace_from_to X s s tr -&gt; tr = [].</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>message</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>X</var><span class="hyp-type"><b>: </b><span>VLSM message</span></span></span><br><span><var>state_size</var><span class="hyp-type"><b>: </b><span>vstate X ‚Üí nat</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>TransitionMonotoneVLSM X state_size</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="kr">‚àÄ</span> (<span class="nv">s</span> : vstate X) (<span class="nv">tr</span> : list (vtransition_item X)),
  finite_valid_trace_from_to X s s tr ‚Üí tr = []</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="TraceableVLSM-v-chk9" style="display: none" type="checkbox"><label class="alectryon-input" for="TraceableVLSM-v-chk9"><span class="kn">Proof</span>.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>message</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>X</var><span class="hyp-type"><b>: </b><span>VLSM message</span></span></span><br><span><var>state_size</var><span class="hyp-type"><b>: </b><span>vstate X ‚Üí nat</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>TransitionMonotoneVLSM X state_size</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="kr">‚àÄ</span> (<span class="nv">s</span> : vstate X) (<span class="nv">tr</span> : list (vtransition_item X)),
  finite_valid_trace_from_to X s s tr ‚Üí tr = []</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="TraceableVLSM-v-chka" style="display: none" type="checkbox"><label class="alectryon-input" for="TraceableVLSM-v-chka"><span class="nb">intros</span> s tr Htr; <span class="nb">remember</span> s <span class="kr">as</span> f; <span class="nb">rewrite</span> Heqf <span class="kr">in</span> Htr <span class="nb">at</span> <span class="mi">1</span>.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>message</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>X</var><span class="hyp-type"><b>: </b><span>VLSM message</span></span></span><br><span><var>state_size</var><span class="hyp-type"><b>: </b><span>vstate X ‚Üí nat</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>TransitionMonotoneVLSM X state_size</span></span></span><br><span><var>s</var><span class="hyp-type"><b>: </b><span>vstate X</span></span></span><br><span><var>tr</var><span class="hyp-type"><b>: </b><span>list (vtransition_item X)</span></span></span><br><span><var>f</var><span class="hyp-type"><b>: </b><span>vstate X</span></span></span><br><span><var>Heqf</var><span class="hyp-type"><b>: </b><span>f = s</span></span></span><br><span><var>Htr</var><span class="hyp-type"><b>: </b><span>finite_valid_trace_from_to X s f tr</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">tr = []</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="TraceableVLSM-v-chkb" style="display: none" type="checkbox"><label class="alectryon-input" for="TraceableVLSM-v-chkb"><span class="nb">induction</span> Htr <span class="nb">using</span> finite_valid_trace_from_to_ind; [<span class="bp">done</span> | <span class="nb">subst</span>].</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>message</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>X</var><span class="hyp-type"><b>: </b><span>VLSM message</span></span></span><br><span><var>state_size</var><span class="hyp-type"><b>: </b><span>vstate X ‚Üí nat</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>TransitionMonotoneVLSM X state_size</span></span></span><br><span><var>s', s</var><span class="hyp-type"><b>: </b><span>state</span></span></span><br><span><var>tl</var><span class="hyp-type"><b>: </b><span>list transition_item</span></span></span><br><span><var>Htr</var><span class="hyp-type"><b>: </b><span>finite_valid_trace_from_to X s s&#39; tl</span></span></span><br><span><var>iom, oom</var><span class="hyp-type"><b>: </b><span>option message</span></span></span><br><span><var>l</var><span class="hyp-type"><b>: </b><span>label</span></span></span><br><span><var>Ht</var><span class="hyp-type"><b>: </b><span>input_valid_transition X l (s&#39;, iom) (s, oom)</span></span></span><br><span><var>IHHtr</var><span class="hyp-type"><b>: </b><span>s&#39; = s ‚Üí tl = []</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">{|
  l := l;
  input := iom;
  destination := s;
  output := oom
|} :: tl = []</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="TraceableVLSM-v-chkc" style="display: none" type="checkbox"><label class="alectryon-input" for="TraceableVLSM-v-chkc"><span class="nb">assert</span> (state_size s &lt;= state_size s&#39;)
    <span class="bp">by</span> (<span class="nb">apply</span> transition_monotone_in_futures; [| <span class="nb">eexists</span>]; <span class="bp">done</span>).</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>message</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>X</var><span class="hyp-type"><b>: </b><span>VLSM message</span></span></span><br><span><var>state_size</var><span class="hyp-type"><b>: </b><span>vstate X ‚Üí nat</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>TransitionMonotoneVLSM X state_size</span></span></span><br><span><var>s', s</var><span class="hyp-type"><b>: </b><span>state</span></span></span><br><span><var>tl</var><span class="hyp-type"><b>: </b><span>list transition_item</span></span></span><br><span><var>Htr</var><span class="hyp-type"><b>: </b><span>finite_valid_trace_from_to X s s&#39; tl</span></span></span><br><span><var>iom, oom</var><span class="hyp-type"><b>: </b><span>option message</span></span></span><br><span><var>l</var><span class="hyp-type"><b>: </b><span>label</span></span></span><br><span><var>Ht</var><span class="hyp-type"><b>: </b><span>input_valid_transition X l (s&#39;, iom) (s, oom)</span></span></span><br><span><var>IHHtr</var><span class="hyp-type"><b>: </b><span>s&#39; = s ‚Üí tl = []</span></span></span><br><span><var>H0</var><span class="hyp-type"><b>: </b><span>state_size s ‚â§ state_size s&#39;</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">{|
  l := l;
  input := iom;
  destination := s;
  output := oom
|} :: tl = []</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="TraceableVLSM-v-chkd" style="display: none" type="checkbox"><label class="alectryon-input" for="TraceableVLSM-v-chkd"><span class="nb">apply</span> input_valid_transition_forget_input,
    valid_transition_next, transition_monotonicity <span class="kr">in</span> Ht.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>message</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>X</var><span class="hyp-type"><b>: </b><span>VLSM message</span></span></span><br><span><var>state_size</var><span class="hyp-type"><b>: </b><span>vstate X ‚Üí nat</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>TransitionMonotoneVLSM X state_size</span></span></span><br><span><var>s', s</var><span class="hyp-type"><b>: </b><span>state</span></span></span><br><span><var>tl</var><span class="hyp-type"><b>: </b><span>list transition_item</span></span></span><br><span><var>Htr</var><span class="hyp-type"><b>: </b><span>finite_valid_trace_from_to X s s&#39; tl</span></span></span><br><span><var>iom, oom</var><span class="hyp-type"><b>: </b><span>option message</span></span></span><br><span><var>l</var><span class="hyp-type"><b>: </b><span>label</span></span></span><br><span><var>Ht</var><span class="hyp-type"><b>: </b><span>state_size s&#39; &lt; state_size s</span></span></span><br><span><var>IHHtr</var><span class="hyp-type"><b>: </b><span>s&#39; = s ‚Üí tl = []</span></span></span><br><span><var>H0</var><span class="hyp-type"><b>: </b><span>state_size s ‚â§ state_size s&#39;</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">{|
  l := l;
  input := iom;
  destination := s;
  output := oom
|} :: tl = []</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><span class="alectryon-input"><span class="bp">by</span> <span class="bp">lia</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Qed</span>.</span></span></pre><div class="doc">
  A class characterizing VLSMs with reversible transitions. A VLSM is traceable
  when given a ram-state, one can compute a set of ram-transitions leading to it.

<div class="paragraph"> </div>

  We assume that such machines are <span class="inlinecode"><span class="id" title="var">TransitionMonotoneVLSM</span></span>s and that the
  set of ram-transitions associated to a ram-state is empty iff the state is
  initial.

</div><pre class="alectryon-io highlight"><!-- Generator: Alectryon --><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Class</span> <span class="nf">TraceableVLSM</span>
  `(X : VLSM message)
  (state_destructor : vstate X -&gt; list (vtransition_item X * vstate X))
  (state_size : vstate X -&gt; nat) :=
{
  tv_monotone :&gt; TransitionMonotoneVLSM X state_size;
  tv_state_destructor_destination :
    <span class="kr">forall</span> (<span class="nv">s&#39;</span> <span class="nv">s</span> : vstate X) (<span class="nv">item</span> : vtransition_item X),
      (item, s) ‚àà state_destructor s&#39; -&gt; destination item = s&#39;;
  tv_state_destructor_transition :
    <span class="kr">forall</span> <span class="nv">s&#39;</span> : vstate X,
      valid_state_prop (pre_loaded_with_all_messages_vlsm X) s&#39; -&gt;
      <span class="kr">forall</span> (<span class="nv">s</span> : vstate X) (<span class="nv">item</span> : vtransition_item X),
        (item, s) ‚àà state_destructor s&#39; -&gt;
        input_valid_transition_item (pre_loaded_with_all_messages_vlsm X) s item;
  tv_state_destructor_initial :
    <span class="kr">forall</span> (<span class="nv">s</span> : vstate X) (<span class="nv">Hs</span> : valid_state_prop (pre_loaded_with_all_messages_vlsm X) s),
      vinitial_state_prop X s &lt;-&gt; state_destructor s = []
}.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
</span><span class="alectryon-sentence"><span class="alectryon-input">#[<span class="kn">global</span>] <span class="kn">Hint Mode</span> TraceableVLSM - ! - - : typeclass_instances.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
</span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Section</span> <span class="nf">sec_traceable_vlsm_props</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
</span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Context</span>
  `(X : VLSM message)
  (state_size : vstate X -&gt; nat)
  (state_destructor : vstate X -&gt; list (vtransition_item X * vstate X))
  `{!TraceableVLSM X state_destructor state_size}
  (R := pre_loaded_with_all_messages_vlsm X)
  .</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
</span><span class="alectryon-sentence"><input class="alectryon-toggle" id="TraceableVLSM-v-chke" style="display: none" type="checkbox"><label class="alectryon-input" for="TraceableVLSM-v-chke"><span class="kn">Lemma</span> <span class="nf">tv_state_destructor_size</span> :
  <span class="kr">forall</span> <span class="nv">s&#39;</span> : vstate X, valid_state_prop R s&#39; -&gt;
  <span class="kr">forall</span> (<span class="nv">s</span> : vstate X) (<span class="nv">item</span> : vtransition_item X),
    (item, s) ‚àà state_destructor s&#39; -&gt; state_size s &lt; state_size s&#39;.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>message</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>X</var><span class="hyp-type"><b>: </b><span>VLSM message</span></span></span><br><span><var>state_size</var><span class="hyp-type"><b>: </b><span>vstate X ‚Üí nat</span></span></span><br><span><var>state_destructor</var><span class="hyp-type"><b>: </b><span>vstate X
‚Üí list
    (vtransition_item X * vstate X)</span></span></span><br><span><var>TraceableVLSM0</var><span class="hyp-type"><b>: </b><span>TraceableVLSM X state_destructor
  state_size</span></span></span><br><span><var>R</var><span><span class="hyp-body"><b>:= </b><span>pre_loaded_with_all_messages_vlsm X</span></span><span class="hyp-type"><b>: </b><span>VLSM message</span></span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="kr">‚àÄ</span> <span class="nv">s&#39;</span> : vstate X,
  valid_state_prop R s&#39;
  ‚Üí <span class="kr">‚àÄ</span> (<span class="nv">s</span> : vstate X) (<span class="nv">item</span> : vtransition_item X),
      (item, s) ‚àà state_destructor s&#39;
      ‚Üí state_size s &lt; state_size s&#39;</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="TraceableVLSM-v-chkf" style="display: none" type="checkbox"><label class="alectryon-input" for="TraceableVLSM-v-chkf"><span class="kn">Proof</span>.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>message</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>X</var><span class="hyp-type"><b>: </b><span>VLSM message</span></span></span><br><span><var>state_size</var><span class="hyp-type"><b>: </b><span>vstate X ‚Üí nat</span></span></span><br><span><var>state_destructor</var><span class="hyp-type"><b>: </b><span>vstate X
‚Üí list
    (vtransition_item X * vstate X)</span></span></span><br><span><var>TraceableVLSM0</var><span class="hyp-type"><b>: </b><span>TraceableVLSM X state_destructor
  state_size</span></span></span><br><span><var>R</var><span><span class="hyp-body"><b>:= </b><span>pre_loaded_with_all_messages_vlsm X</span></span><span class="hyp-type"><b>: </b><span>VLSM message</span></span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="kr">‚àÄ</span> <span class="nv">s&#39;</span> : vstate X,
  valid_state_prop R s&#39;
  ‚Üí <span class="kr">‚àÄ</span> (<span class="nv">s</span> : vstate X) (<span class="nv">item</span> : vtransition_item X),
      (item, s) ‚àà state_destructor s&#39;
      ‚Üí state_size s &lt; state_size s&#39;</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="TraceableVLSM-v-chk10" style="display: none" type="checkbox"><label class="alectryon-input" for="TraceableVLSM-v-chk10"><span class="nb">intros</span>.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>message</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>X</var><span class="hyp-type"><b>: </b><span>VLSM message</span></span></span><br><span><var>state_size</var><span class="hyp-type"><b>: </b><span>vstate X ‚Üí nat</span></span></span><br><span><var>state_destructor</var><span class="hyp-type"><b>: </b><span>vstate X
‚Üí list
    (vtransition_item X * vstate X)</span></span></span><br><span><var>TraceableVLSM0</var><span class="hyp-type"><b>: </b><span>TraceableVLSM X state_destructor
  state_size</span></span></span><br><span><var>R</var><span><span class="hyp-body"><b>:= </b><span>pre_loaded_with_all_messages_vlsm X</span></span><span class="hyp-type"><b>: </b><span>VLSM message</span></span></span></span><br><span><var>s'</var><span class="hyp-type"><b>: </b><span>vstate X</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>valid_state_prop R s&#39;</span></span></span><br><span><var>s</var><span class="hyp-type"><b>: </b><span>vstate X</span></span></span><br><span><var>item</var><span class="hyp-type"><b>: </b><span>vtransition_item X</span></span></span><br><span><var>H0</var><span class="hyp-type"><b>: </b><span>(item, s) ‚àà state_destructor s&#39;</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">state_size s &lt; state_size s&#39;</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="TraceableVLSM-v-chk11" style="display: none" type="checkbox"><label class="alectryon-input" for="TraceableVLSM-v-chk11"><span class="nb">apply</span> transition_monotonicity.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>message</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>X</var><span class="hyp-type"><b>: </b><span>VLSM message</span></span></span><br><span><var>state_size</var><span class="hyp-type"><b>: </b><span>vstate X ‚Üí nat</span></span></span><br><span><var>state_destructor</var><span class="hyp-type"><b>: </b><span>vstate X
‚Üí list
    (vtransition_item X * vstate X)</span></span></span><br><span><var>TraceableVLSM0</var><span class="hyp-type"><b>: </b><span>TraceableVLSM X state_destructor
  state_size</span></span></span><br><span><var>R</var><span><span class="hyp-body"><b>:= </b><span>pre_loaded_with_all_messages_vlsm X</span></span><span class="hyp-type"><b>: </b><span>VLSM message</span></span></span></span><br><span><var>s'</var><span class="hyp-type"><b>: </b><span>vstate X</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>valid_state_prop R s&#39;</span></span></span><br><span><var>s</var><span class="hyp-type"><b>: </b><span>vstate X</span></span></span><br><span><var>item</var><span class="hyp-type"><b>: </b><span>vtransition_item X</span></span></span><br><span><var>H0</var><span class="hyp-type"><b>: </b><span>(item, s) ‚àà state_destructor s&#39;</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">ValidTransitionNext X s s&#39;</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="TraceableVLSM-v-chk12" style="display: none" type="checkbox"><label class="alectryon-input" for="TraceableVLSM-v-chk12"><span class="nb">erewrite</span> &lt;- tv_state_destructor_destination <span class="bp">by</span> <span class="bp">done</span>.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>message</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>X</var><span class="hyp-type"><b>: </b><span>VLSM message</span></span></span><br><span><var>state_size</var><span class="hyp-type"><b>: </b><span>vstate X ‚Üí nat</span></span></span><br><span><var>state_destructor</var><span class="hyp-type"><b>: </b><span>vstate X
‚Üí list
    (vtransition_item X * vstate X)</span></span></span><br><span><var>TraceableVLSM0</var><span class="hyp-type"><b>: </b><span>TraceableVLSM X state_destructor
  state_size</span></span></span><br><span><var>R</var><span><span class="hyp-body"><b>:= </b><span>pre_loaded_with_all_messages_vlsm X</span></span><span class="hyp-type"><b>: </b><span>VLSM message</span></span></span></span><br><span><var>s'</var><span class="hyp-type"><b>: </b><span>vstate X</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>valid_state_prop R s&#39;</span></span></span><br><span><var>s</var><span class="hyp-type"><b>: </b><span>vstate X</span></span></span><br><span><var>item</var><span class="hyp-type"><b>: </b><span>vtransition_item X</span></span></span><br><span><var>H0</var><span class="hyp-type"><b>: </b><span>(item, s) ‚àà state_destructor s&#39;</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">ValidTransitionNext X s (destination item)</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="TraceableVLSM-v-chk13" style="display: none" type="checkbox"><label class="alectryon-input" for="TraceableVLSM-v-chk13"><span class="nb">econstructor</span>.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>message</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>X</var><span class="hyp-type"><b>: </b><span>VLSM message</span></span></span><br><span><var>state_size</var><span class="hyp-type"><b>: </b><span>vstate X ‚Üí nat</span></span></span><br><span><var>state_destructor</var><span class="hyp-type"><b>: </b><span>vstate X
‚Üí list
    (vtransition_item X * vstate X)</span></span></span><br><span><var>TraceableVLSM0</var><span class="hyp-type"><b>: </b><span>TraceableVLSM X state_destructor
  state_size</span></span></span><br><span><var>R</var><span><span class="hyp-body"><b>:= </b><span>pre_loaded_with_all_messages_vlsm X</span></span><span class="hyp-type"><b>: </b><span>VLSM message</span></span></span></span><br><span><var>s'</var><span class="hyp-type"><b>: </b><span>vstate X</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>valid_state_prop R s&#39;</span></span></span><br><span><var>s</var><span class="hyp-type"><b>: </b><span>vstate X</span></span></span><br><span><var>item</var><span class="hyp-type"><b>: </b><span>vtransition_item X</span></span></span><br><span><var>H0</var><span class="hyp-type"><b>: </b><span>(item, s) ‚àà state_destructor s&#39;</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">ValidTransition X <span class="nl">?l</span> s <span class="nl">?iom</span> (destination item) <span class="nl">?oom</span></div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><span class="alectryon-input"><span class="bp">by</span> <span class="nb">eapply</span> ValidTransition_preloaded_iff, input_valid_transition_forget_input,
    tv_state_destructor_transition.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Qed</span>.</span></span></pre><div class="doc">
  Given any ram-state we can extract a trace leading to it by recursively
  following the transitions leading to it.

</div><pre class="alectryon-io highlight"><!-- Generator: Alectryon --><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Equations</span> <span class="nf">state_to_trace</span> (<span class="nv">s&#39;</span> : vstate X) (<span class="nv">Hs&#39;</span> : valid_state_prop R s&#39;) :
  vstate X * list (vtransition_item X) <span class="bp">by</span> <span class="kn">wf</span> (state_size s&#39;) lt :=
state_to_trace s&#39; Hs&#39; <span class="kr">with</span> inspect (state_destructor s&#39;) :=
|               [] eq: _         =&gt; (s&#39;, [])
| ((item, s) :: _) eq: Hdestruct =&gt;
  <span class="kr">let</span> (<span class="nv">is</span>, tr) := state_to_trace s _ <span class="kr">in</span> (<span class="kr">is</span>, tr ++ [item]).</span><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="TraceableVLSM-v-chk14" style="display: none" type="checkbox"><label class="alectryon-input" for="TraceableVLSM-v-chk14"><span class="kn">Next Obligation</span>.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>message</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>X</var><span class="hyp-type"><b>: </b><span>VLSM message</span></span></span><br><span><var>state_size</var><span class="hyp-type"><b>: </b><span>vstate X ‚Üí nat</span></span></span><br><span><var>state_destructor</var><span class="hyp-type"><b>: </b><span>vstate X
‚Üí list
    (vtransition_item X * vstate X)</span></span></span><br><span><var>TraceableVLSM0</var><span class="hyp-type"><b>: </b><span>TraceableVLSM X state_destructor
  state_size</span></span></span><br><span><var>R</var><span><span class="hyp-body"><b>:= </b><span>pre_loaded_with_all_messages_vlsm X</span></span><span class="hyp-type"><b>: </b><span>VLSM message</span></span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="kr">‚àÄ</span> (<span class="nv">s&#39;</span> : vstate X) (<span class="nv">item</span> : vtransition_item X) (<span class="nv">s</span> : 
                                               vstate
                                                 X) 
  (<span class="nv">l0</span> : list (vtransition_item X * vstate X)),
  (<span class="kr">Œª</span> <span class="nv">b</span> : list (vtransition_item X * vstate X),
     state_destructor s&#39; = b) ((item, s) :: l0)
  ‚Üí valid_state_prop R s&#39;
    ‚Üí (<span class="kr">‚àÄ</span> <span class="nv">x</span> : vstate X,
         valid_state_prop R x
         ‚Üí state_size x &lt; state_size s&#39;
           ‚Üí vstate X * list (vtransition_item X))
      ‚Üí valid_state_prop R s</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="TraceableVLSM-v-chk15" style="display: none" type="checkbox"><label class="alectryon-input" for="TraceableVLSM-v-chk15"><span class="nb">cbn</span>; <span class="nb">intros</span>.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>message</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>X</var><span class="hyp-type"><b>: </b><span>VLSM message</span></span></span><br><span><var>state_size</var><span class="hyp-type"><b>: </b><span>vstate X ‚Üí nat</span></span></span><br><span><var>state_destructor</var><span class="hyp-type"><b>: </b><span>vstate X
‚Üí list
    (vtransition_item X * vstate X)</span></span></span><br><span><var>TraceableVLSM0</var><span class="hyp-type"><b>: </b><span>TraceableVLSM X state_destructor
  state_size</span></span></span><br><span><var>R</var><span><span class="hyp-body"><b>:= </b><span>pre_loaded_with_all_messages_vlsm X</span></span><span class="hyp-type"><b>: </b><span>VLSM message</span></span></span></span><br><span><var>s'</var><span class="hyp-type"><b>: </b><span>vstate X</span></span></span><br><span><var>item</var><span class="hyp-type"><b>: </b><span>vtransition_item X</span></span></span><br><span><var>s</var><span class="hyp-type"><b>: </b><span>vstate X</span></span></span><br><span><var>l0</var><span class="hyp-type"><b>: </b><span>list (vtransition_item X * vstate X)</span></span></span><br><span><var>Hdestruct</var><span class="hyp-type"><b>: </b><span>state_destructor s&#39; = (item, s) :: l0</span></span></span><br><span><var>Hs'</var><span class="hyp-type"><b>: </b><span>valid_state_prop R s&#39;</span></span></span><br><span><var>state_to_trace</var><span class="hyp-type"><b>: </b><span><span class="kr">‚àÄ</span> <span class="nv">x</span> : vstate X,
  valid_state_prop R x
  ‚Üí state_size x &lt; state_size s&#39;
    ‚Üí vstate X *
      list (vtransition_item X)</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">valid_state_prop R s</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="TraceableVLSM-v-chk16" style="display: none" type="checkbox"><label class="alectryon-input" for="TraceableVLSM-v-chk16"><span class="nb">eapply</span> tv_state_destructor_transition; [<span class="bp">done</span> |].</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>message</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>X</var><span class="hyp-type"><b>: </b><span>VLSM message</span></span></span><br><span><var>state_size</var><span class="hyp-type"><b>: </b><span>vstate X ‚Üí nat</span></span></span><br><span><var>state_destructor</var><span class="hyp-type"><b>: </b><span>vstate X
‚Üí list
    (vtransition_item X * vstate X)</span></span></span><br><span><var>TraceableVLSM0</var><span class="hyp-type"><b>: </b><span>TraceableVLSM X state_destructor
  state_size</span></span></span><br><span><var>R</var><span><span class="hyp-body"><b>:= </b><span>pre_loaded_with_all_messages_vlsm X</span></span><span class="hyp-type"><b>: </b><span>VLSM message</span></span></span></span><br><span><var>s'</var><span class="hyp-type"><b>: </b><span>vstate X</span></span></span><br><span><var>item</var><span class="hyp-type"><b>: </b><span>vtransition_item X</span></span></span><br><span><var>s</var><span class="hyp-type"><b>: </b><span>vstate X</span></span></span><br><span><var>l0</var><span class="hyp-type"><b>: </b><span>list (vtransition_item X * vstate X)</span></span></span><br><span><var>Hdestruct</var><span class="hyp-type"><b>: </b><span>state_destructor s&#39; = (item, s) :: l0</span></span></span><br><span><var>Hs'</var><span class="hyp-type"><b>: </b><span>valid_state_prop R s&#39;</span></span></span><br><span><var>state_to_trace</var><span class="hyp-type"><b>: </b><span><span class="kr">‚àÄ</span> <span class="nv">x</span> : vstate X,
  valid_state_prop R x
  ‚Üí state_size x &lt; state_size s&#39;
    ‚Üí vstate X *
      list (vtransition_item X)</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">(<span class="nl">?item</span>, s) ‚àà state_destructor s&#39;</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><span class="alectryon-input"><span class="bp">by</span> <span class="nb">rewrite</span> Hdestruct; <span class="nb">left</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Qed</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="TraceableVLSM-v-chk17" style="display: none" type="checkbox"><label class="alectryon-input" for="TraceableVLSM-v-chk17"><span class="kn">Next Obligation</span>.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>message</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>X</var><span class="hyp-type"><b>: </b><span>VLSM message</span></span></span><br><span><var>state_size</var><span class="hyp-type"><b>: </b><span>vstate X ‚Üí nat</span></span></span><br><span><var>state_destructor</var><span class="hyp-type"><b>: </b><span>vstate X
‚Üí list
    (vtransition_item X * vstate X)</span></span></span><br><span><var>TraceableVLSM0</var><span class="hyp-type"><b>: </b><span>TraceableVLSM X state_destructor
  state_size</span></span></span><br><span><var>R</var><span><span class="hyp-body"><b>:= </b><span>pre_loaded_with_all_messages_vlsm X</span></span><span class="hyp-type"><b>: </b><span>VLSM message</span></span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="kr">‚àÄ</span> (<span class="nv">s&#39;</span> : vstate X) (<span class="nv">item</span> : vtransition_item X) (<span class="nv">s</span> : 
                                               vstate
                                                 X) 
  (<span class="nv">l0</span> : list (vtransition_item X * vstate X)),
  (<span class="kr">Œª</span> <span class="nv">b</span> : list (vtransition_item X * vstate X),
     state_destructor s&#39; = b) ((item, s) :: l0)
  ‚Üí valid_state_prop R s&#39;
    ‚Üí (<span class="kr">‚àÄ</span> <span class="nv">x</span> : vstate X,
         valid_state_prop R x
         ‚Üí state_size x &lt; state_size s&#39;
           ‚Üí vstate X * list (vtransition_item X))
      ‚Üí state_size s &lt; state_size s&#39;</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="TraceableVLSM-v-chk18" style="display: none" type="checkbox"><label class="alectryon-input" for="TraceableVLSM-v-chk18"><span class="nb">cbn</span>; <span class="nb">intros</span>.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>message</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>X</var><span class="hyp-type"><b>: </b><span>VLSM message</span></span></span><br><span><var>state_size</var><span class="hyp-type"><b>: </b><span>vstate X ‚Üí nat</span></span></span><br><span><var>state_destructor</var><span class="hyp-type"><b>: </b><span>vstate X
‚Üí list
    (vtransition_item X * vstate X)</span></span></span><br><span><var>TraceableVLSM0</var><span class="hyp-type"><b>: </b><span>TraceableVLSM X state_destructor
  state_size</span></span></span><br><span><var>R</var><span><span class="hyp-body"><b>:= </b><span>pre_loaded_with_all_messages_vlsm X</span></span><span class="hyp-type"><b>: </b><span>VLSM message</span></span></span></span><br><span><var>s'</var><span class="hyp-type"><b>: </b><span>vstate X</span></span></span><br><span><var>item</var><span class="hyp-type"><b>: </b><span>vtransition_item X</span></span></span><br><span><var>s</var><span class="hyp-type"><b>: </b><span>vstate X</span></span></span><br><span><var>l0</var><span class="hyp-type"><b>: </b><span>list (vtransition_item X * vstate X)</span></span></span><br><span><var>Hdestruct</var><span class="hyp-type"><b>: </b><span>state_destructor s&#39; = (item, s) :: l0</span></span></span><br><span><var>Hs'</var><span class="hyp-type"><b>: </b><span>valid_state_prop R s&#39;</span></span></span><br><span><var>state_to_trace</var><span class="hyp-type"><b>: </b><span><span class="kr">‚àÄ</span> <span class="nv">x</span> : vstate X,
  valid_state_prop R x
  ‚Üí state_size x &lt; state_size s&#39;
    ‚Üí vstate X *
      list (vtransition_item X)</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">state_size s &lt; state_size s&#39;</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="TraceableVLSM-v-chk19" style="display: none" type="checkbox"><label class="alectryon-input" for="TraceableVLSM-v-chk19"><span class="nb">eapply</span> tv_state_destructor_size; [<span class="bp">done</span> |].</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>message</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>X</var><span class="hyp-type"><b>: </b><span>VLSM message</span></span></span><br><span><var>state_size</var><span class="hyp-type"><b>: </b><span>vstate X ‚Üí nat</span></span></span><br><span><var>state_destructor</var><span class="hyp-type"><b>: </b><span>vstate X
‚Üí list
    (vtransition_item X * vstate X)</span></span></span><br><span><var>TraceableVLSM0</var><span class="hyp-type"><b>: </b><span>TraceableVLSM X state_destructor
  state_size</span></span></span><br><span><var>R</var><span><span class="hyp-body"><b>:= </b><span>pre_loaded_with_all_messages_vlsm X</span></span><span class="hyp-type"><b>: </b><span>VLSM message</span></span></span></span><br><span><var>s'</var><span class="hyp-type"><b>: </b><span>vstate X</span></span></span><br><span><var>item</var><span class="hyp-type"><b>: </b><span>vtransition_item X</span></span></span><br><span><var>s</var><span class="hyp-type"><b>: </b><span>vstate X</span></span></span><br><span><var>l0</var><span class="hyp-type"><b>: </b><span>list (vtransition_item X * vstate X)</span></span></span><br><span><var>Hdestruct</var><span class="hyp-type"><b>: </b><span>state_destructor s&#39; = (item, s) :: l0</span></span></span><br><span><var>Hs'</var><span class="hyp-type"><b>: </b><span>valid_state_prop R s&#39;</span></span></span><br><span><var>state_to_trace</var><span class="hyp-type"><b>: </b><span><span class="kr">‚àÄ</span> <span class="nv">x</span> : vstate X,
  valid_state_prop R x
  ‚Üí state_size x &lt; state_size s&#39;
    ‚Üí vstate X *
      list (vtransition_item X)</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">(<span class="nl">?item</span>, s) ‚àà state_destructor s&#39;</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><span class="alectryon-input"><span class="bp">by</span> <span class="nb">rewrite</span> Hdestruct; <span class="nb">left</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Qed</span>.</span></span></pre><div class="doc">
Traces extracted using <span class="inlinecode"><span class="id" title="var">state_to_trace</span></span> are ram-traces. 
</div><pre class="alectryon-io highlight"><!-- Generator: Alectryon --><span class="alectryon-sentence"><input class="alectryon-toggle" id="TraceableVLSM-v-chk1a" style="display: none" type="checkbox"><label class="alectryon-input" for="TraceableVLSM-v-chk1a"><span class="kn">Lemma</span> <span class="nf">reachable_state_to_trace</span> :
  <span class="kr">forall</span> (<span class="nv">s</span> : vstate X) (<span class="nv">Hs</span> : valid_state_prop R s) <span class="nv">is</span> <span class="nv">tr</span>,
    state_to_trace s Hs = (<span class="kr">is</span>, tr) -&gt; finite_valid_trace_init_to R <span class="kr">is</span> s tr.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>message</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>X</var><span class="hyp-type"><b>: </b><span>VLSM message</span></span></span><br><span><var>state_size</var><span class="hyp-type"><b>: </b><span>vstate X ‚Üí nat</span></span></span><br><span><var>state_destructor</var><span class="hyp-type"><b>: </b><span>vstate X
‚Üí list
    (vtransition_item X * vstate X)</span></span></span><br><span><var>TraceableVLSM0</var><span class="hyp-type"><b>: </b><span>TraceableVLSM X state_destructor
  state_size</span></span></span><br><span><var>R</var><span><span class="hyp-body"><b>:= </b><span>pre_loaded_with_all_messages_vlsm X</span></span><span class="hyp-type"><b>: </b><span>VLSM message</span></span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="kr">‚àÄ</span> (<span class="nv">s</span> : vstate X) (<span class="nv">Hs</span> : valid_state_prop R s) (<span class="nv">is</span> : 
                                              vstate X) 
  (<span class="nv">tr</span> : list (vtransition_item X)),
  state_to_trace s Hs = (<span class="kr">is</span>, tr)
  ‚Üí finite_valid_trace_init_to R <span class="kr">is</span> s tr</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="TraceableVLSM-v-chk1b" style="display: none" type="checkbox"><label class="alectryon-input" for="TraceableVLSM-v-chk1b"><span class="kn">Proof</span>.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>message</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>X</var><span class="hyp-type"><b>: </b><span>VLSM message</span></span></span><br><span><var>state_size</var><span class="hyp-type"><b>: </b><span>vstate X ‚Üí nat</span></span></span><br><span><var>state_destructor</var><span class="hyp-type"><b>: </b><span>vstate X
‚Üí list
    (vtransition_item X * vstate X)</span></span></span><br><span><var>TraceableVLSM0</var><span class="hyp-type"><b>: </b><span>TraceableVLSM X state_destructor
  state_size</span></span></span><br><span><var>R</var><span><span class="hyp-body"><b>:= </b><span>pre_loaded_with_all_messages_vlsm X</span></span><span class="hyp-type"><b>: </b><span>VLSM message</span></span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="kr">‚àÄ</span> (<span class="nv">s</span> : vstate X) (<span class="nv">Hs</span> : valid_state_prop R s) (<span class="nv">is</span> : 
                                              vstate X) 
  (<span class="nv">tr</span> : list (vtransition_item X)),
  state_to_trace s Hs = (<span class="kr">is</span>, tr)
  ‚Üí finite_valid_trace_init_to R <span class="kr">is</span> s tr</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="TraceableVLSM-v-chk1c" style="display: none" type="checkbox"><label class="alectryon-input" for="TraceableVLSM-v-chk1c"><span class="nb">intros</span> s Hs.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>message</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>X</var><span class="hyp-type"><b>: </b><span>VLSM message</span></span></span><br><span><var>state_size</var><span class="hyp-type"><b>: </b><span>vstate X ‚Üí nat</span></span></span><br><span><var>state_destructor</var><span class="hyp-type"><b>: </b><span>vstate X
‚Üí list
    (vtransition_item X * vstate X)</span></span></span><br><span><var>TraceableVLSM0</var><span class="hyp-type"><b>: </b><span>TraceableVLSM X state_destructor
  state_size</span></span></span><br><span><var>R</var><span><span class="hyp-body"><b>:= </b><span>pre_loaded_with_all_messages_vlsm X</span></span><span class="hyp-type"><b>: </b><span>VLSM message</span></span></span></span><br><span><var>s</var><span class="hyp-type"><b>: </b><span>vstate X</span></span></span><br><span><var>Hs</var><span class="hyp-type"><b>: </b><span>valid_state_prop R s</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="kr">‚àÄ</span> (<span class="nv">is</span> : vstate X) (<span class="nv">tr</span> : list (vtransition_item X)),
  state_to_trace s Hs = (<span class="kr">is</span>, tr)
  ‚Üí finite_valid_trace_init_to R <span class="kr">is</span> s tr</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="TraceableVLSM-v-chk1d" style="display: none" type="checkbox"><label class="alectryon-input" for="TraceableVLSM-v-chk1d">apply_funelim (state_to_trace s Hs); <span class="nb">clear</span> s Hs.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>message</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>X</var><span class="hyp-type"><b>: </b><span>VLSM message</span></span></span><br><span><var>state_size</var><span class="hyp-type"><b>: </b><span>vstate X ‚Üí nat</span></span></span><br><span><var>state_destructor</var><span class="hyp-type"><b>: </b><span>vstate X
‚Üí list
    (vtransition_item X * vstate X)</span></span></span><br><span><var>TraceableVLSM0</var><span class="hyp-type"><b>: </b><span>TraceableVLSM X state_destructor
  state_size</span></span></span><br><span><var>R</var><span><span class="hyp-body"><b>:= </b><span>pre_loaded_with_all_messages_vlsm X</span></span><span class="hyp-type"><b>: </b><span>VLSM message</span></span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="kr">‚àÄ</span> (<span class="nv">s&#39;</span> : vstate X) (<span class="nv">e</span> : state_destructor s&#39; = []),
  valid_state_prop R s&#39;
  ‚Üí inspect (state_destructor s&#39;) = [] ‚Üæ e
    ‚Üí <span class="kr">‚àÄ</span> (<span class="nv">is</span> : vstate X) (<span class="nv">tr</span> : list
                                (vtransition_item X)),
        (s&#39;, []) = (<span class="kr">is</span>, tr)
        ‚Üí finite_valid_trace_init_to R <span class="kr">is</span> s&#39; tr</div></blockquote><div class="alectryon-extra-goals"><input class="alectryon-extra-goal-toggle" id="TraceableVLSM-v-chk1e" style="display: none" type="checkbox"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>message</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>X</var><span class="hyp-type"><b>: </b><span>VLSM message</span></span></span><br><span><var>state_size</var><span class="hyp-type"><b>: </b><span>vstate X ‚Üí nat</span></span></span><br><span><var>state_destructor</var><span class="hyp-type"><b>: </b><span>vstate X
‚Üí list
    (vtransition_item X * vstate X)</span></span></span><br><span><var>TraceableVLSM0</var><span class="hyp-type"><b>: </b><span>TraceableVLSM X state_destructor
  state_size</span></span></span><br><span><var>R</var><span><span class="hyp-body"><b>:= </b><span>pre_loaded_with_all_messages_vlsm X</span></span><span class="hyp-type"><b>: </b><span>VLSM message</span></span></span></span><br></div><label class="goal-separator" for="TraceableVLSM-v-chk1e"><hr></label><div class="goal-conclusion"><span class="kr">‚àÄ</span> (<span class="nv">s&#39;</span> : vstate X) (<span class="nv">item</span> : vtransition_item X) 
  (<span class="nv">s</span> : vstate X) (<span class="nv">l0</span> : 
                  list 
                    (vtransition_item X * vstate X)) 
  (<span class="nv">Hdestruct</span> : state_destructor s&#39; = (item, s) :: l0) 
  (<span class="nv">Hs&#39;</span> : valid_state_prop R s&#39;),
  (<span class="kr">‚àÄ</span> (<span class="nv">is</span> : vstate X) (<span class="nv">tr</span> : list (vtransition_item X)),
     state_to_trace s
       (state_to_trace_obligations_obligation_1 s&#39;
          item s l0 Hdestruct Hs&#39;) = 
     (<span class="kr">is</span>, tr) ‚Üí finite_valid_trace_init_to R <span class="kr">is</span> s tr)
  ‚Üí inspect (state_destructor s&#39;) =
    ((item, s) :: l0) ‚Üæ Hdestruct
    ‚Üí <span class="kr">‚àÄ</span> (<span class="nv">is</span> : vstate X) 
        (<span class="nv">tr</span> : list (vtransition_item X)),
        (<span class="kr">let</span> (<span class="nv">is0</span>, tr0) :=
           state_to_trace s
             (state_to_trace_obligations_obligation_1
                s&#39; item s l0 Hdestruct Hs&#39;) <span class="kr">in</span>
         (is0, tr0 ++ [item])) = 
        (<span class="kr">is</span>, tr)
        ‚Üí finite_valid_trace_init_to R <span class="kr">is</span> s&#39; tr</div></blockquote></div></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="TraceableVLSM-v-chk1f" style="display: none" type="checkbox"><label class="alectryon-input" for="TraceableVLSM-v-chk1f">-</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>message</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>X</var><span class="hyp-type"><b>: </b><span>VLSM message</span></span></span><br><span><var>state_size</var><span class="hyp-type"><b>: </b><span>vstate X ‚Üí nat</span></span></span><br><span><var>state_destructor</var><span class="hyp-type"><b>: </b><span>vstate X
‚Üí list
    (vtransition_item X * vstate X)</span></span></span><br><span><var>TraceableVLSM0</var><span class="hyp-type"><b>: </b><span>TraceableVLSM X state_destructor
  state_size</span></span></span><br><span><var>R</var><span><span class="hyp-body"><b>:= </b><span>pre_loaded_with_all_messages_vlsm X</span></span><span class="hyp-type"><b>: </b><span>VLSM message</span></span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="kr">‚àÄ</span> (<span class="nv">s&#39;</span> : vstate X) (<span class="nv">e</span> : state_destructor s&#39; = []),
  valid_state_prop R s&#39;
  ‚Üí inspect (state_destructor s&#39;) = [] ‚Üæ e
    ‚Üí <span class="kr">‚àÄ</span> (<span class="nv">is</span> : vstate X) (<span class="nv">tr</span> : list
                                (vtransition_item X)),
        (s&#39;, []) = (<span class="kr">is</span>, tr)
        ‚Üí finite_valid_trace_init_to R <span class="kr">is</span> s&#39; tr</div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="TraceableVLSM-v-chk20" style="display: none" type="checkbox"><label class="alectryon-input" for="TraceableVLSM-v-chk20"><span class="nb">intros</span> s&#39; Hdestruct ? ? ? ? Heqis_tr.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>message</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>X</var><span class="hyp-type"><b>: </b><span>VLSM message</span></span></span><br><span><var>state_size</var><span class="hyp-type"><b>: </b><span>vstate X ‚Üí nat</span></span></span><br><span><var>state_destructor</var><span class="hyp-type"><b>: </b><span>vstate X
‚Üí list
    (vtransition_item X * vstate X)</span></span></span><br><span><var>TraceableVLSM0</var><span class="hyp-type"><b>: </b><span>TraceableVLSM X state_destructor
  state_size</span></span></span><br><span><var>R</var><span><span class="hyp-body"><b>:= </b><span>pre_loaded_with_all_messages_vlsm X</span></span><span class="hyp-type"><b>: </b><span>VLSM message</span></span></span></span><br><span><var>s'</var><span class="hyp-type"><b>: </b><span>vstate X</span></span></span><br><span><var>Hdestruct</var><span class="hyp-type"><b>: </b><span>state_destructor s&#39; = []</span></span></span><br><span><var>Hs'</var><span class="hyp-type"><b>: </b><span>valid_state_prop R s&#39;</span></span></span><br><span><var>Heq</var><span class="hyp-type"><b>: </b><span>inspect (state_destructor s&#39;) = [] ‚Üæ Hdestruct</span></span></span><br><span><var>is</var><span class="hyp-type"><b>: </b><span>vstate X</span></span></span><br><span><var>tr</var><span class="hyp-type"><b>: </b><span>list (vtransition_item X)</span></span></span><br><span><var>Heqis_tr</var><span class="hyp-type"><b>: </b><span>(s&#39;, []) = (<span class="kr">is</span>, tr)</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">finite_valid_trace_init_to R <span class="kr">is</span> s&#39; tr</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="TraceableVLSM-v-chk21" style="display: none" type="checkbox"><label class="alectryon-input" for="TraceableVLSM-v-chk21"><span class="nb">inversion</span> Heqis_tr; <span class="nb">subst</span>.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>message</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>X</var><span class="hyp-type"><b>: </b><span>VLSM message</span></span></span><br><span><var>state_size</var><span class="hyp-type"><b>: </b><span>vstate X ‚Üí nat</span></span></span><br><span><var>state_destructor</var><span class="hyp-type"><b>: </b><span>vstate X
‚Üí list
    (vtransition_item X * vstate X)</span></span></span><br><span><var>TraceableVLSM0</var><span class="hyp-type"><b>: </b><span>TraceableVLSM X state_destructor
  state_size</span></span></span><br><span><var>R</var><span><span class="hyp-body"><b>:= </b><span>pre_loaded_with_all_messages_vlsm X</span></span><span class="hyp-type"><b>: </b><span>VLSM message</span></span></span></span><br><span><var>is</var><span class="hyp-type"><b>: </b><span>vstate X</span></span></span><br><span><var>Hdestruct</var><span class="hyp-type"><b>: </b><span>state_destructor <span class="kr">is</span> = []</span></span></span><br><span><var>Heq</var><span class="hyp-type"><b>: </b><span>inspect (state_destructor <span class="kr">is</span>) = [] ‚Üæ Hdestruct</span></span></span><br><span><var>Hs'</var><span class="hyp-type"><b>: </b><span>valid_state_prop R <span class="kr">is</span></span></span></span><br><span><var>Heqis_tr</var><span class="hyp-type"><b>: </b><span>(<span class="kr">is</span>, []) = (<span class="kr">is</span>, [])</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">finite_valid_trace_init_to R <span class="kr">is</span> <span class="kr">is</span> []</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><span class="alectryon-input"><span class="bp">by</span> <span class="nb">split</span>; [<span class="nb">constructor</span> | <span class="nb">eapply</span> @tv_state_destructor_initial <span class="kr">with</span> (X := X)].</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="TraceableVLSM-v-chk22" style="display: none" type="checkbox"><label class="alectryon-input" for="TraceableVLSM-v-chk22">-</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>message</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>X</var><span class="hyp-type"><b>: </b><span>VLSM message</span></span></span><br><span><var>state_size</var><span class="hyp-type"><b>: </b><span>vstate X ‚Üí nat</span></span></span><br><span><var>state_destructor</var><span class="hyp-type"><b>: </b><span>vstate X
‚Üí list
    (vtransition_item X * vstate X)</span></span></span><br><span><var>TraceableVLSM0</var><span class="hyp-type"><b>: </b><span>TraceableVLSM X state_destructor
  state_size</span></span></span><br><span><var>R</var><span><span class="hyp-body"><b>:= </b><span>pre_loaded_with_all_messages_vlsm X</span></span><span class="hyp-type"><b>: </b><span>VLSM message</span></span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="kr">‚àÄ</span> (<span class="nv">s&#39;</span> : vstate X) (<span class="nv">item</span> : vtransition_item X) (<span class="nv">s</span> : 
                                               vstate
                                                 X) 
  (<span class="nv">l0</span> : list (vtransition_item X * vstate X)) (<span class="nv">Hdestruct</span> : 
                                               state_destructor
                                                 s&#39; =
                                               (item,
                                               s)
                                               :: l0) 
  (<span class="nv">Hs&#39;</span> : valid_state_prop R s&#39;),
  (<span class="kr">‚àÄ</span> (<span class="nv">is</span> : vstate X) (<span class="nv">tr</span> : list (vtransition_item X)),
     state_to_trace s
       (state_to_trace_obligations_obligation_1 s&#39;
          item s l0 Hdestruct Hs&#39;) = (<span class="kr">is</span>, tr)
     ‚Üí finite_valid_trace_init_to R <span class="kr">is</span> s tr)
  ‚Üí inspect (state_destructor s&#39;) =
    ((item, s) :: l0) ‚Üæ Hdestruct
    ‚Üí <span class="kr">‚àÄ</span> (<span class="nv">is</span> : vstate X) (<span class="nv">tr</span> : list
                                (vtransition_item X)),
        (<span class="kr">let</span> (<span class="nv">is0</span>, tr0) :=
           state_to_trace s
             (state_to_trace_obligations_obligation_1
                s&#39; item s l0 Hdestruct Hs&#39;) <span class="kr">in</span>
         (is0, tr0 ++ [item])) = (<span class="kr">is</span>, tr)
        ‚Üí finite_valid_trace_init_to R <span class="kr">is</span> s&#39; tr</div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="TraceableVLSM-v-chk23" style="display: none" type="checkbox"><label class="alectryon-input" for="TraceableVLSM-v-chk23"><span class="nb">intros</span> ? ? ? ? ? ? Hind ? ? ? Heqis_tr.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>message</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>X</var><span class="hyp-type"><b>: </b><span>VLSM message</span></span></span><br><span><var>state_size</var><span class="hyp-type"><b>: </b><span>vstate X ‚Üí nat</span></span></span><br><span><var>state_destructor</var><span class="hyp-type"><b>: </b><span>vstate X
‚Üí list
    (vtransition_item X * vstate X)</span></span></span><br><span><var>TraceableVLSM0</var><span class="hyp-type"><b>: </b><span>TraceableVLSM X state_destructor
  state_size</span></span></span><br><span><var>R</var><span><span class="hyp-body"><b>:= </b><span>pre_loaded_with_all_messages_vlsm X</span></span><span class="hyp-type"><b>: </b><span>VLSM message</span></span></span></span><br><span><var>s'</var><span class="hyp-type"><b>: </b><span>vstate X</span></span></span><br><span><var>item</var><span class="hyp-type"><b>: </b><span>vtransition_item X</span></span></span><br><span><var>s</var><span class="hyp-type"><b>: </b><span>vstate X</span></span></span><br><span><var>l0</var><span class="hyp-type"><b>: </b><span>list (vtransition_item X * vstate X)</span></span></span><br><span><var>Hdestruct</var><span class="hyp-type"><b>: </b><span>state_destructor s&#39; = (item, s) :: l0</span></span></span><br><span><var>Hs'</var><span class="hyp-type"><b>: </b><span>valid_state_prop R s&#39;</span></span></span><br><span><var>Hind</var><span class="hyp-type"><b>: </b><span><span class="kr">‚àÄ</span> (<span class="nv">is</span> : vstate X) (<span class="nv">tr</span> : 
                   list 
                     (vtransition_item X)),
  state_to_trace s
    (state_to_trace_obligations_obligation_1 s&#39;
       item s l0 Hdestruct Hs&#39;) = 
  (<span class="kr">is</span>, tr)
  ‚Üí finite_valid_trace_init_to R <span class="kr">is</span> s tr</span></span></span><br><span><var>Heq</var><span class="hyp-type"><b>: </b><span>inspect (state_destructor s&#39;) =
((item, s) :: l0) ‚Üæ Hdestruct</span></span></span><br><span><var>is</var><span class="hyp-type"><b>: </b><span>vstate X</span></span></span><br><span><var>tr</var><span class="hyp-type"><b>: </b><span>list (vtransition_item X)</span></span></span><br><span><var>Heqis_tr</var><span class="hyp-type"><b>: </b><span>(<span class="kr">let</span> (<span class="nv">is</span>, tr) :=
   state_to_trace s
     (state_to_trace_obligations_obligation_1
        s&#39; item s l0 Hdestruct Hs&#39;) <span class="kr">in</span>
 (<span class="kr">is</span>, tr ++ [item])) = 
(<span class="kr">is</span>, tr)</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">finite_valid_trace_init_to R <span class="kr">is</span> s&#39; tr</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="TraceableVLSM-v-chk24" style="display: none" type="checkbox"><label class="alectryon-input" for="TraceableVLSM-v-chk24"><span class="nb">destruct</span> (state_to_trace s _) <span class="kr">as</span> [_is _tr]; <span class="nb">inversion</span> Heqis_tr; <span class="nb">subst</span>; <span class="nb">clear</span> Heqis_tr.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>message</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>X</var><span class="hyp-type"><b>: </b><span>VLSM message</span></span></span><br><span><var>state_size</var><span class="hyp-type"><b>: </b><span>vstate X ‚Üí nat</span></span></span><br><span><var>state_destructor</var><span class="hyp-type"><b>: </b><span>vstate X
‚Üí list
    (vtransition_item X * vstate X)</span></span></span><br><span><var>TraceableVLSM0</var><span class="hyp-type"><b>: </b><span>TraceableVLSM X state_destructor
  state_size</span></span></span><br><span><var>R</var><span><span class="hyp-body"><b>:= </b><span>pre_loaded_with_all_messages_vlsm X</span></span><span class="hyp-type"><b>: </b><span>VLSM message</span></span></span></span><br><span><var>s'</var><span class="hyp-type"><b>: </b><span>vstate X</span></span></span><br><span><var>item</var><span class="hyp-type"><b>: </b><span>vtransition_item X</span></span></span><br><span><var>s</var><span class="hyp-type"><b>: </b><span>vstate X</span></span></span><br><span><var>l0</var><span class="hyp-type"><b>: </b><span>list (vtransition_item X * vstate X)</span></span></span><br><span><var>Hdestruct</var><span class="hyp-type"><b>: </b><span>state_destructor s&#39; = (item, s) :: l0</span></span></span><br><span><var>Hs'</var><span class="hyp-type"><b>: </b><span>valid_state_prop R s&#39;</span></span></span><br><span><var>_tr</var><span class="hyp-type"><b>: </b><span>list (vtransition_item X)</span></span></span><br><span><var>is</var><span class="hyp-type"><b>: </b><span>vstate X</span></span></span><br><span><var>Hind</var><span class="hyp-type"><b>: </b><span><span class="kr">‚àÄ</span> (<span class="nv">is0</span> : vstate X) (<span class="nv">tr</span> : 
                    list 
                      (vtransition_item X)),
  (<span class="kr">is</span>, _tr) = (is0, tr)
  ‚Üí finite_valid_trace_init_to R is0 s tr</span></span></span><br><span><var>Heq</var><span class="hyp-type"><b>: </b><span>inspect (state_destructor s&#39;) =
((item, s) :: l0) ‚Üæ Hdestruct</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">finite_valid_trace_init_to R <span class="kr">is</span> s&#39; (_tr ++ [item])</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="TraceableVLSM-v-chk25" style="display: none" type="checkbox"><label class="alectryon-input" for="TraceableVLSM-v-chk25"><span class="nb">split</span>; [| <span class="bp">by</span> <span class="nb">eapply</span> Hind].</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>message</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>X</var><span class="hyp-type"><b>: </b><span>VLSM message</span></span></span><br><span><var>state_size</var><span class="hyp-type"><b>: </b><span>vstate X ‚Üí nat</span></span></span><br><span><var>state_destructor</var><span class="hyp-type"><b>: </b><span>vstate X
‚Üí list
    (vtransition_item X * vstate X)</span></span></span><br><span><var>TraceableVLSM0</var><span class="hyp-type"><b>: </b><span>TraceableVLSM X state_destructor
  state_size</span></span></span><br><span><var>R</var><span><span class="hyp-body"><b>:= </b><span>pre_loaded_with_all_messages_vlsm X</span></span><span class="hyp-type"><b>: </b><span>VLSM message</span></span></span></span><br><span><var>s'</var><span class="hyp-type"><b>: </b><span>vstate X</span></span></span><br><span><var>item</var><span class="hyp-type"><b>: </b><span>vtransition_item X</span></span></span><br><span><var>s</var><span class="hyp-type"><b>: </b><span>vstate X</span></span></span><br><span><var>l0</var><span class="hyp-type"><b>: </b><span>list (vtransition_item X * vstate X)</span></span></span><br><span><var>Hdestruct</var><span class="hyp-type"><b>: </b><span>state_destructor s&#39; = (item, s) :: l0</span></span></span><br><span><var>Hs'</var><span class="hyp-type"><b>: </b><span>valid_state_prop R s&#39;</span></span></span><br><span><var>_tr</var><span class="hyp-type"><b>: </b><span>list (vtransition_item X)</span></span></span><br><span><var>is</var><span class="hyp-type"><b>: </b><span>vstate X</span></span></span><br><span><var>Hind</var><span class="hyp-type"><b>: </b><span><span class="kr">‚àÄ</span> (<span class="nv">is0</span> : vstate X) (<span class="nv">tr</span> : 
                    list 
                      (vtransition_item X)),
  (<span class="kr">is</span>, _tr) = (is0, tr)
  ‚Üí finite_valid_trace_init_to R is0 s tr</span></span></span><br><span><var>Heq</var><span class="hyp-type"><b>: </b><span>inspect (state_destructor s&#39;) =
((item, s) :: l0) ‚Üæ Hdestruct</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">finite_valid_trace_from_to R <span class="kr">is</span> s&#39; (_tr ++ [item])</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="TraceableVLSM-v-chk26" style="display: none" type="checkbox"><label class="alectryon-input" for="TraceableVLSM-v-chk26"><span class="nb">replace</span> s&#39; <span class="kr">with</span> (destination item)
      <span class="bp">by</span> (<span class="nb">eapply</span> tv_state_destructor_destination; <span class="nb">rewrite</span> Hdestruct; <span class="nb">left</span>).</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>message</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>X</var><span class="hyp-type"><b>: </b><span>VLSM message</span></span></span><br><span><var>state_size</var><span class="hyp-type"><b>: </b><span>vstate X ‚Üí nat</span></span></span><br><span><var>state_destructor</var><span class="hyp-type"><b>: </b><span>vstate X
‚Üí list
    (vtransition_item X * vstate X)</span></span></span><br><span><var>TraceableVLSM0</var><span class="hyp-type"><b>: </b><span>TraceableVLSM X state_destructor
  state_size</span></span></span><br><span><var>R</var><span><span class="hyp-body"><b>:= </b><span>pre_loaded_with_all_messages_vlsm X</span></span><span class="hyp-type"><b>: </b><span>VLSM message</span></span></span></span><br><span><var>s'</var><span class="hyp-type"><b>: </b><span>vstate X</span></span></span><br><span><var>item</var><span class="hyp-type"><b>: </b><span>vtransition_item X</span></span></span><br><span><var>s</var><span class="hyp-type"><b>: </b><span>vstate X</span></span></span><br><span><var>l0</var><span class="hyp-type"><b>: </b><span>list (vtransition_item X * vstate X)</span></span></span><br><span><var>Hdestruct</var><span class="hyp-type"><b>: </b><span>state_destructor s&#39; = (item, s) :: l0</span></span></span><br><span><var>Hs'</var><span class="hyp-type"><b>: </b><span>valid_state_prop R s&#39;</span></span></span><br><span><var>_tr</var><span class="hyp-type"><b>: </b><span>list (vtransition_item X)</span></span></span><br><span><var>is</var><span class="hyp-type"><b>: </b><span>vstate X</span></span></span><br><span><var>Hind</var><span class="hyp-type"><b>: </b><span><span class="kr">‚àÄ</span> (<span class="nv">is0</span> : vstate X) (<span class="nv">tr</span> : 
                    list 
                      (vtransition_item X)),
  (<span class="kr">is</span>, _tr) = (is0, tr)
  ‚Üí finite_valid_trace_init_to R is0 s tr</span></span></span><br><span><var>Heq</var><span class="hyp-type"><b>: </b><span>inspect (state_destructor s&#39;) =
((item, s) :: l0) ‚Üæ Hdestruct</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">finite_valid_trace_from_to R <span class="kr">is</span> (destination item)
  (_tr ++ [item])</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="TraceableVLSM-v-chk27" style="display: none" type="checkbox"><label class="alectryon-input" for="TraceableVLSM-v-chk27"><span class="nb">eapply</span> (finite_valid_trace_from_to_app R); [<span class="bp">by</span> <span class="nb">apply</span> Hind |].</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>message</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>X</var><span class="hyp-type"><b>: </b><span>VLSM message</span></span></span><br><span><var>state_size</var><span class="hyp-type"><b>: </b><span>vstate X ‚Üí nat</span></span></span><br><span><var>state_destructor</var><span class="hyp-type"><b>: </b><span>vstate X
‚Üí list
    (vtransition_item X * vstate X)</span></span></span><br><span><var>TraceableVLSM0</var><span class="hyp-type"><b>: </b><span>TraceableVLSM X state_destructor
  state_size</span></span></span><br><span><var>R</var><span><span class="hyp-body"><b>:= </b><span>pre_loaded_with_all_messages_vlsm X</span></span><span class="hyp-type"><b>: </b><span>VLSM message</span></span></span></span><br><span><var>s'</var><span class="hyp-type"><b>: </b><span>vstate X</span></span></span><br><span><var>item</var><span class="hyp-type"><b>: </b><span>vtransition_item X</span></span></span><br><span><var>s</var><span class="hyp-type"><b>: </b><span>vstate X</span></span></span><br><span><var>l0</var><span class="hyp-type"><b>: </b><span>list (vtransition_item X * vstate X)</span></span></span><br><span><var>Hdestruct</var><span class="hyp-type"><b>: </b><span>state_destructor s&#39; = (item, s) :: l0</span></span></span><br><span><var>Hs'</var><span class="hyp-type"><b>: </b><span>valid_state_prop R s&#39;</span></span></span><br><span><var>_tr</var><span class="hyp-type"><b>: </b><span>list (vtransition_item X)</span></span></span><br><span><var>is</var><span class="hyp-type"><b>: </b><span>vstate X</span></span></span><br><span><var>Hind</var><span class="hyp-type"><b>: </b><span><span class="kr">‚àÄ</span> (<span class="nv">is0</span> : vstate X) (<span class="nv">tr</span> : 
                    list 
                      (vtransition_item X)),
  (<span class="kr">is</span>, _tr) = (is0, tr)
  ‚Üí finite_valid_trace_init_to R is0 s tr</span></span></span><br><span><var>Heq</var><span class="hyp-type"><b>: </b><span>inspect (state_destructor s&#39;) =
((item, s) :: l0) ‚Üæ Hdestruct</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">finite_valid_trace_from_to R s (destination item)
  [item]</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="TraceableVLSM-v-chk28" style="display: none" type="checkbox"><label class="alectryon-input" for="TraceableVLSM-v-chk28"><span class="nb">cut</span> (input_valid_transition_item R s item).</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>message</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>X</var><span class="hyp-type"><b>: </b><span>VLSM message</span></span></span><br><span><var>state_size</var><span class="hyp-type"><b>: </b><span>vstate X ‚Üí nat</span></span></span><br><span><var>state_destructor</var><span class="hyp-type"><b>: </b><span>vstate X
‚Üí list
    (vtransition_item X * vstate X)</span></span></span><br><span><var>TraceableVLSM0</var><span class="hyp-type"><b>: </b><span>TraceableVLSM X state_destructor
  state_size</span></span></span><br><span><var>R</var><span><span class="hyp-body"><b>:= </b><span>pre_loaded_with_all_messages_vlsm X</span></span><span class="hyp-type"><b>: </b><span>VLSM message</span></span></span></span><br><span><var>s'</var><span class="hyp-type"><b>: </b><span>vstate X</span></span></span><br><span><var>item</var><span class="hyp-type"><b>: </b><span>vtransition_item X</span></span></span><br><span><var>s</var><span class="hyp-type"><b>: </b><span>vstate X</span></span></span><br><span><var>l0</var><span class="hyp-type"><b>: </b><span>list (vtransition_item X * vstate X)</span></span></span><br><span><var>Hdestruct</var><span class="hyp-type"><b>: </b><span>state_destructor s&#39; = (item, s) :: l0</span></span></span><br><span><var>Hs'</var><span class="hyp-type"><b>: </b><span>valid_state_prop R s&#39;</span></span></span><br><span><var>_tr</var><span class="hyp-type"><b>: </b><span>list (vtransition_item X)</span></span></span><br><span><var>is</var><span class="hyp-type"><b>: </b><span>vstate X</span></span></span><br><span><var>Hind</var><span class="hyp-type"><b>: </b><span><span class="kr">‚àÄ</span> (<span class="nv">is0</span> : vstate X) (<span class="nv">tr</span> : 
                    list 
                      (vtransition_item X)),
  (<span class="kr">is</span>, _tr) = (is0, tr)
  ‚Üí finite_valid_trace_init_to R is0 s tr</span></span></span><br><span><var>Heq</var><span class="hyp-type"><b>: </b><span>inspect (state_destructor s&#39;) =
((item, s) :: l0) ‚Üæ Hdestruct</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">input_valid_transition_item R s item
‚Üí finite_valid_trace_from_to R s (destination item)
    [item]</div></blockquote><div class="alectryon-extra-goals"><input class="alectryon-extra-goal-toggle" id="TraceableVLSM-v-chk29" style="display: none" type="checkbox"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>message</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>X</var><span class="hyp-type"><b>: </b><span>VLSM message</span></span></span><br><span><var>state_size</var><span class="hyp-type"><b>: </b><span>vstate X ‚Üí nat</span></span></span><br><span><var>state_destructor</var><span class="hyp-type"><b>: </b><span>vstate X
‚Üí list
    (vtransition_item X * vstate X)</span></span></span><br><span><var>TraceableVLSM0</var><span class="hyp-type"><b>: </b><span>TraceableVLSM X state_destructor
  state_size</span></span></span><br><span><var>R</var><span><span class="hyp-body"><b>:= </b><span>pre_loaded_with_all_messages_vlsm X</span></span><span class="hyp-type"><b>: </b><span>VLSM message</span></span></span></span><br><span><var>s'</var><span class="hyp-type"><b>: </b><span>vstate X</span></span></span><br><span><var>item</var><span class="hyp-type"><b>: </b><span>vtransition_item X</span></span></span><br><span><var>s</var><span class="hyp-type"><b>: </b><span>vstate X</span></span></span><br><span><var>l0</var><span class="hyp-type"><b>: </b><span>list (vtransition_item X * vstate X)</span></span></span><br><span><var>Hdestruct</var><span class="hyp-type"><b>: </b><span>state_destructor s&#39; = (item, s) :: l0</span></span></span><br><span><var>Hs'</var><span class="hyp-type"><b>: </b><span>valid_state_prop R s&#39;</span></span></span><br><span><var>_tr</var><span class="hyp-type"><b>: </b><span>list (vtransition_item X)</span></span></span><br><span><var>is</var><span class="hyp-type"><b>: </b><span>vstate X</span></span></span><br><span><var>Hind</var><span class="hyp-type"><b>: </b><span><span class="kr">‚àÄ</span> (<span class="nv">is0</span> : vstate X) (<span class="nv">tr</span> : 
                    list 
                      (vtransition_item X)),
  (<span class="kr">is</span>, _tr) = (is0, tr)
  ‚Üí finite_valid_trace_init_to R is0 s tr</span></span></span><br><span><var>Heq</var><span class="hyp-type"><b>: </b><span>inspect (state_destructor s&#39;) =
((item, s) :: l0) ‚Üæ Hdestruct</span></span></span><br></div><label class="goal-separator" for="TraceableVLSM-v-chk29"><hr></label><div class="goal-conclusion">input_valid_transition_item R s item</div></blockquote></div></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="TraceableVLSM-v-chk2a" style="display: none" type="checkbox"><label class="alectryon-input" for="TraceableVLSM-v-chk2a">{</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>message</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>X</var><span class="hyp-type"><b>: </b><span>VLSM message</span></span></span><br><span><var>state_size</var><span class="hyp-type"><b>: </b><span>vstate X ‚Üí nat</span></span></span><br><span><var>state_destructor</var><span class="hyp-type"><b>: </b><span>vstate X
‚Üí list
    (vtransition_item X * vstate X)</span></span></span><br><span><var>TraceableVLSM0</var><span class="hyp-type"><b>: </b><span>TraceableVLSM X state_destructor
  state_size</span></span></span><br><span><var>R</var><span><span class="hyp-body"><b>:= </b><span>pre_loaded_with_all_messages_vlsm X</span></span><span class="hyp-type"><b>: </b><span>VLSM message</span></span></span></span><br><span><var>s'</var><span class="hyp-type"><b>: </b><span>vstate X</span></span></span><br><span><var>item</var><span class="hyp-type"><b>: </b><span>vtransition_item X</span></span></span><br><span><var>s</var><span class="hyp-type"><b>: </b><span>vstate X</span></span></span><br><span><var>l0</var><span class="hyp-type"><b>: </b><span>list (vtransition_item X * vstate X)</span></span></span><br><span><var>Hdestruct</var><span class="hyp-type"><b>: </b><span>state_destructor s&#39; = (item, s) :: l0</span></span></span><br><span><var>Hs'</var><span class="hyp-type"><b>: </b><span>valid_state_prop R s&#39;</span></span></span><br><span><var>_tr</var><span class="hyp-type"><b>: </b><span>list (vtransition_item X)</span></span></span><br><span><var>is</var><span class="hyp-type"><b>: </b><span>vstate X</span></span></span><br><span><var>Hind</var><span class="hyp-type"><b>: </b><span><span class="kr">‚àÄ</span> (<span class="nv">is0</span> : vstate X) (<span class="nv">tr</span> : 
                    list 
                      (vtransition_item X)),
  (<span class="kr">is</span>, _tr) = (is0, tr)
  ‚Üí finite_valid_trace_init_to R is0 s tr</span></span></span><br><span><var>Heq</var><span class="hyp-type"><b>: </b><span>inspect (state_destructor s&#39;) =
((item, s) :: l0) ‚Üæ Hdestruct</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">input_valid_transition_item R s item
‚Üí finite_valid_trace_from_to R s (destination item)
    [item]</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">      </span><span class="alectryon-sentence"><span class="alectryon-input"><span class="bp">by</span> <span class="nb">destruct</span> item; <span class="nb">cbn</span>; <span class="nb">apply</span> (finite_valid_trace_from_to_singleton R).</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="TraceableVLSM-v-chk2b" style="display: none" type="checkbox"><label class="alectryon-input" for="TraceableVLSM-v-chk2b">}</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>message</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>X</var><span class="hyp-type"><b>: </b><span>VLSM message</span></span></span><br><span><var>state_size</var><span class="hyp-type"><b>: </b><span>vstate X ‚Üí nat</span></span></span><br><span><var>state_destructor</var><span class="hyp-type"><b>: </b><span>vstate X
‚Üí list
    (vtransition_item X * vstate X)</span></span></span><br><span><var>TraceableVLSM0</var><span class="hyp-type"><b>: </b><span>TraceableVLSM X state_destructor
  state_size</span></span></span><br><span><var>R</var><span><span class="hyp-body"><b>:= </b><span>pre_loaded_with_all_messages_vlsm X</span></span><span class="hyp-type"><b>: </b><span>VLSM message</span></span></span></span><br><span><var>s'</var><span class="hyp-type"><b>: </b><span>vstate X</span></span></span><br><span><var>item</var><span class="hyp-type"><b>: </b><span>vtransition_item X</span></span></span><br><span><var>s</var><span class="hyp-type"><b>: </b><span>vstate X</span></span></span><br><span><var>l0</var><span class="hyp-type"><b>: </b><span>list (vtransition_item X * vstate X)</span></span></span><br><span><var>Hdestruct</var><span class="hyp-type"><b>: </b><span>state_destructor s&#39; = (item, s) :: l0</span></span></span><br><span><var>Hs'</var><span class="hyp-type"><b>: </b><span>valid_state_prop R s&#39;</span></span></span><br><span><var>_tr</var><span class="hyp-type"><b>: </b><span>list (vtransition_item X)</span></span></span><br><span><var>is</var><span class="hyp-type"><b>: </b><span>vstate X</span></span></span><br><span><var>Hind</var><span class="hyp-type"><b>: </b><span><span class="kr">‚àÄ</span> (<span class="nv">is0</span> : vstate X) (<span class="nv">tr</span> : 
                    list 
                      (vtransition_item X)),
  (<span class="kr">is</span>, _tr) = (is0, tr)
  ‚Üí finite_valid_trace_init_to R is0 s tr</span></span></span><br><span><var>Heq</var><span class="hyp-type"><b>: </b><span>inspect (state_destructor s&#39;) =
((item, s) :: l0) ‚Üæ Hdestruct</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">input_valid_transition_item R s item</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="TraceableVLSM-v-chk2c" style="display: none" type="checkbox"><label class="alectryon-input" for="TraceableVLSM-v-chk2c"><span class="nb">eapply</span> tv_state_destructor_transition; [<span class="bp">done</span> |].</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>message</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>X</var><span class="hyp-type"><b>: </b><span>VLSM message</span></span></span><br><span><var>state_size</var><span class="hyp-type"><b>: </b><span>vstate X ‚Üí nat</span></span></span><br><span><var>state_destructor</var><span class="hyp-type"><b>: </b><span>vstate X
‚Üí list
    (vtransition_item X * vstate X)</span></span></span><br><span><var>TraceableVLSM0</var><span class="hyp-type"><b>: </b><span>TraceableVLSM X state_destructor
  state_size</span></span></span><br><span><var>R</var><span><span class="hyp-body"><b>:= </b><span>pre_loaded_with_all_messages_vlsm X</span></span><span class="hyp-type"><b>: </b><span>VLSM message</span></span></span></span><br><span><var>s'</var><span class="hyp-type"><b>: </b><span>vstate X</span></span></span><br><span><var>item</var><span class="hyp-type"><b>: </b><span>vtransition_item X</span></span></span><br><span><var>s</var><span class="hyp-type"><b>: </b><span>vstate X</span></span></span><br><span><var>l0</var><span class="hyp-type"><b>: </b><span>list (vtransition_item X * vstate X)</span></span></span><br><span><var>Hdestruct</var><span class="hyp-type"><b>: </b><span>state_destructor s&#39; = (item, s) :: l0</span></span></span><br><span><var>Hs'</var><span class="hyp-type"><b>: </b><span>valid_state_prop R s&#39;</span></span></span><br><span><var>_tr</var><span class="hyp-type"><b>: </b><span>list (vtransition_item X)</span></span></span><br><span><var>is</var><span class="hyp-type"><b>: </b><span>vstate X</span></span></span><br><span><var>Hind</var><span class="hyp-type"><b>: </b><span><span class="kr">‚àÄ</span> (<span class="nv">is0</span> : vstate X) (<span class="nv">tr</span> : 
                    list 
                      (vtransition_item X)),
  (<span class="kr">is</span>, _tr) = (is0, tr)
  ‚Üí finite_valid_trace_init_to R is0 s tr</span></span></span><br><span><var>Heq</var><span class="hyp-type"><b>: </b><span>inspect (state_destructor s&#39;) =
((item, s) :: l0) ‚Üæ Hdestruct</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">(item, s) ‚àà state_destructor s&#39;</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><span class="alectryon-input"><span class="bp">by</span> <span class="nb">rewrite</span> Hdestruct; <span class="nb">left</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Qed</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
</span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">End</span> <span class="nf">sec_traceable_vlsm_props</span>.</span></span></pre><div class="doc">
<a id="lab2"></a><h1 class="section">Composition of TraceableVLSMs</h1>
</div><pre class="alectryon-io highlight"><!-- Generator: Alectryon --><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Section</span> <span class="nf">sec_traceable_vlsm_composition</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
</span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Context</span>
  {<span class="nv">message</span> : <span class="kt">Type</span>}
  `{finite.Finite index}
  (IM : index -&gt; VLSM message)
  (state_destructor : <span class="kr">forall</span> <span class="nv">i</span>, vstate (IM i) -&gt; list (vtransition_item (IM i) * vstate (IM i)))
  (state_size : <span class="kr">forall</span> <span class="nv">i</span>, vstate (IM i) -&gt; nat)
  `{<span class="kr">forall</span> <span class="nv">i</span>, TraceableVLSM (IM i) (state_destructor i) (state_size i)}
  (Free := free_composite_vlsm IM)
  (RFree := pre_loaded_with_all_messages_vlsm Free)
  .</span></span></pre><div class="doc">
  The following definitions and lemmas lift the corresponding notions and
  results from <span class="inlinecode"><span class="id" title="var">TraceableVLSM</span></span>s to their composition.

</div><pre class="alectryon-io highlight"><!-- Generator: Alectryon --><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Definition</span> <span class="nf">lift_to_composite_transition_item_state</span>
  (<span class="nv">s</span> : composite_state IM) (<span class="nv">i</span> : index) (<span class="nv">item_s</span> : vtransition_item (IM i) * vstate (IM i))
  : composite_transition_item IM * composite_state IM :=
  (lift_to_composite_transition_item IM s i item_s.<span class="mi">1</span>,
    lift_to_composite_state IM s i item_s.<span class="mi">2</span>).</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
</span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Definition</span> <span class="nf">composite_state_destructor</span> (<span class="nv">s&#39;</span> : composite_state IM) (<span class="nv">i</span> : index)
  : list (composite_transition_item IM * composite_state IM) :=
  map (lift_to_composite_transition_item_state s&#39; i) (state_destructor i (s&#39; i)).</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
</span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Definition</span> <span class="nf">composite_state_size</span> (<span class="nv">s</span> : composite_state IM) :=
  foldr Nat.add <span class="mi">0</span> (map (<span class="kr">fun</span> <span class="nv">i</span> =&gt; state_size i (s i)) (enum index)).</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
</span><span class="alectryon-sentence"><input class="alectryon-toggle" id="TraceableVLSM-v-chk2d" style="display: none" type="checkbox"><label class="alectryon-input" for="TraceableVLSM-v-chk2d"><span class="kn">Lemma</span> <span class="nf">composite_state_update_size_monotone</span> :
  <span class="kr">forall</span> (<span class="nv">s</span> : composite_state IM) (<span class="nv">i</span> : index) (<span class="nv">si</span> : vstate (IM i)),
  state_size i (s i) &lt; state_size i si -&gt;
  composite_state_size s &lt; composite_state_size (lift_to_composite_state  IM s i si).</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>message, index</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>EqDecision0</var><span class="hyp-type"><b>: </b><span>EqDecision index</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>finite.Finite index</span></span></span><br><span><var>IM</var><span class="hyp-type"><b>: </b><span>index ‚Üí VLSM message</span></span></span><br><span><var>state_destructor</var><span class="hyp-type"><b>: </b><span><span class="kr">‚àÄ</span> <span class="nv">i</span> : index,
  vstate (IM i)
  ‚Üí list
      (vtransition_item (IM i) *
       vstate (IM i))</span></span></span><br><span><var>state_size</var><span class="hyp-type"><b>: </b><span><span class="kr">‚àÄ</span> <span class="nv">i</span> : index, vstate (IM i) ‚Üí nat</span></span></span><br><span><var>H0</var><span class="hyp-type"><b>: </b><span><span class="kr">‚àÄ</span> <span class="nv">i</span> : index,
  TraceableVLSM (IM i) 
    (state_destructor i) 
    (state_size i)</span></span></span><br><span><var>Free</var><span><span class="hyp-body"><b>:= </b><span>free_composite_vlsm IM</span></span><span class="hyp-type"><b>: </b><span>VLSM message</span></span></span></span><br><span><var>RFree</var><span><span class="hyp-body"><b>:= </b><span>pre_loaded_with_all_messages_vlsm Free</span></span><span class="hyp-type"><b>: </b><span>VLSM message</span></span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="kr">‚àÄ</span> (<span class="nv">s</span> : composite_state IM) (<span class="nv">i</span> : index) (<span class="nv">si</span> : vstate
                                               (IM i)),
  state_size i (s i) &lt; state_size i si
  ‚Üí composite_state_size s &lt;
    composite_state_size
      (lift_to_composite_state IM s i si)</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="TraceableVLSM-v-chk2e" style="display: none" type="checkbox"><label class="alectryon-input" for="TraceableVLSM-v-chk2e"><span class="kn">Proof</span>.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>message, index</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>EqDecision0</var><span class="hyp-type"><b>: </b><span>EqDecision index</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>finite.Finite index</span></span></span><br><span><var>IM</var><span class="hyp-type"><b>: </b><span>index ‚Üí VLSM message</span></span></span><br><span><var>state_destructor</var><span class="hyp-type"><b>: </b><span><span class="kr">‚àÄ</span> <span class="nv">i</span> : index,
  vstate (IM i)
  ‚Üí list
      (vtransition_item (IM i) *
       vstate (IM i))</span></span></span><br><span><var>state_size</var><span class="hyp-type"><b>: </b><span><span class="kr">‚àÄ</span> <span class="nv">i</span> : index, vstate (IM i) ‚Üí nat</span></span></span><br><span><var>H0</var><span class="hyp-type"><b>: </b><span><span class="kr">‚àÄ</span> <span class="nv">i</span> : index,
  TraceableVLSM (IM i) 
    (state_destructor i) 
    (state_size i)</span></span></span><br><span><var>Free</var><span><span class="hyp-body"><b>:= </b><span>free_composite_vlsm IM</span></span><span class="hyp-type"><b>: </b><span>VLSM message</span></span></span></span><br><span><var>RFree</var><span><span class="hyp-body"><b>:= </b><span>pre_loaded_with_all_messages_vlsm Free</span></span><span class="hyp-type"><b>: </b><span>VLSM message</span></span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="kr">‚àÄ</span> (<span class="nv">s</span> : composite_state IM) (<span class="nv">i</span> : index) (<span class="nv">si</span> : vstate
                                               (IM i)),
  state_size i (s i) &lt; state_size i si
  ‚Üí composite_state_size s &lt;
    composite_state_size
      (lift_to_composite_state IM s i si)</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="TraceableVLSM-v-chk2f" style="display: none" type="checkbox"><label class="alectryon-input" for="TraceableVLSM-v-chk2f"><span class="nb">intros</span> s i si Hlt.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>message, index</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>EqDecision0</var><span class="hyp-type"><b>: </b><span>EqDecision index</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>finite.Finite index</span></span></span><br><span><var>IM</var><span class="hyp-type"><b>: </b><span>index ‚Üí VLSM message</span></span></span><br><span><var>state_destructor</var><span class="hyp-type"><b>: </b><span><span class="kr">‚àÄ</span> <span class="nv">i</span> : index,
  vstate (IM i)
  ‚Üí list
      (vtransition_item (IM i) *
       vstate (IM i))</span></span></span><br><span><var>state_size</var><span class="hyp-type"><b>: </b><span><span class="kr">‚àÄ</span> <span class="nv">i</span> : index, vstate (IM i) ‚Üí nat</span></span></span><br><span><var>H0</var><span class="hyp-type"><b>: </b><span><span class="kr">‚àÄ</span> <span class="nv">i</span> : index,
  TraceableVLSM (IM i) 
    (state_destructor i) 
    (state_size i)</span></span></span><br><span><var>Free</var><span><span class="hyp-body"><b>:= </b><span>free_composite_vlsm IM</span></span><span class="hyp-type"><b>: </b><span>VLSM message</span></span></span></span><br><span><var>RFree</var><span><span class="hyp-body"><b>:= </b><span>pre_loaded_with_all_messages_vlsm Free</span></span><span class="hyp-type"><b>: </b><span>VLSM message</span></span></span></span><br><span><var>s</var><span class="hyp-type"><b>: </b><span>composite_state IM</span></span></span><br><span><var>i</var><span class="hyp-type"><b>: </b><span>index</span></span></span><br><span><var>si</var><span class="hyp-type"><b>: </b><span>vstate (IM i)</span></span></span><br><span><var>Hlt</var><span class="hyp-type"><b>: </b><span>state_size i (s i) &lt; state_size i si</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">composite_state_size s &lt;
composite_state_size
  (lift_to_composite_state IM s i si)</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="TraceableVLSM-v-chk30" style="display: none" type="checkbox"><label class="alectryon-input" for="TraceableVLSM-v-chk30"><span class="nb">unfold</span> composite_state_size.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>message, index</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>EqDecision0</var><span class="hyp-type"><b>: </b><span>EqDecision index</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>finite.Finite index</span></span></span><br><span><var>IM</var><span class="hyp-type"><b>: </b><span>index ‚Üí VLSM message</span></span></span><br><span><var>state_destructor</var><span class="hyp-type"><b>: </b><span><span class="kr">‚àÄ</span> <span class="nv">i</span> : index,
  vstate (IM i)
  ‚Üí list
      (vtransition_item (IM i) *
       vstate (IM i))</span></span></span><br><span><var>state_size</var><span class="hyp-type"><b>: </b><span><span class="kr">‚àÄ</span> <span class="nv">i</span> : index, vstate (IM i) ‚Üí nat</span></span></span><br><span><var>H0</var><span class="hyp-type"><b>: </b><span><span class="kr">‚àÄ</span> <span class="nv">i</span> : index,
  TraceableVLSM (IM i) 
    (state_destructor i) 
    (state_size i)</span></span></span><br><span><var>Free</var><span><span class="hyp-body"><b>:= </b><span>free_composite_vlsm IM</span></span><span class="hyp-type"><b>: </b><span>VLSM message</span></span></span></span><br><span><var>RFree</var><span><span class="hyp-body"><b>:= </b><span>pre_loaded_with_all_messages_vlsm Free</span></span><span class="hyp-type"><b>: </b><span>VLSM message</span></span></span></span><br><span><var>s</var><span class="hyp-type"><b>: </b><span>composite_state IM</span></span></span><br><span><var>i</var><span class="hyp-type"><b>: </b><span>index</span></span></span><br><span><var>si</var><span class="hyp-type"><b>: </b><span>vstate (IM i)</span></span></span><br><span><var>Hlt</var><span class="hyp-type"><b>: </b><span>state_size i (s i) &lt; state_size i si</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">foldr Nat.add <span class="mi">0</span>
  (map (<span class="kr">Œª</span> <span class="nv">i</span> : index, state_size i (s i)) (enum index)) &lt;
foldr Nat.add <span class="mi">0</span>
  (map
     (<span class="kr">Œª</span> <span class="nv">i0</span> : index,
        state_size i0
          (lift_to_composite_state IM s i si i0))
     (enum index))</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="TraceableVLSM-v-chk31" style="display: none" type="checkbox"><label class="alectryon-input" for="TraceableVLSM-v-chk31"><span class="nb">generalize</span> (NoDup_enum index); <span class="nb">generalize</span> (elem_of_enum i); <span class="nb">generalize</span> (enum index).</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>message, index</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>EqDecision0</var><span class="hyp-type"><b>: </b><span>EqDecision index</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>finite.Finite index</span></span></span><br><span><var>IM</var><span class="hyp-type"><b>: </b><span>index ‚Üí VLSM message</span></span></span><br><span><var>state_destructor</var><span class="hyp-type"><b>: </b><span><span class="kr">‚àÄ</span> <span class="nv">i</span> : index,
  vstate (IM i)
  ‚Üí list
      (vtransition_item (IM i) *
       vstate (IM i))</span></span></span><br><span><var>state_size</var><span class="hyp-type"><b>: </b><span><span class="kr">‚àÄ</span> <span class="nv">i</span> : index, vstate (IM i) ‚Üí nat</span></span></span><br><span><var>H0</var><span class="hyp-type"><b>: </b><span><span class="kr">‚àÄ</span> <span class="nv">i</span> : index,
  TraceableVLSM (IM i) 
    (state_destructor i) 
    (state_size i)</span></span></span><br><span><var>Free</var><span><span class="hyp-body"><b>:= </b><span>free_composite_vlsm IM</span></span><span class="hyp-type"><b>: </b><span>VLSM message</span></span></span></span><br><span><var>RFree</var><span><span class="hyp-body"><b>:= </b><span>pre_loaded_with_all_messages_vlsm Free</span></span><span class="hyp-type"><b>: </b><span>VLSM message</span></span></span></span><br><span><var>s</var><span class="hyp-type"><b>: </b><span>composite_state IM</span></span></span><br><span><var>i</var><span class="hyp-type"><b>: </b><span>index</span></span></span><br><span><var>si</var><span class="hyp-type"><b>: </b><span>vstate (IM i)</span></span></span><br><span><var>Hlt</var><span class="hyp-type"><b>: </b><span>state_size i (s i) &lt; state_size i si</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="kr">‚àÄ</span> <span class="nv">l</span> : list index,
  i ‚àà l
  ‚Üí NoDup l
    ‚Üí foldr Nat.add <span class="mi">0</span>
        (map (<span class="kr">Œª</span> <span class="nv">i</span> : index, state_size i (s i)) l) &lt;
      foldr Nat.add <span class="mi">0</span>
        (map
           (<span class="kr">Œª</span> <span class="nv">i0</span> : index,
              state_size i0
                (lift_to_composite_state IM s i si i0))
           l)</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="TraceableVLSM-v-chk32" style="display: none" type="checkbox"><label class="alectryon-input" for="TraceableVLSM-v-chk32"><span class="nb">induction</span> l; <span class="nb">inversion</span> <span class="mi">1</span> <span class="kr">as</span> []; <span class="nb">subst</span>.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>message, index</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>EqDecision0</var><span class="hyp-type"><b>: </b><span>EqDecision index</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>finite.Finite index</span></span></span><br><span><var>IM</var><span class="hyp-type"><b>: </b><span>index ‚Üí VLSM message</span></span></span><br><span><var>state_destructor</var><span class="hyp-type"><b>: </b><span><span class="kr">‚àÄ</span> <span class="nv">i</span> : index,
  vstate (IM i)
  ‚Üí list
      (vtransition_item (IM i) *
       vstate (IM i))</span></span></span><br><span><var>state_size</var><span class="hyp-type"><b>: </b><span><span class="kr">‚àÄ</span> <span class="nv">i</span> : index, vstate (IM i) ‚Üí nat</span></span></span><br><span><var>H0</var><span class="hyp-type"><b>: </b><span><span class="kr">‚àÄ</span> <span class="nv">i</span> : index,
  TraceableVLSM (IM i) 
    (state_destructor i) 
    (state_size i)</span></span></span><br><span><var>Free</var><span><span class="hyp-body"><b>:= </b><span>free_composite_vlsm IM</span></span><span class="hyp-type"><b>: </b><span>VLSM message</span></span></span></span><br><span><var>RFree</var><span><span class="hyp-body"><b>:= </b><span>pre_loaded_with_all_messages_vlsm Free</span></span><span class="hyp-type"><b>: </b><span>VLSM message</span></span></span></span><br><span><var>s</var><span class="hyp-type"><b>: </b><span>composite_state IM</span></span></span><br><span><var>a</var><span class="hyp-type"><b>: </b><span>index</span></span></span><br><span><var>si</var><span class="hyp-type"><b>: </b><span>vstate (IM a)</span></span></span><br><span><var>Hlt</var><span class="hyp-type"><b>: </b><span>state_size a (s a) &lt; state_size a si</span></span></span><br><span><var>l</var><span class="hyp-type"><b>: </b><span>list index</span></span></span><br><span><var>H1</var><span class="hyp-type"><b>: </b><span>a ‚àà a :: l</span></span></span><br><span><var>IHl</var><span class="hyp-type"><b>: </b><span>a ‚àà l
‚Üí NoDup l
  ‚Üí foldr Nat.add <span class="mi">0</span>
      (map (<span class="kr">Œª</span> <span class="nv">i</span> : index, state_size i (s i)) l) &lt;
    foldr Nat.add <span class="mi">0</span>
      (map
         (<span class="kr">Œª</span> <span class="nv">i</span> : index,
            state_size i
              (lift_to_composite_state IM s a si
                 i)) l)</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">NoDup (a :: l)
‚Üí foldr Nat.add <span class="mi">0</span>
    (map (<span class="kr">Œª</span> <span class="nv">i</span> : index, state_size i (s i)) (a :: l)) &lt;
  foldr Nat.add <span class="mi">0</span>
    (map
       (<span class="kr">Œª</span> <span class="nv">i</span> : index,
          state_size i
            (lift_to_composite_state IM s a si i))
       (a :: l))</div></blockquote><div class="alectryon-extra-goals"><input class="alectryon-extra-goal-toggle" id="TraceableVLSM-v-chk33" style="display: none" type="checkbox"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>message, index</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>EqDecision0</var><span class="hyp-type"><b>: </b><span>EqDecision index</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>finite.Finite index</span></span></span><br><span><var>IM</var><span class="hyp-type"><b>: </b><span>index ‚Üí VLSM message</span></span></span><br><span><var>state_destructor</var><span class="hyp-type"><b>: </b><span><span class="kr">‚àÄ</span> <span class="nv">i</span> : index,
  vstate (IM i)
  ‚Üí list
      (vtransition_item (IM i) *
       vstate (IM i))</span></span></span><br><span><var>state_size</var><span class="hyp-type"><b>: </b><span><span class="kr">‚àÄ</span> <span class="nv">i</span> : index, vstate (IM i) ‚Üí nat</span></span></span><br><span><var>H0</var><span class="hyp-type"><b>: </b><span><span class="kr">‚àÄ</span> <span class="nv">i</span> : index,
  TraceableVLSM (IM i) 
    (state_destructor i) 
    (state_size i)</span></span></span><br><span><var>Free</var><span><span class="hyp-body"><b>:= </b><span>free_composite_vlsm IM</span></span><span class="hyp-type"><b>: </b><span>VLSM message</span></span></span></span><br><span><var>RFree</var><span><span class="hyp-body"><b>:= </b><span>pre_loaded_with_all_messages_vlsm Free</span></span><span class="hyp-type"><b>: </b><span>VLSM message</span></span></span></span><br><span><var>s</var><span class="hyp-type"><b>: </b><span>composite_state IM</span></span></span><br><span><var>i</var><span class="hyp-type"><b>: </b><span>index</span></span></span><br><span><var>si</var><span class="hyp-type"><b>: </b><span>vstate (IM i)</span></span></span><br><span><var>Hlt</var><span class="hyp-type"><b>: </b><span>state_size i (s i) &lt; state_size i si</span></span></span><br><span><var>a</var><span class="hyp-type"><b>: </b><span>index</span></span></span><br><span><var>l</var><span class="hyp-type"><b>: </b><span>list index</span></span></span><br><span><var>IHl</var><span class="hyp-type"><b>: </b><span>i ‚àà l
‚Üí NoDup l
  ‚Üí foldr Nat.add <span class="mi">0</span>
      (map (<span class="kr">Œª</span> <span class="nv">i</span> : index, state_size i (s i)) l) &lt;
    foldr Nat.add <span class="mi">0</span>
      (map
         (<span class="kr">Œª</span> <span class="nv">i0</span> : index,
            state_size i0
              (lift_to_composite_state IM s i si
                 i0)) l)</span></span></span><br><span><var>H1</var><span class="hyp-type"><b>: </b><span>i ‚àà a :: l</span></span></span><br><span><var>H2</var><span class="hyp-type"><b>: </b><span>i ‚àà l</span></span></span><br></div><label class="goal-separator" for="TraceableVLSM-v-chk33"><hr></label><div class="goal-conclusion">NoDup (a :: l)
‚Üí foldr Nat.add <span class="mi">0</span>
    (map (<span class="kr">Œª</span> <span class="nv">i</span> : index, state_size i (s i)) (a :: l)) &lt;
  foldr Nat.add <span class="mi">0</span>
    (map
       (<span class="kr">Œª</span> <span class="nv">i0</span> : index,
          state_size i0
            (lift_to_composite_state IM s i si i0))
       (a :: l))</div></blockquote></div></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="TraceableVLSM-v-chk34" style="display: none" type="checkbox"><label class="alectryon-input" for="TraceableVLSM-v-chk34">-</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>message, index</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>EqDecision0</var><span class="hyp-type"><b>: </b><span>EqDecision index</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>finite.Finite index</span></span></span><br><span><var>IM</var><span class="hyp-type"><b>: </b><span>index ‚Üí VLSM message</span></span></span><br><span><var>state_destructor</var><span class="hyp-type"><b>: </b><span><span class="kr">‚àÄ</span> <span class="nv">i</span> : index,
  vstate (IM i)
  ‚Üí list
      (vtransition_item (IM i) *
       vstate (IM i))</span></span></span><br><span><var>state_size</var><span class="hyp-type"><b>: </b><span><span class="kr">‚àÄ</span> <span class="nv">i</span> : index, vstate (IM i) ‚Üí nat</span></span></span><br><span><var>H0</var><span class="hyp-type"><b>: </b><span><span class="kr">‚àÄ</span> <span class="nv">i</span> : index,
  TraceableVLSM (IM i) 
    (state_destructor i) 
    (state_size i)</span></span></span><br><span><var>Free</var><span><span class="hyp-body"><b>:= </b><span>free_composite_vlsm IM</span></span><span class="hyp-type"><b>: </b><span>VLSM message</span></span></span></span><br><span><var>RFree</var><span><span class="hyp-body"><b>:= </b><span>pre_loaded_with_all_messages_vlsm Free</span></span><span class="hyp-type"><b>: </b><span>VLSM message</span></span></span></span><br><span><var>s</var><span class="hyp-type"><b>: </b><span>composite_state IM</span></span></span><br><span><var>a</var><span class="hyp-type"><b>: </b><span>index</span></span></span><br><span><var>si</var><span class="hyp-type"><b>: </b><span>vstate (IM a)</span></span></span><br><span><var>Hlt</var><span class="hyp-type"><b>: </b><span>state_size a (s a) &lt; state_size a si</span></span></span><br><span><var>l</var><span class="hyp-type"><b>: </b><span>list index</span></span></span><br><span><var>H1</var><span class="hyp-type"><b>: </b><span>a ‚àà a :: l</span></span></span><br><span><var>IHl</var><span class="hyp-type"><b>: </b><span>a ‚àà l
‚Üí NoDup l
  ‚Üí foldr Nat.add <span class="mi">0</span>
      (map (<span class="kr">Œª</span> <span class="nv">i</span> : index, state_size i (s i)) l) &lt;
    foldr Nat.add <span class="mi">0</span>
      (map
         (<span class="kr">Œª</span> <span class="nv">i</span> : index,
            state_size i
              (lift_to_composite_state IM s a si
                 i)) l)</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">NoDup (a :: l)
‚Üí foldr Nat.add <span class="mi">0</span>
    (map (<span class="kr">Œª</span> <span class="nv">i</span> : index, state_size i (s i)) (a :: l)) &lt;
  foldr Nat.add <span class="mi">0</span>
    (map
       (<span class="kr">Œª</span> <span class="nv">i</span> : index,
          state_size i
            (lift_to_composite_state IM s a si i))
       (a :: l))</div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="TraceableVLSM-v-chk35" style="display: none" type="checkbox"><label class="alectryon-input" for="TraceableVLSM-v-chk35"><span class="nb">inversion</span> <span class="mi">1</span> <span class="kr">as</span> [| ? ? Hna _]; <span class="nb">subst</span>; <span class="nb">cbn</span>.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>message, index</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>EqDecision0</var><span class="hyp-type"><b>: </b><span>EqDecision index</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>finite.Finite index</span></span></span><br><span><var>IM</var><span class="hyp-type"><b>: </b><span>index ‚Üí VLSM message</span></span></span><br><span><var>state_destructor</var><span class="hyp-type"><b>: </b><span><span class="kr">‚àÄ</span> <span class="nv">i</span> : index,
  vstate (IM i)
  ‚Üí list
      (vtransition_item (IM i) *
       vstate (IM i))</span></span></span><br><span><var>state_size</var><span class="hyp-type"><b>: </b><span><span class="kr">‚àÄ</span> <span class="nv">i</span> : index, vstate (IM i) ‚Üí nat</span></span></span><br><span><var>H0</var><span class="hyp-type"><b>: </b><span><span class="kr">‚àÄ</span> <span class="nv">i</span> : index,
  TraceableVLSM (IM i) 
    (state_destructor i) 
    (state_size i)</span></span></span><br><span><var>Free</var><span><span class="hyp-body"><b>:= </b><span>free_composite_vlsm IM</span></span><span class="hyp-type"><b>: </b><span>VLSM message</span></span></span></span><br><span><var>RFree</var><span><span class="hyp-body"><b>:= </b><span>pre_loaded_with_all_messages_vlsm Free</span></span><span class="hyp-type"><b>: </b><span>VLSM message</span></span></span></span><br><span><var>s</var><span class="hyp-type"><b>: </b><span>composite_state IM</span></span></span><br><span><var>a</var><span class="hyp-type"><b>: </b><span>index</span></span></span><br><span><var>si</var><span class="hyp-type"><b>: </b><span>vstate (IM a)</span></span></span><br><span><var>Hlt</var><span class="hyp-type"><b>: </b><span>state_size a (s a) &lt; state_size a si</span></span></span><br><span><var>l</var><span class="hyp-type"><b>: </b><span>list index</span></span></span><br><span><var>H1</var><span class="hyp-type"><b>: </b><span>a ‚àà a :: l</span></span></span><br><span><var>IHl</var><span class="hyp-type"><b>: </b><span>a ‚àà l
‚Üí NoDup l
  ‚Üí foldr Nat.add <span class="mi">0</span>
      (map (<span class="kr">Œª</span> <span class="nv">i</span> : index, state_size i (s i)) l) &lt;
    foldr Nat.add <span class="mi">0</span>
      (map
         (<span class="kr">Œª</span> <span class="nv">i</span> : index,
            state_size i
              (lift_to_composite_state IM s a si
                 i)) l)</span></span></span><br><span><var>H2</var><span class="hyp-type"><b>: </b><span>NoDup (a :: l)</span></span></span><br><span><var>Hna</var><span class="hyp-type"><b>: </b><span>a ‚àâ l</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">state_size a (s a) +
foldr Nat.add <span class="mi">0</span>
  (map (<span class="kr">Œª</span> <span class="nv">i</span> : index, state_size i (s i)) l) &lt;
state_size a (lift_to_composite_state IM s a si a) +
foldr Nat.add <span class="mi">0</span>
  (map
     (<span class="kr">Œª</span> <span class="nv">i</span> : index,
        state_size i
          (lift_to_composite_state IM s a si i)) l)</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="TraceableVLSM-v-chk36" style="display: none" type="checkbox"><label class="alectryon-input" for="TraceableVLSM-v-chk36"><span class="nb">rewrite</span> state_update_eq.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>message, index</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>EqDecision0</var><span class="hyp-type"><b>: </b><span>EqDecision index</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>finite.Finite index</span></span></span><br><span><var>IM</var><span class="hyp-type"><b>: </b><span>index ‚Üí VLSM message</span></span></span><br><span><var>state_destructor</var><span class="hyp-type"><b>: </b><span><span class="kr">‚àÄ</span> <span class="nv">i</span> : index,
  vstate (IM i)
  ‚Üí list
      (vtransition_item (IM i) *
       vstate (IM i))</span></span></span><br><span><var>state_size</var><span class="hyp-type"><b>: </b><span><span class="kr">‚àÄ</span> <span class="nv">i</span> : index, vstate (IM i) ‚Üí nat</span></span></span><br><span><var>H0</var><span class="hyp-type"><b>: </b><span><span class="kr">‚àÄ</span> <span class="nv">i</span> : index,
  TraceableVLSM (IM i) 
    (state_destructor i) 
    (state_size i)</span></span></span><br><span><var>Free</var><span><span class="hyp-body"><b>:= </b><span>free_composite_vlsm IM</span></span><span class="hyp-type"><b>: </b><span>VLSM message</span></span></span></span><br><span><var>RFree</var><span><span class="hyp-body"><b>:= </b><span>pre_loaded_with_all_messages_vlsm Free</span></span><span class="hyp-type"><b>: </b><span>VLSM message</span></span></span></span><br><span><var>s</var><span class="hyp-type"><b>: </b><span>composite_state IM</span></span></span><br><span><var>a</var><span class="hyp-type"><b>: </b><span>index</span></span></span><br><span><var>si</var><span class="hyp-type"><b>: </b><span>vstate (IM a)</span></span></span><br><span><var>Hlt</var><span class="hyp-type"><b>: </b><span>state_size a (s a) &lt; state_size a si</span></span></span><br><span><var>l</var><span class="hyp-type"><b>: </b><span>list index</span></span></span><br><span><var>H1</var><span class="hyp-type"><b>: </b><span>a ‚àà a :: l</span></span></span><br><span><var>IHl</var><span class="hyp-type"><b>: </b><span>a ‚àà l
‚Üí NoDup l
  ‚Üí foldr Nat.add <span class="mi">0</span>
      (map (<span class="kr">Œª</span> <span class="nv">i</span> : index, state_size i (s i)) l) &lt;
    foldr Nat.add <span class="mi">0</span>
      (map
         (<span class="kr">Œª</span> <span class="nv">i</span> : index,
            state_size i
              (lift_to_composite_state IM s a si
                 i)) l)</span></span></span><br><span><var>H2</var><span class="hyp-type"><b>: </b><span>NoDup (a :: l)</span></span></span><br><span><var>Hna</var><span class="hyp-type"><b>: </b><span>a ‚àâ l</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">state_size a (s a) +
foldr Nat.add <span class="mi">0</span>
  (map (<span class="kr">Œª</span> <span class="nv">i</span> : index, state_size i (s i)) l) &lt;
state_size a si +
foldr Nat.add <span class="mi">0</span>
  (map
     (<span class="kr">Œª</span> <span class="nv">i</span> : index,
        state_size i
          (lift_to_composite_state IM s a si i)) l)</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="TraceableVLSM-v-chk37" style="display: none" type="checkbox"><label class="alectryon-input" for="TraceableVLSM-v-chk37"><span class="nb">replace</span> (foldr Nat.add <span class="mi">0</span> (map (<span class="kr">Œª</span> <span class="nv">i</span> : index, state_size i (s i)) l))
       <span class="kr">with</span> (foldr Nat.add <span class="mi">0</span> (map (<span class="kr">Œª</span> <span class="nv">i</span> : index, state_size i (lift_to_composite_state IM s a si i)) l))
    ; [<span class="bp">lia</span> |].</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>message, index</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>EqDecision0</var><span class="hyp-type"><b>: </b><span>EqDecision index</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>finite.Finite index</span></span></span><br><span><var>IM</var><span class="hyp-type"><b>: </b><span>index ‚Üí VLSM message</span></span></span><br><span><var>state_destructor</var><span class="hyp-type"><b>: </b><span><span class="kr">‚àÄ</span> <span class="nv">i</span> : index,
  vstate (IM i)
  ‚Üí list
      (vtransition_item (IM i) *
       vstate (IM i))</span></span></span><br><span><var>state_size</var><span class="hyp-type"><b>: </b><span><span class="kr">‚àÄ</span> <span class="nv">i</span> : index, vstate (IM i) ‚Üí nat</span></span></span><br><span><var>H0</var><span class="hyp-type"><b>: </b><span><span class="kr">‚àÄ</span> <span class="nv">i</span> : index,
  TraceableVLSM (IM i) 
    (state_destructor i) 
    (state_size i)</span></span></span><br><span><var>Free</var><span><span class="hyp-body"><b>:= </b><span>free_composite_vlsm IM</span></span><span class="hyp-type"><b>: </b><span>VLSM message</span></span></span></span><br><span><var>RFree</var><span><span class="hyp-body"><b>:= </b><span>pre_loaded_with_all_messages_vlsm Free</span></span><span class="hyp-type"><b>: </b><span>VLSM message</span></span></span></span><br><span><var>s</var><span class="hyp-type"><b>: </b><span>composite_state IM</span></span></span><br><span><var>a</var><span class="hyp-type"><b>: </b><span>index</span></span></span><br><span><var>si</var><span class="hyp-type"><b>: </b><span>vstate (IM a)</span></span></span><br><span><var>Hlt</var><span class="hyp-type"><b>: </b><span>state_size a (s a) &lt; state_size a si</span></span></span><br><span><var>l</var><span class="hyp-type"><b>: </b><span>list index</span></span></span><br><span><var>H1</var><span class="hyp-type"><b>: </b><span>a ‚àà a :: l</span></span></span><br><span><var>IHl</var><span class="hyp-type"><b>: </b><span>a ‚àà l
‚Üí NoDup l
  ‚Üí foldr Nat.add <span class="mi">0</span>
      (map (<span class="kr">Œª</span> <span class="nv">i</span> : index, state_size i (s i)) l) &lt;
    foldr Nat.add <span class="mi">0</span>
      (map
         (<span class="kr">Œª</span> <span class="nv">i</span> : index,
            state_size i
              (lift_to_composite_state IM s a si
                 i)) l)</span></span></span><br><span><var>H2</var><span class="hyp-type"><b>: </b><span>NoDup (a :: l)</span></span></span><br><span><var>Hna</var><span class="hyp-type"><b>: </b><span>a ‚àâ l</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">foldr Nat.add <span class="mi">0</span>
  (map
     (<span class="kr">Œª</span> <span class="nv">i</span> : index,
        state_size i
          (lift_to_composite_state IM s a si i)) l) =
foldr Nat.add <span class="mi">0</span>
  (map (<span class="kr">Œª</span> <span class="nv">i</span> : index, state_size i (s i)) l)</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="TraceableVLSM-v-chk38" style="display: none" type="checkbox"><label class="alectryon-input" for="TraceableVLSM-v-chk38"><span class="nb">revert</span> Hna; <span class="nb">clear</span>; <span class="nb">induction</span> l; [<span class="bp">done</span> |].</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>message, index</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>EqDecision0</var><span class="hyp-type"><b>: </b><span>EqDecision index</span></span></span><br><span><var>IM</var><span class="hyp-type"><b>: </b><span>index ‚Üí VLSM message</span></span></span><br><span><var>state_size</var><span class="hyp-type"><b>: </b><span><span class="kr">‚àÄ</span> <span class="nv">i</span> : index, vstate (IM i) ‚Üí nat</span></span></span><br><span><var>s</var><span class="hyp-type"><b>: </b><span>composite_state IM</span></span></span><br><span><var>a</var><span class="hyp-type"><b>: </b><span>index</span></span></span><br><span><var>si</var><span class="hyp-type"><b>: </b><span>vstate (IM a)</span></span></span><br><span><var>a0</var><span class="hyp-type"><b>: </b><span>index</span></span></span><br><span><var>l</var><span class="hyp-type"><b>: </b><span>list index</span></span></span><br><span><var>IHl</var><span class="hyp-type"><b>: </b><span>a ‚àâ l
‚Üí foldr Nat.add <span class="mi">0</span>
    (map
       (<span class="kr">Œª</span> <span class="nv">i</span> : index,
          state_size i
            (lift_to_composite_state IM s a si i))
       l) =
  foldr Nat.add <span class="mi">0</span>
    (map (<span class="kr">Œª</span> <span class="nv">i</span> : index, state_size i (s i)) l)</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">a ‚àâ a0 :: l
‚Üí foldr Nat.add <span class="mi">0</span>
    (map
       (<span class="kr">Œª</span> <span class="nv">i</span> : index,
          state_size i
            (lift_to_composite_state IM s a si i))
       (a0 :: l)) =
  foldr Nat.add <span class="mi">0</span>
    (map (<span class="kr">Œª</span> <span class="nv">i</span> : index, state_size i (s i)) (a0 :: l))</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="TraceableVLSM-v-chk39" style="display: none" type="checkbox"><label class="alectryon-input" for="TraceableVLSM-v-chk39"><span class="nb">intros</span> []%not_elem_of_cons.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>message, index</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>EqDecision0</var><span class="hyp-type"><b>: </b><span>EqDecision index</span></span></span><br><span><var>IM</var><span class="hyp-type"><b>: </b><span>index ‚Üí VLSM message</span></span></span><br><span><var>state_size</var><span class="hyp-type"><b>: </b><span><span class="kr">‚àÄ</span> <span class="nv">i</span> : index, vstate (IM i) ‚Üí nat</span></span></span><br><span><var>s</var><span class="hyp-type"><b>: </b><span>composite_state IM</span></span></span><br><span><var>a</var><span class="hyp-type"><b>: </b><span>index</span></span></span><br><span><var>si</var><span class="hyp-type"><b>: </b><span>vstate (IM a)</span></span></span><br><span><var>a0</var><span class="hyp-type"><b>: </b><span>index</span></span></span><br><span><var>l</var><span class="hyp-type"><b>: </b><span>list index</span></span></span><br><span><var>IHl</var><span class="hyp-type"><b>: </b><span>a ‚àâ l
‚Üí foldr Nat.add <span class="mi">0</span>
    (map
       (<span class="kr">Œª</span> <span class="nv">i</span> : index,
          state_size i
            (lift_to_composite_state IM s a si i))
       l) =
  foldr Nat.add <span class="mi">0</span>
    (map (<span class="kr">Œª</span> <span class="nv">i</span> : index, state_size i (s i)) l)</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>a ‚â† a0</span></span></span><br><span><var>H0</var><span class="hyp-type"><b>: </b><span>a ‚àâ l</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">foldr Nat.add <span class="mi">0</span>
  (map
     (<span class="kr">Œª</span> <span class="nv">i</span> : index,
        state_size i
          (lift_to_composite_state IM s a si i))
     (a0 :: l)) =
foldr Nat.add <span class="mi">0</span>
  (map (<span class="kr">Œª</span> <span class="nv">i</span> : index, state_size i (s i)) (a0 :: l))</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><span class="alectryon-input"><span class="bp">by</span> <span class="nb">cbn</span>; <span class="nb">rewrite</span> state_update_neq, IHl.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="TraceableVLSM-v-chk3a" style="display: none" type="checkbox"><label class="alectryon-input" for="TraceableVLSM-v-chk3a">-</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>message, index</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>EqDecision0</var><span class="hyp-type"><b>: </b><span>EqDecision index</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>finite.Finite index</span></span></span><br><span><var>IM</var><span class="hyp-type"><b>: </b><span>index ‚Üí VLSM message</span></span></span><br><span><var>state_destructor</var><span class="hyp-type"><b>: </b><span><span class="kr">‚àÄ</span> <span class="nv">i</span> : index,
  vstate (IM i)
  ‚Üí list
      (vtransition_item (IM i) *
       vstate (IM i))</span></span></span><br><span><var>state_size</var><span class="hyp-type"><b>: </b><span><span class="kr">‚àÄ</span> <span class="nv">i</span> : index, vstate (IM i) ‚Üí nat</span></span></span><br><span><var>H0</var><span class="hyp-type"><b>: </b><span><span class="kr">‚àÄ</span> <span class="nv">i</span> : index,
  TraceableVLSM (IM i) 
    (state_destructor i) 
    (state_size i)</span></span></span><br><span><var>Free</var><span><span class="hyp-body"><b>:= </b><span>free_composite_vlsm IM</span></span><span class="hyp-type"><b>: </b><span>VLSM message</span></span></span></span><br><span><var>RFree</var><span><span class="hyp-body"><b>:= </b><span>pre_loaded_with_all_messages_vlsm Free</span></span><span class="hyp-type"><b>: </b><span>VLSM message</span></span></span></span><br><span><var>s</var><span class="hyp-type"><b>: </b><span>composite_state IM</span></span></span><br><span><var>i</var><span class="hyp-type"><b>: </b><span>index</span></span></span><br><span><var>si</var><span class="hyp-type"><b>: </b><span>vstate (IM i)</span></span></span><br><span><var>Hlt</var><span class="hyp-type"><b>: </b><span>state_size i (s i) &lt; state_size i si</span></span></span><br><span><var>a</var><span class="hyp-type"><b>: </b><span>index</span></span></span><br><span><var>l</var><span class="hyp-type"><b>: </b><span>list index</span></span></span><br><span><var>IHl</var><span class="hyp-type"><b>: </b><span>i ‚àà l
‚Üí NoDup l
  ‚Üí foldr Nat.add <span class="mi">0</span>
      (map (<span class="kr">Œª</span> <span class="nv">i</span> : index, state_size i (s i)) l) &lt;
    foldr Nat.add <span class="mi">0</span>
      (map
         (<span class="kr">Œª</span> <span class="nv">i0</span> : index,
            state_size i0
              (lift_to_composite_state IM s i si
                 i0)) l)</span></span></span><br><span><var>H1</var><span class="hyp-type"><b>: </b><span>i ‚àà a :: l</span></span></span><br><span><var>H2</var><span class="hyp-type"><b>: </b><span>i ‚àà l</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">NoDup (a :: l)
‚Üí foldr Nat.add <span class="mi">0</span>
    (map (<span class="kr">Œª</span> <span class="nv">i</span> : index, state_size i (s i)) (a :: l)) &lt;
  foldr Nat.add <span class="mi">0</span>
    (map
       (<span class="kr">Œª</span> <span class="nv">i0</span> : index,
          state_size i0
            (lift_to_composite_state IM s i si i0))
       (a :: l))</div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="TraceableVLSM-v-chk3b" style="display: none" type="checkbox"><label class="alectryon-input" for="TraceableVLSM-v-chk3b"><span class="nb">inversion</span> <span class="mi">1</span>; <span class="nb">subst</span>.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>message, index</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>EqDecision0</var><span class="hyp-type"><b>: </b><span>EqDecision index</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>finite.Finite index</span></span></span><br><span><var>IM</var><span class="hyp-type"><b>: </b><span>index ‚Üí VLSM message</span></span></span><br><span><var>state_destructor</var><span class="hyp-type"><b>: </b><span><span class="kr">‚àÄ</span> <span class="nv">i</span> : index,
  vstate (IM i)
  ‚Üí list
      (vtransition_item (IM i) *
       vstate (IM i))</span></span></span><br><span><var>state_size</var><span class="hyp-type"><b>: </b><span><span class="kr">‚àÄ</span> <span class="nv">i</span> : index, vstate (IM i) ‚Üí nat</span></span></span><br><span><var>H0</var><span class="hyp-type"><b>: </b><span><span class="kr">‚àÄ</span> <span class="nv">i</span> : index,
  TraceableVLSM (IM i) 
    (state_destructor i) 
    (state_size i)</span></span></span><br><span><var>Free</var><span><span class="hyp-body"><b>:= </b><span>free_composite_vlsm IM</span></span><span class="hyp-type"><b>: </b><span>VLSM message</span></span></span></span><br><span><var>RFree</var><span><span class="hyp-body"><b>:= </b><span>pre_loaded_with_all_messages_vlsm Free</span></span><span class="hyp-type"><b>: </b><span>VLSM message</span></span></span></span><br><span><var>s</var><span class="hyp-type"><b>: </b><span>composite_state IM</span></span></span><br><span><var>i</var><span class="hyp-type"><b>: </b><span>index</span></span></span><br><span><var>si</var><span class="hyp-type"><b>: </b><span>vstate (IM i)</span></span></span><br><span><var>Hlt</var><span class="hyp-type"><b>: </b><span>state_size i (s i) &lt; state_size i si</span></span></span><br><span><var>a</var><span class="hyp-type"><b>: </b><span>index</span></span></span><br><span><var>l</var><span class="hyp-type"><b>: </b><span>list index</span></span></span><br><span><var>IHl</var><span class="hyp-type"><b>: </b><span>i ‚àà l
‚Üí NoDup l
  ‚Üí foldr Nat.add <span class="mi">0</span>
      (map (<span class="kr">Œª</span> <span class="nv">i</span> : index, state_size i (s i)) l) &lt;
    foldr Nat.add <span class="mi">0</span>
      (map
         (<span class="kr">Œª</span> <span class="nv">i0</span> : index,
            state_size i0
              (lift_to_composite_state IM s i si
                 i0)) l)</span></span></span><br><span><var>H1</var><span class="hyp-type"><b>: </b><span>i ‚àà a :: l</span></span></span><br><span><var>H2</var><span class="hyp-type"><b>: </b><span>i ‚àà l</span></span></span><br><span><var>H3</var><span class="hyp-type"><b>: </b><span>NoDup (a :: l)</span></span></span><br><span><var>H6</var><span class="hyp-type"><b>: </b><span>a ‚àâ l</span></span></span><br><span><var>H7</var><span class="hyp-type"><b>: </b><span>NoDup l</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">foldr Nat.add <span class="mi">0</span>
  (map (<span class="kr">Œª</span> <span class="nv">i</span> : index, state_size i (s i)) (a :: l)) &lt;
foldr Nat.add <span class="mi">0</span>
  (map
     (<span class="kr">Œª</span> <span class="nv">i0</span> : index,
        state_size i0
          (lift_to_composite_state IM s i si i0))
     (a :: l))</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="TraceableVLSM-v-chk3c" style="display: none" type="checkbox"><label class="alectryon-input" for="TraceableVLSM-v-chk3c"><span class="nb">cbn</span>; <span class="nb">rewrite</span> state_update_neq <span class="bp">by</span> <span class="bp">congruence</span>.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>message, index</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>EqDecision0</var><span class="hyp-type"><b>: </b><span>EqDecision index</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>finite.Finite index</span></span></span><br><span><var>IM</var><span class="hyp-type"><b>: </b><span>index ‚Üí VLSM message</span></span></span><br><span><var>state_destructor</var><span class="hyp-type"><b>: </b><span><span class="kr">‚àÄ</span> <span class="nv">i</span> : index,
  vstate (IM i)
  ‚Üí list
      (vtransition_item (IM i) *
       vstate (IM i))</span></span></span><br><span><var>state_size</var><span class="hyp-type"><b>: </b><span><span class="kr">‚àÄ</span> <span class="nv">i</span> : index, vstate (IM i) ‚Üí nat</span></span></span><br><span><var>H0</var><span class="hyp-type"><b>: </b><span><span class="kr">‚àÄ</span> <span class="nv">i</span> : index,
  TraceableVLSM (IM i) 
    (state_destructor i) 
    (state_size i)</span></span></span><br><span><var>Free</var><span><span class="hyp-body"><b>:= </b><span>free_composite_vlsm IM</span></span><span class="hyp-type"><b>: </b><span>VLSM message</span></span></span></span><br><span><var>RFree</var><span><span class="hyp-body"><b>:= </b><span>pre_loaded_with_all_messages_vlsm Free</span></span><span class="hyp-type"><b>: </b><span>VLSM message</span></span></span></span><br><span><var>s</var><span class="hyp-type"><b>: </b><span>composite_state IM</span></span></span><br><span><var>i</var><span class="hyp-type"><b>: </b><span>index</span></span></span><br><span><var>si</var><span class="hyp-type"><b>: </b><span>vstate (IM i)</span></span></span><br><span><var>Hlt</var><span class="hyp-type"><b>: </b><span>state_size i (s i) &lt; state_size i si</span></span></span><br><span><var>a</var><span class="hyp-type"><b>: </b><span>index</span></span></span><br><span><var>l</var><span class="hyp-type"><b>: </b><span>list index</span></span></span><br><span><var>IHl</var><span class="hyp-type"><b>: </b><span>i ‚àà l
‚Üí NoDup l
  ‚Üí foldr Nat.add <span class="mi">0</span>
      (map (<span class="kr">Œª</span> <span class="nv">i</span> : index, state_size i (s i)) l) &lt;
    foldr Nat.add <span class="mi">0</span>
      (map
         (<span class="kr">Œª</span> <span class="nv">i0</span> : index,
            state_size i0
              (lift_to_composite_state IM s i si
                 i0)) l)</span></span></span><br><span><var>H1</var><span class="hyp-type"><b>: </b><span>i ‚àà a :: l</span></span></span><br><span><var>H2</var><span class="hyp-type"><b>: </b><span>i ‚àà l</span></span></span><br><span><var>H3</var><span class="hyp-type"><b>: </b><span>NoDup (a :: l)</span></span></span><br><span><var>H6</var><span class="hyp-type"><b>: </b><span>a ‚àâ l</span></span></span><br><span><var>H7</var><span class="hyp-type"><b>: </b><span>NoDup l</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">state_size a (s a) +
foldr Nat.add <span class="mi">0</span>
  (map (<span class="kr">Œª</span> <span class="nv">i</span> : index, state_size i (s i)) l) &lt;
state_size a (s a) +
foldr Nat.add <span class="mi">0</span>
  (map
     (<span class="kr">Œª</span> <span class="nv">i0</span> : index,
        state_size i0
          (lift_to_composite_state IM s i si i0)) l)</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><span class="alectryon-input"><span class="bp">by</span> <span class="nb">apply</span> Nat.add_lt_mono_l, IHl.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Qed</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
</span><span class="alectryon-sentence"><input class="alectryon-toggle" id="TraceableVLSM-v-chk3d" style="display: none" type="checkbox"><label class="alectryon-input" for="TraceableVLSM-v-chk3d"><span class="kn">Lemma</span> <span class="nf">composite_tv_state_destructor_destination</span> :
  <span class="kr">forall</span> (<span class="nv">s&#39;</span> <span class="nv">s</span> : composite_state IM) (<span class="nv">item</span> : composite_transition_item IM) <span class="nv">i</span>,
     (item, s) ‚àà composite_state_destructor s&#39; i -&gt; destination item = s&#39;.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>message, index</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>EqDecision0</var><span class="hyp-type"><b>: </b><span>EqDecision index</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>finite.Finite index</span></span></span><br><span><var>IM</var><span class="hyp-type"><b>: </b><span>index ‚Üí VLSM message</span></span></span><br><span><var>state_destructor</var><span class="hyp-type"><b>: </b><span><span class="kr">‚àÄ</span> <span class="nv">i</span> : index,
  vstate (IM i)
  ‚Üí list
      (vtransition_item (IM i) *
       vstate (IM i))</span></span></span><br><span><var>state_size</var><span class="hyp-type"><b>: </b><span><span class="kr">‚àÄ</span> <span class="nv">i</span> : index, vstate (IM i) ‚Üí nat</span></span></span><br><span><var>H0</var><span class="hyp-type"><b>: </b><span><span class="kr">‚àÄ</span> <span class="nv">i</span> : index,
  TraceableVLSM (IM i) 
    (state_destructor i) 
    (state_size i)</span></span></span><br><span><var>Free</var><span><span class="hyp-body"><b>:= </b><span>free_composite_vlsm IM</span></span><span class="hyp-type"><b>: </b><span>VLSM message</span></span></span></span><br><span><var>RFree</var><span><span class="hyp-body"><b>:= </b><span>pre_loaded_with_all_messages_vlsm Free</span></span><span class="hyp-type"><b>: </b><span>VLSM message</span></span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="kr">‚àÄ</span> (<span class="nv">s&#39;</span> <span class="nv">s</span> : composite_state IM) (<span class="nv">item</span> : composite_transition_item
                                        IM) (<span class="nv">i</span> : index),
  (item, s) ‚àà composite_state_destructor s&#39; i
  ‚Üí destination item = s&#39;</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="TraceableVLSM-v-chk3e" style="display: none" type="checkbox"><label class="alectryon-input" for="TraceableVLSM-v-chk3e"><span class="kn">Proof</span>.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>message, index</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>EqDecision0</var><span class="hyp-type"><b>: </b><span>EqDecision index</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>finite.Finite index</span></span></span><br><span><var>IM</var><span class="hyp-type"><b>: </b><span>index ‚Üí VLSM message</span></span></span><br><span><var>state_destructor</var><span class="hyp-type"><b>: </b><span><span class="kr">‚àÄ</span> <span class="nv">i</span> : index,
  vstate (IM i)
  ‚Üí list
      (vtransition_item (IM i) *
       vstate (IM i))</span></span></span><br><span><var>state_size</var><span class="hyp-type"><b>: </b><span><span class="kr">‚àÄ</span> <span class="nv">i</span> : index, vstate (IM i) ‚Üí nat</span></span></span><br><span><var>H0</var><span class="hyp-type"><b>: </b><span><span class="kr">‚àÄ</span> <span class="nv">i</span> : index,
  TraceableVLSM (IM i) 
    (state_destructor i) 
    (state_size i)</span></span></span><br><span><var>Free</var><span><span class="hyp-body"><b>:= </b><span>free_composite_vlsm IM</span></span><span class="hyp-type"><b>: </b><span>VLSM message</span></span></span></span><br><span><var>RFree</var><span><span class="hyp-body"><b>:= </b><span>pre_loaded_with_all_messages_vlsm Free</span></span><span class="hyp-type"><b>: </b><span>VLSM message</span></span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="kr">‚àÄ</span> (<span class="nv">s&#39;</span> <span class="nv">s</span> : composite_state IM) (<span class="nv">item</span> : composite_transition_item
                                        IM) (<span class="nv">i</span> : index),
  (item, s) ‚àà composite_state_destructor s&#39; i
  ‚Üí destination item = s&#39;</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="TraceableVLSM-v-chk3f" style="display: none" type="checkbox"><label class="alectryon-input" for="TraceableVLSM-v-chk3f"><span class="nb">intros</span> *; <span class="nb">unfold</span> composite_state_destructor; <span class="nb">rewrite</span> elem_of_list_fmap.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>message, index</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>EqDecision0</var><span class="hyp-type"><b>: </b><span>EqDecision index</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>finite.Finite index</span></span></span><br><span><var>IM</var><span class="hyp-type"><b>: </b><span>index ‚Üí VLSM message</span></span></span><br><span><var>state_destructor</var><span class="hyp-type"><b>: </b><span><span class="kr">‚àÄ</span> <span class="nv">i</span> : index,
  vstate (IM i)
  ‚Üí list
      (vtransition_item (IM i) *
       vstate (IM i))</span></span></span><br><span><var>state_size</var><span class="hyp-type"><b>: </b><span><span class="kr">‚àÄ</span> <span class="nv">i</span> : index, vstate (IM i) ‚Üí nat</span></span></span><br><span><var>H0</var><span class="hyp-type"><b>: </b><span><span class="kr">‚àÄ</span> <span class="nv">i</span> : index,
  TraceableVLSM (IM i) 
    (state_destructor i) 
    (state_size i)</span></span></span><br><span><var>Free</var><span><span class="hyp-body"><b>:= </b><span>free_composite_vlsm IM</span></span><span class="hyp-type"><b>: </b><span>VLSM message</span></span></span></span><br><span><var>RFree</var><span><span class="hyp-body"><b>:= </b><span>pre_loaded_with_all_messages_vlsm Free</span></span><span class="hyp-type"><b>: </b><span>VLSM message</span></span></span></span><br><span><var>s', s</var><span class="hyp-type"><b>: </b><span>composite_state IM</span></span></span><br><span><var>item</var><span class="hyp-type"><b>: </b><span>composite_transition_item IM</span></span></span><br><span><var>i</var><span class="hyp-type"><b>: </b><span>index</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">(<span class="kr">‚àÉ</span> <span class="nv">y</span> : vtransition_item (IM i) * vstate (IM i),
   (item, s) =
   lift_to_composite_transition_item_state s&#39; i y
   ‚àß y ‚àà state_destructor i (s&#39; i))
‚Üí destination item = s&#39;</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="TraceableVLSM-v-chk40" style="display: none" type="checkbox"><label class="alectryon-input" for="TraceableVLSM-v-chk40"><span class="nb">intros</span> ([itemi si] &amp; [= -&gt; -&gt;] &amp; Hin).</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>message, index</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>EqDecision0</var><span class="hyp-type"><b>: </b><span>EqDecision index</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>finite.Finite index</span></span></span><br><span><var>IM</var><span class="hyp-type"><b>: </b><span>index ‚Üí VLSM message</span></span></span><br><span><var>state_destructor</var><span class="hyp-type"><b>: </b><span><span class="kr">‚àÄ</span> <span class="nv">i</span> : index,
  vstate (IM i)
  ‚Üí list
      (vtransition_item (IM i) *
       vstate (IM i))</span></span></span><br><span><var>state_size</var><span class="hyp-type"><b>: </b><span><span class="kr">‚àÄ</span> <span class="nv">i</span> : index, vstate (IM i) ‚Üí nat</span></span></span><br><span><var>H0</var><span class="hyp-type"><b>: </b><span><span class="kr">‚àÄ</span> <span class="nv">i</span> : index,
  TraceableVLSM (IM i) 
    (state_destructor i) 
    (state_size i)</span></span></span><br><span><var>Free</var><span><span class="hyp-body"><b>:= </b><span>free_composite_vlsm IM</span></span><span class="hyp-type"><b>: </b><span>VLSM message</span></span></span></span><br><span><var>RFree</var><span><span class="hyp-body"><b>:= </b><span>pre_loaded_with_all_messages_vlsm Free</span></span><span class="hyp-type"><b>: </b><span>VLSM message</span></span></span></span><br><span><var>s'</var><span class="hyp-type"><b>: </b><span>composite_state IM</span></span></span><br><span><var>i</var><span class="hyp-type"><b>: </b><span>index</span></span></span><br><span><var>itemi</var><span class="hyp-type"><b>: </b><span>vtransition_item (IM i)</span></span></span><br><span><var>si</var><span class="hyp-type"><b>: </b><span>vstate (IM i)</span></span></span><br><span><var>Hin</var><span class="hyp-type"><b>: </b><span>(itemi, si) ‚àà state_destructor i (s&#39; i)</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">destination
  (lift_to_composite_transition_item IM s&#39; i itemi) =
s&#39;</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="TraceableVLSM-v-chk41" style="display: none" type="checkbox"><label class="alectryon-input" for="TraceableVLSM-v-chk41"><span class="nb">cbn</span>; <span class="nb">unfold</span> lift_to_composite_state.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>message, index</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>EqDecision0</var><span class="hyp-type"><b>: </b><span>EqDecision index</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>finite.Finite index</span></span></span><br><span><var>IM</var><span class="hyp-type"><b>: </b><span>index ‚Üí VLSM message</span></span></span><br><span><var>state_destructor</var><span class="hyp-type"><b>: </b><span><span class="kr">‚àÄ</span> <span class="nv">i</span> : index,
  vstate (IM i)
  ‚Üí list
      (vtransition_item (IM i) *
       vstate (IM i))</span></span></span><br><span><var>state_size</var><span class="hyp-type"><b>: </b><span><span class="kr">‚àÄ</span> <span class="nv">i</span> : index, vstate (IM i) ‚Üí nat</span></span></span><br><span><var>H0</var><span class="hyp-type"><b>: </b><span><span class="kr">‚àÄ</span> <span class="nv">i</span> : index,
  TraceableVLSM (IM i) 
    (state_destructor i) 
    (state_size i)</span></span></span><br><span><var>Free</var><span><span class="hyp-body"><b>:= </b><span>free_composite_vlsm IM</span></span><span class="hyp-type"><b>: </b><span>VLSM message</span></span></span></span><br><span><var>RFree</var><span><span class="hyp-body"><b>:= </b><span>pre_loaded_with_all_messages_vlsm Free</span></span><span class="hyp-type"><b>: </b><span>VLSM message</span></span></span></span><br><span><var>s'</var><span class="hyp-type"><b>: </b><span>composite_state IM</span></span></span><br><span><var>i</var><span class="hyp-type"><b>: </b><span>index</span></span></span><br><span><var>itemi</var><span class="hyp-type"><b>: </b><span>vtransition_item (IM i)</span></span></span><br><span><var>si</var><span class="hyp-type"><b>: </b><span>vstate (IM i)</span></span></span><br><span><var>Hin</var><span class="hyp-type"><b>: </b><span>(itemi, si) ‚àà state_destructor i (s&#39; i)</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">state_update IM s&#39; i (destination itemi) = s&#39;</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><span class="alectryon-input"><span class="bp">by</span> <span class="nb">erewrite</span> tv_state_destructor_destination, state_update_id.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Qed</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
</span><span class="alectryon-sentence"><input class="alectryon-toggle" id="TraceableVLSM-v-chk42" style="display: none" type="checkbox"><label class="alectryon-input" for="TraceableVLSM-v-chk42"><span class="kn">Lemma</span> <span class="nf">composite_tv_state_destructor_transition</span> :
  <span class="kr">forall</span> (<span class="nv">s&#39;</span> : composite_state IM), valid_state_prop RFree s&#39; -&gt;
  <span class="kr">forall</span> (<span class="nv">s</span> : composite_state IM) (<span class="nv">item</span> : composite_transition_item IM) (<span class="nv">i</span> : index),
  (item, s) ‚àà composite_state_destructor s&#39; i -&gt;
  input_valid_transition_item RFree s item.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>message, index</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>EqDecision0</var><span class="hyp-type"><b>: </b><span>EqDecision index</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>finite.Finite index</span></span></span><br><span><var>IM</var><span class="hyp-type"><b>: </b><span>index ‚Üí VLSM message</span></span></span><br><span><var>state_destructor</var><span class="hyp-type"><b>: </b><span><span class="kr">‚àÄ</span> <span class="nv">i</span> : index,
  vstate (IM i)
  ‚Üí list
      (vtransition_item (IM i) *
       vstate (IM i))</span></span></span><br><span><var>state_size</var><span class="hyp-type"><b>: </b><span><span class="kr">‚àÄ</span> <span class="nv">i</span> : index, vstate (IM i) ‚Üí nat</span></span></span><br><span><var>H0</var><span class="hyp-type"><b>: </b><span><span class="kr">‚àÄ</span> <span class="nv">i</span> : index,
  TraceableVLSM (IM i) 
    (state_destructor i) 
    (state_size i)</span></span></span><br><span><var>Free</var><span><span class="hyp-body"><b>:= </b><span>free_composite_vlsm IM</span></span><span class="hyp-type"><b>: </b><span>VLSM message</span></span></span></span><br><span><var>RFree</var><span><span class="hyp-body"><b>:= </b><span>pre_loaded_with_all_messages_vlsm Free</span></span><span class="hyp-type"><b>: </b><span>VLSM message</span></span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="kr">‚àÄ</span> <span class="nv">s&#39;</span> : composite_state IM,
  valid_state_prop RFree s&#39;
  ‚Üí <span class="kr">‚àÄ</span> (<span class="nv">s</span> : composite_state IM) (<span class="nv">item</span> : composite_transition_item
                                         IM) (<span class="nv">i</span> : index),
      (item, s) ‚àà composite_state_destructor s&#39; i
      ‚Üí input_valid_transition_item RFree s item</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="TraceableVLSM-v-chk43" style="display: none" type="checkbox"><label class="alectryon-input" for="TraceableVLSM-v-chk43"><span class="kn">Proof</span>.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>message, index</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>EqDecision0</var><span class="hyp-type"><b>: </b><span>EqDecision index</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>finite.Finite index</span></span></span><br><span><var>IM</var><span class="hyp-type"><b>: </b><span>index ‚Üí VLSM message</span></span></span><br><span><var>state_destructor</var><span class="hyp-type"><b>: </b><span><span class="kr">‚àÄ</span> <span class="nv">i</span> : index,
  vstate (IM i)
  ‚Üí list
      (vtransition_item (IM i) *
       vstate (IM i))</span></span></span><br><span><var>state_size</var><span class="hyp-type"><b>: </b><span><span class="kr">‚àÄ</span> <span class="nv">i</span> : index, vstate (IM i) ‚Üí nat</span></span></span><br><span><var>H0</var><span class="hyp-type"><b>: </b><span><span class="kr">‚àÄ</span> <span class="nv">i</span> : index,
  TraceableVLSM (IM i) 
    (state_destructor i) 
    (state_size i)</span></span></span><br><span><var>Free</var><span><span class="hyp-body"><b>:= </b><span>free_composite_vlsm IM</span></span><span class="hyp-type"><b>: </b><span>VLSM message</span></span></span></span><br><span><var>RFree</var><span><span class="hyp-body"><b>:= </b><span>pre_loaded_with_all_messages_vlsm Free</span></span><span class="hyp-type"><b>: </b><span>VLSM message</span></span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="kr">‚àÄ</span> <span class="nv">s&#39;</span> : composite_state IM,
  valid_state_prop RFree s&#39;
  ‚Üí <span class="kr">‚àÄ</span> (<span class="nv">s</span> : composite_state IM) (<span class="nv">item</span> : composite_transition_item
                                         IM) (<span class="nv">i</span> : index),
      (item, s) ‚àà composite_state_destructor s&#39; i
      ‚Üí input_valid_transition_item RFree s item</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="TraceableVLSM-v-chk44" style="display: none" type="checkbox"><label class="alectryon-input" for="TraceableVLSM-v-chk44"><span class="nb">intros</span> s&#39; Hs&#39; s item i.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>message, index</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>EqDecision0</var><span class="hyp-type"><b>: </b><span>EqDecision index</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>finite.Finite index</span></span></span><br><span><var>IM</var><span class="hyp-type"><b>: </b><span>index ‚Üí VLSM message</span></span></span><br><span><var>state_destructor</var><span class="hyp-type"><b>: </b><span><span class="kr">‚àÄ</span> <span class="nv">i</span> : index,
  vstate (IM i)
  ‚Üí list
      (vtransition_item (IM i) *
       vstate (IM i))</span></span></span><br><span><var>state_size</var><span class="hyp-type"><b>: </b><span><span class="kr">‚àÄ</span> <span class="nv">i</span> : index, vstate (IM i) ‚Üí nat</span></span></span><br><span><var>H0</var><span class="hyp-type"><b>: </b><span><span class="kr">‚àÄ</span> <span class="nv">i</span> : index,
  TraceableVLSM (IM i) 
    (state_destructor i) 
    (state_size i)</span></span></span><br><span><var>Free</var><span><span class="hyp-body"><b>:= </b><span>free_composite_vlsm IM</span></span><span class="hyp-type"><b>: </b><span>VLSM message</span></span></span></span><br><span><var>RFree</var><span><span class="hyp-body"><b>:= </b><span>pre_loaded_with_all_messages_vlsm Free</span></span><span class="hyp-type"><b>: </b><span>VLSM message</span></span></span></span><br><span><var>s'</var><span class="hyp-type"><b>: </b><span>composite_state IM</span></span></span><br><span><var>Hs'</var><span class="hyp-type"><b>: </b><span>valid_state_prop RFree s&#39;</span></span></span><br><span><var>s</var><span class="hyp-type"><b>: </b><span>composite_state IM</span></span></span><br><span><var>item</var><span class="hyp-type"><b>: </b><span>composite_transition_item IM</span></span></span><br><span><var>i</var><span class="hyp-type"><b>: </b><span>index</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">(item, s) ‚àà composite_state_destructor s&#39; i
‚Üí input_valid_transition_item RFree s item</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="TraceableVLSM-v-chk45" style="display: none" type="checkbox"><label class="alectryon-input" for="TraceableVLSM-v-chk45"><span class="nb">unfold</span> composite_state_destructor; <span class="nb">rewrite</span> elem_of_list_fmap.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>message, index</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>EqDecision0</var><span class="hyp-type"><b>: </b><span>EqDecision index</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>finite.Finite index</span></span></span><br><span><var>IM</var><span class="hyp-type"><b>: </b><span>index ‚Üí VLSM message</span></span></span><br><span><var>state_destructor</var><span class="hyp-type"><b>: </b><span><span class="kr">‚àÄ</span> <span class="nv">i</span> : index,
  vstate (IM i)
  ‚Üí list
      (vtransition_item (IM i) *
       vstate (IM i))</span></span></span><br><span><var>state_size</var><span class="hyp-type"><b>: </b><span><span class="kr">‚àÄ</span> <span class="nv">i</span> : index, vstate (IM i) ‚Üí nat</span></span></span><br><span><var>H0</var><span class="hyp-type"><b>: </b><span><span class="kr">‚àÄ</span> <span class="nv">i</span> : index,
  TraceableVLSM (IM i) 
    (state_destructor i) 
    (state_size i)</span></span></span><br><span><var>Free</var><span><span class="hyp-body"><b>:= </b><span>free_composite_vlsm IM</span></span><span class="hyp-type"><b>: </b><span>VLSM message</span></span></span></span><br><span><var>RFree</var><span><span class="hyp-body"><b>:= </b><span>pre_loaded_with_all_messages_vlsm Free</span></span><span class="hyp-type"><b>: </b><span>VLSM message</span></span></span></span><br><span><var>s'</var><span class="hyp-type"><b>: </b><span>composite_state IM</span></span></span><br><span><var>Hs'</var><span class="hyp-type"><b>: </b><span>valid_state_prop RFree s&#39;</span></span></span><br><span><var>s</var><span class="hyp-type"><b>: </b><span>composite_state IM</span></span></span><br><span><var>item</var><span class="hyp-type"><b>: </b><span>composite_transition_item IM</span></span></span><br><span><var>i</var><span class="hyp-type"><b>: </b><span>index</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">(<span class="kr">‚àÉ</span> <span class="nv">y</span> : vtransition_item (IM i) * vstate (IM i),
   (item, s) =
   lift_to_composite_transition_item_state s&#39; i y
   ‚àß y ‚àà state_destructor i (s&#39; i))
‚Üí input_valid_transition_item RFree s item</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="TraceableVLSM-v-chk46" style="display: none" type="checkbox"><label class="alectryon-input" for="TraceableVLSM-v-chk46"><span class="nb">intros</span> ([itemi si] &amp; [=-&gt; -&gt;] &amp; Hin).</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>message, index</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>EqDecision0</var><span class="hyp-type"><b>: </b><span>EqDecision index</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>finite.Finite index</span></span></span><br><span><var>IM</var><span class="hyp-type"><b>: </b><span>index ‚Üí VLSM message</span></span></span><br><span><var>state_destructor</var><span class="hyp-type"><b>: </b><span><span class="kr">‚àÄ</span> <span class="nv">i</span> : index,
  vstate (IM i)
  ‚Üí list
      (vtransition_item (IM i) *
       vstate (IM i))</span></span></span><br><span><var>state_size</var><span class="hyp-type"><b>: </b><span><span class="kr">‚àÄ</span> <span class="nv">i</span> : index, vstate (IM i) ‚Üí nat</span></span></span><br><span><var>H0</var><span class="hyp-type"><b>: </b><span><span class="kr">‚àÄ</span> <span class="nv">i</span> : index,
  TraceableVLSM (IM i) 
    (state_destructor i) 
    (state_size i)</span></span></span><br><span><var>Free</var><span><span class="hyp-body"><b>:= </b><span>free_composite_vlsm IM</span></span><span class="hyp-type"><b>: </b><span>VLSM message</span></span></span></span><br><span><var>RFree</var><span><span class="hyp-body"><b>:= </b><span>pre_loaded_with_all_messages_vlsm Free</span></span><span class="hyp-type"><b>: </b><span>VLSM message</span></span></span></span><br><span><var>s'</var><span class="hyp-type"><b>: </b><span>composite_state IM</span></span></span><br><span><var>Hs'</var><span class="hyp-type"><b>: </b><span>valid_state_prop RFree s&#39;</span></span></span><br><span><var>i</var><span class="hyp-type"><b>: </b><span>index</span></span></span><br><span><var>itemi</var><span class="hyp-type"><b>: </b><span>vtransition_item (IM i)</span></span></span><br><span><var>si</var><span class="hyp-type"><b>: </b><span>vstate (IM i)</span></span></span><br><span><var>Hin</var><span class="hyp-type"><b>: </b><span>(itemi, si) ‚àà state_destructor i (s&#39; i)</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">input_valid_transition_item RFree
  (lift_to_composite_state IM s&#39; i si)
  (lift_to_composite_transition_item IM s&#39; i itemi)</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="TraceableVLSM-v-chk47" style="display: none" type="checkbox"><label class="alectryon-input" for="TraceableVLSM-v-chk47"><span class="nb">eapply</span> (VLSM_weak_full_projection_input_valid_transition
           (lift_to_preloaded_free_weak_full_projection IM i s&#39; Hs&#39;)).</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>message, index</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>EqDecision0</var><span class="hyp-type"><b>: </b><span>EqDecision index</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>finite.Finite index</span></span></span><br><span><var>IM</var><span class="hyp-type"><b>: </b><span>index ‚Üí VLSM message</span></span></span><br><span><var>state_destructor</var><span class="hyp-type"><b>: </b><span><span class="kr">‚àÄ</span> <span class="nv">i</span> : index,
  vstate (IM i)
  ‚Üí list
      (vtransition_item (IM i) *
       vstate (IM i))</span></span></span><br><span><var>state_size</var><span class="hyp-type"><b>: </b><span><span class="kr">‚àÄ</span> <span class="nv">i</span> : index, vstate (IM i) ‚Üí nat</span></span></span><br><span><var>H0</var><span class="hyp-type"><b>: </b><span><span class="kr">‚àÄ</span> <span class="nv">i</span> : index,
  TraceableVLSM (IM i) 
    (state_destructor i) 
    (state_size i)</span></span></span><br><span><var>Free</var><span><span class="hyp-body"><b>:= </b><span>free_composite_vlsm IM</span></span><span class="hyp-type"><b>: </b><span>VLSM message</span></span></span></span><br><span><var>RFree</var><span><span class="hyp-body"><b>:= </b><span>pre_loaded_with_all_messages_vlsm Free</span></span><span class="hyp-type"><b>: </b><span>VLSM message</span></span></span></span><br><span><var>s'</var><span class="hyp-type"><b>: </b><span>composite_state IM</span></span></span><br><span><var>Hs'</var><span class="hyp-type"><b>: </b><span>valid_state_prop RFree s&#39;</span></span></span><br><span><var>i</var><span class="hyp-type"><b>: </b><span>index</span></span></span><br><span><var>itemi</var><span class="hyp-type"><b>: </b><span>vtransition_item (IM i)</span></span></span><br><span><var>si</var><span class="hyp-type"><b>: </b><span>vstate (IM i)</span></span></span><br><span><var>Hin</var><span class="hyp-type"><b>: </b><span>(itemi, si) ‚àà state_destructor i (s&#39; i)</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">input_valid_transition
  (pre_loaded_with_all_messages_vlsm (IM i)) (l itemi)
  (si,
  input
    (lift_to_composite_transition_item IM s&#39; i itemi))
  (destination itemi,
  output
    (lift_to_composite_transition_item IM s&#39; i itemi))</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="TraceableVLSM-v-chk48" style="display: none" type="checkbox"><label class="alectryon-input" for="TraceableVLSM-v-chk48"><span class="nb">eapply</span> @tv_state_destructor_transition; [<span class="bp">done</span> | | <span class="bp">done</span>].</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>message, index</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>EqDecision0</var><span class="hyp-type"><b>: </b><span>EqDecision index</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>finite.Finite index</span></span></span><br><span><var>IM</var><span class="hyp-type"><b>: </b><span>index ‚Üí VLSM message</span></span></span><br><span><var>state_destructor</var><span class="hyp-type"><b>: </b><span><span class="kr">‚àÄ</span> <span class="nv">i</span> : index,
  vstate (IM i)
  ‚Üí list
      (vtransition_item (IM i) *
       vstate (IM i))</span></span></span><br><span><var>state_size</var><span class="hyp-type"><b>: </b><span><span class="kr">‚àÄ</span> <span class="nv">i</span> : index, vstate (IM i) ‚Üí nat</span></span></span><br><span><var>H0</var><span class="hyp-type"><b>: </b><span><span class="kr">‚àÄ</span> <span class="nv">i</span> : index,
  TraceableVLSM (IM i) 
    (state_destructor i) 
    (state_size i)</span></span></span><br><span><var>Free</var><span><span class="hyp-body"><b>:= </b><span>free_composite_vlsm IM</span></span><span class="hyp-type"><b>: </b><span>VLSM message</span></span></span></span><br><span><var>RFree</var><span><span class="hyp-body"><b>:= </b><span>pre_loaded_with_all_messages_vlsm Free</span></span><span class="hyp-type"><b>: </b><span>VLSM message</span></span></span></span><br><span><var>s'</var><span class="hyp-type"><b>: </b><span>composite_state IM</span></span></span><br><span><var>Hs'</var><span class="hyp-type"><b>: </b><span>valid_state_prop RFree s&#39;</span></span></span><br><span><var>i</var><span class="hyp-type"><b>: </b><span>index</span></span></span><br><span><var>itemi</var><span class="hyp-type"><b>: </b><span>vtransition_item (IM i)</span></span></span><br><span><var>si</var><span class="hyp-type"><b>: </b><span>vstate (IM i)</span></span></span><br><span><var>Hin</var><span class="hyp-type"><b>: </b><span>(itemi, si) ‚àà state_destructor i (s&#39; i)</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">valid_state_prop
  (pre_loaded_with_all_messages_vlsm (IM i)) (s&#39; i)</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><span class="alectryon-input"><span class="bp">by</span> <span class="nb">eapply</span> valid_state_project_preloaded_to_preloaded.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Qed</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
</span><span class="alectryon-sentence"><input class="alectryon-toggle" id="TraceableVLSM-v-chk49" style="display: none" type="checkbox"><label class="alectryon-input" for="TraceableVLSM-v-chk49"><span class="kn">Lemma</span> <span class="nf">composite_tv_state_destructor_index</span>  :
  <span class="kr">forall</span> (<span class="nv">s&#39;</span> <span class="nv">s</span> : composite_state IM) (<span class="nv">item</span> : composite_transition_item IM) <span class="nv">i</span>,
    (item, s) ‚àà composite_state_destructor s&#39; i -&gt; projT1 (l item) = i.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>message, index</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>EqDecision0</var><span class="hyp-type"><b>: </b><span>EqDecision index</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>finite.Finite index</span></span></span><br><span><var>IM</var><span class="hyp-type"><b>: </b><span>index ‚Üí VLSM message</span></span></span><br><span><var>state_destructor</var><span class="hyp-type"><b>: </b><span><span class="kr">‚àÄ</span> <span class="nv">i</span> : index,
  vstate (IM i)
  ‚Üí list
      (vtransition_item (IM i) *
       vstate (IM i))</span></span></span><br><span><var>state_size</var><span class="hyp-type"><b>: </b><span><span class="kr">‚àÄ</span> <span class="nv">i</span> : index, vstate (IM i) ‚Üí nat</span></span></span><br><span><var>H0</var><span class="hyp-type"><b>: </b><span><span class="kr">‚àÄ</span> <span class="nv">i</span> : index,
  TraceableVLSM (IM i) 
    (state_destructor i) 
    (state_size i)</span></span></span><br><span><var>Free</var><span><span class="hyp-body"><b>:= </b><span>free_composite_vlsm IM</span></span><span class="hyp-type"><b>: </b><span>VLSM message</span></span></span></span><br><span><var>RFree</var><span><span class="hyp-body"><b>:= </b><span>pre_loaded_with_all_messages_vlsm Free</span></span><span class="hyp-type"><b>: </b><span>VLSM message</span></span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="kr">‚àÄ</span> (<span class="nv">s&#39;</span> <span class="nv">s</span> : composite_state IM) (<span class="nv">item</span> : composite_transition_item
                                        IM) (<span class="nv">i</span> : index),
  (item, s) ‚àà composite_state_destructor s&#39; i
  ‚Üí projT1 (l item) = i</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="TraceableVLSM-v-chk4a" style="display: none" type="checkbox"><label class="alectryon-input" for="TraceableVLSM-v-chk4a"><span class="kn">Proof</span>.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>message, index</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>EqDecision0</var><span class="hyp-type"><b>: </b><span>EqDecision index</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>finite.Finite index</span></span></span><br><span><var>IM</var><span class="hyp-type"><b>: </b><span>index ‚Üí VLSM message</span></span></span><br><span><var>state_destructor</var><span class="hyp-type"><b>: </b><span><span class="kr">‚àÄ</span> <span class="nv">i</span> : index,
  vstate (IM i)
  ‚Üí list
      (vtransition_item (IM i) *
       vstate (IM i))</span></span></span><br><span><var>state_size</var><span class="hyp-type"><b>: </b><span><span class="kr">‚àÄ</span> <span class="nv">i</span> : index, vstate (IM i) ‚Üí nat</span></span></span><br><span><var>H0</var><span class="hyp-type"><b>: </b><span><span class="kr">‚àÄ</span> <span class="nv">i</span> : index,
  TraceableVLSM (IM i) 
    (state_destructor i) 
    (state_size i)</span></span></span><br><span><var>Free</var><span><span class="hyp-body"><b>:= </b><span>free_composite_vlsm IM</span></span><span class="hyp-type"><b>: </b><span>VLSM message</span></span></span></span><br><span><var>RFree</var><span><span class="hyp-body"><b>:= </b><span>pre_loaded_with_all_messages_vlsm Free</span></span><span class="hyp-type"><b>: </b><span>VLSM message</span></span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="kr">‚àÄ</span> (<span class="nv">s&#39;</span> <span class="nv">s</span> : composite_state IM) (<span class="nv">item</span> : composite_transition_item
                                        IM) (<span class="nv">i</span> : index),
  (item, s) ‚àà composite_state_destructor s&#39; i
  ‚Üí projT1 (l item) = i</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="TraceableVLSM-v-chk4b" style="display: none" type="checkbox"><label class="alectryon-input" for="TraceableVLSM-v-chk4b"><span class="nb">intros</span> *.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>message, index</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>EqDecision0</var><span class="hyp-type"><b>: </b><span>EqDecision index</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>finite.Finite index</span></span></span><br><span><var>IM</var><span class="hyp-type"><b>: </b><span>index ‚Üí VLSM message</span></span></span><br><span><var>state_destructor</var><span class="hyp-type"><b>: </b><span><span class="kr">‚àÄ</span> <span class="nv">i</span> : index,
  vstate (IM i)
  ‚Üí list
      (vtransition_item (IM i) *
       vstate (IM i))</span></span></span><br><span><var>state_size</var><span class="hyp-type"><b>: </b><span><span class="kr">‚àÄ</span> <span class="nv">i</span> : index, vstate (IM i) ‚Üí nat</span></span></span><br><span><var>H0</var><span class="hyp-type"><b>: </b><span><span class="kr">‚àÄ</span> <span class="nv">i</span> : index,
  TraceableVLSM (IM i) 
    (state_destructor i) 
    (state_size i)</span></span></span><br><span><var>Free</var><span><span class="hyp-body"><b>:= </b><span>free_composite_vlsm IM</span></span><span class="hyp-type"><b>: </b><span>VLSM message</span></span></span></span><br><span><var>RFree</var><span><span class="hyp-body"><b>:= </b><span>pre_loaded_with_all_messages_vlsm Free</span></span><span class="hyp-type"><b>: </b><span>VLSM message</span></span></span></span><br><span><var>s', s</var><span class="hyp-type"><b>: </b><span>composite_state IM</span></span></span><br><span><var>item</var><span class="hyp-type"><b>: </b><span>composite_transition_item IM</span></span></span><br><span><var>i</var><span class="hyp-type"><b>: </b><span>index</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">(item, s) ‚àà composite_state_destructor s&#39; i
‚Üí projT1 (l item) = i</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="TraceableVLSM-v-chk4c" style="display: none" type="checkbox"><label class="alectryon-input" for="TraceableVLSM-v-chk4c"><span class="nb">unfold</span> composite_state_destructor; <span class="nb">rewrite</span> elem_of_list_fmap.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>message, index</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>EqDecision0</var><span class="hyp-type"><b>: </b><span>EqDecision index</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>finite.Finite index</span></span></span><br><span><var>IM</var><span class="hyp-type"><b>: </b><span>index ‚Üí VLSM message</span></span></span><br><span><var>state_destructor</var><span class="hyp-type"><b>: </b><span><span class="kr">‚àÄ</span> <span class="nv">i</span> : index,
  vstate (IM i)
  ‚Üí list
      (vtransition_item (IM i) *
       vstate (IM i))</span></span></span><br><span><var>state_size</var><span class="hyp-type"><b>: </b><span><span class="kr">‚àÄ</span> <span class="nv">i</span> : index, vstate (IM i) ‚Üí nat</span></span></span><br><span><var>H0</var><span class="hyp-type"><b>: </b><span><span class="kr">‚àÄ</span> <span class="nv">i</span> : index,
  TraceableVLSM (IM i) 
    (state_destructor i) 
    (state_size i)</span></span></span><br><span><var>Free</var><span><span class="hyp-body"><b>:= </b><span>free_composite_vlsm IM</span></span><span class="hyp-type"><b>: </b><span>VLSM message</span></span></span></span><br><span><var>RFree</var><span><span class="hyp-body"><b>:= </b><span>pre_loaded_with_all_messages_vlsm Free</span></span><span class="hyp-type"><b>: </b><span>VLSM message</span></span></span></span><br><span><var>s', s</var><span class="hyp-type"><b>: </b><span>composite_state IM</span></span></span><br><span><var>item</var><span class="hyp-type"><b>: </b><span>composite_transition_item IM</span></span></span><br><span><var>i</var><span class="hyp-type"><b>: </b><span>index</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">(<span class="kr">‚àÉ</span> <span class="nv">y</span> : vtransition_item (IM i) * vstate (IM i),
   (item, s) =
   lift_to_composite_transition_item_state s&#39; i y
   ‚àß y ‚àà state_destructor i (s&#39; i))
‚Üí projT1 (l item) = i</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><span class="alectryon-input"><span class="bp">by</span> <span class="nb">intros</span> ((itemi, si) &amp; [= -&gt;] &amp; Hin).</span><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Qed</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
</span><span class="alectryon-sentence"><input class="alectryon-toggle" id="TraceableVLSM-v-chk4d" style="display: none" type="checkbox"><label class="alectryon-input" for="TraceableVLSM-v-chk4d"><span class="kn">Lemma</span> <span class="nf">composite_tv_state_destructor_state_update</span> :
  <span class="kr">forall</span> (<span class="nv">s&#39;</span> : composite_state IM), valid_state_prop RFree s&#39; -&gt;
  <span class="kr">forall</span> (<span class="nv">s</span> : composite_state IM) (<span class="nv">item</span> : composite_transition_item IM) (<span class="nv">i</span> : index),
  (item, s) ‚àà composite_state_destructor s&#39; i -&gt;
  s&#39; = state_update IM s i (destination item i).</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>message, index</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>EqDecision0</var><span class="hyp-type"><b>: </b><span>EqDecision index</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>finite.Finite index</span></span></span><br><span><var>IM</var><span class="hyp-type"><b>: </b><span>index ‚Üí VLSM message</span></span></span><br><span><var>state_destructor</var><span class="hyp-type"><b>: </b><span><span class="kr">‚àÄ</span> <span class="nv">i</span> : index,
  vstate (IM i)
  ‚Üí list
      (vtransition_item (IM i) *
       vstate (IM i))</span></span></span><br><span><var>state_size</var><span class="hyp-type"><b>: </b><span><span class="kr">‚àÄ</span> <span class="nv">i</span> : index, vstate (IM i) ‚Üí nat</span></span></span><br><span><var>H0</var><span class="hyp-type"><b>: </b><span><span class="kr">‚àÄ</span> <span class="nv">i</span> : index,
  TraceableVLSM (IM i) 
    (state_destructor i) 
    (state_size i)</span></span></span><br><span><var>Free</var><span><span class="hyp-body"><b>:= </b><span>free_composite_vlsm IM</span></span><span class="hyp-type"><b>: </b><span>VLSM message</span></span></span></span><br><span><var>RFree</var><span><span class="hyp-body"><b>:= </b><span>pre_loaded_with_all_messages_vlsm Free</span></span><span class="hyp-type"><b>: </b><span>VLSM message</span></span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="kr">‚àÄ</span> <span class="nv">s&#39;</span> : composite_state IM,
  valid_state_prop RFree s&#39;
  ‚Üí <span class="kr">‚àÄ</span> (<span class="nv">s</span> : composite_state IM) (<span class="nv">item</span> : composite_transition_item
                                         IM) (<span class="nv">i</span> : index),
      (item, s) ‚àà composite_state_destructor s&#39; i
      ‚Üí s&#39; = state_update IM s i (destination item i)</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="TraceableVLSM-v-chk4e" style="display: none" type="checkbox"><label class="alectryon-input" for="TraceableVLSM-v-chk4e"><span class="kn">Proof</span>.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>message, index</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>EqDecision0</var><span class="hyp-type"><b>: </b><span>EqDecision index</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>finite.Finite index</span></span></span><br><span><var>IM</var><span class="hyp-type"><b>: </b><span>index ‚Üí VLSM message</span></span></span><br><span><var>state_destructor</var><span class="hyp-type"><b>: </b><span><span class="kr">‚àÄ</span> <span class="nv">i</span> : index,
  vstate (IM i)
  ‚Üí list
      (vtransition_item (IM i) *
       vstate (IM i))</span></span></span><br><span><var>state_size</var><span class="hyp-type"><b>: </b><span><span class="kr">‚àÄ</span> <span class="nv">i</span> : index, vstate (IM i) ‚Üí nat</span></span></span><br><span><var>H0</var><span class="hyp-type"><b>: </b><span><span class="kr">‚àÄ</span> <span class="nv">i</span> : index,
  TraceableVLSM (IM i) 
    (state_destructor i) 
    (state_size i)</span></span></span><br><span><var>Free</var><span><span class="hyp-body"><b>:= </b><span>free_composite_vlsm IM</span></span><span class="hyp-type"><b>: </b><span>VLSM message</span></span></span></span><br><span><var>RFree</var><span><span class="hyp-body"><b>:= </b><span>pre_loaded_with_all_messages_vlsm Free</span></span><span class="hyp-type"><b>: </b><span>VLSM message</span></span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="kr">‚àÄ</span> <span class="nv">s&#39;</span> : composite_state IM,
  valid_state_prop RFree s&#39;
  ‚Üí <span class="kr">‚àÄ</span> (<span class="nv">s</span> : composite_state IM) (<span class="nv">item</span> : composite_transition_item
                                         IM) (<span class="nv">i</span> : index),
      (item, s) ‚àà composite_state_destructor s&#39; i
      ‚Üí s&#39; = state_update IM s i (destination item i)</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="TraceableVLSM-v-chk4f" style="display: none" type="checkbox"><label class="alectryon-input" for="TraceableVLSM-v-chk4f"><span class="nb">intros</span> s&#39; Hs&#39; s item i Hin.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>message, index</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>EqDecision0</var><span class="hyp-type"><b>: </b><span>EqDecision index</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>finite.Finite index</span></span></span><br><span><var>IM</var><span class="hyp-type"><b>: </b><span>index ‚Üí VLSM message</span></span></span><br><span><var>state_destructor</var><span class="hyp-type"><b>: </b><span><span class="kr">‚àÄ</span> <span class="nv">i</span> : index,
  vstate (IM i)
  ‚Üí list
      (vtransition_item (IM i) *
       vstate (IM i))</span></span></span><br><span><var>state_size</var><span class="hyp-type"><b>: </b><span><span class="kr">‚àÄ</span> <span class="nv">i</span> : index, vstate (IM i) ‚Üí nat</span></span></span><br><span><var>H0</var><span class="hyp-type"><b>: </b><span><span class="kr">‚àÄ</span> <span class="nv">i</span> : index,
  TraceableVLSM (IM i) 
    (state_destructor i) 
    (state_size i)</span></span></span><br><span><var>Free</var><span><span class="hyp-body"><b>:= </b><span>free_composite_vlsm IM</span></span><span class="hyp-type"><b>: </b><span>VLSM message</span></span></span></span><br><span><var>RFree</var><span><span class="hyp-body"><b>:= </b><span>pre_loaded_with_all_messages_vlsm Free</span></span><span class="hyp-type"><b>: </b><span>VLSM message</span></span></span></span><br><span><var>s'</var><span class="hyp-type"><b>: </b><span>composite_state IM</span></span></span><br><span><var>Hs'</var><span class="hyp-type"><b>: </b><span>valid_state_prop RFree s&#39;</span></span></span><br><span><var>s</var><span class="hyp-type"><b>: </b><span>composite_state IM</span></span></span><br><span><var>item</var><span class="hyp-type"><b>: </b><span>composite_transition_item IM</span></span></span><br><span><var>i</var><span class="hyp-type"><b>: </b><span>index</span></span></span><br><span><var>Hin</var><span class="hyp-type"><b>: </b><span>(item, s) ‚àà composite_state_destructor s&#39; i</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">s&#39; = state_update IM s i (destination item i)</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="TraceableVLSM-v-chk50" style="display: none" type="checkbox"><label class="alectryon-input" for="TraceableVLSM-v-chk50"><span class="nb">replace</span> s&#39; <span class="kr">with</span> (destination item) <span class="kr">in</span> *
    <span class="bp">by</span> (<span class="nb">eapply</span> composite_tv_state_destructor_destination; <span class="bp">done</span>).</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>message, index</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>EqDecision0</var><span class="hyp-type"><b>: </b><span>EqDecision index</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>finite.Finite index</span></span></span><br><span><var>IM</var><span class="hyp-type"><b>: </b><span>index ‚Üí VLSM message</span></span></span><br><span><var>state_destructor</var><span class="hyp-type"><b>: </b><span><span class="kr">‚àÄ</span> <span class="nv">i</span> : index,
  vstate (IM i)
  ‚Üí list
      (vtransition_item (IM i) *
       vstate (IM i))</span></span></span><br><span><var>state_size</var><span class="hyp-type"><b>: </b><span><span class="kr">‚àÄ</span> <span class="nv">i</span> : index, vstate (IM i) ‚Üí nat</span></span></span><br><span><var>H0</var><span class="hyp-type"><b>: </b><span><span class="kr">‚àÄ</span> <span class="nv">i</span> : index,
  TraceableVLSM (IM i) 
    (state_destructor i) 
    (state_size i)</span></span></span><br><span><var>Free</var><span><span class="hyp-body"><b>:= </b><span>free_composite_vlsm IM</span></span><span class="hyp-type"><b>: </b><span>VLSM message</span></span></span></span><br><span><var>RFree</var><span><span class="hyp-body"><b>:= </b><span>pre_loaded_with_all_messages_vlsm Free</span></span><span class="hyp-type"><b>: </b><span>VLSM message</span></span></span></span><br><span><var>s'</var><span class="hyp-type"><b>: </b><span>composite_state IM</span></span></span><br><span><var>item</var><span class="hyp-type"><b>: </b><span>composite_transition_item IM</span></span></span><br><span><var>Hs'</var><span class="hyp-type"><b>: </b><span>valid_state_prop RFree (destination item)</span></span></span><br><span><var>s</var><span class="hyp-type"><b>: </b><span>composite_state IM</span></span></span><br><span><var>i</var><span class="hyp-type"><b>: </b><span>index</span></span></span><br><span><var>Hin</var><span class="hyp-type"><b>: </b><span>(item, s)
‚àà composite_state_destructor 
    (destination item) i</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">destination item =
state_update IM s i (destination item i)</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="TraceableVLSM-v-chk51" style="display: none" type="checkbox"><label class="alectryon-input" for="TraceableVLSM-v-chk51"><span class="nb">eapply</span> composite_tv_state_destructor_index  <span class="kr">in</span> Hin <span class="kr">as</span> Hl.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>message, index</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>EqDecision0</var><span class="hyp-type"><b>: </b><span>EqDecision index</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>finite.Finite index</span></span></span><br><span><var>IM</var><span class="hyp-type"><b>: </b><span>index ‚Üí VLSM message</span></span></span><br><span><var>state_destructor</var><span class="hyp-type"><b>: </b><span><span class="kr">‚àÄ</span> <span class="nv">i</span> : index,
  vstate (IM i)
  ‚Üí list
      (vtransition_item (IM i) *
       vstate (IM i))</span></span></span><br><span><var>state_size</var><span class="hyp-type"><b>: </b><span><span class="kr">‚àÄ</span> <span class="nv">i</span> : index, vstate (IM i) ‚Üí nat</span></span></span><br><span><var>H0</var><span class="hyp-type"><b>: </b><span><span class="kr">‚àÄ</span> <span class="nv">i</span> : index,
  TraceableVLSM (IM i) 
    (state_destructor i) 
    (state_size i)</span></span></span><br><span><var>Free</var><span><span class="hyp-body"><b>:= </b><span>free_composite_vlsm IM</span></span><span class="hyp-type"><b>: </b><span>VLSM message</span></span></span></span><br><span><var>RFree</var><span><span class="hyp-body"><b>:= </b><span>pre_loaded_with_all_messages_vlsm Free</span></span><span class="hyp-type"><b>: </b><span>VLSM message</span></span></span></span><br><span><var>s'</var><span class="hyp-type"><b>: </b><span>composite_state IM</span></span></span><br><span><var>item</var><span class="hyp-type"><b>: </b><span>composite_transition_item IM</span></span></span><br><span><var>Hs'</var><span class="hyp-type"><b>: </b><span>valid_state_prop RFree (destination item)</span></span></span><br><span><var>s</var><span class="hyp-type"><b>: </b><span>composite_state IM</span></span></span><br><span><var>i</var><span class="hyp-type"><b>: </b><span>index</span></span></span><br><span><var>Hin</var><span class="hyp-type"><b>: </b><span>(item, s)
‚àà composite_state_destructor 
    (destination item) i</span></span></span><br><span><var>Hl</var><span class="hyp-type"><b>: </b><span>projT1 (l item) = i</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">destination item =
state_update IM s i (destination item i)</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="TraceableVLSM-v-chk52" style="display: none" type="checkbox"><label class="alectryon-input" for="TraceableVLSM-v-chk52"><span class="nb">eapply</span> composite_tv_state_destructor_transition <span class="kr">in</span> Hin <span class="kr">as</span> [_ Ht]; [| <span class="bp">done</span>].</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>message, index</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>EqDecision0</var><span class="hyp-type"><b>: </b><span>EqDecision index</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>finite.Finite index</span></span></span><br><span><var>IM</var><span class="hyp-type"><b>: </b><span>index ‚Üí VLSM message</span></span></span><br><span><var>state_destructor</var><span class="hyp-type"><b>: </b><span><span class="kr">‚àÄ</span> <span class="nv">i</span> : index,
  vstate (IM i)
  ‚Üí list
      (vtransition_item (IM i) *
       vstate (IM i))</span></span></span><br><span><var>state_size</var><span class="hyp-type"><b>: </b><span><span class="kr">‚àÄ</span> <span class="nv">i</span> : index, vstate (IM i) ‚Üí nat</span></span></span><br><span><var>H0</var><span class="hyp-type"><b>: </b><span><span class="kr">‚àÄ</span> <span class="nv">i</span> : index,
  TraceableVLSM (IM i) 
    (state_destructor i) 
    (state_size i)</span></span></span><br><span><var>Free</var><span><span class="hyp-body"><b>:= </b><span>free_composite_vlsm IM</span></span><span class="hyp-type"><b>: </b><span>VLSM message</span></span></span></span><br><span><var>RFree</var><span><span class="hyp-body"><b>:= </b><span>pre_loaded_with_all_messages_vlsm Free</span></span><span class="hyp-type"><b>: </b><span>VLSM message</span></span></span></span><br><span><var>s'</var><span class="hyp-type"><b>: </b><span>composite_state IM</span></span></span><br><span><var>item</var><span class="hyp-type"><b>: </b><span>composite_transition_item IM</span></span></span><br><span><var>Hs'</var><span class="hyp-type"><b>: </b><span>valid_state_prop RFree (destination item)</span></span></span><br><span><var>s</var><span class="hyp-type"><b>: </b><span>composite_state IM</span></span></span><br><span><var>i</var><span class="hyp-type"><b>: </b><span>index</span></span></span><br><span><var>Hl</var><span class="hyp-type"><b>: </b><span>projT1 (l item) = i</span></span></span><br><span><var>Ht</var><span class="hyp-type"><b>: </b><span>transition (l item) (s, input item) =
(destination item, output item)</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">destination item =
state_update IM s i (destination item i)</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="TraceableVLSM-v-chk53" style="display: none" type="checkbox"><label class="alectryon-input" for="TraceableVLSM-v-chk53"><span class="nb">destruct</span> item, l; <span class="nb">cbn</span> <span class="kr">in</span> *; <span class="nb">destruct</span> (vtransition _ _ _); <span class="nb">inversion</span> Ht; <span class="nb">subst</span>.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>message, index</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>EqDecision0</var><span class="hyp-type"><b>: </b><span>EqDecision index</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>finite.Finite index</span></span></span><br><span><var>IM</var><span class="hyp-type"><b>: </b><span>index ‚Üí VLSM message</span></span></span><br><span><var>state_destructor</var><span class="hyp-type"><b>: </b><span><span class="kr">‚àÄ</span> <span class="nv">i</span> : index,
  vstate (IM i)
  ‚Üí list
      (vtransition_item (IM i) *
       vstate (IM i))</span></span></span><br><span><var>state_size</var><span class="hyp-type"><b>: </b><span><span class="kr">‚àÄ</span> <span class="nv">i</span> : index, vstate (IM i) ‚Üí nat</span></span></span><br><span><var>H0</var><span class="hyp-type"><b>: </b><span><span class="kr">‚àÄ</span> <span class="nv">i</span> : index,
  TraceableVLSM (IM i) 
    (state_destructor i) 
    (state_size i)</span></span></span><br><span><var>Free</var><span><span class="hyp-body"><b>:= </b><span>free_composite_vlsm IM</span></span><span class="hyp-type"><b>: </b><span>VLSM message</span></span></span></span><br><span><var>RFree</var><span><span class="hyp-body"><b>:= </b><span>pre_loaded_with_all_messages_vlsm Free</span></span><span class="hyp-type"><b>: </b><span>VLSM message</span></span></span></span><br><span><var>s'</var><span class="hyp-type"><b>: </b><span>composite_state IM</span></span></span><br><span><var>i</var><span class="hyp-type"><b>: </b><span>index</span></span></span><br><span><var>v</var><span class="hyp-type"><b>: </b><span>vlabel (IM i)</span></span></span><br><span><var>input, output</var><span class="hyp-type"><b>: </b><span>option message</span></span></span><br><span><var>s</var><span class="hyp-type"><b>: </b><span>composite_state IM</span></span></span><br><span><var>s0</var><span class="hyp-type"><b>: </b><span>state</span></span></span><br><span><var>Hs'</var><span class="hyp-type"><b>: </b><span>valid_state_prop RFree (state_update IM s i s0)</span></span></span><br><span><var>Ht</var><span class="hyp-type"><b>: </b><span>(state_update IM s i s0, output) =
(state_update IM s i s0, output)</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">state_update IM s i s0 =
state_update IM s i (state_update IM s i s0 i)</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><span class="alectryon-input"><span class="bp">by</span> state_update_simpl.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Qed</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
</span><span class="alectryon-sentence"><input class="alectryon-toggle" id="TraceableVLSM-v-chk54" style="display: none" type="checkbox"><label class="alectryon-input" for="TraceableVLSM-v-chk54"><span class="kn">Lemma</span> <span class="nf">composite_tv_state_destructor_initial</span> :
  <span class="kr">forall</span> (<span class="nv">s</span> : composite_state IM), valid_state_prop RFree s -&gt;
  <span class="kr">forall</span> <span class="nv">i</span>,
    vinitial_state_prop (IM i) (s i)
      &lt;-&gt;
    composite_state_destructor s i = [].</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>message, index</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>EqDecision0</var><span class="hyp-type"><b>: </b><span>EqDecision index</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>finite.Finite index</span></span></span><br><span><var>IM</var><span class="hyp-type"><b>: </b><span>index ‚Üí VLSM message</span></span></span><br><span><var>state_destructor</var><span class="hyp-type"><b>: </b><span><span class="kr">‚àÄ</span> <span class="nv">i</span> : index,
  vstate (IM i)
  ‚Üí list
      (vtransition_item (IM i) *
       vstate (IM i))</span></span></span><br><span><var>state_size</var><span class="hyp-type"><b>: </b><span><span class="kr">‚àÄ</span> <span class="nv">i</span> : index, vstate (IM i) ‚Üí nat</span></span></span><br><span><var>H0</var><span class="hyp-type"><b>: </b><span><span class="kr">‚àÄ</span> <span class="nv">i</span> : index,
  TraceableVLSM (IM i) 
    (state_destructor i) 
    (state_size i)</span></span></span><br><span><var>Free</var><span><span class="hyp-body"><b>:= </b><span>free_composite_vlsm IM</span></span><span class="hyp-type"><b>: </b><span>VLSM message</span></span></span></span><br><span><var>RFree</var><span><span class="hyp-body"><b>:= </b><span>pre_loaded_with_all_messages_vlsm Free</span></span><span class="hyp-type"><b>: </b><span>VLSM message</span></span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="kr">‚àÄ</span> <span class="nv">s</span> : composite_state IM,
  valid_state_prop RFree s
  ‚Üí <span class="kr">‚àÄ</span> <span class="nv">i</span> : index,
      vinitial_state_prop (IM i) (s i)
      ‚Üî composite_state_destructor s i = []</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="TraceableVLSM-v-chk55" style="display: none" type="checkbox"><label class="alectryon-input" for="TraceableVLSM-v-chk55"><span class="kn">Proof</span>.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>message, index</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>EqDecision0</var><span class="hyp-type"><b>: </b><span>EqDecision index</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>finite.Finite index</span></span></span><br><span><var>IM</var><span class="hyp-type"><b>: </b><span>index ‚Üí VLSM message</span></span></span><br><span><var>state_destructor</var><span class="hyp-type"><b>: </b><span><span class="kr">‚àÄ</span> <span class="nv">i</span> : index,
  vstate (IM i)
  ‚Üí list
      (vtransition_item (IM i) *
       vstate (IM i))</span></span></span><br><span><var>state_size</var><span class="hyp-type"><b>: </b><span><span class="kr">‚àÄ</span> <span class="nv">i</span> : index, vstate (IM i) ‚Üí nat</span></span></span><br><span><var>H0</var><span class="hyp-type"><b>: </b><span><span class="kr">‚àÄ</span> <span class="nv">i</span> : index,
  TraceableVLSM (IM i) 
    (state_destructor i) 
    (state_size i)</span></span></span><br><span><var>Free</var><span><span class="hyp-body"><b>:= </b><span>free_composite_vlsm IM</span></span><span class="hyp-type"><b>: </b><span>VLSM message</span></span></span></span><br><span><var>RFree</var><span><span class="hyp-body"><b>:= </b><span>pre_loaded_with_all_messages_vlsm Free</span></span><span class="hyp-type"><b>: </b><span>VLSM message</span></span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="kr">‚àÄ</span> <span class="nv">s</span> : composite_state IM,
  valid_state_prop RFree s
  ‚Üí <span class="kr">‚àÄ</span> <span class="nv">i</span> : index,
      vinitial_state_prop (IM i) (s i)
      ‚Üî composite_state_destructor s i = []</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="TraceableVLSM-v-chk56" style="display: none" type="checkbox"><label class="alectryon-input" for="TraceableVLSM-v-chk56"><span class="nb">unfold</span> composite_state_destructor; <span class="nb">split</span>; <span class="nb">intros</span> Hinit.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>message, index</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>EqDecision0</var><span class="hyp-type"><b>: </b><span>EqDecision index</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>finite.Finite index</span></span></span><br><span><var>IM</var><span class="hyp-type"><b>: </b><span>index ‚Üí VLSM message</span></span></span><br><span><var>state_destructor</var><span class="hyp-type"><b>: </b><span><span class="kr">‚àÄ</span> <span class="nv">i</span> : index,
  vstate (IM i)
  ‚Üí list
      (vtransition_item (IM i) *
       vstate (IM i))</span></span></span><br><span><var>state_size</var><span class="hyp-type"><b>: </b><span><span class="kr">‚àÄ</span> <span class="nv">i</span> : index, vstate (IM i) ‚Üí nat</span></span></span><br><span><var>H0</var><span class="hyp-type"><b>: </b><span><span class="kr">‚àÄ</span> <span class="nv">i</span> : index,
  TraceableVLSM (IM i) 
    (state_destructor i) 
    (state_size i)</span></span></span><br><span><var>Free</var><span><span class="hyp-body"><b>:= </b><span>free_composite_vlsm IM</span></span><span class="hyp-type"><b>: </b><span>VLSM message</span></span></span></span><br><span><var>RFree</var><span><span class="hyp-body"><b>:= </b><span>pre_loaded_with_all_messages_vlsm Free</span></span><span class="hyp-type"><b>: </b><span>VLSM message</span></span></span></span><br><span><var>s</var><span class="hyp-type"><b>: </b><span>composite_state IM</span></span></span><br><span><var>H1</var><span class="hyp-type"><b>: </b><span>valid_state_prop RFree s</span></span></span><br><span><var>i</var><span class="hyp-type"><b>: </b><span>index</span></span></span><br><span><var>Hinit</var><span class="hyp-type"><b>: </b><span>vinitial_state_prop (IM i) (s i)</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">map (lift_to_composite_transition_item_state s i)
  (state_destructor i (s i)) = []</div></blockquote><div class="alectryon-extra-goals"><input class="alectryon-extra-goal-toggle" id="TraceableVLSM-v-chk57" style="display: none" type="checkbox"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>message, index</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>EqDecision0</var><span class="hyp-type"><b>: </b><span>EqDecision index</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>finite.Finite index</span></span></span><br><span><var>IM</var><span class="hyp-type"><b>: </b><span>index ‚Üí VLSM message</span></span></span><br><span><var>state_destructor</var><span class="hyp-type"><b>: </b><span><span class="kr">‚àÄ</span> <span class="nv">i</span> : index,
  vstate (IM i)
  ‚Üí list
      (vtransition_item (IM i) *
       vstate (IM i))</span></span></span><br><span><var>state_size</var><span class="hyp-type"><b>: </b><span><span class="kr">‚àÄ</span> <span class="nv">i</span> : index, vstate (IM i) ‚Üí nat</span></span></span><br><span><var>H0</var><span class="hyp-type"><b>: </b><span><span class="kr">‚àÄ</span> <span class="nv">i</span> : index,
  TraceableVLSM (IM i) 
    (state_destructor i) 
    (state_size i)</span></span></span><br><span><var>Free</var><span><span class="hyp-body"><b>:= </b><span>free_composite_vlsm IM</span></span><span class="hyp-type"><b>: </b><span>VLSM message</span></span></span></span><br><span><var>RFree</var><span><span class="hyp-body"><b>:= </b><span>pre_loaded_with_all_messages_vlsm Free</span></span><span class="hyp-type"><b>: </b><span>VLSM message</span></span></span></span><br><span><var>s</var><span class="hyp-type"><b>: </b><span>composite_state IM</span></span></span><br><span><var>H1</var><span class="hyp-type"><b>: </b><span>valid_state_prop RFree s</span></span></span><br><span><var>i</var><span class="hyp-type"><b>: </b><span>index</span></span></span><br><span><var>Hinit</var><span class="hyp-type"><b>: </b><span>map
  (lift_to_composite_transition_item_state s i)
  (state_destructor i (s i)) = []</span></span></span><br></div><label class="goal-separator" for="TraceableVLSM-v-chk57"><hr></label><div class="goal-conclusion">vinitial_state_prop (IM i) (s i)</div></blockquote></div></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="TraceableVLSM-v-chk58" style="display: none" type="checkbox"><label class="alectryon-input" for="TraceableVLSM-v-chk58">-</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>message, index</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>EqDecision0</var><span class="hyp-type"><b>: </b><span>EqDecision index</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>finite.Finite index</span></span></span><br><span><var>IM</var><span class="hyp-type"><b>: </b><span>index ‚Üí VLSM message</span></span></span><br><span><var>state_destructor</var><span class="hyp-type"><b>: </b><span><span class="kr">‚àÄ</span> <span class="nv">i</span> : index,
  vstate (IM i)
  ‚Üí list
      (vtransition_item (IM i) *
       vstate (IM i))</span></span></span><br><span><var>state_size</var><span class="hyp-type"><b>: </b><span><span class="kr">‚àÄ</span> <span class="nv">i</span> : index, vstate (IM i) ‚Üí nat</span></span></span><br><span><var>H0</var><span class="hyp-type"><b>: </b><span><span class="kr">‚àÄ</span> <span class="nv">i</span> : index,
  TraceableVLSM (IM i) 
    (state_destructor i) 
    (state_size i)</span></span></span><br><span><var>Free</var><span><span class="hyp-body"><b>:= </b><span>free_composite_vlsm IM</span></span><span class="hyp-type"><b>: </b><span>VLSM message</span></span></span></span><br><span><var>RFree</var><span><span class="hyp-body"><b>:= </b><span>pre_loaded_with_all_messages_vlsm Free</span></span><span class="hyp-type"><b>: </b><span>VLSM message</span></span></span></span><br><span><var>s</var><span class="hyp-type"><b>: </b><span>composite_state IM</span></span></span><br><span><var>H1</var><span class="hyp-type"><b>: </b><span>valid_state_prop RFree s</span></span></span><br><span><var>i</var><span class="hyp-type"><b>: </b><span>index</span></span></span><br><span><var>Hinit</var><span class="hyp-type"><b>: </b><span>vinitial_state_prop (IM i) (s i)</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">map (lift_to_composite_transition_item_state s i)
  (state_destructor i (s i)) = []</div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="TraceableVLSM-v-chk59" style="display: none" type="checkbox"><label class="alectryon-input" for="TraceableVLSM-v-chk59"><span class="nb">replace</span> (state_destructor i (s i))
      <span class="kr">with</span> (@nil (vtransition_item (IM i) * vstate (IM i))); [<span class="bp">done</span> |].</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>message, index</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>EqDecision0</var><span class="hyp-type"><b>: </b><span>EqDecision index</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>finite.Finite index</span></span></span><br><span><var>IM</var><span class="hyp-type"><b>: </b><span>index ‚Üí VLSM message</span></span></span><br><span><var>state_destructor</var><span class="hyp-type"><b>: </b><span><span class="kr">‚àÄ</span> <span class="nv">i</span> : index,
  vstate (IM i)
  ‚Üí list
      (vtransition_item (IM i) *
       vstate (IM i))</span></span></span><br><span><var>state_size</var><span class="hyp-type"><b>: </b><span><span class="kr">‚àÄ</span> <span class="nv">i</span> : index, vstate (IM i) ‚Üí nat</span></span></span><br><span><var>H0</var><span class="hyp-type"><b>: </b><span><span class="kr">‚àÄ</span> <span class="nv">i</span> : index,
  TraceableVLSM (IM i) 
    (state_destructor i) 
    (state_size i)</span></span></span><br><span><var>Free</var><span><span class="hyp-body"><b>:= </b><span>free_composite_vlsm IM</span></span><span class="hyp-type"><b>: </b><span>VLSM message</span></span></span></span><br><span><var>RFree</var><span><span class="hyp-body"><b>:= </b><span>pre_loaded_with_all_messages_vlsm Free</span></span><span class="hyp-type"><b>: </b><span>VLSM message</span></span></span></span><br><span><var>s</var><span class="hyp-type"><b>: </b><span>composite_state IM</span></span></span><br><span><var>H1</var><span class="hyp-type"><b>: </b><span>valid_state_prop RFree s</span></span></span><br><span><var>i</var><span class="hyp-type"><b>: </b><span>index</span></span></span><br><span><var>Hinit</var><span class="hyp-type"><b>: </b><span>vinitial_state_prop (IM i) (s i)</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">[] = state_destructor i (s i)</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="TraceableVLSM-v-chk5a" style="display: none" type="checkbox"><label class="alectryon-input" for="TraceableVLSM-v-chk5a"><span class="nb">symmetry</span>; <span class="nb">apply</span> tv_state_destructor_initial; [| <span class="bp">done</span>].</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>message, index</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>EqDecision0</var><span class="hyp-type"><b>: </b><span>EqDecision index</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>finite.Finite index</span></span></span><br><span><var>IM</var><span class="hyp-type"><b>: </b><span>index ‚Üí VLSM message</span></span></span><br><span><var>state_destructor</var><span class="hyp-type"><b>: </b><span><span class="kr">‚àÄ</span> <span class="nv">i</span> : index,
  vstate (IM i)
  ‚Üí list
      (vtransition_item (IM i) *
       vstate (IM i))</span></span></span><br><span><var>state_size</var><span class="hyp-type"><b>: </b><span><span class="kr">‚àÄ</span> <span class="nv">i</span> : index, vstate (IM i) ‚Üí nat</span></span></span><br><span><var>H0</var><span class="hyp-type"><b>: </b><span><span class="kr">‚àÄ</span> <span class="nv">i</span> : index,
  TraceableVLSM (IM i) 
    (state_destructor i) 
    (state_size i)</span></span></span><br><span><var>Free</var><span><span class="hyp-body"><b>:= </b><span>free_composite_vlsm IM</span></span><span class="hyp-type"><b>: </b><span>VLSM message</span></span></span></span><br><span><var>RFree</var><span><span class="hyp-body"><b>:= </b><span>pre_loaded_with_all_messages_vlsm Free</span></span><span class="hyp-type"><b>: </b><span>VLSM message</span></span></span></span><br><span><var>s</var><span class="hyp-type"><b>: </b><span>composite_state IM</span></span></span><br><span><var>H1</var><span class="hyp-type"><b>: </b><span>valid_state_prop RFree s</span></span></span><br><span><var>i</var><span class="hyp-type"><b>: </b><span>index</span></span></span><br><span><var>Hinit</var><span class="hyp-type"><b>: </b><span>vinitial_state_prop (IM i) (s i)</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">valid_state_prop
  (pre_loaded_with_all_messages_vlsm (IM i)) (s i)</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><span class="alectryon-input"><span class="bp">by</span> <span class="nb">eapply</span> valid_state_project_preloaded_to_preloaded.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="TraceableVLSM-v-chk5b" style="display: none" type="checkbox"><label class="alectryon-input" for="TraceableVLSM-v-chk5b">-</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>message, index</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>EqDecision0</var><span class="hyp-type"><b>: </b><span>EqDecision index</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>finite.Finite index</span></span></span><br><span><var>IM</var><span class="hyp-type"><b>: </b><span>index ‚Üí VLSM message</span></span></span><br><span><var>state_destructor</var><span class="hyp-type"><b>: </b><span><span class="kr">‚àÄ</span> <span class="nv">i</span> : index,
  vstate (IM i)
  ‚Üí list
      (vtransition_item (IM i) *
       vstate (IM i))</span></span></span><br><span><var>state_size</var><span class="hyp-type"><b>: </b><span><span class="kr">‚àÄ</span> <span class="nv">i</span> : index, vstate (IM i) ‚Üí nat</span></span></span><br><span><var>H0</var><span class="hyp-type"><b>: </b><span><span class="kr">‚àÄ</span> <span class="nv">i</span> : index,
  TraceableVLSM (IM i) 
    (state_destructor i) 
    (state_size i)</span></span></span><br><span><var>Free</var><span><span class="hyp-body"><b>:= </b><span>free_composite_vlsm IM</span></span><span class="hyp-type"><b>: </b><span>VLSM message</span></span></span></span><br><span><var>RFree</var><span><span class="hyp-body"><b>:= </b><span>pre_loaded_with_all_messages_vlsm Free</span></span><span class="hyp-type"><b>: </b><span>VLSM message</span></span></span></span><br><span><var>s</var><span class="hyp-type"><b>: </b><span>composite_state IM</span></span></span><br><span><var>H1</var><span class="hyp-type"><b>: </b><span>valid_state_prop RFree s</span></span></span><br><span><var>i</var><span class="hyp-type"><b>: </b><span>index</span></span></span><br><span><var>Hinit</var><span class="hyp-type"><b>: </b><span>map
  (lift_to_composite_transition_item_state s i)
  (state_destructor i (s i)) = []</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">vinitial_state_prop (IM i) (s i)</div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="TraceableVLSM-v-chk5c" style="display: none" type="checkbox"><label class="alectryon-input" for="TraceableVLSM-v-chk5c"><span class="nb">apply</span> tv_state_destructor_initial.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>message, index</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>EqDecision0</var><span class="hyp-type"><b>: </b><span>EqDecision index</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>finite.Finite index</span></span></span><br><span><var>IM</var><span class="hyp-type"><b>: </b><span>index ‚Üí VLSM message</span></span></span><br><span><var>state_destructor</var><span class="hyp-type"><b>: </b><span><span class="kr">‚àÄ</span> <span class="nv">i</span> : index,
  vstate (IM i)
  ‚Üí list
      (vtransition_item (IM i) *
       vstate (IM i))</span></span></span><br><span><var>state_size</var><span class="hyp-type"><b>: </b><span><span class="kr">‚àÄ</span> <span class="nv">i</span> : index, vstate (IM i) ‚Üí nat</span></span></span><br><span><var>H0</var><span class="hyp-type"><b>: </b><span><span class="kr">‚àÄ</span> <span class="nv">i</span> : index,
  TraceableVLSM (IM i) 
    (state_destructor i) 
    (state_size i)</span></span></span><br><span><var>Free</var><span><span class="hyp-body"><b>:= </b><span>free_composite_vlsm IM</span></span><span class="hyp-type"><b>: </b><span>VLSM message</span></span></span></span><br><span><var>RFree</var><span><span class="hyp-body"><b>:= </b><span>pre_loaded_with_all_messages_vlsm Free</span></span><span class="hyp-type"><b>: </b><span>VLSM message</span></span></span></span><br><span><var>s</var><span class="hyp-type"><b>: </b><span>composite_state IM</span></span></span><br><span><var>H1</var><span class="hyp-type"><b>: </b><span>valid_state_prop RFree s</span></span></span><br><span><var>i</var><span class="hyp-type"><b>: </b><span>index</span></span></span><br><span><var>Hinit</var><span class="hyp-type"><b>: </b><span>map
  (lift_to_composite_transition_item_state s i)
  (state_destructor i (s i)) = []</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">valid_state_prop
  (pre_loaded_with_all_messages_vlsm (IM i)) (s i)</div></blockquote><div class="alectryon-extra-goals"><input class="alectryon-extra-goal-toggle" id="TraceableVLSM-v-chk5d" style="display: none" type="checkbox"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>message, index</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>EqDecision0</var><span class="hyp-type"><b>: </b><span>EqDecision index</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>finite.Finite index</span></span></span><br><span><var>IM</var><span class="hyp-type"><b>: </b><span>index ‚Üí VLSM message</span></span></span><br><span><var>state_destructor</var><span class="hyp-type"><b>: </b><span><span class="kr">‚àÄ</span> <span class="nv">i</span> : index,
  vstate (IM i)
  ‚Üí list
      (vtransition_item (IM i) *
       vstate (IM i))</span></span></span><br><span><var>state_size</var><span class="hyp-type"><b>: </b><span><span class="kr">‚àÄ</span> <span class="nv">i</span> : index, vstate (IM i) ‚Üí nat</span></span></span><br><span><var>H0</var><span class="hyp-type"><b>: </b><span><span class="kr">‚àÄ</span> <span class="nv">i</span> : index,
  TraceableVLSM (IM i) 
    (state_destructor i) 
    (state_size i)</span></span></span><br><span><var>Free</var><span><span class="hyp-body"><b>:= </b><span>free_composite_vlsm IM</span></span><span class="hyp-type"><b>: </b><span>VLSM message</span></span></span></span><br><span><var>RFree</var><span><span class="hyp-body"><b>:= </b><span>pre_loaded_with_all_messages_vlsm Free</span></span><span class="hyp-type"><b>: </b><span>VLSM message</span></span></span></span><br><span><var>s</var><span class="hyp-type"><b>: </b><span>composite_state IM</span></span></span><br><span><var>H1</var><span class="hyp-type"><b>: </b><span>valid_state_prop RFree s</span></span></span><br><span><var>i</var><span class="hyp-type"><b>: </b><span>index</span></span></span><br><span><var>Hinit</var><span class="hyp-type"><b>: </b><span>map
  (lift_to_composite_transition_item_state s i)
  (state_destructor i (s i)) = []</span></span></span><br></div><label class="goal-separator" for="TraceableVLSM-v-chk5d"><hr></label><div class="goal-conclusion">state_destructor i (s i) = []</div></blockquote></div></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="TraceableVLSM-v-chk5e" style="display: none" type="checkbox"><label class="alectryon-input" for="TraceableVLSM-v-chk5e">+</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>message, index</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>EqDecision0</var><span class="hyp-type"><b>: </b><span>EqDecision index</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>finite.Finite index</span></span></span><br><span><var>IM</var><span class="hyp-type"><b>: </b><span>index ‚Üí VLSM message</span></span></span><br><span><var>state_destructor</var><span class="hyp-type"><b>: </b><span><span class="kr">‚àÄ</span> <span class="nv">i</span> : index,
  vstate (IM i)
  ‚Üí list
      (vtransition_item (IM i) *
       vstate (IM i))</span></span></span><br><span><var>state_size</var><span class="hyp-type"><b>: </b><span><span class="kr">‚àÄ</span> <span class="nv">i</span> : index, vstate (IM i) ‚Üí nat</span></span></span><br><span><var>H0</var><span class="hyp-type"><b>: </b><span><span class="kr">‚àÄ</span> <span class="nv">i</span> : index,
  TraceableVLSM (IM i) 
    (state_destructor i) 
    (state_size i)</span></span></span><br><span><var>Free</var><span><span class="hyp-body"><b>:= </b><span>free_composite_vlsm IM</span></span><span class="hyp-type"><b>: </b><span>VLSM message</span></span></span></span><br><span><var>RFree</var><span><span class="hyp-body"><b>:= </b><span>pre_loaded_with_all_messages_vlsm Free</span></span><span class="hyp-type"><b>: </b><span>VLSM message</span></span></span></span><br><span><var>s</var><span class="hyp-type"><b>: </b><span>composite_state IM</span></span></span><br><span><var>H1</var><span class="hyp-type"><b>: </b><span>valid_state_prop RFree s</span></span></span><br><span><var>i</var><span class="hyp-type"><b>: </b><span>index</span></span></span><br><span><var>Hinit</var><span class="hyp-type"><b>: </b><span>map
  (lift_to_composite_transition_item_state s i)
  (state_destructor i (s i)) = []</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">valid_state_prop
  (pre_loaded_with_all_messages_vlsm (IM i)) (s i)</div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="bp">by</span> <span class="nb">eapply</span> valid_state_project_preloaded_to_preloaded.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="TraceableVLSM-v-chk5f" style="display: none" type="checkbox"><label class="alectryon-input" for="TraceableVLSM-v-chk5f">+</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>message, index</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>EqDecision0</var><span class="hyp-type"><b>: </b><span>EqDecision index</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>finite.Finite index</span></span></span><br><span><var>IM</var><span class="hyp-type"><b>: </b><span>index ‚Üí VLSM message</span></span></span><br><span><var>state_destructor</var><span class="hyp-type"><b>: </b><span><span class="kr">‚àÄ</span> <span class="nv">i</span> : index,
  vstate (IM i)
  ‚Üí list
      (vtransition_item (IM i) *
       vstate (IM i))</span></span></span><br><span><var>state_size</var><span class="hyp-type"><b>: </b><span><span class="kr">‚àÄ</span> <span class="nv">i</span> : index, vstate (IM i) ‚Üí nat</span></span></span><br><span><var>H0</var><span class="hyp-type"><b>: </b><span><span class="kr">‚àÄ</span> <span class="nv">i</span> : index,
  TraceableVLSM (IM i) 
    (state_destructor i) 
    (state_size i)</span></span></span><br><span><var>Free</var><span><span class="hyp-body"><b>:= </b><span>free_composite_vlsm IM</span></span><span class="hyp-type"><b>: </b><span>VLSM message</span></span></span></span><br><span><var>RFree</var><span><span class="hyp-body"><b>:= </b><span>pre_loaded_with_all_messages_vlsm Free</span></span><span class="hyp-type"><b>: </b><span>VLSM message</span></span></span></span><br><span><var>s</var><span class="hyp-type"><b>: </b><span>composite_state IM</span></span></span><br><span><var>H1</var><span class="hyp-type"><b>: </b><span>valid_state_prop RFree s</span></span></span><br><span><var>i</var><span class="hyp-type"><b>: </b><span>index</span></span></span><br><span><var>Hinit</var><span class="hyp-type"><b>: </b><span>map
  (lift_to_composite_transition_item_state s i)
  (state_destructor i (s i)) = []</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">state_destructor i (s i) = []</div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="bp">by</span> <span class="nb">eapply</span> fmap_nil_inv.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Qed</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
</span><span class="alectryon-sentence"><input class="alectryon-toggle" id="TraceableVLSM-v-chk60" style="display: none" type="checkbox"><label class="alectryon-input" for="TraceableVLSM-v-chk60"><span class="kn">Lemma</span> <span class="nf">composite_tv_state_destructor_reflects_initiality</span> :
  <span class="kr">forall</span> (<span class="nv">s&#39;</span> : composite_state IM), valid_state_prop RFree s&#39; -&gt;
  <span class="kr">forall</span> (<span class="nv">i</span> : index) (<span class="nv">s</span> : composite_state IM) (<span class="nv">item</span> : composite_transition_item IM),
    (item, s) ‚àà composite_state_destructor s&#39; i -&gt;
    <span class="kr">forall</span> <span class="nv">j</span>, vinitial_state_prop (IM j) (s&#39; j) -&gt; s j = s&#39; j.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>message, index</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>EqDecision0</var><span class="hyp-type"><b>: </b><span>EqDecision index</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>finite.Finite index</span></span></span><br><span><var>IM</var><span class="hyp-type"><b>: </b><span>index ‚Üí VLSM message</span></span></span><br><span><var>state_destructor</var><span class="hyp-type"><b>: </b><span><span class="kr">‚àÄ</span> <span class="nv">i</span> : index,
  vstate (IM i)
  ‚Üí list
      (vtransition_item (IM i) *
       vstate (IM i))</span></span></span><br><span><var>state_size</var><span class="hyp-type"><b>: </b><span><span class="kr">‚àÄ</span> <span class="nv">i</span> : index, vstate (IM i) ‚Üí nat</span></span></span><br><span><var>H0</var><span class="hyp-type"><b>: </b><span><span class="kr">‚àÄ</span> <span class="nv">i</span> : index,
  TraceableVLSM (IM i) 
    (state_destructor i) 
    (state_size i)</span></span></span><br><span><var>Free</var><span><span class="hyp-body"><b>:= </b><span>free_composite_vlsm IM</span></span><span class="hyp-type"><b>: </b><span>VLSM message</span></span></span></span><br><span><var>RFree</var><span><span class="hyp-body"><b>:= </b><span>pre_loaded_with_all_messages_vlsm Free</span></span><span class="hyp-type"><b>: </b><span>VLSM message</span></span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="kr">‚àÄ</span> <span class="nv">s&#39;</span> : composite_state IM,
  valid_state_prop RFree s&#39;
  ‚Üí <span class="kr">‚àÄ</span> (<span class="nv">i</span> : index) (<span class="nv">s</span> : composite_state IM) (<span class="nv">item</span> : 
                                            composite_transition_item
                                              IM),
      (item, s) ‚àà composite_state_destructor s&#39; i
      ‚Üí <span class="kr">‚àÄ</span> <span class="nv">j</span> : index,
          vinitial_state_prop (IM j) (s&#39; j)
          ‚Üí s j = s&#39; j</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="TraceableVLSM-v-chk61" style="display: none" type="checkbox"><label class="alectryon-input" for="TraceableVLSM-v-chk61"><span class="kn">Proof</span>.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>message, index</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>EqDecision0</var><span class="hyp-type"><b>: </b><span>EqDecision index</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>finite.Finite index</span></span></span><br><span><var>IM</var><span class="hyp-type"><b>: </b><span>index ‚Üí VLSM message</span></span></span><br><span><var>state_destructor</var><span class="hyp-type"><b>: </b><span><span class="kr">‚àÄ</span> <span class="nv">i</span> : index,
  vstate (IM i)
  ‚Üí list
      (vtransition_item (IM i) *
       vstate (IM i))</span></span></span><br><span><var>state_size</var><span class="hyp-type"><b>: </b><span><span class="kr">‚àÄ</span> <span class="nv">i</span> : index, vstate (IM i) ‚Üí nat</span></span></span><br><span><var>H0</var><span class="hyp-type"><b>: </b><span><span class="kr">‚àÄ</span> <span class="nv">i</span> : index,
  TraceableVLSM (IM i) 
    (state_destructor i) 
    (state_size i)</span></span></span><br><span><var>Free</var><span><span class="hyp-body"><b>:= </b><span>free_composite_vlsm IM</span></span><span class="hyp-type"><b>: </b><span>VLSM message</span></span></span></span><br><span><var>RFree</var><span><span class="hyp-body"><b>:= </b><span>pre_loaded_with_all_messages_vlsm Free</span></span><span class="hyp-type"><b>: </b><span>VLSM message</span></span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="kr">‚àÄ</span> <span class="nv">s&#39;</span> : composite_state IM,
  valid_state_prop RFree s&#39;
  ‚Üí <span class="kr">‚àÄ</span> (<span class="nv">i</span> : index) (<span class="nv">s</span> : composite_state IM) (<span class="nv">item</span> : 
                                            composite_transition_item
                                              IM),
      (item, s) ‚àà composite_state_destructor s&#39; i
      ‚Üí <span class="kr">‚àÄ</span> <span class="nv">j</span> : index,
          vinitial_state_prop (IM j) (s&#39; j)
          ‚Üí s j = s&#39; j</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="TraceableVLSM-v-chk62" style="display: none" type="checkbox"><label class="alectryon-input" for="TraceableVLSM-v-chk62"><span class="nb">intros</span> s&#39; Hs&#39; i s item Hdestruct.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>message, index</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>EqDecision0</var><span class="hyp-type"><b>: </b><span>EqDecision index</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>finite.Finite index</span></span></span><br><span><var>IM</var><span class="hyp-type"><b>: </b><span>index ‚Üí VLSM message</span></span></span><br><span><var>state_destructor</var><span class="hyp-type"><b>: </b><span><span class="kr">‚àÄ</span> <span class="nv">i</span> : index,
  vstate (IM i)
  ‚Üí list
      (vtransition_item (IM i) *
       vstate (IM i))</span></span></span><br><span><var>state_size</var><span class="hyp-type"><b>: </b><span><span class="kr">‚àÄ</span> <span class="nv">i</span> : index, vstate (IM i) ‚Üí nat</span></span></span><br><span><var>H0</var><span class="hyp-type"><b>: </b><span><span class="kr">‚àÄ</span> <span class="nv">i</span> : index,
  TraceableVLSM (IM i) 
    (state_destructor i) 
    (state_size i)</span></span></span><br><span><var>Free</var><span><span class="hyp-body"><b>:= </b><span>free_composite_vlsm IM</span></span><span class="hyp-type"><b>: </b><span>VLSM message</span></span></span></span><br><span><var>RFree</var><span><span class="hyp-body"><b>:= </b><span>pre_loaded_with_all_messages_vlsm Free</span></span><span class="hyp-type"><b>: </b><span>VLSM message</span></span></span></span><br><span><var>s'</var><span class="hyp-type"><b>: </b><span>composite_state IM</span></span></span><br><span><var>Hs'</var><span class="hyp-type"><b>: </b><span>valid_state_prop RFree s&#39;</span></span></span><br><span><var>i</var><span class="hyp-type"><b>: </b><span>index</span></span></span><br><span><var>s</var><span class="hyp-type"><b>: </b><span>composite_state IM</span></span></span><br><span><var>item</var><span class="hyp-type"><b>: </b><span>composite_transition_item IM</span></span></span><br><span><var>Hdestruct</var><span class="hyp-type"><b>: </b><span>(item, s)
‚àà composite_state_destructor s&#39; i</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="kr">‚àÄ</span> <span class="nv">j</span> : index,
  vinitial_state_prop (IM j) (s&#39; j) ‚Üí s j = s&#39; j</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="TraceableVLSM-v-chk63" style="display: none" type="checkbox"><label class="alectryon-input" for="TraceableVLSM-v-chk63"><span class="nb">apply</span> composite_tv_state_destructor_state_update <span class="kr">in</span> Hdestruct <span class="kr">as</span> Heqs&#39;; [| <span class="bp">done</span>].</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>message, index</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>EqDecision0</var><span class="hyp-type"><b>: </b><span>EqDecision index</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>finite.Finite index</span></span></span><br><span><var>IM</var><span class="hyp-type"><b>: </b><span>index ‚Üí VLSM message</span></span></span><br><span><var>state_destructor</var><span class="hyp-type"><b>: </b><span><span class="kr">‚àÄ</span> <span class="nv">i</span> : index,
  vstate (IM i)
  ‚Üí list
      (vtransition_item (IM i) *
       vstate (IM i))</span></span></span><br><span><var>state_size</var><span class="hyp-type"><b>: </b><span><span class="kr">‚àÄ</span> <span class="nv">i</span> : index, vstate (IM i) ‚Üí nat</span></span></span><br><span><var>H0</var><span class="hyp-type"><b>: </b><span><span class="kr">‚àÄ</span> <span class="nv">i</span> : index,
  TraceableVLSM (IM i) 
    (state_destructor i) 
    (state_size i)</span></span></span><br><span><var>Free</var><span><span class="hyp-body"><b>:= </b><span>free_composite_vlsm IM</span></span><span class="hyp-type"><b>: </b><span>VLSM message</span></span></span></span><br><span><var>RFree</var><span><span class="hyp-body"><b>:= </b><span>pre_loaded_with_all_messages_vlsm Free</span></span><span class="hyp-type"><b>: </b><span>VLSM message</span></span></span></span><br><span><var>s'</var><span class="hyp-type"><b>: </b><span>composite_state IM</span></span></span><br><span><var>Hs'</var><span class="hyp-type"><b>: </b><span>valid_state_prop RFree s&#39;</span></span></span><br><span><var>i</var><span class="hyp-type"><b>: </b><span>index</span></span></span><br><span><var>s</var><span class="hyp-type"><b>: </b><span>composite_state IM</span></span></span><br><span><var>item</var><span class="hyp-type"><b>: </b><span>composite_transition_item IM</span></span></span><br><span><var>Hdestruct</var><span class="hyp-type"><b>: </b><span>(item, s)
‚àà composite_state_destructor s&#39; i</span></span></span><br><span><var>Heqs'</var><span class="hyp-type"><b>: </b><span>s&#39; = state_update IM s i (destination item i)</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="kr">‚àÄ</span> <span class="nv">j</span> : index,
  vinitial_state_prop (IM j) (s&#39; j) ‚Üí s j = s&#39; j</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="TraceableVLSM-v-chk64" style="display: none" type="checkbox"><label class="alectryon-input" for="TraceableVLSM-v-chk64"><span class="nb">intros</span> j Hinit; <span class="nb">destruct</span> (decide (i = j)); <span class="nb">subst</span>; [| <span class="bp">by</span> state_update_simpl].</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>message, index</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>EqDecision0</var><span class="hyp-type"><b>: </b><span>EqDecision index</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>finite.Finite index</span></span></span><br><span><var>IM</var><span class="hyp-type"><b>: </b><span>index ‚Üí VLSM message</span></span></span><br><span><var>state_destructor</var><span class="hyp-type"><b>: </b><span><span class="kr">‚àÄ</span> <span class="nv">i</span> : index,
  vstate (IM i)
  ‚Üí list
      (vtransition_item (IM i) *
       vstate (IM i))</span></span></span><br><span><var>state_size</var><span class="hyp-type"><b>: </b><span><span class="kr">‚àÄ</span> <span class="nv">i</span> : index, vstate (IM i) ‚Üí nat</span></span></span><br><span><var>H0</var><span class="hyp-type"><b>: </b><span><span class="kr">‚àÄ</span> <span class="nv">i</span> : index,
  TraceableVLSM (IM i) 
    (state_destructor i) 
    (state_size i)</span></span></span><br><span><var>Free</var><span><span class="hyp-body"><b>:= </b><span>free_composite_vlsm IM</span></span><span class="hyp-type"><b>: </b><span>VLSM message</span></span></span></span><br><span><var>RFree</var><span><span class="hyp-body"><b>:= </b><span>pre_loaded_with_all_messages_vlsm Free</span></span><span class="hyp-type"><b>: </b><span>VLSM message</span></span></span></span><br><span><var>s</var><span class="hyp-type"><b>: </b><span>composite_state IM</span></span></span><br><span><var>item</var><span class="hyp-type"><b>: </b><span>composite_transition_item IM</span></span></span><br><span><var>j</var><span class="hyp-type"><b>: </b><span>index</span></span></span><br><span><var>Hinit</var><span class="hyp-type"><b>: </b><span>vinitial_state_prop (IM j)
  (state_update IM s j (destination item j) j)</span></span></span><br><span><var>Hs'</var><span class="hyp-type"><b>: </b><span>valid_state_prop RFree
  (state_update IM s j (destination item j))</span></span></span><br><span><var>Hdestruct</var><span class="hyp-type"><b>: </b><span>(item, s)
‚àà composite_state_destructor
    (state_update IM s j
       (destination item j)) j</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">s j = state_update IM s j (destination item j) j</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="TraceableVLSM-v-chk65" style="display: none" type="checkbox"><label class="alectryon-input" for="TraceableVLSM-v-chk65"><span class="nb">apply</span> composite_tv_state_destructor_initial <span class="kr">in</span> Hinit; [| <span class="bp">done</span>].</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>message, index</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>EqDecision0</var><span class="hyp-type"><b>: </b><span>EqDecision index</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>finite.Finite index</span></span></span><br><span><var>IM</var><span class="hyp-type"><b>: </b><span>index ‚Üí VLSM message</span></span></span><br><span><var>state_destructor</var><span class="hyp-type"><b>: </b><span><span class="kr">‚àÄ</span> <span class="nv">i</span> : index,
  vstate (IM i)
  ‚Üí list
      (vtransition_item (IM i) *
       vstate (IM i))</span></span></span><br><span><var>state_size</var><span class="hyp-type"><b>: </b><span><span class="kr">‚àÄ</span> <span class="nv">i</span> : index, vstate (IM i) ‚Üí nat</span></span></span><br><span><var>H0</var><span class="hyp-type"><b>: </b><span><span class="kr">‚àÄ</span> <span class="nv">i</span> : index,
  TraceableVLSM (IM i) 
    (state_destructor i) 
    (state_size i)</span></span></span><br><span><var>Free</var><span><span class="hyp-body"><b>:= </b><span>free_composite_vlsm IM</span></span><span class="hyp-type"><b>: </b><span>VLSM message</span></span></span></span><br><span><var>RFree</var><span><span class="hyp-body"><b>:= </b><span>pre_loaded_with_all_messages_vlsm Free</span></span><span class="hyp-type"><b>: </b><span>VLSM message</span></span></span></span><br><span><var>s</var><span class="hyp-type"><b>: </b><span>composite_state IM</span></span></span><br><span><var>item</var><span class="hyp-type"><b>: </b><span>composite_transition_item IM</span></span></span><br><span><var>j</var><span class="hyp-type"><b>: </b><span>index</span></span></span><br><span><var>Hinit</var><span class="hyp-type"><b>: </b><span>composite_state_destructor
  (state_update IM s j (destination item j)) j =
[]</span></span></span><br><span><var>Hs'</var><span class="hyp-type"><b>: </b><span>valid_state_prop RFree
  (state_update IM s j (destination item j))</span></span></span><br><span><var>Hdestruct</var><span class="hyp-type"><b>: </b><span>(item, s)
‚àà composite_state_destructor
    (state_update IM s j
       (destination item j)) j</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">s j = state_update IM s j (destination item j) j</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><span class="alectryon-input"><span class="nb">rewrite</span> Hinit <span class="kr">in</span> Hdestruct; <span class="nb">inversion</span> Hdestruct.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Qed</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
</span><span class="alectryon-sentence"><input class="alectryon-toggle" id="TraceableVLSM-v-chk66" style="display: none" type="checkbox"><label class="alectryon-input" for="TraceableVLSM-v-chk66"><span class="kn">Lemma</span> <span class="nf">composite_tv_state_destructor_size</span> :
  <span class="kr">forall</span> (<span class="nv">s&#39;</span> : composite_state IM), valid_state_prop RFree s&#39; -&gt;
  <span class="kr">forall</span> (<span class="nv">s</span> : composite_state IM) (<span class="nv">item</span> : composite_transition_item IM) (<span class="nv">i</span> : index),
    (item, s) ‚àà composite_state_destructor s&#39; i -&gt;
    composite_state_size s &lt; composite_state_size s&#39;.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>message, index</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>EqDecision0</var><span class="hyp-type"><b>: </b><span>EqDecision index</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>finite.Finite index</span></span></span><br><span><var>IM</var><span class="hyp-type"><b>: </b><span>index ‚Üí VLSM message</span></span></span><br><span><var>state_destructor</var><span class="hyp-type"><b>: </b><span><span class="kr">‚àÄ</span> <span class="nv">i</span> : index,
  vstate (IM i)
  ‚Üí list
      (vtransition_item (IM i) *
       vstate (IM i))</span></span></span><br><span><var>state_size</var><span class="hyp-type"><b>: </b><span><span class="kr">‚àÄ</span> <span class="nv">i</span> : index, vstate (IM i) ‚Üí nat</span></span></span><br><span><var>H0</var><span class="hyp-type"><b>: </b><span><span class="kr">‚àÄ</span> <span class="nv">i</span> : index,
  TraceableVLSM (IM i) 
    (state_destructor i) 
    (state_size i)</span></span></span><br><span><var>Free</var><span><span class="hyp-body"><b>:= </b><span>free_composite_vlsm IM</span></span><span class="hyp-type"><b>: </b><span>VLSM message</span></span></span></span><br><span><var>RFree</var><span><span class="hyp-body"><b>:= </b><span>pre_loaded_with_all_messages_vlsm Free</span></span><span class="hyp-type"><b>: </b><span>VLSM message</span></span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="kr">‚àÄ</span> <span class="nv">s&#39;</span> : composite_state IM,
  valid_state_prop RFree s&#39;
  ‚Üí <span class="kr">‚àÄ</span> (<span class="nv">s</span> : composite_state IM) (<span class="nv">item</span> : composite_transition_item
                                         IM) (<span class="nv">i</span> : index),
      (item, s) ‚àà composite_state_destructor s&#39; i
      ‚Üí composite_state_size s &lt;
        composite_state_size s&#39;</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="TraceableVLSM-v-chk67" style="display: none" type="checkbox"><label class="alectryon-input" for="TraceableVLSM-v-chk67"><span class="kn">Proof</span>.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>message, index</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>EqDecision0</var><span class="hyp-type"><b>: </b><span>EqDecision index</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>finite.Finite index</span></span></span><br><span><var>IM</var><span class="hyp-type"><b>: </b><span>index ‚Üí VLSM message</span></span></span><br><span><var>state_destructor</var><span class="hyp-type"><b>: </b><span><span class="kr">‚àÄ</span> <span class="nv">i</span> : index,
  vstate (IM i)
  ‚Üí list
      (vtransition_item (IM i) *
       vstate (IM i))</span></span></span><br><span><var>state_size</var><span class="hyp-type"><b>: </b><span><span class="kr">‚àÄ</span> <span class="nv">i</span> : index, vstate (IM i) ‚Üí nat</span></span></span><br><span><var>H0</var><span class="hyp-type"><b>: </b><span><span class="kr">‚àÄ</span> <span class="nv">i</span> : index,
  TraceableVLSM (IM i) 
    (state_destructor i) 
    (state_size i)</span></span></span><br><span><var>Free</var><span><span class="hyp-body"><b>:= </b><span>free_composite_vlsm IM</span></span><span class="hyp-type"><b>: </b><span>VLSM message</span></span></span></span><br><span><var>RFree</var><span><span class="hyp-body"><b>:= </b><span>pre_loaded_with_all_messages_vlsm Free</span></span><span class="hyp-type"><b>: </b><span>VLSM message</span></span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="kr">‚àÄ</span> <span class="nv">s&#39;</span> : composite_state IM,
  valid_state_prop RFree s&#39;
  ‚Üí <span class="kr">‚àÄ</span> (<span class="nv">s</span> : composite_state IM) (<span class="nv">item</span> : composite_transition_item
                                         IM) (<span class="nv">i</span> : index),
      (item, s) ‚àà composite_state_destructor s&#39; i
      ‚Üí composite_state_size s &lt;
        composite_state_size s&#39;</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="TraceableVLSM-v-chk68" style="display: none" type="checkbox"><label class="alectryon-input" for="TraceableVLSM-v-chk68"><span class="nb">intros</span> s&#39; Hs&#39; s item i.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>message, index</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>EqDecision0</var><span class="hyp-type"><b>: </b><span>EqDecision index</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>finite.Finite index</span></span></span><br><span><var>IM</var><span class="hyp-type"><b>: </b><span>index ‚Üí VLSM message</span></span></span><br><span><var>state_destructor</var><span class="hyp-type"><b>: </b><span><span class="kr">‚àÄ</span> <span class="nv">i</span> : index,
  vstate (IM i)
  ‚Üí list
      (vtransition_item (IM i) *
       vstate (IM i))</span></span></span><br><span><var>state_size</var><span class="hyp-type"><b>: </b><span><span class="kr">‚àÄ</span> <span class="nv">i</span> : index, vstate (IM i) ‚Üí nat</span></span></span><br><span><var>H0</var><span class="hyp-type"><b>: </b><span><span class="kr">‚àÄ</span> <span class="nv">i</span> : index,
  TraceableVLSM (IM i) 
    (state_destructor i) 
    (state_size i)</span></span></span><br><span><var>Free</var><span><span class="hyp-body"><b>:= </b><span>free_composite_vlsm IM</span></span><span class="hyp-type"><b>: </b><span>VLSM message</span></span></span></span><br><span><var>RFree</var><span><span class="hyp-body"><b>:= </b><span>pre_loaded_with_all_messages_vlsm Free</span></span><span class="hyp-type"><b>: </b><span>VLSM message</span></span></span></span><br><span><var>s'</var><span class="hyp-type"><b>: </b><span>composite_state IM</span></span></span><br><span><var>Hs'</var><span class="hyp-type"><b>: </b><span>valid_state_prop RFree s&#39;</span></span></span><br><span><var>s</var><span class="hyp-type"><b>: </b><span>composite_state IM</span></span></span><br><span><var>item</var><span class="hyp-type"><b>: </b><span>composite_transition_item IM</span></span></span><br><span><var>i</var><span class="hyp-type"><b>: </b><span>index</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">(item, s) ‚àà composite_state_destructor s&#39; i
‚Üí composite_state_size s &lt; composite_state_size s&#39;</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="TraceableVLSM-v-chk69" style="display: none" type="checkbox"><label class="alectryon-input" for="TraceableVLSM-v-chk69"><span class="nb">unfold</span> composite_state_destructor; <span class="nb">rewrite</span> elem_of_list_fmap.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>message, index</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>EqDecision0</var><span class="hyp-type"><b>: </b><span>EqDecision index</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>finite.Finite index</span></span></span><br><span><var>IM</var><span class="hyp-type"><b>: </b><span>index ‚Üí VLSM message</span></span></span><br><span><var>state_destructor</var><span class="hyp-type"><b>: </b><span><span class="kr">‚àÄ</span> <span class="nv">i</span> : index,
  vstate (IM i)
  ‚Üí list
      (vtransition_item (IM i) *
       vstate (IM i))</span></span></span><br><span><var>state_size</var><span class="hyp-type"><b>: </b><span><span class="kr">‚àÄ</span> <span class="nv">i</span> : index, vstate (IM i) ‚Üí nat</span></span></span><br><span><var>H0</var><span class="hyp-type"><b>: </b><span><span class="kr">‚àÄ</span> <span class="nv">i</span> : index,
  TraceableVLSM (IM i) 
    (state_destructor i) 
    (state_size i)</span></span></span><br><span><var>Free</var><span><span class="hyp-body"><b>:= </b><span>free_composite_vlsm IM</span></span><span class="hyp-type"><b>: </b><span>VLSM message</span></span></span></span><br><span><var>RFree</var><span><span class="hyp-body"><b>:= </b><span>pre_loaded_with_all_messages_vlsm Free</span></span><span class="hyp-type"><b>: </b><span>VLSM message</span></span></span></span><br><span><var>s'</var><span class="hyp-type"><b>: </b><span>composite_state IM</span></span></span><br><span><var>Hs'</var><span class="hyp-type"><b>: </b><span>valid_state_prop RFree s&#39;</span></span></span><br><span><var>s</var><span class="hyp-type"><b>: </b><span>composite_state IM</span></span></span><br><span><var>item</var><span class="hyp-type"><b>: </b><span>composite_transition_item IM</span></span></span><br><span><var>i</var><span class="hyp-type"><b>: </b><span>index</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">(<span class="kr">‚àÉ</span> <span class="nv">y</span> : vtransition_item (IM i) * vstate (IM i),
   (item, s) =
   lift_to_composite_transition_item_state s&#39; i y
   ‚àß y ‚àà state_destructor i (s&#39; i))
‚Üí composite_state_size s &lt; composite_state_size s&#39;</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="TraceableVLSM-v-chk6a" style="display: none" type="checkbox"><label class="alectryon-input" for="TraceableVLSM-v-chk6a"><span class="nb">intros</span> ([itemi si] &amp; [= -&gt; -&gt;] &amp; Hin).</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>message, index</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>EqDecision0</var><span class="hyp-type"><b>: </b><span>EqDecision index</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>finite.Finite index</span></span></span><br><span><var>IM</var><span class="hyp-type"><b>: </b><span>index ‚Üí VLSM message</span></span></span><br><span><var>state_destructor</var><span class="hyp-type"><b>: </b><span><span class="kr">‚àÄ</span> <span class="nv">i</span> : index,
  vstate (IM i)
  ‚Üí list
      (vtransition_item (IM i) *
       vstate (IM i))</span></span></span><br><span><var>state_size</var><span class="hyp-type"><b>: </b><span><span class="kr">‚àÄ</span> <span class="nv">i</span> : index, vstate (IM i) ‚Üí nat</span></span></span><br><span><var>H0</var><span class="hyp-type"><b>: </b><span><span class="kr">‚àÄ</span> <span class="nv">i</span> : index,
  TraceableVLSM (IM i) 
    (state_destructor i) 
    (state_size i)</span></span></span><br><span><var>Free</var><span><span class="hyp-body"><b>:= </b><span>free_composite_vlsm IM</span></span><span class="hyp-type"><b>: </b><span>VLSM message</span></span></span></span><br><span><var>RFree</var><span><span class="hyp-body"><b>:= </b><span>pre_loaded_with_all_messages_vlsm Free</span></span><span class="hyp-type"><b>: </b><span>VLSM message</span></span></span></span><br><span><var>s'</var><span class="hyp-type"><b>: </b><span>composite_state IM</span></span></span><br><span><var>Hs'</var><span class="hyp-type"><b>: </b><span>valid_state_prop RFree s&#39;</span></span></span><br><span><var>i</var><span class="hyp-type"><b>: </b><span>index</span></span></span><br><span><var>itemi</var><span class="hyp-type"><b>: </b><span>vtransition_item (IM i)</span></span></span><br><span><var>si</var><span class="hyp-type"><b>: </b><span>vstate (IM i)</span></span></span><br><span><var>Hin</var><span class="hyp-type"><b>: </b><span>(itemi, si) ‚àà state_destructor i (s&#39; i)</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">composite_state_size
  (lift_to_composite_state IM s&#39; i si) &lt;
composite_state_size s&#39;</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="TraceableVLSM-v-chk6b" style="display: none" type="checkbox"><label class="alectryon-input" for="TraceableVLSM-v-chk6b"><span class="nb">replace</span> s&#39; <span class="kr">with</span> (state_update IM (state_update IM s&#39; i si) i (s&#39; i)) <span class="nb">at</span> <span class="mi">2</span>.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>message, index</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>EqDecision0</var><span class="hyp-type"><b>: </b><span>EqDecision index</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>finite.Finite index</span></span></span><br><span><var>IM</var><span class="hyp-type"><b>: </b><span>index ‚Üí VLSM message</span></span></span><br><span><var>state_destructor</var><span class="hyp-type"><b>: </b><span><span class="kr">‚àÄ</span> <span class="nv">i</span> : index,
  vstate (IM i)
  ‚Üí list
      (vtransition_item (IM i) *
       vstate (IM i))</span></span></span><br><span><var>state_size</var><span class="hyp-type"><b>: </b><span><span class="kr">‚àÄ</span> <span class="nv">i</span> : index, vstate (IM i) ‚Üí nat</span></span></span><br><span><var>H0</var><span class="hyp-type"><b>: </b><span><span class="kr">‚àÄ</span> <span class="nv">i</span> : index,
  TraceableVLSM (IM i) 
    (state_destructor i) 
    (state_size i)</span></span></span><br><span><var>Free</var><span><span class="hyp-body"><b>:= </b><span>free_composite_vlsm IM</span></span><span class="hyp-type"><b>: </b><span>VLSM message</span></span></span></span><br><span><var>RFree</var><span><span class="hyp-body"><b>:= </b><span>pre_loaded_with_all_messages_vlsm Free</span></span><span class="hyp-type"><b>: </b><span>VLSM message</span></span></span></span><br><span><var>s'</var><span class="hyp-type"><b>: </b><span>composite_state IM</span></span></span><br><span><var>Hs'</var><span class="hyp-type"><b>: </b><span>valid_state_prop RFree s&#39;</span></span></span><br><span><var>i</var><span class="hyp-type"><b>: </b><span>index</span></span></span><br><span><var>itemi</var><span class="hyp-type"><b>: </b><span>vtransition_item (IM i)</span></span></span><br><span><var>si</var><span class="hyp-type"><b>: </b><span>vstate (IM i)</span></span></span><br><span><var>Hin</var><span class="hyp-type"><b>: </b><span>(itemi, si) ‚àà state_destructor i (s&#39; i)</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">composite_state_size
  (lift_to_composite_state IM s&#39; i si) &lt;
composite_state_size
  (state_update IM (state_update IM s&#39; i si) i (s&#39; i))</div></blockquote><div class="alectryon-extra-goals"><input class="alectryon-extra-goal-toggle" id="TraceableVLSM-v-chk6c" style="display: none" type="checkbox"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>message, index</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>EqDecision0</var><span class="hyp-type"><b>: </b><span>EqDecision index</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>finite.Finite index</span></span></span><br><span><var>IM</var><span class="hyp-type"><b>: </b><span>index ‚Üí VLSM message</span></span></span><br><span><var>state_destructor</var><span class="hyp-type"><b>: </b><span><span class="kr">‚àÄ</span> <span class="nv">i</span> : index,
  vstate (IM i)
  ‚Üí list
      (vtransition_item (IM i) *
       vstate (IM i))</span></span></span><br><span><var>state_size</var><span class="hyp-type"><b>: </b><span><span class="kr">‚àÄ</span> <span class="nv">i</span> : index, vstate (IM i) ‚Üí nat</span></span></span><br><span><var>H0</var><span class="hyp-type"><b>: </b><span><span class="kr">‚àÄ</span> <span class="nv">i</span> : index,
  TraceableVLSM (IM i) 
    (state_destructor i) 
    (state_size i)</span></span></span><br><span><var>Free</var><span><span class="hyp-body"><b>:= </b><span>free_composite_vlsm IM</span></span><span class="hyp-type"><b>: </b><span>VLSM message</span></span></span></span><br><span><var>RFree</var><span><span class="hyp-body"><b>:= </b><span>pre_loaded_with_all_messages_vlsm Free</span></span><span class="hyp-type"><b>: </b><span>VLSM message</span></span></span></span><br><span><var>s'</var><span class="hyp-type"><b>: </b><span>composite_state IM</span></span></span><br><span><var>Hs'</var><span class="hyp-type"><b>: </b><span>valid_state_prop RFree s&#39;</span></span></span><br><span><var>i</var><span class="hyp-type"><b>: </b><span>index</span></span></span><br><span><var>itemi</var><span class="hyp-type"><b>: </b><span>vtransition_item (IM i)</span></span></span><br><span><var>si</var><span class="hyp-type"><b>: </b><span>vstate (IM i)</span></span></span><br><span><var>Hin</var><span class="hyp-type"><b>: </b><span>(itemi, si) ‚àà state_destructor i (s&#39; i)</span></span></span><br></div><label class="goal-separator" for="TraceableVLSM-v-chk6c"><hr></label><div class="goal-conclusion">state_update IM (state_update IM s&#39; i si) i (s&#39; i) =
s&#39;</div></blockquote></div></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="TraceableVLSM-v-chk6d" style="display: none" type="checkbox"><label class="alectryon-input" for="TraceableVLSM-v-chk6d">-</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>message, index</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>EqDecision0</var><span class="hyp-type"><b>: </b><span>EqDecision index</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>finite.Finite index</span></span></span><br><span><var>IM</var><span class="hyp-type"><b>: </b><span>index ‚Üí VLSM message</span></span></span><br><span><var>state_destructor</var><span class="hyp-type"><b>: </b><span><span class="kr">‚àÄ</span> <span class="nv">i</span> : index,
  vstate (IM i)
  ‚Üí list
      (vtransition_item (IM i) *
       vstate (IM i))</span></span></span><br><span><var>state_size</var><span class="hyp-type"><b>: </b><span><span class="kr">‚àÄ</span> <span class="nv">i</span> : index, vstate (IM i) ‚Üí nat</span></span></span><br><span><var>H0</var><span class="hyp-type"><b>: </b><span><span class="kr">‚àÄ</span> <span class="nv">i</span> : index,
  TraceableVLSM (IM i) 
    (state_destructor i) 
    (state_size i)</span></span></span><br><span><var>Free</var><span><span class="hyp-body"><b>:= </b><span>free_composite_vlsm IM</span></span><span class="hyp-type"><b>: </b><span>VLSM message</span></span></span></span><br><span><var>RFree</var><span><span class="hyp-body"><b>:= </b><span>pre_loaded_with_all_messages_vlsm Free</span></span><span class="hyp-type"><b>: </b><span>VLSM message</span></span></span></span><br><span><var>s'</var><span class="hyp-type"><b>: </b><span>composite_state IM</span></span></span><br><span><var>Hs'</var><span class="hyp-type"><b>: </b><span>valid_state_prop RFree s&#39;</span></span></span><br><span><var>i</var><span class="hyp-type"><b>: </b><span>index</span></span></span><br><span><var>itemi</var><span class="hyp-type"><b>: </b><span>vtransition_item (IM i)</span></span></span><br><span><var>si</var><span class="hyp-type"><b>: </b><span>vstate (IM i)</span></span></span><br><span><var>Hin</var><span class="hyp-type"><b>: </b><span>(itemi, si) ‚àà state_destructor i (s&#39; i)</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">composite_state_size
  (lift_to_composite_state IM s&#39; i si) &lt;
composite_state_size
  (state_update IM (state_update IM s&#39; i si) i (s&#39; i))</div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="TraceableVLSM-v-chk6e" style="display: none" type="checkbox"><label class="alectryon-input" for="TraceableVLSM-v-chk6e"><span class="nb">apply</span> composite_state_update_size_monotone.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>message, index</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>EqDecision0</var><span class="hyp-type"><b>: </b><span>EqDecision index</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>finite.Finite index</span></span></span><br><span><var>IM</var><span class="hyp-type"><b>: </b><span>index ‚Üí VLSM message</span></span></span><br><span><var>state_destructor</var><span class="hyp-type"><b>: </b><span><span class="kr">‚àÄ</span> <span class="nv">i</span> : index,
  vstate (IM i)
  ‚Üí list
      (vtransition_item (IM i) *
       vstate (IM i))</span></span></span><br><span><var>state_size</var><span class="hyp-type"><b>: </b><span><span class="kr">‚àÄ</span> <span class="nv">i</span> : index, vstate (IM i) ‚Üí nat</span></span></span><br><span><var>H0</var><span class="hyp-type"><b>: </b><span><span class="kr">‚àÄ</span> <span class="nv">i</span> : index,
  TraceableVLSM (IM i) 
    (state_destructor i) 
    (state_size i)</span></span></span><br><span><var>Free</var><span><span class="hyp-body"><b>:= </b><span>free_composite_vlsm IM</span></span><span class="hyp-type"><b>: </b><span>VLSM message</span></span></span></span><br><span><var>RFree</var><span><span class="hyp-body"><b>:= </b><span>pre_loaded_with_all_messages_vlsm Free</span></span><span class="hyp-type"><b>: </b><span>VLSM message</span></span></span></span><br><span><var>s'</var><span class="hyp-type"><b>: </b><span>composite_state IM</span></span></span><br><span><var>Hs'</var><span class="hyp-type"><b>: </b><span>valid_state_prop RFree s&#39;</span></span></span><br><span><var>i</var><span class="hyp-type"><b>: </b><span>index</span></span></span><br><span><var>itemi</var><span class="hyp-type"><b>: </b><span>vtransition_item (IM i)</span></span></span><br><span><var>si</var><span class="hyp-type"><b>: </b><span>vstate (IM i)</span></span></span><br><span><var>Hin</var><span class="hyp-type"><b>: </b><span>(itemi, si) ‚àà state_destructor i (s&#39; i)</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">state_size i (state_update IM s&#39; i si i) &lt;
state_size i (s&#39; i)</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="TraceableVLSM-v-chk6f" style="display: none" type="checkbox"><label class="alectryon-input" for="TraceableVLSM-v-chk6f">state_update_simpl.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>message, index</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>EqDecision0</var><span class="hyp-type"><b>: </b><span>EqDecision index</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>finite.Finite index</span></span></span><br><span><var>IM</var><span class="hyp-type"><b>: </b><span>index ‚Üí VLSM message</span></span></span><br><span><var>state_destructor</var><span class="hyp-type"><b>: </b><span><span class="kr">‚àÄ</span> <span class="nv">i</span> : index,
  vstate (IM i)
  ‚Üí list
      (vtransition_item (IM i) *
       vstate (IM i))</span></span></span><br><span><var>state_size</var><span class="hyp-type"><b>: </b><span><span class="kr">‚àÄ</span> <span class="nv">i</span> : index, vstate (IM i) ‚Üí nat</span></span></span><br><span><var>H0</var><span class="hyp-type"><b>: </b><span><span class="kr">‚àÄ</span> <span class="nv">i</span> : index,
  TraceableVLSM (IM i) 
    (state_destructor i) 
    (state_size i)</span></span></span><br><span><var>Free</var><span><span class="hyp-body"><b>:= </b><span>free_composite_vlsm IM</span></span><span class="hyp-type"><b>: </b><span>VLSM message</span></span></span></span><br><span><var>RFree</var><span><span class="hyp-body"><b>:= </b><span>pre_loaded_with_all_messages_vlsm Free</span></span><span class="hyp-type"><b>: </b><span>VLSM message</span></span></span></span><br><span><var>s'</var><span class="hyp-type"><b>: </b><span>composite_state IM</span></span></span><br><span><var>Hs'</var><span class="hyp-type"><b>: </b><span>valid_state_prop RFree s&#39;</span></span></span><br><span><var>i</var><span class="hyp-type"><b>: </b><span>index</span></span></span><br><span><var>itemi</var><span class="hyp-type"><b>: </b><span>vtransition_item (IM i)</span></span></span><br><span><var>si</var><span class="hyp-type"><b>: </b><span>vstate (IM i)</span></span></span><br><span><var>Hin</var><span class="hyp-type"><b>: </b><span>(itemi, si) ‚àà state_destructor i (s&#39; i)</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">state_size i si &lt; state_size i (s&#39; i)</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="TraceableVLSM-v-chk70" style="display: none" type="checkbox"><label class="alectryon-input" for="TraceableVLSM-v-chk70"><span class="nb">eapply</span> tv_state_destructor_size; [<span class="bp">done</span> | | <span class="bp">done</span>].</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>message, index</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>EqDecision0</var><span class="hyp-type"><b>: </b><span>EqDecision index</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>finite.Finite index</span></span></span><br><span><var>IM</var><span class="hyp-type"><b>: </b><span>index ‚Üí VLSM message</span></span></span><br><span><var>state_destructor</var><span class="hyp-type"><b>: </b><span><span class="kr">‚àÄ</span> <span class="nv">i</span> : index,
  vstate (IM i)
  ‚Üí list
      (vtransition_item (IM i) *
       vstate (IM i))</span></span></span><br><span><var>state_size</var><span class="hyp-type"><b>: </b><span><span class="kr">‚àÄ</span> <span class="nv">i</span> : index, vstate (IM i) ‚Üí nat</span></span></span><br><span><var>H0</var><span class="hyp-type"><b>: </b><span><span class="kr">‚àÄ</span> <span class="nv">i</span> : index,
  TraceableVLSM (IM i) 
    (state_destructor i) 
    (state_size i)</span></span></span><br><span><var>Free</var><span><span class="hyp-body"><b>:= </b><span>free_composite_vlsm IM</span></span><span class="hyp-type"><b>: </b><span>VLSM message</span></span></span></span><br><span><var>RFree</var><span><span class="hyp-body"><b>:= </b><span>pre_loaded_with_all_messages_vlsm Free</span></span><span class="hyp-type"><b>: </b><span>VLSM message</span></span></span></span><br><span><var>s'</var><span class="hyp-type"><b>: </b><span>composite_state IM</span></span></span><br><span><var>Hs'</var><span class="hyp-type"><b>: </b><span>valid_state_prop RFree s&#39;</span></span></span><br><span><var>i</var><span class="hyp-type"><b>: </b><span>index</span></span></span><br><span><var>itemi</var><span class="hyp-type"><b>: </b><span>vtransition_item (IM i)</span></span></span><br><span><var>si</var><span class="hyp-type"><b>: </b><span>vstate (IM i)</span></span></span><br><span><var>Hin</var><span class="hyp-type"><b>: </b><span>(itemi, si) ‚àà state_destructor i (s&#39; i)</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">valid_state_prop
  (pre_loaded_with_all_messages_vlsm (IM i)) (s&#39; i)</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><span class="alectryon-input"><span class="bp">by</span> <span class="nb">eapply</span> valid_state_project_preloaded_to_preloaded.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="TraceableVLSM-v-chk71" style="display: none" type="checkbox"><label class="alectryon-input" for="TraceableVLSM-v-chk71">-</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>message, index</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>EqDecision0</var><span class="hyp-type"><b>: </b><span>EqDecision index</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>finite.Finite index</span></span></span><br><span><var>IM</var><span class="hyp-type"><b>: </b><span>index ‚Üí VLSM message</span></span></span><br><span><var>state_destructor</var><span class="hyp-type"><b>: </b><span><span class="kr">‚àÄ</span> <span class="nv">i</span> : index,
  vstate (IM i)
  ‚Üí list
      (vtransition_item (IM i) *
       vstate (IM i))</span></span></span><br><span><var>state_size</var><span class="hyp-type"><b>: </b><span><span class="kr">‚àÄ</span> <span class="nv">i</span> : index, vstate (IM i) ‚Üí nat</span></span></span><br><span><var>H0</var><span class="hyp-type"><b>: </b><span><span class="kr">‚àÄ</span> <span class="nv">i</span> : index,
  TraceableVLSM (IM i) 
    (state_destructor i) 
    (state_size i)</span></span></span><br><span><var>Free</var><span><span class="hyp-body"><b>:= </b><span>free_composite_vlsm IM</span></span><span class="hyp-type"><b>: </b><span>VLSM message</span></span></span></span><br><span><var>RFree</var><span><span class="hyp-body"><b>:= </b><span>pre_loaded_with_all_messages_vlsm Free</span></span><span class="hyp-type"><b>: </b><span>VLSM message</span></span></span></span><br><span><var>s'</var><span class="hyp-type"><b>: </b><span>composite_state IM</span></span></span><br><span><var>Hs'</var><span class="hyp-type"><b>: </b><span>valid_state_prop RFree s&#39;</span></span></span><br><span><var>i</var><span class="hyp-type"><b>: </b><span>index</span></span></span><br><span><var>itemi</var><span class="hyp-type"><b>: </b><span>vtransition_item (IM i)</span></span></span><br><span><var>si</var><span class="hyp-type"><b>: </b><span>vstate (IM i)</span></span></span><br><span><var>Hin</var><span class="hyp-type"><b>: </b><span>(itemi, si) ‚àà state_destructor i (s&#39; i)</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">state_update IM (state_update IM s&#39; i si) i (s&#39; i) =
s&#39;</div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="bp">by</span> <span class="nb">rewrite</span> state_update_twice, state_update_id.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Qed</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
</span><span class="alectryon-sentence"><input class="alectryon-toggle" id="TraceableVLSM-v-chk72" style="display: none" type="checkbox"><label class="alectryon-input" for="TraceableVLSM-v-chk72"><span class="kn">Lemma</span> <span class="nf">composite_state_destructor_lookup_reachable</span> :
  <span class="kr">forall</span> <span class="nv">s&#39;</span> : composite_state IM, valid_state_prop RFree s&#39; -&gt;
  <span class="kr">forall</span> <span class="nv">i</span> <span class="nv">n</span> <span class="nv">item</span> <span class="nv">s</span>, composite_state_destructor s&#39; i !! n = Some (item, s) -&gt;
    input_valid_transition_item RFree s item.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>message, index</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>EqDecision0</var><span class="hyp-type"><b>: </b><span>EqDecision index</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>finite.Finite index</span></span></span><br><span><var>IM</var><span class="hyp-type"><b>: </b><span>index ‚Üí VLSM message</span></span></span><br><span><var>state_destructor</var><span class="hyp-type"><b>: </b><span><span class="kr">‚àÄ</span> <span class="nv">i</span> : index,
  vstate (IM i)
  ‚Üí list
      (vtransition_item (IM i) *
       vstate (IM i))</span></span></span><br><span><var>state_size</var><span class="hyp-type"><b>: </b><span><span class="kr">‚àÄ</span> <span class="nv">i</span> : index, vstate (IM i) ‚Üí nat</span></span></span><br><span><var>H0</var><span class="hyp-type"><b>: </b><span><span class="kr">‚àÄ</span> <span class="nv">i</span> : index,
  TraceableVLSM (IM i) 
    (state_destructor i) 
    (state_size i)</span></span></span><br><span><var>Free</var><span><span class="hyp-body"><b>:= </b><span>free_composite_vlsm IM</span></span><span class="hyp-type"><b>: </b><span>VLSM message</span></span></span></span><br><span><var>RFree</var><span><span class="hyp-body"><b>:= </b><span>pre_loaded_with_all_messages_vlsm Free</span></span><span class="hyp-type"><b>: </b><span>VLSM message</span></span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="kr">‚àÄ</span> <span class="nv">s&#39;</span> : composite_state IM,
  valid_state_prop RFree s&#39;
  ‚Üí <span class="kr">‚àÄ</span> (<span class="nv">i</span> : index) (<span class="nv">n</span> : nat) (<span class="nv">item</span> : transition_item) 
      (<span class="nv">s</span> : state),
      composite_state_destructor s&#39; i !! n =
      Some (item, s)
      ‚Üí input_valid_transition_item RFree s item</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="TraceableVLSM-v-chk73" style="display: none" type="checkbox"><label class="alectryon-input" for="TraceableVLSM-v-chk73"><span class="kn">Proof</span>.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>message, index</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>EqDecision0</var><span class="hyp-type"><b>: </b><span>EqDecision index</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>finite.Finite index</span></span></span><br><span><var>IM</var><span class="hyp-type"><b>: </b><span>index ‚Üí VLSM message</span></span></span><br><span><var>state_destructor</var><span class="hyp-type"><b>: </b><span><span class="kr">‚àÄ</span> <span class="nv">i</span> : index,
  vstate (IM i)
  ‚Üí list
      (vtransition_item (IM i) *
       vstate (IM i))</span></span></span><br><span><var>state_size</var><span class="hyp-type"><b>: </b><span><span class="kr">‚àÄ</span> <span class="nv">i</span> : index, vstate (IM i) ‚Üí nat</span></span></span><br><span><var>H0</var><span class="hyp-type"><b>: </b><span><span class="kr">‚àÄ</span> <span class="nv">i</span> : index,
  TraceableVLSM (IM i) 
    (state_destructor i) 
    (state_size i)</span></span></span><br><span><var>Free</var><span><span class="hyp-body"><b>:= </b><span>free_composite_vlsm IM</span></span><span class="hyp-type"><b>: </b><span>VLSM message</span></span></span></span><br><span><var>RFree</var><span><span class="hyp-body"><b>:= </b><span>pre_loaded_with_all_messages_vlsm Free</span></span><span class="hyp-type"><b>: </b><span>VLSM message</span></span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="kr">‚àÄ</span> <span class="nv">s&#39;</span> : composite_state IM,
  valid_state_prop RFree s&#39;
  ‚Üí <span class="kr">‚àÄ</span> (<span class="nv">i</span> : index) (<span class="nv">n</span> : nat) (<span class="nv">item</span> : transition_item) 
      (<span class="nv">s</span> : state),
      composite_state_destructor s&#39; i !! n =
      Some (item, s)
      ‚Üí input_valid_transition_item RFree s item</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="TraceableVLSM-v-chk74" style="display: none" type="checkbox"><label class="alectryon-input" for="TraceableVLSM-v-chk74"><span class="nb">intros</span> s&#39; Hs&#39; i n item s Hdestruct.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>message, index</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>EqDecision0</var><span class="hyp-type"><b>: </b><span>EqDecision index</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>finite.Finite index</span></span></span><br><span><var>IM</var><span class="hyp-type"><b>: </b><span>index ‚Üí VLSM message</span></span></span><br><span><var>state_destructor</var><span class="hyp-type"><b>: </b><span><span class="kr">‚àÄ</span> <span class="nv">i</span> : index,
  vstate (IM i)
  ‚Üí list
      (vtransition_item (IM i) *
       vstate (IM i))</span></span></span><br><span><var>state_size</var><span class="hyp-type"><b>: </b><span><span class="kr">‚àÄ</span> <span class="nv">i</span> : index, vstate (IM i) ‚Üí nat</span></span></span><br><span><var>H0</var><span class="hyp-type"><b>: </b><span><span class="kr">‚àÄ</span> <span class="nv">i</span> : index,
  TraceableVLSM (IM i) 
    (state_destructor i) 
    (state_size i)</span></span></span><br><span><var>Free</var><span><span class="hyp-body"><b>:= </b><span>free_composite_vlsm IM</span></span><span class="hyp-type"><b>: </b><span>VLSM message</span></span></span></span><br><span><var>RFree</var><span><span class="hyp-body"><b>:= </b><span>pre_loaded_with_all_messages_vlsm Free</span></span><span class="hyp-type"><b>: </b><span>VLSM message</span></span></span></span><br><span><var>s'</var><span class="hyp-type"><b>: </b><span>composite_state IM</span></span></span><br><span><var>Hs'</var><span class="hyp-type"><b>: </b><span>valid_state_prop RFree s&#39;</span></span></span><br><span><var>i</var><span class="hyp-type"><b>: </b><span>index</span></span></span><br><span><var>n</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>item</var><span class="hyp-type"><b>: </b><span>transition_item</span></span></span><br><span><var>s</var><span class="hyp-type"><b>: </b><span>state</span></span></span><br><span><var>Hdestruct</var><span class="hyp-type"><b>: </b><span>composite_state_destructor s&#39; i !! n =
Some (item, s)</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">input_valid_transition_item RFree s item</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><span class="alectryon-input"><span class="bp">by</span> <span class="nb">eapply</span> composite_tv_state_destructor_transition, elem_of_list_lookup_2.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Qed</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
</span><span class="alectryon-sentence"><input class="alectryon-toggle" id="TraceableVLSM-v-chk75" style="display: none" type="checkbox"><label class="alectryon-input" for="TraceableVLSM-v-chk75"><span class="kn">Lemma</span> <span class="nf">composite_state_destructor_head_reachable</span> :
  <span class="kr">forall</span> <span class="nv">s&#39;</span> : composite_state IM, valid_state_prop RFree s&#39; -&gt;
  <span class="kr">forall</span> <span class="nv">i</span> <span class="nv">item</span> <span class="nv">s</span>, head (composite_state_destructor s&#39; i) = Some (item, s) -&gt;
  input_valid_transition_item RFree s item.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>message, index</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>EqDecision0</var><span class="hyp-type"><b>: </b><span>EqDecision index</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>finite.Finite index</span></span></span><br><span><var>IM</var><span class="hyp-type"><b>: </b><span>index ‚Üí VLSM message</span></span></span><br><span><var>state_destructor</var><span class="hyp-type"><b>: </b><span><span class="kr">‚àÄ</span> <span class="nv">i</span> : index,
  vstate (IM i)
  ‚Üí list
      (vtransition_item (IM i) *
       vstate (IM i))</span></span></span><br><span><var>state_size</var><span class="hyp-type"><b>: </b><span><span class="kr">‚àÄ</span> <span class="nv">i</span> : index, vstate (IM i) ‚Üí nat</span></span></span><br><span><var>H0</var><span class="hyp-type"><b>: </b><span><span class="kr">‚àÄ</span> <span class="nv">i</span> : index,
  TraceableVLSM (IM i) 
    (state_destructor i) 
    (state_size i)</span></span></span><br><span><var>Free</var><span><span class="hyp-body"><b>:= </b><span>free_composite_vlsm IM</span></span><span class="hyp-type"><b>: </b><span>VLSM message</span></span></span></span><br><span><var>RFree</var><span><span class="hyp-body"><b>:= </b><span>pre_loaded_with_all_messages_vlsm Free</span></span><span class="hyp-type"><b>: </b><span>VLSM message</span></span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="kr">‚àÄ</span> <span class="nv">s&#39;</span> : composite_state IM,
  valid_state_prop RFree s&#39;
  ‚Üí <span class="kr">‚àÄ</span> (<span class="nv">i</span> : index) (<span class="nv">item</span> : composite_transition_item IM) 
      (<span class="nv">s</span> : composite_state IM),
      head (composite_state_destructor s&#39; i) =
      Some (item, s)
      ‚Üí input_valid_transition_item RFree s item</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="TraceableVLSM-v-chk76" style="display: none" type="checkbox"><label class="alectryon-input" for="TraceableVLSM-v-chk76"><span class="kn">Proof</span>.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>message, index</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>EqDecision0</var><span class="hyp-type"><b>: </b><span>EqDecision index</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>finite.Finite index</span></span></span><br><span><var>IM</var><span class="hyp-type"><b>: </b><span>index ‚Üí VLSM message</span></span></span><br><span><var>state_destructor</var><span class="hyp-type"><b>: </b><span><span class="kr">‚àÄ</span> <span class="nv">i</span> : index,
  vstate (IM i)
  ‚Üí list
      (vtransition_item (IM i) *
       vstate (IM i))</span></span></span><br><span><var>state_size</var><span class="hyp-type"><b>: </b><span><span class="kr">‚àÄ</span> <span class="nv">i</span> : index, vstate (IM i) ‚Üí nat</span></span></span><br><span><var>H0</var><span class="hyp-type"><b>: </b><span><span class="kr">‚àÄ</span> <span class="nv">i</span> : index,
  TraceableVLSM (IM i) 
    (state_destructor i) 
    (state_size i)</span></span></span><br><span><var>Free</var><span><span class="hyp-body"><b>:= </b><span>free_composite_vlsm IM</span></span><span class="hyp-type"><b>: </b><span>VLSM message</span></span></span></span><br><span><var>RFree</var><span><span class="hyp-body"><b>:= </b><span>pre_loaded_with_all_messages_vlsm Free</span></span><span class="hyp-type"><b>: </b><span>VLSM message</span></span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="kr">‚àÄ</span> <span class="nv">s&#39;</span> : composite_state IM,
  valid_state_prop RFree s&#39;
  ‚Üí <span class="kr">‚àÄ</span> (<span class="nv">i</span> : index) (<span class="nv">item</span> : composite_transition_item IM) 
      (<span class="nv">s</span> : composite_state IM),
      head (composite_state_destructor s&#39; i) =
      Some (item, s)
      ‚Üí input_valid_transition_item RFree s item</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="TraceableVLSM-v-chk77" style="display: none" type="checkbox"><label class="alectryon-input" for="TraceableVLSM-v-chk77"><span class="nb">intros</span> s&#39; Hs&#39; i item s Hdestruct.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>message, index</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>EqDecision0</var><span class="hyp-type"><b>: </b><span>EqDecision index</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>finite.Finite index</span></span></span><br><span><var>IM</var><span class="hyp-type"><b>: </b><span>index ‚Üí VLSM message</span></span></span><br><span><var>state_destructor</var><span class="hyp-type"><b>: </b><span><span class="kr">‚àÄ</span> <span class="nv">i</span> : index,
  vstate (IM i)
  ‚Üí list
      (vtransition_item (IM i) *
       vstate (IM i))</span></span></span><br><span><var>state_size</var><span class="hyp-type"><b>: </b><span><span class="kr">‚àÄ</span> <span class="nv">i</span> : index, vstate (IM i) ‚Üí nat</span></span></span><br><span><var>H0</var><span class="hyp-type"><b>: </b><span><span class="kr">‚àÄ</span> <span class="nv">i</span> : index,
  TraceableVLSM (IM i) 
    (state_destructor i) 
    (state_size i)</span></span></span><br><span><var>Free</var><span><span class="hyp-body"><b>:= </b><span>free_composite_vlsm IM</span></span><span class="hyp-type"><b>: </b><span>VLSM message</span></span></span></span><br><span><var>RFree</var><span><span class="hyp-body"><b>:= </b><span>pre_loaded_with_all_messages_vlsm Free</span></span><span class="hyp-type"><b>: </b><span>VLSM message</span></span></span></span><br><span><var>s'</var><span class="hyp-type"><b>: </b><span>composite_state IM</span></span></span><br><span><var>Hs'</var><span class="hyp-type"><b>: </b><span>valid_state_prop RFree s&#39;</span></span></span><br><span><var>i</var><span class="hyp-type"><b>: </b><span>index</span></span></span><br><span><var>item</var><span class="hyp-type"><b>: </b><span>composite_transition_item IM</span></span></span><br><span><var>s</var><span class="hyp-type"><b>: </b><span>composite_state IM</span></span></span><br><span><var>Hdestruct</var><span class="hyp-type"><b>: </b><span>head (composite_state_destructor s&#39; i) =
Some (item, s)</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">input_valid_transition_item RFree s item</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><span class="alectryon-input"><span class="bp">by</span> <span class="nb">eapply</span> composite_tv_state_destructor_transition, head_Some_elem_of.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Qed</span>.</span></span></pre><div class="doc">
  Given a <span class="inlinecode"><span class="id" title="var">composite_state</span></span> for a composition of <span class="inlinecode"><span class="id" title="var">TraceableVLSM</span></span>s,
  <span class="inlinecode"><span class="id" title="var">composite_state_destructor</span></span> will return a set of possible transitions leading
  to that state. Therefore, when trying to reconstruct a particular trace leading
  to the given state, we must choose one among the possible transitions.

<div class="paragraph"> </div>

  Let us define the type of such a choice function, which takes a composite ram-state
  and a list of indices as arguments and returns one of the indices and a position
  in the list of possible transitions to the state for that particular index.

</div><pre class="alectryon-io highlight"><!-- Generator: Alectryon --><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Definition</span> <span class="nf">choice_function</span> : <span class="kt">Type</span> :=
  <span class="kr">forall</span> <span class="nv">s&#39;</span> : composite_state IM, valid_state_prop RFree s&#39; -&gt; list index -&gt; index * nat.</span></span></pre><div class="doc">
  Given a <span class="inlinecode"><span class="id" title="var">choice_function</span></span> and a particular instance of its arguments,
  we say that the choice function is choosing well, provided that:

<div class="paragraph"> </div>
<ul class="doclist">
<li> if the set of indices is non-empty, then the returned index must belong to it

<div class="paragraph"> </div>
</li>
<li> if the component state coresponding to the returned index in not initial, then
    the returned position must identify a transition leading to the given state

<div class="paragraph"> </div>
</li>
<li> the choice does not depend on the particular proof for the composite ram-state

</li>
</ul>
</div><pre class="alectryon-io highlight"><!-- Generator: Alectryon --><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Record</span> <span class="nf">ChoosingWell</span>
  (<span class="nv">choose</span> : choice_function)
  (<span class="nv">s&#39;</span> : composite_state IM)
  (<span class="nv">Hs&#39;</span> : valid_state_prop RFree s&#39;)
  (<span class="nv">indices</span> : list index)
  : <span class="kt">Prop</span> :=
{
  cw_proof_independent :
    <span class="kr">forall</span> <span class="nv">Hs&#39;&#39;</span> : valid_state_prop RFree s&#39;,
      choose s&#39; Hs&#39; indices = choose s&#39; Hs&#39;&#39; indices;
  cw_chosen_index_in_indices :
    indices ‚â† [] -&gt; (choose s&#39; Hs&#39; indices).<span class="mi">1</span> ‚àà indices;
  cw_chosen_position_exists :
    <span class="kr">forall</span> (<span class="nv">i</span> : index) (<span class="nv">n</span> : nat),
      choose s&#39; Hs&#39; indices = (i, n) -&gt;
      ~ vinitial_state_prop (IM i) (s&#39; i) -&gt;
      is_Some (composite_state_destructor s&#39; i !! n)
}.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
</span><span class="alectryon-sentence"><input class="alectryon-toggle" id="TraceableVLSM-v-chk78" style="display: none" type="checkbox"><label class="alectryon-input" for="TraceableVLSM-v-chk78"><span class="kn">Lemma</span> <span class="nf">choosing_well_position_exists</span> :
  <span class="kr">forall</span>
    (<span class="nv">choose</span> : choice_function)
    (<span class="nv">s&#39;</span> : composite_state IM) (<span class="nv">Hs&#39;</span> : valid_state_prop RFree s&#39;)
    (<span class="nv">indices</span> : list index) (<span class="nv">Hwell</span> : ChoosingWell choose s&#39; Hs&#39; indices)
    (<span class="nv">i_n</span> :=  choose s&#39; Hs&#39; indices),
      composite_state_destructor s&#39; i_n.<span class="mi">1</span> ‚â† [] -&gt;
      composite_state_destructor s&#39; i_n.<span class="mi">1</span> !! i_n.<span class="mi">2</span> ‚â† None.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>message, index</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>EqDecision0</var><span class="hyp-type"><b>: </b><span>EqDecision index</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>finite.Finite index</span></span></span><br><span><var>IM</var><span class="hyp-type"><b>: </b><span>index ‚Üí VLSM message</span></span></span><br><span><var>state_destructor</var><span class="hyp-type"><b>: </b><span><span class="kr">‚àÄ</span> <span class="nv">i</span> : index,
  vstate (IM i)
  ‚Üí list
      (vtransition_item (IM i) *
       vstate (IM i))</span></span></span><br><span><var>state_size</var><span class="hyp-type"><b>: </b><span><span class="kr">‚àÄ</span> <span class="nv">i</span> : index, vstate (IM i) ‚Üí nat</span></span></span><br><span><var>H0</var><span class="hyp-type"><b>: </b><span><span class="kr">‚àÄ</span> <span class="nv">i</span> : index,
  TraceableVLSM (IM i) 
    (state_destructor i) 
    (state_size i)</span></span></span><br><span><var>Free</var><span><span class="hyp-body"><b>:= </b><span>free_composite_vlsm IM</span></span><span class="hyp-type"><b>: </b><span>VLSM message</span></span></span></span><br><span><var>RFree</var><span><span class="hyp-body"><b>:= </b><span>pre_loaded_with_all_messages_vlsm Free</span></span><span class="hyp-type"><b>: </b><span>VLSM message</span></span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="kr">‚àÄ</span> (<span class="nv">choose</span> : choice_function) (<span class="nv">s&#39;</span> : composite_state IM) 
  (<span class="nv">Hs&#39;</span> : valid_state_prop RFree s&#39;) (<span class="nv">indices</span> : list
                                                 index),
  ChoosingWell choose s&#39; Hs&#39; indices
  ‚Üí <span class="kr">let</span> <span class="nv">i_n</span> := choose s&#39; Hs&#39; indices <span class="kr">in</span>
    composite_state_destructor s&#39; i_n.<span class="mi">1</span> ‚â† []
    ‚Üí composite_state_destructor s&#39; i_n.<span class="mi">1</span> !! i_n.<span class="mi">2</span>
      ‚â† None</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="TraceableVLSM-v-chk79" style="display: none" type="checkbox"><label class="alectryon-input" for="TraceableVLSM-v-chk79"><span class="kn">Proof</span>.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>message, index</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>EqDecision0</var><span class="hyp-type"><b>: </b><span>EqDecision index</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>finite.Finite index</span></span></span><br><span><var>IM</var><span class="hyp-type"><b>: </b><span>index ‚Üí VLSM message</span></span></span><br><span><var>state_destructor</var><span class="hyp-type"><b>: </b><span><span class="kr">‚àÄ</span> <span class="nv">i</span> : index,
  vstate (IM i)
  ‚Üí list
      (vtransition_item (IM i) *
       vstate (IM i))</span></span></span><br><span><var>state_size</var><span class="hyp-type"><b>: </b><span><span class="kr">‚àÄ</span> <span class="nv">i</span> : index, vstate (IM i) ‚Üí nat</span></span></span><br><span><var>H0</var><span class="hyp-type"><b>: </b><span><span class="kr">‚àÄ</span> <span class="nv">i</span> : index,
  TraceableVLSM (IM i) 
    (state_destructor i) 
    (state_size i)</span></span></span><br><span><var>Free</var><span><span class="hyp-body"><b>:= </b><span>free_composite_vlsm IM</span></span><span class="hyp-type"><b>: </b><span>VLSM message</span></span></span></span><br><span><var>RFree</var><span><span class="hyp-body"><b>:= </b><span>pre_loaded_with_all_messages_vlsm Free</span></span><span class="hyp-type"><b>: </b><span>VLSM message</span></span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="kr">‚àÄ</span> (<span class="nv">choose</span> : choice_function) (<span class="nv">s&#39;</span> : composite_state IM) 
  (<span class="nv">Hs&#39;</span> : valid_state_prop RFree s&#39;) (<span class="nv">indices</span> : list
                                                 index),
  ChoosingWell choose s&#39; Hs&#39; indices
  ‚Üí <span class="kr">let</span> <span class="nv">i_n</span> := choose s&#39; Hs&#39; indices <span class="kr">in</span>
    composite_state_destructor s&#39; i_n.<span class="mi">1</span> ‚â† []
    ‚Üí composite_state_destructor s&#39; i_n.<span class="mi">1</span> !! i_n.<span class="mi">2</span>
      ‚â† None</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="TraceableVLSM-v-chk7a" style="display: none" type="checkbox"><label class="alectryon-input" for="TraceableVLSM-v-chk7a"><span class="nb">intros</span> choose s&#39; Hs&#39; indices Hchoose i_n Hdestruct.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>message, index</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>EqDecision0</var><span class="hyp-type"><b>: </b><span>EqDecision index</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>finite.Finite index</span></span></span><br><span><var>IM</var><span class="hyp-type"><b>: </b><span>index ‚Üí VLSM message</span></span></span><br><span><var>state_destructor</var><span class="hyp-type"><b>: </b><span><span class="kr">‚àÄ</span> <span class="nv">i</span> : index,
  vstate (IM i)
  ‚Üí list
      (vtransition_item (IM i) *
       vstate (IM i))</span></span></span><br><span><var>state_size</var><span class="hyp-type"><b>: </b><span><span class="kr">‚àÄ</span> <span class="nv">i</span> : index, vstate (IM i) ‚Üí nat</span></span></span><br><span><var>H0</var><span class="hyp-type"><b>: </b><span><span class="kr">‚àÄ</span> <span class="nv">i</span> : index,
  TraceableVLSM (IM i) 
    (state_destructor i) 
    (state_size i)</span></span></span><br><span><var>Free</var><span><span class="hyp-body"><b>:= </b><span>free_composite_vlsm IM</span></span><span class="hyp-type"><b>: </b><span>VLSM message</span></span></span></span><br><span><var>RFree</var><span><span class="hyp-body"><b>:= </b><span>pre_loaded_with_all_messages_vlsm Free</span></span><span class="hyp-type"><b>: </b><span>VLSM message</span></span></span></span><br><span><var>choose</var><span class="hyp-type"><b>: </b><span>choice_function</span></span></span><br><span><var>s'</var><span class="hyp-type"><b>: </b><span>composite_state IM</span></span></span><br><span><var>Hs'</var><span class="hyp-type"><b>: </b><span>valid_state_prop RFree s&#39;</span></span></span><br><span><var>indices</var><span class="hyp-type"><b>: </b><span>list index</span></span></span><br><span><var>Hchoose</var><span class="hyp-type"><b>: </b><span>ChoosingWell choose s&#39; Hs&#39; indices</span></span></span><br><span><var>i_n</var><span><span class="hyp-body"><b>:= </b><span>choose s&#39; Hs&#39; indices</span></span><span class="hyp-type"><b>: </b><span>(index * nat)%type</span></span></span></span><br><span><var>Hdestruct</var><span class="hyp-type"><b>: </b><span>composite_state_destructor s&#39; i_n.<span class="mi">1</span> ‚â† []</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">composite_state_destructor s&#39; i_n.<span class="mi">1</span> !! i_n.<span class="mi">2</span> ‚â† None</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="TraceableVLSM-v-chk7b" style="display: none" type="checkbox"><label class="alectryon-input" for="TraceableVLSM-v-chk7b"><span class="nb">eapply</span> not_eq_None_Some, cw_chosen_position_exists; [<span class="bp">done</span> | |].</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>message, index</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>EqDecision0</var><span class="hyp-type"><b>: </b><span>EqDecision index</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>finite.Finite index</span></span></span><br><span><var>IM</var><span class="hyp-type"><b>: </b><span>index ‚Üí VLSM message</span></span></span><br><span><var>state_destructor</var><span class="hyp-type"><b>: </b><span><span class="kr">‚àÄ</span> <span class="nv">i</span> : index,
  vstate (IM i)
  ‚Üí list
      (vtransition_item (IM i) *
       vstate (IM i))</span></span></span><br><span><var>state_size</var><span class="hyp-type"><b>: </b><span><span class="kr">‚àÄ</span> <span class="nv">i</span> : index, vstate (IM i) ‚Üí nat</span></span></span><br><span><var>H0</var><span class="hyp-type"><b>: </b><span><span class="kr">‚àÄ</span> <span class="nv">i</span> : index,
  TraceableVLSM (IM i) 
    (state_destructor i) 
    (state_size i)</span></span></span><br><span><var>Free</var><span><span class="hyp-body"><b>:= </b><span>free_composite_vlsm IM</span></span><span class="hyp-type"><b>: </b><span>VLSM message</span></span></span></span><br><span><var>RFree</var><span><span class="hyp-body"><b>:= </b><span>pre_loaded_with_all_messages_vlsm Free</span></span><span class="hyp-type"><b>: </b><span>VLSM message</span></span></span></span><br><span><var>choose</var><span class="hyp-type"><b>: </b><span>choice_function</span></span></span><br><span><var>s'</var><span class="hyp-type"><b>: </b><span>composite_state IM</span></span></span><br><span><var>Hs'</var><span class="hyp-type"><b>: </b><span>valid_state_prop RFree s&#39;</span></span></span><br><span><var>indices</var><span class="hyp-type"><b>: </b><span>list index</span></span></span><br><span><var>Hchoose</var><span class="hyp-type"><b>: </b><span>ChoosingWell choose s&#39; Hs&#39; indices</span></span></span><br><span><var>i_n</var><span><span class="hyp-body"><b>:= </b><span>choose s&#39; Hs&#39; indices</span></span><span class="hyp-type"><b>: </b><span>(index * nat)%type</span></span></span></span><br><span><var>Hdestruct</var><span class="hyp-type"><b>: </b><span>composite_state_destructor s&#39; i_n.<span class="mi">1</span> ‚â† []</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">choose s&#39; Hs&#39; indices = (i_n.<span class="mi">1</span>, i_n.<span class="mi">2</span>)</div></blockquote><div class="alectryon-extra-goals"><input class="alectryon-extra-goal-toggle" id="TraceableVLSM-v-chk7c" style="display: none" type="checkbox"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>message, index</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>EqDecision0</var><span class="hyp-type"><b>: </b><span>EqDecision index</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>finite.Finite index</span></span></span><br><span><var>IM</var><span class="hyp-type"><b>: </b><span>index ‚Üí VLSM message</span></span></span><br><span><var>state_destructor</var><span class="hyp-type"><b>: </b><span><span class="kr">‚àÄ</span> <span class="nv">i</span> : index,
  vstate (IM i)
  ‚Üí list
      (vtransition_item (IM i) *
       vstate (IM i))</span></span></span><br><span><var>state_size</var><span class="hyp-type"><b>: </b><span><span class="kr">‚àÄ</span> <span class="nv">i</span> : index, vstate (IM i) ‚Üí nat</span></span></span><br><span><var>H0</var><span class="hyp-type"><b>: </b><span><span class="kr">‚àÄ</span> <span class="nv">i</span> : index,
  TraceableVLSM (IM i) 
    (state_destructor i) 
    (state_size i)</span></span></span><br><span><var>Free</var><span><span class="hyp-body"><b>:= </b><span>free_composite_vlsm IM</span></span><span class="hyp-type"><b>: </b><span>VLSM message</span></span></span></span><br><span><var>RFree</var><span><span class="hyp-body"><b>:= </b><span>pre_loaded_with_all_messages_vlsm Free</span></span><span class="hyp-type"><b>: </b><span>VLSM message</span></span></span></span><br><span><var>choose</var><span class="hyp-type"><b>: </b><span>choice_function</span></span></span><br><span><var>s'</var><span class="hyp-type"><b>: </b><span>composite_state IM</span></span></span><br><span><var>Hs'</var><span class="hyp-type"><b>: </b><span>valid_state_prop RFree s&#39;</span></span></span><br><span><var>indices</var><span class="hyp-type"><b>: </b><span>list index</span></span></span><br><span><var>Hchoose</var><span class="hyp-type"><b>: </b><span>ChoosingWell choose s&#39; Hs&#39; indices</span></span></span><br><span><var>i_n</var><span><span class="hyp-body"><b>:= </b><span>choose s&#39; Hs&#39; indices</span></span><span class="hyp-type"><b>: </b><span>(index * nat)%type</span></span></span></span><br><span><var>Hdestruct</var><span class="hyp-type"><b>: </b><span>composite_state_destructor s&#39; i_n.<span class="mi">1</span> ‚â† []</span></span></span><br></div><label class="goal-separator" for="TraceableVLSM-v-chk7c"><hr></label><div class="goal-conclusion">¬¨ vinitial_state_prop (IM i_n.<span class="mi">1</span>) (s&#39; i_n.<span class="mi">1</span>)</div></blockquote></div></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="TraceableVLSM-v-chk7d" style="display: none" type="checkbox"><label class="alectryon-input" for="TraceableVLSM-v-chk7d">-</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>message, index</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>EqDecision0</var><span class="hyp-type"><b>: </b><span>EqDecision index</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>finite.Finite index</span></span></span><br><span><var>IM</var><span class="hyp-type"><b>: </b><span>index ‚Üí VLSM message</span></span></span><br><span><var>state_destructor</var><span class="hyp-type"><b>: </b><span><span class="kr">‚àÄ</span> <span class="nv">i</span> : index,
  vstate (IM i)
  ‚Üí list
      (vtransition_item (IM i) *
       vstate (IM i))</span></span></span><br><span><var>state_size</var><span class="hyp-type"><b>: </b><span><span class="kr">‚àÄ</span> <span class="nv">i</span> : index, vstate (IM i) ‚Üí nat</span></span></span><br><span><var>H0</var><span class="hyp-type"><b>: </b><span><span class="kr">‚àÄ</span> <span class="nv">i</span> : index,
  TraceableVLSM (IM i) 
    (state_destructor i) 
    (state_size i)</span></span></span><br><span><var>Free</var><span><span class="hyp-body"><b>:= </b><span>free_composite_vlsm IM</span></span><span class="hyp-type"><b>: </b><span>VLSM message</span></span></span></span><br><span><var>RFree</var><span><span class="hyp-body"><b>:= </b><span>pre_loaded_with_all_messages_vlsm Free</span></span><span class="hyp-type"><b>: </b><span>VLSM message</span></span></span></span><br><span><var>choose</var><span class="hyp-type"><b>: </b><span>choice_function</span></span></span><br><span><var>s'</var><span class="hyp-type"><b>: </b><span>composite_state IM</span></span></span><br><span><var>Hs'</var><span class="hyp-type"><b>: </b><span>valid_state_prop RFree s&#39;</span></span></span><br><span><var>indices</var><span class="hyp-type"><b>: </b><span>list index</span></span></span><br><span><var>Hchoose</var><span class="hyp-type"><b>: </b><span>ChoosingWell choose s&#39; Hs&#39; indices</span></span></span><br><span><var>i_n</var><span><span class="hyp-body"><b>:= </b><span>choose s&#39; Hs&#39; indices</span></span><span class="hyp-type"><b>: </b><span>(index * nat)%type</span></span></span></span><br><span><var>Hdestruct</var><span class="hyp-type"><b>: </b><span>composite_state_destructor s&#39; i_n.<span class="mi">1</span> ‚â† []</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">choose s&#39; Hs&#39; indices = (i_n.<span class="mi">1</span>, i_n.<span class="mi">2</span>)</div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="bp">by</span> <span class="nb">destruct</span> (choose _ _ _).</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="TraceableVLSM-v-chk7e" style="display: none" type="checkbox"><label class="alectryon-input" for="TraceableVLSM-v-chk7e">-</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>message, index</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>EqDecision0</var><span class="hyp-type"><b>: </b><span>EqDecision index</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>finite.Finite index</span></span></span><br><span><var>IM</var><span class="hyp-type"><b>: </b><span>index ‚Üí VLSM message</span></span></span><br><span><var>state_destructor</var><span class="hyp-type"><b>: </b><span><span class="kr">‚àÄ</span> <span class="nv">i</span> : index,
  vstate (IM i)
  ‚Üí list
      (vtransition_item (IM i) *
       vstate (IM i))</span></span></span><br><span><var>state_size</var><span class="hyp-type"><b>: </b><span><span class="kr">‚àÄ</span> <span class="nv">i</span> : index, vstate (IM i) ‚Üí nat</span></span></span><br><span><var>H0</var><span class="hyp-type"><b>: </b><span><span class="kr">‚àÄ</span> <span class="nv">i</span> : index,
  TraceableVLSM (IM i) 
    (state_destructor i) 
    (state_size i)</span></span></span><br><span><var>Free</var><span><span class="hyp-body"><b>:= </b><span>free_composite_vlsm IM</span></span><span class="hyp-type"><b>: </b><span>VLSM message</span></span></span></span><br><span><var>RFree</var><span><span class="hyp-body"><b>:= </b><span>pre_loaded_with_all_messages_vlsm Free</span></span><span class="hyp-type"><b>: </b><span>VLSM message</span></span></span></span><br><span><var>choose</var><span class="hyp-type"><b>: </b><span>choice_function</span></span></span><br><span><var>s'</var><span class="hyp-type"><b>: </b><span>composite_state IM</span></span></span><br><span><var>Hs'</var><span class="hyp-type"><b>: </b><span>valid_state_prop RFree s&#39;</span></span></span><br><span><var>indices</var><span class="hyp-type"><b>: </b><span>list index</span></span></span><br><span><var>Hchoose</var><span class="hyp-type"><b>: </b><span>ChoosingWell choose s&#39; Hs&#39; indices</span></span></span><br><span><var>i_n</var><span><span class="hyp-body"><b>:= </b><span>choose s&#39; Hs&#39; indices</span></span><span class="hyp-type"><b>: </b><span>(index * nat)%type</span></span></span></span><br><span><var>Hdestruct</var><span class="hyp-type"><b>: </b><span>composite_state_destructor s&#39; i_n.<span class="mi">1</span> ‚â† []</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">¬¨ vinitial_state_prop (IM i_n.<span class="mi">1</span>) (s&#39; i_n.<span class="mi">1</span>)</div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="bp">by</span> <span class="bp">contradict</span> Hdestruct; <span class="nb">apply</span> composite_tv_state_destructor_initial.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Qed</span>.</span></span></pre><div class="doc">
  This is a property of the set of indices argument to a <span class="inlinecode"><span class="id" title="var">choice_function</span></span>,
  guaranteeing that the component states for the non-included indices are initial.

</div><pre class="alectryon-io highlight"><!-- Generator: Alectryon --><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Definition</span> <span class="nf">not_in_indices_initial_prop</span>
  (<span class="nv">s&#39;</span> : composite_state IM)
  (<span class="nv">indices</span> : list index)
  : <span class="kt">Prop</span> :=
  <span class="kr">forall</span> <span class="nv">i</span>, i ‚àâ indices -&gt; vinitial_state_prop (IM i) (s&#39; i).</span></span></pre><div class="doc">
  The ram-transitions leading to a composite ram-state reflect the
  <span class="inlinecode"><span class="id" title="var">not_in_indices_initial_prop</span></span>erty, or, alternately, the
  <span class="inlinecode"><span class="id" title="var">composite_state_destructor</span></span> function reflects it.

</div><pre class="alectryon-io highlight"><!-- Generator: Alectryon --><span class="alectryon-sentence"><input class="alectryon-toggle" id="TraceableVLSM-v-chk7f" style="display: none" type="checkbox"><label class="alectryon-input" for="TraceableVLSM-v-chk7f"><span class="kn">Lemma</span> <span class="nf">composite_tv_state_destructor_preserves_not_in_indices_initial</span>  :
  <span class="kr">forall</span>
    (<span class="nv">s&#39;</span> : composite_state IM) (<span class="nv">Hs&#39;</span> : valid_state_prop RFree s&#39;)
    (<span class="nv">i</span> : index) (<span class="nv">n</span> : nat)
    (<span class="nv">s</span> : composite_state IM) (<span class="nv">item</span> : composite_transition_item IM),
      composite_state_destructor s&#39; i !! n = Some (item, s) -&gt;
    <span class="kr">forall</span> (<span class="nv">indices</span> : list index),
      not_in_indices_initial_prop s&#39; indices -&gt;
      not_in_indices_initial_prop s indices.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>message, index</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>EqDecision0</var><span class="hyp-type"><b>: </b><span>EqDecision index</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>finite.Finite index</span></span></span><br><span><var>IM</var><span class="hyp-type"><b>: </b><span>index ‚Üí VLSM message</span></span></span><br><span><var>state_destructor</var><span class="hyp-type"><b>: </b><span><span class="kr">‚àÄ</span> <span class="nv">i</span> : index,
  vstate (IM i)
  ‚Üí list
      (vtransition_item (IM i) *
       vstate (IM i))</span></span></span><br><span><var>state_size</var><span class="hyp-type"><b>: </b><span><span class="kr">‚àÄ</span> <span class="nv">i</span> : index, vstate (IM i) ‚Üí nat</span></span></span><br><span><var>H0</var><span class="hyp-type"><b>: </b><span><span class="kr">‚àÄ</span> <span class="nv">i</span> : index,
  TraceableVLSM (IM i) 
    (state_destructor i) 
    (state_size i)</span></span></span><br><span><var>Free</var><span><span class="hyp-body"><b>:= </b><span>free_composite_vlsm IM</span></span><span class="hyp-type"><b>: </b><span>VLSM message</span></span></span></span><br><span><var>RFree</var><span><span class="hyp-body"><b>:= </b><span>pre_loaded_with_all_messages_vlsm Free</span></span><span class="hyp-type"><b>: </b><span>VLSM message</span></span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="kr">‚àÄ</span> <span class="nv">s&#39;</span> : composite_state IM,
  valid_state_prop RFree s&#39;
  ‚Üí <span class="kr">‚àÄ</span> (<span class="nv">i</span> : index) (<span class="nv">n</span> : nat) (<span class="nv">s</span> : composite_state IM) 
      (<span class="nv">item</span> : composite_transition_item IM),
      composite_state_destructor s&#39; i !! n =
      Some (item, s)
      ‚Üí <span class="kr">‚àÄ</span> <span class="nv">indices</span> : list index,
          not_in_indices_initial_prop s&#39; indices
          ‚Üí not_in_indices_initial_prop s indices</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="TraceableVLSM-v-chk80" style="display: none" type="checkbox"><label class="alectryon-input" for="TraceableVLSM-v-chk80"><span class="kn">Proof</span>.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>message, index</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>EqDecision0</var><span class="hyp-type"><b>: </b><span>EqDecision index</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>finite.Finite index</span></span></span><br><span><var>IM</var><span class="hyp-type"><b>: </b><span>index ‚Üí VLSM message</span></span></span><br><span><var>state_destructor</var><span class="hyp-type"><b>: </b><span><span class="kr">‚àÄ</span> <span class="nv">i</span> : index,
  vstate (IM i)
  ‚Üí list
      (vtransition_item (IM i) *
       vstate (IM i))</span></span></span><br><span><var>state_size</var><span class="hyp-type"><b>: </b><span><span class="kr">‚àÄ</span> <span class="nv">i</span> : index, vstate (IM i) ‚Üí nat</span></span></span><br><span><var>H0</var><span class="hyp-type"><b>: </b><span><span class="kr">‚àÄ</span> <span class="nv">i</span> : index,
  TraceableVLSM (IM i) 
    (state_destructor i) 
    (state_size i)</span></span></span><br><span><var>Free</var><span><span class="hyp-body"><b>:= </b><span>free_composite_vlsm IM</span></span><span class="hyp-type"><b>: </b><span>VLSM message</span></span></span></span><br><span><var>RFree</var><span><span class="hyp-body"><b>:= </b><span>pre_loaded_with_all_messages_vlsm Free</span></span><span class="hyp-type"><b>: </b><span>VLSM message</span></span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="kr">‚àÄ</span> <span class="nv">s&#39;</span> : composite_state IM,
  valid_state_prop RFree s&#39;
  ‚Üí <span class="kr">‚àÄ</span> (<span class="nv">i</span> : index) (<span class="nv">n</span> : nat) (<span class="nv">s</span> : composite_state IM) 
      (<span class="nv">item</span> : composite_transition_item IM),
      composite_state_destructor s&#39; i !! n =
      Some (item, s)
      ‚Üí <span class="kr">‚àÄ</span> <span class="nv">indices</span> : list index,
          not_in_indices_initial_prop s&#39; indices
          ‚Üí not_in_indices_initial_prop s indices</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="TraceableVLSM-v-chk81" style="display: none" type="checkbox"><label class="alectryon-input" for="TraceableVLSM-v-chk81"><span class="nb">intros</span> s&#39; Hs&#39; * Heq indices Hinits&#39; j Hj.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>message, index</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>EqDecision0</var><span class="hyp-type"><b>: </b><span>EqDecision index</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>finite.Finite index</span></span></span><br><span><var>IM</var><span class="hyp-type"><b>: </b><span>index ‚Üí VLSM message</span></span></span><br><span><var>state_destructor</var><span class="hyp-type"><b>: </b><span><span class="kr">‚àÄ</span> <span class="nv">i</span> : index,
  vstate (IM i)
  ‚Üí list
      (vtransition_item (IM i) *
       vstate (IM i))</span></span></span><br><span><var>state_size</var><span class="hyp-type"><b>: </b><span><span class="kr">‚àÄ</span> <span class="nv">i</span> : index, vstate (IM i) ‚Üí nat</span></span></span><br><span><var>H0</var><span class="hyp-type"><b>: </b><span><span class="kr">‚àÄ</span> <span class="nv">i</span> : index,
  TraceableVLSM (IM i) 
    (state_destructor i) 
    (state_size i)</span></span></span><br><span><var>Free</var><span><span class="hyp-body"><b>:= </b><span>free_composite_vlsm IM</span></span><span class="hyp-type"><b>: </b><span>VLSM message</span></span></span></span><br><span><var>RFree</var><span><span class="hyp-body"><b>:= </b><span>pre_loaded_with_all_messages_vlsm Free</span></span><span class="hyp-type"><b>: </b><span>VLSM message</span></span></span></span><br><span><var>s'</var><span class="hyp-type"><b>: </b><span>composite_state IM</span></span></span><br><span><var>Hs'</var><span class="hyp-type"><b>: </b><span>valid_state_prop RFree s&#39;</span></span></span><br><span><var>i</var><span class="hyp-type"><b>: </b><span>index</span></span></span><br><span><var>n</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>s</var><span class="hyp-type"><b>: </b><span>composite_state IM</span></span></span><br><span><var>item</var><span class="hyp-type"><b>: </b><span>composite_transition_item IM</span></span></span><br><span><var>Heq</var><span class="hyp-type"><b>: </b><span>composite_state_destructor s&#39; i !! n =
Some (item, s)</span></span></span><br><span><var>indices</var><span class="hyp-type"><b>: </b><span>list index</span></span></span><br><span><var>Hinits'</var><span class="hyp-type"><b>: </b><span>not_in_indices_initial_prop s&#39; indices</span></span></span><br><span><var>j</var><span class="hyp-type"><b>: </b><span>index</span></span></span><br><span><var>Hj</var><span class="hyp-type"><b>: </b><span>j ‚àâ indices</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">vinitial_state_prop (IM j) (s j)</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><span class="alectryon-input"><span class="bp">by</span> <span class="nb">erewrite</span> composite_tv_state_destructor_reflects_initiality;
    [<span class="nb">apply</span> Hinits&#39; | <span class="bp">done</span> | <span class="nb">eapply</span> elem_of_list_lookup_2 | <span class="nb">apply</span> Hinits&#39;].</span><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Qed</span>.</span></span></pre><div class="doc">
  Removing an index whose associated set of transitions is empty
  (so that the corresponding component state is initial) preserves
  <span class="inlinecode"><span class="id" title="var">not_in_indices_initial_prop</span></span>.

</div><pre class="alectryon-io highlight"><!-- Generator: Alectryon --><span class="alectryon-sentence"><input class="alectryon-toggle" id="TraceableVLSM-v-chk82" style="display: none" type="checkbox"><label class="alectryon-input" for="TraceableVLSM-v-chk82"><span class="kn">Lemma</span> <span class="nf">set_remove_preserves_not_in_indices_initial</span> :
  <span class="kr">forall</span> (<span class="nv">s&#39;</span> : composite_state IM), valid_state_prop RFree s&#39; -&gt;
  <span class="kr">forall</span> (<span class="nv">i</span> : index), composite_state_destructor s&#39; i = [] -&gt;
  <span class="kr">forall</span> (<span class="nv">indices</span> : list index),
  not_in_indices_initial_prop s&#39; indices -&gt;
  not_in_indices_initial_prop s&#39; (StdppListSet.set_remove i indices).</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>message, index</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>EqDecision0</var><span class="hyp-type"><b>: </b><span>EqDecision index</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>finite.Finite index</span></span></span><br><span><var>IM</var><span class="hyp-type"><b>: </b><span>index ‚Üí VLSM message</span></span></span><br><span><var>state_destructor</var><span class="hyp-type"><b>: </b><span><span class="kr">‚àÄ</span> <span class="nv">i</span> : index,
  vstate (IM i)
  ‚Üí list
      (vtransition_item (IM i) *
       vstate (IM i))</span></span></span><br><span><var>state_size</var><span class="hyp-type"><b>: </b><span><span class="kr">‚àÄ</span> <span class="nv">i</span> : index, vstate (IM i) ‚Üí nat</span></span></span><br><span><var>H0</var><span class="hyp-type"><b>: </b><span><span class="kr">‚àÄ</span> <span class="nv">i</span> : index,
  TraceableVLSM (IM i) 
    (state_destructor i) 
    (state_size i)</span></span></span><br><span><var>Free</var><span><span class="hyp-body"><b>:= </b><span>free_composite_vlsm IM</span></span><span class="hyp-type"><b>: </b><span>VLSM message</span></span></span></span><br><span><var>RFree</var><span><span class="hyp-body"><b>:= </b><span>pre_loaded_with_all_messages_vlsm Free</span></span><span class="hyp-type"><b>: </b><span>VLSM message</span></span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="kr">‚àÄ</span> <span class="nv">s&#39;</span> : composite_state IM,
  valid_state_prop RFree s&#39;
  ‚Üí <span class="kr">‚àÄ</span> <span class="nv">i</span> : index,
      composite_state_destructor s&#39; i = []
      ‚Üí <span class="kr">‚àÄ</span> <span class="nv">indices</span> : list index,
          not_in_indices_initial_prop s&#39; indices
          ‚Üí not_in_indices_initial_prop s&#39;
              (StdppListSet.set_remove i indices)</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="TraceableVLSM-v-chk83" style="display: none" type="checkbox"><label class="alectryon-input" for="TraceableVLSM-v-chk83"><span class="kn">Proof</span>.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>message, index</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>EqDecision0</var><span class="hyp-type"><b>: </b><span>EqDecision index</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>finite.Finite index</span></span></span><br><span><var>IM</var><span class="hyp-type"><b>: </b><span>index ‚Üí VLSM message</span></span></span><br><span><var>state_destructor</var><span class="hyp-type"><b>: </b><span><span class="kr">‚àÄ</span> <span class="nv">i</span> : index,
  vstate (IM i)
  ‚Üí list
      (vtransition_item (IM i) *
       vstate (IM i))</span></span></span><br><span><var>state_size</var><span class="hyp-type"><b>: </b><span><span class="kr">‚àÄ</span> <span class="nv">i</span> : index, vstate (IM i) ‚Üí nat</span></span></span><br><span><var>H0</var><span class="hyp-type"><b>: </b><span><span class="kr">‚àÄ</span> <span class="nv">i</span> : index,
  TraceableVLSM (IM i) 
    (state_destructor i) 
    (state_size i)</span></span></span><br><span><var>Free</var><span><span class="hyp-body"><b>:= </b><span>free_composite_vlsm IM</span></span><span class="hyp-type"><b>: </b><span>VLSM message</span></span></span></span><br><span><var>RFree</var><span><span class="hyp-body"><b>:= </b><span>pre_loaded_with_all_messages_vlsm Free</span></span><span class="hyp-type"><b>: </b><span>VLSM message</span></span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="kr">‚àÄ</span> <span class="nv">s&#39;</span> : composite_state IM,
  valid_state_prop RFree s&#39;
  ‚Üí <span class="kr">‚àÄ</span> <span class="nv">i</span> : index,
      composite_state_destructor s&#39; i = []
      ‚Üí <span class="kr">‚àÄ</span> <span class="nv">indices</span> : list index,
          not_in_indices_initial_prop s&#39; indices
          ‚Üí not_in_indices_initial_prop s&#39;
              (StdppListSet.set_remove i indices)</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="TraceableVLSM-v-chk84" style="display: none" type="checkbox"><label class="alectryon-input" for="TraceableVLSM-v-chk84"><span class="nb">intros</span> s&#39; Hs&#39; i Hdestruct indices Hinit j Hj.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>message, index</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>EqDecision0</var><span class="hyp-type"><b>: </b><span>EqDecision index</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>finite.Finite index</span></span></span><br><span><var>IM</var><span class="hyp-type"><b>: </b><span>index ‚Üí VLSM message</span></span></span><br><span><var>state_destructor</var><span class="hyp-type"><b>: </b><span><span class="kr">‚àÄ</span> <span class="nv">i</span> : index,
  vstate (IM i)
  ‚Üí list
      (vtransition_item (IM i) *
       vstate (IM i))</span></span></span><br><span><var>state_size</var><span class="hyp-type"><b>: </b><span><span class="kr">‚àÄ</span> <span class="nv">i</span> : index, vstate (IM i) ‚Üí nat</span></span></span><br><span><var>H0</var><span class="hyp-type"><b>: </b><span><span class="kr">‚àÄ</span> <span class="nv">i</span> : index,
  TraceableVLSM (IM i) 
    (state_destructor i) 
    (state_size i)</span></span></span><br><span><var>Free</var><span><span class="hyp-body"><b>:= </b><span>free_composite_vlsm IM</span></span><span class="hyp-type"><b>: </b><span>VLSM message</span></span></span></span><br><span><var>RFree</var><span><span class="hyp-body"><b>:= </b><span>pre_loaded_with_all_messages_vlsm Free</span></span><span class="hyp-type"><b>: </b><span>VLSM message</span></span></span></span><br><span><var>s'</var><span class="hyp-type"><b>: </b><span>composite_state IM</span></span></span><br><span><var>Hs'</var><span class="hyp-type"><b>: </b><span>valid_state_prop RFree s&#39;</span></span></span><br><span><var>i</var><span class="hyp-type"><b>: </b><span>index</span></span></span><br><span><var>Hdestruct</var><span class="hyp-type"><b>: </b><span>composite_state_destructor s&#39; i = []</span></span></span><br><span><var>indices</var><span class="hyp-type"><b>: </b><span>list index</span></span></span><br><span><var>Hinit</var><span class="hyp-type"><b>: </b><span>not_in_indices_initial_prop s&#39; indices</span></span></span><br><span><var>j</var><span class="hyp-type"><b>: </b><span>index</span></span></span><br><span><var>Hj</var><span class="hyp-type"><b>: </b><span>j ‚àâ StdppListSet.set_remove i indices</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">vinitial_state_prop (IM j) (s&#39; j)</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="TraceableVLSM-v-chk85" style="display: none" type="checkbox"><label class="alectryon-input" for="TraceableVLSM-v-chk85"><span class="nb">destruct</span> (decide (j ‚àà indices)); [| <span class="bp">by</span> <span class="nb">apply</span> Hinit].</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>message, index</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>EqDecision0</var><span class="hyp-type"><b>: </b><span>EqDecision index</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>finite.Finite index</span></span></span><br><span><var>IM</var><span class="hyp-type"><b>: </b><span>index ‚Üí VLSM message</span></span></span><br><span><var>state_destructor</var><span class="hyp-type"><b>: </b><span><span class="kr">‚àÄ</span> <span class="nv">i</span> : index,
  vstate (IM i)
  ‚Üí list
      (vtransition_item (IM i) *
       vstate (IM i))</span></span></span><br><span><var>state_size</var><span class="hyp-type"><b>: </b><span><span class="kr">‚àÄ</span> <span class="nv">i</span> : index, vstate (IM i) ‚Üí nat</span></span></span><br><span><var>H0</var><span class="hyp-type"><b>: </b><span><span class="kr">‚àÄ</span> <span class="nv">i</span> : index,
  TraceableVLSM (IM i) 
    (state_destructor i) 
    (state_size i)</span></span></span><br><span><var>Free</var><span><span class="hyp-body"><b>:= </b><span>free_composite_vlsm IM</span></span><span class="hyp-type"><b>: </b><span>VLSM message</span></span></span></span><br><span><var>RFree</var><span><span class="hyp-body"><b>:= </b><span>pre_loaded_with_all_messages_vlsm Free</span></span><span class="hyp-type"><b>: </b><span>VLSM message</span></span></span></span><br><span><var>s'</var><span class="hyp-type"><b>: </b><span>composite_state IM</span></span></span><br><span><var>Hs'</var><span class="hyp-type"><b>: </b><span>valid_state_prop RFree s&#39;</span></span></span><br><span><var>i</var><span class="hyp-type"><b>: </b><span>index</span></span></span><br><span><var>Hdestruct</var><span class="hyp-type"><b>: </b><span>composite_state_destructor s&#39; i = []</span></span></span><br><span><var>indices</var><span class="hyp-type"><b>: </b><span>list index</span></span></span><br><span><var>Hinit</var><span class="hyp-type"><b>: </b><span>not_in_indices_initial_prop s&#39; indices</span></span></span><br><span><var>j</var><span class="hyp-type"><b>: </b><span>index</span></span></span><br><span><var>Hj</var><span class="hyp-type"><b>: </b><span>j ‚àâ StdppListSet.set_remove i indices</span></span></span><br><span><var>e</var><span class="hyp-type"><b>: </b><span>j ‚àà indices</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">vinitial_state_prop (IM j) (s&#39; j)</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="TraceableVLSM-v-chk86" style="display: none" type="checkbox"><label class="alectryon-input" for="TraceableVLSM-v-chk86"><span class="nb">destruct</span> (decide (j = i)); [<span class="bp">by</span> <span class="nb">subst</span>; <span class="nb">apply</span> composite_tv_state_destructor_initial |].</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>message, index</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>EqDecision0</var><span class="hyp-type"><b>: </b><span>EqDecision index</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>finite.Finite index</span></span></span><br><span><var>IM</var><span class="hyp-type"><b>: </b><span>index ‚Üí VLSM message</span></span></span><br><span><var>state_destructor</var><span class="hyp-type"><b>: </b><span><span class="kr">‚àÄ</span> <span class="nv">i</span> : index,
  vstate (IM i)
  ‚Üí list
      (vtransition_item (IM i) *
       vstate (IM i))</span></span></span><br><span><var>state_size</var><span class="hyp-type"><b>: </b><span><span class="kr">‚àÄ</span> <span class="nv">i</span> : index, vstate (IM i) ‚Üí nat</span></span></span><br><span><var>H0</var><span class="hyp-type"><b>: </b><span><span class="kr">‚àÄ</span> <span class="nv">i</span> : index,
  TraceableVLSM (IM i) 
    (state_destructor i) 
    (state_size i)</span></span></span><br><span><var>Free</var><span><span class="hyp-body"><b>:= </b><span>free_composite_vlsm IM</span></span><span class="hyp-type"><b>: </b><span>VLSM message</span></span></span></span><br><span><var>RFree</var><span><span class="hyp-body"><b>:= </b><span>pre_loaded_with_all_messages_vlsm Free</span></span><span class="hyp-type"><b>: </b><span>VLSM message</span></span></span></span><br><span><var>s'</var><span class="hyp-type"><b>: </b><span>composite_state IM</span></span></span><br><span><var>Hs'</var><span class="hyp-type"><b>: </b><span>valid_state_prop RFree s&#39;</span></span></span><br><span><var>i</var><span class="hyp-type"><b>: </b><span>index</span></span></span><br><span><var>Hdestruct</var><span class="hyp-type"><b>: </b><span>composite_state_destructor s&#39; i = []</span></span></span><br><span><var>indices</var><span class="hyp-type"><b>: </b><span>list index</span></span></span><br><span><var>Hinit</var><span class="hyp-type"><b>: </b><span>not_in_indices_initial_prop s&#39; indices</span></span></span><br><span><var>j</var><span class="hyp-type"><b>: </b><span>index</span></span></span><br><span><var>Hj</var><span class="hyp-type"><b>: </b><span>j ‚àâ StdppListSet.set_remove i indices</span></span></span><br><span><var>e</var><span class="hyp-type"><b>: </b><span>j ‚àà indices</span></span></span><br><span><var>n</var><span class="hyp-type"><b>: </b><span>j ‚â† i</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">vinitial_state_prop (IM j) (s&#39; j)</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><span class="alectryon-input"><span class="bp">by</span> <span class="bp">contradict</span> Hj; <span class="nb">subst</span>; <span class="nb">apply</span> StdppListSet.set_remove_3.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Qed</span>.</span></span></pre><div class="doc">
  A <span class="inlinecode"><span class="id" title="var">choice_function</span></span> is choosing well if it is <span class="inlinecode"><span class="id" title="var">ChoosingWell</span></span> for any
  instance of its arguments (a ram-state and a set of indices) satisfying the
  <span class="inlinecode"><span class="id" title="var">not_in_indices_initial_prop</span></span>erty.

</div><pre class="alectryon-io highlight"><!-- Generator: Alectryon --><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Definition</span> <span class="nf">choosing_well</span> (<span class="nv">choose</span> : choice_function) : <span class="kt">Prop</span> :=
  <span class="kr">forall</span> (<span class="nv">s&#39;</span> : composite_state IM) (<span class="nv">Hs&#39;</span> : valid_state_prop RFree s&#39;) (<span class="nv">indices</span> : list index),
    NoDup indices -&gt; not_in_indices_initial_prop s&#39; indices -&gt;
      ChoosingWell choose s&#39; Hs&#39; indices.</span></span></pre><div class="doc">
  Given a composite ram-state, a <span class="inlinecode"><span class="id" title="var">choice_function</span></span> and an initial set of indices,
  we can extract a trace leading to that state by following backwards the
  transitions yielded by the choice function until the states corresponding to
  any of the given indices become initial states.

</div><pre class="alectryon-io highlight"><!-- Generator: Alectryon --><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Equations</span> <span class="nf">indexed_composite_state_to_trace</span>
  (<span class="nv">choose</span> : choice_function)
  (<span class="nv">s&#39;</span> : composite_state IM) (<span class="nv">Hs&#39;</span> : valid_state_prop RFree s&#39;)
  (<span class="nv">indices</span> : list index)
  : composite_state IM * list (composite_transition_item IM)
  <span class="bp">by</span> <span class="kn">wf</span> (length indices + composite_state_size s&#39;) lt :=
| choose, s&#39;, Hs&#39;, [] =&gt; (s&#39;, [])
| choose, s&#39;, Hs&#39;, indices <span class="kr">with</span> inspect (choose s&#39; Hs&#39; indices) =&gt;
  | i_n eq: Hchoice <span class="kr">with</span> inspect (composite_state_destructor s&#39; i_n.<span class="mi">1</span> !! i_n.<span class="mi">2</span>) =&gt;
    | (Some (item, s)) eq: Hdestruct <span class="kr">with</span> indexed_composite_state_to_trace choose s _ indices =&gt; {
      | (<span class="kr">is</span>, tr) =&gt; (<span class="kr">is</span>, tr ++ [item]) }
    |             None eq: Hdestruct <span class="kr">with</span> inspect (decide (i_n.<span class="mi">1</span> ‚àà indices)) =&gt;
      | (<span class="nb">right</span> _) eq: Hni =&gt; (s&#39;, [])
      |  (<span class="nb">left</span> _) eq: Hi <span class="kr">with</span> inspect (decide (composite_state_destructor s&#39; i_n.<span class="mi">1</span> = [])) =&gt;
        | (<span class="nb">right</span> _) eq: Hn  =&gt; (s&#39;, [])
        |  (<span class="nb">left</span> _) eq: Hnn =&gt; indexed_composite_state_to_trace choose s&#39; Hs&#39; (StdppListSet.set_remove i_n.<span class="mi">1</span> indices).</span><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="TraceableVLSM-v-chk87" style="display: none" type="checkbox"><label class="alectryon-input" for="TraceableVLSM-v-chk87"><span class="kn">Next Obligation</span>.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>message, index</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>EqDecision0</var><span class="hyp-type"><b>: </b><span>EqDecision index</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>finite.Finite index</span></span></span><br><span><var>IM</var><span class="hyp-type"><b>: </b><span>index ‚Üí VLSM message</span></span></span><br><span><var>state_destructor</var><span class="hyp-type"><b>: </b><span><span class="kr">‚àÄ</span> <span class="nv">i</span> : index,
  vstate (IM i)
  ‚Üí list
      (vtransition_item (IM i) *
       vstate (IM i))</span></span></span><br><span><var>state_size</var><span class="hyp-type"><b>: </b><span><span class="kr">‚àÄ</span> <span class="nv">i</span> : index, vstate (IM i) ‚Üí nat</span></span></span><br><span><var>H0</var><span class="hyp-type"><b>: </b><span><span class="kr">‚àÄ</span> <span class="nv">i</span> : index,
  TraceableVLSM (IM i) 
    (state_destructor i) 
    (state_size i)</span></span></span><br><span><var>Free</var><span><span class="hyp-body"><b>:= </b><span>free_composite_vlsm IM</span></span><span class="hyp-type"><b>: </b><span>VLSM message</span></span></span></span><br><span><var>RFree</var><span><span class="hyp-body"><b>:= </b><span>pre_loaded_with_all_messages_vlsm Free</span></span><span class="hyp-type"><b>: </b><span>VLSM message</span></span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="kr">‚àÄ</span> (<span class="nv">choose</span> : choice_function) (<span class="nv">s&#39;</span> : composite_state IM) 
  (<span class="nv">Hs&#39;</span> : valid_state_prop RFree s&#39;) (<span class="nv">i</span> : index) (<span class="nv">l0</span> : 
                                                 list
                                                 index) 
  (<span class="nv">i_n</span> : index * nat) (<span class="nv">item</span> : composite_transition_item
                                IM) (<span class="nv">s</span> : composite_state
                                           IM),
  (<span class="kr">Œª</span> <span class="nv">b</span> : option
           (composite_transition_item IM *
            composite_state IM),
     composite_state_destructor s&#39; i_n.<span class="mi">1</span> !! i_n.<span class="mi">2</span> = b)
    (Some (item, s))
  ‚Üí (<span class="kr">Œª</span> <span class="nv">b</span> : index * nat, choose s&#39; Hs&#39; (i :: l0) = b)
      i_n
    ‚Üí (choice_function
       ‚Üí <span class="kr">‚àÄ</span> <span class="nv">x0</span> : composite_state IM,
           valid_state_prop RFree x0
           ‚Üí <span class="kr">‚àÄ</span> <span class="nv">x2</span> : list index,
               length x2 + composite_state_size x0 &lt;
               length (i :: l0) +
               composite_state_size s&#39;
               ‚Üí composite_state IM *
                 list (composite_transition_item IM))
      ‚Üí <span class="kr">let</span> <span class="nv">indices</span> := i :: l0 <span class="kr">in</span>
        valid_state_prop RFree s</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><span class="alectryon-input"><span class="bp">by</span> <span class="nb">cbn</span>; <span class="nb">intros</span>; <span class="nb">eapply</span> input_valid_transition_origin, composite_state_destructor_lookup_reachable.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Qed</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="TraceableVLSM-v-chk88" style="display: none" type="checkbox"><label class="alectryon-input" for="TraceableVLSM-v-chk88"><span class="kn">Next Obligation</span>.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>message, index</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>EqDecision0</var><span class="hyp-type"><b>: </b><span>EqDecision index</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>finite.Finite index</span></span></span><br><span><var>IM</var><span class="hyp-type"><b>: </b><span>index ‚Üí VLSM message</span></span></span><br><span><var>state_destructor</var><span class="hyp-type"><b>: </b><span><span class="kr">‚àÄ</span> <span class="nv">i</span> : index,
  vstate (IM i)
  ‚Üí list
      (vtransition_item (IM i) *
       vstate (IM i))</span></span></span><br><span><var>state_size</var><span class="hyp-type"><b>: </b><span><span class="kr">‚àÄ</span> <span class="nv">i</span> : index, vstate (IM i) ‚Üí nat</span></span></span><br><span><var>H0</var><span class="hyp-type"><b>: </b><span><span class="kr">‚àÄ</span> <span class="nv">i</span> : index,
  TraceableVLSM (IM i) 
    (state_destructor i) 
    (state_size i)</span></span></span><br><span><var>Free</var><span><span class="hyp-body"><b>:= </b><span>free_composite_vlsm IM</span></span><span class="hyp-type"><b>: </b><span>VLSM message</span></span></span></span><br><span><var>RFree</var><span><span class="hyp-body"><b>:= </b><span>pre_loaded_with_all_messages_vlsm Free</span></span><span class="hyp-type"><b>: </b><span>VLSM message</span></span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="kr">‚àÄ</span> (<span class="nv">choose</span> : choice_function) (<span class="nv">s&#39;</span> : composite_state IM) 
  (<span class="nv">Hs&#39;</span> : valid_state_prop RFree s&#39;) (<span class="nv">i</span> : index) (<span class="nv">l0</span> : 
                                                 list
                                                 index) 
  (<span class="nv">i_n</span> : index * nat) (<span class="nv">item</span> : composite_transition_item
                                IM) (<span class="nv">s</span> : composite_state
                                           IM),
  (<span class="kr">Œª</span> <span class="nv">b</span> : option
           (composite_transition_item IM *
            composite_state IM),
     composite_state_destructor s&#39; i_n.<span class="mi">1</span> !! i_n.<span class="mi">2</span> = b)
    (Some (item, s))
  ‚Üí (<span class="kr">Œª</span> <span class="nv">b</span> : index * nat, choose s&#39; Hs&#39; (i :: l0) = b)
      i_n
    ‚Üí (choice_function
       ‚Üí <span class="kr">‚àÄ</span> <span class="nv">x0</span> : composite_state IM,
           valid_state_prop RFree x0
           ‚Üí <span class="kr">‚àÄ</span> <span class="nv">x2</span> : list index,
               length x2 + composite_state_size x0 &lt;
               length (i :: l0) +
               composite_state_size s&#39;
               ‚Üí composite_state IM *
                 list (composite_transition_item IM))
      ‚Üí <span class="kr">let</span> <span class="nv">indices</span> := i :: l0 <span class="kr">in</span>
        length indices + composite_state_size s &lt;
        length (i :: l0) + composite_state_size s&#39;</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="TraceableVLSM-v-chk89" style="display: none" type="checkbox"><label class="alectryon-input" for="TraceableVLSM-v-chk89"><span class="nb">cbn</span>; <span class="nb">intros</span>.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>message, index</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>EqDecision0</var><span class="hyp-type"><b>: </b><span>EqDecision index</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>finite.Finite index</span></span></span><br><span><var>IM</var><span class="hyp-type"><b>: </b><span>index ‚Üí VLSM message</span></span></span><br><span><var>state_destructor</var><span class="hyp-type"><b>: </b><span><span class="kr">‚àÄ</span> <span class="nv">i</span> : index,
  vstate (IM i)
  ‚Üí list
      (vtransition_item (IM i) *
       vstate (IM i))</span></span></span><br><span><var>state_size</var><span class="hyp-type"><b>: </b><span><span class="kr">‚àÄ</span> <span class="nv">i</span> : index, vstate (IM i) ‚Üí nat</span></span></span><br><span><var>H0</var><span class="hyp-type"><b>: </b><span><span class="kr">‚àÄ</span> <span class="nv">i</span> : index,
  TraceableVLSM (IM i) 
    (state_destructor i) 
    (state_size i)</span></span></span><br><span><var>Free</var><span><span class="hyp-body"><b>:= </b><span>free_composite_vlsm IM</span></span><span class="hyp-type"><b>: </b><span>VLSM message</span></span></span></span><br><span><var>RFree</var><span><span class="hyp-body"><b>:= </b><span>pre_loaded_with_all_messages_vlsm Free</span></span><span class="hyp-type"><b>: </b><span>VLSM message</span></span></span></span><br><span><var>choose</var><span class="hyp-type"><b>: </b><span>choice_function</span></span></span><br><span><var>s'</var><span class="hyp-type"><b>: </b><span>composite_state IM</span></span></span><br><span><var>Hs'</var><span class="hyp-type"><b>: </b><span>valid_state_prop RFree s&#39;</span></span></span><br><span><var>i</var><span class="hyp-type"><b>: </b><span>index</span></span></span><br><span><var>l0</var><span class="hyp-type"><b>: </b><span>list index</span></span></span><br><span><var>i_n</var><span class="hyp-type"><b>: </b><span>(index * nat)%type</span></span></span><br><span><var>item</var><span class="hyp-type"><b>: </b><span>composite_transition_item IM</span></span></span><br><span><var>s</var><span class="hyp-type"><b>: </b><span>composite_state IM</span></span></span><br><span><var>Hdestruct</var><span class="hyp-type"><b>: </b><span>composite_state_destructor s&#39; i_n.<span class="mi">1</span>
!! i_n.<span class="mi">2</span> = Some (item, s)</span></span></span><br><span><var>Hchoice</var><span class="hyp-type"><b>: </b><span>choose s&#39; Hs&#39; (i :: l0) = i_n</span></span></span><br><span><var>indexed_composite_state_to_trace</var><span class="hyp-type"><b>: </b><span>choice_function
‚Üí <span class="kr">‚àÄ</span> <span class="nv">x0</span> : composite_state
          IM,
    valid_state_prop
      RFree x0
    ‚Üí <span class="kr">‚àÄ</span> <span class="nv">x2</span> : 
         list index,
        length x2 +
        composite_state_size
          x0 &lt;
        S
          (length
          l0 +
          composite_state_size
          s&#39;)
        ‚Üí composite_state
          IM *
          list
          (composite_transition_item
          IM)</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">S (length l0 + composite_state_size s) &lt;
S (length l0 + composite_state_size s&#39;)</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="TraceableVLSM-v-chk8a" style="display: none" type="checkbox"><label class="alectryon-input" for="TraceableVLSM-v-chk8a"><span class="nb">cut</span> (composite_state_size s &lt; composite_state_size s&#39;); [<span class="bp">lia</span> |].</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>message, index</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>EqDecision0</var><span class="hyp-type"><b>: </b><span>EqDecision index</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>finite.Finite index</span></span></span><br><span><var>IM</var><span class="hyp-type"><b>: </b><span>index ‚Üí VLSM message</span></span></span><br><span><var>state_destructor</var><span class="hyp-type"><b>: </b><span><span class="kr">‚àÄ</span> <span class="nv">i</span> : index,
  vstate (IM i)
  ‚Üí list
      (vtransition_item (IM i) *
       vstate (IM i))</span></span></span><br><span><var>state_size</var><span class="hyp-type"><b>: </b><span><span class="kr">‚àÄ</span> <span class="nv">i</span> : index, vstate (IM i) ‚Üí nat</span></span></span><br><span><var>H0</var><span class="hyp-type"><b>: </b><span><span class="kr">‚àÄ</span> <span class="nv">i</span> : index,
  TraceableVLSM (IM i) 
    (state_destructor i) 
    (state_size i)</span></span></span><br><span><var>Free</var><span><span class="hyp-body"><b>:= </b><span>free_composite_vlsm IM</span></span><span class="hyp-type"><b>: </b><span>VLSM message</span></span></span></span><br><span><var>RFree</var><span><span class="hyp-body"><b>:= </b><span>pre_loaded_with_all_messages_vlsm Free</span></span><span class="hyp-type"><b>: </b><span>VLSM message</span></span></span></span><br><span><var>choose</var><span class="hyp-type"><b>: </b><span>choice_function</span></span></span><br><span><var>s'</var><span class="hyp-type"><b>: </b><span>composite_state IM</span></span></span><br><span><var>Hs'</var><span class="hyp-type"><b>: </b><span>valid_state_prop RFree s&#39;</span></span></span><br><span><var>i</var><span class="hyp-type"><b>: </b><span>index</span></span></span><br><span><var>l0</var><span class="hyp-type"><b>: </b><span>list index</span></span></span><br><span><var>i_n</var><span class="hyp-type"><b>: </b><span>(index * nat)%type</span></span></span><br><span><var>item</var><span class="hyp-type"><b>: </b><span>composite_transition_item IM</span></span></span><br><span><var>s</var><span class="hyp-type"><b>: </b><span>composite_state IM</span></span></span><br><span><var>Hdestruct</var><span class="hyp-type"><b>: </b><span>composite_state_destructor s&#39; i_n.<span class="mi">1</span>
!! i_n.<span class="mi">2</span> = Some (item, s)</span></span></span><br><span><var>Hchoice</var><span class="hyp-type"><b>: </b><span>choose s&#39; Hs&#39; (i :: l0) = i_n</span></span></span><br><span><var>indexed_composite_state_to_trace</var><span class="hyp-type"><b>: </b><span>choice_function
‚Üí <span class="kr">‚àÄ</span> <span class="nv">x0</span> : composite_state
          IM,
    valid_state_prop
      RFree x0
    ‚Üí <span class="kr">‚àÄ</span> <span class="nv">x2</span> : 
         list index,
        length x2 +
        composite_state_size
          x0 &lt;
        S
          (length
          l0 +
          composite_state_size
          s&#39;)
        ‚Üí composite_state
          IM *
          list
          (composite_transition_item
          IM)</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">composite_state_size s &lt; composite_state_size s&#39;</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><span class="alectryon-input"><span class="bp">by</span> <span class="nb">eapply</span> composite_tv_state_destructor_size, elem_of_list_lookup_2.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Qed</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="TraceableVLSM-v-chk8b" style="display: none" type="checkbox"><label class="alectryon-input" for="TraceableVLSM-v-chk8b"><span class="kn">Next Obligation</span>.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>message, index</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>EqDecision0</var><span class="hyp-type"><b>: </b><span>EqDecision index</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>finite.Finite index</span></span></span><br><span><var>IM</var><span class="hyp-type"><b>: </b><span>index ‚Üí VLSM message</span></span></span><br><span><var>state_destructor</var><span class="hyp-type"><b>: </b><span><span class="kr">‚àÄ</span> <span class="nv">i</span> : index,
  vstate (IM i)
  ‚Üí list
      (vtransition_item (IM i) *
       vstate (IM i))</span></span></span><br><span><var>state_size</var><span class="hyp-type"><b>: </b><span><span class="kr">‚àÄ</span> <span class="nv">i</span> : index, vstate (IM i) ‚Üí nat</span></span></span><br><span><var>H0</var><span class="hyp-type"><b>: </b><span><span class="kr">‚àÄ</span> <span class="nv">i</span> : index,
  TraceableVLSM (IM i) 
    (state_destructor i) 
    (state_size i)</span></span></span><br><span><var>Free</var><span><span class="hyp-body"><b>:= </b><span>free_composite_vlsm IM</span></span><span class="hyp-type"><b>: </b><span>VLSM message</span></span></span></span><br><span><var>RFree</var><span><span class="hyp-body"><b>:= </b><span>pre_loaded_with_all_messages_vlsm Free</span></span><span class="hyp-type"><b>: </b><span>VLSM message</span></span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="kr">‚àÄ</span> (<span class="nv">choose</span> : choice_function) (<span class="nv">s&#39;</span> : composite_state IM) 
  (<span class="nv">Hs&#39;</span> : valid_state_prop RFree s&#39;) (<span class="nv">i</span> : index) (<span class="nv">l0</span> : 
                                                 list
                                                 index) 
  (<span class="nv">i_n</span> : index * nat) (<span class="nv">e1</span> : composite_state_destructor
                              s&#39; i_n.<span class="mi">1</span> = []),
  (<span class="kr">Œª</span> <span class="nv">b</span> : {composite_state_destructor s&#39; i_n.<span class="mi">1</span> = []} +
         {composite_state_destructor s&#39; i_n.<span class="mi">1</span> ‚â† []},
     decide (composite_state_destructor s&#39; i_n.<span class="mi">1</span> = []) =
     b) (<span class="nb">left</span> e1)
  ‚Üí <span class="kr">‚àÄ</span> <span class="nv">e0</span> : i_n.<span class="mi">1</span> ‚àà i :: l0,
      (<span class="kr">Œª</span> <span class="nv">b</span> : {i_n.<span class="mi">1</span> ‚àà i :: l0} + {i_n.<span class="mi">1</span> ‚àâ i :: l0},
         decide (i_n.<span class="mi">1</span> ‚àà i :: l0) = b) (<span class="nb">left</span> e0)
      ‚Üí (<span class="kr">Œª</span> <span class="nv">b</span> : option
                 (composite_transition_item IM *
                  composite_state IM),
           composite_state_destructor s&#39; i_n.<span class="mi">1</span>
           !! i_n.<span class="mi">2</span> = b) None
        ‚Üí (<span class="kr">Œª</span> <span class="nv">b</span> : index * nat,
             choose s&#39; Hs&#39; (i :: l0) = b) i_n
          ‚Üí (choice_function
             ‚Üí <span class="kr">‚àÄ</span> <span class="nv">x0</span> : composite_state IM,
                 valid_state_prop RFree x0
                 ‚Üí <span class="kr">‚àÄ</span> <span class="nv">x2</span> : list index,
                     length x2 +
                     composite_state_size x0 &lt;
                     length (i :: l0) +
                     composite_state_size s&#39;
                     ‚Üí composite_state IM *
                       list
                         (composite_transition_item IM))
            ‚Üí <span class="kr">let</span> <span class="nv">indices</span> := i :: l0 <span class="kr">in</span>
              length
                (StdppListSet.set_remove i_n.<span class="mi">1</span> indices) +
              composite_state_size s&#39; &lt;
              length (i :: l0) +
              composite_state_size s&#39;</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="TraceableVLSM-v-chk8c" style="display: none" type="checkbox"><label class="alectryon-input" for="TraceableVLSM-v-chk8c"><span class="nb">intros</span>.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>message, index</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>EqDecision0</var><span class="hyp-type"><b>: </b><span>EqDecision index</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>finite.Finite index</span></span></span><br><span><var>IM</var><span class="hyp-type"><b>: </b><span>index ‚Üí VLSM message</span></span></span><br><span><var>state_destructor</var><span class="hyp-type"><b>: </b><span><span class="kr">‚àÄ</span> <span class="nv">i</span> : index,
  vstate (IM i)
  ‚Üí list
      (vtransition_item (IM i) *
       vstate (IM i))</span></span></span><br><span><var>state_size</var><span class="hyp-type"><b>: </b><span><span class="kr">‚àÄ</span> <span class="nv">i</span> : index, vstate (IM i) ‚Üí nat</span></span></span><br><span><var>H0</var><span class="hyp-type"><b>: </b><span><span class="kr">‚àÄ</span> <span class="nv">i</span> : index,
  TraceableVLSM (IM i) 
    (state_destructor i) 
    (state_size i)</span></span></span><br><span><var>Free</var><span><span class="hyp-body"><b>:= </b><span>free_composite_vlsm IM</span></span><span class="hyp-type"><b>: </b><span>VLSM message</span></span></span></span><br><span><var>RFree</var><span><span class="hyp-body"><b>:= </b><span>pre_loaded_with_all_messages_vlsm Free</span></span><span class="hyp-type"><b>: </b><span>VLSM message</span></span></span></span><br><span><var>choose</var><span class="hyp-type"><b>: </b><span>choice_function</span></span></span><br><span><var>s'</var><span class="hyp-type"><b>: </b><span>composite_state IM</span></span></span><br><span><var>Hs'</var><span class="hyp-type"><b>: </b><span>valid_state_prop RFree s&#39;</span></span></span><br><span><var>i</var><span class="hyp-type"><b>: </b><span>index</span></span></span><br><span><var>l0</var><span class="hyp-type"><b>: </b><span>list index</span></span></span><br><span><var>i_n</var><span class="hyp-type"><b>: </b><span>(index * nat)%type</span></span></span><br><span><var>e1</var><span class="hyp-type"><b>: </b><span>composite_state_destructor s&#39; i_n.<span class="mi">1</span> = []</span></span></span><br><span><var>Hnn</var><span class="hyp-type"><b>: </b><span>(<span class="kr">Œª</span> <span class="nv">b</span> : {composite_state_destructor s&#39; i_n.<span class="mi">1</span> = []}
       +
       {composite_state_destructor s&#39; i_n.<span class="mi">1</span> ‚â† []},
   decide
     (composite_state_destructor s&#39; i_n.<span class="mi">1</span> = []) =
   b) (<span class="nb">left</span> e1)</span></span></span><br><span><var>e0</var><span class="hyp-type"><b>: </b><span>i_n.<span class="mi">1</span> ‚àà i :: l0</span></span></span><br><span><var>Hi</var><span class="hyp-type"><b>: </b><span>(<span class="kr">Œª</span> <span class="nv">b</span> : {i_n.<span class="mi">1</span> ‚àà i :: l0} + {i_n.<span class="mi">1</span> ‚àâ i :: l0},
   decide (i_n.<span class="mi">1</span> ‚àà i :: l0) = b) 
  (<span class="nb">left</span> e0)</span></span></span><br><span><var>Hdestruct</var><span class="hyp-type"><b>: </b><span>(<span class="kr">Œª</span> <span class="nv">b</span> : option
         (composite_transition_item IM *
          composite_state IM),
   composite_state_destructor s&#39; i_n.<span class="mi">1</span>
   !! i_n.<span class="mi">2</span> = b) None</span></span></span><br><span><var>Hchoice</var><span class="hyp-type"><b>: </b><span>(<span class="kr">Œª</span> <span class="nv">b</span> : index * nat,
   choose s&#39; Hs&#39; (i :: l0) = b) i_n</span></span></span><br><span><var>indexed_composite_state_to_trace</var><span class="hyp-type"><b>: </b><span>choice_function
‚Üí <span class="kr">‚àÄ</span> <span class="nv">x0</span> : composite_state
          IM,
    valid_state_prop
      RFree x0
    ‚Üí <span class="kr">‚àÄ</span> <span class="nv">x2</span> : 
         list index,
        length x2 +
        composite_state_size
          x0 &lt;
        length
          (i :: l0) +
        composite_state_size
          s&#39;
        ‚Üí composite_state
          IM *
          list
          (composite_transition_item
          IM)</span></span></span><br><span><var>indices</var><span><span class="hyp-body"><b>:= </b><span>i :: l0</span></span><span class="hyp-type"><b>: </b><span>list index</span></span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">length (StdppListSet.set_remove i_n.<span class="mi">1</span> indices) +
composite_state_size s&#39; &lt;
length (i :: l0) + composite_state_size s&#39;</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="TraceableVLSM-v-chk8d" style="display: none" type="checkbox"><label class="alectryon-input" for="TraceableVLSM-v-chk8d"><span class="nb">cut</span> (S (length (StdppListSet.set_remove i_n.<span class="mi">1</span> indices)) &lt;= length indices); [<span class="nb">unfold</span> indices; <span class="bp">lia</span> |].</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>message, index</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>EqDecision0</var><span class="hyp-type"><b>: </b><span>EqDecision index</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>finite.Finite index</span></span></span><br><span><var>IM</var><span class="hyp-type"><b>: </b><span>index ‚Üí VLSM message</span></span></span><br><span><var>state_destructor</var><span class="hyp-type"><b>: </b><span><span class="kr">‚àÄ</span> <span class="nv">i</span> : index,
  vstate (IM i)
  ‚Üí list
      (vtransition_item (IM i) *
       vstate (IM i))</span></span></span><br><span><var>state_size</var><span class="hyp-type"><b>: </b><span><span class="kr">‚àÄ</span> <span class="nv">i</span> : index, vstate (IM i) ‚Üí nat</span></span></span><br><span><var>H0</var><span class="hyp-type"><b>: </b><span><span class="kr">‚àÄ</span> <span class="nv">i</span> : index,
  TraceableVLSM (IM i) 
    (state_destructor i) 
    (state_size i)</span></span></span><br><span><var>Free</var><span><span class="hyp-body"><b>:= </b><span>free_composite_vlsm IM</span></span><span class="hyp-type"><b>: </b><span>VLSM message</span></span></span></span><br><span><var>RFree</var><span><span class="hyp-body"><b>:= </b><span>pre_loaded_with_all_messages_vlsm Free</span></span><span class="hyp-type"><b>: </b><span>VLSM message</span></span></span></span><br><span><var>choose</var><span class="hyp-type"><b>: </b><span>choice_function</span></span></span><br><span><var>s'</var><span class="hyp-type"><b>: </b><span>composite_state IM</span></span></span><br><span><var>Hs'</var><span class="hyp-type"><b>: </b><span>valid_state_prop RFree s&#39;</span></span></span><br><span><var>i</var><span class="hyp-type"><b>: </b><span>index</span></span></span><br><span><var>l0</var><span class="hyp-type"><b>: </b><span>list index</span></span></span><br><span><var>i_n</var><span class="hyp-type"><b>: </b><span>(index * nat)%type</span></span></span><br><span><var>e1</var><span class="hyp-type"><b>: </b><span>composite_state_destructor s&#39; i_n.<span class="mi">1</span> = []</span></span></span><br><span><var>Hnn</var><span class="hyp-type"><b>: </b><span>(<span class="kr">Œª</span> <span class="nv">b</span> : {composite_state_destructor s&#39; i_n.<span class="mi">1</span> = []}
       +
       {composite_state_destructor s&#39; i_n.<span class="mi">1</span> ‚â† []},
   decide
     (composite_state_destructor s&#39; i_n.<span class="mi">1</span> = []) =
   b) (<span class="nb">left</span> e1)</span></span></span><br><span><var>e0</var><span class="hyp-type"><b>: </b><span>i_n.<span class="mi">1</span> ‚àà i :: l0</span></span></span><br><span><var>Hi</var><span class="hyp-type"><b>: </b><span>(<span class="kr">Œª</span> <span class="nv">b</span> : {i_n.<span class="mi">1</span> ‚àà i :: l0} + {i_n.<span class="mi">1</span> ‚àâ i :: l0},
   decide (i_n.<span class="mi">1</span> ‚àà i :: l0) = b) 
  (<span class="nb">left</span> e0)</span></span></span><br><span><var>Hdestruct</var><span class="hyp-type"><b>: </b><span>(<span class="kr">Œª</span> <span class="nv">b</span> : option
         (composite_transition_item IM *
          composite_state IM),
   composite_state_destructor s&#39; i_n.<span class="mi">1</span>
   !! i_n.<span class="mi">2</span> = b) None</span></span></span><br><span><var>Hchoice</var><span class="hyp-type"><b>: </b><span>(<span class="kr">Œª</span> <span class="nv">b</span> : index * nat,
   choose s&#39; Hs&#39; (i :: l0) = b) i_n</span></span></span><br><span><var>indexed_composite_state_to_trace</var><span class="hyp-type"><b>: </b><span>choice_function
‚Üí <span class="kr">‚àÄ</span> <span class="nv">x0</span> : composite_state
          IM,
    valid_state_prop
      RFree x0
    ‚Üí <span class="kr">‚àÄ</span> <span class="nv">x2</span> : 
         list index,
        length x2 +
        composite_state_size
          x0 &lt;
        length
          (i :: l0) +
        composite_state_size
          s&#39;
        ‚Üí composite_state
          IM *
          list
          (composite_transition_item
          IM)</span></span></span><br><span><var>indices</var><span><span class="hyp-body"><b>:= </b><span>i :: l0</span></span><span class="hyp-type"><b>: </b><span>list index</span></span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">S (length (StdppListSet.set_remove i_n.<span class="mi">1</span> indices))
‚â§ length indices</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><span class="alectryon-input"><span class="bp">by</span> <span class="nb">rewrite</span> &lt;- set_remove_length; [<span class="bp">lia</span> |].</span><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Qed</span>.</span></span></pre><div class="doc">
  For any composite ram-state <code>s</code> and for any index <code>i</code> for which the
  component state <code>s i</code> has the <span class="inlinecode"><span class="id" title="var">initial_state_prop</span></span>erty, the component state of
  index <code>i</code> of the origin state of the trace extracted from <code>s</code> is equal
  to <code>s i</code>.

</div><pre class="alectryon-io highlight"><!-- Generator: Alectryon --><span class="alectryon-sentence"><input class="alectryon-toggle" id="TraceableVLSM-v-chk8e" style="display: none" type="checkbox"><label class="alectryon-input" for="TraceableVLSM-v-chk8e"><span class="kn">Lemma</span> <span class="nf">indexed_composite_state_to_trace_reflects_initiality_1</span> :
  <span class="kr">forall</span> (<span class="nv">choose</span> : choice_function)
    (<span class="nv">s</span> : composite_state IM) (<span class="nv">Hs</span> : valid_state_prop RFree s)
    (<span class="nv">indices</span> : list index),
  <span class="kr">forall</span> (<span class="nv">i</span> : index), vinitial_state_prop (IM i) (s i) -&gt;
    <span class="kr">forall</span> <span class="nv">is</span> <span class="nv">tr</span>, indexed_composite_state_to_trace choose s Hs indices = (<span class="kr">is</span>, tr) -&gt;
    <span class="kr">is</span> i = s i.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>message, index</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>EqDecision0</var><span class="hyp-type"><b>: </b><span>EqDecision index</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>finite.Finite index</span></span></span><br><span><var>IM</var><span class="hyp-type"><b>: </b><span>index ‚Üí VLSM message</span></span></span><br><span><var>state_destructor</var><span class="hyp-type"><b>: </b><span><span class="kr">‚àÄ</span> <span class="nv">i</span> : index,
  vstate (IM i)
  ‚Üí list
      (vtransition_item (IM i) *
       vstate (IM i))</span></span></span><br><span><var>state_size</var><span class="hyp-type"><b>: </b><span><span class="kr">‚àÄ</span> <span class="nv">i</span> : index, vstate (IM i) ‚Üí nat</span></span></span><br><span><var>H0</var><span class="hyp-type"><b>: </b><span><span class="kr">‚àÄ</span> <span class="nv">i</span> : index,
  TraceableVLSM (IM i) 
    (state_destructor i) 
    (state_size i)</span></span></span><br><span><var>Free</var><span><span class="hyp-body"><b>:= </b><span>free_composite_vlsm IM</span></span><span class="hyp-type"><b>: </b><span>VLSM message</span></span></span></span><br><span><var>RFree</var><span><span class="hyp-body"><b>:= </b><span>pre_loaded_with_all_messages_vlsm Free</span></span><span class="hyp-type"><b>: </b><span>VLSM message</span></span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="kr">‚àÄ</span> (<span class="nv">choose</span> : choice_function) (<span class="nv">s</span> : composite_state IM) 
  (<span class="nv">Hs</span> : valid_state_prop RFree s) (<span class="nv">indices</span> : list
                                               index) 
  (<span class="nv">i</span> : index),
  vinitial_state_prop (IM i) (s i)
  ‚Üí <span class="kr">‚àÄ</span> (<span class="nv">is</span> : composite_state IM) (<span class="nv">tr</span> : list
                                        (composite_transition_item
                                           IM)),
      indexed_composite_state_to_trace choose s Hs
        indices = (<span class="kr">is</span>, tr) ‚Üí <span class="kr">is</span> i = s i</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="TraceableVLSM-v-chk8f" style="display: none" type="checkbox"><label class="alectryon-input" for="TraceableVLSM-v-chk8f"><span class="kn">Proof</span>.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>message, index</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>EqDecision0</var><span class="hyp-type"><b>: </b><span>EqDecision index</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>finite.Finite index</span></span></span><br><span><var>IM</var><span class="hyp-type"><b>: </b><span>index ‚Üí VLSM message</span></span></span><br><span><var>state_destructor</var><span class="hyp-type"><b>: </b><span><span class="kr">‚àÄ</span> <span class="nv">i</span> : index,
  vstate (IM i)
  ‚Üí list
      (vtransition_item (IM i) *
       vstate (IM i))</span></span></span><br><span><var>state_size</var><span class="hyp-type"><b>: </b><span><span class="kr">‚àÄ</span> <span class="nv">i</span> : index, vstate (IM i) ‚Üí nat</span></span></span><br><span><var>H0</var><span class="hyp-type"><b>: </b><span><span class="kr">‚àÄ</span> <span class="nv">i</span> : index,
  TraceableVLSM (IM i) 
    (state_destructor i) 
    (state_size i)</span></span></span><br><span><var>Free</var><span><span class="hyp-body"><b>:= </b><span>free_composite_vlsm IM</span></span><span class="hyp-type"><b>: </b><span>VLSM message</span></span></span></span><br><span><var>RFree</var><span><span class="hyp-body"><b>:= </b><span>pre_loaded_with_all_messages_vlsm Free</span></span><span class="hyp-type"><b>: </b><span>VLSM message</span></span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="kr">‚àÄ</span> (<span class="nv">choose</span> : choice_function) (<span class="nv">s</span> : composite_state IM) 
  (<span class="nv">Hs</span> : valid_state_prop RFree s) (<span class="nv">indices</span> : list
                                               index) 
  (<span class="nv">i</span> : index),
  vinitial_state_prop (IM i) (s i)
  ‚Üí <span class="kr">‚àÄ</span> (<span class="nv">is</span> : composite_state IM) (<span class="nv">tr</span> : list
                                        (composite_transition_item
                                           IM)),
      indexed_composite_state_to_trace choose s Hs
        indices = (<span class="kr">is</span>, tr) ‚Üí <span class="kr">is</span> i = s i</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="TraceableVLSM-v-chk90" style="display: none" type="checkbox"><label class="alectryon-input" for="TraceableVLSM-v-chk90"><span class="nb">intros</span> ? ? ? ?.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>message, index</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>EqDecision0</var><span class="hyp-type"><b>: </b><span>EqDecision index</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>finite.Finite index</span></span></span><br><span><var>IM</var><span class="hyp-type"><b>: </b><span>index ‚Üí VLSM message</span></span></span><br><span><var>state_destructor</var><span class="hyp-type"><b>: </b><span><span class="kr">‚àÄ</span> <span class="nv">i</span> : index,
  vstate (IM i)
  ‚Üí list
      (vtransition_item (IM i) *
       vstate (IM i))</span></span></span><br><span><var>state_size</var><span class="hyp-type"><b>: </b><span><span class="kr">‚àÄ</span> <span class="nv">i</span> : index, vstate (IM i) ‚Üí nat</span></span></span><br><span><var>H0</var><span class="hyp-type"><b>: </b><span><span class="kr">‚àÄ</span> <span class="nv">i</span> : index,
  TraceableVLSM (IM i) 
    (state_destructor i) 
    (state_size i)</span></span></span><br><span><var>Free</var><span><span class="hyp-body"><b>:= </b><span>free_composite_vlsm IM</span></span><span class="hyp-type"><b>: </b><span>VLSM message</span></span></span></span><br><span><var>RFree</var><span><span class="hyp-body"><b>:= </b><span>pre_loaded_with_all_messages_vlsm Free</span></span><span class="hyp-type"><b>: </b><span>VLSM message</span></span></span></span><br><span><var>choose</var><span class="hyp-type"><b>: </b><span>choice_function</span></span></span><br><span><var>s</var><span class="hyp-type"><b>: </b><span>composite_state IM</span></span></span><br><span><var>Hs</var><span class="hyp-type"><b>: </b><span>valid_state_prop RFree s</span></span></span><br><span><var>indices</var><span class="hyp-type"><b>: </b><span>list index</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="kr">‚àÄ</span> <span class="nv">i</span> : index,
  vinitial_state_prop (IM i) (s i)
  ‚Üí <span class="kr">‚àÄ</span> (<span class="nv">is</span> : composite_state IM) (<span class="nv">tr</span> : list
                                        (composite_transition_item
                                           IM)),
      indexed_composite_state_to_trace choose s Hs
        indices = (<span class="kr">is</span>, tr) ‚Üí <span class="kr">is</span> i = s i</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="TraceableVLSM-v-chk91" style="display: none" type="checkbox"><label class="alectryon-input" for="TraceableVLSM-v-chk91">apply_funelim (indexed_composite_state_to_trace choose s Hs indices);
    <span class="nb">clear</span> choose s Hs indices; <span class="nb">intros</span> ? ? ?.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>message, index</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>EqDecision0</var><span class="hyp-type"><b>: </b><span>EqDecision index</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>finite.Finite index</span></span></span><br><span><var>IM</var><span class="hyp-type"><b>: </b><span>index ‚Üí VLSM message</span></span></span><br><span><var>state_destructor</var><span class="hyp-type"><b>: </b><span><span class="kr">‚àÄ</span> <span class="nv">i</span> : index,
  vstate (IM i)
  ‚Üí list
      (vtransition_item (IM i) *
       vstate (IM i))</span></span></span><br><span><var>state_size</var><span class="hyp-type"><b>: </b><span><span class="kr">‚àÄ</span> <span class="nv">i</span> : index, vstate (IM i) ‚Üí nat</span></span></span><br><span><var>H0</var><span class="hyp-type"><b>: </b><span><span class="kr">‚àÄ</span> <span class="nv">i</span> : index,
  TraceableVLSM (IM i) 
    (state_destructor i) 
    (state_size i)</span></span></span><br><span><var>Free</var><span><span class="hyp-body"><b>:= </b><span>free_composite_vlsm IM</span></span><span class="hyp-type"><b>: </b><span>VLSM message</span></span></span></span><br><span><var>RFree</var><span><span class="hyp-body"><b>:= </b><span>pre_loaded_with_all_messages_vlsm Free</span></span><span class="hyp-type"><b>: </b><span>VLSM message</span></span></span></span><br><span><var>choose</var><span class="hyp-type"><b>: </b><span>choice_function</span></span></span><br><span><var>s'</var><span class="hyp-type"><b>: </b><span>composite_state IM</span></span></span><br><span><var>Hs'</var><span class="hyp-type"><b>: </b><span>valid_state_prop RFree s&#39;</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="kr">‚àÄ</span> <span class="nv">i</span> : index,
  vinitial_state_prop (IM i) (s&#39; i)
  ‚Üí <span class="kr">‚àÄ</span> (<span class="nv">is</span> : composite_state IM) (<span class="nv">tr</span> : list
                                        (composite_transition_item
                                           IM)),
      (s&#39;, []) = (<span class="kr">is</span>, tr) ‚Üí <span class="kr">is</span> i = s&#39; i</div></blockquote><div class="alectryon-extra-goals"><input class="alectryon-extra-goal-toggle" id="TraceableVLSM-v-chk92" style="display: none" type="checkbox"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>message, index</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>EqDecision0</var><span class="hyp-type"><b>: </b><span>EqDecision index</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>finite.Finite index</span></span></span><br><span><var>IM</var><span class="hyp-type"><b>: </b><span>index ‚Üí VLSM message</span></span></span><br><span><var>state_destructor</var><span class="hyp-type"><b>: </b><span><span class="kr">‚àÄ</span> <span class="nv">i</span> : index,
  vstate (IM i)
  ‚Üí list
      (vtransition_item (IM i) *
       vstate (IM i))</span></span></span><br><span><var>state_size</var><span class="hyp-type"><b>: </b><span><span class="kr">‚àÄ</span> <span class="nv">i</span> : index, vstate (IM i) ‚Üí nat</span></span></span><br><span><var>H0</var><span class="hyp-type"><b>: </b><span><span class="kr">‚àÄ</span> <span class="nv">i</span> : index,
  TraceableVLSM (IM i) 
    (state_destructor i) 
    (state_size i)</span></span></span><br><span><var>Free</var><span><span class="hyp-body"><b>:= </b><span>free_composite_vlsm IM</span></span><span class="hyp-type"><b>: </b><span>VLSM message</span></span></span></span><br><span><var>RFree</var><span><span class="hyp-body"><b>:= </b><span>pre_loaded_with_all_messages_vlsm Free</span></span><span class="hyp-type"><b>: </b><span>VLSM message</span></span></span></span><br><span><var>choose</var><span class="hyp-type"><b>: </b><span>choice_function</span></span></span><br><span><var>s'</var><span class="hyp-type"><b>: </b><span>composite_state IM</span></span></span><br><span><var>Hs'</var><span class="hyp-type"><b>: </b><span>valid_state_prop RFree s&#39;</span></span></span><br></div><label class="goal-separator" for="TraceableVLSM-v-chk92"><hr></label><div class="goal-conclusion"><span class="kr">‚àÄ</span> (<span class="nv">i</span> : index) (<span class="nv">l0</span> : list index) 
  (<span class="nv">i_n</span> : index * nat) (<span class="nv">item</span> : 
                      composite_transition_item IM) 
  (<span class="nv">s</span> : composite_state IM) 
  (<span class="nv">Hdestruct</span> : composite_state_destructor s&#39; i_n.<span class="mi">1</span>
               !! i_n.<span class="mi">2</span> = 
               Some (item, s)) 
  (<span class="nv">Hchoice</span> : choose s&#39; Hs&#39; (i :: l0) = i_n) 
  (<span class="nv">is</span> : composite_state IM) 
  (<span class="nv">tr</span> : list (composite_transition_item IM)),
  indexed_composite_state_to_trace choose s
    (indexed_composite_state_to_trace_obligations_obligation_1
       s&#39; Hs&#39; i_n item s Hdestruct) 
    (i :: l0) = (<span class="kr">is</span>, tr)
  ‚Üí (<span class="kr">‚àÄ</span> <span class="nv">i0</span> : index,
       vinitial_state_prop (IM i0) (s i0)
       ‚Üí <span class="kr">‚àÄ</span> (<span class="nv">is0</span> : composite_state IM) 
           (<span class="nv">tr0</span> : list (composite_transition_item IM)),
           indexed_composite_state_to_trace choose s
             (indexed_composite_state_to_trace_obligations_obligation_1
                s&#39; Hs&#39; i_n item s Hdestruct) 
             (i :: l0) = 
           (is0, tr0) ‚Üí 
           is0 i0 = s i0)
    ‚Üí inspect
        (composite_state_destructor s&#39; i_n.<span class="mi">1</span> !! i_n.<span class="mi">2</span>) =
      Some (item, s) ‚Üæ Hdestruct
      ‚Üí inspect (choose s&#39; Hs&#39; (i :: l0)) =
        i_n ‚Üæ Hchoice
        ‚Üí <span class="kr">‚àÄ</span> <span class="nv">i0</span> : index,
            vinitial_state_prop (IM i0) (s&#39; i0)
            ‚Üí <span class="kr">‚àÄ</span> (<span class="nv">is0</span> : composite_state IM) 
                (<span class="nv">tr0</span> : 
                 list (composite_transition_item IM)),
                (<span class="kr">is</span>, tr ++ [item]) = (is0, tr0)
                ‚Üí is0 i0 = s&#39; i0</div></blockquote><input class="alectryon-extra-goal-toggle" id="TraceableVLSM-v-chk93" style="display: none" type="checkbox"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>message, index</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>EqDecision0</var><span class="hyp-type"><b>: </b><span>EqDecision index</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>finite.Finite index</span></span></span><br><span><var>IM</var><span class="hyp-type"><b>: </b><span>index ‚Üí VLSM message</span></span></span><br><span><var>state_destructor</var><span class="hyp-type"><b>: </b><span><span class="kr">‚àÄ</span> <span class="nv">i</span> : index,
  vstate (IM i)
  ‚Üí list
      (vtransition_item (IM i) *
       vstate (IM i))</span></span></span><br><span><var>state_size</var><span class="hyp-type"><b>: </b><span><span class="kr">‚àÄ</span> <span class="nv">i</span> : index, vstate (IM i) ‚Üí nat</span></span></span><br><span><var>H0</var><span class="hyp-type"><b>: </b><span><span class="kr">‚àÄ</span> <span class="nv">i</span> : index,
  TraceableVLSM (IM i) 
    (state_destructor i) 
    (state_size i)</span></span></span><br><span><var>Free</var><span><span class="hyp-body"><b>:= </b><span>free_composite_vlsm IM</span></span><span class="hyp-type"><b>: </b><span>VLSM message</span></span></span></span><br><span><var>RFree</var><span><span class="hyp-body"><b>:= </b><span>pre_loaded_with_all_messages_vlsm Free</span></span><span class="hyp-type"><b>: </b><span>VLSM message</span></span></span></span><br><span><var>choose</var><span class="hyp-type"><b>: </b><span>choice_function</span></span></span><br><span><var>s'</var><span class="hyp-type"><b>: </b><span>composite_state IM</span></span></span><br><span><var>Hs'</var><span class="hyp-type"><b>: </b><span>valid_state_prop RFree s&#39;</span></span></span><br></div><label class="goal-separator" for="TraceableVLSM-v-chk93"><hr></label><div class="goal-conclusion"><span class="kr">‚àÄ</span> (<span class="nv">i</span> : index) (<span class="nv">l0</span> : list index) 
  (<span class="nv">i_n</span> : index * nat) (<span class="nv">n</span> : i_n.<span class="mi">1</span> ‚àâ i :: l0) 
  (<span class="nv">Hni</span> : decide (i_n.<span class="mi">1</span> ‚àà i :: l0) = <span class="nb">right</span> n) 
  (<span class="nv">Hdestruct</span> : composite_state_destructor s&#39; i_n.<span class="mi">1</span>
               !! i_n.<span class="mi">2</span> = None) 
  (<span class="nv">Hchoice</span> : choose s&#39; Hs&#39; (i :: l0) = i_n),
  inspect (decide (i_n.<span class="mi">1</span> ‚àà i :: l0)) = <span class="nb">right</span> n ‚Üæ Hni
  ‚Üí inspect
      (composite_state_destructor s&#39; i_n.<span class="mi">1</span> !! i_n.<span class="mi">2</span>) =
    None ‚Üæ Hdestruct
    ‚Üí inspect (choose s&#39; Hs&#39; (i :: l0)) =
      i_n ‚Üæ Hchoice
      ‚Üí <span class="kr">‚àÄ</span> <span class="nv">i0</span> : index,
          vinitial_state_prop (IM i0) (s&#39; i0)
          ‚Üí <span class="kr">‚àÄ</span> (<span class="nv">is</span> : composite_state IM) 
              (<span class="nv">tr</span> : list
                      (composite_transition_item IM)),
              (s&#39;, []) = (<span class="kr">is</span>, tr) ‚Üí <span class="kr">is</span> i0 = s&#39; i0</div></blockquote><input class="alectryon-extra-goal-toggle" id="TraceableVLSM-v-chk94" style="display: none" type="checkbox"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>message, index</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>EqDecision0</var><span class="hyp-type"><b>: </b><span>EqDecision index</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>finite.Finite index</span></span></span><br><span><var>IM</var><span class="hyp-type"><b>: </b><span>index ‚Üí VLSM message</span></span></span><br><span><var>state_destructor</var><span class="hyp-type"><b>: </b><span><span class="kr">‚àÄ</span> <span class="nv">i</span> : index,
  vstate (IM i)
  ‚Üí list
      (vtransition_item (IM i) *
       vstate (IM i))</span></span></span><br><span><var>state_size</var><span class="hyp-type"><b>: </b><span><span class="kr">‚àÄ</span> <span class="nv">i</span> : index, vstate (IM i) ‚Üí nat</span></span></span><br><span><var>H0</var><span class="hyp-type"><b>: </b><span><span class="kr">‚àÄ</span> <span class="nv">i</span> : index,
  TraceableVLSM (IM i) 
    (state_destructor i) 
    (state_size i)</span></span></span><br><span><var>Free</var><span><span class="hyp-body"><b>:= </b><span>free_composite_vlsm IM</span></span><span class="hyp-type"><b>: </b><span>VLSM message</span></span></span></span><br><span><var>RFree</var><span><span class="hyp-body"><b>:= </b><span>pre_loaded_with_all_messages_vlsm Free</span></span><span class="hyp-type"><b>: </b><span>VLSM message</span></span></span></span><br><span><var>choose</var><span class="hyp-type"><b>: </b><span>choice_function</span></span></span><br><span><var>s'</var><span class="hyp-type"><b>: </b><span>composite_state IM</span></span></span><br><span><var>Hs'</var><span class="hyp-type"><b>: </b><span>valid_state_prop RFree s&#39;</span></span></span><br></div><label class="goal-separator" for="TraceableVLSM-v-chk94"><hr></label><div class="goal-conclusion"><span class="kr">‚àÄ</span> (<span class="nv">i</span> : index) (<span class="nv">l0</span> : list index) 
  (<span class="nv">i_n</span> : index * nat) (<span class="nv">e1</span> : 
                      composite_state_destructor s&#39;
                      i_n.<span class="mi">1</span> = []) 
  (<span class="nv">Hnn</span> : decide
           (composite_state_destructor s&#39; i_n.<span class="mi">1</span> = []) =
         <span class="nb">left</span> e1) (<span class="nv">e0</span> : i_n.<span class="mi">1</span> ‚àà i :: l0) 
  (<span class="nv">Hi</span> : decide (i_n.<span class="mi">1</span> ‚àà i :: l0) = <span class="nb">left</span> e0) 
  (<span class="nv">Hdestruct</span> : composite_state_destructor s&#39; i_n.<span class="mi">1</span>
               !! i_n.<span class="mi">2</span> = None) 
  (<span class="nv">Hchoice</span> : choose s&#39; Hs&#39; (i :: l0) = i_n),
  (<span class="kr">‚àÄ</span> <span class="nv">i0</span> : index,
     vinitial_state_prop (IM i0) (s&#39; i0)
     ‚Üí <span class="kr">‚àÄ</span> (<span class="nv">is</span> : composite_state IM) 
         (<span class="nv">tr</span> : list (composite_transition_item IM)),
         indexed_composite_state_to_trace choose s&#39;
           Hs&#39;
           (StdppListSet.set_remove i_n.<span class="mi">1</span> (i :: l0)) =
         (<span class="kr">is</span>, tr) ‚Üí <span class="kr">is</span> i0 = s&#39; i0)
  ‚Üí inspect
      (decide
         (composite_state_destructor s&#39; i_n.<span class="mi">1</span> = [])) =
    <span class="nb">left</span> e1 ‚Üæ Hnn
    ‚Üí inspect (decide (i_n.<span class="mi">1</span> ‚àà i :: l0)) =
      <span class="nb">left</span> e0 ‚Üæ Hi
      ‚Üí inspect
          (composite_state_destructor s&#39; i_n.<span class="mi">1</span>
           !! i_n.<span class="mi">2</span>) = 
        None ‚Üæ Hdestruct
        ‚Üí inspect (choose s&#39; Hs&#39; (i :: l0)) =
          i_n ‚Üæ Hchoice
          ‚Üí <span class="kr">‚àÄ</span> <span class="nv">i0</span> : index,
              vinitial_state_prop (IM i0) (s&#39; i0)
              ‚Üí <span class="kr">‚àÄ</span> (<span class="nv">is</span> : composite_state IM) 
                  (<span class="nv">tr</span> : 
                   list 
                     (composite_transition_item IM)),
                  indexed_composite_state_to_trace
                    choose s&#39; Hs&#39;
                    (StdppListSet.set_remove i_n.<span class="mi">1</span>
                      (i :: l0)) = 
                  (<span class="kr">is</span>, tr) ‚Üí 
                  <span class="kr">is</span> i0 = s&#39; i0</div></blockquote><input class="alectryon-extra-goal-toggle" id="TraceableVLSM-v-chk95" style="display: none" type="checkbox"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>message, index</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>EqDecision0</var><span class="hyp-type"><b>: </b><span>EqDecision index</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>finite.Finite index</span></span></span><br><span><var>IM</var><span class="hyp-type"><b>: </b><span>index ‚Üí VLSM message</span></span></span><br><span><var>state_destructor</var><span class="hyp-type"><b>: </b><span><span class="kr">‚àÄ</span> <span class="nv">i</span> : index,
  vstate (IM i)
  ‚Üí list
      (vtransition_item (IM i) *
       vstate (IM i))</span></span></span><br><span><var>state_size</var><span class="hyp-type"><b>: </b><span><span class="kr">‚àÄ</span> <span class="nv">i</span> : index, vstate (IM i) ‚Üí nat</span></span></span><br><span><var>H0</var><span class="hyp-type"><b>: </b><span><span class="kr">‚àÄ</span> <span class="nv">i</span> : index,
  TraceableVLSM (IM i) 
    (state_destructor i) 
    (state_size i)</span></span></span><br><span><var>Free</var><span><span class="hyp-body"><b>:= </b><span>free_composite_vlsm IM</span></span><span class="hyp-type"><b>: </b><span>VLSM message</span></span></span></span><br><span><var>RFree</var><span><span class="hyp-body"><b>:= </b><span>pre_loaded_with_all_messages_vlsm Free</span></span><span class="hyp-type"><b>: </b><span>VLSM message</span></span></span></span><br><span><var>choose</var><span class="hyp-type"><b>: </b><span>choice_function</span></span></span><br><span><var>s'</var><span class="hyp-type"><b>: </b><span>composite_state IM</span></span></span><br><span><var>Hs'</var><span class="hyp-type"><b>: </b><span>valid_state_prop RFree s&#39;</span></span></span><br></div><label class="goal-separator" for="TraceableVLSM-v-chk95"><hr></label><div class="goal-conclusion"><span class="kr">‚àÄ</span> (<span class="nv">i</span> : index) (<span class="nv">l0</span> : list index) 
  (<span class="nv">i_n</span> : index * nat) (<span class="nv">n</span> : 
                      composite_state_destructor s&#39;
                      i_n.<span class="mi">1</span> ‚â† []) 
  (<span class="nv">Hn</span> : decide
          (composite_state_destructor s&#39; i_n.<span class="mi">1</span> = []) =
        <span class="nb">right</span> n) (<span class="nv">e0</span> : i_n.<span class="mi">1</span> ‚àà i :: l0) 
  (<span class="nv">Hi</span> : decide (i_n.<span class="mi">1</span> ‚àà i :: l0) = <span class="nb">left</span> e0) 
  (<span class="nv">Hdestruct</span> : composite_state_destructor s&#39; i_n.<span class="mi">1</span>
               !! i_n.<span class="mi">2</span> = None) 
  (<span class="nv">Hchoice</span> : choose s&#39; Hs&#39; (i :: l0) = i_n),
  inspect
    (decide (composite_state_destructor s&#39; i_n.<span class="mi">1</span> = [])) =
  <span class="nb">right</span> n ‚Üæ Hn
  ‚Üí inspect (decide (i_n.<span class="mi">1</span> ‚àà i :: l0)) = <span class="nb">left</span> e0 ‚Üæ Hi
    ‚Üí inspect
        (composite_state_destructor s&#39; i_n.<span class="mi">1</span> !! i_n.<span class="mi">2</span>) =
      None ‚Üæ Hdestruct
      ‚Üí inspect (choose s&#39; Hs&#39; (i :: l0)) =
        i_n ‚Üæ Hchoice
        ‚Üí <span class="kr">‚àÄ</span> <span class="nv">i0</span> : index,
            vinitial_state_prop (IM i0) (s&#39; i0)
            ‚Üí <span class="kr">‚àÄ</span> (<span class="nv">is</span> : composite_state IM) 
                (<span class="nv">tr</span> : list
                      (composite_transition_item IM)),
                (s&#39;, []) = (<span class="kr">is</span>, tr) ‚Üí <span class="kr">is</span> i0 = s&#39; i0</div></blockquote></div></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="TraceableVLSM-v-chk96" style="display: none" type="checkbox"><label class="alectryon-input" for="TraceableVLSM-v-chk96">-</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>message, index</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>EqDecision0</var><span class="hyp-type"><b>: </b><span>EqDecision index</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>finite.Finite index</span></span></span><br><span><var>IM</var><span class="hyp-type"><b>: </b><span>index ‚Üí VLSM message</span></span></span><br><span><var>state_destructor</var><span class="hyp-type"><b>: </b><span><span class="kr">‚àÄ</span> <span class="nv">i</span> : index,
  vstate (IM i)
  ‚Üí list
      (vtransition_item (IM i) *
       vstate (IM i))</span></span></span><br><span><var>state_size</var><span class="hyp-type"><b>: </b><span><span class="kr">‚àÄ</span> <span class="nv">i</span> : index, vstate (IM i) ‚Üí nat</span></span></span><br><span><var>H0</var><span class="hyp-type"><b>: </b><span><span class="kr">‚àÄ</span> <span class="nv">i</span> : index,
  TraceableVLSM (IM i) 
    (state_destructor i) 
    (state_size i)</span></span></span><br><span><var>Free</var><span><span class="hyp-body"><b>:= </b><span>free_composite_vlsm IM</span></span><span class="hyp-type"><b>: </b><span>VLSM message</span></span></span></span><br><span><var>RFree</var><span><span class="hyp-body"><b>:= </b><span>pre_loaded_with_all_messages_vlsm Free</span></span><span class="hyp-type"><b>: </b><span>VLSM message</span></span></span></span><br><span><var>choose</var><span class="hyp-type"><b>: </b><span>choice_function</span></span></span><br><span><var>s'</var><span class="hyp-type"><b>: </b><span>composite_state IM</span></span></span><br><span><var>Hs'</var><span class="hyp-type"><b>: </b><span>valid_state_prop RFree s&#39;</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="kr">‚àÄ</span> <span class="nv">i</span> : index,
  vinitial_state_prop (IM i) (s&#39; i)
  ‚Üí <span class="kr">‚àÄ</span> (<span class="nv">is</span> : composite_state IM) (<span class="nv">tr</span> : list
                                        (composite_transition_item
                                           IM)),
      (s&#39;, []) = (<span class="kr">is</span>, tr) ‚Üí <span class="kr">is</span> i = s&#39; i</div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="bp">by</span> <span class="nb">inversion</span> <span class="mi">2</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="TraceableVLSM-v-chk97" style="display: none" type="checkbox"><label class="alectryon-input" for="TraceableVLSM-v-chk97">-</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>message, index</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>EqDecision0</var><span class="hyp-type"><b>: </b><span>EqDecision index</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>finite.Finite index</span></span></span><br><span><var>IM</var><span class="hyp-type"><b>: </b><span>index ‚Üí VLSM message</span></span></span><br><span><var>state_destructor</var><span class="hyp-type"><b>: </b><span><span class="kr">‚àÄ</span> <span class="nv">i</span> : index,
  vstate (IM i)
  ‚Üí list
      (vtransition_item (IM i) *
       vstate (IM i))</span></span></span><br><span><var>state_size</var><span class="hyp-type"><b>: </b><span><span class="kr">‚àÄ</span> <span class="nv">i</span> : index, vstate (IM i) ‚Üí nat</span></span></span><br><span><var>H0</var><span class="hyp-type"><b>: </b><span><span class="kr">‚àÄ</span> <span class="nv">i</span> : index,
  TraceableVLSM (IM i) 
    (state_destructor i) 
    (state_size i)</span></span></span><br><span><var>Free</var><span><span class="hyp-body"><b>:= </b><span>free_composite_vlsm IM</span></span><span class="hyp-type"><b>: </b><span>VLSM message</span></span></span></span><br><span><var>RFree</var><span><span class="hyp-body"><b>:= </b><span>pre_loaded_with_all_messages_vlsm Free</span></span><span class="hyp-type"><b>: </b><span>VLSM message</span></span></span></span><br><span><var>choose</var><span class="hyp-type"><b>: </b><span>choice_function</span></span></span><br><span><var>s'</var><span class="hyp-type"><b>: </b><span>composite_state IM</span></span></span><br><span><var>Hs'</var><span class="hyp-type"><b>: </b><span>valid_state_prop RFree s&#39;</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="kr">‚àÄ</span> (<span class="nv">i</span> : index) (<span class="nv">l0</span> : list index) (<span class="nv">i_n</span> : index * nat) 
  (<span class="nv">item</span> : composite_transition_item IM) (<span class="nv">s</span> : composite_state
                                               IM) 
  (<span class="nv">Hdestruct</span> : composite_state_destructor s&#39; i_n.<span class="mi">1</span>
               !! i_n.<span class="mi">2</span> = Some (item, s)) (<span class="nv">Hchoice</span> : 
                                           choose s&#39;
                                             Hs&#39;
                                             (i :: l0) =
                                           i_n) (<span class="nv">is</span> : 
                                                 composite_state
                                                 IM) 
  (<span class="nv">tr</span> : list (composite_transition_item IM)),
  indexed_composite_state_to_trace choose s
    (indexed_composite_state_to_trace_obligations_obligation_1
       s&#39; Hs&#39; i_n item s Hdestruct) (i :: l0) =
  (<span class="kr">is</span>, tr)
  ‚Üí (<span class="kr">‚àÄ</span> <span class="nv">i0</span> : index,
       vinitial_state_prop (IM i0) (s i0)
       ‚Üí <span class="kr">‚àÄ</span> (<span class="nv">is0</span> : composite_state IM) (<span class="nv">tr0</span> : list
                                               (composite_transition_item
                                                 IM)),
           indexed_composite_state_to_trace choose s
             (indexed_composite_state_to_trace_obligations_obligation_1
                s&#39; Hs&#39; i_n item s Hdestruct) (i :: l0) =
           (is0, tr0) ‚Üí is0 i0 = s i0)
    ‚Üí inspect
        (composite_state_destructor s&#39; i_n.<span class="mi">1</span> !! i_n.<span class="mi">2</span>) =
      Some (item, s) ‚Üæ Hdestruct
      ‚Üí inspect (choose s&#39; Hs&#39; (i :: l0)) =
        i_n ‚Üæ Hchoice
        ‚Üí <span class="kr">‚àÄ</span> <span class="nv">i0</span> : index,
            vinitial_state_prop (IM i0) (s&#39; i0)
            ‚Üí <span class="kr">‚àÄ</span> (<span class="nv">is0</span> : composite_state IM) (<span class="nv">tr0</span> : 
                                            list
                                              (composite_transition_item
                                                 IM)),
                (<span class="kr">is</span>, tr ++ [item]) = (is0, tr0)
                ‚Üí is0 i0 = s&#39; i0</div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="TraceableVLSM-v-chk98" style="display: none" type="checkbox"><label class="alectryon-input" for="TraceableVLSM-v-chk98"><span class="nb">intros</span> * -&gt; Hind _ _ i Hi is&#39; tr&#39; [= -&gt; &lt;-].</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>message, index</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>EqDecision0</var><span class="hyp-type"><b>: </b><span>EqDecision index</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>finite.Finite index</span></span></span><br><span><var>IM</var><span class="hyp-type"><b>: </b><span>index ‚Üí VLSM message</span></span></span><br><span><var>state_destructor</var><span class="hyp-type"><b>: </b><span><span class="kr">‚àÄ</span> <span class="nv">i</span> : index,
  vstate (IM i)
  ‚Üí list
      (vtransition_item (IM i) *
       vstate (IM i))</span></span></span><br><span><var>state_size</var><span class="hyp-type"><b>: </b><span><span class="kr">‚àÄ</span> <span class="nv">i</span> : index, vstate (IM i) ‚Üí nat</span></span></span><br><span><var>H0</var><span class="hyp-type"><b>: </b><span><span class="kr">‚àÄ</span> <span class="nv">i</span> : index,
  TraceableVLSM (IM i) 
    (state_destructor i) 
    (state_size i)</span></span></span><br><span><var>Free</var><span><span class="hyp-body"><b>:= </b><span>free_composite_vlsm IM</span></span><span class="hyp-type"><b>: </b><span>VLSM message</span></span></span></span><br><span><var>RFree</var><span><span class="hyp-body"><b>:= </b><span>pre_loaded_with_all_messages_vlsm Free</span></span><span class="hyp-type"><b>: </b><span>VLSM message</span></span></span></span><br><span><var>choose</var><span class="hyp-type"><b>: </b><span>choice_function</span></span></span><br><span><var>s'</var><span class="hyp-type"><b>: </b><span>composite_state IM</span></span></span><br><span><var>Hs'</var><span class="hyp-type"><b>: </b><span>valid_state_prop RFree s&#39;</span></span></span><br><span><var>i0</var><span class="hyp-type"><b>: </b><span>index</span></span></span><br><span><var>l0</var><span class="hyp-type"><b>: </b><span>list index</span></span></span><br><span><var>i_n</var><span class="hyp-type"><b>: </b><span>(index * nat)%type</span></span></span><br><span><var>item</var><span class="hyp-type"><b>: </b><span>composite_transition_item IM</span></span></span><br><span><var>s</var><span class="hyp-type"><b>: </b><span>composite_state IM</span></span></span><br><span><var>Hdestruct</var><span class="hyp-type"><b>: </b><span>composite_state_destructor s&#39; i_n.<span class="mi">1</span>
!! i_n.<span class="mi">2</span> = Some (item, s)</span></span></span><br><span><var>Hchoice</var><span class="hyp-type"><b>: </b><span>choose s&#39; Hs&#39; (i0 :: l0) = i_n</span></span></span><br><span><var>tr</var><span class="hyp-type"><b>: </b><span>list (composite_transition_item IM)</span></span></span><br><span><var>is'</var><span class="hyp-type"><b>: </b><span>composite_state IM</span></span></span><br><span><var>Hind</var><span class="hyp-type"><b>: </b><span><span class="kr">‚àÄ</span> <span class="nv">i</span> : index,
  vinitial_state_prop (IM i) (s i)
  ‚Üí <span class="kr">‚àÄ</span> (<span class="nv">is</span> : composite_state IM) 
      (<span class="nv">tr0</span> : list
               (composite_transition_item IM)),
      (is&#39;, tr) = (<span class="kr">is</span>, tr0) ‚Üí <span class="kr">is</span> i = s i</span></span></span><br><span><var>i</var><span class="hyp-type"><b>: </b><span>index</span></span></span><br><span><var>Hi</var><span class="hyp-type"><b>: </b><span>vinitial_state_prop (IM i) (s&#39; i)</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">is&#39; i = s&#39; i</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="TraceableVLSM-v-chk99" style="display: none" type="checkbox"><label class="alectryon-input" for="TraceableVLSM-v-chk99"><span class="nb">replace</span> (s&#39; i) <span class="kr">with</span> (s i) <span class="kr">in</span> *.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>message, index</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>EqDecision0</var><span class="hyp-type"><b>: </b><span>EqDecision index</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>finite.Finite index</span></span></span><br><span><var>IM</var><span class="hyp-type"><b>: </b><span>index ‚Üí VLSM message</span></span></span><br><span><var>state_destructor</var><span class="hyp-type"><b>: </b><span><span class="kr">‚àÄ</span> <span class="nv">i</span> : index,
  vstate (IM i)
  ‚Üí list
      (vtransition_item (IM i) *
       vstate (IM i))</span></span></span><br><span><var>state_size</var><span class="hyp-type"><b>: </b><span><span class="kr">‚àÄ</span> <span class="nv">i</span> : index, vstate (IM i) ‚Üí nat</span></span></span><br><span><var>H0</var><span class="hyp-type"><b>: </b><span><span class="kr">‚àÄ</span> <span class="nv">i</span> : index,
  TraceableVLSM (IM i) 
    (state_destructor i) 
    (state_size i)</span></span></span><br><span><var>Free</var><span><span class="hyp-body"><b>:= </b><span>free_composite_vlsm IM</span></span><span class="hyp-type"><b>: </b><span>VLSM message</span></span></span></span><br><span><var>RFree</var><span><span class="hyp-body"><b>:= </b><span>pre_loaded_with_all_messages_vlsm Free</span></span><span class="hyp-type"><b>: </b><span>VLSM message</span></span></span></span><br><span><var>choose</var><span class="hyp-type"><b>: </b><span>choice_function</span></span></span><br><span><var>s'</var><span class="hyp-type"><b>: </b><span>composite_state IM</span></span></span><br><span><var>Hs'</var><span class="hyp-type"><b>: </b><span>valid_state_prop RFree s&#39;</span></span></span><br><span><var>i0</var><span class="hyp-type"><b>: </b><span>index</span></span></span><br><span><var>l0</var><span class="hyp-type"><b>: </b><span>list index</span></span></span><br><span><var>i_n</var><span class="hyp-type"><b>: </b><span>(index * nat)%type</span></span></span><br><span><var>item</var><span class="hyp-type"><b>: </b><span>composite_transition_item IM</span></span></span><br><span><var>s</var><span class="hyp-type"><b>: </b><span>composite_state IM</span></span></span><br><span><var>Hdestruct</var><span class="hyp-type"><b>: </b><span>composite_state_destructor s&#39; i_n.<span class="mi">1</span>
!! i_n.<span class="mi">2</span> = Some (item, s)</span></span></span><br><span><var>Hchoice</var><span class="hyp-type"><b>: </b><span>choose s&#39; Hs&#39; (i0 :: l0) = i_n</span></span></span><br><span><var>tr</var><span class="hyp-type"><b>: </b><span>list (composite_transition_item IM)</span></span></span><br><span><var>is'</var><span class="hyp-type"><b>: </b><span>composite_state IM</span></span></span><br><span><var>Hind</var><span class="hyp-type"><b>: </b><span><span class="kr">‚àÄ</span> <span class="nv">i</span> : index,
  vinitial_state_prop (IM i) (s i)
  ‚Üí <span class="kr">‚àÄ</span> (<span class="nv">is</span> : composite_state IM) 
      (<span class="nv">tr0</span> : list
               (composite_transition_item IM)),
      (is&#39;, tr) = (<span class="kr">is</span>, tr0) ‚Üí <span class="kr">is</span> i = s i</span></span></span><br><span><var>i</var><span class="hyp-type"><b>: </b><span>index</span></span></span><br><span><var>Hi</var><span class="hyp-type"><b>: </b><span>vinitial_state_prop (IM i) (s i)</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">is&#39; i = s i</div></blockquote><div class="alectryon-extra-goals"><input class="alectryon-extra-goal-toggle" id="TraceableVLSM-v-chk9a" style="display: none" type="checkbox"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>message, index</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>EqDecision0</var><span class="hyp-type"><b>: </b><span>EqDecision index</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>finite.Finite index</span></span></span><br><span><var>IM</var><span class="hyp-type"><b>: </b><span>index ‚Üí VLSM message</span></span></span><br><span><var>state_destructor</var><span class="hyp-type"><b>: </b><span><span class="kr">‚àÄ</span> <span class="nv">i</span> : index,
  vstate (IM i)
  ‚Üí list
      (vtransition_item (IM i) *
       vstate (IM i))</span></span></span><br><span><var>state_size</var><span class="hyp-type"><b>: </b><span><span class="kr">‚àÄ</span> <span class="nv">i</span> : index, vstate (IM i) ‚Üí nat</span></span></span><br><span><var>H0</var><span class="hyp-type"><b>: </b><span><span class="kr">‚àÄ</span> <span class="nv">i</span> : index,
  TraceableVLSM (IM i) 
    (state_destructor i) 
    (state_size i)</span></span></span><br><span><var>Free</var><span><span class="hyp-body"><b>:= </b><span>free_composite_vlsm IM</span></span><span class="hyp-type"><b>: </b><span>VLSM message</span></span></span></span><br><span><var>RFree</var><span><span class="hyp-body"><b>:= </b><span>pre_loaded_with_all_messages_vlsm Free</span></span><span class="hyp-type"><b>: </b><span>VLSM message</span></span></span></span><br><span><var>choose</var><span class="hyp-type"><b>: </b><span>choice_function</span></span></span><br><span><var>s'</var><span class="hyp-type"><b>: </b><span>composite_state IM</span></span></span><br><span><var>Hs'</var><span class="hyp-type"><b>: </b><span>valid_state_prop RFree s&#39;</span></span></span><br><span><var>i0</var><span class="hyp-type"><b>: </b><span>index</span></span></span><br><span><var>l0</var><span class="hyp-type"><b>: </b><span>list index</span></span></span><br><span><var>i_n</var><span class="hyp-type"><b>: </b><span>(index * nat)%type</span></span></span><br><span><var>item</var><span class="hyp-type"><b>: </b><span>composite_transition_item IM</span></span></span><br><span><var>s</var><span class="hyp-type"><b>: </b><span>composite_state IM</span></span></span><br><span><var>Hdestruct</var><span class="hyp-type"><b>: </b><span>composite_state_destructor s&#39; i_n.<span class="mi">1</span>
!! i_n.<span class="mi">2</span> = Some (item, s)</span></span></span><br><span><var>Hchoice</var><span class="hyp-type"><b>: </b><span>choose s&#39; Hs&#39; (i0 :: l0) = i_n</span></span></span><br><span><var>tr</var><span class="hyp-type"><b>: </b><span>list (composite_transition_item IM)</span></span></span><br><span><var>is'</var><span class="hyp-type"><b>: </b><span>composite_state IM</span></span></span><br><span><var>Hind</var><span class="hyp-type"><b>: </b><span><span class="kr">‚àÄ</span> <span class="nv">i</span> : index,
  vinitial_state_prop (IM i) (s i)
  ‚Üí <span class="kr">‚àÄ</span> (<span class="nv">is</span> : composite_state IM) 
      (<span class="nv">tr0</span> : list
               (composite_transition_item IM)),
      (is&#39;, tr) = (<span class="kr">is</span>, tr0) ‚Üí <span class="kr">is</span> i = s i</span></span></span><br><span><var>i</var><span class="hyp-type"><b>: </b><span>index</span></span></span><br><span><var>Hi</var><span class="hyp-type"><b>: </b><span>vinitial_state_prop (IM i) (s&#39; i)</span></span></span><br></div><label class="goal-separator" for="TraceableVLSM-v-chk9a"><hr></label><div class="goal-conclusion">s i = s&#39; i</div></blockquote></div></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="TraceableVLSM-v-chk9b" style="display: none" type="checkbox"><label class="alectryon-input" for="TraceableVLSM-v-chk9b">+</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>message, index</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>EqDecision0</var><span class="hyp-type"><b>: </b><span>EqDecision index</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>finite.Finite index</span></span></span><br><span><var>IM</var><span class="hyp-type"><b>: </b><span>index ‚Üí VLSM message</span></span></span><br><span><var>state_destructor</var><span class="hyp-type"><b>: </b><span><span class="kr">‚àÄ</span> <span class="nv">i</span> : index,
  vstate (IM i)
  ‚Üí list
      (vtransition_item (IM i) *
       vstate (IM i))</span></span></span><br><span><var>state_size</var><span class="hyp-type"><b>: </b><span><span class="kr">‚àÄ</span> <span class="nv">i</span> : index, vstate (IM i) ‚Üí nat</span></span></span><br><span><var>H0</var><span class="hyp-type"><b>: </b><span><span class="kr">‚àÄ</span> <span class="nv">i</span> : index,
  TraceableVLSM (IM i) 
    (state_destructor i) 
    (state_size i)</span></span></span><br><span><var>Free</var><span><span class="hyp-body"><b>:= </b><span>free_composite_vlsm IM</span></span><span class="hyp-type"><b>: </b><span>VLSM message</span></span></span></span><br><span><var>RFree</var><span><span class="hyp-body"><b>:= </b><span>pre_loaded_with_all_messages_vlsm Free</span></span><span class="hyp-type"><b>: </b><span>VLSM message</span></span></span></span><br><span><var>choose</var><span class="hyp-type"><b>: </b><span>choice_function</span></span></span><br><span><var>s'</var><span class="hyp-type"><b>: </b><span>composite_state IM</span></span></span><br><span><var>Hs'</var><span class="hyp-type"><b>: </b><span>valid_state_prop RFree s&#39;</span></span></span><br><span><var>i0</var><span class="hyp-type"><b>: </b><span>index</span></span></span><br><span><var>l0</var><span class="hyp-type"><b>: </b><span>list index</span></span></span><br><span><var>i_n</var><span class="hyp-type"><b>: </b><span>(index * nat)%type</span></span></span><br><span><var>item</var><span class="hyp-type"><b>: </b><span>composite_transition_item IM</span></span></span><br><span><var>s</var><span class="hyp-type"><b>: </b><span>composite_state IM</span></span></span><br><span><var>Hdestruct</var><span class="hyp-type"><b>: </b><span>composite_state_destructor s&#39; i_n.<span class="mi">1</span>
!! i_n.<span class="mi">2</span> = Some (item, s)</span></span></span><br><span><var>Hchoice</var><span class="hyp-type"><b>: </b><span>choose s&#39; Hs&#39; (i0 :: l0) = i_n</span></span></span><br><span><var>tr</var><span class="hyp-type"><b>: </b><span>list (composite_transition_item IM)</span></span></span><br><span><var>is'</var><span class="hyp-type"><b>: </b><span>composite_state IM</span></span></span><br><span><var>Hind</var><span class="hyp-type"><b>: </b><span><span class="kr">‚àÄ</span> <span class="nv">i</span> : index,
  vinitial_state_prop (IM i) (s i)
  ‚Üí <span class="kr">‚àÄ</span> (<span class="nv">is</span> : composite_state IM) 
      (<span class="nv">tr0</span> : list
               (composite_transition_item IM)),
      (is&#39;, tr) = (<span class="kr">is</span>, tr0) ‚Üí <span class="kr">is</span> i = s i</span></span></span><br><span><var>i</var><span class="hyp-type"><b>: </b><span>index</span></span></span><br><span><var>Hi</var><span class="hyp-type"><b>: </b><span>vinitial_state_prop (IM i) (s i)</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">is&#39; i = s i</div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="bp">by</span> <span class="nb">eapply</span> Hind.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="TraceableVLSM-v-chk9c" style="display: none" type="checkbox"><label class="alectryon-input" for="TraceableVLSM-v-chk9c">+</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>message, index</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>EqDecision0</var><span class="hyp-type"><b>: </b><span>EqDecision index</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>finite.Finite index</span></span></span><br><span><var>IM</var><span class="hyp-type"><b>: </b><span>index ‚Üí VLSM message</span></span></span><br><span><var>state_destructor</var><span class="hyp-type"><b>: </b><span><span class="kr">‚àÄ</span> <span class="nv">i</span> : index,
  vstate (IM i)
  ‚Üí list
      (vtransition_item (IM i) *
       vstate (IM i))</span></span></span><br><span><var>state_size</var><span class="hyp-type"><b>: </b><span><span class="kr">‚àÄ</span> <span class="nv">i</span> : index, vstate (IM i) ‚Üí nat</span></span></span><br><span><var>H0</var><span class="hyp-type"><b>: </b><span><span class="kr">‚àÄ</span> <span class="nv">i</span> : index,
  TraceableVLSM (IM i) 
    (state_destructor i) 
    (state_size i)</span></span></span><br><span><var>Free</var><span><span class="hyp-body"><b>:= </b><span>free_composite_vlsm IM</span></span><span class="hyp-type"><b>: </b><span>VLSM message</span></span></span></span><br><span><var>RFree</var><span><span class="hyp-body"><b>:= </b><span>pre_loaded_with_all_messages_vlsm Free</span></span><span class="hyp-type"><b>: </b><span>VLSM message</span></span></span></span><br><span><var>choose</var><span class="hyp-type"><b>: </b><span>choice_function</span></span></span><br><span><var>s'</var><span class="hyp-type"><b>: </b><span>composite_state IM</span></span></span><br><span><var>Hs'</var><span class="hyp-type"><b>: </b><span>valid_state_prop RFree s&#39;</span></span></span><br><span><var>i0</var><span class="hyp-type"><b>: </b><span>index</span></span></span><br><span><var>l0</var><span class="hyp-type"><b>: </b><span>list index</span></span></span><br><span><var>i_n</var><span class="hyp-type"><b>: </b><span>(index * nat)%type</span></span></span><br><span><var>item</var><span class="hyp-type"><b>: </b><span>composite_transition_item IM</span></span></span><br><span><var>s</var><span class="hyp-type"><b>: </b><span>composite_state IM</span></span></span><br><span><var>Hdestruct</var><span class="hyp-type"><b>: </b><span>composite_state_destructor s&#39; i_n.<span class="mi">1</span>
!! i_n.<span class="mi">2</span> = Some (item, s)</span></span></span><br><span><var>Hchoice</var><span class="hyp-type"><b>: </b><span>choose s&#39; Hs&#39; (i0 :: l0) = i_n</span></span></span><br><span><var>tr</var><span class="hyp-type"><b>: </b><span>list (composite_transition_item IM)</span></span></span><br><span><var>is'</var><span class="hyp-type"><b>: </b><span>composite_state IM</span></span></span><br><span><var>Hind</var><span class="hyp-type"><b>: </b><span><span class="kr">‚àÄ</span> <span class="nv">i</span> : index,
  vinitial_state_prop (IM i) (s i)
  ‚Üí <span class="kr">‚àÄ</span> (<span class="nv">is</span> : composite_state IM) 
      (<span class="nv">tr0</span> : list
               (composite_transition_item IM)),
      (is&#39;, tr) = (<span class="kr">is</span>, tr0) ‚Üí <span class="kr">is</span> i = s i</span></span></span><br><span><var>i</var><span class="hyp-type"><b>: </b><span>index</span></span></span><br><span><var>Hi</var><span class="hyp-type"><b>: </b><span>vinitial_state_prop (IM i) (s&#39; i)</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">s i = s&#39; i</div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="bp">by</span> <span class="nb">eapply</span> composite_tv_state_destructor_reflects_initiality;
        [| <span class="nb">eapply</span> elem_of_list_lookup_2 |].</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="TraceableVLSM-v-chk9d" style="display: none" type="checkbox"><label class="alectryon-input" for="TraceableVLSM-v-chk9d">-</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>message, index</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>EqDecision0</var><span class="hyp-type"><b>: </b><span>EqDecision index</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>finite.Finite index</span></span></span><br><span><var>IM</var><span class="hyp-type"><b>: </b><span>index ‚Üí VLSM message</span></span></span><br><span><var>state_destructor</var><span class="hyp-type"><b>: </b><span><span class="kr">‚àÄ</span> <span class="nv">i</span> : index,
  vstate (IM i)
  ‚Üí list
      (vtransition_item (IM i) *
       vstate (IM i))</span></span></span><br><span><var>state_size</var><span class="hyp-type"><b>: </b><span><span class="kr">‚àÄ</span> <span class="nv">i</span> : index, vstate (IM i) ‚Üí nat</span></span></span><br><span><var>H0</var><span class="hyp-type"><b>: </b><span><span class="kr">‚àÄ</span> <span class="nv">i</span> : index,
  TraceableVLSM (IM i) 
    (state_destructor i) 
    (state_size i)</span></span></span><br><span><var>Free</var><span><span class="hyp-body"><b>:= </b><span>free_composite_vlsm IM</span></span><span class="hyp-type"><b>: </b><span>VLSM message</span></span></span></span><br><span><var>RFree</var><span><span class="hyp-body"><b>:= </b><span>pre_loaded_with_all_messages_vlsm Free</span></span><span class="hyp-type"><b>: </b><span>VLSM message</span></span></span></span><br><span><var>choose</var><span class="hyp-type"><b>: </b><span>choice_function</span></span></span><br><span><var>s'</var><span class="hyp-type"><b>: </b><span>composite_state IM</span></span></span><br><span><var>Hs'</var><span class="hyp-type"><b>: </b><span>valid_state_prop RFree s&#39;</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="kr">‚àÄ</span> (<span class="nv">i</span> : index) (<span class="nv">l0</span> : list index) (<span class="nv">i_n</span> : index * nat) 
  (<span class="nv">n</span> : i_n.<span class="mi">1</span> ‚àâ i :: l0) (<span class="nv">Hni</span> : decide
                                 (i_n.<span class="mi">1</span> ‚àà i :: l0) =
                               <span class="nb">right</span> n) (<span class="nv">Hdestruct</span> : 
                                         composite_state_destructor
                                           s&#39; i_n.<span class="mi">1</span>
                                         !! i_n.<span class="mi">2</span> =
                                         None) (<span class="nv">Hchoice</span> : 
                                                choose
                                                 s&#39;
                                                 Hs&#39;
                                                 (i
                                                 :: l0) =
                                                i_n),
  inspect (decide (i_n.<span class="mi">1</span> ‚àà i :: l0)) = <span class="nb">right</span> n ‚Üæ Hni
  ‚Üí inspect
      (composite_state_destructor s&#39; i_n.<span class="mi">1</span> !! i_n.<span class="mi">2</span>) =
    None ‚Üæ Hdestruct
    ‚Üí inspect (choose s&#39; Hs&#39; (i :: l0)) =
      i_n ‚Üæ Hchoice
      ‚Üí <span class="kr">‚àÄ</span> <span class="nv">i0</span> : index,
          vinitial_state_prop (IM i0) (s&#39; i0)
          ‚Üí <span class="kr">‚àÄ</span> (<span class="nv">is</span> : composite_state IM) (<span class="nv">tr</span> : list
                                                (composite_transition_item
                                                 IM)),
              (s&#39;, []) = (<span class="kr">is</span>, tr) ‚Üí <span class="kr">is</span> i0 = s&#39; i0</div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="bp">by</span> <span class="nb">inversion</span> <span class="mi">5</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="TraceableVLSM-v-chk9e" style="display: none" type="checkbox"><label class="alectryon-input" for="TraceableVLSM-v-chk9e">-</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>message, index</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>EqDecision0</var><span class="hyp-type"><b>: </b><span>EqDecision index</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>finite.Finite index</span></span></span><br><span><var>IM</var><span class="hyp-type"><b>: </b><span>index ‚Üí VLSM message</span></span></span><br><span><var>state_destructor</var><span class="hyp-type"><b>: </b><span><span class="kr">‚àÄ</span> <span class="nv">i</span> : index,
  vstate (IM i)
  ‚Üí list
      (vtransition_item (IM i) *
       vstate (IM i))</span></span></span><br><span><var>state_size</var><span class="hyp-type"><b>: </b><span><span class="kr">‚àÄ</span> <span class="nv">i</span> : index, vstate (IM i) ‚Üí nat</span></span></span><br><span><var>H0</var><span class="hyp-type"><b>: </b><span><span class="kr">‚àÄ</span> <span class="nv">i</span> : index,
  TraceableVLSM (IM i) 
    (state_destructor i) 
    (state_size i)</span></span></span><br><span><var>Free</var><span><span class="hyp-body"><b>:= </b><span>free_composite_vlsm IM</span></span><span class="hyp-type"><b>: </b><span>VLSM message</span></span></span></span><br><span><var>RFree</var><span><span class="hyp-body"><b>:= </b><span>pre_loaded_with_all_messages_vlsm Free</span></span><span class="hyp-type"><b>: </b><span>VLSM message</span></span></span></span><br><span><var>choose</var><span class="hyp-type"><b>: </b><span>choice_function</span></span></span><br><span><var>s'</var><span class="hyp-type"><b>: </b><span>composite_state IM</span></span></span><br><span><var>Hs'</var><span class="hyp-type"><b>: </b><span>valid_state_prop RFree s&#39;</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="kr">‚àÄ</span> (<span class="nv">i</span> : index) (<span class="nv">l0</span> : list index) (<span class="nv">i_n</span> : index * nat) 
  (<span class="nv">e1</span> : composite_state_destructor s&#39; i_n.<span class="mi">1</span> = []) 
  (<span class="nv">Hnn</span> : decide
           (composite_state_destructor s&#39; i_n.<span class="mi">1</span> = []) =
         <span class="nb">left</span> e1) (<span class="nv">e0</span> : i_n.<span class="mi">1</span> ‚àà i :: l0) (<span class="nv">Hi</span> : decide
                                                 (i_n.<span class="mi">1</span>
                                                 ‚àà 
                                                 i
                                                 :: l0) =
                                               <span class="nb">left</span> e0) 
  (<span class="nv">Hdestruct</span> : composite_state_destructor s&#39; i_n.<span class="mi">1</span>
               !! i_n.<span class="mi">2</span> = None) (<span class="nv">Hchoice</span> : choose s&#39;
                                             Hs&#39;
                                             (i :: l0) =
                                           i_n),
  (<span class="kr">‚àÄ</span> <span class="nv">i0</span> : index,
     vinitial_state_prop (IM i0) (s&#39; i0)
     ‚Üí <span class="kr">‚àÄ</span> (<span class="nv">is</span> : composite_state IM) (<span class="nv">tr</span> : list
                                           (composite_transition_item
                                              IM)),
         indexed_composite_state_to_trace choose s&#39;
           Hs&#39;
           (StdppListSet.set_remove i_n.<span class="mi">1</span> (i :: l0)) =
         (<span class="kr">is</span>, tr) ‚Üí <span class="kr">is</span> i0 = s&#39; i0)
  ‚Üí inspect
      (decide
         (composite_state_destructor s&#39; i_n.<span class="mi">1</span> = [])) =
    <span class="nb">left</span> e1 ‚Üæ Hnn
    ‚Üí inspect (decide (i_n.<span class="mi">1</span> ‚àà i :: l0)) =
      <span class="nb">left</span> e0 ‚Üæ Hi
      ‚Üí inspect
          (composite_state_destructor s&#39; i_n.<span class="mi">1</span>
           !! i_n.<span class="mi">2</span>) = None ‚Üæ Hdestruct
        ‚Üí inspect (choose s&#39; Hs&#39; (i :: l0)) =
          i_n ‚Üæ Hchoice
          ‚Üí <span class="kr">‚àÄ</span> <span class="nv">i0</span> : index,
              vinitial_state_prop (IM i0) (s&#39; i0)
              ‚Üí <span class="kr">‚àÄ</span> (<span class="nv">is</span> : composite_state IM) (<span class="nv">tr</span> : 
                                             list
                                               (composite_transition_item
                                                 IM)),
                  indexed_composite_state_to_trace
                    choose s&#39; Hs&#39;
                    (StdppListSet.set_remove i_n.<span class="mi">1</span>
                       (i :: l0)) = (<span class="kr">is</span>, tr)
                  ‚Üí <span class="kr">is</span> i0 = s&#39; i0</div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="bp">by</span> <span class="nb">intros</span> idx indices [j nj] Hdestruct _ Hj _ _ -&gt; Hind _ _ _ _ i Hi <span class="kr">is</span> tr Heqis_tr; <span class="nb">eapply</span> Hind.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="TraceableVLSM-v-chk9f" style="display: none" type="checkbox"><label class="alectryon-input" for="TraceableVLSM-v-chk9f">-</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>message, index</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>EqDecision0</var><span class="hyp-type"><b>: </b><span>EqDecision index</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>finite.Finite index</span></span></span><br><span><var>IM</var><span class="hyp-type"><b>: </b><span>index ‚Üí VLSM message</span></span></span><br><span><var>state_destructor</var><span class="hyp-type"><b>: </b><span><span class="kr">‚àÄ</span> <span class="nv">i</span> : index,
  vstate (IM i)
  ‚Üí list
      (vtransition_item (IM i) *
       vstate (IM i))</span></span></span><br><span><var>state_size</var><span class="hyp-type"><b>: </b><span><span class="kr">‚àÄ</span> <span class="nv">i</span> : index, vstate (IM i) ‚Üí nat</span></span></span><br><span><var>H0</var><span class="hyp-type"><b>: </b><span><span class="kr">‚àÄ</span> <span class="nv">i</span> : index,
  TraceableVLSM (IM i) 
    (state_destructor i) 
    (state_size i)</span></span></span><br><span><var>Free</var><span><span class="hyp-body"><b>:= </b><span>free_composite_vlsm IM</span></span><span class="hyp-type"><b>: </b><span>VLSM message</span></span></span></span><br><span><var>RFree</var><span><span class="hyp-body"><b>:= </b><span>pre_loaded_with_all_messages_vlsm Free</span></span><span class="hyp-type"><b>: </b><span>VLSM message</span></span></span></span><br><span><var>choose</var><span class="hyp-type"><b>: </b><span>choice_function</span></span></span><br><span><var>s'</var><span class="hyp-type"><b>: </b><span>composite_state IM</span></span></span><br><span><var>Hs'</var><span class="hyp-type"><b>: </b><span>valid_state_prop RFree s&#39;</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="kr">‚àÄ</span> (<span class="nv">i</span> : index) (<span class="nv">l0</span> : list index) (<span class="nv">i_n</span> : index * nat) 
  (<span class="nv">n</span> : composite_state_destructor s&#39; i_n.<span class="mi">1</span> ‚â† []) (<span class="nv">Hn</span> : 
                                                 decide
                                                 (composite_state_destructor
                                                 s&#39;
                                                 i_n.<span class="mi">1</span> =
                                                 []) =
                                                 <span class="nb">right</span>
                                                 n) 
  (<span class="nv">e0</span> : i_n.<span class="mi">1</span> ‚àà i :: l0) (<span class="nv">Hi</span> : decide
                                 (i_n.<span class="mi">1</span> ‚àà i :: l0) =
                               <span class="nb">left</span> e0) (<span class="nv">Hdestruct</span> : 
                                         composite_state_destructor
                                           s&#39; i_n.<span class="mi">1</span>
                                         !! i_n.<span class="mi">2</span> =
                                         None) (<span class="nv">Hchoice</span> : 
                                                choose
                                                 s&#39;
                                                 Hs&#39;
                                                 (i
                                                 :: l0) =
                                                i_n),
  inspect
    (decide (composite_state_destructor s&#39; i_n.<span class="mi">1</span> = [])) =
  <span class="nb">right</span> n ‚Üæ Hn
  ‚Üí inspect (decide (i_n.<span class="mi">1</span> ‚àà i :: l0)) = <span class="nb">left</span> e0 ‚Üæ Hi
    ‚Üí inspect
        (composite_state_destructor s&#39; i_n.<span class="mi">1</span> !! i_n.<span class="mi">2</span>) =
      None ‚Üæ Hdestruct
      ‚Üí inspect (choose s&#39; Hs&#39; (i :: l0)) =
        i_n ‚Üæ Hchoice
        ‚Üí <span class="kr">‚àÄ</span> <span class="nv">i0</span> : index,
            vinitial_state_prop (IM i0) (s&#39; i0)
            ‚Üí <span class="kr">‚àÄ</span> (<span class="nv">is</span> : composite_state IM) (<span class="nv">tr</span> : list
                                                 (composite_transition_item
                                                 IM)),
                (s&#39;, []) = (<span class="kr">is</span>, tr) ‚Üí <span class="kr">is</span> i0 = s&#39; i0</div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="bp">by</span> <span class="nb">inversion</span> <span class="mi">6</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Qed</span>.</span></span></pre><div class="doc">
  The components of an origin of a trace extracted through <span class="inlinecode"><span class="id" title="var">indexed_composite_state_to_trace</span></span>
  are initial for any index from the set of indices provided as argument.

</div><pre class="alectryon-io highlight"><!-- Generator: Alectryon --><span class="alectryon-sentence"><input class="alectryon-toggle" id="TraceableVLSM-v-chka0" style="display: none" type="checkbox"><label class="alectryon-input" for="TraceableVLSM-v-chka0"><span class="kn">Lemma</span> <span class="nf">indexed_composite_state_to_trace_result_state</span> :
  <span class="kr">forall</span> (<span class="nv">choose</span> : choice_function), choosing_well choose -&gt;
  <span class="kr">forall</span> (<span class="nv">s</span> : composite_state IM) (<span class="nv">Hs</span> : valid_state_prop RFree s),
  <span class="kr">forall</span> (<span class="nv">indices</span> : list index), NoDup indices -&gt;
    not_in_indices_initial_prop s indices -&gt;
    <span class="kr">forall</span> <span class="nv">is</span> <span class="nv">tr</span>, indexed_composite_state_to_trace choose s Hs indices = (<span class="kr">is</span>, tr) -&gt;
    <span class="kr">forall</span> <span class="nv">i</span>, i ‚àà indices -&gt; vinitial_state_prop (IM i) (<span class="kr">is</span> i).</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>message, index</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>EqDecision0</var><span class="hyp-type"><b>: </b><span>EqDecision index</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>finite.Finite index</span></span></span><br><span><var>IM</var><span class="hyp-type"><b>: </b><span>index ‚Üí VLSM message</span></span></span><br><span><var>state_destructor</var><span class="hyp-type"><b>: </b><span><span class="kr">‚àÄ</span> <span class="nv">i</span> : index,
  vstate (IM i)
  ‚Üí list
      (vtransition_item (IM i) *
       vstate (IM i))</span></span></span><br><span><var>state_size</var><span class="hyp-type"><b>: </b><span><span class="kr">‚àÄ</span> <span class="nv">i</span> : index, vstate (IM i) ‚Üí nat</span></span></span><br><span><var>H0</var><span class="hyp-type"><b>: </b><span><span class="kr">‚àÄ</span> <span class="nv">i</span> : index,
  TraceableVLSM (IM i) 
    (state_destructor i) 
    (state_size i)</span></span></span><br><span><var>Free</var><span><span class="hyp-body"><b>:= </b><span>free_composite_vlsm IM</span></span><span class="hyp-type"><b>: </b><span>VLSM message</span></span></span></span><br><span><var>RFree</var><span><span class="hyp-body"><b>:= </b><span>pre_loaded_with_all_messages_vlsm Free</span></span><span class="hyp-type"><b>: </b><span>VLSM message</span></span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="kr">‚àÄ</span> <span class="nv">choose</span> : choice_function,
  choosing_well choose
  ‚Üí <span class="kr">‚àÄ</span> (<span class="nv">s</span> : composite_state IM) (<span class="nv">Hs</span> : valid_state_prop
                                       RFree s) (<span class="nv">indices</span> : 
                                                 list
                                                 index),
      NoDup indices
      ‚Üí not_in_indices_initial_prop s indices
        ‚Üí <span class="kr">‚àÄ</span> (<span class="nv">is</span> : composite_state IM) (<span class="nv">tr</span> : list
                                              (composite_transition_item
                                                 IM)),
            indexed_composite_state_to_trace choose s
              Hs indices = (<span class="kr">is</span>, tr)
            ‚Üí <span class="kr">‚àÄ</span> <span class="nv">i</span> : index,
                i ‚àà indices
                ‚Üí vinitial_state_prop (IM i) (<span class="kr">is</span> i)</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="TraceableVLSM-v-chka1" style="display: none" type="checkbox"><label class="alectryon-input" for="TraceableVLSM-v-chka1"><span class="kn">Proof</span>.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>message, index</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>EqDecision0</var><span class="hyp-type"><b>: </b><span>EqDecision index</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>finite.Finite index</span></span></span><br><span><var>IM</var><span class="hyp-type"><b>: </b><span>index ‚Üí VLSM message</span></span></span><br><span><var>state_destructor</var><span class="hyp-type"><b>: </b><span><span class="kr">‚àÄ</span> <span class="nv">i</span> : index,
  vstate (IM i)
  ‚Üí list
      (vtransition_item (IM i) *
       vstate (IM i))</span></span></span><br><span><var>state_size</var><span class="hyp-type"><b>: </b><span><span class="kr">‚àÄ</span> <span class="nv">i</span> : index, vstate (IM i) ‚Üí nat</span></span></span><br><span><var>H0</var><span class="hyp-type"><b>: </b><span><span class="kr">‚àÄ</span> <span class="nv">i</span> : index,
  TraceableVLSM (IM i) 
    (state_destructor i) 
    (state_size i)</span></span></span><br><span><var>Free</var><span><span class="hyp-body"><b>:= </b><span>free_composite_vlsm IM</span></span><span class="hyp-type"><b>: </b><span>VLSM message</span></span></span></span><br><span><var>RFree</var><span><span class="hyp-body"><b>:= </b><span>pre_loaded_with_all_messages_vlsm Free</span></span><span class="hyp-type"><b>: </b><span>VLSM message</span></span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="kr">‚àÄ</span> <span class="nv">choose</span> : choice_function,
  choosing_well choose
  ‚Üí <span class="kr">‚àÄ</span> (<span class="nv">s</span> : composite_state IM) (<span class="nv">Hs</span> : valid_state_prop
                                       RFree s) (<span class="nv">indices</span> : 
                                                 list
                                                 index),
      NoDup indices
      ‚Üí not_in_indices_initial_prop s indices
        ‚Üí <span class="kr">‚àÄ</span> (<span class="nv">is</span> : composite_state IM) (<span class="nv">tr</span> : list
                                              (composite_transition_item
                                                 IM)),
            indexed_composite_state_to_trace choose s
              Hs indices = (<span class="kr">is</span>, tr)
            ‚Üí <span class="kr">‚àÄ</span> <span class="nv">i</span> : index,
                i ‚àà indices
                ‚Üí vinitial_state_prop (IM i) (<span class="kr">is</span> i)</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="TraceableVLSM-v-chka2" style="display: none" type="checkbox"><label class="alectryon-input" for="TraceableVLSM-v-chka2"><span class="nb">intros</span> ? Hchoose *; <span class="nb">revert</span> Hchoose.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>message, index</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>EqDecision0</var><span class="hyp-type"><b>: </b><span>EqDecision index</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>finite.Finite index</span></span></span><br><span><var>IM</var><span class="hyp-type"><b>: </b><span>index ‚Üí VLSM message</span></span></span><br><span><var>state_destructor</var><span class="hyp-type"><b>: </b><span><span class="kr">‚àÄ</span> <span class="nv">i</span> : index,
  vstate (IM i)
  ‚Üí list
      (vtransition_item (IM i) *
       vstate (IM i))</span></span></span><br><span><var>state_size</var><span class="hyp-type"><b>: </b><span><span class="kr">‚àÄ</span> <span class="nv">i</span> : index, vstate (IM i) ‚Üí nat</span></span></span><br><span><var>H0</var><span class="hyp-type"><b>: </b><span><span class="kr">‚àÄ</span> <span class="nv">i</span> : index,
  TraceableVLSM (IM i) 
    (state_destructor i) 
    (state_size i)</span></span></span><br><span><var>Free</var><span><span class="hyp-body"><b>:= </b><span>free_composite_vlsm IM</span></span><span class="hyp-type"><b>: </b><span>VLSM message</span></span></span></span><br><span><var>RFree</var><span><span class="hyp-body"><b>:= </b><span>pre_loaded_with_all_messages_vlsm Free</span></span><span class="hyp-type"><b>: </b><span>VLSM message</span></span></span></span><br><span><var>choose</var><span class="hyp-type"><b>: </b><span>choice_function</span></span></span><br><span><var>s</var><span class="hyp-type"><b>: </b><span>composite_state IM</span></span></span><br><span><var>Hs</var><span class="hyp-type"><b>: </b><span>valid_state_prop RFree s</span></span></span><br><span><var>indices</var><span class="hyp-type"><b>: </b><span>list index</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">choosing_well choose
‚Üí NoDup indices
  ‚Üí not_in_indices_initial_prop s indices
    ‚Üí <span class="kr">‚àÄ</span> (<span class="nv">is</span> : composite_state IM) (<span class="nv">tr</span> : list
                                          (composite_transition_item
                                             IM)),
        indexed_composite_state_to_trace choose s Hs
          indices = (<span class="kr">is</span>, tr)
        ‚Üí <span class="kr">‚àÄ</span> <span class="nv">i</span> : index,
            i ‚àà indices
            ‚Üí vinitial_state_prop (IM i) (<span class="kr">is</span> i)</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="TraceableVLSM-v-chka3" style="display: none" type="checkbox"><label class="alectryon-input" for="TraceableVLSM-v-chka3">apply_funelim (indexed_composite_state_to_trace choose s Hs indices);
    <span class="nb">clear</span> choose s Hs indices.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>message, index</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>EqDecision0</var><span class="hyp-type"><b>: </b><span>EqDecision index</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>finite.Finite index</span></span></span><br><span><var>IM</var><span class="hyp-type"><b>: </b><span>index ‚Üí VLSM message</span></span></span><br><span><var>state_destructor</var><span class="hyp-type"><b>: </b><span><span class="kr">‚àÄ</span> <span class="nv">i</span> : index,
  vstate (IM i)
  ‚Üí list
      (vtransition_item (IM i) *
       vstate (IM i))</span></span></span><br><span><var>state_size</var><span class="hyp-type"><b>: </b><span><span class="kr">‚àÄ</span> <span class="nv">i</span> : index, vstate (IM i) ‚Üí nat</span></span></span><br><span><var>H0</var><span class="hyp-type"><b>: </b><span><span class="kr">‚àÄ</span> <span class="nv">i</span> : index,
  TraceableVLSM (IM i) 
    (state_destructor i) 
    (state_size i)</span></span></span><br><span><var>Free</var><span><span class="hyp-body"><b>:= </b><span>free_composite_vlsm IM</span></span><span class="hyp-type"><b>: </b><span>VLSM message</span></span></span></span><br><span><var>RFree</var><span><span class="hyp-body"><b>:= </b><span>pre_loaded_with_all_messages_vlsm Free</span></span><span class="hyp-type"><b>: </b><span>VLSM message</span></span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="kr">‚àÄ</span> (<span class="nv">choose</span> : choice_function) (<span class="nv">s&#39;</span> : composite_state IM),
  valid_state_prop RFree s&#39;
  ‚Üí choosing_well choose
    ‚Üí NoDup []
      ‚Üí not_in_indices_initial_prop s&#39; []
        ‚Üí <span class="kr">‚àÄ</span> (<span class="nv">is</span> : composite_state IM) (<span class="nv">tr</span> : list
                                              (composite_transition_item
                                                 IM)),
            (s&#39;, []) = (<span class="kr">is</span>, tr)
            ‚Üí <span class="kr">‚àÄ</span> <span class="nv">i</span> : index,
                i ‚àà []
                ‚Üí vinitial_state_prop (IM i) (<span class="kr">is</span> i)</div></blockquote><div class="alectryon-extra-goals"><input class="alectryon-extra-goal-toggle" id="TraceableVLSM-v-chka4" style="display: none" type="checkbox"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>message, index</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>EqDecision0</var><span class="hyp-type"><b>: </b><span>EqDecision index</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>finite.Finite index</span></span></span><br><span><var>IM</var><span class="hyp-type"><b>: </b><span>index ‚Üí VLSM message</span></span></span><br><span><var>state_destructor</var><span class="hyp-type"><b>: </b><span><span class="kr">‚àÄ</span> <span class="nv">i</span> : index,
  vstate (IM i)
  ‚Üí list
      (vtransition_item (IM i) *
       vstate (IM i))</span></span></span><br><span><var>state_size</var><span class="hyp-type"><b>: </b><span><span class="kr">‚àÄ</span> <span class="nv">i</span> : index, vstate (IM i) ‚Üí nat</span></span></span><br><span><var>H0</var><span class="hyp-type"><b>: </b><span><span class="kr">‚àÄ</span> <span class="nv">i</span> : index,
  TraceableVLSM (IM i) 
    (state_destructor i) 
    (state_size i)</span></span></span><br><span><var>Free</var><span><span class="hyp-body"><b>:= </b><span>free_composite_vlsm IM</span></span><span class="hyp-type"><b>: </b><span>VLSM message</span></span></span></span><br><span><var>RFree</var><span><span class="hyp-body"><b>:= </b><span>pre_loaded_with_all_messages_vlsm Free</span></span><span class="hyp-type"><b>: </b><span>VLSM message</span></span></span></span><br></div><label class="goal-separator" for="TraceableVLSM-v-chka4"><hr></label><div class="goal-conclusion"><span class="kr">‚àÄ</span> (<span class="nv">choose</span> : choice_function) 
  (<span class="nv">s&#39;</span> : composite_state IM) 
  (<span class="nv">Hs&#39;</span> : valid_state_prop RFree s&#39;) 
  (<span class="nv">i</span> : index) (<span class="nv">l0</span> : list index) 
  (<span class="nv">i_n</span> : index * nat) (<span class="nv">item</span> : 
                      composite_transition_item IM) 
  (<span class="nv">s</span> : composite_state IM) 
  (<span class="nv">Hdestruct</span> : composite_state_destructor s&#39; i_n.<span class="mi">1</span>
               !! i_n.<span class="mi">2</span> = 
               Some (item, s)) 
  (<span class="nv">Hchoice</span> : choose s&#39; Hs&#39; (i :: l0) = i_n) 
  (<span class="nv">is</span> : composite_state IM) 
  (<span class="nv">tr</span> : list (composite_transition_item IM)),
  indexed_composite_state_to_trace choose s
    (indexed_composite_state_to_trace_obligations_obligation_1
       s&#39; Hs&#39; i_n item s Hdestruct) 
    (i :: l0) = (<span class="kr">is</span>, tr)
  ‚Üí (choosing_well choose
     ‚Üí NoDup (i :: l0)
       ‚Üí not_in_indices_initial_prop s (i :: l0)
         ‚Üí <span class="kr">‚àÄ</span> (<span class="nv">is0</span> : composite_state IM) 
             (<span class="nv">tr0</span> : list
                      (composite_transition_item IM)),
             indexed_composite_state_to_trace choose s
               (indexed_composite_state_to_trace_obligations_obligation_1
                  s&#39; Hs&#39; i_n item s Hdestruct)
               (i :: l0) = 
             (is0, tr0)
             ‚Üí <span class="kr">‚àÄ</span> <span class="nv">i0</span> : index,
                 i0 ‚àà i :: l0
                 ‚Üí vinitial_state_prop 
                     (IM i0) 
                     (is0 i0))
    ‚Üí inspect
        (composite_state_destructor s&#39; i_n.<span class="mi">1</span> !! i_n.<span class="mi">2</span>) =
      Some (item, s) ‚Üæ Hdestruct
      ‚Üí inspect (choose s&#39; Hs&#39; (i :: l0)) =
        i_n ‚Üæ Hchoice
        ‚Üí choosing_well choose
          ‚Üí NoDup (i :: l0)
            ‚Üí not_in_indices_initial_prop s&#39; (i :: l0)
              ‚Üí <span class="kr">‚àÄ</span> (<span class="nv">is0</span> : composite_state IM) 
                  (<span class="nv">tr0</span> : 
                   list 
                     (composite_transition_item IM)),
                  (<span class="kr">is</span>, tr ++ [item]) = (is0, tr0)
                  ‚Üí <span class="kr">‚àÄ</span> <span class="nv">i0</span> : index,
                      i0 ‚àà i :: l0
                      ‚Üí 
                      vinitial_state_prop 
                      (IM i0) 
                      (is0 i0)</div></blockquote><input class="alectryon-extra-goal-toggle" id="TraceableVLSM-v-chka5" style="display: none" type="checkbox"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>message, index</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>EqDecision0</var><span class="hyp-type"><b>: </b><span>EqDecision index</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>finite.Finite index</span></span></span><br><span><var>IM</var><span class="hyp-type"><b>: </b><span>index ‚Üí VLSM message</span></span></span><br><span><var>state_destructor</var><span class="hyp-type"><b>: </b><span><span class="kr">‚àÄ</span> <span class="nv">i</span> : index,
  vstate (IM i)
  ‚Üí list
      (vtransition_item (IM i) *
       vstate (IM i))</span></span></span><br><span><var>state_size</var><span class="hyp-type"><b>: </b><span><span class="kr">‚àÄ</span> <span class="nv">i</span> : index, vstate (IM i) ‚Üí nat</span></span></span><br><span><var>H0</var><span class="hyp-type"><b>: </b><span><span class="kr">‚àÄ</span> <span class="nv">i</span> : index,
  TraceableVLSM (IM i) 
    (state_destructor i) 
    (state_size i)</span></span></span><br><span><var>Free</var><span><span class="hyp-body"><b>:= </b><span>free_composite_vlsm IM</span></span><span class="hyp-type"><b>: </b><span>VLSM message</span></span></span></span><br><span><var>RFree</var><span><span class="hyp-body"><b>:= </b><span>pre_loaded_with_all_messages_vlsm Free</span></span><span class="hyp-type"><b>: </b><span>VLSM message</span></span></span></span><br></div><label class="goal-separator" for="TraceableVLSM-v-chka5"><hr></label><div class="goal-conclusion"><span class="kr">‚àÄ</span> (<span class="nv">choose</span> : choice_function) 
  (<span class="nv">s&#39;</span> : composite_state IM) 
  (<span class="nv">Hs&#39;</span> : valid_state_prop RFree s&#39;) 
  (<span class="nv">i</span> : index) (<span class="nv">l0</span> : list index) 
  (<span class="nv">i_n</span> : index * nat) (<span class="nv">n</span> : i_n.<span class="mi">1</span> ‚àâ i :: l0) 
  (<span class="nv">Hni</span> : decide (i_n.<span class="mi">1</span> ‚àà i :: l0) = <span class="nb">right</span> n) 
  (<span class="nv">Hdestruct</span> : composite_state_destructor s&#39; i_n.<span class="mi">1</span>
               !! i_n.<span class="mi">2</span> = None) 
  (<span class="nv">Hchoice</span> : choose s&#39; Hs&#39; (i :: l0) = i_n),
  inspect (decide (i_n.<span class="mi">1</span> ‚àà i :: l0)) = <span class="nb">right</span> n ‚Üæ Hni
  ‚Üí inspect
      (composite_state_destructor s&#39; i_n.<span class="mi">1</span> !! i_n.<span class="mi">2</span>) =
    None ‚Üæ Hdestruct
    ‚Üí inspect (choose s&#39; Hs&#39; (i :: l0)) =
      i_n ‚Üæ Hchoice
      ‚Üí choosing_well choose
        ‚Üí NoDup (i :: l0)
          ‚Üí not_in_indices_initial_prop s&#39; (i :: l0)
            ‚Üí <span class="kr">‚àÄ</span> (<span class="nv">is</span> : composite_state IM) 
                (<span class="nv">tr</span> : list
                      (composite_transition_item IM)),
                (s&#39;, []) = (<span class="kr">is</span>, tr)
                ‚Üí <span class="kr">‚àÄ</span> <span class="nv">i0</span> : index,
                    i0 ‚àà i :: l0
                    ‚Üí vinitial_state_prop 
                      (IM i0) 
                      (<span class="kr">is</span> i0)</div></blockquote><input class="alectryon-extra-goal-toggle" id="TraceableVLSM-v-chka6" style="display: none" type="checkbox"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>message, index</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>EqDecision0</var><span class="hyp-type"><b>: </b><span>EqDecision index</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>finite.Finite index</span></span></span><br><span><var>IM</var><span class="hyp-type"><b>: </b><span>index ‚Üí VLSM message</span></span></span><br><span><var>state_destructor</var><span class="hyp-type"><b>: </b><span><span class="kr">‚àÄ</span> <span class="nv">i</span> : index,
  vstate (IM i)
  ‚Üí list
      (vtransition_item (IM i) *
       vstate (IM i))</span></span></span><br><span><var>state_size</var><span class="hyp-type"><b>: </b><span><span class="kr">‚àÄ</span> <span class="nv">i</span> : index, vstate (IM i) ‚Üí nat</span></span></span><br><span><var>H0</var><span class="hyp-type"><b>: </b><span><span class="kr">‚àÄ</span> <span class="nv">i</span> : index,
  TraceableVLSM (IM i) 
    (state_destructor i) 
    (state_size i)</span></span></span><br><span><var>Free</var><span><span class="hyp-body"><b>:= </b><span>free_composite_vlsm IM</span></span><span class="hyp-type"><b>: </b><span>VLSM message</span></span></span></span><br><span><var>RFree</var><span><span class="hyp-body"><b>:= </b><span>pre_loaded_with_all_messages_vlsm Free</span></span><span class="hyp-type"><b>: </b><span>VLSM message</span></span></span></span><br></div><label class="goal-separator" for="TraceableVLSM-v-chka6"><hr></label><div class="goal-conclusion"><span class="kr">‚àÄ</span> (<span class="nv">choose</span> : choice_function) 
  (<span class="nv">s&#39;</span> : composite_state IM) 
  (<span class="nv">Hs&#39;</span> : valid_state_prop RFree s&#39;) 
  (<span class="nv">i</span> : index) (<span class="nv">l0</span> : list index) 
  (<span class="nv">i_n</span> : index * nat) (<span class="nv">e1</span> : 
                      composite_state_destructor s&#39;
                      i_n.<span class="mi">1</span> = []) 
  (<span class="nv">Hnn</span> : decide
           (composite_state_destructor s&#39; i_n.<span class="mi">1</span> = []) =
         <span class="nb">left</span> e1) (<span class="nv">e0</span> : i_n.<span class="mi">1</span> ‚àà i :: l0) 
  (<span class="nv">Hi</span> : decide (i_n.<span class="mi">1</span> ‚àà i :: l0) = <span class="nb">left</span> e0) 
  (<span class="nv">Hdestruct</span> : composite_state_destructor s&#39; i_n.<span class="mi">1</span>
               !! i_n.<span class="mi">2</span> = None) 
  (<span class="nv">Hchoice</span> : choose s&#39; Hs&#39; (i :: l0) = i_n),
  (choosing_well choose
   ‚Üí NoDup (StdppListSet.set_remove i_n.<span class="mi">1</span> (i :: l0))
     ‚Üí not_in_indices_initial_prop s&#39;
         (StdppListSet.set_remove i_n.<span class="mi">1</span> (i :: l0))
       ‚Üí <span class="kr">‚àÄ</span> (<span class="nv">is</span> : composite_state IM) 
           (<span class="nv">tr</span> : list (composite_transition_item IM)),
           indexed_composite_state_to_trace choose s&#39;
             Hs&#39;
             (StdppListSet.set_remove i_n.<span class="mi">1</span> (i :: l0)) =
           (<span class="kr">is</span>, tr)
           ‚Üí <span class="kr">‚àÄ</span> <span class="nv">i0</span> : index,
               i0
               ‚àà StdppListSet.set_remove i_n.<span class="mi">1</span>
                   (i :: l0)
               ‚Üí vinitial_state_prop (IM i0) (<span class="kr">is</span> i0))
  ‚Üí inspect
      (decide
         (composite_state_destructor s&#39; i_n.<span class="mi">1</span> = [])) =
    <span class="nb">left</span> e1 ‚Üæ Hnn
    ‚Üí inspect (decide (i_n.<span class="mi">1</span> ‚àà i :: l0)) =
      <span class="nb">left</span> e0 ‚Üæ Hi
      ‚Üí inspect
          (composite_state_destructor s&#39; i_n.<span class="mi">1</span>
           !! i_n.<span class="mi">2</span>) = 
        None ‚Üæ Hdestruct
        ‚Üí inspect (choose s&#39; Hs&#39; (i :: l0)) =
          i_n ‚Üæ Hchoice
          ‚Üí choosing_well choose
            ‚Üí NoDup (i :: l0)
              ‚Üí not_in_indices_initial_prop s&#39;
                  (i :: l0)
                ‚Üí <span class="kr">‚àÄ</span> (<span class="nv">is</span> : composite_state IM) 
                    (<span class="nv">tr</span> : 
                     list
                      (composite_transition_item IM)),
                    indexed_composite_state_to_trace
                      choose s&#39; Hs&#39;
                      (StdppListSet.set_remove i_n.<span class="mi">1</span>
                      (i :: l0)) = 
                    (<span class="kr">is</span>, tr)
                    ‚Üí <span class="kr">‚àÄ</span> <span class="nv">i0</span> : index,
                      i0 ‚àà i :: l0
                      ‚Üí 
                      vinitial_state_prop 
                      (IM i0) 
                      (<span class="kr">is</span> i0)</div></blockquote><input class="alectryon-extra-goal-toggle" id="TraceableVLSM-v-chka7" style="display: none" type="checkbox"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>message, index</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>EqDecision0</var><span class="hyp-type"><b>: </b><span>EqDecision index</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>finite.Finite index</span></span></span><br><span><var>IM</var><span class="hyp-type"><b>: </b><span>index ‚Üí VLSM message</span></span></span><br><span><var>state_destructor</var><span class="hyp-type"><b>: </b><span><span class="kr">‚àÄ</span> <span class="nv">i</span> : index,
  vstate (IM i)
  ‚Üí list
      (vtransition_item (IM i) *
       vstate (IM i))</span></span></span><br><span><var>state_size</var><span class="hyp-type"><b>: </b><span><span class="kr">‚àÄ</span> <span class="nv">i</span> : index, vstate (IM i) ‚Üí nat</span></span></span><br><span><var>H0</var><span class="hyp-type"><b>: </b><span><span class="kr">‚àÄ</span> <span class="nv">i</span> : index,
  TraceableVLSM (IM i) 
    (state_destructor i) 
    (state_size i)</span></span></span><br><span><var>Free</var><span><span class="hyp-body"><b>:= </b><span>free_composite_vlsm IM</span></span><span class="hyp-type"><b>: </b><span>VLSM message</span></span></span></span><br><span><var>RFree</var><span><span class="hyp-body"><b>:= </b><span>pre_loaded_with_all_messages_vlsm Free</span></span><span class="hyp-type"><b>: </b><span>VLSM message</span></span></span></span><br></div><label class="goal-separator" for="TraceableVLSM-v-chka7"><hr></label><div class="goal-conclusion"><span class="kr">‚àÄ</span> (<span class="nv">choose</span> : choice_function) 
  (<span class="nv">s&#39;</span> : composite_state IM) 
  (<span class="nv">Hs&#39;</span> : valid_state_prop RFree s&#39;) 
  (<span class="nv">i</span> : index) (<span class="nv">l0</span> : list index) 
  (<span class="nv">i_n</span> : index * nat) (<span class="nv">n</span> : 
                      composite_state_destructor s&#39;
                      i_n.<span class="mi">1</span> ‚â† []) 
  (<span class="nv">Hn</span> : decide
          (composite_state_destructor s&#39; i_n.<span class="mi">1</span> = []) =
        <span class="nb">right</span> n) (<span class="nv">e0</span> : i_n.<span class="mi">1</span> ‚àà i :: l0) 
  (<span class="nv">Hi</span> : decide (i_n.<span class="mi">1</span> ‚àà i :: l0) = <span class="nb">left</span> e0) 
  (<span class="nv">Hdestruct</span> : composite_state_destructor s&#39; i_n.<span class="mi">1</span>
               !! i_n.<span class="mi">2</span> = None) 
  (<span class="nv">Hchoice</span> : choose s&#39; Hs&#39; (i :: l0) = i_n),
  inspect
    (decide (composite_state_destructor s&#39; i_n.<span class="mi">1</span> = [])) =
  <span class="nb">right</span> n ‚Üæ Hn
  ‚Üí inspect (decide (i_n.<span class="mi">1</span> ‚àà i :: l0)) = <span class="nb">left</span> e0 ‚Üæ Hi
    ‚Üí inspect
        (composite_state_destructor s&#39; i_n.<span class="mi">1</span> !! i_n.<span class="mi">2</span>) =
      None ‚Üæ Hdestruct
      ‚Üí inspect (choose s&#39; Hs&#39; (i :: l0)) =
        i_n ‚Üæ Hchoice
        ‚Üí choosing_well choose
          ‚Üí NoDup (i :: l0)
            ‚Üí not_in_indices_initial_prop s&#39; (i :: l0)
              ‚Üí <span class="kr">‚àÄ</span> (<span class="nv">is</span> : composite_state IM) 
                  (<span class="nv">tr</span> : 
                   list 
                     (composite_transition_item IM)),
                  (s&#39;, []) = (<span class="kr">is</span>, tr)
                  ‚Üí <span class="kr">‚àÄ</span> <span class="nv">i0</span> : index,
                      i0 ‚àà i :: l0
                      ‚Üí 
                      vinitial_state_prop 
                      (IM i0) 
                      (<span class="kr">is</span> i0)</div></blockquote></div></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="TraceableVLSM-v-chka8" style="display: none" type="checkbox"><label class="alectryon-input" for="TraceableVLSM-v-chka8">-</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>message, index</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>EqDecision0</var><span class="hyp-type"><b>: </b><span>EqDecision index</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>finite.Finite index</span></span></span><br><span><var>IM</var><span class="hyp-type"><b>: </b><span>index ‚Üí VLSM message</span></span></span><br><span><var>state_destructor</var><span class="hyp-type"><b>: </b><span><span class="kr">‚àÄ</span> <span class="nv">i</span> : index,
  vstate (IM i)
  ‚Üí list
      (vtransition_item (IM i) *
       vstate (IM i))</span></span></span><br><span><var>state_size</var><span class="hyp-type"><b>: </b><span><span class="kr">‚àÄ</span> <span class="nv">i</span> : index, vstate (IM i) ‚Üí nat</span></span></span><br><span><var>H0</var><span class="hyp-type"><b>: </b><span><span class="kr">‚àÄ</span> <span class="nv">i</span> : index,
  TraceableVLSM (IM i) 
    (state_destructor i) 
    (state_size i)</span></span></span><br><span><var>Free</var><span><span class="hyp-body"><b>:= </b><span>free_composite_vlsm IM</span></span><span class="hyp-type"><b>: </b><span>VLSM message</span></span></span></span><br><span><var>RFree</var><span><span class="hyp-body"><b>:= </b><span>pre_loaded_with_all_messages_vlsm Free</span></span><span class="hyp-type"><b>: </b><span>VLSM message</span></span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="kr">‚àÄ</span> (<span class="nv">choose</span> : choice_function) (<span class="nv">s&#39;</span> : composite_state IM),
  valid_state_prop RFree s&#39;
  ‚Üí choosing_well choose
    ‚Üí NoDup []
      ‚Üí not_in_indices_initial_prop s&#39; []
        ‚Üí <span class="kr">‚àÄ</span> (<span class="nv">is</span> : composite_state IM) (<span class="nv">tr</span> : list
                                              (composite_transition_item
                                                 IM)),
            (s&#39;, []) = (<span class="kr">is</span>, tr)
            ‚Üí <span class="kr">‚àÄ</span> <span class="nv">i</span> : index,
                i ‚àà []
                ‚Üí vinitial_state_prop (IM i) (<span class="kr">is</span> i)</div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="bp">by</span> <span class="nb">intros</span> ? ? ? ? ? ? ? ? ? ? Hi; <span class="nb">inversion</span> Hi.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="TraceableVLSM-v-chka9" style="display: none" type="checkbox"><label class="alectryon-input" for="TraceableVLSM-v-chka9">-</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>message, index</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>EqDecision0</var><span class="hyp-type"><b>: </b><span>EqDecision index</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>finite.Finite index</span></span></span><br><span><var>IM</var><span class="hyp-type"><b>: </b><span>index ‚Üí VLSM message</span></span></span><br><span><var>state_destructor</var><span class="hyp-type"><b>: </b><span><span class="kr">‚àÄ</span> <span class="nv">i</span> : index,
  vstate (IM i)
  ‚Üí list
      (vtransition_item (IM i) *
       vstate (IM i))</span></span></span><br><span><var>state_size</var><span class="hyp-type"><b>: </b><span><span class="kr">‚àÄ</span> <span class="nv">i</span> : index, vstate (IM i) ‚Üí nat</span></span></span><br><span><var>H0</var><span class="hyp-type"><b>: </b><span><span class="kr">‚àÄ</span> <span class="nv">i</span> : index,
  TraceableVLSM (IM i) 
    (state_destructor i) 
    (state_size i)</span></span></span><br><span><var>Free</var><span><span class="hyp-body"><b>:= </b><span>free_composite_vlsm IM</span></span><span class="hyp-type"><b>: </b><span>VLSM message</span></span></span></span><br><span><var>RFree</var><span><span class="hyp-body"><b>:= </b><span>pre_loaded_with_all_messages_vlsm Free</span></span><span class="hyp-type"><b>: </b><span>VLSM message</span></span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="kr">‚àÄ</span> (<span class="nv">choose</span> : choice_function) (<span class="nv">s&#39;</span> : composite_state IM) 
  (<span class="nv">Hs&#39;</span> : valid_state_prop RFree s&#39;) (<span class="nv">i</span> : index) (<span class="nv">l0</span> : 
                                                 list
                                                 index) 
  (<span class="nv">i_n</span> : index * nat) (<span class="nv">item</span> : composite_transition_item
                                IM) (<span class="nv">s</span> : composite_state
                                           IM) (<span class="nv">Hdestruct</span> : 
                                                composite_state_destructor
                                                 s&#39;
                                                 i_n.<span class="mi">1</span>
                                                !! i_n.<span class="mi">2</span> =
                                                Some
                                                 (item,
                                                 s)) 
  (<span class="nv">Hchoice</span> : choose s&#39; Hs&#39; (i :: l0) = i_n) (<span class="nv">is</span> : 
                                             composite_state
                                               IM) 
  (<span class="nv">tr</span> : list (composite_transition_item IM)),
  indexed_composite_state_to_trace choose s
    (indexed_composite_state_to_trace_obligations_obligation_1
       s&#39; Hs&#39; i_n item s Hdestruct) (i :: l0) =
  (<span class="kr">is</span>, tr)
  ‚Üí (choosing_well choose
     ‚Üí NoDup (i :: l0)
       ‚Üí not_in_indices_initial_prop s (i :: l0)
         ‚Üí <span class="kr">‚àÄ</span> (<span class="nv">is0</span> : composite_state IM) (<span class="nv">tr0</span> : list
                                                 (composite_transition_item
                                                 IM)),
             indexed_composite_state_to_trace choose s
               (indexed_composite_state_to_trace_obligations_obligation_1
                  s&#39; Hs&#39; i_n item s Hdestruct)
               (i :: l0) = (is0, tr0)
             ‚Üí <span class="kr">‚àÄ</span> <span class="nv">i0</span> : index,
                 i0 ‚àà i :: l0
                 ‚Üí vinitial_state_prop (IM i0)
                     (is0 i0))
    ‚Üí inspect
        (composite_state_destructor s&#39; i_n.<span class="mi">1</span> !! i_n.<span class="mi">2</span>) =
      Some (item, s) ‚Üæ Hdestruct
      ‚Üí inspect (choose s&#39; Hs&#39; (i :: l0)) =
        i_n ‚Üæ Hchoice
        ‚Üí choosing_well choose
          ‚Üí NoDup (i :: l0)
            ‚Üí not_in_indices_initial_prop s&#39; (i :: l0)
              ‚Üí <span class="kr">‚àÄ</span> (<span class="nv">is0</span> : composite_state IM) (<span class="nv">tr0</span> : 
                                              list
                                                (composite_transition_item
                                                 IM)),
                  (<span class="kr">is</span>, tr ++ [item]) = (is0, tr0)
                  ‚Üí <span class="kr">‚àÄ</span> <span class="nv">i0</span> : index,
                      i0 ‚àà i :: l0
                      ‚Üí vinitial_state_prop (IM i0)
                          (is0 i0)</div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="TraceableVLSM-v-chkaa" style="display: none" type="checkbox"><label class="alectryon-input" for="TraceableVLSM-v-chkaa"><span class="nb">intros</span> choose s&#39; Hs&#39; idx indices (j, nj) item s Hdestruct -&gt; <span class="kr">is</span> tr -&gt; Hind
      _ _ Hchoose Hnodup Hinitial is&#39; tr&#39; [= -&gt; &lt;-] i Hi.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>message, index</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>EqDecision0</var><span class="hyp-type"><b>: </b><span>EqDecision index</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>finite.Finite index</span></span></span><br><span><var>IM</var><span class="hyp-type"><b>: </b><span>index ‚Üí VLSM message</span></span></span><br><span><var>state_destructor</var><span class="hyp-type"><b>: </b><span><span class="kr">‚àÄ</span> <span class="nv">i</span> : index,
  vstate (IM i)
  ‚Üí list
      (vtransition_item (IM i) *
       vstate (IM i))</span></span></span><br><span><var>state_size</var><span class="hyp-type"><b>: </b><span><span class="kr">‚àÄ</span> <span class="nv">i</span> : index, vstate (IM i) ‚Üí nat</span></span></span><br><span><var>H0</var><span class="hyp-type"><b>: </b><span><span class="kr">‚àÄ</span> <span class="nv">i</span> : index,
  TraceableVLSM (IM i) 
    (state_destructor i) 
    (state_size i)</span></span></span><br><span><var>Free</var><span><span class="hyp-body"><b>:= </b><span>free_composite_vlsm IM</span></span><span class="hyp-type"><b>: </b><span>VLSM message</span></span></span></span><br><span><var>RFree</var><span><span class="hyp-body"><b>:= </b><span>pre_loaded_with_all_messages_vlsm Free</span></span><span class="hyp-type"><b>: </b><span>VLSM message</span></span></span></span><br><span><var>choose</var><span class="hyp-type"><b>: </b><span>choice_function</span></span></span><br><span><var>s'</var><span class="hyp-type"><b>: </b><span>composite_state IM</span></span></span><br><span><var>Hs'</var><span class="hyp-type"><b>: </b><span>valid_state_prop RFree s&#39;</span></span></span><br><span><var>idx</var><span class="hyp-type"><b>: </b><span>index</span></span></span><br><span><var>indices</var><span class="hyp-type"><b>: </b><span>list index</span></span></span><br><span><var>j</var><span class="hyp-type"><b>: </b><span>index</span></span></span><br><span><var>nj</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>item</var><span class="hyp-type"><b>: </b><span>composite_transition_item IM</span></span></span><br><span><var>s</var><span class="hyp-type"><b>: </b><span>composite_state IM</span></span></span><br><span><var>Hdestruct</var><span class="hyp-type"><b>: </b><span>composite_state_destructor s&#39; (j, nj).<span class="mi">1</span>
!! (j, nj).<span class="mi">2</span> = Some (item, s)</span></span></span><br><span><var>tr</var><span class="hyp-type"><b>: </b><span>list (composite_transition_item IM)</span></span></span><br><span><var>is'</var><span class="hyp-type"><b>: </b><span>composite_state IM</span></span></span><br><span><var>Hind</var><span class="hyp-type"><b>: </b><span>choosing_well choose
‚Üí NoDup (idx :: indices)
  ‚Üí not_in_indices_initial_prop s
      (idx :: indices)
    ‚Üí <span class="kr">‚àÄ</span> (<span class="nv">is</span> : composite_state IM) 
        (<span class="nv">tr0</span> : list
                 (composite_transition_item IM)),
        (is&#39;, tr) = (<span class="kr">is</span>, tr0)
        ‚Üí <span class="kr">‚àÄ</span> <span class="nv">i</span> : index,
            i ‚àà idx :: indices
            ‚Üí vinitial_state_prop (IM i) (<span class="kr">is</span> i)</span></span></span><br><span><var>Hchoose</var><span class="hyp-type"><b>: </b><span>choosing_well choose</span></span></span><br><span><var>Hnodup</var><span class="hyp-type"><b>: </b><span>NoDup (idx :: indices)</span></span></span><br><span><var>Hinitial</var><span class="hyp-type"><b>: </b><span>not_in_indices_initial_prop s&#39;
  (idx :: indices)</span></span></span><br><span><var>i</var><span class="hyp-type"><b>: </b><span>index</span></span></span><br><span><var>Hi</var><span class="hyp-type"><b>: </b><span>i ‚àà idx :: indices</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">vinitial_state_prop (IM i) (is&#39; i)</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><span class="alectryon-input"><span class="bp">by</span> <span class="nb">eapply</span> Hind; [| | <span class="nb">eapply</span> composite_tv_state_destructor_preserves_not_in_indices_initial  | |].</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="TraceableVLSM-v-chkab" style="display: none" type="checkbox"><label class="alectryon-input" for="TraceableVLSM-v-chkab">-</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>message, index</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>EqDecision0</var><span class="hyp-type"><b>: </b><span>EqDecision index</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>finite.Finite index</span></span></span><br><span><var>IM</var><span class="hyp-type"><b>: </b><span>index ‚Üí VLSM message</span></span></span><br><span><var>state_destructor</var><span class="hyp-type"><b>: </b><span><span class="kr">‚àÄ</span> <span class="nv">i</span> : index,
  vstate (IM i)
  ‚Üí list
      (vtransition_item (IM i) *
       vstate (IM i))</span></span></span><br><span><var>state_size</var><span class="hyp-type"><b>: </b><span><span class="kr">‚àÄ</span> <span class="nv">i</span> : index, vstate (IM i) ‚Üí nat</span></span></span><br><span><var>H0</var><span class="hyp-type"><b>: </b><span><span class="kr">‚àÄ</span> <span class="nv">i</span> : index,
  TraceableVLSM (IM i) 
    (state_destructor i) 
    (state_size i)</span></span></span><br><span><var>Free</var><span><span class="hyp-body"><b>:= </b><span>free_composite_vlsm IM</span></span><span class="hyp-type"><b>: </b><span>VLSM message</span></span></span></span><br><span><var>RFree</var><span><span class="hyp-body"><b>:= </b><span>pre_loaded_with_all_messages_vlsm Free</span></span><span class="hyp-type"><b>: </b><span>VLSM message</span></span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="kr">‚àÄ</span> (<span class="nv">choose</span> : choice_function) (<span class="nv">s&#39;</span> : composite_state IM) 
  (<span class="nv">Hs&#39;</span> : valid_state_prop RFree s&#39;) (<span class="nv">i</span> : index) (<span class="nv">l0</span> : 
                                                 list
                                                 index) 
  (<span class="nv">i_n</span> : index * nat) (<span class="nv">n</span> : i_n.<span class="mi">1</span> ‚àâ i :: l0) (<span class="nv">Hni</span> : 
                                             decide
                                               (i_n.<span class="mi">1</span>
                                                ‚àà 
                                                i
                                                :: l0) =
                                             <span class="nb">right</span> n) 
  (<span class="nv">Hdestruct</span> : composite_state_destructor s&#39; i_n.<span class="mi">1</span>
               !! i_n.<span class="mi">2</span> = None) (<span class="nv">Hchoice</span> : choose s&#39;
                                             Hs&#39;
                                             (i :: l0) =
                                           i_n),
  inspect (decide (i_n.<span class="mi">1</span> ‚àà i :: l0)) = <span class="nb">right</span> n ‚Üæ Hni
  ‚Üí inspect
      (composite_state_destructor s&#39; i_n.<span class="mi">1</span> !! i_n.<span class="mi">2</span>) =
    None ‚Üæ Hdestruct
    ‚Üí inspect (choose s&#39; Hs&#39; (i :: l0)) =
      i_n ‚Üæ Hchoice
      ‚Üí choosing_well choose
        ‚Üí NoDup (i :: l0)
          ‚Üí not_in_indices_initial_prop s&#39; (i :: l0)
            ‚Üí <span class="kr">‚àÄ</span> (<span class="nv">is</span> : composite_state IM) (<span class="nv">tr</span> : list
                                                 (composite_transition_item
                                                 IM)),
                (s&#39;, []) = (<span class="kr">is</span>, tr)
                ‚Üí <span class="kr">‚àÄ</span> <span class="nv">i0</span> : index,
                    i0 ‚àà i :: l0
                    ‚Üí vinitial_state_prop (IM i0)
                        (<span class="kr">is</span> i0)</div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="bp">by</span> <span class="nb">intros</span>; <span class="nb">subst</span>; <span class="nb">elim</span> n; <span class="nb">apply</span> cw_chosen_index_in_indices; [<span class="nb">apply</span> Hchoose |].</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="TraceableVLSM-v-chkac" style="display: none" type="checkbox"><label class="alectryon-input" for="TraceableVLSM-v-chkac">-</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>message, index</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>EqDecision0</var><span class="hyp-type"><b>: </b><span>EqDecision index</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>finite.Finite index</span></span></span><br><span><var>IM</var><span class="hyp-type"><b>: </b><span>index ‚Üí VLSM message</span></span></span><br><span><var>state_destructor</var><span class="hyp-type"><b>: </b><span><span class="kr">‚àÄ</span> <span class="nv">i</span> : index,
  vstate (IM i)
  ‚Üí list
      (vtransition_item (IM i) *
       vstate (IM i))</span></span></span><br><span><var>state_size</var><span class="hyp-type"><b>: </b><span><span class="kr">‚àÄ</span> <span class="nv">i</span> : index, vstate (IM i) ‚Üí nat</span></span></span><br><span><var>H0</var><span class="hyp-type"><b>: </b><span><span class="kr">‚àÄ</span> <span class="nv">i</span> : index,
  TraceableVLSM (IM i) 
    (state_destructor i) 
    (state_size i)</span></span></span><br><span><var>Free</var><span><span class="hyp-body"><b>:= </b><span>free_composite_vlsm IM</span></span><span class="hyp-type"><b>: </b><span>VLSM message</span></span></span></span><br><span><var>RFree</var><span><span class="hyp-body"><b>:= </b><span>pre_loaded_with_all_messages_vlsm Free</span></span><span class="hyp-type"><b>: </b><span>VLSM message</span></span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="kr">‚àÄ</span> (<span class="nv">choose</span> : choice_function) (<span class="nv">s&#39;</span> : composite_state IM) 
  (<span class="nv">Hs&#39;</span> : valid_state_prop RFree s&#39;) (<span class="nv">i</span> : index) (<span class="nv">l0</span> : 
                                                 list
                                                 index) 
  (<span class="nv">i_n</span> : index * nat) (<span class="nv">e1</span> : composite_state_destructor
                              s&#39; i_n.<span class="mi">1</span> = []) (<span class="nv">Hnn</span> : 
                                              decide
                                                (composite_state_destructor
                                                 s&#39;
                                                 i_n.<span class="mi">1</span> =
                                                 []) =
                                              <span class="nb">left</span> e1) 
  (<span class="nv">e0</span> : i_n.<span class="mi">1</span> ‚àà i :: l0) (<span class="nv">Hi</span> : decide
                                 (i_n.<span class="mi">1</span> ‚àà i :: l0) =
                               <span class="nb">left</span> e0) (<span class="nv">Hdestruct</span> : 
                                         composite_state_destructor
                                           s&#39; i_n.<span class="mi">1</span>
                                         !! i_n.<span class="mi">2</span> =
                                         None) (<span class="nv">Hchoice</span> : 
                                                choose
                                                 s&#39;
                                                 Hs&#39;
                                                 (i
                                                 :: l0) =
                                                i_n),
  (choosing_well choose
   ‚Üí NoDup (StdppListSet.set_remove i_n.<span class="mi">1</span> (i :: l0))
     ‚Üí not_in_indices_initial_prop s&#39;
         (StdppListSet.set_remove i_n.<span class="mi">1</span> (i :: l0))
       ‚Üí <span class="kr">‚àÄ</span> (<span class="nv">is</span> : composite_state IM) (<span class="nv">tr</span> : list
                                             (composite_transition_item
                                                IM)),
           indexed_composite_state_to_trace choose s&#39;
             Hs&#39;
             (StdppListSet.set_remove i_n.<span class="mi">1</span> (i :: l0)) =
           (<span class="kr">is</span>, tr)
           ‚Üí <span class="kr">‚àÄ</span> <span class="nv">i0</span> : index,
               i0
               ‚àà StdppListSet.set_remove i_n.<span class="mi">1</span>
                   (i :: l0)
               ‚Üí vinitial_state_prop (IM i0) (<span class="kr">is</span> i0))
  ‚Üí inspect
      (decide
         (composite_state_destructor s&#39; i_n.<span class="mi">1</span> = [])) =
    <span class="nb">left</span> e1 ‚Üæ Hnn
    ‚Üí inspect (decide (i_n.<span class="mi">1</span> ‚àà i :: l0)) =
      <span class="nb">left</span> e0 ‚Üæ Hi
      ‚Üí inspect
          (composite_state_destructor s&#39; i_n.<span class="mi">1</span>
           !! i_n.<span class="mi">2</span>) = None ‚Üæ Hdestruct
        ‚Üí inspect (choose s&#39; Hs&#39; (i :: l0)) =
          i_n ‚Üæ Hchoice
          ‚Üí choosing_well choose
            ‚Üí NoDup (i :: l0)
              ‚Üí not_in_indices_initial_prop s&#39;
                  (i :: l0)
                ‚Üí <span class="kr">‚àÄ</span> (<span class="nv">is</span> : composite_state IM) (<span class="nv">tr</span> : 
                                               list
                                                 (composite_transition_item
                                                 IM)),
                    indexed_composite_state_to_trace
                      choose s&#39; Hs&#39;
                      (StdppListSet.set_remove i_n.<span class="mi">1</span>
                         (i :: l0)) = (<span class="kr">is</span>, tr)
                    ‚Üí <span class="kr">‚àÄ</span> <span class="nv">i0</span> : index,
                        i0 ‚àà i :: l0
                        ‚Üí vinitial_state_prop (IM i0)
                            (<span class="kr">is</span> i0)</div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="TraceableVLSM-v-chkad" style="display: none" type="checkbox"><label class="alectryon-input" for="TraceableVLSM-v-chkad"><span class="nb">intros</span> choose s&#39; Hs&#39; idx indices (j, nj) Hdestruct _ Hj _ _ -&gt; Hind
      _ _ _ _ Hchoose Hnodup Hinitial <span class="kr">is</span> tr Heqis_tr i Hi.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>message, index</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>EqDecision0</var><span class="hyp-type"><b>: </b><span>EqDecision index</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>finite.Finite index</span></span></span><br><span><var>IM</var><span class="hyp-type"><b>: </b><span>index ‚Üí VLSM message</span></span></span><br><span><var>state_destructor</var><span class="hyp-type"><b>: </b><span><span class="kr">‚àÄ</span> <span class="nv">i</span> : index,
  vstate (IM i)
  ‚Üí list
      (vtransition_item (IM i) *
       vstate (IM i))</span></span></span><br><span><var>state_size</var><span class="hyp-type"><b>: </b><span><span class="kr">‚àÄ</span> <span class="nv">i</span> : index, vstate (IM i) ‚Üí nat</span></span></span><br><span><var>H0</var><span class="hyp-type"><b>: </b><span><span class="kr">‚àÄ</span> <span class="nv">i</span> : index,
  TraceableVLSM (IM i) 
    (state_destructor i) 
    (state_size i)</span></span></span><br><span><var>Free</var><span><span class="hyp-body"><b>:= </b><span>free_composite_vlsm IM</span></span><span class="hyp-type"><b>: </b><span>VLSM message</span></span></span></span><br><span><var>RFree</var><span><span class="hyp-body"><b>:= </b><span>pre_loaded_with_all_messages_vlsm Free</span></span><span class="hyp-type"><b>: </b><span>VLSM message</span></span></span></span><br><span><var>choose</var><span class="hyp-type"><b>: </b><span>choice_function</span></span></span><br><span><var>s'</var><span class="hyp-type"><b>: </b><span>composite_state IM</span></span></span><br><span><var>Hs'</var><span class="hyp-type"><b>: </b><span>valid_state_prop RFree s&#39;</span></span></span><br><span><var>idx</var><span class="hyp-type"><b>: </b><span>index</span></span></span><br><span><var>indices</var><span class="hyp-type"><b>: </b><span>list index</span></span></span><br><span><var>j</var><span class="hyp-type"><b>: </b><span>index</span></span></span><br><span><var>nj</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>Hdestruct</var><span class="hyp-type"><b>: </b><span>composite_state_destructor s&#39; (j, nj).<span class="mi">1</span> =
[]</span></span></span><br><span><var>Hj</var><span class="hyp-type"><b>: </b><span>(j, nj).<span class="mi">1</span> ‚àà idx :: indices</span></span></span><br><span><var>Hind</var><span class="hyp-type"><b>: </b><span>choosing_well choose
‚Üí NoDup
    (StdppListSet.set_remove 
       (j, nj).<span class="mi">1</span> (idx :: indices))
  ‚Üí not_in_indices_initial_prop s&#39;
      (StdppListSet.set_remove 
         (j, nj).<span class="mi">1</span> (idx :: indices))
    ‚Üí <span class="kr">‚àÄ</span> (<span class="nv">is</span> : composite_state IM) 
        (<span class="nv">tr</span> : list
                (composite_transition_item IM)),
        indexed_composite_state_to_trace choose
          s&#39; Hs&#39;
          (StdppListSet.set_remove 
             (j, nj).<span class="mi">1</span> 
             (idx :: indices)) = 
        (<span class="kr">is</span>, tr)
        ‚Üí <span class="kr">‚àÄ</span> <span class="nv">i</span> : index,
            i
            ‚àà StdppListSet.set_remove 
                (j, nj).<span class="mi">1</span> 
                (idx :: indices)
            ‚Üí vinitial_state_prop (IM i) (<span class="kr">is</span> i)</span></span></span><br><span><var>Hchoose</var><span class="hyp-type"><b>: </b><span>choosing_well choose</span></span></span><br><span><var>Hnodup</var><span class="hyp-type"><b>: </b><span>NoDup (idx :: indices)</span></span></span><br><span><var>Hinitial</var><span class="hyp-type"><b>: </b><span>not_in_indices_initial_prop s&#39;
  (idx :: indices)</span></span></span><br><span><var>is</var><span class="hyp-type"><b>: </b><span>composite_state IM</span></span></span><br><span><var>tr</var><span class="hyp-type"><b>: </b><span>list (composite_transition_item IM)</span></span></span><br><span><var>Heqis_tr</var><span class="hyp-type"><b>: </b><span>indexed_composite_state_to_trace choose s&#39;
  Hs&#39;
  (StdppListSet.set_remove 
     (j, nj).<span class="mi">1</span> (idx :: indices)) = 
(<span class="kr">is</span>, tr)</span></span></span><br><span><var>i</var><span class="hyp-type"><b>: </b><span>index</span></span></span><br><span><var>Hi</var><span class="hyp-type"><b>: </b><span>i ‚àà idx :: indices</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">vinitial_state_prop (IM i) (<span class="kr">is</span> i)</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="TraceableVLSM-v-chkae" style="display: none" type="checkbox"><label class="alectryon-input" for="TraceableVLSM-v-chkae"><span class="nb">rewrite</span> Heqis_tr <span class="kr">in</span> Hind.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>message, index</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>EqDecision0</var><span class="hyp-type"><b>: </b><span>EqDecision index</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>finite.Finite index</span></span></span><br><span><var>IM</var><span class="hyp-type"><b>: </b><span>index ‚Üí VLSM message</span></span></span><br><span><var>state_destructor</var><span class="hyp-type"><b>: </b><span><span class="kr">‚àÄ</span> <span class="nv">i</span> : index,
  vstate (IM i)
  ‚Üí list
      (vtransition_item (IM i) *
       vstate (IM i))</span></span></span><br><span><var>state_size</var><span class="hyp-type"><b>: </b><span><span class="kr">‚àÄ</span> <span class="nv">i</span> : index, vstate (IM i) ‚Üí nat</span></span></span><br><span><var>H0</var><span class="hyp-type"><b>: </b><span><span class="kr">‚àÄ</span> <span class="nv">i</span> : index,
  TraceableVLSM (IM i) 
    (state_destructor i) 
    (state_size i)</span></span></span><br><span><var>Free</var><span><span class="hyp-body"><b>:= </b><span>free_composite_vlsm IM</span></span><span class="hyp-type"><b>: </b><span>VLSM message</span></span></span></span><br><span><var>RFree</var><span><span class="hyp-body"><b>:= </b><span>pre_loaded_with_all_messages_vlsm Free</span></span><span class="hyp-type"><b>: </b><span>VLSM message</span></span></span></span><br><span><var>choose</var><span class="hyp-type"><b>: </b><span>choice_function</span></span></span><br><span><var>s'</var><span class="hyp-type"><b>: </b><span>composite_state IM</span></span></span><br><span><var>Hs'</var><span class="hyp-type"><b>: </b><span>valid_state_prop RFree s&#39;</span></span></span><br><span><var>idx</var><span class="hyp-type"><b>: </b><span>index</span></span></span><br><span><var>indices</var><span class="hyp-type"><b>: </b><span>list index</span></span></span><br><span><var>j</var><span class="hyp-type"><b>: </b><span>index</span></span></span><br><span><var>nj</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>Hdestruct</var><span class="hyp-type"><b>: </b><span>composite_state_destructor s&#39; (j, nj).<span class="mi">1</span> =
[]</span></span></span><br><span><var>Hj</var><span class="hyp-type"><b>: </b><span>(j, nj).<span class="mi">1</span> ‚àà idx :: indices</span></span></span><br><span><var>is</var><span class="hyp-type"><b>: </b><span>composite_state IM</span></span></span><br><span><var>tr</var><span class="hyp-type"><b>: </b><span>list (composite_transition_item IM)</span></span></span><br><span><var>Hind</var><span class="hyp-type"><b>: </b><span>choosing_well choose
‚Üí NoDup
    (StdppListSet.set_remove 
       (j, nj).<span class="mi">1</span> (idx :: indices))
  ‚Üí not_in_indices_initial_prop s&#39;
      (StdppListSet.set_remove 
         (j, nj).<span class="mi">1</span> (idx :: indices))
    ‚Üí <span class="kr">‚àÄ</span> (<span class="nv">is0</span> : composite_state IM) 
        (<span class="nv">tr0</span> : list
                 (composite_transition_item IM)),
        (<span class="kr">is</span>, tr) = (is0, tr0)
        ‚Üí <span class="kr">‚àÄ</span> <span class="nv">i</span> : index,
            i
            ‚àà StdppListSet.set_remove 
                (j, nj).<span class="mi">1</span> 
                (idx :: indices)
            ‚Üí vinitial_state_prop 
                (IM i) 
                (is0 i)</span></span></span><br><span><var>Hchoose</var><span class="hyp-type"><b>: </b><span>choosing_well choose</span></span></span><br><span><var>Hnodup</var><span class="hyp-type"><b>: </b><span>NoDup (idx :: indices)</span></span></span><br><span><var>Hinitial</var><span class="hyp-type"><b>: </b><span>not_in_indices_initial_prop s&#39;
  (idx :: indices)</span></span></span><br><span><var>Heqis_tr</var><span class="hyp-type"><b>: </b><span>indexed_composite_state_to_trace choose s&#39;
  Hs&#39;
  (StdppListSet.set_remove 
     (j, nj).<span class="mi">1</span> (idx :: indices)) = 
(<span class="kr">is</span>, tr)</span></span></span><br><span><var>i</var><span class="hyp-type"><b>: </b><span>index</span></span></span><br><span><var>Hi</var><span class="hyp-type"><b>: </b><span>i ‚àà idx :: indices</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">vinitial_state_prop (IM i) (<span class="kr">is</span> i)</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="TraceableVLSM-v-chkaf" style="display: none" type="checkbox"><label class="alectryon-input" for="TraceableVLSM-v-chkaf"><span class="nb">remember</span> (StdppListSet.set_remove _ _) <span class="kr">as</span> removed.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>message, index</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>EqDecision0</var><span class="hyp-type"><b>: </b><span>EqDecision index</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>finite.Finite index</span></span></span><br><span><var>IM</var><span class="hyp-type"><b>: </b><span>index ‚Üí VLSM message</span></span></span><br><span><var>state_destructor</var><span class="hyp-type"><b>: </b><span><span class="kr">‚àÄ</span> <span class="nv">i</span> : index,
  vstate (IM i)
  ‚Üí list
      (vtransition_item (IM i) *
       vstate (IM i))</span></span></span><br><span><var>state_size</var><span class="hyp-type"><b>: </b><span><span class="kr">‚àÄ</span> <span class="nv">i</span> : index, vstate (IM i) ‚Üí nat</span></span></span><br><span><var>H0</var><span class="hyp-type"><b>: </b><span><span class="kr">‚àÄ</span> <span class="nv">i</span> : index,
  TraceableVLSM (IM i) 
    (state_destructor i) 
    (state_size i)</span></span></span><br><span><var>Free</var><span><span class="hyp-body"><b>:= </b><span>free_composite_vlsm IM</span></span><span class="hyp-type"><b>: </b><span>VLSM message</span></span></span></span><br><span><var>RFree</var><span><span class="hyp-body"><b>:= </b><span>pre_loaded_with_all_messages_vlsm Free</span></span><span class="hyp-type"><b>: </b><span>VLSM message</span></span></span></span><br><span><var>choose</var><span class="hyp-type"><b>: </b><span>choice_function</span></span></span><br><span><var>s'</var><span class="hyp-type"><b>: </b><span>composite_state IM</span></span></span><br><span><var>Hs'</var><span class="hyp-type"><b>: </b><span>valid_state_prop RFree s&#39;</span></span></span><br><span><var>idx</var><span class="hyp-type"><b>: </b><span>index</span></span></span><br><span><var>indices</var><span class="hyp-type"><b>: </b><span>list index</span></span></span><br><span><var>j</var><span class="hyp-type"><b>: </b><span>index</span></span></span><br><span><var>nj</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>Hdestruct</var><span class="hyp-type"><b>: </b><span>composite_state_destructor s&#39; (j, nj).<span class="mi">1</span> =
[]</span></span></span><br><span><var>Hj</var><span class="hyp-type"><b>: </b><span>(j, nj).<span class="mi">1</span> ‚àà idx :: indices</span></span></span><br><span><var>is</var><span class="hyp-type"><b>: </b><span>composite_state IM</span></span></span><br><span><var>tr</var><span class="hyp-type"><b>: </b><span>list (composite_transition_item IM)</span></span></span><br><span><var>removed</var><span class="hyp-type"><b>: </b><span>StdppListSet.<span class="nb">set</span> index</span></span></span><br><span><var>Heqremoved</var><span class="hyp-type"><b>: </b><span>removed =
StdppListSet.set_remove 
  (j, nj).<span class="mi">1</span> (idx :: indices)</span></span></span><br><span><var>Hind</var><span class="hyp-type"><b>: </b><span>choosing_well choose
‚Üí NoDup removed
  ‚Üí not_in_indices_initial_prop s&#39; removed
    ‚Üí <span class="kr">‚àÄ</span> (<span class="nv">is0</span> : composite_state IM) 
        (<span class="nv">tr0</span> : list
                 (composite_transition_item IM)),
        (<span class="kr">is</span>, tr) = (is0, tr0)
        ‚Üí <span class="kr">‚àÄ</span> <span class="nv">i</span> : index,
            i ‚àà removed
            ‚Üí vinitial_state_prop 
                (IM i) 
                (is0 i)</span></span></span><br><span><var>Hchoose</var><span class="hyp-type"><b>: </b><span>choosing_well choose</span></span></span><br><span><var>Hnodup</var><span class="hyp-type"><b>: </b><span>NoDup (idx :: indices)</span></span></span><br><span><var>Hinitial</var><span class="hyp-type"><b>: </b><span>not_in_indices_initial_prop s&#39;
  (idx :: indices)</span></span></span><br><span><var>Heqis_tr</var><span class="hyp-type"><b>: </b><span>indexed_composite_state_to_trace choose s&#39;
  Hs&#39; removed = (<span class="kr">is</span>, tr)</span></span></span><br><span><var>i</var><span class="hyp-type"><b>: </b><span>index</span></span></span><br><span><var>Hi</var><span class="hyp-type"><b>: </b><span>i ‚àà idx :: indices</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">vinitial_state_prop (IM i) (<span class="kr">is</span> i)</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="TraceableVLSM-v-chkb0" style="display: none" type="checkbox"><label class="alectryon-input" for="TraceableVLSM-v-chkb0"><span class="nb">destruct</span> (decide (i ‚àà removed)).</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>message, index</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>EqDecision0</var><span class="hyp-type"><b>: </b><span>EqDecision index</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>finite.Finite index</span></span></span><br><span><var>IM</var><span class="hyp-type"><b>: </b><span>index ‚Üí VLSM message</span></span></span><br><span><var>state_destructor</var><span class="hyp-type"><b>: </b><span><span class="kr">‚àÄ</span> <span class="nv">i</span> : index,
  vstate (IM i)
  ‚Üí list
      (vtransition_item (IM i) *
       vstate (IM i))</span></span></span><br><span><var>state_size</var><span class="hyp-type"><b>: </b><span><span class="kr">‚àÄ</span> <span class="nv">i</span> : index, vstate (IM i) ‚Üí nat</span></span></span><br><span><var>H0</var><span class="hyp-type"><b>: </b><span><span class="kr">‚àÄ</span> <span class="nv">i</span> : index,
  TraceableVLSM (IM i) 
    (state_destructor i) 
    (state_size i)</span></span></span><br><span><var>Free</var><span><span class="hyp-body"><b>:= </b><span>free_composite_vlsm IM</span></span><span class="hyp-type"><b>: </b><span>VLSM message</span></span></span></span><br><span><var>RFree</var><span><span class="hyp-body"><b>:= </b><span>pre_loaded_with_all_messages_vlsm Free</span></span><span class="hyp-type"><b>: </b><span>VLSM message</span></span></span></span><br><span><var>choose</var><span class="hyp-type"><b>: </b><span>choice_function</span></span></span><br><span><var>s'</var><span class="hyp-type"><b>: </b><span>composite_state IM</span></span></span><br><span><var>Hs'</var><span class="hyp-type"><b>: </b><span>valid_state_prop RFree s&#39;</span></span></span><br><span><var>idx</var><span class="hyp-type"><b>: </b><span>index</span></span></span><br><span><var>indices</var><span class="hyp-type"><b>: </b><span>list index</span></span></span><br><span><var>j</var><span class="hyp-type"><b>: </b><span>index</span></span></span><br><span><var>nj</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>Hdestruct</var><span class="hyp-type"><b>: </b><span>composite_state_destructor s&#39; (j, nj).<span class="mi">1</span> =
[]</span></span></span><br><span><var>Hj</var><span class="hyp-type"><b>: </b><span>(j, nj).<span class="mi">1</span> ‚àà idx :: indices</span></span></span><br><span><var>is</var><span class="hyp-type"><b>: </b><span>composite_state IM</span></span></span><br><span><var>tr</var><span class="hyp-type"><b>: </b><span>list (composite_transition_item IM)</span></span></span><br><span><var>removed</var><span class="hyp-type"><b>: </b><span>StdppListSet.<span class="nb">set</span> index</span></span></span><br><span><var>Heqremoved</var><span class="hyp-type"><b>: </b><span>removed =
StdppListSet.set_remove 
  (j, nj).<span class="mi">1</span> (idx :: indices)</span></span></span><br><span><var>Hind</var><span class="hyp-type"><b>: </b><span>choosing_well choose
‚Üí NoDup removed
  ‚Üí not_in_indices_initial_prop s&#39; removed
    ‚Üí <span class="kr">‚àÄ</span> (<span class="nv">is0</span> : composite_state IM) 
        (<span class="nv">tr0</span> : list
                 (composite_transition_item IM)),
        (<span class="kr">is</span>, tr) = (is0, tr0)
        ‚Üí <span class="kr">‚àÄ</span> <span class="nv">i</span> : index,
            i ‚àà removed
            ‚Üí vinitial_state_prop 
                (IM i) 
                (is0 i)</span></span></span><br><span><var>Hchoose</var><span class="hyp-type"><b>: </b><span>choosing_well choose</span></span></span><br><span><var>Hnodup</var><span class="hyp-type"><b>: </b><span>NoDup (idx :: indices)</span></span></span><br><span><var>Hinitial</var><span class="hyp-type"><b>: </b><span>not_in_indices_initial_prop s&#39;
  (idx :: indices)</span></span></span><br><span><var>Heqis_tr</var><span class="hyp-type"><b>: </b><span>indexed_composite_state_to_trace choose s&#39;
  Hs&#39; removed = (<span class="kr">is</span>, tr)</span></span></span><br><span><var>i</var><span class="hyp-type"><b>: </b><span>index</span></span></span><br><span><var>Hi</var><span class="hyp-type"><b>: </b><span>i ‚àà idx :: indices</span></span></span><br><span><var>e</var><span class="hyp-type"><b>: </b><span>i ‚àà removed</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">vinitial_state_prop (IM i) (<span class="kr">is</span> i)</div></blockquote><div class="alectryon-extra-goals"><input class="alectryon-extra-goal-toggle" id="TraceableVLSM-v-chkb1" style="display: none" type="checkbox"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>message, index</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>EqDecision0</var><span class="hyp-type"><b>: </b><span>EqDecision index</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>finite.Finite index</span></span></span><br><span><var>IM</var><span class="hyp-type"><b>: </b><span>index ‚Üí VLSM message</span></span></span><br><span><var>state_destructor</var><span class="hyp-type"><b>: </b><span><span class="kr">‚àÄ</span> <span class="nv">i</span> : index,
  vstate (IM i)
  ‚Üí list
      (vtransition_item (IM i) *
       vstate (IM i))</span></span></span><br><span><var>state_size</var><span class="hyp-type"><b>: </b><span><span class="kr">‚àÄ</span> <span class="nv">i</span> : index, vstate (IM i) ‚Üí nat</span></span></span><br><span><var>H0</var><span class="hyp-type"><b>: </b><span><span class="kr">‚àÄ</span> <span class="nv">i</span> : index,
  TraceableVLSM (IM i) 
    (state_destructor i) 
    (state_size i)</span></span></span><br><span><var>Free</var><span><span class="hyp-body"><b>:= </b><span>free_composite_vlsm IM</span></span><span class="hyp-type"><b>: </b><span>VLSM message</span></span></span></span><br><span><var>RFree</var><span><span class="hyp-body"><b>:= </b><span>pre_loaded_with_all_messages_vlsm Free</span></span><span class="hyp-type"><b>: </b><span>VLSM message</span></span></span></span><br><span><var>choose</var><span class="hyp-type"><b>: </b><span>choice_function</span></span></span><br><span><var>s'</var><span class="hyp-type"><b>: </b><span>composite_state IM</span></span></span><br><span><var>Hs'</var><span class="hyp-type"><b>: </b><span>valid_state_prop RFree s&#39;</span></span></span><br><span><var>idx</var><span class="hyp-type"><b>: </b><span>index</span></span></span><br><span><var>indices</var><span class="hyp-type"><b>: </b><span>list index</span></span></span><br><span><var>j</var><span class="hyp-type"><b>: </b><span>index</span></span></span><br><span><var>nj</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>Hdestruct</var><span class="hyp-type"><b>: </b><span>composite_state_destructor s&#39; (j, nj).<span class="mi">1</span> =
[]</span></span></span><br><span><var>Hj</var><span class="hyp-type"><b>: </b><span>(j, nj).<span class="mi">1</span> ‚àà idx :: indices</span></span></span><br><span><var>is</var><span class="hyp-type"><b>: </b><span>composite_state IM</span></span></span><br><span><var>tr</var><span class="hyp-type"><b>: </b><span>list (composite_transition_item IM)</span></span></span><br><span><var>removed</var><span class="hyp-type"><b>: </b><span>StdppListSet.<span class="nb">set</span> index</span></span></span><br><span><var>Heqremoved</var><span class="hyp-type"><b>: </b><span>removed =
StdppListSet.set_remove 
  (j, nj).<span class="mi">1</span> (idx :: indices)</span></span></span><br><span><var>Hind</var><span class="hyp-type"><b>: </b><span>choosing_well choose
‚Üí NoDup removed
  ‚Üí not_in_indices_initial_prop s&#39; removed
    ‚Üí <span class="kr">‚àÄ</span> (<span class="nv">is0</span> : composite_state IM) 
        (<span class="nv">tr0</span> : list
                 (composite_transition_item IM)),
        (<span class="kr">is</span>, tr) = (is0, tr0)
        ‚Üí <span class="kr">‚àÄ</span> <span class="nv">i</span> : index,
            i ‚àà removed
            ‚Üí vinitial_state_prop 
                (IM i) 
                (is0 i)</span></span></span><br><span><var>Hchoose</var><span class="hyp-type"><b>: </b><span>choosing_well choose</span></span></span><br><span><var>Hnodup</var><span class="hyp-type"><b>: </b><span>NoDup (idx :: indices)</span></span></span><br><span><var>Hinitial</var><span class="hyp-type"><b>: </b><span>not_in_indices_initial_prop s&#39;
  (idx :: indices)</span></span></span><br><span><var>Heqis_tr</var><span class="hyp-type"><b>: </b><span>indexed_composite_state_to_trace choose s&#39;
  Hs&#39; removed = (<span class="kr">is</span>, tr)</span></span></span><br><span><var>i</var><span class="hyp-type"><b>: </b><span>index</span></span></span><br><span><var>Hi</var><span class="hyp-type"><b>: </b><span>i ‚àà idx :: indices</span></span></span><br><span><var>n</var><span class="hyp-type"><b>: </b><span>i ‚àâ removed</span></span></span><br></div><label class="goal-separator" for="TraceableVLSM-v-chkb1"><hr></label><div class="goal-conclusion">vinitial_state_prop (IM i) (<span class="kr">is</span> i)</div></blockquote></div></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="TraceableVLSM-v-chkb2" style="display: none" type="checkbox"><label class="alectryon-input" for="TraceableVLSM-v-chkb2">+</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>message, index</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>EqDecision0</var><span class="hyp-type"><b>: </b><span>EqDecision index</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>finite.Finite index</span></span></span><br><span><var>IM</var><span class="hyp-type"><b>: </b><span>index ‚Üí VLSM message</span></span></span><br><span><var>state_destructor</var><span class="hyp-type"><b>: </b><span><span class="kr">‚àÄ</span> <span class="nv">i</span> : index,
  vstate (IM i)
  ‚Üí list
      (vtransition_item (IM i) *
       vstate (IM i))</span></span></span><br><span><var>state_size</var><span class="hyp-type"><b>: </b><span><span class="kr">‚àÄ</span> <span class="nv">i</span> : index, vstate (IM i) ‚Üí nat</span></span></span><br><span><var>H0</var><span class="hyp-type"><b>: </b><span><span class="kr">‚àÄ</span> <span class="nv">i</span> : index,
  TraceableVLSM (IM i) 
    (state_destructor i) 
    (state_size i)</span></span></span><br><span><var>Free</var><span><span class="hyp-body"><b>:= </b><span>free_composite_vlsm IM</span></span><span class="hyp-type"><b>: </b><span>VLSM message</span></span></span></span><br><span><var>RFree</var><span><span class="hyp-body"><b>:= </b><span>pre_loaded_with_all_messages_vlsm Free</span></span><span class="hyp-type"><b>: </b><span>VLSM message</span></span></span></span><br><span><var>choose</var><span class="hyp-type"><b>: </b><span>choice_function</span></span></span><br><span><var>s'</var><span class="hyp-type"><b>: </b><span>composite_state IM</span></span></span><br><span><var>Hs'</var><span class="hyp-type"><b>: </b><span>valid_state_prop RFree s&#39;</span></span></span><br><span><var>idx</var><span class="hyp-type"><b>: </b><span>index</span></span></span><br><span><var>indices</var><span class="hyp-type"><b>: </b><span>list index</span></span></span><br><span><var>j</var><span class="hyp-type"><b>: </b><span>index</span></span></span><br><span><var>nj</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>Hdestruct</var><span class="hyp-type"><b>: </b><span>composite_state_destructor s&#39; (j, nj).<span class="mi">1</span> =
[]</span></span></span><br><span><var>Hj</var><span class="hyp-type"><b>: </b><span>(j, nj).<span class="mi">1</span> ‚àà idx :: indices</span></span></span><br><span><var>is</var><span class="hyp-type"><b>: </b><span>composite_state IM</span></span></span><br><span><var>tr</var><span class="hyp-type"><b>: </b><span>list (composite_transition_item IM)</span></span></span><br><span><var>removed</var><span class="hyp-type"><b>: </b><span>StdppListSet.<span class="nb">set</span> index</span></span></span><br><span><var>Heqremoved</var><span class="hyp-type"><b>: </b><span>removed =
StdppListSet.set_remove 
  (j, nj).<span class="mi">1</span> (idx :: indices)</span></span></span><br><span><var>Hind</var><span class="hyp-type"><b>: </b><span>choosing_well choose
‚Üí NoDup removed
  ‚Üí not_in_indices_initial_prop s&#39; removed
    ‚Üí <span class="kr">‚àÄ</span> (<span class="nv">is0</span> : composite_state IM) 
        (<span class="nv">tr0</span> : list
                 (composite_transition_item IM)),
        (<span class="kr">is</span>, tr) = (is0, tr0)
        ‚Üí <span class="kr">‚àÄ</span> <span class="nv">i</span> : index,
            i ‚àà removed
            ‚Üí vinitial_state_prop 
                (IM i) 
                (is0 i)</span></span></span><br><span><var>Hchoose</var><span class="hyp-type"><b>: </b><span>choosing_well choose</span></span></span><br><span><var>Hnodup</var><span class="hyp-type"><b>: </b><span>NoDup (idx :: indices)</span></span></span><br><span><var>Hinitial</var><span class="hyp-type"><b>: </b><span>not_in_indices_initial_prop s&#39;
  (idx :: indices)</span></span></span><br><span><var>Heqis_tr</var><span class="hyp-type"><b>: </b><span>indexed_composite_state_to_trace choose s&#39;
  Hs&#39; removed = (<span class="kr">is</span>, tr)</span></span></span><br><span><var>i</var><span class="hyp-type"><b>: </b><span>index</span></span></span><br><span><var>Hi</var><span class="hyp-type"><b>: </b><span>i ‚àà idx :: indices</span></span></span><br><span><var>e</var><span class="hyp-type"><b>: </b><span>i ‚àà removed</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">vinitial_state_prop (IM i) (<span class="kr">is</span> i)</div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="TraceableVLSM-v-chkb3" style="display: none" type="checkbox"><label class="alectryon-input" for="TraceableVLSM-v-chkb3"><span class="nb">subst</span>; <span class="nb">eapply</span> Hind; [<span class="bp">done</span> | | | <span class="bp">done</span> | <span class="bp">done</span>].</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>message, index</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>EqDecision0</var><span class="hyp-type"><b>: </b><span>EqDecision index</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>finite.Finite index</span></span></span><br><span><var>IM</var><span class="hyp-type"><b>: </b><span>index ‚Üí VLSM message</span></span></span><br><span><var>state_destructor</var><span class="hyp-type"><b>: </b><span><span class="kr">‚àÄ</span> <span class="nv">i</span> : index,
  vstate (IM i)
  ‚Üí list
      (vtransition_item (IM i) *
       vstate (IM i))</span></span></span><br><span><var>state_size</var><span class="hyp-type"><b>: </b><span><span class="kr">‚àÄ</span> <span class="nv">i</span> : index, vstate (IM i) ‚Üí nat</span></span></span><br><span><var>H0</var><span class="hyp-type"><b>: </b><span><span class="kr">‚àÄ</span> <span class="nv">i</span> : index,
  TraceableVLSM (IM i) 
    (state_destructor i) 
    (state_size i)</span></span></span><br><span><var>Free</var><span><span class="hyp-body"><b>:= </b><span>free_composite_vlsm IM</span></span><span class="hyp-type"><b>: </b><span>VLSM message</span></span></span></span><br><span><var>RFree</var><span><span class="hyp-body"><b>:= </b><span>pre_loaded_with_all_messages_vlsm Free</span></span><span class="hyp-type"><b>: </b><span>VLSM message</span></span></span></span><br><span><var>choose</var><span class="hyp-type"><b>: </b><span>choice_function</span></span></span><br><span><var>s'</var><span class="hyp-type"><b>: </b><span>composite_state IM</span></span></span><br><span><var>Hs'</var><span class="hyp-type"><b>: </b><span>valid_state_prop RFree s&#39;</span></span></span><br><span><var>idx</var><span class="hyp-type"><b>: </b><span>index</span></span></span><br><span><var>indices</var><span class="hyp-type"><b>: </b><span>list index</span></span></span><br><span><var>j</var><span class="hyp-type"><b>: </b><span>index</span></span></span><br><span><var>nj</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>Hdestruct</var><span class="hyp-type"><b>: </b><span>composite_state_destructor s&#39; (j, nj).<span class="mi">1</span> =
[]</span></span></span><br><span><var>Hj</var><span class="hyp-type"><b>: </b><span>(j, nj).<span class="mi">1</span> ‚àà idx :: indices</span></span></span><br><span><var>is</var><span class="hyp-type"><b>: </b><span>composite_state IM</span></span></span><br><span><var>tr</var><span class="hyp-type"><b>: </b><span>list (composite_transition_item IM)</span></span></span><br><span><var>Hind</var><span class="hyp-type"><b>: </b><span>choosing_well choose
‚Üí NoDup
    (StdppListSet.set_remove 
       (j, nj).<span class="mi">1</span> (idx :: indices))
  ‚Üí not_in_indices_initial_prop s&#39;
      (StdppListSet.set_remove 
         (j, nj).<span class="mi">1</span> (idx :: indices))
    ‚Üí <span class="kr">‚àÄ</span> (<span class="nv">is0</span> : composite_state IM) 
        (<span class="nv">tr0</span> : list
                 (composite_transition_item IM)),
        (<span class="kr">is</span>, tr) = (is0, tr0)
        ‚Üí <span class="kr">‚àÄ</span> <span class="nv">i</span> : index,
            i
            ‚àà StdppListSet.set_remove 
                (j, nj).<span class="mi">1</span> 
                (idx :: indices)
            ‚Üí vinitial_state_prop 
                (IM i) 
                (is0 i)</span></span></span><br><span><var>Hchoose</var><span class="hyp-type"><b>: </b><span>choosing_well choose</span></span></span><br><span><var>Hnodup</var><span class="hyp-type"><b>: </b><span>NoDup (idx :: indices)</span></span></span><br><span><var>Hinitial</var><span class="hyp-type"><b>: </b><span>not_in_indices_initial_prop s&#39;
  (idx :: indices)</span></span></span><br><span><var>Heqis_tr</var><span class="hyp-type"><b>: </b><span>indexed_composite_state_to_trace choose s&#39;
  Hs&#39;
  (StdppListSet.set_remove 
     (j, nj).<span class="mi">1</span> (idx :: indices)) = 
(<span class="kr">is</span>, tr)</span></span></span><br><span><var>i</var><span class="hyp-type"><b>: </b><span>index</span></span></span><br><span><var>Hi</var><span class="hyp-type"><b>: </b><span>i ‚àà idx :: indices</span></span></span><br><span><var>e</var><span class="hyp-type"><b>: </b><span>i
‚àà StdppListSet.set_remove 
    (j, nj).<span class="mi">1</span> (idx :: indices)</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">NoDup
  (StdppListSet.set_remove (j, nj).<span class="mi">1</span> (idx :: indices))</div></blockquote><div class="alectryon-extra-goals"><input class="alectryon-extra-goal-toggle" id="TraceableVLSM-v-chkb4" style="display: none" type="checkbox"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>message, index</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>EqDecision0</var><span class="hyp-type"><b>: </b><span>EqDecision index</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>finite.Finite index</span></span></span><br><span><var>IM</var><span class="hyp-type"><b>: </b><span>index ‚Üí VLSM message</span></span></span><br><span><var>state_destructor</var><span class="hyp-type"><b>: </b><span><span class="kr">‚àÄ</span> <span class="nv">i</span> : index,
  vstate (IM i)
  ‚Üí list
      (vtransition_item (IM i) *
       vstate (IM i))</span></span></span><br><span><var>state_size</var><span class="hyp-type"><b>: </b><span><span class="kr">‚àÄ</span> <span class="nv">i</span> : index, vstate (IM i) ‚Üí nat</span></span></span><br><span><var>H0</var><span class="hyp-type"><b>: </b><span><span class="kr">‚àÄ</span> <span class="nv">i</span> : index,
  TraceableVLSM (IM i) 
    (state_destructor i) 
    (state_size i)</span></span></span><br><span><var>Free</var><span><span class="hyp-body"><b>:= </b><span>free_composite_vlsm IM</span></span><span class="hyp-type"><b>: </b><span>VLSM message</span></span></span></span><br><span><var>RFree</var><span><span class="hyp-body"><b>:= </b><span>pre_loaded_with_all_messages_vlsm Free</span></span><span class="hyp-type"><b>: </b><span>VLSM message</span></span></span></span><br><span><var>choose</var><span class="hyp-type"><b>: </b><span>choice_function</span></span></span><br><span><var>s'</var><span class="hyp-type"><b>: </b><span>composite_state IM</span></span></span><br><span><var>Hs'</var><span class="hyp-type"><b>: </b><span>valid_state_prop RFree s&#39;</span></span></span><br><span><var>idx</var><span class="hyp-type"><b>: </b><span>index</span></span></span><br><span><var>indices</var><span class="hyp-type"><b>: </b><span>list index</span></span></span><br><span><var>j</var><span class="hyp-type"><b>: </b><span>index</span></span></span><br><span><var>nj</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>Hdestruct</var><span class="hyp-type"><b>: </b><span>composite_state_destructor s&#39; (j, nj).<span class="mi">1</span> =
[]</span></span></span><br><span><var>Hj</var><span class="hyp-type"><b>: </b><span>(j, nj).<span class="mi">1</span> ‚àà idx :: indices</span></span></span><br><span><var>is</var><span class="hyp-type"><b>: </b><span>composite_state IM</span></span></span><br><span><var>tr</var><span class="hyp-type"><b>: </b><span>list (composite_transition_item IM)</span></span></span><br><span><var>Hind</var><span class="hyp-type"><b>: </b><span>choosing_well choose
‚Üí NoDup
    (StdppListSet.set_remove 
       (j, nj).<span class="mi">1</span> (idx :: indices))
  ‚Üí not_in_indices_initial_prop s&#39;
      (StdppListSet.set_remove 
         (j, nj).<span class="mi">1</span> (idx :: indices))
    ‚Üí <span class="kr">‚àÄ</span> (<span class="nv">is0</span> : composite_state IM) 
        (<span class="nv">tr0</span> : list
                 (composite_transition_item IM)),
        (<span class="kr">is</span>, tr) = (is0, tr0)
        ‚Üí <span class="kr">‚àÄ</span> <span class="nv">i</span> : index,
            i
            ‚àà StdppListSet.set_remove 
                (j, nj).<span class="mi">1</span> 
                (idx :: indices)
            ‚Üí vinitial_state_prop 
                (IM i) 
                (is0 i)</span></span></span><br><span><var>Hchoose</var><span class="hyp-type"><b>: </b><span>choosing_well choose</span></span></span><br><span><var>Hnodup</var><span class="hyp-type"><b>: </b><span>NoDup (idx :: indices)</span></span></span><br><span><var>Hinitial</var><span class="hyp-type"><b>: </b><span>not_in_indices_initial_prop s&#39;
  (idx :: indices)</span></span></span><br><span><var>Heqis_tr</var><span class="hyp-type"><b>: </b><span>indexed_composite_state_to_trace choose s&#39;
  Hs&#39;
  (StdppListSet.set_remove 
     (j, nj).<span class="mi">1</span> (idx :: indices)) = 
(<span class="kr">is</span>, tr)</span></span></span><br><span><var>i</var><span class="hyp-type"><b>: </b><span>index</span></span></span><br><span><var>Hi</var><span class="hyp-type"><b>: </b><span>i ‚àà idx :: indices</span></span></span><br><span><var>e</var><span class="hyp-type"><b>: </b><span>i
‚àà StdppListSet.set_remove 
    (j, nj).<span class="mi">1</span> (idx :: indices)</span></span></span><br></div><label class="goal-separator" for="TraceableVLSM-v-chkb4"><hr></label><div class="goal-conclusion">not_in_indices_initial_prop s&#39;
  (StdppListSet.set_remove (j, nj).<span class="mi">1</span> (idx :: indices))</div></blockquote></div></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">      </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="TraceableVLSM-v-chkb5" style="display: none" type="checkbox"><label class="alectryon-input" for="TraceableVLSM-v-chkb5">*</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>message, index</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>EqDecision0</var><span class="hyp-type"><b>: </b><span>EqDecision index</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>finite.Finite index</span></span></span><br><span><var>IM</var><span class="hyp-type"><b>: </b><span>index ‚Üí VLSM message</span></span></span><br><span><var>state_destructor</var><span class="hyp-type"><b>: </b><span><span class="kr">‚àÄ</span> <span class="nv">i</span> : index,
  vstate (IM i)
  ‚Üí list
      (vtransition_item (IM i) *
       vstate (IM i))</span></span></span><br><span><var>state_size</var><span class="hyp-type"><b>: </b><span><span class="kr">‚àÄ</span> <span class="nv">i</span> : index, vstate (IM i) ‚Üí nat</span></span></span><br><span><var>H0</var><span class="hyp-type"><b>: </b><span><span class="kr">‚àÄ</span> <span class="nv">i</span> : index,
  TraceableVLSM (IM i) 
    (state_destructor i) 
    (state_size i)</span></span></span><br><span><var>Free</var><span><span class="hyp-body"><b>:= </b><span>free_composite_vlsm IM</span></span><span class="hyp-type"><b>: </b><span>VLSM message</span></span></span></span><br><span><var>RFree</var><span><span class="hyp-body"><b>:= </b><span>pre_loaded_with_all_messages_vlsm Free</span></span><span class="hyp-type"><b>: </b><span>VLSM message</span></span></span></span><br><span><var>choose</var><span class="hyp-type"><b>: </b><span>choice_function</span></span></span><br><span><var>s'</var><span class="hyp-type"><b>: </b><span>composite_state IM</span></span></span><br><span><var>Hs'</var><span class="hyp-type"><b>: </b><span>valid_state_prop RFree s&#39;</span></span></span><br><span><var>idx</var><span class="hyp-type"><b>: </b><span>index</span></span></span><br><span><var>indices</var><span class="hyp-type"><b>: </b><span>list index</span></span></span><br><span><var>j</var><span class="hyp-type"><b>: </b><span>index</span></span></span><br><span><var>nj</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>Hdestruct</var><span class="hyp-type"><b>: </b><span>composite_state_destructor s&#39; (j, nj).<span class="mi">1</span> =
[]</span></span></span><br><span><var>Hj</var><span class="hyp-type"><b>: </b><span>(j, nj).<span class="mi">1</span> ‚àà idx :: indices</span></span></span><br><span><var>is</var><span class="hyp-type"><b>: </b><span>composite_state IM</span></span></span><br><span><var>tr</var><span class="hyp-type"><b>: </b><span>list (composite_transition_item IM)</span></span></span><br><span><var>Hind</var><span class="hyp-type"><b>: </b><span>choosing_well choose
‚Üí NoDup
    (StdppListSet.set_remove 
       (j, nj).<span class="mi">1</span> (idx :: indices))
  ‚Üí not_in_indices_initial_prop s&#39;
      (StdppListSet.set_remove 
         (j, nj).<span class="mi">1</span> (idx :: indices))
    ‚Üí <span class="kr">‚àÄ</span> (<span class="nv">is0</span> : composite_state IM) 
        (<span class="nv">tr0</span> : list
                 (composite_transition_item IM)),
        (<span class="kr">is</span>, tr) = (is0, tr0)
        ‚Üí <span class="kr">‚àÄ</span> <span class="nv">i</span> : index,
            i
            ‚àà StdppListSet.set_remove 
                (j, nj).<span class="mi">1</span> 
                (idx :: indices)
            ‚Üí vinitial_state_prop 
                (IM i) 
                (is0 i)</span></span></span><br><span><var>Hchoose</var><span class="hyp-type"><b>: </b><span>choosing_well choose</span></span></span><br><span><var>Hnodup</var><span class="hyp-type"><b>: </b><span>NoDup (idx :: indices)</span></span></span><br><span><var>Hinitial</var><span class="hyp-type"><b>: </b><span>not_in_indices_initial_prop s&#39;
  (idx :: indices)</span></span></span><br><span><var>Heqis_tr</var><span class="hyp-type"><b>: </b><span>indexed_composite_state_to_trace choose s&#39;
  Hs&#39;
  (StdppListSet.set_remove 
     (j, nj).<span class="mi">1</span> (idx :: indices)) = 
(<span class="kr">is</span>, tr)</span></span></span><br><span><var>i</var><span class="hyp-type"><b>: </b><span>index</span></span></span><br><span><var>Hi</var><span class="hyp-type"><b>: </b><span>i ‚àà idx :: indices</span></span></span><br><span><var>e</var><span class="hyp-type"><b>: </b><span>i
‚àà StdppListSet.set_remove 
    (j, nj).<span class="mi">1</span> (idx :: indices)</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">NoDup
  (StdppListSet.set_remove (j, nj).<span class="mi">1</span> (idx :: indices))</div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="bp">by</span> <span class="nb">apply</span> StdppListSet.set_remove_nodup.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">      </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="TraceableVLSM-v-chkb6" style="display: none" type="checkbox"><label class="alectryon-input" for="TraceableVLSM-v-chkb6">*</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>message, index</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>EqDecision0</var><span class="hyp-type"><b>: </b><span>EqDecision index</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>finite.Finite index</span></span></span><br><span><var>IM</var><span class="hyp-type"><b>: </b><span>index ‚Üí VLSM message</span></span></span><br><span><var>state_destructor</var><span class="hyp-type"><b>: </b><span><span class="kr">‚àÄ</span> <span class="nv">i</span> : index,
  vstate (IM i)
  ‚Üí list
      (vtransition_item (IM i) *
       vstate (IM i))</span></span></span><br><span><var>state_size</var><span class="hyp-type"><b>: </b><span><span class="kr">‚àÄ</span> <span class="nv">i</span> : index, vstate (IM i) ‚Üí nat</span></span></span><br><span><var>H0</var><span class="hyp-type"><b>: </b><span><span class="kr">‚àÄ</span> <span class="nv">i</span> : index,
  TraceableVLSM (IM i) 
    (state_destructor i) 
    (state_size i)</span></span></span><br><span><var>Free</var><span><span class="hyp-body"><b>:= </b><span>free_composite_vlsm IM</span></span><span class="hyp-type"><b>: </b><span>VLSM message</span></span></span></span><br><span><var>RFree</var><span><span class="hyp-body"><b>:= </b><span>pre_loaded_with_all_messages_vlsm Free</span></span><span class="hyp-type"><b>: </b><span>VLSM message</span></span></span></span><br><span><var>choose</var><span class="hyp-type"><b>: </b><span>choice_function</span></span></span><br><span><var>s'</var><span class="hyp-type"><b>: </b><span>composite_state IM</span></span></span><br><span><var>Hs'</var><span class="hyp-type"><b>: </b><span>valid_state_prop RFree s&#39;</span></span></span><br><span><var>idx</var><span class="hyp-type"><b>: </b><span>index</span></span></span><br><span><var>indices</var><span class="hyp-type"><b>: </b><span>list index</span></span></span><br><span><var>j</var><span class="hyp-type"><b>: </b><span>index</span></span></span><br><span><var>nj</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>Hdestruct</var><span class="hyp-type"><b>: </b><span>composite_state_destructor s&#39; (j, nj).<span class="mi">1</span> =
[]</span></span></span><br><span><var>Hj</var><span class="hyp-type"><b>: </b><span>(j, nj).<span class="mi">1</span> ‚àà idx :: indices</span></span></span><br><span><var>is</var><span class="hyp-type"><b>: </b><span>composite_state IM</span></span></span><br><span><var>tr</var><span class="hyp-type"><b>: </b><span>list (composite_transition_item IM)</span></span></span><br><span><var>Hind</var><span class="hyp-type"><b>: </b><span>choosing_well choose
‚Üí NoDup
    (StdppListSet.set_remove 
       (j, nj).<span class="mi">1</span> (idx :: indices))
  ‚Üí not_in_indices_initial_prop s&#39;
      (StdppListSet.set_remove 
         (j, nj).<span class="mi">1</span> (idx :: indices))
    ‚Üí <span class="kr">‚àÄ</span> (<span class="nv">is0</span> : composite_state IM) 
        (<span class="nv">tr0</span> : list
                 (composite_transition_item IM)),
        (<span class="kr">is</span>, tr) = (is0, tr0)
        ‚Üí <span class="kr">‚àÄ</span> <span class="nv">i</span> : index,
            i
            ‚àà StdppListSet.set_remove 
                (j, nj).<span class="mi">1</span> 
                (idx :: indices)
            ‚Üí vinitial_state_prop 
                (IM i) 
                (is0 i)</span></span></span><br><span><var>Hchoose</var><span class="hyp-type"><b>: </b><span>choosing_well choose</span></span></span><br><span><var>Hnodup</var><span class="hyp-type"><b>: </b><span>NoDup (idx :: indices)</span></span></span><br><span><var>Hinitial</var><span class="hyp-type"><b>: </b><span>not_in_indices_initial_prop s&#39;
  (idx :: indices)</span></span></span><br><span><var>Heqis_tr</var><span class="hyp-type"><b>: </b><span>indexed_composite_state_to_trace choose s&#39;
  Hs&#39;
  (StdppListSet.set_remove 
     (j, nj).<span class="mi">1</span> (idx :: indices)) = 
(<span class="kr">is</span>, tr)</span></span></span><br><span><var>i</var><span class="hyp-type"><b>: </b><span>index</span></span></span><br><span><var>Hi</var><span class="hyp-type"><b>: </b><span>i ‚àà idx :: indices</span></span></span><br><span><var>e</var><span class="hyp-type"><b>: </b><span>i
‚àà StdppListSet.set_remove 
    (j, nj).<span class="mi">1</span> (idx :: indices)</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">not_in_indices_initial_prop s&#39;
  (StdppListSet.set_remove (j, nj).<span class="mi">1</span> (idx :: indices))</div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="bp">by</span> <span class="nb">apply</span> set_remove_preserves_not_in_indices_initial.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="TraceableVLSM-v-chkb7" style="display: none" type="checkbox"><label class="alectryon-input" for="TraceableVLSM-v-chkb7">+</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>message, index</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>EqDecision0</var><span class="hyp-type"><b>: </b><span>EqDecision index</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>finite.Finite index</span></span></span><br><span><var>IM</var><span class="hyp-type"><b>: </b><span>index ‚Üí VLSM message</span></span></span><br><span><var>state_destructor</var><span class="hyp-type"><b>: </b><span><span class="kr">‚àÄ</span> <span class="nv">i</span> : index,
  vstate (IM i)
  ‚Üí list
      (vtransition_item (IM i) *
       vstate (IM i))</span></span></span><br><span><var>state_size</var><span class="hyp-type"><b>: </b><span><span class="kr">‚àÄ</span> <span class="nv">i</span> : index, vstate (IM i) ‚Üí nat</span></span></span><br><span><var>H0</var><span class="hyp-type"><b>: </b><span><span class="kr">‚àÄ</span> <span class="nv">i</span> : index,
  TraceableVLSM (IM i) 
    (state_destructor i) 
    (state_size i)</span></span></span><br><span><var>Free</var><span><span class="hyp-body"><b>:= </b><span>free_composite_vlsm IM</span></span><span class="hyp-type"><b>: </b><span>VLSM message</span></span></span></span><br><span><var>RFree</var><span><span class="hyp-body"><b>:= </b><span>pre_loaded_with_all_messages_vlsm Free</span></span><span class="hyp-type"><b>: </b><span>VLSM message</span></span></span></span><br><span><var>choose</var><span class="hyp-type"><b>: </b><span>choice_function</span></span></span><br><span><var>s'</var><span class="hyp-type"><b>: </b><span>composite_state IM</span></span></span><br><span><var>Hs'</var><span class="hyp-type"><b>: </b><span>valid_state_prop RFree s&#39;</span></span></span><br><span><var>idx</var><span class="hyp-type"><b>: </b><span>index</span></span></span><br><span><var>indices</var><span class="hyp-type"><b>: </b><span>list index</span></span></span><br><span><var>j</var><span class="hyp-type"><b>: </b><span>index</span></span></span><br><span><var>nj</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>Hdestruct</var><span class="hyp-type"><b>: </b><span>composite_state_destructor s&#39; (j, nj).<span class="mi">1</span> =
[]</span></span></span><br><span><var>Hj</var><span class="hyp-type"><b>: </b><span>(j, nj).<span class="mi">1</span> ‚àà idx :: indices</span></span></span><br><span><var>is</var><span class="hyp-type"><b>: </b><span>composite_state IM</span></span></span><br><span><var>tr</var><span class="hyp-type"><b>: </b><span>list (composite_transition_item IM)</span></span></span><br><span><var>removed</var><span class="hyp-type"><b>: </b><span>StdppListSet.<span class="nb">set</span> index</span></span></span><br><span><var>Heqremoved</var><span class="hyp-type"><b>: </b><span>removed =
StdppListSet.set_remove 
  (j, nj).<span class="mi">1</span> (idx :: indices)</span></span></span><br><span><var>Hind</var><span class="hyp-type"><b>: </b><span>choosing_well choose
‚Üí NoDup removed
  ‚Üí not_in_indices_initial_prop s&#39; removed
    ‚Üí <span class="kr">‚àÄ</span> (<span class="nv">is0</span> : composite_state IM) 
        (<span class="nv">tr0</span> : list
                 (composite_transition_item IM)),
        (<span class="kr">is</span>, tr) = (is0, tr0)
        ‚Üí <span class="kr">‚àÄ</span> <span class="nv">i</span> : index,
            i ‚àà removed
            ‚Üí vinitial_state_prop 
                (IM i) 
                (is0 i)</span></span></span><br><span><var>Hchoose</var><span class="hyp-type"><b>: </b><span>choosing_well choose</span></span></span><br><span><var>Hnodup</var><span class="hyp-type"><b>: </b><span>NoDup (idx :: indices)</span></span></span><br><span><var>Hinitial</var><span class="hyp-type"><b>: </b><span>not_in_indices_initial_prop s&#39;
  (idx :: indices)</span></span></span><br><span><var>Heqis_tr</var><span class="hyp-type"><b>: </b><span>indexed_composite_state_to_trace choose s&#39;
  Hs&#39; removed = (<span class="kr">is</span>, tr)</span></span></span><br><span><var>i</var><span class="hyp-type"><b>: </b><span>index</span></span></span><br><span><var>Hi</var><span class="hyp-type"><b>: </b><span>i ‚àà idx :: indices</span></span></span><br><span><var>n</var><span class="hyp-type"><b>: </b><span>i ‚àâ removed</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">vinitial_state_prop (IM i) (<span class="kr">is</span> i)</div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="TraceableVLSM-v-chkb8" style="display: none" type="checkbox"><label class="alectryon-input" for="TraceableVLSM-v-chkb8"><span class="nb">replace</span> i <span class="kr">with</span> j <span class="kr">in</span> *
        <span class="bp">by</span> (<span class="nb">destruct</span> (decide (i = j)); [| <span class="bp">contradict</span> n; <span class="nb">subst</span>; <span class="nb">apply</span> StdppListSet.set_remove_3]; <span class="bp">done</span>).</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>message, index</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>EqDecision0</var><span class="hyp-type"><b>: </b><span>EqDecision index</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>finite.Finite index</span></span></span><br><span><var>IM</var><span class="hyp-type"><b>: </b><span>index ‚Üí VLSM message</span></span></span><br><span><var>state_destructor</var><span class="hyp-type"><b>: </b><span><span class="kr">‚àÄ</span> <span class="nv">i</span> : index,
  vstate (IM i)
  ‚Üí list
      (vtransition_item (IM i) *
       vstate (IM i))</span></span></span><br><span><var>state_size</var><span class="hyp-type"><b>: </b><span><span class="kr">‚àÄ</span> <span class="nv">i</span> : index, vstate (IM i) ‚Üí nat</span></span></span><br><span><var>H0</var><span class="hyp-type"><b>: </b><span><span class="kr">‚àÄ</span> <span class="nv">i</span> : index,
  TraceableVLSM (IM i) 
    (state_destructor i) 
    (state_size i)</span></span></span><br><span><var>Free</var><span><span class="hyp-body"><b>:= </b><span>free_composite_vlsm IM</span></span><span class="hyp-type"><b>: </b><span>VLSM message</span></span></span></span><br><span><var>RFree</var><span><span class="hyp-body"><b>:= </b><span>pre_loaded_with_all_messages_vlsm Free</span></span><span class="hyp-type"><b>: </b><span>VLSM message</span></span></span></span><br><span><var>choose</var><span class="hyp-type"><b>: </b><span>choice_function</span></span></span><br><span><var>s'</var><span class="hyp-type"><b>: </b><span>composite_state IM</span></span></span><br><span><var>Hs'</var><span class="hyp-type"><b>: </b><span>valid_state_prop RFree s&#39;</span></span></span><br><span><var>idx</var><span class="hyp-type"><b>: </b><span>index</span></span></span><br><span><var>indices</var><span class="hyp-type"><b>: </b><span>list index</span></span></span><br><span><var>j</var><span class="hyp-type"><b>: </b><span>index</span></span></span><br><span><var>nj</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>Hdestruct</var><span class="hyp-type"><b>: </b><span>composite_state_destructor s&#39; (j, nj).<span class="mi">1</span> =
[]</span></span></span><br><span><var>Hj</var><span class="hyp-type"><b>: </b><span>(j, nj).<span class="mi">1</span> ‚àà idx :: indices</span></span></span><br><span><var>is</var><span class="hyp-type"><b>: </b><span>composite_state IM</span></span></span><br><span><var>tr</var><span class="hyp-type"><b>: </b><span>list (composite_transition_item IM)</span></span></span><br><span><var>removed</var><span class="hyp-type"><b>: </b><span>StdppListSet.<span class="nb">set</span> index</span></span></span><br><span><var>Heqremoved</var><span class="hyp-type"><b>: </b><span>removed =
StdppListSet.set_remove 
  (j, nj).<span class="mi">1</span> (idx :: indices)</span></span></span><br><span><var>Hind</var><span class="hyp-type"><b>: </b><span>choosing_well choose
‚Üí NoDup removed
  ‚Üí not_in_indices_initial_prop s&#39; removed
    ‚Üí <span class="kr">‚àÄ</span> (<span class="nv">is0</span> : composite_state IM) 
        (<span class="nv">tr0</span> : list
                 (composite_transition_item IM)),
        (<span class="kr">is</span>, tr) = (is0, tr0)
        ‚Üí <span class="kr">‚àÄ</span> <span class="nv">i</span> : index,
            i ‚àà removed
            ‚Üí vinitial_state_prop 
                (IM i) 
                (is0 i)</span></span></span><br><span><var>Hchoose</var><span class="hyp-type"><b>: </b><span>choosing_well choose</span></span></span><br><span><var>Hnodup</var><span class="hyp-type"><b>: </b><span>NoDup (idx :: indices)</span></span></span><br><span><var>Hinitial</var><span class="hyp-type"><b>: </b><span>not_in_indices_initial_prop s&#39;
  (idx :: indices)</span></span></span><br><span><var>Heqis_tr</var><span class="hyp-type"><b>: </b><span>indexed_composite_state_to_trace choose s&#39;
  Hs&#39; removed = (<span class="kr">is</span>, tr)</span></span></span><br><span><var>i</var><span class="hyp-type"><b>: </b><span>index</span></span></span><br><span><var>Hi</var><span class="hyp-type"><b>: </b><span>j ‚àà idx :: indices</span></span></span><br><span><var>n</var><span class="hyp-type"><b>: </b><span>j ‚àâ removed</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">vinitial_state_prop (IM j) (<span class="kr">is</span> j)</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">      </span><span class="alectryon-sentence"><span class="alectryon-input"><span class="bp">by</span> <span class="nb">erewrite</span> indexed_composite_state_to_trace_reflects_initiality_1;
        [..| <span class="bp">done</span>]; <span class="nb">apply</span> composite_tv_state_destructor_initial.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="TraceableVLSM-v-chkb9" style="display: none" type="checkbox"><label class="alectryon-input" for="TraceableVLSM-v-chkb9">-</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>message, index</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>EqDecision0</var><span class="hyp-type"><b>: </b><span>EqDecision index</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>finite.Finite index</span></span></span><br><span><var>IM</var><span class="hyp-type"><b>: </b><span>index ‚Üí VLSM message</span></span></span><br><span><var>state_destructor</var><span class="hyp-type"><b>: </b><span><span class="kr">‚àÄ</span> <span class="nv">i</span> : index,
  vstate (IM i)
  ‚Üí list
      (vtransition_item (IM i) *
       vstate (IM i))</span></span></span><br><span><var>state_size</var><span class="hyp-type"><b>: </b><span><span class="kr">‚àÄ</span> <span class="nv">i</span> : index, vstate (IM i) ‚Üí nat</span></span></span><br><span><var>H0</var><span class="hyp-type"><b>: </b><span><span class="kr">‚àÄ</span> <span class="nv">i</span> : index,
  TraceableVLSM (IM i) 
    (state_destructor i) 
    (state_size i)</span></span></span><br><span><var>Free</var><span><span class="hyp-body"><b>:= </b><span>free_composite_vlsm IM</span></span><span class="hyp-type"><b>: </b><span>VLSM message</span></span></span></span><br><span><var>RFree</var><span><span class="hyp-body"><b>:= </b><span>pre_loaded_with_all_messages_vlsm Free</span></span><span class="hyp-type"><b>: </b><span>VLSM message</span></span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="kr">‚àÄ</span> (<span class="nv">choose</span> : choice_function) (<span class="nv">s&#39;</span> : composite_state IM) 
  (<span class="nv">Hs&#39;</span> : valid_state_prop RFree s&#39;) (<span class="nv">i</span> : index) (<span class="nv">l0</span> : 
                                                 list
                                                 index) 
  (<span class="nv">i_n</span> : index * nat) (<span class="nv">n</span> : composite_state_destructor
                             s&#39; i_n.<span class="mi">1</span> ‚â† []) (<span class="nv">Hn</span> : 
                                             decide
                                               (composite_state_destructor
                                                 s&#39;
                                                 i_n.<span class="mi">1</span> =
                                                []) =
                                             <span class="nb">right</span> n) 
  (<span class="nv">e0</span> : i_n.<span class="mi">1</span> ‚àà i :: l0) (<span class="nv">Hi</span> : decide
                                 (i_n.<span class="mi">1</span> ‚àà i :: l0) =
                               <span class="nb">left</span> e0) (<span class="nv">Hdestruct</span> : 
                                         composite_state_destructor
                                           s&#39; i_n.<span class="mi">1</span>
                                         !! i_n.<span class="mi">2</span> =
                                         None) (<span class="nv">Hchoice</span> : 
                                                choose
                                                 s&#39;
                                                 Hs&#39;
                                                 (i
                                                 :: l0) =
                                                i_n),
  inspect
    (decide (composite_state_destructor s&#39; i_n.<span class="mi">1</span> = [])) =
  <span class="nb">right</span> n ‚Üæ Hn
  ‚Üí inspect (decide (i_n.<span class="mi">1</span> ‚àà i :: l0)) = <span class="nb">left</span> e0 ‚Üæ Hi
    ‚Üí inspect
        (composite_state_destructor s&#39; i_n.<span class="mi">1</span> !! i_n.<span class="mi">2</span>) =
      None ‚Üæ Hdestruct
      ‚Üí inspect (choose s&#39; Hs&#39; (i :: l0)) =
        i_n ‚Üæ Hchoice
        ‚Üí choosing_well choose
          ‚Üí NoDup (i :: l0)
            ‚Üí not_in_indices_initial_prop s&#39; (i :: l0)
              ‚Üí <span class="kr">‚àÄ</span> (<span class="nv">is</span> : composite_state IM) (<span class="nv">tr</span> : 
                                             list
                                               (composite_transition_item
                                                 IM)),
                  (s&#39;, []) = (<span class="kr">is</span>, tr)
                  ‚Üí <span class="kr">‚àÄ</span> <span class="nv">i0</span> : index,
                      i0 ‚àà i :: l0
                      ‚Üí vinitial_state_prop (IM i0)
                          (<span class="kr">is</span> i0)</div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="bp">by</span> <span class="nb">intros</span>; <span class="nb">subst</span>; <span class="nb">clear</span> Heq1; <span class="bp">contradict</span> Hdestruct;
      <span class="nb">eapply</span> choosing_well_position_exists; [<span class="nb">apply</span> Hchoose |].</span><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Qed</span>.</span></span></pre><div class="doc">
  Assuming <span class="inlinecode"><span class="id" title="var">not_in_indices_initial_prop</span></span>, the origin state of the
  trace given by <span class="inlinecode"><span class="id" title="var">indexed_composite_state_to_trace</span></span> is initial.

</div><pre class="alectryon-io highlight"><!-- Generator: Alectryon --><span class="alectryon-sentence"><input class="alectryon-toggle" id="TraceableVLSM-v-chkba" style="display: none" type="checkbox"><label class="alectryon-input" for="TraceableVLSM-v-chkba"><span class="kn">Lemma</span> <span class="nf">indexed_composite_state_to_trace_result_state_is_initial</span> :
  <span class="kr">forall</span> (<span class="nv">choose</span> : choice_function), choosing_well choose -&gt;
  <span class="kr">forall</span> (<span class="nv">s</span> : composite_state IM) (<span class="nv">Hs</span> : valid_state_prop RFree s),
  <span class="kr">forall</span> (<span class="nv">indices</span> : list index), NoDup indices -&gt;
    not_in_indices_initial_prop s indices -&gt;
    <span class="kr">forall</span> <span class="nv">is</span> <span class="nv">tr</span>, indexed_composite_state_to_trace choose s Hs indices = (<span class="kr">is</span>, tr) -&gt;
    composite_initial_state_prop IM <span class="kr">is</span>.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>message, index</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>EqDecision0</var><span class="hyp-type"><b>: </b><span>EqDecision index</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>finite.Finite index</span></span></span><br><span><var>IM</var><span class="hyp-type"><b>: </b><span>index ‚Üí VLSM message</span></span></span><br><span><var>state_destructor</var><span class="hyp-type"><b>: </b><span><span class="kr">‚àÄ</span> <span class="nv">i</span> : index,
  vstate (IM i)
  ‚Üí list
      (vtransition_item (IM i) *
       vstate (IM i))</span></span></span><br><span><var>state_size</var><span class="hyp-type"><b>: </b><span><span class="kr">‚àÄ</span> <span class="nv">i</span> : index, vstate (IM i) ‚Üí nat</span></span></span><br><span><var>H0</var><span class="hyp-type"><b>: </b><span><span class="kr">‚àÄ</span> <span class="nv">i</span> : index,
  TraceableVLSM (IM i) 
    (state_destructor i) 
    (state_size i)</span></span></span><br><span><var>Free</var><span><span class="hyp-body"><b>:= </b><span>free_composite_vlsm IM</span></span><span class="hyp-type"><b>: </b><span>VLSM message</span></span></span></span><br><span><var>RFree</var><span><span class="hyp-body"><b>:= </b><span>pre_loaded_with_all_messages_vlsm Free</span></span><span class="hyp-type"><b>: </b><span>VLSM message</span></span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="kr">‚àÄ</span> <span class="nv">choose</span> : choice_function,
  choosing_well choose
  ‚Üí <span class="kr">‚àÄ</span> (<span class="nv">s</span> : composite_state IM) (<span class="nv">Hs</span> : valid_state_prop
                                       RFree s) (<span class="nv">indices</span> : 
                                                 list
                                                 index),
      NoDup indices
      ‚Üí not_in_indices_initial_prop s indices
        ‚Üí <span class="kr">‚àÄ</span> (<span class="nv">is</span> : composite_state IM) (<span class="nv">tr</span> : list
                                              (composite_transition_item
                                                 IM)),
            indexed_composite_state_to_trace choose s
              Hs indices = (<span class="kr">is</span>, tr)
            ‚Üí composite_initial_state_prop IM <span class="kr">is</span></div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="TraceableVLSM-v-chkbb" style="display: none" type="checkbox"><label class="alectryon-input" for="TraceableVLSM-v-chkbb"><span class="kn">Proof</span>.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>message, index</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>EqDecision0</var><span class="hyp-type"><b>: </b><span>EqDecision index</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>finite.Finite index</span></span></span><br><span><var>IM</var><span class="hyp-type"><b>: </b><span>index ‚Üí VLSM message</span></span></span><br><span><var>state_destructor</var><span class="hyp-type"><b>: </b><span><span class="kr">‚àÄ</span> <span class="nv">i</span> : index,
  vstate (IM i)
  ‚Üí list
      (vtransition_item (IM i) *
       vstate (IM i))</span></span></span><br><span><var>state_size</var><span class="hyp-type"><b>: </b><span><span class="kr">‚àÄ</span> <span class="nv">i</span> : index, vstate (IM i) ‚Üí nat</span></span></span><br><span><var>H0</var><span class="hyp-type"><b>: </b><span><span class="kr">‚àÄ</span> <span class="nv">i</span> : index,
  TraceableVLSM (IM i) 
    (state_destructor i) 
    (state_size i)</span></span></span><br><span><var>Free</var><span><span class="hyp-body"><b>:= </b><span>free_composite_vlsm IM</span></span><span class="hyp-type"><b>: </b><span>VLSM message</span></span></span></span><br><span><var>RFree</var><span><span class="hyp-body"><b>:= </b><span>pre_loaded_with_all_messages_vlsm Free</span></span><span class="hyp-type"><b>: </b><span>VLSM message</span></span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="kr">‚àÄ</span> <span class="nv">choose</span> : choice_function,
  choosing_well choose
  ‚Üí <span class="kr">‚àÄ</span> (<span class="nv">s</span> : composite_state IM) (<span class="nv">Hs</span> : valid_state_prop
                                       RFree s) (<span class="nv">indices</span> : 
                                                 list
                                                 index),
      NoDup indices
      ‚Üí not_in_indices_initial_prop s indices
        ‚Üí <span class="kr">‚àÄ</span> (<span class="nv">is</span> : composite_state IM) (<span class="nv">tr</span> : list
                                              (composite_transition_item
                                                 IM)),
            indexed_composite_state_to_trace choose s
              Hs indices = (<span class="kr">is</span>, tr)
            ‚Üí composite_initial_state_prop IM <span class="kr">is</span></div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="TraceableVLSM-v-chkbc" style="display: none" type="checkbox"><label class="alectryon-input" for="TraceableVLSM-v-chkbc"><span class="nb">intros</span> * ? ? ? ? ? Hinitial ** i.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>message, index</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>EqDecision0</var><span class="hyp-type"><b>: </b><span>EqDecision index</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>finite.Finite index</span></span></span><br><span><var>IM</var><span class="hyp-type"><b>: </b><span>index ‚Üí VLSM message</span></span></span><br><span><var>state_destructor</var><span class="hyp-type"><b>: </b><span><span class="kr">‚àÄ</span> <span class="nv">i</span> : index,
  vstate (IM i)
  ‚Üí list
      (vtransition_item (IM i) *
       vstate (IM i))</span></span></span><br><span><var>state_size</var><span class="hyp-type"><b>: </b><span><span class="kr">‚àÄ</span> <span class="nv">i</span> : index, vstate (IM i) ‚Üí nat</span></span></span><br><span><var>H0</var><span class="hyp-type"><b>: </b><span><span class="kr">‚àÄ</span> <span class="nv">i</span> : index,
  TraceableVLSM (IM i) 
    (state_destructor i) 
    (state_size i)</span></span></span><br><span><var>Free</var><span><span class="hyp-body"><b>:= </b><span>free_composite_vlsm IM</span></span><span class="hyp-type"><b>: </b><span>VLSM message</span></span></span></span><br><span><var>RFree</var><span><span class="hyp-body"><b>:= </b><span>pre_loaded_with_all_messages_vlsm Free</span></span><span class="hyp-type"><b>: </b><span>VLSM message</span></span></span></span><br><span><var>choose</var><span class="hyp-type"><b>: </b><span>choice_function</span></span></span><br><span><var>H1</var><span class="hyp-type"><b>: </b><span>choosing_well choose</span></span></span><br><span><var>s</var><span class="hyp-type"><b>: </b><span>composite_state IM</span></span></span><br><span><var>Hs</var><span class="hyp-type"><b>: </b><span>valid_state_prop RFree s</span></span></span><br><span><var>indices</var><span class="hyp-type"><b>: </b><span>list index</span></span></span><br><span><var>H2</var><span class="hyp-type"><b>: </b><span>NoDup indices</span></span></span><br><span><var>Hinitial</var><span class="hyp-type"><b>: </b><span>not_in_indices_initial_prop s indices</span></span></span><br><span><var>is</var><span class="hyp-type"><b>: </b><span>composite_state IM</span></span></span><br><span><var>tr</var><span class="hyp-type"><b>: </b><span>list (composite_transition_item IM)</span></span></span><br><span><var>H3</var><span class="hyp-type"><b>: </b><span>indexed_composite_state_to_trace choose s Hs
  indices = (<span class="kr">is</span>, tr)</span></span></span><br><span><var>i</var><span class="hyp-type"><b>: </b><span>index</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">vinitial_state_prop (IM i) (<span class="kr">is</span> i)</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="TraceableVLSM-v-chkbd" style="display: none" type="checkbox"><label class="alectryon-input" for="TraceableVLSM-v-chkbd"><span class="nb">destruct</span> (decide (i ‚àà indices)).</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>message, index</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>EqDecision0</var><span class="hyp-type"><b>: </b><span>EqDecision index</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>finite.Finite index</span></span></span><br><span><var>IM</var><span class="hyp-type"><b>: </b><span>index ‚Üí VLSM message</span></span></span><br><span><var>state_destructor</var><span class="hyp-type"><b>: </b><span><span class="kr">‚àÄ</span> <span class="nv">i</span> : index,
  vstate (IM i)
  ‚Üí list
      (vtransition_item (IM i) *
       vstate (IM i))</span></span></span><br><span><var>state_size</var><span class="hyp-type"><b>: </b><span><span class="kr">‚àÄ</span> <span class="nv">i</span> : index, vstate (IM i) ‚Üí nat</span></span></span><br><span><var>H0</var><span class="hyp-type"><b>: </b><span><span class="kr">‚àÄ</span> <span class="nv">i</span> : index,
  TraceableVLSM (IM i) 
    (state_destructor i) 
    (state_size i)</span></span></span><br><span><var>Free</var><span><span class="hyp-body"><b>:= </b><span>free_composite_vlsm IM</span></span><span class="hyp-type"><b>: </b><span>VLSM message</span></span></span></span><br><span><var>RFree</var><span><span class="hyp-body"><b>:= </b><span>pre_loaded_with_all_messages_vlsm Free</span></span><span class="hyp-type"><b>: </b><span>VLSM message</span></span></span></span><br><span><var>choose</var><span class="hyp-type"><b>: </b><span>choice_function</span></span></span><br><span><var>H1</var><span class="hyp-type"><b>: </b><span>choosing_well choose</span></span></span><br><span><var>s</var><span class="hyp-type"><b>: </b><span>composite_state IM</span></span></span><br><span><var>Hs</var><span class="hyp-type"><b>: </b><span>valid_state_prop RFree s</span></span></span><br><span><var>indices</var><span class="hyp-type"><b>: </b><span>list index</span></span></span><br><span><var>H2</var><span class="hyp-type"><b>: </b><span>NoDup indices</span></span></span><br><span><var>Hinitial</var><span class="hyp-type"><b>: </b><span>not_in_indices_initial_prop s indices</span></span></span><br><span><var>is</var><span class="hyp-type"><b>: </b><span>composite_state IM</span></span></span><br><span><var>tr</var><span class="hyp-type"><b>: </b><span>list (composite_transition_item IM)</span></span></span><br><span><var>H3</var><span class="hyp-type"><b>: </b><span>indexed_composite_state_to_trace choose s Hs
  indices = (<span class="kr">is</span>, tr)</span></span></span><br><span><var>i</var><span class="hyp-type"><b>: </b><span>index</span></span></span><br><span><var>e</var><span class="hyp-type"><b>: </b><span>i ‚àà indices</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">vinitial_state_prop (IM i) (<span class="kr">is</span> i)</div></blockquote><div class="alectryon-extra-goals"><input class="alectryon-extra-goal-toggle" id="TraceableVLSM-v-chkbe" style="display: none" type="checkbox"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>message, index</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>EqDecision0</var><span class="hyp-type"><b>: </b><span>EqDecision index</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>finite.Finite index</span></span></span><br><span><var>IM</var><span class="hyp-type"><b>: </b><span>index ‚Üí VLSM message</span></span></span><br><span><var>state_destructor</var><span class="hyp-type"><b>: </b><span><span class="kr">‚àÄ</span> <span class="nv">i</span> : index,
  vstate (IM i)
  ‚Üí list
      (vtransition_item (IM i) *
       vstate (IM i))</span></span></span><br><span><var>state_size</var><span class="hyp-type"><b>: </b><span><span class="kr">‚àÄ</span> <span class="nv">i</span> : index, vstate (IM i) ‚Üí nat</span></span></span><br><span><var>H0</var><span class="hyp-type"><b>: </b><span><span class="kr">‚àÄ</span> <span class="nv">i</span> : index,
  TraceableVLSM (IM i) 
    (state_destructor i) 
    (state_size i)</span></span></span><br><span><var>Free</var><span><span class="hyp-body"><b>:= </b><span>free_composite_vlsm IM</span></span><span class="hyp-type"><b>: </b><span>VLSM message</span></span></span></span><br><span><var>RFree</var><span><span class="hyp-body"><b>:= </b><span>pre_loaded_with_all_messages_vlsm Free</span></span><span class="hyp-type"><b>: </b><span>VLSM message</span></span></span></span><br><span><var>choose</var><span class="hyp-type"><b>: </b><span>choice_function</span></span></span><br><span><var>H1</var><span class="hyp-type"><b>: </b><span>choosing_well choose</span></span></span><br><span><var>s</var><span class="hyp-type"><b>: </b><span>composite_state IM</span></span></span><br><span><var>Hs</var><span class="hyp-type"><b>: </b><span>valid_state_prop RFree s</span></span></span><br><span><var>indices</var><span class="hyp-type"><b>: </b><span>list index</span></span></span><br><span><var>H2</var><span class="hyp-type"><b>: </b><span>NoDup indices</span></span></span><br><span><var>Hinitial</var><span class="hyp-type"><b>: </b><span>not_in_indices_initial_prop s indices</span></span></span><br><span><var>is</var><span class="hyp-type"><b>: </b><span>composite_state IM</span></span></span><br><span><var>tr</var><span class="hyp-type"><b>: </b><span>list (composite_transition_item IM)</span></span></span><br><span><var>H3</var><span class="hyp-type"><b>: </b><span>indexed_composite_state_to_trace choose s Hs
  indices = (<span class="kr">is</span>, tr)</span></span></span><br><span><var>i</var><span class="hyp-type"><b>: </b><span>index</span></span></span><br><span><var>n</var><span class="hyp-type"><b>: </b><span>i ‚àâ indices</span></span></span><br></div><label class="goal-separator" for="TraceableVLSM-v-chkbe"><hr></label><div class="goal-conclusion">vinitial_state_prop (IM i) (<span class="kr">is</span> i)</div></blockquote></div></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="TraceableVLSM-v-chkbf" style="display: none" type="checkbox"><label class="alectryon-input" for="TraceableVLSM-v-chkbf">-</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>message, index</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>EqDecision0</var><span class="hyp-type"><b>: </b><span>EqDecision index</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>finite.Finite index</span></span></span><br><span><var>IM</var><span class="hyp-type"><b>: </b><span>index ‚Üí VLSM message</span></span></span><br><span><var>state_destructor</var><span class="hyp-type"><b>: </b><span><span class="kr">‚àÄ</span> <span class="nv">i</span> : index,
  vstate (IM i)
  ‚Üí list
      (vtransition_item (IM i) *
       vstate (IM i))</span></span></span><br><span><var>state_size</var><span class="hyp-type"><b>: </b><span><span class="kr">‚àÄ</span> <span class="nv">i</span> : index, vstate (IM i) ‚Üí nat</span></span></span><br><span><var>H0</var><span class="hyp-type"><b>: </b><span><span class="kr">‚àÄ</span> <span class="nv">i</span> : index,
  TraceableVLSM (IM i) 
    (state_destructor i) 
    (state_size i)</span></span></span><br><span><var>Free</var><span><span class="hyp-body"><b>:= </b><span>free_composite_vlsm IM</span></span><span class="hyp-type"><b>: </b><span>VLSM message</span></span></span></span><br><span><var>RFree</var><span><span class="hyp-body"><b>:= </b><span>pre_loaded_with_all_messages_vlsm Free</span></span><span class="hyp-type"><b>: </b><span>VLSM message</span></span></span></span><br><span><var>choose</var><span class="hyp-type"><b>: </b><span>choice_function</span></span></span><br><span><var>H1</var><span class="hyp-type"><b>: </b><span>choosing_well choose</span></span></span><br><span><var>s</var><span class="hyp-type"><b>: </b><span>composite_state IM</span></span></span><br><span><var>Hs</var><span class="hyp-type"><b>: </b><span>valid_state_prop RFree s</span></span></span><br><span><var>indices</var><span class="hyp-type"><b>: </b><span>list index</span></span></span><br><span><var>H2</var><span class="hyp-type"><b>: </b><span>NoDup indices</span></span></span><br><span><var>Hinitial</var><span class="hyp-type"><b>: </b><span>not_in_indices_initial_prop s indices</span></span></span><br><span><var>is</var><span class="hyp-type"><b>: </b><span>composite_state IM</span></span></span><br><span><var>tr</var><span class="hyp-type"><b>: </b><span>list (composite_transition_item IM)</span></span></span><br><span><var>H3</var><span class="hyp-type"><b>: </b><span>indexed_composite_state_to_trace choose s Hs
  indices = (<span class="kr">is</span>, tr)</span></span></span><br><span><var>i</var><span class="hyp-type"><b>: </b><span>index</span></span></span><br><span><var>e</var><span class="hyp-type"><b>: </b><span>i ‚àà indices</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">vinitial_state_prop (IM i) (<span class="kr">is</span> i)</div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="bp">by</span> <span class="nb">eapply</span> indexed_composite_state_to_trace_result_state.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="TraceableVLSM-v-chkc0" style="display: none" type="checkbox"><label class="alectryon-input" for="TraceableVLSM-v-chkc0">-</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>message, index</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>EqDecision0</var><span class="hyp-type"><b>: </b><span>EqDecision index</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>finite.Finite index</span></span></span><br><span><var>IM</var><span class="hyp-type"><b>: </b><span>index ‚Üí VLSM message</span></span></span><br><span><var>state_destructor</var><span class="hyp-type"><b>: </b><span><span class="kr">‚àÄ</span> <span class="nv">i</span> : index,
  vstate (IM i)
  ‚Üí list
      (vtransition_item (IM i) *
       vstate (IM i))</span></span></span><br><span><var>state_size</var><span class="hyp-type"><b>: </b><span><span class="kr">‚àÄ</span> <span class="nv">i</span> : index, vstate (IM i) ‚Üí nat</span></span></span><br><span><var>H0</var><span class="hyp-type"><b>: </b><span><span class="kr">‚àÄ</span> <span class="nv">i</span> : index,
  TraceableVLSM (IM i) 
    (state_destructor i) 
    (state_size i)</span></span></span><br><span><var>Free</var><span><span class="hyp-body"><b>:= </b><span>free_composite_vlsm IM</span></span><span class="hyp-type"><b>: </b><span>VLSM message</span></span></span></span><br><span><var>RFree</var><span><span class="hyp-body"><b>:= </b><span>pre_loaded_with_all_messages_vlsm Free</span></span><span class="hyp-type"><b>: </b><span>VLSM message</span></span></span></span><br><span><var>choose</var><span class="hyp-type"><b>: </b><span>choice_function</span></span></span><br><span><var>H1</var><span class="hyp-type"><b>: </b><span>choosing_well choose</span></span></span><br><span><var>s</var><span class="hyp-type"><b>: </b><span>composite_state IM</span></span></span><br><span><var>Hs</var><span class="hyp-type"><b>: </b><span>valid_state_prop RFree s</span></span></span><br><span><var>indices</var><span class="hyp-type"><b>: </b><span>list index</span></span></span><br><span><var>H2</var><span class="hyp-type"><b>: </b><span>NoDup indices</span></span></span><br><span><var>Hinitial</var><span class="hyp-type"><b>: </b><span>not_in_indices_initial_prop s indices</span></span></span><br><span><var>is</var><span class="hyp-type"><b>: </b><span>composite_state IM</span></span></span><br><span><var>tr</var><span class="hyp-type"><b>: </b><span>list (composite_transition_item IM)</span></span></span><br><span><var>H3</var><span class="hyp-type"><b>: </b><span>indexed_composite_state_to_trace choose s Hs
  indices = (<span class="kr">is</span>, tr)</span></span></span><br><span><var>i</var><span class="hyp-type"><b>: </b><span>index</span></span></span><br><span><var>n</var><span class="hyp-type"><b>: </b><span>i ‚àâ indices</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">vinitial_state_prop (IM i) (<span class="kr">is</span> i)</div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="TraceableVLSM-v-chkc1" style="display: none" type="checkbox"><label class="alectryon-input" for="TraceableVLSM-v-chkc1"><span class="nb">assert</span> (vinitial_state_prop (IM i) (s i)) <span class="bp">by</span> (<span class="nb">apply</span> Hinitial; <span class="bp">done</span>).</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>message, index</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>EqDecision0</var><span class="hyp-type"><b>: </b><span>EqDecision index</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>finite.Finite index</span></span></span><br><span><var>IM</var><span class="hyp-type"><b>: </b><span>index ‚Üí VLSM message</span></span></span><br><span><var>state_destructor</var><span class="hyp-type"><b>: </b><span><span class="kr">‚àÄ</span> <span class="nv">i</span> : index,
  vstate (IM i)
  ‚Üí list
      (vtransition_item (IM i) *
       vstate (IM i))</span></span></span><br><span><var>state_size</var><span class="hyp-type"><b>: </b><span><span class="kr">‚àÄ</span> <span class="nv">i</span> : index, vstate (IM i) ‚Üí nat</span></span></span><br><span><var>H0</var><span class="hyp-type"><b>: </b><span><span class="kr">‚àÄ</span> <span class="nv">i</span> : index,
  TraceableVLSM (IM i) 
    (state_destructor i) 
    (state_size i)</span></span></span><br><span><var>Free</var><span><span class="hyp-body"><b>:= </b><span>free_composite_vlsm IM</span></span><span class="hyp-type"><b>: </b><span>VLSM message</span></span></span></span><br><span><var>RFree</var><span><span class="hyp-body"><b>:= </b><span>pre_loaded_with_all_messages_vlsm Free</span></span><span class="hyp-type"><b>: </b><span>VLSM message</span></span></span></span><br><span><var>choose</var><span class="hyp-type"><b>: </b><span>choice_function</span></span></span><br><span><var>H1</var><span class="hyp-type"><b>: </b><span>choosing_well choose</span></span></span><br><span><var>s</var><span class="hyp-type"><b>: </b><span>composite_state IM</span></span></span><br><span><var>Hs</var><span class="hyp-type"><b>: </b><span>valid_state_prop RFree s</span></span></span><br><span><var>indices</var><span class="hyp-type"><b>: </b><span>list index</span></span></span><br><span><var>H2</var><span class="hyp-type"><b>: </b><span>NoDup indices</span></span></span><br><span><var>Hinitial</var><span class="hyp-type"><b>: </b><span>not_in_indices_initial_prop s indices</span></span></span><br><span><var>is</var><span class="hyp-type"><b>: </b><span>composite_state IM</span></span></span><br><span><var>tr</var><span class="hyp-type"><b>: </b><span>list (composite_transition_item IM)</span></span></span><br><span><var>H3</var><span class="hyp-type"><b>: </b><span>indexed_composite_state_to_trace choose s Hs
  indices = (<span class="kr">is</span>, tr)</span></span></span><br><span><var>i</var><span class="hyp-type"><b>: </b><span>index</span></span></span><br><span><var>n</var><span class="hyp-type"><b>: </b><span>i ‚àâ indices</span></span></span><br><span><var>H4</var><span class="hyp-type"><b>: </b><span>vinitial_state_prop (IM i) (s i)</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">vinitial_state_prop (IM i) (<span class="kr">is</span> i)</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><span class="alectryon-input"><span class="bp">by</span> <span class="nb">erewrite</span> indexed_composite_state_to_trace_reflects_initiality_1.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Qed</span>.</span></span></pre><div class="doc">
  For any composite ram-state <code>s</code> and for any index <code>i</code> for which the
  component state <code>s i</code> satisfies <span class="inlinecode"><span class="id" title="var">initial_state_prop</span></span>, the component state of
  index <code>i</code> of any state of the trace extracted from <code>s</code> is equal to <code>s i</code>.

</div><pre class="alectryon-io highlight"><!-- Generator: Alectryon --><span class="alectryon-sentence"><input class="alectryon-toggle" id="TraceableVLSM-v-chkc2" style="display: none" type="checkbox"><label class="alectryon-input" for="TraceableVLSM-v-chkc2"><span class="kn">Lemma</span> <span class="nf">indexed_composite_state_to_trace_reflects_initiality_2</span> :
  <span class="kr">forall</span> (<span class="nv">choose</span> : choice_function)
    (<span class="nv">s</span> : composite_state IM) (<span class="nv">Hs</span> : valid_state_prop RFree s)
    (<span class="nv">indices</span> : list index),
  <span class="kr">forall</span> (<span class="nv">i</span> : index), vinitial_state_prop (IM i) (s i) -&gt;
    <span class="kr">forall</span> <span class="nv">is</span> <span class="nv">tr</span>,
      indexed_composite_state_to_trace choose s Hs indices = (<span class="kr">is</span>, tr) -&gt;
      <span class="kr">forall</span> <span class="nv">item</span>, item ‚àà tr -&gt;
      destination item i = s i.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>message, index</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>EqDecision0</var><span class="hyp-type"><b>: </b><span>EqDecision index</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>finite.Finite index</span></span></span><br><span><var>IM</var><span class="hyp-type"><b>: </b><span>index ‚Üí VLSM message</span></span></span><br><span><var>state_destructor</var><span class="hyp-type"><b>: </b><span><span class="kr">‚àÄ</span> <span class="nv">i</span> : index,
  vstate (IM i)
  ‚Üí list
      (vtransition_item (IM i) *
       vstate (IM i))</span></span></span><br><span><var>state_size</var><span class="hyp-type"><b>: </b><span><span class="kr">‚àÄ</span> <span class="nv">i</span> : index, vstate (IM i) ‚Üí nat</span></span></span><br><span><var>H0</var><span class="hyp-type"><b>: </b><span><span class="kr">‚àÄ</span> <span class="nv">i</span> : index,
  TraceableVLSM (IM i) 
    (state_destructor i) 
    (state_size i)</span></span></span><br><span><var>Free</var><span><span class="hyp-body"><b>:= </b><span>free_composite_vlsm IM</span></span><span class="hyp-type"><b>: </b><span>VLSM message</span></span></span></span><br><span><var>RFree</var><span><span class="hyp-body"><b>:= </b><span>pre_loaded_with_all_messages_vlsm Free</span></span><span class="hyp-type"><b>: </b><span>VLSM message</span></span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="kr">‚àÄ</span> (<span class="nv">choose</span> : choice_function) (<span class="nv">s</span> : composite_state IM) 
  (<span class="nv">Hs</span> : valid_state_prop RFree s) (<span class="nv">indices</span> : list
                                               index) 
  (<span class="nv">i</span> : index),
  vinitial_state_prop (IM i) (s i)
  ‚Üí <span class="kr">‚àÄ</span> (<span class="nv">is</span> : composite_state IM) (<span class="nv">tr</span> : list
                                        (composite_transition_item
                                           IM)),
      indexed_composite_state_to_trace choose s Hs
        indices = (<span class="kr">is</span>, tr)
      ‚Üí <span class="kr">‚àÄ</span> <span class="nv">item</span> : transition_item,
          item ‚àà tr ‚Üí destination item i = s i</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="TraceableVLSM-v-chkc3" style="display: none" type="checkbox"><label class="alectryon-input" for="TraceableVLSM-v-chkc3"><span class="kn">Proof</span>.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>message, index</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>EqDecision0</var><span class="hyp-type"><b>: </b><span>EqDecision index</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>finite.Finite index</span></span></span><br><span><var>IM</var><span class="hyp-type"><b>: </b><span>index ‚Üí VLSM message</span></span></span><br><span><var>state_destructor</var><span class="hyp-type"><b>: </b><span><span class="kr">‚àÄ</span> <span class="nv">i</span> : index,
  vstate (IM i)
  ‚Üí list
      (vtransition_item (IM i) *
       vstate (IM i))</span></span></span><br><span><var>state_size</var><span class="hyp-type"><b>: </b><span><span class="kr">‚àÄ</span> <span class="nv">i</span> : index, vstate (IM i) ‚Üí nat</span></span></span><br><span><var>H0</var><span class="hyp-type"><b>: </b><span><span class="kr">‚àÄ</span> <span class="nv">i</span> : index,
  TraceableVLSM (IM i) 
    (state_destructor i) 
    (state_size i)</span></span></span><br><span><var>Free</var><span><span class="hyp-body"><b>:= </b><span>free_composite_vlsm IM</span></span><span class="hyp-type"><b>: </b><span>VLSM message</span></span></span></span><br><span><var>RFree</var><span><span class="hyp-body"><b>:= </b><span>pre_loaded_with_all_messages_vlsm Free</span></span><span class="hyp-type"><b>: </b><span>VLSM message</span></span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="kr">‚àÄ</span> (<span class="nv">choose</span> : choice_function) (<span class="nv">s</span> : composite_state IM) 
  (<span class="nv">Hs</span> : valid_state_prop RFree s) (<span class="nv">indices</span> : list
                                               index) 
  (<span class="nv">i</span> : index),
  vinitial_state_prop (IM i) (s i)
  ‚Üí <span class="kr">‚àÄ</span> (<span class="nv">is</span> : composite_state IM) (<span class="nv">tr</span> : list
                                        (composite_transition_item
                                           IM)),
      indexed_composite_state_to_trace choose s Hs
        indices = (<span class="kr">is</span>, tr)
      ‚Üí <span class="kr">‚àÄ</span> <span class="nv">item</span> : transition_item,
          item ‚àà tr ‚Üí destination item i = s i</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="TraceableVLSM-v-chkc4" style="display: none" type="checkbox"><label class="alectryon-input" for="TraceableVLSM-v-chkc4"><span class="nb">intros</span> ? ? ? ?.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>message, index</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>EqDecision0</var><span class="hyp-type"><b>: </b><span>EqDecision index</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>finite.Finite index</span></span></span><br><span><var>IM</var><span class="hyp-type"><b>: </b><span>index ‚Üí VLSM message</span></span></span><br><span><var>state_destructor</var><span class="hyp-type"><b>: </b><span><span class="kr">‚àÄ</span> <span class="nv">i</span> : index,
  vstate (IM i)
  ‚Üí list
      (vtransition_item (IM i) *
       vstate (IM i))</span></span></span><br><span><var>state_size</var><span class="hyp-type"><b>: </b><span><span class="kr">‚àÄ</span> <span class="nv">i</span> : index, vstate (IM i) ‚Üí nat</span></span></span><br><span><var>H0</var><span class="hyp-type"><b>: </b><span><span class="kr">‚àÄ</span> <span class="nv">i</span> : index,
  TraceableVLSM (IM i) 
    (state_destructor i) 
    (state_size i)</span></span></span><br><span><var>Free</var><span><span class="hyp-body"><b>:= </b><span>free_composite_vlsm IM</span></span><span class="hyp-type"><b>: </b><span>VLSM message</span></span></span></span><br><span><var>RFree</var><span><span class="hyp-body"><b>:= </b><span>pre_loaded_with_all_messages_vlsm Free</span></span><span class="hyp-type"><b>: </b><span>VLSM message</span></span></span></span><br><span><var>choose</var><span class="hyp-type"><b>: </b><span>choice_function</span></span></span><br><span><var>s</var><span class="hyp-type"><b>: </b><span>composite_state IM</span></span></span><br><span><var>Hs</var><span class="hyp-type"><b>: </b><span>valid_state_prop RFree s</span></span></span><br><span><var>indices</var><span class="hyp-type"><b>: </b><span>list index</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="kr">‚àÄ</span> <span class="nv">i</span> : index,
  vinitial_state_prop (IM i) (s i)
  ‚Üí <span class="kr">‚àÄ</span> (<span class="nv">is</span> : composite_state IM) (<span class="nv">tr</span> : list
                                        (composite_transition_item
                                           IM)),
      indexed_composite_state_to_trace choose s Hs
        indices = (<span class="kr">is</span>, tr)
      ‚Üí <span class="kr">‚àÄ</span> <span class="nv">item</span> : transition_item,
          item ‚àà tr ‚Üí destination item i = s i</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="TraceableVLSM-v-chkc5" style="display: none" type="checkbox"><label class="alectryon-input" for="TraceableVLSM-v-chkc5">apply_funelim (indexed_composite_state_to_trace choose s Hs indices);
    <span class="nb">clear</span> choose s Hs indices;
    [<span class="bp">by</span> <span class="nb">inversion</span> <span class="mi">4</span>; <span class="nb">inversion</span> <span class="mi">1</span> |..];
    <span class="nb">intros</span> ? ? ? idx indices [j nj].</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>message, index</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>EqDecision0</var><span class="hyp-type"><b>: </b><span>EqDecision index</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>finite.Finite index</span></span></span><br><span><var>IM</var><span class="hyp-type"><b>: </b><span>index ‚Üí VLSM message</span></span></span><br><span><var>state_destructor</var><span class="hyp-type"><b>: </b><span><span class="kr">‚àÄ</span> <span class="nv">i</span> : index,
  vstate (IM i)
  ‚Üí list
      (vtransition_item (IM i) *
       vstate (IM i))</span></span></span><br><span><var>state_size</var><span class="hyp-type"><b>: </b><span><span class="kr">‚àÄ</span> <span class="nv">i</span> : index, vstate (IM i) ‚Üí nat</span></span></span><br><span><var>H0</var><span class="hyp-type"><b>: </b><span><span class="kr">‚àÄ</span> <span class="nv">i</span> : index,
  TraceableVLSM (IM i) 
    (state_destructor i) 
    (state_size i)</span></span></span><br><span><var>Free</var><span><span class="hyp-body"><b>:= </b><span>free_composite_vlsm IM</span></span><span class="hyp-type"><b>: </b><span>VLSM message</span></span></span></span><br><span><var>RFree</var><span><span class="hyp-body"><b>:= </b><span>pre_loaded_with_all_messages_vlsm Free</span></span><span class="hyp-type"><b>: </b><span>VLSM message</span></span></span></span><br><span><var>choose</var><span class="hyp-type"><b>: </b><span>choice_function</span></span></span><br><span><var>s'</var><span class="hyp-type"><b>: </b><span>composite_state IM</span></span></span><br><span><var>Hs'</var><span class="hyp-type"><b>: </b><span>valid_state_prop RFree s&#39;</span></span></span><br><span><var>idx</var><span class="hyp-type"><b>: </b><span>index</span></span></span><br><span><var>indices</var><span class="hyp-type"><b>: </b><span>list index</span></span></span><br><span><var>j</var><span class="hyp-type"><b>: </b><span>index</span></span></span><br><span><var>nj</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="kr">‚àÄ</span> (<span class="nv">item</span> : composite_transition_item IM) (<span class="nv">s</span> : composite_state
                                               IM) 
  (<span class="nv">Hdestruct</span> : composite_state_destructor s&#39; (j, nj).<span class="mi">1</span>
               !! (j, nj).<span class="mi">2</span> = Some (item, s)) (<span class="nv">Hchoice</span> : 
                                               choose
                                                 s&#39;
                                                 Hs&#39;
                                                 (idx
                                                 :: indices) =
                                               (j, nj)) 
  (<span class="nv">is</span> : composite_state IM) (<span class="nv">tr</span> : list
                                    (composite_transition_item
                                       IM)),
  indexed_composite_state_to_trace choose s
    (indexed_composite_state_to_trace_obligations_obligation_1
       s&#39; Hs&#39; (j, nj) item s Hdestruct)
    (idx :: indices) = (<span class="kr">is</span>, tr)
  ‚Üí (<span class="kr">‚àÄ</span> <span class="nv">i</span> : index,
       vinitial_state_prop (IM i) (s i)
       ‚Üí <span class="kr">‚àÄ</span> (<span class="nv">is0</span> : composite_state IM) (<span class="nv">tr0</span> : list
                                               (composite_transition_item
                                                 IM)),
           indexed_composite_state_to_trace choose s
             (indexed_composite_state_to_trace_obligations_obligation_1
                s&#39; Hs&#39; (j, nj) item s Hdestruct)
             (idx :: indices) = (is0, tr0)
           ‚Üí <span class="kr">‚àÄ</span> <span class="nv">item0</span> : transition_item,
               item0 ‚àà tr0 ‚Üí destination item0 i = s i)
    ‚Üí inspect
        (composite_state_destructor s&#39; (j, nj).<span class="mi">1</span>
         !! (j, nj).<span class="mi">2</span>) = Some (item, s) ‚Üæ Hdestruct
      ‚Üí inspect (choose s&#39; Hs&#39; (idx :: indices)) =
        (j, nj) ‚Üæ Hchoice
        ‚Üí <span class="kr">‚àÄ</span> <span class="nv">i</span> : index,
            vinitial_state_prop (IM i) (s&#39; i)
            ‚Üí <span class="kr">‚àÄ</span> (<span class="nv">is0</span> : composite_state IM) (<span class="nv">tr0</span> : 
                                            list
                                              (composite_transition_item
                                                 IM)),
                (<span class="kr">is</span>, tr ++ [item]) = (is0, tr0)
                ‚Üí <span class="kr">‚àÄ</span> <span class="nv">item0</span> : transition_item,
                    item0 ‚àà tr0
                    ‚Üí destination item0 i = s&#39; i</div></blockquote><div class="alectryon-extra-goals"><input class="alectryon-extra-goal-toggle" id="TraceableVLSM-v-chkc6" style="display: none" type="checkbox"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>message, index</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>EqDecision0</var><span class="hyp-type"><b>: </b><span>EqDecision index</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>finite.Finite index</span></span></span><br><span><var>IM</var><span class="hyp-type"><b>: </b><span>index ‚Üí VLSM message</span></span></span><br><span><var>state_destructor</var><span class="hyp-type"><b>: </b><span><span class="kr">‚àÄ</span> <span class="nv">i</span> : index,
  vstate (IM i)
  ‚Üí list
      (vtransition_item (IM i) *
       vstate (IM i))</span></span></span><br><span><var>state_size</var><span class="hyp-type"><b>: </b><span><span class="kr">‚àÄ</span> <span class="nv">i</span> : index, vstate (IM i) ‚Üí nat</span></span></span><br><span><var>H0</var><span class="hyp-type"><b>: </b><span><span class="kr">‚àÄ</span> <span class="nv">i</span> : index,
  TraceableVLSM (IM i) 
    (state_destructor i) 
    (state_size i)</span></span></span><br><span><var>Free</var><span><span class="hyp-body"><b>:= </b><span>free_composite_vlsm IM</span></span><span class="hyp-type"><b>: </b><span>VLSM message</span></span></span></span><br><span><var>RFree</var><span><span class="hyp-body"><b>:= </b><span>pre_loaded_with_all_messages_vlsm Free</span></span><span class="hyp-type"><b>: </b><span>VLSM message</span></span></span></span><br><span><var>choose</var><span class="hyp-type"><b>: </b><span>choice_function</span></span></span><br><span><var>s'</var><span class="hyp-type"><b>: </b><span>composite_state IM</span></span></span><br><span><var>Hs'</var><span class="hyp-type"><b>: </b><span>valid_state_prop RFree s&#39;</span></span></span><br><span><var>idx</var><span class="hyp-type"><b>: </b><span>index</span></span></span><br><span><var>indices</var><span class="hyp-type"><b>: </b><span>list index</span></span></span><br><span><var>j</var><span class="hyp-type"><b>: </b><span>index</span></span></span><br><span><var>nj</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br></div><label class="goal-separator" for="TraceableVLSM-v-chkc6"><hr></label><div class="goal-conclusion"><span class="kr">‚àÄ</span> (<span class="nv">n</span> : (j, nj).<span class="mi">1</span> ‚àâ idx :: indices) 
  (<span class="nv">Hni</span> : decide ((j, nj).<span class="mi">1</span> ‚àà idx :: indices) = <span class="nb">right</span> n) 
  (<span class="nv">Hdestruct</span> : composite_state_destructor s&#39; (j, nj).<span class="mi">1</span>
               !! (j, nj).<span class="mi">2</span> = None) 
  (<span class="nv">Hchoice</span> : choose s&#39; Hs&#39; (idx :: indices) = (j, nj)),
  inspect (decide ((j, nj).<span class="mi">1</span> ‚àà idx :: indices)) =
  <span class="nb">right</span> n ‚Üæ Hni
  ‚Üí inspect
      (composite_state_destructor s&#39; (j, nj).<span class="mi">1</span>
       !! (j, nj).<span class="mi">2</span>) = 
    None ‚Üæ Hdestruct
    ‚Üí inspect (choose s&#39; Hs&#39; (idx :: indices)) =
      (j, nj) ‚Üæ Hchoice
      ‚Üí <span class="kr">‚àÄ</span> <span class="nv">i</span> : index,
          vinitial_state_prop (IM i) (s&#39; i)
          ‚Üí <span class="kr">‚àÄ</span> (<span class="nv">is</span> : composite_state IM) 
              (<span class="nv">tr</span> : list
                      (composite_transition_item IM)),
              (s&#39;, []) = (<span class="kr">is</span>, tr)
              ‚Üí <span class="kr">‚àÄ</span> <span class="nv">item</span> : transition_item,
                  item ‚àà tr
                  ‚Üí destination item i = s&#39; i</div></blockquote><input class="alectryon-extra-goal-toggle" id="TraceableVLSM-v-chkc7" style="display: none" type="checkbox"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>message, index</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>EqDecision0</var><span class="hyp-type"><b>: </b><span>EqDecision index</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>finite.Finite index</span></span></span><br><span><var>IM</var><span class="hyp-type"><b>: </b><span>index ‚Üí VLSM message</span></span></span><br><span><var>state_destructor</var><span class="hyp-type"><b>: </b><span><span class="kr">‚àÄ</span> <span class="nv">i</span> : index,
  vstate (IM i)
  ‚Üí list
      (vtransition_item (IM i) *
       vstate (IM i))</span></span></span><br><span><var>state_size</var><span class="hyp-type"><b>: </b><span><span class="kr">‚àÄ</span> <span class="nv">i</span> : index, vstate (IM i) ‚Üí nat</span></span></span><br><span><var>H0</var><span class="hyp-type"><b>: </b><span><span class="kr">‚àÄ</span> <span class="nv">i</span> : index,
  TraceableVLSM (IM i) 
    (state_destructor i) 
    (state_size i)</span></span></span><br><span><var>Free</var><span><span class="hyp-body"><b>:= </b><span>free_composite_vlsm IM</span></span><span class="hyp-type"><b>: </b><span>VLSM message</span></span></span></span><br><span><var>RFree</var><span><span class="hyp-body"><b>:= </b><span>pre_loaded_with_all_messages_vlsm Free</span></span><span class="hyp-type"><b>: </b><span>VLSM message</span></span></span></span><br><span><var>choose</var><span class="hyp-type"><b>: </b><span>choice_function</span></span></span><br><span><var>s'</var><span class="hyp-type"><b>: </b><span>composite_state IM</span></span></span><br><span><var>Hs'</var><span class="hyp-type"><b>: </b><span>valid_state_prop RFree s&#39;</span></span></span><br><span><var>idx</var><span class="hyp-type"><b>: </b><span>index</span></span></span><br><span><var>indices</var><span class="hyp-type"><b>: </b><span>list index</span></span></span><br><span><var>j</var><span class="hyp-type"><b>: </b><span>index</span></span></span><br><span><var>nj</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br></div><label class="goal-separator" for="TraceableVLSM-v-chkc7"><hr></label><div class="goal-conclusion"><span class="kr">‚àÄ</span> (<span class="nv">e1</span> : composite_state_destructor s&#39; (j, nj).<span class="mi">1</span> = []) 
  (<span class="nv">Hnn</span> : decide
           (composite_state_destructor s&#39; (j, nj).<span class="mi">1</span> =
            []) = <span class="nb">left</span> e1) 
  (<span class="nv">e0</span> : (j, nj).<span class="mi">1</span> ‚àà idx :: indices) 
  (<span class="nv">Hi</span> : decide ((j, nj).<span class="mi">1</span> ‚àà idx :: indices) = <span class="nb">left</span> e0) 
  (<span class="nv">Hdestruct</span> : composite_state_destructor s&#39; (j, nj).<span class="mi">1</span>
               !! (j, nj).<span class="mi">2</span> = None) 
  (<span class="nv">Hchoice</span> : choose s&#39; Hs&#39; (idx :: indices) = (j, nj)),
  (<span class="kr">‚àÄ</span> <span class="nv">i</span> : index,
     vinitial_state_prop (IM i) (s&#39; i)
     ‚Üí <span class="kr">‚àÄ</span> (<span class="nv">is</span> : composite_state IM) 
         (<span class="nv">tr</span> : list (composite_transition_item IM)),
         indexed_composite_state_to_trace choose s&#39;
           Hs&#39;
           (StdppListSet.set_remove 
              (j, nj).<span class="mi">1</span> 
              (idx :: indices)) = 
         (<span class="kr">is</span>, tr)
         ‚Üí <span class="kr">‚àÄ</span> <span class="nv">item</span> : transition_item,
             item ‚àà tr ‚Üí destination item i = s&#39; i)
  ‚Üí inspect
      (decide
         (composite_state_destructor s&#39; (j, nj).<span class="mi">1</span> = [])) =
    <span class="nb">left</span> e1 ‚Üæ Hnn
    ‚Üí inspect (decide ((j, nj).<span class="mi">1</span> ‚àà idx :: indices)) =
      <span class="nb">left</span> e0 ‚Üæ Hi
      ‚Üí inspect
          (composite_state_destructor s&#39; (j, nj).<span class="mi">1</span>
           !! (j, nj).<span class="mi">2</span>) = 
        None ‚Üæ Hdestruct
        ‚Üí inspect (choose s&#39; Hs&#39; (idx :: indices)) =
          (j, nj) ‚Üæ Hchoice
          ‚Üí <span class="kr">‚àÄ</span> <span class="nv">i</span> : index,
              vinitial_state_prop (IM i) (s&#39; i)
              ‚Üí <span class="kr">‚àÄ</span> (<span class="nv">is</span> : composite_state IM) 
                  (<span class="nv">tr</span> : 
                   list 
                     (composite_transition_item IM)),
                  indexed_composite_state_to_trace
                    choose s&#39; Hs&#39;
                    (StdppListSet.set_remove 
                      (j, nj).<span class="mi">1</span> 
                      (idx :: indices)) = 
                  (<span class="kr">is</span>, tr)
                  ‚Üí <span class="kr">‚àÄ</span> <span class="nv">item</span> : transition_item,
                      item ‚àà tr
                      ‚Üí 
                      destination item i = s&#39; i</div></blockquote><input class="alectryon-extra-goal-toggle" id="TraceableVLSM-v-chkc8" style="display: none" type="checkbox"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>message, index</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>EqDecision0</var><span class="hyp-type"><b>: </b><span>EqDecision index</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>finite.Finite index</span></span></span><br><span><var>IM</var><span class="hyp-type"><b>: </b><span>index ‚Üí VLSM message</span></span></span><br><span><var>state_destructor</var><span class="hyp-type"><b>: </b><span><span class="kr">‚àÄ</span> <span class="nv">i</span> : index,
  vstate (IM i)
  ‚Üí list
      (vtransition_item (IM i) *
       vstate (IM i))</span></span></span><br><span><var>state_size</var><span class="hyp-type"><b>: </b><span><span class="kr">‚àÄ</span> <span class="nv">i</span> : index, vstate (IM i) ‚Üí nat</span></span></span><br><span><var>H0</var><span class="hyp-type"><b>: </b><span><span class="kr">‚àÄ</span> <span class="nv">i</span> : index,
  TraceableVLSM (IM i) 
    (state_destructor i) 
    (state_size i)</span></span></span><br><span><var>Free</var><span><span class="hyp-body"><b>:= </b><span>free_composite_vlsm IM</span></span><span class="hyp-type"><b>: </b><span>VLSM message</span></span></span></span><br><span><var>RFree</var><span><span class="hyp-body"><b>:= </b><span>pre_loaded_with_all_messages_vlsm Free</span></span><span class="hyp-type"><b>: </b><span>VLSM message</span></span></span></span><br><span><var>choose</var><span class="hyp-type"><b>: </b><span>choice_function</span></span></span><br><span><var>s'</var><span class="hyp-type"><b>: </b><span>composite_state IM</span></span></span><br><span><var>Hs'</var><span class="hyp-type"><b>: </b><span>valid_state_prop RFree s&#39;</span></span></span><br><span><var>idx</var><span class="hyp-type"><b>: </b><span>index</span></span></span><br><span><var>indices</var><span class="hyp-type"><b>: </b><span>list index</span></span></span><br><span><var>j</var><span class="hyp-type"><b>: </b><span>index</span></span></span><br><span><var>nj</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br></div><label class="goal-separator" for="TraceableVLSM-v-chkc8"><hr></label><div class="goal-conclusion"><span class="kr">‚àÄ</span> (<span class="nv">n</span> : composite_state_destructor s&#39; (j, nj).<span class="mi">1</span> ‚â† []) 
  (<span class="nv">Hn</span> : decide
          (composite_state_destructor s&#39; (j, nj).<span class="mi">1</span> =
           []) = <span class="nb">right</span> n) 
  (<span class="nv">e0</span> : (j, nj).<span class="mi">1</span> ‚àà idx :: indices) 
  (<span class="nv">Hi</span> : decide ((j, nj).<span class="mi">1</span> ‚àà idx :: indices) = <span class="nb">left</span> e0) 
  (<span class="nv">Hdestruct</span> : composite_state_destructor s&#39; (j, nj).<span class="mi">1</span>
               !! (j, nj).<span class="mi">2</span> = None) 
  (<span class="nv">Hchoice</span> : choose s&#39; Hs&#39; (idx :: indices) = (j, nj)),
  inspect
    (decide
       (composite_state_destructor s&#39; (j, nj).<span class="mi">1</span> = [])) =
  <span class="nb">right</span> n ‚Üæ Hn
  ‚Üí inspect (decide ((j, nj).<span class="mi">1</span> ‚àà idx :: indices)) =
    <span class="nb">left</span> e0 ‚Üæ Hi
    ‚Üí inspect
        (composite_state_destructor s&#39; (j, nj).<span class="mi">1</span>
         !! (j, nj).<span class="mi">2</span>) = 
      None ‚Üæ Hdestruct
      ‚Üí inspect (choose s&#39; Hs&#39; (idx :: indices)) =
        (j, nj) ‚Üæ Hchoice
        ‚Üí <span class="kr">‚àÄ</span> <span class="nv">i</span> : index,
            vinitial_state_prop (IM i) (s&#39; i)
            ‚Üí <span class="kr">‚àÄ</span> (<span class="nv">is</span> : composite_state IM) 
                (<span class="nv">tr</span> : list
                      (composite_transition_item IM)),
                (s&#39;, []) = (<span class="kr">is</span>, tr)
                ‚Üí <span class="kr">‚àÄ</span> <span class="nv">item</span> : transition_item,
                    item ‚àà tr
                    ‚Üí destination item i = s&#39; i</div></blockquote></div></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="TraceableVLSM-v-chkc9" style="display: none" type="checkbox"><label class="alectryon-input" for="TraceableVLSM-v-chkc9">-</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>message, index</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>EqDecision0</var><span class="hyp-type"><b>: </b><span>EqDecision index</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>finite.Finite index</span></span></span><br><span><var>IM</var><span class="hyp-type"><b>: </b><span>index ‚Üí VLSM message</span></span></span><br><span><var>state_destructor</var><span class="hyp-type"><b>: </b><span><span class="kr">‚àÄ</span> <span class="nv">i</span> : index,
  vstate (IM i)
  ‚Üí list
      (vtransition_item (IM i) *
       vstate (IM i))</span></span></span><br><span><var>state_size</var><span class="hyp-type"><b>: </b><span><span class="kr">‚àÄ</span> <span class="nv">i</span> : index, vstate (IM i) ‚Üí nat</span></span></span><br><span><var>H0</var><span class="hyp-type"><b>: </b><span><span class="kr">‚àÄ</span> <span class="nv">i</span> : index,
  TraceableVLSM (IM i) 
    (state_destructor i) 
    (state_size i)</span></span></span><br><span><var>Free</var><span><span class="hyp-body"><b>:= </b><span>free_composite_vlsm IM</span></span><span class="hyp-type"><b>: </b><span>VLSM message</span></span></span></span><br><span><var>RFree</var><span><span class="hyp-body"><b>:= </b><span>pre_loaded_with_all_messages_vlsm Free</span></span><span class="hyp-type"><b>: </b><span>VLSM message</span></span></span></span><br><span><var>choose</var><span class="hyp-type"><b>: </b><span>choice_function</span></span></span><br><span><var>s'</var><span class="hyp-type"><b>: </b><span>composite_state IM</span></span></span><br><span><var>Hs'</var><span class="hyp-type"><b>: </b><span>valid_state_prop RFree s&#39;</span></span></span><br><span><var>idx</var><span class="hyp-type"><b>: </b><span>index</span></span></span><br><span><var>indices</var><span class="hyp-type"><b>: </b><span>list index</span></span></span><br><span><var>j</var><span class="hyp-type"><b>: </b><span>index</span></span></span><br><span><var>nj</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="kr">‚àÄ</span> (<span class="nv">item</span> : composite_transition_item IM) (<span class="nv">s</span> : composite_state
                                               IM) 
  (<span class="nv">Hdestruct</span> : composite_state_destructor s&#39; (j, nj).<span class="mi">1</span>
               !! (j, nj).<span class="mi">2</span> = Some (item, s)) (<span class="nv">Hchoice</span> : 
                                               choose
                                                 s&#39;
                                                 Hs&#39;
                                                 (idx
                                                 :: indices) =
                                               (j, nj)) 
  (<span class="nv">is</span> : composite_state IM) (<span class="nv">tr</span> : list
                                    (composite_transition_item
                                       IM)),
  indexed_composite_state_to_trace choose s
    (indexed_composite_state_to_trace_obligations_obligation_1
       s&#39; Hs&#39; (j, nj) item s Hdestruct)
    (idx :: indices) = (<span class="kr">is</span>, tr)
  ‚Üí (<span class="kr">‚àÄ</span> <span class="nv">i</span> : index,
       vinitial_state_prop (IM i) (s i)
       ‚Üí <span class="kr">‚àÄ</span> (<span class="nv">is0</span> : composite_state IM) (<span class="nv">tr0</span> : list
                                               (composite_transition_item
                                                 IM)),
           indexed_composite_state_to_trace choose s
             (indexed_composite_state_to_trace_obligations_obligation_1
                s&#39; Hs&#39; (j, nj) item s Hdestruct)
             (idx :: indices) = (is0, tr0)
           ‚Üí <span class="kr">‚àÄ</span> <span class="nv">item0</span> : transition_item,
               item0 ‚àà tr0 ‚Üí destination item0 i = s i)
    ‚Üí inspect
        (composite_state_destructor s&#39; (j, nj).<span class="mi">1</span>
         !! (j, nj).<span class="mi">2</span>) = Some (item, s) ‚Üæ Hdestruct
      ‚Üí inspect (choose s&#39; Hs&#39; (idx :: indices)) =
        (j, nj) ‚Üæ Hchoice
        ‚Üí <span class="kr">‚àÄ</span> <span class="nv">i</span> : index,
            vinitial_state_prop (IM i) (s&#39; i)
            ‚Üí <span class="kr">‚àÄ</span> (<span class="nv">is0</span> : composite_state IM) (<span class="nv">tr0</span> : 
                                            list
                                              (composite_transition_item
                                                 IM)),
                (<span class="kr">is</span>, tr ++ [item]) = (is0, tr0)
                ‚Üí <span class="kr">‚àÄ</span> <span class="nv">item0</span> : transition_item,
                    item0 ‚àà tr0
                    ‚Üí destination item0 i = s&#39; i</div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="TraceableVLSM-v-chkca" style="display: none" type="checkbox"><label class="alectryon-input" for="TraceableVLSM-v-chkca"><span class="nb">intros</span> * -&gt; Hind _ _ i Hi is&#39; tr&#39; [=] _item H_item; <span class="nb">subst</span> is&#39; tr&#39;.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>message, index</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>EqDecision0</var><span class="hyp-type"><b>: </b><span>EqDecision index</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>finite.Finite index</span></span></span><br><span><var>IM</var><span class="hyp-type"><b>: </b><span>index ‚Üí VLSM message</span></span></span><br><span><var>state_destructor</var><span class="hyp-type"><b>: </b><span><span class="kr">‚àÄ</span> <span class="nv">i</span> : index,
  vstate (IM i)
  ‚Üí list
      (vtransition_item (IM i) *
       vstate (IM i))</span></span></span><br><span><var>state_size</var><span class="hyp-type"><b>: </b><span><span class="kr">‚àÄ</span> <span class="nv">i</span> : index, vstate (IM i) ‚Üí nat</span></span></span><br><span><var>H0</var><span class="hyp-type"><b>: </b><span><span class="kr">‚àÄ</span> <span class="nv">i</span> : index,
  TraceableVLSM (IM i) 
    (state_destructor i) 
    (state_size i)</span></span></span><br><span><var>Free</var><span><span class="hyp-body"><b>:= </b><span>free_composite_vlsm IM</span></span><span class="hyp-type"><b>: </b><span>VLSM message</span></span></span></span><br><span><var>RFree</var><span><span class="hyp-body"><b>:= </b><span>pre_loaded_with_all_messages_vlsm Free</span></span><span class="hyp-type"><b>: </b><span>VLSM message</span></span></span></span><br><span><var>choose</var><span class="hyp-type"><b>: </b><span>choice_function</span></span></span><br><span><var>s'</var><span class="hyp-type"><b>: </b><span>composite_state IM</span></span></span><br><span><var>Hs'</var><span class="hyp-type"><b>: </b><span>valid_state_prop RFree s&#39;</span></span></span><br><span><var>idx</var><span class="hyp-type"><b>: </b><span>index</span></span></span><br><span><var>indices</var><span class="hyp-type"><b>: </b><span>list index</span></span></span><br><span><var>j</var><span class="hyp-type"><b>: </b><span>index</span></span></span><br><span><var>nj</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>item</var><span class="hyp-type"><b>: </b><span>composite_transition_item IM</span></span></span><br><span><var>s</var><span class="hyp-type"><b>: </b><span>composite_state IM</span></span></span><br><span><var>Hdestruct</var><span class="hyp-type"><b>: </b><span>composite_state_destructor s&#39; (j, nj).<span class="mi">1</span>
!! (j, nj).<span class="mi">2</span> = Some (item, s)</span></span></span><br><span><var>Hchoice</var><span class="hyp-type"><b>: </b><span>choose s&#39; Hs&#39; (idx :: indices) = (j, nj)</span></span></span><br><span><var>is</var><span class="hyp-type"><b>: </b><span>composite_state IM</span></span></span><br><span><var>tr</var><span class="hyp-type"><b>: </b><span>list (composite_transition_item IM)</span></span></span><br><span><var>Hind</var><span class="hyp-type"><b>: </b><span><span class="kr">‚àÄ</span> <span class="nv">i</span> : index,
  vinitial_state_prop (IM i) (s i)
  ‚Üí <span class="kr">‚àÄ</span> (<span class="nv">is0</span> : composite_state IM) 
      (<span class="nv">tr0</span> : list
               (composite_transition_item IM)),
      (<span class="kr">is</span>, tr) = (is0, tr0)
      ‚Üí <span class="kr">‚àÄ</span> <span class="nv">item</span> : transition_item,
          item ‚àà tr0 ‚Üí destination item i = s i</span></span></span><br><span><var>i</var><span class="hyp-type"><b>: </b><span>index</span></span></span><br><span><var>Hi</var><span class="hyp-type"><b>: </b><span>vinitial_state_prop (IM i) (s&#39; i)</span></span></span><br><span><var>_item</var><span class="hyp-type"><b>: </b><span>transition_item</span></span></span><br><span><var>H_item</var><span class="hyp-type"><b>: </b><span>_item ‚àà tr ++ [item]</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">destination _item i = s&#39; i</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="TraceableVLSM-v-chkcb" style="display: none" type="checkbox"><label class="alectryon-input" for="TraceableVLSM-v-chkcb"><span class="nb">apply</span> elem_of_app <span class="kr">in</span> H_item <span class="kr">as</span> [H_item | H_item].</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>message, index</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>EqDecision0</var><span class="hyp-type"><b>: </b><span>EqDecision index</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>finite.Finite index</span></span></span><br><span><var>IM</var><span class="hyp-type"><b>: </b><span>index ‚Üí VLSM message</span></span></span><br><span><var>state_destructor</var><span class="hyp-type"><b>: </b><span><span class="kr">‚àÄ</span> <span class="nv">i</span> : index,
  vstate (IM i)
  ‚Üí list
      (vtransition_item (IM i) *
       vstate (IM i))</span></span></span><br><span><var>state_size</var><span class="hyp-type"><b>: </b><span><span class="kr">‚àÄ</span> <span class="nv">i</span> : index, vstate (IM i) ‚Üí nat</span></span></span><br><span><var>H0</var><span class="hyp-type"><b>: </b><span><span class="kr">‚àÄ</span> <span class="nv">i</span> : index,
  TraceableVLSM (IM i) 
    (state_destructor i) 
    (state_size i)</span></span></span><br><span><var>Free</var><span><span class="hyp-body"><b>:= </b><span>free_composite_vlsm IM</span></span><span class="hyp-type"><b>: </b><span>VLSM message</span></span></span></span><br><span><var>RFree</var><span><span class="hyp-body"><b>:= </b><span>pre_loaded_with_all_messages_vlsm Free</span></span><span class="hyp-type"><b>: </b><span>VLSM message</span></span></span></span><br><span><var>choose</var><span class="hyp-type"><b>: </b><span>choice_function</span></span></span><br><span><var>s'</var><span class="hyp-type"><b>: </b><span>composite_state IM</span></span></span><br><span><var>Hs'</var><span class="hyp-type"><b>: </b><span>valid_state_prop RFree s&#39;</span></span></span><br><span><var>idx</var><span class="hyp-type"><b>: </b><span>index</span></span></span><br><span><var>indices</var><span class="hyp-type"><b>: </b><span>list index</span></span></span><br><span><var>j</var><span class="hyp-type"><b>: </b><span>index</span></span></span><br><span><var>nj</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>item</var><span class="hyp-type"><b>: </b><span>composite_transition_item IM</span></span></span><br><span><var>s</var><span class="hyp-type"><b>: </b><span>composite_state IM</span></span></span><br><span><var>Hdestruct</var><span class="hyp-type"><b>: </b><span>composite_state_destructor s&#39; (j, nj).<span class="mi">1</span>
!! (j, nj).<span class="mi">2</span> = Some (item, s)</span></span></span><br><span><var>Hchoice</var><span class="hyp-type"><b>: </b><span>choose s&#39; Hs&#39; (idx :: indices) = (j, nj)</span></span></span><br><span><var>is</var><span class="hyp-type"><b>: </b><span>composite_state IM</span></span></span><br><span><var>tr</var><span class="hyp-type"><b>: </b><span>list (composite_transition_item IM)</span></span></span><br><span><var>Hind</var><span class="hyp-type"><b>: </b><span><span class="kr">‚àÄ</span> <span class="nv">i</span> : index,
  vinitial_state_prop (IM i) (s i)
  ‚Üí <span class="kr">‚àÄ</span> (<span class="nv">is0</span> : composite_state IM) 
      (<span class="nv">tr0</span> : list
               (composite_transition_item IM)),
      (<span class="kr">is</span>, tr) = (is0, tr0)
      ‚Üí <span class="kr">‚àÄ</span> <span class="nv">item</span> : transition_item,
          item ‚àà tr0 ‚Üí destination item i = s i</span></span></span><br><span><var>i</var><span class="hyp-type"><b>: </b><span>index</span></span></span><br><span><var>Hi</var><span class="hyp-type"><b>: </b><span>vinitial_state_prop (IM i) (s&#39; i)</span></span></span><br><span><var>_item</var><span class="hyp-type"><b>: </b><span>transition_item</span></span></span><br><span><var>H_item</var><span class="hyp-type"><b>: </b><span>_item ‚àà tr</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">destination _item i = s&#39; i</div></blockquote><div class="alectryon-extra-goals"><input class="alectryon-extra-goal-toggle" id="TraceableVLSM-v-chkcc" style="display: none" type="checkbox"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>message, index</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>EqDecision0</var><span class="hyp-type"><b>: </b><span>EqDecision index</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>finite.Finite index</span></span></span><br><span><var>IM</var><span class="hyp-type"><b>: </b><span>index ‚Üí VLSM message</span></span></span><br><span><var>state_destructor</var><span class="hyp-type"><b>: </b><span><span class="kr">‚àÄ</span> <span class="nv">i</span> : index,
  vstate (IM i)
  ‚Üí list
      (vtransition_item (IM i) *
       vstate (IM i))</span></span></span><br><span><var>state_size</var><span class="hyp-type"><b>: </b><span><span class="kr">‚àÄ</span> <span class="nv">i</span> : index, vstate (IM i) ‚Üí nat</span></span></span><br><span><var>H0</var><span class="hyp-type"><b>: </b><span><span class="kr">‚àÄ</span> <span class="nv">i</span> : index,
  TraceableVLSM (IM i) 
    (state_destructor i) 
    (state_size i)</span></span></span><br><span><var>Free</var><span><span class="hyp-body"><b>:= </b><span>free_composite_vlsm IM</span></span><span class="hyp-type"><b>: </b><span>VLSM message</span></span></span></span><br><span><var>RFree</var><span><span class="hyp-body"><b>:= </b><span>pre_loaded_with_all_messages_vlsm Free</span></span><span class="hyp-type"><b>: </b><span>VLSM message</span></span></span></span><br><span><var>choose</var><span class="hyp-type"><b>: </b><span>choice_function</span></span></span><br><span><var>s'</var><span class="hyp-type"><b>: </b><span>composite_state IM</span></span></span><br><span><var>Hs'</var><span class="hyp-type"><b>: </b><span>valid_state_prop RFree s&#39;</span></span></span><br><span><var>idx</var><span class="hyp-type"><b>: </b><span>index</span></span></span><br><span><var>indices</var><span class="hyp-type"><b>: </b><span>list index</span></span></span><br><span><var>j</var><span class="hyp-type"><b>: </b><span>index</span></span></span><br><span><var>nj</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>item</var><span class="hyp-type"><b>: </b><span>composite_transition_item IM</span></span></span><br><span><var>s</var><span class="hyp-type"><b>: </b><span>composite_state IM</span></span></span><br><span><var>Hdestruct</var><span class="hyp-type"><b>: </b><span>composite_state_destructor s&#39; (j, nj).<span class="mi">1</span>
!! (j, nj).<span class="mi">2</span> = Some (item, s)</span></span></span><br><span><var>Hchoice</var><span class="hyp-type"><b>: </b><span>choose s&#39; Hs&#39; (idx :: indices) = (j, nj)</span></span></span><br><span><var>is</var><span class="hyp-type"><b>: </b><span>composite_state IM</span></span></span><br><span><var>tr</var><span class="hyp-type"><b>: </b><span>list (composite_transition_item IM)</span></span></span><br><span><var>Hind</var><span class="hyp-type"><b>: </b><span><span class="kr">‚àÄ</span> <span class="nv">i</span> : index,
  vinitial_state_prop (IM i) (s i)
  ‚Üí <span class="kr">‚àÄ</span> (<span class="nv">is0</span> : composite_state IM) 
      (<span class="nv">tr0</span> : list
               (composite_transition_item IM)),
      (<span class="kr">is</span>, tr) = (is0, tr0)
      ‚Üí <span class="kr">‚àÄ</span> <span class="nv">item</span> : transition_item,
          item ‚àà tr0 ‚Üí destination item i = s i</span></span></span><br><span><var>i</var><span class="hyp-type"><b>: </b><span>index</span></span></span><br><span><var>Hi</var><span class="hyp-type"><b>: </b><span>vinitial_state_prop (IM i) (s&#39; i)</span></span></span><br><span><var>_item</var><span class="hyp-type"><b>: </b><span>transition_item</span></span></span><br><span><var>H_item</var><span class="hyp-type"><b>: </b><span>_item ‚àà [item]</span></span></span><br></div><label class="goal-separator" for="TraceableVLSM-v-chkcc"><hr></label><div class="goal-conclusion">destination _item i = s&#39; i</div></blockquote></div></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="TraceableVLSM-v-chkcd" style="display: none" type="checkbox"><label class="alectryon-input" for="TraceableVLSM-v-chkcd">+</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>message, index</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>EqDecision0</var><span class="hyp-type"><b>: </b><span>EqDecision index</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>finite.Finite index</span></span></span><br><span><var>IM</var><span class="hyp-type"><b>: </b><span>index ‚Üí VLSM message</span></span></span><br><span><var>state_destructor</var><span class="hyp-type"><b>: </b><span><span class="kr">‚àÄ</span> <span class="nv">i</span> : index,
  vstate (IM i)
  ‚Üí list
      (vtransition_item (IM i) *
       vstate (IM i))</span></span></span><br><span><var>state_size</var><span class="hyp-type"><b>: </b><span><span class="kr">‚àÄ</span> <span class="nv">i</span> : index, vstate (IM i) ‚Üí nat</span></span></span><br><span><var>H0</var><span class="hyp-type"><b>: </b><span><span class="kr">‚àÄ</span> <span class="nv">i</span> : index,
  TraceableVLSM (IM i) 
    (state_destructor i) 
    (state_size i)</span></span></span><br><span><var>Free</var><span><span class="hyp-body"><b>:= </b><span>free_composite_vlsm IM</span></span><span class="hyp-type"><b>: </b><span>VLSM message</span></span></span></span><br><span><var>RFree</var><span><span class="hyp-body"><b>:= </b><span>pre_loaded_with_all_messages_vlsm Free</span></span><span class="hyp-type"><b>: </b><span>VLSM message</span></span></span></span><br><span><var>choose</var><span class="hyp-type"><b>: </b><span>choice_function</span></span></span><br><span><var>s'</var><span class="hyp-type"><b>: </b><span>composite_state IM</span></span></span><br><span><var>Hs'</var><span class="hyp-type"><b>: </b><span>valid_state_prop RFree s&#39;</span></span></span><br><span><var>idx</var><span class="hyp-type"><b>: </b><span>index</span></span></span><br><span><var>indices</var><span class="hyp-type"><b>: </b><span>list index</span></span></span><br><span><var>j</var><span class="hyp-type"><b>: </b><span>index</span></span></span><br><span><var>nj</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>item</var><span class="hyp-type"><b>: </b><span>composite_transition_item IM</span></span></span><br><span><var>s</var><span class="hyp-type"><b>: </b><span>composite_state IM</span></span></span><br><span><var>Hdestruct</var><span class="hyp-type"><b>: </b><span>composite_state_destructor s&#39; (j, nj).<span class="mi">1</span>
!! (j, nj).<span class="mi">2</span> = Some (item, s)</span></span></span><br><span><var>Hchoice</var><span class="hyp-type"><b>: </b><span>choose s&#39; Hs&#39; (idx :: indices) = (j, nj)</span></span></span><br><span><var>is</var><span class="hyp-type"><b>: </b><span>composite_state IM</span></span></span><br><span><var>tr</var><span class="hyp-type"><b>: </b><span>list (composite_transition_item IM)</span></span></span><br><span><var>Hind</var><span class="hyp-type"><b>: </b><span><span class="kr">‚àÄ</span> <span class="nv">i</span> : index,
  vinitial_state_prop (IM i) (s i)
  ‚Üí <span class="kr">‚àÄ</span> (<span class="nv">is0</span> : composite_state IM) 
      (<span class="nv">tr0</span> : list
               (composite_transition_item IM)),
      (<span class="kr">is</span>, tr) = (is0, tr0)
      ‚Üí <span class="kr">‚àÄ</span> <span class="nv">item</span> : transition_item,
          item ‚àà tr0 ‚Üí destination item i = s i</span></span></span><br><span><var>i</var><span class="hyp-type"><b>: </b><span>index</span></span></span><br><span><var>Hi</var><span class="hyp-type"><b>: </b><span>vinitial_state_prop (IM i) (s&#39; i)</span></span></span><br><span><var>_item</var><span class="hyp-type"><b>: </b><span>transition_item</span></span></span><br><span><var>H_item</var><span class="hyp-type"><b>: </b><span>_item ‚àà tr</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">destination _item i = s&#39; i</div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="TraceableVLSM-v-chkce" style="display: none" type="checkbox"><label class="alectryon-input" for="TraceableVLSM-v-chkce"><span class="nb">replace</span> (s&#39; i) <span class="kr">with</span> (s i) <span class="kr">in</span> *.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>message, index</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>EqDecision0</var><span class="hyp-type"><b>: </b><span>EqDecision index</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>finite.Finite index</span></span></span><br><span><var>IM</var><span class="hyp-type"><b>: </b><span>index ‚Üí VLSM message</span></span></span><br><span><var>state_destructor</var><span class="hyp-type"><b>: </b><span><span class="kr">‚àÄ</span> <span class="nv">i</span> : index,
  vstate (IM i)
  ‚Üí list
      (vtransition_item (IM i) *
       vstate (IM i))</span></span></span><br><span><var>state_size</var><span class="hyp-type"><b>: </b><span><span class="kr">‚àÄ</span> <span class="nv">i</span> : index, vstate (IM i) ‚Üí nat</span></span></span><br><span><var>H0</var><span class="hyp-type"><b>: </b><span><span class="kr">‚àÄ</span> <span class="nv">i</span> : index,
  TraceableVLSM (IM i) 
    (state_destructor i) 
    (state_size i)</span></span></span><br><span><var>Free</var><span><span class="hyp-body"><b>:= </b><span>free_composite_vlsm IM</span></span><span class="hyp-type"><b>: </b><span>VLSM message</span></span></span></span><br><span><var>RFree</var><span><span class="hyp-body"><b>:= </b><span>pre_loaded_with_all_messages_vlsm Free</span></span><span class="hyp-type"><b>: </b><span>VLSM message</span></span></span></span><br><span><var>choose</var><span class="hyp-type"><b>: </b><span>choice_function</span></span></span><br><span><var>s'</var><span class="hyp-type"><b>: </b><span>composite_state IM</span></span></span><br><span><var>Hs'</var><span class="hyp-type"><b>: </b><span>valid_state_prop RFree s&#39;</span></span></span><br><span><var>idx</var><span class="hyp-type"><b>: </b><span>index</span></span></span><br><span><var>indices</var><span class="hyp-type"><b>: </b><span>list index</span></span></span><br><span><var>j</var><span class="hyp-type"><b>: </b><span>index</span></span></span><br><span><var>nj</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>item</var><span class="hyp-type"><b>: </b><span>composite_transition_item IM</span></span></span><br><span><var>s</var><span class="hyp-type"><b>: </b><span>composite_state IM</span></span></span><br><span><var>Hdestruct</var><span class="hyp-type"><b>: </b><span>composite_state_destructor s&#39; (j, nj).<span class="mi">1</span>
!! (j, nj).<span class="mi">2</span> = Some (item, s)</span></span></span><br><span><var>Hchoice</var><span class="hyp-type"><b>: </b><span>choose s&#39; Hs&#39; (idx :: indices) = (j, nj)</span></span></span><br><span><var>is</var><span class="hyp-type"><b>: </b><span>composite_state IM</span></span></span><br><span><var>tr</var><span class="hyp-type"><b>: </b><span>list (composite_transition_item IM)</span></span></span><br><span><var>Hind</var><span class="hyp-type"><b>: </b><span><span class="kr">‚àÄ</span> <span class="nv">i</span> : index,
  vinitial_state_prop (IM i) (s i)
  ‚Üí <span class="kr">‚àÄ</span> (<span class="nv">is0</span> : composite_state IM) 
      (<span class="nv">tr0</span> : list
               (composite_transition_item IM)),
      (<span class="kr">is</span>, tr) = (is0, tr0)
      ‚Üí <span class="kr">‚àÄ</span> <span class="nv">item</span> : transition_item,
          item ‚àà tr0 ‚Üí destination item i = s i</span></span></span><br><span><var>i</var><span class="hyp-type"><b>: </b><span>index</span></span></span><br><span><var>Hi</var><span class="hyp-type"><b>: </b><span>vinitial_state_prop (IM i) (s i)</span></span></span><br><span><var>_item</var><span class="hyp-type"><b>: </b><span>transition_item</span></span></span><br><span><var>H_item</var><span class="hyp-type"><b>: </b><span>_item ‚àà tr</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">destination _item i = s i</div></blockquote><div class="alectryon-extra-goals"><input class="alectryon-extra-goal-toggle" id="TraceableVLSM-v-chkcf" style="display: none" type="checkbox"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>message, index</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>EqDecision0</var><span class="hyp-type"><b>: </b><span>EqDecision index</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>finite.Finite index</span></span></span><br><span><var>IM</var><span class="hyp-type"><b>: </b><span>index ‚Üí VLSM message</span></span></span><br><span><var>state_destructor</var><span class="hyp-type"><b>: </b><span><span class="kr">‚àÄ</span> <span class="nv">i</span> : index,
  vstate (IM i)
  ‚Üí list
      (vtransition_item (IM i) *
       vstate (IM i))</span></span></span><br><span><var>state_size</var><span class="hyp-type"><b>: </b><span><span class="kr">‚àÄ</span> <span class="nv">i</span> : index, vstate (IM i) ‚Üí nat</span></span></span><br><span><var>H0</var><span class="hyp-type"><b>: </b><span><span class="kr">‚àÄ</span> <span class="nv">i</span> : index,
  TraceableVLSM (IM i) 
    (state_destructor i) 
    (state_size i)</span></span></span><br><span><var>Free</var><span><span class="hyp-body"><b>:= </b><span>free_composite_vlsm IM</span></span><span class="hyp-type"><b>: </b><span>VLSM message</span></span></span></span><br><span><var>RFree</var><span><span class="hyp-body"><b>:= </b><span>pre_loaded_with_all_messages_vlsm Free</span></span><span class="hyp-type"><b>: </b><span>VLSM message</span></span></span></span><br><span><var>choose</var><span class="hyp-type"><b>: </b><span>choice_function</span></span></span><br><span><var>s'</var><span class="hyp-type"><b>: </b><span>composite_state IM</span></span></span><br><span><var>Hs'</var><span class="hyp-type"><b>: </b><span>valid_state_prop RFree s&#39;</span></span></span><br><span><var>idx</var><span class="hyp-type"><b>: </b><span>index</span></span></span><br><span><var>indices</var><span class="hyp-type"><b>: </b><span>list index</span></span></span><br><span><var>j</var><span class="hyp-type"><b>: </b><span>index</span></span></span><br><span><var>nj</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>item</var><span class="hyp-type"><b>: </b><span>composite_transition_item IM</span></span></span><br><span><var>s</var><span class="hyp-type"><b>: </b><span>composite_state IM</span></span></span><br><span><var>Hdestruct</var><span class="hyp-type"><b>: </b><span>composite_state_destructor s&#39; (j, nj).<span class="mi">1</span>
!! (j, nj).<span class="mi">2</span> = Some (item, s)</span></span></span><br><span><var>Hchoice</var><span class="hyp-type"><b>: </b><span>choose s&#39; Hs&#39; (idx :: indices) = (j, nj)</span></span></span><br><span><var>is</var><span class="hyp-type"><b>: </b><span>composite_state IM</span></span></span><br><span><var>tr</var><span class="hyp-type"><b>: </b><span>list (composite_transition_item IM)</span></span></span><br><span><var>Hind</var><span class="hyp-type"><b>: </b><span><span class="kr">‚àÄ</span> <span class="nv">i</span> : index,
  vinitial_state_prop (IM i) (s i)
  ‚Üí <span class="kr">‚àÄ</span> (<span class="nv">is0</span> : composite_state IM) 
      (<span class="nv">tr0</span> : list
               (composite_transition_item IM)),
      (<span class="kr">is</span>, tr) = (is0, tr0)
      ‚Üí <span class="kr">‚àÄ</span> <span class="nv">item</span> : transition_item,
          item ‚àà tr0 ‚Üí destination item i = s i</span></span></span><br><span><var>i</var><span class="hyp-type"><b>: </b><span>index</span></span></span><br><span><var>Hi</var><span class="hyp-type"><b>: </b><span>vinitial_state_prop (IM i) (s&#39; i)</span></span></span><br><span><var>_item</var><span class="hyp-type"><b>: </b><span>transition_item</span></span></span><br><span><var>H_item</var><span class="hyp-type"><b>: </b><span>_item ‚àà tr</span></span></span><br></div><label class="goal-separator" for="TraceableVLSM-v-chkcf"><hr></label><div class="goal-conclusion">s i = s&#39; i</div></blockquote></div></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">      </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="TraceableVLSM-v-chkd0" style="display: none" type="checkbox"><label class="alectryon-input" for="TraceableVLSM-v-chkd0">*</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>message, index</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>EqDecision0</var><span class="hyp-type"><b>: </b><span>EqDecision index</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>finite.Finite index</span></span></span><br><span><var>IM</var><span class="hyp-type"><b>: </b><span>index ‚Üí VLSM message</span></span></span><br><span><var>state_destructor</var><span class="hyp-type"><b>: </b><span><span class="kr">‚àÄ</span> <span class="nv">i</span> : index,
  vstate (IM i)
  ‚Üí list
      (vtransition_item (IM i) *
       vstate (IM i))</span></span></span><br><span><var>state_size</var><span class="hyp-type"><b>: </b><span><span class="kr">‚àÄ</span> <span class="nv">i</span> : index, vstate (IM i) ‚Üí nat</span></span></span><br><span><var>H0</var><span class="hyp-type"><b>: </b><span><span class="kr">‚àÄ</span> <span class="nv">i</span> : index,
  TraceableVLSM (IM i) 
    (state_destructor i) 
    (state_size i)</span></span></span><br><span><var>Free</var><span><span class="hyp-body"><b>:= </b><span>free_composite_vlsm IM</span></span><span class="hyp-type"><b>: </b><span>VLSM message</span></span></span></span><br><span><var>RFree</var><span><span class="hyp-body"><b>:= </b><span>pre_loaded_with_all_messages_vlsm Free</span></span><span class="hyp-type"><b>: </b><span>VLSM message</span></span></span></span><br><span><var>choose</var><span class="hyp-type"><b>: </b><span>choice_function</span></span></span><br><span><var>s'</var><span class="hyp-type"><b>: </b><span>composite_state IM</span></span></span><br><span><var>Hs'</var><span class="hyp-type"><b>: </b><span>valid_state_prop RFree s&#39;</span></span></span><br><span><var>idx</var><span class="hyp-type"><b>: </b><span>index</span></span></span><br><span><var>indices</var><span class="hyp-type"><b>: </b><span>list index</span></span></span><br><span><var>j</var><span class="hyp-type"><b>: </b><span>index</span></span></span><br><span><var>nj</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>item</var><span class="hyp-type"><b>: </b><span>composite_transition_item IM</span></span></span><br><span><var>s</var><span class="hyp-type"><b>: </b><span>composite_state IM</span></span></span><br><span><var>Hdestruct</var><span class="hyp-type"><b>: </b><span>composite_state_destructor s&#39; (j, nj).<span class="mi">1</span>
!! (j, nj).<span class="mi">2</span> = Some (item, s)</span></span></span><br><span><var>Hchoice</var><span class="hyp-type"><b>: </b><span>choose s&#39; Hs&#39; (idx :: indices) = (j, nj)</span></span></span><br><span><var>is</var><span class="hyp-type"><b>: </b><span>composite_state IM</span></span></span><br><span><var>tr</var><span class="hyp-type"><b>: </b><span>list (composite_transition_item IM)</span></span></span><br><span><var>Hind</var><span class="hyp-type"><b>: </b><span><span class="kr">‚àÄ</span> <span class="nv">i</span> : index,
  vinitial_state_prop (IM i) (s i)
  ‚Üí <span class="kr">‚àÄ</span> (<span class="nv">is0</span> : composite_state IM) 
      (<span class="nv">tr0</span> : list
               (composite_transition_item IM)),
      (<span class="kr">is</span>, tr) = (is0, tr0)
      ‚Üí <span class="kr">‚àÄ</span> <span class="nv">item</span> : transition_item,
          item ‚àà tr0 ‚Üí destination item i = s i</span></span></span><br><span><var>i</var><span class="hyp-type"><b>: </b><span>index</span></span></span><br><span><var>Hi</var><span class="hyp-type"><b>: </b><span>vinitial_state_prop (IM i) (s i)</span></span></span><br><span><var>_item</var><span class="hyp-type"><b>: </b><span>transition_item</span></span></span><br><span><var>H_item</var><span class="hyp-type"><b>: </b><span>_item ‚àà tr</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">destination _item i = s i</div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="bp">by</span> <span class="nb">eapply</span> Hind.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">      </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="TraceableVLSM-v-chkd1" style="display: none" type="checkbox"><label class="alectryon-input" for="TraceableVLSM-v-chkd1">*</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>message, index</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>EqDecision0</var><span class="hyp-type"><b>: </b><span>EqDecision index</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>finite.Finite index</span></span></span><br><span><var>IM</var><span class="hyp-type"><b>: </b><span>index ‚Üí VLSM message</span></span></span><br><span><var>state_destructor</var><span class="hyp-type"><b>: </b><span><span class="kr">‚àÄ</span> <span class="nv">i</span> : index,
  vstate (IM i)
  ‚Üí list
      (vtransition_item (IM i) *
       vstate (IM i))</span></span></span><br><span><var>state_size</var><span class="hyp-type"><b>: </b><span><span class="kr">‚àÄ</span> <span class="nv">i</span> : index, vstate (IM i) ‚Üí nat</span></span></span><br><span><var>H0</var><span class="hyp-type"><b>: </b><span><span class="kr">‚àÄ</span> <span class="nv">i</span> : index,
  TraceableVLSM (IM i) 
    (state_destructor i) 
    (state_size i)</span></span></span><br><span><var>Free</var><span><span class="hyp-body"><b>:= </b><span>free_composite_vlsm IM</span></span><span class="hyp-type"><b>: </b><span>VLSM message</span></span></span></span><br><span><var>RFree</var><span><span class="hyp-body"><b>:= </b><span>pre_loaded_with_all_messages_vlsm Free</span></span><span class="hyp-type"><b>: </b><span>VLSM message</span></span></span></span><br><span><var>choose</var><span class="hyp-type"><b>: </b><span>choice_function</span></span></span><br><span><var>s'</var><span class="hyp-type"><b>: </b><span>composite_state IM</span></span></span><br><span><var>Hs'</var><span class="hyp-type"><b>: </b><span>valid_state_prop RFree s&#39;</span></span></span><br><span><var>idx</var><span class="hyp-type"><b>: </b><span>index</span></span></span><br><span><var>indices</var><span class="hyp-type"><b>: </b><span>list index</span></span></span><br><span><var>j</var><span class="hyp-type"><b>: </b><span>index</span></span></span><br><span><var>nj</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>item</var><span class="hyp-type"><b>: </b><span>composite_transition_item IM</span></span></span><br><span><var>s</var><span class="hyp-type"><b>: </b><span>composite_state IM</span></span></span><br><span><var>Hdestruct</var><span class="hyp-type"><b>: </b><span>composite_state_destructor s&#39; (j, nj).<span class="mi">1</span>
!! (j, nj).<span class="mi">2</span> = Some (item, s)</span></span></span><br><span><var>Hchoice</var><span class="hyp-type"><b>: </b><span>choose s&#39; Hs&#39; (idx :: indices) = (j, nj)</span></span></span><br><span><var>is</var><span class="hyp-type"><b>: </b><span>composite_state IM</span></span></span><br><span><var>tr</var><span class="hyp-type"><b>: </b><span>list (composite_transition_item IM)</span></span></span><br><span><var>Hind</var><span class="hyp-type"><b>: </b><span><span class="kr">‚àÄ</span> <span class="nv">i</span> : index,
  vinitial_state_prop (IM i) (s i)
  ‚Üí <span class="kr">‚àÄ</span> (<span class="nv">is0</span> : composite_state IM) 
      (<span class="nv">tr0</span> : list
               (composite_transition_item IM)),
      (<span class="kr">is</span>, tr) = (is0, tr0)
      ‚Üí <span class="kr">‚àÄ</span> <span class="nv">item</span> : transition_item,
          item ‚àà tr0 ‚Üí destination item i = s i</span></span></span><br><span><var>i</var><span class="hyp-type"><b>: </b><span>index</span></span></span><br><span><var>Hi</var><span class="hyp-type"><b>: </b><span>vinitial_state_prop (IM i) (s&#39; i)</span></span></span><br><span><var>_item</var><span class="hyp-type"><b>: </b><span>transition_item</span></span></span><br><span><var>H_item</var><span class="hyp-type"><b>: </b><span>_item ‚àà tr</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">s i = s&#39; i</div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="bp">by</span> <span class="nb">eapply</span> composite_tv_state_destructor_reflects_initiality;
          [| <span class="nb">eapply</span> elem_of_list_lookup_2 |].</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="TraceableVLSM-v-chkd2" style="display: none" type="checkbox"><label class="alectryon-input" for="TraceableVLSM-v-chkd2">+</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>message, index</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>EqDecision0</var><span class="hyp-type"><b>: </b><span>EqDecision index</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>finite.Finite index</span></span></span><br><span><var>IM</var><span class="hyp-type"><b>: </b><span>index ‚Üí VLSM message</span></span></span><br><span><var>state_destructor</var><span class="hyp-type"><b>: </b><span><span class="kr">‚àÄ</span> <span class="nv">i</span> : index,
  vstate (IM i)
  ‚Üí list
      (vtransition_item (IM i) *
       vstate (IM i))</span></span></span><br><span><var>state_size</var><span class="hyp-type"><b>: </b><span><span class="kr">‚àÄ</span> <span class="nv">i</span> : index, vstate (IM i) ‚Üí nat</span></span></span><br><span><var>H0</var><span class="hyp-type"><b>: </b><span><span class="kr">‚àÄ</span> <span class="nv">i</span> : index,
  TraceableVLSM (IM i) 
    (state_destructor i) 
    (state_size i)</span></span></span><br><span><var>Free</var><span><span class="hyp-body"><b>:= </b><span>free_composite_vlsm IM</span></span><span class="hyp-type"><b>: </b><span>VLSM message</span></span></span></span><br><span><var>RFree</var><span><span class="hyp-body"><b>:= </b><span>pre_loaded_with_all_messages_vlsm Free</span></span><span class="hyp-type"><b>: </b><span>VLSM message</span></span></span></span><br><span><var>choose</var><span class="hyp-type"><b>: </b><span>choice_function</span></span></span><br><span><var>s'</var><span class="hyp-type"><b>: </b><span>composite_state IM</span></span></span><br><span><var>Hs'</var><span class="hyp-type"><b>: </b><span>valid_state_prop RFree s&#39;</span></span></span><br><span><var>idx</var><span class="hyp-type"><b>: </b><span>index</span></span></span><br><span><var>indices</var><span class="hyp-type"><b>: </b><span>list index</span></span></span><br><span><var>j</var><span class="hyp-type"><b>: </b><span>index</span></span></span><br><span><var>nj</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>item</var><span class="hyp-type"><b>: </b><span>composite_transition_item IM</span></span></span><br><span><var>s</var><span class="hyp-type"><b>: </b><span>composite_state IM</span></span></span><br><span><var>Hdestruct</var><span class="hyp-type"><b>: </b><span>composite_state_destructor s&#39; (j, nj).<span class="mi">1</span>
!! (j, nj).<span class="mi">2</span> = Some (item, s)</span></span></span><br><span><var>Hchoice</var><span class="hyp-type"><b>: </b><span>choose s&#39; Hs&#39; (idx :: indices) = (j, nj)</span></span></span><br><span><var>is</var><span class="hyp-type"><b>: </b><span>composite_state IM</span></span></span><br><span><var>tr</var><span class="hyp-type"><b>: </b><span>list (composite_transition_item IM)</span></span></span><br><span><var>Hind</var><span class="hyp-type"><b>: </b><span><span class="kr">‚àÄ</span> <span class="nv">i</span> : index,
  vinitial_state_prop (IM i) (s i)
  ‚Üí <span class="kr">‚àÄ</span> (<span class="nv">is0</span> : composite_state IM) 
      (<span class="nv">tr0</span> : list
               (composite_transition_item IM)),
      (<span class="kr">is</span>, tr) = (is0, tr0)
      ‚Üí <span class="kr">‚àÄ</span> <span class="nv">item</span> : transition_item,
          item ‚àà tr0 ‚Üí destination item i = s i</span></span></span><br><span><var>i</var><span class="hyp-type"><b>: </b><span>index</span></span></span><br><span><var>Hi</var><span class="hyp-type"><b>: </b><span>vinitial_state_prop (IM i) (s&#39; i)</span></span></span><br><span><var>_item</var><span class="hyp-type"><b>: </b><span>transition_item</span></span></span><br><span><var>H_item</var><span class="hyp-type"><b>: </b><span>_item ‚àà [item]</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">destination _item i = s&#39; i</div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="TraceableVLSM-v-chkd3" style="display: none" type="checkbox"><label class="alectryon-input" for="TraceableVLSM-v-chkd3"><span class="nb">apply</span> elem_of_list_singleton <span class="kr">in</span> H_item <span class="kr">as</span> -&gt;.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>message, index</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>EqDecision0</var><span class="hyp-type"><b>: </b><span>EqDecision index</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>finite.Finite index</span></span></span><br><span><var>IM</var><span class="hyp-type"><b>: </b><span>index ‚Üí VLSM message</span></span></span><br><span><var>state_destructor</var><span class="hyp-type"><b>: </b><span><span class="kr">‚àÄ</span> <span class="nv">i</span> : index,
  vstate (IM i)
  ‚Üí list
      (vtransition_item (IM i) *
       vstate (IM i))</span></span></span><br><span><var>state_size</var><span class="hyp-type"><b>: </b><span><span class="kr">‚àÄ</span> <span class="nv">i</span> : index, vstate (IM i) ‚Üí nat</span></span></span><br><span><var>H0</var><span class="hyp-type"><b>: </b><span><span class="kr">‚àÄ</span> <span class="nv">i</span> : index,
  TraceableVLSM (IM i) 
    (state_destructor i) 
    (state_size i)</span></span></span><br><span><var>Free</var><span><span class="hyp-body"><b>:= </b><span>free_composite_vlsm IM</span></span><span class="hyp-type"><b>: </b><span>VLSM message</span></span></span></span><br><span><var>RFree</var><span><span class="hyp-body"><b>:= </b><span>pre_loaded_with_all_messages_vlsm Free</span></span><span class="hyp-type"><b>: </b><span>VLSM message</span></span></span></span><br><span><var>choose</var><span class="hyp-type"><b>: </b><span>choice_function</span></span></span><br><span><var>s'</var><span class="hyp-type"><b>: </b><span>composite_state IM</span></span></span><br><span><var>Hs'</var><span class="hyp-type"><b>: </b><span>valid_state_prop RFree s&#39;</span></span></span><br><span><var>idx</var><span class="hyp-type"><b>: </b><span>index</span></span></span><br><span><var>indices</var><span class="hyp-type"><b>: </b><span>list index</span></span></span><br><span><var>j</var><span class="hyp-type"><b>: </b><span>index</span></span></span><br><span><var>nj</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>item</var><span class="hyp-type"><b>: </b><span>composite_transition_item IM</span></span></span><br><span><var>s</var><span class="hyp-type"><b>: </b><span>composite_state IM</span></span></span><br><span><var>Hdestruct</var><span class="hyp-type"><b>: </b><span>composite_state_destructor s&#39; (j, nj).<span class="mi">1</span>
!! (j, nj).<span class="mi">2</span> = Some (item, s)</span></span></span><br><span><var>Hchoice</var><span class="hyp-type"><b>: </b><span>choose s&#39; Hs&#39; (idx :: indices) = (j, nj)</span></span></span><br><span><var>is</var><span class="hyp-type"><b>: </b><span>composite_state IM</span></span></span><br><span><var>tr</var><span class="hyp-type"><b>: </b><span>list (composite_transition_item IM)</span></span></span><br><span><var>Hind</var><span class="hyp-type"><b>: </b><span><span class="kr">‚àÄ</span> <span class="nv">i</span> : index,
  vinitial_state_prop (IM i) (s i)
  ‚Üí <span class="kr">‚àÄ</span> (<span class="nv">is0</span> : composite_state IM) 
      (<span class="nv">tr0</span> : list
               (composite_transition_item IM)),
      (<span class="kr">is</span>, tr) = (is0, tr0)
      ‚Üí <span class="kr">‚àÄ</span> <span class="nv">item</span> : transition_item,
          item ‚àà tr0 ‚Üí destination item i = s i</span></span></span><br><span><var>i</var><span class="hyp-type"><b>: </b><span>index</span></span></span><br><span><var>Hi</var><span class="hyp-type"><b>: </b><span>vinitial_state_prop (IM i) (s&#39; i)</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">destination item i = s&#39; i</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">      </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="TraceableVLSM-v-chkd4" style="display: none" type="checkbox"><label class="alectryon-input" for="TraceableVLSM-v-chkd4"><span class="nb">erewrite</span> composite_tv_state_destructor_destination; [<span class="bp">done</span> |].</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>message, index</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>EqDecision0</var><span class="hyp-type"><b>: </b><span>EqDecision index</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>finite.Finite index</span></span></span><br><span><var>IM</var><span class="hyp-type"><b>: </b><span>index ‚Üí VLSM message</span></span></span><br><span><var>state_destructor</var><span class="hyp-type"><b>: </b><span><span class="kr">‚àÄ</span> <span class="nv">i</span> : index,
  vstate (IM i)
  ‚Üí list
      (vtransition_item (IM i) *
       vstate (IM i))</span></span></span><br><span><var>state_size</var><span class="hyp-type"><b>: </b><span><span class="kr">‚àÄ</span> <span class="nv">i</span> : index, vstate (IM i) ‚Üí nat</span></span></span><br><span><var>H0</var><span class="hyp-type"><b>: </b><span><span class="kr">‚àÄ</span> <span class="nv">i</span> : index,
  TraceableVLSM (IM i) 
    (state_destructor i) 
    (state_size i)</span></span></span><br><span><var>Free</var><span><span class="hyp-body"><b>:= </b><span>free_composite_vlsm IM</span></span><span class="hyp-type"><b>: </b><span>VLSM message</span></span></span></span><br><span><var>RFree</var><span><span class="hyp-body"><b>:= </b><span>pre_loaded_with_all_messages_vlsm Free</span></span><span class="hyp-type"><b>: </b><span>VLSM message</span></span></span></span><br><span><var>choose</var><span class="hyp-type"><b>: </b><span>choice_function</span></span></span><br><span><var>s'</var><span class="hyp-type"><b>: </b><span>composite_state IM</span></span></span><br><span><var>Hs'</var><span class="hyp-type"><b>: </b><span>valid_state_prop RFree s&#39;</span></span></span><br><span><var>idx</var><span class="hyp-type"><b>: </b><span>index</span></span></span><br><span><var>indices</var><span class="hyp-type"><b>: </b><span>list index</span></span></span><br><span><var>j</var><span class="hyp-type"><b>: </b><span>index</span></span></span><br><span><var>nj</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>item</var><span class="hyp-type"><b>: </b><span>composite_transition_item IM</span></span></span><br><span><var>s</var><span class="hyp-type"><b>: </b><span>composite_state IM</span></span></span><br><span><var>Hdestruct</var><span class="hyp-type"><b>: </b><span>composite_state_destructor s&#39; (j, nj).<span class="mi">1</span>
!! (j, nj).<span class="mi">2</span> = Some (item, s)</span></span></span><br><span><var>Hchoice</var><span class="hyp-type"><b>: </b><span>choose s&#39; Hs&#39; (idx :: indices) = (j, nj)</span></span></span><br><span><var>is</var><span class="hyp-type"><b>: </b><span>composite_state IM</span></span></span><br><span><var>tr</var><span class="hyp-type"><b>: </b><span>list (composite_transition_item IM)</span></span></span><br><span><var>Hind</var><span class="hyp-type"><b>: </b><span><span class="kr">‚àÄ</span> <span class="nv">i</span> : index,
  vinitial_state_prop (IM i) (s i)
  ‚Üí <span class="kr">‚àÄ</span> (<span class="nv">is0</span> : composite_state IM) 
      (<span class="nv">tr0</span> : list
               (composite_transition_item IM)),
      (<span class="kr">is</span>, tr) = (is0, tr0)
      ‚Üí <span class="kr">‚àÄ</span> <span class="nv">item</span> : transition_item,
          item ‚àà tr0 ‚Üí destination item i = s i</span></span></span><br><span><var>i</var><span class="hyp-type"><b>: </b><span>index</span></span></span><br><span><var>Hi</var><span class="hyp-type"><b>: </b><span>vinitial_state_prop (IM i) (s&#39; i)</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">(item, <span class="nl">?s</span>) ‚àà composite_state_destructor s&#39; <span class="nl">?i</span></div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">      </span><span class="alectryon-sentence"><span class="alectryon-input"><span class="bp">by</span> <span class="nb">eapply</span> elem_of_list_lookup_2.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="TraceableVLSM-v-chkd5" style="display: none" type="checkbox"><label class="alectryon-input" for="TraceableVLSM-v-chkd5">-</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>message, index</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>EqDecision0</var><span class="hyp-type"><b>: </b><span>EqDecision index</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>finite.Finite index</span></span></span><br><span><var>IM</var><span class="hyp-type"><b>: </b><span>index ‚Üí VLSM message</span></span></span><br><span><var>state_destructor</var><span class="hyp-type"><b>: </b><span><span class="kr">‚àÄ</span> <span class="nv">i</span> : index,
  vstate (IM i)
  ‚Üí list
      (vtransition_item (IM i) *
       vstate (IM i))</span></span></span><br><span><var>state_size</var><span class="hyp-type"><b>: </b><span><span class="kr">‚àÄ</span> <span class="nv">i</span> : index, vstate (IM i) ‚Üí nat</span></span></span><br><span><var>H0</var><span class="hyp-type"><b>: </b><span><span class="kr">‚àÄ</span> <span class="nv">i</span> : index,
  TraceableVLSM (IM i) 
    (state_destructor i) 
    (state_size i)</span></span></span><br><span><var>Free</var><span><span class="hyp-body"><b>:= </b><span>free_composite_vlsm IM</span></span><span class="hyp-type"><b>: </b><span>VLSM message</span></span></span></span><br><span><var>RFree</var><span><span class="hyp-body"><b>:= </b><span>pre_loaded_with_all_messages_vlsm Free</span></span><span class="hyp-type"><b>: </b><span>VLSM message</span></span></span></span><br><span><var>choose</var><span class="hyp-type"><b>: </b><span>choice_function</span></span></span><br><span><var>s'</var><span class="hyp-type"><b>: </b><span>composite_state IM</span></span></span><br><span><var>Hs'</var><span class="hyp-type"><b>: </b><span>valid_state_prop RFree s&#39;</span></span></span><br><span><var>idx</var><span class="hyp-type"><b>: </b><span>index</span></span></span><br><span><var>indices</var><span class="hyp-type"><b>: </b><span>list index</span></span></span><br><span><var>j</var><span class="hyp-type"><b>: </b><span>index</span></span></span><br><span><var>nj</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="kr">‚àÄ</span> (<span class="nv">n</span> : (j, nj).<span class="mi">1</span> ‚àâ idx :: indices) (<span class="nv">Hni</span> : decide
                                            ((j, nj).<span class="mi">1</span>
                                             ‚àà idx
                                               :: indices) =
                                          <span class="nb">right</span> n) 
  (<span class="nv">Hdestruct</span> : composite_state_destructor s&#39; (j, nj).<span class="mi">1</span>
               !! (j, nj).<span class="mi">2</span> = None) (<span class="nv">Hchoice</span> : choose
                                                 s&#39;
                                                 Hs&#39;
                                                 (idx
                                                 :: indices) =
                                               (j, nj)),
  inspect (decide ((j, nj).<span class="mi">1</span> ‚àà idx :: indices)) =
  <span class="nb">right</span> n ‚Üæ Hni
  ‚Üí inspect
      (composite_state_destructor s&#39; (j, nj).<span class="mi">1</span>
       !! (j, nj).<span class="mi">2</span>) = None ‚Üæ Hdestruct
    ‚Üí inspect (choose s&#39; Hs&#39; (idx :: indices)) =
      (j, nj) ‚Üæ Hchoice
      ‚Üí <span class="kr">‚àÄ</span> <span class="nv">i</span> : index,
          vinitial_state_prop (IM i) (s&#39; i)
          ‚Üí <span class="kr">‚àÄ</span> (<span class="nv">is</span> : composite_state IM) (<span class="nv">tr</span> : list
                                                (composite_transition_item
                                                 IM)),
              (s&#39;, []) = (<span class="kr">is</span>, tr)
              ‚Üí <span class="kr">‚àÄ</span> <span class="nv">item</span> : transition_item,
                  item ‚àà tr
                  ‚Üí destination item i = s&#39; i</div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="bp">by</span> <span class="nb">inversion</span> <span class="mi">5</span>; <span class="nb">inversion</span> <span class="mi">1</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="TraceableVLSM-v-chkd6" style="display: none" type="checkbox"><label class="alectryon-input" for="TraceableVLSM-v-chkd6">-</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>message, index</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>EqDecision0</var><span class="hyp-type"><b>: </b><span>EqDecision index</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>finite.Finite index</span></span></span><br><span><var>IM</var><span class="hyp-type"><b>: </b><span>index ‚Üí VLSM message</span></span></span><br><span><var>state_destructor</var><span class="hyp-type"><b>: </b><span><span class="kr">‚àÄ</span> <span class="nv">i</span> : index,
  vstate (IM i)
  ‚Üí list
      (vtransition_item (IM i) *
       vstate (IM i))</span></span></span><br><span><var>state_size</var><span class="hyp-type"><b>: </b><span><span class="kr">‚àÄ</span> <span class="nv">i</span> : index, vstate (IM i) ‚Üí nat</span></span></span><br><span><var>H0</var><span class="hyp-type"><b>: </b><span><span class="kr">‚àÄ</span> <span class="nv">i</span> : index,
  TraceableVLSM (IM i) 
    (state_destructor i) 
    (state_size i)</span></span></span><br><span><var>Free</var><span><span class="hyp-body"><b>:= </b><span>free_composite_vlsm IM</span></span><span class="hyp-type"><b>: </b><span>VLSM message</span></span></span></span><br><span><var>RFree</var><span><span class="hyp-body"><b>:= </b><span>pre_loaded_with_all_messages_vlsm Free</span></span><span class="hyp-type"><b>: </b><span>VLSM message</span></span></span></span><br><span><var>choose</var><span class="hyp-type"><b>: </b><span>choice_function</span></span></span><br><span><var>s'</var><span class="hyp-type"><b>: </b><span>composite_state IM</span></span></span><br><span><var>Hs'</var><span class="hyp-type"><b>: </b><span>valid_state_prop RFree s&#39;</span></span></span><br><span><var>idx</var><span class="hyp-type"><b>: </b><span>index</span></span></span><br><span><var>indices</var><span class="hyp-type"><b>: </b><span>list index</span></span></span><br><span><var>j</var><span class="hyp-type"><b>: </b><span>index</span></span></span><br><span><var>nj</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="kr">‚àÄ</span> (<span class="nv">e1</span> : composite_state_destructor s&#39; (j, nj).<span class="mi">1</span> = []) 
  (<span class="nv">Hnn</span> : decide
           (composite_state_destructor s&#39; (j, nj).<span class="mi">1</span> =
            []) = <span class="nb">left</span> e1) (<span class="nv">e0</span> : (j, nj).<span class="mi">1</span>
                                 ‚àà idx :: indices) 
  (<span class="nv">Hi</span> : decide ((j, nj).<span class="mi">1</span> ‚àà idx :: indices) = <span class="nb">left</span> e0) 
  (<span class="nv">Hdestruct</span> : composite_state_destructor s&#39; (j, nj).<span class="mi">1</span>
               !! (j, nj).<span class="mi">2</span> = None) (<span class="nv">Hchoice</span> : choose
                                                 s&#39;
                                                 Hs&#39;
                                                 (idx
                                                 :: indices) =
                                               (j, nj)),
  (<span class="kr">‚àÄ</span> <span class="nv">i</span> : index,
     vinitial_state_prop (IM i) (s&#39; i)
     ‚Üí <span class="kr">‚àÄ</span> (<span class="nv">is</span> : composite_state IM) (<span class="nv">tr</span> : list
                                           (composite_transition_item
                                              IM)),
         indexed_composite_state_to_trace choose s&#39;
           Hs&#39;
           (StdppListSet.set_remove (j, nj).<span class="mi">1</span>
              (idx :: indices)) = (<span class="kr">is</span>, tr)
         ‚Üí <span class="kr">‚àÄ</span> <span class="nv">item</span> : transition_item,
             item ‚àà tr ‚Üí destination item i = s&#39; i)
  ‚Üí inspect
      (decide
         (composite_state_destructor s&#39; (j, nj).<span class="mi">1</span> = [])) =
    <span class="nb">left</span> e1 ‚Üæ Hnn
    ‚Üí inspect (decide ((j, nj).<span class="mi">1</span> ‚àà idx :: indices)) =
      <span class="nb">left</span> e0 ‚Üæ Hi
      ‚Üí inspect
          (composite_state_destructor s&#39; (j, nj).<span class="mi">1</span>
           !! (j, nj).<span class="mi">2</span>) = None ‚Üæ Hdestruct
        ‚Üí inspect (choose s&#39; Hs&#39; (idx :: indices)) =
          (j, nj) ‚Üæ Hchoice
          ‚Üí <span class="kr">‚àÄ</span> <span class="nv">i</span> : index,
              vinitial_state_prop (IM i) (s&#39; i)
              ‚Üí <span class="kr">‚àÄ</span> (<span class="nv">is</span> : composite_state IM) (<span class="nv">tr</span> : 
                                             list
                                               (composite_transition_item
                                                 IM)),
                  indexed_composite_state_to_trace
                    choose s&#39; Hs&#39;
                    (StdppListSet.set_remove (j, nj).<span class="mi">1</span>
                       (idx :: indices)) = (<span class="kr">is</span>, tr)
                  ‚Üí <span class="kr">‚àÄ</span> <span class="nv">item</span> : transition_item,
                      item ‚àà tr
                      ‚Üí destination item i = s&#39; i</div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="bp">by</span> <span class="nb">eauto</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="TraceableVLSM-v-chkd7" style="display: none" type="checkbox"><label class="alectryon-input" for="TraceableVLSM-v-chkd7">-</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>message, index</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>EqDecision0</var><span class="hyp-type"><b>: </b><span>EqDecision index</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>finite.Finite index</span></span></span><br><span><var>IM</var><span class="hyp-type"><b>: </b><span>index ‚Üí VLSM message</span></span></span><br><span><var>state_destructor</var><span class="hyp-type"><b>: </b><span><span class="kr">‚àÄ</span> <span class="nv">i</span> : index,
  vstate (IM i)
  ‚Üí list
      (vtransition_item (IM i) *
       vstate (IM i))</span></span></span><br><span><var>state_size</var><span class="hyp-type"><b>: </b><span><span class="kr">‚àÄ</span> <span class="nv">i</span> : index, vstate (IM i) ‚Üí nat</span></span></span><br><span><var>H0</var><span class="hyp-type"><b>: </b><span><span class="kr">‚àÄ</span> <span class="nv">i</span> : index,
  TraceableVLSM (IM i) 
    (state_destructor i) 
    (state_size i)</span></span></span><br><span><var>Free</var><span><span class="hyp-body"><b>:= </b><span>free_composite_vlsm IM</span></span><span class="hyp-type"><b>: </b><span>VLSM message</span></span></span></span><br><span><var>RFree</var><span><span class="hyp-body"><b>:= </b><span>pre_loaded_with_all_messages_vlsm Free</span></span><span class="hyp-type"><b>: </b><span>VLSM message</span></span></span></span><br><span><var>choose</var><span class="hyp-type"><b>: </b><span>choice_function</span></span></span><br><span><var>s'</var><span class="hyp-type"><b>: </b><span>composite_state IM</span></span></span><br><span><var>Hs'</var><span class="hyp-type"><b>: </b><span>valid_state_prop RFree s&#39;</span></span></span><br><span><var>idx</var><span class="hyp-type"><b>: </b><span>index</span></span></span><br><span><var>indices</var><span class="hyp-type"><b>: </b><span>list index</span></span></span><br><span><var>j</var><span class="hyp-type"><b>: </b><span>index</span></span></span><br><span><var>nj</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="kr">‚àÄ</span> (<span class="nv">n</span> : composite_state_destructor s&#39; (j, nj).<span class="mi">1</span> ‚â† []) 
  (<span class="nv">Hn</span> : decide
          (composite_state_destructor s&#39; (j, nj).<span class="mi">1</span> =
           []) = <span class="nb">right</span> n) (<span class="nv">e0</span> : (j, nj).<span class="mi">1</span>
                                ‚àà idx :: indices) 
  (<span class="nv">Hi</span> : decide ((j, nj).<span class="mi">1</span> ‚àà idx :: indices) = <span class="nb">left</span> e0) 
  (<span class="nv">Hdestruct</span> : composite_state_destructor s&#39; (j, nj).<span class="mi">1</span>
               !! (j, nj).<span class="mi">2</span> = None) (<span class="nv">Hchoice</span> : choose
                                                 s&#39;
                                                 Hs&#39;
                                                 (idx
                                                 :: indices) =
                                               (j, nj)),
  inspect
    (decide
       (composite_state_destructor s&#39; (j, nj).<span class="mi">1</span> = [])) =
  <span class="nb">right</span> n ‚Üæ Hn
  ‚Üí inspect (decide ((j, nj).<span class="mi">1</span> ‚àà idx :: indices)) =
    <span class="nb">left</span> e0 ‚Üæ Hi
    ‚Üí inspect
        (composite_state_destructor s&#39; (j, nj).<span class="mi">1</span>
         !! (j, nj).<span class="mi">2</span>) = None ‚Üæ Hdestruct
      ‚Üí inspect (choose s&#39; Hs&#39; (idx :: indices)) =
        (j, nj) ‚Üæ Hchoice
        ‚Üí <span class="kr">‚àÄ</span> <span class="nv">i</span> : index,
            vinitial_state_prop (IM i) (s&#39; i)
            ‚Üí <span class="kr">‚àÄ</span> (<span class="nv">is</span> : composite_state IM) (<span class="nv">tr</span> : list
                                                 (composite_transition_item
                                                 IM)),
                (s&#39;, []) = (<span class="kr">is</span>, tr)
                ‚Üí <span class="kr">‚àÄ</span> <span class="nv">item</span> : transition_item,
                    item ‚àà tr
                    ‚Üí destination item i = s&#39; i</div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="bp">by</span> <span class="nb">inversion</span> <span class="mi">6</span>; <span class="nb">inversion</span> <span class="mi">1</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Qed</span>.</span></span></pre><div class="doc">
  The trace extracted from a state using <span class="inlinecode"><span class="id" title="var">indexed_composite_state_to_trace</span></span>
  ends in that state.

</div><pre class="alectryon-io highlight"><!-- Generator: Alectryon --><span class="alectryon-sentence"><input class="alectryon-toggle" id="TraceableVLSM-v-chkd8" style="display: none" type="checkbox"><label class="alectryon-input" for="TraceableVLSM-v-chkd8"><span class="kn">Lemma</span> <span class="nf">indexed_composite_state_to_trace_last</span> :
  <span class="kr">forall</span> (<span class="nv">choose</span> : choice_function) (<span class="nv">Hwell</span> : choosing_well choose)
    (<span class="nv">s&#39;</span> : composite_state IM) (<span class="nv">Hs&#39;</span> : valid_state_prop RFree s&#39;)
    (<span class="nv">indices</span> : list index)
    (<span class="nv">Hnodup</span> : NoDup indices)
    (<span class="nv">Hinit</span> : not_in_indices_initial_prop s&#39; indices),
    <span class="kr">forall</span> <span class="nv">is</span> <span class="nv">tr</span>,
      indexed_composite_state_to_trace choose s&#39; Hs&#39; indices = (<span class="kr">is</span>, tr) -&gt;
      finite_trace_last <span class="kr">is</span> tr = s&#39;.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>message, index</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>EqDecision0</var><span class="hyp-type"><b>: </b><span>EqDecision index</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>finite.Finite index</span></span></span><br><span><var>IM</var><span class="hyp-type"><b>: </b><span>index ‚Üí VLSM message</span></span></span><br><span><var>state_destructor</var><span class="hyp-type"><b>: </b><span><span class="kr">‚àÄ</span> <span class="nv">i</span> : index,
  vstate (IM i)
  ‚Üí list
      (vtransition_item (IM i) *
       vstate (IM i))</span></span></span><br><span><var>state_size</var><span class="hyp-type"><b>: </b><span><span class="kr">‚àÄ</span> <span class="nv">i</span> : index, vstate (IM i) ‚Üí nat</span></span></span><br><span><var>H0</var><span class="hyp-type"><b>: </b><span><span class="kr">‚àÄ</span> <span class="nv">i</span> : index,
  TraceableVLSM (IM i) 
    (state_destructor i) 
    (state_size i)</span></span></span><br><span><var>Free</var><span><span class="hyp-body"><b>:= </b><span>free_composite_vlsm IM</span></span><span class="hyp-type"><b>: </b><span>VLSM message</span></span></span></span><br><span><var>RFree</var><span><span class="hyp-body"><b>:= </b><span>pre_loaded_with_all_messages_vlsm Free</span></span><span class="hyp-type"><b>: </b><span>VLSM message</span></span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="kr">‚àÄ</span> <span class="nv">choose</span> : choice_function,
  choosing_well choose
  ‚Üí <span class="kr">‚àÄ</span> (<span class="nv">s&#39;</span> : composite_state IM) (<span class="nv">Hs&#39;</span> : valid_state_prop
                                         RFree s&#39;) 
      (<span class="nv">indices</span> : list index),
      NoDup indices
      ‚Üí not_in_indices_initial_prop s&#39; indices
        ‚Üí <span class="kr">‚àÄ</span> (<span class="nv">is</span> : composite_state IM) (<span class="nv">tr</span> : list
                                              (composite_transition_item
                                                 IM)),
            indexed_composite_state_to_trace choose s&#39;
              Hs&#39; indices = (<span class="kr">is</span>, tr)
            ‚Üí finite_trace_last <span class="kr">is</span> tr = s&#39;</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="TraceableVLSM-v-chkd9" style="display: none" type="checkbox"><label class="alectryon-input" for="TraceableVLSM-v-chkd9"><span class="kn">Proof</span>.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>message, index</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>EqDecision0</var><span class="hyp-type"><b>: </b><span>EqDecision index</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>finite.Finite index</span></span></span><br><span><var>IM</var><span class="hyp-type"><b>: </b><span>index ‚Üí VLSM message</span></span></span><br><span><var>state_destructor</var><span class="hyp-type"><b>: </b><span><span class="kr">‚àÄ</span> <span class="nv">i</span> : index,
  vstate (IM i)
  ‚Üí list
      (vtransition_item (IM i) *
       vstate (IM i))</span></span></span><br><span><var>state_size</var><span class="hyp-type"><b>: </b><span><span class="kr">‚àÄ</span> <span class="nv">i</span> : index, vstate (IM i) ‚Üí nat</span></span></span><br><span><var>H0</var><span class="hyp-type"><b>: </b><span><span class="kr">‚àÄ</span> <span class="nv">i</span> : index,
  TraceableVLSM (IM i) 
    (state_destructor i) 
    (state_size i)</span></span></span><br><span><var>Free</var><span><span class="hyp-body"><b>:= </b><span>free_composite_vlsm IM</span></span><span class="hyp-type"><b>: </b><span>VLSM message</span></span></span></span><br><span><var>RFree</var><span><span class="hyp-body"><b>:= </b><span>pre_loaded_with_all_messages_vlsm Free</span></span><span class="hyp-type"><b>: </b><span>VLSM message</span></span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="kr">‚àÄ</span> <span class="nv">choose</span> : choice_function,
  choosing_well choose
  ‚Üí <span class="kr">‚àÄ</span> (<span class="nv">s&#39;</span> : composite_state IM) (<span class="nv">Hs&#39;</span> : valid_state_prop
                                         RFree s&#39;) 
      (<span class="nv">indices</span> : list index),
      NoDup indices
      ‚Üí not_in_indices_initial_prop s&#39; indices
        ‚Üí <span class="kr">‚àÄ</span> (<span class="nv">is</span> : composite_state IM) (<span class="nv">tr</span> : list
                                              (composite_transition_item
                                                 IM)),
            indexed_composite_state_to_trace choose s&#39;
              Hs&#39; indices = (<span class="kr">is</span>, tr)
            ‚Üí finite_trace_last <span class="kr">is</span> tr = s&#39;</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="TraceableVLSM-v-chkda" style="display: none" type="checkbox"><label class="alectryon-input" for="TraceableVLSM-v-chkda"><span class="nb">intros</span> choose Hwell s&#39; Hs&#39; indices; <span class="nb">revert</span> Hwell.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>message, index</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>EqDecision0</var><span class="hyp-type"><b>: </b><span>EqDecision index</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>finite.Finite index</span></span></span><br><span><var>IM</var><span class="hyp-type"><b>: </b><span>index ‚Üí VLSM message</span></span></span><br><span><var>state_destructor</var><span class="hyp-type"><b>: </b><span><span class="kr">‚àÄ</span> <span class="nv">i</span> : index,
  vstate (IM i)
  ‚Üí list
      (vtransition_item (IM i) *
       vstate (IM i))</span></span></span><br><span><var>state_size</var><span class="hyp-type"><b>: </b><span><span class="kr">‚àÄ</span> <span class="nv">i</span> : index, vstate (IM i) ‚Üí nat</span></span></span><br><span><var>H0</var><span class="hyp-type"><b>: </b><span><span class="kr">‚àÄ</span> <span class="nv">i</span> : index,
  TraceableVLSM (IM i) 
    (state_destructor i) 
    (state_size i)</span></span></span><br><span><var>Free</var><span><span class="hyp-body"><b>:= </b><span>free_composite_vlsm IM</span></span><span class="hyp-type"><b>: </b><span>VLSM message</span></span></span></span><br><span><var>RFree</var><span><span class="hyp-body"><b>:= </b><span>pre_loaded_with_all_messages_vlsm Free</span></span><span class="hyp-type"><b>: </b><span>VLSM message</span></span></span></span><br><span><var>choose</var><span class="hyp-type"><b>: </b><span>choice_function</span></span></span><br><span><var>s'</var><span class="hyp-type"><b>: </b><span>composite_state IM</span></span></span><br><span><var>Hs'</var><span class="hyp-type"><b>: </b><span>valid_state_prop RFree s&#39;</span></span></span><br><span><var>indices</var><span class="hyp-type"><b>: </b><span>list index</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">choosing_well choose
‚Üí NoDup indices
  ‚Üí not_in_indices_initial_prop s&#39; indices
    ‚Üí <span class="kr">‚àÄ</span> (<span class="nv">is</span> : composite_state IM) (<span class="nv">tr</span> : list
                                          (composite_transition_item
                                             IM)),
        indexed_composite_state_to_trace choose s&#39; Hs&#39;
          indices = (<span class="kr">is</span>, tr)
        ‚Üí finite_trace_last <span class="kr">is</span> tr = s&#39;</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="TraceableVLSM-v-chkdb" style="display: none" type="checkbox"><label class="alectryon-input" for="TraceableVLSM-v-chkdb">apply_funelim (indexed_composite_state_to_trace choose s&#39; Hs&#39; indices);
    <span class="nb">clear</span> choose s&#39; Hs&#39; indices;
    [<span class="bp">by</span> <span class="nb">inversion</span> <span class="mi">5</span> |..];
    <span class="nb">intros</span> ? ? ? idx indices [j jn].</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>message, index</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>EqDecision0</var><span class="hyp-type"><b>: </b><span>EqDecision index</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>finite.Finite index</span></span></span><br><span><var>IM</var><span class="hyp-type"><b>: </b><span>index ‚Üí VLSM message</span></span></span><br><span><var>state_destructor</var><span class="hyp-type"><b>: </b><span><span class="kr">‚àÄ</span> <span class="nv">i</span> : index,
  vstate (IM i)
  ‚Üí list
      (vtransition_item (IM i) *
       vstate (IM i))</span></span></span><br><span><var>state_size</var><span class="hyp-type"><b>: </b><span><span class="kr">‚àÄ</span> <span class="nv">i</span> : index, vstate (IM i) ‚Üí nat</span></span></span><br><span><var>H0</var><span class="hyp-type"><b>: </b><span><span class="kr">‚àÄ</span> <span class="nv">i</span> : index,
  TraceableVLSM (IM i) 
    (state_destructor i) 
    (state_size i)</span></span></span><br><span><var>Free</var><span><span class="hyp-body"><b>:= </b><span>free_composite_vlsm IM</span></span><span class="hyp-type"><b>: </b><span>VLSM message</span></span></span></span><br><span><var>RFree</var><span><span class="hyp-body"><b>:= </b><span>pre_loaded_with_all_messages_vlsm Free</span></span><span class="hyp-type"><b>: </b><span>VLSM message</span></span></span></span><br><span><var>choose</var><span class="hyp-type"><b>: </b><span>choice_function</span></span></span><br><span><var>s'</var><span class="hyp-type"><b>: </b><span>composite_state IM</span></span></span><br><span><var>Hs'</var><span class="hyp-type"><b>: </b><span>valid_state_prop RFree s&#39;</span></span></span><br><span><var>idx</var><span class="hyp-type"><b>: </b><span>index</span></span></span><br><span><var>indices</var><span class="hyp-type"><b>: </b><span>list index</span></span></span><br><span><var>j</var><span class="hyp-type"><b>: </b><span>index</span></span></span><br><span><var>jn</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="kr">‚àÄ</span> (<span class="nv">item</span> : composite_transition_item IM) (<span class="nv">s</span> : composite_state
                                               IM) 
  (<span class="nv">Hdestruct</span> : composite_state_destructor s&#39; (j, jn).<span class="mi">1</span>
               !! (j, jn).<span class="mi">2</span> = Some (item, s)) (<span class="nv">Hchoice</span> : 
                                               choose
                                                 s&#39;
                                                 Hs&#39;
                                                 (idx
                                                 :: indices) =
                                               (j, jn)) 
  (<span class="nv">is</span> : composite_state IM) (<span class="nv">tr</span> : list
                                    (composite_transition_item
                                       IM)),
  indexed_composite_state_to_trace choose s
    (indexed_composite_state_to_trace_obligations_obligation_1
       s&#39; Hs&#39; (j, jn) item s Hdestruct)
    (idx :: indices) = (<span class="kr">is</span>, tr)
  ‚Üí (choosing_well choose
     ‚Üí NoDup (idx :: indices)
       ‚Üí not_in_indices_initial_prop s
           (idx :: indices)
         ‚Üí <span class="kr">‚àÄ</span> (<span class="nv">is0</span> : composite_state IM) (<span class="nv">tr0</span> : list
                                                 (composite_transition_item
                                                 IM)),
             indexed_composite_state_to_trace choose s
               (indexed_composite_state_to_trace_obligations_obligation_1
                  s&#39; Hs&#39; (j, jn) item s Hdestruct)
               (idx :: indices) = (is0, tr0)
             ‚Üí finite_trace_last is0 tr0 = s)
    ‚Üí inspect
        (composite_state_destructor s&#39; (j, jn).<span class="mi">1</span>
         !! (j, jn).<span class="mi">2</span>) = Some (item, s) ‚Üæ Hdestruct
      ‚Üí inspect (choose s&#39; Hs&#39; (idx :: indices)) =
        (j, jn) ‚Üæ Hchoice
        ‚Üí choosing_well choose
          ‚Üí NoDup (idx :: indices)
            ‚Üí not_in_indices_initial_prop s&#39;
                (idx :: indices)
              ‚Üí <span class="kr">‚àÄ</span> (<span class="nv">is0</span> : composite_state IM) (<span class="nv">tr0</span> : 
                                              list
                                                (composite_transition_item
                                                 IM)),
                  (<span class="kr">is</span>, tr ++ [item]) = (is0, tr0)
                  ‚Üí finite_trace_last is0 tr0 = s&#39;</div></blockquote><div class="alectryon-extra-goals"><input class="alectryon-extra-goal-toggle" id="TraceableVLSM-v-chkdc" style="display: none" type="checkbox"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>message, index</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>EqDecision0</var><span class="hyp-type"><b>: </b><span>EqDecision index</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>finite.Finite index</span></span></span><br><span><var>IM</var><span class="hyp-type"><b>: </b><span>index ‚Üí VLSM message</span></span></span><br><span><var>state_destructor</var><span class="hyp-type"><b>: </b><span><span class="kr">‚àÄ</span> <span class="nv">i</span> : index,
  vstate (IM i)
  ‚Üí list
      (vtransition_item (IM i) *
       vstate (IM i))</span></span></span><br><span><var>state_size</var><span class="hyp-type"><b>: </b><span><span class="kr">‚àÄ</span> <span class="nv">i</span> : index, vstate (IM i) ‚Üí nat</span></span></span><br><span><var>H0</var><span class="hyp-type"><b>: </b><span><span class="kr">‚àÄ</span> <span class="nv">i</span> : index,
  TraceableVLSM (IM i) 
    (state_destructor i) 
    (state_size i)</span></span></span><br><span><var>Free</var><span><span class="hyp-body"><b>:= </b><span>free_composite_vlsm IM</span></span><span class="hyp-type"><b>: </b><span>VLSM message</span></span></span></span><br><span><var>RFree</var><span><span class="hyp-body"><b>:= </b><span>pre_loaded_with_all_messages_vlsm Free</span></span><span class="hyp-type"><b>: </b><span>VLSM message</span></span></span></span><br><span><var>choose</var><span class="hyp-type"><b>: </b><span>choice_function</span></span></span><br><span><var>s'</var><span class="hyp-type"><b>: </b><span>composite_state IM</span></span></span><br><span><var>Hs'</var><span class="hyp-type"><b>: </b><span>valid_state_prop RFree s&#39;</span></span></span><br><span><var>idx</var><span class="hyp-type"><b>: </b><span>index</span></span></span><br><span><var>indices</var><span class="hyp-type"><b>: </b><span>list index</span></span></span><br><span><var>j</var><span class="hyp-type"><b>: </b><span>index</span></span></span><br><span><var>jn</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br></div><label class="goal-separator" for="TraceableVLSM-v-chkdc"><hr></label><div class="goal-conclusion"><span class="kr">‚àÄ</span> (<span class="nv">n</span> : (j, jn).<span class="mi">1</span> ‚àâ idx :: indices) 
  (<span class="nv">Hni</span> : decide ((j, jn).<span class="mi">1</span> ‚àà idx :: indices) = <span class="nb">right</span> n) 
  (<span class="nv">Hdestruct</span> : composite_state_destructor s&#39; (j, jn).<span class="mi">1</span>
               !! (j, jn).<span class="mi">2</span> = None) 
  (<span class="nv">Hchoice</span> : choose s&#39; Hs&#39; (idx :: indices) = (j, jn)),
  inspect (decide ((j, jn).<span class="mi">1</span> ‚àà idx :: indices)) =
  <span class="nb">right</span> n ‚Üæ Hni
  ‚Üí inspect
      (composite_state_destructor s&#39; (j, jn).<span class="mi">1</span>
       !! (j, jn).<span class="mi">2</span>) = 
    None ‚Üæ Hdestruct
    ‚Üí inspect (choose s&#39; Hs&#39; (idx :: indices)) =
      (j, jn) ‚Üæ Hchoice
      ‚Üí choosing_well choose
        ‚Üí NoDup (idx :: indices)
          ‚Üí not_in_indices_initial_prop s&#39;
              (idx :: indices)
            ‚Üí <span class="kr">‚àÄ</span> (<span class="nv">is</span> : composite_state IM) 
                (<span class="nv">tr</span> : list
                      (composite_transition_item IM)),
                (s&#39;, []) = (<span class="kr">is</span>, tr)
                ‚Üí finite_trace_last <span class="kr">is</span> tr = s&#39;</div></blockquote><input class="alectryon-extra-goal-toggle" id="TraceableVLSM-v-chkdd" style="display: none" type="checkbox"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>message, index</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>EqDecision0</var><span class="hyp-type"><b>: </b><span>EqDecision index</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>finite.Finite index</span></span></span><br><span><var>IM</var><span class="hyp-type"><b>: </b><span>index ‚Üí VLSM message</span></span></span><br><span><var>state_destructor</var><span class="hyp-type"><b>: </b><span><span class="kr">‚àÄ</span> <span class="nv">i</span> : index,
  vstate (IM i)
  ‚Üí list
      (vtransition_item (IM i) *
       vstate (IM i))</span></span></span><br><span><var>state_size</var><span class="hyp-type"><b>: </b><span><span class="kr">‚àÄ</span> <span class="nv">i</span> : index, vstate (IM i) ‚Üí nat</span></span></span><br><span><var>H0</var><span class="hyp-type"><b>: </b><span><span class="kr">‚àÄ</span> <span class="nv">i</span> : index,
  TraceableVLSM (IM i) 
    (state_destructor i) 
    (state_size i)</span></span></span><br><span><var>Free</var><span><span class="hyp-body"><b>:= </b><span>free_composite_vlsm IM</span></span><span class="hyp-type"><b>: </b><span>VLSM message</span></span></span></span><br><span><var>RFree</var><span><span class="hyp-body"><b>:= </b><span>pre_loaded_with_all_messages_vlsm Free</span></span><span class="hyp-type"><b>: </b><span>VLSM message</span></span></span></span><br><span><var>choose</var><span class="hyp-type"><b>: </b><span>choice_function</span></span></span><br><span><var>s'</var><span class="hyp-type"><b>: </b><span>composite_state IM</span></span></span><br><span><var>Hs'</var><span class="hyp-type"><b>: </b><span>valid_state_prop RFree s&#39;</span></span></span><br><span><var>idx</var><span class="hyp-type"><b>: </b><span>index</span></span></span><br><span><var>indices</var><span class="hyp-type"><b>: </b><span>list index</span></span></span><br><span><var>j</var><span class="hyp-type"><b>: </b><span>index</span></span></span><br><span><var>jn</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br></div><label class="goal-separator" for="TraceableVLSM-v-chkdd"><hr></label><div class="goal-conclusion"><span class="kr">‚àÄ</span> (<span class="nv">e1</span> : composite_state_destructor s&#39; (j, jn).<span class="mi">1</span> = []) 
  (<span class="nv">Hnn</span> : decide
           (composite_state_destructor s&#39; (j, jn).<span class="mi">1</span> =
            []) = <span class="nb">left</span> e1) 
  (<span class="nv">e0</span> : (j, jn).<span class="mi">1</span> ‚àà idx :: indices) 
  (<span class="nv">Hi</span> : decide ((j, jn).<span class="mi">1</span> ‚àà idx :: indices) = <span class="nb">left</span> e0) 
  (<span class="nv">Hdestruct</span> : composite_state_destructor s&#39; (j, jn).<span class="mi">1</span>
               !! (j, jn).<span class="mi">2</span> = None) 
  (<span class="nv">Hchoice</span> : choose s&#39; Hs&#39; (idx :: indices) = (j, jn)),
  (choosing_well choose
   ‚Üí NoDup
       (StdppListSet.set_remove 
          (j, jn).<span class="mi">1</span> (idx :: indices))
     ‚Üí not_in_indices_initial_prop s&#39;
         (StdppListSet.set_remove 
            (j, jn).<span class="mi">1</span> (idx :: indices))
       ‚Üí <span class="kr">‚àÄ</span> (<span class="nv">is</span> : composite_state IM) 
           (<span class="nv">tr</span> : list (composite_transition_item IM)),
           indexed_composite_state_to_trace choose s&#39;
             Hs&#39;
             (StdppListSet.set_remove 
                (j, jn).<span class="mi">1</span> 
                (idx :: indices)) = 
           (<span class="kr">is</span>, tr) ‚Üí finite_trace_last <span class="kr">is</span> tr = s&#39;)
  ‚Üí inspect
      (decide
         (composite_state_destructor s&#39; (j, jn).<span class="mi">1</span> = [])) =
    <span class="nb">left</span> e1 ‚Üæ Hnn
    ‚Üí inspect (decide ((j, jn).<span class="mi">1</span> ‚àà idx :: indices)) =
      <span class="nb">left</span> e0 ‚Üæ Hi
      ‚Üí inspect
          (composite_state_destructor s&#39; (j, jn).<span class="mi">1</span>
           !! (j, jn).<span class="mi">2</span>) = 
        None ‚Üæ Hdestruct
        ‚Üí inspect (choose s&#39; Hs&#39; (idx :: indices)) =
          (j, jn) ‚Üæ Hchoice
          ‚Üí choosing_well choose
            ‚Üí NoDup (idx :: indices)
              ‚Üí not_in_indices_initial_prop s&#39;
                  (idx :: indices)
                ‚Üí <span class="kr">‚àÄ</span> (<span class="nv">is</span> : composite_state IM) 
                    (<span class="nv">tr</span> : 
                     list
                      (composite_transition_item IM)),
                    indexed_composite_state_to_trace
                      choose s&#39; Hs&#39;
                      (StdppListSet.set_remove
                      (j, jn).<span class="mi">1</span> 
                      (idx :: indices)) = 
                    (<span class="kr">is</span>, tr)
                    ‚Üí finite_trace_last <span class="kr">is</span> tr = s&#39;</div></blockquote><input class="alectryon-extra-goal-toggle" id="TraceableVLSM-v-chkde" style="display: none" type="checkbox"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>message, index</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>EqDecision0</var><span class="hyp-type"><b>: </b><span>EqDecision index</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>finite.Finite index</span></span></span><br><span><var>IM</var><span class="hyp-type"><b>: </b><span>index ‚Üí VLSM message</span></span></span><br><span><var>state_destructor</var><span class="hyp-type"><b>: </b><span><span class="kr">‚àÄ</span> <span class="nv">i</span> : index,
  vstate (IM i)
  ‚Üí list
      (vtransition_item (IM i) *
       vstate (IM i))</span></span></span><br><span><var>state_size</var><span class="hyp-type"><b>: </b><span><span class="kr">‚àÄ</span> <span class="nv">i</span> : index, vstate (IM i) ‚Üí nat</span></span></span><br><span><var>H0</var><span class="hyp-type"><b>: </b><span><span class="kr">‚àÄ</span> <span class="nv">i</span> : index,
  TraceableVLSM (IM i) 
    (state_destructor i) 
    (state_size i)</span></span></span><br><span><var>Free</var><span><span class="hyp-body"><b>:= </b><span>free_composite_vlsm IM</span></span><span class="hyp-type"><b>: </b><span>VLSM message</span></span></span></span><br><span><var>RFree</var><span><span class="hyp-body"><b>:= </b><span>pre_loaded_with_all_messages_vlsm Free</span></span><span class="hyp-type"><b>: </b><span>VLSM message</span></span></span></span><br><span><var>choose</var><span class="hyp-type"><b>: </b><span>choice_function</span></span></span><br><span><var>s'</var><span class="hyp-type"><b>: </b><span>composite_state IM</span></span></span><br><span><var>Hs'</var><span class="hyp-type"><b>: </b><span>valid_state_prop RFree s&#39;</span></span></span><br><span><var>idx</var><span class="hyp-type"><b>: </b><span>index</span></span></span><br><span><var>indices</var><span class="hyp-type"><b>: </b><span>list index</span></span></span><br><span><var>j</var><span class="hyp-type"><b>: </b><span>index</span></span></span><br><span><var>jn</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br></div><label class="goal-separator" for="TraceableVLSM-v-chkde"><hr></label><div class="goal-conclusion"><span class="kr">‚àÄ</span> (<span class="nv">n</span> : composite_state_destructor s&#39; (j, jn).<span class="mi">1</span> ‚â† []) 
  (<span class="nv">Hn</span> : decide
          (composite_state_destructor s&#39; (j, jn).<span class="mi">1</span> =
           []) = <span class="nb">right</span> n) 
  (<span class="nv">e0</span> : (j, jn).<span class="mi">1</span> ‚àà idx :: indices) 
  (<span class="nv">Hi</span> : decide ((j, jn).<span class="mi">1</span> ‚àà idx :: indices) = <span class="nb">left</span> e0) 
  (<span class="nv">Hdestruct</span> : composite_state_destructor s&#39; (j, jn).<span class="mi">1</span>
               !! (j, jn).<span class="mi">2</span> = None) 
  (<span class="nv">Hchoice</span> : choose s&#39; Hs&#39; (idx :: indices) = (j, jn)),
  inspect
    (decide
       (composite_state_destructor s&#39; (j, jn).<span class="mi">1</span> = [])) =
  <span class="nb">right</span> n ‚Üæ Hn
  ‚Üí inspect (decide ((j, jn).<span class="mi">1</span> ‚àà idx :: indices)) =
    <span class="nb">left</span> e0 ‚Üæ Hi
    ‚Üí inspect
        (composite_state_destructor s&#39; (j, jn).<span class="mi">1</span>
         !! (j, jn).<span class="mi">2</span>) = 
      None ‚Üæ Hdestruct
      ‚Üí inspect (choose s&#39; Hs&#39; (idx :: indices)) =
        (j, jn) ‚Üæ Hchoice
        ‚Üí choosing_well choose
          ‚Üí NoDup (idx :: indices)
            ‚Üí not_in_indices_initial_prop s&#39;
                (idx :: indices)
              ‚Üí <span class="kr">‚àÄ</span> (<span class="nv">is</span> : composite_state IM) 
                  (<span class="nv">tr</span> : 
                   list 
                     (composite_transition_item IM)),
                  (s&#39;, []) = (<span class="kr">is</span>, tr)
                  ‚Üí finite_trace_last <span class="kr">is</span> tr = s&#39;</div></blockquote></div></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="TraceableVLSM-v-chkdf" style="display: none" type="checkbox"><label class="alectryon-input" for="TraceableVLSM-v-chkdf">-</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>message, index</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>EqDecision0</var><span class="hyp-type"><b>: </b><span>EqDecision index</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>finite.Finite index</span></span></span><br><span><var>IM</var><span class="hyp-type"><b>: </b><span>index ‚Üí VLSM message</span></span></span><br><span><var>state_destructor</var><span class="hyp-type"><b>: </b><span><span class="kr">‚àÄ</span> <span class="nv">i</span> : index,
  vstate (IM i)
  ‚Üí list
      (vtransition_item (IM i) *
       vstate (IM i))</span></span></span><br><span><var>state_size</var><span class="hyp-type"><b>: </b><span><span class="kr">‚àÄ</span> <span class="nv">i</span> : index, vstate (IM i) ‚Üí nat</span></span></span><br><span><var>H0</var><span class="hyp-type"><b>: </b><span><span class="kr">‚àÄ</span> <span class="nv">i</span> : index,
  TraceableVLSM (IM i) 
    (state_destructor i) 
    (state_size i)</span></span></span><br><span><var>Free</var><span><span class="hyp-body"><b>:= </b><span>free_composite_vlsm IM</span></span><span class="hyp-type"><b>: </b><span>VLSM message</span></span></span></span><br><span><var>RFree</var><span><span class="hyp-body"><b>:= </b><span>pre_loaded_with_all_messages_vlsm Free</span></span><span class="hyp-type"><b>: </b><span>VLSM message</span></span></span></span><br><span><var>choose</var><span class="hyp-type"><b>: </b><span>choice_function</span></span></span><br><span><var>s'</var><span class="hyp-type"><b>: </b><span>composite_state IM</span></span></span><br><span><var>Hs'</var><span class="hyp-type"><b>: </b><span>valid_state_prop RFree s&#39;</span></span></span><br><span><var>idx</var><span class="hyp-type"><b>: </b><span>index</span></span></span><br><span><var>indices</var><span class="hyp-type"><b>: </b><span>list index</span></span></span><br><span><var>j</var><span class="hyp-type"><b>: </b><span>index</span></span></span><br><span><var>jn</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="kr">‚àÄ</span> (<span class="nv">item</span> : composite_transition_item IM) (<span class="nv">s</span> : composite_state
                                               IM) 
  (<span class="nv">Hdestruct</span> : composite_state_destructor s&#39; (j, jn).<span class="mi">1</span>
               !! (j, jn).<span class="mi">2</span> = Some (item, s)) (<span class="nv">Hchoice</span> : 
                                               choose
                                                 s&#39;
                                                 Hs&#39;
                                                 (idx
                                                 :: indices) =
                                               (j, jn)) 
  (<span class="nv">is</span> : composite_state IM) (<span class="nv">tr</span> : list
                                    (composite_transition_item
                                       IM)),
  indexed_composite_state_to_trace choose s
    (indexed_composite_state_to_trace_obligations_obligation_1
       s&#39; Hs&#39; (j, jn) item s Hdestruct)
    (idx :: indices) = (<span class="kr">is</span>, tr)
  ‚Üí (choosing_well choose
     ‚Üí NoDup (idx :: indices)
       ‚Üí not_in_indices_initial_prop s
           (idx :: indices)
         ‚Üí <span class="kr">‚àÄ</span> (<span class="nv">is0</span> : composite_state IM) (<span class="nv">tr0</span> : list
                                                 (composite_transition_item
                                                 IM)),
             indexed_composite_state_to_trace choose s
               (indexed_composite_state_to_trace_obligations_obligation_1
                  s&#39; Hs&#39; (j, jn) item s Hdestruct)
               (idx :: indices) = (is0, tr0)
             ‚Üí finite_trace_last is0 tr0 = s)
    ‚Üí inspect
        (composite_state_destructor s&#39; (j, jn).<span class="mi">1</span>
         !! (j, jn).<span class="mi">2</span>) = Some (item, s) ‚Üæ Hdestruct
      ‚Üí inspect (choose s&#39; Hs&#39; (idx :: indices)) =
        (j, jn) ‚Üæ Hchoice
        ‚Üí choosing_well choose
          ‚Üí NoDup (idx :: indices)
            ‚Üí not_in_indices_initial_prop s&#39;
                (idx :: indices)
              ‚Üí <span class="kr">‚àÄ</span> (<span class="nv">is0</span> : composite_state IM) (<span class="nv">tr0</span> : 
                                              list
                                                (composite_transition_item
                                                 IM)),
                  (<span class="kr">is</span>, tr ++ [item]) = (is0, tr0)
                  ‚Üí finite_trace_last is0 tr0 = s&#39;</div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="TraceableVLSM-v-chke0" style="display: none" type="checkbox"><label class="alectryon-input" for="TraceableVLSM-v-chke0"><span class="nb">intros</span> * -&gt; Hind _ _ _ _ _ ? ? [= -&gt; &lt;-].</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>message, index</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>EqDecision0</var><span class="hyp-type"><b>: </b><span>EqDecision index</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>finite.Finite index</span></span></span><br><span><var>IM</var><span class="hyp-type"><b>: </b><span>index ‚Üí VLSM message</span></span></span><br><span><var>state_destructor</var><span class="hyp-type"><b>: </b><span><span class="kr">‚àÄ</span> <span class="nv">i</span> : index,
  vstate (IM i)
  ‚Üí list
      (vtransition_item (IM i) *
       vstate (IM i))</span></span></span><br><span><var>state_size</var><span class="hyp-type"><b>: </b><span><span class="kr">‚àÄ</span> <span class="nv">i</span> : index, vstate (IM i) ‚Üí nat</span></span></span><br><span><var>H0</var><span class="hyp-type"><b>: </b><span><span class="kr">‚àÄ</span> <span class="nv">i</span> : index,
  TraceableVLSM (IM i) 
    (state_destructor i) 
    (state_size i)</span></span></span><br><span><var>Free</var><span><span class="hyp-body"><b>:= </b><span>free_composite_vlsm IM</span></span><span class="hyp-type"><b>: </b><span>VLSM message</span></span></span></span><br><span><var>RFree</var><span><span class="hyp-body"><b>:= </b><span>pre_loaded_with_all_messages_vlsm Free</span></span><span class="hyp-type"><b>: </b><span>VLSM message</span></span></span></span><br><span><var>choose</var><span class="hyp-type"><b>: </b><span>choice_function</span></span></span><br><span><var>s'</var><span class="hyp-type"><b>: </b><span>composite_state IM</span></span></span><br><span><var>Hs'</var><span class="hyp-type"><b>: </b><span>valid_state_prop RFree s&#39;</span></span></span><br><span><var>idx</var><span class="hyp-type"><b>: </b><span>index</span></span></span><br><span><var>indices</var><span class="hyp-type"><b>: </b><span>list index</span></span></span><br><span><var>j</var><span class="hyp-type"><b>: </b><span>index</span></span></span><br><span><var>jn</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>item</var><span class="hyp-type"><b>: </b><span>composite_transition_item IM</span></span></span><br><span><var>s</var><span class="hyp-type"><b>: </b><span>composite_state IM</span></span></span><br><span><var>Hdestruct</var><span class="hyp-type"><b>: </b><span>composite_state_destructor s&#39; (j, jn).<span class="mi">1</span>
!! (j, jn).<span class="mi">2</span> = Some (item, s)</span></span></span><br><span><var>Hchoice</var><span class="hyp-type"><b>: </b><span>choose s&#39; Hs&#39; (idx :: indices) = (j, jn)</span></span></span><br><span><var>tr</var><span class="hyp-type"><b>: </b><span>list (composite_transition_item IM)</span></span></span><br><span><var>is0</var><span class="hyp-type"><b>: </b><span>composite_state IM</span></span></span><br><span><var>Hind</var><span class="hyp-type"><b>: </b><span>choosing_well choose
‚Üí NoDup (idx :: indices)
  ‚Üí not_in_indices_initial_prop s
      (idx :: indices)
    ‚Üí <span class="kr">‚àÄ</span> (<span class="nv">is</span> : composite_state IM) 
        (<span class="nv">tr0</span> : list
                 (composite_transition_item IM)),
        (is0, tr) = (<span class="kr">is</span>, tr0)
        ‚Üí finite_trace_last <span class="kr">is</span> tr0 = s</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">finite_trace_last is0 (tr ++ [item]) = s&#39;</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="TraceableVLSM-v-chke1" style="display: none" type="checkbox"><label class="alectryon-input" for="TraceableVLSM-v-chke1"><span class="nb">rewrite</span> finite_trace_last_is_last.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>message, index</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>EqDecision0</var><span class="hyp-type"><b>: </b><span>EqDecision index</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>finite.Finite index</span></span></span><br><span><var>IM</var><span class="hyp-type"><b>: </b><span>index ‚Üí VLSM message</span></span></span><br><span><var>state_destructor</var><span class="hyp-type"><b>: </b><span><span class="kr">‚àÄ</span> <span class="nv">i</span> : index,
  vstate (IM i)
  ‚Üí list
      (vtransition_item (IM i) *
       vstate (IM i))</span></span></span><br><span><var>state_size</var><span class="hyp-type"><b>: </b><span><span class="kr">‚àÄ</span> <span class="nv">i</span> : index, vstate (IM i) ‚Üí nat</span></span></span><br><span><var>H0</var><span class="hyp-type"><b>: </b><span><span class="kr">‚àÄ</span> <span class="nv">i</span> : index,
  TraceableVLSM (IM i) 
    (state_destructor i) 
    (state_size i)</span></span></span><br><span><var>Free</var><span><span class="hyp-body"><b>:= </b><span>free_composite_vlsm IM</span></span><span class="hyp-type"><b>: </b><span>VLSM message</span></span></span></span><br><span><var>RFree</var><span><span class="hyp-body"><b>:= </b><span>pre_loaded_with_all_messages_vlsm Free</span></span><span class="hyp-type"><b>: </b><span>VLSM message</span></span></span></span><br><span><var>choose</var><span class="hyp-type"><b>: </b><span>choice_function</span></span></span><br><span><var>s'</var><span class="hyp-type"><b>: </b><span>composite_state IM</span></span></span><br><span><var>Hs'</var><span class="hyp-type"><b>: </b><span>valid_state_prop RFree s&#39;</span></span></span><br><span><var>idx</var><span class="hyp-type"><b>: </b><span>index</span></span></span><br><span><var>indices</var><span class="hyp-type"><b>: </b><span>list index</span></span></span><br><span><var>j</var><span class="hyp-type"><b>: </b><span>index</span></span></span><br><span><var>jn</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>item</var><span class="hyp-type"><b>: </b><span>composite_transition_item IM</span></span></span><br><span><var>s</var><span class="hyp-type"><b>: </b><span>composite_state IM</span></span></span><br><span><var>Hdestruct</var><span class="hyp-type"><b>: </b><span>composite_state_destructor s&#39; (j, jn).<span class="mi">1</span>
!! (j, jn).<span class="mi">2</span> = Some (item, s)</span></span></span><br><span><var>Hchoice</var><span class="hyp-type"><b>: </b><span>choose s&#39; Hs&#39; (idx :: indices) = (j, jn)</span></span></span><br><span><var>tr</var><span class="hyp-type"><b>: </b><span>list (composite_transition_item IM)</span></span></span><br><span><var>is0</var><span class="hyp-type"><b>: </b><span>composite_state IM</span></span></span><br><span><var>Hind</var><span class="hyp-type"><b>: </b><span>choosing_well choose
‚Üí NoDup (idx :: indices)
  ‚Üí not_in_indices_initial_prop s
      (idx :: indices)
    ‚Üí <span class="kr">‚àÄ</span> (<span class="nv">is</span> : composite_state IM) 
        (<span class="nv">tr0</span> : list
                 (composite_transition_item IM)),
        (is0, tr) = (<span class="kr">is</span>, tr0)
        ‚Üí finite_trace_last <span class="kr">is</span> tr0 = s</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">destination item = s&#39;</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><span class="alectryon-input"><span class="bp">by</span> <span class="nb">eapply</span> composite_tv_state_destructor_destination, elem_of_list_lookup_2.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="TraceableVLSM-v-chke2" style="display: none" type="checkbox"><label class="alectryon-input" for="TraceableVLSM-v-chke2">-</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>message, index</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>EqDecision0</var><span class="hyp-type"><b>: </b><span>EqDecision index</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>finite.Finite index</span></span></span><br><span><var>IM</var><span class="hyp-type"><b>: </b><span>index ‚Üí VLSM message</span></span></span><br><span><var>state_destructor</var><span class="hyp-type"><b>: </b><span><span class="kr">‚àÄ</span> <span class="nv">i</span> : index,
  vstate (IM i)
  ‚Üí list
      (vtransition_item (IM i) *
       vstate (IM i))</span></span></span><br><span><var>state_size</var><span class="hyp-type"><b>: </b><span><span class="kr">‚àÄ</span> <span class="nv">i</span> : index, vstate (IM i) ‚Üí nat</span></span></span><br><span><var>H0</var><span class="hyp-type"><b>: </b><span><span class="kr">‚àÄ</span> <span class="nv">i</span> : index,
  TraceableVLSM (IM i) 
    (state_destructor i) 
    (state_size i)</span></span></span><br><span><var>Free</var><span><span class="hyp-body"><b>:= </b><span>free_composite_vlsm IM</span></span><span class="hyp-type"><b>: </b><span>VLSM message</span></span></span></span><br><span><var>RFree</var><span><span class="hyp-body"><b>:= </b><span>pre_loaded_with_all_messages_vlsm Free</span></span><span class="hyp-type"><b>: </b><span>VLSM message</span></span></span></span><br><span><var>choose</var><span class="hyp-type"><b>: </b><span>choice_function</span></span></span><br><span><var>s'</var><span class="hyp-type"><b>: </b><span>composite_state IM</span></span></span><br><span><var>Hs'</var><span class="hyp-type"><b>: </b><span>valid_state_prop RFree s&#39;</span></span></span><br><span><var>idx</var><span class="hyp-type"><b>: </b><span>index</span></span></span><br><span><var>indices</var><span class="hyp-type"><b>: </b><span>list index</span></span></span><br><span><var>j</var><span class="hyp-type"><b>: </b><span>index</span></span></span><br><span><var>jn</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="kr">‚àÄ</span> (<span class="nv">n</span> : (j, jn).<span class="mi">1</span> ‚àâ idx :: indices) (<span class="nv">Hni</span> : decide
                                            ((j, jn).<span class="mi">1</span>
                                             ‚àà idx
                                               :: indices) =
                                          <span class="nb">right</span> n) 
  (<span class="nv">Hdestruct</span> : composite_state_destructor s&#39; (j, jn).<span class="mi">1</span>
               !! (j, jn).<span class="mi">2</span> = None) (<span class="nv">Hchoice</span> : choose
                                                 s&#39;
                                                 Hs&#39;
                                                 (idx
                                                 :: indices) =
                                               (j, jn)),
  inspect (decide ((j, jn).<span class="mi">1</span> ‚àà idx :: indices)) =
  <span class="nb">right</span> n ‚Üæ Hni
  ‚Üí inspect
      (composite_state_destructor s&#39; (j, jn).<span class="mi">1</span>
       !! (j, jn).<span class="mi">2</span>) = None ‚Üæ Hdestruct
    ‚Üí inspect (choose s&#39; Hs&#39; (idx :: indices)) =
      (j, jn) ‚Üæ Hchoice
      ‚Üí choosing_well choose
        ‚Üí NoDup (idx :: indices)
          ‚Üí not_in_indices_initial_prop s&#39;
              (idx :: indices)
            ‚Üí <span class="kr">‚àÄ</span> (<span class="nv">is</span> : composite_state IM) (<span class="nv">tr</span> : list
                                                 (composite_transition_item
                                                 IM)),
                (s&#39;, []) = (<span class="kr">is</span>, tr)
                ‚Üí finite_trace_last <span class="kr">is</span> tr = s&#39;</div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="bp">by</span> <span class="nb">inversion</span> <span class="mi">7</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="TraceableVLSM-v-chke3" style="display: none" type="checkbox"><label class="alectryon-input" for="TraceableVLSM-v-chke3">-</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>message, index</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>EqDecision0</var><span class="hyp-type"><b>: </b><span>EqDecision index</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>finite.Finite index</span></span></span><br><span><var>IM</var><span class="hyp-type"><b>: </b><span>index ‚Üí VLSM message</span></span></span><br><span><var>state_destructor</var><span class="hyp-type"><b>: </b><span><span class="kr">‚àÄ</span> <span class="nv">i</span> : index,
  vstate (IM i)
  ‚Üí list
      (vtransition_item (IM i) *
       vstate (IM i))</span></span></span><br><span><var>state_size</var><span class="hyp-type"><b>: </b><span><span class="kr">‚àÄ</span> <span class="nv">i</span> : index, vstate (IM i) ‚Üí nat</span></span></span><br><span><var>H0</var><span class="hyp-type"><b>: </b><span><span class="kr">‚àÄ</span> <span class="nv">i</span> : index,
  TraceableVLSM (IM i) 
    (state_destructor i) 
    (state_size i)</span></span></span><br><span><var>Free</var><span><span class="hyp-body"><b>:= </b><span>free_composite_vlsm IM</span></span><span class="hyp-type"><b>: </b><span>VLSM message</span></span></span></span><br><span><var>RFree</var><span><span class="hyp-body"><b>:= </b><span>pre_loaded_with_all_messages_vlsm Free</span></span><span class="hyp-type"><b>: </b><span>VLSM message</span></span></span></span><br><span><var>choose</var><span class="hyp-type"><b>: </b><span>choice_function</span></span></span><br><span><var>s'</var><span class="hyp-type"><b>: </b><span>composite_state IM</span></span></span><br><span><var>Hs'</var><span class="hyp-type"><b>: </b><span>valid_state_prop RFree s&#39;</span></span></span><br><span><var>idx</var><span class="hyp-type"><b>: </b><span>index</span></span></span><br><span><var>indices</var><span class="hyp-type"><b>: </b><span>list index</span></span></span><br><span><var>j</var><span class="hyp-type"><b>: </b><span>index</span></span></span><br><span><var>jn</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="kr">‚àÄ</span> (<span class="nv">e1</span> : composite_state_destructor s&#39; (j, jn).<span class="mi">1</span> = []) 
  (<span class="nv">Hnn</span> : decide
           (composite_state_destructor s&#39; (j, jn).<span class="mi">1</span> =
            []) = <span class="nb">left</span> e1) (<span class="nv">e0</span> : (j, jn).<span class="mi">1</span>
                                 ‚àà idx :: indices) 
  (<span class="nv">Hi</span> : decide ((j, jn).<span class="mi">1</span> ‚àà idx :: indices) = <span class="nb">left</span> e0) 
  (<span class="nv">Hdestruct</span> : composite_state_destructor s&#39; (j, jn).<span class="mi">1</span>
               !! (j, jn).<span class="mi">2</span> = None) (<span class="nv">Hchoice</span> : choose
                                                 s&#39;
                                                 Hs&#39;
                                                 (idx
                                                 :: indices) =
                                               (j, jn)),
  (choosing_well choose
   ‚Üí NoDup
       (StdppListSet.set_remove (j, jn).<span class="mi">1</span>
          (idx :: indices))
     ‚Üí not_in_indices_initial_prop s&#39;
         (StdppListSet.set_remove (j, jn).<span class="mi">1</span>
            (idx :: indices))
       ‚Üí <span class="kr">‚àÄ</span> (<span class="nv">is</span> : composite_state IM) (<span class="nv">tr</span> : list
                                             (composite_transition_item
                                                IM)),
           indexed_composite_state_to_trace choose s&#39;
             Hs&#39;
             (StdppListSet.set_remove (j, jn).<span class="mi">1</span>
                (idx :: indices)) = (<span class="kr">is</span>, tr)
           ‚Üí finite_trace_last <span class="kr">is</span> tr = s&#39;)
  ‚Üí inspect
      (decide
         (composite_state_destructor s&#39; (j, jn).<span class="mi">1</span> = [])) =
    <span class="nb">left</span> e1 ‚Üæ Hnn
    ‚Üí inspect (decide ((j, jn).<span class="mi">1</span> ‚àà idx :: indices)) =
      <span class="nb">left</span> e0 ‚Üæ Hi
      ‚Üí inspect
          (composite_state_destructor s&#39; (j, jn).<span class="mi">1</span>
           !! (j, jn).<span class="mi">2</span>) = None ‚Üæ Hdestruct
        ‚Üí inspect (choose s&#39; Hs&#39; (idx :: indices)) =
          (j, jn) ‚Üæ Hchoice
          ‚Üí choosing_well choose
            ‚Üí NoDup (idx :: indices)
              ‚Üí not_in_indices_initial_prop s&#39;
                  (idx :: indices)
                ‚Üí <span class="kr">‚àÄ</span> (<span class="nv">is</span> : composite_state IM) (<span class="nv">tr</span> : 
                                               list
                                                 (composite_transition_item
                                                 IM)),
                    indexed_composite_state_to_trace
                      choose s&#39; Hs&#39;
                      (StdppListSet.set_remove
                         (j, jn).<span class="mi">1</span> (idx :: indices)) =
                    (<span class="kr">is</span>, tr)
                    ‚Üí finite_trace_last <span class="kr">is</span> tr = s&#39;</div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="TraceableVLSM-v-chke4" style="display: none" type="checkbox"><label class="alectryon-input" for="TraceableVLSM-v-chke4"><span class="nb">intros</span> * Hind _ _ _ _ **; <span class="nb">apply</span> Hind; [<span class="bp">done</span> | | | <span class="bp">done</span>].</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>message, index</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>EqDecision0</var><span class="hyp-type"><b>: </b><span>EqDecision index</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>finite.Finite index</span></span></span><br><span><var>IM</var><span class="hyp-type"><b>: </b><span>index ‚Üí VLSM message</span></span></span><br><span><var>state_destructor</var><span class="hyp-type"><b>: </b><span><span class="kr">‚àÄ</span> <span class="nv">i</span> : index,
  vstate (IM i)
  ‚Üí list
      (vtransition_item (IM i) *
       vstate (IM i))</span></span></span><br><span><var>state_size</var><span class="hyp-type"><b>: </b><span><span class="kr">‚àÄ</span> <span class="nv">i</span> : index, vstate (IM i) ‚Üí nat</span></span></span><br><span><var>H0</var><span class="hyp-type"><b>: </b><span><span class="kr">‚àÄ</span> <span class="nv">i</span> : index,
  TraceableVLSM (IM i) 
    (state_destructor i) 
    (state_size i)</span></span></span><br><span><var>Free</var><span><span class="hyp-body"><b>:= </b><span>free_composite_vlsm IM</span></span><span class="hyp-type"><b>: </b><span>VLSM message</span></span></span></span><br><span><var>RFree</var><span><span class="hyp-body"><b>:= </b><span>pre_loaded_with_all_messages_vlsm Free</span></span><span class="hyp-type"><b>: </b><span>VLSM message</span></span></span></span><br><span><var>choose</var><span class="hyp-type"><b>: </b><span>choice_function</span></span></span><br><span><var>s'</var><span class="hyp-type"><b>: </b><span>composite_state IM</span></span></span><br><span><var>Hs'</var><span class="hyp-type"><b>: </b><span>valid_state_prop RFree s&#39;</span></span></span><br><span><var>idx</var><span class="hyp-type"><b>: </b><span>index</span></span></span><br><span><var>indices</var><span class="hyp-type"><b>: </b><span>list index</span></span></span><br><span><var>j</var><span class="hyp-type"><b>: </b><span>index</span></span></span><br><span><var>jn</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>e1</var><span class="hyp-type"><b>: </b><span>composite_state_destructor s&#39; (j, jn).<span class="mi">1</span> = []</span></span></span><br><span><var>Hnn</var><span class="hyp-type"><b>: </b><span>decide
  (composite_state_destructor s&#39; (j, jn).<span class="mi">1</span> = []) =
<span class="nb">left</span> e1</span></span></span><br><span><var>e0</var><span class="hyp-type"><b>: </b><span>(j, jn).<span class="mi">1</span> ‚àà idx :: indices</span></span></span><br><span><var>Hi</var><span class="hyp-type"><b>: </b><span>decide ((j, jn).<span class="mi">1</span> ‚àà idx :: indices) = <span class="nb">left</span> e0</span></span></span><br><span><var>Hdestruct</var><span class="hyp-type"><b>: </b><span>composite_state_destructor s&#39; (j, jn).<span class="mi">1</span>
!! (j, jn).<span class="mi">2</span> = None</span></span></span><br><span><var>Hchoice</var><span class="hyp-type"><b>: </b><span>choose s&#39; Hs&#39; (idx :: indices) = (j, jn)</span></span></span><br><span><var>Hind</var><span class="hyp-type"><b>: </b><span>choosing_well choose
‚Üí NoDup
    (StdppListSet.set_remove 
       (j, jn).<span class="mi">1</span> (idx :: indices))
  ‚Üí not_in_indices_initial_prop s&#39;
      (StdppListSet.set_remove 
         (j, jn).<span class="mi">1</span> (idx :: indices))
    ‚Üí <span class="kr">‚àÄ</span> (<span class="nv">is</span> : composite_state IM) 
        (<span class="nv">tr</span> : list
                (composite_transition_item IM)),
        indexed_composite_state_to_trace choose
          s&#39; Hs&#39;
          (StdppListSet.set_remove 
             (j, jn).<span class="mi">1</span> 
             (idx :: indices)) = 
        (<span class="kr">is</span>, tr) ‚Üí finite_trace_last <span class="kr">is</span> tr = s&#39;</span></span></span><br><span><var>Hwell</var><span class="hyp-type"><b>: </b><span>choosing_well choose</span></span></span><br><span><var>Hnodup</var><span class="hyp-type"><b>: </b><span>NoDup (idx :: indices)</span></span></span><br><span><var>Hinit</var><span class="hyp-type"><b>: </b><span>not_in_indices_initial_prop s&#39;
  (idx :: indices)</span></span></span><br><span><var>is</var><span class="hyp-type"><b>: </b><span>composite_state IM</span></span></span><br><span><var>tr</var><span class="hyp-type"><b>: </b><span>list (composite_transition_item IM)</span></span></span><br><span><var>H1</var><span class="hyp-type"><b>: </b><span>indexed_composite_state_to_trace choose s&#39; Hs&#39;
  (StdppListSet.set_remove 
     (j, jn).<span class="mi">1</span> (idx :: indices)) = 
(<span class="kr">is</span>, tr)</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">NoDup
  (StdppListSet.set_remove (j, jn).<span class="mi">1</span> (idx :: indices))</div></blockquote><div class="alectryon-extra-goals"><input class="alectryon-extra-goal-toggle" id="TraceableVLSM-v-chke5" style="display: none" type="checkbox"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>message, index</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>EqDecision0</var><span class="hyp-type"><b>: </b><span>EqDecision index</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>finite.Finite index</span></span></span><br><span><var>IM</var><span class="hyp-type"><b>: </b><span>index ‚Üí VLSM message</span></span></span><br><span><var>state_destructor</var><span class="hyp-type"><b>: </b><span><span class="kr">‚àÄ</span> <span class="nv">i</span> : index,
  vstate (IM i)
  ‚Üí list
      (vtransition_item (IM i) *
       vstate (IM i))</span></span></span><br><span><var>state_size</var><span class="hyp-type"><b>: </b><span><span class="kr">‚àÄ</span> <span class="nv">i</span> : index, vstate (IM i) ‚Üí nat</span></span></span><br><span><var>H0</var><span class="hyp-type"><b>: </b><span><span class="kr">‚àÄ</span> <span class="nv">i</span> : index,
  TraceableVLSM (IM i) 
    (state_destructor i) 
    (state_size i)</span></span></span><br><span><var>Free</var><span><span class="hyp-body"><b>:= </b><span>free_composite_vlsm IM</span></span><span class="hyp-type"><b>: </b><span>VLSM message</span></span></span></span><br><span><var>RFree</var><span><span class="hyp-body"><b>:= </b><span>pre_loaded_with_all_messages_vlsm Free</span></span><span class="hyp-type"><b>: </b><span>VLSM message</span></span></span></span><br><span><var>choose</var><span class="hyp-type"><b>: </b><span>choice_function</span></span></span><br><span><var>s'</var><span class="hyp-type"><b>: </b><span>composite_state IM</span></span></span><br><span><var>Hs'</var><span class="hyp-type"><b>: </b><span>valid_state_prop RFree s&#39;</span></span></span><br><span><var>idx</var><span class="hyp-type"><b>: </b><span>index</span></span></span><br><span><var>indices</var><span class="hyp-type"><b>: </b><span>list index</span></span></span><br><span><var>j</var><span class="hyp-type"><b>: </b><span>index</span></span></span><br><span><var>jn</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>e1</var><span class="hyp-type"><b>: </b><span>composite_state_destructor s&#39; (j, jn).<span class="mi">1</span> = []</span></span></span><br><span><var>Hnn</var><span class="hyp-type"><b>: </b><span>decide
  (composite_state_destructor s&#39; (j, jn).<span class="mi">1</span> = []) =
<span class="nb">left</span> e1</span></span></span><br><span><var>e0</var><span class="hyp-type"><b>: </b><span>(j, jn).<span class="mi">1</span> ‚àà idx :: indices</span></span></span><br><span><var>Hi</var><span class="hyp-type"><b>: </b><span>decide ((j, jn).<span class="mi">1</span> ‚àà idx :: indices) = <span class="nb">left</span> e0</span></span></span><br><span><var>Hdestruct</var><span class="hyp-type"><b>: </b><span>composite_state_destructor s&#39; (j, jn).<span class="mi">1</span>
!! (j, jn).<span class="mi">2</span> = None</span></span></span><br><span><var>Hchoice</var><span class="hyp-type"><b>: </b><span>choose s&#39; Hs&#39; (idx :: indices) = (j, jn)</span></span></span><br><span><var>Hind</var><span class="hyp-type"><b>: </b><span>choosing_well choose
‚Üí NoDup
    (StdppListSet.set_remove 
       (j, jn).<span class="mi">1</span> (idx :: indices))
  ‚Üí not_in_indices_initial_prop s&#39;
      (StdppListSet.set_remove 
         (j, jn).<span class="mi">1</span> (idx :: indices))
    ‚Üí <span class="kr">‚àÄ</span> (<span class="nv">is</span> : composite_state IM) 
        (<span class="nv">tr</span> : list
                (composite_transition_item IM)),
        indexed_composite_state_to_trace choose
          s&#39; Hs&#39;
          (StdppListSet.set_remove 
             (j, jn).<span class="mi">1</span> 
             (idx :: indices)) = 
        (<span class="kr">is</span>, tr) ‚Üí finite_trace_last <span class="kr">is</span> tr = s&#39;</span></span></span><br><span><var>Hwell</var><span class="hyp-type"><b>: </b><span>choosing_well choose</span></span></span><br><span><var>Hnodup</var><span class="hyp-type"><b>: </b><span>NoDup (idx :: indices)</span></span></span><br><span><var>Hinit</var><span class="hyp-type"><b>: </b><span>not_in_indices_initial_prop s&#39;
  (idx :: indices)</span></span></span><br><span><var>is</var><span class="hyp-type"><b>: </b><span>composite_state IM</span></span></span><br><span><var>tr</var><span class="hyp-type"><b>: </b><span>list (composite_transition_item IM)</span></span></span><br><span><var>H1</var><span class="hyp-type"><b>: </b><span>indexed_composite_state_to_trace choose s&#39; Hs&#39;
  (StdppListSet.set_remove 
     (j, jn).<span class="mi">1</span> (idx :: indices)) = 
(<span class="kr">is</span>, tr)</span></span></span><br></div><label class="goal-separator" for="TraceableVLSM-v-chke5"><hr></label><div class="goal-conclusion">not_in_indices_initial_prop s&#39;
  (StdppListSet.set_remove (j, jn).<span class="mi">1</span> (idx :: indices))</div></blockquote></div></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="TraceableVLSM-v-chke6" style="display: none" type="checkbox"><label class="alectryon-input" for="TraceableVLSM-v-chke6">+</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>message, index</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>EqDecision0</var><span class="hyp-type"><b>: </b><span>EqDecision index</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>finite.Finite index</span></span></span><br><span><var>IM</var><span class="hyp-type"><b>: </b><span>index ‚Üí VLSM message</span></span></span><br><span><var>state_destructor</var><span class="hyp-type"><b>: </b><span><span class="kr">‚àÄ</span> <span class="nv">i</span> : index,
  vstate (IM i)
  ‚Üí list
      (vtransition_item (IM i) *
       vstate (IM i))</span></span></span><br><span><var>state_size</var><span class="hyp-type"><b>: </b><span><span class="kr">‚àÄ</span> <span class="nv">i</span> : index, vstate (IM i) ‚Üí nat</span></span></span><br><span><var>H0</var><span class="hyp-type"><b>: </b><span><span class="kr">‚àÄ</span> <span class="nv">i</span> : index,
  TraceableVLSM (IM i) 
    (state_destructor i) 
    (state_size i)</span></span></span><br><span><var>Free</var><span><span class="hyp-body"><b>:= </b><span>free_composite_vlsm IM</span></span><span class="hyp-type"><b>: </b><span>VLSM message</span></span></span></span><br><span><var>RFree</var><span><span class="hyp-body"><b>:= </b><span>pre_loaded_with_all_messages_vlsm Free</span></span><span class="hyp-type"><b>: </b><span>VLSM message</span></span></span></span><br><span><var>choose</var><span class="hyp-type"><b>: </b><span>choice_function</span></span></span><br><span><var>s'</var><span class="hyp-type"><b>: </b><span>composite_state IM</span></span></span><br><span><var>Hs'</var><span class="hyp-type"><b>: </b><span>valid_state_prop RFree s&#39;</span></span></span><br><span><var>idx</var><span class="hyp-type"><b>: </b><span>index</span></span></span><br><span><var>indices</var><span class="hyp-type"><b>: </b><span>list index</span></span></span><br><span><var>j</var><span class="hyp-type"><b>: </b><span>index</span></span></span><br><span><var>jn</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>e1</var><span class="hyp-type"><b>: </b><span>composite_state_destructor s&#39; (j, jn).<span class="mi">1</span> = []</span></span></span><br><span><var>Hnn</var><span class="hyp-type"><b>: </b><span>decide
  (composite_state_destructor s&#39; (j, jn).<span class="mi">1</span> = []) =
<span class="nb">left</span> e1</span></span></span><br><span><var>e0</var><span class="hyp-type"><b>: </b><span>(j, jn).<span class="mi">1</span> ‚àà idx :: indices</span></span></span><br><span><var>Hi</var><span class="hyp-type"><b>: </b><span>decide ((j, jn).<span class="mi">1</span> ‚àà idx :: indices) = <span class="nb">left</span> e0</span></span></span><br><span><var>Hdestruct</var><span class="hyp-type"><b>: </b><span>composite_state_destructor s&#39; (j, jn).<span class="mi">1</span>
!! (j, jn).<span class="mi">2</span> = None</span></span></span><br><span><var>Hchoice</var><span class="hyp-type"><b>: </b><span>choose s&#39; Hs&#39; (idx :: indices) = (j, jn)</span></span></span><br><span><var>Hind</var><span class="hyp-type"><b>: </b><span>choosing_well choose
‚Üí NoDup
    (StdppListSet.set_remove 
       (j, jn).<span class="mi">1</span> (idx :: indices))
  ‚Üí not_in_indices_initial_prop s&#39;
      (StdppListSet.set_remove 
         (j, jn).<span class="mi">1</span> (idx :: indices))
    ‚Üí <span class="kr">‚àÄ</span> (<span class="nv">is</span> : composite_state IM) 
        (<span class="nv">tr</span> : list
                (composite_transition_item IM)),
        indexed_composite_state_to_trace choose
          s&#39; Hs&#39;
          (StdppListSet.set_remove 
             (j, jn).<span class="mi">1</span> 
             (idx :: indices)) = 
        (<span class="kr">is</span>, tr) ‚Üí finite_trace_last <span class="kr">is</span> tr = s&#39;</span></span></span><br><span><var>Hwell</var><span class="hyp-type"><b>: </b><span>choosing_well choose</span></span></span><br><span><var>Hnodup</var><span class="hyp-type"><b>: </b><span>NoDup (idx :: indices)</span></span></span><br><span><var>Hinit</var><span class="hyp-type"><b>: </b><span>not_in_indices_initial_prop s&#39;
  (idx :: indices)</span></span></span><br><span><var>is</var><span class="hyp-type"><b>: </b><span>composite_state IM</span></span></span><br><span><var>tr</var><span class="hyp-type"><b>: </b><span>list (composite_transition_item IM)</span></span></span><br><span><var>H1</var><span class="hyp-type"><b>: </b><span>indexed_composite_state_to_trace choose s&#39; Hs&#39;
  (StdppListSet.set_remove 
     (j, jn).<span class="mi">1</span> (idx :: indices)) = 
(<span class="kr">is</span>, tr)</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">NoDup
  (StdppListSet.set_remove (j, jn).<span class="mi">1</span> (idx :: indices))</div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="bp">by</span> <span class="nb">apply</span> StdppListSet.set_remove_nodup.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="TraceableVLSM-v-chke7" style="display: none" type="checkbox"><label class="alectryon-input" for="TraceableVLSM-v-chke7">+</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>message, index</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>EqDecision0</var><span class="hyp-type"><b>: </b><span>EqDecision index</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>finite.Finite index</span></span></span><br><span><var>IM</var><span class="hyp-type"><b>: </b><span>index ‚Üí VLSM message</span></span></span><br><span><var>state_destructor</var><span class="hyp-type"><b>: </b><span><span class="kr">‚àÄ</span> <span class="nv">i</span> : index,
  vstate (IM i)
  ‚Üí list
      (vtransition_item (IM i) *
       vstate (IM i))</span></span></span><br><span><var>state_size</var><span class="hyp-type"><b>: </b><span><span class="kr">‚àÄ</span> <span class="nv">i</span> : index, vstate (IM i) ‚Üí nat</span></span></span><br><span><var>H0</var><span class="hyp-type"><b>: </b><span><span class="kr">‚àÄ</span> <span class="nv">i</span> : index,
  TraceableVLSM (IM i) 
    (state_destructor i) 
    (state_size i)</span></span></span><br><span><var>Free</var><span><span class="hyp-body"><b>:= </b><span>free_composite_vlsm IM</span></span><span class="hyp-type"><b>: </b><span>VLSM message</span></span></span></span><br><span><var>RFree</var><span><span class="hyp-body"><b>:= </b><span>pre_loaded_with_all_messages_vlsm Free</span></span><span class="hyp-type"><b>: </b><span>VLSM message</span></span></span></span><br><span><var>choose</var><span class="hyp-type"><b>: </b><span>choice_function</span></span></span><br><span><var>s'</var><span class="hyp-type"><b>: </b><span>composite_state IM</span></span></span><br><span><var>Hs'</var><span class="hyp-type"><b>: </b><span>valid_state_prop RFree s&#39;</span></span></span><br><span><var>idx</var><span class="hyp-type"><b>: </b><span>index</span></span></span><br><span><var>indices</var><span class="hyp-type"><b>: </b><span>list index</span></span></span><br><span><var>j</var><span class="hyp-type"><b>: </b><span>index</span></span></span><br><span><var>jn</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>e1</var><span class="hyp-type"><b>: </b><span>composite_state_destructor s&#39; (j, jn).<span class="mi">1</span> = []</span></span></span><br><span><var>Hnn</var><span class="hyp-type"><b>: </b><span>decide
  (composite_state_destructor s&#39; (j, jn).<span class="mi">1</span> = []) =
<span class="nb">left</span> e1</span></span></span><br><span><var>e0</var><span class="hyp-type"><b>: </b><span>(j, jn).<span class="mi">1</span> ‚àà idx :: indices</span></span></span><br><span><var>Hi</var><span class="hyp-type"><b>: </b><span>decide ((j, jn).<span class="mi">1</span> ‚àà idx :: indices) = <span class="nb">left</span> e0</span></span></span><br><span><var>Hdestruct</var><span class="hyp-type"><b>: </b><span>composite_state_destructor s&#39; (j, jn).<span class="mi">1</span>
!! (j, jn).<span class="mi">2</span> = None</span></span></span><br><span><var>Hchoice</var><span class="hyp-type"><b>: </b><span>choose s&#39; Hs&#39; (idx :: indices) = (j, jn)</span></span></span><br><span><var>Hind</var><span class="hyp-type"><b>: </b><span>choosing_well choose
‚Üí NoDup
    (StdppListSet.set_remove 
       (j, jn).<span class="mi">1</span> (idx :: indices))
  ‚Üí not_in_indices_initial_prop s&#39;
      (StdppListSet.set_remove 
         (j, jn).<span class="mi">1</span> (idx :: indices))
    ‚Üí <span class="kr">‚àÄ</span> (<span class="nv">is</span> : composite_state IM) 
        (<span class="nv">tr</span> : list
                (composite_transition_item IM)),
        indexed_composite_state_to_trace choose
          s&#39; Hs&#39;
          (StdppListSet.set_remove 
             (j, jn).<span class="mi">1</span> 
             (idx :: indices)) = 
        (<span class="kr">is</span>, tr) ‚Üí finite_trace_last <span class="kr">is</span> tr = s&#39;</span></span></span><br><span><var>Hwell</var><span class="hyp-type"><b>: </b><span>choosing_well choose</span></span></span><br><span><var>Hnodup</var><span class="hyp-type"><b>: </b><span>NoDup (idx :: indices)</span></span></span><br><span><var>Hinit</var><span class="hyp-type"><b>: </b><span>not_in_indices_initial_prop s&#39;
  (idx :: indices)</span></span></span><br><span><var>is</var><span class="hyp-type"><b>: </b><span>composite_state IM</span></span></span><br><span><var>tr</var><span class="hyp-type"><b>: </b><span>list (composite_transition_item IM)</span></span></span><br><span><var>H1</var><span class="hyp-type"><b>: </b><span>indexed_composite_state_to_trace choose s&#39; Hs&#39;
  (StdppListSet.set_remove 
     (j, jn).<span class="mi">1</span> (idx :: indices)) = 
(<span class="kr">is</span>, tr)</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">not_in_indices_initial_prop s&#39;
  (StdppListSet.set_remove (j, jn).<span class="mi">1</span> (idx :: indices))</div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="bp">by</span> <span class="nb">apply</span> set_remove_preserves_not_in_indices_initial.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="TraceableVLSM-v-chke8" style="display: none" type="checkbox"><label class="alectryon-input" for="TraceableVLSM-v-chke8">-</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>message, index</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>EqDecision0</var><span class="hyp-type"><b>: </b><span>EqDecision index</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>finite.Finite index</span></span></span><br><span><var>IM</var><span class="hyp-type"><b>: </b><span>index ‚Üí VLSM message</span></span></span><br><span><var>state_destructor</var><span class="hyp-type"><b>: </b><span><span class="kr">‚àÄ</span> <span class="nv">i</span> : index,
  vstate (IM i)
  ‚Üí list
      (vtransition_item (IM i) *
       vstate (IM i))</span></span></span><br><span><var>state_size</var><span class="hyp-type"><b>: </b><span><span class="kr">‚àÄ</span> <span class="nv">i</span> : index, vstate (IM i) ‚Üí nat</span></span></span><br><span><var>H0</var><span class="hyp-type"><b>: </b><span><span class="kr">‚àÄ</span> <span class="nv">i</span> : index,
  TraceableVLSM (IM i) 
    (state_destructor i) 
    (state_size i)</span></span></span><br><span><var>Free</var><span><span class="hyp-body"><b>:= </b><span>free_composite_vlsm IM</span></span><span class="hyp-type"><b>: </b><span>VLSM message</span></span></span></span><br><span><var>RFree</var><span><span class="hyp-body"><b>:= </b><span>pre_loaded_with_all_messages_vlsm Free</span></span><span class="hyp-type"><b>: </b><span>VLSM message</span></span></span></span><br><span><var>choose</var><span class="hyp-type"><b>: </b><span>choice_function</span></span></span><br><span><var>s'</var><span class="hyp-type"><b>: </b><span>composite_state IM</span></span></span><br><span><var>Hs'</var><span class="hyp-type"><b>: </b><span>valid_state_prop RFree s&#39;</span></span></span><br><span><var>idx</var><span class="hyp-type"><b>: </b><span>index</span></span></span><br><span><var>indices</var><span class="hyp-type"><b>: </b><span>list index</span></span></span><br><span><var>j</var><span class="hyp-type"><b>: </b><span>index</span></span></span><br><span><var>jn</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="kr">‚àÄ</span> (<span class="nv">n</span> : composite_state_destructor s&#39; (j, jn).<span class="mi">1</span> ‚â† []) 
  (<span class="nv">Hn</span> : decide
          (composite_state_destructor s&#39; (j, jn).<span class="mi">1</span> =
           []) = <span class="nb">right</span> n) (<span class="nv">e0</span> : (j, jn).<span class="mi">1</span>
                                ‚àà idx :: indices) 
  (<span class="nv">Hi</span> : decide ((j, jn).<span class="mi">1</span> ‚àà idx :: indices) = <span class="nb">left</span> e0) 
  (<span class="nv">Hdestruct</span> : composite_state_destructor s&#39; (j, jn).<span class="mi">1</span>
               !! (j, jn).<span class="mi">2</span> = None) (<span class="nv">Hchoice</span> : choose
                                                 s&#39;
                                                 Hs&#39;
                                                 (idx
                                                 :: indices) =
                                               (j, jn)),
  inspect
    (decide
       (composite_state_destructor s&#39; (j, jn).<span class="mi">1</span> = [])) =
  <span class="nb">right</span> n ‚Üæ Hn
  ‚Üí inspect (decide ((j, jn).<span class="mi">1</span> ‚àà idx :: indices)) =
    <span class="nb">left</span> e0 ‚Üæ Hi
    ‚Üí inspect
        (composite_state_destructor s&#39; (j, jn).<span class="mi">1</span>
         !! (j, jn).<span class="mi">2</span>) = None ‚Üæ Hdestruct
      ‚Üí inspect (choose s&#39; Hs&#39; (idx :: indices)) =
        (j, jn) ‚Üæ Hchoice
        ‚Üí choosing_well choose
          ‚Üí NoDup (idx :: indices)
            ‚Üí not_in_indices_initial_prop s&#39;
                (idx :: indices)
              ‚Üí <span class="kr">‚àÄ</span> (<span class="nv">is</span> : composite_state IM) (<span class="nv">tr</span> : 
                                             list
                                               (composite_transition_item
                                                 IM)),
                  (s&#39;, []) = (<span class="kr">is</span>, tr)
                  ‚Üí finite_trace_last <span class="kr">is</span> tr = s&#39;</div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="bp">by</span> <span class="nb">inversion</span> <span class="mi">8</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Qed</span>.</span></span></pre><div class="doc">
  For any given composite ram-state, <span class="inlinecode"><span class="id" title="var">indexed_reachable_composite_state_to_trace</span></span>
  yields a ram-trace leading to it.

</div><pre class="alectryon-io highlight"><!-- Generator: Alectryon --><span class="alectryon-sentence"><input class="alectryon-toggle" id="TraceableVLSM-v-chke9" style="display: none" type="checkbox"><label class="alectryon-input" for="TraceableVLSM-v-chke9"><span class="kn">Lemma</span> <span class="nf">indexed_reachable_composite_state_to_trace</span> :
  <span class="kr">forall</span> (<span class="nv">choose</span> : choice_function), choosing_well choose -&gt;
  <span class="kr">forall</span> (<span class="nv">s</span> : composite_state IM) (<span class="nv">Hs</span> : valid_state_prop RFree s),
  <span class="kr">forall</span> (<span class="nv">indices</span> : list index), NoDup indices -&gt;
    not_in_indices_initial_prop s indices -&gt;
    <span class="kr">forall</span> <span class="nv">is</span> <span class="nv">tr</span>, indexed_composite_state_to_trace choose s Hs indices = (<span class="kr">is</span>, tr) -&gt;
    finite_valid_trace_from_to RFree <span class="kr">is</span> s tr.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>message, index</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>EqDecision0</var><span class="hyp-type"><b>: </b><span>EqDecision index</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>finite.Finite index</span></span></span><br><span><var>IM</var><span class="hyp-type"><b>: </b><span>index ‚Üí VLSM message</span></span></span><br><span><var>state_destructor</var><span class="hyp-type"><b>: </b><span><span class="kr">‚àÄ</span> <span class="nv">i</span> : index,
  vstate (IM i)
  ‚Üí list
      (vtransition_item (IM i) *
       vstate (IM i))</span></span></span><br><span><var>state_size</var><span class="hyp-type"><b>: </b><span><span class="kr">‚àÄ</span> <span class="nv">i</span> : index, vstate (IM i) ‚Üí nat</span></span></span><br><span><var>H0</var><span class="hyp-type"><b>: </b><span><span class="kr">‚àÄ</span> <span class="nv">i</span> : index,
  TraceableVLSM (IM i) 
    (state_destructor i) 
    (state_size i)</span></span></span><br><span><var>Free</var><span><span class="hyp-body"><b>:= </b><span>free_composite_vlsm IM</span></span><span class="hyp-type"><b>: </b><span>VLSM message</span></span></span></span><br><span><var>RFree</var><span><span class="hyp-body"><b>:= </b><span>pre_loaded_with_all_messages_vlsm Free</span></span><span class="hyp-type"><b>: </b><span>VLSM message</span></span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="kr">‚àÄ</span> <span class="nv">choose</span> : choice_function,
  choosing_well choose
  ‚Üí <span class="kr">‚àÄ</span> (<span class="nv">s</span> : composite_state IM) (<span class="nv">Hs</span> : valid_state_prop
                                       RFree s) (<span class="nv">indices</span> : 
                                                 list
                                                 index),
      NoDup indices
      ‚Üí not_in_indices_initial_prop s indices
        ‚Üí <span class="kr">‚àÄ</span> (<span class="nv">is</span> : composite_state IM) (<span class="nv">tr</span> : list
                                              (composite_transition_item
                                                 IM)),
            indexed_composite_state_to_trace choose s
              Hs indices = (<span class="kr">is</span>, tr)
            ‚Üí finite_valid_trace_from_to RFree <span class="kr">is</span> s tr</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="TraceableVLSM-v-chkea" style="display: none" type="checkbox"><label class="alectryon-input" for="TraceableVLSM-v-chkea"><span class="kn">Proof</span>.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>message, index</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>EqDecision0</var><span class="hyp-type"><b>: </b><span>EqDecision index</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>finite.Finite index</span></span></span><br><span><var>IM</var><span class="hyp-type"><b>: </b><span>index ‚Üí VLSM message</span></span></span><br><span><var>state_destructor</var><span class="hyp-type"><b>: </b><span><span class="kr">‚àÄ</span> <span class="nv">i</span> : index,
  vstate (IM i)
  ‚Üí list
      (vtransition_item (IM i) *
       vstate (IM i))</span></span></span><br><span><var>state_size</var><span class="hyp-type"><b>: </b><span><span class="kr">‚àÄ</span> <span class="nv">i</span> : index, vstate (IM i) ‚Üí nat</span></span></span><br><span><var>H0</var><span class="hyp-type"><b>: </b><span><span class="kr">‚àÄ</span> <span class="nv">i</span> : index,
  TraceableVLSM (IM i) 
    (state_destructor i) 
    (state_size i)</span></span></span><br><span><var>Free</var><span><span class="hyp-body"><b>:= </b><span>free_composite_vlsm IM</span></span><span class="hyp-type"><b>: </b><span>VLSM message</span></span></span></span><br><span><var>RFree</var><span><span class="hyp-body"><b>:= </b><span>pre_loaded_with_all_messages_vlsm Free</span></span><span class="hyp-type"><b>: </b><span>VLSM message</span></span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="kr">‚àÄ</span> <span class="nv">choose</span> : choice_function,
  choosing_well choose
  ‚Üí <span class="kr">‚àÄ</span> (<span class="nv">s</span> : composite_state IM) (<span class="nv">Hs</span> : valid_state_prop
                                       RFree s) (<span class="nv">indices</span> : 
                                                 list
                                                 index),
      NoDup indices
      ‚Üí not_in_indices_initial_prop s indices
        ‚Üí <span class="kr">‚àÄ</span> (<span class="nv">is</span> : composite_state IM) (<span class="nv">tr</span> : list
                                              (composite_transition_item
                                                 IM)),
            indexed_composite_state_to_trace choose s
              Hs indices = (<span class="kr">is</span>, tr)
            ‚Üí finite_valid_trace_from_to RFree <span class="kr">is</span> s tr</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="TraceableVLSM-v-chkeb" style="display: none" type="checkbox"><label class="alectryon-input" for="TraceableVLSM-v-chkeb"><span class="nb">intros</span> choose Hchoose s Hs indices; <span class="nb">revert</span> Hchoose.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>message, index</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>EqDecision0</var><span class="hyp-type"><b>: </b><span>EqDecision index</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>finite.Finite index</span></span></span><br><span><var>IM</var><span class="hyp-type"><b>: </b><span>index ‚Üí VLSM message</span></span></span><br><span><var>state_destructor</var><span class="hyp-type"><b>: </b><span><span class="kr">‚àÄ</span> <span class="nv">i</span> : index,
  vstate (IM i)
  ‚Üí list
      (vtransition_item (IM i) *
       vstate (IM i))</span></span></span><br><span><var>state_size</var><span class="hyp-type"><b>: </b><span><span class="kr">‚àÄ</span> <span class="nv">i</span> : index, vstate (IM i) ‚Üí nat</span></span></span><br><span><var>H0</var><span class="hyp-type"><b>: </b><span><span class="kr">‚àÄ</span> <span class="nv">i</span> : index,
  TraceableVLSM (IM i) 
    (state_destructor i) 
    (state_size i)</span></span></span><br><span><var>Free</var><span><span class="hyp-body"><b>:= </b><span>free_composite_vlsm IM</span></span><span class="hyp-type"><b>: </b><span>VLSM message</span></span></span></span><br><span><var>RFree</var><span><span class="hyp-body"><b>:= </b><span>pre_loaded_with_all_messages_vlsm Free</span></span><span class="hyp-type"><b>: </b><span>VLSM message</span></span></span></span><br><span><var>choose</var><span class="hyp-type"><b>: </b><span>choice_function</span></span></span><br><span><var>s</var><span class="hyp-type"><b>: </b><span>composite_state IM</span></span></span><br><span><var>Hs</var><span class="hyp-type"><b>: </b><span>valid_state_prop RFree s</span></span></span><br><span><var>indices</var><span class="hyp-type"><b>: </b><span>list index</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">choosing_well choose
‚Üí NoDup indices
  ‚Üí not_in_indices_initial_prop s indices
    ‚Üí <span class="kr">‚àÄ</span> (<span class="nv">is</span> : composite_state IM) (<span class="nv">tr</span> : list
                                          (composite_transition_item
                                             IM)),
        indexed_composite_state_to_trace choose s Hs
          indices = (<span class="kr">is</span>, tr)
        ‚Üí finite_valid_trace_from_to RFree <span class="kr">is</span> s tr</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="TraceableVLSM-v-chkec" style="display: none" type="checkbox"><label class="alectryon-input" for="TraceableVLSM-v-chkec">apply_funelim (indexed_composite_state_to_trace choose s Hs indices);
    <span class="nb">clear</span> choose s Hs indices; <span class="nb">intros</span> choose s&#39; Hs&#39;;
    [<span class="bp">by</span> <span class="nb">inversion</span> <span class="mi">4</span>; <span class="nb">subst</span>; <span class="nb">constructor</span> |..];
    <span class="nb">intros</span> idx indices.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>message, index</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>EqDecision0</var><span class="hyp-type"><b>: </b><span>EqDecision index</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>finite.Finite index</span></span></span><br><span><var>IM</var><span class="hyp-type"><b>: </b><span>index ‚Üí VLSM message</span></span></span><br><span><var>state_destructor</var><span class="hyp-type"><b>: </b><span><span class="kr">‚àÄ</span> <span class="nv">i</span> : index,
  vstate (IM i)
  ‚Üí list
      (vtransition_item (IM i) *
       vstate (IM i))</span></span></span><br><span><var>state_size</var><span class="hyp-type"><b>: </b><span><span class="kr">‚àÄ</span> <span class="nv">i</span> : index, vstate (IM i) ‚Üí nat</span></span></span><br><span><var>H0</var><span class="hyp-type"><b>: </b><span><span class="kr">‚àÄ</span> <span class="nv">i</span> : index,
  TraceableVLSM (IM i) 
    (state_destructor i) 
    (state_size i)</span></span></span><br><span><var>Free</var><span><span class="hyp-body"><b>:= </b><span>free_composite_vlsm IM</span></span><span class="hyp-type"><b>: </b><span>VLSM message</span></span></span></span><br><span><var>RFree</var><span><span class="hyp-body"><b>:= </b><span>pre_loaded_with_all_messages_vlsm Free</span></span><span class="hyp-type"><b>: </b><span>VLSM message</span></span></span></span><br><span><var>choose</var><span class="hyp-type"><b>: </b><span>choice_function</span></span></span><br><span><var>s'</var><span class="hyp-type"><b>: </b><span>composite_state IM</span></span></span><br><span><var>Hs'</var><span class="hyp-type"><b>: </b><span>valid_state_prop RFree s&#39;</span></span></span><br><span><var>idx</var><span class="hyp-type"><b>: </b><span>index</span></span></span><br><span><var>indices</var><span class="hyp-type"><b>: </b><span>list index</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="kr">‚àÄ</span> (<span class="nv">i_n</span> : index * nat) (<span class="nv">item</span> : composite_transition_item
                                IM) (<span class="nv">s</span> : composite_state
                                           IM) (<span class="nv">Hdestruct</span> : 
                                                composite_state_destructor
                                                 s&#39;
                                                 i_n.<span class="mi">1</span>
                                                !! i_n.<span class="mi">2</span> =
                                                Some
                                                 (item,
                                                 s)) 
  (<span class="nv">Hchoice</span> : choose s&#39; Hs&#39; (idx :: indices) = i_n) 
  (<span class="nv">is</span> : composite_state IM) (<span class="nv">tr</span> : list
                                    (composite_transition_item
                                       IM)),
  indexed_composite_state_to_trace choose s
    (indexed_composite_state_to_trace_obligations_obligation_1
       s&#39; Hs&#39; i_n item s Hdestruct) (idx :: indices) =
  (<span class="kr">is</span>, tr)
  ‚Üí (choosing_well choose
     ‚Üí NoDup (idx :: indices)
       ‚Üí not_in_indices_initial_prop s
           (idx :: indices)
         ‚Üí <span class="kr">‚àÄ</span> (<span class="nv">is0</span> : composite_state IM) (<span class="nv">tr0</span> : list
                                                 (composite_transition_item
                                                 IM)),
             indexed_composite_state_to_trace choose s
               (indexed_composite_state_to_trace_obligations_obligation_1
                  s&#39; Hs&#39; i_n item s Hdestruct)
               (idx :: indices) = (is0, tr0)
             ‚Üí finite_valid_trace_from_to RFree is0 s
                 tr0)
    ‚Üí inspect
        (composite_state_destructor s&#39; i_n.<span class="mi">1</span> !! i_n.<span class="mi">2</span>) =
      Some (item, s) ‚Üæ Hdestruct
      ‚Üí inspect (choose s&#39; Hs&#39; (idx :: indices)) =
        i_n ‚Üæ Hchoice
        ‚Üí choosing_well choose
          ‚Üí NoDup (idx :: indices)
            ‚Üí not_in_indices_initial_prop s&#39;
                (idx :: indices)
              ‚Üí <span class="kr">‚àÄ</span> (<span class="nv">is0</span> : composite_state IM) (<span class="nv">tr0</span> : 
                                              list
                                                (composite_transition_item
                                                 IM)),
                  (<span class="kr">is</span>, tr ++ [item]) = (is0, tr0)
                  ‚Üí finite_valid_trace_from_to RFree
                      is0 s&#39; tr0</div></blockquote><div class="alectryon-extra-goals"><input class="alectryon-extra-goal-toggle" id="TraceableVLSM-v-chked" style="display: none" type="checkbox"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>message, index</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>EqDecision0</var><span class="hyp-type"><b>: </b><span>EqDecision index</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>finite.Finite index</span></span></span><br><span><var>IM</var><span class="hyp-type"><b>: </b><span>index ‚Üí VLSM message</span></span></span><br><span><var>state_destructor</var><span class="hyp-type"><b>: </b><span><span class="kr">‚àÄ</span> <span class="nv">i</span> : index,
  vstate (IM i)
  ‚Üí list
      (vtransition_item (IM i) *
       vstate (IM i))</span></span></span><br><span><var>state_size</var><span class="hyp-type"><b>: </b><span><span class="kr">‚àÄ</span> <span class="nv">i</span> : index, vstate (IM i) ‚Üí nat</span></span></span><br><span><var>H0</var><span class="hyp-type"><b>: </b><span><span class="kr">‚àÄ</span> <span class="nv">i</span> : index,
  TraceableVLSM (IM i) 
    (state_destructor i) 
    (state_size i)</span></span></span><br><span><var>Free</var><span><span class="hyp-body"><b>:= </b><span>free_composite_vlsm IM</span></span><span class="hyp-type"><b>: </b><span>VLSM message</span></span></span></span><br><span><var>RFree</var><span><span class="hyp-body"><b>:= </b><span>pre_loaded_with_all_messages_vlsm Free</span></span><span class="hyp-type"><b>: </b><span>VLSM message</span></span></span></span><br><span><var>choose</var><span class="hyp-type"><b>: </b><span>choice_function</span></span></span><br><span><var>s'</var><span class="hyp-type"><b>: </b><span>composite_state IM</span></span></span><br><span><var>Hs'</var><span class="hyp-type"><b>: </b><span>valid_state_prop RFree s&#39;</span></span></span><br><span><var>idx</var><span class="hyp-type"><b>: </b><span>index</span></span></span><br><span><var>indices</var><span class="hyp-type"><b>: </b><span>list index</span></span></span><br></div><label class="goal-separator" for="TraceableVLSM-v-chked"><hr></label><div class="goal-conclusion"><span class="kr">‚àÄ</span> (<span class="nv">i_n</span> : index * nat) (<span class="nv">n</span> : i_n.<span class="mi">1</span> ‚àâ idx :: indices) 
  (<span class="nv">Hni</span> : decide (i_n.<span class="mi">1</span> ‚àà idx :: indices) = <span class="nb">right</span> n) 
  (<span class="nv">Hdestruct</span> : composite_state_destructor s&#39; i_n.<span class="mi">1</span>
               !! i_n.<span class="mi">2</span> = None) 
  (<span class="nv">Hchoice</span> : choose s&#39; Hs&#39; (idx :: indices) = i_n),
  inspect (decide (i_n.<span class="mi">1</span> ‚àà idx :: indices)) =
  <span class="nb">right</span> n ‚Üæ Hni
  ‚Üí inspect
      (composite_state_destructor s&#39; i_n.<span class="mi">1</span> !! i_n.<span class="mi">2</span>) =
    None ‚Üæ Hdestruct
    ‚Üí inspect (choose s&#39; Hs&#39; (idx :: indices)) =
      i_n ‚Üæ Hchoice
      ‚Üí choosing_well choose
        ‚Üí NoDup (idx :: indices)
          ‚Üí not_in_indices_initial_prop s&#39;
              (idx :: indices)
            ‚Üí <span class="kr">‚àÄ</span> (<span class="nv">is</span> : composite_state IM) 
                (<span class="nv">tr</span> : list
                      (composite_transition_item IM)),
                (s&#39;, []) = (<span class="kr">is</span>, tr)
                ‚Üí finite_valid_trace_from_to RFree <span class="kr">is</span>
                    s&#39; tr</div></blockquote><input class="alectryon-extra-goal-toggle" id="TraceableVLSM-v-chkee" style="display: none" type="checkbox"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>message, index</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>EqDecision0</var><span class="hyp-type"><b>: </b><span>EqDecision index</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>finite.Finite index</span></span></span><br><span><var>IM</var><span class="hyp-type"><b>: </b><span>index ‚Üí VLSM message</span></span></span><br><span><var>state_destructor</var><span class="hyp-type"><b>: </b><span><span class="kr">‚àÄ</span> <span class="nv">i</span> : index,
  vstate (IM i)
  ‚Üí list
      (vtransition_item (IM i) *
       vstate (IM i))</span></span></span><br><span><var>state_size</var><span class="hyp-type"><b>: </b><span><span class="kr">‚àÄ</span> <span class="nv">i</span> : index, vstate (IM i) ‚Üí nat</span></span></span><br><span><var>H0</var><span class="hyp-type"><b>: </b><span><span class="kr">‚àÄ</span> <span class="nv">i</span> : index,
  TraceableVLSM (IM i) 
    (state_destructor i) 
    (state_size i)</span></span></span><br><span><var>Free</var><span><span class="hyp-body"><b>:= </b><span>free_composite_vlsm IM</span></span><span class="hyp-type"><b>: </b><span>VLSM message</span></span></span></span><br><span><var>RFree</var><span><span class="hyp-body"><b>:= </b><span>pre_loaded_with_all_messages_vlsm Free</span></span><span class="hyp-type"><b>: </b><span>VLSM message</span></span></span></span><br><span><var>choose</var><span class="hyp-type"><b>: </b><span>choice_function</span></span></span><br><span><var>s'</var><span class="hyp-type"><b>: </b><span>composite_state IM</span></span></span><br><span><var>Hs'</var><span class="hyp-type"><b>: </b><span>valid_state_prop RFree s&#39;</span></span></span><br><span><var>idx</var><span class="hyp-type"><b>: </b><span>index</span></span></span><br><span><var>indices</var><span class="hyp-type"><b>: </b><span>list index</span></span></span><br></div><label class="goal-separator" for="TraceableVLSM-v-chkee"><hr></label><div class="goal-conclusion"><span class="kr">‚àÄ</span> (<span class="nv">i_n</span> : index * nat) (<span class="nv">e1</span> : 
                      composite_state_destructor s&#39;
                      i_n.<span class="mi">1</span> = []) 
  (<span class="nv">Hnn</span> : decide
           (composite_state_destructor s&#39; i_n.<span class="mi">1</span> = []) =
         <span class="nb">left</span> e1) (<span class="nv">e0</span> : i_n.<span class="mi">1</span> ‚àà idx :: indices) 
  (<span class="nv">Hi</span> : decide (i_n.<span class="mi">1</span> ‚àà idx :: indices) = <span class="nb">left</span> e0) 
  (<span class="nv">Hdestruct</span> : composite_state_destructor s&#39; i_n.<span class="mi">1</span>
               !! i_n.<span class="mi">2</span> = None) 
  (<span class="nv">Hchoice</span> : choose s&#39; Hs&#39; (idx :: indices) = i_n),
  (choosing_well choose
   ‚Üí NoDup
       (StdppListSet.set_remove i_n.<span class="mi">1</span> (idx :: indices))
     ‚Üí not_in_indices_initial_prop s&#39;
         (StdppListSet.set_remove i_n.<span class="mi">1</span>
            (idx :: indices))
       ‚Üí <span class="kr">‚àÄ</span> (<span class="nv">is</span> : composite_state IM) 
           (<span class="nv">tr</span> : list (composite_transition_item IM)),
           indexed_composite_state_to_trace choose s&#39;
             Hs&#39;
             (StdppListSet.set_remove i_n.<span class="mi">1</span>
                (idx :: indices)) = 
           (<span class="kr">is</span>, tr)
           ‚Üí finite_valid_trace_from_to RFree <span class="kr">is</span> s&#39; tr)
  ‚Üí inspect
      (decide
         (composite_state_destructor s&#39; i_n.<span class="mi">1</span> = [])) =
    <span class="nb">left</span> e1 ‚Üæ Hnn
    ‚Üí inspect (decide (i_n.<span class="mi">1</span> ‚àà idx :: indices)) =
      <span class="nb">left</span> e0 ‚Üæ Hi
      ‚Üí inspect
          (composite_state_destructor s&#39; i_n.<span class="mi">1</span>
           !! i_n.<span class="mi">2</span>) = 
        None ‚Üæ Hdestruct
        ‚Üí inspect (choose s&#39; Hs&#39; (idx :: indices)) =
          i_n ‚Üæ Hchoice
          ‚Üí choosing_well choose
            ‚Üí NoDup (idx :: indices)
              ‚Üí not_in_indices_initial_prop s&#39;
                  (idx :: indices)
                ‚Üí <span class="kr">‚àÄ</span> (<span class="nv">is</span> : composite_state IM) 
                    (<span class="nv">tr</span> : 
                     list
                      (composite_transition_item IM)),
                    indexed_composite_state_to_trace
                      choose s&#39; Hs&#39;
                      (StdppListSet.set_remove i_n.<span class="mi">1</span>
                      (idx :: indices)) = 
                    (<span class="kr">is</span>, tr)
                    ‚Üí finite_valid_trace_from_to RFree
                      <span class="kr">is</span> s&#39; tr</div></blockquote><input class="alectryon-extra-goal-toggle" id="TraceableVLSM-v-chkef" style="display: none" type="checkbox"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>message, index</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>EqDecision0</var><span class="hyp-type"><b>: </b><span>EqDecision index</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>finite.Finite index</span></span></span><br><span><var>IM</var><span class="hyp-type"><b>: </b><span>index ‚Üí VLSM message</span></span></span><br><span><var>state_destructor</var><span class="hyp-type"><b>: </b><span><span class="kr">‚àÄ</span> <span class="nv">i</span> : index,
  vstate (IM i)
  ‚Üí list
      (vtransition_item (IM i) *
       vstate (IM i))</span></span></span><br><span><var>state_size</var><span class="hyp-type"><b>: </b><span><span class="kr">‚àÄ</span> <span class="nv">i</span> : index, vstate (IM i) ‚Üí nat</span></span></span><br><span><var>H0</var><span class="hyp-type"><b>: </b><span><span class="kr">‚àÄ</span> <span class="nv">i</span> : index,
  TraceableVLSM (IM i) 
    (state_destructor i) 
    (state_size i)</span></span></span><br><span><var>Free</var><span><span class="hyp-body"><b>:= </b><span>free_composite_vlsm IM</span></span><span class="hyp-type"><b>: </b><span>VLSM message</span></span></span></span><br><span><var>RFree</var><span><span class="hyp-body"><b>:= </b><span>pre_loaded_with_all_messages_vlsm Free</span></span><span class="hyp-type"><b>: </b><span>VLSM message</span></span></span></span><br><span><var>choose</var><span class="hyp-type"><b>: </b><span>choice_function</span></span></span><br><span><var>s'</var><span class="hyp-type"><b>: </b><span>composite_state IM</span></span></span><br><span><var>Hs'</var><span class="hyp-type"><b>: </b><span>valid_state_prop RFree s&#39;</span></span></span><br><span><var>idx</var><span class="hyp-type"><b>: </b><span>index</span></span></span><br><span><var>indices</var><span class="hyp-type"><b>: </b><span>list index</span></span></span><br></div><label class="goal-separator" for="TraceableVLSM-v-chkef"><hr></label><div class="goal-conclusion"><span class="kr">‚àÄ</span> (<span class="nv">i_n</span> : index * nat) (<span class="nv">n</span> : 
                      composite_state_destructor s&#39;
                      i_n.<span class="mi">1</span> ‚â† []) 
  (<span class="nv">Hn</span> : decide
          (composite_state_destructor s&#39; i_n.<span class="mi">1</span> = []) =
        <span class="nb">right</span> n) (<span class="nv">e0</span> : i_n.<span class="mi">1</span> ‚àà idx :: indices) 
  (<span class="nv">Hi</span> : decide (i_n.<span class="mi">1</span> ‚àà idx :: indices) = <span class="nb">left</span> e0) 
  (<span class="nv">Hdestruct</span> : composite_state_destructor s&#39; i_n.<span class="mi">1</span>
               !! i_n.<span class="mi">2</span> = None) 
  (<span class="nv">Hchoice</span> : choose s&#39; Hs&#39; (idx :: indices) = i_n),
  inspect
    (decide (composite_state_destructor s&#39; i_n.<span class="mi">1</span> = [])) =
  <span class="nb">right</span> n ‚Üæ Hn
  ‚Üí inspect (decide (i_n.<span class="mi">1</span> ‚àà idx :: indices)) =
    <span class="nb">left</span> e0 ‚Üæ Hi
    ‚Üí inspect
        (composite_state_destructor s&#39; i_n.<span class="mi">1</span> !! i_n.<span class="mi">2</span>) =
      None ‚Üæ Hdestruct
      ‚Üí inspect (choose s&#39; Hs&#39; (idx :: indices)) =
        i_n ‚Üæ Hchoice
        ‚Üí choosing_well choose
          ‚Üí NoDup (idx :: indices)
            ‚Üí not_in_indices_initial_prop s&#39;
                (idx :: indices)
              ‚Üí <span class="kr">‚àÄ</span> (<span class="nv">is</span> : composite_state IM) 
                  (<span class="nv">tr</span> : 
                   list 
                     (composite_transition_item IM)),
                  (s&#39;, []) = (<span class="kr">is</span>, tr)
                  ‚Üí finite_valid_trace_from_to RFree
                      <span class="kr">is</span> s&#39; tr</div></blockquote></div></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="TraceableVLSM-v-chkf0" style="display: none" type="checkbox"><label class="alectryon-input" for="TraceableVLSM-v-chkf0">-</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>message, index</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>EqDecision0</var><span class="hyp-type"><b>: </b><span>EqDecision index</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>finite.Finite index</span></span></span><br><span><var>IM</var><span class="hyp-type"><b>: </b><span>index ‚Üí VLSM message</span></span></span><br><span><var>state_destructor</var><span class="hyp-type"><b>: </b><span><span class="kr">‚àÄ</span> <span class="nv">i</span> : index,
  vstate (IM i)
  ‚Üí list
      (vtransition_item (IM i) *
       vstate (IM i))</span></span></span><br><span><var>state_size</var><span class="hyp-type"><b>: </b><span><span class="kr">‚àÄ</span> <span class="nv">i</span> : index, vstate (IM i) ‚Üí nat</span></span></span><br><span><var>H0</var><span class="hyp-type"><b>: </b><span><span class="kr">‚àÄ</span> <span class="nv">i</span> : index,
  TraceableVLSM (IM i) 
    (state_destructor i) 
    (state_size i)</span></span></span><br><span><var>Free</var><span><span class="hyp-body"><b>:= </b><span>free_composite_vlsm IM</span></span><span class="hyp-type"><b>: </b><span>VLSM message</span></span></span></span><br><span><var>RFree</var><span><span class="hyp-body"><b>:= </b><span>pre_loaded_with_all_messages_vlsm Free</span></span><span class="hyp-type"><b>: </b><span>VLSM message</span></span></span></span><br><span><var>choose</var><span class="hyp-type"><b>: </b><span>choice_function</span></span></span><br><span><var>s'</var><span class="hyp-type"><b>: </b><span>composite_state IM</span></span></span><br><span><var>Hs'</var><span class="hyp-type"><b>: </b><span>valid_state_prop RFree s&#39;</span></span></span><br><span><var>idx</var><span class="hyp-type"><b>: </b><span>index</span></span></span><br><span><var>indices</var><span class="hyp-type"><b>: </b><span>list index</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="kr">‚àÄ</span> (<span class="nv">i_n</span> : index * nat) (<span class="nv">item</span> : composite_transition_item
                                IM) (<span class="nv">s</span> : composite_state
                                           IM) (<span class="nv">Hdestruct</span> : 
                                                composite_state_destructor
                                                 s&#39;
                                                 i_n.<span class="mi">1</span>
                                                !! i_n.<span class="mi">2</span> =
                                                Some
                                                 (item,
                                                 s)) 
  (<span class="nv">Hchoice</span> : choose s&#39; Hs&#39; (idx :: indices) = i_n) 
  (<span class="nv">is</span> : composite_state IM) (<span class="nv">tr</span> : list
                                    (composite_transition_item
                                       IM)),
  indexed_composite_state_to_trace choose s
    (indexed_composite_state_to_trace_obligations_obligation_1
       s&#39; Hs&#39; i_n item s Hdestruct) (idx :: indices) =
  (<span class="kr">is</span>, tr)
  ‚Üí (choosing_well choose
     ‚Üí NoDup (idx :: indices)
       ‚Üí not_in_indices_initial_prop s
           (idx :: indices)
         ‚Üí <span class="kr">‚àÄ</span> (<span class="nv">is0</span> : composite_state IM) (<span class="nv">tr0</span> : list
                                                 (composite_transition_item
                                                 IM)),
             indexed_composite_state_to_trace choose s
               (indexed_composite_state_to_trace_obligations_obligation_1
                  s&#39; Hs&#39; i_n item s Hdestruct)
               (idx :: indices) = (is0, tr0)
             ‚Üí finite_valid_trace_from_to RFree is0 s
                 tr0)
    ‚Üí inspect
        (composite_state_destructor s&#39; i_n.<span class="mi">1</span> !! i_n.<span class="mi">2</span>) =
      Some (item, s) ‚Üæ Hdestruct
      ‚Üí inspect (choose s&#39; Hs&#39; (idx :: indices)) =
        i_n ‚Üæ Hchoice
        ‚Üí choosing_well choose
          ‚Üí NoDup (idx :: indices)
            ‚Üí not_in_indices_initial_prop s&#39;
                (idx :: indices)
              ‚Üí <span class="kr">‚àÄ</span> (<span class="nv">is0</span> : composite_state IM) (<span class="nv">tr0</span> : 
                                              list
                                                (composite_transition_item
                                                 IM)),
                  (<span class="kr">is</span>, tr ++ [item]) = (is0, tr0)
                  ‚Üí finite_valid_trace_from_to RFree
                      is0 s&#39; tr0</div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="TraceableVLSM-v-chkf1" style="display: none" type="checkbox"><label class="alectryon-input" for="TraceableVLSM-v-chkf1"><span class="nb">intros</span> ? ? ? ? _ ? ? -&gt; Hind _ _ Hchoose Hnodup Hinitial is&#39; tr&#39; [= -&gt; &lt;-].</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>message, index</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>EqDecision0</var><span class="hyp-type"><b>: </b><span>EqDecision index</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>finite.Finite index</span></span></span><br><span><var>IM</var><span class="hyp-type"><b>: </b><span>index ‚Üí VLSM message</span></span></span><br><span><var>state_destructor</var><span class="hyp-type"><b>: </b><span><span class="kr">‚àÄ</span> <span class="nv">i</span> : index,
  vstate (IM i)
  ‚Üí list
      (vtransition_item (IM i) *
       vstate (IM i))</span></span></span><br><span><var>state_size</var><span class="hyp-type"><b>: </b><span><span class="kr">‚àÄ</span> <span class="nv">i</span> : index, vstate (IM i) ‚Üí nat</span></span></span><br><span><var>H0</var><span class="hyp-type"><b>: </b><span><span class="kr">‚àÄ</span> <span class="nv">i</span> : index,
  TraceableVLSM (IM i) 
    (state_destructor i) 
    (state_size i)</span></span></span><br><span><var>Free</var><span><span class="hyp-body"><b>:= </b><span>free_composite_vlsm IM</span></span><span class="hyp-type"><b>: </b><span>VLSM message</span></span></span></span><br><span><var>RFree</var><span><span class="hyp-body"><b>:= </b><span>pre_loaded_with_all_messages_vlsm Free</span></span><span class="hyp-type"><b>: </b><span>VLSM message</span></span></span></span><br><span><var>choose</var><span class="hyp-type"><b>: </b><span>choice_function</span></span></span><br><span><var>s'</var><span class="hyp-type"><b>: </b><span>composite_state IM</span></span></span><br><span><var>Hs'</var><span class="hyp-type"><b>: </b><span>valid_state_prop RFree s&#39;</span></span></span><br><span><var>idx</var><span class="hyp-type"><b>: </b><span>index</span></span></span><br><span><var>indices</var><span class="hyp-type"><b>: </b><span>list index</span></span></span><br><span><var>i_n</var><span class="hyp-type"><b>: </b><span>(index * nat)%type</span></span></span><br><span><var>item</var><span class="hyp-type"><b>: </b><span>composite_transition_item IM</span></span></span><br><span><var>s</var><span class="hyp-type"><b>: </b><span>composite_state IM</span></span></span><br><span><var>Hdestruct</var><span class="hyp-type"><b>: </b><span>composite_state_destructor s&#39; i_n.<span class="mi">1</span>
!! i_n.<span class="mi">2</span> = Some (item, s)</span></span></span><br><span><var>tr</var><span class="hyp-type"><b>: </b><span>list (composite_transition_item IM)</span></span></span><br><span><var>is'</var><span class="hyp-type"><b>: </b><span>composite_state IM</span></span></span><br><span><var>Hind</var><span class="hyp-type"><b>: </b><span>choosing_well choose
‚Üí NoDup (idx :: indices)
  ‚Üí not_in_indices_initial_prop s
      (idx :: indices)
    ‚Üí <span class="kr">‚àÄ</span> (<span class="nv">is</span> : composite_state IM) 
        (<span class="nv">tr0</span> : list
                 (composite_transition_item IM)),
        (is&#39;, tr) = (<span class="kr">is</span>, tr0)
        ‚Üí finite_valid_trace_from_to RFree <span class="kr">is</span> s
            tr0</span></span></span><br><span><var>Hchoose</var><span class="hyp-type"><b>: </b><span>choosing_well choose</span></span></span><br><span><var>Hnodup</var><span class="hyp-type"><b>: </b><span>NoDup (idx :: indices)</span></span></span><br><span><var>Hinitial</var><span class="hyp-type"><b>: </b><span>not_in_indices_initial_prop s&#39;
  (idx :: indices)</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">finite_valid_trace_from_to RFree is&#39; s&#39; (tr ++ [item])</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="TraceableVLSM-v-chkf2" style="display: none" type="checkbox"><label class="alectryon-input" for="TraceableVLSM-v-chkf2"><span class="nb">eapply</span> composite_tv_state_destructor_preserves_not_in_indices_initial  <span class="kr">in</span> Hinitial; [| <span class="bp">done</span>..].</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>message, index</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>EqDecision0</var><span class="hyp-type"><b>: </b><span>EqDecision index</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>finite.Finite index</span></span></span><br><span><var>IM</var><span class="hyp-type"><b>: </b><span>index ‚Üí VLSM message</span></span></span><br><span><var>state_destructor</var><span class="hyp-type"><b>: </b><span><span class="kr">‚àÄ</span> <span class="nv">i</span> : index,
  vstate (IM i)
  ‚Üí list
      (vtransition_item (IM i) *
       vstate (IM i))</span></span></span><br><span><var>state_size</var><span class="hyp-type"><b>: </b><span><span class="kr">‚àÄ</span> <span class="nv">i</span> : index, vstate (IM i) ‚Üí nat</span></span></span><br><span><var>H0</var><span class="hyp-type"><b>: </b><span><span class="kr">‚àÄ</span> <span class="nv">i</span> : index,
  TraceableVLSM (IM i) 
    (state_destructor i) 
    (state_size i)</span></span></span><br><span><var>Free</var><span><span class="hyp-body"><b>:= </b><span>free_composite_vlsm IM</span></span><span class="hyp-type"><b>: </b><span>VLSM message</span></span></span></span><br><span><var>RFree</var><span><span class="hyp-body"><b>:= </b><span>pre_loaded_with_all_messages_vlsm Free</span></span><span class="hyp-type"><b>: </b><span>VLSM message</span></span></span></span><br><span><var>choose</var><span class="hyp-type"><b>: </b><span>choice_function</span></span></span><br><span><var>s'</var><span class="hyp-type"><b>: </b><span>composite_state IM</span></span></span><br><span><var>Hs'</var><span class="hyp-type"><b>: </b><span>valid_state_prop RFree s&#39;</span></span></span><br><span><var>idx</var><span class="hyp-type"><b>: </b><span>index</span></span></span><br><span><var>indices</var><span class="hyp-type"><b>: </b><span>list index</span></span></span><br><span><var>i_n</var><span class="hyp-type"><b>: </b><span>(index * nat)%type</span></span></span><br><span><var>item</var><span class="hyp-type"><b>: </b><span>composite_transition_item IM</span></span></span><br><span><var>s</var><span class="hyp-type"><b>: </b><span>composite_state IM</span></span></span><br><span><var>Hdestruct</var><span class="hyp-type"><b>: </b><span>composite_state_destructor s&#39; i_n.<span class="mi">1</span>
!! i_n.<span class="mi">2</span> = Some (item, s)</span></span></span><br><span><var>tr</var><span class="hyp-type"><b>: </b><span>list (composite_transition_item IM)</span></span></span><br><span><var>is'</var><span class="hyp-type"><b>: </b><span>composite_state IM</span></span></span><br><span><var>Hind</var><span class="hyp-type"><b>: </b><span>choosing_well choose
‚Üí NoDup (idx :: indices)
  ‚Üí not_in_indices_initial_prop s
      (idx :: indices)
    ‚Üí <span class="kr">‚àÄ</span> (<span class="nv">is</span> : composite_state IM) 
        (<span class="nv">tr0</span> : list
                 (composite_transition_item IM)),
        (is&#39;, tr) = (<span class="kr">is</span>, tr0)
        ‚Üí finite_valid_trace_from_to RFree <span class="kr">is</span> s
            tr0</span></span></span><br><span><var>Hchoose</var><span class="hyp-type"><b>: </b><span>choosing_well choose</span></span></span><br><span><var>Hnodup</var><span class="hyp-type"><b>: </b><span>NoDup (idx :: indices)</span></span></span><br><span><var>Hinitial</var><span class="hyp-type"><b>: </b><span>not_in_indices_initial_prop s
  (idx :: indices)</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">finite_valid_trace_from_to RFree is&#39; s&#39; (tr ++ [item])</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="TraceableVLSM-v-chkf3" style="display: none" type="checkbox"><label class="alectryon-input" for="TraceableVLSM-v-chkf3"><span class="nb">apply</span> elem_of_list_lookup_2 <span class="kr">in</span> Hdestruct.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>message, index</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>EqDecision0</var><span class="hyp-type"><b>: </b><span>EqDecision index</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>finite.Finite index</span></span></span><br><span><var>IM</var><span class="hyp-type"><b>: </b><span>index ‚Üí VLSM message</span></span></span><br><span><var>state_destructor</var><span class="hyp-type"><b>: </b><span><span class="kr">‚àÄ</span> <span class="nv">i</span> : index,
  vstate (IM i)
  ‚Üí list
      (vtransition_item (IM i) *
       vstate (IM i))</span></span></span><br><span><var>state_size</var><span class="hyp-type"><b>: </b><span><span class="kr">‚àÄ</span> <span class="nv">i</span> : index, vstate (IM i) ‚Üí nat</span></span></span><br><span><var>H0</var><span class="hyp-type"><b>: </b><span><span class="kr">‚àÄ</span> <span class="nv">i</span> : index,
  TraceableVLSM (IM i) 
    (state_destructor i) 
    (state_size i)</span></span></span><br><span><var>Free</var><span><span class="hyp-body"><b>:= </b><span>free_composite_vlsm IM</span></span><span class="hyp-type"><b>: </b><span>VLSM message</span></span></span></span><br><span><var>RFree</var><span><span class="hyp-body"><b>:= </b><span>pre_loaded_with_all_messages_vlsm Free</span></span><span class="hyp-type"><b>: </b><span>VLSM message</span></span></span></span><br><span><var>choose</var><span class="hyp-type"><b>: </b><span>choice_function</span></span></span><br><span><var>s'</var><span class="hyp-type"><b>: </b><span>composite_state IM</span></span></span><br><span><var>Hs'</var><span class="hyp-type"><b>: </b><span>valid_state_prop RFree s&#39;</span></span></span><br><span><var>idx</var><span class="hyp-type"><b>: </b><span>index</span></span></span><br><span><var>indices</var><span class="hyp-type"><b>: </b><span>list index</span></span></span><br><span><var>i_n</var><span class="hyp-type"><b>: </b><span>(index * nat)%type</span></span></span><br><span><var>item</var><span class="hyp-type"><b>: </b><span>composite_transition_item IM</span></span></span><br><span><var>s</var><span class="hyp-type"><b>: </b><span>composite_state IM</span></span></span><br><span><var>Hdestruct</var><span class="hyp-type"><b>: </b><span>(item, s)
‚àà composite_state_destructor s&#39; i_n.<span class="mi">1</span></span></span></span><br><span><var>tr</var><span class="hyp-type"><b>: </b><span>list (composite_transition_item IM)</span></span></span><br><span><var>is'</var><span class="hyp-type"><b>: </b><span>composite_state IM</span></span></span><br><span><var>Hind</var><span class="hyp-type"><b>: </b><span>choosing_well choose
‚Üí NoDup (idx :: indices)
  ‚Üí not_in_indices_initial_prop s
      (idx :: indices)
    ‚Üí <span class="kr">‚àÄ</span> (<span class="nv">is</span> : composite_state IM) 
        (<span class="nv">tr0</span> : list
                 (composite_transition_item IM)),
        (is&#39;, tr) = (<span class="kr">is</span>, tr0)
        ‚Üí finite_valid_trace_from_to RFree <span class="kr">is</span> s
            tr0</span></span></span><br><span><var>Hchoose</var><span class="hyp-type"><b>: </b><span>choosing_well choose</span></span></span><br><span><var>Hnodup</var><span class="hyp-type"><b>: </b><span>NoDup (idx :: indices)</span></span></span><br><span><var>Hinitial</var><span class="hyp-type"><b>: </b><span>not_in_indices_initial_prop s
  (idx :: indices)</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">finite_valid_trace_from_to RFree is&#39; s&#39; (tr ++ [item])</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="TraceableVLSM-v-chkf4" style="display: none" type="checkbox"><label class="alectryon-input" for="TraceableVLSM-v-chkf4"><span class="nb">replace</span> s&#39; <span class="kr">with</span> (destination item) <span class="kr">in</span> *
      <span class="bp">by</span> (<span class="nb">eapply</span> composite_tv_state_destructor_destination; <span class="bp">done</span>).</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>message, index</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>EqDecision0</var><span class="hyp-type"><b>: </b><span>EqDecision index</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>finite.Finite index</span></span></span><br><span><var>IM</var><span class="hyp-type"><b>: </b><span>index ‚Üí VLSM message</span></span></span><br><span><var>state_destructor</var><span class="hyp-type"><b>: </b><span><span class="kr">‚àÄ</span> <span class="nv">i</span> : index,
  vstate (IM i)
  ‚Üí list
      (vtransition_item (IM i) *
       vstate (IM i))</span></span></span><br><span><var>state_size</var><span class="hyp-type"><b>: </b><span><span class="kr">‚àÄ</span> <span class="nv">i</span> : index, vstate (IM i) ‚Üí nat</span></span></span><br><span><var>H0</var><span class="hyp-type"><b>: </b><span><span class="kr">‚àÄ</span> <span class="nv">i</span> : index,
  TraceableVLSM (IM i) 
    (state_destructor i) 
    (state_size i)</span></span></span><br><span><var>Free</var><span><span class="hyp-body"><b>:= </b><span>free_composite_vlsm IM</span></span><span class="hyp-type"><b>: </b><span>VLSM message</span></span></span></span><br><span><var>RFree</var><span><span class="hyp-body"><b>:= </b><span>pre_loaded_with_all_messages_vlsm Free</span></span><span class="hyp-type"><b>: </b><span>VLSM message</span></span></span></span><br><span><var>choose</var><span class="hyp-type"><b>: </b><span>choice_function</span></span></span><br><span><var>s'</var><span class="hyp-type"><b>: </b><span>composite_state IM</span></span></span><br><span><var>item</var><span class="hyp-type"><b>: </b><span>composite_transition_item IM</span></span></span><br><span><var>Hs'</var><span class="hyp-type"><b>: </b><span>valid_state_prop RFree (destination item)</span></span></span><br><span><var>idx</var><span class="hyp-type"><b>: </b><span>index</span></span></span><br><span><var>indices</var><span class="hyp-type"><b>: </b><span>list index</span></span></span><br><span><var>i_n</var><span class="hyp-type"><b>: </b><span>(index * nat)%type</span></span></span><br><span><var>s</var><span class="hyp-type"><b>: </b><span>composite_state IM</span></span></span><br><span><var>Hdestruct</var><span class="hyp-type"><b>: </b><span>(item, s)
‚àà composite_state_destructor
    (destination item) i_n.<span class="mi">1</span></span></span></span><br><span><var>tr</var><span class="hyp-type"><b>: </b><span>list (composite_transition_item IM)</span></span></span><br><span><var>is'</var><span class="hyp-type"><b>: </b><span>composite_state IM</span></span></span><br><span><var>Hind</var><span class="hyp-type"><b>: </b><span>choosing_well choose
‚Üí NoDup (idx :: indices)
  ‚Üí not_in_indices_initial_prop s
      (idx :: indices)
    ‚Üí <span class="kr">‚àÄ</span> (<span class="nv">is</span> : composite_state IM) 
        (<span class="nv">tr0</span> : list
                 (composite_transition_item IM)),
        (is&#39;, tr) = (<span class="kr">is</span>, tr0)
        ‚Üí finite_valid_trace_from_to RFree <span class="kr">is</span> s
            tr0</span></span></span><br><span><var>Hchoose</var><span class="hyp-type"><b>: </b><span>choosing_well choose</span></span></span><br><span><var>Hnodup</var><span class="hyp-type"><b>: </b><span>NoDup (idx :: indices)</span></span></span><br><span><var>Hinitial</var><span class="hyp-type"><b>: </b><span>not_in_indices_initial_prop s
  (idx :: indices)</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">finite_valid_trace_from_to RFree is&#39;
  (destination item) (tr ++ [item])</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="TraceableVLSM-v-chkf5" style="display: none" type="checkbox"><label class="alectryon-input" for="TraceableVLSM-v-chkf5"><span class="nb">eapply</span> composite_tv_state_destructor_transition <span class="kr">in</span> Hdestruct; [| <span class="bp">done</span>].</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>message, index</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>EqDecision0</var><span class="hyp-type"><b>: </b><span>EqDecision index</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>finite.Finite index</span></span></span><br><span><var>IM</var><span class="hyp-type"><b>: </b><span>index ‚Üí VLSM message</span></span></span><br><span><var>state_destructor</var><span class="hyp-type"><b>: </b><span><span class="kr">‚àÄ</span> <span class="nv">i</span> : index,
  vstate (IM i)
  ‚Üí list
      (vtransition_item (IM i) *
       vstate (IM i))</span></span></span><br><span><var>state_size</var><span class="hyp-type"><b>: </b><span><span class="kr">‚àÄ</span> <span class="nv">i</span> : index, vstate (IM i) ‚Üí nat</span></span></span><br><span><var>H0</var><span class="hyp-type"><b>: </b><span><span class="kr">‚àÄ</span> <span class="nv">i</span> : index,
  TraceableVLSM (IM i) 
    (state_destructor i) 
    (state_size i)</span></span></span><br><span><var>Free</var><span><span class="hyp-body"><b>:= </b><span>free_composite_vlsm IM</span></span><span class="hyp-type"><b>: </b><span>VLSM message</span></span></span></span><br><span><var>RFree</var><span><span class="hyp-body"><b>:= </b><span>pre_loaded_with_all_messages_vlsm Free</span></span><span class="hyp-type"><b>: </b><span>VLSM message</span></span></span></span><br><span><var>choose</var><span class="hyp-type"><b>: </b><span>choice_function</span></span></span><br><span><var>s'</var><span class="hyp-type"><b>: </b><span>composite_state IM</span></span></span><br><span><var>item</var><span class="hyp-type"><b>: </b><span>composite_transition_item IM</span></span></span><br><span><var>Hs'</var><span class="hyp-type"><b>: </b><span>valid_state_prop RFree (destination item)</span></span></span><br><span><var>idx</var><span class="hyp-type"><b>: </b><span>index</span></span></span><br><span><var>indices</var><span class="hyp-type"><b>: </b><span>list index</span></span></span><br><span><var>i_n</var><span class="hyp-type"><b>: </b><span>(index * nat)%type</span></span></span><br><span><var>s</var><span class="hyp-type"><b>: </b><span>composite_state IM</span></span></span><br><span><var>Hdestruct</var><span class="hyp-type"><b>: </b><span>input_valid_transition_item RFree s item</span></span></span><br><span><var>tr</var><span class="hyp-type"><b>: </b><span>list (composite_transition_item IM)</span></span></span><br><span><var>is'</var><span class="hyp-type"><b>: </b><span>composite_state IM</span></span></span><br><span><var>Hind</var><span class="hyp-type"><b>: </b><span>choosing_well choose
‚Üí NoDup (idx :: indices)
  ‚Üí not_in_indices_initial_prop s
      (idx :: indices)
    ‚Üí <span class="kr">‚àÄ</span> (<span class="nv">is</span> : composite_state IM) 
        (<span class="nv">tr0</span> : list
                 (composite_transition_item IM)),
        (is&#39;, tr) = (<span class="kr">is</span>, tr0)
        ‚Üí finite_valid_trace_from_to RFree <span class="kr">is</span> s
            tr0</span></span></span><br><span><var>Hchoose</var><span class="hyp-type"><b>: </b><span>choosing_well choose</span></span></span><br><span><var>Hnodup</var><span class="hyp-type"><b>: </b><span>NoDup (idx :: indices)</span></span></span><br><span><var>Hinitial</var><span class="hyp-type"><b>: </b><span>not_in_indices_initial_prop s
  (idx :: indices)</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">finite_valid_trace_from_to RFree is&#39;
  (destination item) (tr ++ [item])</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="TraceableVLSM-v-chkf6" style="display: none" type="checkbox"><label class="alectryon-input" for="TraceableVLSM-v-chkf6"><span class="nb">destruct</span> item; <span class="nb">cbn</span> <span class="kr">in</span> *.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>message, index</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>EqDecision0</var><span class="hyp-type"><b>: </b><span>EqDecision index</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>finite.Finite index</span></span></span><br><span><var>IM</var><span class="hyp-type"><b>: </b><span>index ‚Üí VLSM message</span></span></span><br><span><var>state_destructor</var><span class="hyp-type"><b>: </b><span><span class="kr">‚àÄ</span> <span class="nv">i</span> : index,
  vstate (IM i)
  ‚Üí list
      (vtransition_item (IM i) *
       vstate (IM i))</span></span></span><br><span><var>state_size</var><span class="hyp-type"><b>: </b><span><span class="kr">‚àÄ</span> <span class="nv">i</span> : index, vstate (IM i) ‚Üí nat</span></span></span><br><span><var>H0</var><span class="hyp-type"><b>: </b><span><span class="kr">‚àÄ</span> <span class="nv">i</span> : index,
  TraceableVLSM (IM i) 
    (state_destructor i) 
    (state_size i)</span></span></span><br><span><var>Free</var><span><span class="hyp-body"><b>:= </b><span>free_composite_vlsm IM</span></span><span class="hyp-type"><b>: </b><span>VLSM message</span></span></span></span><br><span><var>RFree</var><span><span class="hyp-body"><b>:= </b><span>pre_loaded_with_all_messages_vlsm Free</span></span><span class="hyp-type"><b>: </b><span>VLSM message</span></span></span></span><br><span><var>choose</var><span class="hyp-type"><b>: </b><span>choice_function</span></span></span><br><span><var>s'</var><span class="hyp-type"><b>: </b><span>composite_state IM</span></span></span><br><span><var>l</var><span class="hyp-type"><b>: </b><span>composite_label IM</span></span></span><br><span><var>input</var><span class="hyp-type"><b>: </b><span>option message</span></span></span><br><span><var>destination</var><span class="hyp-type"><b>: </b><span>composite_state IM</span></span></span><br><span><var>output</var><span class="hyp-type"><b>: </b><span>option message</span></span></span><br><span><var>Hs'</var><span class="hyp-type"><b>: </b><span>valid_state_prop RFree destination</span></span></span><br><span><var>idx</var><span class="hyp-type"><b>: </b><span>index</span></span></span><br><span><var>indices</var><span class="hyp-type"><b>: </b><span>list index</span></span></span><br><span><var>i_n</var><span class="hyp-type"><b>: </b><span>(index * nat)%type</span></span></span><br><span><var>s</var><span class="hyp-type"><b>: </b><span>composite_state IM</span></span></span><br><span><var>Hdestruct</var><span class="hyp-type"><b>: </b><span>input_valid_transition_item RFree s
  {|
    l := l;
    input := input;
    destination := destination;
    output := output
  |}</span></span></span><br><span><var>tr</var><span class="hyp-type"><b>: </b><span>list (composite_transition_item IM)</span></span></span><br><span><var>is'</var><span class="hyp-type"><b>: </b><span>composite_state IM</span></span></span><br><span><var>Hind</var><span class="hyp-type"><b>: </b><span>choosing_well choose
‚Üí NoDup (idx :: indices)
  ‚Üí not_in_indices_initial_prop s
      (idx :: indices)
    ‚Üí <span class="kr">‚àÄ</span> (<span class="nv">is</span> : composite_state IM) 
        (<span class="nv">tr0</span> : list
                 (composite_transition_item IM)),
        (is&#39;, tr) = (<span class="kr">is</span>, tr0)
        ‚Üí finite_valid_trace_from_to RFree <span class="kr">is</span> s
            tr0</span></span></span><br><span><var>Hchoose</var><span class="hyp-type"><b>: </b><span>choosing_well choose</span></span></span><br><span><var>Hnodup</var><span class="hyp-type"><b>: </b><span>NoDup (idx :: indices)</span></span></span><br><span><var>Hinitial</var><span class="hyp-type"><b>: </b><span>not_in_indices_initial_prop s
  (idx :: indices)</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">finite_valid_trace_from_to RFree is&#39; destination
  (tr ++
   [{|
      l := l;
      input := input;
      destination := destination;
      output := output
    |}])</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><span class="alectryon-input"><span class="bp">by</span> <span class="nb">apply</span> (extend_right_finite_trace_from_to RFree) <span class="kr">with</span> s; [<span class="nb">apply</span> Hind |].</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="TraceableVLSM-v-chkf7" style="display: none" type="checkbox"><label class="alectryon-input" for="TraceableVLSM-v-chkf7">-</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>message, index</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>EqDecision0</var><span class="hyp-type"><b>: </b><span>EqDecision index</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>finite.Finite index</span></span></span><br><span><var>IM</var><span class="hyp-type"><b>: </b><span>index ‚Üí VLSM message</span></span></span><br><span><var>state_destructor</var><span class="hyp-type"><b>: </b><span><span class="kr">‚àÄ</span> <span class="nv">i</span> : index,
  vstate (IM i)
  ‚Üí list
      (vtransition_item (IM i) *
       vstate (IM i))</span></span></span><br><span><var>state_size</var><span class="hyp-type"><b>: </b><span><span class="kr">‚àÄ</span> <span class="nv">i</span> : index, vstate (IM i) ‚Üí nat</span></span></span><br><span><var>H0</var><span class="hyp-type"><b>: </b><span><span class="kr">‚àÄ</span> <span class="nv">i</span> : index,
  TraceableVLSM (IM i) 
    (state_destructor i) 
    (state_size i)</span></span></span><br><span><var>Free</var><span><span class="hyp-body"><b>:= </b><span>free_composite_vlsm IM</span></span><span class="hyp-type"><b>: </b><span>VLSM message</span></span></span></span><br><span><var>RFree</var><span><span class="hyp-body"><b>:= </b><span>pre_loaded_with_all_messages_vlsm Free</span></span><span class="hyp-type"><b>: </b><span>VLSM message</span></span></span></span><br><span><var>choose</var><span class="hyp-type"><b>: </b><span>choice_function</span></span></span><br><span><var>s'</var><span class="hyp-type"><b>: </b><span>composite_state IM</span></span></span><br><span><var>Hs'</var><span class="hyp-type"><b>: </b><span>valid_state_prop RFree s&#39;</span></span></span><br><span><var>idx</var><span class="hyp-type"><b>: </b><span>index</span></span></span><br><span><var>indices</var><span class="hyp-type"><b>: </b><span>list index</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="kr">‚àÄ</span> (<span class="nv">i_n</span> : index * nat) (<span class="nv">n</span> : i_n.<span class="mi">1</span> ‚àâ idx :: indices) 
  (<span class="nv">Hni</span> : decide (i_n.<span class="mi">1</span> ‚àà idx :: indices) = <span class="nb">right</span> n) 
  (<span class="nv">Hdestruct</span> : composite_state_destructor s&#39; i_n.<span class="mi">1</span>
               !! i_n.<span class="mi">2</span> = None) (<span class="nv">Hchoice</span> : choose s&#39;
                                             Hs&#39;
                                             (idx
                                              :: indices) =
                                           i_n),
  inspect (decide (i_n.<span class="mi">1</span> ‚àà idx :: indices)) =
  <span class="nb">right</span> n ‚Üæ Hni
  ‚Üí inspect
      (composite_state_destructor s&#39; i_n.<span class="mi">1</span> !! i_n.<span class="mi">2</span>) =
    None ‚Üæ Hdestruct
    ‚Üí inspect (choose s&#39; Hs&#39; (idx :: indices)) =
      i_n ‚Üæ Hchoice
      ‚Üí choosing_well choose
        ‚Üí NoDup (idx :: indices)
          ‚Üí not_in_indices_initial_prop s&#39;
              (idx :: indices)
            ‚Üí <span class="kr">‚àÄ</span> (<span class="nv">is</span> : composite_state IM) (<span class="nv">tr</span> : list
                                                 (composite_transition_item
                                                 IM)),
                (s&#39;, []) = (<span class="kr">is</span>, tr)
                ‚Üí finite_valid_trace_from_to RFree <span class="kr">is</span>
                    s&#39; tr</div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="bp">by</span> <span class="nb">intros</span>; <span class="bp">contradiction</span> n; <span class="nb">subst</span>;
      <span class="nb">apply</span> cw_chosen_index_in_indices; [<span class="nb">apply</span> Hchoose |].</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="TraceableVLSM-v-chkf8" style="display: none" type="checkbox"><label class="alectryon-input" for="TraceableVLSM-v-chkf8">-</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>message, index</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>EqDecision0</var><span class="hyp-type"><b>: </b><span>EqDecision index</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>finite.Finite index</span></span></span><br><span><var>IM</var><span class="hyp-type"><b>: </b><span>index ‚Üí VLSM message</span></span></span><br><span><var>state_destructor</var><span class="hyp-type"><b>: </b><span><span class="kr">‚àÄ</span> <span class="nv">i</span> : index,
  vstate (IM i)
  ‚Üí list
      (vtransition_item (IM i) *
       vstate (IM i))</span></span></span><br><span><var>state_size</var><span class="hyp-type"><b>: </b><span><span class="kr">‚àÄ</span> <span class="nv">i</span> : index, vstate (IM i) ‚Üí nat</span></span></span><br><span><var>H0</var><span class="hyp-type"><b>: </b><span><span class="kr">‚àÄ</span> <span class="nv">i</span> : index,
  TraceableVLSM (IM i) 
    (state_destructor i) 
    (state_size i)</span></span></span><br><span><var>Free</var><span><span class="hyp-body"><b>:= </b><span>free_composite_vlsm IM</span></span><span class="hyp-type"><b>: </b><span>VLSM message</span></span></span></span><br><span><var>RFree</var><span><span class="hyp-body"><b>:= </b><span>pre_loaded_with_all_messages_vlsm Free</span></span><span class="hyp-type"><b>: </b><span>VLSM message</span></span></span></span><br><span><var>choose</var><span class="hyp-type"><b>: </b><span>choice_function</span></span></span><br><span><var>s'</var><span class="hyp-type"><b>: </b><span>composite_state IM</span></span></span><br><span><var>Hs'</var><span class="hyp-type"><b>: </b><span>valid_state_prop RFree s&#39;</span></span></span><br><span><var>idx</var><span class="hyp-type"><b>: </b><span>index</span></span></span><br><span><var>indices</var><span class="hyp-type"><b>: </b><span>list index</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="kr">‚àÄ</span> (<span class="nv">i_n</span> : index * nat) (<span class="nv">e1</span> : composite_state_destructor
                              s&#39; i_n.<span class="mi">1</span> = []) (<span class="nv">Hnn</span> : 
                                              decide
                                                (composite_state_destructor
                                                 s&#39;
                                                 i_n.<span class="mi">1</span> =
                                                 []) =
                                              <span class="nb">left</span> e1) 
  (<span class="nv">e0</span> : i_n.<span class="mi">1</span> ‚àà idx :: indices) (<span class="nv">Hi</span> : decide
                                        (i_n.<span class="mi">1</span>
                                         ‚àà idx
                                           :: indices) =
                                      <span class="nb">left</span> e0) (<span class="nv">Hdestruct</span> : 
                                                composite_state_destructor
                                                 s&#39;
                                                 i_n.<span class="mi">1</span>
                                                !! i_n.<span class="mi">2</span> =
                                                None) 
  (<span class="nv">Hchoice</span> : choose s&#39; Hs&#39; (idx :: indices) = i_n),
  (choosing_well choose
   ‚Üí NoDup
       (StdppListSet.set_remove i_n.<span class="mi">1</span> (idx :: indices))
     ‚Üí not_in_indices_initial_prop s&#39;
         (StdppListSet.set_remove i_n.<span class="mi">1</span>
            (idx :: indices))
       ‚Üí <span class="kr">‚àÄ</span> (<span class="nv">is</span> : composite_state IM) (<span class="nv">tr</span> : list
                                             (composite_transition_item
                                                IM)),
           indexed_composite_state_to_trace choose s&#39;
             Hs&#39;
             (StdppListSet.set_remove i_n.<span class="mi">1</span>
                (idx :: indices)) = (<span class="kr">is</span>, tr)
           ‚Üí finite_valid_trace_from_to RFree <span class="kr">is</span> s&#39; tr)
  ‚Üí inspect
      (decide
         (composite_state_destructor s&#39; i_n.<span class="mi">1</span> = [])) =
    <span class="nb">left</span> e1 ‚Üæ Hnn
    ‚Üí inspect (decide (i_n.<span class="mi">1</span> ‚àà idx :: indices)) =
      <span class="nb">left</span> e0 ‚Üæ Hi
      ‚Üí inspect
          (composite_state_destructor s&#39; i_n.<span class="mi">1</span>
           !! i_n.<span class="mi">2</span>) = None ‚Üæ Hdestruct
        ‚Üí inspect (choose s&#39; Hs&#39; (idx :: indices)) =
          i_n ‚Üæ Hchoice
          ‚Üí choosing_well choose
            ‚Üí NoDup (idx :: indices)
              ‚Üí not_in_indices_initial_prop s&#39;
                  (idx :: indices)
                ‚Üí <span class="kr">‚àÄ</span> (<span class="nv">is</span> : composite_state IM) (<span class="nv">tr</span> : 
                                               list
                                                 (composite_transition_item
                                                 IM)),
                    indexed_composite_state_to_trace
                      choose s&#39; Hs&#39;
                      (StdppListSet.set_remove i_n.<span class="mi">1</span>
                         (idx :: indices)) = (<span class="kr">is</span>, tr)
                    ‚Üí finite_valid_trace_from_to RFree
                        <span class="kr">is</span> s&#39; tr</div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="TraceableVLSM-v-chkf9" style="display: none" type="checkbox"><label class="alectryon-input" for="TraceableVLSM-v-chkf9"><span class="nb">intros</span> ? Hdestruct _ Hj _ _ -&gt; Hind _ _ _ _ **; <span class="nb">eapply</span> Hind; [<span class="bp">done</span> | | | <span class="bp">done</span>].</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>message, index</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>EqDecision0</var><span class="hyp-type"><b>: </b><span>EqDecision index</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>finite.Finite index</span></span></span><br><span><var>IM</var><span class="hyp-type"><b>: </b><span>index ‚Üí VLSM message</span></span></span><br><span><var>state_destructor</var><span class="hyp-type"><b>: </b><span><span class="kr">‚àÄ</span> <span class="nv">i</span> : index,
  vstate (IM i)
  ‚Üí list
      (vtransition_item (IM i) *
       vstate (IM i))</span></span></span><br><span><var>state_size</var><span class="hyp-type"><b>: </b><span><span class="kr">‚àÄ</span> <span class="nv">i</span> : index, vstate (IM i) ‚Üí nat</span></span></span><br><span><var>H0</var><span class="hyp-type"><b>: </b><span><span class="kr">‚àÄ</span> <span class="nv">i</span> : index,
  TraceableVLSM (IM i) 
    (state_destructor i) 
    (state_size i)</span></span></span><br><span><var>Free</var><span><span class="hyp-body"><b>:= </b><span>free_composite_vlsm IM</span></span><span class="hyp-type"><b>: </b><span>VLSM message</span></span></span></span><br><span><var>RFree</var><span><span class="hyp-body"><b>:= </b><span>pre_loaded_with_all_messages_vlsm Free</span></span><span class="hyp-type"><b>: </b><span>VLSM message</span></span></span></span><br><span><var>choose</var><span class="hyp-type"><b>: </b><span>choice_function</span></span></span><br><span><var>s'</var><span class="hyp-type"><b>: </b><span>composite_state IM</span></span></span><br><span><var>Hs'</var><span class="hyp-type"><b>: </b><span>valid_state_prop RFree s&#39;</span></span></span><br><span><var>idx</var><span class="hyp-type"><b>: </b><span>index</span></span></span><br><span><var>indices</var><span class="hyp-type"><b>: </b><span>list index</span></span></span><br><span><var>i_n</var><span class="hyp-type"><b>: </b><span>(index * nat)%type</span></span></span><br><span><var>Hdestruct</var><span class="hyp-type"><b>: </b><span>composite_state_destructor s&#39; i_n.<span class="mi">1</span> = []</span></span></span><br><span><var>Hj</var><span class="hyp-type"><b>: </b><span>i_n.<span class="mi">1</span> ‚àà idx :: indices</span></span></span><br><span><var>Hind</var><span class="hyp-type"><b>: </b><span>choosing_well choose
‚Üí NoDup
    (StdppListSet.set_remove i_n.<span class="mi">1</span>
       (idx :: indices))
  ‚Üí not_in_indices_initial_prop s&#39;
      (StdppListSet.set_remove i_n.<span class="mi">1</span>
         (idx :: indices))
    ‚Üí <span class="kr">‚àÄ</span> (<span class="nv">is</span> : composite_state IM) 
        (<span class="nv">tr</span> : list
                (composite_transition_item IM)),
        indexed_composite_state_to_trace choose
          s&#39; Hs&#39;
          (StdppListSet.set_remove i_n.<span class="mi">1</span>
             (idx :: indices)) = 
        (<span class="kr">is</span>, tr)
        ‚Üí finite_valid_trace_from_to RFree <span class="kr">is</span>
            s&#39; tr</span></span></span><br><span><var>Hchoose</var><span class="hyp-type"><b>: </b><span>choosing_well choose</span></span></span><br><span><var>H1</var><span class="hyp-type"><b>: </b><span>NoDup (idx :: indices)</span></span></span><br><span><var>H2</var><span class="hyp-type"><b>: </b><span>not_in_indices_initial_prop s&#39; (idx :: indices)</span></span></span><br><span><var>is</var><span class="hyp-type"><b>: </b><span>composite_state IM</span></span></span><br><span><var>tr</var><span class="hyp-type"><b>: </b><span>list (composite_transition_item IM)</span></span></span><br><span><var>H3</var><span class="hyp-type"><b>: </b><span>indexed_composite_state_to_trace choose s&#39; Hs&#39;
  (StdppListSet.set_remove i_n.<span class="mi">1</span> (idx :: indices)) =
(<span class="kr">is</span>, tr)</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">NoDup (StdppListSet.set_remove i_n.<span class="mi">1</span> (idx :: indices))</div></blockquote><div class="alectryon-extra-goals"><input class="alectryon-extra-goal-toggle" id="TraceableVLSM-v-chkfa" style="display: none" type="checkbox"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>message, index</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>EqDecision0</var><span class="hyp-type"><b>: </b><span>EqDecision index</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>finite.Finite index</span></span></span><br><span><var>IM</var><span class="hyp-type"><b>: </b><span>index ‚Üí VLSM message</span></span></span><br><span><var>state_destructor</var><span class="hyp-type"><b>: </b><span><span class="kr">‚àÄ</span> <span class="nv">i</span> : index,
  vstate (IM i)
  ‚Üí list
      (vtransition_item (IM i) *
       vstate (IM i))</span></span></span><br><span><var>state_size</var><span class="hyp-type"><b>: </b><span><span class="kr">‚àÄ</span> <span class="nv">i</span> : index, vstate (IM i) ‚Üí nat</span></span></span><br><span><var>H0</var><span class="hyp-type"><b>: </b><span><span class="kr">‚àÄ</span> <span class="nv">i</span> : index,
  TraceableVLSM (IM i) 
    (state_destructor i) 
    (state_size i)</span></span></span><br><span><var>Free</var><span><span class="hyp-body"><b>:= </b><span>free_composite_vlsm IM</span></span><span class="hyp-type"><b>: </b><span>VLSM message</span></span></span></span><br><span><var>RFree</var><span><span class="hyp-body"><b>:= </b><span>pre_loaded_with_all_messages_vlsm Free</span></span><span class="hyp-type"><b>: </b><span>VLSM message</span></span></span></span><br><span><var>choose</var><span class="hyp-type"><b>: </b><span>choice_function</span></span></span><br><span><var>s'</var><span class="hyp-type"><b>: </b><span>composite_state IM</span></span></span><br><span><var>Hs'</var><span class="hyp-type"><b>: </b><span>valid_state_prop RFree s&#39;</span></span></span><br><span><var>idx</var><span class="hyp-type"><b>: </b><span>index</span></span></span><br><span><var>indices</var><span class="hyp-type"><b>: </b><span>list index</span></span></span><br><span><var>i_n</var><span class="hyp-type"><b>: </b><span>(index * nat)%type</span></span></span><br><span><var>Hdestruct</var><span class="hyp-type"><b>: </b><span>composite_state_destructor s&#39; i_n.<span class="mi">1</span> = []</span></span></span><br><span><var>Hj</var><span class="hyp-type"><b>: </b><span>i_n.<span class="mi">1</span> ‚àà idx :: indices</span></span></span><br><span><var>Hind</var><span class="hyp-type"><b>: </b><span>choosing_well choose
‚Üí NoDup
    (StdppListSet.set_remove i_n.<span class="mi">1</span>
       (idx :: indices))
  ‚Üí not_in_indices_initial_prop s&#39;
      (StdppListSet.set_remove i_n.<span class="mi">1</span>
         (idx :: indices))
    ‚Üí <span class="kr">‚àÄ</span> (<span class="nv">is</span> : composite_state IM) 
        (<span class="nv">tr</span> : list
                (composite_transition_item IM)),
        indexed_composite_state_to_trace choose
          s&#39; Hs&#39;
          (StdppListSet.set_remove i_n.<span class="mi">1</span>
             (idx :: indices)) = 
        (<span class="kr">is</span>, tr)
        ‚Üí finite_valid_trace_from_to RFree <span class="kr">is</span>
            s&#39; tr</span></span></span><br><span><var>Hchoose</var><span class="hyp-type"><b>: </b><span>choosing_well choose</span></span></span><br><span><var>H1</var><span class="hyp-type"><b>: </b><span>NoDup (idx :: indices)</span></span></span><br><span><var>H2</var><span class="hyp-type"><b>: </b><span>not_in_indices_initial_prop s&#39; (idx :: indices)</span></span></span><br><span><var>is</var><span class="hyp-type"><b>: </b><span>composite_state IM</span></span></span><br><span><var>tr</var><span class="hyp-type"><b>: </b><span>list (composite_transition_item IM)</span></span></span><br><span><var>H3</var><span class="hyp-type"><b>: </b><span>indexed_composite_state_to_trace choose s&#39; Hs&#39;
  (StdppListSet.set_remove i_n.<span class="mi">1</span> (idx :: indices)) =
(<span class="kr">is</span>, tr)</span></span></span><br></div><label class="goal-separator" for="TraceableVLSM-v-chkfa"><hr></label><div class="goal-conclusion">not_in_indices_initial_prop s&#39;
  (StdppListSet.set_remove i_n.<span class="mi">1</span> (idx :: indices))</div></blockquote></div></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="TraceableVLSM-v-chkfb" style="display: none" type="checkbox"><label class="alectryon-input" for="TraceableVLSM-v-chkfb">+</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>message, index</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>EqDecision0</var><span class="hyp-type"><b>: </b><span>EqDecision index</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>finite.Finite index</span></span></span><br><span><var>IM</var><span class="hyp-type"><b>: </b><span>index ‚Üí VLSM message</span></span></span><br><span><var>state_destructor</var><span class="hyp-type"><b>: </b><span><span class="kr">‚àÄ</span> <span class="nv">i</span> : index,
  vstate (IM i)
  ‚Üí list
      (vtransition_item (IM i) *
       vstate (IM i))</span></span></span><br><span><var>state_size</var><span class="hyp-type"><b>: </b><span><span class="kr">‚àÄ</span> <span class="nv">i</span> : index, vstate (IM i) ‚Üí nat</span></span></span><br><span><var>H0</var><span class="hyp-type"><b>: </b><span><span class="kr">‚àÄ</span> <span class="nv">i</span> : index,
  TraceableVLSM (IM i) 
    (state_destructor i) 
    (state_size i)</span></span></span><br><span><var>Free</var><span><span class="hyp-body"><b>:= </b><span>free_composite_vlsm IM</span></span><span class="hyp-type"><b>: </b><span>VLSM message</span></span></span></span><br><span><var>RFree</var><span><span class="hyp-body"><b>:= </b><span>pre_loaded_with_all_messages_vlsm Free</span></span><span class="hyp-type"><b>: </b><span>VLSM message</span></span></span></span><br><span><var>choose</var><span class="hyp-type"><b>: </b><span>choice_function</span></span></span><br><span><var>s'</var><span class="hyp-type"><b>: </b><span>composite_state IM</span></span></span><br><span><var>Hs'</var><span class="hyp-type"><b>: </b><span>valid_state_prop RFree s&#39;</span></span></span><br><span><var>idx</var><span class="hyp-type"><b>: </b><span>index</span></span></span><br><span><var>indices</var><span class="hyp-type"><b>: </b><span>list index</span></span></span><br><span><var>i_n</var><span class="hyp-type"><b>: </b><span>(index * nat)%type</span></span></span><br><span><var>Hdestruct</var><span class="hyp-type"><b>: </b><span>composite_state_destructor s&#39; i_n.<span class="mi">1</span> = []</span></span></span><br><span><var>Hj</var><span class="hyp-type"><b>: </b><span>i_n.<span class="mi">1</span> ‚àà idx :: indices</span></span></span><br><span><var>Hind</var><span class="hyp-type"><b>: </b><span>choosing_well choose
‚Üí NoDup
    (StdppListSet.set_remove i_n.<span class="mi">1</span>
       (idx :: indices))
  ‚Üí not_in_indices_initial_prop s&#39;
      (StdppListSet.set_remove i_n.<span class="mi">1</span>
         (idx :: indices))
    ‚Üí <span class="kr">‚àÄ</span> (<span class="nv">is</span> : composite_state IM) 
        (<span class="nv">tr</span> : list
                (composite_transition_item IM)),
        indexed_composite_state_to_trace choose
          s&#39; Hs&#39;
          (StdppListSet.set_remove i_n.<span class="mi">1</span>
             (idx :: indices)) = 
        (<span class="kr">is</span>, tr)
        ‚Üí finite_valid_trace_from_to RFree <span class="kr">is</span>
            s&#39; tr</span></span></span><br><span><var>Hchoose</var><span class="hyp-type"><b>: </b><span>choosing_well choose</span></span></span><br><span><var>H1</var><span class="hyp-type"><b>: </b><span>NoDup (idx :: indices)</span></span></span><br><span><var>H2</var><span class="hyp-type"><b>: </b><span>not_in_indices_initial_prop s&#39; (idx :: indices)</span></span></span><br><span><var>is</var><span class="hyp-type"><b>: </b><span>composite_state IM</span></span></span><br><span><var>tr</var><span class="hyp-type"><b>: </b><span>list (composite_transition_item IM)</span></span></span><br><span><var>H3</var><span class="hyp-type"><b>: </b><span>indexed_composite_state_to_trace choose s&#39; Hs&#39;
  (StdppListSet.set_remove i_n.<span class="mi">1</span> (idx :: indices)) =
(<span class="kr">is</span>, tr)</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">NoDup (StdppListSet.set_remove i_n.<span class="mi">1</span> (idx :: indices))</div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="bp">by</span> <span class="nb">apply</span> StdppListSet.set_remove_nodup.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="TraceableVLSM-v-chkfc" style="display: none" type="checkbox"><label class="alectryon-input" for="TraceableVLSM-v-chkfc">+</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>message, index</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>EqDecision0</var><span class="hyp-type"><b>: </b><span>EqDecision index</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>finite.Finite index</span></span></span><br><span><var>IM</var><span class="hyp-type"><b>: </b><span>index ‚Üí VLSM message</span></span></span><br><span><var>state_destructor</var><span class="hyp-type"><b>: </b><span><span class="kr">‚àÄ</span> <span class="nv">i</span> : index,
  vstate (IM i)
  ‚Üí list
      (vtransition_item (IM i) *
       vstate (IM i))</span></span></span><br><span><var>state_size</var><span class="hyp-type"><b>: </b><span><span class="kr">‚àÄ</span> <span class="nv">i</span> : index, vstate (IM i) ‚Üí nat</span></span></span><br><span><var>H0</var><span class="hyp-type"><b>: </b><span><span class="kr">‚àÄ</span> <span class="nv">i</span> : index,
  TraceableVLSM (IM i) 
    (state_destructor i) 
    (state_size i)</span></span></span><br><span><var>Free</var><span><span class="hyp-body"><b>:= </b><span>free_composite_vlsm IM</span></span><span class="hyp-type"><b>: </b><span>VLSM message</span></span></span></span><br><span><var>RFree</var><span><span class="hyp-body"><b>:= </b><span>pre_loaded_with_all_messages_vlsm Free</span></span><span class="hyp-type"><b>: </b><span>VLSM message</span></span></span></span><br><span><var>choose</var><span class="hyp-type"><b>: </b><span>choice_function</span></span></span><br><span><var>s'</var><span class="hyp-type"><b>: </b><span>composite_state IM</span></span></span><br><span><var>Hs'</var><span class="hyp-type"><b>: </b><span>valid_state_prop RFree s&#39;</span></span></span><br><span><var>idx</var><span class="hyp-type"><b>: </b><span>index</span></span></span><br><span><var>indices</var><span class="hyp-type"><b>: </b><span>list index</span></span></span><br><span><var>i_n</var><span class="hyp-type"><b>: </b><span>(index * nat)%type</span></span></span><br><span><var>Hdestruct</var><span class="hyp-type"><b>: </b><span>composite_state_destructor s&#39; i_n.<span class="mi">1</span> = []</span></span></span><br><span><var>Hj</var><span class="hyp-type"><b>: </b><span>i_n.<span class="mi">1</span> ‚àà idx :: indices</span></span></span><br><span><var>Hind</var><span class="hyp-type"><b>: </b><span>choosing_well choose
‚Üí NoDup
    (StdppListSet.set_remove i_n.<span class="mi">1</span>
       (idx :: indices))
  ‚Üí not_in_indices_initial_prop s&#39;
      (StdppListSet.set_remove i_n.<span class="mi">1</span>
         (idx :: indices))
    ‚Üí <span class="kr">‚àÄ</span> (<span class="nv">is</span> : composite_state IM) 
        (<span class="nv">tr</span> : list
                (composite_transition_item IM)),
        indexed_composite_state_to_trace choose
          s&#39; Hs&#39;
          (StdppListSet.set_remove i_n.<span class="mi">1</span>
             (idx :: indices)) = 
        (<span class="kr">is</span>, tr)
        ‚Üí finite_valid_trace_from_to RFree <span class="kr">is</span>
            s&#39; tr</span></span></span><br><span><var>Hchoose</var><span class="hyp-type"><b>: </b><span>choosing_well choose</span></span></span><br><span><var>H1</var><span class="hyp-type"><b>: </b><span>NoDup (idx :: indices)</span></span></span><br><span><var>H2</var><span class="hyp-type"><b>: </b><span>not_in_indices_initial_prop s&#39; (idx :: indices)</span></span></span><br><span><var>is</var><span class="hyp-type"><b>: </b><span>composite_state IM</span></span></span><br><span><var>tr</var><span class="hyp-type"><b>: </b><span>list (composite_transition_item IM)</span></span></span><br><span><var>H3</var><span class="hyp-type"><b>: </b><span>indexed_composite_state_to_trace choose s&#39; Hs&#39;
  (StdppListSet.set_remove i_n.<span class="mi">1</span> (idx :: indices)) =
(<span class="kr">is</span>, tr)</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">not_in_indices_initial_prop s&#39;
  (StdppListSet.set_remove i_n.<span class="mi">1</span> (idx :: indices))</div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="bp">by</span> <span class="nb">apply</span> set_remove_preserves_not_in_indices_initial.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="TraceableVLSM-v-chkfd" style="display: none" type="checkbox"><label class="alectryon-input" for="TraceableVLSM-v-chkfd">-</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>message, index</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>EqDecision0</var><span class="hyp-type"><b>: </b><span>EqDecision index</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>finite.Finite index</span></span></span><br><span><var>IM</var><span class="hyp-type"><b>: </b><span>index ‚Üí VLSM message</span></span></span><br><span><var>state_destructor</var><span class="hyp-type"><b>: </b><span><span class="kr">‚àÄ</span> <span class="nv">i</span> : index,
  vstate (IM i)
  ‚Üí list
      (vtransition_item (IM i) *
       vstate (IM i))</span></span></span><br><span><var>state_size</var><span class="hyp-type"><b>: </b><span><span class="kr">‚àÄ</span> <span class="nv">i</span> : index, vstate (IM i) ‚Üí nat</span></span></span><br><span><var>H0</var><span class="hyp-type"><b>: </b><span><span class="kr">‚àÄ</span> <span class="nv">i</span> : index,
  TraceableVLSM (IM i) 
    (state_destructor i) 
    (state_size i)</span></span></span><br><span><var>Free</var><span><span class="hyp-body"><b>:= </b><span>free_composite_vlsm IM</span></span><span class="hyp-type"><b>: </b><span>VLSM message</span></span></span></span><br><span><var>RFree</var><span><span class="hyp-body"><b>:= </b><span>pre_loaded_with_all_messages_vlsm Free</span></span><span class="hyp-type"><b>: </b><span>VLSM message</span></span></span></span><br><span><var>choose</var><span class="hyp-type"><b>: </b><span>choice_function</span></span></span><br><span><var>s'</var><span class="hyp-type"><b>: </b><span>composite_state IM</span></span></span><br><span><var>Hs'</var><span class="hyp-type"><b>: </b><span>valid_state_prop RFree s&#39;</span></span></span><br><span><var>idx</var><span class="hyp-type"><b>: </b><span>index</span></span></span><br><span><var>indices</var><span class="hyp-type"><b>: </b><span>list index</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="kr">‚àÄ</span> (<span class="nv">i_n</span> : index * nat) (<span class="nv">n</span> : composite_state_destructor
                             s&#39; i_n.<span class="mi">1</span> ‚â† []) (<span class="nv">Hn</span> : 
                                             decide
                                               (composite_state_destructor
                                                 s&#39;
                                                 i_n.<span class="mi">1</span> =
                                                []) =
                                             <span class="nb">right</span> n) 
  (<span class="nv">e0</span> : i_n.<span class="mi">1</span> ‚àà idx :: indices) (<span class="nv">Hi</span> : decide
                                        (i_n.<span class="mi">1</span>
                                         ‚àà idx
                                           :: indices) =
                                      <span class="nb">left</span> e0) (<span class="nv">Hdestruct</span> : 
                                                composite_state_destructor
                                                 s&#39;
                                                 i_n.<span class="mi">1</span>
                                                !! i_n.<span class="mi">2</span> =
                                                None) 
  (<span class="nv">Hchoice</span> : choose s&#39; Hs&#39; (idx :: indices) = i_n),
  inspect
    (decide (composite_state_destructor s&#39; i_n.<span class="mi">1</span> = [])) =
  <span class="nb">right</span> n ‚Üæ Hn
  ‚Üí inspect (decide (i_n.<span class="mi">1</span> ‚àà idx :: indices)) =
    <span class="nb">left</span> e0 ‚Üæ Hi
    ‚Üí inspect
        (composite_state_destructor s&#39; i_n.<span class="mi">1</span> !! i_n.<span class="mi">2</span>) =
      None ‚Üæ Hdestruct
      ‚Üí inspect (choose s&#39; Hs&#39; (idx :: indices)) =
        i_n ‚Üæ Hchoice
        ‚Üí choosing_well choose
          ‚Üí NoDup (idx :: indices)
            ‚Üí not_in_indices_initial_prop s&#39;
                (idx :: indices)
              ‚Üí <span class="kr">‚àÄ</span> (<span class="nv">is</span> : composite_state IM) (<span class="nv">tr</span> : 
                                             list
                                               (composite_transition_item
                                                 IM)),
                  (s&#39;, []) = (<span class="kr">is</span>, tr)
                  ‚Üí finite_valid_trace_from_to RFree
                      <span class="kr">is</span> s&#39; tr</div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="bp">by</span> <span class="nb">intros</span>; <span class="nb">clear</span> Heq1; <span class="bp">contradict</span> Hdestruct; <span class="nb">subst</span>;
      <span class="nb">eapply</span> choosing_well_position_exists; [<span class="nb">apply</span> Hchoose |].</span><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Qed</span>.</span></span></pre><div class="doc">
  Given a composite ram-state, and a <span class="inlinecode"><span class="id" title="var">choice_function</span></span>, we can extract a ram-trace
  leading to that state by instantiating <span class="inlinecode"><span class="id" title="var">indexed_composite_state_to_trace</span></span> with
  the set of all indices.

</div><pre class="alectryon-io highlight"><!-- Generator: Alectryon --><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Definition</span> <span class="nf">composite_state_to_trace</span>
  (<span class="nv">choose</span> : choice_function)
  (<span class="nv">s</span> : composite_state IM) (<span class="nv">Hs</span> : valid_state_prop RFree s)
  : composite_state IM * list (composite_transition_item IM) :=
  indexed_composite_state_to_trace choose s Hs (enum index).</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
</span><span class="alectryon-sentence"><input class="alectryon-toggle" id="TraceableVLSM-v-chkfe" style="display: none" type="checkbox"><label class="alectryon-input" for="TraceableVLSM-v-chkfe"><span class="kn">Lemma</span> <span class="nf">reachable_composite_state_to_trace</span> :
  <span class="kr">forall</span> (<span class="nv">choose</span> : choice_function), choosing_well choose -&gt;
  <span class="kr">forall</span> (<span class="nv">s</span> : composite_state IM) (<span class="nv">Hs</span> : valid_state_prop RFree s),
  <span class="kr">forall</span> <span class="nv">is</span> <span class="nv">tr</span>, composite_state_to_trace choose s Hs = (<span class="kr">is</span>, tr) -&gt;
  finite_valid_trace_init_to RFree <span class="kr">is</span> s tr.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>message, index</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>EqDecision0</var><span class="hyp-type"><b>: </b><span>EqDecision index</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>finite.Finite index</span></span></span><br><span><var>IM</var><span class="hyp-type"><b>: </b><span>index ‚Üí VLSM message</span></span></span><br><span><var>state_destructor</var><span class="hyp-type"><b>: </b><span><span class="kr">‚àÄ</span> <span class="nv">i</span> : index,
  vstate (IM i)
  ‚Üí list
      (vtransition_item (IM i) *
       vstate (IM i))</span></span></span><br><span><var>state_size</var><span class="hyp-type"><b>: </b><span><span class="kr">‚àÄ</span> <span class="nv">i</span> : index, vstate (IM i) ‚Üí nat</span></span></span><br><span><var>H0</var><span class="hyp-type"><b>: </b><span><span class="kr">‚àÄ</span> <span class="nv">i</span> : index,
  TraceableVLSM (IM i) 
    (state_destructor i) 
    (state_size i)</span></span></span><br><span><var>Free</var><span><span class="hyp-body"><b>:= </b><span>free_composite_vlsm IM</span></span><span class="hyp-type"><b>: </b><span>VLSM message</span></span></span></span><br><span><var>RFree</var><span><span class="hyp-body"><b>:= </b><span>pre_loaded_with_all_messages_vlsm Free</span></span><span class="hyp-type"><b>: </b><span>VLSM message</span></span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="kr">‚àÄ</span> <span class="nv">choose</span> : choice_function,
  choosing_well choose
  ‚Üí <span class="kr">‚àÄ</span> (<span class="nv">s</span> : composite_state IM) (<span class="nv">Hs</span> : valid_state_prop
                                       RFree s) (<span class="nv">is</span> : 
                                                 composite_state
                                                 IM) 
      (<span class="nv">tr</span> : list (composite_transition_item IM)),
      composite_state_to_trace choose s Hs = (<span class="kr">is</span>, tr)
      ‚Üí finite_valid_trace_init_to RFree <span class="kr">is</span> s tr</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="TraceableVLSM-v-chkff" style="display: none" type="checkbox"><label class="alectryon-input" for="TraceableVLSM-v-chkff"><span class="kn">Proof</span>.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>message, index</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>EqDecision0</var><span class="hyp-type"><b>: </b><span>EqDecision index</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>finite.Finite index</span></span></span><br><span><var>IM</var><span class="hyp-type"><b>: </b><span>index ‚Üí VLSM message</span></span></span><br><span><var>state_destructor</var><span class="hyp-type"><b>: </b><span><span class="kr">‚àÄ</span> <span class="nv">i</span> : index,
  vstate (IM i)
  ‚Üí list
      (vtransition_item (IM i) *
       vstate (IM i))</span></span></span><br><span><var>state_size</var><span class="hyp-type"><b>: </b><span><span class="kr">‚àÄ</span> <span class="nv">i</span> : index, vstate (IM i) ‚Üí nat</span></span></span><br><span><var>H0</var><span class="hyp-type"><b>: </b><span><span class="kr">‚àÄ</span> <span class="nv">i</span> : index,
  TraceableVLSM (IM i) 
    (state_destructor i) 
    (state_size i)</span></span></span><br><span><var>Free</var><span><span class="hyp-body"><b>:= </b><span>free_composite_vlsm IM</span></span><span class="hyp-type"><b>: </b><span>VLSM message</span></span></span></span><br><span><var>RFree</var><span><span class="hyp-body"><b>:= </b><span>pre_loaded_with_all_messages_vlsm Free</span></span><span class="hyp-type"><b>: </b><span>VLSM message</span></span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="kr">‚àÄ</span> <span class="nv">choose</span> : choice_function,
  choosing_well choose
  ‚Üí <span class="kr">‚àÄ</span> (<span class="nv">s</span> : composite_state IM) (<span class="nv">Hs</span> : valid_state_prop
                                       RFree s) (<span class="nv">is</span> : 
                                                 composite_state
                                                 IM) 
      (<span class="nv">tr</span> : list (composite_transition_item IM)),
      composite_state_to_trace choose s Hs = (<span class="kr">is</span>, tr)
      ‚Üí finite_valid_trace_init_to RFree <span class="kr">is</span> s tr</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="TraceableVLSM-v-chk100" style="display: none" type="checkbox"><label class="alectryon-input" for="TraceableVLSM-v-chk100"><span class="nb">intros</span> ? Hchoose * Heqis_tr.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>message, index</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>EqDecision0</var><span class="hyp-type"><b>: </b><span>EqDecision index</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>finite.Finite index</span></span></span><br><span><var>IM</var><span class="hyp-type"><b>: </b><span>index ‚Üí VLSM message</span></span></span><br><span><var>state_destructor</var><span class="hyp-type"><b>: </b><span><span class="kr">‚àÄ</span> <span class="nv">i</span> : index,
  vstate (IM i)
  ‚Üí list
      (vtransition_item (IM i) *
       vstate (IM i))</span></span></span><br><span><var>state_size</var><span class="hyp-type"><b>: </b><span><span class="kr">‚àÄ</span> <span class="nv">i</span> : index, vstate (IM i) ‚Üí nat</span></span></span><br><span><var>H0</var><span class="hyp-type"><b>: </b><span><span class="kr">‚àÄ</span> <span class="nv">i</span> : index,
  TraceableVLSM (IM i) 
    (state_destructor i) 
    (state_size i)</span></span></span><br><span><var>Free</var><span><span class="hyp-body"><b>:= </b><span>free_composite_vlsm IM</span></span><span class="hyp-type"><b>: </b><span>VLSM message</span></span></span></span><br><span><var>RFree</var><span><span class="hyp-body"><b>:= </b><span>pre_loaded_with_all_messages_vlsm Free</span></span><span class="hyp-type"><b>: </b><span>VLSM message</span></span></span></span><br><span><var>choose</var><span class="hyp-type"><b>: </b><span>choice_function</span></span></span><br><span><var>Hchoose</var><span class="hyp-type"><b>: </b><span>choosing_well choose</span></span></span><br><span><var>s</var><span class="hyp-type"><b>: </b><span>composite_state IM</span></span></span><br><span><var>Hs</var><span class="hyp-type"><b>: </b><span>valid_state_prop RFree s</span></span></span><br><span><var>is</var><span class="hyp-type"><b>: </b><span>composite_state IM</span></span></span><br><span><var>tr</var><span class="hyp-type"><b>: </b><span>list (composite_transition_item IM)</span></span></span><br><span><var>Heqis_tr</var><span class="hyp-type"><b>: </b><span>composite_state_to_trace choose s Hs =
(<span class="kr">is</span>, tr)</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">finite_valid_trace_init_to RFree <span class="kr">is</span> s tr</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="TraceableVLSM-v-chk101" style="display: none" type="checkbox"><label class="alectryon-input" for="TraceableVLSM-v-chk101"><span class="nb">pose proof</span> (Hnodup := NoDup_enum index).</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>message, index</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>EqDecision0</var><span class="hyp-type"><b>: </b><span>EqDecision index</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>finite.Finite index</span></span></span><br><span><var>IM</var><span class="hyp-type"><b>: </b><span>index ‚Üí VLSM message</span></span></span><br><span><var>state_destructor</var><span class="hyp-type"><b>: </b><span><span class="kr">‚àÄ</span> <span class="nv">i</span> : index,
  vstate (IM i)
  ‚Üí list
      (vtransition_item (IM i) *
       vstate (IM i))</span></span></span><br><span><var>state_size</var><span class="hyp-type"><b>: </b><span><span class="kr">‚àÄ</span> <span class="nv">i</span> : index, vstate (IM i) ‚Üí nat</span></span></span><br><span><var>H0</var><span class="hyp-type"><b>: </b><span><span class="kr">‚àÄ</span> <span class="nv">i</span> : index,
  TraceableVLSM (IM i) 
    (state_destructor i) 
    (state_size i)</span></span></span><br><span><var>Free</var><span><span class="hyp-body"><b>:= </b><span>free_composite_vlsm IM</span></span><span class="hyp-type"><b>: </b><span>VLSM message</span></span></span></span><br><span><var>RFree</var><span><span class="hyp-body"><b>:= </b><span>pre_loaded_with_all_messages_vlsm Free</span></span><span class="hyp-type"><b>: </b><span>VLSM message</span></span></span></span><br><span><var>choose</var><span class="hyp-type"><b>: </b><span>choice_function</span></span></span><br><span><var>Hchoose</var><span class="hyp-type"><b>: </b><span>choosing_well choose</span></span></span><br><span><var>s</var><span class="hyp-type"><b>: </b><span>composite_state IM</span></span></span><br><span><var>Hs</var><span class="hyp-type"><b>: </b><span>valid_state_prop RFree s</span></span></span><br><span><var>is</var><span class="hyp-type"><b>: </b><span>composite_state IM</span></span></span><br><span><var>tr</var><span class="hyp-type"><b>: </b><span>list (composite_transition_item IM)</span></span></span><br><span><var>Heqis_tr</var><span class="hyp-type"><b>: </b><span>composite_state_to_trace choose s Hs =
(<span class="kr">is</span>, tr)</span></span></span><br><span><var>Hnodup</var><span class="hyp-type"><b>: </b><span>NoDup (enum index)</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">finite_valid_trace_init_to RFree <span class="kr">is</span> s tr</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="TraceableVLSM-v-chk102" style="display: none" type="checkbox"><label class="alectryon-input" for="TraceableVLSM-v-chk102"><span class="nb">assert</span> (Hinitial : not_in_indices_initial_prop s (enum index))
    <span class="bp">by</span> (<span class="nb">intros</span> j Hj; <span class="bp">contradict</span> Hj; <span class="nb">apply</span> elem_of_enum).</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>message, index</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>EqDecision0</var><span class="hyp-type"><b>: </b><span>EqDecision index</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>finite.Finite index</span></span></span><br><span><var>IM</var><span class="hyp-type"><b>: </b><span>index ‚Üí VLSM message</span></span></span><br><span><var>state_destructor</var><span class="hyp-type"><b>: </b><span><span class="kr">‚àÄ</span> <span class="nv">i</span> : index,
  vstate (IM i)
  ‚Üí list
      (vtransition_item (IM i) *
       vstate (IM i))</span></span></span><br><span><var>state_size</var><span class="hyp-type"><b>: </b><span><span class="kr">‚àÄ</span> <span class="nv">i</span> : index, vstate (IM i) ‚Üí nat</span></span></span><br><span><var>H0</var><span class="hyp-type"><b>: </b><span><span class="kr">‚àÄ</span> <span class="nv">i</span> : index,
  TraceableVLSM (IM i) 
    (state_destructor i) 
    (state_size i)</span></span></span><br><span><var>Free</var><span><span class="hyp-body"><b>:= </b><span>free_composite_vlsm IM</span></span><span class="hyp-type"><b>: </b><span>VLSM message</span></span></span></span><br><span><var>RFree</var><span><span class="hyp-body"><b>:= </b><span>pre_loaded_with_all_messages_vlsm Free</span></span><span class="hyp-type"><b>: </b><span>VLSM message</span></span></span></span><br><span><var>choose</var><span class="hyp-type"><b>: </b><span>choice_function</span></span></span><br><span><var>Hchoose</var><span class="hyp-type"><b>: </b><span>choosing_well choose</span></span></span><br><span><var>s</var><span class="hyp-type"><b>: </b><span>composite_state IM</span></span></span><br><span><var>Hs</var><span class="hyp-type"><b>: </b><span>valid_state_prop RFree s</span></span></span><br><span><var>is</var><span class="hyp-type"><b>: </b><span>composite_state IM</span></span></span><br><span><var>tr</var><span class="hyp-type"><b>: </b><span>list (composite_transition_item IM)</span></span></span><br><span><var>Heqis_tr</var><span class="hyp-type"><b>: </b><span>composite_state_to_trace choose s Hs =
(<span class="kr">is</span>, tr)</span></span></span><br><span><var>Hnodup</var><span class="hyp-type"><b>: </b><span>NoDup (enum index)</span></span></span><br><span><var>Hinitial</var><span class="hyp-type"><b>: </b><span>not_in_indices_initial_prop s (enum index)</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">finite_valid_trace_init_to RFree <span class="kr">is</span> s tr</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="TraceableVLSM-v-chk103" style="display: none" type="checkbox"><label class="alectryon-input" for="TraceableVLSM-v-chk103"><span class="nb">split</span>.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>message, index</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>EqDecision0</var><span class="hyp-type"><b>: </b><span>EqDecision index</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>finite.Finite index</span></span></span><br><span><var>IM</var><span class="hyp-type"><b>: </b><span>index ‚Üí VLSM message</span></span></span><br><span><var>state_destructor</var><span class="hyp-type"><b>: </b><span><span class="kr">‚àÄ</span> <span class="nv">i</span> : index,
  vstate (IM i)
  ‚Üí list
      (vtransition_item (IM i) *
       vstate (IM i))</span></span></span><br><span><var>state_size</var><span class="hyp-type"><b>: </b><span><span class="kr">‚àÄ</span> <span class="nv">i</span> : index, vstate (IM i) ‚Üí nat</span></span></span><br><span><var>H0</var><span class="hyp-type"><b>: </b><span><span class="kr">‚àÄ</span> <span class="nv">i</span> : index,
  TraceableVLSM (IM i) 
    (state_destructor i) 
    (state_size i)</span></span></span><br><span><var>Free</var><span><span class="hyp-body"><b>:= </b><span>free_composite_vlsm IM</span></span><span class="hyp-type"><b>: </b><span>VLSM message</span></span></span></span><br><span><var>RFree</var><span><span class="hyp-body"><b>:= </b><span>pre_loaded_with_all_messages_vlsm Free</span></span><span class="hyp-type"><b>: </b><span>VLSM message</span></span></span></span><br><span><var>choose</var><span class="hyp-type"><b>: </b><span>choice_function</span></span></span><br><span><var>Hchoose</var><span class="hyp-type"><b>: </b><span>choosing_well choose</span></span></span><br><span><var>s</var><span class="hyp-type"><b>: </b><span>composite_state IM</span></span></span><br><span><var>Hs</var><span class="hyp-type"><b>: </b><span>valid_state_prop RFree s</span></span></span><br><span><var>is</var><span class="hyp-type"><b>: </b><span>composite_state IM</span></span></span><br><span><var>tr</var><span class="hyp-type"><b>: </b><span>list (composite_transition_item IM)</span></span></span><br><span><var>Heqis_tr</var><span class="hyp-type"><b>: </b><span>composite_state_to_trace choose s Hs =
(<span class="kr">is</span>, tr)</span></span></span><br><span><var>Hnodup</var><span class="hyp-type"><b>: </b><span>NoDup (enum index)</span></span></span><br><span><var>Hinitial</var><span class="hyp-type"><b>: </b><span>not_in_indices_initial_prop s (enum index)</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">finite_valid_trace_from_to RFree <span class="kr">is</span> s tr</div></blockquote><div class="alectryon-extra-goals"><input class="alectryon-extra-goal-toggle" id="TraceableVLSM-v-chk104" style="display: none" type="checkbox"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>message, index</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>EqDecision0</var><span class="hyp-type"><b>: </b><span>EqDecision index</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>finite.Finite index</span></span></span><br><span><var>IM</var><span class="hyp-type"><b>: </b><span>index ‚Üí VLSM message</span></span></span><br><span><var>state_destructor</var><span class="hyp-type"><b>: </b><span><span class="kr">‚àÄ</span> <span class="nv">i</span> : index,
  vstate (IM i)
  ‚Üí list
      (vtransition_item (IM i) *
       vstate (IM i))</span></span></span><br><span><var>state_size</var><span class="hyp-type"><b>: </b><span><span class="kr">‚àÄ</span> <span class="nv">i</span> : index, vstate (IM i) ‚Üí nat</span></span></span><br><span><var>H0</var><span class="hyp-type"><b>: </b><span><span class="kr">‚àÄ</span> <span class="nv">i</span> : index,
  TraceableVLSM (IM i) 
    (state_destructor i) 
    (state_size i)</span></span></span><br><span><var>Free</var><span><span class="hyp-body"><b>:= </b><span>free_composite_vlsm IM</span></span><span class="hyp-type"><b>: </b><span>VLSM message</span></span></span></span><br><span><var>RFree</var><span><span class="hyp-body"><b>:= </b><span>pre_loaded_with_all_messages_vlsm Free</span></span><span class="hyp-type"><b>: </b><span>VLSM message</span></span></span></span><br><span><var>choose</var><span class="hyp-type"><b>: </b><span>choice_function</span></span></span><br><span><var>Hchoose</var><span class="hyp-type"><b>: </b><span>choosing_well choose</span></span></span><br><span><var>s</var><span class="hyp-type"><b>: </b><span>composite_state IM</span></span></span><br><span><var>Hs</var><span class="hyp-type"><b>: </b><span>valid_state_prop RFree s</span></span></span><br><span><var>is</var><span class="hyp-type"><b>: </b><span>composite_state IM</span></span></span><br><span><var>tr</var><span class="hyp-type"><b>: </b><span>list (composite_transition_item IM)</span></span></span><br><span><var>Heqis_tr</var><span class="hyp-type"><b>: </b><span>composite_state_to_trace choose s Hs =
(<span class="kr">is</span>, tr)</span></span></span><br><span><var>Hnodup</var><span class="hyp-type"><b>: </b><span>NoDup (enum index)</span></span></span><br><span><var>Hinitial</var><span class="hyp-type"><b>: </b><span>not_in_indices_initial_prop s (enum index)</span></span></span><br></div><label class="goal-separator" for="TraceableVLSM-v-chk104"><hr></label><div class="goal-conclusion">initial_state_prop <span class="kr">is</span></div></blockquote></div></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="TraceableVLSM-v-chk105" style="display: none" type="checkbox"><label class="alectryon-input" for="TraceableVLSM-v-chk105">-</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>message, index</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>EqDecision0</var><span class="hyp-type"><b>: </b><span>EqDecision index</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>finite.Finite index</span></span></span><br><span><var>IM</var><span class="hyp-type"><b>: </b><span>index ‚Üí VLSM message</span></span></span><br><span><var>state_destructor</var><span class="hyp-type"><b>: </b><span><span class="kr">‚àÄ</span> <span class="nv">i</span> : index,
  vstate (IM i)
  ‚Üí list
      (vtransition_item (IM i) *
       vstate (IM i))</span></span></span><br><span><var>state_size</var><span class="hyp-type"><b>: </b><span><span class="kr">‚àÄ</span> <span class="nv">i</span> : index, vstate (IM i) ‚Üí nat</span></span></span><br><span><var>H0</var><span class="hyp-type"><b>: </b><span><span class="kr">‚àÄ</span> <span class="nv">i</span> : index,
  TraceableVLSM (IM i) 
    (state_destructor i) 
    (state_size i)</span></span></span><br><span><var>Free</var><span><span class="hyp-body"><b>:= </b><span>free_composite_vlsm IM</span></span><span class="hyp-type"><b>: </b><span>VLSM message</span></span></span></span><br><span><var>RFree</var><span><span class="hyp-body"><b>:= </b><span>pre_loaded_with_all_messages_vlsm Free</span></span><span class="hyp-type"><b>: </b><span>VLSM message</span></span></span></span><br><span><var>choose</var><span class="hyp-type"><b>: </b><span>choice_function</span></span></span><br><span><var>Hchoose</var><span class="hyp-type"><b>: </b><span>choosing_well choose</span></span></span><br><span><var>s</var><span class="hyp-type"><b>: </b><span>composite_state IM</span></span></span><br><span><var>Hs</var><span class="hyp-type"><b>: </b><span>valid_state_prop RFree s</span></span></span><br><span><var>is</var><span class="hyp-type"><b>: </b><span>composite_state IM</span></span></span><br><span><var>tr</var><span class="hyp-type"><b>: </b><span>list (composite_transition_item IM)</span></span></span><br><span><var>Heqis_tr</var><span class="hyp-type"><b>: </b><span>composite_state_to_trace choose s Hs =
(<span class="kr">is</span>, tr)</span></span></span><br><span><var>Hnodup</var><span class="hyp-type"><b>: </b><span>NoDup (enum index)</span></span></span><br><span><var>Hinitial</var><span class="hyp-type"><b>: </b><span>not_in_indices_initial_prop s (enum index)</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">finite_valid_trace_from_to RFree <span class="kr">is</span> s tr</div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="bp">by</span> <span class="nb">eapply</span> indexed_reachable_composite_state_to_trace.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="TraceableVLSM-v-chk106" style="display: none" type="checkbox"><label class="alectryon-input" for="TraceableVLSM-v-chk106">-</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>message, index</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>EqDecision0</var><span class="hyp-type"><b>: </b><span>EqDecision index</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>finite.Finite index</span></span></span><br><span><var>IM</var><span class="hyp-type"><b>: </b><span>index ‚Üí VLSM message</span></span></span><br><span><var>state_destructor</var><span class="hyp-type"><b>: </b><span><span class="kr">‚àÄ</span> <span class="nv">i</span> : index,
  vstate (IM i)
  ‚Üí list
      (vtransition_item (IM i) *
       vstate (IM i))</span></span></span><br><span><var>state_size</var><span class="hyp-type"><b>: </b><span><span class="kr">‚àÄ</span> <span class="nv">i</span> : index, vstate (IM i) ‚Üí nat</span></span></span><br><span><var>H0</var><span class="hyp-type"><b>: </b><span><span class="kr">‚àÄ</span> <span class="nv">i</span> : index,
  TraceableVLSM (IM i) 
    (state_destructor i) 
    (state_size i)</span></span></span><br><span><var>Free</var><span><span class="hyp-body"><b>:= </b><span>free_composite_vlsm IM</span></span><span class="hyp-type"><b>: </b><span>VLSM message</span></span></span></span><br><span><var>RFree</var><span><span class="hyp-body"><b>:= </b><span>pre_loaded_with_all_messages_vlsm Free</span></span><span class="hyp-type"><b>: </b><span>VLSM message</span></span></span></span><br><span><var>choose</var><span class="hyp-type"><b>: </b><span>choice_function</span></span></span><br><span><var>Hchoose</var><span class="hyp-type"><b>: </b><span>choosing_well choose</span></span></span><br><span><var>s</var><span class="hyp-type"><b>: </b><span>composite_state IM</span></span></span><br><span><var>Hs</var><span class="hyp-type"><b>: </b><span>valid_state_prop RFree s</span></span></span><br><span><var>is</var><span class="hyp-type"><b>: </b><span>composite_state IM</span></span></span><br><span><var>tr</var><span class="hyp-type"><b>: </b><span>list (composite_transition_item IM)</span></span></span><br><span><var>Heqis_tr</var><span class="hyp-type"><b>: </b><span>composite_state_to_trace choose s Hs =
(<span class="kr">is</span>, tr)</span></span></span><br><span><var>Hnodup</var><span class="hyp-type"><b>: </b><span>NoDup (enum index)</span></span></span><br><span><var>Hinitial</var><span class="hyp-type"><b>: </b><span>not_in_indices_initial_prop s (enum index)</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">initial_state_prop <span class="kr">is</span></div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="bp">by</span> <span class="nb">eapply</span> indexed_composite_state_to_trace_result_state_is_initial.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Qed</span>.</span></span></pre><div class="doc">
  The property of a <span class="inlinecode"><span class="id" title="var">choice_function</span></span> with respect to a predicate on composite
  states which states that for any chosen transition, if the predicate holds for
  the source of the transition then it must also hold for its taget.

<div class="paragraph"> </div>

  See <span class="inlinecode"><span class="id" title="var">MinimalEquivocationTrace.minimal_equivocation_choice_monotone</span></span> for an
  example of such a function.

</div><pre class="alectryon-io highlight"><!-- Generator: Alectryon --><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Definition</span> <span class="nf">chosen_transition_preserves_P</span>
  (<span class="nv">P</span> : composite_state IM -&gt; <span class="kt">Prop</span>) (<span class="nv">choose</span> : choice_function) : <span class="kt">Prop</span> :=
  <span class="kr">forall</span> (<span class="nv">is</span> : list index), NoDup <span class="kr">is</span> -&gt;
  <span class="kr">forall</span> (<span class="nv">s&#39;</span> : composite_state IM) (<span class="nv">Hs&#39;</span> : valid_state_prop RFree s&#39;),
    not_in_indices_initial_prop s&#39; <span class="kr">is</span> -&gt;
    <span class="kr">forall</span> (<span class="nv">i</span> : index) (<span class="nv">Hi</span> : i ‚àà <span class="kr">is</span>) (<span class="nv">n</span> : nat),
      choose s&#39; Hs&#39; <span class="kr">is</span>  = (i, n) -&gt;
      <span class="kr">forall</span> (<span class="nv">s</span> : composite_state IM) (<span class="nv">item</span> : composite_transition_item IM),
        composite_state_destructor s&#39; i !! n = Some (item, s) -&gt;
        P s -&gt; P s&#39;.</span></span></pre><div class="doc">
  If a <span class="inlinecode"><span class="id" title="var">choice_function</span></span> is choosing well and satisfying
  <span class="inlinecode"><span class="id" title="var">chosen_transition_preserves_P</span></span> w.r.t. a predicate <code>P</code> then the corresponding
  trace obtained through <span class="inlinecode"><span class="id" title="var">composite_state_to_trace</span></span> will also preserve <code>P</code>
  at every step.

<div class="paragraph"> </div>

  See <span class="inlinecode"><span class="id" title="var">MinimalEquivocationTrace.state_to_minimal_equivocation_trace_equivocation_monotonic</span></span>
  for an example of such a function.

</div><pre class="alectryon-io highlight"><!-- Generator: Alectryon --><span class="alectryon-sentence"><input class="alectryon-toggle" id="TraceableVLSM-v-chk107" style="display: none" type="checkbox"><label class="alectryon-input" for="TraceableVLSM-v-chk107"><span class="kn">Lemma</span> <span class="nf">composite_state_to_trace_P_monotonic</span> :
  <span class="kr">forall</span> (<span class="nv">P</span> : composite_state IM -&gt; <span class="kt">Prop</span>),
  <span class="kr">forall</span> (<span class="nv">choose</span> : choice_function), choosing_well choose -&gt;
    chosen_transition_preserves_P P choose -&gt;
  <span class="kr">forall</span> (<span class="nv">s</span> : composite_state IM) (<span class="nv">Hs</span> : valid_state_prop RFree s),
  <span class="kr">forall</span> <span class="nv">is</span> <span class="nv">tr</span>, composite_state_to_trace choose s Hs = (<span class="kr">is</span>, tr) -&gt;
  <span class="kr">forall</span> (<span class="nv">pre</span> <span class="nv">suf</span> : list (composite_transition_item IM))
    (<span class="nv">item</span> : composite_transition_item IM),
    tr = pre ++ [item] ++ suf -&gt;
    P (finite_trace_last <span class="kr">is</span> pre)-&gt; P (destination item).</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>message, index</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>EqDecision0</var><span class="hyp-type"><b>: </b><span>EqDecision index</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>finite.Finite index</span></span></span><br><span><var>IM</var><span class="hyp-type"><b>: </b><span>index ‚Üí VLSM message</span></span></span><br><span><var>state_destructor</var><span class="hyp-type"><b>: </b><span><span class="kr">‚àÄ</span> <span class="nv">i</span> : index,
  vstate (IM i)
  ‚Üí list
      (vtransition_item (IM i) *
       vstate (IM i))</span></span></span><br><span><var>state_size</var><span class="hyp-type"><b>: </b><span><span class="kr">‚àÄ</span> <span class="nv">i</span> : index, vstate (IM i) ‚Üí nat</span></span></span><br><span><var>H0</var><span class="hyp-type"><b>: </b><span><span class="kr">‚àÄ</span> <span class="nv">i</span> : index,
  TraceableVLSM (IM i) 
    (state_destructor i) 
    (state_size i)</span></span></span><br><span><var>Free</var><span><span class="hyp-body"><b>:= </b><span>free_composite_vlsm IM</span></span><span class="hyp-type"><b>: </b><span>VLSM message</span></span></span></span><br><span><var>RFree</var><span><span class="hyp-body"><b>:= </b><span>pre_loaded_with_all_messages_vlsm Free</span></span><span class="hyp-type"><b>: </b><span>VLSM message</span></span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="kr">‚àÄ</span> (<span class="nv">P</span> : composite_state IM ‚Üí <span class="kt">Prop</span>) (<span class="nv">choose</span> : choice_function),
  choosing_well choose
  ‚Üí chosen_transition_preserves_P P choose
    ‚Üí <span class="kr">‚àÄ</span> (<span class="nv">s</span> : composite_state IM) (<span class="nv">Hs</span> : valid_state_prop
                                         RFree s) 
        (<span class="nv">is</span> : composite_state IM) (<span class="nv">tr</span> : list
                                          (composite_transition_item
                                             IM)),
        composite_state_to_trace choose s Hs =
        (<span class="kr">is</span>, tr)
        ‚Üí <span class="kr">‚àÄ</span> (<span class="nv">pre</span>
             <span class="nv">suf</span> : list (composite_transition_item IM)) 
            (<span class="nv">item</span> : composite_transition_item IM),
            tr = pre ++ [item] ++ suf
            ‚Üí P (finite_trace_last <span class="kr">is</span> pre)
              ‚Üí P (destination item)</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="TraceableVLSM-v-chk108" style="display: none" type="checkbox"><label class="alectryon-input" for="TraceableVLSM-v-chk108"><span class="kn">Proof</span>.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>message, index</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>EqDecision0</var><span class="hyp-type"><b>: </b><span>EqDecision index</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>finite.Finite index</span></span></span><br><span><var>IM</var><span class="hyp-type"><b>: </b><span>index ‚Üí VLSM message</span></span></span><br><span><var>state_destructor</var><span class="hyp-type"><b>: </b><span><span class="kr">‚àÄ</span> <span class="nv">i</span> : index,
  vstate (IM i)
  ‚Üí list
      (vtransition_item (IM i) *
       vstate (IM i))</span></span></span><br><span><var>state_size</var><span class="hyp-type"><b>: </b><span><span class="kr">‚àÄ</span> <span class="nv">i</span> : index, vstate (IM i) ‚Üí nat</span></span></span><br><span><var>H0</var><span class="hyp-type"><b>: </b><span><span class="kr">‚àÄ</span> <span class="nv">i</span> : index,
  TraceableVLSM (IM i) 
    (state_destructor i) 
    (state_size i)</span></span></span><br><span><var>Free</var><span><span class="hyp-body"><b>:= </b><span>free_composite_vlsm IM</span></span><span class="hyp-type"><b>: </b><span>VLSM message</span></span></span></span><br><span><var>RFree</var><span><span class="hyp-body"><b>:= </b><span>pre_loaded_with_all_messages_vlsm Free</span></span><span class="hyp-type"><b>: </b><span>VLSM message</span></span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="kr">‚àÄ</span> (<span class="nv">P</span> : composite_state IM ‚Üí <span class="kt">Prop</span>) (<span class="nv">choose</span> : choice_function),
  choosing_well choose
  ‚Üí chosen_transition_preserves_P P choose
    ‚Üí <span class="kr">‚àÄ</span> (<span class="nv">s</span> : composite_state IM) (<span class="nv">Hs</span> : valid_state_prop
                                         RFree s) 
        (<span class="nv">is</span> : composite_state IM) (<span class="nv">tr</span> : list
                                          (composite_transition_item
                                             IM)),
        composite_state_to_trace choose s Hs =
        (<span class="kr">is</span>, tr)
        ‚Üí <span class="kr">‚àÄ</span> (<span class="nv">pre</span>
             <span class="nv">suf</span> : list (composite_transition_item IM)) 
            (<span class="nv">item</span> : composite_transition_item IM),
            tr = pre ++ [item] ++ suf
            ‚Üí P (finite_trace_last <span class="kr">is</span> pre)
              ‚Üí P (destination item)</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="TraceableVLSM-v-chk109" style="display: none" type="checkbox"><label class="alectryon-input" for="TraceableVLSM-v-chk109"><span class="nb">unfold</span> composite_state_to_trace.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>message, index</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>EqDecision0</var><span class="hyp-type"><b>: </b><span>EqDecision index</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>finite.Finite index</span></span></span><br><span><var>IM</var><span class="hyp-type"><b>: </b><span>index ‚Üí VLSM message</span></span></span><br><span><var>state_destructor</var><span class="hyp-type"><b>: </b><span><span class="kr">‚àÄ</span> <span class="nv">i</span> : index,
  vstate (IM i)
  ‚Üí list
      (vtransition_item (IM i) *
       vstate (IM i))</span></span></span><br><span><var>state_size</var><span class="hyp-type"><b>: </b><span><span class="kr">‚àÄ</span> <span class="nv">i</span> : index, vstate (IM i) ‚Üí nat</span></span></span><br><span><var>H0</var><span class="hyp-type"><b>: </b><span><span class="kr">‚àÄ</span> <span class="nv">i</span> : index,
  TraceableVLSM (IM i) 
    (state_destructor i) 
    (state_size i)</span></span></span><br><span><var>Free</var><span><span class="hyp-body"><b>:= </b><span>free_composite_vlsm IM</span></span><span class="hyp-type"><b>: </b><span>VLSM message</span></span></span></span><br><span><var>RFree</var><span><span class="hyp-body"><b>:= </b><span>pre_loaded_with_all_messages_vlsm Free</span></span><span class="hyp-type"><b>: </b><span>VLSM message</span></span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="kr">‚àÄ</span> (<span class="nv">P</span> : composite_state IM ‚Üí <span class="kt">Prop</span>) (<span class="nv">choose</span> : choice_function),
  choosing_well choose
  ‚Üí chosen_transition_preserves_P P choose
    ‚Üí <span class="kr">‚àÄ</span> (<span class="nv">s</span> : composite_state IM) (<span class="nv">Hs</span> : valid_state_prop
                                         RFree s) 
        (<span class="nv">is</span> : composite_state IM) (<span class="nv">tr</span> : list
                                          (composite_transition_item
                                             IM)),
        indexed_composite_state_to_trace choose s Hs
          (enum index) = (<span class="kr">is</span>, tr)
        ‚Üí <span class="kr">‚àÄ</span> (<span class="nv">pre</span>
             <span class="nv">suf</span> : list (composite_transition_item IM)) 
            (<span class="nv">item</span> : composite_transition_item IM),
            tr = pre ++ [item] ++ suf
            ‚Üí P (finite_trace_last <span class="kr">is</span> pre)
              ‚Üí P (destination item)</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="TraceableVLSM-v-chk10a" style="display: none" type="checkbox"><label class="alectryon-input" for="TraceableVLSM-v-chk10a"><span class="nb">intros</span> P choose Hwell HchooseP s&#39; Hs&#39; <span class="kr">is</span> tr Heqis_tr pre suf item Heqtr Heqv.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>message, index</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>EqDecision0</var><span class="hyp-type"><b>: </b><span>EqDecision index</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>finite.Finite index</span></span></span><br><span><var>IM</var><span class="hyp-type"><b>: </b><span>index ‚Üí VLSM message</span></span></span><br><span><var>state_destructor</var><span class="hyp-type"><b>: </b><span><span class="kr">‚àÄ</span> <span class="nv">i</span> : index,
  vstate (IM i)
  ‚Üí list
      (vtransition_item (IM i) *
       vstate (IM i))</span></span></span><br><span><var>state_size</var><span class="hyp-type"><b>: </b><span><span class="kr">‚àÄ</span> <span class="nv">i</span> : index, vstate (IM i) ‚Üí nat</span></span></span><br><span><var>H0</var><span class="hyp-type"><b>: </b><span><span class="kr">‚àÄ</span> <span class="nv">i</span> : index,
  TraceableVLSM (IM i) 
    (state_destructor i) 
    (state_size i)</span></span></span><br><span><var>Free</var><span><span class="hyp-body"><b>:= </b><span>free_composite_vlsm IM</span></span><span class="hyp-type"><b>: </b><span>VLSM message</span></span></span></span><br><span><var>RFree</var><span><span class="hyp-body"><b>:= </b><span>pre_loaded_with_all_messages_vlsm Free</span></span><span class="hyp-type"><b>: </b><span>VLSM message</span></span></span></span><br><span><var>P</var><span class="hyp-type"><b>: </b><span>composite_state IM ‚Üí <span class="kt">Prop</span></span></span></span><br><span><var>choose</var><span class="hyp-type"><b>: </b><span>choice_function</span></span></span><br><span><var>Hwell</var><span class="hyp-type"><b>: </b><span>choosing_well choose</span></span></span><br><span><var>HchooseP</var><span class="hyp-type"><b>: </b><span>chosen_transition_preserves_P P choose</span></span></span><br><span><var>s'</var><span class="hyp-type"><b>: </b><span>composite_state IM</span></span></span><br><span><var>Hs'</var><span class="hyp-type"><b>: </b><span>valid_state_prop RFree s&#39;</span></span></span><br><span><var>is</var><span class="hyp-type"><b>: </b><span>composite_state IM</span></span></span><br><span><var>tr</var><span class="hyp-type"><b>: </b><span>list (composite_transition_item IM)</span></span></span><br><span><var>Heqis_tr</var><span class="hyp-type"><b>: </b><span>indexed_composite_state_to_trace choose s&#39;
  Hs&#39; (enum index) = (<span class="kr">is</span>, tr)</span></span></span><br><span><var>pre, suf</var><span class="hyp-type"><b>: </b><span>list (composite_transition_item IM)</span></span></span><br><span><var>item</var><span class="hyp-type"><b>: </b><span>composite_transition_item IM</span></span></span><br><span><var>Heqtr</var><span class="hyp-type"><b>: </b><span>tr = pre ++ [item] ++ suf</span></span></span><br><span><var>Heqv</var><span class="hyp-type"><b>: </b><span>P (finite_trace_last <span class="kr">is</span> pre)</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">P (destination item)</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="TraceableVLSM-v-chk10b" style="display: none" type="checkbox"><label class="alectryon-input" for="TraceableVLSM-v-chk10b"><span class="nb">revert</span> <span class="kr">is</span> tr Heqis_tr pre suf item Heqtr Heqv.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>message, index</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>EqDecision0</var><span class="hyp-type"><b>: </b><span>EqDecision index</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>finite.Finite index</span></span></span><br><span><var>IM</var><span class="hyp-type"><b>: </b><span>index ‚Üí VLSM message</span></span></span><br><span><var>state_destructor</var><span class="hyp-type"><b>: </b><span><span class="kr">‚àÄ</span> <span class="nv">i</span> : index,
  vstate (IM i)
  ‚Üí list
      (vtransition_item (IM i) *
       vstate (IM i))</span></span></span><br><span><var>state_size</var><span class="hyp-type"><b>: </b><span><span class="kr">‚àÄ</span> <span class="nv">i</span> : index, vstate (IM i) ‚Üí nat</span></span></span><br><span><var>H0</var><span class="hyp-type"><b>: </b><span><span class="kr">‚àÄ</span> <span class="nv">i</span> : index,
  TraceableVLSM (IM i) 
    (state_destructor i) 
    (state_size i)</span></span></span><br><span><var>Free</var><span><span class="hyp-body"><b>:= </b><span>free_composite_vlsm IM</span></span><span class="hyp-type"><b>: </b><span>VLSM message</span></span></span></span><br><span><var>RFree</var><span><span class="hyp-body"><b>:= </b><span>pre_loaded_with_all_messages_vlsm Free</span></span><span class="hyp-type"><b>: </b><span>VLSM message</span></span></span></span><br><span><var>P</var><span class="hyp-type"><b>: </b><span>composite_state IM ‚Üí <span class="kt">Prop</span></span></span></span><br><span><var>choose</var><span class="hyp-type"><b>: </b><span>choice_function</span></span></span><br><span><var>Hwell</var><span class="hyp-type"><b>: </b><span>choosing_well choose</span></span></span><br><span><var>HchooseP</var><span class="hyp-type"><b>: </b><span>chosen_transition_preserves_P P choose</span></span></span><br><span><var>s'</var><span class="hyp-type"><b>: </b><span>composite_state IM</span></span></span><br><span><var>Hs'</var><span class="hyp-type"><b>: </b><span>valid_state_prop RFree s&#39;</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="kr">‚àÄ</span> (<span class="nv">is</span> : composite_state IM) (<span class="nv">tr</span> : list
                                    (composite_transition_item
                                       IM)),
  indexed_composite_state_to_trace choose s&#39; Hs&#39;
    (enum index) = (<span class="kr">is</span>, tr)
  ‚Üí <span class="kr">‚àÄ</span> (<span class="nv">pre</span> <span class="nv">suf</span> : list (composite_transition_item IM)) 
      (<span class="nv">item</span> : composite_transition_item IM),
      tr = pre ++ [item] ++ suf
      ‚Üí P (finite_trace_last <span class="kr">is</span> pre)
        ‚Üí P (destination item)</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="TraceableVLSM-v-chk10c" style="display: none" type="checkbox"><label class="alectryon-input" for="TraceableVLSM-v-chk10c"><span class="nb">generalize</span> (NoDup_enum index) <span class="kr">as</span> Hnodup.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>message, index</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>EqDecision0</var><span class="hyp-type"><b>: </b><span>EqDecision index</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>finite.Finite index</span></span></span><br><span><var>IM</var><span class="hyp-type"><b>: </b><span>index ‚Üí VLSM message</span></span></span><br><span><var>state_destructor</var><span class="hyp-type"><b>: </b><span><span class="kr">‚àÄ</span> <span class="nv">i</span> : index,
  vstate (IM i)
  ‚Üí list
      (vtransition_item (IM i) *
       vstate (IM i))</span></span></span><br><span><var>state_size</var><span class="hyp-type"><b>: </b><span><span class="kr">‚àÄ</span> <span class="nv">i</span> : index, vstate (IM i) ‚Üí nat</span></span></span><br><span><var>H0</var><span class="hyp-type"><b>: </b><span><span class="kr">‚àÄ</span> <span class="nv">i</span> : index,
  TraceableVLSM (IM i) 
    (state_destructor i) 
    (state_size i)</span></span></span><br><span><var>Free</var><span><span class="hyp-body"><b>:= </b><span>free_composite_vlsm IM</span></span><span class="hyp-type"><b>: </b><span>VLSM message</span></span></span></span><br><span><var>RFree</var><span><span class="hyp-body"><b>:= </b><span>pre_loaded_with_all_messages_vlsm Free</span></span><span class="hyp-type"><b>: </b><span>VLSM message</span></span></span></span><br><span><var>P</var><span class="hyp-type"><b>: </b><span>composite_state IM ‚Üí <span class="kt">Prop</span></span></span></span><br><span><var>choose</var><span class="hyp-type"><b>: </b><span>choice_function</span></span></span><br><span><var>Hwell</var><span class="hyp-type"><b>: </b><span>choosing_well choose</span></span></span><br><span><var>HchooseP</var><span class="hyp-type"><b>: </b><span>chosen_transition_preserves_P P choose</span></span></span><br><span><var>s'</var><span class="hyp-type"><b>: </b><span>composite_state IM</span></span></span><br><span><var>Hs'</var><span class="hyp-type"><b>: </b><span>valid_state_prop RFree s&#39;</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">NoDup (enum index)
‚Üí <span class="kr">‚àÄ</span> (<span class="nv">is</span> : composite_state IM) (<span class="nv">tr</span> : list
                                      (composite_transition_item
                                         IM)),
    indexed_composite_state_to_trace choose s&#39; Hs&#39;
      (enum index) = (<span class="kr">is</span>, tr)
    ‚Üí <span class="kr">‚àÄ</span> (<span class="nv">pre</span>
         <span class="nv">suf</span> : list (composite_transition_item IM)) 
        (<span class="nv">item</span> : composite_transition_item IM),
        tr = pre ++ [item] ++ suf
        ‚Üí P (finite_trace_last <span class="kr">is</span> pre)
          ‚Üí P (destination item)</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="TraceableVLSM-v-chk10d" style="display: none" type="checkbox"><label class="alectryon-input" for="TraceableVLSM-v-chk10d"><span class="nb">assert</span> (Hinitial : not_in_indices_initial_prop s&#39; (enum index))
    <span class="bp">by</span> (<span class="nb">intros</span> i contra; <span class="bp">contradict</span> contra; <span class="nb">apply</span> elem_of_enum).</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>message, index</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>EqDecision0</var><span class="hyp-type"><b>: </b><span>EqDecision index</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>finite.Finite index</span></span></span><br><span><var>IM</var><span class="hyp-type"><b>: </b><span>index ‚Üí VLSM message</span></span></span><br><span><var>state_destructor</var><span class="hyp-type"><b>: </b><span><span class="kr">‚àÄ</span> <span class="nv">i</span> : index,
  vstate (IM i)
  ‚Üí list
      (vtransition_item (IM i) *
       vstate (IM i))</span></span></span><br><span><var>state_size</var><span class="hyp-type"><b>: </b><span><span class="kr">‚àÄ</span> <span class="nv">i</span> : index, vstate (IM i) ‚Üí nat</span></span></span><br><span><var>H0</var><span class="hyp-type"><b>: </b><span><span class="kr">‚àÄ</span> <span class="nv">i</span> : index,
  TraceableVLSM (IM i) 
    (state_destructor i) 
    (state_size i)</span></span></span><br><span><var>Free</var><span><span class="hyp-body"><b>:= </b><span>free_composite_vlsm IM</span></span><span class="hyp-type"><b>: </b><span>VLSM message</span></span></span></span><br><span><var>RFree</var><span><span class="hyp-body"><b>:= </b><span>pre_loaded_with_all_messages_vlsm Free</span></span><span class="hyp-type"><b>: </b><span>VLSM message</span></span></span></span><br><span><var>P</var><span class="hyp-type"><b>: </b><span>composite_state IM ‚Üí <span class="kt">Prop</span></span></span></span><br><span><var>choose</var><span class="hyp-type"><b>: </b><span>choice_function</span></span></span><br><span><var>Hwell</var><span class="hyp-type"><b>: </b><span>choosing_well choose</span></span></span><br><span><var>HchooseP</var><span class="hyp-type"><b>: </b><span>chosen_transition_preserves_P P choose</span></span></span><br><span><var>s'</var><span class="hyp-type"><b>: </b><span>composite_state IM</span></span></span><br><span><var>Hs'</var><span class="hyp-type"><b>: </b><span>valid_state_prop RFree s&#39;</span></span></span><br><span><var>Hinitial</var><span class="hyp-type"><b>: </b><span>not_in_indices_initial_prop s&#39; (enum index)</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">NoDup (enum index)
‚Üí <span class="kr">‚àÄ</span> (<span class="nv">is</span> : composite_state IM) (<span class="nv">tr</span> : list
                                      (composite_transition_item
                                         IM)),
    indexed_composite_state_to_trace choose s&#39; Hs&#39;
      (enum index) = (<span class="kr">is</span>, tr)
    ‚Üí <span class="kr">‚àÄ</span> (<span class="nv">pre</span>
         <span class="nv">suf</span> : list (composite_transition_item IM)) 
        (<span class="nv">item</span> : composite_transition_item IM),
        tr = pre ++ [item] ++ suf
        ‚Üí P (finite_trace_last <span class="kr">is</span> pre)
          ‚Üí P (destination item)</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="TraceableVLSM-v-chk10e" style="display: none" type="checkbox"><label class="alectryon-input" for="TraceableVLSM-v-chk10e"><span class="nb">revert</span> Hinitial; <span class="nb">generalize</span> (enum index); <span class="nb">intro</span> indices; <span class="nb">revert</span> Hwell HchooseP.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>message, index</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>EqDecision0</var><span class="hyp-type"><b>: </b><span>EqDecision index</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>finite.Finite index</span></span></span><br><span><var>IM</var><span class="hyp-type"><b>: </b><span>index ‚Üí VLSM message</span></span></span><br><span><var>state_destructor</var><span class="hyp-type"><b>: </b><span><span class="kr">‚àÄ</span> <span class="nv">i</span> : index,
  vstate (IM i)
  ‚Üí list
      (vtransition_item (IM i) *
       vstate (IM i))</span></span></span><br><span><var>state_size</var><span class="hyp-type"><b>: </b><span><span class="kr">‚àÄ</span> <span class="nv">i</span> : index, vstate (IM i) ‚Üí nat</span></span></span><br><span><var>H0</var><span class="hyp-type"><b>: </b><span><span class="kr">‚àÄ</span> <span class="nv">i</span> : index,
  TraceableVLSM (IM i) 
    (state_destructor i) 
    (state_size i)</span></span></span><br><span><var>Free</var><span><span class="hyp-body"><b>:= </b><span>free_composite_vlsm IM</span></span><span class="hyp-type"><b>: </b><span>VLSM message</span></span></span></span><br><span><var>RFree</var><span><span class="hyp-body"><b>:= </b><span>pre_loaded_with_all_messages_vlsm Free</span></span><span class="hyp-type"><b>: </b><span>VLSM message</span></span></span></span><br><span><var>P</var><span class="hyp-type"><b>: </b><span>composite_state IM ‚Üí <span class="kt">Prop</span></span></span></span><br><span><var>choose</var><span class="hyp-type"><b>: </b><span>choice_function</span></span></span><br><span><var>s'</var><span class="hyp-type"><b>: </b><span>composite_state IM</span></span></span><br><span><var>Hs'</var><span class="hyp-type"><b>: </b><span>valid_state_prop RFree s&#39;</span></span></span><br><span><var>indices</var><span class="hyp-type"><b>: </b><span>list index</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">choosing_well choose
‚Üí chosen_transition_preserves_P P choose
  ‚Üí not_in_indices_initial_prop s&#39; indices
    ‚Üí NoDup indices
      ‚Üí <span class="kr">‚àÄ</span> (<span class="nv">is</span> : composite_state IM) (<span class="nv">tr</span> : list
                                            (composite_transition_item
                                               IM)),
          indexed_composite_state_to_trace choose s&#39;
            Hs&#39; indices = (<span class="kr">is</span>, tr)
          ‚Üí <span class="kr">‚àÄ</span> (<span class="nv">pre</span>
               <span class="nv">suf</span> : list
                       (composite_transition_item IM)) 
              (<span class="nv">item</span> : composite_transition_item IM),
              tr = pre ++ [item] ++ suf
              ‚Üí P (finite_trace_last <span class="kr">is</span> pre)
                ‚Üí P (destination item)</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="TraceableVLSM-v-chk10f" style="display: none" type="checkbox"><label class="alectryon-input" for="TraceableVLSM-v-chk10f">apply_funelim (indexed_composite_state_to_trace choose s&#39; Hs&#39; indices);
    <span class="nb">clear</span> choose s&#39; Hs&#39; indices;
    [<span class="bp">by</span> <span class="nb">intros</span>; <span class="nb">inversion</span> Heqis_tr; <span class="nb">subst</span>; <span class="nb">destruct</span> pre |..];
    <span class="nb">intros</span> choose s&#39; Hs&#39; idx indices (j,nj); <span class="nb">cbn</span>.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>message, index</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>EqDecision0</var><span class="hyp-type"><b>: </b><span>EqDecision index</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>finite.Finite index</span></span></span><br><span><var>IM</var><span class="hyp-type"><b>: </b><span>index ‚Üí VLSM message</span></span></span><br><span><var>state_destructor</var><span class="hyp-type"><b>: </b><span><span class="kr">‚àÄ</span> <span class="nv">i</span> : index,
  vstate (IM i)
  ‚Üí list
      (vtransition_item (IM i) *
       vstate (IM i))</span></span></span><br><span><var>state_size</var><span class="hyp-type"><b>: </b><span><span class="kr">‚àÄ</span> <span class="nv">i</span> : index, vstate (IM i) ‚Üí nat</span></span></span><br><span><var>H0</var><span class="hyp-type"><b>: </b><span><span class="kr">‚àÄ</span> <span class="nv">i</span> : index,
  TraceableVLSM (IM i) 
    (state_destructor i) 
    (state_size i)</span></span></span><br><span><var>Free</var><span><span class="hyp-body"><b>:= </b><span>free_composite_vlsm IM</span></span><span class="hyp-type"><b>: </b><span>VLSM message</span></span></span></span><br><span><var>RFree</var><span><span class="hyp-body"><b>:= </b><span>pre_loaded_with_all_messages_vlsm Free</span></span><span class="hyp-type"><b>: </b><span>VLSM message</span></span></span></span><br><span><var>P</var><span class="hyp-type"><b>: </b><span>composite_state IM ‚Üí <span class="kt">Prop</span></span></span></span><br><span><var>choose</var><span class="hyp-type"><b>: </b><span>choice_function</span></span></span><br><span><var>s'</var><span class="hyp-type"><b>: </b><span>composite_state IM</span></span></span><br><span><var>Hs'</var><span class="hyp-type"><b>: </b><span>valid_state_prop RFree s&#39;</span></span></span><br><span><var>idx</var><span class="hyp-type"><b>: </b><span>index</span></span></span><br><span><var>indices</var><span class="hyp-type"><b>: </b><span>list index</span></span></span><br><span><var>j</var><span class="hyp-type"><b>: </b><span>index</span></span></span><br><span><var>nj</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="kr">‚àÄ</span> (<span class="nv">item</span> : composite_transition_item IM) (<span class="nv">s</span> : composite_state
                                               IM) 
  (<span class="nv">Hdestruct</span> : composite_state_destructor s&#39; j !! nj =
               Some (item, s)) (<span class="nv">Hchoice</span> : choose s&#39;
                                            Hs&#39;
                                            (idx
                                             :: indices) =
                                          (j, nj)) 
  (<span class="nv">is</span> : composite_state IM) (<span class="nv">tr</span> : list
                                    (composite_transition_item
                                       IM)),
  indexed_composite_state_to_trace choose s
    (indexed_composite_state_to_trace_obligations_obligation_1
       s&#39; Hs&#39; (j, nj) item s Hdestruct)
    (idx :: indices) = (<span class="kr">is</span>, tr)
  ‚Üí (choosing_well choose
     ‚Üí chosen_transition_preserves_P P choose
       ‚Üí not_in_indices_initial_prop s
           (idx :: indices)
         ‚Üí NoDup (idx :: indices)
           ‚Üí <span class="kr">‚àÄ</span> (<span class="nv">is0</span> : composite_state IM) (<span class="nv">tr0</span> : list
                                                 (composite_transition_item
                                                 IM)),
               indexed_composite_state_to_trace choose
                 s
                 (indexed_composite_state_to_trace_obligations_obligation_1
                    s&#39; Hs&#39; (j, nj) item s Hdestruct)
                 (idx :: indices) = (is0, tr0)
               ‚Üí <span class="kr">‚àÄ</span> (<span class="nv">pre</span>
                    <span class="nv">suf</span> : list
                            (composite_transition_item
                               IM)) (<span class="nv">item0</span> : composite_transition_item
                                               IM),
                   tr0 = pre ++ item0 :: suf
                   ‚Üí P (finite_trace_last is0 pre)
                     ‚Üí P (destination item0))
    ‚Üí inspect (composite_state_destructor s&#39; j !! nj) =
      Some (item, s) ‚Üæ Hdestruct
      ‚Üí inspect (choose s&#39; Hs&#39; (idx :: indices)) =
        (j, nj) ‚Üæ Hchoice
        ‚Üí choosing_well choose
          ‚Üí chosen_transition_preserves_P P choose
            ‚Üí not_in_indices_initial_prop s&#39;
                (idx :: indices)
              ‚Üí NoDup (idx :: indices)
                ‚Üí <span class="kr">‚àÄ</span> (<span class="nv">is0</span> : composite_state IM) (<span class="nv">tr0</span> : 
                                                list
                                                 (composite_transition_item
                                                 IM)),
                    (<span class="kr">is</span>, tr ++ [item]) = (is0, tr0)
                    ‚Üí <span class="kr">‚àÄ</span> (<span class="nv">pre</span>
                         <span class="nv">suf</span> : list
                                 (composite_transition_item
                                    IM)) (<span class="nv">item0</span> : 
                                          composite_transition_item
                                            IM),
                        tr0 = pre ++ item0 :: suf
                        ‚Üí P
                            (finite_trace_last is0 pre)
                          ‚Üí P (destination item0)</div></blockquote><div class="alectryon-extra-goals"><input class="alectryon-extra-goal-toggle" id="TraceableVLSM-v-chk110" style="display: none" type="checkbox"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>message, index</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>EqDecision0</var><span class="hyp-type"><b>: </b><span>EqDecision index</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>finite.Finite index</span></span></span><br><span><var>IM</var><span class="hyp-type"><b>: </b><span>index ‚Üí VLSM message</span></span></span><br><span><var>state_destructor</var><span class="hyp-type"><b>: </b><span><span class="kr">‚àÄ</span> <span class="nv">i</span> : index,
  vstate (IM i)
  ‚Üí list
      (vtransition_item (IM i) *
       vstate (IM i))</span></span></span><br><span><var>state_size</var><span class="hyp-type"><b>: </b><span><span class="kr">‚àÄ</span> <span class="nv">i</span> : index, vstate (IM i) ‚Üí nat</span></span></span><br><span><var>H0</var><span class="hyp-type"><b>: </b><span><span class="kr">‚àÄ</span> <span class="nv">i</span> : index,
  TraceableVLSM (IM i) 
    (state_destructor i) 
    (state_size i)</span></span></span><br><span><var>Free</var><span><span class="hyp-body"><b>:= </b><span>free_composite_vlsm IM</span></span><span class="hyp-type"><b>: </b><span>VLSM message</span></span></span></span><br><span><var>RFree</var><span><span class="hyp-body"><b>:= </b><span>pre_loaded_with_all_messages_vlsm Free</span></span><span class="hyp-type"><b>: </b><span>VLSM message</span></span></span></span><br><span><var>P</var><span class="hyp-type"><b>: </b><span>composite_state IM ‚Üí <span class="kt">Prop</span></span></span></span><br><span><var>choose</var><span class="hyp-type"><b>: </b><span>choice_function</span></span></span><br><span><var>s'</var><span class="hyp-type"><b>: </b><span>composite_state IM</span></span></span><br><span><var>Hs'</var><span class="hyp-type"><b>: </b><span>valid_state_prop RFree s&#39;</span></span></span><br><span><var>idx</var><span class="hyp-type"><b>: </b><span>index</span></span></span><br><span><var>indices</var><span class="hyp-type"><b>: </b><span>list index</span></span></span><br><span><var>j</var><span class="hyp-type"><b>: </b><span>index</span></span></span><br><span><var>nj</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br></div><label class="goal-separator" for="TraceableVLSM-v-chk110"><hr></label><div class="goal-conclusion"><span class="kr">‚àÄ</span> (<span class="nv">n</span> : j ‚àâ idx :: indices) 
  (<span class="nv">Hni</span> : decide (j ‚àà idx :: indices) = <span class="nb">right</span> n) 
  (<span class="nv">Hdestruct</span> : composite_state_destructor s&#39; j !! nj =
               None) (<span class="nv">Hchoice</span> : 
                      choose s&#39; Hs&#39; (idx :: indices) =
                      (j, nj)),
  inspect (decide (j ‚àà idx :: indices)) =
  <span class="nb">right</span> n ‚Üæ Hni
  ‚Üí inspect (composite_state_destructor s&#39; j !! nj) =
    None ‚Üæ Hdestruct
    ‚Üí inspect (choose s&#39; Hs&#39; (idx :: indices)) =
      (j, nj) ‚Üæ Hchoice
      ‚Üí choosing_well choose
        ‚Üí chosen_transition_preserves_P P choose
          ‚Üí not_in_indices_initial_prop s&#39;
              (idx :: indices)
            ‚Üí NoDup (idx :: indices)
              ‚Üí <span class="kr">‚àÄ</span> (<span class="nv">is</span> : composite_state IM) 
                  (<span class="nv">tr</span> : 
                   list 
                     (composite_transition_item IM)),
                  (s&#39;, []) = (<span class="kr">is</span>, tr)
                  ‚Üí <span class="kr">‚àÄ</span> (<span class="nv">pre</span>
                      <span class="nv">suf</span> : 
                      list
                      (composite_transition_item IM)) 
                      (<span class="nv">item</span> : 
                      composite_transition_item IM),
                      tr = pre ++ item :: suf
                      ‚Üí 
                      P (finite_trace_last <span class="kr">is</span> pre)
                      ‚Üí 
                      P (destination item)</div></blockquote><input class="alectryon-extra-goal-toggle" id="TraceableVLSM-v-chk111" style="display: none" type="checkbox"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>message, index</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>EqDecision0</var><span class="hyp-type"><b>: </b><span>EqDecision index</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>finite.Finite index</span></span></span><br><span><var>IM</var><span class="hyp-type"><b>: </b><span>index ‚Üí VLSM message</span></span></span><br><span><var>state_destructor</var><span class="hyp-type"><b>: </b><span><span class="kr">‚àÄ</span> <span class="nv">i</span> : index,
  vstate (IM i)
  ‚Üí list
      (vtransition_item (IM i) *
       vstate (IM i))</span></span></span><br><span><var>state_size</var><span class="hyp-type"><b>: </b><span><span class="kr">‚àÄ</span> <span class="nv">i</span> : index, vstate (IM i) ‚Üí nat</span></span></span><br><span><var>H0</var><span class="hyp-type"><b>: </b><span><span class="kr">‚àÄ</span> <span class="nv">i</span> : index,
  TraceableVLSM (IM i) 
    (state_destructor i) 
    (state_size i)</span></span></span><br><span><var>Free</var><span><span class="hyp-body"><b>:= </b><span>free_composite_vlsm IM</span></span><span class="hyp-type"><b>: </b><span>VLSM message</span></span></span></span><br><span><var>RFree</var><span><span class="hyp-body"><b>:= </b><span>pre_loaded_with_all_messages_vlsm Free</span></span><span class="hyp-type"><b>: </b><span>VLSM message</span></span></span></span><br><span><var>P</var><span class="hyp-type"><b>: </b><span>composite_state IM ‚Üí <span class="kt">Prop</span></span></span></span><br><span><var>choose</var><span class="hyp-type"><b>: </b><span>choice_function</span></span></span><br><span><var>s'</var><span class="hyp-type"><b>: </b><span>composite_state IM</span></span></span><br><span><var>Hs'</var><span class="hyp-type"><b>: </b><span>valid_state_prop RFree s&#39;</span></span></span><br><span><var>idx</var><span class="hyp-type"><b>: </b><span>index</span></span></span><br><span><var>indices</var><span class="hyp-type"><b>: </b><span>list index</span></span></span><br><span><var>j</var><span class="hyp-type"><b>: </b><span>index</span></span></span><br><span><var>nj</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br></div><label class="goal-separator" for="TraceableVLSM-v-chk111"><hr></label><div class="goal-conclusion"><span class="kr">‚àÄ</span> (<span class="nv">e1</span> : composite_state_destructor s&#39; j = []) 
  (<span class="nv">Hnn</span> : decide (composite_state_destructor s&#39; j = []) =
         <span class="nb">left</span> e1) (<span class="nv">e0</span> : j ‚àà idx :: indices) 
  (<span class="nv">Hi</span> : decide (j ‚àà idx :: indices) = <span class="nb">left</span> e0) 
  (<span class="nv">Hdestruct</span> : composite_state_destructor s&#39; j !! nj =
               None) (<span class="nv">Hchoice</span> : 
                      choose s&#39; Hs&#39; (idx :: indices) =
                      (j, nj)),
  (choosing_well choose
   ‚Üí chosen_transition_preserves_P P choose
     ‚Üí not_in_indices_initial_prop s&#39;
         (<span class="kr">if</span> decide (j = idx)
          <span class="kr">then</span> indices
          <span class="kr">else</span>
           idx :: StdppListSet.set_remove j indices)
       ‚Üí NoDup
           (<span class="kr">if</span> decide (j = idx)
            <span class="kr">then</span> indices
            <span class="kr">else</span>
             idx :: StdppListSet.set_remove j indices)
         ‚Üí <span class="kr">‚àÄ</span> (<span class="nv">is</span> : composite_state IM) 
             (<span class="nv">tr</span> : list (composite_transition_item IM)),
             indexed_composite_state_to_trace choose
               s&#39; Hs&#39;
               (<span class="kr">if</span> decide (j = idx)
                <span class="kr">then</span> indices
                <span class="kr">else</span>
                 idx
                 :: StdppListSet.set_remove j indices) =
             (<span class="kr">is</span>, tr)
             ‚Üí <span class="kr">‚àÄ</span> (<span class="nv">pre</span>
                  <span class="nv">suf</span> : 
                  list 
                    (composite_transition_item IM)) 
                 (<span class="nv">item</span> : 
                  composite_transition_item IM),
                 tr = pre ++ item :: suf
                 ‚Üí P (finite_trace_last <span class="kr">is</span> pre)
                   ‚Üí P (destination item))
  ‚Üí inspect
      (decide (composite_state_destructor s&#39; j = [])) =
    <span class="nb">left</span> e1 ‚Üæ Hnn
    ‚Üí inspect (decide (j ‚àà idx :: indices)) =
      <span class="nb">left</span> e0 ‚Üæ Hi
      ‚Üí inspect
          (composite_state_destructor s&#39; j !! nj) =
        None ‚Üæ Hdestruct
        ‚Üí inspect (choose s&#39; Hs&#39; (idx :: indices)) =
          (j, nj) ‚Üæ Hchoice
          ‚Üí choosing_well choose
            ‚Üí chosen_transition_preserves_P P choose
              ‚Üí not_in_indices_initial_prop s&#39;
                  (idx :: indices)
                ‚Üí NoDup (idx :: indices)
                  ‚Üí <span class="kr">‚àÄ</span> (<span class="nv">is</span> : composite_state IM) 
                      (<span class="nv">tr</span> : 
                      list
                      (composite_transition_item IM)),
                      indexed_composite_state_to_trace
                      choose s&#39; Hs&#39;
                      (<span class="kr">if</span> decide (j = idx)
                      <span class="kr">then</span> indices
                      <span class="kr">else</span>
                      idx
                      :: 
                      StdppListSet.set_remove j
                      indices) = 
                      (<span class="kr">is</span>, tr)
                      ‚Üí 
                      <span class="kr">‚àÄ</span> (<span class="nv">pre</span>
                      <span class="nv">suf</span> : 
                      list
                      (composite_transition_item IM)) 
                      (<span class="nv">item</span> : 
                      composite_transition_item IM),
                      tr = pre ++ item :: suf
                      ‚Üí 
                      P (finite_trace_last <span class="kr">is</span> pre)
                      ‚Üí 
                      P (destination item)</div></blockquote><input class="alectryon-extra-goal-toggle" id="TraceableVLSM-v-chk112" style="display: none" type="checkbox"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>message, index</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>EqDecision0</var><span class="hyp-type"><b>: </b><span>EqDecision index</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>finite.Finite index</span></span></span><br><span><var>IM</var><span class="hyp-type"><b>: </b><span>index ‚Üí VLSM message</span></span></span><br><span><var>state_destructor</var><span class="hyp-type"><b>: </b><span><span class="kr">‚àÄ</span> <span class="nv">i</span> : index,
  vstate (IM i)
  ‚Üí list
      (vtransition_item (IM i) *
       vstate (IM i))</span></span></span><br><span><var>state_size</var><span class="hyp-type"><b>: </b><span><span class="kr">‚àÄ</span> <span class="nv">i</span> : index, vstate (IM i) ‚Üí nat</span></span></span><br><span><var>H0</var><span class="hyp-type"><b>: </b><span><span class="kr">‚àÄ</span> <span class="nv">i</span> : index,
  TraceableVLSM (IM i) 
    (state_destructor i) 
    (state_size i)</span></span></span><br><span><var>Free</var><span><span class="hyp-body"><b>:= </b><span>free_composite_vlsm IM</span></span><span class="hyp-type"><b>: </b><span>VLSM message</span></span></span></span><br><span><var>RFree</var><span><span class="hyp-body"><b>:= </b><span>pre_loaded_with_all_messages_vlsm Free</span></span><span class="hyp-type"><b>: </b><span>VLSM message</span></span></span></span><br><span><var>P</var><span class="hyp-type"><b>: </b><span>composite_state IM ‚Üí <span class="kt">Prop</span></span></span></span><br><span><var>choose</var><span class="hyp-type"><b>: </b><span>choice_function</span></span></span><br><span><var>s'</var><span class="hyp-type"><b>: </b><span>composite_state IM</span></span></span><br><span><var>Hs'</var><span class="hyp-type"><b>: </b><span>valid_state_prop RFree s&#39;</span></span></span><br><span><var>idx</var><span class="hyp-type"><b>: </b><span>index</span></span></span><br><span><var>indices</var><span class="hyp-type"><b>: </b><span>list index</span></span></span><br><span><var>j</var><span class="hyp-type"><b>: </b><span>index</span></span></span><br><span><var>nj</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br></div><label class="goal-separator" for="TraceableVLSM-v-chk112"><hr></label><div class="goal-conclusion"><span class="kr">‚àÄ</span> (<span class="nv">n</span> : composite_state_destructor s&#39; j ‚â† []) 
  (<span class="nv">Hn</span> : decide (composite_state_destructor s&#39; j = []) =
        <span class="nb">right</span> n) (<span class="nv">e0</span> : j ‚àà idx :: indices) 
  (<span class="nv">Hi</span> : decide (j ‚àà idx :: indices) = <span class="nb">left</span> e0) 
  (<span class="nv">Hdestruct</span> : composite_state_destructor s&#39; j !! nj =
               None) (<span class="nv">Hchoice</span> : 
                      choose s&#39; Hs&#39; (idx :: indices) =
                      (j, nj)),
  inspect
    (decide (composite_state_destructor s&#39; j = [])) =
  <span class="nb">right</span> n ‚Üæ Hn
  ‚Üí inspect (decide (j ‚àà idx :: indices)) =
    <span class="nb">left</span> e0 ‚Üæ Hi
    ‚Üí inspect (composite_state_destructor s&#39; j !! nj) =
      None ‚Üæ Hdestruct
      ‚Üí inspect (choose s&#39; Hs&#39; (idx :: indices)) =
        (j, nj) ‚Üæ Hchoice
        ‚Üí choosing_well choose
          ‚Üí chosen_transition_preserves_P P choose
            ‚Üí not_in_indices_initial_prop s&#39;
                (idx :: indices)
              ‚Üí NoDup (idx :: indices)
                ‚Üí <span class="kr">‚àÄ</span> (<span class="nv">is</span> : composite_state IM) 
                    (<span class="nv">tr</span> : 
                     list
                      (composite_transition_item IM)),
                    (s&#39;, []) = (<span class="kr">is</span>, tr)
                    ‚Üí <span class="kr">‚àÄ</span> (<span class="nv">pre</span>
                      <span class="nv">suf</span> : 
                      list
                      (composite_transition_item IM)) 
                      (<span class="nv">item</span> : 
                      composite_transition_item IM),
                      tr = pre ++ item :: suf
                      ‚Üí 
                      P (finite_trace_last <span class="kr">is</span> pre)
                      ‚Üí 
                      P (destination item)</div></blockquote></div></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="TraceableVLSM-v-chk113" style="display: none" type="checkbox"><label class="alectryon-input" for="TraceableVLSM-v-chk113">-</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>message, index</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>EqDecision0</var><span class="hyp-type"><b>: </b><span>EqDecision index</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>finite.Finite index</span></span></span><br><span><var>IM</var><span class="hyp-type"><b>: </b><span>index ‚Üí VLSM message</span></span></span><br><span><var>state_destructor</var><span class="hyp-type"><b>: </b><span><span class="kr">‚àÄ</span> <span class="nv">i</span> : index,
  vstate (IM i)
  ‚Üí list
      (vtransition_item (IM i) *
       vstate (IM i))</span></span></span><br><span><var>state_size</var><span class="hyp-type"><b>: </b><span><span class="kr">‚àÄ</span> <span class="nv">i</span> : index, vstate (IM i) ‚Üí nat</span></span></span><br><span><var>H0</var><span class="hyp-type"><b>: </b><span><span class="kr">‚àÄ</span> <span class="nv">i</span> : index,
  TraceableVLSM (IM i) 
    (state_destructor i) 
    (state_size i)</span></span></span><br><span><var>Free</var><span><span class="hyp-body"><b>:= </b><span>free_composite_vlsm IM</span></span><span class="hyp-type"><b>: </b><span>VLSM message</span></span></span></span><br><span><var>RFree</var><span><span class="hyp-body"><b>:= </b><span>pre_loaded_with_all_messages_vlsm Free</span></span><span class="hyp-type"><b>: </b><span>VLSM message</span></span></span></span><br><span><var>P</var><span class="hyp-type"><b>: </b><span>composite_state IM ‚Üí <span class="kt">Prop</span></span></span></span><br><span><var>choose</var><span class="hyp-type"><b>: </b><span>choice_function</span></span></span><br><span><var>s'</var><span class="hyp-type"><b>: </b><span>composite_state IM</span></span></span><br><span><var>Hs'</var><span class="hyp-type"><b>: </b><span>valid_state_prop RFree s&#39;</span></span></span><br><span><var>idx</var><span class="hyp-type"><b>: </b><span>index</span></span></span><br><span><var>indices</var><span class="hyp-type"><b>: </b><span>list index</span></span></span><br><span><var>j</var><span class="hyp-type"><b>: </b><span>index</span></span></span><br><span><var>nj</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="kr">‚àÄ</span> (<span class="nv">item</span> : composite_transition_item IM) (<span class="nv">s</span> : composite_state
                                               IM) 
  (<span class="nv">Hdestruct</span> : composite_state_destructor s&#39; j !! nj =
               Some (item, s)) (<span class="nv">Hchoice</span> : choose s&#39;
                                            Hs&#39;
                                            (idx
                                             :: indices) =
                                          (j, nj)) 
  (<span class="nv">is</span> : composite_state IM) (<span class="nv">tr</span> : list
                                    (composite_transition_item
                                       IM)),
  indexed_composite_state_to_trace choose s
    (indexed_composite_state_to_trace_obligations_obligation_1
       s&#39; Hs&#39; (j, nj) item s Hdestruct)
    (idx :: indices) = (<span class="kr">is</span>, tr)
  ‚Üí (choosing_well choose
     ‚Üí chosen_transition_preserves_P P choose
       ‚Üí not_in_indices_initial_prop s
           (idx :: indices)
         ‚Üí NoDup (idx :: indices)
           ‚Üí <span class="kr">‚àÄ</span> (<span class="nv">is0</span> : composite_state IM) (<span class="nv">tr0</span> : list
                                                 (composite_transition_item
                                                 IM)),
               indexed_composite_state_to_trace choose
                 s
                 (indexed_composite_state_to_trace_obligations_obligation_1
                    s&#39; Hs&#39; (j, nj) item s Hdestruct)
                 (idx :: indices) = (is0, tr0)
               ‚Üí <span class="kr">‚àÄ</span> (<span class="nv">pre</span>
                    <span class="nv">suf</span> : list
                            (composite_transition_item
                               IM)) (<span class="nv">item0</span> : composite_transition_item
                                               IM),
                   tr0 = pre ++ item0 :: suf
                   ‚Üí P (finite_trace_last is0 pre)
                     ‚Üí P (destination item0))
    ‚Üí inspect (composite_state_destructor s&#39; j !! nj) =
      Some (item, s) ‚Üæ Hdestruct
      ‚Üí inspect (choose s&#39; Hs&#39; (idx :: indices)) =
        (j, nj) ‚Üæ Hchoice
        ‚Üí choosing_well choose
          ‚Üí chosen_transition_preserves_P P choose
            ‚Üí not_in_indices_initial_prop s&#39;
                (idx :: indices)
              ‚Üí NoDup (idx :: indices)
                ‚Üí <span class="kr">‚àÄ</span> (<span class="nv">is0</span> : composite_state IM) (<span class="nv">tr0</span> : 
                                                list
                                                 (composite_transition_item
                                                 IM)),
                    (<span class="kr">is</span>, tr ++ [item]) = (is0, tr0)
                    ‚Üí <span class="kr">‚àÄ</span> (<span class="nv">pre</span>
                         <span class="nv">suf</span> : list
                                 (composite_transition_item
                                    IM)) (<span class="nv">item0</span> : 
                                          composite_transition_item
                                            IM),
                        tr0 = pre ++ item0 :: suf
                        ‚Üí P
                            (finite_trace_last is0 pre)
                          ‚Üí P (destination item0)</div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="TraceableVLSM-v-chk114" style="display: none" type="checkbox"><label class="alectryon-input" for="TraceableVLSM-v-chk114"><span class="nb">intros</span> item s Hdestruct Hchoice <span class="kr">is</span> tr Heq ? _ _ ? ? ? ? ? ? [= &lt;- &lt;-] **;
      <span class="nb">rewrite</span> Heq <span class="kr">in</span> Hind.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>message, index</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>EqDecision0</var><span class="hyp-type"><b>: </b><span>EqDecision index</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>finite.Finite index</span></span></span><br><span><var>IM</var><span class="hyp-type"><b>: </b><span>index ‚Üí VLSM message</span></span></span><br><span><var>state_destructor</var><span class="hyp-type"><b>: </b><span><span class="kr">‚àÄ</span> <span class="nv">i</span> : index,
  vstate (IM i)
  ‚Üí list
      (vtransition_item (IM i) *
       vstate (IM i))</span></span></span><br><span><var>state_size</var><span class="hyp-type"><b>: </b><span><span class="kr">‚àÄ</span> <span class="nv">i</span> : index, vstate (IM i) ‚Üí nat</span></span></span><br><span><var>H0</var><span class="hyp-type"><b>: </b><span><span class="kr">‚àÄ</span> <span class="nv">i</span> : index,
  TraceableVLSM (IM i) 
    (state_destructor i) 
    (state_size i)</span></span></span><br><span><var>Free</var><span><span class="hyp-body"><b>:= </b><span>free_composite_vlsm IM</span></span><span class="hyp-type"><b>: </b><span>VLSM message</span></span></span></span><br><span><var>RFree</var><span><span class="hyp-body"><b>:= </b><span>pre_loaded_with_all_messages_vlsm Free</span></span><span class="hyp-type"><b>: </b><span>VLSM message</span></span></span></span><br><span><var>P</var><span class="hyp-type"><b>: </b><span>composite_state IM ‚Üí <span class="kt">Prop</span></span></span></span><br><span><var>choose</var><span class="hyp-type"><b>: </b><span>choice_function</span></span></span><br><span><var>s'</var><span class="hyp-type"><b>: </b><span>composite_state IM</span></span></span><br><span><var>Hs'</var><span class="hyp-type"><b>: </b><span>valid_state_prop RFree s&#39;</span></span></span><br><span><var>idx</var><span class="hyp-type"><b>: </b><span>index</span></span></span><br><span><var>indices</var><span class="hyp-type"><b>: </b><span>list index</span></span></span><br><span><var>j</var><span class="hyp-type"><b>: </b><span>index</span></span></span><br><span><var>nj</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>item</var><span class="hyp-type"><b>: </b><span>composite_transition_item IM</span></span></span><br><span><var>s</var><span class="hyp-type"><b>: </b><span>composite_state IM</span></span></span><br><span><var>Hdestruct</var><span class="hyp-type"><b>: </b><span>composite_state_destructor s&#39; j !! nj =
Some (item, s)</span></span></span><br><span><var>Hchoice</var><span class="hyp-type"><b>: </b><span>choose s&#39; Hs&#39; (idx :: indices) = (j, nj)</span></span></span><br><span><var>is</var><span class="hyp-type"><b>: </b><span>composite_state IM</span></span></span><br><span><var>tr</var><span class="hyp-type"><b>: </b><span>list (composite_transition_item IM)</span></span></span><br><span><var>Heq</var><span class="hyp-type"><b>: </b><span>indexed_composite_state_to_trace choose s
  (indexed_composite_state_to_trace_obligations_obligation_1
     s&#39; Hs&#39; (j, nj) item s Hdestruct)
  (idx :: indices) = (<span class="kr">is</span>, tr)</span></span></span><br><span><var>Hind</var><span class="hyp-type"><b>: </b><span>choosing_well choose
‚Üí chosen_transition_preserves_P P choose
  ‚Üí not_in_indices_initial_prop s
      (idx :: indices)
    ‚Üí NoDup (idx :: indices)
      ‚Üí <span class="kr">‚àÄ</span> (<span class="nv">is0</span> : composite_state IM) 
          (<span class="nv">tr0</span> : list
                   (composite_transition_item
                      IM)),
          (<span class="kr">is</span>, tr) = (is0, tr0)
          ‚Üí <span class="kr">‚àÄ</span> (<span class="nv">pre</span>
               <span class="nv">suf</span> : list
                      (composite_transition_item
                      IM)) 
              (<span class="nv">item</span> : composite_transition_item
                      IM),
              tr0 = pre ++ item :: suf
              ‚Üí P (finite_trace_last is0 pre)
                ‚Üí P (destination item)</span></span></span><br><span><var>Hwell</var><span class="hyp-type"><b>: </b><span>choosing_well choose</span></span></span><br><span><var>HchooseP</var><span class="hyp-type"><b>: </b><span>chosen_transition_preserves_P P choose</span></span></span><br><span><var>Hinitial</var><span class="hyp-type"><b>: </b><span>not_in_indices_initial_prop s&#39;
  (idx :: indices)</span></span></span><br><span><var>Hnodup</var><span class="hyp-type"><b>: </b><span>NoDup (idx :: indices)</span></span></span><br><span><var>pre, suf</var><span class="hyp-type"><b>: </b><span>list (composite_transition_item IM)</span></span></span><br><span><var>item0</var><span class="hyp-type"><b>: </b><span>composite_transition_item IM</span></span></span><br><span><var>Heqtr</var><span class="hyp-type"><b>: </b><span>tr ++ [item] = pre ++ item0 :: suf</span></span></span><br><span><var>Heqv</var><span class="hyp-type"><b>: </b><span>P (finite_trace_last <span class="kr">is</span> pre)</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">P (destination item0)</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="TraceableVLSM-v-chk115" style="display: none" type="checkbox"><label class="alectryon-input" for="TraceableVLSM-v-chk115"><span class="nb">eapply</span> composite_tv_state_destructor_preserves_not_in_indices_initial <span class="kr">in</span> Hinitial <span class="kr">as</span> Hinitials;
      [| <span class="bp">done</span>..].</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>message, index</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>EqDecision0</var><span class="hyp-type"><b>: </b><span>EqDecision index</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>finite.Finite index</span></span></span><br><span><var>IM</var><span class="hyp-type"><b>: </b><span>index ‚Üí VLSM message</span></span></span><br><span><var>state_destructor</var><span class="hyp-type"><b>: </b><span><span class="kr">‚àÄ</span> <span class="nv">i</span> : index,
  vstate (IM i)
  ‚Üí list
      (vtransition_item (IM i) *
       vstate (IM i))</span></span></span><br><span><var>state_size</var><span class="hyp-type"><b>: </b><span><span class="kr">‚àÄ</span> <span class="nv">i</span> : index, vstate (IM i) ‚Üí nat</span></span></span><br><span><var>H0</var><span class="hyp-type"><b>: </b><span><span class="kr">‚àÄ</span> <span class="nv">i</span> : index,
  TraceableVLSM (IM i) 
    (state_destructor i) 
    (state_size i)</span></span></span><br><span><var>Free</var><span><span class="hyp-body"><b>:= </b><span>free_composite_vlsm IM</span></span><span class="hyp-type"><b>: </b><span>VLSM message</span></span></span></span><br><span><var>RFree</var><span><span class="hyp-body"><b>:= </b><span>pre_loaded_with_all_messages_vlsm Free</span></span><span class="hyp-type"><b>: </b><span>VLSM message</span></span></span></span><br><span><var>P</var><span class="hyp-type"><b>: </b><span>composite_state IM ‚Üí <span class="kt">Prop</span></span></span></span><br><span><var>choose</var><span class="hyp-type"><b>: </b><span>choice_function</span></span></span><br><span><var>s'</var><span class="hyp-type"><b>: </b><span>composite_state IM</span></span></span><br><span><var>Hs'</var><span class="hyp-type"><b>: </b><span>valid_state_prop RFree s&#39;</span></span></span><br><span><var>idx</var><span class="hyp-type"><b>: </b><span>index</span></span></span><br><span><var>indices</var><span class="hyp-type"><b>: </b><span>list index</span></span></span><br><span><var>j</var><span class="hyp-type"><b>: </b><span>index</span></span></span><br><span><var>nj</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>item</var><span class="hyp-type"><b>: </b><span>composite_transition_item IM</span></span></span><br><span><var>s</var><span class="hyp-type"><b>: </b><span>composite_state IM</span></span></span><br><span><var>Hdestruct</var><span class="hyp-type"><b>: </b><span>composite_state_destructor s&#39; j !! nj =
Some (item, s)</span></span></span><br><span><var>Hchoice</var><span class="hyp-type"><b>: </b><span>choose s&#39; Hs&#39; (idx :: indices) = (j, nj)</span></span></span><br><span><var>is</var><span class="hyp-type"><b>: </b><span>composite_state IM</span></span></span><br><span><var>tr</var><span class="hyp-type"><b>: </b><span>list (composite_transition_item IM)</span></span></span><br><span><var>Heq</var><span class="hyp-type"><b>: </b><span>indexed_composite_state_to_trace choose s
  (indexed_composite_state_to_trace_obligations_obligation_1
     s&#39; Hs&#39; (j, nj) item s Hdestruct)
  (idx :: indices) = (<span class="kr">is</span>, tr)</span></span></span><br><span><var>Hind</var><span class="hyp-type"><b>: </b><span>choosing_well choose
‚Üí chosen_transition_preserves_P P choose
  ‚Üí not_in_indices_initial_prop s
      (idx :: indices)
    ‚Üí NoDup (idx :: indices)
      ‚Üí <span class="kr">‚àÄ</span> (<span class="nv">is0</span> : composite_state IM) 
          (<span class="nv">tr0</span> : list
                   (composite_transition_item
                      IM)),
          (<span class="kr">is</span>, tr) = (is0, tr0)
          ‚Üí <span class="kr">‚àÄ</span> (<span class="nv">pre</span>
               <span class="nv">suf</span> : list
                      (composite_transition_item
                      IM)) 
              (<span class="nv">item</span> : composite_transition_item
                      IM),
              tr0 = pre ++ item :: suf
              ‚Üí P (finite_trace_last is0 pre)
                ‚Üí P (destination item)</span></span></span><br><span><var>Hwell</var><span class="hyp-type"><b>: </b><span>choosing_well choose</span></span></span><br><span><var>HchooseP</var><span class="hyp-type"><b>: </b><span>chosen_transition_preserves_P P choose</span></span></span><br><span><var>Hinitial</var><span class="hyp-type"><b>: </b><span>not_in_indices_initial_prop s&#39;
  (idx :: indices)</span></span></span><br><span><var>Hnodup</var><span class="hyp-type"><b>: </b><span>NoDup (idx :: indices)</span></span></span><br><span><var>pre, suf</var><span class="hyp-type"><b>: </b><span>list (composite_transition_item IM)</span></span></span><br><span><var>item0</var><span class="hyp-type"><b>: </b><span>composite_transition_item IM</span></span></span><br><span><var>Heqtr</var><span class="hyp-type"><b>: </b><span>tr ++ [item] = pre ++ item0 :: suf</span></span></span><br><span><var>Heqv</var><span class="hyp-type"><b>: </b><span>P (finite_trace_last <span class="kr">is</span> pre)</span></span></span><br><span><var>Hinitials</var><span class="hyp-type"><b>: </b><span>not_in_indices_initial_prop s
  (idx :: indices)</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">P (destination item0)</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="TraceableVLSM-v-chk116" style="display: none" type="checkbox"><label class="alectryon-input" for="TraceableVLSM-v-chk116">destruct_list_last suf suf&#39; last_suf Heqsuf; <span class="nb">subst</span> suf; simplify_list_eq;
      [| <span class="bp">by</span> <span class="nb">eapply</span> Hind].</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>message, index</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>EqDecision0</var><span class="hyp-type"><b>: </b><span>EqDecision index</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>finite.Finite index</span></span></span><br><span><var>IM</var><span class="hyp-type"><b>: </b><span>index ‚Üí VLSM message</span></span></span><br><span><var>state_destructor</var><span class="hyp-type"><b>: </b><span><span class="kr">‚àÄ</span> <span class="nv">i</span> : index,
  vstate (IM i)
  ‚Üí list
      (vtransition_item (IM i) *
       vstate (IM i))</span></span></span><br><span><var>state_size</var><span class="hyp-type"><b>: </b><span><span class="kr">‚àÄ</span> <span class="nv">i</span> : index, vstate (IM i) ‚Üí nat</span></span></span><br><span><var>H0</var><span class="hyp-type"><b>: </b><span><span class="kr">‚àÄ</span> <span class="nv">i</span> : index,
  TraceableVLSM (IM i) 
    (state_destructor i) 
    (state_size i)</span></span></span><br><span><var>Free</var><span><span class="hyp-body"><b>:= </b><span>free_composite_vlsm IM</span></span><span class="hyp-type"><b>: </b><span>VLSM message</span></span></span></span><br><span><var>RFree</var><span><span class="hyp-body"><b>:= </b><span>pre_loaded_with_all_messages_vlsm Free</span></span><span class="hyp-type"><b>: </b><span>VLSM message</span></span></span></span><br><span><var>P</var><span class="hyp-type"><b>: </b><span>composite_state IM ‚Üí <span class="kt">Prop</span></span></span></span><br><span><var>choose</var><span class="hyp-type"><b>: </b><span>choice_function</span></span></span><br><span><var>s'</var><span class="hyp-type"><b>: </b><span>composite_state IM</span></span></span><br><span><var>Hs'</var><span class="hyp-type"><b>: </b><span>valid_state_prop RFree s&#39;</span></span></span><br><span><var>idx</var><span class="hyp-type"><b>: </b><span>index</span></span></span><br><span><var>indices</var><span class="hyp-type"><b>: </b><span>list index</span></span></span><br><span><var>j</var><span class="hyp-type"><b>: </b><span>index</span></span></span><br><span><var>nj</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>s</var><span class="hyp-type"><b>: </b><span>composite_state IM</span></span></span><br><span><var>item0</var><span class="hyp-type"><b>: </b><span>composite_transition_item IM</span></span></span><br><span><var>Hdestruct</var><span class="hyp-type"><b>: </b><span>composite_state_destructor s&#39; j !! nj =
Some (item0, s)</span></span></span><br><span><var>Hchoice</var><span class="hyp-type"><b>: </b><span>choose s&#39; Hs&#39; (idx :: indices) = (j, nj)</span></span></span><br><span><var>is</var><span class="hyp-type"><b>: </b><span>composite_state IM</span></span></span><br><span><var>pre</var><span class="hyp-type"><b>: </b><span>list (composite_transition_item IM)</span></span></span><br><span><var>Hind</var><span class="hyp-type"><b>: </b><span>choosing_well choose
‚Üí chosen_transition_preserves_P P choose
  ‚Üí not_in_indices_initial_prop s
      (idx :: indices)
    ‚Üí NoDup (idx :: indices)
      ‚Üí <span class="kr">‚àÄ</span> (<span class="nv">is0</span> : composite_state IM) 
          (<span class="nv">tr</span> : list
                  (composite_transition_item IM)),
          (<span class="kr">is</span>, pre) = (is0, tr)
          ‚Üí <span class="kr">‚àÄ</span> (<span class="nv">pre</span>
               <span class="nv">suf</span> : list
                      (composite_transition_item
                      IM)) 
              (<span class="nv">item</span> : composite_transition_item
                      IM),
              tr = pre ++ item :: suf
              ‚Üí P (finite_trace_last is0 pre)
                ‚Üí P (destination item)</span></span></span><br><span><var>Heq</var><span class="hyp-type"><b>: </b><span>indexed_composite_state_to_trace choose s
  (indexed_composite_state_to_trace_obligations_obligation_1
     s&#39; Hs&#39; (j, nj) item0 s Hdestruct)
  (idx :: indices) = (<span class="kr">is</span>, pre)</span></span></span><br><span><var>Hwell</var><span class="hyp-type"><b>: </b><span>choosing_well choose</span></span></span><br><span><var>HchooseP</var><span class="hyp-type"><b>: </b><span>chosen_transition_preserves_P P choose</span></span></span><br><span><var>Hinitial</var><span class="hyp-type"><b>: </b><span>not_in_indices_initial_prop s&#39;
  (idx :: indices)</span></span></span><br><span><var>Hnodup</var><span class="hyp-type"><b>: </b><span>NoDup (idx :: indices)</span></span></span><br><span><var>Heqv</var><span class="hyp-type"><b>: </b><span>P (finite_trace_last <span class="kr">is</span> pre)</span></span></span><br><span><var>Hinitials</var><span class="hyp-type"><b>: </b><span>not_in_indices_initial_prop s
  (idx :: indices)</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">P (destination item0)</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="TraceableVLSM-v-chk117" style="display: none" type="checkbox"><label class="alectryon-input" for="TraceableVLSM-v-chk117"><span class="nb">assert</span> (destination item0 = s&#39;) <span class="kr">as</span> -&gt;
      <span class="bp">by</span> (<span class="nb">eapply</span> composite_tv_state_destructor_destination, elem_of_list_lookup_2; <span class="bp">done</span>).</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>message, index</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>EqDecision0</var><span class="hyp-type"><b>: </b><span>EqDecision index</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>finite.Finite index</span></span></span><br><span><var>IM</var><span class="hyp-type"><b>: </b><span>index ‚Üí VLSM message</span></span></span><br><span><var>state_destructor</var><span class="hyp-type"><b>: </b><span><span class="kr">‚àÄ</span> <span class="nv">i</span> : index,
  vstate (IM i)
  ‚Üí list
      (vtransition_item (IM i) *
       vstate (IM i))</span></span></span><br><span><var>state_size</var><span class="hyp-type"><b>: </b><span><span class="kr">‚àÄ</span> <span class="nv">i</span> : index, vstate (IM i) ‚Üí nat</span></span></span><br><span><var>H0</var><span class="hyp-type"><b>: </b><span><span class="kr">‚àÄ</span> <span class="nv">i</span> : index,
  TraceableVLSM (IM i) 
    (state_destructor i) 
    (state_size i)</span></span></span><br><span><var>Free</var><span><span class="hyp-body"><b>:= </b><span>free_composite_vlsm IM</span></span><span class="hyp-type"><b>: </b><span>VLSM message</span></span></span></span><br><span><var>RFree</var><span><span class="hyp-body"><b>:= </b><span>pre_loaded_with_all_messages_vlsm Free</span></span><span class="hyp-type"><b>: </b><span>VLSM message</span></span></span></span><br><span><var>P</var><span class="hyp-type"><b>: </b><span>composite_state IM ‚Üí <span class="kt">Prop</span></span></span></span><br><span><var>choose</var><span class="hyp-type"><b>: </b><span>choice_function</span></span></span><br><span><var>s'</var><span class="hyp-type"><b>: </b><span>composite_state IM</span></span></span><br><span><var>Hs'</var><span class="hyp-type"><b>: </b><span>valid_state_prop RFree s&#39;</span></span></span><br><span><var>idx</var><span class="hyp-type"><b>: </b><span>index</span></span></span><br><span><var>indices</var><span class="hyp-type"><b>: </b><span>list index</span></span></span><br><span><var>j</var><span class="hyp-type"><b>: </b><span>index</span></span></span><br><span><var>nj</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>s</var><span class="hyp-type"><b>: </b><span>composite_state IM</span></span></span><br><span><var>item0</var><span class="hyp-type"><b>: </b><span>composite_transition_item IM</span></span></span><br><span><var>Hdestruct</var><span class="hyp-type"><b>: </b><span>composite_state_destructor s&#39; j !! nj =
Some (item0, s)</span></span></span><br><span><var>Hchoice</var><span class="hyp-type"><b>: </b><span>choose s&#39; Hs&#39; (idx :: indices) = (j, nj)</span></span></span><br><span><var>is</var><span class="hyp-type"><b>: </b><span>composite_state IM</span></span></span><br><span><var>pre</var><span class="hyp-type"><b>: </b><span>list (composite_transition_item IM)</span></span></span><br><span><var>Hind</var><span class="hyp-type"><b>: </b><span>choosing_well choose
‚Üí chosen_transition_preserves_P P choose
  ‚Üí not_in_indices_initial_prop s
      (idx :: indices)
    ‚Üí NoDup (idx :: indices)
      ‚Üí <span class="kr">‚àÄ</span> (<span class="nv">is0</span> : composite_state IM) 
          (<span class="nv">tr</span> : list
                  (composite_transition_item IM)),
          (<span class="kr">is</span>, pre) = (is0, tr)
          ‚Üí <span class="kr">‚àÄ</span> (<span class="nv">pre</span>
               <span class="nv">suf</span> : list
                      (composite_transition_item
                      IM)) 
              (<span class="nv">item</span> : composite_transition_item
                      IM),
              tr = pre ++ item :: suf
              ‚Üí P (finite_trace_last is0 pre)
                ‚Üí P (destination item)</span></span></span><br><span><var>Heq</var><span class="hyp-type"><b>: </b><span>indexed_composite_state_to_trace choose s
  (indexed_composite_state_to_trace_obligations_obligation_1
     s&#39; Hs&#39; (j, nj) item0 s Hdestruct)
  (idx :: indices) = (<span class="kr">is</span>, pre)</span></span></span><br><span><var>Hwell</var><span class="hyp-type"><b>: </b><span>choosing_well choose</span></span></span><br><span><var>HchooseP</var><span class="hyp-type"><b>: </b><span>chosen_transition_preserves_P P choose</span></span></span><br><span><var>Hinitial</var><span class="hyp-type"><b>: </b><span>not_in_indices_initial_prop s&#39;
  (idx :: indices)</span></span></span><br><span><var>Hnodup</var><span class="hyp-type"><b>: </b><span>NoDup (idx :: indices)</span></span></span><br><span><var>Heqv</var><span class="hyp-type"><b>: </b><span>P (finite_trace_last <span class="kr">is</span> pre)</span></span></span><br><span><var>Hinitials</var><span class="hyp-type"><b>: </b><span>not_in_indices_initial_prop s
  (idx :: indices)</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">P s&#39;</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="TraceableVLSM-v-chk118" style="display: none" type="checkbox"><label class="alectryon-input" for="TraceableVLSM-v-chk118"><span class="nb">erewrite</span> indexed_composite_state_to_trace_last <span class="kr">in</span> Heqv <span class="bp">by</span> <span class="bp">done</span>.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>message, index</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>EqDecision0</var><span class="hyp-type"><b>: </b><span>EqDecision index</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>finite.Finite index</span></span></span><br><span><var>IM</var><span class="hyp-type"><b>: </b><span>index ‚Üí VLSM message</span></span></span><br><span><var>state_destructor</var><span class="hyp-type"><b>: </b><span><span class="kr">‚àÄ</span> <span class="nv">i</span> : index,
  vstate (IM i)
  ‚Üí list
      (vtransition_item (IM i) *
       vstate (IM i))</span></span></span><br><span><var>state_size</var><span class="hyp-type"><b>: </b><span><span class="kr">‚àÄ</span> <span class="nv">i</span> : index, vstate (IM i) ‚Üí nat</span></span></span><br><span><var>H0</var><span class="hyp-type"><b>: </b><span><span class="kr">‚àÄ</span> <span class="nv">i</span> : index,
  TraceableVLSM (IM i) 
    (state_destructor i) 
    (state_size i)</span></span></span><br><span><var>Free</var><span><span class="hyp-body"><b>:= </b><span>free_composite_vlsm IM</span></span><span class="hyp-type"><b>: </b><span>VLSM message</span></span></span></span><br><span><var>RFree</var><span><span class="hyp-body"><b>:= </b><span>pre_loaded_with_all_messages_vlsm Free</span></span><span class="hyp-type"><b>: </b><span>VLSM message</span></span></span></span><br><span><var>P</var><span class="hyp-type"><b>: </b><span>composite_state IM ‚Üí <span class="kt">Prop</span></span></span></span><br><span><var>choose</var><span class="hyp-type"><b>: </b><span>choice_function</span></span></span><br><span><var>s'</var><span class="hyp-type"><b>: </b><span>composite_state IM</span></span></span><br><span><var>Hs'</var><span class="hyp-type"><b>: </b><span>valid_state_prop RFree s&#39;</span></span></span><br><span><var>idx</var><span class="hyp-type"><b>: </b><span>index</span></span></span><br><span><var>indices</var><span class="hyp-type"><b>: </b><span>list index</span></span></span><br><span><var>j</var><span class="hyp-type"><b>: </b><span>index</span></span></span><br><span><var>nj</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>s</var><span class="hyp-type"><b>: </b><span>composite_state IM</span></span></span><br><span><var>item0</var><span class="hyp-type"><b>: </b><span>composite_transition_item IM</span></span></span><br><span><var>Hdestruct</var><span class="hyp-type"><b>: </b><span>composite_state_destructor s&#39; j !! nj =
Some (item0, s)</span></span></span><br><span><var>Hchoice</var><span class="hyp-type"><b>: </b><span>choose s&#39; Hs&#39; (idx :: indices) = (j, nj)</span></span></span><br><span><var>is</var><span class="hyp-type"><b>: </b><span>composite_state IM</span></span></span><br><span><var>pre</var><span class="hyp-type"><b>: </b><span>list (composite_transition_item IM)</span></span></span><br><span><var>Hind</var><span class="hyp-type"><b>: </b><span>choosing_well choose
‚Üí chosen_transition_preserves_P P choose
  ‚Üí not_in_indices_initial_prop s
      (idx :: indices)
    ‚Üí NoDup (idx :: indices)
      ‚Üí <span class="kr">‚àÄ</span> (<span class="nv">is0</span> : composite_state IM) 
          (<span class="nv">tr</span> : list
                  (composite_transition_item IM)),
          (<span class="kr">is</span>, pre) = (is0, tr)
          ‚Üí <span class="kr">‚àÄ</span> (<span class="nv">pre</span>
               <span class="nv">suf</span> : list
                      (composite_transition_item
                      IM)) 
              (<span class="nv">item</span> : composite_transition_item
                      IM),
              tr = pre ++ item :: suf
              ‚Üí P (finite_trace_last is0 pre)
                ‚Üí P (destination item)</span></span></span><br><span><var>Heq</var><span class="hyp-type"><b>: </b><span>indexed_composite_state_to_trace choose s
  (indexed_composite_state_to_trace_obligations_obligation_1
     s&#39; Hs&#39; (j, nj) item0 s Hdestruct)
  (idx :: indices) = (<span class="kr">is</span>, pre)</span></span></span><br><span><var>Hwell</var><span class="hyp-type"><b>: </b><span>choosing_well choose</span></span></span><br><span><var>HchooseP</var><span class="hyp-type"><b>: </b><span>chosen_transition_preserves_P P choose</span></span></span><br><span><var>Hinitial</var><span class="hyp-type"><b>: </b><span>not_in_indices_initial_prop s&#39;
  (idx :: indices)</span></span></span><br><span><var>Hnodup</var><span class="hyp-type"><b>: </b><span>NoDup (idx :: indices)</span></span></span><br><span><var>Hinitials</var><span class="hyp-type"><b>: </b><span>not_in_indices_initial_prop s
  (idx :: indices)</span></span></span><br><span><var>Heqv</var><span class="hyp-type"><b>: </b><span>P s</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">P s&#39;</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="TraceableVLSM-v-chk119" style="display: none" type="checkbox"><label class="alectryon-input" for="TraceableVLSM-v-chk119"><span class="nb">eapply</span> HchooseP; [<span class="bp">done</span> | <span class="bp">done</span> | | <span class="bp">done</span> | <span class="bp">done</span> | <span class="bp">done</span>].</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>message, index</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>EqDecision0</var><span class="hyp-type"><b>: </b><span>EqDecision index</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>finite.Finite index</span></span></span><br><span><var>IM</var><span class="hyp-type"><b>: </b><span>index ‚Üí VLSM message</span></span></span><br><span><var>state_destructor</var><span class="hyp-type"><b>: </b><span><span class="kr">‚àÄ</span> <span class="nv">i</span> : index,
  vstate (IM i)
  ‚Üí list
      (vtransition_item (IM i) *
       vstate (IM i))</span></span></span><br><span><var>state_size</var><span class="hyp-type"><b>: </b><span><span class="kr">‚àÄ</span> <span class="nv">i</span> : index, vstate (IM i) ‚Üí nat</span></span></span><br><span><var>H0</var><span class="hyp-type"><b>: </b><span><span class="kr">‚àÄ</span> <span class="nv">i</span> : index,
  TraceableVLSM (IM i) 
    (state_destructor i) 
    (state_size i)</span></span></span><br><span><var>Free</var><span><span class="hyp-body"><b>:= </b><span>free_composite_vlsm IM</span></span><span class="hyp-type"><b>: </b><span>VLSM message</span></span></span></span><br><span><var>RFree</var><span><span class="hyp-body"><b>:= </b><span>pre_loaded_with_all_messages_vlsm Free</span></span><span class="hyp-type"><b>: </b><span>VLSM message</span></span></span></span><br><span><var>P</var><span class="hyp-type"><b>: </b><span>composite_state IM ‚Üí <span class="kt">Prop</span></span></span></span><br><span><var>choose</var><span class="hyp-type"><b>: </b><span>choice_function</span></span></span><br><span><var>s'</var><span class="hyp-type"><b>: </b><span>composite_state IM</span></span></span><br><span><var>Hs'</var><span class="hyp-type"><b>: </b><span>valid_state_prop RFree s&#39;</span></span></span><br><span><var>idx</var><span class="hyp-type"><b>: </b><span>index</span></span></span><br><span><var>indices</var><span class="hyp-type"><b>: </b><span>list index</span></span></span><br><span><var>j</var><span class="hyp-type"><b>: </b><span>index</span></span></span><br><span><var>nj</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>s</var><span class="hyp-type"><b>: </b><span>composite_state IM</span></span></span><br><span><var>item0</var><span class="hyp-type"><b>: </b><span>composite_transition_item IM</span></span></span><br><span><var>Hdestruct</var><span class="hyp-type"><b>: </b><span>composite_state_destructor s&#39; j !! nj =
Some (item0, s)</span></span></span><br><span><var>Hchoice</var><span class="hyp-type"><b>: </b><span>choose s&#39; Hs&#39; (idx :: indices) = (j, nj)</span></span></span><br><span><var>is</var><span class="hyp-type"><b>: </b><span>composite_state IM</span></span></span><br><span><var>pre</var><span class="hyp-type"><b>: </b><span>list (composite_transition_item IM)</span></span></span><br><span><var>Hind</var><span class="hyp-type"><b>: </b><span>choosing_well choose
‚Üí chosen_transition_preserves_P P choose
  ‚Üí not_in_indices_initial_prop s
      (idx :: indices)
    ‚Üí NoDup (idx :: indices)
      ‚Üí <span class="kr">‚àÄ</span> (<span class="nv">is0</span> : composite_state IM) 
          (<span class="nv">tr</span> : list
                  (composite_transition_item IM)),
          (<span class="kr">is</span>, pre) = (is0, tr)
          ‚Üí <span class="kr">‚àÄ</span> (<span class="nv">pre</span>
               <span class="nv">suf</span> : list
                      (composite_transition_item
                      IM)) 
              (<span class="nv">item</span> : composite_transition_item
                      IM),
              tr = pre ++ item :: suf
              ‚Üí P (finite_trace_last is0 pre)
                ‚Üí P (destination item)</span></span></span><br><span><var>Heq</var><span class="hyp-type"><b>: </b><span>indexed_composite_state_to_trace choose s
  (indexed_composite_state_to_trace_obligations_obligation_1
     s&#39; Hs&#39; (j, nj) item0 s Hdestruct)
  (idx :: indices) = (<span class="kr">is</span>, pre)</span></span></span><br><span><var>Hwell</var><span class="hyp-type"><b>: </b><span>choosing_well choose</span></span></span><br><span><var>HchooseP</var><span class="hyp-type"><b>: </b><span>chosen_transition_preserves_P P choose</span></span></span><br><span><var>Hinitial</var><span class="hyp-type"><b>: </b><span>not_in_indices_initial_prop s&#39;
  (idx :: indices)</span></span></span><br><span><var>Hnodup</var><span class="hyp-type"><b>: </b><span>NoDup (idx :: indices)</span></span></span><br><span><var>Hinitials</var><span class="hyp-type"><b>: </b><span>not_in_indices_initial_prop s
  (idx :: indices)</span></span></span><br><span><var>Heqv</var><span class="hyp-type"><b>: </b><span>P s</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">j ‚àà idx :: indices</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="TraceableVLSM-v-chk11a" style="display: none" type="checkbox"><label class="alectryon-input" for="TraceableVLSM-v-chk11a"><span class="nb">destruct</span> (decide (j ‚àà idx :: indices)); [<span class="bp">done</span> |].</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>message, index</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>EqDecision0</var><span class="hyp-type"><b>: </b><span>EqDecision index</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>finite.Finite index</span></span></span><br><span><var>IM</var><span class="hyp-type"><b>: </b><span>index ‚Üí VLSM message</span></span></span><br><span><var>state_destructor</var><span class="hyp-type"><b>: </b><span><span class="kr">‚àÄ</span> <span class="nv">i</span> : index,
  vstate (IM i)
  ‚Üí list
      (vtransition_item (IM i) *
       vstate (IM i))</span></span></span><br><span><var>state_size</var><span class="hyp-type"><b>: </b><span><span class="kr">‚àÄ</span> <span class="nv">i</span> : index, vstate (IM i) ‚Üí nat</span></span></span><br><span><var>H0</var><span class="hyp-type"><b>: </b><span><span class="kr">‚àÄ</span> <span class="nv">i</span> : index,
  TraceableVLSM (IM i) 
    (state_destructor i) 
    (state_size i)</span></span></span><br><span><var>Free</var><span><span class="hyp-body"><b>:= </b><span>free_composite_vlsm IM</span></span><span class="hyp-type"><b>: </b><span>VLSM message</span></span></span></span><br><span><var>RFree</var><span><span class="hyp-body"><b>:= </b><span>pre_loaded_with_all_messages_vlsm Free</span></span><span class="hyp-type"><b>: </b><span>VLSM message</span></span></span></span><br><span><var>P</var><span class="hyp-type"><b>: </b><span>composite_state IM ‚Üí <span class="kt">Prop</span></span></span></span><br><span><var>choose</var><span class="hyp-type"><b>: </b><span>choice_function</span></span></span><br><span><var>s'</var><span class="hyp-type"><b>: </b><span>composite_state IM</span></span></span><br><span><var>Hs'</var><span class="hyp-type"><b>: </b><span>valid_state_prop RFree s&#39;</span></span></span><br><span><var>idx</var><span class="hyp-type"><b>: </b><span>index</span></span></span><br><span><var>indices</var><span class="hyp-type"><b>: </b><span>list index</span></span></span><br><span><var>j</var><span class="hyp-type"><b>: </b><span>index</span></span></span><br><span><var>nj</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>s</var><span class="hyp-type"><b>: </b><span>composite_state IM</span></span></span><br><span><var>item0</var><span class="hyp-type"><b>: </b><span>composite_transition_item IM</span></span></span><br><span><var>Hdestruct</var><span class="hyp-type"><b>: </b><span>composite_state_destructor s&#39; j !! nj =
Some (item0, s)</span></span></span><br><span><var>Hchoice</var><span class="hyp-type"><b>: </b><span>choose s&#39; Hs&#39; (idx :: indices) = (j, nj)</span></span></span><br><span><var>is</var><span class="hyp-type"><b>: </b><span>composite_state IM</span></span></span><br><span><var>pre</var><span class="hyp-type"><b>: </b><span>list (composite_transition_item IM)</span></span></span><br><span><var>Hind</var><span class="hyp-type"><b>: </b><span>choosing_well choose
‚Üí chosen_transition_preserves_P P choose
  ‚Üí not_in_indices_initial_prop s
      (idx :: indices)
    ‚Üí NoDup (idx :: indices)
      ‚Üí <span class="kr">‚àÄ</span> (<span class="nv">is0</span> : composite_state IM) 
          (<span class="nv">tr</span> : list
                  (composite_transition_item IM)),
          (<span class="kr">is</span>, pre) = (is0, tr)
          ‚Üí <span class="kr">‚àÄ</span> (<span class="nv">pre</span>
               <span class="nv">suf</span> : list
                      (composite_transition_item
                      IM)) 
              (<span class="nv">item</span> : composite_transition_item
                      IM),
              tr = pre ++ item :: suf
              ‚Üí P (finite_trace_last is0 pre)
                ‚Üí P (destination item)</span></span></span><br><span><var>Heq</var><span class="hyp-type"><b>: </b><span>indexed_composite_state_to_trace choose s
  (indexed_composite_state_to_trace_obligations_obligation_1
     s&#39; Hs&#39; (j, nj) item0 s Hdestruct)
  (idx :: indices) = (<span class="kr">is</span>, pre)</span></span></span><br><span><var>Hwell</var><span class="hyp-type"><b>: </b><span>choosing_well choose</span></span></span><br><span><var>HchooseP</var><span class="hyp-type"><b>: </b><span>chosen_transition_preserves_P P choose</span></span></span><br><span><var>Hinitial</var><span class="hyp-type"><b>: </b><span>not_in_indices_initial_prop s&#39;
  (idx :: indices)</span></span></span><br><span><var>Hnodup</var><span class="hyp-type"><b>: </b><span>NoDup (idx :: indices)</span></span></span><br><span><var>Hinitials</var><span class="hyp-type"><b>: </b><span>not_in_indices_initial_prop s
  (idx :: indices)</span></span></span><br><span><var>Heqv</var><span class="hyp-type"><b>: </b><span>P s</span></span></span><br><span><var>n</var><span class="hyp-type"><b>: </b><span>j ‚àâ idx :: indices</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">j ‚àà idx :: indices</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="TraceableVLSM-v-chk11b" style="display: none" type="checkbox"><label class="alectryon-input" for="TraceableVLSM-v-chk11b"><span class="nb">eapply</span> Hinitial, composite_tv_state_destructor_initial <span class="kr">in</span> n; [| <span class="bp">done</span>].</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>message, index</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>EqDecision0</var><span class="hyp-type"><b>: </b><span>EqDecision index</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>finite.Finite index</span></span></span><br><span><var>IM</var><span class="hyp-type"><b>: </b><span>index ‚Üí VLSM message</span></span></span><br><span><var>state_destructor</var><span class="hyp-type"><b>: </b><span><span class="kr">‚àÄ</span> <span class="nv">i</span> : index,
  vstate (IM i)
  ‚Üí list
      (vtransition_item (IM i) *
       vstate (IM i))</span></span></span><br><span><var>state_size</var><span class="hyp-type"><b>: </b><span><span class="kr">‚àÄ</span> <span class="nv">i</span> : index, vstate (IM i) ‚Üí nat</span></span></span><br><span><var>H0</var><span class="hyp-type"><b>: </b><span><span class="kr">‚àÄ</span> <span class="nv">i</span> : index,
  TraceableVLSM (IM i) 
    (state_destructor i) 
    (state_size i)</span></span></span><br><span><var>Free</var><span><span class="hyp-body"><b>:= </b><span>free_composite_vlsm IM</span></span><span class="hyp-type"><b>: </b><span>VLSM message</span></span></span></span><br><span><var>RFree</var><span><span class="hyp-body"><b>:= </b><span>pre_loaded_with_all_messages_vlsm Free</span></span><span class="hyp-type"><b>: </b><span>VLSM message</span></span></span></span><br><span><var>P</var><span class="hyp-type"><b>: </b><span>composite_state IM ‚Üí <span class="kt">Prop</span></span></span></span><br><span><var>choose</var><span class="hyp-type"><b>: </b><span>choice_function</span></span></span><br><span><var>s'</var><span class="hyp-type"><b>: </b><span>composite_state IM</span></span></span><br><span><var>Hs'</var><span class="hyp-type"><b>: </b><span>valid_state_prop RFree s&#39;</span></span></span><br><span><var>idx</var><span class="hyp-type"><b>: </b><span>index</span></span></span><br><span><var>indices</var><span class="hyp-type"><b>: </b><span>list index</span></span></span><br><span><var>j</var><span class="hyp-type"><b>: </b><span>index</span></span></span><br><span><var>nj</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>s</var><span class="hyp-type"><b>: </b><span>composite_state IM</span></span></span><br><span><var>item0</var><span class="hyp-type"><b>: </b><span>composite_transition_item IM</span></span></span><br><span><var>Hdestruct</var><span class="hyp-type"><b>: </b><span>composite_state_destructor s&#39; j !! nj =
Some (item0, s)</span></span></span><br><span><var>Hchoice</var><span class="hyp-type"><b>: </b><span>choose s&#39; Hs&#39; (idx :: indices) = (j, nj)</span></span></span><br><span><var>is</var><span class="hyp-type"><b>: </b><span>composite_state IM</span></span></span><br><span><var>pre</var><span class="hyp-type"><b>: </b><span>list (composite_transition_item IM)</span></span></span><br><span><var>Hind</var><span class="hyp-type"><b>: </b><span>choosing_well choose
‚Üí chosen_transition_preserves_P P choose
  ‚Üí not_in_indices_initial_prop s
      (idx :: indices)
    ‚Üí NoDup (idx :: indices)
      ‚Üí <span class="kr">‚àÄ</span> (<span class="nv">is0</span> : composite_state IM) 
          (<span class="nv">tr</span> : list
                  (composite_transition_item IM)),
          (<span class="kr">is</span>, pre) = (is0, tr)
          ‚Üí <span class="kr">‚àÄ</span> (<span class="nv">pre</span>
               <span class="nv">suf</span> : list
                      (composite_transition_item
                      IM)) 
              (<span class="nv">item</span> : composite_transition_item
                      IM),
              tr = pre ++ item :: suf
              ‚Üí P (finite_trace_last is0 pre)
                ‚Üí P (destination item)</span></span></span><br><span><var>Heq</var><span class="hyp-type"><b>: </b><span>indexed_composite_state_to_trace choose s
  (indexed_composite_state_to_trace_obligations_obligation_1
     s&#39; Hs&#39; (j, nj) item0 s Hdestruct)
  (idx :: indices) = (<span class="kr">is</span>, pre)</span></span></span><br><span><var>Hwell</var><span class="hyp-type"><b>: </b><span>choosing_well choose</span></span></span><br><span><var>HchooseP</var><span class="hyp-type"><b>: </b><span>chosen_transition_preserves_P P choose</span></span></span><br><span><var>Hinitial</var><span class="hyp-type"><b>: </b><span>not_in_indices_initial_prop s&#39;
  (idx :: indices)</span></span></span><br><span><var>Hnodup</var><span class="hyp-type"><b>: </b><span>NoDup (idx :: indices)</span></span></span><br><span><var>Hinitials</var><span class="hyp-type"><b>: </b><span>not_in_indices_initial_prop s
  (idx :: indices)</span></span></span><br><span><var>Heqv</var><span class="hyp-type"><b>: </b><span>P s</span></span></span><br><span><var>n</var><span class="hyp-type"><b>: </b><span>composite_state_destructor s&#39; j = []</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">j ‚àà idx :: indices</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><span class="alectryon-input"><span class="bp">by</span> <span class="nb">clear</span> -Hdestruct n; <span class="nb">rewrite</span> n <span class="kr">in</span> Hdestruct.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="TraceableVLSM-v-chk11c" style="display: none" type="checkbox"><label class="alectryon-input" for="TraceableVLSM-v-chk11c">-</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>message, index</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>EqDecision0</var><span class="hyp-type"><b>: </b><span>EqDecision index</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>finite.Finite index</span></span></span><br><span><var>IM</var><span class="hyp-type"><b>: </b><span>index ‚Üí VLSM message</span></span></span><br><span><var>state_destructor</var><span class="hyp-type"><b>: </b><span><span class="kr">‚àÄ</span> <span class="nv">i</span> : index,
  vstate (IM i)
  ‚Üí list
      (vtransition_item (IM i) *
       vstate (IM i))</span></span></span><br><span><var>state_size</var><span class="hyp-type"><b>: </b><span><span class="kr">‚àÄ</span> <span class="nv">i</span> : index, vstate (IM i) ‚Üí nat</span></span></span><br><span><var>H0</var><span class="hyp-type"><b>: </b><span><span class="kr">‚àÄ</span> <span class="nv">i</span> : index,
  TraceableVLSM (IM i) 
    (state_destructor i) 
    (state_size i)</span></span></span><br><span><var>Free</var><span><span class="hyp-body"><b>:= </b><span>free_composite_vlsm IM</span></span><span class="hyp-type"><b>: </b><span>VLSM message</span></span></span></span><br><span><var>RFree</var><span><span class="hyp-body"><b>:= </b><span>pre_loaded_with_all_messages_vlsm Free</span></span><span class="hyp-type"><b>: </b><span>VLSM message</span></span></span></span><br><span><var>P</var><span class="hyp-type"><b>: </b><span>composite_state IM ‚Üí <span class="kt">Prop</span></span></span></span><br><span><var>choose</var><span class="hyp-type"><b>: </b><span>choice_function</span></span></span><br><span><var>s'</var><span class="hyp-type"><b>: </b><span>composite_state IM</span></span></span><br><span><var>Hs'</var><span class="hyp-type"><b>: </b><span>valid_state_prop RFree s&#39;</span></span></span><br><span><var>idx</var><span class="hyp-type"><b>: </b><span>index</span></span></span><br><span><var>indices</var><span class="hyp-type"><b>: </b><span>list index</span></span></span><br><span><var>j</var><span class="hyp-type"><b>: </b><span>index</span></span></span><br><span><var>nj</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="kr">‚àÄ</span> (<span class="nv">n</span> : j ‚àâ idx :: indices) (<span class="nv">Hni</span> : decide
                                    (j
                                     ‚àà idx :: indices) =
                                  <span class="nb">right</span> n) (<span class="nv">Hdestruct</span> : 
                                            composite_state_destructor
                                              s&#39; j
                                            !! nj =
                                            None) 
  (<span class="nv">Hchoice</span> : choose s&#39; Hs&#39; (idx :: indices) = (j, nj)),
  inspect (decide (j ‚àà idx :: indices)) =
  <span class="nb">right</span> n ‚Üæ Hni
  ‚Üí inspect (composite_state_destructor s&#39; j !! nj) =
    None ‚Üæ Hdestruct
    ‚Üí inspect (choose s&#39; Hs&#39; (idx :: indices)) =
      (j, nj) ‚Üæ Hchoice
      ‚Üí choosing_well choose
        ‚Üí chosen_transition_preserves_P P choose
          ‚Üí not_in_indices_initial_prop s&#39;
              (idx :: indices)
            ‚Üí NoDup (idx :: indices)
              ‚Üí <span class="kr">‚àÄ</span> (<span class="nv">is</span> : composite_state IM) (<span class="nv">tr</span> : 
                                             list
                                               (composite_transition_item
                                                 IM)),
                  (s&#39;, []) = (<span class="kr">is</span>, tr)
                  ‚Üí <span class="kr">‚àÄ</span> (<span class="nv">pre</span>
                       <span class="nv">suf</span> : list
                               (composite_transition_item
                                  IM)) (<span class="nv">item</span> : composite_transition_item
                                                 IM),
                      tr = pre ++ item :: suf
                      ‚Üí P (finite_trace_last <span class="kr">is</span> pre)
                        ‚Üí P (destination item)</div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="bp">by</span> <span class="nb">intros</span>; <span class="nb">inversion</span> Heqis_tr; <span class="nb">subst</span>; <span class="nb">destruct</span> pre.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="TraceableVLSM-v-chk11d" style="display: none" type="checkbox"><label class="alectryon-input" for="TraceableVLSM-v-chk11d">-</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>message, index</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>EqDecision0</var><span class="hyp-type"><b>: </b><span>EqDecision index</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>finite.Finite index</span></span></span><br><span><var>IM</var><span class="hyp-type"><b>: </b><span>index ‚Üí VLSM message</span></span></span><br><span><var>state_destructor</var><span class="hyp-type"><b>: </b><span><span class="kr">‚àÄ</span> <span class="nv">i</span> : index,
  vstate (IM i)
  ‚Üí list
      (vtransition_item (IM i) *
       vstate (IM i))</span></span></span><br><span><var>state_size</var><span class="hyp-type"><b>: </b><span><span class="kr">‚àÄ</span> <span class="nv">i</span> : index, vstate (IM i) ‚Üí nat</span></span></span><br><span><var>H0</var><span class="hyp-type"><b>: </b><span><span class="kr">‚àÄ</span> <span class="nv">i</span> : index,
  TraceableVLSM (IM i) 
    (state_destructor i) 
    (state_size i)</span></span></span><br><span><var>Free</var><span><span class="hyp-body"><b>:= </b><span>free_composite_vlsm IM</span></span><span class="hyp-type"><b>: </b><span>VLSM message</span></span></span></span><br><span><var>RFree</var><span><span class="hyp-body"><b>:= </b><span>pre_loaded_with_all_messages_vlsm Free</span></span><span class="hyp-type"><b>: </b><span>VLSM message</span></span></span></span><br><span><var>P</var><span class="hyp-type"><b>: </b><span>composite_state IM ‚Üí <span class="kt">Prop</span></span></span></span><br><span><var>choose</var><span class="hyp-type"><b>: </b><span>choice_function</span></span></span><br><span><var>s'</var><span class="hyp-type"><b>: </b><span>composite_state IM</span></span></span><br><span><var>Hs'</var><span class="hyp-type"><b>: </b><span>valid_state_prop RFree s&#39;</span></span></span><br><span><var>idx</var><span class="hyp-type"><b>: </b><span>index</span></span></span><br><span><var>indices</var><span class="hyp-type"><b>: </b><span>list index</span></span></span><br><span><var>j</var><span class="hyp-type"><b>: </b><span>index</span></span></span><br><span><var>nj</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="kr">‚àÄ</span> (<span class="nv">e1</span> : composite_state_destructor s&#39; j = []) (<span class="nv">Hnn</span> : 
                                               decide
                                                 (composite_state_destructor
                                                 s&#39; j =
                                                 []) =
                                               <span class="nb">left</span> e1) 
  (<span class="nv">e0</span> : j ‚àà idx :: indices) (<span class="nv">Hi</span> : decide
                                    (j
                                     ‚àà idx :: indices) =
                                  <span class="nb">left</span> e0) (<span class="nv">Hdestruct</span> : 
                                            composite_state_destructor
                                              s&#39; j
                                            !! nj =
                                            None) 
  (<span class="nv">Hchoice</span> : choose s&#39; Hs&#39; (idx :: indices) = (j, nj)),
  (choosing_well choose
   ‚Üí chosen_transition_preserves_P P choose
     ‚Üí not_in_indices_initial_prop s&#39;
         (<span class="kr">if</span> decide (j = idx)
          <span class="kr">then</span> indices
          <span class="kr">else</span>
           idx :: StdppListSet.set_remove j indices)
       ‚Üí NoDup
           (<span class="kr">if</span> decide (j = idx)
            <span class="kr">then</span> indices
            <span class="kr">else</span>
             idx :: StdppListSet.set_remove j indices)
         ‚Üí <span class="kr">‚àÄ</span> (<span class="nv">is</span> : composite_state IM) (<span class="nv">tr</span> : list
                                               (composite_transition_item
                                                 IM)),
             indexed_composite_state_to_trace choose
               s&#39; Hs&#39;
               (<span class="kr">if</span> decide (j = idx)
                <span class="kr">then</span> indices
                <span class="kr">else</span>
                 idx
                 :: StdppListSet.set_remove j indices) =
             (<span class="kr">is</span>, tr)
             ‚Üí <span class="kr">‚àÄ</span> (<span class="nv">pre</span>
                  <span class="nv">suf</span> : list
                          (composite_transition_item
                             IM)) (<span class="nv">item</span> : composite_transition_item
                                            IM),
                 tr = pre ++ item :: suf
                 ‚Üí P (finite_trace_last <span class="kr">is</span> pre)
                   ‚Üí P (destination item))
  ‚Üí inspect
      (decide (composite_state_destructor s&#39; j = [])) =
    <span class="nb">left</span> e1 ‚Üæ Hnn
    ‚Üí inspect (decide (j ‚àà idx :: indices)) =
      <span class="nb">left</span> e0 ‚Üæ Hi
      ‚Üí inspect
          (composite_state_destructor s&#39; j !! nj) =
        None ‚Üæ Hdestruct
        ‚Üí inspect (choose s&#39; Hs&#39; (idx :: indices)) =
          (j, nj) ‚Üæ Hchoice
          ‚Üí choosing_well choose
            ‚Üí chosen_transition_preserves_P P choose
              ‚Üí not_in_indices_initial_prop s&#39;
                  (idx :: indices)
                ‚Üí NoDup (idx :: indices)
                  ‚Üí <span class="kr">‚àÄ</span> (<span class="nv">is</span> : composite_state IM) (<span class="nv">tr</span> : 
                                                 list
                                                 (composite_transition_item
                                                 IM)),
                      indexed_composite_state_to_trace
                        choose s&#39; Hs&#39;
                        (<span class="kr">if</span> decide (j = idx)
                         <span class="kr">then</span> indices
                         <span class="kr">else</span>
                          idx
                          :: StdppListSet.set_remove j
                               indices) = (<span class="kr">is</span>, tr)
                      ‚Üí <span class="kr">‚àÄ</span> (<span class="nv">pre</span>
                           <span class="nv">suf</span> : list
                                   (composite_transition_item
                                      IM)) (<span class="nv">item</span> : 
                                            composite_transition_item
                                              IM),
                          tr = pre ++ item :: suf
                          ‚Üí P
                              (finite_trace_last <span class="kr">is</span>
                                 pre)
                            ‚Üí P (destination item)</div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="TraceableVLSM-v-chk11e" style="display: none" type="checkbox"><label class="alectryon-input" for="TraceableVLSM-v-chk11e"><span class="nb">intros</span> Hdestruct _ Hj _ _ -&gt; Hind _ _ _ _ **.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>message, index</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>EqDecision0</var><span class="hyp-type"><b>: </b><span>EqDecision index</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>finite.Finite index</span></span></span><br><span><var>IM</var><span class="hyp-type"><b>: </b><span>index ‚Üí VLSM message</span></span></span><br><span><var>state_destructor</var><span class="hyp-type"><b>: </b><span><span class="kr">‚àÄ</span> <span class="nv">i</span> : index,
  vstate (IM i)
  ‚Üí list
      (vtransition_item (IM i) *
       vstate (IM i))</span></span></span><br><span><var>state_size</var><span class="hyp-type"><b>: </b><span><span class="kr">‚àÄ</span> <span class="nv">i</span> : index, vstate (IM i) ‚Üí nat</span></span></span><br><span><var>H0</var><span class="hyp-type"><b>: </b><span><span class="kr">‚àÄ</span> <span class="nv">i</span> : index,
  TraceableVLSM (IM i) 
    (state_destructor i) 
    (state_size i)</span></span></span><br><span><var>Free</var><span><span class="hyp-body"><b>:= </b><span>free_composite_vlsm IM</span></span><span class="hyp-type"><b>: </b><span>VLSM message</span></span></span></span><br><span><var>RFree</var><span><span class="hyp-body"><b>:= </b><span>pre_loaded_with_all_messages_vlsm Free</span></span><span class="hyp-type"><b>: </b><span>VLSM message</span></span></span></span><br><span><var>P</var><span class="hyp-type"><b>: </b><span>composite_state IM ‚Üí <span class="kt">Prop</span></span></span></span><br><span><var>choose</var><span class="hyp-type"><b>: </b><span>choice_function</span></span></span><br><span><var>s'</var><span class="hyp-type"><b>: </b><span>composite_state IM</span></span></span><br><span><var>Hs'</var><span class="hyp-type"><b>: </b><span>valid_state_prop RFree s&#39;</span></span></span><br><span><var>idx</var><span class="hyp-type"><b>: </b><span>index</span></span></span><br><span><var>indices</var><span class="hyp-type"><b>: </b><span>list index</span></span></span><br><span><var>j</var><span class="hyp-type"><b>: </b><span>index</span></span></span><br><span><var>nj</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>Hdestruct</var><span class="hyp-type"><b>: </b><span>composite_state_destructor s&#39; j = []</span></span></span><br><span><var>Hj</var><span class="hyp-type"><b>: </b><span>j ‚àà idx :: indices</span></span></span><br><span><var>Hind</var><span class="hyp-type"><b>: </b><span>choosing_well choose
‚Üí chosen_transition_preserves_P P choose
  ‚Üí not_in_indices_initial_prop s&#39;
      (<span class="kr">if</span> decide (j = idx)
       <span class="kr">then</span> indices
       <span class="kr">else</span>
        idx
        :: StdppListSet.set_remove j indices)
    ‚Üí NoDup
        (<span class="kr">if</span> decide (j = idx)
         <span class="kr">then</span> indices
         <span class="kr">else</span>
          idx
          :: StdppListSet.set_remove j indices)
      ‚Üí <span class="kr">‚àÄ</span> (<span class="nv">is</span> : composite_state IM) 
          (<span class="nv">tr</span> : list
                  (composite_transition_item IM)),
          indexed_composite_state_to_trace
            choose s&#39; Hs&#39;
            (<span class="kr">if</span> decide (j = idx)
             <span class="kr">then</span> indices
             <span class="kr">else</span>
              idx
              :: StdppListSet.set_remove j
                   indices) = 
          (<span class="kr">is</span>, tr)
          ‚Üí <span class="kr">‚àÄ</span> (<span class="nv">pre</span>
               <span class="nv">suf</span> : list
                      (composite_transition_item
                      IM)) 
              (<span class="nv">item</span> : composite_transition_item
                      IM),
              tr = pre ++ item :: suf
              ‚Üí P (finite_trace_last <span class="kr">is</span> pre)
                ‚Üí P (destination item)</span></span></span><br><span><var>Hwell</var><span class="hyp-type"><b>: </b><span>choosing_well choose</span></span></span><br><span><var>HchooseP</var><span class="hyp-type"><b>: </b><span>chosen_transition_preserves_P P choose</span></span></span><br><span><var>Hinitial</var><span class="hyp-type"><b>: </b><span>not_in_indices_initial_prop s&#39;
  (idx :: indices)</span></span></span><br><span><var>Hnodup</var><span class="hyp-type"><b>: </b><span>NoDup (idx :: indices)</span></span></span><br><span><var>is</var><span class="hyp-type"><b>: </b><span>composite_state IM</span></span></span><br><span><var>tr</var><span class="hyp-type"><b>: </b><span>list (composite_transition_item IM)</span></span></span><br><span><var>Heqis_tr</var><span class="hyp-type"><b>: </b><span>indexed_composite_state_to_trace choose s&#39;
  Hs&#39;
  (<span class="kr">if</span> decide (j = idx)
   <span class="kr">then</span> indices
   <span class="kr">else</span>
    idx
    :: StdppListSet.set_remove j indices) =
(<span class="kr">is</span>, tr)</span></span></span><br><span><var>pre, suf</var><span class="hyp-type"><b>: </b><span>list (composite_transition_item IM)</span></span></span><br><span><var>item</var><span class="hyp-type"><b>: </b><span>composite_transition_item IM</span></span></span><br><span><var>Heqtr</var><span class="hyp-type"><b>: </b><span>tr = pre ++ item :: suf</span></span></span><br><span><var>Heqv</var><span class="hyp-type"><b>: </b><span>P (finite_trace_last <span class="kr">is</span> pre)</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">P (destination item)</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="TraceableVLSM-v-chk11f" style="display: none" type="checkbox"><label class="alectryon-input" for="TraceableVLSM-v-chk11f"><span class="nb">eapply</span> set_remove_preserves_not_in_indices_initial <span class="kr">in</span> Hinitial; [| <span class="bp">done</span>..].</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>message, index</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>EqDecision0</var><span class="hyp-type"><b>: </b><span>EqDecision index</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>finite.Finite index</span></span></span><br><span><var>IM</var><span class="hyp-type"><b>: </b><span>index ‚Üí VLSM message</span></span></span><br><span><var>state_destructor</var><span class="hyp-type"><b>: </b><span><span class="kr">‚àÄ</span> <span class="nv">i</span> : index,
  vstate (IM i)
  ‚Üí list
      (vtransition_item (IM i) *
       vstate (IM i))</span></span></span><br><span><var>state_size</var><span class="hyp-type"><b>: </b><span><span class="kr">‚àÄ</span> <span class="nv">i</span> : index, vstate (IM i) ‚Üí nat</span></span></span><br><span><var>H0</var><span class="hyp-type"><b>: </b><span><span class="kr">‚àÄ</span> <span class="nv">i</span> : index,
  TraceableVLSM (IM i) 
    (state_destructor i) 
    (state_size i)</span></span></span><br><span><var>Free</var><span><span class="hyp-body"><b>:= </b><span>free_composite_vlsm IM</span></span><span class="hyp-type"><b>: </b><span>VLSM message</span></span></span></span><br><span><var>RFree</var><span><span class="hyp-body"><b>:= </b><span>pre_loaded_with_all_messages_vlsm Free</span></span><span class="hyp-type"><b>: </b><span>VLSM message</span></span></span></span><br><span><var>P</var><span class="hyp-type"><b>: </b><span>composite_state IM ‚Üí <span class="kt">Prop</span></span></span></span><br><span><var>choose</var><span class="hyp-type"><b>: </b><span>choice_function</span></span></span><br><span><var>s'</var><span class="hyp-type"><b>: </b><span>composite_state IM</span></span></span><br><span><var>Hs'</var><span class="hyp-type"><b>: </b><span>valid_state_prop RFree s&#39;</span></span></span><br><span><var>idx</var><span class="hyp-type"><b>: </b><span>index</span></span></span><br><span><var>indices</var><span class="hyp-type"><b>: </b><span>list index</span></span></span><br><span><var>j</var><span class="hyp-type"><b>: </b><span>index</span></span></span><br><span><var>nj</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>Hdestruct</var><span class="hyp-type"><b>: </b><span>composite_state_destructor s&#39; j = []</span></span></span><br><span><var>Hj</var><span class="hyp-type"><b>: </b><span>j ‚àà idx :: indices</span></span></span><br><span><var>Hind</var><span class="hyp-type"><b>: </b><span>choosing_well choose
‚Üí chosen_transition_preserves_P P choose
  ‚Üí not_in_indices_initial_prop s&#39;
      (<span class="kr">if</span> decide (j = idx)
       <span class="kr">then</span> indices
       <span class="kr">else</span>
        idx
        :: StdppListSet.set_remove j indices)
    ‚Üí NoDup
        (<span class="kr">if</span> decide (j = idx)
         <span class="kr">then</span> indices
         <span class="kr">else</span>
          idx
          :: StdppListSet.set_remove j indices)
      ‚Üí <span class="kr">‚àÄ</span> (<span class="nv">is</span> : composite_state IM) 
          (<span class="nv">tr</span> : list
                  (composite_transition_item IM)),
          indexed_composite_state_to_trace
            choose s&#39; Hs&#39;
            (<span class="kr">if</span> decide (j = idx)
             <span class="kr">then</span> indices
             <span class="kr">else</span>
              idx
              :: StdppListSet.set_remove j
                   indices) = 
          (<span class="kr">is</span>, tr)
          ‚Üí <span class="kr">‚àÄ</span> (<span class="nv">pre</span>
               <span class="nv">suf</span> : list
                      (composite_transition_item
                      IM)) 
              (<span class="nv">item</span> : composite_transition_item
                      IM),
              tr = pre ++ item :: suf
              ‚Üí P (finite_trace_last <span class="kr">is</span> pre)
                ‚Üí P (destination item)</span></span></span><br><span><var>Hwell</var><span class="hyp-type"><b>: </b><span>choosing_well choose</span></span></span><br><span><var>HchooseP</var><span class="hyp-type"><b>: </b><span>chosen_transition_preserves_P P choose</span></span></span><br><span><var>Hnodup</var><span class="hyp-type"><b>: </b><span>NoDup (idx :: indices)</span></span></span><br><span><var>is</var><span class="hyp-type"><b>: </b><span>composite_state IM</span></span></span><br><span><var>tr</var><span class="hyp-type"><b>: </b><span>list (composite_transition_item IM)</span></span></span><br><span><var>Heqis_tr</var><span class="hyp-type"><b>: </b><span>indexed_composite_state_to_trace choose s&#39;
  Hs&#39;
  (<span class="kr">if</span> decide (j = idx)
   <span class="kr">then</span> indices
   <span class="kr">else</span>
    idx
    :: StdppListSet.set_remove j indices) =
(<span class="kr">is</span>, tr)</span></span></span><br><span><var>pre, suf</var><span class="hyp-type"><b>: </b><span>list (composite_transition_item IM)</span></span></span><br><span><var>item</var><span class="hyp-type"><b>: </b><span>composite_transition_item IM</span></span></span><br><span><var>Heqtr</var><span class="hyp-type"><b>: </b><span>tr = pre ++ item :: suf</span></span></span><br><span><var>Heqv</var><span class="hyp-type"><b>: </b><span>P (finite_trace_last <span class="kr">is</span> pre)</span></span></span><br><span><var>Hinitial</var><span class="hyp-type"><b>: </b><span>not_in_indices_initial_prop s&#39;
  (StdppListSet.set_remove j
     (idx :: indices))</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">P (destination item)</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="TraceableVLSM-v-chk120" style="display: none" type="checkbox"><label class="alectryon-input" for="TraceableVLSM-v-chk120"><span class="nb">eapply</span> StdppListSet.set_remove_nodup <span class="kr">with</span> (a := j) <span class="kr">in</span> Hnodup.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>message, index</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>EqDecision0</var><span class="hyp-type"><b>: </b><span>EqDecision index</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>finite.Finite index</span></span></span><br><span><var>IM</var><span class="hyp-type"><b>: </b><span>index ‚Üí VLSM message</span></span></span><br><span><var>state_destructor</var><span class="hyp-type"><b>: </b><span><span class="kr">‚àÄ</span> <span class="nv">i</span> : index,
  vstate (IM i)
  ‚Üí list
      (vtransition_item (IM i) *
       vstate (IM i))</span></span></span><br><span><var>state_size</var><span class="hyp-type"><b>: </b><span><span class="kr">‚àÄ</span> <span class="nv">i</span> : index, vstate (IM i) ‚Üí nat</span></span></span><br><span><var>H0</var><span class="hyp-type"><b>: </b><span><span class="kr">‚àÄ</span> <span class="nv">i</span> : index,
  TraceableVLSM (IM i) 
    (state_destructor i) 
    (state_size i)</span></span></span><br><span><var>Free</var><span><span class="hyp-body"><b>:= </b><span>free_composite_vlsm IM</span></span><span class="hyp-type"><b>: </b><span>VLSM message</span></span></span></span><br><span><var>RFree</var><span><span class="hyp-body"><b>:= </b><span>pre_loaded_with_all_messages_vlsm Free</span></span><span class="hyp-type"><b>: </b><span>VLSM message</span></span></span></span><br><span><var>P</var><span class="hyp-type"><b>: </b><span>composite_state IM ‚Üí <span class="kt">Prop</span></span></span></span><br><span><var>choose</var><span class="hyp-type"><b>: </b><span>choice_function</span></span></span><br><span><var>s'</var><span class="hyp-type"><b>: </b><span>composite_state IM</span></span></span><br><span><var>Hs'</var><span class="hyp-type"><b>: </b><span>valid_state_prop RFree s&#39;</span></span></span><br><span><var>idx</var><span class="hyp-type"><b>: </b><span>index</span></span></span><br><span><var>indices</var><span class="hyp-type"><b>: </b><span>list index</span></span></span><br><span><var>j</var><span class="hyp-type"><b>: </b><span>index</span></span></span><br><span><var>nj</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>Hdestruct</var><span class="hyp-type"><b>: </b><span>composite_state_destructor s&#39; j = []</span></span></span><br><span><var>Hj</var><span class="hyp-type"><b>: </b><span>j ‚àà idx :: indices</span></span></span><br><span><var>Hind</var><span class="hyp-type"><b>: </b><span>choosing_well choose
‚Üí chosen_transition_preserves_P P choose
  ‚Üí not_in_indices_initial_prop s&#39;
      (<span class="kr">if</span> decide (j = idx)
       <span class="kr">then</span> indices
       <span class="kr">else</span>
        idx
        :: StdppListSet.set_remove j indices)
    ‚Üí NoDup
        (<span class="kr">if</span> decide (j = idx)
         <span class="kr">then</span> indices
         <span class="kr">else</span>
          idx
          :: StdppListSet.set_remove j indices)
      ‚Üí <span class="kr">‚àÄ</span> (<span class="nv">is</span> : composite_state IM) 
          (<span class="nv">tr</span> : list
                  (composite_transition_item IM)),
          indexed_composite_state_to_trace
            choose s&#39; Hs&#39;
            (<span class="kr">if</span> decide (j = idx)
             <span class="kr">then</span> indices
             <span class="kr">else</span>
              idx
              :: StdppListSet.set_remove j
                   indices) = 
          (<span class="kr">is</span>, tr)
          ‚Üí <span class="kr">‚àÄ</span> (<span class="nv">pre</span>
               <span class="nv">suf</span> : list
                      (composite_transition_item
                      IM)) 
              (<span class="nv">item</span> : composite_transition_item
                      IM),
              tr = pre ++ item :: suf
              ‚Üí P (finite_trace_last <span class="kr">is</span> pre)
                ‚Üí P (destination item)</span></span></span><br><span><var>Hwell</var><span class="hyp-type"><b>: </b><span>choosing_well choose</span></span></span><br><span><var>HchooseP</var><span class="hyp-type"><b>: </b><span>chosen_transition_preserves_P P choose</span></span></span><br><span><var>Hnodup</var><span class="hyp-type"><b>: </b><span>NoDup
  (StdppListSet.set_remove j (idx :: indices))</span></span></span><br><span><var>is</var><span class="hyp-type"><b>: </b><span>composite_state IM</span></span></span><br><span><var>tr</var><span class="hyp-type"><b>: </b><span>list (composite_transition_item IM)</span></span></span><br><span><var>Heqis_tr</var><span class="hyp-type"><b>: </b><span>indexed_composite_state_to_trace choose s&#39;
  Hs&#39;
  (<span class="kr">if</span> decide (j = idx)
   <span class="kr">then</span> indices
   <span class="kr">else</span>
    idx
    :: StdppListSet.set_remove j indices) =
(<span class="kr">is</span>, tr)</span></span></span><br><span><var>pre, suf</var><span class="hyp-type"><b>: </b><span>list (composite_transition_item IM)</span></span></span><br><span><var>item</var><span class="hyp-type"><b>: </b><span>composite_transition_item IM</span></span></span><br><span><var>Heqtr</var><span class="hyp-type"><b>: </b><span>tr = pre ++ item :: suf</span></span></span><br><span><var>Heqv</var><span class="hyp-type"><b>: </b><span>P (finite_trace_last <span class="kr">is</span> pre)</span></span></span><br><span><var>Hinitial</var><span class="hyp-type"><b>: </b><span>not_in_indices_initial_prop s&#39;
  (StdppListSet.set_remove j
     (idx :: indices))</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">P (destination item)</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><span class="alectryon-input"><span class="bp">by</span> <span class="nb">eapply</span> Hind.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="TraceableVLSM-v-chk121" style="display: none" type="checkbox"><label class="alectryon-input" for="TraceableVLSM-v-chk121">-</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>message, index</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>EqDecision0</var><span class="hyp-type"><b>: </b><span>EqDecision index</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>finite.Finite index</span></span></span><br><span><var>IM</var><span class="hyp-type"><b>: </b><span>index ‚Üí VLSM message</span></span></span><br><span><var>state_destructor</var><span class="hyp-type"><b>: </b><span><span class="kr">‚àÄ</span> <span class="nv">i</span> : index,
  vstate (IM i)
  ‚Üí list
      (vtransition_item (IM i) *
       vstate (IM i))</span></span></span><br><span><var>state_size</var><span class="hyp-type"><b>: </b><span><span class="kr">‚àÄ</span> <span class="nv">i</span> : index, vstate (IM i) ‚Üí nat</span></span></span><br><span><var>H0</var><span class="hyp-type"><b>: </b><span><span class="kr">‚àÄ</span> <span class="nv">i</span> : index,
  TraceableVLSM (IM i) 
    (state_destructor i) 
    (state_size i)</span></span></span><br><span><var>Free</var><span><span class="hyp-body"><b>:= </b><span>free_composite_vlsm IM</span></span><span class="hyp-type"><b>: </b><span>VLSM message</span></span></span></span><br><span><var>RFree</var><span><span class="hyp-body"><b>:= </b><span>pre_loaded_with_all_messages_vlsm Free</span></span><span class="hyp-type"><b>: </b><span>VLSM message</span></span></span></span><br><span><var>P</var><span class="hyp-type"><b>: </b><span>composite_state IM ‚Üí <span class="kt">Prop</span></span></span></span><br><span><var>choose</var><span class="hyp-type"><b>: </b><span>choice_function</span></span></span><br><span><var>s'</var><span class="hyp-type"><b>: </b><span>composite_state IM</span></span></span><br><span><var>Hs'</var><span class="hyp-type"><b>: </b><span>valid_state_prop RFree s&#39;</span></span></span><br><span><var>idx</var><span class="hyp-type"><b>: </b><span>index</span></span></span><br><span><var>indices</var><span class="hyp-type"><b>: </b><span>list index</span></span></span><br><span><var>j</var><span class="hyp-type"><b>: </b><span>index</span></span></span><br><span><var>nj</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="kr">‚àÄ</span> (<span class="nv">n</span> : composite_state_destructor s&#39; j ‚â† []) (<span class="nv">Hn</span> : 
                                              decide
                                                (composite_state_destructor
                                                 s&#39; j =
                                                 []) =
                                              <span class="nb">right</span> n) 
  (<span class="nv">e0</span> : j ‚àà idx :: indices) (<span class="nv">Hi</span> : decide
                                    (j
                                     ‚àà idx :: indices) =
                                  <span class="nb">left</span> e0) (<span class="nv">Hdestruct</span> : 
                                            composite_state_destructor
                                              s&#39; j
                                            !! nj =
                                            None) 
  (<span class="nv">Hchoice</span> : choose s&#39; Hs&#39; (idx :: indices) = (j, nj)),
  inspect
    (decide (composite_state_destructor s&#39; j = [])) =
  <span class="nb">right</span> n ‚Üæ Hn
  ‚Üí inspect (decide (j ‚àà idx :: indices)) =
    <span class="nb">left</span> e0 ‚Üæ Hi
    ‚Üí inspect (composite_state_destructor s&#39; j !! nj) =
      None ‚Üæ Hdestruct
      ‚Üí inspect (choose s&#39; Hs&#39; (idx :: indices)) =
        (j, nj) ‚Üæ Hchoice
        ‚Üí choosing_well choose
          ‚Üí chosen_transition_preserves_P P choose
            ‚Üí not_in_indices_initial_prop s&#39;
                (idx :: indices)
              ‚Üí NoDup (idx :: indices)
                ‚Üí <span class="kr">‚àÄ</span> (<span class="nv">is</span> : composite_state IM) (<span class="nv">tr</span> : 
                                               list
                                                 (composite_transition_item
                                                 IM)),
                    (s&#39;, []) = (<span class="kr">is</span>, tr)
                    ‚Üí <span class="kr">‚àÄ</span> (<span class="nv">pre</span>
                         <span class="nv">suf</span> : list
                                 (composite_transition_item
                                    IM)) (<span class="nv">item</span> : composite_transition_item
                                                 IM),
                        tr = pre ++ item :: suf
                        ‚Üí P (finite_trace_last <span class="kr">is</span> pre)
                          ‚Üí P (destination item)</div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="bp">by</span> <span class="nb">intros</span>; <span class="nb">inversion</span> Heqis_tr; <span class="nb">subst</span>; <span class="nb">destruct</span> pre.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Qed</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
</span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">End</span> <span class="nf">sec_traceable_vlsm_composition</span>.</span></span></pre></article></body></html>