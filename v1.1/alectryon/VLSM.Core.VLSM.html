<!DOCTYPE html>
<html class="alectryon-standalone"><head><title>VLSM.v</title><meta charset="utf-8"><meta content="Alectryon" name="generator"><meta name="viewport" content="width=device-width, initial-scale=1"><link href="alectryon.css" rel="stylesheet"><link href="pygments.css" rel="stylesheet">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/IBM-type/0.5.4/css/ibm-type.min.css" integrity="sha512-sky5cf9Ts6FY1kstGOBHSybfKqdHR41M0Ldb0BjNiv3ifltoQIsg0zIaQ+wwdwgQ0w9vKFW7Js50lxH9vqNSSw==" crossorigin="anonymous" />
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/firacode/5.2.0/fira_code.min.css" integrity="sha512-MbysAYimH1hH2xYzkkMHB6MqxBqfP0megxsCLknbYqHVwXTCg9IqHbk+ZP/vnhO8UEW6PaXAkKe2vQ+SWACxxA==" crossorigin="anonymous" /><script src="alectryon.js"></script></head><body><article class="alectryon-root alectryon-windowed alectryon-coqdoc"><div class="alectryon-banner">Built with <a href="https://github.com/cpitclaudel/alectryon/">Alectryon</a>, running Coq+SerAPI v8.13.0+0.13.0. Bubbles (<span class="alectryon-bubble"></span>) indicate interactive fragments: hover for details, tap to reveal contents. Use <kbd>Ctrl+‚Üë</kbd> <kbd>Ctrl+‚Üì</kbd> to navigate, <kbd>Ctrl+üñ±Ô∏è</kbd> to focus. On Mac, use <kbd>‚åò</kbd> instead of <kbd>Ctrl</kbd>.</div><pre class="alectryon-io highlight"><!-- Generator: Alectryon --><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">From</span> stdpp <span class="kn">Require Import</span> prelude.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">From</span> Coq <span class="kn">Require Import</span> Streams.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">From</span> VLSM.Lib <span class="kn">Require Import</span> Preamble ListExtras StreamExtras.</span></span></pre><div class="doc">
<a id="lab1"></a><h1 class="section">VLSM Basics</h1>
<div class="paragraph"> </div>

This module provides basic VLSM infrastructure.

</div><pre class="alectryon-io highlight"><!-- Generator: Alectryon --></pre><div class="doc">
<a id="lab2"></a><h2 class="section">VLSM definition</h2>
<div class="paragraph"> </div>
<a id="lab3"></a><h3 class="section">The type of a VLSM</h3>
<div class="paragraph"> </div>

The type of a VLSM is a triple consisting of the underlying types of
messages, states, and labels.

<div class="paragraph"> </div>

In Coq it is defined as a Class taking <code>message</code> as parameter and having
<span class="inlinecode"><span class="id" title="var">state</span></span> and <span class="inlinecode"><span class="id" title="var">label</span></span> as fields.  <code>message</code> is a parameter to allow it to be
easily shared by multiple VLSMs during composition.

</div><pre class="alectryon-io highlight"><!-- Generator: Alectryon --><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Class</span> <span class="nf">VLSMType</span> (<span class="nv">message</span> : <span class="kt">Type</span>) :=
  { state : <span class="kt">Type</span>
  ; label : <span class="kt">Type</span>
  }.</span></span></pre><div class="doc">
<a id="lab4"></a><h3 class="section">VLSM class definition</h3>
<div class="paragraph"> </div>

The <span class="inlinecode"><span class="id" title="var">VLSMMachine</span></span> class is parameterized by a <span class="inlinecode"><span class="id" title="var">VLSMType</span></span>, and contains the
remaining parameters to define a VLSM over the given types.
These are the properties for initial states (<span class="inlinecode"><span class="id" title="var">initial_state_prop</span></span>)
and initial messages (<span class="inlinecode"><span class="id" title="var">initial_message_prop</span></span>),
from which we can immediately define the dependent
types <span class="inlinecode"><span class="id" title="var">initial_state</span></span> (as <span class="inlinecode"><span class="id" title="var">state</span></span>s having the <span class="inlinecode"><span class="id" title="var">initial_state_prop</span></span>erty) and
<span class="inlinecode"><span class="id" title="var">intial_message</span></span> (as <code>message</code>s having the <span class="inlinecode"><span class="id" title="var">initial_message_prop</span></span>erty),
a witness <span class="inlinecode"><span class="id" title="var">s0</span></span> to nonemptiness of the <span class="inlinecode"><span class="id" title="var">initial_state</span></span> set,
and the <span class="inlinecode"><span class="id" title="var">transition</span></span> function and <span class="inlinecode"><span class="id" title="var">valid</span></span> predicate.

</div><pre class="alectryon-io highlight"><!-- Generator: Alectryon --><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Class</span> <span class="nf">VLSMMachine</span> {<span class="nv">message</span> : <span class="kt">Type</span>} (<span class="nv">vtype</span> : VLSMType message) :=
  { initial_state_prop : state -&gt; <span class="kt">Prop</span>
  ; initial_state := { s : state | initial_state_prop s }
  ; initial_message_prop : message -&gt; <span class="kt">Prop</span>
  ; initial_message := { m : message | initial_message_prop m }
  ; s0 : Inhabited initial_state
  ; transition : label -&gt; state * option message -&gt; state * option message
  ; valid : label -&gt; state * option message -&gt; <span class="kt">Prop</span>
  }.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
</span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Definition</span> <span class="nf">option_initial_message_prop</span>
  {<span class="nv">message</span> : <span class="kt">Type</span>} {<span class="nv">vtype</span> : VLSMType message} {<span class="nv">vmachine</span> : VLSMMachine vtype}
  : option message -&gt; <span class="kt">Prop</span> := from_option initial_message_prop <span class="kt">True</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
</span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Definition</span> <span class="nf">VLSMMachine_pre_loaded_with_messages</span>
  {<span class="nv">message</span> : <span class="kt">Type</span>} {<span class="nv">vtype</span> : VLSMType message} (<span class="nv">vmachine</span> : VLSMMachine vtype)
  (<span class="nv">initial</span> : message -&gt; <span class="kt">Prop</span>)
  : VLSMMachine vtype
  :=
  {| initial_state_prop := @initial_state_prop _ _ vmachine
  ; initial_message_prop := <span class="kr">fun</span> <span class="nv">m</span> =&gt; @initial_message_prop _ _ vmachine  m \/ initial m
  ; s0 := @s0 _ _ vmachine
  ; transition := @transition _ _ vmachine
  ; valid := @valid _ _ vmachine
  |}.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
</span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Definition</span> <span class="nf">decidable_initial_messages_prop</span>
  {<span class="nv">message</span> : <span class="kt">Type</span>} {<span class="nv">vtype</span> : VLSMType message} (<span class="nv">vmachine</span> : VLSMMachine vtype)
  := <span class="kr">forall</span> <span class="nv">m</span>, Decision (initial_message_prop m).</span></span></pre><div class="doc">
<a id="lab5"></a><h3 class="section">VLSM type definition</h3>
<div class="paragraph"> </div>

For technical reasons, e.g., the need to easily talk about VLSMs over
the same set of messages and about VLSMs of the same type (over the same
set of messages, labels and states), the VLSM definition is split into
two parts, <span class="inlinecode"><span class="id" title="var">VLSMType</span></span> and <span class="inlinecode"><span class="id" title="var">VLSMMachine</span></span>, which are
packaged together by the following definition.

</div><pre class="alectryon-io highlight"><!-- Generator: Alectryon --><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Record</span> <span class="nf">VLSM</span> (<span class="nv">message</span> : <span class="kt">Type</span>) : <span class="kt">Type</span> :=
  mk_vlsm { vtype : VLSMType message; vmachine : VLSMMachine vtype }.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Arguments</span> vtype [message] v.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Arguments</span> vmachine [message] v.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Arguments</span> mk_vlsm [message] [vtype] vmachine.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
</span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Definition</span> <span class="nf">pre_loaded_vlsm</span>
  {<span class="nv">message</span> : <span class="kt">Type</span>}
  (<span class="nv">X</span> : VLSM message)
  (<span class="nv">initial</span> : message -&gt; <span class="kt">Prop</span>)
  : VLSM message
  :=
  {| vmachine := VLSMMachine_pre_loaded_with_messages (vmachine X) initial |}.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
</span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Section</span> <span class="nf">Traces</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
</span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Context</span>
    {<span class="nv">message</span> : <span class="kt">Type</span>}
    {<span class="nv">T</span> : VLSMType message}
    .</span></span></pre><div class="doc">
<a id="lab6"></a><h2 class="section">Traces</h2>
<div class="paragraph"> </div>

We introduce the concept of a trace to formalize an execution of the protocol.
It is abstracted as a pair <code>(start, steps)</code> where <code>start</code> is a state
and <code>steps</code> is a tuple of objects which fully describe the transitions
underwent during execution. Notably, <code>steps</code> might be infinite.

<div class="paragraph"> </div>

In Coq, we can define these objects (which we name <span class="inlinecode"><span class="id" title="var">transition_item</span></span>s) as consisting of:
<ul class="doclist">
<li> the <span class="inlinecode"><span class="id" title="var">label</span></span> <span class="inlinecode"><span class="id" title="var">l</span></span>
</li>
<li> the (optional) <span class="inlinecode"><span class="id" title="var">input</span></span> <code>message</code>
</li>
<li> the <span class="inlinecode"><span class="id" title="var">destination</span></span> <span class="inlinecode"><span class="id" title="var">state</span></span> of the transition

</li>
<li> the (optional) <span class="inlinecode"><span class="id" title="var">output</span></span> <code>message</code> generated by the transition

</li>
</ul>
</div><pre class="alectryon-io highlight"><!-- Generator: Alectryon --><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Record</span> <span class="nf">transition_item</span> :=
    {   l : label
        ;   input : option message
        ;   destination : state
        ;   output : option message
    }.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
</span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Definition</span> <span class="nf">field_selector</span>
               (<span class="nv">field</span>: transition_item -&gt; option message) :
      (message -&gt; transition_item -&gt; <span class="kt">Prop</span>) :=
      <span class="kr">fun</span> <span class="nv">m</span> <span class="nv">item</span> =&gt; <span class="bp">field</span> item = Some m.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
</span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Definition</span> <span class="nf">item_sends_or_receives</span>:
      message -&gt; transition_item -&gt; <span class="kt">Prop</span> :=
      <span class="kr">fun</span> <span class="nv">m</span> <span class="nv">item</span> =&gt; input item = Some m \/ output item = Some m.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
</span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Definition</span> <span class="nf">trace_has_message</span>
      (<span class="nv">message_selector</span> : message -&gt; transition_item -&gt; <span class="kt">Prop</span>)
      (<span class="nv">msg</span> : message)
      (<span class="nv">tr</span> : list transition_item)
      : <span class="kt">Prop</span>
      := List.Exists (message_selector msg) tr.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
</span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="VLSM-v-chk0" style="display: none" type="checkbox"><label class="alectryon-input" for="VLSM-v-chk0"><span class="kn">Lemma</span> <span class="nf">trace_has_message_prefix</span>
      (<span class="nv">message_selector</span> : message -&gt; transition_item -&gt; <span class="kt">Prop</span>)
      (<span class="nv">msg</span> : message)
      (<span class="nv">prefix</span> <span class="nv">suffix</span> : list transition_item)
      : trace_has_message message_selector msg prefix -&gt;
        trace_has_message message_selector msg (prefix ++ suffix).</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>message</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>T</var><span class="hyp-type"><b>: </b><span>VLSMType message</span></span></span><br><span><var>message_selector</var><span class="hyp-type"><b>: </b><span>message ‚Üí transition_item ‚Üí <span class="kt">Prop</span></span></span></span><br><span><var>msg</var><span class="hyp-type"><b>: </b><span>message</span></span></span><br><span><var>prefix, suffix</var><span class="hyp-type"><b>: </b><span>list transition_item</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">trace_has_message message_selector msg prefix
‚Üí trace_has_message message_selector msg
    (prefix ++ suffix)</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="VLSM-v-chk1" style="display: none" type="checkbox"><label class="alectryon-input" for="VLSM-v-chk1"><span class="kn">Proof</span>.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>message</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>T</var><span class="hyp-type"><b>: </b><span>VLSMType message</span></span></span><br><span><var>message_selector</var><span class="hyp-type"><b>: </b><span>message ‚Üí transition_item ‚Üí <span class="kt">Prop</span></span></span></span><br><span><var>msg</var><span class="hyp-type"><b>: </b><span>message</span></span></span><br><span><var>prefix, suffix</var><span class="hyp-type"><b>: </b><span>list transition_item</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">trace_has_message message_selector msg prefix
‚Üí trace_has_message message_selector msg
    (prefix ++ suffix)</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">      </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="VLSM-v-chk2" style="display: none" type="checkbox"><label class="alectryon-input" for="VLSM-v-chk2"><span class="nb">intro</span> Hprefix.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>message</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>T</var><span class="hyp-type"><b>: </b><span>VLSMType message</span></span></span><br><span><var>message_selector</var><span class="hyp-type"><b>: </b><span>message ‚Üí transition_item ‚Üí <span class="kt">Prop</span></span></span></span><br><span><var>msg</var><span class="hyp-type"><b>: </b><span>message</span></span></span><br><span><var>prefix, suffix</var><span class="hyp-type"><b>: </b><span>list transition_item</span></span></span><br><span><var>Hprefix</var><span class="hyp-type"><b>: </b><span>trace_has_message message_selector msg
  prefix</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">trace_has_message message_selector msg
  (prefix ++ suffix)</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">      </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="VLSM-v-chk3" style="display: none" type="checkbox"><label class="alectryon-input" for="VLSM-v-chk3"><span class="nb">apply</span> Exists_app.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>message</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>T</var><span class="hyp-type"><b>: </b><span>VLSMType message</span></span></span><br><span><var>message_selector</var><span class="hyp-type"><b>: </b><span>message ‚Üí transition_item ‚Üí <span class="kt">Prop</span></span></span></span><br><span><var>msg</var><span class="hyp-type"><b>: </b><span>message</span></span></span><br><span><var>prefix, suffix</var><span class="hyp-type"><b>: </b><span>list transition_item</span></span></span><br><span><var>Hprefix</var><span class="hyp-type"><b>: </b><span>trace_has_message message_selector msg
  prefix</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">List.Exists (message_selector msg) prefix
‚à® List.Exists (message_selector msg) suffix</div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="VLSM-v-chk4" style="display: none" type="checkbox"><label class="alectryon-input" for="VLSM-v-chk4"><span class="nb">left</span>.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>message</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>T</var><span class="hyp-type"><b>: </b><span>VLSMType message</span></span></span><br><span><var>message_selector</var><span class="hyp-type"><b>: </b><span>message ‚Üí transition_item ‚Üí <span class="kt">Prop</span></span></span></span><br><span><var>msg</var><span class="hyp-type"><b>: </b><span>message</span></span></span><br><span><var>prefix, suffix</var><span class="hyp-type"><b>: </b><span>list transition_item</span></span></span><br><span><var>Hprefix</var><span class="hyp-type"><b>: </b><span>trace_has_message message_selector msg
  prefix</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">List.Exists (message_selector msg) prefix</div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="bp">assumption</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Qed</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
</span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="VLSM-v-chk5" style="display: none" type="checkbox"><label class="alectryon-input" for="VLSM-v-chk5"><span class="kn">Lemma</span> <span class="nf">trace_has_message_observed_iff</span> <span class="nv">m</span> <span class="nv">tr</span>
      (<span class="nv">Hobserved</span> : trace_has_message item_sends_or_receives m tr)
      : trace_has_message (field_selector input) m tr \/ trace_has_message (field_selector output) m tr.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>message</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>T</var><span class="hyp-type"><b>: </b><span>VLSMType message</span></span></span><br><span><var>m</var><span class="hyp-type"><b>: </b><span>message</span></span></span><br><span><var>tr</var><span class="hyp-type"><b>: </b><span>list transition_item</span></span></span><br><span><var>Hobserved</var><span class="hyp-type"><b>: </b><span>trace_has_message item_sends_or_receives m
  tr</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">trace_has_message (field_selector input) m tr
‚à® trace_has_message (field_selector output) m tr</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="VLSM-v-chk6" style="display: none" type="checkbox"><label class="alectryon-input" for="VLSM-v-chk6"><span class="kn">Proof</span>.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>message</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>T</var><span class="hyp-type"><b>: </b><span>VLSMType message</span></span></span><br><span><var>m</var><span class="hyp-type"><b>: </b><span>message</span></span></span><br><span><var>tr</var><span class="hyp-type"><b>: </b><span>list transition_item</span></span></span><br><span><var>Hobserved</var><span class="hyp-type"><b>: </b><span>trace_has_message item_sends_or_receives m
  tr</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">trace_has_message (field_selector input) m tr
‚à® trace_has_message (field_selector output) m tr</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">      </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="VLSM-v-chk7" style="display: none" type="checkbox"><label class="alectryon-input" for="VLSM-v-chk7"><span class="nb">unfold</span> trace_has_message <span class="kr">in</span> *.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>message</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>T</var><span class="hyp-type"><b>: </b><span>VLSMType message</span></span></span><br><span><var>m</var><span class="hyp-type"><b>: </b><span>message</span></span></span><br><span><var>tr</var><span class="hyp-type"><b>: </b><span>list transition_item</span></span></span><br><span><var>Hobserved</var><span class="hyp-type"><b>: </b><span>List.Exists (item_sends_or_receives m) tr</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">List.Exists (field_selector input m) tr
‚à® List.Exists (field_selector output m) tr</div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="VLSM-v-chk8" style="display: none" type="checkbox"><label class="alectryon-input" for="VLSM-v-chk8"><span class="nb">rewrite</span> !Exists_exists <span class="kr">in</span> *.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>message</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>T</var><span class="hyp-type"><b>: </b><span>VLSMType message</span></span></span><br><span><var>m</var><span class="hyp-type"><b>: </b><span>message</span></span></span><br><span><var>tr</var><span class="hyp-type"><b>: </b><span>list transition_item</span></span></span><br><span><var>Hobserved</var><span class="hyp-type"><b>: </b><span><span class="kr">‚àÉ</span> <span class="nv">x</span> : transition_item,
  x ‚àà tr ‚àß item_sends_or_receives m x</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">(<span class="kr">‚àÉ</span> <span class="nv">x</span> : transition_item,
   x ‚àà tr ‚àß field_selector input m x)
‚à® (<span class="kr">‚àÉ</span> <span class="nv">x</span> : transition_item,
     x ‚àà tr ‚àß field_selector output m x)</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">      </span><span class="alectryon-sentence"><span class="alectryon-input"><span class="nb">destruct</span> Hobserved <span class="kr">as</span> [item [Hitem [Hm|Hm]]]
      ; [<span class="nb">left</span>|<span class="nb">right</span>]; <span class="kr">exists</span> <span class="nv">item</span>; <span class="nb">split</span>; <span class="bp">assumption</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Qed</span>.</span></span></pre><div class="doc">
Defines a message received but not sent by within the trace. 
</div><pre class="alectryon-io highlight"><!-- Generator: Alectryon --><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Definition</span> <span class="nf">trace_received_not_sent_before_or_after</span>
      (<span class="nv">tr</span> : list transition_item)
      (<span class="nv">m</span> : message)
      : <span class="kt">Prop</span>
      := trace_has_message (field_selector input) m tr /\
         ~trace_has_message (field_selector output) m tr.</span></span></pre><div class="doc">
States that a property holds for all messages received but not sent by a trace. 
</div><pre class="alectryon-io highlight"><!-- Generator: Alectryon --><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Definition</span> <span class="nf">trace_received_not_sent_before_or_after_invariant</span>
      (<span class="nv">tr</span> : list transition_item)
      (<span class="nv">P</span> : message -&gt; <span class="kt">Prop</span>)
      : <span class="kt">Prop</span>
      := <span class="kr">forall</span> <span class="nv">m</span>, trace_received_not_sent_before_or_after tr m -&gt; P m.</span></span></pre><div class="doc">
<span class="inlinecode"><span class="id" title="var">proto_run</span></span> is used for an alternative definition of <span class="inlinecode"><span class="id" title="var">valid_state_message_prop</span></span>, which
  takes into account transitions. See 'vlsm_run_prop'.
  
</div><pre class="alectryon-io highlight"><!-- Generator: Alectryon --><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Record</span> <span class="nf">proto_run</span> : <span class="kt">Type</span> := mk_proto_run
    { start : state
      ; transitions : list transition_item
      ; final : state * option message
    }.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
</span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Inductive</span> <span class="nf">Trace</span> : <span class="kt">Type</span> :=
  | Finite : state -&gt; list transition_item -&gt; Trace
  | Infinite : state -&gt; Stream transition_item -&gt; Trace.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
</span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Definition</span> <span class="nf">trace_first</span> (<span class="nv">tr</span> : Trace) : state :=
    <span class="kr">match</span> tr <span class="kr">with</span>
    | Finite s _ =&gt; s
    | Infinite s _ =&gt; s
    <span class="kr">end</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
</span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Definition</span> <span class="nf">finite_trace_last</span>
    (<span class="nv">si</span> : state) (<span class="nv">tr</span> : list transition_item) : state :=
    List.<span class="nb">last</span> (List.map destination tr) si.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
</span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Definition</span> <span class="nf">finite_trace_last_output</span>
    (<span class="nv">tr</span> : list transition_item) : option message :=
    List.<span class="nb">last</span> (List.map output tr) None.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
</span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Definition</span> <span class="nf">finite_trace_nth</span>
    (<span class="nv">si</span> : state) (<span class="nv">tr</span> : list transition_item)
    : nat -&gt; option state :=
  nth_error (si :: List.map destination tr).</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
</span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Definition</span> <span class="nf">trace_last</span> (<span class="nv">tr</span> : Trace) : option state
    :=
      <span class="kr">match</span> tr <span class="kr">with</span>
      | Finite s ls =&gt; Some (finite_trace_last s ls)
      | Infinite _ _ =&gt; None
      <span class="kr">end</span>.</span></span></pre><div class="doc">
Next function extract the nth state of a trace, where the sequence of
states of a trace is obtained by appending the all destination
states in the transition list/stream to the initial state of the trace.

</div><pre class="alectryon-io highlight"><!-- Generator: Alectryon --><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Definition</span> <span class="nf">trace_nth</span> (<span class="nv">tr</span> : Trace)
    : nat -&gt; option state :=
    <span class="kr">fun</span> (<span class="nv">n</span> : nat) =&gt;
      <span class="kr">match</span> tr <span class="kr">with</span>
      | Finite s ls =&gt; finite_trace_nth s ls n
      | Infinite s st =&gt; Some (Str_nth n (Cons s (Streams.map destination st)))
      <span class="kr">end</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
</span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">End</span> <span class="nf">Traces</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
</span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Arguments</span> transition_item {message} {T} , {message} T.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Arguments</span> field_selector {_} {T} _ msg item / .</span><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Arguments</span> item_sends_or_receives {_} {_} msg item /.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
</span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Section</span> <span class="nf">TraceLemmas</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
</span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Context</span>
    [message : <span class="kt">Type</span>]
    [T : VLSMType message]
    .</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
</span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="VLSM-v-chk9" style="display: none" type="checkbox"><label class="alectryon-input" for="VLSM-v-chk9"><span class="kn">Lemma</span> <span class="nf">last_error_destination_last</span>
    (<span class="nv">tr</span> : list transition_item)
    (<span class="nv">s</span> : state)
    (<span class="nv">Hlast</span> : option_map destination (last_error tr) = Some s)
    (<span class="nv">default</span> : state)
    : finite_trace_last default tr  = s.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>message</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>T</var><span class="hyp-type"><b>: </b><span>VLSMType message</span></span></span><br><span><var>tr</var><span class="hyp-type"><b>: </b><span>list transition_item</span></span></span><br><span><var>s</var><span class="hyp-type"><b>: </b><span>state</span></span></span><br><span><var>Hlast</var><span class="hyp-type"><b>: </b><span>option_map destination (last_error tr) =
Some s</span></span></span><br><span><var>default</var><span class="hyp-type"><b>: </b><span>state</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">finite_trace_last default tr = s</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="VLSM-v-chka" style="display: none" type="checkbox"><label class="alectryon-input" for="VLSM-v-chka"><span class="kn">Proof</span>.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>message</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>T</var><span class="hyp-type"><b>: </b><span>VLSMType message</span></span></span><br><span><var>tr</var><span class="hyp-type"><b>: </b><span>list transition_item</span></span></span><br><span><var>s</var><span class="hyp-type"><b>: </b><span>state</span></span></span><br><span><var>Hlast</var><span class="hyp-type"><b>: </b><span>option_map destination (last_error tr) =
Some s</span></span></span><br><span><var>default</var><span class="hyp-type"><b>: </b><span>state</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">finite_trace_last default tr = s</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="VLSM-v-chkb" style="display: none" type="checkbox"><label class="alectryon-input" for="VLSM-v-chkb"><span class="nb">unfold</span> option_map <span class="kr">in</span> Hlast.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>message</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>T</var><span class="hyp-type"><b>: </b><span>VLSMType message</span></span></span><br><span><var>tr</var><span class="hyp-type"><b>: </b><span>list transition_item</span></span></span><br><span><var>s</var><span class="hyp-type"><b>: </b><span>state</span></span></span><br><span><var>Hlast</var><span class="hyp-type"><b>: </b><span><span class="kr">match</span> last_error tr <span class="kr">with</span>
| Some a =&gt; Some (destination a)
| None =&gt; None
<span class="kr">end</span> = Some s</span></span></span><br><span><var>default</var><span class="hyp-type"><b>: </b><span>state</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">finite_trace_last default tr = s</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="VLSM-v-chkc" style="display: none" type="checkbox"><label class="alectryon-input" for="VLSM-v-chkc"><span class="nb">destruct</span> (last_error tr) <span class="nb">eqn</span> : eq; <span class="kp">try</span> <span class="bp">discriminate</span> Hlast.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>message</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>T</var><span class="hyp-type"><b>: </b><span>VLSMType message</span></span></span><br><span><var>tr</var><span class="hyp-type"><b>: </b><span>list transition_item</span></span></span><br><span><var>s</var><span class="hyp-type"><b>: </b><span>state</span></span></span><br><span><var>t</var><span class="hyp-type"><b>: </b><span>transition_item</span></span></span><br><span><var>eq</var><span class="hyp-type"><b>: </b><span>last_error tr = Some t</span></span></span><br><span><var>Hlast</var><span class="hyp-type"><b>: </b><span>Some (destination t) = Some s</span></span></span><br><span><var>default</var><span class="hyp-type"><b>: </b><span>state</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">finite_trace_last default tr = s</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="VLSM-v-chkd" style="display: none" type="checkbox"><label class="alectryon-input" for="VLSM-v-chkd"><span class="nb">inversion</span> Hlast.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>message</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>T</var><span class="hyp-type"><b>: </b><span>VLSMType message</span></span></span><br><span><var>tr</var><span class="hyp-type"><b>: </b><span>list transition_item</span></span></span><br><span><var>s</var><span class="hyp-type"><b>: </b><span>state</span></span></span><br><span><var>t</var><span class="hyp-type"><b>: </b><span>transition_item</span></span></span><br><span><var>eq</var><span class="hyp-type"><b>: </b><span>last_error tr = Some t</span></span></span><br><span><var>Hlast</var><span class="hyp-type"><b>: </b><span>Some (destination t) = Some s</span></span></span><br><span><var>default</var><span class="hyp-type"><b>: </b><span>state</span></span></span><br><span><var>H0</var><span class="hyp-type"><b>: </b><span>destination t = s</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">finite_trace_last default tr = destination t</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="VLSM-v-chke" style="display: none" type="checkbox"><label class="alectryon-input" for="VLSM-v-chke"><span class="nb">unfold</span> last_error <span class="kr">in</span> eq.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>message</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>T</var><span class="hyp-type"><b>: </b><span>VLSMType message</span></span></span><br><span><var>tr</var><span class="hyp-type"><b>: </b><span>list transition_item</span></span></span><br><span><var>s</var><span class="hyp-type"><b>: </b><span>state</span></span></span><br><span><var>t</var><span class="hyp-type"><b>: </b><span>transition_item</span></span></span><br><span><var>eq</var><span class="hyp-type"><b>: </b><span><span class="kr">match</span> tr <span class="kr">with</span>
| [] =&gt; None
| a :: t =&gt; Some (List.<span class="nb">last</span> t a)
<span class="kr">end</span> = Some t</span></span></span><br><span><var>Hlast</var><span class="hyp-type"><b>: </b><span>Some (destination t) = Some s</span></span></span><br><span><var>default</var><span class="hyp-type"><b>: </b><span>state</span></span></span><br><span><var>H0</var><span class="hyp-type"><b>: </b><span>destination t = s</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">finite_trace_last default tr = destination t</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="VLSM-v-chkf" style="display: none" type="checkbox"><label class="alectryon-input" for="VLSM-v-chkf"><span class="nb">destruct</span> tr; <span class="kp">try</span> <span class="bp">discriminate</span> eq.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>message</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>T</var><span class="hyp-type"><b>: </b><span>VLSMType message</span></span></span><br><span><var>t0</var><span class="hyp-type"><b>: </b><span>transition_item</span></span></span><br><span><var>tr</var><span class="hyp-type"><b>: </b><span>list transition_item</span></span></span><br><span><var>s</var><span class="hyp-type"><b>: </b><span>state</span></span></span><br><span><var>t</var><span class="hyp-type"><b>: </b><span>transition_item</span></span></span><br><span><var>eq</var><span class="hyp-type"><b>: </b><span>Some (List.<span class="nb">last</span> tr t0) = Some t</span></span></span><br><span><var>Hlast</var><span class="hyp-type"><b>: </b><span>Some (destination t) = Some s</span></span></span><br><span><var>default</var><span class="hyp-type"><b>: </b><span>state</span></span></span><br><span><var>H0</var><span class="hyp-type"><b>: </b><span>destination t = s</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">finite_trace_last default (t0 :: tr) = destination t</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="VLSM-v-chk10" style="display: none" type="checkbox"><label class="alectryon-input" for="VLSM-v-chk10"><span class="nb">inversion</span> eq.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>message</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>T</var><span class="hyp-type"><b>: </b><span>VLSMType message</span></span></span><br><span><var>t0</var><span class="hyp-type"><b>: </b><span>transition_item</span></span></span><br><span><var>tr</var><span class="hyp-type"><b>: </b><span>list transition_item</span></span></span><br><span><var>s</var><span class="hyp-type"><b>: </b><span>state</span></span></span><br><span><var>t</var><span class="hyp-type"><b>: </b><span>transition_item</span></span></span><br><span><var>eq</var><span class="hyp-type"><b>: </b><span>Some (List.<span class="nb">last</span> tr t0) = Some t</span></span></span><br><span><var>Hlast</var><span class="hyp-type"><b>: </b><span>Some (destination t) = Some s</span></span></span><br><span><var>default</var><span class="hyp-type"><b>: </b><span>state</span></span></span><br><span><var>H0</var><span class="hyp-type"><b>: </b><span>destination t = s</span></span></span><br><span><var>H1</var><span class="hyp-type"><b>: </b><span>List.<span class="nb">last</span> tr t0 = t</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">finite_trace_last default (t0 :: tr) =
destination (List.<span class="nb">last</span> tr t0)</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="VLSM-v-chk11" style="display: none" type="checkbox"><label class="alectryon-input" for="VLSM-v-chk11"><span class="nb">unfold</span> finite_trace_last.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>message</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>T</var><span class="hyp-type"><b>: </b><span>VLSMType message</span></span></span><br><span><var>t0</var><span class="hyp-type"><b>: </b><span>transition_item</span></span></span><br><span><var>tr</var><span class="hyp-type"><b>: </b><span>list transition_item</span></span></span><br><span><var>s</var><span class="hyp-type"><b>: </b><span>state</span></span></span><br><span><var>t</var><span class="hyp-type"><b>: </b><span>transition_item</span></span></span><br><span><var>eq</var><span class="hyp-type"><b>: </b><span>Some (List.<span class="nb">last</span> tr t0) = Some t</span></span></span><br><span><var>Hlast</var><span class="hyp-type"><b>: </b><span>Some (destination t) = Some s</span></span></span><br><span><var>default</var><span class="hyp-type"><b>: </b><span>state</span></span></span><br><span><var>H0</var><span class="hyp-type"><b>: </b><span>destination t = s</span></span></span><br><span><var>H1</var><span class="hyp-type"><b>: </b><span>List.<span class="nb">last</span> tr t0 = t</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">List.<span class="nb">last</span> (List.map destination (t0 :: tr)) default =
destination (List.<span class="nb">last</span> tr t0)</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="VLSM-v-chk12" style="display: none" type="checkbox"><label class="alectryon-input" for="VLSM-v-chk12"><span class="nb">rewrite</span> last_map.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>message</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>T</var><span class="hyp-type"><b>: </b><span>VLSMType message</span></span></span><br><span><var>t0</var><span class="hyp-type"><b>: </b><span>transition_item</span></span></span><br><span><var>tr</var><span class="hyp-type"><b>: </b><span>list transition_item</span></span></span><br><span><var>s</var><span class="hyp-type"><b>: </b><span>state</span></span></span><br><span><var>t</var><span class="hyp-type"><b>: </b><span>transition_item</span></span></span><br><span><var>eq</var><span class="hyp-type"><b>: </b><span>Some (List.<span class="nb">last</span> tr t0) = Some t</span></span></span><br><span><var>Hlast</var><span class="hyp-type"><b>: </b><span>Some (destination t) = Some s</span></span></span><br><span><var>default</var><span class="hyp-type"><b>: </b><span>state</span></span></span><br><span><var>H0</var><span class="hyp-type"><b>: </b><span>destination t = s</span></span></span><br><span><var>H1</var><span class="hyp-type"><b>: </b><span>List.<span class="nb">last</span> tr t0 = t</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">destination (List.<span class="nb">last</span> tr t0) =
destination (List.<span class="nb">last</span> tr t0)</div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="bp">reflexivity</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Qed</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
</span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="VLSM-v-chk13" style="display: none" type="checkbox"><label class="alectryon-input" for="VLSM-v-chk13"><span class="kn">Lemma</span> <span class="nf">finite_trace_last_cons</span>
    <span class="nv">s</span> <span class="nv">x</span> <span class="nv">tl</span>:
    finite_trace_last s (x::tl) = finite_trace_last (destination x) tl.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>message</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>T</var><span class="hyp-type"><b>: </b><span>VLSMType message</span></span></span><br><span><var>s</var><span class="hyp-type"><b>: </b><span>state</span></span></span><br><span><var>x</var><span class="hyp-type"><b>: </b><span>transition_item</span></span></span><br><span><var>tl</var><span class="hyp-type"><b>: </b><span>list transition_item</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">finite_trace_last s (x :: tl) =
finite_trace_last (destination x) tl</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="VLSM-v-chk14" style="display: none" type="checkbox"><label class="alectryon-input" for="VLSM-v-chk14"><span class="kn">Proof</span>.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>message</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>T</var><span class="hyp-type"><b>: </b><span>VLSMType message</span></span></span><br><span><var>s</var><span class="hyp-type"><b>: </b><span>state</span></span></span><br><span><var>x</var><span class="hyp-type"><b>: </b><span>transition_item</span></span></span><br><span><var>tl</var><span class="hyp-type"><b>: </b><span>list transition_item</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">finite_trace_last s (x :: tl) =
finite_trace_last (destination x) tl</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="VLSM-v-chk15" style="display: none" type="checkbox"><label class="alectryon-input" for="VLSM-v-chk15"><span class="nb">unfold</span> finite_trace_last.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>message</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>T</var><span class="hyp-type"><b>: </b><span>VLSMType message</span></span></span><br><span><var>s</var><span class="hyp-type"><b>: </b><span>state</span></span></span><br><span><var>x</var><span class="hyp-type"><b>: </b><span>transition_item</span></span></span><br><span><var>tl</var><span class="hyp-type"><b>: </b><span>list transition_item</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">List.<span class="nb">last</span> (List.map destination (x :: tl)) s =
List.<span class="nb">last</span> (List.map destination tl) (destination x)</div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="VLSM-v-chk16" style="display: none" type="checkbox"><label class="alectryon-input" for="VLSM-v-chk16"><span class="nb">rewrite</span> map_cons, unroll_last.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>message</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>T</var><span class="hyp-type"><b>: </b><span>VLSMType message</span></span></span><br><span><var>s</var><span class="hyp-type"><b>: </b><span>state</span></span></span><br><span><var>x</var><span class="hyp-type"><b>: </b><span>transition_item</span></span></span><br><span><var>tl</var><span class="hyp-type"><b>: </b><span>list transition_item</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">List.<span class="nb">last</span> (List.map destination tl) (destination x) =
List.<span class="nb">last</span> (List.map destination tl) (destination x)</div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="bp">reflexivity</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Qed</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
</span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="VLSM-v-chk17" style="display: none" type="checkbox"><label class="alectryon-input" for="VLSM-v-chk17"><span class="kn">Lemma</span> <span class="nf">finite_trace_last_nil</span>
    <span class="nv">s</span>:
    finite_trace_last s [] = s.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>message</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>T</var><span class="hyp-type"><b>: </b><span>VLSMType message</span></span></span><br><span><var>s</var><span class="hyp-type"><b>: </b><span>state</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">finite_trace_last s [] = s</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="VLSM-v-chk18" style="display: none" type="checkbox"><label class="alectryon-input" for="VLSM-v-chk18"><span class="kn">Proof</span>.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>message</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>T</var><span class="hyp-type"><b>: </b><span>VLSMType message</span></span></span><br><span><var>s</var><span class="hyp-type"><b>: </b><span>state</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">finite_trace_last s [] = s</div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="bp">reflexivity</span>.</span><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Qed</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
</span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="VLSM-v-chk19" style="display: none" type="checkbox"><label class="alectryon-input" for="VLSM-v-chk19"><span class="kn">Lemma</span> <span class="nf">finite_trace_last_app</span>
    <span class="nv">s</span> <span class="nv">t1</span> <span class="nv">t2</span>:
    finite_trace_last s (t1 ++ t2) = finite_trace_last (finite_trace_last s t1) t2.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>message</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>T</var><span class="hyp-type"><b>: </b><span>VLSMType message</span></span></span><br><span><var>s</var><span class="hyp-type"><b>: </b><span>state</span></span></span><br><span><var>t1, t2</var><span class="hyp-type"><b>: </b><span>list transition_item</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">finite_trace_last s (t1 ++ t2) =
finite_trace_last (finite_trace_last s t1) t2</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="VLSM-v-chk1a" style="display: none" type="checkbox"><label class="alectryon-input" for="VLSM-v-chk1a"><span class="kn">Proof</span>.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>message</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>T</var><span class="hyp-type"><b>: </b><span>VLSMType message</span></span></span><br><span><var>s</var><span class="hyp-type"><b>: </b><span>state</span></span></span><br><span><var>t1, t2</var><span class="hyp-type"><b>: </b><span>list transition_item</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">finite_trace_last s (t1 ++ t2) =
finite_trace_last (finite_trace_last s t1) t2</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="VLSM-v-chk1b" style="display: none" type="checkbox"><label class="alectryon-input" for="VLSM-v-chk1b"><span class="nb">unfold</span> finite_trace_last.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>message</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>T</var><span class="hyp-type"><b>: </b><span>VLSMType message</span></span></span><br><span><var>s</var><span class="hyp-type"><b>: </b><span>state</span></span></span><br><span><var>t1, t2</var><span class="hyp-type"><b>: </b><span>list transition_item</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">List.<span class="nb">last</span> (List.map destination (t1 ++ t2)) s =
List.<span class="nb">last</span> (List.map destination t2)
  (List.<span class="nb">last</span> (List.map destination t1) s)</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="VLSM-v-chk1c" style="display: none" type="checkbox"><label class="alectryon-input" for="VLSM-v-chk1c"><span class="nb">rewrite</span> map_app, last_app.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>message</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>T</var><span class="hyp-type"><b>: </b><span>VLSMType message</span></span></span><br><span><var>s</var><span class="hyp-type"><b>: </b><span>state</span></span></span><br><span><var>t1, t2</var><span class="hyp-type"><b>: </b><span>list transition_item</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">List.<span class="nb">last</span> (List.map destination t2)
  (List.<span class="nb">last</span> (List.map destination t1) s) =
List.<span class="nb">last</span> (List.map destination t2)
  (List.<span class="nb">last</span> (List.map destination t1) s)</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><span class="alectryon-input"><span class="bp">reflexivity</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Qed</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
</span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="VLSM-v-chk1d" style="display: none" type="checkbox"><label class="alectryon-input" for="VLSM-v-chk1d"><span class="kn">Lemma</span> <span class="nf">finite_trace_last_is_last</span>
    <span class="nv">s</span> <span class="nv">x</span> <span class="nv">tl</span>:
    finite_trace_last s (tl++[x]) = destination x.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>message</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>T</var><span class="hyp-type"><b>: </b><span>VLSMType message</span></span></span><br><span><var>s</var><span class="hyp-type"><b>: </b><span>state</span></span></span><br><span><var>x</var><span class="hyp-type"><b>: </b><span>transition_item</span></span></span><br><span><var>tl</var><span class="hyp-type"><b>: </b><span>list transition_item</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">finite_trace_last s (tl ++ [x]) = destination x</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="VLSM-v-chk1e" style="display: none" type="checkbox"><label class="alectryon-input" for="VLSM-v-chk1e"><span class="kn">Proof</span>.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>message</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>T</var><span class="hyp-type"><b>: </b><span>VLSMType message</span></span></span><br><span><var>s</var><span class="hyp-type"><b>: </b><span>state</span></span></span><br><span><var>x</var><span class="hyp-type"><b>: </b><span>transition_item</span></span></span><br><span><var>tl</var><span class="hyp-type"><b>: </b><span>list transition_item</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">finite_trace_last s (tl ++ [x]) = destination x</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="VLSM-v-chk1f" style="display: none" type="checkbox"><label class="alectryon-input" for="VLSM-v-chk1f"><span class="nb">unfold</span> finite_trace_last.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>message</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>T</var><span class="hyp-type"><b>: </b><span>VLSMType message</span></span></span><br><span><var>s</var><span class="hyp-type"><b>: </b><span>state</span></span></span><br><span><var>x</var><span class="hyp-type"><b>: </b><span>transition_item</span></span></span><br><span><var>tl</var><span class="hyp-type"><b>: </b><span>list transition_item</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">List.<span class="nb">last</span> (List.map destination (tl ++ [x])) s =
destination x</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="VLSM-v-chk20" style="display: none" type="checkbox"><label class="alectryon-input" for="VLSM-v-chk20"><span class="nb">rewrite</span> map_app.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>message</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>T</var><span class="hyp-type"><b>: </b><span>VLSMType message</span></span></span><br><span><var>s</var><span class="hyp-type"><b>: </b><span>state</span></span></span><br><span><var>x</var><span class="hyp-type"><b>: </b><span>transition_item</span></span></span><br><span><var>tl</var><span class="hyp-type"><b>: </b><span>list transition_item</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">List.<span class="nb">last</span>
  (List.map destination tl ++ List.map destination [x])
  s = destination x</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="VLSM-v-chk21" style="display: none" type="checkbox"><label class="alectryon-input" for="VLSM-v-chk21"><span class="nb">simpl</span>.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>message</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>T</var><span class="hyp-type"><b>: </b><span>VLSMType message</span></span></span><br><span><var>s</var><span class="hyp-type"><b>: </b><span>state</span></span></span><br><span><var>x</var><span class="hyp-type"><b>: </b><span>transition_item</span></span></span><br><span><var>tl</var><span class="hyp-type"><b>: </b><span>list transition_item</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">List.<span class="nb">last</span> (List.map destination tl ++ [destination x])
  s = destination x</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="VLSM-v-chk22" style="display: none" type="checkbox"><label class="alectryon-input" for="VLSM-v-chk22"><span class="nb">rewrite</span> last_is_last.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>message</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>T</var><span class="hyp-type"><b>: </b><span>VLSMType message</span></span></span><br><span><var>s</var><span class="hyp-type"><b>: </b><span>state</span></span></span><br><span><var>x</var><span class="hyp-type"><b>: </b><span>transition_item</span></span></span><br><span><var>tl</var><span class="hyp-type"><b>: </b><span>list transition_item</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">destination x = destination x</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><span class="alectryon-input"><span class="bp">reflexivity</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Qed</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
</span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="VLSM-v-chk23" style="display: none" type="checkbox"><label class="alectryon-input" for="VLSM-v-chk23"><span class="kn">Lemma</span> <span class="nf">finite_trace_last_output_is_last</span>
    <span class="nv">x</span> <span class="nv">tl</span>:
    finite_trace_last_output (tl++[x]) = output x.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>message</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>T</var><span class="hyp-type"><b>: </b><span>VLSMType message</span></span></span><br><span><var>x</var><span class="hyp-type"><b>: </b><span>transition_item</span></span></span><br><span><var>tl</var><span class="hyp-type"><b>: </b><span>list transition_item</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">finite_trace_last_output (tl ++ [x]) = output x</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="VLSM-v-chk24" style="display: none" type="checkbox"><label class="alectryon-input" for="VLSM-v-chk24"><span class="kn">Proof</span>.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>message</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>T</var><span class="hyp-type"><b>: </b><span>VLSMType message</span></span></span><br><span><var>x</var><span class="hyp-type"><b>: </b><span>transition_item</span></span></span><br><span><var>tl</var><span class="hyp-type"><b>: </b><span>list transition_item</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">finite_trace_last_output (tl ++ [x]) = output x</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="VLSM-v-chk25" style="display: none" type="checkbox"><label class="alectryon-input" for="VLSM-v-chk25"><span class="nb">unfold</span> finite_trace_last_output.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>message</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>T</var><span class="hyp-type"><b>: </b><span>VLSMType message</span></span></span><br><span><var>x</var><span class="hyp-type"><b>: </b><span>transition_item</span></span></span><br><span><var>tl</var><span class="hyp-type"><b>: </b><span>list transition_item</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">List.<span class="nb">last</span> (List.map output (tl ++ [x])) None =
output x</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="VLSM-v-chk26" style="display: none" type="checkbox"><label class="alectryon-input" for="VLSM-v-chk26"><span class="nb">rewrite</span> map_app.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>message</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>T</var><span class="hyp-type"><b>: </b><span>VLSMType message</span></span></span><br><span><var>x</var><span class="hyp-type"><b>: </b><span>transition_item</span></span></span><br><span><var>tl</var><span class="hyp-type"><b>: </b><span>list transition_item</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">List.<span class="nb">last</span> (List.map output tl ++ List.map output [x])
  None = output x</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="VLSM-v-chk27" style="display: none" type="checkbox"><label class="alectryon-input" for="VLSM-v-chk27"><span class="nb">simpl</span>.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>message</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>T</var><span class="hyp-type"><b>: </b><span>VLSMType message</span></span></span><br><span><var>x</var><span class="hyp-type"><b>: </b><span>transition_item</span></span></span><br><span><var>tl</var><span class="hyp-type"><b>: </b><span>list transition_item</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">List.<span class="nb">last</span> (List.map output tl ++ [output x]) None =
output x</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="VLSM-v-chk28" style="display: none" type="checkbox"><label class="alectryon-input" for="VLSM-v-chk28"><span class="nb">rewrite</span> last_is_last.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>message</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>T</var><span class="hyp-type"><b>: </b><span>VLSMType message</span></span></span><br><span><var>x</var><span class="hyp-type"><b>: </b><span>transition_item</span></span></span><br><span><var>tl</var><span class="hyp-type"><b>: </b><span>list transition_item</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">output x = output x</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><span class="alectryon-input"><span class="bp">reflexivity</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Qed</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
</span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="VLSM-v-chk29" style="display: none" type="checkbox"><label class="alectryon-input" for="VLSM-v-chk29"><span class="kn">Lemma</span> <span class="nf">finite_trace_nth_first</span>
    (<span class="nv">si</span> : state) (<span class="nv">tr</span> : list transition_item):
    finite_trace_nth si tr <span class="mi">0</span> = Some si.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>message</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>T</var><span class="hyp-type"><b>: </b><span>VLSMType message</span></span></span><br><span><var>si</var><span class="hyp-type"><b>: </b><span>state</span></span></span><br><span><var>tr</var><span class="hyp-type"><b>: </b><span>list transition_item</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">finite_trace_nth si tr <span class="mi">0</span> = Some si</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="VLSM-v-chk2a" style="display: none" type="checkbox"><label class="alectryon-input" for="VLSM-v-chk2a"><span class="kn">Proof</span>.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>message</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>T</var><span class="hyp-type"><b>: </b><span>VLSMType message</span></span></span><br><span><var>si</var><span class="hyp-type"><b>: </b><span>state</span></span></span><br><span><var>tr</var><span class="hyp-type"><b>: </b><span>list transition_item</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">finite_trace_nth si tr <span class="mi">0</span> = Some si</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><span class="alectryon-input"><span class="bp">reflexivity</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Qed</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
</span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="VLSM-v-chk2b" style="display: none" type="checkbox"><label class="alectryon-input" for="VLSM-v-chk2b"><span class="kn">Lemma</span> <span class="nf">finite_trace_nth_last</span>
    (<span class="nv">si</span> : state) (<span class="nv">tr</span> : list transition_item):
    finite_trace_nth si tr (length tr) = Some (finite_trace_last si tr).</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>message</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>T</var><span class="hyp-type"><b>: </b><span>VLSMType message</span></span></span><br><span><var>si</var><span class="hyp-type"><b>: </b><span>state</span></span></span><br><span><var>tr</var><span class="hyp-type"><b>: </b><span>list transition_item</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">finite_trace_nth si tr (length tr) =
Some (finite_trace_last si tr)</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="VLSM-v-chk2c" style="display: none" type="checkbox"><label class="alectryon-input" for="VLSM-v-chk2c"><span class="kn">Proof</span>.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>message</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>T</var><span class="hyp-type"><b>: </b><span>VLSMType message</span></span></span><br><span><var>si</var><span class="hyp-type"><b>: </b><span>state</span></span></span><br><span><var>tr</var><span class="hyp-type"><b>: </b><span>list transition_item</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">finite_trace_nth si tr (length tr) =
Some (finite_trace_last si tr)</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="VLSM-v-chk2d" style="display: none" type="checkbox"><label class="alectryon-input" for="VLSM-v-chk2d"><span class="nb">unfold</span> finite_trace_nth, finite_trace_last.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>message</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>T</var><span class="hyp-type"><b>: </b><span>VLSMType message</span></span></span><br><span><var>si</var><span class="hyp-type"><b>: </b><span>state</span></span></span><br><span><var>tr</var><span class="hyp-type"><b>: </b><span>list transition_item</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">nth_error (si :: List.map destination tr) (length tr) =
Some (List.<span class="nb">last</span> (List.map destination tr) si)</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="VLSM-v-chk2e" style="display: none" type="checkbox"><label class="alectryon-input" for="VLSM-v-chk2e"><span class="nb">destruct</span> tr;[<span class="bp">reflexivity</span>|].</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>message</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>T</var><span class="hyp-type"><b>: </b><span>VLSMType message</span></span></span><br><span><var>si</var><span class="hyp-type"><b>: </b><span>state</span></span></span><br><span><var>t</var><span class="hyp-type"><b>: </b><span>transition_item</span></span></span><br><span><var>tr</var><span class="hyp-type"><b>: </b><span>list transition_item</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">nth_error (si :: List.map destination (t :: tr))
  (length (t :: tr)) =
Some (List.<span class="nb">last</span> (List.map destination (t :: tr)) si)</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="VLSM-v-chk2f" style="display: none" type="checkbox"><label class="alectryon-input" for="VLSM-v-chk2f"><span class="nb">cbn</span> [nth_error length].</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>message</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>T</var><span class="hyp-type"><b>: </b><span>VLSMType message</span></span></span><br><span><var>si</var><span class="hyp-type"><b>: </b><span>state</span></span></span><br><span><var>t</var><span class="hyp-type"><b>: </b><span>transition_item</span></span></span><br><span><var>tr</var><span class="hyp-type"><b>: </b><span>list transition_item</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">nth_error (List.map destination (t :: tr)) (length tr) =
Some (List.<span class="nb">last</span> (List.map destination (t :: tr)) si)</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="VLSM-v-chk30" style="display: none" type="checkbox"><label class="alectryon-input" for="VLSM-v-chk30"><span class="nb">apply</span> nth_error_last.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>message</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>T</var><span class="hyp-type"><b>: </b><span>VLSMType message</span></span></span><br><span><var>si</var><span class="hyp-type"><b>: </b><span>state</span></span></span><br><span><var>t</var><span class="hyp-type"><b>: </b><span>transition_item</span></span></span><br><span><var>tr</var><span class="hyp-type"><b>: </b><span>list transition_item</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">S (length tr) =
length (List.map destination (t :: tr))</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="VLSM-v-chk31" style="display: none" type="checkbox"><label class="alectryon-input" for="VLSM-v-chk31"><span class="nb">rewrite</span> map_length.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>message</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>T</var><span class="hyp-type"><b>: </b><span>VLSMType message</span></span></span><br><span><var>si</var><span class="hyp-type"><b>: </b><span>state</span></span></span><br><span><var>t</var><span class="hyp-type"><b>: </b><span>transition_item</span></span></span><br><span><var>tr</var><span class="hyp-type"><b>: </b><span>list transition_item</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">S (length tr) = length (t :: tr)</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><span class="alectryon-input"><span class="bp">reflexivity</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Qed</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
</span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="VLSM-v-chk32" style="display: none" type="checkbox"><label class="alectryon-input" for="VLSM-v-chk32"><span class="kn">Lemma</span> <span class="nf">finite_trace_nth_app1</span>
    (<span class="nv">si</span> : state) (<span class="nv">t1</span> <span class="nv">t2</span> : list transition_item) <span class="nv">n</span>:
    n &lt;= length t1 -&gt;
    finite_trace_nth si (t1++t2) n = finite_trace_nth si t1 n.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>message</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>T</var><span class="hyp-type"><b>: </b><span>VLSMType message</span></span></span><br><span><var>si</var><span class="hyp-type"><b>: </b><span>state</span></span></span><br><span><var>t1, t2</var><span class="hyp-type"><b>: </b><span>list transition_item</span></span></span><br><span><var>n</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">n ‚â§ length t1
‚Üí finite_trace_nth si (t1 ++ t2) n =
  finite_trace_nth si t1 n</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="VLSM-v-chk33" style="display: none" type="checkbox"><label class="alectryon-input" for="VLSM-v-chk33"><span class="kn">Proof</span>.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>message</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>T</var><span class="hyp-type"><b>: </b><span>VLSMType message</span></span></span><br><span><var>si</var><span class="hyp-type"><b>: </b><span>state</span></span></span><br><span><var>t1, t2</var><span class="hyp-type"><b>: </b><span>list transition_item</span></span></span><br><span><var>n</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">n ‚â§ length t1
‚Üí finite_trace_nth si (t1 ++ t2) n =
  finite_trace_nth si t1 n</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="VLSM-v-chk34" style="display: none" type="checkbox"><label class="alectryon-input" for="VLSM-v-chk34"><span class="nb">intro</span> H.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>message</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>T</var><span class="hyp-type"><b>: </b><span>VLSMType message</span></span></span><br><span><var>si</var><span class="hyp-type"><b>: </b><span>state</span></span></span><br><span><var>t1, t2</var><span class="hyp-type"><b>: </b><span>list transition_item</span></span></span><br><span><var>n</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>n ‚â§ length t1</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">finite_trace_nth si (t1 ++ t2) n =
finite_trace_nth si t1 n</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="VLSM-v-chk35" style="display: none" type="checkbox"><label class="alectryon-input" for="VLSM-v-chk35"><span class="nb">unfold</span> finite_trace_nth.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>message</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>T</var><span class="hyp-type"><b>: </b><span>VLSMType message</span></span></span><br><span><var>si</var><span class="hyp-type"><b>: </b><span>state</span></span></span><br><span><var>t1, t2</var><span class="hyp-type"><b>: </b><span>list transition_item</span></span></span><br><span><var>n</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>n ‚â§ length t1</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">nth_error (si :: List.map destination (t1 ++ t2)) n =
nth_error (si :: List.map destination t1) n</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="VLSM-v-chk36" style="display: none" type="checkbox"><label class="alectryon-input" for="VLSM-v-chk36"><span class="nb">rewrite</span> map_app, app_comm_cons.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>message</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>T</var><span class="hyp-type"><b>: </b><span>VLSMType message</span></span></span><br><span><var>si</var><span class="hyp-type"><b>: </b><span>state</span></span></span><br><span><var>t1, t2</var><span class="hyp-type"><b>: </b><span>list transition_item</span></span></span><br><span><var>n</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>n ‚â§ length t1</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">nth_error
  ((si :: List.map destination t1) ++
   List.map destination t2) n =
nth_error (si :: List.map destination t1) n</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="VLSM-v-chk37" style="display: none" type="checkbox"><label class="alectryon-input" for="VLSM-v-chk37"><span class="nb">apply</span> nth_error_app1.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>message</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>T</var><span class="hyp-type"><b>: </b><span>VLSMType message</span></span></span><br><span><var>si</var><span class="hyp-type"><b>: </b><span>state</span></span></span><br><span><var>t1, t2</var><span class="hyp-type"><b>: </b><span>list transition_item</span></span></span><br><span><var>n</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>n ‚â§ length t1</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">n &lt; length (si :: List.map destination t1)</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="VLSM-v-chk38" style="display: none" type="checkbox"><label class="alectryon-input" for="VLSM-v-chk38"><span class="nb">simpl</span>.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>message</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>T</var><span class="hyp-type"><b>: </b><span>VLSMType message</span></span></span><br><span><var>si</var><span class="hyp-type"><b>: </b><span>state</span></span></span><br><span><var>t1, t2</var><span class="hyp-type"><b>: </b><span>list transition_item</span></span></span><br><span><var>n</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>n ‚â§ length t1</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">n &lt; S (length (List.map destination t1))</div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="VLSM-v-chk39" style="display: none" type="checkbox"><label class="alectryon-input" for="VLSM-v-chk39"><span class="nb">rewrite</span> map_length.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>message</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>T</var><span class="hyp-type"><b>: </b><span>VLSMType message</span></span></span><br><span><var>si</var><span class="hyp-type"><b>: </b><span>state</span></span></span><br><span><var>t1, t2</var><span class="hyp-type"><b>: </b><span>list transition_item</span></span></span><br><span><var>n</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>n ‚â§ length t1</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">n &lt; S (length t1)</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><span class="alectryon-input"><span class="nb">auto with</span> arith.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Qed</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
</span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="VLSM-v-chk3a" style="display: none" type="checkbox"><label class="alectryon-input" for="VLSM-v-chk3a"><span class="kn">Lemma</span> <span class="nf">finite_trace_nth_app2</span>
    (<span class="nv">si</span> : state) (<span class="nv">t1</span> <span class="nv">t2</span> : list transition_item) <span class="nv">n</span>:
    length t1 &lt;= n -&gt;
    finite_trace_nth si (t1++t2) n = finite_trace_nth (finite_trace_last si t1) t2 (n - length t1).</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>message</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>T</var><span class="hyp-type"><b>: </b><span>VLSMType message</span></span></span><br><span><var>si</var><span class="hyp-type"><b>: </b><span>state</span></span></span><br><span><var>t1, t2</var><span class="hyp-type"><b>: </b><span>list transition_item</span></span></span><br><span><var>n</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">length t1 ‚â§ n
‚Üí finite_trace_nth si (t1 ++ t2) n =
  finite_trace_nth (finite_trace_last si t1) t2
    (n - length t1)</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="VLSM-v-chk3b" style="display: none" type="checkbox"><label class="alectryon-input" for="VLSM-v-chk3b"><span class="kn">Proof</span>.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>message</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>T</var><span class="hyp-type"><b>: </b><span>VLSMType message</span></span></span><br><span><var>si</var><span class="hyp-type"><b>: </b><span>state</span></span></span><br><span><var>t1, t2</var><span class="hyp-type"><b>: </b><span>list transition_item</span></span></span><br><span><var>n</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">length t1 ‚â§ n
‚Üí finite_trace_nth si (t1 ++ t2) n =
  finite_trace_nth (finite_trace_last si t1) t2
    (n - length t1)</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="VLSM-v-chk3c" style="display: none" type="checkbox"><label class="alectryon-input" for="VLSM-v-chk3c"><span class="nb">intro</span> H.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>message</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>T</var><span class="hyp-type"><b>: </b><span>VLSMType message</span></span></span><br><span><var>si</var><span class="hyp-type"><b>: </b><span>state</span></span></span><br><span><var>t1, t2</var><span class="hyp-type"><b>: </b><span>list transition_item</span></span></span><br><span><var>n</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>length t1 ‚â§ n</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">finite_trace_nth si (t1 ++ t2) n =
finite_trace_nth (finite_trace_last si t1) t2
  (n - length t1)</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="VLSM-v-chk3d" style="display: none" type="checkbox"><label class="alectryon-input" for="VLSM-v-chk3d"><span class="nb">apply</span> Compare_dec.le_lt_eq_dec <span class="kr">in</span> H.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>message</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>T</var><span class="hyp-type"><b>: </b><span>VLSMType message</span></span></span><br><span><var>si</var><span class="hyp-type"><b>: </b><span>state</span></span></span><br><span><var>t1, t2</var><span class="hyp-type"><b>: </b><span>list transition_item</span></span></span><br><span><var>n</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>{length t1 &lt; n} + {length t1 = n}</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">finite_trace_nth si (t1 ++ t2) n =
finite_trace_nth (finite_trace_last si t1) t2
  (n - length t1)</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="VLSM-v-chk3e" style="display: none" type="checkbox"><label class="alectryon-input" for="VLSM-v-chk3e"><span class="nb">destruct</span> H <span class="kr">as</span> [H |&lt;-].</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>message</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>T</var><span class="hyp-type"><b>: </b><span>VLSMType message</span></span></span><br><span><var>si</var><span class="hyp-type"><b>: </b><span>state</span></span></span><br><span><var>t1, t2</var><span class="hyp-type"><b>: </b><span>list transition_item</span></span></span><br><span><var>n</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>length t1 &lt; n</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">finite_trace_nth si (t1 ++ t2) n =
finite_trace_nth (finite_trace_last si t1) t2
  (n - length t1)</div></blockquote><div class="alectryon-extra-goals"><input class="alectryon-extra-goal-toggle" id="VLSM-v-chk3f" style="display: none" type="checkbox"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>message</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>T</var><span class="hyp-type"><b>: </b><span>VLSMType message</span></span></span><br><span><var>si</var><span class="hyp-type"><b>: </b><span>state</span></span></span><br><span><var>t1, t2</var><span class="hyp-type"><b>: </b><span>list transition_item</span></span></span><br></div><label class="goal-separator" for="VLSM-v-chk3f"><hr></label><div class="goal-conclusion">finite_trace_nth si (t1 ++ t2) (length t1) =
finite_trace_nth (finite_trace_last si t1) t2
  (length t1 - length t1)</div></blockquote></div></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="VLSM-v-chk40" style="display: none" type="checkbox"><label class="alectryon-input" for="VLSM-v-chk40">-</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>message</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>T</var><span class="hyp-type"><b>: </b><span>VLSMType message</span></span></span><br><span><var>si</var><span class="hyp-type"><b>: </b><span>state</span></span></span><br><span><var>t1, t2</var><span class="hyp-type"><b>: </b><span>list transition_item</span></span></span><br><span><var>n</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>length t1 &lt; n</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">finite_trace_nth si (t1 ++ t2) n =
finite_trace_nth (finite_trace_last si t1) t2
  (n - length t1)</div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="VLSM-v-chk41" style="display: none" type="checkbox"><label class="alectryon-input" for="VLSM-v-chk41"><span class="nb">unfold</span> finite_trace_nth.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>message</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>T</var><span class="hyp-type"><b>: </b><span>VLSMType message</span></span></span><br><span><var>si</var><span class="hyp-type"><b>: </b><span>state</span></span></span><br><span><var>t1, t2</var><span class="hyp-type"><b>: </b><span>list transition_item</span></span></span><br><span><var>n</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>length t1 &lt; n</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">nth_error (si :: List.map destination (t1 ++ t2)) n =
nth_error
  (finite_trace_last si t1 :: List.map destination t2)
  (n - length t1)</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">      </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="VLSM-v-chk42" style="display: none" type="checkbox"><label class="alectryon-input" for="VLSM-v-chk42"><span class="nb">rewrite</span> map_app, app_comm_cons.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>message</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>T</var><span class="hyp-type"><b>: </b><span>VLSMType message</span></span></span><br><span><var>si</var><span class="hyp-type"><b>: </b><span>state</span></span></span><br><span><var>t1, t2</var><span class="hyp-type"><b>: </b><span>list transition_item</span></span></span><br><span><var>n</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>length t1 &lt; n</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">nth_error
  ((si :: List.map destination t1) ++
   List.map destination t2) n =
nth_error
  (finite_trace_last si t1 :: List.map destination t2)
  (n - length t1)</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">      </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="VLSM-v-chk43" style="display: none" type="checkbox"><label class="alectryon-input" for="VLSM-v-chk43"><span class="nb">rewrite</span> nth_error_app2;<span class="nb">simpl</span> length;<span class="nb">rewrite</span> map_length;[|<span class="kp">solve</span>[<span class="nb">auto with</span> arith]].</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>message</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>T</var><span class="hyp-type"><b>: </b><span>VLSMType message</span></span></span><br><span><var>si</var><span class="hyp-type"><b>: </b><span>state</span></span></span><br><span><var>t1, t2</var><span class="hyp-type"><b>: </b><span>list transition_item</span></span></span><br><span><var>n</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>length t1 &lt; n</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">nth_error (List.map destination t2)
  (n - S (length t1)) =
nth_error
  (finite_trace_last si t1 :: List.map destination t2)
  (n - length t1)</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">      </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="VLSM-v-chk44" style="display: none" type="checkbox"><label class="alectryon-input" for="VLSM-v-chk44"><span class="nb">destruct</span> n;[<span class="nb">exfalso</span>;<span class="bp">lia</span>|].</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>message</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>T</var><span class="hyp-type"><b>: </b><span>VLSMType message</span></span></span><br><span><var>si</var><span class="hyp-type"><b>: </b><span>state</span></span></span><br><span><var>t1, t2</var><span class="hyp-type"><b>: </b><span>list transition_item</span></span></span><br><span><var>n</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>length t1 &lt; S n</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">nth_error (List.map destination t2)
  (S n - S (length t1)) =
nth_error
  (finite_trace_last si t1 :: List.map destination t2)
  (S n - length t1)</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">      </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="VLSM-v-chk45" style="display: none" type="checkbox"><label class="alectryon-input" for="VLSM-v-chk45"><span class="nb">replace</span> (S n -length t1) <span class="kr">with</span> (S (n - length t1)) <span class="bp">by</span> <span class="bp">lia</span>.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>message</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>T</var><span class="hyp-type"><b>: </b><span>VLSMType message</span></span></span><br><span><var>si</var><span class="hyp-type"><b>: </b><span>state</span></span></span><br><span><var>t1, t2</var><span class="hyp-type"><b>: </b><span>list transition_item</span></span></span><br><span><var>n</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>length t1 &lt; S n</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">nth_error (List.map destination t2)
  (S n - S (length t1)) =
nth_error
  (finite_trace_last si t1 :: List.map destination t2)
  (S (n - length t1))</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">      </span><span class="alectryon-sentence"><span class="alectryon-input"><span class="bp">reflexivity</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="VLSM-v-chk46" style="display: none" type="checkbox"><label class="alectryon-input" for="VLSM-v-chk46">-</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>message</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>T</var><span class="hyp-type"><b>: </b><span>VLSMType message</span></span></span><br><span><var>si</var><span class="hyp-type"><b>: </b><span>state</span></span></span><br><span><var>t1, t2</var><span class="hyp-type"><b>: </b><span>list transition_item</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">finite_trace_nth si (t1 ++ t2) (length t1) =
finite_trace_nth (finite_trace_last si t1) t2
  (length t1 - length t1)</div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="VLSM-v-chk47" style="display: none" type="checkbox"><label class="alectryon-input" for="VLSM-v-chk47"><span class="nb">rewrite</span> finite_trace_nth_app1, finite_trace_nth_last <span class="bp">by</span> <span class="bp">reflexivity</span>.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>message</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>T</var><span class="hyp-type"><b>: </b><span>VLSMType message</span></span></span><br><span><var>si</var><span class="hyp-type"><b>: </b><span>state</span></span></span><br><span><var>t1, t2</var><span class="hyp-type"><b>: </b><span>list transition_item</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">Some (finite_trace_last si t1) =
finite_trace_nth (finite_trace_last si t1) t2
  (length t1 - length t1)</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">      </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="VLSM-v-chk48" style="display: none" type="checkbox"><label class="alectryon-input" for="VLSM-v-chk48"><span class="nb">rewrite</span> PeanoNat.Nat.sub_diag, finite_trace_nth_first.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>message</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>T</var><span class="hyp-type"><b>: </b><span>VLSMType message</span></span></span><br><span><var>si</var><span class="hyp-type"><b>: </b><span>state</span></span></span><br><span><var>t1, t2</var><span class="hyp-type"><b>: </b><span>list transition_item</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">Some (finite_trace_last si t1) =
Some (finite_trace_last si t1)</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">      </span><span class="alectryon-sentence"><span class="alectryon-input"><span class="bp">reflexivity</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Qed</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
</span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="VLSM-v-chk49" style="display: none" type="checkbox"><label class="alectryon-input" for="VLSM-v-chk49"><span class="kn">Lemma</span> <span class="nf">finite_trace_nth_length</span>
    (<span class="nv">si</span> : state) (<span class="nv">tr</span> : list transition_item) <span class="nv">n</span> <span class="nv">s</span>:
    finite_trace_nth si tr n = Some s -&gt;
    n &lt;= length tr.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>message</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>T</var><span class="hyp-type"><b>: </b><span>VLSMType message</span></span></span><br><span><var>si</var><span class="hyp-type"><b>: </b><span>state</span></span></span><br><span><var>tr</var><span class="hyp-type"><b>: </b><span>list transition_item</span></span></span><br><span><var>n</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>s</var><span class="hyp-type"><b>: </b><span>state</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">finite_trace_nth si tr n = Some s ‚Üí n ‚â§ length tr</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="VLSM-v-chk4a" style="display: none" type="checkbox"><label class="alectryon-input" for="VLSM-v-chk4a"><span class="kn">Proof</span>.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>message</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>T</var><span class="hyp-type"><b>: </b><span>VLSMType message</span></span></span><br><span><var>si</var><span class="hyp-type"><b>: </b><span>state</span></span></span><br><span><var>tr</var><span class="hyp-type"><b>: </b><span>list transition_item</span></span></span><br><span><var>n</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>s</var><span class="hyp-type"><b>: </b><span>state</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">finite_trace_nth si tr n = Some s ‚Üí n ‚â§ length tr</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="VLSM-v-chk4b" style="display: none" type="checkbox"><label class="alectryon-input" for="VLSM-v-chk4b"><span class="nb">intros</span> H.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>message</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>T</var><span class="hyp-type"><b>: </b><span>VLSMType message</span></span></span><br><span><var>si</var><span class="hyp-type"><b>: </b><span>state</span></span></span><br><span><var>tr</var><span class="hyp-type"><b>: </b><span>list transition_item</span></span></span><br><span><var>n</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>s</var><span class="hyp-type"><b>: </b><span>state</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>finite_trace_nth si tr n = Some s</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">n ‚â§ length tr</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="VLSM-v-chk4c" style="display: none" type="checkbox"><label class="alectryon-input" for="VLSM-v-chk4c"><span class="nb">apply</span> nth_error_length <span class="kr">in</span> H.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>message</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>T</var><span class="hyp-type"><b>: </b><span>VLSMType message</span></span></span><br><span><var>si</var><span class="hyp-type"><b>: </b><span>state</span></span></span><br><span><var>tr</var><span class="hyp-type"><b>: </b><span>list transition_item</span></span></span><br><span><var>n</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>s</var><span class="hyp-type"><b>: </b><span>state</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>S n ‚â§ length (si :: List.map destination tr)</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">n ‚â§ length tr</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="VLSM-v-chk4d" style="display: none" type="checkbox"><label class="alectryon-input" for="VLSM-v-chk4d"><span class="nb">simpl</span> <span class="kr">in</span> H.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>message</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>T</var><span class="hyp-type"><b>: </b><span>VLSMType message</span></span></span><br><span><var>si</var><span class="hyp-type"><b>: </b><span>state</span></span></span><br><span><var>tr</var><span class="hyp-type"><b>: </b><span>list transition_item</span></span></span><br><span><var>n</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>s</var><span class="hyp-type"><b>: </b><span>state</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>S n ‚â§ S (length (List.map destination tr))</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">n ‚â§ length tr</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="VLSM-v-chk4e" style="display: none" type="checkbox"><label class="alectryon-input" for="VLSM-v-chk4e"><span class="nb">rewrite</span> map_length <span class="kr">in</span> H.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>message</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>T</var><span class="hyp-type"><b>: </b><span>VLSMType message</span></span></span><br><span><var>si</var><span class="hyp-type"><b>: </b><span>state</span></span></span><br><span><var>tr</var><span class="hyp-type"><b>: </b><span>list transition_item</span></span></span><br><span><var>n</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>s</var><span class="hyp-type"><b>: </b><span>state</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>S n ‚â§ S (length tr)</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">n ‚â§ length tr</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="VLSM-v-chk4f" style="display: none" type="checkbox"><label class="alectryon-input" for="VLSM-v-chk4f"><span class="nb">apply</span> le_S_n <span class="kr">in</span> H.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>message</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>T</var><span class="hyp-type"><b>: </b><span>VLSMType message</span></span></span><br><span><var>si</var><span class="hyp-type"><b>: </b><span>state</span></span></span><br><span><var>tr</var><span class="hyp-type"><b>: </b><span>list transition_item</span></span></span><br><span><var>n</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>s</var><span class="hyp-type"><b>: </b><span>state</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>n ‚â§ length tr</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">n ‚â§ length tr</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><span class="alectryon-input"><span class="bp">assumption</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Qed</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
</span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="VLSM-v-chk50" style="display: none" type="checkbox"><label class="alectryon-input" for="VLSM-v-chk50"><span class="kn">Lemma</span> <span class="nf">finite_trace_last_prefix</span>
    (<span class="nv">s</span>: state) (<span class="nv">tr</span>: list transition_item) <span class="nv">n</span> <span class="nv">nth</span>:
    finite_trace_nth s tr n = Some nth -&gt;
    finite_trace_last s (list_prefix tr n) = nth.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>message</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>T</var><span class="hyp-type"><b>: </b><span>VLSMType message</span></span></span><br><span><var>s</var><span class="hyp-type"><b>: </b><span>state</span></span></span><br><span><var>tr</var><span class="hyp-type"><b>: </b><span>list transition_item</span></span></span><br><span><var>n</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>nth</var><span class="hyp-type"><b>: </b><span>state</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">finite_trace_nth s tr n = Some nth
‚Üí finite_trace_last s (list_prefix tr n) = nth</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="VLSM-v-chk51" style="display: none" type="checkbox"><label class="alectryon-input" for="VLSM-v-chk51"><span class="kn">Proof</span>.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>message</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>T</var><span class="hyp-type"><b>: </b><span>VLSMType message</span></span></span><br><span><var>s</var><span class="hyp-type"><b>: </b><span>state</span></span></span><br><span><var>tr</var><span class="hyp-type"><b>: </b><span>list transition_item</span></span></span><br><span><var>n</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>nth</var><span class="hyp-type"><b>: </b><span>state</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">finite_trace_nth s tr n = Some nth
‚Üí finite_trace_last s (list_prefix tr n) = nth</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="VLSM-v-chk52" style="display: none" type="checkbox"><label class="alectryon-input" for="VLSM-v-chk52"><span class="nb">unfold</span> finite_trace_nth, finite_trace_last.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>message</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>T</var><span class="hyp-type"><b>: </b><span>VLSMType message</span></span></span><br><span><var>s</var><span class="hyp-type"><b>: </b><span>state</span></span></span><br><span><var>tr</var><span class="hyp-type"><b>: </b><span>list transition_item</span></span></span><br><span><var>n</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>nth</var><span class="hyp-type"><b>: </b><span>state</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">nth_error (s :: List.map destination tr) n = Some nth
‚Üí List.<span class="nb">last</span> (List.map destination (list_prefix tr n))
    s = nth</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="VLSM-v-chk53" style="display: none" type="checkbox"><label class="alectryon-input" for="VLSM-v-chk53"><span class="nb">rewrite</span> list_prefix_map.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>message</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>T</var><span class="hyp-type"><b>: </b><span>VLSMType message</span></span></span><br><span><var>s</var><span class="hyp-type"><b>: </b><span>state</span></span></span><br><span><var>tr</var><span class="hyp-type"><b>: </b><span>list transition_item</span></span></span><br><span><var>n</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>nth</var><span class="hyp-type"><b>: </b><span>state</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">nth_error (s :: List.map destination tr) n = Some nth
‚Üí List.<span class="nb">last</span> (list_prefix (List.map destination tr) n)
    s = nth</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="VLSM-v-chk54" style="display: none" type="checkbox"><label class="alectryon-input" for="VLSM-v-chk54"><span class="nb">generalize</span> (List.map destination tr); <span class="nb">intro</span> l; <span class="nb">clear</span> tr.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>message</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>T</var><span class="hyp-type"><b>: </b><span>VLSMType message</span></span></span><br><span><var>s</var><span class="hyp-type"><b>: </b><span>state</span></span></span><br><span><var>n</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>nth</var><span class="hyp-type"><b>: </b><span>state</span></span></span><br><span><var>l</var><span class="hyp-type"><b>: </b><span>list state</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">nth_error (s :: l) n = Some nth
‚Üí List.<span class="nb">last</span> (list_prefix l n) s = nth</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="VLSM-v-chk55" style="display: none" type="checkbox"><label class="alectryon-input" for="VLSM-v-chk55"><span class="nb">destruct</span> n.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>message</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>T</var><span class="hyp-type"><b>: </b><span>VLSMType message</span></span></span><br><span><var>s, nth</var><span class="hyp-type"><b>: </b><span>state</span></span></span><br><span><var>l</var><span class="hyp-type"><b>: </b><span>list state</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">nth_error (s :: l) <span class="mi">0</span> = Some nth
‚Üí List.<span class="nb">last</span> (list_prefix l <span class="mi">0</span>) s = nth</div></blockquote><div class="alectryon-extra-goals"><input class="alectryon-extra-goal-toggle" id="VLSM-v-chk56" style="display: none" type="checkbox"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>message</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>T</var><span class="hyp-type"><b>: </b><span>VLSMType message</span></span></span><br><span><var>s</var><span class="hyp-type"><b>: </b><span>state</span></span></span><br><span><var>n</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>nth</var><span class="hyp-type"><b>: </b><span>state</span></span></span><br><span><var>l</var><span class="hyp-type"><b>: </b><span>list state</span></span></span><br></div><label class="goal-separator" for="VLSM-v-chk56"><hr></label><div class="goal-conclusion">nth_error (s :: l) (S n) = Some nth
‚Üí List.<span class="nb">last</span> (list_prefix l (S n)) s = nth</div></blockquote></div></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="VLSM-v-chk57" style="display: none" type="checkbox"><label class="alectryon-input" for="VLSM-v-chk57">-</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>message</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>T</var><span class="hyp-type"><b>: </b><span>VLSMType message</span></span></span><br><span><var>s, nth</var><span class="hyp-type"><b>: </b><span>state</span></span></span><br><span><var>l</var><span class="hyp-type"><b>: </b><span>list state</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">nth_error (s :: l) <span class="mi">0</span> = Some nth
‚Üí List.<span class="nb">last</span> (list_prefix l <span class="mi">0</span>) s = nth</div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="VLSM-v-chk58" style="display: none" type="checkbox"><label class="alectryon-input" for="VLSM-v-chk58"><span class="nb">simpl</span>.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>message</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>T</var><span class="hyp-type"><b>: </b><span>VLSMType message</span></span></span><br><span><var>s, nth</var><span class="hyp-type"><b>: </b><span>state</span></span></span><br><span><var>l</var><span class="hyp-type"><b>: </b><span>list state</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">Some s = Some nth
‚Üí List.<span class="nb">last</span> (list_prefix l <span class="mi">0</span>) s = nth</div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="VLSM-v-chk59" style="display: none" type="checkbox"><label class="alectryon-input" for="VLSM-v-chk59"><span class="nb">intros</span> [=&lt;-].</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>message</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>T</var><span class="hyp-type"><b>: </b><span>VLSMType message</span></span></span><br><span><var>s</var><span class="hyp-type"><b>: </b><span>state</span></span></span><br><span><var>l</var><span class="hyp-type"><b>: </b><span>list state</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">List.<span class="nb">last</span> (list_prefix l <span class="mi">0</span>) s = s</div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="nb">destruct</span> l;<span class="bp">reflexivity</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="VLSM-v-chk5a" style="display: none" type="checkbox"><label class="alectryon-input" for="VLSM-v-chk5a">-</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>message</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>T</var><span class="hyp-type"><b>: </b><span>VLSMType message</span></span></span><br><span><var>s</var><span class="hyp-type"><b>: </b><span>state</span></span></span><br><span><var>n</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>nth</var><span class="hyp-type"><b>: </b><span>state</span></span></span><br><span><var>l</var><span class="hyp-type"><b>: </b><span>list state</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">nth_error (s :: l) (S n) = Some nth
‚Üí List.<span class="nb">last</span> (list_prefix l (S n)) s = nth</div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="VLSM-v-chk5b" style="display: none" type="checkbox"><label class="alectryon-input" for="VLSM-v-chk5b"><span class="nb">simpl</span>.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>message</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>T</var><span class="hyp-type"><b>: </b><span>VLSMType message</span></span></span><br><span><var>s</var><span class="hyp-type"><b>: </b><span>state</span></span></span><br><span><var>n</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>nth</var><span class="hyp-type"><b>: </b><span>state</span></span></span><br><span><var>l</var><span class="hyp-type"><b>: </b><span>list state</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">nth_error l n = Some nth
‚Üí List.<span class="nb">last</span> (list_prefix l (S n)) s = nth</div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="VLSM-v-chk5c" style="display: none" type="checkbox"><label class="alectryon-input" for="VLSM-v-chk5c"><span class="nb">intro</span> H.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>message</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>T</var><span class="hyp-type"><b>: </b><span>VLSMType message</span></span></span><br><span><var>s</var><span class="hyp-type"><b>: </b><span>state</span></span></span><br><span><var>n</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>nth</var><span class="hyp-type"><b>: </b><span>state</span></span></span><br><span><var>l</var><span class="hyp-type"><b>: </b><span>list state</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>nth_error l n = Some nth</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">List.<span class="nb">last</span> (list_prefix l (S n)) s = nth</div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="VLSM-v-chk5d" style="display: none" type="checkbox"><label class="alectryon-input" for="VLSM-v-chk5d"><span class="nb">symmetry</span>.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>message</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>T</var><span class="hyp-type"><b>: </b><span>VLSMType message</span></span></span><br><span><var>s</var><span class="hyp-type"><b>: </b><span>state</span></span></span><br><span><var>n</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>nth</var><span class="hyp-type"><b>: </b><span>state</span></span></span><br><span><var>l</var><span class="hyp-type"><b>: </b><span>list state</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>nth_error l n = Some nth</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">nth = List.<span class="nb">last</span> (list_prefix l (S n)) s</div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="VLSM-v-chk5e" style="display: none" type="checkbox"><label class="alectryon-input" for="VLSM-v-chk5e"><span class="nb">revert</span> H s.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>message</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>T</var><span class="hyp-type"><b>: </b><span>VLSMType message</span></span></span><br><span><var>n</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>nth</var><span class="hyp-type"><b>: </b><span>state</span></span></span><br><span><var>l</var><span class="hyp-type"><b>: </b><span>list state</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">nth_error l n = Some nth
‚Üí <span class="kr">‚àÄ</span> <span class="nv">s</span> : state, nth = List.<span class="nb">last</span> (list_prefix l (S n)) s</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">      </span><span class="alectryon-sentence"><span class="alectryon-input"><span class="nb">apply</span> list_prefix_nth_last.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Qed</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
</span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="VLSM-v-chk5f" style="display: none" type="checkbox"><label class="alectryon-input" for="VLSM-v-chk5f"><span class="kn">Lemma</span> <span class="nf">finite_trace_last_suffix</span>
    (<span class="nv">s</span>: state) (<span class="nv">tr</span>: list transition_item) <span class="nv">n</span>:
    n &lt; length tr -&gt;
    finite_trace_last s (list_suffix tr n) = finite_trace_last s tr.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>message</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>T</var><span class="hyp-type"><b>: </b><span>VLSMType message</span></span></span><br><span><var>s</var><span class="hyp-type"><b>: </b><span>state</span></span></span><br><span><var>tr</var><span class="hyp-type"><b>: </b><span>list transition_item</span></span></span><br><span><var>n</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">n &lt; length tr
‚Üí finite_trace_last s (list_suffix tr n) =
  finite_trace_last s tr</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="VLSM-v-chk60" style="display: none" type="checkbox"><label class="alectryon-input" for="VLSM-v-chk60"><span class="kn">Proof</span>.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>message</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>T</var><span class="hyp-type"><b>: </b><span>VLSMType message</span></span></span><br><span><var>s</var><span class="hyp-type"><b>: </b><span>state</span></span></span><br><span><var>tr</var><span class="hyp-type"><b>: </b><span>list transition_item</span></span></span><br><span><var>n</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">n &lt; length tr
‚Üí finite_trace_last s (list_suffix tr n) =
  finite_trace_last s tr</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="VLSM-v-chk61" style="display: none" type="checkbox"><label class="alectryon-input" for="VLSM-v-chk61"><span class="nb">intros</span> H.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>message</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>T</var><span class="hyp-type"><b>: </b><span>VLSMType message</span></span></span><br><span><var>s</var><span class="hyp-type"><b>: </b><span>state</span></span></span><br><span><var>tr</var><span class="hyp-type"><b>: </b><span>list transition_item</span></span></span><br><span><var>n</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>n &lt; length tr</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">finite_trace_last s (list_suffix tr n) =
finite_trace_last s tr</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="VLSM-v-chk62" style="display: none" type="checkbox"><label class="alectryon-input" for="VLSM-v-chk62"><span class="nb">unfold</span> finite_trace_last.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>message</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>T</var><span class="hyp-type"><b>: </b><span>VLSMType message</span></span></span><br><span><var>s</var><span class="hyp-type"><b>: </b><span>state</span></span></span><br><span><var>tr</var><span class="hyp-type"><b>: </b><span>list transition_item</span></span></span><br><span><var>n</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>n &lt; length tr</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">List.<span class="nb">last</span> (List.map destination (list_suffix tr n)) s =
List.<span class="nb">last</span> (List.map destination tr) s</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="VLSM-v-chk63" style="display: none" type="checkbox"><label class="alectryon-input" for="VLSM-v-chk63"><span class="nb">rewrite</span> list_suffix_map.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>message</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>T</var><span class="hyp-type"><b>: </b><span>VLSMType message</span></span></span><br><span><var>s</var><span class="hyp-type"><b>: </b><span>state</span></span></span><br><span><var>tr</var><span class="hyp-type"><b>: </b><span>list transition_item</span></span></span><br><span><var>n</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>n &lt; length tr</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">List.<span class="nb">last</span> (list_suffix (List.map destination tr) n) s =
List.<span class="nb">last</span> (List.map destination tr) s</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="VLSM-v-chk64" style="display: none" type="checkbox"><label class="alectryon-input" for="VLSM-v-chk64"><span class="nb">apply</span> list_suffix_last.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>message</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>T</var><span class="hyp-type"><b>: </b><span>VLSMType message</span></span></span><br><span><var>s</var><span class="hyp-type"><b>: </b><span>state</span></span></span><br><span><var>tr</var><span class="hyp-type"><b>: </b><span>list transition_item</span></span></span><br><span><var>n</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>n &lt; length tr</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">n &lt; length (List.map destination tr)</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="VLSM-v-chk65" style="display: none" type="checkbox"><label class="alectryon-input" for="VLSM-v-chk65"><span class="nb">rewrite</span> map_length.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>message</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>T</var><span class="hyp-type"><b>: </b><span>VLSMType message</span></span></span><br><span><var>s</var><span class="hyp-type"><b>: </b><span>state</span></span></span><br><span><var>tr</var><span class="hyp-type"><b>: </b><span>list transition_item</span></span></span><br><span><var>n</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>n &lt; length tr</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">n &lt; length tr</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><span class="alectryon-input"><span class="bp">assumption</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Qed</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
</span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="VLSM-v-chk66" style="display: none" type="checkbox"><label class="alectryon-input" for="VLSM-v-chk66"><span class="kn">Lemma</span> <span class="nf">unlock_finite_trace_last</span> <span class="nv">s</span> <span class="nv">tr</span>:
    finite_trace_last s tr = List.<span class="nb">last</span> (List.map destination tr) s.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>message</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>T</var><span class="hyp-type"><b>: </b><span>VLSMType message</span></span></span><br><span><var>s</var><span class="hyp-type"><b>: </b><span>state</span></span></span><br><span><var>tr</var><span class="hyp-type"><b>: </b><span>list transition_item</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">finite_trace_last s tr =
List.<span class="nb">last</span> (List.map destination tr) s</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="VLSM-v-chk67" style="display: none" type="checkbox"><label class="alectryon-input" for="VLSM-v-chk67"><span class="kn">Proof</span>.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>message</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>T</var><span class="hyp-type"><b>: </b><span>VLSMType message</span></span></span><br><span><var>s</var><span class="hyp-type"><b>: </b><span>state</span></span></span><br><span><var>tr</var><span class="hyp-type"><b>: </b><span>list transition_item</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">finite_trace_last s tr =
List.<span class="nb">last</span> (List.map destination tr) s</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><span class="alectryon-input"><span class="bp">reflexivity</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Qed</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Opaque</span> finite_trace_last.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
</span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">End</span> <span class="nf">TraceLemmas</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
</span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Section</span> <span class="nf">vlsm_projections</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
</span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Context</span>
    {<span class="nv">message</span> : <span class="kt">Type</span>}
    (<span class="nv">vlsm</span> : VLSM message)
    .</span></span></pre><div class="doc">
Given a <span class="inlinecode"><span class="id" title="var">VLSM</span></span>, it is convenient to be able to retrieve its <span class="inlinecode"><span class="id" title="var">VLSMMachine</span></span>
or <span class="inlinecode"><span class="id" title="var">VLSMType</span></span>. Functions <span class="inlinecode"><span class="id" title="var">machine</span></span> and <span class="inlinecode"><span class="id" title="keyword">type</span></span> below achieve this precise purpose.

</div><pre class="alectryon-io highlight"><!-- Generator: Alectryon --><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Definition</span> <span class="nf">type</span> := vtype vlsm.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Definition</span> <span class="nf">machine</span> := vmachine vlsm.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Definition</span> <span class="nf">vstate</span> := @state _ type.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Definition</span> <span class="nf">vlabel</span> := @label _ type.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Definition</span> <span class="nf">vinitial_state_prop</span> := @initial_state_prop _ _ machine.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Definition</span> <span class="nf">vinitial_state</span> := @initial_state _ _ machine.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Definition</span> <span class="nf">vinitial_message_prop</span> := @initial_message_prop _ _ machine.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Definition</span> <span class="nf">voption_initial_message_prop</span> := @option_initial_message_prop _ _ machine.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Definition</span> <span class="nf">vinitial_message</span> := @initial_message _ _ machine.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Definition</span> <span class="nf">vs0</span> := @inhabitant _ (@s0 _ _ machine).</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Definition</span> <span class="nf">vdecidable_initial_messages_prop</span> := @decidable_initial_messages_prop _ _ machine.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Definition</span> <span class="nf">vtransition</span> := @transition _ _ machine.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Definition</span> <span class="nf">vvalid</span> := @valid _ _ machine.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Definition</span> <span class="nf">vtransition_item</span> := @transition_item _ type.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Definition</span> <span class="nf">vTrace</span> := @Trace _ type.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Definition</span> <span class="nf">vproto_run</span> := @proto_run _ type.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
</span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">End</span> <span class="nf">vlsm_projections</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
</span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Ltac</span> <span class="nf">unfold_vtransition</span> H := (<span class="nb">unfold</span> vtransition <span class="kr">in</span> H; <span class="nb">simpl</span> <span class="kr">in</span> H).</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
</span><span class="alectryon-sentence"><input class="alectryon-toggle" id="VLSM-v-chk68" style="display: none" type="checkbox"><label class="alectryon-input" for="VLSM-v-chk68"><span class="kn">Lemma</span> <span class="nf">mk_vlsm_machine</span>
  {<span class="nv">message</span> : <span class="kt">Type</span>}
  (<span class="nv">X</span> : VLSM message)
  : mk_vlsm (machine X) = X.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>message</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>X</var><span class="hyp-type"><b>: </b><span>VLSM message</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">{| vtype := vtype X; vmachine := machine X |} = X</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="VLSM-v-chk69" style="display: none" type="checkbox"><label class="alectryon-input" for="VLSM-v-chk69"><span class="kn">Proof</span>.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>message</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>X</var><span class="hyp-type"><b>: </b><span>VLSM message</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">{| vtype := vtype X; vmachine := machine X |} = X</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="VLSM-v-chk6a" style="display: none" type="checkbox"><label class="alectryon-input" for="VLSM-v-chk6a"><span class="nb">destruct</span> X <span class="kr">as</span> (T, M).</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>message</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>T</var><span class="hyp-type"><b>: </b><span>VLSMType message</span></span></span><br><span><var>M</var><span class="hyp-type"><b>: </b><span>VLSMMachine T</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">{|
  vtype := vtype {| vtype := T; vmachine := M |};
  vmachine := machine {| vtype := T; vmachine := M |}
|} = {| vtype := T; vmachine := M |}</div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="bp">reflexivity</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Qed</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
</span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Section</span> <span class="nf">VLSM</span>.</span></span></pre><div class="doc">
In this section we assume a fixed <span class="inlinecode"><span class="id" title="var">VLSM</span></span>.

</div><pre class="alectryon-io highlight"><!-- Generator: Alectryon --><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Context</span>
      {<span class="nv">message</span> : <span class="kt">Type</span>}
      (<span class="nv">X</span> : VLSM message)
      (<span class="nv">TypeX</span> := type X)
      (<span class="nv">MachineX</span> := machine X)
      .</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
</span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Existing Instance</span> <span class="nf">TypeX</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Existing Instance</span> <span class="nf">MachineX</span>.</span></span></pre><div class="doc">
<a id="lab7"></a><h3 class="section">Valid states and messages</h3>
<div class="paragraph"> </div>

We further characterize certain objects as being <i>valid</i>, which means they can
be witnessed or experienced during executions of the protocol. For example,
a message is a <span class="inlinecode"><span class="id" title="var">valid_message</span></span> if there exists an execution of the protocol
in which it is produced.

<div class="paragraph"> </div>

We choose here to define valid states and messages together as the
<span class="inlinecode"><span class="id" title="var">valid_state_message_prop</span></span>erty, inductively defined over the
<span class="inlinecode"><span class="id" title="var">state</span></span> <span class="inlinecode">√ó</span> <span class="inlinecode"><span class="id" title="var">option</span></span> <span class="inlinecode"><span class="id" title="var">message</span></span> product type,
as this definition avoids the need of using a mutually recursive definition.

<div class="paragraph"> </div>

The inductive definition has three cases:
<ul class="doclist">
<li> if <code>s</code> is a <span class="inlinecode"><span class="id" title="var">state</span></span> with the <span class="inlinecode"><span class="id" title="var">initial_state_prop</span></span>erty, then <code>(s, None)</code>
  has the <span class="inlinecode"><span class="id" title="var">valid_state_message_prop</span></span>erty;

</li>
<li> if <code>m</code> is a <code>message</code> with the <span class="inlinecode"><span class="id" title="var">initial_message_prop</span></span>erty,
  then <code>(</code><span class="inlinecode"><span class="id" title="var">s0</span>,</span> <span class="inlinecode"><span class="id" title="var">Some</span></span><code>m)</code> has the <span class="inlinecode"><span class="id" title="var">valid_state_message_prop</span></span>erty;

</li>
<li> for all <span class="inlinecode"><span class="id" title="var">state</span></span>s <code>s</code>, <span class="inlinecode"><span class="id" title="var">option</span></span>al <code>message</code> <code>om</code>, and <span class="inlinecode"><span class="id" title="var">label</span></span> <code>l</code>:

<div class="paragraph"> </div>
<ul class="doclist">
<li> if there is an (optional) <code>message</code> <code>_om</code> such that <code>(s, _om)</code>
    has the <span class="inlinecode"><span class="id" title="var">valid_state_message_prop</span></span>erty;

<div class="paragraph"> </div>
</li>
<li> and if there is a <span class="inlinecode"><span class="id" title="var">state</span></span> <code>_s</code> such that <code>(_s, om)</code> has the
    <span class="inlinecode"><span class="id" title="var">valid_state_message_prop</span></span>erty;

<div class="paragraph"> </div>
</li>
<li> and if <code>l</code> <span class="inlinecode"><span class="id" title="var">valid</span></span> <code>(s, om)</code>,

<div class="paragraph"> </div>
</li>
<li> then <span class="inlinecode"><span class="id" title="var">transition</span></span> <code>l (s, om)</code> has the <span class="inlinecode"><span class="id" title="var">valid_state_message_prop</span></span>erty.

</li>
</ul>
</li>
</ul>
</div><pre class="alectryon-io highlight"><!-- Generator: Alectryon --><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Inductive</span> <span class="nf">valid_state_message_prop</span> : state -&gt; option message -&gt; <span class="kt">Prop</span> :=
    | valid_initial_state_message
        (s : state)
        (Hs : initial_state_prop s)
        (om : option message)
        (Hom : option_initial_message_prop om)
      : valid_state_message_prop s om
    | valid_generated_state_message
        (s : state)
        (_om : option message)
        (Hps : valid_state_message_prop s _om)
        (_s : state)
        (om : option message)
        (Hpm : valid_state_message_prop _s om)
        (l : label)
        (Hv : valid l (s, om))
        s&#39; om&#39;
        (Ht : transition l (s, om) = (s&#39;, om&#39;))
      : valid_state_message_prop s&#39; om&#39;.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
</span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Definition</span> <span class="nf">valid_initial_state</span>
      [s:state] (Hs: initial_state_prop s)
      : valid_state_message_prop s None
      := valid_initial_state_message s Hs None I.</span></span></pre><div class="doc">
<div class="paragraph"> </div>

The <span class="inlinecode"><span class="id" title="var">valid_state_prop</span></span>erty and the <span class="inlinecode"><span class="id" title="var">valid_message_prop</span></span>erty are now
definable as simple projections of the above definition.

<div class="paragraph"> </div>

Moreover, we use these derived properties to define the corresponding
dependent types <span class="inlinecode"><span class="id" title="var">valid_state</span></span> and <span class="inlinecode"><span class="id" title="var">valid_message</span></span>.

<div class="paragraph"> </div>
</div><pre class="alectryon-io highlight"><!-- Generator: Alectryon --><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Definition</span> <span class="nf">valid_state_prop</span> (<span class="nv">s</span> : state) :=
      <span class="kr">exists</span> <span class="nv">om</span> : option message, valid_state_message_prop s om.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
</span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Definition</span> <span class="nf">valid_message_prop</span> (<span class="nv">m</span> : message) :=
      <span class="kr">exists</span> <span class="nv">s</span> : state, valid_state_message_prop s (Some m).</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
</span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Definition</span> <span class="nf">valid_state</span> : <span class="kt">Type</span> :=
      { s : state | valid_state_prop s }.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
</span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Definition</span> <span class="nf">valid_message</span> : <span class="kt">Type</span> :=
      { m : message | valid_message_prop m }.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
</span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="VLSM-v-chk6b" style="display: none" type="checkbox"><label class="alectryon-input" for="VLSM-v-chk6b"><span class="kn">Lemma</span> <span class="nf">initial_state_is_valid</span>
      (<span class="nv">s</span> : state)
      (<span class="nv">Hinitial</span> : initial_state_prop s) :
      valid_state_prop s.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>message</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>X</var><span class="hyp-type"><b>: </b><span>VLSM message</span></span></span><br><span><var>TypeX</var><span><span class="hyp-body"><b>:= </b><span>type X</span></span><span class="hyp-type"><b>: </b><span>VLSMType message</span></span></span></span><br><span><var>MachineX</var><span><span class="hyp-body"><b>:= </b><span>machine X</span></span><span class="hyp-type"><b>: </b><span>VLSMMachine (vtype X)</span></span></span></span><br><span><var>s</var><span class="hyp-type"><b>: </b><span>state</span></span></span><br><span><var>Hinitial</var><span class="hyp-type"><b>: </b><span>initial_state_prop s</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">valid_state_prop s</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="VLSM-v-chk6c" style="display: none" type="checkbox"><label class="alectryon-input" for="VLSM-v-chk6c"><span class="kn">Proof</span>.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>message</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>X</var><span class="hyp-type"><b>: </b><span>VLSM message</span></span></span><br><span><var>TypeX</var><span><span class="hyp-body"><b>:= </b><span>type X</span></span><span class="hyp-type"><b>: </b><span>VLSMType message</span></span></span></span><br><span><var>MachineX</var><span><span class="hyp-body"><b>:= </b><span>machine X</span></span><span class="hyp-type"><b>: </b><span>VLSMMachine (vtype X)</span></span></span></span><br><span><var>s</var><span class="hyp-type"><b>: </b><span>state</span></span></span><br><span><var>Hinitial</var><span class="hyp-type"><b>: </b><span>initial_state_prop s</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">valid_state_prop s</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">      </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="VLSM-v-chk6d" style="display: none" type="checkbox"><label class="alectryon-input" for="VLSM-v-chk6d"><span class="kr">exists</span> <span class="nv">None</span>.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>message</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>X</var><span class="hyp-type"><b>: </b><span>VLSM message</span></span></span><br><span><var>TypeX</var><span><span class="hyp-body"><b>:= </b><span>type X</span></span><span class="hyp-type"><b>: </b><span>VLSMType message</span></span></span></span><br><span><var>MachineX</var><span><span class="hyp-body"><b>:= </b><span>machine X</span></span><span class="hyp-type"><b>: </b><span>VLSMMachine (vtype X)</span></span></span></span><br><span><var>s</var><span class="hyp-type"><b>: </b><span>state</span></span></span><br><span><var>Hinitial</var><span class="hyp-type"><b>: </b><span>initial_state_prop s</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">valid_state_message_prop s None</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">      </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="VLSM-v-chk6e" style="display: none" type="checkbox"><label class="alectryon-input" for="VLSM-v-chk6e"><span class="nb">apply</span> valid_initial_state_message.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>message</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>X</var><span class="hyp-type"><b>: </b><span>VLSM message</span></span></span><br><span><var>TypeX</var><span><span class="hyp-body"><b>:= </b><span>type X</span></span><span class="hyp-type"><b>: </b><span>VLSMType message</span></span></span></span><br><span><var>MachineX</var><span><span class="hyp-body"><b>:= </b><span>machine X</span></span><span class="hyp-type"><b>: </b><span>VLSMMachine (vtype X)</span></span></span></span><br><span><var>s</var><span class="hyp-type"><b>: </b><span>state</span></span></span><br><span><var>Hinitial</var><span class="hyp-type"><b>: </b><span>initial_state_prop s</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">initial_state_prop s</div></blockquote><div class="alectryon-extra-goals"><input class="alectryon-extra-goal-toggle" id="VLSM-v-chk6f" style="display: none" type="checkbox"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>message</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>X</var><span class="hyp-type"><b>: </b><span>VLSM message</span></span></span><br><span><var>TypeX</var><span><span class="hyp-body"><b>:= </b><span>type X</span></span><span class="hyp-type"><b>: </b><span>VLSMType message</span></span></span></span><br><span><var>MachineX</var><span><span class="hyp-body"><b>:= </b><span>machine X</span></span><span class="hyp-type"><b>: </b><span>VLSMMachine (vtype X)</span></span></span></span><br><span><var>s</var><span class="hyp-type"><b>: </b><span>state</span></span></span><br><span><var>Hinitial</var><span class="hyp-type"><b>: </b><span>initial_state_prop s</span></span></span><br></div><label class="goal-separator" for="VLSM-v-chk6f"><hr></label><div class="goal-conclusion">option_initial_message_prop None</div></blockquote></div></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">      </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="VLSM-v-chk70" style="display: none" type="checkbox"><label class="alectryon-input" for="VLSM-v-chk70"><span class="bp">assumption</span>.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>message</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>X</var><span class="hyp-type"><b>: </b><span>VLSM message</span></span></span><br><span><var>TypeX</var><span><span class="hyp-body"><b>:= </b><span>type X</span></span><span class="hyp-type"><b>: </b><span>VLSMType message</span></span></span></span><br><span><var>MachineX</var><span><span class="hyp-body"><b>:= </b><span>machine X</span></span><span class="hyp-type"><b>: </b><span>VLSMMachine (vtype X)</span></span></span></span><br><span><var>s</var><span class="hyp-type"><b>: </b><span>state</span></span></span><br><span><var>Hinitial</var><span class="hyp-type"><b>: </b><span>initial_state_prop s</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">option_initial_message_prop None</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">      </span><span class="alectryon-sentence"><span class="alectryon-input"><span class="bp">exact</span> I.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Qed</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
</span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="VLSM-v-chk71" style="display: none" type="checkbox"><label class="alectryon-input" for="VLSM-v-chk71"><span class="kn">Lemma</span> <span class="nf">initial_message_is_valid</span>
      (<span class="nv">m</span> : message)
      (<span class="nv">Hinitial</span> : initial_message_prop m) :
      valid_message_prop m.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>message</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>X</var><span class="hyp-type"><b>: </b><span>VLSM message</span></span></span><br><span><var>TypeX</var><span><span class="hyp-body"><b>:= </b><span>type X</span></span><span class="hyp-type"><b>: </b><span>VLSMType message</span></span></span></span><br><span><var>MachineX</var><span><span class="hyp-body"><b>:= </b><span>machine X</span></span><span class="hyp-type"><b>: </b><span>VLSMMachine (vtype X)</span></span></span></span><br><span><var>m</var><span class="hyp-type"><b>: </b><span>message</span></span></span><br><span><var>Hinitial</var><span class="hyp-type"><b>: </b><span>initial_message_prop m</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">valid_message_prop m</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="VLSM-v-chk72" style="display: none" type="checkbox"><label class="alectryon-input" for="VLSM-v-chk72"><span class="kn">Proof</span>.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>message</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>X</var><span class="hyp-type"><b>: </b><span>VLSM message</span></span></span><br><span><var>TypeX</var><span><span class="hyp-body"><b>:= </b><span>type X</span></span><span class="hyp-type"><b>: </b><span>VLSMType message</span></span></span></span><br><span><var>MachineX</var><span><span class="hyp-body"><b>:= </b><span>machine X</span></span><span class="hyp-type"><b>: </b><span>VLSMMachine (vtype X)</span></span></span></span><br><span><var>m</var><span class="hyp-type"><b>: </b><span>message</span></span></span><br><span><var>Hinitial</var><span class="hyp-type"><b>: </b><span>initial_message_prop m</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">valid_message_prop m</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">      </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="VLSM-v-chk73" style="display: none" type="checkbox"><label class="alectryon-input" for="VLSM-v-chk73"><span class="kr">exists</span> (<span class="nv">proj1_sig</span> (vs0 X)).</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>message</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>X</var><span class="hyp-type"><b>: </b><span>VLSM message</span></span></span><br><span><var>TypeX</var><span><span class="hyp-body"><b>:= </b><span>type X</span></span><span class="hyp-type"><b>: </b><span>VLSMType message</span></span></span></span><br><span><var>MachineX</var><span><span class="hyp-body"><b>:= </b><span>machine X</span></span><span class="hyp-type"><b>: </b><span>VLSMMachine (vtype X)</span></span></span></span><br><span><var>m</var><span class="hyp-type"><b>: </b><span>message</span></span></span><br><span><var>Hinitial</var><span class="hyp-type"><b>: </b><span>initial_message_prop m</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">valid_state_message_prop (`(vs0 X)) (Some m)</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">      </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="VLSM-v-chk74" style="display: none" type="checkbox"><label class="alectryon-input" for="VLSM-v-chk74"><span class="nb">apply</span> valid_initial_state_message.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>message</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>X</var><span class="hyp-type"><b>: </b><span>VLSM message</span></span></span><br><span><var>TypeX</var><span><span class="hyp-body"><b>:= </b><span>type X</span></span><span class="hyp-type"><b>: </b><span>VLSMType message</span></span></span></span><br><span><var>MachineX</var><span><span class="hyp-body"><b>:= </b><span>machine X</span></span><span class="hyp-type"><b>: </b><span>VLSMMachine (vtype X)</span></span></span></span><br><span><var>m</var><span class="hyp-type"><b>: </b><span>message</span></span></span><br><span><var>Hinitial</var><span class="hyp-type"><b>: </b><span>initial_message_prop m</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">initial_state_prop (`(vs0 X))</div></blockquote><div class="alectryon-extra-goals"><input class="alectryon-extra-goal-toggle" id="VLSM-v-chk75" style="display: none" type="checkbox"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>message</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>X</var><span class="hyp-type"><b>: </b><span>VLSM message</span></span></span><br><span><var>TypeX</var><span><span class="hyp-body"><b>:= </b><span>type X</span></span><span class="hyp-type"><b>: </b><span>VLSMType message</span></span></span></span><br><span><var>MachineX</var><span><span class="hyp-body"><b>:= </b><span>machine X</span></span><span class="hyp-type"><b>: </b><span>VLSMMachine (vtype X)</span></span></span></span><br><span><var>m</var><span class="hyp-type"><b>: </b><span>message</span></span></span><br><span><var>Hinitial</var><span class="hyp-type"><b>: </b><span>initial_message_prop m</span></span></span><br></div><label class="goal-separator" for="VLSM-v-chk75"><hr></label><div class="goal-conclusion">option_initial_message_prop (Some m)</div></blockquote></div></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">      </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="VLSM-v-chk76" style="display: none" type="checkbox"><label class="alectryon-input" for="VLSM-v-chk76"><span class="nb">apply</span> proj2_sig.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>message</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>X</var><span class="hyp-type"><b>: </b><span>VLSM message</span></span></span><br><span><var>TypeX</var><span><span class="hyp-body"><b>:= </b><span>type X</span></span><span class="hyp-type"><b>: </b><span>VLSMType message</span></span></span></span><br><span><var>MachineX</var><span><span class="hyp-body"><b>:= </b><span>machine X</span></span><span class="hyp-type"><b>: </b><span>VLSMMachine (vtype X)</span></span></span></span><br><span><var>m</var><span class="hyp-type"><b>: </b><span>message</span></span></span><br><span><var>Hinitial</var><span class="hyp-type"><b>: </b><span>initial_message_prop m</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">option_initial_message_prop (Some m)</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">      </span><span class="alectryon-sentence"><span class="alectryon-input"><span class="bp">assumption</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Qed</span>.</span></span></pre><div class="doc">
As often times we work with optional valid messages, it is convenient
to define a valid message property for optional messages:

</div><pre class="alectryon-io highlight"><!-- Generator: Alectryon --><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Definition</span> <span class="nf">option_valid_message_prop</span> (<span class="nv">om</span> : option message) :=
      <span class="kr">exists</span> <span class="nv">s</span> : state, valid_state_message_prop s om.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
</span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="VLSM-v-chk77" style="display: none" type="checkbox"><label class="alectryon-input" for="VLSM-v-chk77"><span class="kn">Lemma</span> <span class="nf">option_valid_message_None</span>
      : option_valid_message_prop None.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>message</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>X</var><span class="hyp-type"><b>: </b><span>VLSM message</span></span></span><br><span><var>TypeX</var><span><span class="hyp-body"><b>:= </b><span>type X</span></span><span class="hyp-type"><b>: </b><span>VLSMType message</span></span></span></span><br><span><var>MachineX</var><span><span class="hyp-body"><b>:= </b><span>machine X</span></span><span class="hyp-type"><b>: </b><span>VLSMMachine (vtype X)</span></span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">option_valid_message_prop None</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="VLSM-v-chk78" style="display: none" type="checkbox"><label class="alectryon-input" for="VLSM-v-chk78"><span class="kn">Proof</span>.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>message</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>X</var><span class="hyp-type"><b>: </b><span>VLSM message</span></span></span><br><span><var>TypeX</var><span><span class="hyp-body"><b>:= </b><span>type X</span></span><span class="hyp-type"><b>: </b><span>VLSMType message</span></span></span></span><br><span><var>MachineX</var><span><span class="hyp-body"><b>:= </b><span>machine X</span></span><span class="hyp-type"><b>: </b><span>VLSMMachine (vtype X)</span></span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">option_valid_message_prop None</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">      </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="VLSM-v-chk79" style="display: none" type="checkbox"><label class="alectryon-input" for="VLSM-v-chk79"><span class="kr">exists</span> (<span class="nv">proj1_sig</span> (vs0 X)).</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>message</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>X</var><span class="hyp-type"><b>: </b><span>VLSM message</span></span></span><br><span><var>TypeX</var><span><span class="hyp-body"><b>:= </b><span>type X</span></span><span class="hyp-type"><b>: </b><span>VLSMType message</span></span></span></span><br><span><var>MachineX</var><span><span class="hyp-body"><b>:= </b><span>machine X</span></span><span class="hyp-type"><b>: </b><span>VLSMMachine (vtype X)</span></span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">valid_state_message_prop (`(vs0 X)) None</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">      </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="VLSM-v-chk7a" style="display: none" type="checkbox"><label class="alectryon-input" for="VLSM-v-chk7a"><span class="nb">apply</span> valid_initial_state_message.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>message</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>X</var><span class="hyp-type"><b>: </b><span>VLSM message</span></span></span><br><span><var>TypeX</var><span><span class="hyp-body"><b>:= </b><span>type X</span></span><span class="hyp-type"><b>: </b><span>VLSMType message</span></span></span></span><br><span><var>MachineX</var><span><span class="hyp-body"><b>:= </b><span>machine X</span></span><span class="hyp-type"><b>: </b><span>VLSMMachine (vtype X)</span></span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">initial_state_prop (`(vs0 X))</div></blockquote><div class="alectryon-extra-goals"><input class="alectryon-extra-goal-toggle" id="VLSM-v-chk7b" style="display: none" type="checkbox"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>message</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>X</var><span class="hyp-type"><b>: </b><span>VLSM message</span></span></span><br><span><var>TypeX</var><span><span class="hyp-body"><b>:= </b><span>type X</span></span><span class="hyp-type"><b>: </b><span>VLSMType message</span></span></span></span><br><span><var>MachineX</var><span><span class="hyp-body"><b>:= </b><span>machine X</span></span><span class="hyp-type"><b>: </b><span>VLSMMachine (vtype X)</span></span></span></span><br></div><label class="goal-separator" for="VLSM-v-chk7b"><hr></label><div class="goal-conclusion">option_initial_message_prop None</div></blockquote></div></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">      </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="VLSM-v-chk7c" style="display: none" type="checkbox"><label class="alectryon-input" for="VLSM-v-chk7c"><span class="nb">apply</span> proj2_sig.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>message</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>X</var><span class="hyp-type"><b>: </b><span>VLSM message</span></span></span><br><span><var>TypeX</var><span><span class="hyp-body"><b>:= </b><span>type X</span></span><span class="hyp-type"><b>: </b><span>VLSMType message</span></span></span></span><br><span><var>MachineX</var><span><span class="hyp-body"><b>:= </b><span>machine X</span></span><span class="hyp-type"><b>: </b><span>VLSMMachine (vtype X)</span></span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">option_initial_message_prop None</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">      </span><span class="alectryon-sentence"><span class="alectryon-input"><span class="bp">exact</span> I.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Qed</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
</span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="VLSM-v-chk7d" style="display: none" type="checkbox"><label class="alectryon-input" for="VLSM-v-chk7d"><span class="kn">Lemma</span> <span class="nf">option_valid_message_Some</span>
      (<span class="nv">m</span> : message)
      (<span class="nv">Hpm</span> : valid_message_prop m)
      : option_valid_message_prop (Some m).</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>message</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>X</var><span class="hyp-type"><b>: </b><span>VLSM message</span></span></span><br><span><var>TypeX</var><span><span class="hyp-body"><b>:= </b><span>type X</span></span><span class="hyp-type"><b>: </b><span>VLSMType message</span></span></span></span><br><span><var>MachineX</var><span><span class="hyp-body"><b>:= </b><span>machine X</span></span><span class="hyp-type"><b>: </b><span>VLSMMachine (vtype X)</span></span></span></span><br><span><var>m</var><span class="hyp-type"><b>: </b><span>message</span></span></span><br><span><var>Hpm</var><span class="hyp-type"><b>: </b><span>valid_message_prop m</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">option_valid_message_prop (Some m)</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="VLSM-v-chk7e" style="display: none" type="checkbox"><label class="alectryon-input" for="VLSM-v-chk7e"><span class="kn">Proof</span>.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>message</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>X</var><span class="hyp-type"><b>: </b><span>VLSM message</span></span></span><br><span><var>TypeX</var><span><span class="hyp-body"><b>:= </b><span>type X</span></span><span class="hyp-type"><b>: </b><span>VLSMType message</span></span></span></span><br><span><var>MachineX</var><span><span class="hyp-body"><b>:= </b><span>machine X</span></span><span class="hyp-type"><b>: </b><span>VLSMMachine (vtype X)</span></span></span></span><br><span><var>m</var><span class="hyp-type"><b>: </b><span>message</span></span></span><br><span><var>Hpm</var><span class="hyp-type"><b>: </b><span>valid_message_prop m</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">option_valid_message_prop (Some m)</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">      </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="VLSM-v-chk7f" style="display: none" type="checkbox"><label class="alectryon-input" for="VLSM-v-chk7f"><span class="nb">destruct</span> Hpm <span class="kr">as</span> [s Hpm].</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>message</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>X</var><span class="hyp-type"><b>: </b><span>VLSM message</span></span></span><br><span><var>TypeX</var><span><span class="hyp-body"><b>:= </b><span>type X</span></span><span class="hyp-type"><b>: </b><span>VLSMType message</span></span></span></span><br><span><var>MachineX</var><span><span class="hyp-body"><b>:= </b><span>machine X</span></span><span class="hyp-type"><b>: </b><span>VLSMMachine (vtype X)</span></span></span></span><br><span><var>m</var><span class="hyp-type"><b>: </b><span>message</span></span></span><br><span><var>s</var><span class="hyp-type"><b>: </b><span>state</span></span></span><br><span><var>Hpm</var><span class="hyp-type"><b>: </b><span>valid_state_message_prop s (Some m)</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">option_valid_message_prop (Some m)</div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="VLSM-v-chk80" style="display: none" type="checkbox"><label class="alectryon-input" for="VLSM-v-chk80"><span class="kr">exists</span> <span class="nv">s</span>.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>message</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>X</var><span class="hyp-type"><b>: </b><span>VLSM message</span></span></span><br><span><var>TypeX</var><span><span class="hyp-body"><b>:= </b><span>type X</span></span><span class="hyp-type"><b>: </b><span>VLSMType message</span></span></span></span><br><span><var>MachineX</var><span><span class="hyp-body"><b>:= </b><span>machine X</span></span><span class="hyp-type"><b>: </b><span>VLSMMachine (vtype X)</span></span></span></span><br><span><var>m</var><span class="hyp-type"><b>: </b><span>message</span></span></span><br><span><var>s</var><span class="hyp-type"><b>: </b><span>state</span></span></span><br><span><var>Hpm</var><span class="hyp-type"><b>: </b><span>valid_state_message_prop s (Some m)</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">valid_state_message_prop s (Some m)</div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="bp">assumption</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Qed</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
</span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="VLSM-v-chk81" style="display: none" type="checkbox"><label class="alectryon-input" for="VLSM-v-chk81"><span class="kn">Lemma</span> <span class="nf">option_initial_message_is_valid</span>
      (<span class="nv">om</span> : option message)
      (<span class="nv">Hinitial</span> : option_initial_message_prop om) :
      option_valid_message_prop om.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>message</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>X</var><span class="hyp-type"><b>: </b><span>VLSM message</span></span></span><br><span><var>TypeX</var><span><span class="hyp-body"><b>:= </b><span>type X</span></span><span class="hyp-type"><b>: </b><span>VLSMType message</span></span></span></span><br><span><var>MachineX</var><span><span class="hyp-body"><b>:= </b><span>machine X</span></span><span class="hyp-type"><b>: </b><span>VLSMMachine (vtype X)</span></span></span></span><br><span><var>om</var><span class="hyp-type"><b>: </b><span>option message</span></span></span><br><span><var>Hinitial</var><span class="hyp-type"><b>: </b><span>option_initial_message_prop om</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">option_valid_message_prop om</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="VLSM-v-chk82" style="display: none" type="checkbox"><label class="alectryon-input" for="VLSM-v-chk82"><span class="kn">Proof</span>.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>message</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>X</var><span class="hyp-type"><b>: </b><span>VLSM message</span></span></span><br><span><var>TypeX</var><span><span class="hyp-body"><b>:= </b><span>type X</span></span><span class="hyp-type"><b>: </b><span>VLSMType message</span></span></span></span><br><span><var>MachineX</var><span><span class="hyp-body"><b>:= </b><span>machine X</span></span><span class="hyp-type"><b>: </b><span>VLSMMachine (vtype X)</span></span></span></span><br><span><var>om</var><span class="hyp-type"><b>: </b><span>option message</span></span></span><br><span><var>Hinitial</var><span class="hyp-type"><b>: </b><span>option_initial_message_prop om</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">option_valid_message_prop om</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">      </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="VLSM-v-chk83" style="display: none" type="checkbox"><label class="alectryon-input" for="VLSM-v-chk83"><span class="nb">destruct</span> om;
      [<span class="nb">apply</span> option_valid_message_Some
      |<span class="nb">apply</span> option_valid_message_None].</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>message</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>X</var><span class="hyp-type"><b>: </b><span>VLSM message</span></span></span><br><span><var>TypeX</var><span><span class="hyp-body"><b>:= </b><span>type X</span></span><span class="hyp-type"><b>: </b><span>VLSMType message</span></span></span></span><br><span><var>MachineX</var><span><span class="hyp-body"><b>:= </b><span>machine X</span></span><span class="hyp-type"><b>: </b><span>VLSMMachine (vtype X)</span></span></span></span><br><span><var>m</var><span class="hyp-type"><b>: </b><span>message</span></span></span><br><span><var>Hinitial</var><span class="hyp-type"><b>: </b><span>option_initial_message_prop (Some m)</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">valid_message_prop m</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">      </span><span class="alectryon-sentence"><span class="alectryon-input"><span class="nb">apply</span> initial_message_is_valid;<span class="bp">assumption</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Qed</span>.</span></span></pre><div class="doc">
<a id="lab8"></a><h3 class="section">Input validity and input valid transitions</h3>
<div class="paragraph"> </div>

To specify that a particular (input of a) transition can actually be
encountered as part of a protocol execution, we define the notions of
<span class="inlinecode"><span class="id" title="var">input_valid</span></span>ity and <span class="inlinecode"><span class="id" title="var">input_valid_transition</span></span>.

<div class="paragraph"> </div>

Input validity requires that the <span class="inlinecode"><span class="id" title="var">valid</span></span> predicate holds for the
given inputs and that they have a <span class="inlinecode"><span class="id" title="var">valid_state</span></span> and a <span class="inlinecode"><span class="id" title="var">valid_message</span></span>.

</div><pre class="alectryon-io highlight"><!-- Generator: Alectryon --><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Definition</span> <span class="nf">input_valid</span>
               (<span class="nv">l</span> : label)
               (<span class="nv">som</span> : state * option message)
      : <span class="kt">Prop</span>
      :=
      <span class="kr">let</span> (<span class="nv">s</span>, om) := som <span class="kr">in</span>
         valid_state_prop s
      /\ option_valid_message_prop om
      /\ valid l (s,om).</span></span></pre><div class="doc">
Input valid transitions are transitions with <span class="inlinecode"><span class="id" title="var">input_valid</span></span> inputs. 
</div><pre class="alectryon-io highlight"><!-- Generator: Alectryon --><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Definition</span> <span class="nf">input_valid_transition</span>
      (<span class="nv">l</span> : label)
      (<span class="nv">som</span> : state * option message)
      (<span class="nv">som&#39;</span> : state * option message)
      :=
      input_valid l som
      /\  transition l som = som&#39;.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
</span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Definition</span> <span class="nf">input_valid_transition_item</span>
      (<span class="nv">s</span> : state)
      (<span class="nv">item</span> : transition_item)
      :=
      input_valid_transition (l item) (s, input item) (destination item, output item).</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
</span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Definition</span> <span class="nf">input_valid_transition_preserving</span>
      (<span class="nv">R</span> : state -&gt; state -&gt; <span class="kt">Prop</span>)
      : <span class="kt">Prop</span>
      :=
      <span class="kr">forall</span>
        (<span class="nv">s1</span> <span class="nv">s2</span> : state)
        (<span class="nv">l</span> : label)
        (<span class="nv">om1</span> <span class="nv">om2</span> : option message)
        (<span class="nv">Hvalid_transition</span>: input_valid_transition l (s1, om1) (s2, om2)),
        R s1 s2.</span></span></pre><div class="doc">
  Next three lemmas show the two definitions above are strongly related.

</div><pre class="alectryon-io highlight"><!-- Generator: Alectryon --><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="VLSM-v-chk84" style="display: none" type="checkbox"><label class="alectryon-input" for="VLSM-v-chk84"><span class="kn">Lemma</span> <span class="nf">input_valid_transition_valid</span>
      (<span class="nv">l</span> : label)
      (<span class="nv">som</span> : state * option message)
      (<span class="nv">som&#39;</span> : state * option message)
      (<span class="nv">Ht</span> : input_valid_transition l som som&#39;)
      : input_valid l som.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>message</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>X</var><span class="hyp-type"><b>: </b><span>VLSM message</span></span></span><br><span><var>TypeX</var><span><span class="hyp-body"><b>:= </b><span>type X</span></span><span class="hyp-type"><b>: </b><span>VLSMType message</span></span></span></span><br><span><var>MachineX</var><span><span class="hyp-body"><b>:= </b><span>machine X</span></span><span class="hyp-type"><b>: </b><span>VLSMMachine (vtype X)</span></span></span></span><br><span><var>l</var><span class="hyp-type"><b>: </b><span>label</span></span></span><br><span><var>som, som'</var><span class="hyp-type"><b>: </b><span>(state * option message)%type</span></span></span><br><span><var>Ht</var><span class="hyp-type"><b>: </b><span>input_valid_transition l som som&#39;</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">input_valid l som</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="VLSM-v-chk85" style="display: none" type="checkbox"><label class="alectryon-input" for="VLSM-v-chk85"><span class="kn">Proof</span>.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>message</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>X</var><span class="hyp-type"><b>: </b><span>VLSM message</span></span></span><br><span><var>TypeX</var><span><span class="hyp-body"><b>:= </b><span>type X</span></span><span class="hyp-type"><b>: </b><span>VLSMType message</span></span></span></span><br><span><var>MachineX</var><span><span class="hyp-body"><b>:= </b><span>machine X</span></span><span class="hyp-type"><b>: </b><span>VLSMMachine (vtype X)</span></span></span></span><br><span><var>l</var><span class="hyp-type"><b>: </b><span>label</span></span></span><br><span><var>som, som'</var><span class="hyp-type"><b>: </b><span>(state * option message)%type</span></span></span><br><span><var>Ht</var><span class="hyp-type"><b>: </b><span>input_valid_transition l som som&#39;</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">input_valid l som</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">      </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="VLSM-v-chk86" style="display: none" type="checkbox"><label class="alectryon-input" for="VLSM-v-chk86"><span class="nb">destruct</span> Ht <span class="kr">as</span> [Hpv Ht].</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>message</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>X</var><span class="hyp-type"><b>: </b><span>VLSM message</span></span></span><br><span><var>TypeX</var><span><span class="hyp-body"><b>:= </b><span>type X</span></span><span class="hyp-type"><b>: </b><span>VLSMType message</span></span></span></span><br><span><var>MachineX</var><span><span class="hyp-body"><b>:= </b><span>machine X</span></span><span class="hyp-type"><b>: </b><span>VLSMMachine (vtype X)</span></span></span></span><br><span><var>l</var><span class="hyp-type"><b>: </b><span>label</span></span></span><br><span><var>som, som'</var><span class="hyp-type"><b>: </b><span>(state * option message)%type</span></span></span><br><span><var>Hpv</var><span class="hyp-type"><b>: </b><span>input_valid l som</span></span></span><br><span><var>Ht</var><span class="hyp-type"><b>: </b><span>transition l som = som&#39;</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">input_valid l som</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">      </span><span class="alectryon-sentence"><span class="alectryon-input"><span class="bp">assumption</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Qed</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
</span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="VLSM-v-chk87" style="display: none" type="checkbox"><label class="alectryon-input" for="VLSM-v-chk87"><span class="kn">Lemma</span> <span class="nf">input_valid_can_transition</span>
      (<span class="nv">l</span> : label)
      (<span class="nv">som</span> : state * option message)
      (<span class="nv">Hv</span> : input_valid l som)
      : <span class="kr">forall</span> <span class="nv">som&#39;</span>, transition l som = som&#39; -&gt;
        input_valid_transition l som som&#39;.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>message</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>X</var><span class="hyp-type"><b>: </b><span>VLSM message</span></span></span><br><span><var>TypeX</var><span><span class="hyp-body"><b>:= </b><span>type X</span></span><span class="hyp-type"><b>: </b><span>VLSMType message</span></span></span></span><br><span><var>MachineX</var><span><span class="hyp-body"><b>:= </b><span>machine X</span></span><span class="hyp-type"><b>: </b><span>VLSMMachine (vtype X)</span></span></span></span><br><span><var>l</var><span class="hyp-type"><b>: </b><span>label</span></span></span><br><span><var>som</var><span class="hyp-type"><b>: </b><span>(state * option message)%type</span></span></span><br><span><var>Hv</var><span class="hyp-type"><b>: </b><span>input_valid l som</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="kr">‚àÄ</span> <span class="nv">som&#39;</span> : state * option message,
  transition l som = som&#39;
  ‚Üí input_valid_transition l som som&#39;</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="VLSM-v-chk88" style="display: none" type="checkbox"><label class="alectryon-input" for="VLSM-v-chk88"><span class="kn">Proof</span>.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>message</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>X</var><span class="hyp-type"><b>: </b><span>VLSM message</span></span></span><br><span><var>TypeX</var><span><span class="hyp-body"><b>:= </b><span>type X</span></span><span class="hyp-type"><b>: </b><span>VLSMType message</span></span></span></span><br><span><var>MachineX</var><span><span class="hyp-body"><b>:= </b><span>machine X</span></span><span class="hyp-type"><b>: </b><span>VLSMMachine (vtype X)</span></span></span></span><br><span><var>l</var><span class="hyp-type"><b>: </b><span>label</span></span></span><br><span><var>som</var><span class="hyp-type"><b>: </b><span>(state * option message)%type</span></span></span><br><span><var>Hv</var><span class="hyp-type"><b>: </b><span>input_valid l som</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="kr">‚àÄ</span> <span class="nv">som&#39;</span> : state * option message,
  transition l som = som&#39;
  ‚Üí input_valid_transition l som som&#39;</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">      </span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kp">repeat</span> <span class="nb">split</span>; <span class="bp">assumption</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Qed</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
</span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="VLSM-v-chk89" style="display: none" type="checkbox"><label class="alectryon-input" for="VLSM-v-chk89"><span class="kn">Lemma</span> <span class="nf">input_valid_transition_iff</span>
      (<span class="nv">l</span> : label)
      (<span class="nv">som</span> : state * option message)
      : input_valid l som
      &lt;-&gt; <span class="kr">exists</span> (<span class="nv">som&#39;</span> : state * option message),
            input_valid_transition l som som&#39;.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>message</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>X</var><span class="hyp-type"><b>: </b><span>VLSM message</span></span></span><br><span><var>TypeX</var><span><span class="hyp-body"><b>:= </b><span>type X</span></span><span class="hyp-type"><b>: </b><span>VLSMType message</span></span></span></span><br><span><var>MachineX</var><span><span class="hyp-body"><b>:= </b><span>machine X</span></span><span class="hyp-type"><b>: </b><span>VLSMMachine (vtype X)</span></span></span></span><br><span><var>l</var><span class="hyp-type"><b>: </b><span>label</span></span></span><br><span><var>som</var><span class="hyp-type"><b>: </b><span>(state * option message)%type</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">input_valid l som
‚Üî (<span class="kr">‚àÉ</span> <span class="nv">som&#39;</span> : state * option message,
     input_valid_transition l som som&#39;)</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="VLSM-v-chk8a" style="display: none" type="checkbox"><label class="alectryon-input" for="VLSM-v-chk8a"><span class="kn">Proof</span>.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>message</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>X</var><span class="hyp-type"><b>: </b><span>VLSM message</span></span></span><br><span><var>TypeX</var><span><span class="hyp-body"><b>:= </b><span>type X</span></span><span class="hyp-type"><b>: </b><span>VLSMType message</span></span></span></span><br><span><var>MachineX</var><span><span class="hyp-body"><b>:= </b><span>machine X</span></span><span class="hyp-type"><b>: </b><span>VLSMMachine (vtype X)</span></span></span></span><br><span><var>l</var><span class="hyp-type"><b>: </b><span>label</span></span></span><br><span><var>som</var><span class="hyp-type"><b>: </b><span>(state * option message)%type</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">input_valid l som
‚Üî (<span class="kr">‚àÉ</span> <span class="nv">som&#39;</span> : state * option message,
     input_valid_transition l som som&#39;)</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">      </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="VLSM-v-chk8b" style="display: none" type="checkbox"><label class="alectryon-input" for="VLSM-v-chk8b"><span class="nb">split</span>.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>message</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>X</var><span class="hyp-type"><b>: </b><span>VLSM message</span></span></span><br><span><var>TypeX</var><span><span class="hyp-body"><b>:= </b><span>type X</span></span><span class="hyp-type"><b>: </b><span>VLSMType message</span></span></span></span><br><span><var>MachineX</var><span><span class="hyp-body"><b>:= </b><span>machine X</span></span><span class="hyp-type"><b>: </b><span>VLSMMachine (vtype X)</span></span></span></span><br><span><var>l</var><span class="hyp-type"><b>: </b><span>label</span></span></span><br><span><var>som</var><span class="hyp-type"><b>: </b><span>(state * option message)%type</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">input_valid l som
‚Üí <span class="kr">‚àÉ</span> <span class="nv">som&#39;</span> : state * option message,
    input_valid_transition l som som&#39;</div></blockquote><div class="alectryon-extra-goals"><input class="alectryon-extra-goal-toggle" id="VLSM-v-chk8c" style="display: none" type="checkbox"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>message</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>X</var><span class="hyp-type"><b>: </b><span>VLSM message</span></span></span><br><span><var>TypeX</var><span><span class="hyp-body"><b>:= </b><span>type X</span></span><span class="hyp-type"><b>: </b><span>VLSMType message</span></span></span></span><br><span><var>MachineX</var><span><span class="hyp-body"><b>:= </b><span>machine X</span></span><span class="hyp-type"><b>: </b><span>VLSMMachine (vtype X)</span></span></span></span><br><span><var>l</var><span class="hyp-type"><b>: </b><span>label</span></span></span><br><span><var>som</var><span class="hyp-type"><b>: </b><span>(state * option message)%type</span></span></span><br></div><label class="goal-separator" for="VLSM-v-chk8c"><hr></label><div class="goal-conclusion">(<span class="kr">‚àÉ</span> <span class="nv">som&#39;</span> : state * option message,
   input_valid_transition l som som&#39;)
‚Üí input_valid l som</div></blockquote></div></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">      </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="VLSM-v-chk8d" style="display: none" type="checkbox"><label class="alectryon-input" for="VLSM-v-chk8d">-</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>message</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>X</var><span class="hyp-type"><b>: </b><span>VLSM message</span></span></span><br><span><var>TypeX</var><span><span class="hyp-body"><b>:= </b><span>type X</span></span><span class="hyp-type"><b>: </b><span>VLSMType message</span></span></span></span><br><span><var>MachineX</var><span><span class="hyp-body"><b>:= </b><span>machine X</span></span><span class="hyp-type"><b>: </b><span>VLSMMachine (vtype X)</span></span></span></span><br><span><var>l</var><span class="hyp-type"><b>: </b><span>label</span></span></span><br><span><var>som</var><span class="hyp-type"><b>: </b><span>(state * option message)%type</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">input_valid l som
‚Üí <span class="kr">‚àÉ</span> <span class="nv">som&#39;</span> : state * option message,
    input_valid_transition l som som&#39;</div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="VLSM-v-chk8e" style="display: none" type="checkbox"><label class="alectryon-input" for="VLSM-v-chk8e"><span class="nb">eexists</span>.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>message</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>X</var><span class="hyp-type"><b>: </b><span>VLSM message</span></span></span><br><span><var>TypeX</var><span><span class="hyp-body"><b>:= </b><span>type X</span></span><span class="hyp-type"><b>: </b><span>VLSMType message</span></span></span></span><br><span><var>MachineX</var><span><span class="hyp-body"><b>:= </b><span>machine X</span></span><span class="hyp-type"><b>: </b><span>VLSMMachine (vtype X)</span></span></span></span><br><span><var>l</var><span class="hyp-type"><b>: </b><span>label</span></span></span><br><span><var>som</var><span class="hyp-type"><b>: </b><span>(state * option message)%type</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>input_valid l som</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">input_valid_transition l som <span class="nl">?som&#39;</span></div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">        </span><span class="alectryon-sentence"><span class="alectryon-input"><span class="nb">apply</span> input_valid_can_transition; [<span class="bp">assumption</span>|<span class="bp">reflexivity</span>].</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">      </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="VLSM-v-chk8f" style="display: none" type="checkbox"><label class="alectryon-input" for="VLSM-v-chk8f">-</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>message</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>X</var><span class="hyp-type"><b>: </b><span>VLSM message</span></span></span><br><span><var>TypeX</var><span><span class="hyp-body"><b>:= </b><span>type X</span></span><span class="hyp-type"><b>: </b><span>VLSMType message</span></span></span></span><br><span><var>MachineX</var><span><span class="hyp-body"><b>:= </b><span>machine X</span></span><span class="hyp-type"><b>: </b><span>VLSMMachine (vtype X)</span></span></span></span><br><span><var>l</var><span class="hyp-type"><b>: </b><span>label</span></span></span><br><span><var>som</var><span class="hyp-type"><b>: </b><span>(state * option message)%type</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">(<span class="kr">‚àÉ</span> <span class="nv">som&#39;</span> : state * option message,
   input_valid_transition l som som&#39;)
‚Üí input_valid l som</div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="VLSM-v-chk90" style="display: none" type="checkbox"><label class="alectryon-input" for="VLSM-v-chk90"><span class="nb">intros</span> [som&#39; Hivt].</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>message</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>X</var><span class="hyp-type"><b>: </b><span>VLSM message</span></span></span><br><span><var>TypeX</var><span><span class="hyp-body"><b>:= </b><span>type X</span></span><span class="hyp-type"><b>: </b><span>VLSMType message</span></span></span></span><br><span><var>MachineX</var><span><span class="hyp-body"><b>:= </b><span>machine X</span></span><span class="hyp-type"><b>: </b><span>VLSMMachine (vtype X)</span></span></span></span><br><span><var>l</var><span class="hyp-type"><b>: </b><span>label</span></span></span><br><span><var>som, som'</var><span class="hyp-type"><b>: </b><span>(state * option message)%type</span></span></span><br><span><var>Hivt</var><span class="hyp-type"><b>: </b><span>input_valid_transition l som som&#39;</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">input_valid l som</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">        </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="VLSM-v-chk91" style="display: none" type="checkbox"><label class="alectryon-input" for="VLSM-v-chk91"><span class="nb">apply</span> input_valid_transition_valid <span class="kr">with</span> som&#39;.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>message</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>X</var><span class="hyp-type"><b>: </b><span>VLSM message</span></span></span><br><span><var>TypeX</var><span><span class="hyp-body"><b>:= </b><span>type X</span></span><span class="hyp-type"><b>: </b><span>VLSMType message</span></span></span></span><br><span><var>MachineX</var><span><span class="hyp-body"><b>:= </b><span>machine X</span></span><span class="hyp-type"><b>: </b><span>VLSMMachine (vtype X)</span></span></span></span><br><span><var>l</var><span class="hyp-type"><b>: </b><span>label</span></span></span><br><span><var>som, som'</var><span class="hyp-type"><b>: </b><span>(state * option message)%type</span></span></span><br><span><var>Hivt</var><span class="hyp-type"><b>: </b><span>input_valid_transition l som som&#39;</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">input_valid_transition l som som&#39;</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">        </span><span class="alectryon-sentence"><span class="alectryon-input"><span class="bp">assumption</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Qed</span>.</span></span></pre><div class="doc">
<div class="paragraph"> </div>

The next couple of lemmas relate the two definitions above with
pre-existing concepts.

<div class="paragraph"> </div>
</div><pre class="alectryon-io highlight"><!-- Generator: Alectryon --><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="VLSM-v-chk92" style="display: none" type="checkbox"><label class="alectryon-input" for="VLSM-v-chk92"><span class="kn">Lemma</span> <span class="nf">input_valid_transition_origin</span>
          {<span class="nv">l</span> : label}
          {<span class="nv">s</span> <span class="nv">s&#39;</span> : state}
          {<span class="nv">om</span> <span class="nv">om&#39;</span> : option message}
          (<span class="nv">Ht</span> : input_valid_transition l (s, om) (s&#39;,om&#39;))
      : valid_state_prop s.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>message</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>X</var><span class="hyp-type"><b>: </b><span>VLSM message</span></span></span><br><span><var>TypeX</var><span><span class="hyp-body"><b>:= </b><span>type X</span></span><span class="hyp-type"><b>: </b><span>VLSMType message</span></span></span></span><br><span><var>MachineX</var><span><span class="hyp-body"><b>:= </b><span>machine X</span></span><span class="hyp-type"><b>: </b><span>VLSMMachine (vtype X)</span></span></span></span><br><span><var>l</var><span class="hyp-type"><b>: </b><span>label</span></span></span><br><span><var>s, s'</var><span class="hyp-type"><b>: </b><span>state</span></span></span><br><span><var>om, om'</var><span class="hyp-type"><b>: </b><span>option message</span></span></span><br><span><var>Ht</var><span class="hyp-type"><b>: </b><span>input_valid_transition l (s, om) (s&#39;, om&#39;)</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">valid_state_prop s</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="VLSM-v-chk93" style="display: none" type="checkbox"><label class="alectryon-input" for="VLSM-v-chk93"><span class="kn">Proof</span>.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>message</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>X</var><span class="hyp-type"><b>: </b><span>VLSM message</span></span></span><br><span><var>TypeX</var><span><span class="hyp-body"><b>:= </b><span>type X</span></span><span class="hyp-type"><b>: </b><span>VLSMType message</span></span></span></span><br><span><var>MachineX</var><span><span class="hyp-body"><b>:= </b><span>machine X</span></span><span class="hyp-type"><b>: </b><span>VLSMMachine (vtype X)</span></span></span></span><br><span><var>l</var><span class="hyp-type"><b>: </b><span>label</span></span></span><br><span><var>s, s'</var><span class="hyp-type"><b>: </b><span>state</span></span></span><br><span><var>om, om'</var><span class="hyp-type"><b>: </b><span>option message</span></span></span><br><span><var>Ht</var><span class="hyp-type"><b>: </b><span>input_valid_transition l (s, om) (s&#39;, om&#39;)</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">valid_state_prop s</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">      </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="VLSM-v-chk94" style="display: none" type="checkbox"><label class="alectryon-input" for="VLSM-v-chk94"><span class="nb">destruct</span> Ht <span class="kr">as</span> [[[_om Hp] _] _].</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>message</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>X</var><span class="hyp-type"><b>: </b><span>VLSM message</span></span></span><br><span><var>TypeX</var><span><span class="hyp-body"><b>:= </b><span>type X</span></span><span class="hyp-type"><b>: </b><span>VLSMType message</span></span></span></span><br><span><var>MachineX</var><span><span class="hyp-body"><b>:= </b><span>machine X</span></span><span class="hyp-type"><b>: </b><span>VLSMMachine (vtype X)</span></span></span></span><br><span><var>l</var><span class="hyp-type"><b>: </b><span>label</span></span></span><br><span><var>s, s'</var><span class="hyp-type"><b>: </b><span>state</span></span></span><br><span><var>om, om', _om</var><span class="hyp-type"><b>: </b><span>option message</span></span></span><br><span><var>Hp</var><span class="hyp-type"><b>: </b><span>valid_state_message_prop s _om</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">valid_state_prop s</div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="VLSM-v-chk95" style="display: none" type="checkbox"><label class="alectryon-input" for="VLSM-v-chk95"><span class="kr">exists</span> <span class="nv">_om</span>.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>message</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>X</var><span class="hyp-type"><b>: </b><span>VLSM message</span></span></span><br><span><var>TypeX</var><span><span class="hyp-body"><b>:= </b><span>type X</span></span><span class="hyp-type"><b>: </b><span>VLSMType message</span></span></span></span><br><span><var>MachineX</var><span><span class="hyp-body"><b>:= </b><span>machine X</span></span><span class="hyp-type"><b>: </b><span>VLSMMachine (vtype X)</span></span></span></span><br><span><var>l</var><span class="hyp-type"><b>: </b><span>label</span></span></span><br><span><var>s, s'</var><span class="hyp-type"><b>: </b><span>state</span></span></span><br><span><var>om, om', _om</var><span class="hyp-type"><b>: </b><span>option message</span></span></span><br><span><var>Hp</var><span class="hyp-type"><b>: </b><span>valid_state_message_prop s _om</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">valid_state_message_prop s _om</div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="bp">assumption</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Qed</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
</span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="VLSM-v-chk96" style="display: none" type="checkbox"><label class="alectryon-input" for="VLSM-v-chk96"><span class="kn">Lemma</span> <span class="nf">input_valid_transition_destination</span>
          {<span class="nv">l</span> : label}
          {<span class="nv">s</span> <span class="nv">s&#39;</span> : state}
          {<span class="nv">om</span> <span class="nv">om&#39;</span> : option message}
          (<span class="nv">Ht</span> : input_valid_transition l (s, om) (s&#39;, om&#39;))
      : valid_state_prop s&#39;.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>message</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>X</var><span class="hyp-type"><b>: </b><span>VLSM message</span></span></span><br><span><var>TypeX</var><span><span class="hyp-body"><b>:= </b><span>type X</span></span><span class="hyp-type"><b>: </b><span>VLSMType message</span></span></span></span><br><span><var>MachineX</var><span><span class="hyp-body"><b>:= </b><span>machine X</span></span><span class="hyp-type"><b>: </b><span>VLSMMachine (vtype X)</span></span></span></span><br><span><var>l</var><span class="hyp-type"><b>: </b><span>label</span></span></span><br><span><var>s, s'</var><span class="hyp-type"><b>: </b><span>state</span></span></span><br><span><var>om, om'</var><span class="hyp-type"><b>: </b><span>option message</span></span></span><br><span><var>Ht</var><span class="hyp-type"><b>: </b><span>input_valid_transition l (s, om) (s&#39;, om&#39;)</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">valid_state_prop s&#39;</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="VLSM-v-chk97" style="display: none" type="checkbox"><label class="alectryon-input" for="VLSM-v-chk97"><span class="kn">Proof</span>.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>message</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>X</var><span class="hyp-type"><b>: </b><span>VLSM message</span></span></span><br><span><var>TypeX</var><span><span class="hyp-body"><b>:= </b><span>type X</span></span><span class="hyp-type"><b>: </b><span>VLSMType message</span></span></span></span><br><span><var>MachineX</var><span><span class="hyp-body"><b>:= </b><span>machine X</span></span><span class="hyp-type"><b>: </b><span>VLSMMachine (vtype X)</span></span></span></span><br><span><var>l</var><span class="hyp-type"><b>: </b><span>label</span></span></span><br><span><var>s, s'</var><span class="hyp-type"><b>: </b><span>state</span></span></span><br><span><var>om, om'</var><span class="hyp-type"><b>: </b><span>option message</span></span></span><br><span><var>Ht</var><span class="hyp-type"><b>: </b><span>input_valid_transition l (s, om) (s&#39;, om&#39;)</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">valid_state_prop s&#39;</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">      </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="VLSM-v-chk98" style="display: none" type="checkbox"><label class="alectryon-input" for="VLSM-v-chk98"><span class="kr">exists</span> <span class="nv">om&#39;</span>.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>message</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>X</var><span class="hyp-type"><b>: </b><span>VLSM message</span></span></span><br><span><var>TypeX</var><span><span class="hyp-body"><b>:= </b><span>type X</span></span><span class="hyp-type"><b>: </b><span>VLSMType message</span></span></span></span><br><span><var>MachineX</var><span><span class="hyp-body"><b>:= </b><span>machine X</span></span><span class="hyp-type"><b>: </b><span>VLSMMachine (vtype X)</span></span></span></span><br><span><var>l</var><span class="hyp-type"><b>: </b><span>label</span></span></span><br><span><var>s, s'</var><span class="hyp-type"><b>: </b><span>state</span></span></span><br><span><var>om, om'</var><span class="hyp-type"><b>: </b><span>option message</span></span></span><br><span><var>Ht</var><span class="hyp-type"><b>: </b><span>input_valid_transition l (s, om) (s&#39;, om&#39;)</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">valid_state_message_prop s&#39; om&#39;</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">      </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="VLSM-v-chk99" style="display: none" type="checkbox"><label class="alectryon-input" for="VLSM-v-chk99"><span class="nb">destruct</span> Ht <span class="kr">as</span> [[[_om Hs] [[_s Hom] Hv]] Ht].</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>message</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>X</var><span class="hyp-type"><b>: </b><span>VLSM message</span></span></span><br><span><var>TypeX</var><span><span class="hyp-body"><b>:= </b><span>type X</span></span><span class="hyp-type"><b>: </b><span>VLSMType message</span></span></span></span><br><span><var>MachineX</var><span><span class="hyp-body"><b>:= </b><span>machine X</span></span><span class="hyp-type"><b>: </b><span>VLSMMachine (vtype X)</span></span></span></span><br><span><var>l</var><span class="hyp-type"><b>: </b><span>label</span></span></span><br><span><var>s, s'</var><span class="hyp-type"><b>: </b><span>state</span></span></span><br><span><var>om, om', _om</var><span class="hyp-type"><b>: </b><span>option message</span></span></span><br><span><var>Hs</var><span class="hyp-type"><b>: </b><span>valid_state_message_prop s _om</span></span></span><br><span><var>_s</var><span class="hyp-type"><b>: </b><span>state</span></span></span><br><span><var>Hom</var><span class="hyp-type"><b>: </b><span>valid_state_message_prop _s om</span></span></span><br><span><var>Hv</var><span class="hyp-type"><b>: </b><span>valid l (s, om)</span></span></span><br><span><var>Ht</var><span class="hyp-type"><b>: </b><span>transition l (s, om) = (s&#39;, om&#39;)</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">valid_state_message_prop s&#39; om&#39;</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">      </span><span class="alectryon-sentence"><span class="alectryon-input"><span class="nb">apply</span> valid_generated_state_message <span class="kr">with</span> s _om _s om l; <span class="bp">assumption</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Qed</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
</span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="VLSM-v-chk9a" style="display: none" type="checkbox"><label class="alectryon-input" for="VLSM-v-chk9a"><span class="kn">Lemma</span> <span class="nf">input_valid_transition_in</span>
          {<span class="nv">l</span> : label}
          {<span class="nv">s</span> <span class="nv">s&#39;</span> : state}
          {<span class="nv">om</span> <span class="nv">om&#39;</span> : option message}
          (<span class="nv">Ht</span> : input_valid_transition l (s, om) (s&#39;, om&#39;))
      : option_valid_message_prop om.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>message</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>X</var><span class="hyp-type"><b>: </b><span>VLSM message</span></span></span><br><span><var>TypeX</var><span><span class="hyp-body"><b>:= </b><span>type X</span></span><span class="hyp-type"><b>: </b><span>VLSMType message</span></span></span></span><br><span><var>MachineX</var><span><span class="hyp-body"><b>:= </b><span>machine X</span></span><span class="hyp-type"><b>: </b><span>VLSMMachine (vtype X)</span></span></span></span><br><span><var>l</var><span class="hyp-type"><b>: </b><span>label</span></span></span><br><span><var>s, s'</var><span class="hyp-type"><b>: </b><span>state</span></span></span><br><span><var>om, om'</var><span class="hyp-type"><b>: </b><span>option message</span></span></span><br><span><var>Ht</var><span class="hyp-type"><b>: </b><span>input_valid_transition l (s, om) (s&#39;, om&#39;)</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">option_valid_message_prop om</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="VLSM-v-chk9b" style="display: none" type="checkbox"><label class="alectryon-input" for="VLSM-v-chk9b"><span class="kn">Proof</span>.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>message</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>X</var><span class="hyp-type"><b>: </b><span>VLSM message</span></span></span><br><span><var>TypeX</var><span><span class="hyp-body"><b>:= </b><span>type X</span></span><span class="hyp-type"><b>: </b><span>VLSMType message</span></span></span></span><br><span><var>MachineX</var><span><span class="hyp-body"><b>:= </b><span>machine X</span></span><span class="hyp-type"><b>: </b><span>VLSMMachine (vtype X)</span></span></span></span><br><span><var>l</var><span class="hyp-type"><b>: </b><span>label</span></span></span><br><span><var>s, s'</var><span class="hyp-type"><b>: </b><span>state</span></span></span><br><span><var>om, om'</var><span class="hyp-type"><b>: </b><span>option message</span></span></span><br><span><var>Ht</var><span class="hyp-type"><b>: </b><span>input_valid_transition l (s, om) (s&#39;, om&#39;)</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">option_valid_message_prop om</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">      </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="VLSM-v-chk9c" style="display: none" type="checkbox"><label class="alectryon-input" for="VLSM-v-chk9c"><span class="nb">destruct</span> Ht <span class="kr">as</span> [[_ [[_s Hom] _]] _].</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>message</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>X</var><span class="hyp-type"><b>: </b><span>VLSM message</span></span></span><br><span><var>TypeX</var><span><span class="hyp-body"><b>:= </b><span>type X</span></span><span class="hyp-type"><b>: </b><span>VLSMType message</span></span></span></span><br><span><var>MachineX</var><span><span class="hyp-body"><b>:= </b><span>machine X</span></span><span class="hyp-type"><b>: </b><span>VLSMMachine (vtype X)</span></span></span></span><br><span><var>l</var><span class="hyp-type"><b>: </b><span>label</span></span></span><br><span><var>s, s'</var><span class="hyp-type"><b>: </b><span>state</span></span></span><br><span><var>om, om'</var><span class="hyp-type"><b>: </b><span>option message</span></span></span><br><span><var>_s</var><span class="hyp-type"><b>: </b><span>state</span></span></span><br><span><var>Hom</var><span class="hyp-type"><b>: </b><span>valid_state_message_prop _s om</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">option_valid_message_prop om</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">      </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="VLSM-v-chk9d" style="display: none" type="checkbox"><label class="alectryon-input" for="VLSM-v-chk9d"><span class="kr">exists</span> <span class="nv">_s</span>.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>message</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>X</var><span class="hyp-type"><b>: </b><span>VLSM message</span></span></span><br><span><var>TypeX</var><span><span class="hyp-body"><b>:= </b><span>type X</span></span><span class="hyp-type"><b>: </b><span>VLSMType message</span></span></span></span><br><span><var>MachineX</var><span><span class="hyp-body"><b>:= </b><span>machine X</span></span><span class="hyp-type"><b>: </b><span>VLSMMachine (vtype X)</span></span></span></span><br><span><var>l</var><span class="hyp-type"><b>: </b><span>label</span></span></span><br><span><var>s, s'</var><span class="hyp-type"><b>: </b><span>state</span></span></span><br><span><var>om, om'</var><span class="hyp-type"><b>: </b><span>option message</span></span></span><br><span><var>_s</var><span class="hyp-type"><b>: </b><span>state</span></span></span><br><span><var>Hom</var><span class="hyp-type"><b>: </b><span>valid_state_message_prop _s om</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">valid_state_message_prop _s om</div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="bp">assumption</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Qed</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
</span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="VLSM-v-chk9e" style="display: none" type="checkbox"><label class="alectryon-input" for="VLSM-v-chk9e"><span class="kn">Lemma</span> <span class="nf">input_valid_transition_outputs_valid_state_message</span>
          {<span class="nv">l</span> : label}
          {<span class="nv">s</span> <span class="nv">s&#39;</span> : state}
          {<span class="nv">om</span> <span class="nv">om&#39;</span> : option message}
          (<span class="nv">Ht</span> : input_valid_transition l (s, om) (s&#39;, om&#39;))
        : valid_state_message_prop s&#39; om&#39;.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>message</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>X</var><span class="hyp-type"><b>: </b><span>VLSM message</span></span></span><br><span><var>TypeX</var><span><span class="hyp-body"><b>:= </b><span>type X</span></span><span class="hyp-type"><b>: </b><span>VLSMType message</span></span></span></span><br><span><var>MachineX</var><span><span class="hyp-body"><b>:= </b><span>machine X</span></span><span class="hyp-type"><b>: </b><span>VLSMMachine (vtype X)</span></span></span></span><br><span><var>l</var><span class="hyp-type"><b>: </b><span>label</span></span></span><br><span><var>s, s'</var><span class="hyp-type"><b>: </b><span>state</span></span></span><br><span><var>om, om'</var><span class="hyp-type"><b>: </b><span>option message</span></span></span><br><span><var>Ht</var><span class="hyp-type"><b>: </b><span>input_valid_transition l (s, om) (s&#39;, om&#39;)</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">valid_state_message_prop s&#39; om&#39;</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="VLSM-v-chk9f" style="display: none" type="checkbox"><label class="alectryon-input" for="VLSM-v-chk9f"><span class="kn">Proof</span>.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>message</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>X</var><span class="hyp-type"><b>: </b><span>VLSM message</span></span></span><br><span><var>TypeX</var><span><span class="hyp-body"><b>:= </b><span>type X</span></span><span class="hyp-type"><b>: </b><span>VLSMType message</span></span></span></span><br><span><var>MachineX</var><span><span class="hyp-body"><b>:= </b><span>machine X</span></span><span class="hyp-type"><b>: </b><span>VLSMMachine (vtype X)</span></span></span></span><br><span><var>l</var><span class="hyp-type"><b>: </b><span>label</span></span></span><br><span><var>s, s'</var><span class="hyp-type"><b>: </b><span>state</span></span></span><br><span><var>om, om'</var><span class="hyp-type"><b>: </b><span>option message</span></span></span><br><span><var>Ht</var><span class="hyp-type"><b>: </b><span>input_valid_transition l (s, om) (s&#39;, om&#39;)</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">valid_state_message_prop s&#39; om&#39;</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">      </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="VLSM-v-chka0" style="display: none" type="checkbox"><label class="alectryon-input" for="VLSM-v-chka0"><span class="nb">destruct</span> Ht <span class="kr">as</span> [[[_om Hps] [[_s Hpm] Hv]] Ht].</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>message</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>X</var><span class="hyp-type"><b>: </b><span>VLSM message</span></span></span><br><span><var>TypeX</var><span><span class="hyp-body"><b>:= </b><span>type X</span></span><span class="hyp-type"><b>: </b><span>VLSMType message</span></span></span></span><br><span><var>MachineX</var><span><span class="hyp-body"><b>:= </b><span>machine X</span></span><span class="hyp-type"><b>: </b><span>VLSMMachine (vtype X)</span></span></span></span><br><span><var>l</var><span class="hyp-type"><b>: </b><span>label</span></span></span><br><span><var>s, s'</var><span class="hyp-type"><b>: </b><span>state</span></span></span><br><span><var>om, om', _om</var><span class="hyp-type"><b>: </b><span>option message</span></span></span><br><span><var>Hps</var><span class="hyp-type"><b>: </b><span>valid_state_message_prop s _om</span></span></span><br><span><var>_s</var><span class="hyp-type"><b>: </b><span>state</span></span></span><br><span><var>Hpm</var><span class="hyp-type"><b>: </b><span>valid_state_message_prop _s om</span></span></span><br><span><var>Hv</var><span class="hyp-type"><b>: </b><span>valid l (s, om)</span></span></span><br><span><var>Ht</var><span class="hyp-type"><b>: </b><span>transition l (s, om) = (s&#39;, om&#39;)</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">valid_state_message_prop s&#39; om&#39;</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">      </span><span class="alectryon-sentence"><span class="alectryon-input"><span class="nb">apply</span> valid_generated_state_message <span class="kr">with</span> s _om _s om l; <span class="bp">assumption</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Qed</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
</span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="VLSM-v-chka1" style="display: none" type="checkbox"><label class="alectryon-input" for="VLSM-v-chka1"><span class="kn">Lemma</span> <span class="nf">input_valid_transition_out</span>
          {<span class="nv">l</span> : label}
          {<span class="nv">s</span> <span class="nv">s&#39;</span> : state}
          {<span class="nv">om</span> <span class="nv">om&#39;</span> : option message}
          (<span class="nv">Ht</span> : input_valid_transition l (s, om) (s&#39;, om&#39;))
      : option_valid_message_prop om&#39;.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>message</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>X</var><span class="hyp-type"><b>: </b><span>VLSM message</span></span></span><br><span><var>TypeX</var><span><span class="hyp-body"><b>:= </b><span>type X</span></span><span class="hyp-type"><b>: </b><span>VLSMType message</span></span></span></span><br><span><var>MachineX</var><span><span class="hyp-body"><b>:= </b><span>machine X</span></span><span class="hyp-type"><b>: </b><span>VLSMMachine (vtype X)</span></span></span></span><br><span><var>l</var><span class="hyp-type"><b>: </b><span>label</span></span></span><br><span><var>s, s'</var><span class="hyp-type"><b>: </b><span>state</span></span></span><br><span><var>om, om'</var><span class="hyp-type"><b>: </b><span>option message</span></span></span><br><span><var>Ht</var><span class="hyp-type"><b>: </b><span>input_valid_transition l (s, om) (s&#39;, om&#39;)</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">option_valid_message_prop om&#39;</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="VLSM-v-chka2" style="display: none" type="checkbox"><label class="alectryon-input" for="VLSM-v-chka2"><span class="kn">Proof</span>.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>message</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>X</var><span class="hyp-type"><b>: </b><span>VLSM message</span></span></span><br><span><var>TypeX</var><span><span class="hyp-body"><b>:= </b><span>type X</span></span><span class="hyp-type"><b>: </b><span>VLSMType message</span></span></span></span><br><span><var>MachineX</var><span><span class="hyp-body"><b>:= </b><span>machine X</span></span><span class="hyp-type"><b>: </b><span>VLSMMachine (vtype X)</span></span></span></span><br><span><var>l</var><span class="hyp-type"><b>: </b><span>label</span></span></span><br><span><var>s, s'</var><span class="hyp-type"><b>: </b><span>state</span></span></span><br><span><var>om, om'</var><span class="hyp-type"><b>: </b><span>option message</span></span></span><br><span><var>Ht</var><span class="hyp-type"><b>: </b><span>input_valid_transition l (s, om) (s&#39;, om&#39;)</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">option_valid_message_prop om&#39;</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">      </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="VLSM-v-chka3" style="display: none" type="checkbox"><label class="alectryon-input" for="VLSM-v-chka3"><span class="nb">apply</span> input_valid_transition_outputs_valid_state_message <span class="kr">in</span> Ht.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>message</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>X</var><span class="hyp-type"><b>: </b><span>VLSM message</span></span></span><br><span><var>TypeX</var><span><span class="hyp-body"><b>:= </b><span>type X</span></span><span class="hyp-type"><b>: </b><span>VLSMType message</span></span></span></span><br><span><var>MachineX</var><span><span class="hyp-body"><b>:= </b><span>machine X</span></span><span class="hyp-type"><b>: </b><span>VLSMMachine (vtype X)</span></span></span></span><br><span><var>l</var><span class="hyp-type"><b>: </b><span>label</span></span></span><br><span><var>s, s'</var><span class="hyp-type"><b>: </b><span>state</span></span></span><br><span><var>om, om'</var><span class="hyp-type"><b>: </b><span>option message</span></span></span><br><span><var>Ht</var><span class="hyp-type"><b>: </b><span>valid_state_message_prop s&#39; om&#39;</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">option_valid_message_prop om&#39;</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">      </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="VLSM-v-chka4" style="display: none" type="checkbox"><label class="alectryon-input" for="VLSM-v-chka4"><span class="kr">exists</span> <span class="nv">s&#39;</span>.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>message</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>X</var><span class="hyp-type"><b>: </b><span>VLSM message</span></span></span><br><span><var>TypeX</var><span><span class="hyp-body"><b>:= </b><span>type X</span></span><span class="hyp-type"><b>: </b><span>VLSMType message</span></span></span></span><br><span><var>MachineX</var><span><span class="hyp-body"><b>:= </b><span>machine X</span></span><span class="hyp-type"><b>: </b><span>VLSMMachine (vtype X)</span></span></span></span><br><span><var>l</var><span class="hyp-type"><b>: </b><span>label</span></span></span><br><span><var>s, s'</var><span class="hyp-type"><b>: </b><span>state</span></span></span><br><span><var>om, om'</var><span class="hyp-type"><b>: </b><span>option message</span></span></span><br><span><var>Ht</var><span class="hyp-type"><b>: </b><span>valid_state_message_prop s&#39; om&#39;</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">valid_state_message_prop s&#39; om&#39;</div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="bp">assumption</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Qed</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
</span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="VLSM-v-chka5" style="display: none" type="checkbox"><label class="alectryon-input" for="VLSM-v-chka5"><span class="kn">Lemma</span> <span class="nf">input_valid_transition_is_valid</span>
          {<span class="nv">l</span> : label}
          {<span class="nv">s</span> <span class="nv">s&#39;</span> : state}
          {<span class="nv">om</span> <span class="nv">om&#39;</span> : option message}
          (<span class="nv">Ht</span> : input_valid_transition l (s, om) (s&#39;, om&#39;))
      : valid l (s, om).</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>message</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>X</var><span class="hyp-type"><b>: </b><span>VLSM message</span></span></span><br><span><var>TypeX</var><span><span class="hyp-body"><b>:= </b><span>type X</span></span><span class="hyp-type"><b>: </b><span>VLSMType message</span></span></span></span><br><span><var>MachineX</var><span><span class="hyp-body"><b>:= </b><span>machine X</span></span><span class="hyp-type"><b>: </b><span>VLSMMachine (vtype X)</span></span></span></span><br><span><var>l</var><span class="hyp-type"><b>: </b><span>label</span></span></span><br><span><var>s, s'</var><span class="hyp-type"><b>: </b><span>state</span></span></span><br><span><var>om, om'</var><span class="hyp-type"><b>: </b><span>option message</span></span></span><br><span><var>Ht</var><span class="hyp-type"><b>: </b><span>input_valid_transition l (s, om) (s&#39;, om&#39;)</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">valid l (s, om)</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="VLSM-v-chka6" style="display: none" type="checkbox"><label class="alectryon-input" for="VLSM-v-chka6"><span class="kn">Proof</span>.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>message</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>X</var><span class="hyp-type"><b>: </b><span>VLSM message</span></span></span><br><span><var>TypeX</var><span><span class="hyp-body"><b>:= </b><span>type X</span></span><span class="hyp-type"><b>: </b><span>VLSMType message</span></span></span></span><br><span><var>MachineX</var><span><span class="hyp-body"><b>:= </b><span>machine X</span></span><span class="hyp-type"><b>: </b><span>VLSMMachine (vtype X)</span></span></span></span><br><span><var>l</var><span class="hyp-type"><b>: </b><span>label</span></span></span><br><span><var>s, s'</var><span class="hyp-type"><b>: </b><span>state</span></span></span><br><span><var>om, om'</var><span class="hyp-type"><b>: </b><span>option message</span></span></span><br><span><var>Ht</var><span class="hyp-type"><b>: </b><span>input_valid_transition l (s, om) (s&#39;, om&#39;)</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">valid l (s, om)</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">      </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="VLSM-v-chka7" style="display: none" type="checkbox"><label class="alectryon-input" for="VLSM-v-chka7"><span class="nb">destruct</span> Ht <span class="kr">as</span> [[_ [_ Hv]] _].</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>message</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>X</var><span class="hyp-type"><b>: </b><span>VLSM message</span></span></span><br><span><var>TypeX</var><span><span class="hyp-body"><b>:= </b><span>type X</span></span><span class="hyp-type"><b>: </b><span>VLSMType message</span></span></span></span><br><span><var>MachineX</var><span><span class="hyp-body"><b>:= </b><span>machine X</span></span><span class="hyp-type"><b>: </b><span>VLSMMachine (vtype X)</span></span></span></span><br><span><var>l</var><span class="hyp-type"><b>: </b><span>label</span></span></span><br><span><var>s, s'</var><span class="hyp-type"><b>: </b><span>state</span></span></span><br><span><var>om, om'</var><span class="hyp-type"><b>: </b><span>option message</span></span></span><br><span><var>Hv</var><span class="hyp-type"><b>: </b><span>valid l (s, om)</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">valid l (s, om)</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">      </span><span class="alectryon-sentence"><span class="alectryon-input"><span class="bp">assumption</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Qed</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
</span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="VLSM-v-chka8" style="display: none" type="checkbox"><label class="alectryon-input" for="VLSM-v-chka8"><span class="kn">Lemma</span> <span class="nf">input_valid_transition_transition</span>
          {<span class="nv">l</span> : label}
          {<span class="nv">s</span> <span class="nv">s&#39;</span> : state}
          {<span class="nv">om</span> <span class="nv">om&#39;</span> : option message}
          (<span class="nv">Ht</span> : input_valid_transition l (s, om) (s&#39;, om&#39;))
        :  transition l (s, om) = (s&#39;, om&#39;).</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>message</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>X</var><span class="hyp-type"><b>: </b><span>VLSM message</span></span></span><br><span><var>TypeX</var><span><span class="hyp-body"><b>:= </b><span>type X</span></span><span class="hyp-type"><b>: </b><span>VLSMType message</span></span></span></span><br><span><var>MachineX</var><span><span class="hyp-body"><b>:= </b><span>machine X</span></span><span class="hyp-type"><b>: </b><span>VLSMMachine (vtype X)</span></span></span></span><br><span><var>l</var><span class="hyp-type"><b>: </b><span>label</span></span></span><br><span><var>s, s'</var><span class="hyp-type"><b>: </b><span>state</span></span></span><br><span><var>om, om'</var><span class="hyp-type"><b>: </b><span>option message</span></span></span><br><span><var>Ht</var><span class="hyp-type"><b>: </b><span>input_valid_transition l (s, om) (s&#39;, om&#39;)</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">transition l (s, om) = (s&#39;, om&#39;)</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">     </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="VLSM-v-chka9" style="display: none" type="checkbox"><label class="alectryon-input" for="VLSM-v-chka9"><span class="kn">Proof</span>.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>message</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>X</var><span class="hyp-type"><b>: </b><span>VLSM message</span></span></span><br><span><var>TypeX</var><span><span class="hyp-body"><b>:= </b><span>type X</span></span><span class="hyp-type"><b>: </b><span>VLSMType message</span></span></span></span><br><span><var>MachineX</var><span><span class="hyp-body"><b>:= </b><span>machine X</span></span><span class="hyp-type"><b>: </b><span>VLSMMachine (vtype X)</span></span></span></span><br><span><var>l</var><span class="hyp-type"><b>: </b><span>label</span></span></span><br><span><var>s, s'</var><span class="hyp-type"><b>: </b><span>state</span></span></span><br><span><var>om, om'</var><span class="hyp-type"><b>: </b><span>option message</span></span></span><br><span><var>Ht</var><span class="hyp-type"><b>: </b><span>input_valid_transition l (s, om) (s&#39;, om&#39;)</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">transition l (s, om) = (s&#39;, om&#39;)</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">      </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="VLSM-v-chkaa" style="display: none" type="checkbox"><label class="alectryon-input" for="VLSM-v-chkaa"><span class="nb">destruct</span> Ht <span class="kr">as</span> [_ Ht].</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>message</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>X</var><span class="hyp-type"><b>: </b><span>VLSM message</span></span></span><br><span><var>TypeX</var><span><span class="hyp-body"><b>:= </b><span>type X</span></span><span class="hyp-type"><b>: </b><span>VLSMType message</span></span></span></span><br><span><var>MachineX</var><span><span class="hyp-body"><b>:= </b><span>machine X</span></span><span class="hyp-type"><b>: </b><span>VLSMMachine (vtype X)</span></span></span></span><br><span><var>l</var><span class="hyp-type"><b>: </b><span>label</span></span></span><br><span><var>s, s'</var><span class="hyp-type"><b>: </b><span>state</span></span></span><br><span><var>om, om'</var><span class="hyp-type"><b>: </b><span>option message</span></span></span><br><span><var>Ht</var><span class="hyp-type"><b>: </b><span>transition l (s, om) = (s&#39;, om&#39;)</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">transition l (s, om) = (s&#39;, om&#39;)</div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="bp">assumption</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">     </span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Qed</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
</span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="VLSM-v-chkab" style="display: none" type="checkbox"><label class="alectryon-input" for="VLSM-v-chkab"><span class="kn">Lemma</span> <span class="nf">input_valid_state_message_outputs</span>
      (<span class="nv">l</span> : label)
      (<span class="nv">s</span> : state)
      (<span class="nv">om</span> : option message)
      (<span class="nv">Hv</span> : input_valid l (s, om))
      <span class="nv">s&#39;</span> <span class="nv">om&#39;</span>
      (<span class="nv">Ht</span> : transition l (s, om) = (s&#39;, om&#39;))
      : valid_state_message_prop s&#39; om&#39;.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>message</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>X</var><span class="hyp-type"><b>: </b><span>VLSM message</span></span></span><br><span><var>TypeX</var><span><span class="hyp-body"><b>:= </b><span>type X</span></span><span class="hyp-type"><b>: </b><span>VLSMType message</span></span></span></span><br><span><var>MachineX</var><span><span class="hyp-body"><b>:= </b><span>machine X</span></span><span class="hyp-type"><b>: </b><span>VLSMMachine (vtype X)</span></span></span></span><br><span><var>l</var><span class="hyp-type"><b>: </b><span>label</span></span></span><br><span><var>s</var><span class="hyp-type"><b>: </b><span>state</span></span></span><br><span><var>om</var><span class="hyp-type"><b>: </b><span>option message</span></span></span><br><span><var>Hv</var><span class="hyp-type"><b>: </b><span>input_valid l (s, om)</span></span></span><br><span><var>s'</var><span class="hyp-type"><b>: </b><span>state</span></span></span><br><span><var>om'</var><span class="hyp-type"><b>: </b><span>option message</span></span></span><br><span><var>Ht</var><span class="hyp-type"><b>: </b><span>transition l (s, om) = (s&#39;, om&#39;)</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">valid_state_message_prop s&#39; om&#39;</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="VLSM-v-chkac" style="display: none" type="checkbox"><label class="alectryon-input" for="VLSM-v-chkac"><span class="kn">Proof</span>.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>message</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>X</var><span class="hyp-type"><b>: </b><span>VLSM message</span></span></span><br><span><var>TypeX</var><span><span class="hyp-body"><b>:= </b><span>type X</span></span><span class="hyp-type"><b>: </b><span>VLSMType message</span></span></span></span><br><span><var>MachineX</var><span><span class="hyp-body"><b>:= </b><span>machine X</span></span><span class="hyp-type"><b>: </b><span>VLSMMachine (vtype X)</span></span></span></span><br><span><var>l</var><span class="hyp-type"><b>: </b><span>label</span></span></span><br><span><var>s</var><span class="hyp-type"><b>: </b><span>state</span></span></span><br><span><var>om</var><span class="hyp-type"><b>: </b><span>option message</span></span></span><br><span><var>Hv</var><span class="hyp-type"><b>: </b><span>input_valid l (s, om)</span></span></span><br><span><var>s'</var><span class="hyp-type"><b>: </b><span>state</span></span></span><br><span><var>om'</var><span class="hyp-type"><b>: </b><span>option message</span></span></span><br><span><var>Ht</var><span class="hyp-type"><b>: </b><span>transition l (s, om) = (s&#39;, om&#39;)</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">valid_state_message_prop s&#39; om&#39;</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">      </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="VLSM-v-chkad" style="display: none" type="checkbox"><label class="alectryon-input" for="VLSM-v-chkad"><span class="nb">destruct</span> Hv <span class="kr">as</span> [[_om Hs] [[_s Hom] Hv]].</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>message</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>X</var><span class="hyp-type"><b>: </b><span>VLSM message</span></span></span><br><span><var>TypeX</var><span><span class="hyp-body"><b>:= </b><span>type X</span></span><span class="hyp-type"><b>: </b><span>VLSMType message</span></span></span></span><br><span><var>MachineX</var><span><span class="hyp-body"><b>:= </b><span>machine X</span></span><span class="hyp-type"><b>: </b><span>VLSMMachine (vtype X)</span></span></span></span><br><span><var>l</var><span class="hyp-type"><b>: </b><span>label</span></span></span><br><span><var>s</var><span class="hyp-type"><b>: </b><span>state</span></span></span><br><span><var>om, _om</var><span class="hyp-type"><b>: </b><span>option message</span></span></span><br><span><var>Hs</var><span class="hyp-type"><b>: </b><span>valid_state_message_prop s _om</span></span></span><br><span><var>_s</var><span class="hyp-type"><b>: </b><span>state</span></span></span><br><span><var>Hom</var><span class="hyp-type"><b>: </b><span>valid_state_message_prop _s om</span></span></span><br><span><var>Hv</var><span class="hyp-type"><b>: </b><span>valid l (s, om)</span></span></span><br><span><var>s'</var><span class="hyp-type"><b>: </b><span>state</span></span></span><br><span><var>om'</var><span class="hyp-type"><b>: </b><span>option message</span></span></span><br><span><var>Ht</var><span class="hyp-type"><b>: </b><span>transition l (s, om) = (s&#39;, om&#39;)</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">valid_state_message_prop s&#39; om&#39;</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">      </span><span class="alectryon-sentence"><span class="alectryon-input"><span class="nb">apply</span> valid_generated_state_message <span class="kr">with</span> s _om _s om l; <span class="bp">assumption</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Qed</span>.</span></span></pre><div class="doc">
For VLSMs initialized with many initial messages such as
    the <span class="inlinecode"><span class="id" title="var">composite_vlsm_constrained_projection</span></span> or the <span class="inlinecode"><span class="id" title="var">pre_loaded_with_all_messages_vlsm</span></span>,
    the question of whether a <span class="inlinecode"><span class="id" title="var">VLSM</span></span> <span class="inlinecode"><span class="id" title="var">can_emit</span></span> a message <code>m</code> becomes more
    useful than that whether <code>m</code> is a <span class="inlinecode"><span class="id" title="var">valid_message</span></span>.
    
</div><pre class="alectryon-io highlight"><!-- Generator: Alectryon --><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Definition</span> <span class="nf">option_can_produce</span>
      (<span class="nv">s</span> : state)
      (<span class="nv">om</span> : option message)
      :=
      <span class="kr">exists</span>
      (<span class="nv">som</span> : state * option message)
      (<span class="nv">l</span> : label),
      input_valid_transition l som (s, om).</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
</span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Definition</span> <span class="nf">can_produce</span>
      (<span class="nv">s</span> : state)
      (<span class="nv">m</span> : message)
      := option_can_produce s (Some m).</span></span></pre><div class="doc">
Of course, if a VLSM <span class="inlinecode"><span class="id" title="var">can_emit</span></span> <code>(s,m)</code>, then <code>(s,m)</code> is valid.
    
</div><pre class="alectryon-io highlight"><!-- Generator: Alectryon --><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="VLSM-v-chkae" style="display: none" type="checkbox"><label class="alectryon-input" for="VLSM-v-chkae"><span class="kn">Lemma</span> <span class="nf">option_can_produce_valid</span>
      (<span class="nv">s</span> : state)
      (<span class="nv">om</span> : option message)
      (<span class="nv">Hm</span> : option_can_produce s om)
      : valid_state_message_prop s om .</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>message</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>X</var><span class="hyp-type"><b>: </b><span>VLSM message</span></span></span><br><span><var>TypeX</var><span><span class="hyp-body"><b>:= </b><span>type X</span></span><span class="hyp-type"><b>: </b><span>VLSMType message</span></span></span></span><br><span><var>MachineX</var><span><span class="hyp-body"><b>:= </b><span>machine X</span></span><span class="hyp-type"><b>: </b><span>VLSMMachine (vtype X)</span></span></span></span><br><span><var>s</var><span class="hyp-type"><b>: </b><span>state</span></span></span><br><span><var>om</var><span class="hyp-type"><b>: </b><span>option message</span></span></span><br><span><var>Hm</var><span class="hyp-type"><b>: </b><span>option_can_produce s om</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">valid_state_message_prop s om</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="VLSM-v-chkaf" style="display: none" type="checkbox"><label class="alectryon-input" for="VLSM-v-chkaf"><span class="kn">Proof</span>.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>message</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>X</var><span class="hyp-type"><b>: </b><span>VLSM message</span></span></span><br><span><var>TypeX</var><span><span class="hyp-body"><b>:= </b><span>type X</span></span><span class="hyp-type"><b>: </b><span>VLSMType message</span></span></span></span><br><span><var>MachineX</var><span><span class="hyp-body"><b>:= </b><span>machine X</span></span><span class="hyp-type"><b>: </b><span>VLSMMachine (vtype X)</span></span></span></span><br><span><var>s</var><span class="hyp-type"><b>: </b><span>state</span></span></span><br><span><var>om</var><span class="hyp-type"><b>: </b><span>option message</span></span></span><br><span><var>Hm</var><span class="hyp-type"><b>: </b><span>option_can_produce s om</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">valid_state_message_prop s om</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">      </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="VLSM-v-chkb0" style="display: none" type="checkbox"><label class="alectryon-input" for="VLSM-v-chkb0"><span class="nb">destruct</span> Hm <span class="kr">as</span> [(s0, om0) [l [[[_om0 Hs0] [[_s0 Hom0] Hv]] Ht]]].</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>message</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>X</var><span class="hyp-type"><b>: </b><span>VLSM message</span></span></span><br><span><var>TypeX</var><span><span class="hyp-body"><b>:= </b><span>type X</span></span><span class="hyp-type"><b>: </b><span>VLSMType message</span></span></span></span><br><span><var>MachineX</var><span><span class="hyp-body"><b>:= </b><span>machine X</span></span><span class="hyp-type"><b>: </b><span>VLSMMachine (vtype X)</span></span></span></span><br><span><var>s</var><span class="hyp-type"><b>: </b><span>state</span></span></span><br><span><var>om</var><span class="hyp-type"><b>: </b><span>option message</span></span></span><br><span><var>s0</var><span class="hyp-type"><b>: </b><span>state</span></span></span><br><span><var>om0</var><span class="hyp-type"><b>: </b><span>option message</span></span></span><br><span><var>l</var><span class="hyp-type"><b>: </b><span>label</span></span></span><br><span><var>_om0</var><span class="hyp-type"><b>: </b><span>option message</span></span></span><br><span><var>Hs0</var><span class="hyp-type"><b>: </b><span>valid_state_message_prop s0 _om0</span></span></span><br><span><var>_s0</var><span class="hyp-type"><b>: </b><span>state</span></span></span><br><span><var>Hom0</var><span class="hyp-type"><b>: </b><span>valid_state_message_prop _s0 om0</span></span></span><br><span><var>Hv</var><span class="hyp-type"><b>: </b><span>valid l (s0, om0)</span></span></span><br><span><var>Ht</var><span class="hyp-type"><b>: </b><span>transition l (s0, om0) = (s, om)</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">valid_state_message_prop s om</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">      </span><span class="alectryon-sentence"><span class="alectryon-input"><span class="nb">apply</span> valid_generated_state_message <span class="kr">with</span> s0 _om0 _s0 om0 l; <span class="bp">assumption</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Qed</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
</span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Definition</span> <span class="nf">can_produce_valid</span>
      (<span class="nv">s</span> : state)
      (<span class="nv">m</span> : message)
      (<span class="nv">Hm</span> : can_produce s m)
      : valid_state_message_prop s (Some m)
      := option_can_produce_valid s (Some m) Hm.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
</span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="VLSM-v-chkb1" style="display: none" type="checkbox"><label class="alectryon-input" for="VLSM-v-chkb1"><span class="kn">Lemma</span> <span class="nf">option_can_produce_valid_iff</span>
      (<span class="nv">s</span> : state)
      (<span class="nv">om</span> : option message)
      : valid_state_message_prop s om &lt;-&gt;
        option_can_produce s om \/ initial_state_prop s /\ option_initial_message_prop om.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>message</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>X</var><span class="hyp-type"><b>: </b><span>VLSM message</span></span></span><br><span><var>TypeX</var><span><span class="hyp-body"><b>:= </b><span>type X</span></span><span class="hyp-type"><b>: </b><span>VLSMType message</span></span></span></span><br><span><var>MachineX</var><span><span class="hyp-body"><b>:= </b><span>machine X</span></span><span class="hyp-type"><b>: </b><span>VLSMMachine (vtype X)</span></span></span></span><br><span><var>s</var><span class="hyp-type"><b>: </b><span>state</span></span></span><br><span><var>om</var><span class="hyp-type"><b>: </b><span>option message</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">valid_state_message_prop s om
‚Üî option_can_produce s om
  ‚à® initial_state_prop s
    ‚àß option_initial_message_prop om</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="VLSM-v-chkb2" style="display: none" type="checkbox"><label class="alectryon-input" for="VLSM-v-chkb2"><span class="kn">Proof</span>.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>message</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>X</var><span class="hyp-type"><b>: </b><span>VLSM message</span></span></span><br><span><var>TypeX</var><span><span class="hyp-body"><b>:= </b><span>type X</span></span><span class="hyp-type"><b>: </b><span>VLSMType message</span></span></span></span><br><span><var>MachineX</var><span><span class="hyp-body"><b>:= </b><span>machine X</span></span><span class="hyp-type"><b>: </b><span>VLSMMachine (vtype X)</span></span></span></span><br><span><var>s</var><span class="hyp-type"><b>: </b><span>state</span></span></span><br><span><var>om</var><span class="hyp-type"><b>: </b><span>option message</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">valid_state_message_prop s om
‚Üî option_can_produce s om
  ‚à® initial_state_prop s
    ‚àß option_initial_message_prop om</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">      </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="VLSM-v-chkb3" style="display: none" type="checkbox"><label class="alectryon-input" for="VLSM-v-chkb3"><span class="nb">split</span>.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>message</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>X</var><span class="hyp-type"><b>: </b><span>VLSM message</span></span></span><br><span><var>TypeX</var><span><span class="hyp-body"><b>:= </b><span>type X</span></span><span class="hyp-type"><b>: </b><span>VLSMType message</span></span></span></span><br><span><var>MachineX</var><span><span class="hyp-body"><b>:= </b><span>machine X</span></span><span class="hyp-type"><b>: </b><span>VLSMMachine (vtype X)</span></span></span></span><br><span><var>s</var><span class="hyp-type"><b>: </b><span>state</span></span></span><br><span><var>om</var><span class="hyp-type"><b>: </b><span>option message</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">valid_state_message_prop s om
‚Üí option_can_produce s om
  ‚à® initial_state_prop s
    ‚àß option_initial_message_prop om</div></blockquote><div class="alectryon-extra-goals"><input class="alectryon-extra-goal-toggle" id="VLSM-v-chkb4" style="display: none" type="checkbox"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>message</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>X</var><span class="hyp-type"><b>: </b><span>VLSM message</span></span></span><br><span><var>TypeX</var><span><span class="hyp-body"><b>:= </b><span>type X</span></span><span class="hyp-type"><b>: </b><span>VLSMType message</span></span></span></span><br><span><var>MachineX</var><span><span class="hyp-body"><b>:= </b><span>machine X</span></span><span class="hyp-type"><b>: </b><span>VLSMMachine (vtype X)</span></span></span></span><br><span><var>s</var><span class="hyp-type"><b>: </b><span>state</span></span></span><br><span><var>om</var><span class="hyp-type"><b>: </b><span>option message</span></span></span><br></div><label class="goal-separator" for="VLSM-v-chkb4"><hr></label><div class="goal-conclusion">option_can_produce s om
‚à® initial_state_prop s
  ‚àß option_initial_message_prop om
‚Üí valid_state_message_prop s om</div></blockquote></div></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">      </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="VLSM-v-chkb5" style="display: none" type="checkbox"><label class="alectryon-input" for="VLSM-v-chkb5">-</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>message</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>X</var><span class="hyp-type"><b>: </b><span>VLSM message</span></span></span><br><span><var>TypeX</var><span><span class="hyp-body"><b>:= </b><span>type X</span></span><span class="hyp-type"><b>: </b><span>VLSMType message</span></span></span></span><br><span><var>MachineX</var><span><span class="hyp-body"><b>:= </b><span>machine X</span></span><span class="hyp-type"><b>: </b><span>VLSMMachine (vtype X)</span></span></span></span><br><span><var>s</var><span class="hyp-type"><b>: </b><span>state</span></span></span><br><span><var>om</var><span class="hyp-type"><b>: </b><span>option message</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">valid_state_message_prop s om
‚Üí option_can_produce s om
  ‚à® initial_state_prop s
    ‚àß option_initial_message_prop om</div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="VLSM-v-chkb6" style="display: none" type="checkbox"><label class="alectryon-input" for="VLSM-v-chkb6"><span class="nb">intros</span> Hm; <span class="nb">inversion</span> Hm; <span class="nb">subst</span>.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>message</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>X</var><span class="hyp-type"><b>: </b><span>VLSM message</span></span></span><br><span><var>TypeX</var><span><span class="hyp-body"><b>:= </b><span>type X</span></span><span class="hyp-type"><b>: </b><span>VLSMType message</span></span></span></span><br><span><var>MachineX</var><span><span class="hyp-body"><b>:= </b><span>machine X</span></span><span class="hyp-type"><b>: </b><span>VLSMMachine (vtype X)</span></span></span></span><br><span><var>s</var><span class="hyp-type"><b>: </b><span>state</span></span></span><br><span><var>om</var><span class="hyp-type"><b>: </b><span>option message</span></span></span><br><span><var>Hm</var><span class="hyp-type"><b>: </b><span>valid_state_message_prop s om</span></span></span><br><span><var>Hs</var><span class="hyp-type"><b>: </b><span>initial_state_prop s</span></span></span><br><span><var>Hom</var><span class="hyp-type"><b>: </b><span>option_initial_message_prop om</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">option_can_produce s om
‚à® initial_state_prop s
  ‚àß option_initial_message_prop om</div></blockquote><div class="alectryon-extra-goals"><input class="alectryon-extra-goal-toggle" id="VLSM-v-chkb7" style="display: none" type="checkbox"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>message</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>X</var><span class="hyp-type"><b>: </b><span>VLSM message</span></span></span><br><span><var>TypeX</var><span><span class="hyp-body"><b>:= </b><span>type X</span></span><span class="hyp-type"><b>: </b><span>VLSMType message</span></span></span></span><br><span><var>MachineX</var><span><span class="hyp-body"><b>:= </b><span>machine X</span></span><span class="hyp-type"><b>: </b><span>VLSMMachine (vtype X)</span></span></span></span><br><span><var>s</var><span class="hyp-type"><b>: </b><span>state</span></span></span><br><span><var>om</var><span class="hyp-type"><b>: </b><span>option message</span></span></span><br><span><var>Hm</var><span class="hyp-type"><b>: </b><span>valid_state_message_prop s om</span></span></span><br><span><var>s1</var><span class="hyp-type"><b>: </b><span>state</span></span></span><br><span><var>_om</var><span class="hyp-type"><b>: </b><span>option message</span></span></span><br><span><var>_s</var><span class="hyp-type"><b>: </b><span>state</span></span></span><br><span><var>om0</var><span class="hyp-type"><b>: </b><span>option message</span></span></span><br><span><var>l0</var><span class="hyp-type"><b>: </b><span>label</span></span></span><br><span><var>Hps</var><span class="hyp-type"><b>: </b><span>valid_state_message_prop s1 _om</span></span></span><br><span><var>Hpm</var><span class="hyp-type"><b>: </b><span>valid_state_message_prop _s om0</span></span></span><br><span><var>Hv</var><span class="hyp-type"><b>: </b><span>valid l0 (s1, om0)</span></span></span><br><span><var>Ht</var><span class="hyp-type"><b>: </b><span>transition l0 (s1, om0) = (s, om)</span></span></span><br></div><label class="goal-separator" for="VLSM-v-chkb7"><hr></label><div class="goal-conclusion">option_can_produce s om
‚à® initial_state_prop s
  ‚àß option_initial_message_prop om</div></blockquote></div></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">        </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="VLSM-v-chkb8" style="display: none" type="checkbox"><label class="alectryon-input" for="VLSM-v-chkb8">+</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>message</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>X</var><span class="hyp-type"><b>: </b><span>VLSM message</span></span></span><br><span><var>TypeX</var><span><span class="hyp-body"><b>:= </b><span>type X</span></span><span class="hyp-type"><b>: </b><span>VLSMType message</span></span></span></span><br><span><var>MachineX</var><span><span class="hyp-body"><b>:= </b><span>machine X</span></span><span class="hyp-type"><b>: </b><span>VLSMMachine (vtype X)</span></span></span></span><br><span><var>s</var><span class="hyp-type"><b>: </b><span>state</span></span></span><br><span><var>om</var><span class="hyp-type"><b>: </b><span>option message</span></span></span><br><span><var>Hm</var><span class="hyp-type"><b>: </b><span>valid_state_message_prop s om</span></span></span><br><span><var>Hs</var><span class="hyp-type"><b>: </b><span>initial_state_prop s</span></span></span><br><span><var>Hom</var><span class="hyp-type"><b>: </b><span>option_initial_message_prop om</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">option_can_produce s om
‚à® initial_state_prop s
  ‚àß option_initial_message_prop om</div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="VLSM-v-chkb9" style="display: none" type="checkbox"><label class="alectryon-input" for="VLSM-v-chkb9"><span class="nb">right</span>.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>message</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>X</var><span class="hyp-type"><b>: </b><span>VLSM message</span></span></span><br><span><var>TypeX</var><span><span class="hyp-body"><b>:= </b><span>type X</span></span><span class="hyp-type"><b>: </b><span>VLSMType message</span></span></span></span><br><span><var>MachineX</var><span><span class="hyp-body"><b>:= </b><span>machine X</span></span><span class="hyp-type"><b>: </b><span>VLSMMachine (vtype X)</span></span></span></span><br><span><var>s</var><span class="hyp-type"><b>: </b><span>state</span></span></span><br><span><var>om</var><span class="hyp-type"><b>: </b><span>option message</span></span></span><br><span><var>Hm</var><span class="hyp-type"><b>: </b><span>valid_state_message_prop s om</span></span></span><br><span><var>Hs</var><span class="hyp-type"><b>: </b><span>initial_state_prop s</span></span></span><br><span><var>Hom</var><span class="hyp-type"><b>: </b><span>option_initial_message_prop om</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">initial_state_prop s ‚àß option_initial_message_prop om</div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="nb">split</span>; <span class="bp">assumption</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">        </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="VLSM-v-chkba" style="display: none" type="checkbox"><label class="alectryon-input" for="VLSM-v-chkba">+</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>message</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>X</var><span class="hyp-type"><b>: </b><span>VLSM message</span></span></span><br><span><var>TypeX</var><span><span class="hyp-body"><b>:= </b><span>type X</span></span><span class="hyp-type"><b>: </b><span>VLSMType message</span></span></span></span><br><span><var>MachineX</var><span><span class="hyp-body"><b>:= </b><span>machine X</span></span><span class="hyp-type"><b>: </b><span>VLSMMachine (vtype X)</span></span></span></span><br><span><var>s</var><span class="hyp-type"><b>: </b><span>state</span></span></span><br><span><var>om</var><span class="hyp-type"><b>: </b><span>option message</span></span></span><br><span><var>Hm</var><span class="hyp-type"><b>: </b><span>valid_state_message_prop s om</span></span></span><br><span><var>s1</var><span class="hyp-type"><b>: </b><span>state</span></span></span><br><span><var>_om</var><span class="hyp-type"><b>: </b><span>option message</span></span></span><br><span><var>_s</var><span class="hyp-type"><b>: </b><span>state</span></span></span><br><span><var>om0</var><span class="hyp-type"><b>: </b><span>option message</span></span></span><br><span><var>l0</var><span class="hyp-type"><b>: </b><span>label</span></span></span><br><span><var>Hps</var><span class="hyp-type"><b>: </b><span>valid_state_message_prop s1 _om</span></span></span><br><span><var>Hpm</var><span class="hyp-type"><b>: </b><span>valid_state_message_prop _s om0</span></span></span><br><span><var>Hv</var><span class="hyp-type"><b>: </b><span>valid l0 (s1, om0)</span></span></span><br><span><var>Ht</var><span class="hyp-type"><b>: </b><span>transition l0 (s1, om0) = (s, om)</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">option_can_produce s om
‚à® initial_state_prop s
  ‚àß option_initial_message_prop om</div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="VLSM-v-chkbb" style="display: none" type="checkbox"><label class="alectryon-input" for="VLSM-v-chkbb"><span class="nb">left</span>.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>message</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>X</var><span class="hyp-type"><b>: </b><span>VLSM message</span></span></span><br><span><var>TypeX</var><span><span class="hyp-body"><b>:= </b><span>type X</span></span><span class="hyp-type"><b>: </b><span>VLSMType message</span></span></span></span><br><span><var>MachineX</var><span><span class="hyp-body"><b>:= </b><span>machine X</span></span><span class="hyp-type"><b>: </b><span>VLSMMachine (vtype X)</span></span></span></span><br><span><var>s</var><span class="hyp-type"><b>: </b><span>state</span></span></span><br><span><var>om</var><span class="hyp-type"><b>: </b><span>option message</span></span></span><br><span><var>Hm</var><span class="hyp-type"><b>: </b><span>valid_state_message_prop s om</span></span></span><br><span><var>s1</var><span class="hyp-type"><b>: </b><span>state</span></span></span><br><span><var>_om</var><span class="hyp-type"><b>: </b><span>option message</span></span></span><br><span><var>_s</var><span class="hyp-type"><b>: </b><span>state</span></span></span><br><span><var>om0</var><span class="hyp-type"><b>: </b><span>option message</span></span></span><br><span><var>l0</var><span class="hyp-type"><b>: </b><span>label</span></span></span><br><span><var>Hps</var><span class="hyp-type"><b>: </b><span>valid_state_message_prop s1 _om</span></span></span><br><span><var>Hpm</var><span class="hyp-type"><b>: </b><span>valid_state_message_prop _s om0</span></span></span><br><span><var>Hv</var><span class="hyp-type"><b>: </b><span>valid l0 (s1, om0)</span></span></span><br><span><var>Ht</var><span class="hyp-type"><b>: </b><span>transition l0 (s1, om0) = (s, om)</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">option_can_produce s om</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">          </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="VLSM-v-chkbc" style="display: none" type="checkbox"><label class="alectryon-input" for="VLSM-v-chkbc"><span class="kr">exists</span> (<span class="nv">s1</span>, om0).</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>message</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>X</var><span class="hyp-type"><b>: </b><span>VLSM message</span></span></span><br><span><var>TypeX</var><span><span class="hyp-body"><b>:= </b><span>type X</span></span><span class="hyp-type"><b>: </b><span>VLSMType message</span></span></span></span><br><span><var>MachineX</var><span><span class="hyp-body"><b>:= </b><span>machine X</span></span><span class="hyp-type"><b>: </b><span>VLSMMachine (vtype X)</span></span></span></span><br><span><var>s</var><span class="hyp-type"><b>: </b><span>state</span></span></span><br><span><var>om</var><span class="hyp-type"><b>: </b><span>option message</span></span></span><br><span><var>Hm</var><span class="hyp-type"><b>: </b><span>valid_state_message_prop s om</span></span></span><br><span><var>s1</var><span class="hyp-type"><b>: </b><span>state</span></span></span><br><span><var>_om</var><span class="hyp-type"><b>: </b><span>option message</span></span></span><br><span><var>_s</var><span class="hyp-type"><b>: </b><span>state</span></span></span><br><span><var>om0</var><span class="hyp-type"><b>: </b><span>option message</span></span></span><br><span><var>l0</var><span class="hyp-type"><b>: </b><span>label</span></span></span><br><span><var>Hps</var><span class="hyp-type"><b>: </b><span>valid_state_message_prop s1 _om</span></span></span><br><span><var>Hpm</var><span class="hyp-type"><b>: </b><span>valid_state_message_prop _s om0</span></span></span><br><span><var>Hv</var><span class="hyp-type"><b>: </b><span>valid l0 (s1, om0)</span></span></span><br><span><var>Ht</var><span class="hyp-type"><b>: </b><span>transition l0 (s1, om0) = (s, om)</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="kr">‚àÉ</span> <span class="nv">l</span> : label,
  input_valid_transition l (s1, om0) (s, om)</div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="VLSM-v-chkbd" style="display: none" type="checkbox"><label class="alectryon-input" for="VLSM-v-chkbd"><span class="kr">exists</span> <span class="nv">l0</span>.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>message</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>X</var><span class="hyp-type"><b>: </b><span>VLSM message</span></span></span><br><span><var>TypeX</var><span><span class="hyp-body"><b>:= </b><span>type X</span></span><span class="hyp-type"><b>: </b><span>VLSMType message</span></span></span></span><br><span><var>MachineX</var><span><span class="hyp-body"><b>:= </b><span>machine X</span></span><span class="hyp-type"><b>: </b><span>VLSMMachine (vtype X)</span></span></span></span><br><span><var>s</var><span class="hyp-type"><b>: </b><span>state</span></span></span><br><span><var>om</var><span class="hyp-type"><b>: </b><span>option message</span></span></span><br><span><var>Hm</var><span class="hyp-type"><b>: </b><span>valid_state_message_prop s om</span></span></span><br><span><var>s1</var><span class="hyp-type"><b>: </b><span>state</span></span></span><br><span><var>_om</var><span class="hyp-type"><b>: </b><span>option message</span></span></span><br><span><var>_s</var><span class="hyp-type"><b>: </b><span>state</span></span></span><br><span><var>om0</var><span class="hyp-type"><b>: </b><span>option message</span></span></span><br><span><var>l0</var><span class="hyp-type"><b>: </b><span>label</span></span></span><br><span><var>Hps</var><span class="hyp-type"><b>: </b><span>valid_state_message_prop s1 _om</span></span></span><br><span><var>Hpm</var><span class="hyp-type"><b>: </b><span>valid_state_message_prop _s om0</span></span></span><br><span><var>Hv</var><span class="hyp-type"><b>: </b><span>valid l0 (s1, om0)</span></span></span><br><span><var>Ht</var><span class="hyp-type"><b>: </b><span>transition l0 (s1, om0) = (s, om)</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">input_valid_transition l0 (s1, om0) (s, om)</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">          </span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kp">repeat</span> <span class="nb">split</span>; [..|<span class="bp">assumption</span>|<span class="bp">assumption</span>]
          ; <span class="nb">eexists</span>; [<span class="bp">exact</span> Hps|<span class="bp">exact</span> Hpm].</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">      </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="VLSM-v-chkbe" style="display: none" type="checkbox"><label class="alectryon-input" for="VLSM-v-chkbe">-</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>message</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>X</var><span class="hyp-type"><b>: </b><span>VLSM message</span></span></span><br><span><var>TypeX</var><span><span class="hyp-body"><b>:= </b><span>type X</span></span><span class="hyp-type"><b>: </b><span>VLSMType message</span></span></span></span><br><span><var>MachineX</var><span><span class="hyp-body"><b>:= </b><span>machine X</span></span><span class="hyp-type"><b>: </b><span>VLSMMachine (vtype X)</span></span></span></span><br><span><var>s</var><span class="hyp-type"><b>: </b><span>state</span></span></span><br><span><var>om</var><span class="hyp-type"><b>: </b><span>option message</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">option_can_produce s om
‚à® initial_state_prop s
  ‚àß option_initial_message_prop om
‚Üí valid_state_message_prop s om</div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="VLSM-v-chkbf" style="display: none" type="checkbox"><label class="alectryon-input" for="VLSM-v-chkbf"><span class="nb">intros</span> [Hem | Him].</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>message</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>X</var><span class="hyp-type"><b>: </b><span>VLSM message</span></span></span><br><span><var>TypeX</var><span><span class="hyp-body"><b>:= </b><span>type X</span></span><span class="hyp-type"><b>: </b><span>VLSMType message</span></span></span></span><br><span><var>MachineX</var><span><span class="hyp-body"><b>:= </b><span>machine X</span></span><span class="hyp-type"><b>: </b><span>VLSMMachine (vtype X)</span></span></span></span><br><span><var>s</var><span class="hyp-type"><b>: </b><span>state</span></span></span><br><span><var>om</var><span class="hyp-type"><b>: </b><span>option message</span></span></span><br><span><var>Hem</var><span class="hyp-type"><b>: </b><span>option_can_produce s om</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">valid_state_message_prop s om</div></blockquote><div class="alectryon-extra-goals"><input class="alectryon-extra-goal-toggle" id="VLSM-v-chkc0" style="display: none" type="checkbox"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>message</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>X</var><span class="hyp-type"><b>: </b><span>VLSM message</span></span></span><br><span><var>TypeX</var><span><span class="hyp-body"><b>:= </b><span>type X</span></span><span class="hyp-type"><b>: </b><span>VLSMType message</span></span></span></span><br><span><var>MachineX</var><span><span class="hyp-body"><b>:= </b><span>machine X</span></span><span class="hyp-type"><b>: </b><span>VLSMMachine (vtype X)</span></span></span></span><br><span><var>s</var><span class="hyp-type"><b>: </b><span>state</span></span></span><br><span><var>om</var><span class="hyp-type"><b>: </b><span>option message</span></span></span><br><span><var>Him</var><span class="hyp-type"><b>: </b><span>initial_state_prop s
‚àß option_initial_message_prop om</span></span></span><br></div><label class="goal-separator" for="VLSM-v-chkc0"><hr></label><div class="goal-conclusion">valid_state_message_prop s om</div></blockquote></div></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">        </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="VLSM-v-chkc1" style="display: none" type="checkbox"><label class="alectryon-input" for="VLSM-v-chkc1">+</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>message</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>X</var><span class="hyp-type"><b>: </b><span>VLSM message</span></span></span><br><span><var>TypeX</var><span><span class="hyp-body"><b>:= </b><span>type X</span></span><span class="hyp-type"><b>: </b><span>VLSMType message</span></span></span></span><br><span><var>MachineX</var><span><span class="hyp-body"><b>:= </b><span>machine X</span></span><span class="hyp-type"><b>: </b><span>VLSMMachine (vtype X)</span></span></span></span><br><span><var>s</var><span class="hyp-type"><b>: </b><span>state</span></span></span><br><span><var>om</var><span class="hyp-type"><b>: </b><span>option message</span></span></span><br><span><var>Hem</var><span class="hyp-type"><b>: </b><span>option_can_produce s om</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">valid_state_message_prop s om</div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="VLSM-v-chkc2" style="display: none" type="checkbox"><label class="alectryon-input" for="VLSM-v-chkc2"><span class="nb">apply</span> option_can_produce_valid.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>message</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>X</var><span class="hyp-type"><b>: </b><span>VLSM message</span></span></span><br><span><var>TypeX</var><span><span class="hyp-body"><b>:= </b><span>type X</span></span><span class="hyp-type"><b>: </b><span>VLSMType message</span></span></span></span><br><span><var>MachineX</var><span><span class="hyp-body"><b>:= </b><span>machine X</span></span><span class="hyp-type"><b>: </b><span>VLSMMachine (vtype X)</span></span></span></span><br><span><var>s</var><span class="hyp-type"><b>: </b><span>state</span></span></span><br><span><var>om</var><span class="hyp-type"><b>: </b><span>option message</span></span></span><br><span><var>Hem</var><span class="hyp-type"><b>: </b><span>option_can_produce s om</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">option_can_produce s om</div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="bp">assumption</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">        </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="VLSM-v-chkc3" style="display: none" type="checkbox"><label class="alectryon-input" for="VLSM-v-chkc3">+</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>message</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>X</var><span class="hyp-type"><b>: </b><span>VLSM message</span></span></span><br><span><var>TypeX</var><span><span class="hyp-body"><b>:= </b><span>type X</span></span><span class="hyp-type"><b>: </b><span>VLSMType message</span></span></span></span><br><span><var>MachineX</var><span><span class="hyp-body"><b>:= </b><span>machine X</span></span><span class="hyp-type"><b>: </b><span>VLSMMachine (vtype X)</span></span></span></span><br><span><var>s</var><span class="hyp-type"><b>: </b><span>state</span></span></span><br><span><var>om</var><span class="hyp-type"><b>: </b><span>option message</span></span></span><br><span><var>Him</var><span class="hyp-type"><b>: </b><span>initial_state_prop s
‚àß option_initial_message_prop om</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">valid_state_message_prop s om</div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="nb">constructor</span>; <span class="nb">apply</span> Him.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Qed</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
</span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Definition</span> <span class="nf">can_produce_valid_iff</span>
      (<span class="nv">s</span> : state)
      (<span class="nv">m</span> : message)
      : valid_state_message_prop s (Some m) &lt;-&gt;
        can_produce s m \/ initial_state_prop s /\ initial_message_prop m
      := option_can_produce_valid_iff s (Some m).</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
</span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Definition</span> <span class="nf">can_emit</span>
      (<span class="nv">m</span> : message)
      :=
      <span class="kr">exists</span>
      (<span class="nv">som</span> : state * option message)
      (<span class="nv">l</span> : label)
      (<span class="nv">s</span> : state),
      input_valid_transition l som (s, Some m).</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
</span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="VLSM-v-chkc4" style="display: none" type="checkbox"><label class="alectryon-input" for="VLSM-v-chkc4"><span class="kn">Lemma</span> <span class="nf">can_emit_iff</span>
      (<span class="nv">m</span> : message)
      : can_emit m &lt;-&gt; <span class="kr">exists</span> <span class="nv">s</span>, can_produce s m.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>message</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>X</var><span class="hyp-type"><b>: </b><span>VLSM message</span></span></span><br><span><var>TypeX</var><span><span class="hyp-body"><b>:= </b><span>type X</span></span><span class="hyp-type"><b>: </b><span>VLSMType message</span></span></span></span><br><span><var>MachineX</var><span><span class="hyp-body"><b>:= </b><span>machine X</span></span><span class="hyp-type"><b>: </b><span>VLSMMachine (vtype X)</span></span></span></span><br><span><var>m</var><span class="hyp-type"><b>: </b><span>message</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">can_emit m ‚Üî (<span class="kr">‚àÉ</span> <span class="nv">s</span> : state, can_produce s m)</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="VLSM-v-chkc5" style="display: none" type="checkbox"><label class="alectryon-input" for="VLSM-v-chkc5"><span class="kn">Proof</span>.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>message</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>X</var><span class="hyp-type"><b>: </b><span>VLSM message</span></span></span><br><span><var>TypeX</var><span><span class="hyp-body"><b>:= </b><span>type X</span></span><span class="hyp-type"><b>: </b><span>VLSMType message</span></span></span></span><br><span><var>MachineX</var><span><span class="hyp-body"><b>:= </b><span>machine X</span></span><span class="hyp-type"><b>: </b><span>VLSMMachine (vtype X)</span></span></span></span><br><span><var>m</var><span class="hyp-type"><b>: </b><span>message</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">can_emit m ‚Üî (<span class="kr">‚àÉ</span> <span class="nv">s</span> : state, can_produce s m)</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">      </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="VLSM-v-chkc6" style="display: none" type="checkbox"><label class="alectryon-input" for="VLSM-v-chkc6"><span class="nb">split</span>.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>message</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>X</var><span class="hyp-type"><b>: </b><span>VLSM message</span></span></span><br><span><var>TypeX</var><span><span class="hyp-body"><b>:= </b><span>type X</span></span><span class="hyp-type"><b>: </b><span>VLSMType message</span></span></span></span><br><span><var>MachineX</var><span><span class="hyp-body"><b>:= </b><span>machine X</span></span><span class="hyp-type"><b>: </b><span>VLSMMachine (vtype X)</span></span></span></span><br><span><var>m</var><span class="hyp-type"><b>: </b><span>message</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">can_emit m ‚Üí <span class="kr">‚àÉ</span> <span class="nv">s</span> : state, can_produce s m</div></blockquote><div class="alectryon-extra-goals"><input class="alectryon-extra-goal-toggle" id="VLSM-v-chkc7" style="display: none" type="checkbox"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>message</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>X</var><span class="hyp-type"><b>: </b><span>VLSM message</span></span></span><br><span><var>TypeX</var><span><span class="hyp-body"><b>:= </b><span>type X</span></span><span class="hyp-type"><b>: </b><span>VLSMType message</span></span></span></span><br><span><var>MachineX</var><span><span class="hyp-body"><b>:= </b><span>machine X</span></span><span class="hyp-type"><b>: </b><span>VLSMMachine (vtype X)</span></span></span></span><br><span><var>m</var><span class="hyp-type"><b>: </b><span>message</span></span></span><br></div><label class="goal-separator" for="VLSM-v-chkc7"><hr></label><div class="goal-conclusion">(<span class="kr">‚àÉ</span> <span class="nv">s</span> : state, can_produce s m) ‚Üí can_emit m</div></blockquote></div></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">      </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="VLSM-v-chkc8" style="display: none" type="checkbox"><label class="alectryon-input" for="VLSM-v-chkc8">-</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>message</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>X</var><span class="hyp-type"><b>: </b><span>VLSM message</span></span></span><br><span><var>TypeX</var><span><span class="hyp-body"><b>:= </b><span>type X</span></span><span class="hyp-type"><b>: </b><span>VLSMType message</span></span></span></span><br><span><var>MachineX</var><span><span class="hyp-body"><b>:= </b><span>machine X</span></span><span class="hyp-type"><b>: </b><span>VLSMMachine (vtype X)</span></span></span></span><br><span><var>m</var><span class="hyp-type"><b>: </b><span>message</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">can_emit m ‚Üí <span class="kr">‚àÉ</span> <span class="nv">s</span> : state, can_produce s m</div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="VLSM-v-chkc9" style="display: none" type="checkbox"><label class="alectryon-input" for="VLSM-v-chkc9"><span class="nb">intros</span> [som [l [s Ht]]].</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>message</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>X</var><span class="hyp-type"><b>: </b><span>VLSM message</span></span></span><br><span><var>TypeX</var><span><span class="hyp-body"><b>:= </b><span>type X</span></span><span class="hyp-type"><b>: </b><span>VLSMType message</span></span></span></span><br><span><var>MachineX</var><span><span class="hyp-body"><b>:= </b><span>machine X</span></span><span class="hyp-type"><b>: </b><span>VLSMMachine (vtype X)</span></span></span></span><br><span><var>m</var><span class="hyp-type"><b>: </b><span>message</span></span></span><br><span><var>som</var><span class="hyp-type"><b>: </b><span>(state * option message)%type</span></span></span><br><span><var>l</var><span class="hyp-type"><b>: </b><span>label</span></span></span><br><span><var>s</var><span class="hyp-type"><b>: </b><span>state</span></span></span><br><span><var>Ht</var><span class="hyp-type"><b>: </b><span>input_valid_transition l som (s, Some m)</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="kr">‚àÉ</span> <span class="nv">s</span> : state, can_produce s m</div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="VLSM-v-chkca" style="display: none" type="checkbox"><label class="alectryon-input" for="VLSM-v-chkca"><span class="kr">exists</span> <span class="nv">s</span>, som, l.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>message</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>X</var><span class="hyp-type"><b>: </b><span>VLSM message</span></span></span><br><span><var>TypeX</var><span><span class="hyp-body"><b>:= </b><span>type X</span></span><span class="hyp-type"><b>: </b><span>VLSMType message</span></span></span></span><br><span><var>MachineX</var><span><span class="hyp-body"><b>:= </b><span>machine X</span></span><span class="hyp-type"><b>: </b><span>VLSMMachine (vtype X)</span></span></span></span><br><span><var>m</var><span class="hyp-type"><b>: </b><span>message</span></span></span><br><span><var>som</var><span class="hyp-type"><b>: </b><span>(state * option message)%type</span></span></span><br><span><var>l</var><span class="hyp-type"><b>: </b><span>label</span></span></span><br><span><var>s</var><span class="hyp-type"><b>: </b><span>state</span></span></span><br><span><var>Ht</var><span class="hyp-type"><b>: </b><span>input_valid_transition l som (s, Some m)</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">input_valid_transition l som (s, Some m)</div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="bp">assumption</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">      </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="VLSM-v-chkcb" style="display: none" type="checkbox"><label class="alectryon-input" for="VLSM-v-chkcb">-</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>message</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>X</var><span class="hyp-type"><b>: </b><span>VLSM message</span></span></span><br><span><var>TypeX</var><span><span class="hyp-body"><b>:= </b><span>type X</span></span><span class="hyp-type"><b>: </b><span>VLSMType message</span></span></span></span><br><span><var>MachineX</var><span><span class="hyp-body"><b>:= </b><span>machine X</span></span><span class="hyp-type"><b>: </b><span>VLSMMachine (vtype X)</span></span></span></span><br><span><var>m</var><span class="hyp-type"><b>: </b><span>message</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">(<span class="kr">‚àÉ</span> <span class="nv">s</span> : state, can_produce s m) ‚Üí can_emit m</div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="VLSM-v-chkcc" style="display: none" type="checkbox"><label class="alectryon-input" for="VLSM-v-chkcc"><span class="nb">intros</span> [s [som [l Ht]]].</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>message</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>X</var><span class="hyp-type"><b>: </b><span>VLSM message</span></span></span><br><span><var>TypeX</var><span><span class="hyp-body"><b>:= </b><span>type X</span></span><span class="hyp-type"><b>: </b><span>VLSMType message</span></span></span></span><br><span><var>MachineX</var><span><span class="hyp-body"><b>:= </b><span>machine X</span></span><span class="hyp-type"><b>: </b><span>VLSMMachine (vtype X)</span></span></span></span><br><span><var>m</var><span class="hyp-type"><b>: </b><span>message</span></span></span><br><span><var>s</var><span class="hyp-type"><b>: </b><span>state</span></span></span><br><span><var>som</var><span class="hyp-type"><b>: </b><span>(state * option message)%type</span></span></span><br><span><var>l</var><span class="hyp-type"><b>: </b><span>label</span></span></span><br><span><var>Ht</var><span class="hyp-type"><b>: </b><span>input_valid_transition l som (s, Some m)</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">can_emit m</div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="VLSM-v-chkcd" style="display: none" type="checkbox"><label class="alectryon-input" for="VLSM-v-chkcd"><span class="kr">exists</span> <span class="nv">som</span>, l, s.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>message</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>X</var><span class="hyp-type"><b>: </b><span>VLSM message</span></span></span><br><span><var>TypeX</var><span><span class="hyp-body"><b>:= </b><span>type X</span></span><span class="hyp-type"><b>: </b><span>VLSMType message</span></span></span></span><br><span><var>MachineX</var><span><span class="hyp-body"><b>:= </b><span>machine X</span></span><span class="hyp-type"><b>: </b><span>VLSMMachine (vtype X)</span></span></span></span><br><span><var>m</var><span class="hyp-type"><b>: </b><span>message</span></span></span><br><span><var>s</var><span class="hyp-type"><b>: </b><span>state</span></span></span><br><span><var>som</var><span class="hyp-type"><b>: </b><span>(state * option message)%type</span></span></span><br><span><var>l</var><span class="hyp-type"><b>: </b><span>label</span></span></span><br><span><var>Ht</var><span class="hyp-type"><b>: </b><span>input_valid_transition l som (s, Some m)</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">input_valid_transition l som (s, Some m)</div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="bp">assumption</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Qed</span>.</span></span></pre><div class="doc">
If a VLSM <span class="inlinecode"><span class="id" title="var">can_emit</span></span> a message <code>m</code>, then <code>m</code> is valid.
    
</div><pre class="alectryon-io highlight"><!-- Generator: Alectryon --><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="VLSM-v-chkce" style="display: none" type="checkbox"><label class="alectryon-input" for="VLSM-v-chkce"><span class="kn">Lemma</span> <span class="nf">emitted_messages_are_valid</span>
      (<span class="nv">m</span> : message)
      (<span class="nv">Hm</span> : can_emit m)
      : valid_message_prop m .</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>message</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>X</var><span class="hyp-type"><b>: </b><span>VLSM message</span></span></span><br><span><var>TypeX</var><span><span class="hyp-body"><b>:= </b><span>type X</span></span><span class="hyp-type"><b>: </b><span>VLSMType message</span></span></span></span><br><span><var>MachineX</var><span><span class="hyp-body"><b>:= </b><span>machine X</span></span><span class="hyp-type"><b>: </b><span>VLSMMachine (vtype X)</span></span></span></span><br><span><var>m</var><span class="hyp-type"><b>: </b><span>message</span></span></span><br><span><var>Hm</var><span class="hyp-type"><b>: </b><span>can_emit m</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">valid_message_prop m</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="VLSM-v-chkcf" style="display: none" type="checkbox"><label class="alectryon-input" for="VLSM-v-chkcf"><span class="kn">Proof</span>.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>message</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>X</var><span class="hyp-type"><b>: </b><span>VLSM message</span></span></span><br><span><var>TypeX</var><span><span class="hyp-body"><b>:= </b><span>type X</span></span><span class="hyp-type"><b>: </b><span>VLSMType message</span></span></span></span><br><span><var>MachineX</var><span><span class="hyp-body"><b>:= </b><span>machine X</span></span><span class="hyp-type"><b>: </b><span>VLSMMachine (vtype X)</span></span></span></span><br><span><var>m</var><span class="hyp-type"><b>: </b><span>message</span></span></span><br><span><var>Hm</var><span class="hyp-type"><b>: </b><span>can_emit m</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">valid_message_prop m</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">      </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="VLSM-v-chkd0" style="display: none" type="checkbox"><label class="alectryon-input" for="VLSM-v-chkd0"><span class="nb">apply</span> can_emit_iff <span class="kr">in</span> Hm.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>message</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>X</var><span class="hyp-type"><b>: </b><span>VLSM message</span></span></span><br><span><var>TypeX</var><span><span class="hyp-body"><b>:= </b><span>type X</span></span><span class="hyp-type"><b>: </b><span>VLSMType message</span></span></span></span><br><span><var>MachineX</var><span><span class="hyp-body"><b>:= </b><span>machine X</span></span><span class="hyp-type"><b>: </b><span>VLSMMachine (vtype X)</span></span></span></span><br><span><var>m</var><span class="hyp-type"><b>: </b><span>message</span></span></span><br><span><var>Hm</var><span class="hyp-type"><b>: </b><span><span class="kr">‚àÉ</span> <span class="nv">s</span> : state, can_produce s m</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">valid_message_prop m</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">      </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="VLSM-v-chkd1" style="display: none" type="checkbox"><label class="alectryon-input" for="VLSM-v-chkd1"><span class="nb">destruct</span> Hm <span class="kr">as</span> [s Hm].</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>message</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>X</var><span class="hyp-type"><b>: </b><span>VLSM message</span></span></span><br><span><var>TypeX</var><span><span class="hyp-body"><b>:= </b><span>type X</span></span><span class="hyp-type"><b>: </b><span>VLSMType message</span></span></span></span><br><span><var>MachineX</var><span><span class="hyp-body"><b>:= </b><span>machine X</span></span><span class="hyp-type"><b>: </b><span>VLSMMachine (vtype X)</span></span></span></span><br><span><var>m</var><span class="hyp-type"><b>: </b><span>message</span></span></span><br><span><var>s</var><span class="hyp-type"><b>: </b><span>state</span></span></span><br><span><var>Hm</var><span class="hyp-type"><b>: </b><span>can_produce s m</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">valid_message_prop m</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">      </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="VLSM-v-chkd2" style="display: none" type="checkbox"><label class="alectryon-input" for="VLSM-v-chkd2"><span class="nb">apply</span> can_produce_valid <span class="kr">in</span> Hm.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>message</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>X</var><span class="hyp-type"><b>: </b><span>VLSM message</span></span></span><br><span><var>TypeX</var><span><span class="hyp-body"><b>:= </b><span>type X</span></span><span class="hyp-type"><b>: </b><span>VLSMType message</span></span></span></span><br><span><var>MachineX</var><span><span class="hyp-body"><b>:= </b><span>machine X</span></span><span class="hyp-type"><b>: </b><span>VLSMMachine (vtype X)</span></span></span></span><br><span><var>m</var><span class="hyp-type"><b>: </b><span>message</span></span></span><br><span><var>s</var><span class="hyp-type"><b>: </b><span>state</span></span></span><br><span><var>Hm</var><span class="hyp-type"><b>: </b><span>valid_state_message_prop s (Some m)</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">valid_message_prop m</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">      </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="VLSM-v-chkd3" style="display: none" type="checkbox"><label class="alectryon-input" for="VLSM-v-chkd3"><span class="kr">exists</span> <span class="nv">s</span>.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>message</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>X</var><span class="hyp-type"><b>: </b><span>VLSM message</span></span></span><br><span><var>TypeX</var><span><span class="hyp-body"><b>:= </b><span>type X</span></span><span class="hyp-type"><b>: </b><span>VLSMType message</span></span></span></span><br><span><var>MachineX</var><span><span class="hyp-body"><b>:= </b><span>machine X</span></span><span class="hyp-type"><b>: </b><span>VLSMMachine (vtype X)</span></span></span></span><br><span><var>m</var><span class="hyp-type"><b>: </b><span>message</span></span></span><br><span><var>s</var><span class="hyp-type"><b>: </b><span>state</span></span></span><br><span><var>Hm</var><span class="hyp-type"><b>: </b><span>valid_state_message_prop s (Some m)</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">valid_state_message_prop s (Some m)</div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="bp">assumption</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Qed</span>.</span></span></pre><div class="doc">
A characterization of valid messages in terms of <span class="inlinecode"><span class="id" title="var">can_emit</span></span>
</div><pre class="alectryon-io highlight"><!-- Generator: Alectryon --><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="VLSM-v-chkd4" style="display: none" type="checkbox"><label class="alectryon-input" for="VLSM-v-chkd4"><span class="kn">Lemma</span> <span class="nf">emitted_messages_are_valid_iff</span>
      (<span class="nv">m</span> : message)
      : valid_message_prop m &lt;-&gt; initial_message_prop m \/ can_emit m.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>message</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>X</var><span class="hyp-type"><b>: </b><span>VLSM message</span></span></span><br><span><var>TypeX</var><span><span class="hyp-body"><b>:= </b><span>type X</span></span><span class="hyp-type"><b>: </b><span>VLSMType message</span></span></span></span><br><span><var>MachineX</var><span><span class="hyp-body"><b>:= </b><span>machine X</span></span><span class="hyp-type"><b>: </b><span>VLSMMachine (vtype X)</span></span></span></span><br><span><var>m</var><span class="hyp-type"><b>: </b><span>message</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">valid_message_prop m
‚Üî initial_message_prop m ‚à® can_emit m</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="VLSM-v-chkd5" style="display: none" type="checkbox"><label class="alectryon-input" for="VLSM-v-chkd5"><span class="kn">Proof</span>.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>message</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>X</var><span class="hyp-type"><b>: </b><span>VLSM message</span></span></span><br><span><var>TypeX</var><span><span class="hyp-body"><b>:= </b><span>type X</span></span><span class="hyp-type"><b>: </b><span>VLSMType message</span></span></span></span><br><span><var>MachineX</var><span><span class="hyp-body"><b>:= </b><span>machine X</span></span><span class="hyp-type"><b>: </b><span>VLSMMachine (vtype X)</span></span></span></span><br><span><var>m</var><span class="hyp-type"><b>: </b><span>message</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">valid_message_prop m
‚Üî initial_message_prop m ‚à® can_emit m</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">      </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="VLSM-v-chkd6" style="display: none" type="checkbox"><label class="alectryon-input" for="VLSM-v-chkd6"><span class="nb">split</span>.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>message</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>X</var><span class="hyp-type"><b>: </b><span>VLSM message</span></span></span><br><span><var>TypeX</var><span><span class="hyp-body"><b>:= </b><span>type X</span></span><span class="hyp-type"><b>: </b><span>VLSMType message</span></span></span></span><br><span><var>MachineX</var><span><span class="hyp-body"><b>:= </b><span>machine X</span></span><span class="hyp-type"><b>: </b><span>VLSMMachine (vtype X)</span></span></span></span><br><span><var>m</var><span class="hyp-type"><b>: </b><span>message</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">valid_message_prop m
‚Üí initial_message_prop m ‚à® can_emit m</div></blockquote><div class="alectryon-extra-goals"><input class="alectryon-extra-goal-toggle" id="VLSM-v-chkd7" style="display: none" type="checkbox"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>message</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>X</var><span class="hyp-type"><b>: </b><span>VLSM message</span></span></span><br><span><var>TypeX</var><span><span class="hyp-body"><b>:= </b><span>type X</span></span><span class="hyp-type"><b>: </b><span>VLSMType message</span></span></span></span><br><span><var>MachineX</var><span><span class="hyp-body"><b>:= </b><span>machine X</span></span><span class="hyp-type"><b>: </b><span>VLSMMachine (vtype X)</span></span></span></span><br><span><var>m</var><span class="hyp-type"><b>: </b><span>message</span></span></span><br></div><label class="goal-separator" for="VLSM-v-chkd7"><hr></label><div class="goal-conclusion">initial_message_prop m ‚à® can_emit m
‚Üí valid_message_prop m</div></blockquote></div></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">      </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="VLSM-v-chkd8" style="display: none" type="checkbox"><label class="alectryon-input" for="VLSM-v-chkd8">-</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>message</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>X</var><span class="hyp-type"><b>: </b><span>VLSM message</span></span></span><br><span><var>TypeX</var><span><span class="hyp-body"><b>:= </b><span>type X</span></span><span class="hyp-type"><b>: </b><span>VLSMType message</span></span></span></span><br><span><var>MachineX</var><span><span class="hyp-body"><b>:= </b><span>machine X</span></span><span class="hyp-type"><b>: </b><span>VLSMMachine (vtype X)</span></span></span></span><br><span><var>m</var><span class="hyp-type"><b>: </b><span>message</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">valid_message_prop m
‚Üí initial_message_prop m ‚à® can_emit m</div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="VLSM-v-chkd9" style="display: none" type="checkbox"><label class="alectryon-input" for="VLSM-v-chkd9"><span class="nb">intros</span> [s Hm].</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>message</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>X</var><span class="hyp-type"><b>: </b><span>VLSM message</span></span></span><br><span><var>TypeX</var><span><span class="hyp-body"><b>:= </b><span>type X</span></span><span class="hyp-type"><b>: </b><span>VLSMType message</span></span></span></span><br><span><var>MachineX</var><span><span class="hyp-body"><b>:= </b><span>machine X</span></span><span class="hyp-type"><b>: </b><span>VLSMMachine (vtype X)</span></span></span></span><br><span><var>m</var><span class="hyp-type"><b>: </b><span>message</span></span></span><br><span><var>s</var><span class="hyp-type"><b>: </b><span>state</span></span></span><br><span><var>Hm</var><span class="hyp-type"><b>: </b><span>valid_state_message_prop s (Some m)</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">initial_message_prop m ‚à® can_emit m</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">        </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="VLSM-v-chkda" style="display: none" type="checkbox"><label class="alectryon-input" for="VLSM-v-chkda"><span class="nb">apply</span> can_produce_valid_iff <span class="kr">in</span> Hm <span class="kr">as</span> [Hgen | [_ Him]].</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>message</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>X</var><span class="hyp-type"><b>: </b><span>VLSM message</span></span></span><br><span><var>TypeX</var><span><span class="hyp-body"><b>:= </b><span>type X</span></span><span class="hyp-type"><b>: </b><span>VLSMType message</span></span></span></span><br><span><var>MachineX</var><span><span class="hyp-body"><b>:= </b><span>machine X</span></span><span class="hyp-type"><b>: </b><span>VLSMMachine (vtype X)</span></span></span></span><br><span><var>m</var><span class="hyp-type"><b>: </b><span>message</span></span></span><br><span><var>s</var><span class="hyp-type"><b>: </b><span>state</span></span></span><br><span><var>Hgen</var><span class="hyp-type"><b>: </b><span>can_produce s m</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">initial_message_prop m ‚à® can_emit m</div></blockquote><div class="alectryon-extra-goals"><input class="alectryon-extra-goal-toggle" id="VLSM-v-chkdb" style="display: none" type="checkbox"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>message</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>X</var><span class="hyp-type"><b>: </b><span>VLSM message</span></span></span><br><span><var>TypeX</var><span><span class="hyp-body"><b>:= </b><span>type X</span></span><span class="hyp-type"><b>: </b><span>VLSMType message</span></span></span></span><br><span><var>MachineX</var><span><span class="hyp-body"><b>:= </b><span>machine X</span></span><span class="hyp-type"><b>: </b><span>VLSMMachine (vtype X)</span></span></span></span><br><span><var>m</var><span class="hyp-type"><b>: </b><span>message</span></span></span><br><span><var>s</var><span class="hyp-type"><b>: </b><span>state</span></span></span><br><span><var>Him</var><span class="hyp-type"><b>: </b><span>initial_message_prop m</span></span></span><br></div><label class="goal-separator" for="VLSM-v-chkdb"><hr></label><div class="goal-conclusion">initial_message_prop m ‚à® can_emit m</div></blockquote></div></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">        </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="VLSM-v-chkdc" style="display: none" type="checkbox"><label class="alectryon-input" for="VLSM-v-chkdc">+</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>message</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>X</var><span class="hyp-type"><b>: </b><span>VLSM message</span></span></span><br><span><var>TypeX</var><span><span class="hyp-body"><b>:= </b><span>type X</span></span><span class="hyp-type"><b>: </b><span>VLSMType message</span></span></span></span><br><span><var>MachineX</var><span><span class="hyp-body"><b>:= </b><span>machine X</span></span><span class="hyp-type"><b>: </b><span>VLSMMachine (vtype X)</span></span></span></span><br><span><var>m</var><span class="hyp-type"><b>: </b><span>message</span></span></span><br><span><var>s</var><span class="hyp-type"><b>: </b><span>state</span></span></span><br><span><var>Hgen</var><span class="hyp-type"><b>: </b><span>can_produce s m</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">initial_message_prop m ‚à® can_emit m</div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="VLSM-v-chkdd" style="display: none" type="checkbox"><label class="alectryon-input" for="VLSM-v-chkdd"><span class="nb">right</span>.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>message</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>X</var><span class="hyp-type"><b>: </b><span>VLSM message</span></span></span><br><span><var>TypeX</var><span><span class="hyp-body"><b>:= </b><span>type X</span></span><span class="hyp-type"><b>: </b><span>VLSMType message</span></span></span></span><br><span><var>MachineX</var><span><span class="hyp-body"><b>:= </b><span>machine X</span></span><span class="hyp-type"><b>: </b><span>VLSMMachine (vtype X)</span></span></span></span><br><span><var>m</var><span class="hyp-type"><b>: </b><span>message</span></span></span><br><span><var>s</var><span class="hyp-type"><b>: </b><span>state</span></span></span><br><span><var>Hgen</var><span class="hyp-type"><b>: </b><span>can_produce s m</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">can_emit m</div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="VLSM-v-chkde" style="display: none" type="checkbox"><label class="alectryon-input" for="VLSM-v-chkde"><span class="nb">apply</span> can_emit_iff.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>message</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>X</var><span class="hyp-type"><b>: </b><span>VLSM message</span></span></span><br><span><var>TypeX</var><span><span class="hyp-body"><b>:= </b><span>type X</span></span><span class="hyp-type"><b>: </b><span>VLSMType message</span></span></span></span><br><span><var>MachineX</var><span><span class="hyp-body"><b>:= </b><span>machine X</span></span><span class="hyp-type"><b>: </b><span>VLSMMachine (vtype X)</span></span></span></span><br><span><var>m</var><span class="hyp-type"><b>: </b><span>message</span></span></span><br><span><var>s</var><span class="hyp-type"><b>: </b><span>state</span></span></span><br><span><var>Hgen</var><span class="hyp-type"><b>: </b><span>can_produce s m</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="kr">‚àÉ</span> <span class="nv">s</span> : state, can_produce s m</div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="VLSM-v-chkdf" style="display: none" type="checkbox"><label class="alectryon-input" for="VLSM-v-chkdf"><span class="kr">exists</span> <span class="nv">s</span>.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>message</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>X</var><span class="hyp-type"><b>: </b><span>VLSM message</span></span></span><br><span><var>TypeX</var><span><span class="hyp-body"><b>:= </b><span>type X</span></span><span class="hyp-type"><b>: </b><span>VLSMType message</span></span></span></span><br><span><var>MachineX</var><span><span class="hyp-body"><b>:= </b><span>machine X</span></span><span class="hyp-type"><b>: </b><span>VLSMMachine (vtype X)</span></span></span></span><br><span><var>m</var><span class="hyp-type"><b>: </b><span>message</span></span></span><br><span><var>s</var><span class="hyp-type"><b>: </b><span>state</span></span></span><br><span><var>Hgen</var><span class="hyp-type"><b>: </b><span>can_produce s m</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">can_produce s m</div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="bp">assumption</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">        </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="VLSM-v-chke0" style="display: none" type="checkbox"><label class="alectryon-input" for="VLSM-v-chke0">+</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>message</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>X</var><span class="hyp-type"><b>: </b><span>VLSM message</span></span></span><br><span><var>TypeX</var><span><span class="hyp-body"><b>:= </b><span>type X</span></span><span class="hyp-type"><b>: </b><span>VLSMType message</span></span></span></span><br><span><var>MachineX</var><span><span class="hyp-body"><b>:= </b><span>machine X</span></span><span class="hyp-type"><b>: </b><span>VLSMMachine (vtype X)</span></span></span></span><br><span><var>m</var><span class="hyp-type"><b>: </b><span>message</span></span></span><br><span><var>s</var><span class="hyp-type"><b>: </b><span>state</span></span></span><br><span><var>Him</var><span class="hyp-type"><b>: </b><span>initial_message_prop m</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">initial_message_prop m ‚à® can_emit m</div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="VLSM-v-chke1" style="display: none" type="checkbox"><label class="alectryon-input" for="VLSM-v-chke1"><span class="nb">left</span>.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>message</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>X</var><span class="hyp-type"><b>: </b><span>VLSM message</span></span></span><br><span><var>TypeX</var><span><span class="hyp-body"><b>:= </b><span>type X</span></span><span class="hyp-type"><b>: </b><span>VLSMType message</span></span></span></span><br><span><var>MachineX</var><span><span class="hyp-body"><b>:= </b><span>machine X</span></span><span class="hyp-type"><b>: </b><span>VLSMMachine (vtype X)</span></span></span></span><br><span><var>m</var><span class="hyp-type"><b>: </b><span>message</span></span></span><br><span><var>s</var><span class="hyp-type"><b>: </b><span>state</span></span></span><br><span><var>Him</var><span class="hyp-type"><b>: </b><span>initial_message_prop m</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">initial_message_prop m</div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="bp">assumption</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">      </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="VLSM-v-chke2" style="display: none" type="checkbox"><label class="alectryon-input" for="VLSM-v-chke2">-</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>message</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>X</var><span class="hyp-type"><b>: </b><span>VLSM message</span></span></span><br><span><var>TypeX</var><span><span class="hyp-body"><b>:= </b><span>type X</span></span><span class="hyp-type"><b>: </b><span>VLSMType message</span></span></span></span><br><span><var>MachineX</var><span><span class="hyp-body"><b>:= </b><span>machine X</span></span><span class="hyp-type"><b>: </b><span>VLSMMachine (vtype X)</span></span></span></span><br><span><var>m</var><span class="hyp-type"><b>: </b><span>message</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">initial_message_prop m ‚à® can_emit m
‚Üí valid_message_prop m</div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="VLSM-v-chke3" style="display: none" type="checkbox"><label class="alectryon-input" for="VLSM-v-chke3"><span class="nb">intros</span> [Him | Hm].</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>message</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>X</var><span class="hyp-type"><b>: </b><span>VLSM message</span></span></span><br><span><var>TypeX</var><span><span class="hyp-body"><b>:= </b><span>type X</span></span><span class="hyp-type"><b>: </b><span>VLSMType message</span></span></span></span><br><span><var>MachineX</var><span><span class="hyp-body"><b>:= </b><span>machine X</span></span><span class="hyp-type"><b>: </b><span>VLSMMachine (vtype X)</span></span></span></span><br><span><var>m</var><span class="hyp-type"><b>: </b><span>message</span></span></span><br><span><var>Him</var><span class="hyp-type"><b>: </b><span>initial_message_prop m</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">valid_message_prop m</div></blockquote><div class="alectryon-extra-goals"><input class="alectryon-extra-goal-toggle" id="VLSM-v-chke4" style="display: none" type="checkbox"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>message</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>X</var><span class="hyp-type"><b>: </b><span>VLSM message</span></span></span><br><span><var>TypeX</var><span><span class="hyp-body"><b>:= </b><span>type X</span></span><span class="hyp-type"><b>: </b><span>VLSMType message</span></span></span></span><br><span><var>MachineX</var><span><span class="hyp-body"><b>:= </b><span>machine X</span></span><span class="hyp-type"><b>: </b><span>VLSMMachine (vtype X)</span></span></span></span><br><span><var>m</var><span class="hyp-type"><b>: </b><span>message</span></span></span><br><span><var>Hm</var><span class="hyp-type"><b>: </b><span>can_emit m</span></span></span><br></div><label class="goal-separator" for="VLSM-v-chke4"><hr></label><div class="goal-conclusion">valid_message_prop m</div></blockquote></div></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">        </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="VLSM-v-chke5" style="display: none" type="checkbox"><label class="alectryon-input" for="VLSM-v-chke5">+</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>message</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>X</var><span class="hyp-type"><b>: </b><span>VLSM message</span></span></span><br><span><var>TypeX</var><span><span class="hyp-body"><b>:= </b><span>type X</span></span><span class="hyp-type"><b>: </b><span>VLSMType message</span></span></span></span><br><span><var>MachineX</var><span><span class="hyp-body"><b>:= </b><span>machine X</span></span><span class="hyp-type"><b>: </b><span>VLSMMachine (vtype X)</span></span></span></span><br><span><var>m</var><span class="hyp-type"><b>: </b><span>message</span></span></span><br><span><var>Him</var><span class="hyp-type"><b>: </b><span>initial_message_prop m</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">valid_message_prop m</div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="VLSM-v-chke6" style="display: none" type="checkbox"><label class="alectryon-input" for="VLSM-v-chke6"><span class="nb">apply</span> initial_message_is_valid.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>message</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>X</var><span class="hyp-type"><b>: </b><span>VLSM message</span></span></span><br><span><var>TypeX</var><span><span class="hyp-body"><b>:= </b><span>type X</span></span><span class="hyp-type"><b>: </b><span>VLSMType message</span></span></span></span><br><span><var>MachineX</var><span><span class="hyp-body"><b>:= </b><span>machine X</span></span><span class="hyp-type"><b>: </b><span>VLSMMachine (vtype X)</span></span></span></span><br><span><var>m</var><span class="hyp-type"><b>: </b><span>message</span></span></span><br><span><var>Him</var><span class="hyp-type"><b>: </b><span>initial_message_prop m</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">initial_message_prop m</div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="bp">assumption</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">        </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="VLSM-v-chke7" style="display: none" type="checkbox"><label class="alectryon-input" for="VLSM-v-chke7">+</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>message</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>X</var><span class="hyp-type"><b>: </b><span>VLSM message</span></span></span><br><span><var>TypeX</var><span><span class="hyp-body"><b>:= </b><span>type X</span></span><span class="hyp-type"><b>: </b><span>VLSMType message</span></span></span></span><br><span><var>MachineX</var><span><span class="hyp-body"><b>:= </b><span>machine X</span></span><span class="hyp-type"><b>: </b><span>VLSMMachine (vtype X)</span></span></span></span><br><span><var>m</var><span class="hyp-type"><b>: </b><span>message</span></span></span><br><span><var>Hm</var><span class="hyp-type"><b>: </b><span>can_emit m</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">valid_message_prop m</div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="VLSM-v-chke8" style="display: none" type="checkbox"><label class="alectryon-input" for="VLSM-v-chke8"><span class="nb">apply</span> emitted_messages_are_valid.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>message</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>X</var><span class="hyp-type"><b>: </b><span>VLSM message</span></span></span><br><span><var>TypeX</var><span><span class="hyp-body"><b>:= </b><span>type X</span></span><span class="hyp-type"><b>: </b><span>VLSMType message</span></span></span></span><br><span><var>MachineX</var><span><span class="hyp-body"><b>:= </b><span>machine X</span></span><span class="hyp-type"><b>: </b><span>VLSMMachine (vtype X)</span></span></span></span><br><span><var>m</var><span class="hyp-type"><b>: </b><span>message</span></span></span><br><span><var>Hm</var><span class="hyp-type"><b>: </b><span>can_emit m</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">can_emit m</div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="bp">assumption</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Qed</span>.</span></span></pre><div class="doc">
<a id="lab9"></a><h3 class="section">valid state and valid message characterization</h3>
<div class="paragraph"> </div>

The definition and results below show that the mutually-recursive definitions
for <span class="inlinecode"><span class="id" title="var">valid_state</span></span>s and <span class="inlinecode"><span class="id" title="var">valid_message</span></span>s can be derived from the
prior definitions.

<div class="paragraph"> </div>

The results below offers equivalent characterizations for <span class="inlinecode"><span class="id" title="var">valid_state</span></span>s
and <span class="inlinecode"><span class="id" title="var">valid_message</span></span>s, similar to their recursive definition.

</div><pre class="alectryon-io highlight"><!-- Generator: Alectryon --><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="VLSM-v-chke9" style="display: none" type="checkbox"><label class="alectryon-input" for="VLSM-v-chke9"><span class="kn">Lemma</span> <span class="nf">valid_state_prop_iff</span> :
      <span class="kr">forall</span> <span class="nv">s&#39;</span> : state,
        valid_state_prop s&#39;
        &lt;-&gt; (<span class="kr">exists</span> <span class="nv">is</span> : initial_state, s&#39; = proj1_sig <span class="kr">is</span>)
          \/ <span class="kr">exists</span> (<span class="nv">l</span> : label) (<span class="nv">som</span> : state * option message) (<span class="nv">om&#39;</span> : option message),
            input_valid_transition l som (s&#39;, om&#39;).</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>message</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>X</var><span class="hyp-type"><b>: </b><span>VLSM message</span></span></span><br><span><var>TypeX</var><span><span class="hyp-body"><b>:= </b><span>type X</span></span><span class="hyp-type"><b>: </b><span>VLSMType message</span></span></span></span><br><span><var>MachineX</var><span><span class="hyp-body"><b>:= </b><span>machine X</span></span><span class="hyp-type"><b>: </b><span>VLSMMachine (vtype X)</span></span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="kr">‚àÄ</span> <span class="nv">s&#39;</span> : state,
  valid_state_prop s&#39;
  ‚Üî (<span class="kr">‚àÉ</span> <span class="nv">is</span> : initial_state, s&#39; = `<span class="kr">is</span>)
    ‚à® (<span class="kr">‚àÉ</span> (<span class="nv">l</span> : label) (<span class="nv">som</span> : state * option message) 
         (<span class="nv">om&#39;</span> : option message),
         input_valid_transition l som (s&#39;, om&#39;))</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="VLSM-v-chkea" style="display: none" type="checkbox"><label class="alectryon-input" for="VLSM-v-chkea"><span class="kn">Proof</span>.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>message</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>X</var><span class="hyp-type"><b>: </b><span>VLSM message</span></span></span><br><span><var>TypeX</var><span><span class="hyp-body"><b>:= </b><span>type X</span></span><span class="hyp-type"><b>: </b><span>VLSMType message</span></span></span></span><br><span><var>MachineX</var><span><span class="hyp-body"><b>:= </b><span>machine X</span></span><span class="hyp-type"><b>: </b><span>VLSMMachine (vtype X)</span></span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="kr">‚àÄ</span> <span class="nv">s&#39;</span> : state,
  valid_state_prop s&#39;
  ‚Üî (<span class="kr">‚àÉ</span> <span class="nv">is</span> : initial_state, s&#39; = `<span class="kr">is</span>)
    ‚à® (<span class="kr">‚àÉ</span> (<span class="nv">l</span> : label) (<span class="nv">som</span> : state * option message) 
         (<span class="nv">om&#39;</span> : option message),
         input_valid_transition l som (s&#39;, om&#39;))</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">      </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="VLSM-v-chkeb" style="display: none" type="checkbox"><label class="alectryon-input" for="VLSM-v-chkeb"><span class="nb">intros</span>; <span class="nb">split</span>.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>message</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>X</var><span class="hyp-type"><b>: </b><span>VLSM message</span></span></span><br><span><var>TypeX</var><span><span class="hyp-body"><b>:= </b><span>type X</span></span><span class="hyp-type"><b>: </b><span>VLSMType message</span></span></span></span><br><span><var>MachineX</var><span><span class="hyp-body"><b>:= </b><span>machine X</span></span><span class="hyp-type"><b>: </b><span>VLSMMachine (vtype X)</span></span></span></span><br><span><var>s'</var><span class="hyp-type"><b>: </b><span>state</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">valid_state_prop s&#39;
‚Üí (<span class="kr">‚àÉ</span> <span class="nv">is</span> : initial_state, s&#39; = `<span class="kr">is</span>)
  ‚à® (<span class="kr">‚àÉ</span> (<span class="nv">l</span> : label) (<span class="nv">som</span> : state * option message) 
       (<span class="nv">om&#39;</span> : option message),
       input_valid_transition l som (s&#39;, om&#39;))</div></blockquote><div class="alectryon-extra-goals"><input class="alectryon-extra-goal-toggle" id="VLSM-v-chkec" style="display: none" type="checkbox"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>message</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>X</var><span class="hyp-type"><b>: </b><span>VLSM message</span></span></span><br><span><var>TypeX</var><span><span class="hyp-body"><b>:= </b><span>type X</span></span><span class="hyp-type"><b>: </b><span>VLSMType message</span></span></span></span><br><span><var>MachineX</var><span><span class="hyp-body"><b>:= </b><span>machine X</span></span><span class="hyp-type"><b>: </b><span>VLSMMachine (vtype X)</span></span></span></span><br><span><var>s'</var><span class="hyp-type"><b>: </b><span>state</span></span></span><br></div><label class="goal-separator" for="VLSM-v-chkec"><hr></label><div class="goal-conclusion">(<span class="kr">‚àÉ</span> <span class="nv">is</span> : initial_state, s&#39; = `<span class="kr">is</span>)
‚à® (<span class="kr">‚àÉ</span> (<span class="nv">l</span> : label) (<span class="nv">som</span> : state * option message) 
     (<span class="nv">om&#39;</span> : option message),
     input_valid_transition l som (s&#39;, om&#39;))
‚Üí valid_state_prop s&#39;</div></blockquote></div></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">      </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="VLSM-v-chked" style="display: none" type="checkbox"><label class="alectryon-input" for="VLSM-v-chked">-</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>message</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>X</var><span class="hyp-type"><b>: </b><span>VLSM message</span></span></span><br><span><var>TypeX</var><span><span class="hyp-body"><b>:= </b><span>type X</span></span><span class="hyp-type"><b>: </b><span>VLSMType message</span></span></span></span><br><span><var>MachineX</var><span><span class="hyp-body"><b>:= </b><span>machine X</span></span><span class="hyp-type"><b>: </b><span>VLSMMachine (vtype X)</span></span></span></span><br><span><var>s'</var><span class="hyp-type"><b>: </b><span>state</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">valid_state_prop s&#39;
‚Üí (<span class="kr">‚àÉ</span> <span class="nv">is</span> : initial_state, s&#39; = `<span class="kr">is</span>)
  ‚à® (<span class="kr">‚àÉ</span> (<span class="nv">l</span> : label) (<span class="nv">som</span> : state * option message) 
       (<span class="nv">om&#39;</span> : option message),
       input_valid_transition l som (s&#39;, om&#39;))</div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="VLSM-v-chkee" style="display: none" type="checkbox"><label class="alectryon-input" for="VLSM-v-chkee"><span class="nb">intro</span> Hps&#39;.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>message</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>X</var><span class="hyp-type"><b>: </b><span>VLSM message</span></span></span><br><span><var>TypeX</var><span><span class="hyp-body"><b>:= </b><span>type X</span></span><span class="hyp-type"><b>: </b><span>VLSMType message</span></span></span></span><br><span><var>MachineX</var><span><span class="hyp-body"><b>:= </b><span>machine X</span></span><span class="hyp-type"><b>: </b><span>VLSMMachine (vtype X)</span></span></span></span><br><span><var>s'</var><span class="hyp-type"><b>: </b><span>state</span></span></span><br><span><var>Hps'</var><span class="hyp-type"><b>: </b><span>valid_state_prop s&#39;</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">(<span class="kr">‚àÉ</span> <span class="nv">is</span> : initial_state, s&#39; = `<span class="kr">is</span>)
‚à® (<span class="kr">‚àÉ</span> (<span class="nv">l</span> : label) (<span class="nv">som</span> : state * option message) (<span class="nv">om&#39;</span> : 
                                                 option
                                                 message),
     input_valid_transition l som (s&#39;, om&#39;))</div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="VLSM-v-chkef" style="display: none" type="checkbox"><label class="alectryon-input" for="VLSM-v-chkef"><span class="nb">destruct</span> Hps&#39; <span class="kr">as</span> [om&#39; Hs].</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>message</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>X</var><span class="hyp-type"><b>: </b><span>VLSM message</span></span></span><br><span><var>TypeX</var><span><span class="hyp-body"><b>:= </b><span>type X</span></span><span class="hyp-type"><b>: </b><span>VLSMType message</span></span></span></span><br><span><var>MachineX</var><span><span class="hyp-body"><b>:= </b><span>machine X</span></span><span class="hyp-type"><b>: </b><span>VLSMMachine (vtype X)</span></span></span></span><br><span><var>s'</var><span class="hyp-type"><b>: </b><span>state</span></span></span><br><span><var>om'</var><span class="hyp-type"><b>: </b><span>option message</span></span></span><br><span><var>Hs</var><span class="hyp-type"><b>: </b><span>valid_state_message_prop s&#39; om&#39;</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">(<span class="kr">‚àÉ</span> <span class="nv">is</span> : initial_state, s&#39; = `<span class="kr">is</span>)
‚à® (<span class="kr">‚àÉ</span> (<span class="nv">l</span> : label) (<span class="nv">som</span> : state * option message) (<span class="nv">om&#39;</span> : 
                                                 option
                                                 message),
     input_valid_transition l som (s&#39;, om&#39;))</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">        </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="VLSM-v-chkf0" style="display: none" type="checkbox"><label class="alectryon-input" for="VLSM-v-chkf0"><span class="nb">inversion</span> Hs; <span class="nb">subst</span>.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>message</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>X</var><span class="hyp-type"><b>: </b><span>VLSM message</span></span></span><br><span><var>TypeX</var><span><span class="hyp-body"><b>:= </b><span>type X</span></span><span class="hyp-type"><b>: </b><span>VLSMType message</span></span></span></span><br><span><var>MachineX</var><span><span class="hyp-body"><b>:= </b><span>machine X</span></span><span class="hyp-type"><b>: </b><span>VLSMMachine (vtype X)</span></span></span></span><br><span><var>s'</var><span class="hyp-type"><b>: </b><span>state</span></span></span><br><span><var>om'</var><span class="hyp-type"><b>: </b><span>option message</span></span></span><br><span><var>Hs</var><span class="hyp-type"><b>: </b><span>valid_state_message_prop s&#39; om&#39;</span></span></span><br><span><var>Hs0</var><span class="hyp-type"><b>: </b><span>initial_state_prop s&#39;</span></span></span><br><span><var>Hom</var><span class="hyp-type"><b>: </b><span>option_initial_message_prop om&#39;</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">(<span class="kr">‚àÉ</span> <span class="nv">is</span> : initial_state, s&#39; = `<span class="kr">is</span>)
‚à® (<span class="kr">‚àÉ</span> (<span class="nv">l</span> : label) (<span class="nv">som</span> : state * option message) (<span class="nv">om&#39;</span> : 
                                                 option
                                                 message),
     input_valid_transition l som (s&#39;, om&#39;))</div></blockquote><div class="alectryon-extra-goals"><input class="alectryon-extra-goal-toggle" id="VLSM-v-chkf1" style="display: none" type="checkbox"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>message</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>X</var><span class="hyp-type"><b>: </b><span>VLSM message</span></span></span><br><span><var>TypeX</var><span><span class="hyp-body"><b>:= </b><span>type X</span></span><span class="hyp-type"><b>: </b><span>VLSMType message</span></span></span></span><br><span><var>MachineX</var><span><span class="hyp-body"><b>:= </b><span>machine X</span></span><span class="hyp-type"><b>: </b><span>VLSMMachine (vtype X)</span></span></span></span><br><span><var>s'</var><span class="hyp-type"><b>: </b><span>state</span></span></span><br><span><var>om'</var><span class="hyp-type"><b>: </b><span>option message</span></span></span><br><span><var>Hs</var><span class="hyp-type"><b>: </b><span>valid_state_message_prop s&#39; om&#39;</span></span></span><br><span><var>s</var><span class="hyp-type"><b>: </b><span>state</span></span></span><br><span><var>_om</var><span class="hyp-type"><b>: </b><span>option message</span></span></span><br><span><var>_s</var><span class="hyp-type"><b>: </b><span>state</span></span></span><br><span><var>om</var><span class="hyp-type"><b>: </b><span>option message</span></span></span><br><span><var>l0</var><span class="hyp-type"><b>: </b><span>label</span></span></span><br><span><var>Hps</var><span class="hyp-type"><b>: </b><span>valid_state_message_prop s _om</span></span></span><br><span><var>Hpm</var><span class="hyp-type"><b>: </b><span>valid_state_message_prop _s om</span></span></span><br><span><var>Hv</var><span class="hyp-type"><b>: </b><span>valid l0 (s, om)</span></span></span><br><span><var>Ht</var><span class="hyp-type"><b>: </b><span>transition l0 (s, om) = (s&#39;, om&#39;)</span></span></span><br></div><label class="goal-separator" for="VLSM-v-chkf1"><hr></label><div class="goal-conclusion">(<span class="kr">‚àÉ</span> <span class="nv">is</span> : initial_state, s&#39; = `<span class="kr">is</span>)
‚à® (<span class="kr">‚àÉ</span> (<span class="nv">l</span> : label) (<span class="nv">som</span> : state * option message) 
     (<span class="nv">om&#39;</span> : option message),
     input_valid_transition l som (s&#39;, om&#39;))</div></blockquote></div></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">        </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="VLSM-v-chkf2" style="display: none" type="checkbox"><label class="alectryon-input" for="VLSM-v-chkf2">*</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>message</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>X</var><span class="hyp-type"><b>: </b><span>VLSM message</span></span></span><br><span><var>TypeX</var><span><span class="hyp-body"><b>:= </b><span>type X</span></span><span class="hyp-type"><b>: </b><span>VLSMType message</span></span></span></span><br><span><var>MachineX</var><span><span class="hyp-body"><b>:= </b><span>machine X</span></span><span class="hyp-type"><b>: </b><span>VLSMMachine (vtype X)</span></span></span></span><br><span><var>s'</var><span class="hyp-type"><b>: </b><span>state</span></span></span><br><span><var>om'</var><span class="hyp-type"><b>: </b><span>option message</span></span></span><br><span><var>Hs</var><span class="hyp-type"><b>: </b><span>valid_state_message_prop s&#39; om&#39;</span></span></span><br><span><var>Hs0</var><span class="hyp-type"><b>: </b><span>initial_state_prop s&#39;</span></span></span><br><span><var>Hom</var><span class="hyp-type"><b>: </b><span>option_initial_message_prop om&#39;</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">(<span class="kr">‚àÉ</span> <span class="nv">is</span> : initial_state, s&#39; = `<span class="kr">is</span>)
‚à® (<span class="kr">‚àÉ</span> (<span class="nv">l</span> : label) (<span class="nv">som</span> : state * option message) (<span class="nv">om&#39;</span> : 
                                                 option
                                                 message),
     input_valid_transition l som (s&#39;, om&#39;))</div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="VLSM-v-chkf3" style="display: none" type="checkbox"><label class="alectryon-input" for="VLSM-v-chkf3"><span class="nb">left</span>.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>message</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>X</var><span class="hyp-type"><b>: </b><span>VLSM message</span></span></span><br><span><var>TypeX</var><span><span class="hyp-body"><b>:= </b><span>type X</span></span><span class="hyp-type"><b>: </b><span>VLSMType message</span></span></span></span><br><span><var>MachineX</var><span><span class="hyp-body"><b>:= </b><span>machine X</span></span><span class="hyp-type"><b>: </b><span>VLSMMachine (vtype X)</span></span></span></span><br><span><var>s'</var><span class="hyp-type"><b>: </b><span>state</span></span></span><br><span><var>om'</var><span class="hyp-type"><b>: </b><span>option message</span></span></span><br><span><var>Hs</var><span class="hyp-type"><b>: </b><span>valid_state_message_prop s&#39; om&#39;</span></span></span><br><span><var>Hs0</var><span class="hyp-type"><b>: </b><span>initial_state_prop s&#39;</span></span></span><br><span><var>Hom</var><span class="hyp-type"><b>: </b><span>option_initial_message_prop om&#39;</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="kr">‚àÉ</span> <span class="nv">is</span> : initial_state, s&#39; = `<span class="kr">is</span></div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="VLSM-v-chkf4" style="display: none" type="checkbox"><label class="alectryon-input" for="VLSM-v-chkf4"><span class="kr">exists</span> (<span class="nv">exist</span> <span class="nv">_</span> <span class="nv">_</span> <span class="nv">Hs0</span>).</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>message</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>X</var><span class="hyp-type"><b>: </b><span>VLSM message</span></span></span><br><span><var>TypeX</var><span><span class="hyp-body"><b>:= </b><span>type X</span></span><span class="hyp-type"><b>: </b><span>VLSMType message</span></span></span></span><br><span><var>MachineX</var><span><span class="hyp-body"><b>:= </b><span>machine X</span></span><span class="hyp-type"><b>: </b><span>VLSMMachine (vtype X)</span></span></span></span><br><span><var>s'</var><span class="hyp-type"><b>: </b><span>state</span></span></span><br><span><var>om'</var><span class="hyp-type"><b>: </b><span>option message</span></span></span><br><span><var>Hs</var><span class="hyp-type"><b>: </b><span>valid_state_message_prop s&#39; om&#39;</span></span></span><br><span><var>Hs0</var><span class="hyp-type"><b>: </b><span>initial_state_prop s&#39;</span></span></span><br><span><var>Hom</var><span class="hyp-type"><b>: </b><span>option_initial_message_prop om&#39;</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">s&#39; = `(s&#39; ‚Üæ Hs0)</div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="bp">reflexivity</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">        </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="VLSM-v-chkf5" style="display: none" type="checkbox"><label class="alectryon-input" for="VLSM-v-chkf5">*</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>message</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>X</var><span class="hyp-type"><b>: </b><span>VLSM message</span></span></span><br><span><var>TypeX</var><span><span class="hyp-body"><b>:= </b><span>type X</span></span><span class="hyp-type"><b>: </b><span>VLSMType message</span></span></span></span><br><span><var>MachineX</var><span><span class="hyp-body"><b>:= </b><span>machine X</span></span><span class="hyp-type"><b>: </b><span>VLSMMachine (vtype X)</span></span></span></span><br><span><var>s'</var><span class="hyp-type"><b>: </b><span>state</span></span></span><br><span><var>om'</var><span class="hyp-type"><b>: </b><span>option message</span></span></span><br><span><var>Hs</var><span class="hyp-type"><b>: </b><span>valid_state_message_prop s&#39; om&#39;</span></span></span><br><span><var>s</var><span class="hyp-type"><b>: </b><span>state</span></span></span><br><span><var>_om</var><span class="hyp-type"><b>: </b><span>option message</span></span></span><br><span><var>_s</var><span class="hyp-type"><b>: </b><span>state</span></span></span><br><span><var>om</var><span class="hyp-type"><b>: </b><span>option message</span></span></span><br><span><var>l0</var><span class="hyp-type"><b>: </b><span>label</span></span></span><br><span><var>Hps</var><span class="hyp-type"><b>: </b><span>valid_state_message_prop s _om</span></span></span><br><span><var>Hpm</var><span class="hyp-type"><b>: </b><span>valid_state_message_prop _s om</span></span></span><br><span><var>Hv</var><span class="hyp-type"><b>: </b><span>valid l0 (s, om)</span></span></span><br><span><var>Ht</var><span class="hyp-type"><b>: </b><span>transition l0 (s, om) = (s&#39;, om&#39;)</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">(<span class="kr">‚àÉ</span> <span class="nv">is</span> : initial_state, s&#39; = `<span class="kr">is</span>)
‚à® (<span class="kr">‚àÉ</span> (<span class="nv">l</span> : label) (<span class="nv">som</span> : state * option message) (<span class="nv">om&#39;</span> : 
                                                 option
                                                 message),
     input_valid_transition l som (s&#39;, om&#39;))</div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="VLSM-v-chkf6" style="display: none" type="checkbox"><label class="alectryon-input" for="VLSM-v-chkf6"><span class="nb">right</span>.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>message</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>X</var><span class="hyp-type"><b>: </b><span>VLSM message</span></span></span><br><span><var>TypeX</var><span><span class="hyp-body"><b>:= </b><span>type X</span></span><span class="hyp-type"><b>: </b><span>VLSMType message</span></span></span></span><br><span><var>MachineX</var><span><span class="hyp-body"><b>:= </b><span>machine X</span></span><span class="hyp-type"><b>: </b><span>VLSMMachine (vtype X)</span></span></span></span><br><span><var>s'</var><span class="hyp-type"><b>: </b><span>state</span></span></span><br><span><var>om'</var><span class="hyp-type"><b>: </b><span>option message</span></span></span><br><span><var>Hs</var><span class="hyp-type"><b>: </b><span>valid_state_message_prop s&#39; om&#39;</span></span></span><br><span><var>s</var><span class="hyp-type"><b>: </b><span>state</span></span></span><br><span><var>_om</var><span class="hyp-type"><b>: </b><span>option message</span></span></span><br><span><var>_s</var><span class="hyp-type"><b>: </b><span>state</span></span></span><br><span><var>om</var><span class="hyp-type"><b>: </b><span>option message</span></span></span><br><span><var>l0</var><span class="hyp-type"><b>: </b><span>label</span></span></span><br><span><var>Hps</var><span class="hyp-type"><b>: </b><span>valid_state_message_prop s _om</span></span></span><br><span><var>Hpm</var><span class="hyp-type"><b>: </b><span>valid_state_message_prop _s om</span></span></span><br><span><var>Hv</var><span class="hyp-type"><b>: </b><span>valid l0 (s, om)</span></span></span><br><span><var>Ht</var><span class="hyp-type"><b>: </b><span>transition l0 (s, om) = (s&#39;, om&#39;)</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="kr">‚àÉ</span> (<span class="nv">l</span> : label) (<span class="nv">som</span> : state * option message) (<span class="nv">om&#39;</span> : 
                                              option
                                                message),
  input_valid_transition l som (s&#39;, om&#39;)</div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="VLSM-v-chkf7" style="display: none" type="checkbox"><label class="alectryon-input" for="VLSM-v-chkf7"><span class="kr">exists</span> <span class="nv">l0</span>.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>message</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>X</var><span class="hyp-type"><b>: </b><span>VLSM message</span></span></span><br><span><var>TypeX</var><span><span class="hyp-body"><b>:= </b><span>type X</span></span><span class="hyp-type"><b>: </b><span>VLSMType message</span></span></span></span><br><span><var>MachineX</var><span><span class="hyp-body"><b>:= </b><span>machine X</span></span><span class="hyp-type"><b>: </b><span>VLSMMachine (vtype X)</span></span></span></span><br><span><var>s'</var><span class="hyp-type"><b>: </b><span>state</span></span></span><br><span><var>om'</var><span class="hyp-type"><b>: </b><span>option message</span></span></span><br><span><var>Hs</var><span class="hyp-type"><b>: </b><span>valid_state_message_prop s&#39; om&#39;</span></span></span><br><span><var>s</var><span class="hyp-type"><b>: </b><span>state</span></span></span><br><span><var>_om</var><span class="hyp-type"><b>: </b><span>option message</span></span></span><br><span><var>_s</var><span class="hyp-type"><b>: </b><span>state</span></span></span><br><span><var>om</var><span class="hyp-type"><b>: </b><span>option message</span></span></span><br><span><var>l0</var><span class="hyp-type"><b>: </b><span>label</span></span></span><br><span><var>Hps</var><span class="hyp-type"><b>: </b><span>valid_state_message_prop s _om</span></span></span><br><span><var>Hpm</var><span class="hyp-type"><b>: </b><span>valid_state_message_prop _s om</span></span></span><br><span><var>Hv</var><span class="hyp-type"><b>: </b><span>valid l0 (s, om)</span></span></span><br><span><var>Ht</var><span class="hyp-type"><b>: </b><span>transition l0 (s, om) = (s&#39;, om&#39;)</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="kr">‚àÉ</span> (<span class="nv">som</span> : state * option message) (<span class="nv">om&#39;</span> : option message),
  input_valid_transition l0 som (s&#39;, om&#39;)</div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="VLSM-v-chkf8" style="display: none" type="checkbox"><label class="alectryon-input" for="VLSM-v-chkf8"><span class="kr">exists</span> (<span class="nv">s</span>, om).</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>message</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>X</var><span class="hyp-type"><b>: </b><span>VLSM message</span></span></span><br><span><var>TypeX</var><span><span class="hyp-body"><b>:= </b><span>type X</span></span><span class="hyp-type"><b>: </b><span>VLSMType message</span></span></span></span><br><span><var>MachineX</var><span><span class="hyp-body"><b>:= </b><span>machine X</span></span><span class="hyp-type"><b>: </b><span>VLSMMachine (vtype X)</span></span></span></span><br><span><var>s'</var><span class="hyp-type"><b>: </b><span>state</span></span></span><br><span><var>om'</var><span class="hyp-type"><b>: </b><span>option message</span></span></span><br><span><var>Hs</var><span class="hyp-type"><b>: </b><span>valid_state_message_prop s&#39; om&#39;</span></span></span><br><span><var>s</var><span class="hyp-type"><b>: </b><span>state</span></span></span><br><span><var>_om</var><span class="hyp-type"><b>: </b><span>option message</span></span></span><br><span><var>_s</var><span class="hyp-type"><b>: </b><span>state</span></span></span><br><span><var>om</var><span class="hyp-type"><b>: </b><span>option message</span></span></span><br><span><var>l0</var><span class="hyp-type"><b>: </b><span>label</span></span></span><br><span><var>Hps</var><span class="hyp-type"><b>: </b><span>valid_state_message_prop s _om</span></span></span><br><span><var>Hpm</var><span class="hyp-type"><b>: </b><span>valid_state_message_prop _s om</span></span></span><br><span><var>Hv</var><span class="hyp-type"><b>: </b><span>valid l0 (s, om)</span></span></span><br><span><var>Ht</var><span class="hyp-type"><b>: </b><span>transition l0 (s, om) = (s&#39;, om&#39;)</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="kr">‚àÉ</span> <span class="nv">om&#39;</span> : option message,
  input_valid_transition l0 (s, om) (s&#39;, om&#39;)</div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="VLSM-v-chkf9" style="display: none" type="checkbox"><label class="alectryon-input" for="VLSM-v-chkf9"><span class="kr">exists</span> <span class="nv">om&#39;</span>.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>message</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>X</var><span class="hyp-type"><b>: </b><span>VLSM message</span></span></span><br><span><var>TypeX</var><span><span class="hyp-body"><b>:= </b><span>type X</span></span><span class="hyp-type"><b>: </b><span>VLSMType message</span></span></span></span><br><span><var>MachineX</var><span><span class="hyp-body"><b>:= </b><span>machine X</span></span><span class="hyp-type"><b>: </b><span>VLSMMachine (vtype X)</span></span></span></span><br><span><var>s'</var><span class="hyp-type"><b>: </b><span>state</span></span></span><br><span><var>om'</var><span class="hyp-type"><b>: </b><span>option message</span></span></span><br><span><var>Hs</var><span class="hyp-type"><b>: </b><span>valid_state_message_prop s&#39; om&#39;</span></span></span><br><span><var>s</var><span class="hyp-type"><b>: </b><span>state</span></span></span><br><span><var>_om</var><span class="hyp-type"><b>: </b><span>option message</span></span></span><br><span><var>_s</var><span class="hyp-type"><b>: </b><span>state</span></span></span><br><span><var>om</var><span class="hyp-type"><b>: </b><span>option message</span></span></span><br><span><var>l0</var><span class="hyp-type"><b>: </b><span>label</span></span></span><br><span><var>Hps</var><span class="hyp-type"><b>: </b><span>valid_state_message_prop s _om</span></span></span><br><span><var>Hpm</var><span class="hyp-type"><b>: </b><span>valid_state_message_prop _s om</span></span></span><br><span><var>Hv</var><span class="hyp-type"><b>: </b><span>valid l0 (s, om)</span></span></span><br><span><var>Ht</var><span class="hyp-type"><b>: </b><span>transition l0 (s, om) = (s&#39;, om&#39;)</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">input_valid_transition l0 (s, om) (s&#39;, om&#39;)</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">          </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="VLSM-v-chkfa" style="display: none" type="checkbox"><label class="alectryon-input" for="VLSM-v-chkfa"><span class="kp">repeat</span> <span class="nb">split</span>; <span class="kp">try</span> <span class="bp">assumption</span>.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>message</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>X</var><span class="hyp-type"><b>: </b><span>VLSM message</span></span></span><br><span><var>TypeX</var><span><span class="hyp-body"><b>:= </b><span>type X</span></span><span class="hyp-type"><b>: </b><span>VLSMType message</span></span></span></span><br><span><var>MachineX</var><span><span class="hyp-body"><b>:= </b><span>machine X</span></span><span class="hyp-type"><b>: </b><span>VLSMMachine (vtype X)</span></span></span></span><br><span><var>s'</var><span class="hyp-type"><b>: </b><span>state</span></span></span><br><span><var>om'</var><span class="hyp-type"><b>: </b><span>option message</span></span></span><br><span><var>Hs</var><span class="hyp-type"><b>: </b><span>valid_state_message_prop s&#39; om&#39;</span></span></span><br><span><var>s</var><span class="hyp-type"><b>: </b><span>state</span></span></span><br><span><var>_om</var><span class="hyp-type"><b>: </b><span>option message</span></span></span><br><span><var>_s</var><span class="hyp-type"><b>: </b><span>state</span></span></span><br><span><var>om</var><span class="hyp-type"><b>: </b><span>option message</span></span></span><br><span><var>l0</var><span class="hyp-type"><b>: </b><span>label</span></span></span><br><span><var>Hps</var><span class="hyp-type"><b>: </b><span>valid_state_message_prop s _om</span></span></span><br><span><var>Hpm</var><span class="hyp-type"><b>: </b><span>valid_state_message_prop _s om</span></span></span><br><span><var>Hv</var><span class="hyp-type"><b>: </b><span>valid l0 (s, om)</span></span></span><br><span><var>Ht</var><span class="hyp-type"><b>: </b><span>transition l0 (s, om) = (s&#39;, om&#39;)</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">valid_state_prop s</div></blockquote><div class="alectryon-extra-goals"><input class="alectryon-extra-goal-toggle" id="VLSM-v-chkfb" style="display: none" type="checkbox"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>message</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>X</var><span class="hyp-type"><b>: </b><span>VLSM message</span></span></span><br><span><var>TypeX</var><span><span class="hyp-body"><b>:= </b><span>type X</span></span><span class="hyp-type"><b>: </b><span>VLSMType message</span></span></span></span><br><span><var>MachineX</var><span><span class="hyp-body"><b>:= </b><span>machine X</span></span><span class="hyp-type"><b>: </b><span>VLSMMachine (vtype X)</span></span></span></span><br><span><var>s'</var><span class="hyp-type"><b>: </b><span>state</span></span></span><br><span><var>om'</var><span class="hyp-type"><b>: </b><span>option message</span></span></span><br><span><var>Hs</var><span class="hyp-type"><b>: </b><span>valid_state_message_prop s&#39; om&#39;</span></span></span><br><span><var>s</var><span class="hyp-type"><b>: </b><span>state</span></span></span><br><span><var>_om</var><span class="hyp-type"><b>: </b><span>option message</span></span></span><br><span><var>_s</var><span class="hyp-type"><b>: </b><span>state</span></span></span><br><span><var>om</var><span class="hyp-type"><b>: </b><span>option message</span></span></span><br><span><var>l0</var><span class="hyp-type"><b>: </b><span>label</span></span></span><br><span><var>Hps</var><span class="hyp-type"><b>: </b><span>valid_state_message_prop s _om</span></span></span><br><span><var>Hpm</var><span class="hyp-type"><b>: </b><span>valid_state_message_prop _s om</span></span></span><br><span><var>Hv</var><span class="hyp-type"><b>: </b><span>valid l0 (s, om)</span></span></span><br><span><var>Ht</var><span class="hyp-type"><b>: </b><span>transition l0 (s, om) = (s&#39;, om&#39;)</span></span></span><br></div><label class="goal-separator" for="VLSM-v-chkfb"><hr></label><div class="goal-conclusion">option_valid_message_prop om</div></blockquote></div></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">          </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="VLSM-v-chkfc" style="display: none" type="checkbox"><label class="alectryon-input" for="VLSM-v-chkfc">+</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>message</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>X</var><span class="hyp-type"><b>: </b><span>VLSM message</span></span></span><br><span><var>TypeX</var><span><span class="hyp-body"><b>:= </b><span>type X</span></span><span class="hyp-type"><b>: </b><span>VLSMType message</span></span></span></span><br><span><var>MachineX</var><span><span class="hyp-body"><b>:= </b><span>machine X</span></span><span class="hyp-type"><b>: </b><span>VLSMMachine (vtype X)</span></span></span></span><br><span><var>s'</var><span class="hyp-type"><b>: </b><span>state</span></span></span><br><span><var>om'</var><span class="hyp-type"><b>: </b><span>option message</span></span></span><br><span><var>Hs</var><span class="hyp-type"><b>: </b><span>valid_state_message_prop s&#39; om&#39;</span></span></span><br><span><var>s</var><span class="hyp-type"><b>: </b><span>state</span></span></span><br><span><var>_om</var><span class="hyp-type"><b>: </b><span>option message</span></span></span><br><span><var>_s</var><span class="hyp-type"><b>: </b><span>state</span></span></span><br><span><var>om</var><span class="hyp-type"><b>: </b><span>option message</span></span></span><br><span><var>l0</var><span class="hyp-type"><b>: </b><span>label</span></span></span><br><span><var>Hps</var><span class="hyp-type"><b>: </b><span>valid_state_message_prop s _om</span></span></span><br><span><var>Hpm</var><span class="hyp-type"><b>: </b><span>valid_state_message_prop _s om</span></span></span><br><span><var>Hv</var><span class="hyp-type"><b>: </b><span>valid l0 (s, om)</span></span></span><br><span><var>Ht</var><span class="hyp-type"><b>: </b><span>transition l0 (s, om) = (s&#39;, om&#39;)</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">valid_state_prop s</div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="VLSM-v-chkfd" style="display: none" type="checkbox"><label class="alectryon-input" for="VLSM-v-chkfd"><span class="kr">exists</span> <span class="nv">_om</span>.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>message</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>X</var><span class="hyp-type"><b>: </b><span>VLSM message</span></span></span><br><span><var>TypeX</var><span><span class="hyp-body"><b>:= </b><span>type X</span></span><span class="hyp-type"><b>: </b><span>VLSMType message</span></span></span></span><br><span><var>MachineX</var><span><span class="hyp-body"><b>:= </b><span>machine X</span></span><span class="hyp-type"><b>: </b><span>VLSMMachine (vtype X)</span></span></span></span><br><span><var>s'</var><span class="hyp-type"><b>: </b><span>state</span></span></span><br><span><var>om'</var><span class="hyp-type"><b>: </b><span>option message</span></span></span><br><span><var>Hs</var><span class="hyp-type"><b>: </b><span>valid_state_message_prop s&#39; om&#39;</span></span></span><br><span><var>s</var><span class="hyp-type"><b>: </b><span>state</span></span></span><br><span><var>_om</var><span class="hyp-type"><b>: </b><span>option message</span></span></span><br><span><var>_s</var><span class="hyp-type"><b>: </b><span>state</span></span></span><br><span><var>om</var><span class="hyp-type"><b>: </b><span>option message</span></span></span><br><span><var>l0</var><span class="hyp-type"><b>: </b><span>label</span></span></span><br><span><var>Hps</var><span class="hyp-type"><b>: </b><span>valid_state_message_prop s _om</span></span></span><br><span><var>Hpm</var><span class="hyp-type"><b>: </b><span>valid_state_message_prop _s om</span></span></span><br><span><var>Hv</var><span class="hyp-type"><b>: </b><span>valid l0 (s, om)</span></span></span><br><span><var>Ht</var><span class="hyp-type"><b>: </b><span>transition l0 (s, om) = (s&#39;, om&#39;)</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">valid_state_message_prop s _om</div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="bp">assumption</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">          </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="VLSM-v-chkfe" style="display: none" type="checkbox"><label class="alectryon-input" for="VLSM-v-chkfe">+</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>message</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>X</var><span class="hyp-type"><b>: </b><span>VLSM message</span></span></span><br><span><var>TypeX</var><span><span class="hyp-body"><b>:= </b><span>type X</span></span><span class="hyp-type"><b>: </b><span>VLSMType message</span></span></span></span><br><span><var>MachineX</var><span><span class="hyp-body"><b>:= </b><span>machine X</span></span><span class="hyp-type"><b>: </b><span>VLSMMachine (vtype X)</span></span></span></span><br><span><var>s'</var><span class="hyp-type"><b>: </b><span>state</span></span></span><br><span><var>om'</var><span class="hyp-type"><b>: </b><span>option message</span></span></span><br><span><var>Hs</var><span class="hyp-type"><b>: </b><span>valid_state_message_prop s&#39; om&#39;</span></span></span><br><span><var>s</var><span class="hyp-type"><b>: </b><span>state</span></span></span><br><span><var>_om</var><span class="hyp-type"><b>: </b><span>option message</span></span></span><br><span><var>_s</var><span class="hyp-type"><b>: </b><span>state</span></span></span><br><span><var>om</var><span class="hyp-type"><b>: </b><span>option message</span></span></span><br><span><var>l0</var><span class="hyp-type"><b>: </b><span>label</span></span></span><br><span><var>Hps</var><span class="hyp-type"><b>: </b><span>valid_state_message_prop s _om</span></span></span><br><span><var>Hpm</var><span class="hyp-type"><b>: </b><span>valid_state_message_prop _s om</span></span></span><br><span><var>Hv</var><span class="hyp-type"><b>: </b><span>valid l0 (s, om)</span></span></span><br><span><var>Ht</var><span class="hyp-type"><b>: </b><span>transition l0 (s, om) = (s&#39;, om&#39;)</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">option_valid_message_prop om</div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="VLSM-v-chkff" style="display: none" type="checkbox"><label class="alectryon-input" for="VLSM-v-chkff"><span class="kr">exists</span> <span class="nv">_s</span>.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>message</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>X</var><span class="hyp-type"><b>: </b><span>VLSM message</span></span></span><br><span><var>TypeX</var><span><span class="hyp-body"><b>:= </b><span>type X</span></span><span class="hyp-type"><b>: </b><span>VLSMType message</span></span></span></span><br><span><var>MachineX</var><span><span class="hyp-body"><b>:= </b><span>machine X</span></span><span class="hyp-type"><b>: </b><span>VLSMMachine (vtype X)</span></span></span></span><br><span><var>s'</var><span class="hyp-type"><b>: </b><span>state</span></span></span><br><span><var>om'</var><span class="hyp-type"><b>: </b><span>option message</span></span></span><br><span><var>Hs</var><span class="hyp-type"><b>: </b><span>valid_state_message_prop s&#39; om&#39;</span></span></span><br><span><var>s</var><span class="hyp-type"><b>: </b><span>state</span></span></span><br><span><var>_om</var><span class="hyp-type"><b>: </b><span>option message</span></span></span><br><span><var>_s</var><span class="hyp-type"><b>: </b><span>state</span></span></span><br><span><var>om</var><span class="hyp-type"><b>: </b><span>option message</span></span></span><br><span><var>l0</var><span class="hyp-type"><b>: </b><span>label</span></span></span><br><span><var>Hps</var><span class="hyp-type"><b>: </b><span>valid_state_message_prop s _om</span></span></span><br><span><var>Hpm</var><span class="hyp-type"><b>: </b><span>valid_state_message_prop _s om</span></span></span><br><span><var>Hv</var><span class="hyp-type"><b>: </b><span>valid l0 (s, om)</span></span></span><br><span><var>Ht</var><span class="hyp-type"><b>: </b><span>transition l0 (s, om) = (s&#39;, om&#39;)</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">valid_state_message_prop _s om</div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="bp">assumption</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">      </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="VLSM-v-chk100" style="display: none" type="checkbox"><label class="alectryon-input" for="VLSM-v-chk100">-</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>message</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>X</var><span class="hyp-type"><b>: </b><span>VLSM message</span></span></span><br><span><var>TypeX</var><span><span class="hyp-body"><b>:= </b><span>type X</span></span><span class="hyp-type"><b>: </b><span>VLSMType message</span></span></span></span><br><span><var>MachineX</var><span><span class="hyp-body"><b>:= </b><span>machine X</span></span><span class="hyp-type"><b>: </b><span>VLSMMachine (vtype X)</span></span></span></span><br><span><var>s'</var><span class="hyp-type"><b>: </b><span>state</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">(<span class="kr">‚àÉ</span> <span class="nv">is</span> : initial_state, s&#39; = `<span class="kr">is</span>)
‚à® (<span class="kr">‚àÉ</span> (<span class="nv">l</span> : label) (<span class="nv">som</span> : state * option message) (<span class="nv">om&#39;</span> : 
                                                 option
                                                 message),
     input_valid_transition l som (s&#39;, om&#39;))
‚Üí valid_state_prop s&#39;</div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="VLSM-v-chk101" style="display: none" type="checkbox"><label class="alectryon-input" for="VLSM-v-chk101"><span class="nb">intros</span> [[[s His] Heq] | [l [[s om] [om&#39; [[[_om Hps] [[_s Hpm] Hv]] Ht]]]]]; <span class="nb">subst</span>.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>message</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>X</var><span class="hyp-type"><b>: </b><span>VLSM message</span></span></span><br><span><var>TypeX</var><span><span class="hyp-body"><b>:= </b><span>type X</span></span><span class="hyp-type"><b>: </b><span>VLSMType message</span></span></span></span><br><span><var>MachineX</var><span><span class="hyp-body"><b>:= </b><span>machine X</span></span><span class="hyp-type"><b>: </b><span>VLSMMachine (vtype X)</span></span></span></span><br><span><var>s</var><span class="hyp-type"><b>: </b><span>state</span></span></span><br><span><var>His</var><span class="hyp-type"><b>: </b><span>initial_state_prop s</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">valid_state_prop (`(s ‚Üæ His))</div></blockquote><div class="alectryon-extra-goals"><input class="alectryon-extra-goal-toggle" id="VLSM-v-chk102" style="display: none" type="checkbox"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>message</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>X</var><span class="hyp-type"><b>: </b><span>VLSM message</span></span></span><br><span><var>TypeX</var><span><span class="hyp-body"><b>:= </b><span>type X</span></span><span class="hyp-type"><b>: </b><span>VLSMType message</span></span></span></span><br><span><var>MachineX</var><span><span class="hyp-body"><b>:= </b><span>machine X</span></span><span class="hyp-type"><b>: </b><span>VLSMMachine (vtype X)</span></span></span></span><br><span><var>s'</var><span class="hyp-type"><b>: </b><span>state</span></span></span><br><span><var>l</var><span class="hyp-type"><b>: </b><span>label</span></span></span><br><span><var>s</var><span class="hyp-type"><b>: </b><span>state</span></span></span><br><span><var>om, om', _om</var><span class="hyp-type"><b>: </b><span>option message</span></span></span><br><span><var>Hps</var><span class="hyp-type"><b>: </b><span>valid_state_message_prop s _om</span></span></span><br><span><var>_s</var><span class="hyp-type"><b>: </b><span>state</span></span></span><br><span><var>Hpm</var><span class="hyp-type"><b>: </b><span>valid_state_message_prop _s om</span></span></span><br><span><var>Hv</var><span class="hyp-type"><b>: </b><span>valid l (s, om)</span></span></span><br><span><var>Ht</var><span class="hyp-type"><b>: </b><span>transition l (s, om) = (s&#39;, om&#39;)</span></span></span><br></div><label class="goal-separator" for="VLSM-v-chk102"><hr></label><div class="goal-conclusion">valid_state_prop s&#39;</div></blockquote></div></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">        </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="VLSM-v-chk103" style="display: none" type="checkbox"><label class="alectryon-input" for="VLSM-v-chk103">+</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>message</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>X</var><span class="hyp-type"><b>: </b><span>VLSM message</span></span></span><br><span><var>TypeX</var><span><span class="hyp-body"><b>:= </b><span>type X</span></span><span class="hyp-type"><b>: </b><span>VLSMType message</span></span></span></span><br><span><var>MachineX</var><span><span class="hyp-body"><b>:= </b><span>machine X</span></span><span class="hyp-type"><b>: </b><span>VLSMMachine (vtype X)</span></span></span></span><br><span><var>s</var><span class="hyp-type"><b>: </b><span>state</span></span></span><br><span><var>His</var><span class="hyp-type"><b>: </b><span>initial_state_prop s</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">valid_state_prop (`(s ‚Üæ His))</div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="VLSM-v-chk104" style="display: none" type="checkbox"><label class="alectryon-input" for="VLSM-v-chk104"><span class="kr">exists</span> <span class="nv">None</span>.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>message</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>X</var><span class="hyp-type"><b>: </b><span>VLSM message</span></span></span><br><span><var>TypeX</var><span><span class="hyp-body"><b>:= </b><span>type X</span></span><span class="hyp-type"><b>: </b><span>VLSMType message</span></span></span></span><br><span><var>MachineX</var><span><span class="hyp-body"><b>:= </b><span>machine X</span></span><span class="hyp-type"><b>: </b><span>VLSMMachine (vtype X)</span></span></span></span><br><span><var>s</var><span class="hyp-type"><b>: </b><span>state</span></span></span><br><span><var>His</var><span class="hyp-type"><b>: </b><span>initial_state_prop s</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">valid_state_message_prop (`(s ‚Üæ His)) None</div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="nb">apply</span> valid_initial_state_message; [<span class="bp">assumption</span> | <span class="bp">exact</span> I].</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">        </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="VLSM-v-chk105" style="display: none" type="checkbox"><label class="alectryon-input" for="VLSM-v-chk105">+</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>message</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>X</var><span class="hyp-type"><b>: </b><span>VLSM message</span></span></span><br><span><var>TypeX</var><span><span class="hyp-body"><b>:= </b><span>type X</span></span><span class="hyp-type"><b>: </b><span>VLSMType message</span></span></span></span><br><span><var>MachineX</var><span><span class="hyp-body"><b>:= </b><span>machine X</span></span><span class="hyp-type"><b>: </b><span>VLSMMachine (vtype X)</span></span></span></span><br><span><var>s'</var><span class="hyp-type"><b>: </b><span>state</span></span></span><br><span><var>l</var><span class="hyp-type"><b>: </b><span>label</span></span></span><br><span><var>s</var><span class="hyp-type"><b>: </b><span>state</span></span></span><br><span><var>om, om', _om</var><span class="hyp-type"><b>: </b><span>option message</span></span></span><br><span><var>Hps</var><span class="hyp-type"><b>: </b><span>valid_state_message_prop s _om</span></span></span><br><span><var>_s</var><span class="hyp-type"><b>: </b><span>state</span></span></span><br><span><var>Hpm</var><span class="hyp-type"><b>: </b><span>valid_state_message_prop _s om</span></span></span><br><span><var>Hv</var><span class="hyp-type"><b>: </b><span>valid l (s, om)</span></span></span><br><span><var>Ht</var><span class="hyp-type"><b>: </b><span>transition l (s, om) = (s&#39;, om&#39;)</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">valid_state_prop s&#39;</div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="VLSM-v-chk106" style="display: none" type="checkbox"><label class="alectryon-input" for="VLSM-v-chk106"><span class="kr">exists</span> <span class="nv">om&#39;</span>.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>message</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>X</var><span class="hyp-type"><b>: </b><span>VLSM message</span></span></span><br><span><var>TypeX</var><span><span class="hyp-body"><b>:= </b><span>type X</span></span><span class="hyp-type"><b>: </b><span>VLSMType message</span></span></span></span><br><span><var>MachineX</var><span><span class="hyp-body"><b>:= </b><span>machine X</span></span><span class="hyp-type"><b>: </b><span>VLSMMachine (vtype X)</span></span></span></span><br><span><var>s'</var><span class="hyp-type"><b>: </b><span>state</span></span></span><br><span><var>l</var><span class="hyp-type"><b>: </b><span>label</span></span></span><br><span><var>s</var><span class="hyp-type"><b>: </b><span>state</span></span></span><br><span><var>om, om', _om</var><span class="hyp-type"><b>: </b><span>option message</span></span></span><br><span><var>Hps</var><span class="hyp-type"><b>: </b><span>valid_state_message_prop s _om</span></span></span><br><span><var>_s</var><span class="hyp-type"><b>: </b><span>state</span></span></span><br><span><var>Hpm</var><span class="hyp-type"><b>: </b><span>valid_state_message_prop _s om</span></span></span><br><span><var>Hv</var><span class="hyp-type"><b>: </b><span>valid l (s, om)</span></span></span><br><span><var>Ht</var><span class="hyp-type"><b>: </b><span>transition l (s, om) = (s&#39;, om&#39;)</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">valid_state_message_prop s&#39; om&#39;</div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="nb">apply</span> valid_generated_state_message <span class="kr">with</span> s _om _s om l; <span class="bp">assumption</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Qed</span>.</span></span></pre><div class="doc">
A specialized induction principle for <span class="inlinecode"><span class="id" title="var">valid_state_prop</span></span>.

<div class="paragraph"> </div>

        Compared to opening the existential and using <span class="inlinecode"><span class="id" title="var">valid_state_message_prop_ind</span></span>,
        this expresses the inductive assumptions simply in terms of
        <span class="inlinecode"><span class="id" title="var">input_valid_transition</span></span>, rather than than having everything exploded
        as <span class="inlinecode"><span class="id" title="var">valid_state_message_prop</span></span> assumptions over witnesses <code>_s</code>
        and <code>_om</code>, and a spurious inductive assumption <code>P _s</code>.
     
</div><pre class="alectryon-io highlight"><!-- Generator: Alectryon --><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="VLSM-v-chk107" style="display: none" type="checkbox"><label class="alectryon-input" for="VLSM-v-chk107"><span class="kn">Lemma</span> <span class="nf">valid_state_prop_ind</span>
      (<span class="nv">P</span> : state -&gt; <span class="kt">Prop</span>)
      (<span class="nv">IHinit</span> : <span class="kr">forall</span> (<span class="nv">s</span> : state) (<span class="nv">Hs</span> : initial_state_prop s), P s)
      (<span class="nv">IHgen</span> :
        <span class="kr">forall</span> (<span class="nv">s&#39;</span> : state) (<span class="nv">l</span>: label) (<span class="nv">om</span> <span class="nv">om&#39;</span> : option message) (<span class="nv">s</span> : state)
          (<span class="nv">Ht</span> : input_valid_transition l (s, om) (s&#39;, om&#39;)) (<span class="nv">Hs</span> : P s),
          P s&#39;
      )
      : <span class="kr">forall</span> (<span class="nv">s</span> : state) (<span class="nv">Hs</span> : valid_state_prop s), P s.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>message</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>X</var><span class="hyp-type"><b>: </b><span>VLSM message</span></span></span><br><span><var>TypeX</var><span><span class="hyp-body"><b>:= </b><span>type X</span></span><span class="hyp-type"><b>: </b><span>VLSMType message</span></span></span></span><br><span><var>MachineX</var><span><span class="hyp-body"><b>:= </b><span>machine X</span></span><span class="hyp-type"><b>: </b><span>VLSMMachine (vtype X)</span></span></span></span><br><span><var>P</var><span class="hyp-type"><b>: </b><span>state ‚Üí <span class="kt">Prop</span></span></span></span><br><span><var>IHinit</var><span class="hyp-type"><b>: </b><span><span class="kr">‚àÄ</span> <span class="nv">s</span> : state, initial_state_prop s ‚Üí P s</span></span></span><br><span><var>IHgen</var><span class="hyp-type"><b>: </b><span><span class="kr">‚àÄ</span> (<span class="nv">s&#39;</span> : state) (<span class="nv">l</span> : label) 
  (<span class="nv">om</span> <span class="nv">om&#39;</span> : option message) 
  (<span class="nv">s</span> : state),
  input_valid_transition l (s, om) (s&#39;, om&#39;)
  ‚Üí P s ‚Üí P s&#39;</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="kr">‚àÄ</span> <span class="nv">s</span> : state, valid_state_prop s ‚Üí P s</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="VLSM-v-chk108" style="display: none" type="checkbox"><label class="alectryon-input" for="VLSM-v-chk108"><span class="kn">Proof</span>.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>message</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>X</var><span class="hyp-type"><b>: </b><span>VLSM message</span></span></span><br><span><var>TypeX</var><span><span class="hyp-body"><b>:= </b><span>type X</span></span><span class="hyp-type"><b>: </b><span>VLSMType message</span></span></span></span><br><span><var>MachineX</var><span><span class="hyp-body"><b>:= </b><span>machine X</span></span><span class="hyp-type"><b>: </b><span>VLSMMachine (vtype X)</span></span></span></span><br><span><var>P</var><span class="hyp-type"><b>: </b><span>state ‚Üí <span class="kt">Prop</span></span></span></span><br><span><var>IHinit</var><span class="hyp-type"><b>: </b><span><span class="kr">‚àÄ</span> <span class="nv">s</span> : state, initial_state_prop s ‚Üí P s</span></span></span><br><span><var>IHgen</var><span class="hyp-type"><b>: </b><span><span class="kr">‚àÄ</span> (<span class="nv">s&#39;</span> : state) (<span class="nv">l</span> : label) 
  (<span class="nv">om</span> <span class="nv">om&#39;</span> : option message) 
  (<span class="nv">s</span> : state),
  input_valid_transition l (s, om) (s&#39;, om&#39;)
  ‚Üí P s ‚Üí P s&#39;</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="kr">‚àÄ</span> <span class="nv">s</span> : state, valid_state_prop s ‚Üí P s</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">      </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="VLSM-v-chk109" style="display: none" type="checkbox"><label class="alectryon-input" for="VLSM-v-chk109"><span class="nb">intros</span>.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>message</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>X</var><span class="hyp-type"><b>: </b><span>VLSM message</span></span></span><br><span><var>TypeX</var><span><span class="hyp-body"><b>:= </b><span>type X</span></span><span class="hyp-type"><b>: </b><span>VLSMType message</span></span></span></span><br><span><var>MachineX</var><span><span class="hyp-body"><b>:= </b><span>machine X</span></span><span class="hyp-type"><b>: </b><span>VLSMMachine (vtype X)</span></span></span></span><br><span><var>P</var><span class="hyp-type"><b>: </b><span>state ‚Üí <span class="kt">Prop</span></span></span></span><br><span><var>IHinit</var><span class="hyp-type"><b>: </b><span><span class="kr">‚àÄ</span> <span class="nv">s</span> : state, initial_state_prop s ‚Üí P s</span></span></span><br><span><var>IHgen</var><span class="hyp-type"><b>: </b><span><span class="kr">‚àÄ</span> (<span class="nv">s&#39;</span> : state) (<span class="nv">l</span> : label) 
  (<span class="nv">om</span> <span class="nv">om&#39;</span> : option message) 
  (<span class="nv">s</span> : state),
  input_valid_transition l (s, om) (s&#39;, om&#39;)
  ‚Üí P s ‚Üí P s&#39;</span></span></span><br><span><var>s</var><span class="hyp-type"><b>: </b><span>state</span></span></span><br><span><var>Hs</var><span class="hyp-type"><b>: </b><span>valid_state_prop s</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">P s</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">      </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="VLSM-v-chk10a" style="display: none" type="checkbox"><label class="alectryon-input" for="VLSM-v-chk10a"><span class="nb">destruct</span> Hs <span class="kr">as</span> [om Hs].</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>message</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>X</var><span class="hyp-type"><b>: </b><span>VLSM message</span></span></span><br><span><var>TypeX</var><span><span class="hyp-body"><b>:= </b><span>type X</span></span><span class="hyp-type"><b>: </b><span>VLSMType message</span></span></span></span><br><span><var>MachineX</var><span><span class="hyp-body"><b>:= </b><span>machine X</span></span><span class="hyp-type"><b>: </b><span>VLSMMachine (vtype X)</span></span></span></span><br><span><var>P</var><span class="hyp-type"><b>: </b><span>state ‚Üí <span class="kt">Prop</span></span></span></span><br><span><var>IHinit</var><span class="hyp-type"><b>: </b><span><span class="kr">‚àÄ</span> <span class="nv">s</span> : state, initial_state_prop s ‚Üí P s</span></span></span><br><span><var>IHgen</var><span class="hyp-type"><b>: </b><span><span class="kr">‚àÄ</span> (<span class="nv">s&#39;</span> : state) (<span class="nv">l</span> : label) 
  (<span class="nv">om</span> <span class="nv">om&#39;</span> : option message) 
  (<span class="nv">s</span> : state),
  input_valid_transition l (s, om) (s&#39;, om&#39;)
  ‚Üí P s ‚Üí P s&#39;</span></span></span><br><span><var>s</var><span class="hyp-type"><b>: </b><span>state</span></span></span><br><span><var>om</var><span class="hyp-type"><b>: </b><span>option message</span></span></span><br><span><var>Hs</var><span class="hyp-type"><b>: </b><span>valid_state_message_prop s om</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">P s</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">      </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="VLSM-v-chk10b" style="display: none" type="checkbox"><label class="alectryon-input" for="VLSM-v-chk10b"><span class="nb">induction</span> Hs.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>message</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>X</var><span class="hyp-type"><b>: </b><span>VLSM message</span></span></span><br><span><var>TypeX</var><span><span class="hyp-body"><b>:= </b><span>type X</span></span><span class="hyp-type"><b>: </b><span>VLSMType message</span></span></span></span><br><span><var>MachineX</var><span><span class="hyp-body"><b>:= </b><span>machine X</span></span><span class="hyp-type"><b>: </b><span>VLSMMachine (vtype X)</span></span></span></span><br><span><var>P</var><span class="hyp-type"><b>: </b><span>state ‚Üí <span class="kt">Prop</span></span></span></span><br><span><var>IHinit</var><span class="hyp-type"><b>: </b><span><span class="kr">‚àÄ</span> <span class="nv">s</span> : state, initial_state_prop s ‚Üí P s</span></span></span><br><span><var>IHgen</var><span class="hyp-type"><b>: </b><span><span class="kr">‚àÄ</span> (<span class="nv">s&#39;</span> : state) (<span class="nv">l</span> : label) 
  (<span class="nv">om</span> <span class="nv">om&#39;</span> : option message) 
  (<span class="nv">s</span> : state),
  input_valid_transition l (s, om) (s&#39;, om&#39;)
  ‚Üí P s ‚Üí P s&#39;</span></span></span><br><span><var>s</var><span class="hyp-type"><b>: </b><span>state</span></span></span><br><span><var>Hs</var><span class="hyp-type"><b>: </b><span>initial_state_prop s</span></span></span><br><span><var>om</var><span class="hyp-type"><b>: </b><span>option message</span></span></span><br><span><var>Hom</var><span class="hyp-type"><b>: </b><span>option_initial_message_prop om</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">P s</div></blockquote><div class="alectryon-extra-goals"><input class="alectryon-extra-goal-toggle" id="VLSM-v-chk10c" style="display: none" type="checkbox"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>message</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>X</var><span class="hyp-type"><b>: </b><span>VLSM message</span></span></span><br><span><var>TypeX</var><span><span class="hyp-body"><b>:= </b><span>type X</span></span><span class="hyp-type"><b>: </b><span>VLSMType message</span></span></span></span><br><span><var>MachineX</var><span><span class="hyp-body"><b>:= </b><span>machine X</span></span><span class="hyp-type"><b>: </b><span>VLSMMachine (vtype X)</span></span></span></span><br><span><var>P</var><span class="hyp-type"><b>: </b><span>state ‚Üí <span class="kt">Prop</span></span></span></span><br><span><var>IHinit</var><span class="hyp-type"><b>: </b><span><span class="kr">‚àÄ</span> <span class="nv">s</span> : state, initial_state_prop s ‚Üí P s</span></span></span><br><span><var>IHgen</var><span class="hyp-type"><b>: </b><span><span class="kr">‚àÄ</span> (<span class="nv">s&#39;</span> : state) (<span class="nv">l</span> : label) 
  (<span class="nv">om</span> <span class="nv">om&#39;</span> : option message) 
  (<span class="nv">s</span> : state),
  input_valid_transition l (s, om) (s&#39;, om&#39;)
  ‚Üí P s ‚Üí P s&#39;</span></span></span><br><span><var>s</var><span class="hyp-type"><b>: </b><span>state</span></span></span><br><span><var>_om</var><span class="hyp-type"><b>: </b><span>option message</span></span></span><br><span><var>Hs1</var><span class="hyp-type"><b>: </b><span>valid_state_message_prop s _om</span></span></span><br><span><var>_s</var><span class="hyp-type"><b>: </b><span>state</span></span></span><br><span><var>om</var><span class="hyp-type"><b>: </b><span>option message</span></span></span><br><span><var>Hs2</var><span class="hyp-type"><b>: </b><span>valid_state_message_prop _s om</span></span></span><br><span><var>l0</var><span class="hyp-type"><b>: </b><span>label</span></span></span><br><span><var>Hv</var><span class="hyp-type"><b>: </b><span>valid l0 (s, om)</span></span></span><br><span><var>s'</var><span class="hyp-type"><b>: </b><span>state</span></span></span><br><span><var>om'</var><span class="hyp-type"><b>: </b><span>option message</span></span></span><br><span><var>Ht</var><span class="hyp-type"><b>: </b><span>transition l0 (s, om) = (s&#39;, om&#39;)</span></span></span><br><span><var>IHHs1</var><span class="hyp-type"><b>: </b><span>P s</span></span></span><br><span><var>IHHs2</var><span class="hyp-type"><b>: </b><span>P _s</span></span></span><br></div><label class="goal-separator" for="VLSM-v-chk10c"><hr></label><div class="goal-conclusion">P s&#39;</div></blockquote></div></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">      </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="VLSM-v-chk10d" style="display: none" type="checkbox"><label class="alectryon-input" for="VLSM-v-chk10d">-</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>message</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>X</var><span class="hyp-type"><b>: </b><span>VLSM message</span></span></span><br><span><var>TypeX</var><span><span class="hyp-body"><b>:= </b><span>type X</span></span><span class="hyp-type"><b>: </b><span>VLSMType message</span></span></span></span><br><span><var>MachineX</var><span><span class="hyp-body"><b>:= </b><span>machine X</span></span><span class="hyp-type"><b>: </b><span>VLSMMachine (vtype X)</span></span></span></span><br><span><var>P</var><span class="hyp-type"><b>: </b><span>state ‚Üí <span class="kt">Prop</span></span></span></span><br><span><var>IHinit</var><span class="hyp-type"><b>: </b><span><span class="kr">‚àÄ</span> <span class="nv">s</span> : state, initial_state_prop s ‚Üí P s</span></span></span><br><span><var>IHgen</var><span class="hyp-type"><b>: </b><span><span class="kr">‚àÄ</span> (<span class="nv">s&#39;</span> : state) (<span class="nv">l</span> : label) 
  (<span class="nv">om</span> <span class="nv">om&#39;</span> : option message) 
  (<span class="nv">s</span> : state),
  input_valid_transition l (s, om) (s&#39;, om&#39;)
  ‚Üí P s ‚Üí P s&#39;</span></span></span><br><span><var>s</var><span class="hyp-type"><b>: </b><span>state</span></span></span><br><span><var>Hs</var><span class="hyp-type"><b>: </b><span>initial_state_prop s</span></span></span><br><span><var>om</var><span class="hyp-type"><b>: </b><span>option message</span></span></span><br><span><var>Hom</var><span class="hyp-type"><b>: </b><span>option_initial_message_prop om</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">P s</div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="VLSM-v-chk10e" style="display: none" type="checkbox"><label class="alectryon-input" for="VLSM-v-chk10e"><span class="nb">apply</span> IHinit.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>message</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>X</var><span class="hyp-type"><b>: </b><span>VLSM message</span></span></span><br><span><var>TypeX</var><span><span class="hyp-body"><b>:= </b><span>type X</span></span><span class="hyp-type"><b>: </b><span>VLSMType message</span></span></span></span><br><span><var>MachineX</var><span><span class="hyp-body"><b>:= </b><span>machine X</span></span><span class="hyp-type"><b>: </b><span>VLSMMachine (vtype X)</span></span></span></span><br><span><var>P</var><span class="hyp-type"><b>: </b><span>state ‚Üí <span class="kt">Prop</span></span></span></span><br><span><var>IHinit</var><span class="hyp-type"><b>: </b><span><span class="kr">‚àÄ</span> <span class="nv">s</span> : state, initial_state_prop s ‚Üí P s</span></span></span><br><span><var>IHgen</var><span class="hyp-type"><b>: </b><span><span class="kr">‚àÄ</span> (<span class="nv">s&#39;</span> : state) (<span class="nv">l</span> : label) 
  (<span class="nv">om</span> <span class="nv">om&#39;</span> : option message) 
  (<span class="nv">s</span> : state),
  input_valid_transition l (s, om) (s&#39;, om&#39;)
  ‚Üí P s ‚Üí P s&#39;</span></span></span><br><span><var>s</var><span class="hyp-type"><b>: </b><span>state</span></span></span><br><span><var>Hs</var><span class="hyp-type"><b>: </b><span>initial_state_prop s</span></span></span><br><span><var>om</var><span class="hyp-type"><b>: </b><span>option message</span></span></span><br><span><var>Hom</var><span class="hyp-type"><b>: </b><span>option_initial_message_prop om</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">initial_state_prop s</div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="bp">assumption</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">      </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="VLSM-v-chk10f" style="display: none" type="checkbox"><label class="alectryon-input" for="VLSM-v-chk10f">-</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>message</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>X</var><span class="hyp-type"><b>: </b><span>VLSM message</span></span></span><br><span><var>TypeX</var><span><span class="hyp-body"><b>:= </b><span>type X</span></span><span class="hyp-type"><b>: </b><span>VLSMType message</span></span></span></span><br><span><var>MachineX</var><span><span class="hyp-body"><b>:= </b><span>machine X</span></span><span class="hyp-type"><b>: </b><span>VLSMMachine (vtype X)</span></span></span></span><br><span><var>P</var><span class="hyp-type"><b>: </b><span>state ‚Üí <span class="kt">Prop</span></span></span></span><br><span><var>IHinit</var><span class="hyp-type"><b>: </b><span><span class="kr">‚àÄ</span> <span class="nv">s</span> : state, initial_state_prop s ‚Üí P s</span></span></span><br><span><var>IHgen</var><span class="hyp-type"><b>: </b><span><span class="kr">‚àÄ</span> (<span class="nv">s&#39;</span> : state) (<span class="nv">l</span> : label) 
  (<span class="nv">om</span> <span class="nv">om&#39;</span> : option message) 
  (<span class="nv">s</span> : state),
  input_valid_transition l (s, om) (s&#39;, om&#39;)
  ‚Üí P s ‚Üí P s&#39;</span></span></span><br><span><var>s</var><span class="hyp-type"><b>: </b><span>state</span></span></span><br><span><var>_om</var><span class="hyp-type"><b>: </b><span>option message</span></span></span><br><span><var>Hs1</var><span class="hyp-type"><b>: </b><span>valid_state_message_prop s _om</span></span></span><br><span><var>_s</var><span class="hyp-type"><b>: </b><span>state</span></span></span><br><span><var>om</var><span class="hyp-type"><b>: </b><span>option message</span></span></span><br><span><var>Hs2</var><span class="hyp-type"><b>: </b><span>valid_state_message_prop _s om</span></span></span><br><span><var>l0</var><span class="hyp-type"><b>: </b><span>label</span></span></span><br><span><var>Hv</var><span class="hyp-type"><b>: </b><span>valid l0 (s, om)</span></span></span><br><span><var>s'</var><span class="hyp-type"><b>: </b><span>state</span></span></span><br><span><var>om'</var><span class="hyp-type"><b>: </b><span>option message</span></span></span><br><span><var>Ht</var><span class="hyp-type"><b>: </b><span>transition l0 (s, om) = (s&#39;, om&#39;)</span></span></span><br><span><var>IHHs1</var><span class="hyp-type"><b>: </b><span>P s</span></span></span><br><span><var>IHHs2</var><span class="hyp-type"><b>: </b><span>P _s</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">P s&#39;</div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="nb">apply</span> (IHgen s&#39; l0 om om&#39; s);<span class="nb">firstorder</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Qed</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
    <span class="c">(* valid message characterization - similar to the definition in the report. *)</span>

</span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="VLSM-v-chk110" style="display: none" type="checkbox"><label class="alectryon-input" for="VLSM-v-chk110"><span class="kn">Lemma</span> <span class="nf">valid_message_prop_iff</span> :
      <span class="kr">forall</span> <span class="nv">m&#39;</span> : message,
        valid_message_prop m&#39;
        &lt;-&gt; (<span class="kr">exists</span> <span class="nv">im</span> : initial_message, m&#39; = proj1_sig im)
          \/ <span class="kr">exists</span> (<span class="nv">l</span> : label) (<span class="nv">som</span> : state * option message) (<span class="nv">s&#39;</span> : state),
            input_valid_transition l som (s&#39;, Some m&#39;).</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>message</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>X</var><span class="hyp-type"><b>: </b><span>VLSM message</span></span></span><br><span><var>TypeX</var><span><span class="hyp-body"><b>:= </b><span>type X</span></span><span class="hyp-type"><b>: </b><span>VLSMType message</span></span></span></span><br><span><var>MachineX</var><span><span class="hyp-body"><b>:= </b><span>machine X</span></span><span class="hyp-type"><b>: </b><span>VLSMMachine (vtype X)</span></span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="kr">‚àÄ</span> <span class="nv">m&#39;</span> : message,
  valid_message_prop m&#39;
  ‚Üî (<span class="kr">‚àÉ</span> <span class="nv">im</span> : initial_message, m&#39; = `im)
    ‚à® (<span class="kr">‚àÉ</span> (<span class="nv">l</span> : label) (<span class="nv">som</span> : state * option message) 
         (<span class="nv">s&#39;</span> : state),
         input_valid_transition l som (s&#39;, Some m&#39;))</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="VLSM-v-chk111" style="display: none" type="checkbox"><label class="alectryon-input" for="VLSM-v-chk111"><span class="kn">Proof</span>.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>message</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>X</var><span class="hyp-type"><b>: </b><span>VLSM message</span></span></span><br><span><var>TypeX</var><span><span class="hyp-body"><b>:= </b><span>type X</span></span><span class="hyp-type"><b>: </b><span>VLSMType message</span></span></span></span><br><span><var>MachineX</var><span><span class="hyp-body"><b>:= </b><span>machine X</span></span><span class="hyp-type"><b>: </b><span>VLSMMachine (vtype X)</span></span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="kr">‚àÄ</span> <span class="nv">m&#39;</span> : message,
  valid_message_prop m&#39;
  ‚Üî (<span class="kr">‚àÉ</span> <span class="nv">im</span> : initial_message, m&#39; = `im)
    ‚à® (<span class="kr">‚àÉ</span> (<span class="nv">l</span> : label) (<span class="nv">som</span> : state * option message) 
         (<span class="nv">s&#39;</span> : state),
         input_valid_transition l som (s&#39;, Some m&#39;))</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">      </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="VLSM-v-chk112" style="display: none" type="checkbox"><label class="alectryon-input" for="VLSM-v-chk112"><span class="nb">intros</span>; <span class="nb">split</span>.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>message</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>X</var><span class="hyp-type"><b>: </b><span>VLSM message</span></span></span><br><span><var>TypeX</var><span><span class="hyp-body"><b>:= </b><span>type X</span></span><span class="hyp-type"><b>: </b><span>VLSMType message</span></span></span></span><br><span><var>MachineX</var><span><span class="hyp-body"><b>:= </b><span>machine X</span></span><span class="hyp-type"><b>: </b><span>VLSMMachine (vtype X)</span></span></span></span><br><span><var>m'</var><span class="hyp-type"><b>: </b><span>message</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">valid_message_prop m&#39;
‚Üí (<span class="kr">‚àÉ</span> <span class="nv">im</span> : initial_message, m&#39; = `im)
  ‚à® (<span class="kr">‚àÉ</span> (<span class="nv">l</span> : label) (<span class="nv">som</span> : state * option message) 
       (<span class="nv">s&#39;</span> : state),
       input_valid_transition l som (s&#39;, Some m&#39;))</div></blockquote><div class="alectryon-extra-goals"><input class="alectryon-extra-goal-toggle" id="VLSM-v-chk113" style="display: none" type="checkbox"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>message</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>X</var><span class="hyp-type"><b>: </b><span>VLSM message</span></span></span><br><span><var>TypeX</var><span><span class="hyp-body"><b>:= </b><span>type X</span></span><span class="hyp-type"><b>: </b><span>VLSMType message</span></span></span></span><br><span><var>MachineX</var><span><span class="hyp-body"><b>:= </b><span>machine X</span></span><span class="hyp-type"><b>: </b><span>VLSMMachine (vtype X)</span></span></span></span><br><span><var>m'</var><span class="hyp-type"><b>: </b><span>message</span></span></span><br></div><label class="goal-separator" for="VLSM-v-chk113"><hr></label><div class="goal-conclusion">(<span class="kr">‚àÉ</span> <span class="nv">im</span> : initial_message, m&#39; = `im)
‚à® (<span class="kr">‚àÉ</span> (<span class="nv">l</span> : label) (<span class="nv">som</span> : state * option message) 
     (<span class="nv">s&#39;</span> : state),
     input_valid_transition l som (s&#39;, Some m&#39;))
‚Üí valid_message_prop m&#39;</div></blockquote></div></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">      </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="VLSM-v-chk114" style="display: none" type="checkbox"><label class="alectryon-input" for="VLSM-v-chk114">-</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>message</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>X</var><span class="hyp-type"><b>: </b><span>VLSM message</span></span></span><br><span><var>TypeX</var><span><span class="hyp-body"><b>:= </b><span>type X</span></span><span class="hyp-type"><b>: </b><span>VLSMType message</span></span></span></span><br><span><var>MachineX</var><span><span class="hyp-body"><b>:= </b><span>machine X</span></span><span class="hyp-type"><b>: </b><span>VLSMMachine (vtype X)</span></span></span></span><br><span><var>m'</var><span class="hyp-type"><b>: </b><span>message</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">valid_message_prop m&#39;
‚Üí (<span class="kr">‚àÉ</span> <span class="nv">im</span> : initial_message, m&#39; = `im)
  ‚à® (<span class="kr">‚àÉ</span> (<span class="nv">l</span> : label) (<span class="nv">som</span> : state * option message) 
       (<span class="nv">s&#39;</span> : state),
       input_valid_transition l som (s&#39;, Some m&#39;))</div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="VLSM-v-chk115" style="display: none" type="checkbox"><label class="alectryon-input" for="VLSM-v-chk115"><span class="nb">intros</span> [s&#39; Hpm&#39;].</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>message</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>X</var><span class="hyp-type"><b>: </b><span>VLSM message</span></span></span><br><span><var>TypeX</var><span><span class="hyp-body"><b>:= </b><span>type X</span></span><span class="hyp-type"><b>: </b><span>VLSMType message</span></span></span></span><br><span><var>MachineX</var><span><span class="hyp-body"><b>:= </b><span>machine X</span></span><span class="hyp-type"><b>: </b><span>VLSMMachine (vtype X)</span></span></span></span><br><span><var>m'</var><span class="hyp-type"><b>: </b><span>message</span></span></span><br><span><var>s'</var><span class="hyp-type"><b>: </b><span>state</span></span></span><br><span><var>Hpm'</var><span class="hyp-type"><b>: </b><span>valid_state_message_prop s&#39; (Some m&#39;)</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">(<span class="kr">‚àÉ</span> <span class="nv">im</span> : initial_message, m&#39; = `im)
‚à® (<span class="kr">‚àÉ</span> (<span class="nv">l</span> : label) (<span class="nv">som</span> : state * option message) (<span class="nv">s&#39;</span> : state),
     input_valid_transition l som (s&#39;, Some m&#39;))</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">        </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="VLSM-v-chk116" style="display: none" type="checkbox"><label class="alectryon-input" for="VLSM-v-chk116"><span class="nb">inversion</span> Hpm&#39;; <span class="nb">subst</span>.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>message</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>X</var><span class="hyp-type"><b>: </b><span>VLSM message</span></span></span><br><span><var>TypeX</var><span><span class="hyp-body"><b>:= </b><span>type X</span></span><span class="hyp-type"><b>: </b><span>VLSMType message</span></span></span></span><br><span><var>MachineX</var><span><span class="hyp-body"><b>:= </b><span>machine X</span></span><span class="hyp-type"><b>: </b><span>VLSMMachine (vtype X)</span></span></span></span><br><span><var>m'</var><span class="hyp-type"><b>: </b><span>message</span></span></span><br><span><var>s'</var><span class="hyp-type"><b>: </b><span>state</span></span></span><br><span><var>Hpm'</var><span class="hyp-type"><b>: </b><span>valid_state_message_prop s&#39; (Some m&#39;)</span></span></span><br><span><var>Hs</var><span class="hyp-type"><b>: </b><span>initial_state_prop s&#39;</span></span></span><br><span><var>Hom</var><span class="hyp-type"><b>: </b><span>option_initial_message_prop (Some m&#39;)</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">(<span class="kr">‚àÉ</span> <span class="nv">im</span> : initial_message, m&#39; = `im)
‚à® (<span class="kr">‚àÉ</span> (<span class="nv">l</span> : label) (<span class="nv">som</span> : state * option message) (<span class="nv">s&#39;</span> : state),
     input_valid_transition l som (s&#39;, Some m&#39;))</div></blockquote><div class="alectryon-extra-goals"><input class="alectryon-extra-goal-toggle" id="VLSM-v-chk117" style="display: none" type="checkbox"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>message</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>X</var><span class="hyp-type"><b>: </b><span>VLSM message</span></span></span><br><span><var>TypeX</var><span><span class="hyp-body"><b>:= </b><span>type X</span></span><span class="hyp-type"><b>: </b><span>VLSMType message</span></span></span></span><br><span><var>MachineX</var><span><span class="hyp-body"><b>:= </b><span>machine X</span></span><span class="hyp-type"><b>: </b><span>VLSMMachine (vtype X)</span></span></span></span><br><span><var>m'</var><span class="hyp-type"><b>: </b><span>message</span></span></span><br><span><var>s'</var><span class="hyp-type"><b>: </b><span>state</span></span></span><br><span><var>Hpm'</var><span class="hyp-type"><b>: </b><span>valid_state_message_prop s&#39; (Some m&#39;)</span></span></span><br><span><var>s</var><span class="hyp-type"><b>: </b><span>state</span></span></span><br><span><var>_om</var><span class="hyp-type"><b>: </b><span>option message</span></span></span><br><span><var>_s</var><span class="hyp-type"><b>: </b><span>state</span></span></span><br><span><var>om</var><span class="hyp-type"><b>: </b><span>option message</span></span></span><br><span><var>l0</var><span class="hyp-type"><b>: </b><span>label</span></span></span><br><span><var>Hps</var><span class="hyp-type"><b>: </b><span>valid_state_message_prop s _om</span></span></span><br><span><var>Hpm</var><span class="hyp-type"><b>: </b><span>valid_state_message_prop _s om</span></span></span><br><span><var>Hv</var><span class="hyp-type"><b>: </b><span>valid l0 (s, om)</span></span></span><br><span><var>Ht</var><span class="hyp-type"><b>: </b><span>transition l0 (s, om) = (s&#39;, Some m&#39;)</span></span></span><br></div><label class="goal-separator" for="VLSM-v-chk117"><hr></label><div class="goal-conclusion">(<span class="kr">‚àÉ</span> <span class="nv">im</span> : initial_message, m&#39; = `im)
‚à® (<span class="kr">‚àÉ</span> (<span class="nv">l</span> : label) (<span class="nv">som</span> : state * option message) 
     (<span class="nv">s&#39;</span> : state),
     input_valid_transition l som (s&#39;, Some m&#39;))</div></blockquote></div></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">        </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="VLSM-v-chk118" style="display: none" type="checkbox"><label class="alectryon-input" for="VLSM-v-chk118">+</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>message</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>X</var><span class="hyp-type"><b>: </b><span>VLSM message</span></span></span><br><span><var>TypeX</var><span><span class="hyp-body"><b>:= </b><span>type X</span></span><span class="hyp-type"><b>: </b><span>VLSMType message</span></span></span></span><br><span><var>MachineX</var><span><span class="hyp-body"><b>:= </b><span>machine X</span></span><span class="hyp-type"><b>: </b><span>VLSMMachine (vtype X)</span></span></span></span><br><span><var>m'</var><span class="hyp-type"><b>: </b><span>message</span></span></span><br><span><var>s'</var><span class="hyp-type"><b>: </b><span>state</span></span></span><br><span><var>Hpm'</var><span class="hyp-type"><b>: </b><span>valid_state_message_prop s&#39; (Some m&#39;)</span></span></span><br><span><var>Hs</var><span class="hyp-type"><b>: </b><span>initial_state_prop s&#39;</span></span></span><br><span><var>Hom</var><span class="hyp-type"><b>: </b><span>option_initial_message_prop (Some m&#39;)</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">(<span class="kr">‚àÉ</span> <span class="nv">im</span> : initial_message, m&#39; = `im)
‚à® (<span class="kr">‚àÉ</span> (<span class="nv">l</span> : label) (<span class="nv">som</span> : state * option message) (<span class="nv">s&#39;</span> : state),
     input_valid_transition l som (s&#39;, Some m&#39;))</div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="VLSM-v-chk119" style="display: none" type="checkbox"><label class="alectryon-input" for="VLSM-v-chk119"><span class="nb">left</span>.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>message</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>X</var><span class="hyp-type"><b>: </b><span>VLSM message</span></span></span><br><span><var>TypeX</var><span><span class="hyp-body"><b>:= </b><span>type X</span></span><span class="hyp-type"><b>: </b><span>VLSMType message</span></span></span></span><br><span><var>MachineX</var><span><span class="hyp-body"><b>:= </b><span>machine X</span></span><span class="hyp-type"><b>: </b><span>VLSMMachine (vtype X)</span></span></span></span><br><span><var>m'</var><span class="hyp-type"><b>: </b><span>message</span></span></span><br><span><var>s'</var><span class="hyp-type"><b>: </b><span>state</span></span></span><br><span><var>Hpm'</var><span class="hyp-type"><b>: </b><span>valid_state_message_prop s&#39; (Some m&#39;)</span></span></span><br><span><var>Hs</var><span class="hyp-type"><b>: </b><span>initial_state_prop s&#39;</span></span></span><br><span><var>Hom</var><span class="hyp-type"><b>: </b><span>option_initial_message_prop (Some m&#39;)</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="kr">‚àÉ</span> <span class="nv">im</span> : initial_message, m&#39; = `im</div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="VLSM-v-chk11a" style="display: none" type="checkbox"><label class="alectryon-input" for="VLSM-v-chk11a"><span class="kr">exists</span> (<span class="nv">exist</span> <span class="nv">_</span> <span class="nv">m&#39;</span> <span class="nv">Hom</span>).</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>message</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>X</var><span class="hyp-type"><b>: </b><span>VLSM message</span></span></span><br><span><var>TypeX</var><span><span class="hyp-body"><b>:= </b><span>type X</span></span><span class="hyp-type"><b>: </b><span>VLSMType message</span></span></span></span><br><span><var>MachineX</var><span><span class="hyp-body"><b>:= </b><span>machine X</span></span><span class="hyp-type"><b>: </b><span>VLSMMachine (vtype X)</span></span></span></span><br><span><var>m'</var><span class="hyp-type"><b>: </b><span>message</span></span></span><br><span><var>s'</var><span class="hyp-type"><b>: </b><span>state</span></span></span><br><span><var>Hpm'</var><span class="hyp-type"><b>: </b><span>valid_state_message_prop s&#39; (Some m&#39;)</span></span></span><br><span><var>Hs</var><span class="hyp-type"><b>: </b><span>initial_state_prop s&#39;</span></span></span><br><span><var>Hom</var><span class="hyp-type"><b>: </b><span>option_initial_message_prop (Some m&#39;)</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">m&#39; = `(m&#39; ‚Üæ Hom)</div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="bp">reflexivity</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">        </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="VLSM-v-chk11b" style="display: none" type="checkbox"><label class="alectryon-input" for="VLSM-v-chk11b">+</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>message</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>X</var><span class="hyp-type"><b>: </b><span>VLSM message</span></span></span><br><span><var>TypeX</var><span><span class="hyp-body"><b>:= </b><span>type X</span></span><span class="hyp-type"><b>: </b><span>VLSMType message</span></span></span></span><br><span><var>MachineX</var><span><span class="hyp-body"><b>:= </b><span>machine X</span></span><span class="hyp-type"><b>: </b><span>VLSMMachine (vtype X)</span></span></span></span><br><span><var>m'</var><span class="hyp-type"><b>: </b><span>message</span></span></span><br><span><var>s'</var><span class="hyp-type"><b>: </b><span>state</span></span></span><br><span><var>Hpm'</var><span class="hyp-type"><b>: </b><span>valid_state_message_prop s&#39; (Some m&#39;)</span></span></span><br><span><var>s</var><span class="hyp-type"><b>: </b><span>state</span></span></span><br><span><var>_om</var><span class="hyp-type"><b>: </b><span>option message</span></span></span><br><span><var>_s</var><span class="hyp-type"><b>: </b><span>state</span></span></span><br><span><var>om</var><span class="hyp-type"><b>: </b><span>option message</span></span></span><br><span><var>l0</var><span class="hyp-type"><b>: </b><span>label</span></span></span><br><span><var>Hps</var><span class="hyp-type"><b>: </b><span>valid_state_message_prop s _om</span></span></span><br><span><var>Hpm</var><span class="hyp-type"><b>: </b><span>valid_state_message_prop _s om</span></span></span><br><span><var>Hv</var><span class="hyp-type"><b>: </b><span>valid l0 (s, om)</span></span></span><br><span><var>Ht</var><span class="hyp-type"><b>: </b><span>transition l0 (s, om) = (s&#39;, Some m&#39;)</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">(<span class="kr">‚àÉ</span> <span class="nv">im</span> : initial_message, m&#39; = `im)
‚à® (<span class="kr">‚àÉ</span> (<span class="nv">l</span> : label) (<span class="nv">som</span> : state * option message) (<span class="nv">s&#39;</span> : state),
     input_valid_transition l som (s&#39;, Some m&#39;))</div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="VLSM-v-chk11c" style="display: none" type="checkbox"><label class="alectryon-input" for="VLSM-v-chk11c"><span class="nb">right</span>.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>message</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>X</var><span class="hyp-type"><b>: </b><span>VLSM message</span></span></span><br><span><var>TypeX</var><span><span class="hyp-body"><b>:= </b><span>type X</span></span><span class="hyp-type"><b>: </b><span>VLSMType message</span></span></span></span><br><span><var>MachineX</var><span><span class="hyp-body"><b>:= </b><span>machine X</span></span><span class="hyp-type"><b>: </b><span>VLSMMachine (vtype X)</span></span></span></span><br><span><var>m'</var><span class="hyp-type"><b>: </b><span>message</span></span></span><br><span><var>s'</var><span class="hyp-type"><b>: </b><span>state</span></span></span><br><span><var>Hpm'</var><span class="hyp-type"><b>: </b><span>valid_state_message_prop s&#39; (Some m&#39;)</span></span></span><br><span><var>s</var><span class="hyp-type"><b>: </b><span>state</span></span></span><br><span><var>_om</var><span class="hyp-type"><b>: </b><span>option message</span></span></span><br><span><var>_s</var><span class="hyp-type"><b>: </b><span>state</span></span></span><br><span><var>om</var><span class="hyp-type"><b>: </b><span>option message</span></span></span><br><span><var>l0</var><span class="hyp-type"><b>: </b><span>label</span></span></span><br><span><var>Hps</var><span class="hyp-type"><b>: </b><span>valid_state_message_prop s _om</span></span></span><br><span><var>Hpm</var><span class="hyp-type"><b>: </b><span>valid_state_message_prop _s om</span></span></span><br><span><var>Hv</var><span class="hyp-type"><b>: </b><span>valid l0 (s, om)</span></span></span><br><span><var>Ht</var><span class="hyp-type"><b>: </b><span>transition l0 (s, om) = (s&#39;, Some m&#39;)</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="kr">‚àÉ</span> (<span class="nv">l</span> : label) (<span class="nv">som</span> : state * option message) (<span class="nv">s&#39;</span> : state),
  input_valid_transition l som (s&#39;, Some m&#39;)</div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="VLSM-v-chk11d" style="display: none" type="checkbox"><label class="alectryon-input" for="VLSM-v-chk11d"><span class="kr">exists</span> <span class="nv">l0</span>.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>message</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>X</var><span class="hyp-type"><b>: </b><span>VLSM message</span></span></span><br><span><var>TypeX</var><span><span class="hyp-body"><b>:= </b><span>type X</span></span><span class="hyp-type"><b>: </b><span>VLSMType message</span></span></span></span><br><span><var>MachineX</var><span><span class="hyp-body"><b>:= </b><span>machine X</span></span><span class="hyp-type"><b>: </b><span>VLSMMachine (vtype X)</span></span></span></span><br><span><var>m'</var><span class="hyp-type"><b>: </b><span>message</span></span></span><br><span><var>s'</var><span class="hyp-type"><b>: </b><span>state</span></span></span><br><span><var>Hpm'</var><span class="hyp-type"><b>: </b><span>valid_state_message_prop s&#39; (Some m&#39;)</span></span></span><br><span><var>s</var><span class="hyp-type"><b>: </b><span>state</span></span></span><br><span><var>_om</var><span class="hyp-type"><b>: </b><span>option message</span></span></span><br><span><var>_s</var><span class="hyp-type"><b>: </b><span>state</span></span></span><br><span><var>om</var><span class="hyp-type"><b>: </b><span>option message</span></span></span><br><span><var>l0</var><span class="hyp-type"><b>: </b><span>label</span></span></span><br><span><var>Hps</var><span class="hyp-type"><b>: </b><span>valid_state_message_prop s _om</span></span></span><br><span><var>Hpm</var><span class="hyp-type"><b>: </b><span>valid_state_message_prop _s om</span></span></span><br><span><var>Hv</var><span class="hyp-type"><b>: </b><span>valid l0 (s, om)</span></span></span><br><span><var>Ht</var><span class="hyp-type"><b>: </b><span>transition l0 (s, om) = (s&#39;, Some m&#39;)</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="kr">‚àÉ</span> (<span class="nv">som</span> : state * option message) (<span class="nv">s&#39;</span> : state),
  input_valid_transition l0 som (s&#39;, Some m&#39;)</div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="VLSM-v-chk11e" style="display: none" type="checkbox"><label class="alectryon-input" for="VLSM-v-chk11e"><span class="kr">exists</span> (<span class="nv">s</span>, om).</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>message</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>X</var><span class="hyp-type"><b>: </b><span>VLSM message</span></span></span><br><span><var>TypeX</var><span><span class="hyp-body"><b>:= </b><span>type X</span></span><span class="hyp-type"><b>: </b><span>VLSMType message</span></span></span></span><br><span><var>MachineX</var><span><span class="hyp-body"><b>:= </b><span>machine X</span></span><span class="hyp-type"><b>: </b><span>VLSMMachine (vtype X)</span></span></span></span><br><span><var>m'</var><span class="hyp-type"><b>: </b><span>message</span></span></span><br><span><var>s'</var><span class="hyp-type"><b>: </b><span>state</span></span></span><br><span><var>Hpm'</var><span class="hyp-type"><b>: </b><span>valid_state_message_prop s&#39; (Some m&#39;)</span></span></span><br><span><var>s</var><span class="hyp-type"><b>: </b><span>state</span></span></span><br><span><var>_om</var><span class="hyp-type"><b>: </b><span>option message</span></span></span><br><span><var>_s</var><span class="hyp-type"><b>: </b><span>state</span></span></span><br><span><var>om</var><span class="hyp-type"><b>: </b><span>option message</span></span></span><br><span><var>l0</var><span class="hyp-type"><b>: </b><span>label</span></span></span><br><span><var>Hps</var><span class="hyp-type"><b>: </b><span>valid_state_message_prop s _om</span></span></span><br><span><var>Hpm</var><span class="hyp-type"><b>: </b><span>valid_state_message_prop _s om</span></span></span><br><span><var>Hv</var><span class="hyp-type"><b>: </b><span>valid l0 (s, om)</span></span></span><br><span><var>Ht</var><span class="hyp-type"><b>: </b><span>transition l0 (s, om) = (s&#39;, Some m&#39;)</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="kr">‚àÉ</span> <span class="nv">s&#39;</span> : state,
  input_valid_transition l0 (s, om) (s&#39;, Some m&#39;)</div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="VLSM-v-chk11f" style="display: none" type="checkbox"><label class="alectryon-input" for="VLSM-v-chk11f"><span class="kr">exists</span> <span class="nv">s&#39;</span>.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>message</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>X</var><span class="hyp-type"><b>: </b><span>VLSM message</span></span></span><br><span><var>TypeX</var><span><span class="hyp-body"><b>:= </b><span>type X</span></span><span class="hyp-type"><b>: </b><span>VLSMType message</span></span></span></span><br><span><var>MachineX</var><span><span class="hyp-body"><b>:= </b><span>machine X</span></span><span class="hyp-type"><b>: </b><span>VLSMMachine (vtype X)</span></span></span></span><br><span><var>m'</var><span class="hyp-type"><b>: </b><span>message</span></span></span><br><span><var>s'</var><span class="hyp-type"><b>: </b><span>state</span></span></span><br><span><var>Hpm'</var><span class="hyp-type"><b>: </b><span>valid_state_message_prop s&#39; (Some m&#39;)</span></span></span><br><span><var>s</var><span class="hyp-type"><b>: </b><span>state</span></span></span><br><span><var>_om</var><span class="hyp-type"><b>: </b><span>option message</span></span></span><br><span><var>_s</var><span class="hyp-type"><b>: </b><span>state</span></span></span><br><span><var>om</var><span class="hyp-type"><b>: </b><span>option message</span></span></span><br><span><var>l0</var><span class="hyp-type"><b>: </b><span>label</span></span></span><br><span><var>Hps</var><span class="hyp-type"><b>: </b><span>valid_state_message_prop s _om</span></span></span><br><span><var>Hpm</var><span class="hyp-type"><b>: </b><span>valid_state_message_prop _s om</span></span></span><br><span><var>Hv</var><span class="hyp-type"><b>: </b><span>valid l0 (s, om)</span></span></span><br><span><var>Ht</var><span class="hyp-type"><b>: </b><span>transition l0 (s, om) = (s&#39;, Some m&#39;)</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">input_valid_transition l0 (s, om) (s&#39;, Some m&#39;)</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">          </span><span class="alectryon-sentence"><span class="alectryon-input"><span class="nb">firstorder</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">      </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="VLSM-v-chk120" style="display: none" type="checkbox"><label class="alectryon-input" for="VLSM-v-chk120">-</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>message</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>X</var><span class="hyp-type"><b>: </b><span>VLSM message</span></span></span><br><span><var>TypeX</var><span><span class="hyp-body"><b>:= </b><span>type X</span></span><span class="hyp-type"><b>: </b><span>VLSMType message</span></span></span></span><br><span><var>MachineX</var><span><span class="hyp-body"><b>:= </b><span>machine X</span></span><span class="hyp-type"><b>: </b><span>VLSMMachine (vtype X)</span></span></span></span><br><span><var>m'</var><span class="hyp-type"><b>: </b><span>message</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">(<span class="kr">‚àÉ</span> <span class="nv">im</span> : initial_message, m&#39; = `im)
‚à® (<span class="kr">‚àÉ</span> (<span class="nv">l</span> : label) (<span class="nv">som</span> : state * option message) (<span class="nv">s&#39;</span> : state),
     input_valid_transition l som (s&#39;, Some m&#39;))
‚Üí valid_message_prop m&#39;</div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="VLSM-v-chk121" style="display: none" type="checkbox"><label class="alectryon-input" for="VLSM-v-chk121"><span class="nb">intros</span> [[[s His] Heq] | [l [[s om] [s&#39; [[[_om Hps] [[_s Hpm] Hv]] Ht]]]]]; <span class="nb">subst</span>.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>message</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>X</var><span class="hyp-type"><b>: </b><span>VLSM message</span></span></span><br><span><var>TypeX</var><span><span class="hyp-body"><b>:= </b><span>type X</span></span><span class="hyp-type"><b>: </b><span>VLSMType message</span></span></span></span><br><span><var>MachineX</var><span><span class="hyp-body"><b>:= </b><span>machine X</span></span><span class="hyp-type"><b>: </b><span>VLSMMachine (vtype X)</span></span></span></span><br><span><var>s</var><span class="hyp-type"><b>: </b><span>message</span></span></span><br><span><var>His</var><span class="hyp-type"><b>: </b><span>initial_message_prop s</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">valid_message_prop (`(s ‚Üæ His))</div></blockquote><div class="alectryon-extra-goals"><input class="alectryon-extra-goal-toggle" id="VLSM-v-chk122" style="display: none" type="checkbox"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>message</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>X</var><span class="hyp-type"><b>: </b><span>VLSM message</span></span></span><br><span><var>TypeX</var><span><span class="hyp-body"><b>:= </b><span>type X</span></span><span class="hyp-type"><b>: </b><span>VLSMType message</span></span></span></span><br><span><var>MachineX</var><span><span class="hyp-body"><b>:= </b><span>machine X</span></span><span class="hyp-type"><b>: </b><span>VLSMMachine (vtype X)</span></span></span></span><br><span><var>m'</var><span class="hyp-type"><b>: </b><span>message</span></span></span><br><span><var>l</var><span class="hyp-type"><b>: </b><span>label</span></span></span><br><span><var>s</var><span class="hyp-type"><b>: </b><span>state</span></span></span><br><span><var>om</var><span class="hyp-type"><b>: </b><span>option message</span></span></span><br><span><var>s'</var><span class="hyp-type"><b>: </b><span>state</span></span></span><br><span><var>_om</var><span class="hyp-type"><b>: </b><span>option message</span></span></span><br><span><var>Hps</var><span class="hyp-type"><b>: </b><span>valid_state_message_prop s _om</span></span></span><br><span><var>_s</var><span class="hyp-type"><b>: </b><span>state</span></span></span><br><span><var>Hpm</var><span class="hyp-type"><b>: </b><span>valid_state_message_prop _s om</span></span></span><br><span><var>Hv</var><span class="hyp-type"><b>: </b><span>valid l (s, om)</span></span></span><br><span><var>Ht</var><span class="hyp-type"><b>: </b><span>transition l (s, om) = (s&#39;, Some m&#39;)</span></span></span><br></div><label class="goal-separator" for="VLSM-v-chk122"><hr></label><div class="goal-conclusion">valid_message_prop m&#39;</div></blockquote></div></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">        </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="VLSM-v-chk123" style="display: none" type="checkbox"><label class="alectryon-input" for="VLSM-v-chk123">+</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>message</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>X</var><span class="hyp-type"><b>: </b><span>VLSM message</span></span></span><br><span><var>TypeX</var><span><span class="hyp-body"><b>:= </b><span>type X</span></span><span class="hyp-type"><b>: </b><span>VLSMType message</span></span></span></span><br><span><var>MachineX</var><span><span class="hyp-body"><b>:= </b><span>machine X</span></span><span class="hyp-type"><b>: </b><span>VLSMMachine (vtype X)</span></span></span></span><br><span><var>s</var><span class="hyp-type"><b>: </b><span>message</span></span></span><br><span><var>His</var><span class="hyp-type"><b>: </b><span>initial_message_prop s</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">valid_message_prop (`(s ‚Üæ His))</div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="VLSM-v-chk124" style="display: none" type="checkbox"><label class="alectryon-input" for="VLSM-v-chk124"><span class="nb">apply</span> initial_message_is_valid.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>message</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>X</var><span class="hyp-type"><b>: </b><span>VLSM message</span></span></span><br><span><var>TypeX</var><span><span class="hyp-body"><b>:= </b><span>type X</span></span><span class="hyp-type"><b>: </b><span>VLSMType message</span></span></span></span><br><span><var>MachineX</var><span><span class="hyp-body"><b>:= </b><span>machine X</span></span><span class="hyp-type"><b>: </b><span>VLSMMachine (vtype X)</span></span></span></span><br><span><var>s</var><span class="hyp-type"><b>: </b><span>message</span></span></span><br><span><var>His</var><span class="hyp-type"><b>: </b><span>initial_message_prop s</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">initial_message_prop (`(s ‚Üæ His))</div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="bp">assumption</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">        </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="VLSM-v-chk125" style="display: none" type="checkbox"><label class="alectryon-input" for="VLSM-v-chk125">+</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>message</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>X</var><span class="hyp-type"><b>: </b><span>VLSM message</span></span></span><br><span><var>TypeX</var><span><span class="hyp-body"><b>:= </b><span>type X</span></span><span class="hyp-type"><b>: </b><span>VLSMType message</span></span></span></span><br><span><var>MachineX</var><span><span class="hyp-body"><b>:= </b><span>machine X</span></span><span class="hyp-type"><b>: </b><span>VLSMMachine (vtype X)</span></span></span></span><br><span><var>m'</var><span class="hyp-type"><b>: </b><span>message</span></span></span><br><span><var>l</var><span class="hyp-type"><b>: </b><span>label</span></span></span><br><span><var>s</var><span class="hyp-type"><b>: </b><span>state</span></span></span><br><span><var>om</var><span class="hyp-type"><b>: </b><span>option message</span></span></span><br><span><var>s'</var><span class="hyp-type"><b>: </b><span>state</span></span></span><br><span><var>_om</var><span class="hyp-type"><b>: </b><span>option message</span></span></span><br><span><var>Hps</var><span class="hyp-type"><b>: </b><span>valid_state_message_prop s _om</span></span></span><br><span><var>_s</var><span class="hyp-type"><b>: </b><span>state</span></span></span><br><span><var>Hpm</var><span class="hyp-type"><b>: </b><span>valid_state_message_prop _s om</span></span></span><br><span><var>Hv</var><span class="hyp-type"><b>: </b><span>valid l (s, om)</span></span></span><br><span><var>Ht</var><span class="hyp-type"><b>: </b><span>transition l (s, om) = (s&#39;, Some m&#39;)</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">valid_message_prop m&#39;</div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="VLSM-v-chk126" style="display: none" type="checkbox"><label class="alectryon-input" for="VLSM-v-chk126"><span class="kr">exists</span> <span class="nv">s&#39;</span>.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>message</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>X</var><span class="hyp-type"><b>: </b><span>VLSM message</span></span></span><br><span><var>TypeX</var><span><span class="hyp-body"><b>:= </b><span>type X</span></span><span class="hyp-type"><b>: </b><span>VLSMType message</span></span></span></span><br><span><var>MachineX</var><span><span class="hyp-body"><b>:= </b><span>machine X</span></span><span class="hyp-type"><b>: </b><span>VLSMMachine (vtype X)</span></span></span></span><br><span><var>m'</var><span class="hyp-type"><b>: </b><span>message</span></span></span><br><span><var>l</var><span class="hyp-type"><b>: </b><span>label</span></span></span><br><span><var>s</var><span class="hyp-type"><b>: </b><span>state</span></span></span><br><span><var>om</var><span class="hyp-type"><b>: </b><span>option message</span></span></span><br><span><var>s'</var><span class="hyp-type"><b>: </b><span>state</span></span></span><br><span><var>_om</var><span class="hyp-type"><b>: </b><span>option message</span></span></span><br><span><var>Hps</var><span class="hyp-type"><b>: </b><span>valid_state_message_prop s _om</span></span></span><br><span><var>_s</var><span class="hyp-type"><b>: </b><span>state</span></span></span><br><span><var>Hpm</var><span class="hyp-type"><b>: </b><span>valid_state_message_prop _s om</span></span></span><br><span><var>Hv</var><span class="hyp-type"><b>: </b><span>valid l (s, om)</span></span></span><br><span><var>Ht</var><span class="hyp-type"><b>: </b><span>transition l (s, om) = (s&#39;, Some m&#39;)</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">valid_state_message_prop s&#39; (Some m&#39;)</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">          </span><span class="alectryon-sentence"><span class="alectryon-input"><span class="nb">apply</span> valid_generated_state_message <span class="kr">with</span> s _om _s om l; <span class="bp">assumption</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Qed</span>.</span></span></pre><div class="doc">
<a id="lab10"></a><h2 class="section">Trace Properties</h2>
<div class="paragraph"> </div>

Note that it is unnecessary to specify the source state of the transition,
as it is implied by the preceding <span class="inlinecode"><span class="id" title="var">transition_item</span></span> (or by the <code>start</code> state,
if such an item doesn't exist).

</div><pre class="alectryon-io highlight"><!-- Generator: Alectryon --></pre><div class="doc">
We will now split our groundwork for defining traces into the finite case and
the infinite case.

</div><pre class="alectryon-io highlight"><!-- Generator: Alectryon --></pre><div class="doc">
<a id="lab11"></a><h3 class="section">Finite <span class="inlinecode"><span class="id" title="var">valid_trace</span></span>s</h3>
<div class="paragraph"> </div>

A <span class="inlinecode"><span class="id" title="var">finite_valid_trace_from</span></span> a <span class="inlinecode"><span class="id" title="var">state</span></span> <code>start</code> is a pair <code>(start, steps)</code> where <code>steps</code>
is a list of <span class="inlinecode"><span class="id" title="var">transition_item</span></span>s, and is inductively defined by:
<ul class="doclist">
<li> <code>(s, [])</code> is a <span class="inlinecode"><span class="id" title="var">finite_valid_trace_from</span></span> <code>s</code> if <code>s</code> is valid

</li>
<li> if there is an <span class="inlinecode"><span class="id" title="var">input_valid_transition</span></span> <code>l (s', iom) (s, oom)</code>
<div class="paragraph"> </div>

  and if <code>(s,steps)</code> is a <span class="inlinecode"><span class="id" title="var">valid_trace_from</span></span> <code>s</code>
<div class="paragraph"> </div>

  then <code>(s', ({| l := l; input := iom; destination := s; output := oom |} :: steps)</code>
  is a <span class="inlinecode"><span class="id" title="var">finite_valid_trace_from</span></span> <code>s'</code>.

</li>
</ul>
<div class="paragraph"> </div>

Note that the definition is given such that it extends an existing trace by
adding a transition to its front.
The reason for this choice is to have this definition be similar to the one
for infinite traces, which can only be extended at the front.

</div><pre class="alectryon-io highlight"><!-- Generator: Alectryon --><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Inductive</span> <span class="nf">finite_valid_trace_from</span> : state -&gt; list transition_item -&gt; <span class="kt">Prop</span> :=
    | finite_valid_trace_from_empty : <span class="kr">forall</span> (<span class="nv">s</span> : state)
        (<span class="nv">Hs</span> : valid_state_prop s),
        finite_valid_trace_from s []
    | finite_valid_trace_from_extend : <span class="kr">forall</span>  (<span class="nv">s</span> : state) (<span class="nv">tl</span> : list transition_item)
        (<span class="nv">Htl</span> : finite_valid_trace_from s tl)
        (<span class="nv">s&#39;</span> : state) (<span class="nv">iom</span> <span class="nv">oom</span> : option message) (<span class="nv">l</span> : label)
        (<span class="nv">Ht</span> : input_valid_transition l (s&#39;, iom) (s, oom)),
        finite_valid_trace_from  s&#39; ({| l := l; input := iom; destination := s; output := oom |} :: tl).</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
</span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Definition</span> <span class="nf">finite_valid_trace_singleton</span> :
      <span class="kr">forall</span> {<span class="nv">l</span> : label} {<span class="nv">s</span> <span class="nv">s&#39;</span>: state} {<span class="nv">iom</span> <span class="nv">oom</span> : option message},
        input_valid_transition l (s, iom) (s&#39;, oom) -&gt;
        finite_valid_trace_from  s ({| l := l; input := iom; destination := s&#39;; output := oom |} :: [])
      := <span class="kr">fun</span> <span class="nv">l</span> <span class="nv">s</span> <span class="nv">s&#39;</span> <span class="nv">iom</span> <span class="nv">oom</span> <span class="nv">Hptrans</span> =&gt;
           finite_valid_trace_from_extend s&#39; []
               (finite_valid_trace_from_empty s&#39; (input_valid_transition_destination Hptrans))
               _ _ _ _ Hptrans.</span></span></pre><div class="doc">
To complete our definition of a finite valid trace, we must also guarantee that <code>start</code> is an
initial state according to the protocol.

</div><pre class="alectryon-io highlight"><!-- Generator: Alectryon --><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Definition</span> <span class="nf">finite_valid_trace</span> (<span class="nv">s</span> : state) (<span class="nv">ls</span> : list transition_item) : <span class="kt">Prop</span> :=
      finite_valid_trace_from s ls /\ initial_state_prop s.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
</span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Opaque</span> finite_valid_trace.</span></span></pre><div class="doc">
In the remainder of the section we provide various results allowing us to
prove or decompose the above properties in proofs.

</div><pre class="alectryon-io highlight"><!-- Generator: Alectryon --><span class="alectryon-wsp">    </span></pre><div class="doc">
This is a bit more useful than the small proof suggests,
        because applying it always leaves just one subgoal.
        The tactical <code>split;[constructor;apply initial_state_is_valid|];assumption</code>
        only works if the assumption is available, which may require
        an <code>assert</code> and writing out the full VLSM and state expressions
        as part of the proof script.
     
</div><pre class="alectryon-io highlight"><!-- Generator: Alectryon --><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="VLSM-v-chk127" style="display: none" type="checkbox"><label class="alectryon-input" for="VLSM-v-chk127"><span class="kn">Lemma</span> <span class="nf">finite_valid_trace_empty</span> (<span class="nv">s</span> : state):
      vinitial_state_prop X s -&gt;
      finite_valid_trace s [].</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>message</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>X</var><span class="hyp-type"><b>: </b><span>VLSM message</span></span></span><br><span><var>TypeX</var><span><span class="hyp-body"><b>:= </b><span>type X</span></span><span class="hyp-type"><b>: </b><span>VLSMType message</span></span></span></span><br><span><var>MachineX</var><span><span class="hyp-body"><b>:= </b><span>machine X</span></span><span class="hyp-type"><b>: </b><span>VLSMMachine (vtype X)</span></span></span></span><br><span><var>s</var><span class="hyp-type"><b>: </b><span>state</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">vinitial_state_prop X s ‚Üí finite_valid_trace s []</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="VLSM-v-chk128" style="display: none" type="checkbox"><label class="alectryon-input" for="VLSM-v-chk128"><span class="kn">Proof</span>.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>message</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>X</var><span class="hyp-type"><b>: </b><span>VLSM message</span></span></span><br><span><var>TypeX</var><span><span class="hyp-body"><b>:= </b><span>type X</span></span><span class="hyp-type"><b>: </b><span>VLSMType message</span></span></span></span><br><span><var>MachineX</var><span><span class="hyp-body"><b>:= </b><span>machine X</span></span><span class="hyp-type"><b>: </b><span>VLSMMachine (vtype X)</span></span></span></span><br><span><var>s</var><span class="hyp-type"><b>: </b><span>state</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">vinitial_state_prop X s ‚Üí finite_valid_trace s []</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">      </span><span class="alectryon-sentence"><span class="alectryon-input"><span class="nb">split</span>;[<span class="nb">constructor</span>;<span class="nb">apply</span> initial_state_is_valid|];<span class="bp">assumption</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Qed</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
</span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="VLSM-v-chk129" style="display: none" type="checkbox"><label class="alectryon-input" for="VLSM-v-chk129"><span class="kn">Lemma</span> <span class="nf">finite_valid_trace_first_valid_transition</span>
          (<span class="nv">s</span> : state)
          (<span class="nv">tr</span> : list transition_item)
          (<span class="nv">te</span> : transition_item)
          (<span class="nv">Htr</span> : finite_valid_trace_from s (te :: tr))
      : input_valid_transition (l te) (s, input te) (destination te, output te).</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>message</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>X</var><span class="hyp-type"><b>: </b><span>VLSM message</span></span></span><br><span><var>TypeX</var><span><span class="hyp-body"><b>:= </b><span>type X</span></span><span class="hyp-type"><b>: </b><span>VLSMType message</span></span></span></span><br><span><var>MachineX</var><span><span class="hyp-body"><b>:= </b><span>machine X</span></span><span class="hyp-type"><b>: </b><span>VLSMMachine (vtype X)</span></span></span></span><br><span><var>s</var><span class="hyp-type"><b>: </b><span>state</span></span></span><br><span><var>tr</var><span class="hyp-type"><b>: </b><span>list transition_item</span></span></span><br><span><var>te</var><span class="hyp-type"><b>: </b><span>transition_item</span></span></span><br><span><var>Htr</var><span class="hyp-type"><b>: </b><span>finite_valid_trace_from s (te :: tr)</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">input_valid_transition (l te) (s, input te)
  (destination te, output te)</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="VLSM-v-chk12a" style="display: none" type="checkbox"><label class="alectryon-input" for="VLSM-v-chk12a"><span class="kn">Proof</span>.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>message</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>X</var><span class="hyp-type"><b>: </b><span>VLSM message</span></span></span><br><span><var>TypeX</var><span><span class="hyp-body"><b>:= </b><span>type X</span></span><span class="hyp-type"><b>: </b><span>VLSMType message</span></span></span></span><br><span><var>MachineX</var><span><span class="hyp-body"><b>:= </b><span>machine X</span></span><span class="hyp-type"><b>: </b><span>VLSMMachine (vtype X)</span></span></span></span><br><span><var>s</var><span class="hyp-type"><b>: </b><span>state</span></span></span><br><span><var>tr</var><span class="hyp-type"><b>: </b><span>list transition_item</span></span></span><br><span><var>te</var><span class="hyp-type"><b>: </b><span>transition_item</span></span></span><br><span><var>Htr</var><span class="hyp-type"><b>: </b><span>finite_valid_trace_from s (te :: tr)</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">input_valid_transition (l te) (s, input te)
  (destination te, output te)</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">      </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="VLSM-v-chk12b" style="display: none" type="checkbox"><label class="alectryon-input" for="VLSM-v-chk12b"><span class="nb">inversion</span> Htr.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>message</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>X</var><span class="hyp-type"><b>: </b><span>VLSM message</span></span></span><br><span><var>TypeX</var><span><span class="hyp-body"><b>:= </b><span>type X</span></span><span class="hyp-type"><b>: </b><span>VLSMType message</span></span></span></span><br><span><var>MachineX</var><span><span class="hyp-body"><b>:= </b><span>machine X</span></span><span class="hyp-type"><b>: </b><span>VLSMMachine (vtype X)</span></span></span></span><br><span><var>s</var><span class="hyp-type"><b>: </b><span>state</span></span></span><br><span><var>tr</var><span class="hyp-type"><b>: </b><span>list transition_item</span></span></span><br><span><var>te</var><span class="hyp-type"><b>: </b><span>transition_item</span></span></span><br><span><var>Htr</var><span class="hyp-type"><b>: </b><span>finite_valid_trace_from s (te :: tr)</span></span></span><br><span><var>s1</var><span class="hyp-type"><b>: </b><span>state</span></span></span><br><span><var>tl</var><span class="hyp-type"><b>: </b><span>list transition_item</span></span></span><br><span><var>s'</var><span class="hyp-type"><b>: </b><span>state</span></span></span><br><span><var>iom, oom</var><span class="hyp-type"><b>: </b><span>option message</span></span></span><br><span><var>l0</var><span class="hyp-type"><b>: </b><span>label</span></span></span><br><span><var>Htl</var><span class="hyp-type"><b>: </b><span>finite_valid_trace_from s1 tr</span></span></span><br><span><var>Ht</var><span class="hyp-type"><b>: </b><span>input_valid_transition l0 (s, iom) (s1, oom)</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>s&#39; = s</span></span></span><br><span><var>H1</var><span class="hyp-type"><b>: </b><span>{|
  l := l0;
  input := iom;
  destination := s1;
  output := oom
|} = te</span></span></span><br><span><var>H2</var><span class="hyp-type"><b>: </b><span>tl = tr</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">input_valid_transition
  (l
     {|
       l := l0;
       input := iom;
       destination := s1;
       output := oom
     |})
  (s,
  input
    {|
      l := l0;
      input := iom;
      destination := s1;
      output := oom
    |})
  (destination
     {|
       l := l0;
       input := iom;
       destination := s1;
       output := oom
     |},
  output
    {|
      l := l0;
      input := iom;
      destination := s1;
      output := oom
    |})</div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="bp">assumption</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Qed</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
</span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="VLSM-v-chk12c" style="display: none" type="checkbox"><label class="alectryon-input" for="VLSM-v-chk12c"><span class="kn">Lemma</span> <span class="nf">finite_valid_trace_first_pstate</span>
      (<span class="nv">s</span> : state)
      (<span class="nv">tr</span> : list transition_item)
      (<span class="nv">Htr</span> : finite_valid_trace_from s tr)
      : valid_state_prop s.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>message</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>X</var><span class="hyp-type"><b>: </b><span>VLSM message</span></span></span><br><span><var>TypeX</var><span><span class="hyp-body"><b>:= </b><span>type X</span></span><span class="hyp-type"><b>: </b><span>VLSMType message</span></span></span></span><br><span><var>MachineX</var><span><span class="hyp-body"><b>:= </b><span>machine X</span></span><span class="hyp-type"><b>: </b><span>VLSMMachine (vtype X)</span></span></span></span><br><span><var>s</var><span class="hyp-type"><b>: </b><span>state</span></span></span><br><span><var>tr</var><span class="hyp-type"><b>: </b><span>list transition_item</span></span></span><br><span><var>Htr</var><span class="hyp-type"><b>: </b><span>finite_valid_trace_from s tr</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">valid_state_prop s</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="VLSM-v-chk12d" style="display: none" type="checkbox"><label class="alectryon-input" for="VLSM-v-chk12d"><span class="kn">Proof</span>.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>message</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>X</var><span class="hyp-type"><b>: </b><span>VLSM message</span></span></span><br><span><var>TypeX</var><span><span class="hyp-body"><b>:= </b><span>type X</span></span><span class="hyp-type"><b>: </b><span>VLSMType message</span></span></span></span><br><span><var>MachineX</var><span><span class="hyp-body"><b>:= </b><span>machine X</span></span><span class="hyp-type"><b>: </b><span>VLSMMachine (vtype X)</span></span></span></span><br><span><var>s</var><span class="hyp-type"><b>: </b><span>state</span></span></span><br><span><var>tr</var><span class="hyp-type"><b>: </b><span>list transition_item</span></span></span><br><span><var>Htr</var><span class="hyp-type"><b>: </b><span>finite_valid_trace_from s tr</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">valid_state_prop s</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">      </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="VLSM-v-chk12e" style="display: none" type="checkbox"><label class="alectryon-input" for="VLSM-v-chk12e"><span class="nb">inversion</span> Htr; <span class="nb">subst</span>; [<span class="bp">assumption</span>|].</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>message</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>X</var><span class="hyp-type"><b>: </b><span>VLSM message</span></span></span><br><span><var>TypeX</var><span><span class="hyp-body"><b>:= </b><span>type X</span></span><span class="hyp-type"><b>: </b><span>VLSMType message</span></span></span></span><br><span><var>MachineX</var><span><span class="hyp-body"><b>:= </b><span>machine X</span></span><span class="hyp-type"><b>: </b><span>VLSMMachine (vtype X)</span></span></span></span><br><span><var>s, s1</var><span class="hyp-type"><b>: </b><span>state</span></span></span><br><span><var>tl</var><span class="hyp-type"><b>: </b><span>list transition_item</span></span></span><br><span><var>iom, oom</var><span class="hyp-type"><b>: </b><span>option message</span></span></span><br><span><var>l0</var><span class="hyp-type"><b>: </b><span>label</span></span></span><br><span><var>Htr</var><span class="hyp-type"><b>: </b><span>finite_valid_trace_from s
  ({|
     l := l0;
     input := iom;
     destination := s1;
     output := oom
   |} :: tl)</span></span></span><br><span><var>Htl</var><span class="hyp-type"><b>: </b><span>finite_valid_trace_from s1 tl</span></span></span><br><span><var>Ht</var><span class="hyp-type"><b>: </b><span>input_valid_transition l0 (s, iom) (s1, oom)</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">valid_state_prop s</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">      </span><span class="alectryon-sentence"><span class="alectryon-input"><span class="nb">apply</span> Ht.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Qed</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
</span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="VLSM-v-chk12f" style="display: none" type="checkbox"><label class="alectryon-input" for="VLSM-v-chk12f"><span class="kn">Lemma</span> <span class="nf">finite_valid_trace_tail</span>
          (<span class="nv">s</span> : state)
          (<span class="nv">tr</span> : list transition_item)
          (<span class="nv">te</span> : transition_item)
          (<span class="nv">Htr</span> : finite_valid_trace_from s (te :: tr))
      : finite_valid_trace_from (destination te) tr.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>message</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>X</var><span class="hyp-type"><b>: </b><span>VLSM message</span></span></span><br><span><var>TypeX</var><span><span class="hyp-body"><b>:= </b><span>type X</span></span><span class="hyp-type"><b>: </b><span>VLSMType message</span></span></span></span><br><span><var>MachineX</var><span><span class="hyp-body"><b>:= </b><span>machine X</span></span><span class="hyp-type"><b>: </b><span>VLSMMachine (vtype X)</span></span></span></span><br><span><var>s</var><span class="hyp-type"><b>: </b><span>state</span></span></span><br><span><var>tr</var><span class="hyp-type"><b>: </b><span>list transition_item</span></span></span><br><span><var>te</var><span class="hyp-type"><b>: </b><span>transition_item</span></span></span><br><span><var>Htr</var><span class="hyp-type"><b>: </b><span>finite_valid_trace_from s (te :: tr)</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">finite_valid_trace_from (destination te) tr</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="VLSM-v-chk130" style="display: none" type="checkbox"><label class="alectryon-input" for="VLSM-v-chk130"><span class="kn">Proof</span>.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>message</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>X</var><span class="hyp-type"><b>: </b><span>VLSM message</span></span></span><br><span><var>TypeX</var><span><span class="hyp-body"><b>:= </b><span>type X</span></span><span class="hyp-type"><b>: </b><span>VLSMType message</span></span></span></span><br><span><var>MachineX</var><span><span class="hyp-body"><b>:= </b><span>machine X</span></span><span class="hyp-type"><b>: </b><span>VLSMMachine (vtype X)</span></span></span></span><br><span><var>s</var><span class="hyp-type"><b>: </b><span>state</span></span></span><br><span><var>tr</var><span class="hyp-type"><b>: </b><span>list transition_item</span></span></span><br><span><var>te</var><span class="hyp-type"><b>: </b><span>transition_item</span></span></span><br><span><var>Htr</var><span class="hyp-type"><b>: </b><span>finite_valid_trace_from s (te :: tr)</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">finite_valid_trace_from (destination te) tr</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">      </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="VLSM-v-chk131" style="display: none" type="checkbox"><label class="alectryon-input" for="VLSM-v-chk131"><span class="nb">inversion</span> Htr.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>message</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>X</var><span class="hyp-type"><b>: </b><span>VLSM message</span></span></span><br><span><var>TypeX</var><span><span class="hyp-body"><b>:= </b><span>type X</span></span><span class="hyp-type"><b>: </b><span>VLSMType message</span></span></span></span><br><span><var>MachineX</var><span><span class="hyp-body"><b>:= </b><span>machine X</span></span><span class="hyp-type"><b>: </b><span>VLSMMachine (vtype X)</span></span></span></span><br><span><var>s</var><span class="hyp-type"><b>: </b><span>state</span></span></span><br><span><var>tr</var><span class="hyp-type"><b>: </b><span>list transition_item</span></span></span><br><span><var>te</var><span class="hyp-type"><b>: </b><span>transition_item</span></span></span><br><span><var>Htr</var><span class="hyp-type"><b>: </b><span>finite_valid_trace_from s (te :: tr)</span></span></span><br><span><var>s1</var><span class="hyp-type"><b>: </b><span>state</span></span></span><br><span><var>tl</var><span class="hyp-type"><b>: </b><span>list transition_item</span></span></span><br><span><var>s'</var><span class="hyp-type"><b>: </b><span>state</span></span></span><br><span><var>iom, oom</var><span class="hyp-type"><b>: </b><span>option message</span></span></span><br><span><var>l0</var><span class="hyp-type"><b>: </b><span>label</span></span></span><br><span><var>Htl</var><span class="hyp-type"><b>: </b><span>finite_valid_trace_from s1 tr</span></span></span><br><span><var>Ht</var><span class="hyp-type"><b>: </b><span>input_valid_transition l0 (s, iom) (s1, oom)</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>s&#39; = s</span></span></span><br><span><var>H1</var><span class="hyp-type"><b>: </b><span>{|
  l := l0;
  input := iom;
  destination := s1;
  output := oom
|} = te</span></span></span><br><span><var>H2</var><span class="hyp-type"><b>: </b><span>tl = tr</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">finite_valid_trace_from
  (destination
     {|
       l := l0;
       input := iom;
       destination := s1;
       output := oom
     |}) tr</div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="bp">assumption</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Qed</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
</span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="VLSM-v-chk132" style="display: none" type="checkbox"><label class="alectryon-input" for="VLSM-v-chk132"><span class="kn">Lemma</span> <span class="nf">finite_valid_trace_last_pstate</span>
      (<span class="nv">s</span> : state)
      (<span class="nv">tr</span> : list transition_item)
      (<span class="nv">Htr</span> : finite_valid_trace_from s tr)
      : valid_state_prop (finite_trace_last s tr).</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>message</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>X</var><span class="hyp-type"><b>: </b><span>VLSM message</span></span></span><br><span><var>TypeX</var><span><span class="hyp-body"><b>:= </b><span>type X</span></span><span class="hyp-type"><b>: </b><span>VLSMType message</span></span></span></span><br><span><var>MachineX</var><span><span class="hyp-body"><b>:= </b><span>machine X</span></span><span class="hyp-type"><b>: </b><span>VLSMMachine (vtype X)</span></span></span></span><br><span><var>s</var><span class="hyp-type"><b>: </b><span>state</span></span></span><br><span><var>tr</var><span class="hyp-type"><b>: </b><span>list transition_item</span></span></span><br><span><var>Htr</var><span class="hyp-type"><b>: </b><span>finite_valid_trace_from s tr</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">valid_state_prop (finite_trace_last s tr)</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="VLSM-v-chk133" style="display: none" type="checkbox"><label class="alectryon-input" for="VLSM-v-chk133"><span class="kn">Proof</span>.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>message</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>X</var><span class="hyp-type"><b>: </b><span>VLSM message</span></span></span><br><span><var>TypeX</var><span><span class="hyp-body"><b>:= </b><span>type X</span></span><span class="hyp-type"><b>: </b><span>VLSMType message</span></span></span></span><br><span><var>MachineX</var><span><span class="hyp-body"><b>:= </b><span>machine X</span></span><span class="hyp-type"><b>: </b><span>VLSMMachine (vtype X)</span></span></span></span><br><span><var>s</var><span class="hyp-type"><b>: </b><span>state</span></span></span><br><span><var>tr</var><span class="hyp-type"><b>: </b><span>list transition_item</span></span></span><br><span><var>Htr</var><span class="hyp-type"><b>: </b><span>finite_valid_trace_from s tr</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">valid_state_prop (finite_trace_last s tr)</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">      </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="VLSM-v-chk134" style="display: none" type="checkbox"><label class="alectryon-input" for="VLSM-v-chk134"><span class="nb">generalize dependent</span> s.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>message</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>X</var><span class="hyp-type"><b>: </b><span>VLSM message</span></span></span><br><span><var>TypeX</var><span><span class="hyp-body"><b>:= </b><span>type X</span></span><span class="hyp-type"><b>: </b><span>VLSMType message</span></span></span></span><br><span><var>MachineX</var><span><span class="hyp-body"><b>:= </b><span>machine X</span></span><span class="hyp-type"><b>: </b><span>VLSMMachine (vtype X)</span></span></span></span><br><span><var>tr</var><span class="hyp-type"><b>: </b><span>list transition_item</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="kr">‚àÄ</span> <span class="nv">s</span> : state,
  finite_valid_trace_from s tr
  ‚Üí valid_state_prop (finite_trace_last s tr)</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">      </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="VLSM-v-chk135" style="display: none" type="checkbox"><label class="alectryon-input" for="VLSM-v-chk135"><span class="nb">induction</span> tr; <span class="nb">intros</span>.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>message</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>X</var><span class="hyp-type"><b>: </b><span>VLSM message</span></span></span><br><span><var>TypeX</var><span><span class="hyp-body"><b>:= </b><span>type X</span></span><span class="hyp-type"><b>: </b><span>VLSMType message</span></span></span></span><br><span><var>MachineX</var><span><span class="hyp-body"><b>:= </b><span>machine X</span></span><span class="hyp-type"><b>: </b><span>VLSMMachine (vtype X)</span></span></span></span><br><span><var>s</var><span class="hyp-type"><b>: </b><span>state</span></span></span><br><span><var>Htr</var><span class="hyp-type"><b>: </b><span>finite_valid_trace_from s []</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">valid_state_prop (finite_trace_last s [])</div></blockquote><div class="alectryon-extra-goals"><input class="alectryon-extra-goal-toggle" id="VLSM-v-chk136" style="display: none" type="checkbox"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>message</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>X</var><span class="hyp-type"><b>: </b><span>VLSM message</span></span></span><br><span><var>TypeX</var><span><span class="hyp-body"><b>:= </b><span>type X</span></span><span class="hyp-type"><b>: </b><span>VLSMType message</span></span></span></span><br><span><var>MachineX</var><span><span class="hyp-body"><b>:= </b><span>machine X</span></span><span class="hyp-type"><b>: </b><span>VLSMMachine (vtype X)</span></span></span></span><br><span><var>a</var><span class="hyp-type"><b>: </b><span>transition_item</span></span></span><br><span><var>tr</var><span class="hyp-type"><b>: </b><span>list transition_item</span></span></span><br><span><var>IHtr</var><span class="hyp-type"><b>: </b><span><span class="kr">‚àÄ</span> <span class="nv">s</span> : state,
  finite_valid_trace_from s tr
  ‚Üí valid_state_prop (finite_trace_last s tr)</span></span></span><br><span><var>s</var><span class="hyp-type"><b>: </b><span>state</span></span></span><br><span><var>Htr</var><span class="hyp-type"><b>: </b><span>finite_valid_trace_from s (a :: tr)</span></span></span><br></div><label class="goal-separator" for="VLSM-v-chk136"><hr></label><div class="goal-conclusion">valid_state_prop (finite_trace_last s (a :: tr))</div></blockquote></div></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">      </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="VLSM-v-chk137" style="display: none" type="checkbox"><label class="alectryon-input" for="VLSM-v-chk137">-</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>message</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>X</var><span class="hyp-type"><b>: </b><span>VLSM message</span></span></span><br><span><var>TypeX</var><span><span class="hyp-body"><b>:= </b><span>type X</span></span><span class="hyp-type"><b>: </b><span>VLSMType message</span></span></span></span><br><span><var>MachineX</var><span><span class="hyp-body"><b>:= </b><span>machine X</span></span><span class="hyp-type"><b>: </b><span>VLSMMachine (vtype X)</span></span></span></span><br><span><var>s</var><span class="hyp-type"><b>: </b><span>state</span></span></span><br><span><var>Htr</var><span class="hyp-type"><b>: </b><span>finite_valid_trace_from s []</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">valid_state_prop (finite_trace_last s [])</div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="VLSM-v-chk138" style="display: none" type="checkbox"><label class="alectryon-input" for="VLSM-v-chk138"><span class="nb">simpl</span>.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>message</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>X</var><span class="hyp-type"><b>: </b><span>VLSM message</span></span></span><br><span><var>TypeX</var><span><span class="hyp-body"><b>:= </b><span>type X</span></span><span class="hyp-type"><b>: </b><span>VLSMType message</span></span></span></span><br><span><var>MachineX</var><span><span class="hyp-body"><b>:= </b><span>machine X</span></span><span class="hyp-type"><b>: </b><span>VLSMMachine (vtype X)</span></span></span></span><br><span><var>s</var><span class="hyp-type"><b>: </b><span>state</span></span></span><br><span><var>Htr</var><span class="hyp-type"><b>: </b><span>finite_valid_trace_from s []</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">valid_state_prop (finite_trace_last s [])</div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="VLSM-v-chk139" style="display: none" type="checkbox"><label class="alectryon-input" for="VLSM-v-chk139"><span class="nb">apply</span> finite_valid_trace_first_pstate <span class="kr">with</span> [].</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>message</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>X</var><span class="hyp-type"><b>: </b><span>VLSM message</span></span></span><br><span><var>TypeX</var><span><span class="hyp-body"><b>:= </b><span>type X</span></span><span class="hyp-type"><b>: </b><span>VLSMType message</span></span></span></span><br><span><var>MachineX</var><span><span class="hyp-body"><b>:= </b><span>machine X</span></span><span class="hyp-type"><b>: </b><span>VLSMMachine (vtype X)</span></span></span></span><br><span><var>s</var><span class="hyp-type"><b>: </b><span>state</span></span></span><br><span><var>Htr</var><span class="hyp-type"><b>: </b><span>finite_valid_trace_from s []</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">finite_valid_trace_from (finite_trace_last s []) []</div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="bp">assumption</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">      </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="VLSM-v-chk13a" style="display: none" type="checkbox"><label class="alectryon-input" for="VLSM-v-chk13a">-</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>message</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>X</var><span class="hyp-type"><b>: </b><span>VLSM message</span></span></span><br><span><var>TypeX</var><span><span class="hyp-body"><b>:= </b><span>type X</span></span><span class="hyp-type"><b>: </b><span>VLSMType message</span></span></span></span><br><span><var>MachineX</var><span><span class="hyp-body"><b>:= </b><span>machine X</span></span><span class="hyp-type"><b>: </b><span>VLSMMachine (vtype X)</span></span></span></span><br><span><var>a</var><span class="hyp-type"><b>: </b><span>transition_item</span></span></span><br><span><var>tr</var><span class="hyp-type"><b>: </b><span>list transition_item</span></span></span><br><span><var>IHtr</var><span class="hyp-type"><b>: </b><span><span class="kr">‚àÄ</span> <span class="nv">s</span> : state,
  finite_valid_trace_from s tr
  ‚Üí valid_state_prop (finite_trace_last s tr)</span></span></span><br><span><var>s</var><span class="hyp-type"><b>: </b><span>state</span></span></span><br><span><var>Htr</var><span class="hyp-type"><b>: </b><span>finite_valid_trace_from s (a :: tr)</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">valid_state_prop (finite_trace_last s (a :: tr))</div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="VLSM-v-chk13b" style="display: none" type="checkbox"><label class="alectryon-input" for="VLSM-v-chk13b"><span class="nb">apply</span> finite_valid_trace_tail <span class="kr">in</span> Htr.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>message</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>X</var><span class="hyp-type"><b>: </b><span>VLSM message</span></span></span><br><span><var>TypeX</var><span><span class="hyp-body"><b>:= </b><span>type X</span></span><span class="hyp-type"><b>: </b><span>VLSMType message</span></span></span></span><br><span><var>MachineX</var><span><span class="hyp-body"><b>:= </b><span>machine X</span></span><span class="hyp-type"><b>: </b><span>VLSMMachine (vtype X)</span></span></span></span><br><span><var>a</var><span class="hyp-type"><b>: </b><span>transition_item</span></span></span><br><span><var>tr</var><span class="hyp-type"><b>: </b><span>list transition_item</span></span></span><br><span><var>IHtr</var><span class="hyp-type"><b>: </b><span><span class="kr">‚àÄ</span> <span class="nv">s</span> : state,
  finite_valid_trace_from s tr
  ‚Üí valid_state_prop (finite_trace_last s tr)</span></span></span><br><span><var>s</var><span class="hyp-type"><b>: </b><span>state</span></span></span><br><span><var>Htr</var><span class="hyp-type"><b>: </b><span>finite_valid_trace_from (destination a) tr</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">valid_state_prop (finite_trace_last s (a :: tr))</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">        </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="VLSM-v-chk13c" style="display: none" type="checkbox"><label class="alectryon-input" for="VLSM-v-chk13c"><span class="nb">apply</span> IHtr <span class="kr">in</span> Htr.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>message</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>X</var><span class="hyp-type"><b>: </b><span>VLSM message</span></span></span><br><span><var>TypeX</var><span><span class="hyp-body"><b>:= </b><span>type X</span></span><span class="hyp-type"><b>: </b><span>VLSMType message</span></span></span></span><br><span><var>MachineX</var><span><span class="hyp-body"><b>:= </b><span>machine X</span></span><span class="hyp-type"><b>: </b><span>VLSMMachine (vtype X)</span></span></span></span><br><span><var>a</var><span class="hyp-type"><b>: </b><span>transition_item</span></span></span><br><span><var>tr</var><span class="hyp-type"><b>: </b><span>list transition_item</span></span></span><br><span><var>IHtr</var><span class="hyp-type"><b>: </b><span><span class="kr">‚àÄ</span> <span class="nv">s</span> : state,
  finite_valid_trace_from s tr
  ‚Üí valid_state_prop (finite_trace_last s tr)</span></span></span><br><span><var>s</var><span class="hyp-type"><b>: </b><span>state</span></span></span><br><span><var>Htr</var><span class="hyp-type"><b>: </b><span>valid_state_prop
  (finite_trace_last (destination a) tr)</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">valid_state_prop (finite_trace_last s (a :: tr))</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">        </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="VLSM-v-chk13d" style="display: none" type="checkbox"><label class="alectryon-input" for="VLSM-v-chk13d"><span class="nb">replace</span>
          (finite_trace_last s (a :: tr))
          <span class="kr">with</span> (finite_trace_last (destination a) tr)
        ;[<span class="bp">assumption</span>|].</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>message</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>X</var><span class="hyp-type"><b>: </b><span>VLSM message</span></span></span><br><span><var>TypeX</var><span><span class="hyp-body"><b>:= </b><span>type X</span></span><span class="hyp-type"><b>: </b><span>VLSMType message</span></span></span></span><br><span><var>MachineX</var><span><span class="hyp-body"><b>:= </b><span>machine X</span></span><span class="hyp-type"><b>: </b><span>VLSMMachine (vtype X)</span></span></span></span><br><span><var>a</var><span class="hyp-type"><b>: </b><span>transition_item</span></span></span><br><span><var>tr</var><span class="hyp-type"><b>: </b><span>list transition_item</span></span></span><br><span><var>IHtr</var><span class="hyp-type"><b>: </b><span><span class="kr">‚àÄ</span> <span class="nv">s</span> : state,
  finite_valid_trace_from s tr
  ‚Üí valid_state_prop (finite_trace_last s tr)</span></span></span><br><span><var>s</var><span class="hyp-type"><b>: </b><span>state</span></span></span><br><span><var>Htr</var><span class="hyp-type"><b>: </b><span>valid_state_prop
  (finite_trace_last (destination a) tr)</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">finite_trace_last (destination a) tr =
finite_trace_last s (a :: tr)</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">        </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="VLSM-v-chk13e" style="display: none" type="checkbox"><label class="alectryon-input" for="VLSM-v-chk13e"><span class="nb">unfold</span> finite_trace_last.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>message</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>X</var><span class="hyp-type"><b>: </b><span>VLSM message</span></span></span><br><span><var>TypeX</var><span><span class="hyp-body"><b>:= </b><span>type X</span></span><span class="hyp-type"><b>: </b><span>VLSMType message</span></span></span></span><br><span><var>MachineX</var><span><span class="hyp-body"><b>:= </b><span>machine X</span></span><span class="hyp-type"><b>: </b><span>VLSMMachine (vtype X)</span></span></span></span><br><span><var>a</var><span class="hyp-type"><b>: </b><span>transition_item</span></span></span><br><span><var>tr</var><span class="hyp-type"><b>: </b><span>list transition_item</span></span></span><br><span><var>IHtr</var><span class="hyp-type"><b>: </b><span><span class="kr">‚àÄ</span> <span class="nv">s</span> : state,
  finite_valid_trace_from s tr
  ‚Üí valid_state_prop (finite_trace_last s tr)</span></span></span><br><span><var>s</var><span class="hyp-type"><b>: </b><span>state</span></span></span><br><span><var>Htr</var><span class="hyp-type"><b>: </b><span>valid_state_prop
  (finite_trace_last (destination a) tr)</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">List.<span class="nb">last</span> (List.map destination tr) (destination a) =
List.<span class="nb">last</span> (List.map destination (a :: tr)) s</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">        </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="VLSM-v-chk13f" style="display: none" type="checkbox"><label class="alectryon-input" for="VLSM-v-chk13f"><span class="nb">rewrite</span> map_cons.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>message</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>X</var><span class="hyp-type"><b>: </b><span>VLSM message</span></span></span><br><span><var>TypeX</var><span><span class="hyp-body"><b>:= </b><span>type X</span></span><span class="hyp-type"><b>: </b><span>VLSMType message</span></span></span></span><br><span><var>MachineX</var><span><span class="hyp-body"><b>:= </b><span>machine X</span></span><span class="hyp-type"><b>: </b><span>VLSMMachine (vtype X)</span></span></span></span><br><span><var>a</var><span class="hyp-type"><b>: </b><span>transition_item</span></span></span><br><span><var>tr</var><span class="hyp-type"><b>: </b><span>list transition_item</span></span></span><br><span><var>IHtr</var><span class="hyp-type"><b>: </b><span><span class="kr">‚àÄ</span> <span class="nv">s</span> : state,
  finite_valid_trace_from s tr
  ‚Üí valid_state_prop (finite_trace_last s tr)</span></span></span><br><span><var>s</var><span class="hyp-type"><b>: </b><span>state</span></span></span><br><span><var>Htr</var><span class="hyp-type"><b>: </b><span>valid_state_prop
  (finite_trace_last (destination a) tr)</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">List.<span class="nb">last</span> (List.map destination tr) (destination a) =
List.<span class="nb">last</span> (destination a :: List.map destination tr) s</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">        </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="VLSM-v-chk140" style="display: none" type="checkbox"><label class="alectryon-input" for="VLSM-v-chk140"><span class="nb">rewrite</span> unroll_last.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>message</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>X</var><span class="hyp-type"><b>: </b><span>VLSM message</span></span></span><br><span><var>TypeX</var><span><span class="hyp-body"><b>:= </b><span>type X</span></span><span class="hyp-type"><b>: </b><span>VLSMType message</span></span></span></span><br><span><var>MachineX</var><span><span class="hyp-body"><b>:= </b><span>machine X</span></span><span class="hyp-type"><b>: </b><span>VLSMMachine (vtype X)</span></span></span></span><br><span><var>a</var><span class="hyp-type"><b>: </b><span>transition_item</span></span></span><br><span><var>tr</var><span class="hyp-type"><b>: </b><span>list transition_item</span></span></span><br><span><var>IHtr</var><span class="hyp-type"><b>: </b><span><span class="kr">‚àÄ</span> <span class="nv">s</span> : state,
  finite_valid_trace_from s tr
  ‚Üí valid_state_prop (finite_trace_last s tr)</span></span></span><br><span><var>s</var><span class="hyp-type"><b>: </b><span>state</span></span></span><br><span><var>Htr</var><span class="hyp-type"><b>: </b><span>valid_state_prop
  (finite_trace_last (destination a) tr)</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">List.<span class="nb">last</span> (List.map destination tr) (destination a) =
List.<span class="nb">last</span> (List.map destination tr) (destination a)</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">        </span><span class="alectryon-sentence"><span class="alectryon-input"><span class="bp">reflexivity</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Qed</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
</span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="VLSM-v-chk141" style="display: none" type="checkbox"><label class="alectryon-input" for="VLSM-v-chk141"><span class="kn">Lemma</span> <span class="nf">input_valid_transition_to</span>
          (<span class="nv">s</span> : state)
          (<span class="nv">tr</span> : list transition_item)
          (<span class="nv">tr1</span> <span class="nv">tr2</span> : list transition_item)
          (<span class="nv">te</span> : transition_item)
          (<span class="nv">Htr</span> : finite_valid_trace_from s tr)
          (<span class="nv">Heq</span> : tr = tr1 ++ [te] ++ tr2)
          (<span class="nv">lst1</span> := finite_trace_last s tr1)
      : input_valid_transition (l te) (lst1, input te) (destination te, output te).</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>message</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>X</var><span class="hyp-type"><b>: </b><span>VLSM message</span></span></span><br><span><var>TypeX</var><span><span class="hyp-body"><b>:= </b><span>type X</span></span><span class="hyp-type"><b>: </b><span>VLSMType message</span></span></span></span><br><span><var>MachineX</var><span><span class="hyp-body"><b>:= </b><span>machine X</span></span><span class="hyp-type"><b>: </b><span>VLSMMachine (vtype X)</span></span></span></span><br><span><var>s</var><span class="hyp-type"><b>: </b><span>state</span></span></span><br><span><var>tr, tr1, tr2</var><span class="hyp-type"><b>: </b><span>list transition_item</span></span></span><br><span><var>te</var><span class="hyp-type"><b>: </b><span>transition_item</span></span></span><br><span><var>Htr</var><span class="hyp-type"><b>: </b><span>finite_valid_trace_from s tr</span></span></span><br><span><var>Heq</var><span class="hyp-type"><b>: </b><span>tr = tr1 ++ [te] ++ tr2</span></span></span><br><span><var>lst1</var><span><span class="hyp-body"><b>:= </b><span>finite_trace_last s tr1</span></span><span class="hyp-type"><b>: </b><span>state</span></span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">input_valid_transition (l te) (lst1, input te)
  (destination te, output te)</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="VLSM-v-chk142" style="display: none" type="checkbox"><label class="alectryon-input" for="VLSM-v-chk142"><span class="kn">Proof</span>.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>message</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>X</var><span class="hyp-type"><b>: </b><span>VLSM message</span></span></span><br><span><var>TypeX</var><span><span class="hyp-body"><b>:= </b><span>type X</span></span><span class="hyp-type"><b>: </b><span>VLSMType message</span></span></span></span><br><span><var>MachineX</var><span><span class="hyp-body"><b>:= </b><span>machine X</span></span><span class="hyp-type"><b>: </b><span>VLSMMachine (vtype X)</span></span></span></span><br><span><var>s</var><span class="hyp-type"><b>: </b><span>state</span></span></span><br><span><var>tr, tr1, tr2</var><span class="hyp-type"><b>: </b><span>list transition_item</span></span></span><br><span><var>te</var><span class="hyp-type"><b>: </b><span>transition_item</span></span></span><br><span><var>Htr</var><span class="hyp-type"><b>: </b><span>finite_valid_trace_from s tr</span></span></span><br><span><var>Heq</var><span class="hyp-type"><b>: </b><span>tr = tr1 ++ [te] ++ tr2</span></span></span><br><span><var>lst1</var><span><span class="hyp-body"><b>:= </b><span>finite_trace_last s tr1</span></span><span class="hyp-type"><b>: </b><span>state</span></span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">input_valid_transition (l te) (lst1, input te)
  (destination te, output te)</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">      </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="VLSM-v-chk143" style="display: none" type="checkbox"><label class="alectryon-input" for="VLSM-v-chk143"><span class="nb">generalize dependent</span> s.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>message</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>X</var><span class="hyp-type"><b>: </b><span>VLSM message</span></span></span><br><span><var>TypeX</var><span><span class="hyp-body"><b>:= </b><span>type X</span></span><span class="hyp-type"><b>: </b><span>VLSMType message</span></span></span></span><br><span><var>MachineX</var><span><span class="hyp-body"><b>:= </b><span>machine X</span></span><span class="hyp-type"><b>: </b><span>VLSMMachine (vtype X)</span></span></span></span><br><span><var>tr, tr1, tr2</var><span class="hyp-type"><b>: </b><span>list transition_item</span></span></span><br><span><var>te</var><span class="hyp-type"><b>: </b><span>transition_item</span></span></span><br><span><var>Heq</var><span class="hyp-type"><b>: </b><span>tr = tr1 ++ [te] ++ tr2</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="kr">‚àÄ</span> <span class="nv">s</span> : state,
  finite_valid_trace_from s tr
  ‚Üí <span class="kr">let</span> <span class="nv">lst1</span> := finite_trace_last s tr1 <span class="kr">in</span>
    input_valid_transition (l te) (lst1, input te)
      (destination te, output te)</div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="VLSM-v-chk144" style="display: none" type="checkbox"><label class="alectryon-input" for="VLSM-v-chk144"><span class="nb">generalize dependent</span> tr.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>message</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>X</var><span class="hyp-type"><b>: </b><span>VLSM message</span></span></span><br><span><var>TypeX</var><span><span class="hyp-body"><b>:= </b><span>type X</span></span><span class="hyp-type"><b>: </b><span>VLSMType message</span></span></span></span><br><span><var>MachineX</var><span><span class="hyp-body"><b>:= </b><span>machine X</span></span><span class="hyp-type"><b>: </b><span>VLSMMachine (vtype X)</span></span></span></span><br><span><var>tr1, tr2</var><span class="hyp-type"><b>: </b><span>list transition_item</span></span></span><br><span><var>te</var><span class="hyp-type"><b>: </b><span>transition_item</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="kr">‚àÄ</span> <span class="nv">tr</span> : list transition_item,
  tr = tr1 ++ [te] ++ tr2
  ‚Üí <span class="kr">‚àÄ</span> <span class="nv">s</span> : state,
      finite_valid_trace_from s tr
      ‚Üí <span class="kr">let</span> <span class="nv">lst1</span> := finite_trace_last s tr1 <span class="kr">in</span>
        input_valid_transition (l te) (lst1, input te)
          (destination te, output te)</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">      </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="VLSM-v-chk145" style="display: none" type="checkbox"><label class="alectryon-input" for="VLSM-v-chk145"><span class="nb">induction</span> tr1.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>message</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>X</var><span class="hyp-type"><b>: </b><span>VLSM message</span></span></span><br><span><var>TypeX</var><span><span class="hyp-body"><b>:= </b><span>type X</span></span><span class="hyp-type"><b>: </b><span>VLSMType message</span></span></span></span><br><span><var>MachineX</var><span><span class="hyp-body"><b>:= </b><span>machine X</span></span><span class="hyp-type"><b>: </b><span>VLSMMachine (vtype X)</span></span></span></span><br><span><var>tr2</var><span class="hyp-type"><b>: </b><span>list transition_item</span></span></span><br><span><var>te</var><span class="hyp-type"><b>: </b><span>transition_item</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="kr">‚àÄ</span> <span class="nv">tr</span> : list transition_item,
  tr = [] ++ [te] ++ tr2
  ‚Üí <span class="kr">‚àÄ</span> <span class="nv">s</span> : state,
      finite_valid_trace_from s tr
      ‚Üí <span class="kr">let</span> <span class="nv">lst1</span> := finite_trace_last s [] <span class="kr">in</span>
        input_valid_transition (l te) (lst1, input te)
          (destination te, output te)</div></blockquote><div class="alectryon-extra-goals"><input class="alectryon-extra-goal-toggle" id="VLSM-v-chk146" style="display: none" type="checkbox"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>message</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>X</var><span class="hyp-type"><b>: </b><span>VLSM message</span></span></span><br><span><var>TypeX</var><span><span class="hyp-body"><b>:= </b><span>type X</span></span><span class="hyp-type"><b>: </b><span>VLSMType message</span></span></span></span><br><span><var>MachineX</var><span><span class="hyp-body"><b>:= </b><span>machine X</span></span><span class="hyp-type"><b>: </b><span>VLSMMachine (vtype X)</span></span></span></span><br><span><var>a</var><span class="hyp-type"><b>: </b><span>transition_item</span></span></span><br><span><var>tr1, tr2</var><span class="hyp-type"><b>: </b><span>list transition_item</span></span></span><br><span><var>te</var><span class="hyp-type"><b>: </b><span>transition_item</span></span></span><br><span><var>IHtr1</var><span class="hyp-type"><b>: </b><span><span class="kr">‚àÄ</span> <span class="nv">tr</span> : list transition_item,
  tr = tr1 ++ [te] ++ tr2
  ‚Üí <span class="kr">‚àÄ</span> <span class="nv">s</span> : state,
      finite_valid_trace_from s tr
      ‚Üí <span class="kr">let</span> <span class="nv">lst1</span> := finite_trace_last s tr1 <span class="kr">in</span>
        input_valid_transition 
          (l te) (lst1, input te)
          (destination te, output te)</span></span></span><br></div><label class="goal-separator" for="VLSM-v-chk146"><hr></label><div class="goal-conclusion"><span class="kr">‚àÄ</span> <span class="nv">tr</span> : list transition_item,
  tr = (a :: tr1) ++ [te] ++ tr2
  ‚Üí <span class="kr">‚àÄ</span> <span class="nv">s</span> : state,
      finite_valid_trace_from s tr
      ‚Üí <span class="kr">let</span> <span class="nv">lst1</span> := finite_trace_last s (a :: tr1) <span class="kr">in</span>
        input_valid_transition 
          (l te) (lst1, input te)
          (destination te, output te)</div></blockquote></div></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">      </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="VLSM-v-chk147" style="display: none" type="checkbox"><label class="alectryon-input" for="VLSM-v-chk147">-</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>message</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>X</var><span class="hyp-type"><b>: </b><span>VLSM message</span></span></span><br><span><var>TypeX</var><span><span class="hyp-body"><b>:= </b><span>type X</span></span><span class="hyp-type"><b>: </b><span>VLSMType message</span></span></span></span><br><span><var>MachineX</var><span><span class="hyp-body"><b>:= </b><span>machine X</span></span><span class="hyp-type"><b>: </b><span>VLSMMachine (vtype X)</span></span></span></span><br><span><var>tr2</var><span class="hyp-type"><b>: </b><span>list transition_item</span></span></span><br><span><var>te</var><span class="hyp-type"><b>: </b><span>transition_item</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="kr">‚àÄ</span> <span class="nv">tr</span> : list transition_item,
  tr = [] ++ [te] ++ tr2
  ‚Üí <span class="kr">‚àÄ</span> <span class="nv">s</span> : state,
      finite_valid_trace_from s tr
      ‚Üí <span class="kr">let</span> <span class="nv">lst1</span> := finite_trace_last s [] <span class="kr">in</span>
        input_valid_transition (l te) (lst1, input te)
          (destination te, output te)</div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="VLSM-v-chk148" style="display: none" type="checkbox"><label class="alectryon-input" for="VLSM-v-chk148"><span class="nb">intros</span> tr Heq s Htr.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>message</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>X</var><span class="hyp-type"><b>: </b><span>VLSM message</span></span></span><br><span><var>TypeX</var><span><span class="hyp-body"><b>:= </b><span>type X</span></span><span class="hyp-type"><b>: </b><span>VLSMType message</span></span></span></span><br><span><var>MachineX</var><span><span class="hyp-body"><b>:= </b><span>machine X</span></span><span class="hyp-type"><b>: </b><span>VLSMMachine (vtype X)</span></span></span></span><br><span><var>tr2</var><span class="hyp-type"><b>: </b><span>list transition_item</span></span></span><br><span><var>te</var><span class="hyp-type"><b>: </b><span>transition_item</span></span></span><br><span><var>tr</var><span class="hyp-type"><b>: </b><span>list transition_item</span></span></span><br><span><var>Heq</var><span class="hyp-type"><b>: </b><span>tr = [] ++ [te] ++ tr2</span></span></span><br><span><var>s</var><span class="hyp-type"><b>: </b><span>state</span></span></span><br><span><var>Htr</var><span class="hyp-type"><b>: </b><span>finite_valid_trace_from s tr</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="kr">let</span> <span class="nv">lst1</span> := finite_trace_last s [] <span class="kr">in</span>
input_valid_transition (l te) (lst1, input te)
  (destination te, output te)</div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="VLSM-v-chk149" style="display: none" type="checkbox"><label class="alectryon-input" for="VLSM-v-chk149"><span class="nb">simpl</span> <span class="kr">in</span> Heq; <span class="nb">subst</span>.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>message</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>X</var><span class="hyp-type"><b>: </b><span>VLSM message</span></span></span><br><span><var>TypeX</var><span><span class="hyp-body"><b>:= </b><span>type X</span></span><span class="hyp-type"><b>: </b><span>VLSMType message</span></span></span></span><br><span><var>MachineX</var><span><span class="hyp-body"><b>:= </b><span>machine X</span></span><span class="hyp-type"><b>: </b><span>VLSMMachine (vtype X)</span></span></span></span><br><span><var>tr2</var><span class="hyp-type"><b>: </b><span>list transition_item</span></span></span><br><span><var>te</var><span class="hyp-type"><b>: </b><span>transition_item</span></span></span><br><span><var>s</var><span class="hyp-type"><b>: </b><span>state</span></span></span><br><span><var>Htr</var><span class="hyp-type"><b>: </b><span>finite_valid_trace_from s (te :: tr2)</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="kr">let</span> <span class="nv">lst1</span> := finite_trace_last s [] <span class="kr">in</span>
input_valid_transition (l te) (lst1, input te)
  (destination te, output te)</div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="VLSM-v-chk14a" style="display: none" type="checkbox"><label class="alectryon-input" for="VLSM-v-chk14a"><span class="nb">inversion</span> Htr; <span class="nb">subst</span>.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>message</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>X</var><span class="hyp-type"><b>: </b><span>VLSM message</span></span></span><br><span><var>TypeX</var><span><span class="hyp-body"><b>:= </b><span>type X</span></span><span class="hyp-type"><b>: </b><span>VLSMType message</span></span></span></span><br><span><var>MachineX</var><span><span class="hyp-body"><b>:= </b><span>machine X</span></span><span class="hyp-type"><b>: </b><span>VLSMMachine (vtype X)</span></span></span></span><br><span><var>tr2</var><span class="hyp-type"><b>: </b><span>list transition_item</span></span></span><br><span><var>s, s1</var><span class="hyp-type"><b>: </b><span>state</span></span></span><br><span><var>iom, oom</var><span class="hyp-type"><b>: </b><span>option message</span></span></span><br><span><var>l0</var><span class="hyp-type"><b>: </b><span>label</span></span></span><br><span><var>Htr</var><span class="hyp-type"><b>: </b><span>finite_valid_trace_from s
  ({|
     l := l0;
     input := iom;
     destination := s1;
     output := oom
   |} :: tr2)</span></span></span><br><span><var>Htl</var><span class="hyp-type"><b>: </b><span>finite_valid_trace_from s1 tr2</span></span></span><br><span><var>Ht</var><span class="hyp-type"><b>: </b><span>input_valid_transition l0 (s, iom) (s1, oom)</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="kr">let</span> <span class="nv">lst1</span> := finite_trace_last s [] <span class="kr">in</span>
input_valid_transition
  (l
     {|
       l := l0;
       input := iom;
       destination := s1;
       output := oom
     |})
  (lst1,
  input
    {|
      l := l0;
      input := iom;
      destination := s1;
      output := oom
    |})
  (destination
     {|
       l := l0;
       input := iom;
       destination := s1;
       output := oom
     |},
  output
    {|
      l := l0;
      input := iom;
      destination := s1;
      output := oom
    |})</div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="bp">assumption</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">      </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="VLSM-v-chk14b" style="display: none" type="checkbox"><label class="alectryon-input" for="VLSM-v-chk14b">-</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>message</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>X</var><span class="hyp-type"><b>: </b><span>VLSM message</span></span></span><br><span><var>TypeX</var><span><span class="hyp-body"><b>:= </b><span>type X</span></span><span class="hyp-type"><b>: </b><span>VLSMType message</span></span></span></span><br><span><var>MachineX</var><span><span class="hyp-body"><b>:= </b><span>machine X</span></span><span class="hyp-type"><b>: </b><span>VLSMMachine (vtype X)</span></span></span></span><br><span><var>a</var><span class="hyp-type"><b>: </b><span>transition_item</span></span></span><br><span><var>tr1, tr2</var><span class="hyp-type"><b>: </b><span>list transition_item</span></span></span><br><span><var>te</var><span class="hyp-type"><b>: </b><span>transition_item</span></span></span><br><span><var>IHtr1</var><span class="hyp-type"><b>: </b><span><span class="kr">‚àÄ</span> <span class="nv">tr</span> : list transition_item,
  tr = tr1 ++ [te] ++ tr2
  ‚Üí <span class="kr">‚àÄ</span> <span class="nv">s</span> : state,
      finite_valid_trace_from s tr
      ‚Üí <span class="kr">let</span> <span class="nv">lst1</span> := finite_trace_last s tr1 <span class="kr">in</span>
        input_valid_transition 
          (l te) (lst1, input te)
          (destination te, output te)</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="kr">‚àÄ</span> <span class="nv">tr</span> : list transition_item,
  tr = (a :: tr1) ++ [te] ++ tr2
  ‚Üí <span class="kr">‚àÄ</span> <span class="nv">s</span> : state,
      finite_valid_trace_from s tr
      ‚Üí <span class="kr">let</span> <span class="nv">lst1</span> := finite_trace_last s (a :: tr1) <span class="kr">in</span>
        input_valid_transition (l te) (lst1, input te)
          (destination te, output te)</div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="VLSM-v-chk14c" style="display: none" type="checkbox"><label class="alectryon-input" for="VLSM-v-chk14c"><span class="nb">specialize</span> (IHtr1 (tr1 ++ [te] ++ tr2) eq_refl).</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>message</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>X</var><span class="hyp-type"><b>: </b><span>VLSM message</span></span></span><br><span><var>TypeX</var><span><span class="hyp-body"><b>:= </b><span>type X</span></span><span class="hyp-type"><b>: </b><span>VLSMType message</span></span></span></span><br><span><var>MachineX</var><span><span class="hyp-body"><b>:= </b><span>machine X</span></span><span class="hyp-type"><b>: </b><span>VLSMMachine (vtype X)</span></span></span></span><br><span><var>a</var><span class="hyp-type"><b>: </b><span>transition_item</span></span></span><br><span><var>tr1, tr2</var><span class="hyp-type"><b>: </b><span>list transition_item</span></span></span><br><span><var>te</var><span class="hyp-type"><b>: </b><span>transition_item</span></span></span><br><span><var>IHtr1</var><span class="hyp-type"><b>: </b><span><span class="kr">‚àÄ</span> <span class="nv">s</span> : state,
  finite_valid_trace_from s
    (tr1 ++ [te] ++ tr2)
  ‚Üí <span class="kr">let</span> <span class="nv">lst1</span> := finite_trace_last s tr1 <span class="kr">in</span>
    input_valid_transition 
      (l te) (lst1, input te)
      (destination te, output te)</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="kr">‚àÄ</span> <span class="nv">tr</span> : list transition_item,
  tr = (a :: tr1) ++ [te] ++ tr2
  ‚Üí <span class="kr">‚àÄ</span> <span class="nv">s</span> : state,
      finite_valid_trace_from s tr
      ‚Üí <span class="kr">let</span> <span class="nv">lst1</span> := finite_trace_last s (a :: tr1) <span class="kr">in</span>
        input_valid_transition (l te) (lst1, input te)
          (destination te, output te)</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">        </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="VLSM-v-chk14d" style="display: none" type="checkbox"><label class="alectryon-input" for="VLSM-v-chk14d"><span class="nb">intros</span> tr Heq <span class="kr">is</span> Htr; <span class="nb">subst</span>.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>message</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>X</var><span class="hyp-type"><b>: </b><span>VLSM message</span></span></span><br><span><var>TypeX</var><span><span class="hyp-body"><b>:= </b><span>type X</span></span><span class="hyp-type"><b>: </b><span>VLSMType message</span></span></span></span><br><span><var>MachineX</var><span><span class="hyp-body"><b>:= </b><span>machine X</span></span><span class="hyp-type"><b>: </b><span>VLSMMachine (vtype X)</span></span></span></span><br><span><var>a</var><span class="hyp-type"><b>: </b><span>transition_item</span></span></span><br><span><var>tr1, tr2</var><span class="hyp-type"><b>: </b><span>list transition_item</span></span></span><br><span><var>te</var><span class="hyp-type"><b>: </b><span>transition_item</span></span></span><br><span><var>IHtr1</var><span class="hyp-type"><b>: </b><span><span class="kr">‚àÄ</span> <span class="nv">s</span> : state,
  finite_valid_trace_from s
    (tr1 ++ [te] ++ tr2)
  ‚Üí <span class="kr">let</span> <span class="nv">lst1</span> := finite_trace_last s tr1 <span class="kr">in</span>
    input_valid_transition 
      (l te) (lst1, input te)
      (destination te, output te)</span></span></span><br><span><var>is</var><span class="hyp-type"><b>: </b><span>state</span></span></span><br><span><var>Htr</var><span class="hyp-type"><b>: </b><span>finite_valid_trace_from <span class="kr">is</span>
  ((a :: tr1) ++ [te] ++ tr2)</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="kr">let</span> <span class="nv">lst1</span> := finite_trace_last <span class="kr">is</span> (a :: tr1) <span class="kr">in</span>
input_valid_transition (l te) (lst1, input te)
  (destination te, output te)</div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="VLSM-v-chk14e" style="display: none" type="checkbox"><label class="alectryon-input" for="VLSM-v-chk14e"><span class="nb">inversion</span> Htr; <span class="nb">subst</span>.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>message</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>X</var><span class="hyp-type"><b>: </b><span>VLSM message</span></span></span><br><span><var>TypeX</var><span><span class="hyp-body"><b>:= </b><span>type X</span></span><span class="hyp-type"><b>: </b><span>VLSMType message</span></span></span></span><br><span><var>MachineX</var><span><span class="hyp-body"><b>:= </b><span>machine X</span></span><span class="hyp-type"><b>: </b><span>VLSMMachine (vtype X)</span></span></span></span><br><span><var>tr1, tr2</var><span class="hyp-type"><b>: </b><span>list transition_item</span></span></span><br><span><var>te</var><span class="hyp-type"><b>: </b><span>transition_item</span></span></span><br><span><var>IHtr1</var><span class="hyp-type"><b>: </b><span><span class="kr">‚àÄ</span> <span class="nv">s</span> : state,
  finite_valid_trace_from s
    (tr1 ++ [te] ++ tr2)
  ‚Üí <span class="kr">let</span> <span class="nv">lst1</span> := finite_trace_last s tr1 <span class="kr">in</span>
    input_valid_transition 
      (l te) (lst1, input te)
      (destination te, output te)</span></span></span><br><span><var>is, s</var><span class="hyp-type"><b>: </b><span>state</span></span></span><br><span><var>iom, oom</var><span class="hyp-type"><b>: </b><span>option message</span></span></span><br><span><var>l0</var><span class="hyp-type"><b>: </b><span>label</span></span></span><br><span><var>Htr</var><span class="hyp-type"><b>: </b><span>finite_valid_trace_from <span class="kr">is</span>
  (({|
      l := l0;
      input := iom;
      destination := s;
      output := oom
    |} :: tr1) ++ [te] ++ tr2)</span></span></span><br><span><var>Htl</var><span class="hyp-type"><b>: </b><span>finite_valid_trace_from s (tr1 ++ te :: tr2)</span></span></span><br><span><var>Ht</var><span class="hyp-type"><b>: </b><span>input_valid_transition l0 (<span class="kr">is</span>, iom) (s, oom)</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="kr">let</span> <span class="nv">lst1</span> :=
  finite_trace_last <span class="kr">is</span>
    ({|
       l := l0;
       input := iom;
       destination := s;
       output := oom
     |} :: tr1) <span class="kr">in</span>
input_valid_transition (l te) (lst1, input te)
  (destination te, output te)</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">        </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="VLSM-v-chk14f" style="display: none" type="checkbox"><label class="alectryon-input" for="VLSM-v-chk14f"><span class="nb">rewrite</span> finite_trace_last_cons.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>message</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>X</var><span class="hyp-type"><b>: </b><span>VLSM message</span></span></span><br><span><var>TypeX</var><span><span class="hyp-body"><b>:= </b><span>type X</span></span><span class="hyp-type"><b>: </b><span>VLSMType message</span></span></span></span><br><span><var>MachineX</var><span><span class="hyp-body"><b>:= </b><span>machine X</span></span><span class="hyp-type"><b>: </b><span>VLSMMachine (vtype X)</span></span></span></span><br><span><var>tr1, tr2</var><span class="hyp-type"><b>: </b><span>list transition_item</span></span></span><br><span><var>te</var><span class="hyp-type"><b>: </b><span>transition_item</span></span></span><br><span><var>IHtr1</var><span class="hyp-type"><b>: </b><span><span class="kr">‚àÄ</span> <span class="nv">s</span> : state,
  finite_valid_trace_from s
    (tr1 ++ [te] ++ tr2)
  ‚Üí <span class="kr">let</span> <span class="nv">lst1</span> := finite_trace_last s tr1 <span class="kr">in</span>
    input_valid_transition 
      (l te) (lst1, input te)
      (destination te, output te)</span></span></span><br><span><var>is, s</var><span class="hyp-type"><b>: </b><span>state</span></span></span><br><span><var>iom, oom</var><span class="hyp-type"><b>: </b><span>option message</span></span></span><br><span><var>l0</var><span class="hyp-type"><b>: </b><span>label</span></span></span><br><span><var>Htr</var><span class="hyp-type"><b>: </b><span>finite_valid_trace_from <span class="kr">is</span>
  (({|
      l := l0;
      input := iom;
      destination := s;
      output := oom
    |} :: tr1) ++ [te] ++ tr2)</span></span></span><br><span><var>Htl</var><span class="hyp-type"><b>: </b><span>finite_valid_trace_from s (tr1 ++ te :: tr2)</span></span></span><br><span><var>Ht</var><span class="hyp-type"><b>: </b><span>input_valid_transition l0 (<span class="kr">is</span>, iom) (s, oom)</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="kr">let</span> <span class="nv">lst1</span> :=
  finite_trace_last
    (destination
       {|
         l := l0;
         input := iom;
         destination := s;
         output := oom
       |}) tr1 <span class="kr">in</span>
input_valid_transition (l te) (lst1, input te)
  (destination te, output te)</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">        </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="VLSM-v-chk150" style="display: none" type="checkbox"><label class="alectryon-input" for="VLSM-v-chk150"><span class="nb">apply</span> IHtr1.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>message</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>X</var><span class="hyp-type"><b>: </b><span>VLSM message</span></span></span><br><span><var>TypeX</var><span><span class="hyp-body"><b>:= </b><span>type X</span></span><span class="hyp-type"><b>: </b><span>VLSMType message</span></span></span></span><br><span><var>MachineX</var><span><span class="hyp-body"><b>:= </b><span>machine X</span></span><span class="hyp-type"><b>: </b><span>VLSMMachine (vtype X)</span></span></span></span><br><span><var>tr1, tr2</var><span class="hyp-type"><b>: </b><span>list transition_item</span></span></span><br><span><var>te</var><span class="hyp-type"><b>: </b><span>transition_item</span></span></span><br><span><var>IHtr1</var><span class="hyp-type"><b>: </b><span><span class="kr">‚àÄ</span> <span class="nv">s</span> : state,
  finite_valid_trace_from s
    (tr1 ++ [te] ++ tr2)
  ‚Üí <span class="kr">let</span> <span class="nv">lst1</span> := finite_trace_last s tr1 <span class="kr">in</span>
    input_valid_transition 
      (l te) (lst1, input te)
      (destination te, output te)</span></span></span><br><span><var>is, s</var><span class="hyp-type"><b>: </b><span>state</span></span></span><br><span><var>iom, oom</var><span class="hyp-type"><b>: </b><span>option message</span></span></span><br><span><var>l0</var><span class="hyp-type"><b>: </b><span>label</span></span></span><br><span><var>Htr</var><span class="hyp-type"><b>: </b><span>finite_valid_trace_from <span class="kr">is</span>
  (({|
      l := l0;
      input := iom;
      destination := s;
      output := oom
    |} :: tr1) ++ [te] ++ tr2)</span></span></span><br><span><var>Htl</var><span class="hyp-type"><b>: </b><span>finite_valid_trace_from s (tr1 ++ te :: tr2)</span></span></span><br><span><var>Ht</var><span class="hyp-type"><b>: </b><span>input_valid_transition l0 (<span class="kr">is</span>, iom) (s, oom)</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">finite_valid_trace_from
  (destination
     {|
       l := l0;
       input := iom;
       destination := s;
       output := oom
     |}) (tr1 ++ [te] ++ tr2)</div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="bp">assumption</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Qed</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
</span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="VLSM-v-chk151" style="display: none" type="checkbox"><label class="alectryon-input" for="VLSM-v-chk151"><span class="kn">Lemma</span> <span class="nf">finite_valid_trace_consecutive_valid_transition</span>
          (<span class="nv">s</span> : state)
          (<span class="nv">tr</span> : list transition_item)
          (<span class="nv">tr1</span> <span class="nv">tr2</span> : list transition_item)
          (<span class="nv">te1</span> <span class="nv">te2</span> : transition_item)
          (<span class="nv">Htr</span> : finite_valid_trace_from s tr)
          (<span class="nv">Heq</span> : tr = tr1 ++ [te1; te2] ++ tr2)
      : input_valid_transition (l te2) (destination te1, input te2) (destination te2, output te2).</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>message</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>X</var><span class="hyp-type"><b>: </b><span>VLSM message</span></span></span><br><span><var>TypeX</var><span><span class="hyp-body"><b>:= </b><span>type X</span></span><span class="hyp-type"><b>: </b><span>VLSMType message</span></span></span></span><br><span><var>MachineX</var><span><span class="hyp-body"><b>:= </b><span>machine X</span></span><span class="hyp-type"><b>: </b><span>VLSMMachine (vtype X)</span></span></span></span><br><span><var>s</var><span class="hyp-type"><b>: </b><span>state</span></span></span><br><span><var>tr, tr1, tr2</var><span class="hyp-type"><b>: </b><span>list transition_item</span></span></span><br><span><var>te1, te2</var><span class="hyp-type"><b>: </b><span>transition_item</span></span></span><br><span><var>Htr</var><span class="hyp-type"><b>: </b><span>finite_valid_trace_from s tr</span></span></span><br><span><var>Heq</var><span class="hyp-type"><b>: </b><span>tr = tr1 ++ [te1; te2] ++ tr2</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">input_valid_transition (l te2)
  (destination te1, input te2)
  (destination te2, output te2)</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="VLSM-v-chk152" style="display: none" type="checkbox"><label class="alectryon-input" for="VLSM-v-chk152"><span class="kn">Proof</span>.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>message</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>X</var><span class="hyp-type"><b>: </b><span>VLSM message</span></span></span><br><span><var>TypeX</var><span><span class="hyp-body"><b>:= </b><span>type X</span></span><span class="hyp-type"><b>: </b><span>VLSMType message</span></span></span></span><br><span><var>MachineX</var><span><span class="hyp-body"><b>:= </b><span>machine X</span></span><span class="hyp-type"><b>: </b><span>VLSMMachine (vtype X)</span></span></span></span><br><span><var>s</var><span class="hyp-type"><b>: </b><span>state</span></span></span><br><span><var>tr, tr1, tr2</var><span class="hyp-type"><b>: </b><span>list transition_item</span></span></span><br><span><var>te1, te2</var><span class="hyp-type"><b>: </b><span>transition_item</span></span></span><br><span><var>Htr</var><span class="hyp-type"><b>: </b><span>finite_valid_trace_from s tr</span></span></span><br><span><var>Heq</var><span class="hyp-type"><b>: </b><span>tr = tr1 ++ [te1; te2] ++ tr2</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">input_valid_transition (l te2)
  (destination te1, input te2)
  (destination te2, output te2)</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">      </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="VLSM-v-chk153" style="display: none" type="checkbox"><label class="alectryon-input" for="VLSM-v-chk153"><span class="nb">change</span> ([te1; te2] ++ tr2) <span class="kr">with</span> ([te1] ++ [te2] ++ tr2) <span class="kr">in</span> Heq.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>message</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>X</var><span class="hyp-type"><b>: </b><span>VLSM message</span></span></span><br><span><var>TypeX</var><span><span class="hyp-body"><b>:= </b><span>type X</span></span><span class="hyp-type"><b>: </b><span>VLSMType message</span></span></span></span><br><span><var>MachineX</var><span><span class="hyp-body"><b>:= </b><span>machine X</span></span><span class="hyp-type"><b>: </b><span>VLSMMachine (vtype X)</span></span></span></span><br><span><var>s</var><span class="hyp-type"><b>: </b><span>state</span></span></span><br><span><var>tr, tr1, tr2</var><span class="hyp-type"><b>: </b><span>list transition_item</span></span></span><br><span><var>te1, te2</var><span class="hyp-type"><b>: </b><span>transition_item</span></span></span><br><span><var>Htr</var><span class="hyp-type"><b>: </b><span>finite_valid_trace_from s tr</span></span></span><br><span><var>Heq</var><span class="hyp-type"><b>: </b><span>tr = tr1 ++ [te1] ++ [te2] ++ tr2</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">input_valid_transition (l te2)
  (destination te1, input te2)
  (destination te2, output te2)</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">      </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="VLSM-v-chk154" style="display: none" type="checkbox"><label class="alectryon-input" for="VLSM-v-chk154"><span class="nb">rewrite</span> app_assoc <span class="kr">in</span> Heq.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>message</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>X</var><span class="hyp-type"><b>: </b><span>VLSM message</span></span></span><br><span><var>TypeX</var><span><span class="hyp-body"><b>:= </b><span>type X</span></span><span class="hyp-type"><b>: </b><span>VLSMType message</span></span></span></span><br><span><var>MachineX</var><span><span class="hyp-body"><b>:= </b><span>machine X</span></span><span class="hyp-type"><b>: </b><span>VLSMMachine (vtype X)</span></span></span></span><br><span><var>s</var><span class="hyp-type"><b>: </b><span>state</span></span></span><br><span><var>tr, tr1, tr2</var><span class="hyp-type"><b>: </b><span>list transition_item</span></span></span><br><span><var>te1, te2</var><span class="hyp-type"><b>: </b><span>transition_item</span></span></span><br><span><var>Htr</var><span class="hyp-type"><b>: </b><span>finite_valid_trace_from s tr</span></span></span><br><span><var>Heq</var><span class="hyp-type"><b>: </b><span>tr = (tr1 ++ [te1]) ++ [te2] ++ tr2</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">input_valid_transition (l te2)
  (destination te1, input te2)
  (destination te2, output te2)</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">      </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="VLSM-v-chk155" style="display: none" type="checkbox"><label class="alectryon-input" for="VLSM-v-chk155"><span class="nb">specialize</span> (input_valid_transition_to s tr (tr1 ++ [te1]) tr2 te2 Htr Heq)
        <span class="kr">as</span> Ht.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>message</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>X</var><span class="hyp-type"><b>: </b><span>VLSM message</span></span></span><br><span><var>TypeX</var><span><span class="hyp-body"><b>:= </b><span>type X</span></span><span class="hyp-type"><b>: </b><span>VLSMType message</span></span></span></span><br><span><var>MachineX</var><span><span class="hyp-body"><b>:= </b><span>machine X</span></span><span class="hyp-type"><b>: </b><span>VLSMMachine (vtype X)</span></span></span></span><br><span><var>s</var><span class="hyp-type"><b>: </b><span>state</span></span></span><br><span><var>tr, tr1, tr2</var><span class="hyp-type"><b>: </b><span>list transition_item</span></span></span><br><span><var>te1, te2</var><span class="hyp-type"><b>: </b><span>transition_item</span></span></span><br><span><var>Htr</var><span class="hyp-type"><b>: </b><span>finite_valid_trace_from s tr</span></span></span><br><span><var>Heq</var><span class="hyp-type"><b>: </b><span>tr = (tr1 ++ [te1]) ++ [te2] ++ tr2</span></span></span><br><span><var>Ht</var><span class="hyp-type"><b>: </b><span><span class="kr">let</span> <span class="nv">lst1</span> := finite_trace_last s (tr1 ++ [te1]) <span class="kr">in</span>
input_valid_transition 
  (l te2) (lst1, input te2)
  (destination te2, output te2)</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">input_valid_transition (l te2)
  (destination te1, input te2)
  (destination te2, output te2)</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">      </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="VLSM-v-chk156" style="display: none" type="checkbox"><label class="alectryon-input" for="VLSM-v-chk156"><span class="nb">rewrite</span> finite_trace_last_is_last <span class="kr">in</span> Ht.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>message</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>X</var><span class="hyp-type"><b>: </b><span>VLSM message</span></span></span><br><span><var>TypeX</var><span><span class="hyp-body"><b>:= </b><span>type X</span></span><span class="hyp-type"><b>: </b><span>VLSMType message</span></span></span></span><br><span><var>MachineX</var><span><span class="hyp-body"><b>:= </b><span>machine X</span></span><span class="hyp-type"><b>: </b><span>VLSMMachine (vtype X)</span></span></span></span><br><span><var>s</var><span class="hyp-type"><b>: </b><span>state</span></span></span><br><span><var>tr, tr1, tr2</var><span class="hyp-type"><b>: </b><span>list transition_item</span></span></span><br><span><var>te1, te2</var><span class="hyp-type"><b>: </b><span>transition_item</span></span></span><br><span><var>Htr</var><span class="hyp-type"><b>: </b><span>finite_valid_trace_from s tr</span></span></span><br><span><var>Heq</var><span class="hyp-type"><b>: </b><span>tr = (tr1 ++ [te1]) ++ [te2] ++ tr2</span></span></span><br><span><var>Ht</var><span class="hyp-type"><b>: </b><span><span class="kr">let</span> <span class="nv">lst1</span> := destination te1 <span class="kr">in</span>
input_valid_transition 
  (l te2) (lst1, input te2)
  (destination te2, output te2)</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">input_valid_transition (l te2)
  (destination te1, input te2)
  (destination te2, output te2)</div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="bp">assumption</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Qed</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">

</span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="VLSM-v-chk157" style="display: none" type="checkbox"><label class="alectryon-input" for="VLSM-v-chk157"><span class="kn">Lemma</span> <span class="nf">valid_trace_output_is_valid</span>
      (<span class="nv">is</span> : state)
      (<span class="nv">tr</span> : list transition_item)
      (<span class="nv">Htr</span> : finite_valid_trace_from <span class="kr">is</span> tr)
      (<span class="nv">m</span> : message)
      (<span class="nv">Houtput</span> : trace_has_message (field_selector output) m tr)
      : valid_message_prop m.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>message</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>X</var><span class="hyp-type"><b>: </b><span>VLSM message</span></span></span><br><span><var>TypeX</var><span><span class="hyp-body"><b>:= </b><span>type X</span></span><span class="hyp-type"><b>: </b><span>VLSMType message</span></span></span></span><br><span><var>MachineX</var><span><span class="hyp-body"><b>:= </b><span>machine X</span></span><span class="hyp-type"><b>: </b><span>VLSMMachine (vtype X)</span></span></span></span><br><span><var>is</var><span class="hyp-type"><b>: </b><span>state</span></span></span><br><span><var>tr</var><span class="hyp-type"><b>: </b><span>list transition_item</span></span></span><br><span><var>Htr</var><span class="hyp-type"><b>: </b><span>finite_valid_trace_from <span class="kr">is</span> tr</span></span></span><br><span><var>m</var><span class="hyp-type"><b>: </b><span>message</span></span></span><br><span><var>Houtput</var><span class="hyp-type"><b>: </b><span>trace_has_message (field_selector output) m
  tr</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">valid_message_prop m</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="VLSM-v-chk158" style="display: none" type="checkbox"><label class="alectryon-input" for="VLSM-v-chk158"><span class="kn">Proof</span>.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>message</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>X</var><span class="hyp-type"><b>: </b><span>VLSM message</span></span></span><br><span><var>TypeX</var><span><span class="hyp-body"><b>:= </b><span>type X</span></span><span class="hyp-type"><b>: </b><span>VLSMType message</span></span></span></span><br><span><var>MachineX</var><span><span class="hyp-body"><b>:= </b><span>machine X</span></span><span class="hyp-type"><b>: </b><span>VLSMMachine (vtype X)</span></span></span></span><br><span><var>is</var><span class="hyp-type"><b>: </b><span>state</span></span></span><br><span><var>tr</var><span class="hyp-type"><b>: </b><span>list transition_item</span></span></span><br><span><var>Htr</var><span class="hyp-type"><b>: </b><span>finite_valid_trace_from <span class="kr">is</span> tr</span></span></span><br><span><var>m</var><span class="hyp-type"><b>: </b><span>message</span></span></span><br><span><var>Houtput</var><span class="hyp-type"><b>: </b><span>trace_has_message (field_selector output) m
  tr</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">valid_message_prop m</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">      </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="VLSM-v-chk159" style="display: none" type="checkbox"><label class="alectryon-input" for="VLSM-v-chk159"><span class="nb">revert</span> <span class="kr">is</span> Htr.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>message</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>X</var><span class="hyp-type"><b>: </b><span>VLSM message</span></span></span><br><span><var>TypeX</var><span><span class="hyp-body"><b>:= </b><span>type X</span></span><span class="hyp-type"><b>: </b><span>VLSMType message</span></span></span></span><br><span><var>MachineX</var><span><span class="hyp-body"><b>:= </b><span>machine X</span></span><span class="hyp-type"><b>: </b><span>VLSMMachine (vtype X)</span></span></span></span><br><span><var>tr</var><span class="hyp-type"><b>: </b><span>list transition_item</span></span></span><br><span><var>m</var><span class="hyp-type"><b>: </b><span>message</span></span></span><br><span><var>Houtput</var><span class="hyp-type"><b>: </b><span>trace_has_message (field_selector output) m
  tr</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="kr">‚àÄ</span> <span class="nv">is</span> : state,
  finite_valid_trace_from <span class="kr">is</span> tr ‚Üí valid_message_prop m</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">      </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="VLSM-v-chk15a" style="display: none" type="checkbox"><label class="alectryon-input" for="VLSM-v-chk15a"><span class="nb">induction</span> Houtput <span class="kr">as</span> [item tr&#39; Hm| item tr&#39;];<span class="nb">intros</span>;<span class="nb">inversion</span> Htr; <span class="nb">subst</span>.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>message</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>X</var><span class="hyp-type"><b>: </b><span>VLSM message</span></span></span><br><span><var>TypeX</var><span><span class="hyp-body"><b>:= </b><span>type X</span></span><span class="hyp-type"><b>: </b><span>VLSMType message</span></span></span></span><br><span><var>MachineX</var><span><span class="hyp-body"><b>:= </b><span>machine X</span></span><span class="hyp-type"><b>: </b><span>VLSMMachine (vtype X)</span></span></span></span><br><span><var>m</var><span class="hyp-type"><b>: </b><span>message</span></span></span><br><span><var>tr'</var><span class="hyp-type"><b>: </b><span>list transition_item</span></span></span><br><span><var>s</var><span class="hyp-type"><b>: </b><span>state</span></span></span><br><span><var>iom, oom</var><span class="hyp-type"><b>: </b><span>option message</span></span></span><br><span><var>l0</var><span class="hyp-type"><b>: </b><span>label</span></span></span><br><span><var>Hm</var><span class="hyp-type"><b>: </b><span>field_selector output m
  {|
    l := l0;
    input := iom;
    destination := s;
    output := oom
  |}</span></span></span><br><span><var>is</var><span class="hyp-type"><b>: </b><span>state</span></span></span><br><span><var>Htr</var><span class="hyp-type"><b>: </b><span>finite_valid_trace_from <span class="kr">is</span>
  ({|
     l := l0;
     input := iom;
     destination := s;
     output := oom
   |} :: tr&#39;)</span></span></span><br><span><var>Htl</var><span class="hyp-type"><b>: </b><span>finite_valid_trace_from s tr&#39;</span></span></span><br><span><var>Ht</var><span class="hyp-type"><b>: </b><span>input_valid_transition l0 (<span class="kr">is</span>, iom) (s, oom)</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">valid_message_prop m</div></blockquote><div class="alectryon-extra-goals"><input class="alectryon-extra-goal-toggle" id="VLSM-v-chk15b" style="display: none" type="checkbox"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>message</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>X</var><span class="hyp-type"><b>: </b><span>VLSM message</span></span></span><br><span><var>TypeX</var><span><span class="hyp-body"><b>:= </b><span>type X</span></span><span class="hyp-type"><b>: </b><span>VLSMType message</span></span></span></span><br><span><var>MachineX</var><span><span class="hyp-body"><b>:= </b><span>machine X</span></span><span class="hyp-type"><b>: </b><span>VLSMMachine (vtype X)</span></span></span></span><br><span><var>m</var><span class="hyp-type"><b>: </b><span>message</span></span></span><br><span><var>tr'</var><span class="hyp-type"><b>: </b><span>list transition_item</span></span></span><br><span><var>Houtput</var><span class="hyp-type"><b>: </b><span>List.Exists (field_selector output m) tr&#39;</span></span></span><br><span><var>IHHoutput</var><span class="hyp-type"><b>: </b><span><span class="kr">‚àÄ</span> <span class="nv">is</span> : state,
  finite_valid_trace_from <span class="kr">is</span> tr&#39;
  ‚Üí valid_message_prop m</span></span></span><br><span><var>is, s</var><span class="hyp-type"><b>: </b><span>state</span></span></span><br><span><var>iom, oom</var><span class="hyp-type"><b>: </b><span>option message</span></span></span><br><span><var>l0</var><span class="hyp-type"><b>: </b><span>label</span></span></span><br><span><var>Htr</var><span class="hyp-type"><b>: </b><span>finite_valid_trace_from <span class="kr">is</span>
  ({|
     l := l0;
     input := iom;
     destination := s;
     output := oom
   |} :: tr&#39;)</span></span></span><br><span><var>Htl</var><span class="hyp-type"><b>: </b><span>finite_valid_trace_from s tr&#39;</span></span></span><br><span><var>Ht</var><span class="hyp-type"><b>: </b><span>input_valid_transition l0 (<span class="kr">is</span>, iom) (s, oom)</span></span></span><br></div><label class="goal-separator" for="VLSM-v-chk15b"><hr></label><div class="goal-conclusion">valid_message_prop m</div></blockquote></div></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">      </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="VLSM-v-chk15c" style="display: none" type="checkbox"><label class="alectryon-input" for="VLSM-v-chk15c">-</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>message</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>X</var><span class="hyp-type"><b>: </b><span>VLSM message</span></span></span><br><span><var>TypeX</var><span><span class="hyp-body"><b>:= </b><span>type X</span></span><span class="hyp-type"><b>: </b><span>VLSMType message</span></span></span></span><br><span><var>MachineX</var><span><span class="hyp-body"><b>:= </b><span>machine X</span></span><span class="hyp-type"><b>: </b><span>VLSMMachine (vtype X)</span></span></span></span><br><span><var>m</var><span class="hyp-type"><b>: </b><span>message</span></span></span><br><span><var>tr'</var><span class="hyp-type"><b>: </b><span>list transition_item</span></span></span><br><span><var>s</var><span class="hyp-type"><b>: </b><span>state</span></span></span><br><span><var>iom, oom</var><span class="hyp-type"><b>: </b><span>option message</span></span></span><br><span><var>l0</var><span class="hyp-type"><b>: </b><span>label</span></span></span><br><span><var>Hm</var><span class="hyp-type"><b>: </b><span>field_selector output m
  {|
    l := l0;
    input := iom;
    destination := s;
    output := oom
  |}</span></span></span><br><span><var>is</var><span class="hyp-type"><b>: </b><span>state</span></span></span><br><span><var>Htr</var><span class="hyp-type"><b>: </b><span>finite_valid_trace_from <span class="kr">is</span>
  ({|
     l := l0;
     input := iom;
     destination := s;
     output := oom
   |} :: tr&#39;)</span></span></span><br><span><var>Htl</var><span class="hyp-type"><b>: </b><span>finite_valid_trace_from s tr&#39;</span></span></span><br><span><var>Ht</var><span class="hyp-type"><b>: </b><span>input_valid_transition l0 (<span class="kr">is</span>, iom) (s, oom)</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">valid_message_prop m</div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="VLSM-v-chk15d" style="display: none" type="checkbox"><label class="alectryon-input" for="VLSM-v-chk15d"><span class="nb">simpl</span> <span class="kr">in</span> Hm.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>message</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>X</var><span class="hyp-type"><b>: </b><span>VLSM message</span></span></span><br><span><var>TypeX</var><span><span class="hyp-body"><b>:= </b><span>type X</span></span><span class="hyp-type"><b>: </b><span>VLSMType message</span></span></span></span><br><span><var>MachineX</var><span><span class="hyp-body"><b>:= </b><span>machine X</span></span><span class="hyp-type"><b>: </b><span>VLSMMachine (vtype X)</span></span></span></span><br><span><var>m</var><span class="hyp-type"><b>: </b><span>message</span></span></span><br><span><var>tr'</var><span class="hyp-type"><b>: </b><span>list transition_item</span></span></span><br><span><var>s</var><span class="hyp-type"><b>: </b><span>state</span></span></span><br><span><var>iom, oom</var><span class="hyp-type"><b>: </b><span>option message</span></span></span><br><span><var>l0</var><span class="hyp-type"><b>: </b><span>label</span></span></span><br><span><var>Hm</var><span class="hyp-type"><b>: </b><span>oom = Some m</span></span></span><br><span><var>is</var><span class="hyp-type"><b>: </b><span>state</span></span></span><br><span><var>Htr</var><span class="hyp-type"><b>: </b><span>finite_valid_trace_from <span class="kr">is</span>
  ({|
     l := l0;
     input := iom;
     destination := s;
     output := oom
   |} :: tr&#39;)</span></span></span><br><span><var>Htl</var><span class="hyp-type"><b>: </b><span>finite_valid_trace_from s tr&#39;</span></span></span><br><span><var>Ht</var><span class="hyp-type"><b>: </b><span>input_valid_transition l0 (<span class="kr">is</span>, iom) (s, oom)</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">valid_message_prop m</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">        </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="VLSM-v-chk15e" style="display: none" type="checkbox"><label class="alectryon-input" for="VLSM-v-chk15e"><span class="nb">subst</span>.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>message</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>X</var><span class="hyp-type"><b>: </b><span>VLSM message</span></span></span><br><span><var>TypeX</var><span><span class="hyp-body"><b>:= </b><span>type X</span></span><span class="hyp-type"><b>: </b><span>VLSMType message</span></span></span></span><br><span><var>MachineX</var><span><span class="hyp-body"><b>:= </b><span>machine X</span></span><span class="hyp-type"><b>: </b><span>VLSMMachine (vtype X)</span></span></span></span><br><span><var>m</var><span class="hyp-type"><b>: </b><span>message</span></span></span><br><span><var>tr'</var><span class="hyp-type"><b>: </b><span>list transition_item</span></span></span><br><span><var>s</var><span class="hyp-type"><b>: </b><span>state</span></span></span><br><span><var>iom</var><span class="hyp-type"><b>: </b><span>option message</span></span></span><br><span><var>l0</var><span class="hyp-type"><b>: </b><span>label</span></span></span><br><span><var>is</var><span class="hyp-type"><b>: </b><span>state</span></span></span><br><span><var>Htr</var><span class="hyp-type"><b>: </b><span>finite_valid_trace_from <span class="kr">is</span>
  ({|
     l := l0;
     input := iom;
     destination := s;
     output := Some m
   |} :: tr&#39;)</span></span></span><br><span><var>Htl</var><span class="hyp-type"><b>: </b><span>finite_valid_trace_from s tr&#39;</span></span></span><br><span><var>Ht</var><span class="hyp-type"><b>: </b><span>input_valid_transition l0 (<span class="kr">is</span>, iom) (s, Some m)</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">valid_message_prop m</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">        </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="VLSM-v-chk15f" style="display: none" type="checkbox"><label class="alectryon-input" for="VLSM-v-chk15f"><span class="nb">apply</span> input_valid_transition_out <span class="kr">in</span> Ht.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>message</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>X</var><span class="hyp-type"><b>: </b><span>VLSM message</span></span></span><br><span><var>TypeX</var><span><span class="hyp-body"><b>:= </b><span>type X</span></span><span class="hyp-type"><b>: </b><span>VLSMType message</span></span></span></span><br><span><var>MachineX</var><span><span class="hyp-body"><b>:= </b><span>machine X</span></span><span class="hyp-type"><b>: </b><span>VLSMMachine (vtype X)</span></span></span></span><br><span><var>m</var><span class="hyp-type"><b>: </b><span>message</span></span></span><br><span><var>tr'</var><span class="hyp-type"><b>: </b><span>list transition_item</span></span></span><br><span><var>s</var><span class="hyp-type"><b>: </b><span>state</span></span></span><br><span><var>iom</var><span class="hyp-type"><b>: </b><span>option message</span></span></span><br><span><var>l0</var><span class="hyp-type"><b>: </b><span>label</span></span></span><br><span><var>is</var><span class="hyp-type"><b>: </b><span>state</span></span></span><br><span><var>Htr</var><span class="hyp-type"><b>: </b><span>finite_valid_trace_from <span class="kr">is</span>
  ({|
     l := l0;
     input := iom;
     destination := s;
     output := Some m
   |} :: tr&#39;)</span></span></span><br><span><var>Htl</var><span class="hyp-type"><b>: </b><span>finite_valid_trace_from s tr&#39;</span></span></span><br><span><var>Ht</var><span class="hyp-type"><b>: </b><span>option_valid_message_prop (Some m)</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">valid_message_prop m</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">        </span><span class="alectryon-sentence"><span class="alectryon-input"><span class="bp">assumption</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">      </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="VLSM-v-chk160" style="display: none" type="checkbox"><label class="alectryon-input" for="VLSM-v-chk160">-</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>message</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>X</var><span class="hyp-type"><b>: </b><span>VLSM message</span></span></span><br><span><var>TypeX</var><span><span class="hyp-body"><b>:= </b><span>type X</span></span><span class="hyp-type"><b>: </b><span>VLSMType message</span></span></span></span><br><span><var>MachineX</var><span><span class="hyp-body"><b>:= </b><span>machine X</span></span><span class="hyp-type"><b>: </b><span>VLSMMachine (vtype X)</span></span></span></span><br><span><var>m</var><span class="hyp-type"><b>: </b><span>message</span></span></span><br><span><var>tr'</var><span class="hyp-type"><b>: </b><span>list transition_item</span></span></span><br><span><var>Houtput</var><span class="hyp-type"><b>: </b><span>List.Exists (field_selector output m) tr&#39;</span></span></span><br><span><var>IHHoutput</var><span class="hyp-type"><b>: </b><span><span class="kr">‚àÄ</span> <span class="nv">is</span> : state,
  finite_valid_trace_from <span class="kr">is</span> tr&#39;
  ‚Üí valid_message_prop m</span></span></span><br><span><var>is, s</var><span class="hyp-type"><b>: </b><span>state</span></span></span><br><span><var>iom, oom</var><span class="hyp-type"><b>: </b><span>option message</span></span></span><br><span><var>l0</var><span class="hyp-type"><b>: </b><span>label</span></span></span><br><span><var>Htr</var><span class="hyp-type"><b>: </b><span>finite_valid_trace_from <span class="kr">is</span>
  ({|
     l := l0;
     input := iom;
     destination := s;
     output := oom
   |} :: tr&#39;)</span></span></span><br><span><var>Htl</var><span class="hyp-type"><b>: </b><span>finite_valid_trace_from s tr&#39;</span></span></span><br><span><var>Ht</var><span class="hyp-type"><b>: </b><span>input_valid_transition l0 (<span class="kr">is</span>, iom) (s, oom)</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">valid_message_prop m</div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="VLSM-v-chk161" style="display: none" type="checkbox"><label class="alectryon-input" for="VLSM-v-chk161"><span class="nb">apply</span> (IHHoutput s).</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>message</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>X</var><span class="hyp-type"><b>: </b><span>VLSM message</span></span></span><br><span><var>TypeX</var><span><span class="hyp-body"><b>:= </b><span>type X</span></span><span class="hyp-type"><b>: </b><span>VLSMType message</span></span></span></span><br><span><var>MachineX</var><span><span class="hyp-body"><b>:= </b><span>machine X</span></span><span class="hyp-type"><b>: </b><span>VLSMMachine (vtype X)</span></span></span></span><br><span><var>m</var><span class="hyp-type"><b>: </b><span>message</span></span></span><br><span><var>tr'</var><span class="hyp-type"><b>: </b><span>list transition_item</span></span></span><br><span><var>Houtput</var><span class="hyp-type"><b>: </b><span>List.Exists (field_selector output m) tr&#39;</span></span></span><br><span><var>IHHoutput</var><span class="hyp-type"><b>: </b><span><span class="kr">‚àÄ</span> <span class="nv">is</span> : state,
  finite_valid_trace_from <span class="kr">is</span> tr&#39;
  ‚Üí valid_message_prop m</span></span></span><br><span><var>is, s</var><span class="hyp-type"><b>: </b><span>state</span></span></span><br><span><var>iom, oom</var><span class="hyp-type"><b>: </b><span>option message</span></span></span><br><span><var>l0</var><span class="hyp-type"><b>: </b><span>label</span></span></span><br><span><var>Htr</var><span class="hyp-type"><b>: </b><span>finite_valid_trace_from <span class="kr">is</span>
  ({|
     l := l0;
     input := iom;
     destination := s;
     output := oom
   |} :: tr&#39;)</span></span></span><br><span><var>Htl</var><span class="hyp-type"><b>: </b><span>finite_valid_trace_from s tr&#39;</span></span></span><br><span><var>Ht</var><span class="hyp-type"><b>: </b><span>input_valid_transition l0 (<span class="kr">is</span>, iom) (s, oom)</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">finite_valid_trace_from s tr&#39;</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">        </span><span class="alectryon-sentence"><span class="alectryon-input"><span class="bp">assumption</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Qed</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
</span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="VLSM-v-chk162" style="display: none" type="checkbox"><label class="alectryon-input" for="VLSM-v-chk162"><span class="kn">Lemma</span> <span class="nf">valid_trace_input_is_valid</span>
      (<span class="nv">is</span> : state)
      (<span class="nv">tr</span> : list transition_item)
      (<span class="nv">Htr</span> : finite_valid_trace_from <span class="kr">is</span> tr)
      (<span class="nv">m</span> : message)
      (<span class="nv">Hinput</span> : trace_has_message (field_selector input) m tr)
      : valid_message_prop m.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>message</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>X</var><span class="hyp-type"><b>: </b><span>VLSM message</span></span></span><br><span><var>TypeX</var><span><span class="hyp-body"><b>:= </b><span>type X</span></span><span class="hyp-type"><b>: </b><span>VLSMType message</span></span></span></span><br><span><var>MachineX</var><span><span class="hyp-body"><b>:= </b><span>machine X</span></span><span class="hyp-type"><b>: </b><span>VLSMMachine (vtype X)</span></span></span></span><br><span><var>is</var><span class="hyp-type"><b>: </b><span>state</span></span></span><br><span><var>tr</var><span class="hyp-type"><b>: </b><span>list transition_item</span></span></span><br><span><var>Htr</var><span class="hyp-type"><b>: </b><span>finite_valid_trace_from <span class="kr">is</span> tr</span></span></span><br><span><var>m</var><span class="hyp-type"><b>: </b><span>message</span></span></span><br><span><var>Hinput</var><span class="hyp-type"><b>: </b><span>trace_has_message (field_selector input) m tr</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">valid_message_prop m</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="VLSM-v-chk163" style="display: none" type="checkbox"><label class="alectryon-input" for="VLSM-v-chk163"><span class="kn">Proof</span>.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>message</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>X</var><span class="hyp-type"><b>: </b><span>VLSM message</span></span></span><br><span><var>TypeX</var><span><span class="hyp-body"><b>:= </b><span>type X</span></span><span class="hyp-type"><b>: </b><span>VLSMType message</span></span></span></span><br><span><var>MachineX</var><span><span class="hyp-body"><b>:= </b><span>machine X</span></span><span class="hyp-type"><b>: </b><span>VLSMMachine (vtype X)</span></span></span></span><br><span><var>is</var><span class="hyp-type"><b>: </b><span>state</span></span></span><br><span><var>tr</var><span class="hyp-type"><b>: </b><span>list transition_item</span></span></span><br><span><var>Htr</var><span class="hyp-type"><b>: </b><span>finite_valid_trace_from <span class="kr">is</span> tr</span></span></span><br><span><var>m</var><span class="hyp-type"><b>: </b><span>message</span></span></span><br><span><var>Hinput</var><span class="hyp-type"><b>: </b><span>trace_has_message (field_selector input) m tr</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">valid_message_prop m</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">      </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="VLSM-v-chk164" style="display: none" type="checkbox"><label class="alectryon-input" for="VLSM-v-chk164"><span class="nb">revert</span> <span class="kr">is</span> Htr.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>message</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>X</var><span class="hyp-type"><b>: </b><span>VLSM message</span></span></span><br><span><var>TypeX</var><span><span class="hyp-body"><b>:= </b><span>type X</span></span><span class="hyp-type"><b>: </b><span>VLSMType message</span></span></span></span><br><span><var>MachineX</var><span><span class="hyp-body"><b>:= </b><span>machine X</span></span><span class="hyp-type"><b>: </b><span>VLSMMachine (vtype X)</span></span></span></span><br><span><var>tr</var><span class="hyp-type"><b>: </b><span>list transition_item</span></span></span><br><span><var>m</var><span class="hyp-type"><b>: </b><span>message</span></span></span><br><span><var>Hinput</var><span class="hyp-type"><b>: </b><span>trace_has_message (field_selector input) m tr</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="kr">‚àÄ</span> <span class="nv">is</span> : state,
  finite_valid_trace_from <span class="kr">is</span> tr ‚Üí valid_message_prop m</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">      </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="VLSM-v-chk165" style="display: none" type="checkbox"><label class="alectryon-input" for="VLSM-v-chk165"><span class="nb">induction</span> Hinput <span class="kr">as</span> [item tr&#39; Hm| item tr&#39;];<span class="nb">intros</span>
      ;<span class="nb">inversion</span> Htr <span class="kr">as</span> [|s _tr&#39;  Htr&#39; _is iom oom l Ht ];<span class="nb">subst</span>.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>message</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>X</var><span class="hyp-type"><b>: </b><span>VLSM message</span></span></span><br><span><var>TypeX</var><span><span class="hyp-body"><b>:= </b><span>type X</span></span><span class="hyp-type"><b>: </b><span>VLSMType message</span></span></span></span><br><span><var>MachineX</var><span><span class="hyp-body"><b>:= </b><span>machine X</span></span><span class="hyp-type"><b>: </b><span>VLSMMachine (vtype X)</span></span></span></span><br><span><var>m</var><span class="hyp-type"><b>: </b><span>message</span></span></span><br><span><var>tr'</var><span class="hyp-type"><b>: </b><span>list transition_item</span></span></span><br><span><var>s</var><span class="hyp-type"><b>: </b><span>state</span></span></span><br><span><var>iom, oom</var><span class="hyp-type"><b>: </b><span>option message</span></span></span><br><span><var>l</var><span class="hyp-type"><b>: </b><span>label</span></span></span><br><span><var>Hm</var><span class="hyp-type"><b>: </b><span>field_selector input m
  {|
    l := l;
    input := iom;
    destination := s;
    output := oom
  |}</span></span></span><br><span><var>is</var><span class="hyp-type"><b>: </b><span>state</span></span></span><br><span><var>Htr</var><span class="hyp-type"><b>: </b><span>finite_valid_trace_from <span class="kr">is</span>
  ({|
     l := l;
     input := iom;
     destination := s;
     output := oom
   |} :: tr&#39;)</span></span></span><br><span><var>Htr'</var><span class="hyp-type"><b>: </b><span>finite_valid_trace_from s tr&#39;</span></span></span><br><span><var>Ht</var><span class="hyp-type"><b>: </b><span>input_valid_transition l (<span class="kr">is</span>, iom) (s, oom)</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">valid_message_prop m</div></blockquote><div class="alectryon-extra-goals"><input class="alectryon-extra-goal-toggle" id="VLSM-v-chk166" style="display: none" type="checkbox"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>message</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>X</var><span class="hyp-type"><b>: </b><span>VLSM message</span></span></span><br><span><var>TypeX</var><span><span class="hyp-body"><b>:= </b><span>type X</span></span><span class="hyp-type"><b>: </b><span>VLSMType message</span></span></span></span><br><span><var>MachineX</var><span><span class="hyp-body"><b>:= </b><span>machine X</span></span><span class="hyp-type"><b>: </b><span>VLSMMachine (vtype X)</span></span></span></span><br><span><var>m</var><span class="hyp-type"><b>: </b><span>message</span></span></span><br><span><var>tr'</var><span class="hyp-type"><b>: </b><span>list transition_item</span></span></span><br><span><var>Hinput</var><span class="hyp-type"><b>: </b><span>List.Exists (field_selector input m) tr&#39;</span></span></span><br><span><var>IHHinput</var><span class="hyp-type"><b>: </b><span><span class="kr">‚àÄ</span> <span class="nv">is</span> : state,
  finite_valid_trace_from <span class="kr">is</span> tr&#39;
  ‚Üí valid_message_prop m</span></span></span><br><span><var>is, s</var><span class="hyp-type"><b>: </b><span>state</span></span></span><br><span><var>iom, oom</var><span class="hyp-type"><b>: </b><span>option message</span></span></span><br><span><var>l</var><span class="hyp-type"><b>: </b><span>label</span></span></span><br><span><var>Htr</var><span class="hyp-type"><b>: </b><span>finite_valid_trace_from <span class="kr">is</span>
  ({|
     l := l;
     input := iom;
     destination := s;
     output := oom
   |} :: tr&#39;)</span></span></span><br><span><var>Htr'</var><span class="hyp-type"><b>: </b><span>finite_valid_trace_from s tr&#39;</span></span></span><br><span><var>Ht</var><span class="hyp-type"><b>: </b><span>input_valid_transition l (<span class="kr">is</span>, iom) (s, oom)</span></span></span><br></div><label class="goal-separator" for="VLSM-v-chk166"><hr></label><div class="goal-conclusion">valid_message_prop m</div></blockquote></div></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">      </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="VLSM-v-chk167" style="display: none" type="checkbox"><label class="alectryon-input" for="VLSM-v-chk167">-</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>message</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>X</var><span class="hyp-type"><b>: </b><span>VLSM message</span></span></span><br><span><var>TypeX</var><span><span class="hyp-body"><b>:= </b><span>type X</span></span><span class="hyp-type"><b>: </b><span>VLSMType message</span></span></span></span><br><span><var>MachineX</var><span><span class="hyp-body"><b>:= </b><span>machine X</span></span><span class="hyp-type"><b>: </b><span>VLSMMachine (vtype X)</span></span></span></span><br><span><var>m</var><span class="hyp-type"><b>: </b><span>message</span></span></span><br><span><var>tr'</var><span class="hyp-type"><b>: </b><span>list transition_item</span></span></span><br><span><var>s</var><span class="hyp-type"><b>: </b><span>state</span></span></span><br><span><var>iom, oom</var><span class="hyp-type"><b>: </b><span>option message</span></span></span><br><span><var>l</var><span class="hyp-type"><b>: </b><span>label</span></span></span><br><span><var>Hm</var><span class="hyp-type"><b>: </b><span>field_selector input m
  {|
    l := l;
    input := iom;
    destination := s;
    output := oom
  |}</span></span></span><br><span><var>is</var><span class="hyp-type"><b>: </b><span>state</span></span></span><br><span><var>Htr</var><span class="hyp-type"><b>: </b><span>finite_valid_trace_from <span class="kr">is</span>
  ({|
     l := l;
     input := iom;
     destination := s;
     output := oom
   |} :: tr&#39;)</span></span></span><br><span><var>Htr'</var><span class="hyp-type"><b>: </b><span>finite_valid_trace_from s tr&#39;</span></span></span><br><span><var>Ht</var><span class="hyp-type"><b>: </b><span>input_valid_transition l (<span class="kr">is</span>, iom) (s, oom)</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">valid_message_prop m</div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="VLSM-v-chk168" style="display: none" type="checkbox"><label class="alectryon-input" for="VLSM-v-chk168"><span class="nb">simpl</span> <span class="kr">in</span> Hm.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>message</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>X</var><span class="hyp-type"><b>: </b><span>VLSM message</span></span></span><br><span><var>TypeX</var><span><span class="hyp-body"><b>:= </b><span>type X</span></span><span class="hyp-type"><b>: </b><span>VLSMType message</span></span></span></span><br><span><var>MachineX</var><span><span class="hyp-body"><b>:= </b><span>machine X</span></span><span class="hyp-type"><b>: </b><span>VLSMMachine (vtype X)</span></span></span></span><br><span><var>m</var><span class="hyp-type"><b>: </b><span>message</span></span></span><br><span><var>tr'</var><span class="hyp-type"><b>: </b><span>list transition_item</span></span></span><br><span><var>s</var><span class="hyp-type"><b>: </b><span>state</span></span></span><br><span><var>iom, oom</var><span class="hyp-type"><b>: </b><span>option message</span></span></span><br><span><var>l</var><span class="hyp-type"><b>: </b><span>label</span></span></span><br><span><var>Hm</var><span class="hyp-type"><b>: </b><span>iom = Some m</span></span></span><br><span><var>is</var><span class="hyp-type"><b>: </b><span>state</span></span></span><br><span><var>Htr</var><span class="hyp-type"><b>: </b><span>finite_valid_trace_from <span class="kr">is</span>
  ({|
     l := l;
     input := iom;
     destination := s;
     output := oom
   |} :: tr&#39;)</span></span></span><br><span><var>Htr'</var><span class="hyp-type"><b>: </b><span>finite_valid_trace_from s tr&#39;</span></span></span><br><span><var>Ht</var><span class="hyp-type"><b>: </b><span>input_valid_transition l (<span class="kr">is</span>, iom) (s, oom)</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">valid_message_prop m</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">        </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="VLSM-v-chk169" style="display: none" type="checkbox"><label class="alectryon-input" for="VLSM-v-chk169"><span class="nb">subst</span>.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>message</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>X</var><span class="hyp-type"><b>: </b><span>VLSM message</span></span></span><br><span><var>TypeX</var><span><span class="hyp-body"><b>:= </b><span>type X</span></span><span class="hyp-type"><b>: </b><span>VLSMType message</span></span></span></span><br><span><var>MachineX</var><span><span class="hyp-body"><b>:= </b><span>machine X</span></span><span class="hyp-type"><b>: </b><span>VLSMMachine (vtype X)</span></span></span></span><br><span><var>m</var><span class="hyp-type"><b>: </b><span>message</span></span></span><br><span><var>tr'</var><span class="hyp-type"><b>: </b><span>list transition_item</span></span></span><br><span><var>s</var><span class="hyp-type"><b>: </b><span>state</span></span></span><br><span><var>oom</var><span class="hyp-type"><b>: </b><span>option message</span></span></span><br><span><var>l</var><span class="hyp-type"><b>: </b><span>label</span></span></span><br><span><var>is</var><span class="hyp-type"><b>: </b><span>state</span></span></span><br><span><var>Htr</var><span class="hyp-type"><b>: </b><span>finite_valid_trace_from <span class="kr">is</span>
  ({|
     l := l;
     input := Some m;
     destination := s;
     output := oom
   |} :: tr&#39;)</span></span></span><br><span><var>Htr'</var><span class="hyp-type"><b>: </b><span>finite_valid_trace_from s tr&#39;</span></span></span><br><span><var>Ht</var><span class="hyp-type"><b>: </b><span>input_valid_transition l (<span class="kr">is</span>, Some m) (s, oom)</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">valid_message_prop m</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">        </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="VLSM-v-chk16a" style="display: none" type="checkbox"><label class="alectryon-input" for="VLSM-v-chk16a"><span class="nb">apply</span> input_valid_transition_in <span class="kr">in</span> Ht.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>message</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>X</var><span class="hyp-type"><b>: </b><span>VLSM message</span></span></span><br><span><var>TypeX</var><span><span class="hyp-body"><b>:= </b><span>type X</span></span><span class="hyp-type"><b>: </b><span>VLSMType message</span></span></span></span><br><span><var>MachineX</var><span><span class="hyp-body"><b>:= </b><span>machine X</span></span><span class="hyp-type"><b>: </b><span>VLSMMachine (vtype X)</span></span></span></span><br><span><var>m</var><span class="hyp-type"><b>: </b><span>message</span></span></span><br><span><var>tr'</var><span class="hyp-type"><b>: </b><span>list transition_item</span></span></span><br><span><var>s</var><span class="hyp-type"><b>: </b><span>state</span></span></span><br><span><var>oom</var><span class="hyp-type"><b>: </b><span>option message</span></span></span><br><span><var>l</var><span class="hyp-type"><b>: </b><span>label</span></span></span><br><span><var>is</var><span class="hyp-type"><b>: </b><span>state</span></span></span><br><span><var>Htr</var><span class="hyp-type"><b>: </b><span>finite_valid_trace_from <span class="kr">is</span>
  ({|
     l := l;
     input := Some m;
     destination := s;
     output := oom
   |} :: tr&#39;)</span></span></span><br><span><var>Htr'</var><span class="hyp-type"><b>: </b><span>finite_valid_trace_from s tr&#39;</span></span></span><br><span><var>Ht</var><span class="hyp-type"><b>: </b><span>option_valid_message_prop (Some m)</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">valid_message_prop m</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">        </span><span class="alectryon-sentence"><span class="alectryon-input"><span class="bp">assumption</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">      </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="VLSM-v-chk16b" style="display: none" type="checkbox"><label class="alectryon-input" for="VLSM-v-chk16b">-</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>message</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>X</var><span class="hyp-type"><b>: </b><span>VLSM message</span></span></span><br><span><var>TypeX</var><span><span class="hyp-body"><b>:= </b><span>type X</span></span><span class="hyp-type"><b>: </b><span>VLSMType message</span></span></span></span><br><span><var>MachineX</var><span><span class="hyp-body"><b>:= </b><span>machine X</span></span><span class="hyp-type"><b>: </b><span>VLSMMachine (vtype X)</span></span></span></span><br><span><var>m</var><span class="hyp-type"><b>: </b><span>message</span></span></span><br><span><var>tr'</var><span class="hyp-type"><b>: </b><span>list transition_item</span></span></span><br><span><var>Hinput</var><span class="hyp-type"><b>: </b><span>List.Exists (field_selector input m) tr&#39;</span></span></span><br><span><var>IHHinput</var><span class="hyp-type"><b>: </b><span><span class="kr">‚àÄ</span> <span class="nv">is</span> : state,
  finite_valid_trace_from <span class="kr">is</span> tr&#39;
  ‚Üí valid_message_prop m</span></span></span><br><span><var>is, s</var><span class="hyp-type"><b>: </b><span>state</span></span></span><br><span><var>iom, oom</var><span class="hyp-type"><b>: </b><span>option message</span></span></span><br><span><var>l</var><span class="hyp-type"><b>: </b><span>label</span></span></span><br><span><var>Htr</var><span class="hyp-type"><b>: </b><span>finite_valid_trace_from <span class="kr">is</span>
  ({|
     l := l;
     input := iom;
     destination := s;
     output := oom
   |} :: tr&#39;)</span></span></span><br><span><var>Htr'</var><span class="hyp-type"><b>: </b><span>finite_valid_trace_from s tr&#39;</span></span></span><br><span><var>Ht</var><span class="hyp-type"><b>: </b><span>input_valid_transition l (<span class="kr">is</span>, iom) (s, oom)</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">valid_message_prop m</div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="VLSM-v-chk16c" style="display: none" type="checkbox"><label class="alectryon-input" for="VLSM-v-chk16c"><span class="nb">apply</span> (IHHinput s).</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>message</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>X</var><span class="hyp-type"><b>: </b><span>VLSM message</span></span></span><br><span><var>TypeX</var><span><span class="hyp-body"><b>:= </b><span>type X</span></span><span class="hyp-type"><b>: </b><span>VLSMType message</span></span></span></span><br><span><var>MachineX</var><span><span class="hyp-body"><b>:= </b><span>machine X</span></span><span class="hyp-type"><b>: </b><span>VLSMMachine (vtype X)</span></span></span></span><br><span><var>m</var><span class="hyp-type"><b>: </b><span>message</span></span></span><br><span><var>tr'</var><span class="hyp-type"><b>: </b><span>list transition_item</span></span></span><br><span><var>Hinput</var><span class="hyp-type"><b>: </b><span>List.Exists (field_selector input m) tr&#39;</span></span></span><br><span><var>IHHinput</var><span class="hyp-type"><b>: </b><span><span class="kr">‚àÄ</span> <span class="nv">is</span> : state,
  finite_valid_trace_from <span class="kr">is</span> tr&#39;
  ‚Üí valid_message_prop m</span></span></span><br><span><var>is, s</var><span class="hyp-type"><b>: </b><span>state</span></span></span><br><span><var>iom, oom</var><span class="hyp-type"><b>: </b><span>option message</span></span></span><br><span><var>l</var><span class="hyp-type"><b>: </b><span>label</span></span></span><br><span><var>Htr</var><span class="hyp-type"><b>: </b><span>finite_valid_trace_from <span class="kr">is</span>
  ({|
     l := l;
     input := iom;
     destination := s;
     output := oom
   |} :: tr&#39;)</span></span></span><br><span><var>Htr'</var><span class="hyp-type"><b>: </b><span>finite_valid_trace_from s tr&#39;</span></span></span><br><span><var>Ht</var><span class="hyp-type"><b>: </b><span>input_valid_transition l (<span class="kr">is</span>, iom) (s, oom)</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">finite_valid_trace_from s tr&#39;</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">        </span><span class="alectryon-sentence"><span class="alectryon-input"><span class="bp">assumption</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Qed</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
</span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="VLSM-v-chk16d" style="display: none" type="checkbox"><label class="alectryon-input" for="VLSM-v-chk16d"><span class="kn">Lemma</span> <span class="nf">valid_trace_observed_is_valid</span>
      (<span class="nv">is</span> : state)
      (<span class="nv">tr</span> : list transition_item)
      (<span class="nv">Htr</span> : finite_valid_trace_from <span class="kr">is</span> tr)
      (<span class="nv">m</span> : message)
      (<span class="nv">Hobserved</span> : trace_has_message item_sends_or_receives m tr)
      : valid_message_prop m.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>message</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>X</var><span class="hyp-type"><b>: </b><span>VLSM message</span></span></span><br><span><var>TypeX</var><span><span class="hyp-body"><b>:= </b><span>type X</span></span><span class="hyp-type"><b>: </b><span>VLSMType message</span></span></span></span><br><span><var>MachineX</var><span><span class="hyp-body"><b>:= </b><span>machine X</span></span><span class="hyp-type"><b>: </b><span>VLSMMachine (vtype X)</span></span></span></span><br><span><var>is</var><span class="hyp-type"><b>: </b><span>state</span></span></span><br><span><var>tr</var><span class="hyp-type"><b>: </b><span>list transition_item</span></span></span><br><span><var>Htr</var><span class="hyp-type"><b>: </b><span>finite_valid_trace_from <span class="kr">is</span> tr</span></span></span><br><span><var>m</var><span class="hyp-type"><b>: </b><span>message</span></span></span><br><span><var>Hobserved</var><span class="hyp-type"><b>: </b><span>trace_has_message item_sends_or_receives m
  tr</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">valid_message_prop m</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="VLSM-v-chk16e" style="display: none" type="checkbox"><label class="alectryon-input" for="VLSM-v-chk16e"><span class="kn">Proof</span>.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>message</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>X</var><span class="hyp-type"><b>: </b><span>VLSM message</span></span></span><br><span><var>TypeX</var><span><span class="hyp-body"><b>:= </b><span>type X</span></span><span class="hyp-type"><b>: </b><span>VLSMType message</span></span></span></span><br><span><var>MachineX</var><span><span class="hyp-body"><b>:= </b><span>machine X</span></span><span class="hyp-type"><b>: </b><span>VLSMMachine (vtype X)</span></span></span></span><br><span><var>is</var><span class="hyp-type"><b>: </b><span>state</span></span></span><br><span><var>tr</var><span class="hyp-type"><b>: </b><span>list transition_item</span></span></span><br><span><var>Htr</var><span class="hyp-type"><b>: </b><span>finite_valid_trace_from <span class="kr">is</span> tr</span></span></span><br><span><var>m</var><span class="hyp-type"><b>: </b><span>message</span></span></span><br><span><var>Hobserved</var><span class="hyp-type"><b>: </b><span>trace_has_message item_sends_or_receives m
  tr</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">valid_message_prop m</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">      </span><span class="alectryon-sentence"><span class="alectryon-input"><span class="nb">apply</span> trace_has_message_observed_iff <span class="kr">in</span> Hobserved <span class="kr">as</span> [Hm |Hm]
      ; <span class="nb">revert</span> Htr m Hm; [<span class="nb">apply</span> valid_trace_input_is_valid | <span class="nb">apply</span> valid_trace_output_is_valid].</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Qed</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
</span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="VLSM-v-chk16f" style="display: none" type="checkbox"><label class="alectryon-input" for="VLSM-v-chk16f"><span class="kn">Lemma</span> <span class="nf">first_transition_valid</span>
      (<span class="nv">s</span> : state)
      (<span class="nv">te</span> : transition_item)
      : finite_valid_trace_from s [te] &lt;-&gt; input_valid_transition (l te) (s, input te) (destination te, output te).</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>message</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>X</var><span class="hyp-type"><b>: </b><span>VLSM message</span></span></span><br><span><var>TypeX</var><span><span class="hyp-body"><b>:= </b><span>type X</span></span><span class="hyp-type"><b>: </b><span>VLSMType message</span></span></span></span><br><span><var>MachineX</var><span><span class="hyp-body"><b>:= </b><span>machine X</span></span><span class="hyp-type"><b>: </b><span>VLSMMachine (vtype X)</span></span></span></span><br><span><var>s</var><span class="hyp-type"><b>: </b><span>state</span></span></span><br><span><var>te</var><span class="hyp-type"><b>: </b><span>transition_item</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">finite_valid_trace_from s [te]
‚Üî input_valid_transition (l te) (s, input te)
    (destination te, output te)</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
</span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="VLSM-v-chk170" style="display: none" type="checkbox"><label class="alectryon-input" for="VLSM-v-chk170"><span class="kn">Proof</span>.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>message</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>X</var><span class="hyp-type"><b>: </b><span>VLSM message</span></span></span><br><span><var>TypeX</var><span><span class="hyp-body"><b>:= </b><span>type X</span></span><span class="hyp-type"><b>: </b><span>VLSMType message</span></span></span></span><br><span><var>MachineX</var><span><span class="hyp-body"><b>:= </b><span>machine X</span></span><span class="hyp-type"><b>: </b><span>VLSMMachine (vtype X)</span></span></span></span><br><span><var>s</var><span class="hyp-type"><b>: </b><span>state</span></span></span><br><span><var>te</var><span class="hyp-type"><b>: </b><span>transition_item</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">finite_valid_trace_from s [te]
‚Üî input_valid_transition (l te) (s, input te)
    (destination te, output te)</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">      </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="VLSM-v-chk171" style="display: none" type="checkbox"><label class="alectryon-input" for="VLSM-v-chk171"><span class="nb">split</span>.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>message</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>X</var><span class="hyp-type"><b>: </b><span>VLSM message</span></span></span><br><span><var>TypeX</var><span><span class="hyp-body"><b>:= </b><span>type X</span></span><span class="hyp-type"><b>: </b><span>VLSMType message</span></span></span></span><br><span><var>MachineX</var><span><span class="hyp-body"><b>:= </b><span>machine X</span></span><span class="hyp-type"><b>: </b><span>VLSMMachine (vtype X)</span></span></span></span><br><span><var>s</var><span class="hyp-type"><b>: </b><span>state</span></span></span><br><span><var>te</var><span class="hyp-type"><b>: </b><span>transition_item</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">finite_valid_trace_from s [te]
‚Üí input_valid_transition (l te) (s, input te)
    (destination te, output te)</div></blockquote><div class="alectryon-extra-goals"><input class="alectryon-extra-goal-toggle" id="VLSM-v-chk172" style="display: none" type="checkbox"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>message</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>X</var><span class="hyp-type"><b>: </b><span>VLSM message</span></span></span><br><span><var>TypeX</var><span><span class="hyp-body"><b>:= </b><span>type X</span></span><span class="hyp-type"><b>: </b><span>VLSMType message</span></span></span></span><br><span><var>MachineX</var><span><span class="hyp-body"><b>:= </b><span>machine X</span></span><span class="hyp-type"><b>: </b><span>VLSMMachine (vtype X)</span></span></span></span><br><span><var>s</var><span class="hyp-type"><b>: </b><span>state</span></span></span><br><span><var>te</var><span class="hyp-type"><b>: </b><span>transition_item</span></span></span><br></div><label class="goal-separator" for="VLSM-v-chk172"><hr></label><div class="goal-conclusion">input_valid_transition 
  (l te) (s, input te) 
  (destination te, output te)
‚Üí finite_valid_trace_from s [te]</div></blockquote></div></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">      </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="VLSM-v-chk173" style="display: none" type="checkbox"><label class="alectryon-input" for="VLSM-v-chk173">-</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>message</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>X</var><span class="hyp-type"><b>: </b><span>VLSM message</span></span></span><br><span><var>TypeX</var><span><span class="hyp-body"><b>:= </b><span>type X</span></span><span class="hyp-type"><b>: </b><span>VLSMType message</span></span></span></span><br><span><var>MachineX</var><span><span class="hyp-body"><b>:= </b><span>machine X</span></span><span class="hyp-type"><b>: </b><span>VLSMMachine (vtype X)</span></span></span></span><br><span><var>s</var><span class="hyp-type"><b>: </b><span>state</span></span></span><br><span><var>te</var><span class="hyp-type"><b>: </b><span>transition_item</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">finite_valid_trace_from s [te]
‚Üí input_valid_transition (l te) (s, input te)
    (destination te, output te)</div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="VLSM-v-chk174" style="display: none" type="checkbox"><label class="alectryon-input" for="VLSM-v-chk174"><span class="nb">intro</span> Htr.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>message</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>X</var><span class="hyp-type"><b>: </b><span>VLSM message</span></span></span><br><span><var>TypeX</var><span><span class="hyp-body"><b>:= </b><span>type X</span></span><span class="hyp-type"><b>: </b><span>VLSMType message</span></span></span></span><br><span><var>MachineX</var><span><span class="hyp-body"><b>:= </b><span>machine X</span></span><span class="hyp-type"><b>: </b><span>VLSMMachine (vtype X)</span></span></span></span><br><span><var>s</var><span class="hyp-type"><b>: </b><span>state</span></span></span><br><span><var>te</var><span class="hyp-type"><b>: </b><span>transition_item</span></span></span><br><span><var>Htr</var><span class="hyp-type"><b>: </b><span>finite_valid_trace_from s [te]</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">input_valid_transition (l te) (s, input te)
  (destination te, output te)</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">        </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="VLSM-v-chk175" style="display: none" type="checkbox"><label class="alectryon-input" for="VLSM-v-chk175"><span class="nb">inversion</span> Htr.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>message</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>X</var><span class="hyp-type"><b>: </b><span>VLSM message</span></span></span><br><span><var>TypeX</var><span><span class="hyp-body"><b>:= </b><span>type X</span></span><span class="hyp-type"><b>: </b><span>VLSMType message</span></span></span></span><br><span><var>MachineX</var><span><span class="hyp-body"><b>:= </b><span>machine X</span></span><span class="hyp-type"><b>: </b><span>VLSMMachine (vtype X)</span></span></span></span><br><span><var>s</var><span class="hyp-type"><b>: </b><span>state</span></span></span><br><span><var>te</var><span class="hyp-type"><b>: </b><span>transition_item</span></span></span><br><span><var>Htr</var><span class="hyp-type"><b>: </b><span>finite_valid_trace_from s [te]</span></span></span><br><span><var>s1</var><span class="hyp-type"><b>: </b><span>state</span></span></span><br><span><var>tl</var><span class="hyp-type"><b>: </b><span>list transition_item</span></span></span><br><span><var>s'</var><span class="hyp-type"><b>: </b><span>state</span></span></span><br><span><var>iom, oom</var><span class="hyp-type"><b>: </b><span>option message</span></span></span><br><span><var>l0</var><span class="hyp-type"><b>: </b><span>label</span></span></span><br><span><var>Htl</var><span class="hyp-type"><b>: </b><span>finite_valid_trace_from s1 []</span></span></span><br><span><var>Ht</var><span class="hyp-type"><b>: </b><span>input_valid_transition l0 (s, iom) (s1, oom)</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>s&#39; = s</span></span></span><br><span><var>H1</var><span class="hyp-type"><b>: </b><span>{|
  l := l0;
  input := iom;
  destination := s1;
  output := oom
|} = te</span></span></span><br><span><var>H2</var><span class="hyp-type"><b>: </b><span>tl = []</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">input_valid_transition
  (l
     {|
       l := l0;
       input := iom;
       destination := s1;
       output := oom
     |})
  (s,
  input
    {|
      l := l0;
      input := iom;
      destination := s1;
      output := oom
    |})
  (destination
     {|
       l := l0;
       input := iom;
       destination := s1;
       output := oom
     |},
  output
    {|
      l := l0;
      input := iom;
      destination := s1;
      output := oom
    |})</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">        </span><span class="alectryon-sentence"><span class="alectryon-input"><span class="bp">assumption</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">      </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="VLSM-v-chk176" style="display: none" type="checkbox"><label class="alectryon-input" for="VLSM-v-chk176">-</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>message</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>X</var><span class="hyp-type"><b>: </b><span>VLSM message</span></span></span><br><span><var>TypeX</var><span><span class="hyp-body"><b>:= </b><span>type X</span></span><span class="hyp-type"><b>: </b><span>VLSMType message</span></span></span></span><br><span><var>MachineX</var><span><span class="hyp-body"><b>:= </b><span>machine X</span></span><span class="hyp-type"><b>: </b><span>VLSMMachine (vtype X)</span></span></span></span><br><span><var>s</var><span class="hyp-type"><b>: </b><span>state</span></span></span><br><span><var>te</var><span class="hyp-type"><b>: </b><span>transition_item</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">input_valid_transition (l te) (s, input te)
  (destination te, output te)
‚Üí finite_valid_trace_from s [te]</div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="VLSM-v-chk177" style="display: none" type="checkbox"><label class="alectryon-input" for="VLSM-v-chk177"><span class="nb">destruct</span> te.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>message</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>X</var><span class="hyp-type"><b>: </b><span>VLSM message</span></span></span><br><span><var>TypeX</var><span><span class="hyp-body"><b>:= </b><span>type X</span></span><span class="hyp-type"><b>: </b><span>VLSMType message</span></span></span></span><br><span><var>MachineX</var><span><span class="hyp-body"><b>:= </b><span>machine X</span></span><span class="hyp-type"><b>: </b><span>VLSMMachine (vtype X)</span></span></span></span><br><span><var>s</var><span class="hyp-type"><b>: </b><span>state</span></span></span><br><span><var>l0</var><span class="hyp-type"><b>: </b><span>label</span></span></span><br><span><var>input0</var><span class="hyp-type"><b>: </b><span>option message</span></span></span><br><span><var>destination0</var><span class="hyp-type"><b>: </b><span>state</span></span></span><br><span><var>output0</var><span class="hyp-type"><b>: </b><span>option message</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">input_valid_transition
  (l
     {|
       l := l0;
       input := input0;
       destination := destination0;
       output := output0
     |})
  (s,
  input
    {|
      l := l0;
      input := input0;
      destination := destination0;
      output := output0
    |})
  (destination
     {|
       l := l0;
       input := input0;
       destination := destination0;
       output := output0
     |},
  output
    {|
      l := l0;
      input := input0;
      destination := destination0;
      output := output0
    |})
‚Üí finite_valid_trace_from s
    [{|
       l := l0;
       input := input0;
       destination := destination0;
       output := output0
     |}]</div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="VLSM-v-chk178" style="display: none" type="checkbox"><label class="alectryon-input" for="VLSM-v-chk178"><span class="nb">simpl</span>.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>message</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>X</var><span class="hyp-type"><b>: </b><span>VLSM message</span></span></span><br><span><var>TypeX</var><span><span class="hyp-body"><b>:= </b><span>type X</span></span><span class="hyp-type"><b>: </b><span>VLSMType message</span></span></span></span><br><span><var>MachineX</var><span><span class="hyp-body"><b>:= </b><span>machine X</span></span><span class="hyp-type"><b>: </b><span>VLSMMachine (vtype X)</span></span></span></span><br><span><var>s</var><span class="hyp-type"><b>: </b><span>state</span></span></span><br><span><var>l0</var><span class="hyp-type"><b>: </b><span>label</span></span></span><br><span><var>input0</var><span class="hyp-type"><b>: </b><span>option message</span></span></span><br><span><var>destination0</var><span class="hyp-type"><b>: </b><span>state</span></span></span><br><span><var>output0</var><span class="hyp-type"><b>: </b><span>option message</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">input_valid_transition l0 (s, input0)
  (destination0, output0)
‚Üí finite_valid_trace_from s
    [{|
       l := l0;
       input := input0;
       destination := destination0;
       output := output0
     |}]</div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="VLSM-v-chk179" style="display: none" type="checkbox"><label class="alectryon-input" for="VLSM-v-chk179"><span class="nb">intro</span> Ht.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>message</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>X</var><span class="hyp-type"><b>: </b><span>VLSM message</span></span></span><br><span><var>TypeX</var><span><span class="hyp-body"><b>:= </b><span>type X</span></span><span class="hyp-type"><b>: </b><span>VLSMType message</span></span></span></span><br><span><var>MachineX</var><span><span class="hyp-body"><b>:= </b><span>machine X</span></span><span class="hyp-type"><b>: </b><span>VLSMMachine (vtype X)</span></span></span></span><br><span><var>s</var><span class="hyp-type"><b>: </b><span>state</span></span></span><br><span><var>l0</var><span class="hyp-type"><b>: </b><span>label</span></span></span><br><span><var>input0</var><span class="hyp-type"><b>: </b><span>option message</span></span></span><br><span><var>destination0</var><span class="hyp-type"><b>: </b><span>state</span></span></span><br><span><var>output0</var><span class="hyp-type"><b>: </b><span>option message</span></span></span><br><span><var>Ht</var><span class="hyp-type"><b>: </b><span>input_valid_transition l0 
  (s, input0) (destination0, output0)</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">finite_valid_trace_from s
  [{|
     l := l0;
     input := input0;
     destination := destination0;
     output := output0
   |}]</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">        </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="VLSM-v-chk17a" style="display: none" type="checkbox"><label class="alectryon-input" for="VLSM-v-chk17a"><span class="nb">apply</span> input_valid_transition_destination <span class="kr">in</span> Ht <span class="kr">as</span> Hdestination0.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>message</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>X</var><span class="hyp-type"><b>: </b><span>VLSM message</span></span></span><br><span><var>TypeX</var><span><span class="hyp-body"><b>:= </b><span>type X</span></span><span class="hyp-type"><b>: </b><span>VLSMType message</span></span></span></span><br><span><var>MachineX</var><span><span class="hyp-body"><b>:= </b><span>machine X</span></span><span class="hyp-type"><b>: </b><span>VLSMMachine (vtype X)</span></span></span></span><br><span><var>s</var><span class="hyp-type"><b>: </b><span>state</span></span></span><br><span><var>l0</var><span class="hyp-type"><b>: </b><span>label</span></span></span><br><span><var>input0</var><span class="hyp-type"><b>: </b><span>option message</span></span></span><br><span><var>destination0</var><span class="hyp-type"><b>: </b><span>state</span></span></span><br><span><var>output0</var><span class="hyp-type"><b>: </b><span>option message</span></span></span><br><span><var>Ht</var><span class="hyp-type"><b>: </b><span>input_valid_transition l0 
  (s, input0) (destination0, output0)</span></span></span><br><span><var>Hdestination0</var><span class="hyp-type"><b>: </b><span>valid_state_prop destination0</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">finite_valid_trace_from s
  [{|
     l := l0;
     input := input0;
     destination := destination0;
     output := output0
   |}]</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">        </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="VLSM-v-chk17b" style="display: none" type="checkbox"><label class="alectryon-input" for="VLSM-v-chk17b"><span class="nb">constructor</span>; [|<span class="bp">assumption</span>].</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>message</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>X</var><span class="hyp-type"><b>: </b><span>VLSM message</span></span></span><br><span><var>TypeX</var><span><span class="hyp-body"><b>:= </b><span>type X</span></span><span class="hyp-type"><b>: </b><span>VLSMType message</span></span></span></span><br><span><var>MachineX</var><span><span class="hyp-body"><b>:= </b><span>machine X</span></span><span class="hyp-type"><b>: </b><span>VLSMMachine (vtype X)</span></span></span></span><br><span><var>s</var><span class="hyp-type"><b>: </b><span>state</span></span></span><br><span><var>l0</var><span class="hyp-type"><b>: </b><span>label</span></span></span><br><span><var>input0</var><span class="hyp-type"><b>: </b><span>option message</span></span></span><br><span><var>destination0</var><span class="hyp-type"><b>: </b><span>state</span></span></span><br><span><var>output0</var><span class="hyp-type"><b>: </b><span>option message</span></span></span><br><span><var>Ht</var><span class="hyp-type"><b>: </b><span>input_valid_transition l0 
  (s, input0) (destination0, output0)</span></span></span><br><span><var>Hdestination0</var><span class="hyp-type"><b>: </b><span>valid_state_prop destination0</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">finite_valid_trace_from destination0 []</div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="VLSM-v-chk17c" style="display: none" type="checkbox"><label class="alectryon-input" for="VLSM-v-chk17c"><span class="nb">constructor</span>.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>message</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>X</var><span class="hyp-type"><b>: </b><span>VLSM message</span></span></span><br><span><var>TypeX</var><span><span class="hyp-body"><b>:= </b><span>type X</span></span><span class="hyp-type"><b>: </b><span>VLSMType message</span></span></span></span><br><span><var>MachineX</var><span><span class="hyp-body"><b>:= </b><span>machine X</span></span><span class="hyp-type"><b>: </b><span>VLSMMachine (vtype X)</span></span></span></span><br><span><var>s</var><span class="hyp-type"><b>: </b><span>state</span></span></span><br><span><var>l0</var><span class="hyp-type"><b>: </b><span>label</span></span></span><br><span><var>input0</var><span class="hyp-type"><b>: </b><span>option message</span></span></span><br><span><var>destination0</var><span class="hyp-type"><b>: </b><span>state</span></span></span><br><span><var>output0</var><span class="hyp-type"><b>: </b><span>option message</span></span></span><br><span><var>Ht</var><span class="hyp-type"><b>: </b><span>input_valid_transition l0 
  (s, input0) (destination0, output0)</span></span></span><br><span><var>Hdestination0</var><span class="hyp-type"><b>: </b><span>valid_state_prop destination0</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">valid_state_prop destination0</div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="bp">assumption</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Qed</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
</span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="VLSM-v-chk17d" style="display: none" type="checkbox"><label class="alectryon-input" for="VLSM-v-chk17d"><span class="kn">Lemma</span> <span class="nf">extend_right_finite_trace_from</span>
      (<span class="nv">s1</span> : state)
      (<span class="nv">ts</span> : list transition_item)
      (<span class="nv">Ht12</span> : finite_valid_trace_from s1 ts)
      (<span class="nv">l3</span> : label)
      (<span class="nv">s2</span> := finite_trace_last s1 ts)
      (<span class="nv">iom3</span> : option message)
      (<span class="nv">s3</span> : state)
      (<span class="nv">oom3</span> : option message)
      (<span class="nv">Hv23</span> : input_valid_transition l3 (s2, iom3) (s3, oom3))
      : finite_valid_trace_from s1 (ts ++ [{| l := l3; destination := s3; input := iom3; output := oom3 |}]).</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>message</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>X</var><span class="hyp-type"><b>: </b><span>VLSM message</span></span></span><br><span><var>TypeX</var><span><span class="hyp-body"><b>:= </b><span>type X</span></span><span class="hyp-type"><b>: </b><span>VLSMType message</span></span></span></span><br><span><var>MachineX</var><span><span class="hyp-body"><b>:= </b><span>machine X</span></span><span class="hyp-type"><b>: </b><span>VLSMMachine (vtype X)</span></span></span></span><br><span><var>s1</var><span class="hyp-type"><b>: </b><span>state</span></span></span><br><span><var>ts</var><span class="hyp-type"><b>: </b><span>list transition_item</span></span></span><br><span><var>Ht12</var><span class="hyp-type"><b>: </b><span>finite_valid_trace_from s1 ts</span></span></span><br><span><var>l3</var><span class="hyp-type"><b>: </b><span>label</span></span></span><br><span><var>s2</var><span><span class="hyp-body"><b>:= </b><span>finite_trace_last s1 ts</span></span><span class="hyp-type"><b>: </b><span>state</span></span></span></span><br><span><var>iom3</var><span class="hyp-type"><b>: </b><span>option message</span></span></span><br><span><var>s3</var><span class="hyp-type"><b>: </b><span>state</span></span></span><br><span><var>oom3</var><span class="hyp-type"><b>: </b><span>option message</span></span></span><br><span><var>Hv23</var><span class="hyp-type"><b>: </b><span>input_valid_transition l3 (s2, iom3) (s3, oom3)</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">finite_valid_trace_from s1
  (ts ++
   [{|
      l := l3;
      input := iom3;
      destination := s3;
      output := oom3
    |}])</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="VLSM-v-chk17e" style="display: none" type="checkbox"><label class="alectryon-input" for="VLSM-v-chk17e"><span class="kn">Proof</span>.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>message</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>X</var><span class="hyp-type"><b>: </b><span>VLSM message</span></span></span><br><span><var>TypeX</var><span><span class="hyp-body"><b>:= </b><span>type X</span></span><span class="hyp-type"><b>: </b><span>VLSMType message</span></span></span></span><br><span><var>MachineX</var><span><span class="hyp-body"><b>:= </b><span>machine X</span></span><span class="hyp-type"><b>: </b><span>VLSMMachine (vtype X)</span></span></span></span><br><span><var>s1</var><span class="hyp-type"><b>: </b><span>state</span></span></span><br><span><var>ts</var><span class="hyp-type"><b>: </b><span>list transition_item</span></span></span><br><span><var>Ht12</var><span class="hyp-type"><b>: </b><span>finite_valid_trace_from s1 ts</span></span></span><br><span><var>l3</var><span class="hyp-type"><b>: </b><span>label</span></span></span><br><span><var>s2</var><span><span class="hyp-body"><b>:= </b><span>finite_trace_last s1 ts</span></span><span class="hyp-type"><b>: </b><span>state</span></span></span></span><br><span><var>iom3</var><span class="hyp-type"><b>: </b><span>option message</span></span></span><br><span><var>s3</var><span class="hyp-type"><b>: </b><span>state</span></span></span><br><span><var>oom3</var><span class="hyp-type"><b>: </b><span>option message</span></span></span><br><span><var>Hv23</var><span class="hyp-type"><b>: </b><span>input_valid_transition l3 (s2, iom3) (s3, oom3)</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">finite_valid_trace_from s1
  (ts ++
   [{|
      l := l3;
      input := iom3;
      destination := s3;
      output := oom3
    |}])</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">      </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="VLSM-v-chk17f" style="display: none" type="checkbox"><label class="alectryon-input" for="VLSM-v-chk17f"><span class="nb">induction</span> Ht12.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>message</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>X</var><span class="hyp-type"><b>: </b><span>VLSM message</span></span></span><br><span><var>TypeX</var><span><span class="hyp-body"><b>:= </b><span>type X</span></span><span class="hyp-type"><b>: </b><span>VLSMType message</span></span></span></span><br><span><var>MachineX</var><span><span class="hyp-body"><b>:= </b><span>machine X</span></span><span class="hyp-type"><b>: </b><span>VLSMMachine (vtype X)</span></span></span></span><br><span><var>s</var><span class="hyp-type"><b>: </b><span>state</span></span></span><br><span><var>Hs</var><span class="hyp-type"><b>: </b><span>valid_state_prop s</span></span></span><br><span><var>l3</var><span class="hyp-type"><b>: </b><span>label</span></span></span><br><span><var>s2</var><span><span class="hyp-body"><b>:= </b><span>finite_trace_last s []</span></span><span class="hyp-type"><b>: </b><span>state</span></span></span></span><br><span><var>iom3</var><span class="hyp-type"><b>: </b><span>option message</span></span></span><br><span><var>s3</var><span class="hyp-type"><b>: </b><span>state</span></span></span><br><span><var>oom3</var><span class="hyp-type"><b>: </b><span>option message</span></span></span><br><span><var>Hv23</var><span class="hyp-type"><b>: </b><span>input_valid_transition l3 (s2, iom3) (s3, oom3)</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">finite_valid_trace_from s
  ([] ++
   [{|
      l := l3;
      input := iom3;
      destination := s3;
      output := oom3
    |}])</div></blockquote><div class="alectryon-extra-goals"><input class="alectryon-extra-goal-toggle" id="VLSM-v-chk180" style="display: none" type="checkbox"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>message</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>X</var><span class="hyp-type"><b>: </b><span>VLSM message</span></span></span><br><span><var>TypeX</var><span><span class="hyp-body"><b>:= </b><span>type X</span></span><span class="hyp-type"><b>: </b><span>VLSMType message</span></span></span></span><br><span><var>MachineX</var><span><span class="hyp-body"><b>:= </b><span>machine X</span></span><span class="hyp-type"><b>: </b><span>VLSMMachine (vtype X)</span></span></span></span><br><span><var>s</var><span class="hyp-type"><b>: </b><span>state</span></span></span><br><span><var>tl</var><span class="hyp-type"><b>: </b><span>list transition_item</span></span></span><br><span><var>Ht12</var><span class="hyp-type"><b>: </b><span>finite_valid_trace_from s tl</span></span></span><br><span><var>s'</var><span class="hyp-type"><b>: </b><span>state</span></span></span><br><span><var>iom, oom</var><span class="hyp-type"><b>: </b><span>option message</span></span></span><br><span><var>l0</var><span class="hyp-type"><b>: </b><span>label</span></span></span><br><span><var>Ht</var><span class="hyp-type"><b>: </b><span>input_valid_transition l0 (s&#39;, iom) (s, oom)</span></span></span><br><span><var>l3</var><span class="hyp-type"><b>: </b><span>label</span></span></span><br><span><var>s2</var><span><span class="hyp-body"><b>:= </b><span>finite_trace_last s&#39;
  ({|
     l := l0;
     input := iom;
     destination := s;
     output := oom
   |} :: tl)</span></span><span class="hyp-type"><b>: </b><span>state</span></span></span></span><br><span><var>iom3</var><span class="hyp-type"><b>: </b><span>option message</span></span></span><br><span><var>s3</var><span class="hyp-type"><b>: </b><span>state</span></span></span><br><span><var>oom3</var><span class="hyp-type"><b>: </b><span>option message</span></span></span><br><span><var>Hv23</var><span class="hyp-type"><b>: </b><span>input_valid_transition l3 (s2, iom3) (s3, oom3)</span></span></span><br><span><var>IHHt12</var><span class="hyp-type"><b>: </b><span><span class="kr">let</span> <span class="nv">s2</span> := finite_trace_last s tl <span class="kr">in</span>
input_valid_transition l3 
  (s2, iom3) (s3, oom3)
‚Üí finite_valid_trace_from s
    (tl ++
     [{|
        l := l3;
        input := iom3;
        destination := s3;
        output := oom3
      |}])</span></span></span><br></div><label class="goal-separator" for="VLSM-v-chk180"><hr></label><div class="goal-conclusion">finite_valid_trace_from s&#39;
  (({|
      l := l0;
      input := iom;
      destination := s;
      output := oom
    |} :: tl) ++
   [{|
      l := l3;
      input := iom3;
      destination := s3;
      output := oom3
    |}])</div></blockquote></div></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">      </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="VLSM-v-chk181" style="display: none" type="checkbox"><label class="alectryon-input" for="VLSM-v-chk181">-</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>message</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>X</var><span class="hyp-type"><b>: </b><span>VLSM message</span></span></span><br><span><var>TypeX</var><span><span class="hyp-body"><b>:= </b><span>type X</span></span><span class="hyp-type"><b>: </b><span>VLSMType message</span></span></span></span><br><span><var>MachineX</var><span><span class="hyp-body"><b>:= </b><span>machine X</span></span><span class="hyp-type"><b>: </b><span>VLSMMachine (vtype X)</span></span></span></span><br><span><var>s</var><span class="hyp-type"><b>: </b><span>state</span></span></span><br><span><var>Hs</var><span class="hyp-type"><b>: </b><span>valid_state_prop s</span></span></span><br><span><var>l3</var><span class="hyp-type"><b>: </b><span>label</span></span></span><br><span><var>s2</var><span><span class="hyp-body"><b>:= </b><span>finite_trace_last s []</span></span><span class="hyp-type"><b>: </b><span>state</span></span></span></span><br><span><var>iom3</var><span class="hyp-type"><b>: </b><span>option message</span></span></span><br><span><var>s3</var><span class="hyp-type"><b>: </b><span>state</span></span></span><br><span><var>oom3</var><span class="hyp-type"><b>: </b><span>option message</span></span></span><br><span><var>Hv23</var><span class="hyp-type"><b>: </b><span>input_valid_transition l3 (s2, iom3) (s3, oom3)</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">finite_valid_trace_from s
  ([] ++
   [{|
      l := l3;
      input := iom3;
      destination := s3;
      output := oom3
    |}])</div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="VLSM-v-chk182" style="display: none" type="checkbox"><label class="alectryon-input" for="VLSM-v-chk182"><span class="nb">simpl</span>.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>message</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>X</var><span class="hyp-type"><b>: </b><span>VLSM message</span></span></span><br><span><var>TypeX</var><span><span class="hyp-body"><b>:= </b><span>type X</span></span><span class="hyp-type"><b>: </b><span>VLSMType message</span></span></span></span><br><span><var>MachineX</var><span><span class="hyp-body"><b>:= </b><span>machine X</span></span><span class="hyp-type"><b>: </b><span>VLSMMachine (vtype X)</span></span></span></span><br><span><var>s</var><span class="hyp-type"><b>: </b><span>state</span></span></span><br><span><var>Hs</var><span class="hyp-type"><b>: </b><span>valid_state_prop s</span></span></span><br><span><var>l3</var><span class="hyp-type"><b>: </b><span>label</span></span></span><br><span><var>s2</var><span><span class="hyp-body"><b>:= </b><span>finite_trace_last s []</span></span><span class="hyp-type"><b>: </b><span>state</span></span></span></span><br><span><var>iom3</var><span class="hyp-type"><b>: </b><span>option message</span></span></span><br><span><var>s3</var><span class="hyp-type"><b>: </b><span>state</span></span></span><br><span><var>oom3</var><span class="hyp-type"><b>: </b><span>option message</span></span></span><br><span><var>Hv23</var><span class="hyp-type"><b>: </b><span>input_valid_transition l3 (s2, iom3) (s3, oom3)</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">finite_valid_trace_from s
  [{|
     l := l3;
     input := iom3;
     destination := s3;
     output := oom3
   |}]</div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="nb">apply</span> finite_valid_trace_singleton;<span class="bp">assumption</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">      </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="VLSM-v-chk183" style="display: none" type="checkbox"><label class="alectryon-input" for="VLSM-v-chk183">-</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>message</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>X</var><span class="hyp-type"><b>: </b><span>VLSM message</span></span></span><br><span><var>TypeX</var><span><span class="hyp-body"><b>:= </b><span>type X</span></span><span class="hyp-type"><b>: </b><span>VLSMType message</span></span></span></span><br><span><var>MachineX</var><span><span class="hyp-body"><b>:= </b><span>machine X</span></span><span class="hyp-type"><b>: </b><span>VLSMMachine (vtype X)</span></span></span></span><br><span><var>s</var><span class="hyp-type"><b>: </b><span>state</span></span></span><br><span><var>tl</var><span class="hyp-type"><b>: </b><span>list transition_item</span></span></span><br><span><var>Ht12</var><span class="hyp-type"><b>: </b><span>finite_valid_trace_from s tl</span></span></span><br><span><var>s'</var><span class="hyp-type"><b>: </b><span>state</span></span></span><br><span><var>iom, oom</var><span class="hyp-type"><b>: </b><span>option message</span></span></span><br><span><var>l0</var><span class="hyp-type"><b>: </b><span>label</span></span></span><br><span><var>Ht</var><span class="hyp-type"><b>: </b><span>input_valid_transition l0 (s&#39;, iom) (s, oom)</span></span></span><br><span><var>l3</var><span class="hyp-type"><b>: </b><span>label</span></span></span><br><span><var>s2</var><span><span class="hyp-body"><b>:= </b><span>finite_trace_last s&#39;
  ({|
     l := l0;
     input := iom;
     destination := s;
     output := oom
   |} :: tl)</span></span><span class="hyp-type"><b>: </b><span>state</span></span></span></span><br><span><var>iom3</var><span class="hyp-type"><b>: </b><span>option message</span></span></span><br><span><var>s3</var><span class="hyp-type"><b>: </b><span>state</span></span></span><br><span><var>oom3</var><span class="hyp-type"><b>: </b><span>option message</span></span></span><br><span><var>Hv23</var><span class="hyp-type"><b>: </b><span>input_valid_transition l3 (s2, iom3) (s3, oom3)</span></span></span><br><span><var>IHHt12</var><span class="hyp-type"><b>: </b><span><span class="kr">let</span> <span class="nv">s2</span> := finite_trace_last s tl <span class="kr">in</span>
input_valid_transition l3 
  (s2, iom3) (s3, oom3)
‚Üí finite_valid_trace_from s
    (tl ++
     [{|
        l := l3;
        input := iom3;
        destination := s3;
        output := oom3
      |}])</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">finite_valid_trace_from s&#39;
  (({|
      l := l0;
      input := iom;
      destination := s;
      output := oom
    |} :: tl) ++
   [{|
      l := l3;
      input := iom3;
      destination := s3;
      output := oom3
    |}])</div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="VLSM-v-chk184" style="display: none" type="checkbox"><label class="alectryon-input" for="VLSM-v-chk184"><span class="nb">rewrite</span> &lt;- app_comm_cons.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>message</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>X</var><span class="hyp-type"><b>: </b><span>VLSM message</span></span></span><br><span><var>TypeX</var><span><span class="hyp-body"><b>:= </b><span>type X</span></span><span class="hyp-type"><b>: </b><span>VLSMType message</span></span></span></span><br><span><var>MachineX</var><span><span class="hyp-body"><b>:= </b><span>machine X</span></span><span class="hyp-type"><b>: </b><span>VLSMMachine (vtype X)</span></span></span></span><br><span><var>s</var><span class="hyp-type"><b>: </b><span>state</span></span></span><br><span><var>tl</var><span class="hyp-type"><b>: </b><span>list transition_item</span></span></span><br><span><var>Ht12</var><span class="hyp-type"><b>: </b><span>finite_valid_trace_from s tl</span></span></span><br><span><var>s'</var><span class="hyp-type"><b>: </b><span>state</span></span></span><br><span><var>iom, oom</var><span class="hyp-type"><b>: </b><span>option message</span></span></span><br><span><var>l0</var><span class="hyp-type"><b>: </b><span>label</span></span></span><br><span><var>Ht</var><span class="hyp-type"><b>: </b><span>input_valid_transition l0 (s&#39;, iom) (s, oom)</span></span></span><br><span><var>l3</var><span class="hyp-type"><b>: </b><span>label</span></span></span><br><span><var>s2</var><span><span class="hyp-body"><b>:= </b><span>finite_trace_last s&#39;
  ({|
     l := l0;
     input := iom;
     destination := s;
     output := oom
   |} :: tl)</span></span><span class="hyp-type"><b>: </b><span>state</span></span></span></span><br><span><var>iom3</var><span class="hyp-type"><b>: </b><span>option message</span></span></span><br><span><var>s3</var><span class="hyp-type"><b>: </b><span>state</span></span></span><br><span><var>oom3</var><span class="hyp-type"><b>: </b><span>option message</span></span></span><br><span><var>Hv23</var><span class="hyp-type"><b>: </b><span>input_valid_transition l3 (s2, iom3) (s3, oom3)</span></span></span><br><span><var>IHHt12</var><span class="hyp-type"><b>: </b><span><span class="kr">let</span> <span class="nv">s2</span> := finite_trace_last s tl <span class="kr">in</span>
input_valid_transition l3 
  (s2, iom3) (s3, oom3)
‚Üí finite_valid_trace_from s
    (tl ++
     [{|
        l := l3;
        input := iom3;
        destination := s3;
        output := oom3
      |}])</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">finite_valid_trace_from s&#39;
  ({|
     l := l0;
     input := iom;
     destination := s;
     output := oom
   |}
   :: tl ++
      [{|
         l := l3;
         input := iom3;
         destination := s3;
         output := oom3
       |}])</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">        </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="VLSM-v-chk185" style="display: none" type="checkbox"><label class="alectryon-input" for="VLSM-v-chk185"><span class="nb">apply</span> finite_valid_trace_from_extend; <span class="kp">try</span> <span class="bp">assumption</span>.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>message</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>X</var><span class="hyp-type"><b>: </b><span>VLSM message</span></span></span><br><span><var>TypeX</var><span><span class="hyp-body"><b>:= </b><span>type X</span></span><span class="hyp-type"><b>: </b><span>VLSMType message</span></span></span></span><br><span><var>MachineX</var><span><span class="hyp-body"><b>:= </b><span>machine X</span></span><span class="hyp-type"><b>: </b><span>VLSMMachine (vtype X)</span></span></span></span><br><span><var>s</var><span class="hyp-type"><b>: </b><span>state</span></span></span><br><span><var>tl</var><span class="hyp-type"><b>: </b><span>list transition_item</span></span></span><br><span><var>Ht12</var><span class="hyp-type"><b>: </b><span>finite_valid_trace_from s tl</span></span></span><br><span><var>s'</var><span class="hyp-type"><b>: </b><span>state</span></span></span><br><span><var>iom, oom</var><span class="hyp-type"><b>: </b><span>option message</span></span></span><br><span><var>l0</var><span class="hyp-type"><b>: </b><span>label</span></span></span><br><span><var>Ht</var><span class="hyp-type"><b>: </b><span>input_valid_transition l0 (s&#39;, iom) (s, oom)</span></span></span><br><span><var>l3</var><span class="hyp-type"><b>: </b><span>label</span></span></span><br><span><var>s2</var><span><span class="hyp-body"><b>:= </b><span>finite_trace_last s&#39;
  ({|
     l := l0;
     input := iom;
     destination := s;
     output := oom
   |} :: tl)</span></span><span class="hyp-type"><b>: </b><span>state</span></span></span></span><br><span><var>iom3</var><span class="hyp-type"><b>: </b><span>option message</span></span></span><br><span><var>s3</var><span class="hyp-type"><b>: </b><span>state</span></span></span><br><span><var>oom3</var><span class="hyp-type"><b>: </b><span>option message</span></span></span><br><span><var>Hv23</var><span class="hyp-type"><b>: </b><span>input_valid_transition l3 (s2, iom3) (s3, oom3)</span></span></span><br><span><var>IHHt12</var><span class="hyp-type"><b>: </b><span><span class="kr">let</span> <span class="nv">s2</span> := finite_trace_last s tl <span class="kr">in</span>
input_valid_transition l3 
  (s2, iom3) (s3, oom3)
‚Üí finite_valid_trace_from s
    (tl ++
     [{|
        l := l3;
        input := iom3;
        destination := s3;
        output := oom3
      |}])</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">finite_valid_trace_from s
  (tl ++
   [{|
      l := l3;
      input := iom3;
      destination := s3;
      output := oom3
    |}])</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">        </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="VLSM-v-chk186" style="display: none" type="checkbox"><label class="alectryon-input" for="VLSM-v-chk186"><span class="nb">simpl</span> <span class="kr">in</span> IHHt12.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>message</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>X</var><span class="hyp-type"><b>: </b><span>VLSM message</span></span></span><br><span><var>TypeX</var><span><span class="hyp-body"><b>:= </b><span>type X</span></span><span class="hyp-type"><b>: </b><span>VLSMType message</span></span></span></span><br><span><var>MachineX</var><span><span class="hyp-body"><b>:= </b><span>machine X</span></span><span class="hyp-type"><b>: </b><span>VLSMMachine (vtype X)</span></span></span></span><br><span><var>s</var><span class="hyp-type"><b>: </b><span>state</span></span></span><br><span><var>tl</var><span class="hyp-type"><b>: </b><span>list transition_item</span></span></span><br><span><var>Ht12</var><span class="hyp-type"><b>: </b><span>finite_valid_trace_from s tl</span></span></span><br><span><var>s'</var><span class="hyp-type"><b>: </b><span>state</span></span></span><br><span><var>iom, oom</var><span class="hyp-type"><b>: </b><span>option message</span></span></span><br><span><var>l0</var><span class="hyp-type"><b>: </b><span>label</span></span></span><br><span><var>Ht</var><span class="hyp-type"><b>: </b><span>input_valid_transition l0 (s&#39;, iom) (s, oom)</span></span></span><br><span><var>l3</var><span class="hyp-type"><b>: </b><span>label</span></span></span><br><span><var>s2</var><span><span class="hyp-body"><b>:= </b><span>finite_trace_last s&#39;
  ({|
     l := l0;
     input := iom;
     destination := s;
     output := oom
   |} :: tl)</span></span><span class="hyp-type"><b>: </b><span>state</span></span></span></span><br><span><var>iom3</var><span class="hyp-type"><b>: </b><span>option message</span></span></span><br><span><var>s3</var><span class="hyp-type"><b>: </b><span>state</span></span></span><br><span><var>oom3</var><span class="hyp-type"><b>: </b><span>option message</span></span></span><br><span><var>Hv23</var><span class="hyp-type"><b>: </b><span>input_valid_transition l3 (s2, iom3) (s3, oom3)</span></span></span><br><span><var>IHHt12</var><span class="hyp-type"><b>: </b><span>input_valid_transition l3
  (finite_trace_last s tl, iom3) 
  (s3, oom3)
‚Üí finite_valid_trace_from s
    (tl ++
     [{|
        l := l3;
        input := iom3;
        destination := s3;
        output := oom3
      |}])</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">finite_valid_trace_from s
  (tl ++
   [{|
      l := l3;
      input := iom3;
      destination := s3;
      output := oom3
    |}])</div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="VLSM-v-chk187" style="display: none" type="checkbox"><label class="alectryon-input" for="VLSM-v-chk187"><span class="nb">apply</span> IHHt12.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>message</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>X</var><span class="hyp-type"><b>: </b><span>VLSM message</span></span></span><br><span><var>TypeX</var><span><span class="hyp-body"><b>:= </b><span>type X</span></span><span class="hyp-type"><b>: </b><span>VLSMType message</span></span></span></span><br><span><var>MachineX</var><span><span class="hyp-body"><b>:= </b><span>machine X</span></span><span class="hyp-type"><b>: </b><span>VLSMMachine (vtype X)</span></span></span></span><br><span><var>s</var><span class="hyp-type"><b>: </b><span>state</span></span></span><br><span><var>tl</var><span class="hyp-type"><b>: </b><span>list transition_item</span></span></span><br><span><var>Ht12</var><span class="hyp-type"><b>: </b><span>finite_valid_trace_from s tl</span></span></span><br><span><var>s'</var><span class="hyp-type"><b>: </b><span>state</span></span></span><br><span><var>iom, oom</var><span class="hyp-type"><b>: </b><span>option message</span></span></span><br><span><var>l0</var><span class="hyp-type"><b>: </b><span>label</span></span></span><br><span><var>Ht</var><span class="hyp-type"><b>: </b><span>input_valid_transition l0 (s&#39;, iom) (s, oom)</span></span></span><br><span><var>l3</var><span class="hyp-type"><b>: </b><span>label</span></span></span><br><span><var>s2</var><span><span class="hyp-body"><b>:= </b><span>finite_trace_last s&#39;
  ({|
     l := l0;
     input := iom;
     destination := s;
     output := oom
   |} :: tl)</span></span><span class="hyp-type"><b>: </b><span>state</span></span></span></span><br><span><var>iom3</var><span class="hyp-type"><b>: </b><span>option message</span></span></span><br><span><var>s3</var><span class="hyp-type"><b>: </b><span>state</span></span></span><br><span><var>oom3</var><span class="hyp-type"><b>: </b><span>option message</span></span></span><br><span><var>Hv23</var><span class="hyp-type"><b>: </b><span>input_valid_transition l3 (s2, iom3) (s3, oom3)</span></span></span><br><span><var>IHHt12</var><span class="hyp-type"><b>: </b><span>input_valid_transition l3
  (finite_trace_last s tl, iom3) 
  (s3, oom3)
‚Üí finite_valid_trace_from s
    (tl ++
     [{|
        l := l3;
        input := iom3;
        destination := s3;
        output := oom3
      |}])</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">input_valid_transition l3
  (finite_trace_last s tl, iom3) (s3, oom3)</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">        </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="VLSM-v-chk188" style="display: none" type="checkbox"><label class="alectryon-input" for="VLSM-v-chk188"><span class="nb">unfold</span> s2 <span class="kr">in</span> *; <span class="nb">clear</span> s2.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>message</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>X</var><span class="hyp-type"><b>: </b><span>VLSM message</span></span></span><br><span><var>TypeX</var><span><span class="hyp-body"><b>:= </b><span>type X</span></span><span class="hyp-type"><b>: </b><span>VLSMType message</span></span></span></span><br><span><var>MachineX</var><span><span class="hyp-body"><b>:= </b><span>machine X</span></span><span class="hyp-type"><b>: </b><span>VLSMMachine (vtype X)</span></span></span></span><br><span><var>s</var><span class="hyp-type"><b>: </b><span>state</span></span></span><br><span><var>tl</var><span class="hyp-type"><b>: </b><span>list transition_item</span></span></span><br><span><var>Ht12</var><span class="hyp-type"><b>: </b><span>finite_valid_trace_from s tl</span></span></span><br><span><var>s'</var><span class="hyp-type"><b>: </b><span>state</span></span></span><br><span><var>iom, oom</var><span class="hyp-type"><b>: </b><span>option message</span></span></span><br><span><var>l0</var><span class="hyp-type"><b>: </b><span>label</span></span></span><br><span><var>Ht</var><span class="hyp-type"><b>: </b><span>input_valid_transition l0 (s&#39;, iom) (s, oom)</span></span></span><br><span><var>l3</var><span class="hyp-type"><b>: </b><span>label</span></span></span><br><span><var>iom3</var><span class="hyp-type"><b>: </b><span>option message</span></span></span><br><span><var>s3</var><span class="hyp-type"><b>: </b><span>state</span></span></span><br><span><var>oom3</var><span class="hyp-type"><b>: </b><span>option message</span></span></span><br><span><var>Hv23</var><span class="hyp-type"><b>: </b><span>input_valid_transition l3
  (finite_trace_last s&#39;
     ({|
        l := l0;
        input := iom;
        destination := s;
        output := oom
      |} :: tl), iom3) 
  (s3, oom3)</span></span></span><br><span><var>IHHt12</var><span class="hyp-type"><b>: </b><span>input_valid_transition l3
  (finite_trace_last s tl, iom3) 
  (s3, oom3)
‚Üí finite_valid_trace_from s
    (tl ++
     [{|
        l := l3;
        input := iom3;
        destination := s3;
        output := oom3
      |}])</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">input_valid_transition l3
  (finite_trace_last s tl, iom3) (s3, oom3)</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">        </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="VLSM-v-chk189" style="display: none" type="checkbox"><label class="alectryon-input" for="VLSM-v-chk189"><span class="nb">rewrite</span> finite_trace_last_cons <span class="kr">in</span> Hv23.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>message</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>X</var><span class="hyp-type"><b>: </b><span>VLSM message</span></span></span><br><span><var>TypeX</var><span><span class="hyp-body"><b>:= </b><span>type X</span></span><span class="hyp-type"><b>: </b><span>VLSMType message</span></span></span></span><br><span><var>MachineX</var><span><span class="hyp-body"><b>:= </b><span>machine X</span></span><span class="hyp-type"><b>: </b><span>VLSMMachine (vtype X)</span></span></span></span><br><span><var>s</var><span class="hyp-type"><b>: </b><span>state</span></span></span><br><span><var>tl</var><span class="hyp-type"><b>: </b><span>list transition_item</span></span></span><br><span><var>Ht12</var><span class="hyp-type"><b>: </b><span>finite_valid_trace_from s tl</span></span></span><br><span><var>s'</var><span class="hyp-type"><b>: </b><span>state</span></span></span><br><span><var>iom, oom</var><span class="hyp-type"><b>: </b><span>option message</span></span></span><br><span><var>l0</var><span class="hyp-type"><b>: </b><span>label</span></span></span><br><span><var>Ht</var><span class="hyp-type"><b>: </b><span>input_valid_transition l0 (s&#39;, iom) (s, oom)</span></span></span><br><span><var>l3</var><span class="hyp-type"><b>: </b><span>label</span></span></span><br><span><var>iom3</var><span class="hyp-type"><b>: </b><span>option message</span></span></span><br><span><var>s3</var><span class="hyp-type"><b>: </b><span>state</span></span></span><br><span><var>oom3</var><span class="hyp-type"><b>: </b><span>option message</span></span></span><br><span><var>Hv23</var><span class="hyp-type"><b>: </b><span>input_valid_transition l3
  (finite_trace_last
     (destination
        {|
          l := l0;
          input := iom;
          destination := s;
          output := oom
        |}) tl, iom3) (s3, oom3)</span></span></span><br><span><var>IHHt12</var><span class="hyp-type"><b>: </b><span>input_valid_transition l3
  (finite_trace_last s tl, iom3) 
  (s3, oom3)
‚Üí finite_valid_trace_from s
    (tl ++
     [{|
        l := l3;
        input := iom3;
        destination := s3;
        output := oom3
      |}])</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">input_valid_transition l3
  (finite_trace_last s tl, iom3) (s3, oom3)</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">        </span><span class="alectryon-sentence"><span class="alectryon-input"><span class="bp">assumption</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Qed</span>.</span></span></pre><div class="doc">
We can now prove several general properties of <span class="inlinecode"><span class="id" title="var">finite_valid_trace</span></span>s. For example,
the following lemma states that given two such traces, such that the latter's starting state
is equal to the former's last state, it is possible to <i>concatenate</i> them into a single
<span class="inlinecode"><span class="id" title="var">finite_valid_trace</span></span>.

</div><pre class="alectryon-io highlight"><!-- Generator: Alectryon --><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="VLSM-v-chk18a" style="display: none" type="checkbox"><label class="alectryon-input" for="VLSM-v-chk18a"><span class="kn">Lemma</span> <span class="nf">finite_valid_trace_from_app_iff</span> (<span class="nv">s</span> : state) (<span class="nv">ls</span> <span class="nv">ls&#39;</span> : list transition_item) (<span class="nv">s&#39;</span> := finite_trace_last s ls)
      : finite_valid_trace_from s ls /\ finite_valid_trace_from s&#39; ls&#39;
        &lt;-&gt;
        finite_valid_trace_from s (ls ++ ls&#39;).</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>message</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>X</var><span class="hyp-type"><b>: </b><span>VLSM message</span></span></span><br><span><var>TypeX</var><span><span class="hyp-body"><b>:= </b><span>type X</span></span><span class="hyp-type"><b>: </b><span>VLSMType message</span></span></span></span><br><span><var>MachineX</var><span><span class="hyp-body"><b>:= </b><span>machine X</span></span><span class="hyp-type"><b>: </b><span>VLSMMachine (vtype X)</span></span></span></span><br><span><var>s</var><span class="hyp-type"><b>: </b><span>state</span></span></span><br><span><var>ls, ls'</var><span class="hyp-type"><b>: </b><span>list transition_item</span></span></span><br><span><var>s'</var><span><span class="hyp-body"><b>:= </b><span>finite_trace_last s ls</span></span><span class="hyp-type"><b>: </b><span>state</span></span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">finite_valid_trace_from s ls
‚àß finite_valid_trace_from s&#39; ls&#39;
‚Üî finite_valid_trace_from s (ls ++ ls&#39;)</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="VLSM-v-chk18b" style="display: none" type="checkbox"><label class="alectryon-input" for="VLSM-v-chk18b"><span class="kn">Proof</span>.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>message</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>X</var><span class="hyp-type"><b>: </b><span>VLSM message</span></span></span><br><span><var>TypeX</var><span><span class="hyp-body"><b>:= </b><span>type X</span></span><span class="hyp-type"><b>: </b><span>VLSMType message</span></span></span></span><br><span><var>MachineX</var><span><span class="hyp-body"><b>:= </b><span>machine X</span></span><span class="hyp-type"><b>: </b><span>VLSMMachine (vtype X)</span></span></span></span><br><span><var>s</var><span class="hyp-type"><b>: </b><span>state</span></span></span><br><span><var>ls, ls'</var><span class="hyp-type"><b>: </b><span>list transition_item</span></span></span><br><span><var>s'</var><span><span class="hyp-body"><b>:= </b><span>finite_trace_last s ls</span></span><span class="hyp-type"><b>: </b><span>state</span></span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">finite_valid_trace_from s ls
‚àß finite_valid_trace_from s&#39; ls&#39;
‚Üî finite_valid_trace_from s (ls ++ ls&#39;)</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">      </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="VLSM-v-chk18c" style="display: none" type="checkbox"><label class="alectryon-input" for="VLSM-v-chk18c"><span class="nb">subst</span> s&#39;.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>message</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>X</var><span class="hyp-type"><b>: </b><span>VLSM message</span></span></span><br><span><var>TypeX</var><span><span class="hyp-body"><b>:= </b><span>type X</span></span><span class="hyp-type"><b>: </b><span>VLSMType message</span></span></span></span><br><span><var>MachineX</var><span><span class="hyp-body"><b>:= </b><span>machine X</span></span><span class="hyp-type"><b>: </b><span>VLSMMachine (vtype X)</span></span></span></span><br><span><var>s</var><span class="hyp-type"><b>: </b><span>state</span></span></span><br><span><var>ls, ls'</var><span class="hyp-type"><b>: </b><span>list transition_item</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">finite_valid_trace_from s ls
‚àß finite_valid_trace_from (finite_trace_last s ls) ls&#39;
‚Üî finite_valid_trace_from s (ls ++ ls&#39;)</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">      </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="VLSM-v-chk18d" style="display: none" type="checkbox"><label class="alectryon-input" for="VLSM-v-chk18d"><span class="nb">revert</span> s.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>message</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>X</var><span class="hyp-type"><b>: </b><span>VLSM message</span></span></span><br><span><var>TypeX</var><span><span class="hyp-body"><b>:= </b><span>type X</span></span><span class="hyp-type"><b>: </b><span>VLSMType message</span></span></span></span><br><span><var>MachineX</var><span><span class="hyp-body"><b>:= </b><span>machine X</span></span><span class="hyp-type"><b>: </b><span>VLSMMachine (vtype X)</span></span></span></span><br><span><var>ls, ls'</var><span class="hyp-type"><b>: </b><span>list transition_item</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="kr">‚àÄ</span> <span class="nv">s</span> : state,
  finite_valid_trace_from s ls
  ‚àß finite_valid_trace_from (finite_trace_last s ls)
      ls&#39; ‚Üî finite_valid_trace_from s (ls ++ ls&#39;)</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">      </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="VLSM-v-chk18e" style="display: none" type="checkbox"><label class="alectryon-input" for="VLSM-v-chk18e"><span class="nb">induction</span> ls;<span class="nb">intro</span> s.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>message</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>X</var><span class="hyp-type"><b>: </b><span>VLSM message</span></span></span><br><span><var>TypeX</var><span><span class="hyp-body"><b>:= </b><span>type X</span></span><span class="hyp-type"><b>: </b><span>VLSMType message</span></span></span></span><br><span><var>MachineX</var><span><span class="hyp-body"><b>:= </b><span>machine X</span></span><span class="hyp-type"><b>: </b><span>VLSMMachine (vtype X)</span></span></span></span><br><span><var>ls'</var><span class="hyp-type"><b>: </b><span>list transition_item</span></span></span><br><span><var>s</var><span class="hyp-type"><b>: </b><span>state</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">finite_valid_trace_from s []
‚àß finite_valid_trace_from (finite_trace_last s []) ls&#39;
‚Üî finite_valid_trace_from s ([] ++ ls&#39;)</div></blockquote><div class="alectryon-extra-goals"><input class="alectryon-extra-goal-toggle" id="VLSM-v-chk18f" style="display: none" type="checkbox"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>message</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>X</var><span class="hyp-type"><b>: </b><span>VLSM message</span></span></span><br><span><var>TypeX</var><span><span class="hyp-body"><b>:= </b><span>type X</span></span><span class="hyp-type"><b>: </b><span>VLSMType message</span></span></span></span><br><span><var>MachineX</var><span><span class="hyp-body"><b>:= </b><span>machine X</span></span><span class="hyp-type"><b>: </b><span>VLSMMachine (vtype X)</span></span></span></span><br><span><var>a</var><span class="hyp-type"><b>: </b><span>transition_item</span></span></span><br><span><var>ls, ls'</var><span class="hyp-type"><b>: </b><span>list transition_item</span></span></span><br><span><var>IHls</var><span class="hyp-type"><b>: </b><span><span class="kr">‚àÄ</span> <span class="nv">s</span> : state,
  finite_valid_trace_from s ls
  ‚àß finite_valid_trace_from
      (finite_trace_last s ls) ls&#39;
  ‚Üî finite_valid_trace_from s (ls ++ ls&#39;)</span></span></span><br><span><var>s</var><span class="hyp-type"><b>: </b><span>state</span></span></span><br></div><label class="goal-separator" for="VLSM-v-chk18f"><hr></label><div class="goal-conclusion">finite_valid_trace_from s (a :: ls)
‚àß finite_valid_trace_from
    (finite_trace_last s (a :: ls)) ls&#39;
‚Üî finite_valid_trace_from s ((a :: ls) ++ ls&#39;)</div></blockquote></div></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">      </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="VLSM-v-chk190" style="display: none" type="checkbox"><label class="alectryon-input" for="VLSM-v-chk190">-</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>message</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>X</var><span class="hyp-type"><b>: </b><span>VLSM message</span></span></span><br><span><var>TypeX</var><span><span class="hyp-body"><b>:= </b><span>type X</span></span><span class="hyp-type"><b>: </b><span>VLSMType message</span></span></span></span><br><span><var>MachineX</var><span><span class="hyp-body"><b>:= </b><span>machine X</span></span><span class="hyp-type"><b>: </b><span>VLSMMachine (vtype X)</span></span></span></span><br><span><var>ls'</var><span class="hyp-type"><b>: </b><span>list transition_item</span></span></span><br><span><var>s</var><span class="hyp-type"><b>: </b><span>state</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">finite_valid_trace_from s []
‚àß finite_valid_trace_from (finite_trace_last s []) ls&#39;
‚Üî finite_valid_trace_from s ([] ++ ls&#39;)</div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="VLSM-v-chk191" style="display: none" type="checkbox"><label class="alectryon-input" for="VLSM-v-chk191"><span class="nb">rewrite</span> finite_trace_last_nil.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>message</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>X</var><span class="hyp-type"><b>: </b><span>VLSM message</span></span></span><br><span><var>TypeX</var><span><span class="hyp-body"><b>:= </b><span>type X</span></span><span class="hyp-type"><b>: </b><span>VLSMType message</span></span></span></span><br><span><var>MachineX</var><span><span class="hyp-body"><b>:= </b><span>machine X</span></span><span class="hyp-type"><b>: </b><span>VLSMMachine (vtype X)</span></span></span></span><br><span><var>ls'</var><span class="hyp-type"><b>: </b><span>list transition_item</span></span></span><br><span><var>s</var><span class="hyp-type"><b>: </b><span>state</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">finite_valid_trace_from s []
‚àß finite_valid_trace_from s ls&#39;
‚Üî finite_valid_trace_from s ([] ++ ls&#39;)</div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="VLSM-v-chk192" style="display: none" type="checkbox"><label class="alectryon-input" for="VLSM-v-chk192"><span class="nb">simpl</span>.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>message</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>X</var><span class="hyp-type"><b>: </b><span>VLSM message</span></span></span><br><span><var>TypeX</var><span><span class="hyp-body"><b>:= </b><span>type X</span></span><span class="hyp-type"><b>: </b><span>VLSMType message</span></span></span></span><br><span><var>MachineX</var><span><span class="hyp-body"><b>:= </b><span>machine X</span></span><span class="hyp-type"><b>: </b><span>VLSMMachine (vtype X)</span></span></span></span><br><span><var>ls'</var><span class="hyp-type"><b>: </b><span>list transition_item</span></span></span><br><span><var>s</var><span class="hyp-type"><b>: </b><span>state</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">finite_valid_trace_from s []
‚àß finite_valid_trace_from s ls&#39;
‚Üî finite_valid_trace_from s ls&#39;</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">        </span><span class="alectryon-sentence"><span class="alectryon-input"><span class="nb">intuition</span> (<span class="nb">eauto using</span> finite_valid_trace_first_pstate, finite_valid_trace_from_empty).</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">      </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="VLSM-v-chk193" style="display: none" type="checkbox"><label class="alectryon-input" for="VLSM-v-chk193">-</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>message</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>X</var><span class="hyp-type"><b>: </b><span>VLSM message</span></span></span><br><span><var>TypeX</var><span><span class="hyp-body"><b>:= </b><span>type X</span></span><span class="hyp-type"><b>: </b><span>VLSMType message</span></span></span></span><br><span><var>MachineX</var><span><span class="hyp-body"><b>:= </b><span>machine X</span></span><span class="hyp-type"><b>: </b><span>VLSMMachine (vtype X)</span></span></span></span><br><span><var>a</var><span class="hyp-type"><b>: </b><span>transition_item</span></span></span><br><span><var>ls, ls'</var><span class="hyp-type"><b>: </b><span>list transition_item</span></span></span><br><span><var>IHls</var><span class="hyp-type"><b>: </b><span><span class="kr">‚àÄ</span> <span class="nv">s</span> : state,
  finite_valid_trace_from s ls
  ‚àß finite_valid_trace_from
      (finite_trace_last s ls) ls&#39;
  ‚Üî finite_valid_trace_from s (ls ++ ls&#39;)</span></span></span><br><span><var>s</var><span class="hyp-type"><b>: </b><span>state</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">finite_valid_trace_from s (a :: ls)
‚àß finite_valid_trace_from
    (finite_trace_last s (a :: ls)) ls&#39;
‚Üî finite_valid_trace_from s ((a :: ls) ++ ls&#39;)</div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="VLSM-v-chk194" style="display: none" type="checkbox"><label class="alectryon-input" for="VLSM-v-chk194"><span class="nb">rewrite</span> finite_trace_last_cons.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>message</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>X</var><span class="hyp-type"><b>: </b><span>VLSM message</span></span></span><br><span><var>TypeX</var><span><span class="hyp-body"><b>:= </b><span>type X</span></span><span class="hyp-type"><b>: </b><span>VLSMType message</span></span></span></span><br><span><var>MachineX</var><span><span class="hyp-body"><b>:= </b><span>machine X</span></span><span class="hyp-type"><b>: </b><span>VLSMMachine (vtype X)</span></span></span></span><br><span><var>a</var><span class="hyp-type"><b>: </b><span>transition_item</span></span></span><br><span><var>ls, ls'</var><span class="hyp-type"><b>: </b><span>list transition_item</span></span></span><br><span><var>IHls</var><span class="hyp-type"><b>: </b><span><span class="kr">‚àÄ</span> <span class="nv">s</span> : state,
  finite_valid_trace_from s ls
  ‚àß finite_valid_trace_from
      (finite_trace_last s ls) ls&#39;
  ‚Üî finite_valid_trace_from s (ls ++ ls&#39;)</span></span></span><br><span><var>s</var><span class="hyp-type"><b>: </b><span>state</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">finite_valid_trace_from s (a :: ls)
‚àß finite_valid_trace_from
    (finite_trace_last (destination a) ls) ls&#39;
‚Üî finite_valid_trace_from s ((a :: ls) ++ ls&#39;)</div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="VLSM-v-chk195" style="display: none" type="checkbox"><label class="alectryon-input" for="VLSM-v-chk195"><span class="nb">simpl</span>.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>message</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>X</var><span class="hyp-type"><b>: </b><span>VLSM message</span></span></span><br><span><var>TypeX</var><span><span class="hyp-body"><b>:= </b><span>type X</span></span><span class="hyp-type"><b>: </b><span>VLSMType message</span></span></span></span><br><span><var>MachineX</var><span><span class="hyp-body"><b>:= </b><span>machine X</span></span><span class="hyp-type"><b>: </b><span>VLSMMachine (vtype X)</span></span></span></span><br><span><var>a</var><span class="hyp-type"><b>: </b><span>transition_item</span></span></span><br><span><var>ls, ls'</var><span class="hyp-type"><b>: </b><span>list transition_item</span></span></span><br><span><var>IHls</var><span class="hyp-type"><b>: </b><span><span class="kr">‚àÄ</span> <span class="nv">s</span> : state,
  finite_valid_trace_from s ls
  ‚àß finite_valid_trace_from
      (finite_trace_last s ls) ls&#39;
  ‚Üî finite_valid_trace_from s (ls ++ ls&#39;)</span></span></span><br><span><var>s</var><span class="hyp-type"><b>: </b><span>state</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">finite_valid_trace_from s (a :: ls)
‚àß finite_valid_trace_from
    (finite_trace_last (destination a) ls) ls&#39;
‚Üî finite_valid_trace_from s (a :: ls ++ ls&#39;)</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">        </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="VLSM-v-chk196" style="display: none" type="checkbox"><label class="alectryon-input" for="VLSM-v-chk196"><span class="nb">specialize</span> (IHls (destination a)).</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>message</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>X</var><span class="hyp-type"><b>: </b><span>VLSM message</span></span></span><br><span><var>TypeX</var><span><span class="hyp-body"><b>:= </b><span>type X</span></span><span class="hyp-type"><b>: </b><span>VLSMType message</span></span></span></span><br><span><var>MachineX</var><span><span class="hyp-body"><b>:= </b><span>machine X</span></span><span class="hyp-type"><b>: </b><span>VLSMMachine (vtype X)</span></span></span></span><br><span><var>a</var><span class="hyp-type"><b>: </b><span>transition_item</span></span></span><br><span><var>ls, ls'</var><span class="hyp-type"><b>: </b><span>list transition_item</span></span></span><br><span><var>IHls</var><span class="hyp-type"><b>: </b><span>finite_valid_trace_from (destination a) ls
‚àß finite_valid_trace_from
    (finite_trace_last (destination a) ls) ls&#39;
‚Üî finite_valid_trace_from 
    (destination a) (ls ++ ls&#39;)</span></span></span><br><span><var>s</var><span class="hyp-type"><b>: </b><span>state</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">finite_valid_trace_from s (a :: ls)
‚àß finite_valid_trace_from
    (finite_trace_last (destination a) ls) ls&#39;
‚Üî finite_valid_trace_from s (a :: ls ++ ls&#39;)</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">        </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="VLSM-v-chk197" style="display: none" type="checkbox"><label class="alectryon-input" for="VLSM-v-chk197"><span class="nb">split</span>.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>message</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>X</var><span class="hyp-type"><b>: </b><span>VLSM message</span></span></span><br><span><var>TypeX</var><span><span class="hyp-body"><b>:= </b><span>type X</span></span><span class="hyp-type"><b>: </b><span>VLSMType message</span></span></span></span><br><span><var>MachineX</var><span><span class="hyp-body"><b>:= </b><span>machine X</span></span><span class="hyp-type"><b>: </b><span>VLSMMachine (vtype X)</span></span></span></span><br><span><var>a</var><span class="hyp-type"><b>: </b><span>transition_item</span></span></span><br><span><var>ls, ls'</var><span class="hyp-type"><b>: </b><span>list transition_item</span></span></span><br><span><var>IHls</var><span class="hyp-type"><b>: </b><span>finite_valid_trace_from (destination a) ls
‚àß finite_valid_trace_from
    (finite_trace_last (destination a) ls) ls&#39;
‚Üî finite_valid_trace_from 
    (destination a) (ls ++ ls&#39;)</span></span></span><br><span><var>s</var><span class="hyp-type"><b>: </b><span>state</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">finite_valid_trace_from s (a :: ls)
‚àß finite_valid_trace_from
    (finite_trace_last (destination a) ls) ls&#39;
‚Üí finite_valid_trace_from s (a :: ls ++ ls&#39;)</div></blockquote><div class="alectryon-extra-goals"><input class="alectryon-extra-goal-toggle" id="VLSM-v-chk198" style="display: none" type="checkbox"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>message</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>X</var><span class="hyp-type"><b>: </b><span>VLSM message</span></span></span><br><span><var>TypeX</var><span><span class="hyp-body"><b>:= </b><span>type X</span></span><span class="hyp-type"><b>: </b><span>VLSMType message</span></span></span></span><br><span><var>MachineX</var><span><span class="hyp-body"><b>:= </b><span>machine X</span></span><span class="hyp-type"><b>: </b><span>VLSMMachine (vtype X)</span></span></span></span><br><span><var>a</var><span class="hyp-type"><b>: </b><span>transition_item</span></span></span><br><span><var>ls, ls'</var><span class="hyp-type"><b>: </b><span>list transition_item</span></span></span><br><span><var>IHls</var><span class="hyp-type"><b>: </b><span>finite_valid_trace_from (destination a) ls
‚àß finite_valid_trace_from
    (finite_trace_last (destination a) ls) ls&#39;
‚Üî finite_valid_trace_from 
    (destination a) (ls ++ ls&#39;)</span></span></span><br><span><var>s</var><span class="hyp-type"><b>: </b><span>state</span></span></span><br></div><label class="goal-separator" for="VLSM-v-chk198"><hr></label><div class="goal-conclusion">finite_valid_trace_from s (a :: ls ++ ls&#39;)
‚Üí finite_valid_trace_from s (a :: ls)
  ‚àß finite_valid_trace_from
      (finite_trace_last (destination a) ls) ls&#39;</div></blockquote></div></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">        </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="VLSM-v-chk199" style="display: none" type="checkbox"><label class="alectryon-input" for="VLSM-v-chk199">+</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>message</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>X</var><span class="hyp-type"><b>: </b><span>VLSM message</span></span></span><br><span><var>TypeX</var><span><span class="hyp-body"><b>:= </b><span>type X</span></span><span class="hyp-type"><b>: </b><span>VLSMType message</span></span></span></span><br><span><var>MachineX</var><span><span class="hyp-body"><b>:= </b><span>machine X</span></span><span class="hyp-type"><b>: </b><span>VLSMMachine (vtype X)</span></span></span></span><br><span><var>a</var><span class="hyp-type"><b>: </b><span>transition_item</span></span></span><br><span><var>ls, ls'</var><span class="hyp-type"><b>: </b><span>list transition_item</span></span></span><br><span><var>IHls</var><span class="hyp-type"><b>: </b><span>finite_valid_trace_from (destination a) ls
‚àß finite_valid_trace_from
    (finite_trace_last (destination a) ls) ls&#39;
‚Üî finite_valid_trace_from 
    (destination a) (ls ++ ls&#39;)</span></span></span><br><span><var>s</var><span class="hyp-type"><b>: </b><span>state</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">finite_valid_trace_from s (a :: ls)
‚àß finite_valid_trace_from
    (finite_trace_last (destination a) ls) ls&#39;
‚Üí finite_valid_trace_from s (a :: ls ++ ls&#39;)</div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="VLSM-v-chk19a" style="display: none" type="checkbox"><label class="alectryon-input" for="VLSM-v-chk19a"><span class="nb">intros</span> [Hal Hl&#39;].</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>message</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>X</var><span class="hyp-type"><b>: </b><span>VLSM message</span></span></span><br><span><var>TypeX</var><span><span class="hyp-body"><b>:= </b><span>type X</span></span><span class="hyp-type"><b>: </b><span>VLSMType message</span></span></span></span><br><span><var>MachineX</var><span><span class="hyp-body"><b>:= </b><span>machine X</span></span><span class="hyp-type"><b>: </b><span>VLSMMachine (vtype X)</span></span></span></span><br><span><var>a</var><span class="hyp-type"><b>: </b><span>transition_item</span></span></span><br><span><var>ls, ls'</var><span class="hyp-type"><b>: </b><span>list transition_item</span></span></span><br><span><var>IHls</var><span class="hyp-type"><b>: </b><span>finite_valid_trace_from (destination a) ls
‚àß finite_valid_trace_from
    (finite_trace_last (destination a) ls) ls&#39;
‚Üî finite_valid_trace_from 
    (destination a) (ls ++ ls&#39;)</span></span></span><br><span><var>s</var><span class="hyp-type"><b>: </b><span>state</span></span></span><br><span><var>Hal</var><span class="hyp-type"><b>: </b><span>finite_valid_trace_from s (a :: ls)</span></span></span><br><span><var>Hl'</var><span class="hyp-type"><b>: </b><span>finite_valid_trace_from
  (finite_trace_last (destination a) ls) ls&#39;</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">finite_valid_trace_from s (a :: ls ++ ls&#39;)</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">          </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="VLSM-v-chk19b" style="display: none" type="checkbox"><label class="alectryon-input" for="VLSM-v-chk19b"><span class="nb">inversion</span> Hal; <span class="nb">subst</span>; <span class="nb">simpl</span> <span class="kr">in</span> *.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>message</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>X</var><span class="hyp-type"><b>: </b><span>VLSM message</span></span></span><br><span><var>TypeX</var><span><span class="hyp-body"><b>:= </b><span>type X</span></span><span class="hyp-type"><b>: </b><span>VLSMType message</span></span></span></span><br><span><var>MachineX</var><span><span class="hyp-body"><b>:= </b><span>machine X</span></span><span class="hyp-type"><b>: </b><span>VLSMMachine (vtype X)</span></span></span></span><br><span><var>ls, ls'</var><span class="hyp-type"><b>: </b><span>list transition_item</span></span></span><br><span><var>s1</var><span class="hyp-type"><b>: </b><span>state</span></span></span><br><span><var>iom, oom</var><span class="hyp-type"><b>: </b><span>option message</span></span></span><br><span><var>l0</var><span class="hyp-type"><b>: </b><span>label</span></span></span><br><span><var>IHls</var><span class="hyp-type"><b>: </b><span>finite_valid_trace_from s1 ls
‚àß finite_valid_trace_from
    (finite_trace_last s1 ls) ls&#39;
‚Üî finite_valid_trace_from s1 (ls ++ ls&#39;)</span></span></span><br><span><var>s</var><span class="hyp-type"><b>: </b><span>state</span></span></span><br><span><var>Hl'</var><span class="hyp-type"><b>: </b><span>finite_valid_trace_from
  (finite_trace_last s1 ls) ls&#39;</span></span></span><br><span><var>Hal</var><span class="hyp-type"><b>: </b><span>finite_valid_trace_from s
  ({|
     l := l0;
     input := iom;
     destination := s1;
     output := oom
   |} :: ls)</span></span></span><br><span><var>Htl</var><span class="hyp-type"><b>: </b><span>finite_valid_trace_from s1 ls</span></span></span><br><span><var>Ht</var><span class="hyp-type"><b>: </b><span>input_valid_transition l0 (s, iom) (s1, oom)</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">finite_valid_trace_from s
  ({|
     l := l0;
     input := iom;
     destination := s1;
     output := oom
   |} :: ls ++ ls&#39;)</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">          </span><span class="alectryon-sentence"><span class="alectryon-input"><span class="nb">constructor</span>;[<span class="nb">apply</span> IHls;<span class="nb">split</span>|];<span class="bp">assumption</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">        </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="VLSM-v-chk19c" style="display: none" type="checkbox"><label class="alectryon-input" for="VLSM-v-chk19c">+</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>message</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>X</var><span class="hyp-type"><b>: </b><span>VLSM message</span></span></span><br><span><var>TypeX</var><span><span class="hyp-body"><b>:= </b><span>type X</span></span><span class="hyp-type"><b>: </b><span>VLSMType message</span></span></span></span><br><span><var>MachineX</var><span><span class="hyp-body"><b>:= </b><span>machine X</span></span><span class="hyp-type"><b>: </b><span>VLSMMachine (vtype X)</span></span></span></span><br><span><var>a</var><span class="hyp-type"><b>: </b><span>transition_item</span></span></span><br><span><var>ls, ls'</var><span class="hyp-type"><b>: </b><span>list transition_item</span></span></span><br><span><var>IHls</var><span class="hyp-type"><b>: </b><span>finite_valid_trace_from (destination a) ls
‚àß finite_valid_trace_from
    (finite_trace_last (destination a) ls) ls&#39;
‚Üî finite_valid_trace_from 
    (destination a) (ls ++ ls&#39;)</span></span></span><br><span><var>s</var><span class="hyp-type"><b>: </b><span>state</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">finite_valid_trace_from s (a :: ls ++ ls&#39;)
‚Üí finite_valid_trace_from s (a :: ls)
  ‚àß finite_valid_trace_from
      (finite_trace_last (destination a) ls) ls&#39;</div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="VLSM-v-chk19d" style="display: none" type="checkbox"><label class="alectryon-input" for="VLSM-v-chk19d"><span class="nb">inversion</span> <span class="mi">1</span>;<span class="nb">subst</span>; <span class="nb">simpl</span> <span class="kr">in</span> *.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>message</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>X</var><span class="hyp-type"><b>: </b><span>VLSM message</span></span></span><br><span><var>TypeX</var><span><span class="hyp-body"><b>:= </b><span>type X</span></span><span class="hyp-type"><b>: </b><span>VLSMType message</span></span></span></span><br><span><var>MachineX</var><span><span class="hyp-body"><b>:= </b><span>machine X</span></span><span class="hyp-type"><b>: </b><span>VLSMMachine (vtype X)</span></span></span></span><br><span><var>ls, ls'</var><span class="hyp-type"><b>: </b><span>list transition_item</span></span></span><br><span><var>s1</var><span class="hyp-type"><b>: </b><span>state</span></span></span><br><span><var>iom, oom</var><span class="hyp-type"><b>: </b><span>option message</span></span></span><br><span><var>l0</var><span class="hyp-type"><b>: </b><span>label</span></span></span><br><span><var>IHls</var><span class="hyp-type"><b>: </b><span>finite_valid_trace_from s1 ls
‚àß finite_valid_trace_from
    (finite_trace_last s1 ls) ls&#39;
‚Üî finite_valid_trace_from s1 (ls ++ ls&#39;)</span></span></span><br><span><var>s</var><span class="hyp-type"><b>: </b><span>state</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>finite_valid_trace_from s
  ({|
     l := l0;
     input := iom;
     destination := s1;
     output := oom
   |} :: ls ++ ls&#39;)</span></span></span><br><span><var>Htl</var><span class="hyp-type"><b>: </b><span>finite_valid_trace_from s1 (ls ++ ls&#39;)</span></span></span><br><span><var>Ht</var><span class="hyp-type"><b>: </b><span>input_valid_transition l0 (s, iom) (s1, oom)</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">finite_valid_trace_from s
  ({|
     l := l0;
     input := iom;
     destination := s1;
     output := oom
   |} :: ls)
‚àß finite_valid_trace_from (finite_trace_last s1 ls)
    ls&#39;</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">          </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="VLSM-v-chk19e" style="display: none" type="checkbox"><label class="alectryon-input" for="VLSM-v-chk19e"><span class="nb">apply</span> IHls <span class="kr">in</span> Htl <span class="kr">as</span> [Hl Hl&#39;].</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>message</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>X</var><span class="hyp-type"><b>: </b><span>VLSM message</span></span></span><br><span><var>TypeX</var><span><span class="hyp-body"><b>:= </b><span>type X</span></span><span class="hyp-type"><b>: </b><span>VLSMType message</span></span></span></span><br><span><var>MachineX</var><span><span class="hyp-body"><b>:= </b><span>machine X</span></span><span class="hyp-type"><b>: </b><span>VLSMMachine (vtype X)</span></span></span></span><br><span><var>ls, ls'</var><span class="hyp-type"><b>: </b><span>list transition_item</span></span></span><br><span><var>s1</var><span class="hyp-type"><b>: </b><span>state</span></span></span><br><span><var>iom, oom</var><span class="hyp-type"><b>: </b><span>option message</span></span></span><br><span><var>l0</var><span class="hyp-type"><b>: </b><span>label</span></span></span><br><span><var>IHls</var><span class="hyp-type"><b>: </b><span>finite_valid_trace_from s1 ls
‚àß finite_valid_trace_from
    (finite_trace_last s1 ls) ls&#39;
‚Üî finite_valid_trace_from s1 (ls ++ ls&#39;)</span></span></span><br><span><var>s</var><span class="hyp-type"><b>: </b><span>state</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>finite_valid_trace_from s
  ({|
     l := l0;
     input := iom;
     destination := s1;
     output := oom
   |} :: ls ++ ls&#39;)</span></span></span><br><span><var>Hl</var><span class="hyp-type"><b>: </b><span>finite_valid_trace_from s1 ls</span></span></span><br><span><var>Hl'</var><span class="hyp-type"><b>: </b><span>finite_valid_trace_from
  (finite_trace_last s1 ls) ls&#39;</span></span></span><br><span><var>Ht</var><span class="hyp-type"><b>: </b><span>input_valid_transition l0 (s, iom) (s1, oom)</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">finite_valid_trace_from s
  ({|
     l := l0;
     input := iom;
     destination := s1;
     output := oom
   |} :: ls)
‚àß finite_valid_trace_from (finite_trace_last s1 ls)
    ls&#39;</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">          </span><span class="alectryon-sentence"><span class="alectryon-input"><span class="nb">split</span>;[<span class="nb">constructor</span>|];<span class="bp">assumption</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Qed</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
</span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="VLSM-v-chk19f" style="display: none" type="checkbox"><label class="alectryon-input" for="VLSM-v-chk19f"><span class="kn">Lemma</span> <span class="nf">finite_valid_trace_from_rev_ind</span>
      (<span class="nv">P</span> : state -&gt; list transition_item -&gt; <span class="kt">Prop</span>)
      (<span class="nv">Hempty</span>: <span class="kr">forall</span> <span class="nv">s</span>,
        valid_state_prop s -&gt; P s nil)
      (<span class="nv">Hextend</span> : <span class="kr">forall</span> <span class="nv">s</span> <span class="nv">tr</span>,
        finite_valid_trace_from s tr -&gt;
        P s tr -&gt;
        <span class="kr">forall</span> <span class="nv">sf</span> <span class="nv">iom</span> <span class="nv">oom</span> <span class="nv">l</span>
        (<span class="nv">Hx</span>: input_valid_transition l (finite_trace_last s tr,iom) (sf,oom)),
        <span class="kr">let</span> <span class="nv">x</span>:= {|l:=l; input:=iom; destination:=sf; output:=oom|} <span class="kr">in</span>
        P s (tr++[x])):
      <span class="kr">forall</span> <span class="nv">s</span> <span class="nv">tr</span>,
        finite_valid_trace_from s tr -&gt;
        P s tr.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>message</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>X</var><span class="hyp-type"><b>: </b><span>VLSM message</span></span></span><br><span><var>TypeX</var><span><span class="hyp-body"><b>:= </b><span>type X</span></span><span class="hyp-type"><b>: </b><span>VLSMType message</span></span></span></span><br><span><var>MachineX</var><span><span class="hyp-body"><b>:= </b><span>machine X</span></span><span class="hyp-type"><b>: </b><span>VLSMMachine (vtype X)</span></span></span></span><br><span><var>P</var><span class="hyp-type"><b>: </b><span>state ‚Üí list transition_item ‚Üí <span class="kt">Prop</span></span></span></span><br><span><var>Hempty</var><span class="hyp-type"><b>: </b><span><span class="kr">‚àÄ</span> <span class="nv">s</span> : state, valid_state_prop s ‚Üí P s []</span></span></span><br><span><var>Hextend</var><span class="hyp-type"><b>: </b><span><span class="kr">‚àÄ</span> (<span class="nv">s</span> : state) (<span class="nv">tr</span> : list transition_item),
  finite_valid_trace_from s tr
  ‚Üí P s tr
    ‚Üí <span class="kr">‚àÄ</span> (<span class="nv">sf</span> : state) (<span class="nv">iom</span>
                      <span class="nv">oom</span> : 
                      option message) 
        (<span class="nv">l</span> : label),
        input_valid_transition l
          (finite_trace_last s tr, iom)
          (sf, oom)
        ‚Üí <span class="kr">let</span> <span class="nv">x</span> :=
            {|
              l := l;
              input := iom;
              destination := sf;
              output := oom
            |} <span class="kr">in</span>
          P s (tr ++ [x])</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="kr">‚àÄ</span> (<span class="nv">s</span> : state) (<span class="nv">tr</span> : list transition_item),
  finite_valid_trace_from s tr ‚Üí P s tr</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="VLSM-v-chk1a0" style="display: none" type="checkbox"><label class="alectryon-input" for="VLSM-v-chk1a0"><span class="kn">Proof</span>.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>message</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>X</var><span class="hyp-type"><b>: </b><span>VLSM message</span></span></span><br><span><var>TypeX</var><span><span class="hyp-body"><b>:= </b><span>type X</span></span><span class="hyp-type"><b>: </b><span>VLSMType message</span></span></span></span><br><span><var>MachineX</var><span><span class="hyp-body"><b>:= </b><span>machine X</span></span><span class="hyp-type"><b>: </b><span>VLSMMachine (vtype X)</span></span></span></span><br><span><var>P</var><span class="hyp-type"><b>: </b><span>state ‚Üí list transition_item ‚Üí <span class="kt">Prop</span></span></span></span><br><span><var>Hempty</var><span class="hyp-type"><b>: </b><span><span class="kr">‚àÄ</span> <span class="nv">s</span> : state, valid_state_prop s ‚Üí P s []</span></span></span><br><span><var>Hextend</var><span class="hyp-type"><b>: </b><span><span class="kr">‚àÄ</span> (<span class="nv">s</span> : state) (<span class="nv">tr</span> : list transition_item),
  finite_valid_trace_from s tr
  ‚Üí P s tr
    ‚Üí <span class="kr">‚àÄ</span> (<span class="nv">sf</span> : state) (<span class="nv">iom</span>
                      <span class="nv">oom</span> : 
                      option message) 
        (<span class="nv">l</span> : label),
        input_valid_transition l
          (finite_trace_last s tr, iom)
          (sf, oom)
        ‚Üí <span class="kr">let</span> <span class="nv">x</span> :=
            {|
              l := l;
              input := iom;
              destination := sf;
              output := oom
            |} <span class="kr">in</span>
          P s (tr ++ [x])</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="kr">‚àÄ</span> (<span class="nv">s</span> : state) (<span class="nv">tr</span> : list transition_item),
  finite_valid_trace_from s tr ‚Üí P s tr</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">      </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="VLSM-v-chk1a1" style="display: none" type="checkbox"><label class="alectryon-input" for="VLSM-v-chk1a1"><span class="nb">induction</span> tr <span class="nb">using</span> rev_ind; <span class="nb">intro</span> Htr.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>message</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>X</var><span class="hyp-type"><b>: </b><span>VLSM message</span></span></span><br><span><var>TypeX</var><span><span class="hyp-body"><b>:= </b><span>type X</span></span><span class="hyp-type"><b>: </b><span>VLSMType message</span></span></span></span><br><span><var>MachineX</var><span><span class="hyp-body"><b>:= </b><span>machine X</span></span><span class="hyp-type"><b>: </b><span>VLSMMachine (vtype X)</span></span></span></span><br><span><var>P</var><span class="hyp-type"><b>: </b><span>state ‚Üí list transition_item ‚Üí <span class="kt">Prop</span></span></span></span><br><span><var>Hempty</var><span class="hyp-type"><b>: </b><span><span class="kr">‚àÄ</span> <span class="nv">s</span> : state, valid_state_prop s ‚Üí P s []</span></span></span><br><span><var>Hextend</var><span class="hyp-type"><b>: </b><span><span class="kr">‚àÄ</span> (<span class="nv">s</span> : state) (<span class="nv">tr</span> : list transition_item),
  finite_valid_trace_from s tr
  ‚Üí P s tr
    ‚Üí <span class="kr">‚àÄ</span> (<span class="nv">sf</span> : state) (<span class="nv">iom</span>
                      <span class="nv">oom</span> : 
                      option message) 
        (<span class="nv">l</span> : label),
        input_valid_transition l
          (finite_trace_last s tr, iom)
          (sf, oom)
        ‚Üí <span class="kr">let</span> <span class="nv">x</span> :=
            {|
              l := l;
              input := iom;
              destination := sf;
              output := oom
            |} <span class="kr">in</span>
          P s (tr ++ [x])</span></span></span><br><span><var>s</var><span class="hyp-type"><b>: </b><span>state</span></span></span><br><span><var>Htr</var><span class="hyp-type"><b>: </b><span>finite_valid_trace_from s []</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">P s []</div></blockquote><div class="alectryon-extra-goals"><input class="alectryon-extra-goal-toggle" id="VLSM-v-chk1a2" style="display: none" type="checkbox"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>message</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>X</var><span class="hyp-type"><b>: </b><span>VLSM message</span></span></span><br><span><var>TypeX</var><span><span class="hyp-body"><b>:= </b><span>type X</span></span><span class="hyp-type"><b>: </b><span>VLSMType message</span></span></span></span><br><span><var>MachineX</var><span><span class="hyp-body"><b>:= </b><span>machine X</span></span><span class="hyp-type"><b>: </b><span>VLSMMachine (vtype X)</span></span></span></span><br><span><var>P</var><span class="hyp-type"><b>: </b><span>state ‚Üí list transition_item ‚Üí <span class="kt">Prop</span></span></span></span><br><span><var>Hempty</var><span class="hyp-type"><b>: </b><span><span class="kr">‚àÄ</span> <span class="nv">s</span> : state, valid_state_prop s ‚Üí P s []</span></span></span><br><span><var>Hextend</var><span class="hyp-type"><b>: </b><span><span class="kr">‚àÄ</span> (<span class="nv">s</span> : state) (<span class="nv">tr</span> : list transition_item),
  finite_valid_trace_from s tr
  ‚Üí P s tr
    ‚Üí <span class="kr">‚àÄ</span> (<span class="nv">sf</span> : state) (<span class="nv">iom</span>
                      <span class="nv">oom</span> : 
                      option message) 
        (<span class="nv">l</span> : label),
        input_valid_transition l
          (finite_trace_last s tr, iom)
          (sf, oom)
        ‚Üí <span class="kr">let</span> <span class="nv">x</span> :=
            {|
              l := l;
              input := iom;
              destination := sf;
              output := oom
            |} <span class="kr">in</span>
          P s (tr ++ [x])</span></span></span><br><span><var>s</var><span class="hyp-type"><b>: </b><span>state</span></span></span><br><span><var>x</var><span class="hyp-type"><b>: </b><span>transition_item</span></span></span><br><span><var>tr</var><span class="hyp-type"><b>: </b><span>list transition_item</span></span></span><br><span><var>IHtr</var><span class="hyp-type"><b>: </b><span>finite_valid_trace_from s tr ‚Üí P s tr</span></span></span><br><span><var>Htr</var><span class="hyp-type"><b>: </b><span>finite_valid_trace_from s (tr ++ [x])</span></span></span><br></div><label class="goal-separator" for="VLSM-v-chk1a2"><hr></label><div class="goal-conclusion">P s (tr ++ [x])</div></blockquote></div></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">      </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="VLSM-v-chk1a3" style="display: none" type="checkbox"><label class="alectryon-input" for="VLSM-v-chk1a3">-</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>message</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>X</var><span class="hyp-type"><b>: </b><span>VLSM message</span></span></span><br><span><var>TypeX</var><span><span class="hyp-body"><b>:= </b><span>type X</span></span><span class="hyp-type"><b>: </b><span>VLSMType message</span></span></span></span><br><span><var>MachineX</var><span><span class="hyp-body"><b>:= </b><span>machine X</span></span><span class="hyp-type"><b>: </b><span>VLSMMachine (vtype X)</span></span></span></span><br><span><var>P</var><span class="hyp-type"><b>: </b><span>state ‚Üí list transition_item ‚Üí <span class="kt">Prop</span></span></span></span><br><span><var>Hempty</var><span class="hyp-type"><b>: </b><span><span class="kr">‚àÄ</span> <span class="nv">s</span> : state, valid_state_prop s ‚Üí P s []</span></span></span><br><span><var>Hextend</var><span class="hyp-type"><b>: </b><span><span class="kr">‚àÄ</span> (<span class="nv">s</span> : state) (<span class="nv">tr</span> : list transition_item),
  finite_valid_trace_from s tr
  ‚Üí P s tr
    ‚Üí <span class="kr">‚àÄ</span> (<span class="nv">sf</span> : state) (<span class="nv">iom</span>
                      <span class="nv">oom</span> : 
                      option message) 
        (<span class="nv">l</span> : label),
        input_valid_transition l
          (finite_trace_last s tr, iom)
          (sf, oom)
        ‚Üí <span class="kr">let</span> <span class="nv">x</span> :=
            {|
              l := l;
              input := iom;
              destination := sf;
              output := oom
            |} <span class="kr">in</span>
          P s (tr ++ [x])</span></span></span><br><span><var>s</var><span class="hyp-type"><b>: </b><span>state</span></span></span><br><span><var>Htr</var><span class="hyp-type"><b>: </b><span>finite_valid_trace_from s []</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">P s []</div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="VLSM-v-chk1a4" style="display: none" type="checkbox"><label class="alectryon-input" for="VLSM-v-chk1a4"><span class="nb">inversion</span> Htr.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>message</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>X</var><span class="hyp-type"><b>: </b><span>VLSM message</span></span></span><br><span><var>TypeX</var><span><span class="hyp-body"><b>:= </b><span>type X</span></span><span class="hyp-type"><b>: </b><span>VLSMType message</span></span></span></span><br><span><var>MachineX</var><span><span class="hyp-body"><b>:= </b><span>machine X</span></span><span class="hyp-type"><b>: </b><span>VLSMMachine (vtype X)</span></span></span></span><br><span><var>P</var><span class="hyp-type"><b>: </b><span>state ‚Üí list transition_item ‚Üí <span class="kt">Prop</span></span></span></span><br><span><var>Hempty</var><span class="hyp-type"><b>: </b><span><span class="kr">‚àÄ</span> <span class="nv">s</span> : state, valid_state_prop s ‚Üí P s []</span></span></span><br><span><var>Hextend</var><span class="hyp-type"><b>: </b><span><span class="kr">‚àÄ</span> (<span class="nv">s</span> : state) (<span class="nv">tr</span> : list transition_item),
  finite_valid_trace_from s tr
  ‚Üí P s tr
    ‚Üí <span class="kr">‚àÄ</span> (<span class="nv">sf</span> : state) (<span class="nv">iom</span>
                      <span class="nv">oom</span> : 
                      option message) 
        (<span class="nv">l</span> : label),
        input_valid_transition l
          (finite_trace_last s tr, iom)
          (sf, oom)
        ‚Üí <span class="kr">let</span> <span class="nv">x</span> :=
            {|
              l := l;
              input := iom;
              destination := sf;
              output := oom
            |} <span class="kr">in</span>
          P s (tr ++ [x])</span></span></span><br><span><var>s</var><span class="hyp-type"><b>: </b><span>state</span></span></span><br><span><var>Htr</var><span class="hyp-type"><b>: </b><span>finite_valid_trace_from s []</span></span></span><br><span><var>s1</var><span class="hyp-type"><b>: </b><span>state</span></span></span><br><span><var>Hs</var><span class="hyp-type"><b>: </b><span>valid_state_prop s</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>s1 = s</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">P s []</div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="VLSM-v-chk1a5" style="display: none" type="checkbox"><label class="alectryon-input" for="VLSM-v-chk1a5"><span class="nb">apply</span> Hempty.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>message</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>X</var><span class="hyp-type"><b>: </b><span>VLSM message</span></span></span><br><span><var>TypeX</var><span><span class="hyp-body"><b>:= </b><span>type X</span></span><span class="hyp-type"><b>: </b><span>VLSMType message</span></span></span></span><br><span><var>MachineX</var><span><span class="hyp-body"><b>:= </b><span>machine X</span></span><span class="hyp-type"><b>: </b><span>VLSMMachine (vtype X)</span></span></span></span><br><span><var>P</var><span class="hyp-type"><b>: </b><span>state ‚Üí list transition_item ‚Üí <span class="kt">Prop</span></span></span></span><br><span><var>Hempty</var><span class="hyp-type"><b>: </b><span><span class="kr">‚àÄ</span> <span class="nv">s</span> : state, valid_state_prop s ‚Üí P s []</span></span></span><br><span><var>Hextend</var><span class="hyp-type"><b>: </b><span><span class="kr">‚àÄ</span> (<span class="nv">s</span> : state) (<span class="nv">tr</span> : list transition_item),
  finite_valid_trace_from s tr
  ‚Üí P s tr
    ‚Üí <span class="kr">‚àÄ</span> (<span class="nv">sf</span> : state) (<span class="nv">iom</span>
                      <span class="nv">oom</span> : 
                      option message) 
        (<span class="nv">l</span> : label),
        input_valid_transition l
          (finite_trace_last s tr, iom)
          (sf, oom)
        ‚Üí <span class="kr">let</span> <span class="nv">x</span> :=
            {|
              l := l;
              input := iom;
              destination := sf;
              output := oom
            |} <span class="kr">in</span>
          P s (tr ++ [x])</span></span></span><br><span><var>s</var><span class="hyp-type"><b>: </b><span>state</span></span></span><br><span><var>Htr</var><span class="hyp-type"><b>: </b><span>finite_valid_trace_from s []</span></span></span><br><span><var>s1</var><span class="hyp-type"><b>: </b><span>state</span></span></span><br><span><var>Hs</var><span class="hyp-type"><b>: </b><span>valid_state_prop s</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>s1 = s</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">valid_state_prop s</div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="bp">congruence</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">      </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="VLSM-v-chk1a6" style="display: none" type="checkbox"><label class="alectryon-input" for="VLSM-v-chk1a6">-</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>message</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>X</var><span class="hyp-type"><b>: </b><span>VLSM message</span></span></span><br><span><var>TypeX</var><span><span class="hyp-body"><b>:= </b><span>type X</span></span><span class="hyp-type"><b>: </b><span>VLSMType message</span></span></span></span><br><span><var>MachineX</var><span><span class="hyp-body"><b>:= </b><span>machine X</span></span><span class="hyp-type"><b>: </b><span>VLSMMachine (vtype X)</span></span></span></span><br><span><var>P</var><span class="hyp-type"><b>: </b><span>state ‚Üí list transition_item ‚Üí <span class="kt">Prop</span></span></span></span><br><span><var>Hempty</var><span class="hyp-type"><b>: </b><span><span class="kr">‚àÄ</span> <span class="nv">s</span> : state, valid_state_prop s ‚Üí P s []</span></span></span><br><span><var>Hextend</var><span class="hyp-type"><b>: </b><span><span class="kr">‚àÄ</span> (<span class="nv">s</span> : state) (<span class="nv">tr</span> : list transition_item),
  finite_valid_trace_from s tr
  ‚Üí P s tr
    ‚Üí <span class="kr">‚àÄ</span> (<span class="nv">sf</span> : state) (<span class="nv">iom</span>
                      <span class="nv">oom</span> : 
                      option message) 
        (<span class="nv">l</span> : label),
        input_valid_transition l
          (finite_trace_last s tr, iom)
          (sf, oom)
        ‚Üí <span class="kr">let</span> <span class="nv">x</span> :=
            {|
              l := l;
              input := iom;
              destination := sf;
              output := oom
            |} <span class="kr">in</span>
          P s (tr ++ [x])</span></span></span><br><span><var>s</var><span class="hyp-type"><b>: </b><span>state</span></span></span><br><span><var>x</var><span class="hyp-type"><b>: </b><span>transition_item</span></span></span><br><span><var>tr</var><span class="hyp-type"><b>: </b><span>list transition_item</span></span></span><br><span><var>IHtr</var><span class="hyp-type"><b>: </b><span>finite_valid_trace_from s tr ‚Üí P s tr</span></span></span><br><span><var>Htr</var><span class="hyp-type"><b>: </b><span>finite_valid_trace_from s (tr ++ [x])</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">P s (tr ++ [x])</div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="VLSM-v-chk1a7" style="display: none" type="checkbox"><label class="alectryon-input" for="VLSM-v-chk1a7"><span class="nb">apply</span> finite_valid_trace_from_app_iff <span class="kr">in</span> Htr.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>message</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>X</var><span class="hyp-type"><b>: </b><span>VLSM message</span></span></span><br><span><var>TypeX</var><span><span class="hyp-body"><b>:= </b><span>type X</span></span><span class="hyp-type"><b>: </b><span>VLSMType message</span></span></span></span><br><span><var>MachineX</var><span><span class="hyp-body"><b>:= </b><span>machine X</span></span><span class="hyp-type"><b>: </b><span>VLSMMachine (vtype X)</span></span></span></span><br><span><var>P</var><span class="hyp-type"><b>: </b><span>state ‚Üí list transition_item ‚Üí <span class="kt">Prop</span></span></span></span><br><span><var>Hempty</var><span class="hyp-type"><b>: </b><span><span class="kr">‚àÄ</span> <span class="nv">s</span> : state, valid_state_prop s ‚Üí P s []</span></span></span><br><span><var>Hextend</var><span class="hyp-type"><b>: </b><span><span class="kr">‚àÄ</span> (<span class="nv">s</span> : state) (<span class="nv">tr</span> : list transition_item),
  finite_valid_trace_from s tr
  ‚Üí P s tr
    ‚Üí <span class="kr">‚àÄ</span> (<span class="nv">sf</span> : state) (<span class="nv">iom</span>
                      <span class="nv">oom</span> : 
                      option message) 
        (<span class="nv">l</span> : label),
        input_valid_transition l
          (finite_trace_last s tr, iom)
          (sf, oom)
        ‚Üí <span class="kr">let</span> <span class="nv">x</span> :=
            {|
              l := l;
              input := iom;
              destination := sf;
              output := oom
            |} <span class="kr">in</span>
          P s (tr ++ [x])</span></span></span><br><span><var>s</var><span class="hyp-type"><b>: </b><span>state</span></span></span><br><span><var>x</var><span class="hyp-type"><b>: </b><span>transition_item</span></span></span><br><span><var>tr</var><span class="hyp-type"><b>: </b><span>list transition_item</span></span></span><br><span><var>IHtr</var><span class="hyp-type"><b>: </b><span>finite_valid_trace_from s tr ‚Üí P s tr</span></span></span><br><span><var>Htr</var><span class="hyp-type"><b>: </b><span>finite_valid_trace_from s tr
‚àß finite_valid_trace_from
    (finite_trace_last s tr) [x]</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">P s (tr ++ [x])</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">        </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="VLSM-v-chk1a8" style="display: none" type="checkbox"><label class="alectryon-input" for="VLSM-v-chk1a8"><span class="nb">destruct</span> Htr <span class="kr">as</span> [Htr Hx].</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>message</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>X</var><span class="hyp-type"><b>: </b><span>VLSM message</span></span></span><br><span><var>TypeX</var><span><span class="hyp-body"><b>:= </b><span>type X</span></span><span class="hyp-type"><b>: </b><span>VLSMType message</span></span></span></span><br><span><var>MachineX</var><span><span class="hyp-body"><b>:= </b><span>machine X</span></span><span class="hyp-type"><b>: </b><span>VLSMMachine (vtype X)</span></span></span></span><br><span><var>P</var><span class="hyp-type"><b>: </b><span>state ‚Üí list transition_item ‚Üí <span class="kt">Prop</span></span></span></span><br><span><var>Hempty</var><span class="hyp-type"><b>: </b><span><span class="kr">‚àÄ</span> <span class="nv">s</span> : state, valid_state_prop s ‚Üí P s []</span></span></span><br><span><var>Hextend</var><span class="hyp-type"><b>: </b><span><span class="kr">‚àÄ</span> (<span class="nv">s</span> : state) (<span class="nv">tr</span> : list transition_item),
  finite_valid_trace_from s tr
  ‚Üí P s tr
    ‚Üí <span class="kr">‚àÄ</span> (<span class="nv">sf</span> : state) (<span class="nv">iom</span>
                      <span class="nv">oom</span> : 
                      option message) 
        (<span class="nv">l</span> : label),
        input_valid_transition l
          (finite_trace_last s tr, iom)
          (sf, oom)
        ‚Üí <span class="kr">let</span> <span class="nv">x</span> :=
            {|
              l := l;
              input := iom;
              destination := sf;
              output := oom
            |} <span class="kr">in</span>
          P s (tr ++ [x])</span></span></span><br><span><var>s</var><span class="hyp-type"><b>: </b><span>state</span></span></span><br><span><var>x</var><span class="hyp-type"><b>: </b><span>transition_item</span></span></span><br><span><var>tr</var><span class="hyp-type"><b>: </b><span>list transition_item</span></span></span><br><span><var>IHtr</var><span class="hyp-type"><b>: </b><span>finite_valid_trace_from s tr ‚Üí P s tr</span></span></span><br><span><var>Htr</var><span class="hyp-type"><b>: </b><span>finite_valid_trace_from s tr</span></span></span><br><span><var>Hx</var><span class="hyp-type"><b>: </b><span>finite_valid_trace_from 
  (finite_trace_last s tr) [x]</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">P s (tr ++ [x])</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">        </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="VLSM-v-chk1a9" style="display: none" type="checkbox"><label class="alectryon-input" for="VLSM-v-chk1a9"><span class="nb">destruct</span> x; <span class="nb">apply</span> (Hextend _ _ Htr (IHtr Htr)).</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>message</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>X</var><span class="hyp-type"><b>: </b><span>VLSM message</span></span></span><br><span><var>TypeX</var><span><span class="hyp-body"><b>:= </b><span>type X</span></span><span class="hyp-type"><b>: </b><span>VLSMType message</span></span></span></span><br><span><var>MachineX</var><span><span class="hyp-body"><b>:= </b><span>machine X</span></span><span class="hyp-type"><b>: </b><span>VLSMMachine (vtype X)</span></span></span></span><br><span><var>P</var><span class="hyp-type"><b>: </b><span>state ‚Üí list transition_item ‚Üí <span class="kt">Prop</span></span></span></span><br><span><var>Hempty</var><span class="hyp-type"><b>: </b><span><span class="kr">‚àÄ</span> <span class="nv">s</span> : state, valid_state_prop s ‚Üí P s []</span></span></span><br><span><var>Hextend</var><span class="hyp-type"><b>: </b><span><span class="kr">‚àÄ</span> (<span class="nv">s</span> : state) (<span class="nv">tr</span> : list transition_item),
  finite_valid_trace_from s tr
  ‚Üí P s tr
    ‚Üí <span class="kr">‚àÄ</span> (<span class="nv">sf</span> : state) (<span class="nv">iom</span>
                      <span class="nv">oom</span> : 
                      option message) 
        (<span class="nv">l</span> : label),
        input_valid_transition l
          (finite_trace_last s tr, iom)
          (sf, oom)
        ‚Üí <span class="kr">let</span> <span class="nv">x</span> :=
            {|
              l := l;
              input := iom;
              destination := sf;
              output := oom
            |} <span class="kr">in</span>
          P s (tr ++ [x])</span></span></span><br><span><var>s</var><span class="hyp-type"><b>: </b><span>state</span></span></span><br><span><var>l0</var><span class="hyp-type"><b>: </b><span>label</span></span></span><br><span><var>input0</var><span class="hyp-type"><b>: </b><span>option message</span></span></span><br><span><var>destination0</var><span class="hyp-type"><b>: </b><span>state</span></span></span><br><span><var>output0</var><span class="hyp-type"><b>: </b><span>option message</span></span></span><br><span><var>tr</var><span class="hyp-type"><b>: </b><span>list transition_item</span></span></span><br><span><var>IHtr</var><span class="hyp-type"><b>: </b><span>finite_valid_trace_from s tr ‚Üí P s tr</span></span></span><br><span><var>Htr</var><span class="hyp-type"><b>: </b><span>finite_valid_trace_from s tr</span></span></span><br><span><var>Hx</var><span class="hyp-type"><b>: </b><span>finite_valid_trace_from 
  (finite_trace_last s tr)
  [{|
     l := l0;
     input := input0;
     destination := destination0;
     output := output0
   |}]</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">input_valid_transition l0
  (finite_trace_last s tr, input0)
  (destination0, output0)</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">        </span><span class="alectryon-sentence"><span class="alectryon-input"><span class="nb">inversion</span> Hx; <span class="bp">congruence</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Qed</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
</span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="VLSM-v-chk1aa" style="display: none" type="checkbox"><label class="alectryon-input" for="VLSM-v-chk1aa"><span class="kn">Lemma</span> <span class="nf">finite_valid_trace_rev_ind</span>
      (<span class="nv">P</span> : state -&gt; list transition_item -&gt; <span class="kt">Prop</span>)
      (<span class="nv">Hempty</span>: <span class="kr">forall</span> <span class="nv">si</span>,
        initial_state_prop si -&gt; P si nil)
      (<span class="nv">Hextend</span> : <span class="kr">forall</span> <span class="nv">si</span> <span class="nv">tr</span>,
        finite_valid_trace si tr -&gt;
        P si tr -&gt;
        <span class="kr">forall</span> <span class="nv">sf</span> <span class="nv">iom</span> <span class="nv">oom</span> <span class="nv">l</span>
        (<span class="nv">Hx</span>: input_valid_transition l (finite_trace_last si tr,iom) (sf,oom)),
        <span class="kr">let</span> <span class="nv">x</span>:= {|l:=l; input:=iom; destination:=sf; output:=oom|} <span class="kr">in</span>
        P si (tr++[x])):
      <span class="kr">forall</span> <span class="nv">si</span> <span class="nv">tr</span>,
        finite_valid_trace si tr -&gt;
        P si tr.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>message</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>X</var><span class="hyp-type"><b>: </b><span>VLSM message</span></span></span><br><span><var>TypeX</var><span><span class="hyp-body"><b>:= </b><span>type X</span></span><span class="hyp-type"><b>: </b><span>VLSMType message</span></span></span></span><br><span><var>MachineX</var><span><span class="hyp-body"><b>:= </b><span>machine X</span></span><span class="hyp-type"><b>: </b><span>VLSMMachine (vtype X)</span></span></span></span><br><span><var>P</var><span class="hyp-type"><b>: </b><span>state ‚Üí list transition_item ‚Üí <span class="kt">Prop</span></span></span></span><br><span><var>Hempty</var><span class="hyp-type"><b>: </b><span><span class="kr">‚àÄ</span> <span class="nv">si</span> : state, initial_state_prop si ‚Üí P si []</span></span></span><br><span><var>Hextend</var><span class="hyp-type"><b>: </b><span><span class="kr">‚àÄ</span> (<span class="nv">si</span> : state) (<span class="nv">tr</span> : list transition_item),
  finite_valid_trace si tr
  ‚Üí P si tr
    ‚Üí <span class="kr">‚àÄ</span> (<span class="nv">sf</span> : state) (<span class="nv">iom</span>
                      <span class="nv">oom</span> : 
                      option message) 
        (<span class="nv">l</span> : label),
        input_valid_transition l
          (finite_trace_last si tr, iom)
          (sf, oom)
        ‚Üí <span class="kr">let</span> <span class="nv">x</span> :=
            {|
              l := l;
              input := iom;
              destination := sf;
              output := oom
            |} <span class="kr">in</span>
          P si (tr ++ [x])</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="kr">‚àÄ</span> (<span class="nv">si</span> : state) (<span class="nv">tr</span> : list transition_item),
  finite_valid_trace si tr ‚Üí P si tr</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="VLSM-v-chk1ab" style="display: none" type="checkbox"><label class="alectryon-input" for="VLSM-v-chk1ab"><span class="kn">Proof</span>.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>message</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>X</var><span class="hyp-type"><b>: </b><span>VLSM message</span></span></span><br><span><var>TypeX</var><span><span class="hyp-body"><b>:= </b><span>type X</span></span><span class="hyp-type"><b>: </b><span>VLSMType message</span></span></span></span><br><span><var>MachineX</var><span><span class="hyp-body"><b>:= </b><span>machine X</span></span><span class="hyp-type"><b>: </b><span>VLSMMachine (vtype X)</span></span></span></span><br><span><var>P</var><span class="hyp-type"><b>: </b><span>state ‚Üí list transition_item ‚Üí <span class="kt">Prop</span></span></span></span><br><span><var>Hempty</var><span class="hyp-type"><b>: </b><span><span class="kr">‚àÄ</span> <span class="nv">si</span> : state, initial_state_prop si ‚Üí P si []</span></span></span><br><span><var>Hextend</var><span class="hyp-type"><b>: </b><span><span class="kr">‚àÄ</span> (<span class="nv">si</span> : state) (<span class="nv">tr</span> : list transition_item),
  finite_valid_trace si tr
  ‚Üí P si tr
    ‚Üí <span class="kr">‚àÄ</span> (<span class="nv">sf</span> : state) (<span class="nv">iom</span>
                      <span class="nv">oom</span> : 
                      option message) 
        (<span class="nv">l</span> : label),
        input_valid_transition l
          (finite_trace_last si tr, iom)
          (sf, oom)
        ‚Üí <span class="kr">let</span> <span class="nv">x</span> :=
            {|
              l := l;
              input := iom;
              destination := sf;
              output := oom
            |} <span class="kr">in</span>
          P si (tr ++ [x])</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="kr">‚àÄ</span> (<span class="nv">si</span> : state) (<span class="nv">tr</span> : list transition_item),
  finite_valid_trace si tr ‚Üí P si tr</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">      </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="VLSM-v-chk1ac" style="display: none" type="checkbox"><label class="alectryon-input" for="VLSM-v-chk1ac"><span class="nb">intros</span> si tr [Htr Hinit].</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>message</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>X</var><span class="hyp-type"><b>: </b><span>VLSM message</span></span></span><br><span><var>TypeX</var><span><span class="hyp-body"><b>:= </b><span>type X</span></span><span class="hyp-type"><b>: </b><span>VLSMType message</span></span></span></span><br><span><var>MachineX</var><span><span class="hyp-body"><b>:= </b><span>machine X</span></span><span class="hyp-type"><b>: </b><span>VLSMMachine (vtype X)</span></span></span></span><br><span><var>P</var><span class="hyp-type"><b>: </b><span>state ‚Üí list transition_item ‚Üí <span class="kt">Prop</span></span></span></span><br><span><var>Hempty</var><span class="hyp-type"><b>: </b><span><span class="kr">‚àÄ</span> <span class="nv">si</span> : state, initial_state_prop si ‚Üí P si []</span></span></span><br><span><var>Hextend</var><span class="hyp-type"><b>: </b><span><span class="kr">‚àÄ</span> (<span class="nv">si</span> : state) (<span class="nv">tr</span> : list transition_item),
  finite_valid_trace si tr
  ‚Üí P si tr
    ‚Üí <span class="kr">‚àÄ</span> (<span class="nv">sf</span> : state) (<span class="nv">iom</span>
                      <span class="nv">oom</span> : 
                      option message) 
        (<span class="nv">l</span> : label),
        input_valid_transition l
          (finite_trace_last si tr, iom)
          (sf, oom)
        ‚Üí <span class="kr">let</span> <span class="nv">x</span> :=
            {|
              l := l;
              input := iom;
              destination := sf;
              output := oom
            |} <span class="kr">in</span>
          P si (tr ++ [x])</span></span></span><br><span><var>si</var><span class="hyp-type"><b>: </b><span>state</span></span></span><br><span><var>tr</var><span class="hyp-type"><b>: </b><span>list transition_item</span></span></span><br><span><var>Htr</var><span class="hyp-type"><b>: </b><span>finite_valid_trace_from si tr</span></span></span><br><span><var>Hinit</var><span class="hyp-type"><b>: </b><span>initial_state_prop si</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">P si tr</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">      </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="VLSM-v-chk1ad" style="display: none" type="checkbox"><label class="alectryon-input" for="VLSM-v-chk1ad"><span class="nb">induction</span> Htr <span class="nb">using</span> finite_valid_trace_from_rev_ind.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>message</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>X</var><span class="hyp-type"><b>: </b><span>VLSM message</span></span></span><br><span><var>TypeX</var><span><span class="hyp-body"><b>:= </b><span>type X</span></span><span class="hyp-type"><b>: </b><span>VLSMType message</span></span></span></span><br><span><var>MachineX</var><span><span class="hyp-body"><b>:= </b><span>machine X</span></span><span class="hyp-type"><b>: </b><span>VLSMMachine (vtype X)</span></span></span></span><br><span><var>P</var><span class="hyp-type"><b>: </b><span>state ‚Üí list transition_item ‚Üí <span class="kt">Prop</span></span></span></span><br><span><var>Hempty</var><span class="hyp-type"><b>: </b><span><span class="kr">‚àÄ</span> <span class="nv">si</span> : state, initial_state_prop si ‚Üí P si []</span></span></span><br><span><var>Hextend</var><span class="hyp-type"><b>: </b><span><span class="kr">‚àÄ</span> (<span class="nv">si</span> : state) (<span class="nv">tr</span> : list transition_item),
  finite_valid_trace si tr
  ‚Üí P si tr
    ‚Üí <span class="kr">‚àÄ</span> (<span class="nv">sf</span> : state) (<span class="nv">iom</span>
                      <span class="nv">oom</span> : 
                      option message) 
        (<span class="nv">l</span> : label),
        input_valid_transition l
          (finite_trace_last si tr, iom)
          (sf, oom)
        ‚Üí <span class="kr">let</span> <span class="nv">x</span> :=
            {|
              l := l;
              input := iom;
              destination := sf;
              output := oom
            |} <span class="kr">in</span>
          P si (tr ++ [x])</span></span></span><br><span><var>s</var><span class="hyp-type"><b>: </b><span>state</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>valid_state_prop s</span></span></span><br><span><var>Hinit</var><span class="hyp-type"><b>: </b><span>initial_state_prop s</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">P s []</div></blockquote><div class="alectryon-extra-goals"><input class="alectryon-extra-goal-toggle" id="VLSM-v-chk1ae" style="display: none" type="checkbox"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>message</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>X</var><span class="hyp-type"><b>: </b><span>VLSM message</span></span></span><br><span><var>TypeX</var><span><span class="hyp-body"><b>:= </b><span>type X</span></span><span class="hyp-type"><b>: </b><span>VLSMType message</span></span></span></span><br><span><var>MachineX</var><span><span class="hyp-body"><b>:= </b><span>machine X</span></span><span class="hyp-type"><b>: </b><span>VLSMMachine (vtype X)</span></span></span></span><br><span><var>P</var><span class="hyp-type"><b>: </b><span>state ‚Üí list transition_item ‚Üí <span class="kt">Prop</span></span></span></span><br><span><var>Hempty</var><span class="hyp-type"><b>: </b><span><span class="kr">‚àÄ</span> <span class="nv">si</span> : state, initial_state_prop si ‚Üí P si []</span></span></span><br><span><var>Hextend</var><span class="hyp-type"><b>: </b><span><span class="kr">‚àÄ</span> (<span class="nv">si</span> : state) (<span class="nv">tr</span> : list transition_item),
  finite_valid_trace si tr
  ‚Üí P si tr
    ‚Üí <span class="kr">‚àÄ</span> (<span class="nv">sf</span> : state) (<span class="nv">iom</span>
                      <span class="nv">oom</span> : 
                      option message) 
        (<span class="nv">l</span> : label),
        input_valid_transition l
          (finite_trace_last si tr, iom)
          (sf, oom)
        ‚Üí <span class="kr">let</span> <span class="nv">x</span> :=
            {|
              l := l;
              input := iom;
              destination := sf;
              output := oom
            |} <span class="kr">in</span>
          P si (tr ++ [x])</span></span></span><br><span><var>s</var><span class="hyp-type"><b>: </b><span>state</span></span></span><br><span><var>tr</var><span class="hyp-type"><b>: </b><span>list transition_item</span></span></span><br><span><var>Htr</var><span class="hyp-type"><b>: </b><span>finite_valid_trace_from s tr</span></span></span><br><span><var>sf</var><span class="hyp-type"><b>: </b><span>state</span></span></span><br><span><var>iom, oom</var><span class="hyp-type"><b>: </b><span>option message</span></span></span><br><span><var>l0</var><span class="hyp-type"><b>: </b><span>label</span></span></span><br><span><var>Hx</var><span class="hyp-type"><b>: </b><span>input_valid_transition l0
  (finite_trace_last s tr, iom) 
  (sf, oom)</span></span></span><br><span><var>x</var><span><span class="hyp-body"><b>:= </b><span>{|
  l := l0;
  input := iom;
  destination := sf;
  output := oom
|}</span></span><span class="hyp-type"><b>: </b><span>transition_item</span></span></span></span><br><span><var>Hinit</var><span class="hyp-type"><b>: </b><span>initial_state_prop s</span></span></span><br><span><var>IHHtr</var><span class="hyp-type"><b>: </b><span>initial_state_prop s ‚Üí P s tr</span></span></span><br></div><label class="goal-separator" for="VLSM-v-chk1ae"><hr></label><div class="goal-conclusion">P s (tr ++ [x])</div></blockquote></div></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">      </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="VLSM-v-chk1af" style="display: none" type="checkbox"><label class="alectryon-input" for="VLSM-v-chk1af">-</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>message</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>X</var><span class="hyp-type"><b>: </b><span>VLSM message</span></span></span><br><span><var>TypeX</var><span><span class="hyp-body"><b>:= </b><span>type X</span></span><span class="hyp-type"><b>: </b><span>VLSMType message</span></span></span></span><br><span><var>MachineX</var><span><span class="hyp-body"><b>:= </b><span>machine X</span></span><span class="hyp-type"><b>: </b><span>VLSMMachine (vtype X)</span></span></span></span><br><span><var>P</var><span class="hyp-type"><b>: </b><span>state ‚Üí list transition_item ‚Üí <span class="kt">Prop</span></span></span></span><br><span><var>Hempty</var><span class="hyp-type"><b>: </b><span><span class="kr">‚àÄ</span> <span class="nv">si</span> : state, initial_state_prop si ‚Üí P si []</span></span></span><br><span><var>Hextend</var><span class="hyp-type"><b>: </b><span><span class="kr">‚àÄ</span> (<span class="nv">si</span> : state) (<span class="nv">tr</span> : list transition_item),
  finite_valid_trace si tr
  ‚Üí P si tr
    ‚Üí <span class="kr">‚àÄ</span> (<span class="nv">sf</span> : state) (<span class="nv">iom</span>
                      <span class="nv">oom</span> : 
                      option message) 
        (<span class="nv">l</span> : label),
        input_valid_transition l
          (finite_trace_last si tr, iom)
          (sf, oom)
        ‚Üí <span class="kr">let</span> <span class="nv">x</span> :=
            {|
              l := l;
              input := iom;
              destination := sf;
              output := oom
            |} <span class="kr">in</span>
          P si (tr ++ [x])</span></span></span><br><span><var>s</var><span class="hyp-type"><b>: </b><span>state</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>valid_state_prop s</span></span></span><br><span><var>Hinit</var><span class="hyp-type"><b>: </b><span>initial_state_prop s</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">P s []</div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="nb">apply</span> Hempty;<span class="nb">auto</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">      </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="VLSM-v-chk1b0" style="display: none" type="checkbox"><label class="alectryon-input" for="VLSM-v-chk1b0">-</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>message</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>X</var><span class="hyp-type"><b>: </b><span>VLSM message</span></span></span><br><span><var>TypeX</var><span><span class="hyp-body"><b>:= </b><span>type X</span></span><span class="hyp-type"><b>: </b><span>VLSMType message</span></span></span></span><br><span><var>MachineX</var><span><span class="hyp-body"><b>:= </b><span>machine X</span></span><span class="hyp-type"><b>: </b><span>VLSMMachine (vtype X)</span></span></span></span><br><span><var>P</var><span class="hyp-type"><b>: </b><span>state ‚Üí list transition_item ‚Üí <span class="kt">Prop</span></span></span></span><br><span><var>Hempty</var><span class="hyp-type"><b>: </b><span><span class="kr">‚àÄ</span> <span class="nv">si</span> : state, initial_state_prop si ‚Üí P si []</span></span></span><br><span><var>Hextend</var><span class="hyp-type"><b>: </b><span><span class="kr">‚àÄ</span> (<span class="nv">si</span> : state) (<span class="nv">tr</span> : list transition_item),
  finite_valid_trace si tr
  ‚Üí P si tr
    ‚Üí <span class="kr">‚àÄ</span> (<span class="nv">sf</span> : state) (<span class="nv">iom</span>
                      <span class="nv">oom</span> : 
                      option message) 
        (<span class="nv">l</span> : label),
        input_valid_transition l
          (finite_trace_last si tr, iom)
          (sf, oom)
        ‚Üí <span class="kr">let</span> <span class="nv">x</span> :=
            {|
              l := l;
              input := iom;
              destination := sf;
              output := oom
            |} <span class="kr">in</span>
          P si (tr ++ [x])</span></span></span><br><span><var>s</var><span class="hyp-type"><b>: </b><span>state</span></span></span><br><span><var>tr</var><span class="hyp-type"><b>: </b><span>list transition_item</span></span></span><br><span><var>Htr</var><span class="hyp-type"><b>: </b><span>finite_valid_trace_from s tr</span></span></span><br><span><var>sf</var><span class="hyp-type"><b>: </b><span>state</span></span></span><br><span><var>iom, oom</var><span class="hyp-type"><b>: </b><span>option message</span></span></span><br><span><var>l0</var><span class="hyp-type"><b>: </b><span>label</span></span></span><br><span><var>Hx</var><span class="hyp-type"><b>: </b><span>input_valid_transition l0
  (finite_trace_last s tr, iom) 
  (sf, oom)</span></span></span><br><span><var>x</var><span><span class="hyp-body"><b>:= </b><span>{|
  l := l0;
  input := iom;
  destination := sf;
  output := oom
|}</span></span><span class="hyp-type"><b>: </b><span>transition_item</span></span></span></span><br><span><var>Hinit</var><span class="hyp-type"><b>: </b><span>initial_state_prop s</span></span></span><br><span><var>IHHtr</var><span class="hyp-type"><b>: </b><span>initial_state_prop s ‚Üí P s tr</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">P s (tr ++ [x])</div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="nb">apply</span> Hextend;[<span class="nb">split</span>|..];<span class="nb">auto</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Qed</span>.</span></span></pre><div class="doc">
Several other lemmas in this vein are necessary for proving results regarding
traces.

</div><pre class="alectryon-io highlight"><!-- Generator: Alectryon --><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="VLSM-v-chk1b1" style="display: none" type="checkbox"><label class="alectryon-input" for="VLSM-v-chk1b1"><span class="kn">Lemma</span> <span class="nf">finite_valid_trace_from_prefix</span>
      (<span class="nv">s</span> : state)
      (<span class="nv">ls</span> : list transition_item)
      (<span class="nv">Htr</span> : finite_valid_trace_from s ls)
      (<span class="nv">n</span> : nat)
      : finite_valid_trace_from s (list_prefix ls n).</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>message</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>X</var><span class="hyp-type"><b>: </b><span>VLSM message</span></span></span><br><span><var>TypeX</var><span><span class="hyp-body"><b>:= </b><span>type X</span></span><span class="hyp-type"><b>: </b><span>VLSMType message</span></span></span></span><br><span><var>MachineX</var><span><span class="hyp-body"><b>:= </b><span>machine X</span></span><span class="hyp-type"><b>: </b><span>VLSMMachine (vtype X)</span></span></span></span><br><span><var>s</var><span class="hyp-type"><b>: </b><span>state</span></span></span><br><span><var>ls</var><span class="hyp-type"><b>: </b><span>list transition_item</span></span></span><br><span><var>Htr</var><span class="hyp-type"><b>: </b><span>finite_valid_trace_from s ls</span></span></span><br><span><var>n</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">finite_valid_trace_from s (list_prefix ls n)</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="VLSM-v-chk1b2" style="display: none" type="checkbox"><label class="alectryon-input" for="VLSM-v-chk1b2"><span class="kn">Proof</span>.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>message</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>X</var><span class="hyp-type"><b>: </b><span>VLSM message</span></span></span><br><span><var>TypeX</var><span><span class="hyp-body"><b>:= </b><span>type X</span></span><span class="hyp-type"><b>: </b><span>VLSMType message</span></span></span></span><br><span><var>MachineX</var><span><span class="hyp-body"><b>:= </b><span>machine X</span></span><span class="hyp-type"><b>: </b><span>VLSMMachine (vtype X)</span></span></span></span><br><span><var>s</var><span class="hyp-type"><b>: </b><span>state</span></span></span><br><span><var>ls</var><span class="hyp-type"><b>: </b><span>list transition_item</span></span></span><br><span><var>Htr</var><span class="hyp-type"><b>: </b><span>finite_valid_trace_from s ls</span></span></span><br><span><var>n</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">finite_valid_trace_from s (list_prefix ls n)</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">      </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="VLSM-v-chk1b3" style="display: none" type="checkbox"><label class="alectryon-input" for="VLSM-v-chk1b3"><span class="nb">specialize</span> (list_prefix_suffix ls n); <span class="nb">intro</span> Hdecompose.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>message</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>X</var><span class="hyp-type"><b>: </b><span>VLSM message</span></span></span><br><span><var>TypeX</var><span><span class="hyp-body"><b>:= </b><span>type X</span></span><span class="hyp-type"><b>: </b><span>VLSMType message</span></span></span></span><br><span><var>MachineX</var><span><span class="hyp-body"><b>:= </b><span>machine X</span></span><span class="hyp-type"><b>: </b><span>VLSMMachine (vtype X)</span></span></span></span><br><span><var>s</var><span class="hyp-type"><b>: </b><span>state</span></span></span><br><span><var>ls</var><span class="hyp-type"><b>: </b><span>list transition_item</span></span></span><br><span><var>Htr</var><span class="hyp-type"><b>: </b><span>finite_valid_trace_from s ls</span></span></span><br><span><var>n</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>Hdecompose</var><span class="hyp-type"><b>: </b><span>list_prefix ls n ++ list_suffix ls n = ls</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">finite_valid_trace_from s (list_prefix ls n)</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">      </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="VLSM-v-chk1b4" style="display: none" type="checkbox"><label class="alectryon-input" for="VLSM-v-chk1b4"><span class="nb">rewrite</span> &lt;- Hdecompose <span class="kr">in</span> Htr.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>message</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>X</var><span class="hyp-type"><b>: </b><span>VLSM message</span></span></span><br><span><var>TypeX</var><span><span class="hyp-body"><b>:= </b><span>type X</span></span><span class="hyp-type"><b>: </b><span>VLSMType message</span></span></span></span><br><span><var>MachineX</var><span><span class="hyp-body"><b>:= </b><span>machine X</span></span><span class="hyp-type"><b>: </b><span>VLSMMachine (vtype X)</span></span></span></span><br><span><var>s</var><span class="hyp-type"><b>: </b><span>state</span></span></span><br><span><var>ls</var><span class="hyp-type"><b>: </b><span>list transition_item</span></span></span><br><span><var>n</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>Htr</var><span class="hyp-type"><b>: </b><span>finite_valid_trace_from s
  (list_prefix ls n ++ list_suffix ls n)</span></span></span><br><span><var>Hdecompose</var><span class="hyp-type"><b>: </b><span>list_prefix ls n ++ list_suffix ls n = ls</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">finite_valid_trace_from s (list_prefix ls n)</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">      </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="VLSM-v-chk1b5" style="display: none" type="checkbox"><label class="alectryon-input" for="VLSM-v-chk1b5"><span class="nb">apply</span> finite_valid_trace_from_app_iff <span class="kr">in</span> Htr.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>message</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>X</var><span class="hyp-type"><b>: </b><span>VLSM message</span></span></span><br><span><var>TypeX</var><span><span class="hyp-body"><b>:= </b><span>type X</span></span><span class="hyp-type"><b>: </b><span>VLSMType message</span></span></span></span><br><span><var>MachineX</var><span><span class="hyp-body"><b>:= </b><span>machine X</span></span><span class="hyp-type"><b>: </b><span>VLSMMachine (vtype X)</span></span></span></span><br><span><var>s</var><span class="hyp-type"><b>: </b><span>state</span></span></span><br><span><var>ls</var><span class="hyp-type"><b>: </b><span>list transition_item</span></span></span><br><span><var>n</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>Htr</var><span class="hyp-type"><b>: </b><span>finite_valid_trace_from s (list_prefix ls n)
‚àß finite_valid_trace_from
    (finite_trace_last s (list_prefix ls n))
    (list_suffix ls n)</span></span></span><br><span><var>Hdecompose</var><span class="hyp-type"><b>: </b><span>list_prefix ls n ++ list_suffix ls n = ls</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">finite_valid_trace_from s (list_prefix ls n)</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">      </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="VLSM-v-chk1b6" style="display: none" type="checkbox"><label class="alectryon-input" for="VLSM-v-chk1b6"><span class="nb">destruct</span> Htr <span class="kr">as</span> [Hpr _].</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>message</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>X</var><span class="hyp-type"><b>: </b><span>VLSM message</span></span></span><br><span><var>TypeX</var><span><span class="hyp-body"><b>:= </b><span>type X</span></span><span class="hyp-type"><b>: </b><span>VLSMType message</span></span></span></span><br><span><var>MachineX</var><span><span class="hyp-body"><b>:= </b><span>machine X</span></span><span class="hyp-type"><b>: </b><span>VLSMMachine (vtype X)</span></span></span></span><br><span><var>s</var><span class="hyp-type"><b>: </b><span>state</span></span></span><br><span><var>ls</var><span class="hyp-type"><b>: </b><span>list transition_item</span></span></span><br><span><var>n</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>Hpr</var><span class="hyp-type"><b>: </b><span>finite_valid_trace_from s (list_prefix ls n)</span></span></span><br><span><var>Hdecompose</var><span class="hyp-type"><b>: </b><span>list_prefix ls n ++ list_suffix ls n = ls</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">finite_valid_trace_from s (list_prefix ls n)</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">      </span><span class="alectryon-sentence"><span class="alectryon-input"><span class="bp">assumption</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Qed</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
</span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="VLSM-v-chk1b7" style="display: none" type="checkbox"><label class="alectryon-input" for="VLSM-v-chk1b7"><span class="kn">Lemma</span> <span class="nf">finite_valid_trace_from_suffix</span>
      (<span class="nv">s</span> : state)
      (<span class="nv">ls</span> : list transition_item)
      (<span class="nv">Htr</span> : finite_valid_trace_from s ls)
      (<span class="nv">n</span> : nat)
      (<span class="nv">nth</span> : state)
      (<span class="nv">Hnth</span> : finite_trace_nth s ls n = Some nth)
      : finite_valid_trace_from nth (list_suffix ls n).</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>message</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>X</var><span class="hyp-type"><b>: </b><span>VLSM message</span></span></span><br><span><var>TypeX</var><span><span class="hyp-body"><b>:= </b><span>type X</span></span><span class="hyp-type"><b>: </b><span>VLSMType message</span></span></span></span><br><span><var>MachineX</var><span><span class="hyp-body"><b>:= </b><span>machine X</span></span><span class="hyp-type"><b>: </b><span>VLSMMachine (vtype X)</span></span></span></span><br><span><var>s</var><span class="hyp-type"><b>: </b><span>state</span></span></span><br><span><var>ls</var><span class="hyp-type"><b>: </b><span>list transition_item</span></span></span><br><span><var>Htr</var><span class="hyp-type"><b>: </b><span>finite_valid_trace_from s ls</span></span></span><br><span><var>n</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>nth</var><span class="hyp-type"><b>: </b><span>state</span></span></span><br><span><var>Hnth</var><span class="hyp-type"><b>: </b><span>finite_trace_nth s ls n = Some nth</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">finite_valid_trace_from nth (list_suffix ls n)</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="VLSM-v-chk1b8" style="display: none" type="checkbox"><label class="alectryon-input" for="VLSM-v-chk1b8"><span class="kn">Proof</span>.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>message</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>X</var><span class="hyp-type"><b>: </b><span>VLSM message</span></span></span><br><span><var>TypeX</var><span><span class="hyp-body"><b>:= </b><span>type X</span></span><span class="hyp-type"><b>: </b><span>VLSMType message</span></span></span></span><br><span><var>MachineX</var><span><span class="hyp-body"><b>:= </b><span>machine X</span></span><span class="hyp-type"><b>: </b><span>VLSMMachine (vtype X)</span></span></span></span><br><span><var>s</var><span class="hyp-type"><b>: </b><span>state</span></span></span><br><span><var>ls</var><span class="hyp-type"><b>: </b><span>list transition_item</span></span></span><br><span><var>Htr</var><span class="hyp-type"><b>: </b><span>finite_valid_trace_from s ls</span></span></span><br><span><var>n</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>nth</var><span class="hyp-type"><b>: </b><span>state</span></span></span><br><span><var>Hnth</var><span class="hyp-type"><b>: </b><span>finite_trace_nth s ls n = Some nth</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">finite_valid_trace_from nth (list_suffix ls n)</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">      </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="VLSM-v-chk1b9" style="display: none" type="checkbox"><label class="alectryon-input" for="VLSM-v-chk1b9"><span class="nb">rewrite</span> &lt;- (list_prefix_suffix ls n) <span class="kr">in</span> Htr.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>message</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>X</var><span class="hyp-type"><b>: </b><span>VLSM message</span></span></span><br><span><var>TypeX</var><span><span class="hyp-body"><b>:= </b><span>type X</span></span><span class="hyp-type"><b>: </b><span>VLSMType message</span></span></span></span><br><span><var>MachineX</var><span><span class="hyp-body"><b>:= </b><span>machine X</span></span><span class="hyp-type"><b>: </b><span>VLSMMachine (vtype X)</span></span></span></span><br><span><var>s</var><span class="hyp-type"><b>: </b><span>state</span></span></span><br><span><var>ls</var><span class="hyp-type"><b>: </b><span>list transition_item</span></span></span><br><span><var>n</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>Htr</var><span class="hyp-type"><b>: </b><span>finite_valid_trace_from s
  (list_prefix ls n ++ list_suffix ls n)</span></span></span><br><span><var>nth</var><span class="hyp-type"><b>: </b><span>state</span></span></span><br><span><var>Hnth</var><span class="hyp-type"><b>: </b><span>finite_trace_nth s ls n = Some nth</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">finite_valid_trace_from nth (list_suffix ls n)</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">      </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="VLSM-v-chk1ba" style="display: none" type="checkbox"><label class="alectryon-input" for="VLSM-v-chk1ba"><span class="nb">apply</span> finite_valid_trace_from_app_iff <span class="kr">in</span> Htr.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>message</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>X</var><span class="hyp-type"><b>: </b><span>VLSM message</span></span></span><br><span><var>TypeX</var><span><span class="hyp-body"><b>:= </b><span>type X</span></span><span class="hyp-type"><b>: </b><span>VLSMType message</span></span></span></span><br><span><var>MachineX</var><span><span class="hyp-body"><b>:= </b><span>machine X</span></span><span class="hyp-type"><b>: </b><span>VLSMMachine (vtype X)</span></span></span></span><br><span><var>s</var><span class="hyp-type"><b>: </b><span>state</span></span></span><br><span><var>ls</var><span class="hyp-type"><b>: </b><span>list transition_item</span></span></span><br><span><var>n</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>Htr</var><span class="hyp-type"><b>: </b><span>finite_valid_trace_from s (list_prefix ls n)
‚àß finite_valid_trace_from
    (finite_trace_last s (list_prefix ls n))
    (list_suffix ls n)</span></span></span><br><span><var>nth</var><span class="hyp-type"><b>: </b><span>state</span></span></span><br><span><var>Hnth</var><span class="hyp-type"><b>: </b><span>finite_trace_nth s ls n = Some nth</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">finite_valid_trace_from nth (list_suffix ls n)</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">      </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="VLSM-v-chk1bb" style="display: none" type="checkbox"><label class="alectryon-input" for="VLSM-v-chk1bb"><span class="nb">destruct</span> Htr <span class="kr">as</span> [_ Htr].</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>message</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>X</var><span class="hyp-type"><b>: </b><span>VLSM message</span></span></span><br><span><var>TypeX</var><span><span class="hyp-body"><b>:= </b><span>type X</span></span><span class="hyp-type"><b>: </b><span>VLSMType message</span></span></span></span><br><span><var>MachineX</var><span><span class="hyp-body"><b>:= </b><span>machine X</span></span><span class="hyp-type"><b>: </b><span>VLSMMachine (vtype X)</span></span></span></span><br><span><var>s</var><span class="hyp-type"><b>: </b><span>state</span></span></span><br><span><var>ls</var><span class="hyp-type"><b>: </b><span>list transition_item</span></span></span><br><span><var>n</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>Htr</var><span class="hyp-type"><b>: </b><span>finite_valid_trace_from
  (finite_trace_last s (list_prefix ls n))
  (list_suffix ls n)</span></span></span><br><span><var>nth</var><span class="hyp-type"><b>: </b><span>state</span></span></span><br><span><var>Hnth</var><span class="hyp-type"><b>: </b><span>finite_trace_nth s ls n = Some nth</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">finite_valid_trace_from nth (list_suffix ls n)</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">      </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="VLSM-v-chk1bc" style="display: none" type="checkbox"><label class="alectryon-input" for="VLSM-v-chk1bc"><span class="nb">replace</span> (finite_trace_last s (list_prefix ls n)) <span class="kr">with</span> nth <span class="kr">in</span> Htr;[<span class="bp">assumption</span>|].</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>message</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>X</var><span class="hyp-type"><b>: </b><span>VLSM message</span></span></span><br><span><var>TypeX</var><span><span class="hyp-body"><b>:= </b><span>type X</span></span><span class="hyp-type"><b>: </b><span>VLSMType message</span></span></span></span><br><span><var>MachineX</var><span><span class="hyp-body"><b>:= </b><span>machine X</span></span><span class="hyp-type"><b>: </b><span>VLSMMachine (vtype X)</span></span></span></span><br><span><var>s</var><span class="hyp-type"><b>: </b><span>state</span></span></span><br><span><var>ls</var><span class="hyp-type"><b>: </b><span>list transition_item</span></span></span><br><span><var>n</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>Htr</var><span class="hyp-type"><b>: </b><span>finite_valid_trace_from
  (finite_trace_last s (list_prefix ls n))
  (list_suffix ls n)</span></span></span><br><span><var>nth</var><span class="hyp-type"><b>: </b><span>state</span></span></span><br><span><var>Hnth</var><span class="hyp-type"><b>: </b><span>finite_trace_nth s ls n = Some nth</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">nth = finite_trace_last s (list_prefix ls n)</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">      </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="VLSM-v-chk1bd" style="display: none" type="checkbox"><label class="alectryon-input" for="VLSM-v-chk1bd">{</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>message</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>X</var><span class="hyp-type"><b>: </b><span>VLSM message</span></span></span><br><span><var>TypeX</var><span><span class="hyp-body"><b>:= </b><span>type X</span></span><span class="hyp-type"><b>: </b><span>VLSMType message</span></span></span></span><br><span><var>MachineX</var><span><span class="hyp-body"><b>:= </b><span>machine X</span></span><span class="hyp-type"><b>: </b><span>VLSMMachine (vtype X)</span></span></span></span><br><span><var>s</var><span class="hyp-type"><b>: </b><span>state</span></span></span><br><span><var>ls</var><span class="hyp-type"><b>: </b><span>list transition_item</span></span></span><br><span><var>n</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>Htr</var><span class="hyp-type"><b>: </b><span>finite_valid_trace_from
  (finite_trace_last s (list_prefix ls n))
  (list_suffix ls n)</span></span></span><br><span><var>nth</var><span class="hyp-type"><b>: </b><span>state</span></span></span><br><span><var>Hnth</var><span class="hyp-type"><b>: </b><span>finite_trace_nth s ls n = Some nth</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">nth = finite_trace_last s (list_prefix ls n)</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">        </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="VLSM-v-chk1be" style="display: none" type="checkbox"><label class="alectryon-input" for="VLSM-v-chk1be"><span class="nb">destruct</span> n.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>message</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>X</var><span class="hyp-type"><b>: </b><span>VLSM message</span></span></span><br><span><var>TypeX</var><span><span class="hyp-body"><b>:= </b><span>type X</span></span><span class="hyp-type"><b>: </b><span>VLSMType message</span></span></span></span><br><span><var>MachineX</var><span><span class="hyp-body"><b>:= </b><span>machine X</span></span><span class="hyp-type"><b>: </b><span>VLSMMachine (vtype X)</span></span></span></span><br><span><var>s</var><span class="hyp-type"><b>: </b><span>state</span></span></span><br><span><var>ls</var><span class="hyp-type"><b>: </b><span>list transition_item</span></span></span><br><span><var>Htr</var><span class="hyp-type"><b>: </b><span>finite_valid_trace_from
  (finite_trace_last s (list_prefix ls <span class="mi">0</span>))
  (list_suffix ls <span class="mi">0</span>)</span></span></span><br><span><var>nth</var><span class="hyp-type"><b>: </b><span>state</span></span></span><br><span><var>Hnth</var><span class="hyp-type"><b>: </b><span>finite_trace_nth s ls <span class="mi">0</span> = Some nth</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">nth = finite_trace_last s (list_prefix ls <span class="mi">0</span>)</div></blockquote><div class="alectryon-extra-goals"><input class="alectryon-extra-goal-toggle" id="VLSM-v-chk1bf" style="display: none" type="checkbox"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>message</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>X</var><span class="hyp-type"><b>: </b><span>VLSM message</span></span></span><br><span><var>TypeX</var><span><span class="hyp-body"><b>:= </b><span>type X</span></span><span class="hyp-type"><b>: </b><span>VLSMType message</span></span></span></span><br><span><var>MachineX</var><span><span class="hyp-body"><b>:= </b><span>machine X</span></span><span class="hyp-type"><b>: </b><span>VLSMMachine (vtype X)</span></span></span></span><br><span><var>s</var><span class="hyp-type"><b>: </b><span>state</span></span></span><br><span><var>ls</var><span class="hyp-type"><b>: </b><span>list transition_item</span></span></span><br><span><var>n</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>Htr</var><span class="hyp-type"><b>: </b><span>finite_valid_trace_from
  (finite_trace_last s (list_prefix ls (S n)))
  (list_suffix ls (S n))</span></span></span><br><span><var>nth</var><span class="hyp-type"><b>: </b><span>state</span></span></span><br><span><var>Hnth</var><span class="hyp-type"><b>: </b><span>finite_trace_nth s ls (S n) = Some nth</span></span></span><br></div><label class="goal-separator" for="VLSM-v-chk1bf"><hr></label><div class="goal-conclusion">nth = finite_trace_last s (list_prefix ls (S n))</div></blockquote></div></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">        </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="VLSM-v-chk1c0" style="display: none" type="checkbox"><label class="alectryon-input" for="VLSM-v-chk1c0">-</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>message</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>X</var><span class="hyp-type"><b>: </b><span>VLSM message</span></span></span><br><span><var>TypeX</var><span><span class="hyp-body"><b>:= </b><span>type X</span></span><span class="hyp-type"><b>: </b><span>VLSMType message</span></span></span></span><br><span><var>MachineX</var><span><span class="hyp-body"><b>:= </b><span>machine X</span></span><span class="hyp-type"><b>: </b><span>VLSMMachine (vtype X)</span></span></span></span><br><span><var>s</var><span class="hyp-type"><b>: </b><span>state</span></span></span><br><span><var>ls</var><span class="hyp-type"><b>: </b><span>list transition_item</span></span></span><br><span><var>Htr</var><span class="hyp-type"><b>: </b><span>finite_valid_trace_from
  (finite_trace_last s (list_prefix ls <span class="mi">0</span>))
  (list_suffix ls <span class="mi">0</span>)</span></span></span><br><span><var>nth</var><span class="hyp-type"><b>: </b><span>state</span></span></span><br><span><var>Hnth</var><span class="hyp-type"><b>: </b><span>finite_trace_nth s ls <span class="mi">0</span> = Some nth</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">nth = finite_trace_last s (list_prefix ls <span class="mi">0</span>)</div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="VLSM-v-chk1c1" style="display: none" type="checkbox"><label class="alectryon-input" for="VLSM-v-chk1c1"><span class="nb">rewrite</span> finite_trace_nth_first <span class="kr">in</span> Hnth.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>message</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>X</var><span class="hyp-type"><b>: </b><span>VLSM message</span></span></span><br><span><var>TypeX</var><span><span class="hyp-body"><b>:= </b><span>type X</span></span><span class="hyp-type"><b>: </b><span>VLSMType message</span></span></span></span><br><span><var>MachineX</var><span><span class="hyp-body"><b>:= </b><span>machine X</span></span><span class="hyp-type"><b>: </b><span>VLSMMachine (vtype X)</span></span></span></span><br><span><var>s</var><span class="hyp-type"><b>: </b><span>state</span></span></span><br><span><var>ls</var><span class="hyp-type"><b>: </b><span>list transition_item</span></span></span><br><span><var>Htr</var><span class="hyp-type"><b>: </b><span>finite_valid_trace_from
  (finite_trace_last s (list_prefix ls <span class="mi">0</span>))
  (list_suffix ls <span class="mi">0</span>)</span></span></span><br><span><var>nth</var><span class="hyp-type"><b>: </b><span>state</span></span></span><br><span><var>Hnth</var><span class="hyp-type"><b>: </b><span>Some s = Some nth</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">nth = finite_trace_last s (list_prefix ls <span class="mi">0</span>)</div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="VLSM-v-chk1c2" style="display: none" type="checkbox"><label class="alectryon-input" for="VLSM-v-chk1c2"><span class="nb">injection</span> Hnth <span class="kr">as</span> -&gt;.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>message</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>X</var><span class="hyp-type"><b>: </b><span>VLSM message</span></span></span><br><span><var>TypeX</var><span><span class="hyp-body"><b>:= </b><span>type X</span></span><span class="hyp-type"><b>: </b><span>VLSMType message</span></span></span></span><br><span><var>MachineX</var><span><span class="hyp-body"><b>:= </b><span>machine X</span></span><span class="hyp-type"><b>: </b><span>VLSMMachine (vtype X)</span></span></span></span><br><span><var>ls</var><span class="hyp-type"><b>: </b><span>list transition_item</span></span></span><br><span><var>nth</var><span class="hyp-type"><b>: </b><span>state</span></span></span><br><span><var>Htr</var><span class="hyp-type"><b>: </b><span>finite_valid_trace_from
  (finite_trace_last nth (list_prefix ls <span class="mi">0</span>))
  (list_suffix ls <span class="mi">0</span>)</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">nth = finite_trace_last nth (list_prefix ls <span class="mi">0</span>)</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">          </span><span class="alectryon-sentence"><span class="alectryon-input"><span class="nb">destruct</span> ls;<span class="bp">reflexivity</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">        </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="VLSM-v-chk1c3" style="display: none" type="checkbox"><label class="alectryon-input" for="VLSM-v-chk1c3">-</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>message</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>X</var><span class="hyp-type"><b>: </b><span>VLSM message</span></span></span><br><span><var>TypeX</var><span><span class="hyp-body"><b>:= </b><span>type X</span></span><span class="hyp-type"><b>: </b><span>VLSMType message</span></span></span></span><br><span><var>MachineX</var><span><span class="hyp-body"><b>:= </b><span>machine X</span></span><span class="hyp-type"><b>: </b><span>VLSMMachine (vtype X)</span></span></span></span><br><span><var>s</var><span class="hyp-type"><b>: </b><span>state</span></span></span><br><span><var>ls</var><span class="hyp-type"><b>: </b><span>list transition_item</span></span></span><br><span><var>n</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>Htr</var><span class="hyp-type"><b>: </b><span>finite_valid_trace_from
  (finite_trace_last s (list_prefix ls (S n)))
  (list_suffix ls (S n))</span></span></span><br><span><var>nth</var><span class="hyp-type"><b>: </b><span>state</span></span></span><br><span><var>Hnth</var><span class="hyp-type"><b>: </b><span>finite_trace_nth s ls (S n) = Some nth</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">nth = finite_trace_last s (list_prefix ls (S n))</div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="VLSM-v-chk1c4" style="display: none" type="checkbox"><label class="alectryon-input" for="VLSM-v-chk1c4"><span class="nb">unfold</span> finite_trace_last.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>message</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>X</var><span class="hyp-type"><b>: </b><span>VLSM message</span></span></span><br><span><var>TypeX</var><span><span class="hyp-body"><b>:= </b><span>type X</span></span><span class="hyp-type"><b>: </b><span>VLSMType message</span></span></span></span><br><span><var>MachineX</var><span><span class="hyp-body"><b>:= </b><span>machine X</span></span><span class="hyp-type"><b>: </b><span>VLSMMachine (vtype X)</span></span></span></span><br><span><var>s</var><span class="hyp-type"><b>: </b><span>state</span></span></span><br><span><var>ls</var><span class="hyp-type"><b>: </b><span>list transition_item</span></span></span><br><span><var>n</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>Htr</var><span class="hyp-type"><b>: </b><span>finite_valid_trace_from
  (finite_trace_last s (list_prefix ls (S n)))
  (list_suffix ls (S n))</span></span></span><br><span><var>nth</var><span class="hyp-type"><b>: </b><span>state</span></span></span><br><span><var>Hnth</var><span class="hyp-type"><b>: </b><span>finite_trace_nth s ls (S n) = Some nth</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">nth =
List.<span class="nb">last</span>
  (List.map destination (list_prefix ls (S n))) s</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">          </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="VLSM-v-chk1c5" style="display: none" type="checkbox"><label class="alectryon-input" for="VLSM-v-chk1c5"><span class="nb">rewrite</span> list_prefix_map.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>message</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>X</var><span class="hyp-type"><b>: </b><span>VLSM message</span></span></span><br><span><var>TypeX</var><span><span class="hyp-body"><b>:= </b><span>type X</span></span><span class="hyp-type"><b>: </b><span>VLSMType message</span></span></span></span><br><span><var>MachineX</var><span><span class="hyp-body"><b>:= </b><span>machine X</span></span><span class="hyp-type"><b>: </b><span>VLSMMachine (vtype X)</span></span></span></span><br><span><var>s</var><span class="hyp-type"><b>: </b><span>state</span></span></span><br><span><var>ls</var><span class="hyp-type"><b>: </b><span>list transition_item</span></span></span><br><span><var>n</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>Htr</var><span class="hyp-type"><b>: </b><span>finite_valid_trace_from
  (finite_trace_last s (list_prefix ls (S n)))
  (list_suffix ls (S n))</span></span></span><br><span><var>nth</var><span class="hyp-type"><b>: </b><span>state</span></span></span><br><span><var>Hnth</var><span class="hyp-type"><b>: </b><span>finite_trace_nth s ls (S n) = Some nth</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">nth =
List.<span class="nb">last</span>
  (list_prefix (List.map destination ls) (S n)) s</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">          </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="VLSM-v-chk1c6" style="display: none" type="checkbox"><label class="alectryon-input" for="VLSM-v-chk1c6"><span class="nb">apply</span> list_prefix_nth_last.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>message</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>X</var><span class="hyp-type"><b>: </b><span>VLSM message</span></span></span><br><span><var>TypeX</var><span><span class="hyp-body"><b>:= </b><span>type X</span></span><span class="hyp-type"><b>: </b><span>VLSMType message</span></span></span></span><br><span><var>MachineX</var><span><span class="hyp-body"><b>:= </b><span>machine X</span></span><span class="hyp-type"><b>: </b><span>VLSMMachine (vtype X)</span></span></span></span><br><span><var>s</var><span class="hyp-type"><b>: </b><span>state</span></span></span><br><span><var>ls</var><span class="hyp-type"><b>: </b><span>list transition_item</span></span></span><br><span><var>n</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>Htr</var><span class="hyp-type"><b>: </b><span>finite_valid_trace_from
  (finite_trace_last s (list_prefix ls (S n)))
  (list_suffix ls (S n))</span></span></span><br><span><var>nth</var><span class="hyp-type"><b>: </b><span>state</span></span></span><br><span><var>Hnth</var><span class="hyp-type"><b>: </b><span>finite_trace_nth s ls (S n) = Some nth</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">nth_error (List.map destination ls) n = Some nth</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">          </span><span class="alectryon-sentence"><span class="alectryon-input"><span class="bp">assumption</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">      </span><span class="alectryon-sentence"><span class="alectryon-input">}</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Qed</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
</span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="VLSM-v-chk1c7" style="display: none" type="checkbox"><label class="alectryon-input" for="VLSM-v-chk1c7"><span class="kn">Lemma</span> <span class="nf">finite_valid_trace_from_segment</span>
      (<span class="nv">s</span> : state)
      (<span class="nv">ls</span> : list transition_item)
      (<span class="nv">Htr</span> : finite_valid_trace_from s ls)
      (<span class="nv">n1</span> <span class="nv">n2</span> : nat)
      (<span class="nv">Hle</span> : n1 &lt;= n2)
      (<span class="nv">n1th</span> : state)
      (<span class="nv">Hnth</span> : finite_trace_nth s ls n1 = Some n1th)
      : finite_valid_trace_from n1th (list_segment ls n1 n2).</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>message</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>X</var><span class="hyp-type"><b>: </b><span>VLSM message</span></span></span><br><span><var>TypeX</var><span><span class="hyp-body"><b>:= </b><span>type X</span></span><span class="hyp-type"><b>: </b><span>VLSMType message</span></span></span></span><br><span><var>MachineX</var><span><span class="hyp-body"><b>:= </b><span>machine X</span></span><span class="hyp-type"><b>: </b><span>VLSMMachine (vtype X)</span></span></span></span><br><span><var>s</var><span class="hyp-type"><b>: </b><span>state</span></span></span><br><span><var>ls</var><span class="hyp-type"><b>: </b><span>list transition_item</span></span></span><br><span><var>Htr</var><span class="hyp-type"><b>: </b><span>finite_valid_trace_from s ls</span></span></span><br><span><var>n1, n2</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>Hle</var><span class="hyp-type"><b>: </b><span>n1 ‚â§ n2</span></span></span><br><span><var>n1th</var><span class="hyp-type"><b>: </b><span>state</span></span></span><br><span><var>Hnth</var><span class="hyp-type"><b>: </b><span>finite_trace_nth s ls n1 = Some n1th</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">finite_valid_trace_from n1th (list_segment ls n1 n2)</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="VLSM-v-chk1c8" style="display: none" type="checkbox"><label class="alectryon-input" for="VLSM-v-chk1c8"><span class="kn">Proof</span>.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>message</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>X</var><span class="hyp-type"><b>: </b><span>VLSM message</span></span></span><br><span><var>TypeX</var><span><span class="hyp-body"><b>:= </b><span>type X</span></span><span class="hyp-type"><b>: </b><span>VLSMType message</span></span></span></span><br><span><var>MachineX</var><span><span class="hyp-body"><b>:= </b><span>machine X</span></span><span class="hyp-type"><b>: </b><span>VLSMMachine (vtype X)</span></span></span></span><br><span><var>s</var><span class="hyp-type"><b>: </b><span>state</span></span></span><br><span><var>ls</var><span class="hyp-type"><b>: </b><span>list transition_item</span></span></span><br><span><var>Htr</var><span class="hyp-type"><b>: </b><span>finite_valid_trace_from s ls</span></span></span><br><span><var>n1, n2</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>Hle</var><span class="hyp-type"><b>: </b><span>n1 ‚â§ n2</span></span></span><br><span><var>n1th</var><span class="hyp-type"><b>: </b><span>state</span></span></span><br><span><var>Hnth</var><span class="hyp-type"><b>: </b><span>finite_trace_nth s ls n1 = Some n1th</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">finite_valid_trace_from n1th (list_segment ls n1 n2)</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">      </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="VLSM-v-chk1c9" style="display: none" type="checkbox"><label class="alectryon-input" for="VLSM-v-chk1c9"><span class="nb">apply</span> finite_valid_trace_from_suffix <span class="kr">with</span> s.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>message</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>X</var><span class="hyp-type"><b>: </b><span>VLSM message</span></span></span><br><span><var>TypeX</var><span><span class="hyp-body"><b>:= </b><span>type X</span></span><span class="hyp-type"><b>: </b><span>VLSMType message</span></span></span></span><br><span><var>MachineX</var><span><span class="hyp-body"><b>:= </b><span>machine X</span></span><span class="hyp-type"><b>: </b><span>VLSMMachine (vtype X)</span></span></span></span><br><span><var>s</var><span class="hyp-type"><b>: </b><span>state</span></span></span><br><span><var>ls</var><span class="hyp-type"><b>: </b><span>list transition_item</span></span></span><br><span><var>Htr</var><span class="hyp-type"><b>: </b><span>finite_valid_trace_from s ls</span></span></span><br><span><var>n1, n2</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>Hle</var><span class="hyp-type"><b>: </b><span>n1 ‚â§ n2</span></span></span><br><span><var>n1th</var><span class="hyp-type"><b>: </b><span>state</span></span></span><br><span><var>Hnth</var><span class="hyp-type"><b>: </b><span>finite_trace_nth s ls n1 = Some n1th</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">finite_valid_trace_from s (list_prefix ls n2)</div></blockquote><div class="alectryon-extra-goals"><input class="alectryon-extra-goal-toggle" id="VLSM-v-chk1ca" style="display: none" type="checkbox"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>message</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>X</var><span class="hyp-type"><b>: </b><span>VLSM message</span></span></span><br><span><var>TypeX</var><span><span class="hyp-body"><b>:= </b><span>type X</span></span><span class="hyp-type"><b>: </b><span>VLSMType message</span></span></span></span><br><span><var>MachineX</var><span><span class="hyp-body"><b>:= </b><span>machine X</span></span><span class="hyp-type"><b>: </b><span>VLSMMachine (vtype X)</span></span></span></span><br><span><var>s</var><span class="hyp-type"><b>: </b><span>state</span></span></span><br><span><var>ls</var><span class="hyp-type"><b>: </b><span>list transition_item</span></span></span><br><span><var>Htr</var><span class="hyp-type"><b>: </b><span>finite_valid_trace_from s ls</span></span></span><br><span><var>n1, n2</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>Hle</var><span class="hyp-type"><b>: </b><span>n1 ‚â§ n2</span></span></span><br><span><var>n1th</var><span class="hyp-type"><b>: </b><span>state</span></span></span><br><span><var>Hnth</var><span class="hyp-type"><b>: </b><span>finite_trace_nth s ls n1 = Some n1th</span></span></span><br></div><label class="goal-separator" for="VLSM-v-chk1ca"><hr></label><div class="goal-conclusion">finite_trace_nth s (list_prefix ls n2) n1 = Some n1th</div></blockquote></div></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">      </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="VLSM-v-chk1cb" style="display: none" type="checkbox"><label class="alectryon-input" for="VLSM-v-chk1cb">-</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>message</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>X</var><span class="hyp-type"><b>: </b><span>VLSM message</span></span></span><br><span><var>TypeX</var><span><span class="hyp-body"><b>:= </b><span>type X</span></span><span class="hyp-type"><b>: </b><span>VLSMType message</span></span></span></span><br><span><var>MachineX</var><span><span class="hyp-body"><b>:= </b><span>machine X</span></span><span class="hyp-type"><b>: </b><span>VLSMMachine (vtype X)</span></span></span></span><br><span><var>s</var><span class="hyp-type"><b>: </b><span>state</span></span></span><br><span><var>ls</var><span class="hyp-type"><b>: </b><span>list transition_item</span></span></span><br><span><var>Htr</var><span class="hyp-type"><b>: </b><span>finite_valid_trace_from s ls</span></span></span><br><span><var>n1, n2</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>Hle</var><span class="hyp-type"><b>: </b><span>n1 ‚â§ n2</span></span></span><br><span><var>n1th</var><span class="hyp-type"><b>: </b><span>state</span></span></span><br><span><var>Hnth</var><span class="hyp-type"><b>: </b><span>finite_trace_nth s ls n1 = Some n1th</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">finite_valid_trace_from s (list_prefix ls n2)</div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="VLSM-v-chk1cc" style="display: none" type="checkbox"><label class="alectryon-input" for="VLSM-v-chk1cc"><span class="nb">apply</span> finite_valid_trace_from_prefix.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>message</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>X</var><span class="hyp-type"><b>: </b><span>VLSM message</span></span></span><br><span><var>TypeX</var><span><span class="hyp-body"><b>:= </b><span>type X</span></span><span class="hyp-type"><b>: </b><span>VLSMType message</span></span></span></span><br><span><var>MachineX</var><span><span class="hyp-body"><b>:= </b><span>machine X</span></span><span class="hyp-type"><b>: </b><span>VLSMMachine (vtype X)</span></span></span></span><br><span><var>s</var><span class="hyp-type"><b>: </b><span>state</span></span></span><br><span><var>ls</var><span class="hyp-type"><b>: </b><span>list transition_item</span></span></span><br><span><var>Htr</var><span class="hyp-type"><b>: </b><span>finite_valid_trace_from s ls</span></span></span><br><span><var>n1, n2</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>Hle</var><span class="hyp-type"><b>: </b><span>n1 ‚â§ n2</span></span></span><br><span><var>n1th</var><span class="hyp-type"><b>: </b><span>state</span></span></span><br><span><var>Hnth</var><span class="hyp-type"><b>: </b><span>finite_trace_nth s ls n1 = Some n1th</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">finite_valid_trace_from s ls</div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="bp">assumption</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">      </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="VLSM-v-chk1cd" style="display: none" type="checkbox"><label class="alectryon-input" for="VLSM-v-chk1cd">-</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>message</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>X</var><span class="hyp-type"><b>: </b><span>VLSM message</span></span></span><br><span><var>TypeX</var><span><span class="hyp-body"><b>:= </b><span>type X</span></span><span class="hyp-type"><b>: </b><span>VLSMType message</span></span></span></span><br><span><var>MachineX</var><span><span class="hyp-body"><b>:= </b><span>machine X</span></span><span class="hyp-type"><b>: </b><span>VLSMMachine (vtype X)</span></span></span></span><br><span><var>s</var><span class="hyp-type"><b>: </b><span>state</span></span></span><br><span><var>ls</var><span class="hyp-type"><b>: </b><span>list transition_item</span></span></span><br><span><var>Htr</var><span class="hyp-type"><b>: </b><span>finite_valid_trace_from s ls</span></span></span><br><span><var>n1, n2</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>Hle</var><span class="hyp-type"><b>: </b><span>n1 ‚â§ n2</span></span></span><br><span><var>n1th</var><span class="hyp-type"><b>: </b><span>state</span></span></span><br><span><var>Hnth</var><span class="hyp-type"><b>: </b><span>finite_trace_nth s ls n1 = Some n1th</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">finite_trace_nth s (list_prefix ls n2) n1 = Some n1th</div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="VLSM-v-chk1ce" style="display: none" type="checkbox"><label class="alectryon-input" for="VLSM-v-chk1ce"><span class="nb">destruct</span> n1;[<span class="bp">assumption</span>|].</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>message</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>X</var><span class="hyp-type"><b>: </b><span>VLSM message</span></span></span><br><span><var>TypeX</var><span><span class="hyp-body"><b>:= </b><span>type X</span></span><span class="hyp-type"><b>: </b><span>VLSMType message</span></span></span></span><br><span><var>MachineX</var><span><span class="hyp-body"><b>:= </b><span>machine X</span></span><span class="hyp-type"><b>: </b><span>VLSMMachine (vtype X)</span></span></span></span><br><span><var>s</var><span class="hyp-type"><b>: </b><span>state</span></span></span><br><span><var>ls</var><span class="hyp-type"><b>: </b><span>list transition_item</span></span></span><br><span><var>Htr</var><span class="hyp-type"><b>: </b><span>finite_valid_trace_from s ls</span></span></span><br><span><var>n1, n2</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>Hle</var><span class="hyp-type"><b>: </b><span>S n1 ‚â§ n2</span></span></span><br><span><var>n1th</var><span class="hyp-type"><b>: </b><span>state</span></span></span><br><span><var>Hnth</var><span class="hyp-type"><b>: </b><span>finite_trace_nth s ls (S n1) = Some n1th</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">finite_trace_nth s (list_prefix ls n2) (S n1) =
Some n1th</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">        </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="VLSM-v-chk1cf" style="display: none" type="checkbox"><label class="alectryon-input" for="VLSM-v-chk1cf"><span class="nb">unfold</span> finite_trace_nth <span class="kr">in</span> Hnth |- *.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>message</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>X</var><span class="hyp-type"><b>: </b><span>VLSM message</span></span></span><br><span><var>TypeX</var><span><span class="hyp-body"><b>:= </b><span>type X</span></span><span class="hyp-type"><b>: </b><span>VLSMType message</span></span></span></span><br><span><var>MachineX</var><span><span class="hyp-body"><b>:= </b><span>machine X</span></span><span class="hyp-type"><b>: </b><span>VLSMMachine (vtype X)</span></span></span></span><br><span><var>s</var><span class="hyp-type"><b>: </b><span>state</span></span></span><br><span><var>ls</var><span class="hyp-type"><b>: </b><span>list transition_item</span></span></span><br><span><var>Htr</var><span class="hyp-type"><b>: </b><span>finite_valid_trace_from s ls</span></span></span><br><span><var>n1, n2</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>Hle</var><span class="hyp-type"><b>: </b><span>S n1 ‚â§ n2</span></span></span><br><span><var>n1th</var><span class="hyp-type"><b>: </b><span>state</span></span></span><br><span><var>Hnth</var><span class="hyp-type"><b>: </b><span>nth_error (s :: List.map destination ls) (S n1) =
Some n1th</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">nth_error
  (s :: List.map destination (list_prefix ls n2))
  (S n1) = Some n1th</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">        </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="VLSM-v-chk1d0" style="display: none" type="checkbox"><label class="alectryon-input" for="VLSM-v-chk1d0"><span class="nb">simpl</span> <span class="kr">in</span> Hnth |- *.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>message</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>X</var><span class="hyp-type"><b>: </b><span>VLSM message</span></span></span><br><span><var>TypeX</var><span><span class="hyp-body"><b>:= </b><span>type X</span></span><span class="hyp-type"><b>: </b><span>VLSMType message</span></span></span></span><br><span><var>MachineX</var><span><span class="hyp-body"><b>:= </b><span>machine X</span></span><span class="hyp-type"><b>: </b><span>VLSMMachine (vtype X)</span></span></span></span><br><span><var>s</var><span class="hyp-type"><b>: </b><span>state</span></span></span><br><span><var>ls</var><span class="hyp-type"><b>: </b><span>list transition_item</span></span></span><br><span><var>Htr</var><span class="hyp-type"><b>: </b><span>finite_valid_trace_from s ls</span></span></span><br><span><var>n1, n2</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>Hle</var><span class="hyp-type"><b>: </b><span>S n1 ‚â§ n2</span></span></span><br><span><var>n1th</var><span class="hyp-type"><b>: </b><span>state</span></span></span><br><span><var>Hnth</var><span class="hyp-type"><b>: </b><span>nth_error (List.map destination ls) n1 =
Some n1th</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">nth_error (List.map destination (list_prefix ls n2))
  n1 = Some n1th</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">        </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="VLSM-v-chk1d1" style="display: none" type="checkbox"><label class="alectryon-input" for="VLSM-v-chk1d1"><span class="nb">rewrite</span> list_prefix_map.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>message</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>X</var><span class="hyp-type"><b>: </b><span>VLSM message</span></span></span><br><span><var>TypeX</var><span><span class="hyp-body"><b>:= </b><span>type X</span></span><span class="hyp-type"><b>: </b><span>VLSMType message</span></span></span></span><br><span><var>MachineX</var><span><span class="hyp-body"><b>:= </b><span>machine X</span></span><span class="hyp-type"><b>: </b><span>VLSMMachine (vtype X)</span></span></span></span><br><span><var>s</var><span class="hyp-type"><b>: </b><span>state</span></span></span><br><span><var>ls</var><span class="hyp-type"><b>: </b><span>list transition_item</span></span></span><br><span><var>Htr</var><span class="hyp-type"><b>: </b><span>finite_valid_trace_from s ls</span></span></span><br><span><var>n1, n2</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>Hle</var><span class="hyp-type"><b>: </b><span>S n1 ‚â§ n2</span></span></span><br><span><var>n1th</var><span class="hyp-type"><b>: </b><span>state</span></span></span><br><span><var>Hnth</var><span class="hyp-type"><b>: </b><span>nth_error (List.map destination ls) n1 =
Some n1th</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">nth_error (list_prefix (List.map destination ls) n2)
  n1 = Some n1th</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">        </span><span class="alectryon-sentence"><span class="alectryon-input"><span class="nb">rewrite</span> list_prefix_nth;<span class="bp">assumption</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Qed</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
    <span class="c">(* begin hide *)</span>

</span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="VLSM-v-chk1d2" style="display: none" type="checkbox"><label class="alectryon-input" for="VLSM-v-chk1d2"><span class="kn">Lemma</span> <span class="nf">can_produce_from_valid_trace</span> <span class="nv">si</span> <span class="nv">tr</span>
      (<span class="nv">Htr</span>: finite_valid_trace_from si tr)
      : <span class="kr">forall</span> <span class="nv">item</span>, item ‚àà tr -&gt;
        option_can_produce (destination item) (output item).</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>message</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>X</var><span class="hyp-type"><b>: </b><span>VLSM message</span></span></span><br><span><var>TypeX</var><span><span class="hyp-body"><b>:= </b><span>type X</span></span><span class="hyp-type"><b>: </b><span>VLSMType message</span></span></span></span><br><span><var>MachineX</var><span><span class="hyp-body"><b>:= </b><span>machine X</span></span><span class="hyp-type"><b>: </b><span>VLSMMachine (vtype X)</span></span></span></span><br><span><var>si</var><span class="hyp-type"><b>: </b><span>state</span></span></span><br><span><var>tr</var><span class="hyp-type"><b>: </b><span>list transition_item</span></span></span><br><span><var>Htr</var><span class="hyp-type"><b>: </b><span>finite_valid_trace_from si tr</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="kr">‚àÄ</span> <span class="nv">item</span> : transition_item,
  item ‚àà tr
  ‚Üí option_can_produce (destination item)
      (output item)</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="VLSM-v-chk1d3" style="display: none" type="checkbox"><label class="alectryon-input" for="VLSM-v-chk1d3"><span class="kn">Proof</span>.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>message</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>X</var><span class="hyp-type"><b>: </b><span>VLSM message</span></span></span><br><span><var>TypeX</var><span><span class="hyp-body"><b>:= </b><span>type X</span></span><span class="hyp-type"><b>: </b><span>VLSMType message</span></span></span></span><br><span><var>MachineX</var><span><span class="hyp-body"><b>:= </b><span>machine X</span></span><span class="hyp-type"><b>: </b><span>VLSMMachine (vtype X)</span></span></span></span><br><span><var>si</var><span class="hyp-type"><b>: </b><span>state</span></span></span><br><span><var>tr</var><span class="hyp-type"><b>: </b><span>list transition_item</span></span></span><br><span><var>Htr</var><span class="hyp-type"><b>: </b><span>finite_valid_trace_from si tr</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="kr">‚àÄ</span> <span class="nv">item</span> : transition_item,
  item ‚àà tr
  ‚Üí option_can_produce (destination item)
      (output item)</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">      </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="VLSM-v-chk1d4" style="display: none" type="checkbox"><label class="alectryon-input" for="VLSM-v-chk1d4"><span class="nb">intros</span> item Hitem.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>message</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>X</var><span class="hyp-type"><b>: </b><span>VLSM message</span></span></span><br><span><var>TypeX</var><span><span class="hyp-body"><b>:= </b><span>type X</span></span><span class="hyp-type"><b>: </b><span>VLSMType message</span></span></span></span><br><span><var>MachineX</var><span><span class="hyp-body"><b>:= </b><span>machine X</span></span><span class="hyp-type"><b>: </b><span>VLSMMachine (vtype X)</span></span></span></span><br><span><var>si</var><span class="hyp-type"><b>: </b><span>state</span></span></span><br><span><var>tr</var><span class="hyp-type"><b>: </b><span>list transition_item</span></span></span><br><span><var>Htr</var><span class="hyp-type"><b>: </b><span>finite_valid_trace_from si tr</span></span></span><br><span><var>item</var><span class="hyp-type"><b>: </b><span>transition_item</span></span></span><br><span><var>Hitem</var><span class="hyp-type"><b>: </b><span>item ‚àà tr</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">option_can_produce (destination item) (output item)</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">      </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="VLSM-v-chk1d5" style="display: none" type="checkbox"><label class="alectryon-input" for="VLSM-v-chk1d5"><span class="nb">apply</span> elem_of_list_split <span class="kr">in</span> Hitem <span class="kr">as</span> (l1 &amp; l2 &amp; Heq).</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>message</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>X</var><span class="hyp-type"><b>: </b><span>VLSM message</span></span></span><br><span><var>TypeX</var><span><span class="hyp-body"><b>:= </b><span>type X</span></span><span class="hyp-type"><b>: </b><span>VLSMType message</span></span></span></span><br><span><var>MachineX</var><span><span class="hyp-body"><b>:= </b><span>machine X</span></span><span class="hyp-type"><b>: </b><span>VLSMMachine (vtype X)</span></span></span></span><br><span><var>si</var><span class="hyp-type"><b>: </b><span>state</span></span></span><br><span><var>tr</var><span class="hyp-type"><b>: </b><span>list transition_item</span></span></span><br><span><var>Htr</var><span class="hyp-type"><b>: </b><span>finite_valid_trace_from si tr</span></span></span><br><span><var>item</var><span class="hyp-type"><b>: </b><span>transition_item</span></span></span><br><span><var>l1, l2</var><span class="hyp-type"><b>: </b><span>list transition_item</span></span></span><br><span><var>Heq</var><span class="hyp-type"><b>: </b><span>tr = l1 ++ item :: l2</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">option_can_produce (destination item) (output item)</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">      </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="VLSM-v-chk1d6" style="display: none" type="checkbox"><label class="alectryon-input" for="VLSM-v-chk1d6"><span class="nb">eexists</span> _,_.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>message</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>X</var><span class="hyp-type"><b>: </b><span>VLSM message</span></span></span><br><span><var>TypeX</var><span><span class="hyp-body"><b>:= </b><span>type X</span></span><span class="hyp-type"><b>: </b><span>VLSMType message</span></span></span></span><br><span><var>MachineX</var><span><span class="hyp-body"><b>:= </b><span>machine X</span></span><span class="hyp-type"><b>: </b><span>VLSMMachine (vtype X)</span></span></span></span><br><span><var>si</var><span class="hyp-type"><b>: </b><span>state</span></span></span><br><span><var>tr</var><span class="hyp-type"><b>: </b><span>list transition_item</span></span></span><br><span><var>Htr</var><span class="hyp-type"><b>: </b><span>finite_valid_trace_from si tr</span></span></span><br><span><var>item</var><span class="hyp-type"><b>: </b><span>transition_item</span></span></span><br><span><var>l1, l2</var><span class="hyp-type"><b>: </b><span>list transition_item</span></span></span><br><span><var>Heq</var><span class="hyp-type"><b>: </b><span>tr = l1 ++ item :: l2</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">input_valid_transition <span class="nl">?Goal0</span> <span class="nl">?Goal</span>
  (destination item, output item)</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">      </span><span class="alectryon-sentence"><span class="alectryon-input"><span class="nb">eapply</span> input_valid_transition_to; <span class="nb">cbn</span>; <span class="bp">eassumption</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Qed</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
</span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="VLSM-v-chk1d7" style="display: none" type="checkbox"><label class="alectryon-input" for="VLSM-v-chk1d7"><span class="kn">Lemma</span> <span class="nf">can_emit_from_valid_trace</span>
      (<span class="nv">si</span> : state)
      (<span class="nv">m</span> : message)
      (<span class="nv">tr</span> : list transition_item)
      (<span class="nv">Htr</span>: finite_valid_trace si tr)
      (<span class="nv">Hm</span> : trace_has_message (field_selector output) m tr) :
      can_emit m.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>message</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>X</var><span class="hyp-type"><b>: </b><span>VLSM message</span></span></span><br><span><var>TypeX</var><span><span class="hyp-body"><b>:= </b><span>type X</span></span><span class="hyp-type"><b>: </b><span>VLSMType message</span></span></span></span><br><span><var>MachineX</var><span><span class="hyp-body"><b>:= </b><span>machine X</span></span><span class="hyp-type"><b>: </b><span>VLSMMachine (vtype X)</span></span></span></span><br><span><var>si</var><span class="hyp-type"><b>: </b><span>state</span></span></span><br><span><var>m</var><span class="hyp-type"><b>: </b><span>message</span></span></span><br><span><var>tr</var><span class="hyp-type"><b>: </b><span>list transition_item</span></span></span><br><span><var>Htr</var><span class="hyp-type"><b>: </b><span>finite_valid_trace si tr</span></span></span><br><span><var>Hm</var><span class="hyp-type"><b>: </b><span>trace_has_message (field_selector output) m tr</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">can_emit m</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="VLSM-v-chk1d8" style="display: none" type="checkbox"><label class="alectryon-input" for="VLSM-v-chk1d8"><span class="kn">Proof</span>.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>message</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>X</var><span class="hyp-type"><b>: </b><span>VLSM message</span></span></span><br><span><var>TypeX</var><span><span class="hyp-body"><b>:= </b><span>type X</span></span><span class="hyp-type"><b>: </b><span>VLSMType message</span></span></span></span><br><span><var>MachineX</var><span><span class="hyp-body"><b>:= </b><span>machine X</span></span><span class="hyp-type"><b>: </b><span>VLSMMachine (vtype X)</span></span></span></span><br><span><var>si</var><span class="hyp-type"><b>: </b><span>state</span></span></span><br><span><var>m</var><span class="hyp-type"><b>: </b><span>message</span></span></span><br><span><var>tr</var><span class="hyp-type"><b>: </b><span>list transition_item</span></span></span><br><span><var>Htr</var><span class="hyp-type"><b>: </b><span>finite_valid_trace si tr</span></span></span><br><span><var>Hm</var><span class="hyp-type"><b>: </b><span>trace_has_message (field_selector output) m tr</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">can_emit m</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">      </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="VLSM-v-chk1d9" style="display: none" type="checkbox"><label class="alectryon-input" for="VLSM-v-chk1d9"><span class="nb">apply</span> can_emit_iff.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>message</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>X</var><span class="hyp-type"><b>: </b><span>VLSM message</span></span></span><br><span><var>TypeX</var><span><span class="hyp-body"><b>:= </b><span>type X</span></span><span class="hyp-type"><b>: </b><span>VLSMType message</span></span></span></span><br><span><var>MachineX</var><span><span class="hyp-body"><b>:= </b><span>machine X</span></span><span class="hyp-type"><b>: </b><span>VLSMMachine (vtype X)</span></span></span></span><br><span><var>si</var><span class="hyp-type"><b>: </b><span>state</span></span></span><br><span><var>m</var><span class="hyp-type"><b>: </b><span>message</span></span></span><br><span><var>tr</var><span class="hyp-type"><b>: </b><span>list transition_item</span></span></span><br><span><var>Htr</var><span class="hyp-type"><b>: </b><span>finite_valid_trace si tr</span></span></span><br><span><var>Hm</var><span class="hyp-type"><b>: </b><span>trace_has_message (field_selector output) m tr</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="kr">‚àÉ</span> <span class="nv">s</span> : state, can_produce s m</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">      </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="VLSM-v-chk1da" style="display: none" type="checkbox"><label class="alectryon-input" for="VLSM-v-chk1da"><span class="nb">setoid_rewrite</span> Exists_exists <span class="kr">in</span> Hm.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>message</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>X</var><span class="hyp-type"><b>: </b><span>VLSM message</span></span></span><br><span><var>TypeX</var><span><span class="hyp-body"><b>:= </b><span>type X</span></span><span class="hyp-type"><b>: </b><span>VLSMType message</span></span></span></span><br><span><var>MachineX</var><span><span class="hyp-body"><b>:= </b><span>machine X</span></span><span class="hyp-type"><b>: </b><span>VLSMMachine (vtype X)</span></span></span></span><br><span><var>si</var><span class="hyp-type"><b>: </b><span>state</span></span></span><br><span><var>m</var><span class="hyp-type"><b>: </b><span>message</span></span></span><br><span><var>tr</var><span class="hyp-type"><b>: </b><span>list transition_item</span></span></span><br><span><var>Htr</var><span class="hyp-type"><b>: </b><span>finite_valid_trace si tr</span></span></span><br><span><var>Hm</var><span class="hyp-type"><b>: </b><span><span class="kr">‚àÉ</span> <span class="nv">x</span> : transition_item,
  x ‚àà tr ‚àß field_selector output m x</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="kr">‚àÉ</span> <span class="nv">s</span> : state, can_produce s m</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">      </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="VLSM-v-chk1db" style="display: none" type="checkbox"><label class="alectryon-input" for="VLSM-v-chk1db"><span class="nb">destruct</span> Hm <span class="kr">as</span> (item &amp; Hitem &amp; Houtput).</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>message</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>X</var><span class="hyp-type"><b>: </b><span>VLSM message</span></span></span><br><span><var>TypeX</var><span><span class="hyp-body"><b>:= </b><span>type X</span></span><span class="hyp-type"><b>: </b><span>VLSMType message</span></span></span></span><br><span><var>MachineX</var><span><span class="hyp-body"><b>:= </b><span>machine X</span></span><span class="hyp-type"><b>: </b><span>VLSMMachine (vtype X)</span></span></span></span><br><span><var>si</var><span class="hyp-type"><b>: </b><span>state</span></span></span><br><span><var>m</var><span class="hyp-type"><b>: </b><span>message</span></span></span><br><span><var>tr</var><span class="hyp-type"><b>: </b><span>list transition_item</span></span></span><br><span><var>Htr</var><span class="hyp-type"><b>: </b><span>finite_valid_trace si tr</span></span></span><br><span><var>item</var><span class="hyp-type"><b>: </b><span>transition_item</span></span></span><br><span><var>Hitem</var><span class="hyp-type"><b>: </b><span>item ‚àà tr</span></span></span><br><span><var>Houtput</var><span class="hyp-type"><b>: </b><span>field_selector output m item</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="kr">‚àÉ</span> <span class="nv">s</span> : state, can_produce s m</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">      </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="VLSM-v-chk1dc" style="display: none" type="checkbox"><label class="alectryon-input" for="VLSM-v-chk1dc"><span class="kr">exists</span> (<span class="nv">destination</span> <span class="nv">item</span>).</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>message</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>X</var><span class="hyp-type"><b>: </b><span>VLSM message</span></span></span><br><span><var>TypeX</var><span><span class="hyp-body"><b>:= </b><span>type X</span></span><span class="hyp-type"><b>: </b><span>VLSMType message</span></span></span></span><br><span><var>MachineX</var><span><span class="hyp-body"><b>:= </b><span>machine X</span></span><span class="hyp-type"><b>: </b><span>VLSMMachine (vtype X)</span></span></span></span><br><span><var>si</var><span class="hyp-type"><b>: </b><span>state</span></span></span><br><span><var>m</var><span class="hyp-type"><b>: </b><span>message</span></span></span><br><span><var>tr</var><span class="hyp-type"><b>: </b><span>list transition_item</span></span></span><br><span><var>Htr</var><span class="hyp-type"><b>: </b><span>finite_valid_trace si tr</span></span></span><br><span><var>item</var><span class="hyp-type"><b>: </b><span>transition_item</span></span></span><br><span><var>Hitem</var><span class="hyp-type"><b>: </b><span>item ‚àà tr</span></span></span><br><span><var>Houtput</var><span class="hyp-type"><b>: </b><span>field_selector output m item</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">can_produce (destination item) m</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">      </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="VLSM-v-chk1dd" style="display: none" type="checkbox"><label class="alectryon-input" for="VLSM-v-chk1dd"><span class="nb">unfold</span> can_produce; <span class="nb">rewrite</span> &lt;- Houtput.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>message</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>X</var><span class="hyp-type"><b>: </b><span>VLSM message</span></span></span><br><span><var>TypeX</var><span><span class="hyp-body"><b>:= </b><span>type X</span></span><span class="hyp-type"><b>: </b><span>VLSMType message</span></span></span></span><br><span><var>MachineX</var><span><span class="hyp-body"><b>:= </b><span>machine X</span></span><span class="hyp-type"><b>: </b><span>VLSMMachine (vtype X)</span></span></span></span><br><span><var>si</var><span class="hyp-type"><b>: </b><span>state</span></span></span><br><span><var>m</var><span class="hyp-type"><b>: </b><span>message</span></span></span><br><span><var>tr</var><span class="hyp-type"><b>: </b><span>list transition_item</span></span></span><br><span><var>Htr</var><span class="hyp-type"><b>: </b><span>finite_valid_trace si tr</span></span></span><br><span><var>item</var><span class="hyp-type"><b>: </b><span>transition_item</span></span></span><br><span><var>Hitem</var><span class="hyp-type"><b>: </b><span>item ‚àà tr</span></span></span><br><span><var>Houtput</var><span class="hyp-type"><b>: </b><span>field_selector output m item</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">option_can_produce (destination item) (output item)</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">      </span><span class="alectryon-sentence"><span class="alectryon-input"><span class="nb">eapply</span> can_produce_from_valid_trace; [<span class="nb">apply</span> Htr | <span class="bp">assumption</span>].</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Qed</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
    <span class="c">(* End Hide *)</span></span></pre><div class="doc">
<a id="lab12"></a><h2 class="section">Finite <span class="inlinecode"><span class="id" title="var">valid_trace</span></span>s with a final state</h2>
</div><pre class="alectryon-io highlight"><!-- Generator: Alectryon --></pre><div class="doc">
It is often necessary to refer to know ending state of a <span class="inlinecode"><span class="id" title="var">finite_valid_trace_from</span></span>.
This is either the <span class="inlinecode"><span class="id" title="var">destination</span></span> of the <span class="inlinecode"><span class="id" title="var">last</span></span> <span class="inlinecode"><span class="id" title="var">transition_item</span></span> in the trace, or
the starting state.
To avoid repeating reasoning about <span class="inlinecode"><span class="id" title="var">last</span></span>, we define variants of
<span class="inlinecode"><span class="id" title="var">finite_valid_trace_from</span></span> and <span class="inlinecode"><span class="id" title="var">finite_valid_trace</span></span>
that include the final state, and give appropriate induction principles.
 
</div><pre class="alectryon-io highlight"><!-- Generator: Alectryon --></pre><div class="doc">
The final state of a finite portion of a valid trace.
    This is defined over <span class="inlinecode"><span class="id" title="var">finite_valid_trace_from</span></span> because
    an initial state is necessary in case <code>tr</code> is empty,
    and this allows the definition to have only one non-implicit
    parameter.
 
</div><pre class="alectryon-io highlight"><!-- Generator: Alectryon --><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Inductive</span> <span class="nf">finite_valid_trace_from_to</span> : state -&gt; state -&gt; list transition_item -&gt; <span class="kt">Prop</span> :=
    | finite_valid_trace_from_to_empty : <span class="kr">forall</span> (<span class="nv">s</span> : state)
        (<span class="nv">Hs</span> : valid_state_prop s),
        finite_valid_trace_from_to s s []
    | finite_valid_trace_from_to_extend : <span class="kr">forall</span>  (<span class="nv">s</span> <span class="nv">f</span> : state) (<span class="nv">tl</span> : list transition_item)
        (<span class="nv">Htl</span> : finite_valid_trace_from_to s f tl)
        (<span class="nv">s&#39;</span> : state) (<span class="nv">iom</span> <span class="nv">oom</span> : option message) (<span class="nv">l</span> : label)
        (<span class="nv">Ht</span> : input_valid_transition l (s&#39;, iom) (s, oom)),
        finite_valid_trace_from_to s&#39; f ({| l := l; input := iom; destination := s; output := oom |} :: tl).</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
</span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="VLSM-v-chk1de" style="display: none" type="checkbox"><label class="alectryon-input" for="VLSM-v-chk1de"><span class="kn">Lemma</span> <span class="nf">finite_valid_trace_from_to_singleton</span> <span class="nv">s</span> <span class="nv">s&#39;</span> <span class="nv">iom</span> <span class="nv">oom</span> <span class="nv">l</span>
        : input_valid_transition l (s, iom) (s&#39;, oom) -&gt;
          finite_valid_trace_from_to s s&#39; [{| l := l; input := iom; destination := s&#39;; output := oom |}].</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>message</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>X</var><span class="hyp-type"><b>: </b><span>VLSM message</span></span></span><br><span><var>TypeX</var><span><span class="hyp-body"><b>:= </b><span>type X</span></span><span class="hyp-type"><b>: </b><span>VLSMType message</span></span></span></span><br><span><var>MachineX</var><span><span class="hyp-body"><b>:= </b><span>machine X</span></span><span class="hyp-type"><b>: </b><span>VLSMMachine (vtype X)</span></span></span></span><br><span><var>s, s'</var><span class="hyp-type"><b>: </b><span>state</span></span></span><br><span><var>iom, oom</var><span class="hyp-type"><b>: </b><span>option message</span></span></span><br><span><var>l</var><span class="hyp-type"><b>: </b><span>label</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">input_valid_transition l (s, iom) (s&#39;, oom)
‚Üí finite_valid_trace_from_to s s&#39;
    [{|
       l := l;
       input := iom;
       destination := s&#39;;
       output := oom
     |}]</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="VLSM-v-chk1df" style="display: none" type="checkbox"><label class="alectryon-input" for="VLSM-v-chk1df"><span class="kn">Proof</span>.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>message</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>X</var><span class="hyp-type"><b>: </b><span>VLSM message</span></span></span><br><span><var>TypeX</var><span><span class="hyp-body"><b>:= </b><span>type X</span></span><span class="hyp-type"><b>: </b><span>VLSMType message</span></span></span></span><br><span><var>MachineX</var><span><span class="hyp-body"><b>:= </b><span>machine X</span></span><span class="hyp-type"><b>: </b><span>VLSMMachine (vtype X)</span></span></span></span><br><span><var>s, s'</var><span class="hyp-type"><b>: </b><span>state</span></span></span><br><span><var>iom, oom</var><span class="hyp-type"><b>: </b><span>option message</span></span></span><br><span><var>l</var><span class="hyp-type"><b>: </b><span>label</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">input_valid_transition l (s, iom) (s&#39;, oom)
‚Üí finite_valid_trace_from_to s s&#39;
    [{|
       l := l;
       input := iom;
       destination := s&#39;;
       output := oom
     |}]</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">      </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="VLSM-v-chk1e0" style="display: none" type="checkbox"><label class="alectryon-input" for="VLSM-v-chk1e0"><span class="nb">intro</span> Ht.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>message</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>X</var><span class="hyp-type"><b>: </b><span>VLSM message</span></span></span><br><span><var>TypeX</var><span><span class="hyp-body"><b>:= </b><span>type X</span></span><span class="hyp-type"><b>: </b><span>VLSMType message</span></span></span></span><br><span><var>MachineX</var><span><span class="hyp-body"><b>:= </b><span>machine X</span></span><span class="hyp-type"><b>: </b><span>VLSMMachine (vtype X)</span></span></span></span><br><span><var>s, s'</var><span class="hyp-type"><b>: </b><span>state</span></span></span><br><span><var>iom, oom</var><span class="hyp-type"><b>: </b><span>option message</span></span></span><br><span><var>l</var><span class="hyp-type"><b>: </b><span>label</span></span></span><br><span><var>Ht</var><span class="hyp-type"><b>: </b><span>input_valid_transition l (s, iom) (s&#39;, oom)</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">finite_valid_trace_from_to s s&#39;
  [{|
     l := l;
     input := iom;
     destination := s&#39;;
     output := oom
   |}]</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">      </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="VLSM-v-chk1e1" style="display: none" type="checkbox"><label class="alectryon-input" for="VLSM-v-chk1e1"><span class="nb">constructor</span>;[|<span class="bp">assumption</span>].</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>message</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>X</var><span class="hyp-type"><b>: </b><span>VLSM message</span></span></span><br><span><var>TypeX</var><span><span class="hyp-body"><b>:= </b><span>type X</span></span><span class="hyp-type"><b>: </b><span>VLSMType message</span></span></span></span><br><span><var>MachineX</var><span><span class="hyp-body"><b>:= </b><span>machine X</span></span><span class="hyp-type"><b>: </b><span>VLSMMachine (vtype X)</span></span></span></span><br><span><var>s, s'</var><span class="hyp-type"><b>: </b><span>state</span></span></span><br><span><var>iom, oom</var><span class="hyp-type"><b>: </b><span>option message</span></span></span><br><span><var>l</var><span class="hyp-type"><b>: </b><span>label</span></span></span><br><span><var>Ht</var><span class="hyp-type"><b>: </b><span>input_valid_transition l (s, iom) (s&#39;, oom)</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">finite_valid_trace_from_to s&#39; s&#39; []</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">      </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="VLSM-v-chk1e2" style="display: none" type="checkbox"><label class="alectryon-input" for="VLSM-v-chk1e2"><span class="nb">constructor</span>.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>message</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>X</var><span class="hyp-type"><b>: </b><span>VLSM message</span></span></span><br><span><var>TypeX</var><span><span class="hyp-body"><b>:= </b><span>type X</span></span><span class="hyp-type"><b>: </b><span>VLSMType message</span></span></span></span><br><span><var>MachineX</var><span><span class="hyp-body"><b>:= </b><span>machine X</span></span><span class="hyp-type"><b>: </b><span>VLSMMachine (vtype X)</span></span></span></span><br><span><var>s, s'</var><span class="hyp-type"><b>: </b><span>state</span></span></span><br><span><var>iom, oom</var><span class="hyp-type"><b>: </b><span>option message</span></span></span><br><span><var>l</var><span class="hyp-type"><b>: </b><span>label</span></span></span><br><span><var>Ht</var><span class="hyp-type"><b>: </b><span>input_valid_transition l (s, iom) (s&#39;, oom)</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">valid_state_prop s&#39;</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">      </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="VLSM-v-chk1e3" style="display: none" type="checkbox"><label class="alectryon-input" for="VLSM-v-chk1e3"><span class="nb">apply</span> input_valid_transition_destination <span class="kr">in</span> Ht.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>message</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>X</var><span class="hyp-type"><b>: </b><span>VLSM message</span></span></span><br><span><var>TypeX</var><span><span class="hyp-body"><b>:= </b><span>type X</span></span><span class="hyp-type"><b>: </b><span>VLSMType message</span></span></span></span><br><span><var>MachineX</var><span><span class="hyp-body"><b>:= </b><span>machine X</span></span><span class="hyp-type"><b>: </b><span>VLSMMachine (vtype X)</span></span></span></span><br><span><var>s, s'</var><span class="hyp-type"><b>: </b><span>state</span></span></span><br><span><var>iom, oom</var><span class="hyp-type"><b>: </b><span>option message</span></span></span><br><span><var>l</var><span class="hyp-type"><b>: </b><span>label</span></span></span><br><span><var>Ht</var><span class="hyp-type"><b>: </b><span>valid_state_prop s&#39;</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">valid_state_prop s&#39;</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">      </span><span class="alectryon-sentence"><span class="alectryon-input"><span class="bp">assumption</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Qed</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
</span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="VLSM-v-chk1e4" style="display: none" type="checkbox"><label class="alectryon-input" for="VLSM-v-chk1e4"><span class="kn">Lemma</span> <span class="nf">finite_valid_trace_from_to_forget_last</span>
          <span class="nv">s</span> <span class="nv">f</span> <span class="nv">tr</span> : finite_valid_trace_from_to s f tr -&gt; finite_valid_trace_from s tr.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>message</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>X</var><span class="hyp-type"><b>: </b><span>VLSM message</span></span></span><br><span><var>TypeX</var><span><span class="hyp-body"><b>:= </b><span>type X</span></span><span class="hyp-type"><b>: </b><span>VLSMType message</span></span></span></span><br><span><var>MachineX</var><span><span class="hyp-body"><b>:= </b><span>machine X</span></span><span class="hyp-type"><b>: </b><span>VLSMMachine (vtype X)</span></span></span></span><br><span><var>s, f</var><span class="hyp-type"><b>: </b><span>state</span></span></span><br><span><var>tr</var><span class="hyp-type"><b>: </b><span>list transition_item</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">finite_valid_trace_from_to s f tr
‚Üí finite_valid_trace_from s tr</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="VLSM-v-chk1e5" style="display: none" type="checkbox"><label class="alectryon-input" for="VLSM-v-chk1e5"><span class="kn">Proof</span>.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>message</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>X</var><span class="hyp-type"><b>: </b><span>VLSM message</span></span></span><br><span><var>TypeX</var><span><span class="hyp-body"><b>:= </b><span>type X</span></span><span class="hyp-type"><b>: </b><span>VLSMType message</span></span></span></span><br><span><var>MachineX</var><span><span class="hyp-body"><b>:= </b><span>machine X</span></span><span class="hyp-type"><b>: </b><span>VLSMMachine (vtype X)</span></span></span></span><br><span><var>s, f</var><span class="hyp-type"><b>: </b><span>state</span></span></span><br><span><var>tr</var><span class="hyp-type"><b>: </b><span>list transition_item</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">finite_valid_trace_from_to s f tr
‚Üí finite_valid_trace_from s tr</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">      </span><span class="alectryon-sentence"><span class="alectryon-input"><span class="nb">induction</span> <span class="mi">1</span>;<span class="nb">constructor</span>;<span class="nb">auto</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Qed</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
</span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="VLSM-v-chk1e6" style="display: none" type="checkbox"><label class="alectryon-input" for="VLSM-v-chk1e6"><span class="kn">Lemma</span> <span class="nf">finite_valid_trace_from_to_last</span>
          <span class="nv">s</span> <span class="nv">f</span> <span class="nv">tr</span> : finite_valid_trace_from_to s f tr -&gt; finite_trace_last s tr = f.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>message</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>X</var><span class="hyp-type"><b>: </b><span>VLSM message</span></span></span><br><span><var>TypeX</var><span><span class="hyp-body"><b>:= </b><span>type X</span></span><span class="hyp-type"><b>: </b><span>VLSMType message</span></span></span></span><br><span><var>MachineX</var><span><span class="hyp-body"><b>:= </b><span>machine X</span></span><span class="hyp-type"><b>: </b><span>VLSMMachine (vtype X)</span></span></span></span><br><span><var>s, f</var><span class="hyp-type"><b>: </b><span>state</span></span></span><br><span><var>tr</var><span class="hyp-type"><b>: </b><span>list transition_item</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">finite_valid_trace_from_to s f tr
‚Üí finite_trace_last s tr = f</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="VLSM-v-chk1e7" style="display: none" type="checkbox"><label class="alectryon-input" for="VLSM-v-chk1e7"><span class="kn">Proof</span>.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>message</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>X</var><span class="hyp-type"><b>: </b><span>VLSM message</span></span></span><br><span><var>TypeX</var><span><span class="hyp-body"><b>:= </b><span>type X</span></span><span class="hyp-type"><b>: </b><span>VLSMType message</span></span></span></span><br><span><var>MachineX</var><span><span class="hyp-body"><b>:= </b><span>machine X</span></span><span class="hyp-type"><b>: </b><span>VLSMMachine (vtype X)</span></span></span></span><br><span><var>s, f</var><span class="hyp-type"><b>: </b><span>state</span></span></span><br><span><var>tr</var><span class="hyp-type"><b>: </b><span>list transition_item</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">finite_valid_trace_from_to s f tr
‚Üí finite_trace_last s tr = f</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">      </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="VLSM-v-chk1e8" style="display: none" type="checkbox"><label class="alectryon-input" for="VLSM-v-chk1e8"><span class="nb">induction</span> <span class="mi">1</span>.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>message</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>X</var><span class="hyp-type"><b>: </b><span>VLSM message</span></span></span><br><span><var>TypeX</var><span><span class="hyp-body"><b>:= </b><span>type X</span></span><span class="hyp-type"><b>: </b><span>VLSMType message</span></span></span></span><br><span><var>MachineX</var><span><span class="hyp-body"><b>:= </b><span>machine X</span></span><span class="hyp-type"><b>: </b><span>VLSMMachine (vtype X)</span></span></span></span><br><span><var>s</var><span class="hyp-type"><b>: </b><span>state</span></span></span><br><span><var>Hs</var><span class="hyp-type"><b>: </b><span>valid_state_prop s</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">finite_trace_last s [] = s</div></blockquote><div class="alectryon-extra-goals"><input class="alectryon-extra-goal-toggle" id="VLSM-v-chk1e9" style="display: none" type="checkbox"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>message</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>X</var><span class="hyp-type"><b>: </b><span>VLSM message</span></span></span><br><span><var>TypeX</var><span><span class="hyp-body"><b>:= </b><span>type X</span></span><span class="hyp-type"><b>: </b><span>VLSMType message</span></span></span></span><br><span><var>MachineX</var><span><span class="hyp-body"><b>:= </b><span>machine X</span></span><span class="hyp-type"><b>: </b><span>VLSMMachine (vtype X)</span></span></span></span><br><span><var>s, f</var><span class="hyp-type"><b>: </b><span>state</span></span></span><br><span><var>tl</var><span class="hyp-type"><b>: </b><span>list transition_item</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>finite_valid_trace_from_to s f tl</span></span></span><br><span><var>s'</var><span class="hyp-type"><b>: </b><span>state</span></span></span><br><span><var>iom, oom</var><span class="hyp-type"><b>: </b><span>option message</span></span></span><br><span><var>l0</var><span class="hyp-type"><b>: </b><span>label</span></span></span><br><span><var>Ht</var><span class="hyp-type"><b>: </b><span>input_valid_transition l0 (s&#39;, iom) (s, oom)</span></span></span><br><span><var>IHfinite_valid_trace_from_to</var><span class="hyp-type"><b>: </b><span>finite_trace_last s tl =
f</span></span></span><br></div><label class="goal-separator" for="VLSM-v-chk1e9"><hr></label><div class="goal-conclusion">finite_trace_last s&#39;
  ({|
     l := l0;
     input := iom;
     destination := s;
     output := oom
   |} :: tl) = f</div></blockquote></div></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">      </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="VLSM-v-chk1ea" style="display: none" type="checkbox"><label class="alectryon-input" for="VLSM-v-chk1ea">-</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>message</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>X</var><span class="hyp-type"><b>: </b><span>VLSM message</span></span></span><br><span><var>TypeX</var><span><span class="hyp-body"><b>:= </b><span>type X</span></span><span class="hyp-type"><b>: </b><span>VLSMType message</span></span></span></span><br><span><var>MachineX</var><span><span class="hyp-body"><b>:= </b><span>machine X</span></span><span class="hyp-type"><b>: </b><span>VLSMMachine (vtype X)</span></span></span></span><br><span><var>s</var><span class="hyp-type"><b>: </b><span>state</span></span></span><br><span><var>Hs</var><span class="hyp-type"><b>: </b><span>valid_state_prop s</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">finite_trace_last s [] = s</div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="nb">apply</span> finite_trace_last_nil.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">      </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="VLSM-v-chk1eb" style="display: none" type="checkbox"><label class="alectryon-input" for="VLSM-v-chk1eb">-</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>message</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>X</var><span class="hyp-type"><b>: </b><span>VLSM message</span></span></span><br><span><var>TypeX</var><span><span class="hyp-body"><b>:= </b><span>type X</span></span><span class="hyp-type"><b>: </b><span>VLSMType message</span></span></span></span><br><span><var>MachineX</var><span><span class="hyp-body"><b>:= </b><span>machine X</span></span><span class="hyp-type"><b>: </b><span>VLSMMachine (vtype X)</span></span></span></span><br><span><var>s, f</var><span class="hyp-type"><b>: </b><span>state</span></span></span><br><span><var>tl</var><span class="hyp-type"><b>: </b><span>list transition_item</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>finite_valid_trace_from_to s f tl</span></span></span><br><span><var>s'</var><span class="hyp-type"><b>: </b><span>state</span></span></span><br><span><var>iom, oom</var><span class="hyp-type"><b>: </b><span>option message</span></span></span><br><span><var>l0</var><span class="hyp-type"><b>: </b><span>label</span></span></span><br><span><var>Ht</var><span class="hyp-type"><b>: </b><span>input_valid_transition l0 (s&#39;, iom) (s, oom)</span></span></span><br><span><var>IHfinite_valid_trace_from_to</var><span class="hyp-type"><b>: </b><span>finite_trace_last s tl =
f</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">finite_trace_last s&#39;
  ({|
     l := l0;
     input := iom;
     destination := s;
     output := oom
   |} :: tl) = f</div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="nb">rewrite</span> finite_trace_last_cons; <span class="bp">assumption</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Qed</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">

</span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="VLSM-v-chk1ec" style="display: none" type="checkbox"><label class="alectryon-input" for="VLSM-v-chk1ec"><span class="kn">Lemma</span> <span class="nf">finite_valid_trace_from_add_last</span>
          <span class="nv">s</span> <span class="nv">f</span> <span class="nv">tr</span> :
      finite_valid_trace_from s tr -&gt;
      finite_trace_last s tr = f -&gt;
      finite_valid_trace_from_to s f tr.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>message</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>X</var><span class="hyp-type"><b>: </b><span>VLSM message</span></span></span><br><span><var>TypeX</var><span><span class="hyp-body"><b>:= </b><span>type X</span></span><span class="hyp-type"><b>: </b><span>VLSMType message</span></span></span></span><br><span><var>MachineX</var><span><span class="hyp-body"><b>:= </b><span>machine X</span></span><span class="hyp-type"><b>: </b><span>VLSMMachine (vtype X)</span></span></span></span><br><span><var>s, f</var><span class="hyp-type"><b>: </b><span>state</span></span></span><br><span><var>tr</var><span class="hyp-type"><b>: </b><span>list transition_item</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">finite_valid_trace_from s tr
‚Üí finite_trace_last s tr = f
  ‚Üí finite_valid_trace_from_to s f tr</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="VLSM-v-chk1ed" style="display: none" type="checkbox"><label class="alectryon-input" for="VLSM-v-chk1ed"><span class="kn">Proof</span>.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>message</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>X</var><span class="hyp-type"><b>: </b><span>VLSM message</span></span></span><br><span><var>TypeX</var><span><span class="hyp-body"><b>:= </b><span>type X</span></span><span class="hyp-type"><b>: </b><span>VLSMType message</span></span></span></span><br><span><var>MachineX</var><span><span class="hyp-body"><b>:= </b><span>machine X</span></span><span class="hyp-type"><b>: </b><span>VLSMMachine (vtype X)</span></span></span></span><br><span><var>s, f</var><span class="hyp-type"><b>: </b><span>state</span></span></span><br><span><var>tr</var><span class="hyp-type"><b>: </b><span>list transition_item</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">finite_valid_trace_from s tr
‚Üí finite_trace_last s tr = f
  ‚Üí finite_valid_trace_from_to s f tr</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">      </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="VLSM-v-chk1ee" style="display: none" type="checkbox"><label class="alectryon-input" for="VLSM-v-chk1ee"><span class="nb">intro</span> Hfrom.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>message</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>X</var><span class="hyp-type"><b>: </b><span>VLSM message</span></span></span><br><span><var>TypeX</var><span><span class="hyp-body"><b>:= </b><span>type X</span></span><span class="hyp-type"><b>: </b><span>VLSMType message</span></span></span></span><br><span><var>MachineX</var><span><span class="hyp-body"><b>:= </b><span>machine X</span></span><span class="hyp-type"><b>: </b><span>VLSMMachine (vtype X)</span></span></span></span><br><span><var>s, f</var><span class="hyp-type"><b>: </b><span>state</span></span></span><br><span><var>tr</var><span class="hyp-type"><b>: </b><span>list transition_item</span></span></span><br><span><var>Hfrom</var><span class="hyp-type"><b>: </b><span>finite_valid_trace_from s tr</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">finite_trace_last s tr = f
‚Üí finite_valid_trace_from_to s f tr</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">      </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="VLSM-v-chk1ef" style="display: none" type="checkbox"><label class="alectryon-input" for="VLSM-v-chk1ef"><span class="nb">induction</span> Hfrom.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>message</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>X</var><span class="hyp-type"><b>: </b><span>VLSM message</span></span></span><br><span><var>TypeX</var><span><span class="hyp-body"><b>:= </b><span>type X</span></span><span class="hyp-type"><b>: </b><span>VLSMType message</span></span></span></span><br><span><var>MachineX</var><span><span class="hyp-body"><b>:= </b><span>machine X</span></span><span class="hyp-type"><b>: </b><span>VLSMMachine (vtype X)</span></span></span></span><br><span><var>f, s</var><span class="hyp-type"><b>: </b><span>state</span></span></span><br><span><var>Hs</var><span class="hyp-type"><b>: </b><span>valid_state_prop s</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">finite_trace_last s [] = f
‚Üí finite_valid_trace_from_to s f []</div></blockquote><div class="alectryon-extra-goals"><input class="alectryon-extra-goal-toggle" id="VLSM-v-chk1f0" style="display: none" type="checkbox"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>message</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>X</var><span class="hyp-type"><b>: </b><span>VLSM message</span></span></span><br><span><var>TypeX</var><span><span class="hyp-body"><b>:= </b><span>type X</span></span><span class="hyp-type"><b>: </b><span>VLSMType message</span></span></span></span><br><span><var>MachineX</var><span><span class="hyp-body"><b>:= </b><span>machine X</span></span><span class="hyp-type"><b>: </b><span>VLSMMachine (vtype X)</span></span></span></span><br><span><var>f, s</var><span class="hyp-type"><b>: </b><span>state</span></span></span><br><span><var>tl</var><span class="hyp-type"><b>: </b><span>list transition_item</span></span></span><br><span><var>Hfrom</var><span class="hyp-type"><b>: </b><span>finite_valid_trace_from s tl</span></span></span><br><span><var>s'</var><span class="hyp-type"><b>: </b><span>state</span></span></span><br><span><var>iom, oom</var><span class="hyp-type"><b>: </b><span>option message</span></span></span><br><span><var>l0</var><span class="hyp-type"><b>: </b><span>label</span></span></span><br><span><var>Ht</var><span class="hyp-type"><b>: </b><span>input_valid_transition l0 (s&#39;, iom) (s, oom)</span></span></span><br><span><var>IHHfrom</var><span class="hyp-type"><b>: </b><span>finite_trace_last s tl = f
‚Üí finite_valid_trace_from_to s f tl</span></span></span><br></div><label class="goal-separator" for="VLSM-v-chk1f0"><hr></label><div class="goal-conclusion">finite_trace_last s&#39;
  ({|
     l := l0;
     input := iom;
     destination := s;
     output := oom
   |} :: tl) = f
‚Üí finite_valid_trace_from_to s&#39; f
    ({|
       l := l0;
       input := iom;
       destination := s;
       output := oom
     |} :: tl)</div></blockquote></div></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">      </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="VLSM-v-chk1f1" style="display: none" type="checkbox"><label class="alectryon-input" for="VLSM-v-chk1f1">-</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>message</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>X</var><span class="hyp-type"><b>: </b><span>VLSM message</span></span></span><br><span><var>TypeX</var><span><span class="hyp-body"><b>:= </b><span>type X</span></span><span class="hyp-type"><b>: </b><span>VLSMType message</span></span></span></span><br><span><var>MachineX</var><span><span class="hyp-body"><b>:= </b><span>machine X</span></span><span class="hyp-type"><b>: </b><span>VLSMMachine (vtype X)</span></span></span></span><br><span><var>f, s</var><span class="hyp-type"><b>: </b><span>state</span></span></span><br><span><var>Hs</var><span class="hyp-type"><b>: </b><span>valid_state_prop s</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">finite_trace_last s [] = f
‚Üí finite_valid_trace_from_to s f []</div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="VLSM-v-chk1f2" style="display: none" type="checkbox"><label class="alectryon-input" for="VLSM-v-chk1f2"><span class="nb">rewrite</span> finite_trace_last_nil.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>message</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>X</var><span class="hyp-type"><b>: </b><span>VLSM message</span></span></span><br><span><var>TypeX</var><span><span class="hyp-body"><b>:= </b><span>type X</span></span><span class="hyp-type"><b>: </b><span>VLSMType message</span></span></span></span><br><span><var>MachineX</var><span><span class="hyp-body"><b>:= </b><span>machine X</span></span><span class="hyp-type"><b>: </b><span>VLSMMachine (vtype X)</span></span></span></span><br><span><var>f, s</var><span class="hyp-type"><b>: </b><span>state</span></span></span><br><span><var>Hs</var><span class="hyp-type"><b>: </b><span>valid_state_prop s</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">s = f ‚Üí finite_valid_trace_from_to s f []</div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="VLSM-v-chk1f3" style="display: none" type="checkbox"><label class="alectryon-input" for="VLSM-v-chk1f3"><span class="nb">intros</span> &lt;-.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>message</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>X</var><span class="hyp-type"><b>: </b><span>VLSM message</span></span></span><br><span><var>TypeX</var><span><span class="hyp-body"><b>:= </b><span>type X</span></span><span class="hyp-type"><b>: </b><span>VLSMType message</span></span></span></span><br><span><var>MachineX</var><span><span class="hyp-body"><b>:= </b><span>machine X</span></span><span class="hyp-type"><b>: </b><span>VLSMMachine (vtype X)</span></span></span></span><br><span><var>s</var><span class="hyp-type"><b>: </b><span>state</span></span></span><br><span><var>Hs</var><span class="hyp-type"><b>: </b><span>valid_state_prop s</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">finite_valid_trace_from_to s s []</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">        </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="VLSM-v-chk1f4" style="display: none" type="checkbox"><label class="alectryon-input" for="VLSM-v-chk1f4"><span class="nb">constructor</span>.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>message</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>X</var><span class="hyp-type"><b>: </b><span>VLSM message</span></span></span><br><span><var>TypeX</var><span><span class="hyp-body"><b>:= </b><span>type X</span></span><span class="hyp-type"><b>: </b><span>VLSMType message</span></span></span></span><br><span><var>MachineX</var><span><span class="hyp-body"><b>:= </b><span>machine X</span></span><span class="hyp-type"><b>: </b><span>VLSMMachine (vtype X)</span></span></span></span><br><span><var>s</var><span class="hyp-type"><b>: </b><span>state</span></span></span><br><span><var>Hs</var><span class="hyp-type"><b>: </b><span>valid_state_prop s</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">valid_state_prop s</div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="bp">assumption</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">      </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="VLSM-v-chk1f5" style="display: none" type="checkbox"><label class="alectryon-input" for="VLSM-v-chk1f5">-</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>message</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>X</var><span class="hyp-type"><b>: </b><span>VLSM message</span></span></span><br><span><var>TypeX</var><span><span class="hyp-body"><b>:= </b><span>type X</span></span><span class="hyp-type"><b>: </b><span>VLSMType message</span></span></span></span><br><span><var>MachineX</var><span><span class="hyp-body"><b>:= </b><span>machine X</span></span><span class="hyp-type"><b>: </b><span>VLSMMachine (vtype X)</span></span></span></span><br><span><var>f, s</var><span class="hyp-type"><b>: </b><span>state</span></span></span><br><span><var>tl</var><span class="hyp-type"><b>: </b><span>list transition_item</span></span></span><br><span><var>Hfrom</var><span class="hyp-type"><b>: </b><span>finite_valid_trace_from s tl</span></span></span><br><span><var>s'</var><span class="hyp-type"><b>: </b><span>state</span></span></span><br><span><var>iom, oom</var><span class="hyp-type"><b>: </b><span>option message</span></span></span><br><span><var>l0</var><span class="hyp-type"><b>: </b><span>label</span></span></span><br><span><var>Ht</var><span class="hyp-type"><b>: </b><span>input_valid_transition l0 (s&#39;, iom) (s, oom)</span></span></span><br><span><var>IHHfrom</var><span class="hyp-type"><b>: </b><span>finite_trace_last s tl = f
‚Üí finite_valid_trace_from_to s f tl</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">finite_trace_last s&#39;
  ({|
     l := l0;
     input := iom;
     destination := s;
     output := oom
   |} :: tl) = f
‚Üí finite_valid_trace_from_to s&#39; f
    ({|
       l := l0;
       input := iom;
       destination := s;
       output := oom
     |} :: tl)</div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="VLSM-v-chk1f6" style="display: none" type="checkbox"><label class="alectryon-input" for="VLSM-v-chk1f6"><span class="nb">rewrite</span> finite_trace_last_cons.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>message</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>X</var><span class="hyp-type"><b>: </b><span>VLSM message</span></span></span><br><span><var>TypeX</var><span><span class="hyp-body"><b>:= </b><span>type X</span></span><span class="hyp-type"><b>: </b><span>VLSMType message</span></span></span></span><br><span><var>MachineX</var><span><span class="hyp-body"><b>:= </b><span>machine X</span></span><span class="hyp-type"><b>: </b><span>VLSMMachine (vtype X)</span></span></span></span><br><span><var>f, s</var><span class="hyp-type"><b>: </b><span>state</span></span></span><br><span><var>tl</var><span class="hyp-type"><b>: </b><span>list transition_item</span></span></span><br><span><var>Hfrom</var><span class="hyp-type"><b>: </b><span>finite_valid_trace_from s tl</span></span></span><br><span><var>s'</var><span class="hyp-type"><b>: </b><span>state</span></span></span><br><span><var>iom, oom</var><span class="hyp-type"><b>: </b><span>option message</span></span></span><br><span><var>l0</var><span class="hyp-type"><b>: </b><span>label</span></span></span><br><span><var>Ht</var><span class="hyp-type"><b>: </b><span>input_valid_transition l0 (s&#39;, iom) (s, oom)</span></span></span><br><span><var>IHHfrom</var><span class="hyp-type"><b>: </b><span>finite_trace_last s tl = f
‚Üí finite_valid_trace_from_to s f tl</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">finite_trace_last
  (destination
     {|
       l := l0;
       input := iom;
       destination := s;
       output := oom
     |}) tl = f
‚Üí finite_valid_trace_from_to s&#39; f
    ({|
       l := l0;
       input := iom;
       destination := s;
       output := oom
     |} :: tl)</div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="VLSM-v-chk1f7" style="display: none" type="checkbox"><label class="alectryon-input" for="VLSM-v-chk1f7"><span class="nb">simpl</span>.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>message</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>X</var><span class="hyp-type"><b>: </b><span>VLSM message</span></span></span><br><span><var>TypeX</var><span><span class="hyp-body"><b>:= </b><span>type X</span></span><span class="hyp-type"><b>: </b><span>VLSMType message</span></span></span></span><br><span><var>MachineX</var><span><span class="hyp-body"><b>:= </b><span>machine X</span></span><span class="hyp-type"><b>: </b><span>VLSMMachine (vtype X)</span></span></span></span><br><span><var>f, s</var><span class="hyp-type"><b>: </b><span>state</span></span></span><br><span><var>tl</var><span class="hyp-type"><b>: </b><span>list transition_item</span></span></span><br><span><var>Hfrom</var><span class="hyp-type"><b>: </b><span>finite_valid_trace_from s tl</span></span></span><br><span><var>s'</var><span class="hyp-type"><b>: </b><span>state</span></span></span><br><span><var>iom, oom</var><span class="hyp-type"><b>: </b><span>option message</span></span></span><br><span><var>l0</var><span class="hyp-type"><b>: </b><span>label</span></span></span><br><span><var>Ht</var><span class="hyp-type"><b>: </b><span>input_valid_transition l0 (s&#39;, iom) (s, oom)</span></span></span><br><span><var>IHHfrom</var><span class="hyp-type"><b>: </b><span>finite_trace_last s tl = f
‚Üí finite_valid_trace_from_to s f tl</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">finite_trace_last s tl = f
‚Üí finite_valid_trace_from_to s&#39; f
    ({|
       l := l0;
       input := iom;
       destination := s;
       output := oom
     |} :: tl)</div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="VLSM-v-chk1f8" style="display: none" type="checkbox"><label class="alectryon-input" for="VLSM-v-chk1f8"><span class="nb">intro</span>.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>message</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>X</var><span class="hyp-type"><b>: </b><span>VLSM message</span></span></span><br><span><var>TypeX</var><span><span class="hyp-body"><b>:= </b><span>type X</span></span><span class="hyp-type"><b>: </b><span>VLSMType message</span></span></span></span><br><span><var>MachineX</var><span><span class="hyp-body"><b>:= </b><span>machine X</span></span><span class="hyp-type"><b>: </b><span>VLSMMachine (vtype X)</span></span></span></span><br><span><var>f, s</var><span class="hyp-type"><b>: </b><span>state</span></span></span><br><span><var>tl</var><span class="hyp-type"><b>: </b><span>list transition_item</span></span></span><br><span><var>Hfrom</var><span class="hyp-type"><b>: </b><span>finite_valid_trace_from s tl</span></span></span><br><span><var>s'</var><span class="hyp-type"><b>: </b><span>state</span></span></span><br><span><var>iom, oom</var><span class="hyp-type"><b>: </b><span>option message</span></span></span><br><span><var>l0</var><span class="hyp-type"><b>: </b><span>label</span></span></span><br><span><var>Ht</var><span class="hyp-type"><b>: </b><span>input_valid_transition l0 (s&#39;, iom) (s, oom)</span></span></span><br><span><var>IHHfrom</var><span class="hyp-type"><b>: </b><span>finite_trace_last s tl = f
‚Üí finite_valid_trace_from_to s f tl</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>finite_trace_last s tl = f</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">finite_valid_trace_from_to s&#39; f
  ({|
     l := l0;
     input := iom;
     destination := s;
     output := oom
   |} :: tl)</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">        </span><span class="alectryon-sentence"><span class="alectryon-input"><span class="nb">constructor</span>;<span class="nb">auto</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Qed</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
</span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="VLSM-v-chk1f9" style="display: none" type="checkbox"><label class="alectryon-input" for="VLSM-v-chk1f9"><span class="kn">Lemma</span> <span class="nf">finite_valid_trace_from_to_first_pstate</span>
          <span class="nv">s</span> <span class="nv">f</span> <span class="nv">tr</span> : finite_valid_trace_from_to s f tr -&gt; valid_state_prop s.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>message</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>X</var><span class="hyp-type"><b>: </b><span>VLSM message</span></span></span><br><span><var>TypeX</var><span><span class="hyp-body"><b>:= </b><span>type X</span></span><span class="hyp-type"><b>: </b><span>VLSMType message</span></span></span></span><br><span><var>MachineX</var><span><span class="hyp-body"><b>:= </b><span>machine X</span></span><span class="hyp-type"><b>: </b><span>VLSMMachine (vtype X)</span></span></span></span><br><span><var>s, f</var><span class="hyp-type"><b>: </b><span>state</span></span></span><br><span><var>tr</var><span class="hyp-type"><b>: </b><span>list transition_item</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">finite_valid_trace_from_to s f tr ‚Üí valid_state_prop s</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="VLSM-v-chk1fa" style="display: none" type="checkbox"><label class="alectryon-input" for="VLSM-v-chk1fa"><span class="kn">Proof</span>.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>message</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>X</var><span class="hyp-type"><b>: </b><span>VLSM message</span></span></span><br><span><var>TypeX</var><span><span class="hyp-body"><b>:= </b><span>type X</span></span><span class="hyp-type"><b>: </b><span>VLSMType message</span></span></span></span><br><span><var>MachineX</var><span><span class="hyp-body"><b>:= </b><span>machine X</span></span><span class="hyp-type"><b>: </b><span>VLSMMachine (vtype X)</span></span></span></span><br><span><var>s, f</var><span class="hyp-type"><b>: </b><span>state</span></span></span><br><span><var>tr</var><span class="hyp-type"><b>: </b><span>list transition_item</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">finite_valid_trace_from_to s f tr ‚Üí valid_state_prop s</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">      </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="VLSM-v-chk1fb" style="display: none" type="checkbox"><label class="alectryon-input" for="VLSM-v-chk1fb"><span class="nb">intro</span> Htr.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>message</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>X</var><span class="hyp-type"><b>: </b><span>VLSM message</span></span></span><br><span><var>TypeX</var><span><span class="hyp-body"><b>:= </b><span>type X</span></span><span class="hyp-type"><b>: </b><span>VLSMType message</span></span></span></span><br><span><var>MachineX</var><span><span class="hyp-body"><b>:= </b><span>machine X</span></span><span class="hyp-type"><b>: </b><span>VLSMMachine (vtype X)</span></span></span></span><br><span><var>s, f</var><span class="hyp-type"><b>: </b><span>state</span></span></span><br><span><var>tr</var><span class="hyp-type"><b>: </b><span>list transition_item</span></span></span><br><span><var>Htr</var><span class="hyp-type"><b>: </b><span>finite_valid_trace_from_to s f tr</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">valid_state_prop s</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">      </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="VLSM-v-chk1fc" style="display: none" type="checkbox"><label class="alectryon-input" for="VLSM-v-chk1fc"><span class="nb">apply</span> finite_valid_trace_from_to_forget_last <span class="kr">in</span> Htr.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>message</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>X</var><span class="hyp-type"><b>: </b><span>VLSM message</span></span></span><br><span><var>TypeX</var><span><span class="hyp-body"><b>:= </b><span>type X</span></span><span class="hyp-type"><b>: </b><span>VLSMType message</span></span></span></span><br><span><var>MachineX</var><span><span class="hyp-body"><b>:= </b><span>machine X</span></span><span class="hyp-type"><b>: </b><span>VLSMMachine (vtype X)</span></span></span></span><br><span><var>s, f</var><span class="hyp-type"><b>: </b><span>state</span></span></span><br><span><var>tr</var><span class="hyp-type"><b>: </b><span>list transition_item</span></span></span><br><span><var>Htr</var><span class="hyp-type"><b>: </b><span>finite_valid_trace_from s tr</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">valid_state_prop s</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">      </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="VLSM-v-chk1fd" style="display: none" type="checkbox"><label class="alectryon-input" for="VLSM-v-chk1fd"><span class="nb">apply</span> finite_valid_trace_first_pstate <span class="kr">in</span> Htr.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>message</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>X</var><span class="hyp-type"><b>: </b><span>VLSM message</span></span></span><br><span><var>TypeX</var><span><span class="hyp-body"><b>:= </b><span>type X</span></span><span class="hyp-type"><b>: </b><span>VLSMType message</span></span></span></span><br><span><var>MachineX</var><span><span class="hyp-body"><b>:= </b><span>machine X</span></span><span class="hyp-type"><b>: </b><span>VLSMMachine (vtype X)</span></span></span></span><br><span><var>s, f</var><span class="hyp-type"><b>: </b><span>state</span></span></span><br><span><var>tr</var><span class="hyp-type"><b>: </b><span>list transition_item</span></span></span><br><span><var>Htr</var><span class="hyp-type"><b>: </b><span>valid_state_prop s</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">valid_state_prop s</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">      </span><span class="alectryon-sentence"><span class="alectryon-input"><span class="bp">assumption</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Qed</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
</span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="VLSM-v-chk1fe" style="display: none" type="checkbox"><label class="alectryon-input" for="VLSM-v-chk1fe"><span class="kn">Lemma</span> <span class="nf">finite_valid_trace_from_to_last_pstate</span>
          <span class="nv">s</span> <span class="nv">f</span> <span class="nv">tr</span> : finite_valid_trace_from_to s f tr -&gt; valid_state_prop f.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>message</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>X</var><span class="hyp-type"><b>: </b><span>VLSM message</span></span></span><br><span><var>TypeX</var><span><span class="hyp-body"><b>:= </b><span>type X</span></span><span class="hyp-type"><b>: </b><span>VLSMType message</span></span></span></span><br><span><var>MachineX</var><span><span class="hyp-body"><b>:= </b><span>machine X</span></span><span class="hyp-type"><b>: </b><span>VLSMMachine (vtype X)</span></span></span></span><br><span><var>s, f</var><span class="hyp-type"><b>: </b><span>state</span></span></span><br><span><var>tr</var><span class="hyp-type"><b>: </b><span>list transition_item</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">finite_valid_trace_from_to s f tr ‚Üí valid_state_prop f</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="VLSM-v-chk1ff" style="display: none" type="checkbox"><label class="alectryon-input" for="VLSM-v-chk1ff"><span class="kn">Proof</span>.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>message</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>X</var><span class="hyp-type"><b>: </b><span>VLSM message</span></span></span><br><span><var>TypeX</var><span><span class="hyp-body"><b>:= </b><span>type X</span></span><span class="hyp-type"><b>: </b><span>VLSMType message</span></span></span></span><br><span><var>MachineX</var><span><span class="hyp-body"><b>:= </b><span>machine X</span></span><span class="hyp-type"><b>: </b><span>VLSMMachine (vtype X)</span></span></span></span><br><span><var>s, f</var><span class="hyp-type"><b>: </b><span>state</span></span></span><br><span><var>tr</var><span class="hyp-type"><b>: </b><span>list transition_item</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">finite_valid_trace_from_to s f tr ‚Üí valid_state_prop f</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">      </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="VLSM-v-chk200" style="display: none" type="checkbox"><label class="alectryon-input" for="VLSM-v-chk200"><span class="nb">intro</span> Htr.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>message</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>X</var><span class="hyp-type"><b>: </b><span>VLSM message</span></span></span><br><span><var>TypeX</var><span><span class="hyp-body"><b>:= </b><span>type X</span></span><span class="hyp-type"><b>: </b><span>VLSMType message</span></span></span></span><br><span><var>MachineX</var><span><span class="hyp-body"><b>:= </b><span>machine X</span></span><span class="hyp-type"><b>: </b><span>VLSMMachine (vtype X)</span></span></span></span><br><span><var>s, f</var><span class="hyp-type"><b>: </b><span>state</span></span></span><br><span><var>tr</var><span class="hyp-type"><b>: </b><span>list transition_item</span></span></span><br><span><var>Htr</var><span class="hyp-type"><b>: </b><span>finite_valid_trace_from_to s f tr</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">valid_state_prop f</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">      </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="VLSM-v-chk201" style="display: none" type="checkbox"><label class="alectryon-input" for="VLSM-v-chk201"><span class="nb">rewrite</span> &lt;- (finite_valid_trace_from_to_last _ _ _ Htr).</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>message</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>X</var><span class="hyp-type"><b>: </b><span>VLSM message</span></span></span><br><span><var>TypeX</var><span><span class="hyp-body"><b>:= </b><span>type X</span></span><span class="hyp-type"><b>: </b><span>VLSMType message</span></span></span></span><br><span><var>MachineX</var><span><span class="hyp-body"><b>:= </b><span>machine X</span></span><span class="hyp-type"><b>: </b><span>VLSMMachine (vtype X)</span></span></span></span><br><span><var>s, f</var><span class="hyp-type"><b>: </b><span>state</span></span></span><br><span><var>tr</var><span class="hyp-type"><b>: </b><span>list transition_item</span></span></span><br><span><var>Htr</var><span class="hyp-type"><b>: </b><span>finite_valid_trace_from_to s f tr</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">valid_state_prop (finite_trace_last s tr)</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">      </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="VLSM-v-chk202" style="display: none" type="checkbox"><label class="alectryon-input" for="VLSM-v-chk202"><span class="nb">apply</span> finite_valid_trace_last_pstate.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>message</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>X</var><span class="hyp-type"><b>: </b><span>VLSM message</span></span></span><br><span><var>TypeX</var><span><span class="hyp-body"><b>:= </b><span>type X</span></span><span class="hyp-type"><b>: </b><span>VLSMType message</span></span></span></span><br><span><var>MachineX</var><span><span class="hyp-body"><b>:= </b><span>machine X</span></span><span class="hyp-type"><b>: </b><span>VLSMMachine (vtype X)</span></span></span></span><br><span><var>s, f</var><span class="hyp-type"><b>: </b><span>state</span></span></span><br><span><var>tr</var><span class="hyp-type"><b>: </b><span>list transition_item</span></span></span><br><span><var>Htr</var><span class="hyp-type"><b>: </b><span>finite_valid_trace_from_to s f tr</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">finite_valid_trace_from s tr</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">      </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="VLSM-v-chk203" style="display: none" type="checkbox"><label class="alectryon-input" for="VLSM-v-chk203"><span class="nb">apply</span> finite_valid_trace_from_to_forget_last <span class="kr">in</span> Htr.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>message</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>X</var><span class="hyp-type"><b>: </b><span>VLSM message</span></span></span><br><span><var>TypeX</var><span><span class="hyp-body"><b>:= </b><span>type X</span></span><span class="hyp-type"><b>: </b><span>VLSMType message</span></span></span></span><br><span><var>MachineX</var><span><span class="hyp-body"><b>:= </b><span>machine X</span></span><span class="hyp-type"><b>: </b><span>VLSMMachine (vtype X)</span></span></span></span><br><span><var>s, f</var><span class="hyp-type"><b>: </b><span>state</span></span></span><br><span><var>tr</var><span class="hyp-type"><b>: </b><span>list transition_item</span></span></span><br><span><var>Htr</var><span class="hyp-type"><b>: </b><span>finite_valid_trace_from s tr</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">finite_valid_trace_from s tr</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">      </span><span class="alectryon-sentence"><span class="alectryon-input"><span class="bp">assumption</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Qed</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
</span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="VLSM-v-chk204" style="display: none" type="checkbox"><label class="alectryon-input" for="VLSM-v-chk204"><span class="kn">Lemma</span> <span class="nf">finite_valid_trace_from_to_app</span>
      (<span class="nv">m</span> <span class="nv">s</span> <span class="nv">f</span>: state) (<span class="nv">ls</span> <span class="nv">ls&#39;</span> : list transition_item)
      : finite_valid_trace_from_to s m ls
        -&gt; finite_valid_trace_from_to m f ls&#39;
        -&gt; finite_valid_trace_from_to s f (ls ++ ls&#39;).</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>message</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>X</var><span class="hyp-type"><b>: </b><span>VLSM message</span></span></span><br><span><var>TypeX</var><span><span class="hyp-body"><b>:= </b><span>type X</span></span><span class="hyp-type"><b>: </b><span>VLSMType message</span></span></span></span><br><span><var>MachineX</var><span><span class="hyp-body"><b>:= </b><span>machine X</span></span><span class="hyp-type"><b>: </b><span>VLSMMachine (vtype X)</span></span></span></span><br><span><var>m, s, f</var><span class="hyp-type"><b>: </b><span>state</span></span></span><br><span><var>ls, ls'</var><span class="hyp-type"><b>: </b><span>list transition_item</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">finite_valid_trace_from_to s m ls
‚Üí finite_valid_trace_from_to m f ls&#39;
  ‚Üí finite_valid_trace_from_to s f (ls ++ ls&#39;)</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="VLSM-v-chk205" style="display: none" type="checkbox"><label class="alectryon-input" for="VLSM-v-chk205"><span class="kn">Proof</span>.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>message</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>X</var><span class="hyp-type"><b>: </b><span>VLSM message</span></span></span><br><span><var>TypeX</var><span><span class="hyp-body"><b>:= </b><span>type X</span></span><span class="hyp-type"><b>: </b><span>VLSMType message</span></span></span></span><br><span><var>MachineX</var><span><span class="hyp-body"><b>:= </b><span>machine X</span></span><span class="hyp-type"><b>: </b><span>VLSMMachine (vtype X)</span></span></span></span><br><span><var>m, s, f</var><span class="hyp-type"><b>: </b><span>state</span></span></span><br><span><var>ls, ls'</var><span class="hyp-type"><b>: </b><span>list transition_item</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">finite_valid_trace_from_to s m ls
‚Üí finite_valid_trace_from_to m f ls&#39;
  ‚Üí finite_valid_trace_from_to s f (ls ++ ls&#39;)</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">      </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="VLSM-v-chk206" style="display: none" type="checkbox"><label class="alectryon-input" for="VLSM-v-chk206"><span class="nb">intros</span> Hl Hl&#39;;<span class="nb">induction</span> Hl;<span class="nb">simpl</span>.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>message</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>X</var><span class="hyp-type"><b>: </b><span>VLSM message</span></span></span><br><span><var>TypeX</var><span><span class="hyp-body"><b>:= </b><span>type X</span></span><span class="hyp-type"><b>: </b><span>VLSMType message</span></span></span></span><br><span><var>MachineX</var><span><span class="hyp-body"><b>:= </b><span>machine X</span></span><span class="hyp-type"><b>: </b><span>VLSMMachine (vtype X)</span></span></span></span><br><span><var>f</var><span class="hyp-type"><b>: </b><span>state</span></span></span><br><span><var>ls'</var><span class="hyp-type"><b>: </b><span>list transition_item</span></span></span><br><span><var>s</var><span class="hyp-type"><b>: </b><span>state</span></span></span><br><span><var>Hs</var><span class="hyp-type"><b>: </b><span>valid_state_prop s</span></span></span><br><span><var>Hl'</var><span class="hyp-type"><b>: </b><span>finite_valid_trace_from_to s f ls&#39;</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">finite_valid_trace_from_to s f ls&#39;</div></blockquote><div class="alectryon-extra-goals"><input class="alectryon-extra-goal-toggle" id="VLSM-v-chk207" style="display: none" type="checkbox"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>message</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>X</var><span class="hyp-type"><b>: </b><span>VLSM message</span></span></span><br><span><var>TypeX</var><span><span class="hyp-body"><b>:= </b><span>type X</span></span><span class="hyp-type"><b>: </b><span>VLSMType message</span></span></span></span><br><span><var>MachineX</var><span><span class="hyp-body"><b>:= </b><span>machine X</span></span><span class="hyp-type"><b>: </b><span>VLSMMachine (vtype X)</span></span></span></span><br><span><var>f</var><span class="hyp-type"><b>: </b><span>state</span></span></span><br><span><var>ls'</var><span class="hyp-type"><b>: </b><span>list transition_item</span></span></span><br><span><var>s, f0</var><span class="hyp-type"><b>: </b><span>state</span></span></span><br><span><var>tl</var><span class="hyp-type"><b>: </b><span>list transition_item</span></span></span><br><span><var>Hl</var><span class="hyp-type"><b>: </b><span>finite_valid_trace_from_to s f0 tl</span></span></span><br><span><var>s'</var><span class="hyp-type"><b>: </b><span>state</span></span></span><br><span><var>iom, oom</var><span class="hyp-type"><b>: </b><span>option message</span></span></span><br><span><var>l0</var><span class="hyp-type"><b>: </b><span>label</span></span></span><br><span><var>Ht</var><span class="hyp-type"><b>: </b><span>input_valid_transition l0 (s&#39;, iom) (s, oom)</span></span></span><br><span><var>Hl'</var><span class="hyp-type"><b>: </b><span>finite_valid_trace_from_to f0 f ls&#39;</span></span></span><br><span><var>IHHl</var><span class="hyp-type"><b>: </b><span>finite_valid_trace_from_to f0 f ls&#39;
‚Üí finite_valid_trace_from_to s f (tl ++ ls&#39;)</span></span></span><br></div><label class="goal-separator" for="VLSM-v-chk207"><hr></label><div class="goal-conclusion">finite_valid_trace_from_to s&#39; f
  ({|
     l := l0;
     input := iom;
     destination := s;
     output := oom
   |} :: tl ++ ls&#39;)</div></blockquote></div></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">      </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="VLSM-v-chk208" style="display: none" type="checkbox"><label class="alectryon-input" for="VLSM-v-chk208">-</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>message</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>X</var><span class="hyp-type"><b>: </b><span>VLSM message</span></span></span><br><span><var>TypeX</var><span><span class="hyp-body"><b>:= </b><span>type X</span></span><span class="hyp-type"><b>: </b><span>VLSMType message</span></span></span></span><br><span><var>MachineX</var><span><span class="hyp-body"><b>:= </b><span>machine X</span></span><span class="hyp-type"><b>: </b><span>VLSMMachine (vtype X)</span></span></span></span><br><span><var>f</var><span class="hyp-type"><b>: </b><span>state</span></span></span><br><span><var>ls'</var><span class="hyp-type"><b>: </b><span>list transition_item</span></span></span><br><span><var>s</var><span class="hyp-type"><b>: </b><span>state</span></span></span><br><span><var>Hs</var><span class="hyp-type"><b>: </b><span>valid_state_prop s</span></span></span><br><span><var>Hl'</var><span class="hyp-type"><b>: </b><span>finite_valid_trace_from_to s f ls&#39;</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">finite_valid_trace_from_to s f ls&#39;</div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="nb">trivial</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">      </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="VLSM-v-chk209" style="display: none" type="checkbox"><label class="alectryon-input" for="VLSM-v-chk209">-</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>message</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>X</var><span class="hyp-type"><b>: </b><span>VLSM message</span></span></span><br><span><var>TypeX</var><span><span class="hyp-body"><b>:= </b><span>type X</span></span><span class="hyp-type"><b>: </b><span>VLSMType message</span></span></span></span><br><span><var>MachineX</var><span><span class="hyp-body"><b>:= </b><span>machine X</span></span><span class="hyp-type"><b>: </b><span>VLSMMachine (vtype X)</span></span></span></span><br><span><var>f</var><span class="hyp-type"><b>: </b><span>state</span></span></span><br><span><var>ls'</var><span class="hyp-type"><b>: </b><span>list transition_item</span></span></span><br><span><var>s, f0</var><span class="hyp-type"><b>: </b><span>state</span></span></span><br><span><var>tl</var><span class="hyp-type"><b>: </b><span>list transition_item</span></span></span><br><span><var>Hl</var><span class="hyp-type"><b>: </b><span>finite_valid_trace_from_to s f0 tl</span></span></span><br><span><var>s'</var><span class="hyp-type"><b>: </b><span>state</span></span></span><br><span><var>iom, oom</var><span class="hyp-type"><b>: </b><span>option message</span></span></span><br><span><var>l0</var><span class="hyp-type"><b>: </b><span>label</span></span></span><br><span><var>Ht</var><span class="hyp-type"><b>: </b><span>input_valid_transition l0 (s&#39;, iom) (s, oom)</span></span></span><br><span><var>Hl'</var><span class="hyp-type"><b>: </b><span>finite_valid_trace_from_to f0 f ls&#39;</span></span></span><br><span><var>IHHl</var><span class="hyp-type"><b>: </b><span>finite_valid_trace_from_to f0 f ls&#39;
‚Üí finite_valid_trace_from_to s f (tl ++ ls&#39;)</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">finite_valid_trace_from_to s&#39; f
  ({|
     l := l0;
     input := iom;
     destination := s;
     output := oom
   |} :: tl ++ ls&#39;)</div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="nb">constructor</span>;<span class="nb">auto</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Qed</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
</span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="VLSM-v-chk20a" style="display: none" type="checkbox"><label class="alectryon-input" for="VLSM-v-chk20a"><span class="kn">Lemma</span> <span class="nf">finite_valid_trace_from_to_app_split</span>
      (<span class="nv">s</span> <span class="nv">f</span>: state) (<span class="nv">ls</span> <span class="nv">ls&#39;</span> : list transition_item)
      : finite_valid_trace_from_to s f (ls ++ ls&#39;) -&gt;
        <span class="kr">let</span> <span class="nv">m</span> := finite_trace_last s ls <span class="kr">in</span>
        finite_valid_trace_from_to s m ls
        /\ finite_valid_trace_from_to m f ls&#39;.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>message</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>X</var><span class="hyp-type"><b>: </b><span>VLSM message</span></span></span><br><span><var>TypeX</var><span><span class="hyp-body"><b>:= </b><span>type X</span></span><span class="hyp-type"><b>: </b><span>VLSMType message</span></span></span></span><br><span><var>MachineX</var><span><span class="hyp-body"><b>:= </b><span>machine X</span></span><span class="hyp-type"><b>: </b><span>VLSMMachine (vtype X)</span></span></span></span><br><span><var>s, f</var><span class="hyp-type"><b>: </b><span>state</span></span></span><br><span><var>ls, ls'</var><span class="hyp-type"><b>: </b><span>list transition_item</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">finite_valid_trace_from_to s f (ls ++ ls&#39;)
‚Üí <span class="kr">let</span> <span class="nv">m</span> := finite_trace_last s ls <span class="kr">in</span>
  finite_valid_trace_from_to s m ls
  ‚àß finite_valid_trace_from_to m f ls&#39;</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="VLSM-v-chk20b" style="display: none" type="checkbox"><label class="alectryon-input" for="VLSM-v-chk20b"><span class="kn">Proof</span>.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>message</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>X</var><span class="hyp-type"><b>: </b><span>VLSM message</span></span></span><br><span><var>TypeX</var><span><span class="hyp-body"><b>:= </b><span>type X</span></span><span class="hyp-type"><b>: </b><span>VLSMType message</span></span></span></span><br><span><var>MachineX</var><span><span class="hyp-body"><b>:= </b><span>machine X</span></span><span class="hyp-type"><b>: </b><span>VLSMMachine (vtype X)</span></span></span></span><br><span><var>s, f</var><span class="hyp-type"><b>: </b><span>state</span></span></span><br><span><var>ls, ls'</var><span class="hyp-type"><b>: </b><span>list transition_item</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">finite_valid_trace_from_to s f (ls ++ ls&#39;)
‚Üí <span class="kr">let</span> <span class="nv">m</span> := finite_trace_last s ls <span class="kr">in</span>
  finite_valid_trace_from_to s m ls
  ‚àß finite_valid_trace_from_to m f ls&#39;</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">      </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="VLSM-v-chk20c" style="display: none" type="checkbox"><label class="alectryon-input" for="VLSM-v-chk20c"><span class="nb">revert</span> s;<span class="nb">induction</span> ls;<span class="nb">intros</span> s;<span class="nb">simpl</span>.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>message</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>X</var><span class="hyp-type"><b>: </b><span>VLSM message</span></span></span><br><span><var>TypeX</var><span><span class="hyp-body"><b>:= </b><span>type X</span></span><span class="hyp-type"><b>: </b><span>VLSMType message</span></span></span></span><br><span><var>MachineX</var><span><span class="hyp-body"><b>:= </b><span>machine X</span></span><span class="hyp-type"><b>: </b><span>VLSMMachine (vtype X)</span></span></span></span><br><span><var>f</var><span class="hyp-type"><b>: </b><span>state</span></span></span><br><span><var>ls'</var><span class="hyp-type"><b>: </b><span>list transition_item</span></span></span><br><span><var>s</var><span class="hyp-type"><b>: </b><span>state</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">finite_valid_trace_from_to s f ls&#39;
‚Üí finite_valid_trace_from_to s
    (finite_trace_last s []) []
  ‚àß finite_valid_trace_from_to
      (finite_trace_last s []) f ls&#39;</div></blockquote><div class="alectryon-extra-goals"><input class="alectryon-extra-goal-toggle" id="VLSM-v-chk20d" style="display: none" type="checkbox"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>message</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>X</var><span class="hyp-type"><b>: </b><span>VLSM message</span></span></span><br><span><var>TypeX</var><span><span class="hyp-body"><b>:= </b><span>type X</span></span><span class="hyp-type"><b>: </b><span>VLSMType message</span></span></span></span><br><span><var>MachineX</var><span><span class="hyp-body"><b>:= </b><span>machine X</span></span><span class="hyp-type"><b>: </b><span>VLSMMachine (vtype X)</span></span></span></span><br><span><var>f</var><span class="hyp-type"><b>: </b><span>state</span></span></span><br><span><var>a</var><span class="hyp-type"><b>: </b><span>transition_item</span></span></span><br><span><var>ls, ls'</var><span class="hyp-type"><b>: </b><span>list transition_item</span></span></span><br><span><var>IHls</var><span class="hyp-type"><b>: </b><span><span class="kr">‚àÄ</span> <span class="nv">s</span> : state,
  finite_valid_trace_from_to s f (ls ++ ls&#39;)
  ‚Üí <span class="kr">let</span> <span class="nv">m</span> := finite_trace_last s ls <span class="kr">in</span>
    finite_valid_trace_from_to s m ls
    ‚àß finite_valid_trace_from_to m f ls&#39;</span></span></span><br><span><var>s</var><span class="hyp-type"><b>: </b><span>state</span></span></span><br></div><label class="goal-separator" for="VLSM-v-chk20d"><hr></label><div class="goal-conclusion">finite_valid_trace_from_to s f (a :: ls ++ ls&#39;)
‚Üí finite_valid_trace_from_to s
    (finite_trace_last s (a :: ls)) 
    (a :: ls)
  ‚àß finite_valid_trace_from_to
      (finite_trace_last s (a :: ls)) f ls&#39;</div></blockquote></div></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">      </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="VLSM-v-chk20e" style="display: none" type="checkbox"><label class="alectryon-input" for="VLSM-v-chk20e">-</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>message</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>X</var><span class="hyp-type"><b>: </b><span>VLSM message</span></span></span><br><span><var>TypeX</var><span><span class="hyp-body"><b>:= </b><span>type X</span></span><span class="hyp-type"><b>: </b><span>VLSMType message</span></span></span></span><br><span><var>MachineX</var><span><span class="hyp-body"><b>:= </b><span>machine X</span></span><span class="hyp-type"><b>: </b><span>VLSMMachine (vtype X)</span></span></span></span><br><span><var>f</var><span class="hyp-type"><b>: </b><span>state</span></span></span><br><span><var>ls'</var><span class="hyp-type"><b>: </b><span>list transition_item</span></span></span><br><span><var>s</var><span class="hyp-type"><b>: </b><span>state</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">finite_valid_trace_from_to s f ls&#39;
‚Üí finite_valid_trace_from_to s
    (finite_trace_last s []) []
  ‚àß finite_valid_trace_from_to
      (finite_trace_last s []) f ls&#39;</div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="VLSM-v-chk20f" style="display: none" type="checkbox"><label class="alectryon-input" for="VLSM-v-chk20f"><span class="nb">rewrite</span> finite_trace_last_nil.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>message</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>X</var><span class="hyp-type"><b>: </b><span>VLSM message</span></span></span><br><span><var>TypeX</var><span><span class="hyp-body"><b>:= </b><span>type X</span></span><span class="hyp-type"><b>: </b><span>VLSMType message</span></span></span></span><br><span><var>MachineX</var><span><span class="hyp-body"><b>:= </b><span>machine X</span></span><span class="hyp-type"><b>: </b><span>VLSMMachine (vtype X)</span></span></span></span><br><span><var>f</var><span class="hyp-type"><b>: </b><span>state</span></span></span><br><span><var>ls'</var><span class="hyp-type"><b>: </b><span>list transition_item</span></span></span><br><span><var>s</var><span class="hyp-type"><b>: </b><span>state</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">finite_valid_trace_from_to s f ls&#39;
‚Üí finite_valid_trace_from_to s s []
  ‚àß finite_valid_trace_from_to s f ls&#39;</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">        </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="VLSM-v-chk210" style="display: none" type="checkbox"><label class="alectryon-input" for="VLSM-v-chk210"><span class="nb">intro</span> Htr.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>message</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>X</var><span class="hyp-type"><b>: </b><span>VLSM message</span></span></span><br><span><var>TypeX</var><span><span class="hyp-body"><b>:= </b><span>type X</span></span><span class="hyp-type"><b>: </b><span>VLSMType message</span></span></span></span><br><span><var>MachineX</var><span><span class="hyp-body"><b>:= </b><span>machine X</span></span><span class="hyp-type"><b>: </b><span>VLSMMachine (vtype X)</span></span></span></span><br><span><var>f</var><span class="hyp-type"><b>: </b><span>state</span></span></span><br><span><var>ls'</var><span class="hyp-type"><b>: </b><span>list transition_item</span></span></span><br><span><var>s</var><span class="hyp-type"><b>: </b><span>state</span></span></span><br><span><var>Htr</var><span class="hyp-type"><b>: </b><span>finite_valid_trace_from_to s f ls&#39;</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">finite_valid_trace_from_to s s []
‚àß finite_valid_trace_from_to s f ls&#39;</div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="VLSM-v-chk211" style="display: none" type="checkbox"><label class="alectryon-input" for="VLSM-v-chk211"><span class="nb">split</span>;[|<span class="bp">assumption</span>].</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>message</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>X</var><span class="hyp-type"><b>: </b><span>VLSM message</span></span></span><br><span><var>TypeX</var><span><span class="hyp-body"><b>:= </b><span>type X</span></span><span class="hyp-type"><b>: </b><span>VLSMType message</span></span></span></span><br><span><var>MachineX</var><span><span class="hyp-body"><b>:= </b><span>machine X</span></span><span class="hyp-type"><b>: </b><span>VLSMMachine (vtype X)</span></span></span></span><br><span><var>f</var><span class="hyp-type"><b>: </b><span>state</span></span></span><br><span><var>ls'</var><span class="hyp-type"><b>: </b><span>list transition_item</span></span></span><br><span><var>s</var><span class="hyp-type"><b>: </b><span>state</span></span></span><br><span><var>Htr</var><span class="hyp-type"><b>: </b><span>finite_valid_trace_from_to s f ls&#39;</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">finite_valid_trace_from_to s s []</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">        </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="VLSM-v-chk212" style="display: none" type="checkbox"><label class="alectryon-input" for="VLSM-v-chk212"><span class="nb">apply</span> finite_valid_trace_from_to_first_pstate <span class="kr">in</span> Htr.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>message</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>X</var><span class="hyp-type"><b>: </b><span>VLSM message</span></span></span><br><span><var>TypeX</var><span><span class="hyp-body"><b>:= </b><span>type X</span></span><span class="hyp-type"><b>: </b><span>VLSMType message</span></span></span></span><br><span><var>MachineX</var><span><span class="hyp-body"><b>:= </b><span>machine X</span></span><span class="hyp-type"><b>: </b><span>VLSMMachine (vtype X)</span></span></span></span><br><span><var>f</var><span class="hyp-type"><b>: </b><span>state</span></span></span><br><span><var>ls'</var><span class="hyp-type"><b>: </b><span>list transition_item</span></span></span><br><span><var>s</var><span class="hyp-type"><b>: </b><span>state</span></span></span><br><span><var>Htr</var><span class="hyp-type"><b>: </b><span>valid_state_prop s</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">finite_valid_trace_from_to s s []</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">        </span><span class="alectryon-sentence"><span class="alectryon-input"><span class="nb">constructor</span>;<span class="bp">assumption</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">      </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="VLSM-v-chk213" style="display: none" type="checkbox"><label class="alectryon-input" for="VLSM-v-chk213">-</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>message</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>X</var><span class="hyp-type"><b>: </b><span>VLSM message</span></span></span><br><span><var>TypeX</var><span><span class="hyp-body"><b>:= </b><span>type X</span></span><span class="hyp-type"><b>: </b><span>VLSMType message</span></span></span></span><br><span><var>MachineX</var><span><span class="hyp-body"><b>:= </b><span>machine X</span></span><span class="hyp-type"><b>: </b><span>VLSMMachine (vtype X)</span></span></span></span><br><span><var>f</var><span class="hyp-type"><b>: </b><span>state</span></span></span><br><span><var>a</var><span class="hyp-type"><b>: </b><span>transition_item</span></span></span><br><span><var>ls, ls'</var><span class="hyp-type"><b>: </b><span>list transition_item</span></span></span><br><span><var>IHls</var><span class="hyp-type"><b>: </b><span><span class="kr">‚àÄ</span> <span class="nv">s</span> : state,
  finite_valid_trace_from_to s f (ls ++ ls&#39;)
  ‚Üí <span class="kr">let</span> <span class="nv">m</span> := finite_trace_last s ls <span class="kr">in</span>
    finite_valid_trace_from_to s m ls
    ‚àß finite_valid_trace_from_to m f ls&#39;</span></span></span><br><span><var>s</var><span class="hyp-type"><b>: </b><span>state</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">finite_valid_trace_from_to s f (a :: ls ++ ls&#39;)
‚Üí finite_valid_trace_from_to s
    (finite_trace_last s (a :: ls)) (a :: ls)
  ‚àß finite_valid_trace_from_to
      (finite_trace_last s (a :: ls)) f ls&#39;</div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="VLSM-v-chk214" style="display: none" type="checkbox"><label class="alectryon-input" for="VLSM-v-chk214"><span class="nb">rewrite</span> finite_trace_last_cons.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>message</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>X</var><span class="hyp-type"><b>: </b><span>VLSM message</span></span></span><br><span><var>TypeX</var><span><span class="hyp-body"><b>:= </b><span>type X</span></span><span class="hyp-type"><b>: </b><span>VLSMType message</span></span></span></span><br><span><var>MachineX</var><span><span class="hyp-body"><b>:= </b><span>machine X</span></span><span class="hyp-type"><b>: </b><span>VLSMMachine (vtype X)</span></span></span></span><br><span><var>f</var><span class="hyp-type"><b>: </b><span>state</span></span></span><br><span><var>a</var><span class="hyp-type"><b>: </b><span>transition_item</span></span></span><br><span><var>ls, ls'</var><span class="hyp-type"><b>: </b><span>list transition_item</span></span></span><br><span><var>IHls</var><span class="hyp-type"><b>: </b><span><span class="kr">‚àÄ</span> <span class="nv">s</span> : state,
  finite_valid_trace_from_to s f (ls ++ ls&#39;)
  ‚Üí <span class="kr">let</span> <span class="nv">m</span> := finite_trace_last s ls <span class="kr">in</span>
    finite_valid_trace_from_to s m ls
    ‚àß finite_valid_trace_from_to m f ls&#39;</span></span></span><br><span><var>s</var><span class="hyp-type"><b>: </b><span>state</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">finite_valid_trace_from_to s f (a :: ls ++ ls&#39;)
‚Üí finite_valid_trace_from_to s
    (finite_trace_last (destination a) ls) (a :: ls)
  ‚àß finite_valid_trace_from_to
      (finite_trace_last (destination a) ls) f ls&#39;</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">        </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="VLSM-v-chk215" style="display: none" type="checkbox"><label class="alectryon-input" for="VLSM-v-chk215"><span class="nb">inversion</span> <span class="mi">1</span>; <span class="nb">subst</span>; <span class="nb">simpl</span> <span class="kr">in</span> *.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>message</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>X</var><span class="hyp-type"><b>: </b><span>VLSM message</span></span></span><br><span><var>TypeX</var><span><span class="hyp-body"><b>:= </b><span>type X</span></span><span class="hyp-type"><b>: </b><span>VLSMType message</span></span></span></span><br><span><var>MachineX</var><span><span class="hyp-body"><b>:= </b><span>machine X</span></span><span class="hyp-type"><b>: </b><span>VLSMMachine (vtype X)</span></span></span></span><br><span><var>f</var><span class="hyp-type"><b>: </b><span>state</span></span></span><br><span><var>ls, ls'</var><span class="hyp-type"><b>: </b><span>list transition_item</span></span></span><br><span><var>IHls</var><span class="hyp-type"><b>: </b><span><span class="kr">‚àÄ</span> <span class="nv">s</span> : state,
  finite_valid_trace_from_to s f (ls ++ ls&#39;)
  ‚Üí finite_valid_trace_from_to s
      (finite_trace_last s ls) ls
    ‚àß finite_valid_trace_from_to
        (finite_trace_last s ls) f ls&#39;</span></span></span><br><span><var>s, s1</var><span class="hyp-type"><b>: </b><span>state</span></span></span><br><span><var>iom, oom</var><span class="hyp-type"><b>: </b><span>option message</span></span></span><br><span><var>l0</var><span class="hyp-type"><b>: </b><span>label</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>finite_valid_trace_from_to s f
  ({|
     l := l0;
     input := iom;
     destination := s1;
     output := oom
   |} :: ls ++ ls&#39;)</span></span></span><br><span><var>Htl</var><span class="hyp-type"><b>: </b><span>finite_valid_trace_from_to s1 f (ls ++ ls&#39;)</span></span></span><br><span><var>Ht</var><span class="hyp-type"><b>: </b><span>input_valid_transition l0 (s, iom) (s1, oom)</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">finite_valid_trace_from_to s (finite_trace_last s1 ls)
  ({|
     l := l0;
     input := iom;
     destination := s1;
     output := oom
   |} :: ls)
‚àß finite_valid_trace_from_to (finite_trace_last s1 ls)
    f ls&#39;</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">        </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="VLSM-v-chk216" style="display: none" type="checkbox"><label class="alectryon-input" for="VLSM-v-chk216"><span class="nb">apply</span> IHls <span class="kr">in</span> Htl <span class="kr">as</span> [].</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>message</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>X</var><span class="hyp-type"><b>: </b><span>VLSM message</span></span></span><br><span><var>TypeX</var><span><span class="hyp-body"><b>:= </b><span>type X</span></span><span class="hyp-type"><b>: </b><span>VLSMType message</span></span></span></span><br><span><var>MachineX</var><span><span class="hyp-body"><b>:= </b><span>machine X</span></span><span class="hyp-type"><b>: </b><span>VLSMMachine (vtype X)</span></span></span></span><br><span><var>f</var><span class="hyp-type"><b>: </b><span>state</span></span></span><br><span><var>ls, ls'</var><span class="hyp-type"><b>: </b><span>list transition_item</span></span></span><br><span><var>IHls</var><span class="hyp-type"><b>: </b><span><span class="kr">‚àÄ</span> <span class="nv">s</span> : state,
  finite_valid_trace_from_to s f (ls ++ ls&#39;)
  ‚Üí finite_valid_trace_from_to s
      (finite_trace_last s ls) ls
    ‚àß finite_valid_trace_from_to
        (finite_trace_last s ls) f ls&#39;</span></span></span><br><span><var>s, s1</var><span class="hyp-type"><b>: </b><span>state</span></span></span><br><span><var>iom, oom</var><span class="hyp-type"><b>: </b><span>option message</span></span></span><br><span><var>l0</var><span class="hyp-type"><b>: </b><span>label</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>finite_valid_trace_from_to s f
  ({|
     l := l0;
     input := iom;
     destination := s1;
     output := oom
   |} :: ls ++ ls&#39;)</span></span></span><br><span><var>H0</var><span class="hyp-type"><b>: </b><span>finite_valid_trace_from_to s1
  (finite_trace_last s1 ls) ls</span></span></span><br><span><var>H1</var><span class="hyp-type"><b>: </b><span>finite_valid_trace_from_to
  (finite_trace_last s1 ls) f ls&#39;</span></span></span><br><span><var>Ht</var><span class="hyp-type"><b>: </b><span>input_valid_transition l0 (s, iom) (s1, oom)</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">finite_valid_trace_from_to s (finite_trace_last s1 ls)
  ({|
     l := l0;
     input := iom;
     destination := s1;
     output := oom
   |} :: ls)
‚àß finite_valid_trace_from_to (finite_trace_last s1 ls)
    f ls&#39;</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">        </span><span class="alectryon-sentence"><span class="alectryon-input"><span class="nb">auto using</span> finite_valid_trace_from_to_extend.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Qed</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
</span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Definition</span> <span class="nf">finite_valid_trace_init_to</span> <span class="nv">si</span> <span class="nv">sf</span> <span class="nv">tr</span> : <span class="kt">Prop</span>
      := finite_valid_trace_from_to si sf tr
          /\ initial_state_prop si.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
</span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="VLSM-v-chk217" style="display: none" type="checkbox"><label class="alectryon-input" for="VLSM-v-chk217"><span class="kn">Lemma</span> <span class="nf">finite_valid_trace_init_add_last</span> <span class="nv">si</span> <span class="nv">sf</span> <span class="nv">tr</span>:
      finite_valid_trace si tr -&gt;
      finite_trace_last si tr = sf -&gt;
      finite_valid_trace_init_to si sf tr.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>message</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>X</var><span class="hyp-type"><b>: </b><span>VLSM message</span></span></span><br><span><var>TypeX</var><span><span class="hyp-body"><b>:= </b><span>type X</span></span><span class="hyp-type"><b>: </b><span>VLSMType message</span></span></span></span><br><span><var>MachineX</var><span><span class="hyp-body"><b>:= </b><span>machine X</span></span><span class="hyp-type"><b>: </b><span>VLSMMachine (vtype X)</span></span></span></span><br><span><var>si, sf</var><span class="hyp-type"><b>: </b><span>state</span></span></span><br><span><var>tr</var><span class="hyp-type"><b>: </b><span>list transition_item</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">finite_valid_trace si tr
‚Üí finite_trace_last si tr = sf
  ‚Üí finite_valid_trace_init_to si sf tr</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="VLSM-v-chk218" style="display: none" type="checkbox"><label class="alectryon-input" for="VLSM-v-chk218"><span class="kn">Proof</span>.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>message</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>X</var><span class="hyp-type"><b>: </b><span>VLSM message</span></span></span><br><span><var>TypeX</var><span><span class="hyp-body"><b>:= </b><span>type X</span></span><span class="hyp-type"><b>: </b><span>VLSMType message</span></span></span></span><br><span><var>MachineX</var><span><span class="hyp-body"><b>:= </b><span>machine X</span></span><span class="hyp-type"><b>: </b><span>VLSMMachine (vtype X)</span></span></span></span><br><span><var>si, sf</var><span class="hyp-type"><b>: </b><span>state</span></span></span><br><span><var>tr</var><span class="hyp-type"><b>: </b><span>list transition_item</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">finite_valid_trace si tr
‚Üí finite_trace_last si tr = sf
  ‚Üí finite_valid_trace_init_to si sf tr</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">      </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="VLSM-v-chk219" style="display: none" type="checkbox"><label class="alectryon-input" for="VLSM-v-chk219"><span class="nb">intros</span> [Htr Hinit] Hf.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>message</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>X</var><span class="hyp-type"><b>: </b><span>VLSM message</span></span></span><br><span><var>TypeX</var><span><span class="hyp-body"><b>:= </b><span>type X</span></span><span class="hyp-type"><b>: </b><span>VLSMType message</span></span></span></span><br><span><var>MachineX</var><span><span class="hyp-body"><b>:= </b><span>machine X</span></span><span class="hyp-type"><b>: </b><span>VLSMMachine (vtype X)</span></span></span></span><br><span><var>si, sf</var><span class="hyp-type"><b>: </b><span>state</span></span></span><br><span><var>tr</var><span class="hyp-type"><b>: </b><span>list transition_item</span></span></span><br><span><var>Htr</var><span class="hyp-type"><b>: </b><span>finite_valid_trace_from si tr</span></span></span><br><span><var>Hinit</var><span class="hyp-type"><b>: </b><span>initial_state_prop si</span></span></span><br><span><var>Hf</var><span class="hyp-type"><b>: </b><span>finite_trace_last si tr = sf</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">finite_valid_trace_init_to si sf tr</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">      </span><span class="alectryon-sentence"><span class="alectryon-input"><span class="nb">split</span>;<span class="nb">eauto using</span> finite_valid_trace_from_add_last.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Qed</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
</span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="VLSM-v-chk21a" style="display: none" type="checkbox"><label class="alectryon-input" for="VLSM-v-chk21a"><span class="kn">Lemma</span> <span class="nf">finite_valid_trace_init_to_forget_last</span> <span class="nv">si</span> <span class="nv">sf</span> <span class="nv">tr</span>:
      finite_valid_trace_init_to si sf tr -&gt;
      finite_valid_trace si tr.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>message</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>X</var><span class="hyp-type"><b>: </b><span>VLSM message</span></span></span><br><span><var>TypeX</var><span><span class="hyp-body"><b>:= </b><span>type X</span></span><span class="hyp-type"><b>: </b><span>VLSMType message</span></span></span></span><br><span><var>MachineX</var><span><span class="hyp-body"><b>:= </b><span>machine X</span></span><span class="hyp-type"><b>: </b><span>VLSMMachine (vtype X)</span></span></span></span><br><span><var>si, sf</var><span class="hyp-type"><b>: </b><span>state</span></span></span><br><span><var>tr</var><span class="hyp-type"><b>: </b><span>list transition_item</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">finite_valid_trace_init_to si sf tr
‚Üí finite_valid_trace si tr</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="VLSM-v-chk21b" style="display: none" type="checkbox"><label class="alectryon-input" for="VLSM-v-chk21b"><span class="kn">Proof</span>.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>message</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>X</var><span class="hyp-type"><b>: </b><span>VLSM message</span></span></span><br><span><var>TypeX</var><span><span class="hyp-body"><b>:= </b><span>type X</span></span><span class="hyp-type"><b>: </b><span>VLSMType message</span></span></span></span><br><span><var>MachineX</var><span><span class="hyp-body"><b>:= </b><span>machine X</span></span><span class="hyp-type"><b>: </b><span>VLSMMachine (vtype X)</span></span></span></span><br><span><var>si, sf</var><span class="hyp-type"><b>: </b><span>state</span></span></span><br><span><var>tr</var><span class="hyp-type"><b>: </b><span>list transition_item</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">finite_valid_trace_init_to si sf tr
‚Üí finite_valid_trace si tr</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">      </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="VLSM-v-chk21c" style="display: none" type="checkbox"><label class="alectryon-input" for="VLSM-v-chk21c"><span class="nb">intros</span> [Hinit Htr].</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>message</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>X</var><span class="hyp-type"><b>: </b><span>VLSM message</span></span></span><br><span><var>TypeX</var><span><span class="hyp-body"><b>:= </b><span>type X</span></span><span class="hyp-type"><b>: </b><span>VLSMType message</span></span></span></span><br><span><var>MachineX</var><span><span class="hyp-body"><b>:= </b><span>machine X</span></span><span class="hyp-type"><b>: </b><span>VLSMMachine (vtype X)</span></span></span></span><br><span><var>si, sf</var><span class="hyp-type"><b>: </b><span>state</span></span></span><br><span><var>tr</var><span class="hyp-type"><b>: </b><span>list transition_item</span></span></span><br><span><var>Hinit</var><span class="hyp-type"><b>: </b><span>finite_valid_trace_from_to si sf tr</span></span></span><br><span><var>Htr</var><span class="hyp-type"><b>: </b><span>initial_state_prop si</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">finite_valid_trace si tr</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">      </span><span class="alectryon-sentence"><span class="alectryon-input"><span class="nb">split</span>;<span class="nb">eauto using</span> finite_valid_trace_from_to_forget_last.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Qed</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
</span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="VLSM-v-chk21d" style="display: none" type="checkbox"><label class="alectryon-input" for="VLSM-v-chk21d"><span class="kn">Lemma</span> <span class="nf">finite_valid_trace_init_to_last</span> <span class="nv">si</span> <span class="nv">sf</span> <span class="nv">tr</span>:
      finite_valid_trace_init_to si sf tr -&gt;
      finite_trace_last si tr = sf.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>message</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>X</var><span class="hyp-type"><b>: </b><span>VLSM message</span></span></span><br><span><var>TypeX</var><span><span class="hyp-body"><b>:= </b><span>type X</span></span><span class="hyp-type"><b>: </b><span>VLSMType message</span></span></span></span><br><span><var>MachineX</var><span><span class="hyp-body"><b>:= </b><span>machine X</span></span><span class="hyp-type"><b>: </b><span>VLSMMachine (vtype X)</span></span></span></span><br><span><var>si, sf</var><span class="hyp-type"><b>: </b><span>state</span></span></span><br><span><var>tr</var><span class="hyp-type"><b>: </b><span>list transition_item</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">finite_valid_trace_init_to si sf tr
‚Üí finite_trace_last si tr = sf</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="VLSM-v-chk21e" style="display: none" type="checkbox"><label class="alectryon-input" for="VLSM-v-chk21e"><span class="kn">Proof</span>.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>message</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>X</var><span class="hyp-type"><b>: </b><span>VLSM message</span></span></span><br><span><var>TypeX</var><span><span class="hyp-body"><b>:= </b><span>type X</span></span><span class="hyp-type"><b>: </b><span>VLSMType message</span></span></span></span><br><span><var>MachineX</var><span><span class="hyp-body"><b>:= </b><span>machine X</span></span><span class="hyp-type"><b>: </b><span>VLSMMachine (vtype X)</span></span></span></span><br><span><var>si, sf</var><span class="hyp-type"><b>: </b><span>state</span></span></span><br><span><var>tr</var><span class="hyp-type"><b>: </b><span>list transition_item</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">finite_valid_trace_init_to si sf tr
‚Üí finite_trace_last si tr = sf</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">      </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="VLSM-v-chk21f" style="display: none" type="checkbox"><label class="alectryon-input" for="VLSM-v-chk21f"><span class="nb">intros</span> [Htr _].</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>message</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>X</var><span class="hyp-type"><b>: </b><span>VLSM message</span></span></span><br><span><var>TypeX</var><span><span class="hyp-body"><b>:= </b><span>type X</span></span><span class="hyp-type"><b>: </b><span>VLSMType message</span></span></span></span><br><span><var>MachineX</var><span><span class="hyp-body"><b>:= </b><span>machine X</span></span><span class="hyp-type"><b>: </b><span>VLSMMachine (vtype X)</span></span></span></span><br><span><var>si, sf</var><span class="hyp-type"><b>: </b><span>state</span></span></span><br><span><var>tr</var><span class="hyp-type"><b>: </b><span>list transition_item</span></span></span><br><span><var>Htr</var><span class="hyp-type"><b>: </b><span>finite_valid_trace_from_to si sf tr</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">finite_trace_last si tr = sf</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">      </span><span class="alectryon-sentence"><span class="alectryon-input"><span class="nb">eauto using</span> finite_valid_trace_from_to_last.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Qed</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
</span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="VLSM-v-chk220" style="display: none" type="checkbox"><label class="alectryon-input" for="VLSM-v-chk220"><span class="kn">Lemma</span> <span class="nf">extend_right_finite_trace_from_to</span>
      (<span class="nv">s1</span> <span class="nv">s2</span> : state)
      (<span class="nv">ts</span> : list transition_item)
      (<span class="nv">Ht12</span> : finite_valid_trace_from_to s1 s2 ts)
      (<span class="nv">l3</span> : label)
      (<span class="nv">iom3</span> : option message)
      (<span class="nv">s3</span> : state)
      (<span class="nv">oom3</span> : option message)
      (<span class="nv">Hv23</span> : input_valid_transition l3 (s2, iom3) (s3, oom3))
      : finite_valid_trace_from_to s1 s3 (ts ++ [{| l := l3; destination := s3; input := iom3; output := oom3 |}]).</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>message</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>X</var><span class="hyp-type"><b>: </b><span>VLSM message</span></span></span><br><span><var>TypeX</var><span><span class="hyp-body"><b>:= </b><span>type X</span></span><span class="hyp-type"><b>: </b><span>VLSMType message</span></span></span></span><br><span><var>MachineX</var><span><span class="hyp-body"><b>:= </b><span>machine X</span></span><span class="hyp-type"><b>: </b><span>VLSMMachine (vtype X)</span></span></span></span><br><span><var>s1, s2</var><span class="hyp-type"><b>: </b><span>state</span></span></span><br><span><var>ts</var><span class="hyp-type"><b>: </b><span>list transition_item</span></span></span><br><span><var>Ht12</var><span class="hyp-type"><b>: </b><span>finite_valid_trace_from_to s1 s2 ts</span></span></span><br><span><var>l3</var><span class="hyp-type"><b>: </b><span>label</span></span></span><br><span><var>iom3</var><span class="hyp-type"><b>: </b><span>option message</span></span></span><br><span><var>s3</var><span class="hyp-type"><b>: </b><span>state</span></span></span><br><span><var>oom3</var><span class="hyp-type"><b>: </b><span>option message</span></span></span><br><span><var>Hv23</var><span class="hyp-type"><b>: </b><span>input_valid_transition l3 (s2, iom3) (s3, oom3)</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">finite_valid_trace_from_to s1 s3
  (ts ++
   [{|
      l := l3;
      input := iom3;
      destination := s3;
      output := oom3
    |}])</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="VLSM-v-chk221" style="display: none" type="checkbox"><label class="alectryon-input" for="VLSM-v-chk221"><span class="kn">Proof</span>.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>message</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>X</var><span class="hyp-type"><b>: </b><span>VLSM message</span></span></span><br><span><var>TypeX</var><span><span class="hyp-body"><b>:= </b><span>type X</span></span><span class="hyp-type"><b>: </b><span>VLSMType message</span></span></span></span><br><span><var>MachineX</var><span><span class="hyp-body"><b>:= </b><span>machine X</span></span><span class="hyp-type"><b>: </b><span>VLSMMachine (vtype X)</span></span></span></span><br><span><var>s1, s2</var><span class="hyp-type"><b>: </b><span>state</span></span></span><br><span><var>ts</var><span class="hyp-type"><b>: </b><span>list transition_item</span></span></span><br><span><var>Ht12</var><span class="hyp-type"><b>: </b><span>finite_valid_trace_from_to s1 s2 ts</span></span></span><br><span><var>l3</var><span class="hyp-type"><b>: </b><span>label</span></span></span><br><span><var>iom3</var><span class="hyp-type"><b>: </b><span>option message</span></span></span><br><span><var>s3</var><span class="hyp-type"><b>: </b><span>state</span></span></span><br><span><var>oom3</var><span class="hyp-type"><b>: </b><span>option message</span></span></span><br><span><var>Hv23</var><span class="hyp-type"><b>: </b><span>input_valid_transition l3 (s2, iom3) (s3, oom3)</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">finite_valid_trace_from_to s1 s3
  (ts ++
   [{|
      l := l3;
      input := iom3;
      destination := s3;
      output := oom3
    |}])</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">      </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="VLSM-v-chk222" style="display: none" type="checkbox"><label class="alectryon-input" for="VLSM-v-chk222"><span class="nb">induction</span> Ht12.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>message</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>X</var><span class="hyp-type"><b>: </b><span>VLSM message</span></span></span><br><span><var>TypeX</var><span><span class="hyp-body"><b>:= </b><span>type X</span></span><span class="hyp-type"><b>: </b><span>VLSMType message</span></span></span></span><br><span><var>MachineX</var><span><span class="hyp-body"><b>:= </b><span>machine X</span></span><span class="hyp-type"><b>: </b><span>VLSMMachine (vtype X)</span></span></span></span><br><span><var>s</var><span class="hyp-type"><b>: </b><span>state</span></span></span><br><span><var>Hs</var><span class="hyp-type"><b>: </b><span>valid_state_prop s</span></span></span><br><span><var>l3</var><span class="hyp-type"><b>: </b><span>label</span></span></span><br><span><var>iom3</var><span class="hyp-type"><b>: </b><span>option message</span></span></span><br><span><var>s3</var><span class="hyp-type"><b>: </b><span>state</span></span></span><br><span><var>oom3</var><span class="hyp-type"><b>: </b><span>option message</span></span></span><br><span><var>Hv23</var><span class="hyp-type"><b>: </b><span>input_valid_transition l3 (s, iom3) (s3, oom3)</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">finite_valid_trace_from_to s s3
  ([] ++
   [{|
      l := l3;
      input := iom3;
      destination := s3;
      output := oom3
    |}])</div></blockquote><div class="alectryon-extra-goals"><input class="alectryon-extra-goal-toggle" id="VLSM-v-chk223" style="display: none" type="checkbox"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>message</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>X</var><span class="hyp-type"><b>: </b><span>VLSM message</span></span></span><br><span><var>TypeX</var><span><span class="hyp-body"><b>:= </b><span>type X</span></span><span class="hyp-type"><b>: </b><span>VLSMType message</span></span></span></span><br><span><var>MachineX</var><span><span class="hyp-body"><b>:= </b><span>machine X</span></span><span class="hyp-type"><b>: </b><span>VLSMMachine (vtype X)</span></span></span></span><br><span><var>s, f</var><span class="hyp-type"><b>: </b><span>state</span></span></span><br><span><var>tl</var><span class="hyp-type"><b>: </b><span>list transition_item</span></span></span><br><span><var>Ht12</var><span class="hyp-type"><b>: </b><span>finite_valid_trace_from_to s f tl</span></span></span><br><span><var>s'</var><span class="hyp-type"><b>: </b><span>state</span></span></span><br><span><var>iom, oom</var><span class="hyp-type"><b>: </b><span>option message</span></span></span><br><span><var>l0</var><span class="hyp-type"><b>: </b><span>label</span></span></span><br><span><var>Ht</var><span class="hyp-type"><b>: </b><span>input_valid_transition l0 (s&#39;, iom) (s, oom)</span></span></span><br><span><var>l3</var><span class="hyp-type"><b>: </b><span>label</span></span></span><br><span><var>iom3</var><span class="hyp-type"><b>: </b><span>option message</span></span></span><br><span><var>s3</var><span class="hyp-type"><b>: </b><span>state</span></span></span><br><span><var>oom3</var><span class="hyp-type"><b>: </b><span>option message</span></span></span><br><span><var>Hv23</var><span class="hyp-type"><b>: </b><span>input_valid_transition l3 (f, iom3) (s3, oom3)</span></span></span><br><span><var>IHHt12</var><span class="hyp-type"><b>: </b><span>input_valid_transition l3 
  (f, iom3) (s3, oom3)
‚Üí finite_valid_trace_from_to s s3
    (tl ++
     [{|
        l := l3;
        input := iom3;
        destination := s3;
        output := oom3
      |}])</span></span></span><br></div><label class="goal-separator" for="VLSM-v-chk223"><hr></label><div class="goal-conclusion">finite_valid_trace_from_to s&#39; s3
  (({|
      l := l0;
      input := iom;
      destination := s;
      output := oom
    |} :: tl) ++
   [{|
      l := l3;
      input := iom3;
      destination := s3;
      output := oom3
    |}])</div></blockquote></div></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">      </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="VLSM-v-chk224" style="display: none" type="checkbox"><label class="alectryon-input" for="VLSM-v-chk224">-</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>message</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>X</var><span class="hyp-type"><b>: </b><span>VLSM message</span></span></span><br><span><var>TypeX</var><span><span class="hyp-body"><b>:= </b><span>type X</span></span><span class="hyp-type"><b>: </b><span>VLSMType message</span></span></span></span><br><span><var>MachineX</var><span><span class="hyp-body"><b>:= </b><span>machine X</span></span><span class="hyp-type"><b>: </b><span>VLSMMachine (vtype X)</span></span></span></span><br><span><var>s</var><span class="hyp-type"><b>: </b><span>state</span></span></span><br><span><var>Hs</var><span class="hyp-type"><b>: </b><span>valid_state_prop s</span></span></span><br><span><var>l3</var><span class="hyp-type"><b>: </b><span>label</span></span></span><br><span><var>iom3</var><span class="hyp-type"><b>: </b><span>option message</span></span></span><br><span><var>s3</var><span class="hyp-type"><b>: </b><span>state</span></span></span><br><span><var>oom3</var><span class="hyp-type"><b>: </b><span>option message</span></span></span><br><span><var>Hv23</var><span class="hyp-type"><b>: </b><span>input_valid_transition l3 (s, iom3) (s3, oom3)</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">finite_valid_trace_from_to s s3
  ([] ++
   [{|
      l := l3;
      input := iom3;
      destination := s3;
      output := oom3
    |}])</div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="VLSM-v-chk225" style="display: none" type="checkbox"><label class="alectryon-input" for="VLSM-v-chk225"><span class="nb">simpl</span>.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>message</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>X</var><span class="hyp-type"><b>: </b><span>VLSM message</span></span></span><br><span><var>TypeX</var><span><span class="hyp-body"><b>:= </b><span>type X</span></span><span class="hyp-type"><b>: </b><span>VLSMType message</span></span></span></span><br><span><var>MachineX</var><span><span class="hyp-body"><b>:= </b><span>machine X</span></span><span class="hyp-type"><b>: </b><span>VLSMMachine (vtype X)</span></span></span></span><br><span><var>s</var><span class="hyp-type"><b>: </b><span>state</span></span></span><br><span><var>Hs</var><span class="hyp-type"><b>: </b><span>valid_state_prop s</span></span></span><br><span><var>l3</var><span class="hyp-type"><b>: </b><span>label</span></span></span><br><span><var>iom3</var><span class="hyp-type"><b>: </b><span>option message</span></span></span><br><span><var>s3</var><span class="hyp-type"><b>: </b><span>state</span></span></span><br><span><var>oom3</var><span class="hyp-type"><b>: </b><span>option message</span></span></span><br><span><var>Hv23</var><span class="hyp-type"><b>: </b><span>input_valid_transition l3 (s, iom3) (s3, oom3)</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">finite_valid_trace_from_to s s3
  [{|
     l := l3;
     input := iom3;
     destination := s3;
     output := oom3
   |}]</div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="nb">apply</span> finite_valid_trace_from_to_singleton;<span class="bp">assumption</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">      </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="VLSM-v-chk226" style="display: none" type="checkbox"><label class="alectryon-input" for="VLSM-v-chk226">-</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>message</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>X</var><span class="hyp-type"><b>: </b><span>VLSM message</span></span></span><br><span><var>TypeX</var><span><span class="hyp-body"><b>:= </b><span>type X</span></span><span class="hyp-type"><b>: </b><span>VLSMType message</span></span></span></span><br><span><var>MachineX</var><span><span class="hyp-body"><b>:= </b><span>machine X</span></span><span class="hyp-type"><b>: </b><span>VLSMMachine (vtype X)</span></span></span></span><br><span><var>s, f</var><span class="hyp-type"><b>: </b><span>state</span></span></span><br><span><var>tl</var><span class="hyp-type"><b>: </b><span>list transition_item</span></span></span><br><span><var>Ht12</var><span class="hyp-type"><b>: </b><span>finite_valid_trace_from_to s f tl</span></span></span><br><span><var>s'</var><span class="hyp-type"><b>: </b><span>state</span></span></span><br><span><var>iom, oom</var><span class="hyp-type"><b>: </b><span>option message</span></span></span><br><span><var>l0</var><span class="hyp-type"><b>: </b><span>label</span></span></span><br><span><var>Ht</var><span class="hyp-type"><b>: </b><span>input_valid_transition l0 (s&#39;, iom) (s, oom)</span></span></span><br><span><var>l3</var><span class="hyp-type"><b>: </b><span>label</span></span></span><br><span><var>iom3</var><span class="hyp-type"><b>: </b><span>option message</span></span></span><br><span><var>s3</var><span class="hyp-type"><b>: </b><span>state</span></span></span><br><span><var>oom3</var><span class="hyp-type"><b>: </b><span>option message</span></span></span><br><span><var>Hv23</var><span class="hyp-type"><b>: </b><span>input_valid_transition l3 (f, iom3) (s3, oom3)</span></span></span><br><span><var>IHHt12</var><span class="hyp-type"><b>: </b><span>input_valid_transition l3 
  (f, iom3) (s3, oom3)
‚Üí finite_valid_trace_from_to s s3
    (tl ++
     [{|
        l := l3;
        input := iom3;
        destination := s3;
        output := oom3
      |}])</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">finite_valid_trace_from_to s&#39; s3
  (({|
      l := l0;
      input := iom;
      destination := s;
      output := oom
    |} :: tl) ++
   [{|
      l := l3;
      input := iom3;
      destination := s3;
      output := oom3
    |}])</div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="VLSM-v-chk227" style="display: none" type="checkbox"><label class="alectryon-input" for="VLSM-v-chk227"><span class="nb">rewrite</span> &lt;- app_comm_cons.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>message</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>X</var><span class="hyp-type"><b>: </b><span>VLSM message</span></span></span><br><span><var>TypeX</var><span><span class="hyp-body"><b>:= </b><span>type X</span></span><span class="hyp-type"><b>: </b><span>VLSMType message</span></span></span></span><br><span><var>MachineX</var><span><span class="hyp-body"><b>:= </b><span>machine X</span></span><span class="hyp-type"><b>: </b><span>VLSMMachine (vtype X)</span></span></span></span><br><span><var>s, f</var><span class="hyp-type"><b>: </b><span>state</span></span></span><br><span><var>tl</var><span class="hyp-type"><b>: </b><span>list transition_item</span></span></span><br><span><var>Ht12</var><span class="hyp-type"><b>: </b><span>finite_valid_trace_from_to s f tl</span></span></span><br><span><var>s'</var><span class="hyp-type"><b>: </b><span>state</span></span></span><br><span><var>iom, oom</var><span class="hyp-type"><b>: </b><span>option message</span></span></span><br><span><var>l0</var><span class="hyp-type"><b>: </b><span>label</span></span></span><br><span><var>Ht</var><span class="hyp-type"><b>: </b><span>input_valid_transition l0 (s&#39;, iom) (s, oom)</span></span></span><br><span><var>l3</var><span class="hyp-type"><b>: </b><span>label</span></span></span><br><span><var>iom3</var><span class="hyp-type"><b>: </b><span>option message</span></span></span><br><span><var>s3</var><span class="hyp-type"><b>: </b><span>state</span></span></span><br><span><var>oom3</var><span class="hyp-type"><b>: </b><span>option message</span></span></span><br><span><var>Hv23</var><span class="hyp-type"><b>: </b><span>input_valid_transition l3 (f, iom3) (s3, oom3)</span></span></span><br><span><var>IHHt12</var><span class="hyp-type"><b>: </b><span>input_valid_transition l3 
  (f, iom3) (s3, oom3)
‚Üí finite_valid_trace_from_to s s3
    (tl ++
     [{|
        l := l3;
        input := iom3;
        destination := s3;
        output := oom3
      |}])</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">finite_valid_trace_from_to s&#39; s3
  ({|
     l := l0;
     input := iom;
     destination := s;
     output := oom
   |}
   :: tl ++
      [{|
         l := l3;
         input := iom3;
         destination := s3;
         output := oom3
       |}])</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">        </span><span class="alectryon-sentence"><span class="alectryon-input"><span class="nb">apply</span> finite_valid_trace_from_to_extend; <span class="nb">auto</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Qed</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
</span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="VLSM-v-chk228" style="display: none" type="checkbox"><label class="alectryon-input" for="VLSM-v-chk228"><span class="kn">Lemma</span> <span class="nf">finite_valid_trace_from_to_rev_ind</span>
      (<span class="nv">P</span> : state -&gt; state -&gt; list transition_item -&gt; <span class="kt">Prop</span>)
      (<span class="nv">Hempty</span>: <span class="kr">forall</span> <span class="nv">si</span>
        (<span class="nv">Hsi</span> : valid_state_prop si),
        P si si nil)
      (<span class="nv">Hextend</span> : <span class="kr">forall</span> <span class="nv">si</span> <span class="nv">s</span> <span class="nv">tr</span>
        (<span class="nv">IHtr</span> : P si s tr)
        (<span class="nv">Htr</span> : finite_valid_trace_from_to si s tr)
        <span class="nv">sf</span> <span class="nv">iom</span> <span class="nv">oom</span> <span class="nv">l</span>
        (<span class="nv">Ht</span> : input_valid_transition l (s,iom) (sf,oom)),
        P si sf (tr++[{|l:=l; input:=iom; destination:=sf; output:=oom|}])):
      <span class="kr">forall</span> <span class="nv">si</span> <span class="nv">sf</span> <span class="nv">tr</span>,
        finite_valid_trace_from_to si sf tr -&gt;
        P si sf tr.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>message</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>X</var><span class="hyp-type"><b>: </b><span>VLSM message</span></span></span><br><span><var>TypeX</var><span><span class="hyp-body"><b>:= </b><span>type X</span></span><span class="hyp-type"><b>: </b><span>VLSMType message</span></span></span></span><br><span><var>MachineX</var><span><span class="hyp-body"><b>:= </b><span>machine X</span></span><span class="hyp-type"><b>: </b><span>VLSMMachine (vtype X)</span></span></span></span><br><span><var>P</var><span class="hyp-type"><b>: </b><span>state ‚Üí state ‚Üí list transition_item ‚Üí <span class="kt">Prop</span></span></span></span><br><span><var>Hempty</var><span class="hyp-type"><b>: </b><span><span class="kr">‚àÄ</span> <span class="nv">si</span> : state,
  valid_state_prop si ‚Üí P si si []</span></span></span><br><span><var>Hextend</var><span class="hyp-type"><b>: </b><span><span class="kr">‚àÄ</span> (<span class="nv">si</span> <span class="nv">s</span> : state) (<span class="nv">tr</span> : list transition_item),
  P si s tr
  ‚Üí finite_valid_trace_from_to si s tr
    ‚Üí <span class="kr">‚àÄ</span> (<span class="nv">sf</span> : state) (<span class="nv">iom</span>
                      <span class="nv">oom</span> : 
                      option message) 
        (<span class="nv">l</span> : label),
        input_valid_transition l 
          (s, iom) (sf, oom)
        ‚Üí P si sf
            (tr ++
             [{|
                l := l;
                input := iom;
                destination := sf;
                output := oom
              |}])</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="kr">‚àÄ</span> (<span class="nv">si</span> <span class="nv">sf</span> : state) (<span class="nv">tr</span> : list transition_item),
  finite_valid_trace_from_to si sf tr ‚Üí P si sf tr</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="VLSM-v-chk229" style="display: none" type="checkbox"><label class="alectryon-input" for="VLSM-v-chk229"><span class="kn">Proof</span>.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>message</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>X</var><span class="hyp-type"><b>: </b><span>VLSM message</span></span></span><br><span><var>TypeX</var><span><span class="hyp-body"><b>:= </b><span>type X</span></span><span class="hyp-type"><b>: </b><span>VLSMType message</span></span></span></span><br><span><var>MachineX</var><span><span class="hyp-body"><b>:= </b><span>machine X</span></span><span class="hyp-type"><b>: </b><span>VLSMMachine (vtype X)</span></span></span></span><br><span><var>P</var><span class="hyp-type"><b>: </b><span>state ‚Üí state ‚Üí list transition_item ‚Üí <span class="kt">Prop</span></span></span></span><br><span><var>Hempty</var><span class="hyp-type"><b>: </b><span><span class="kr">‚àÄ</span> <span class="nv">si</span> : state,
  valid_state_prop si ‚Üí P si si []</span></span></span><br><span><var>Hextend</var><span class="hyp-type"><b>: </b><span><span class="kr">‚àÄ</span> (<span class="nv">si</span> <span class="nv">s</span> : state) (<span class="nv">tr</span> : list transition_item),
  P si s tr
  ‚Üí finite_valid_trace_from_to si s tr
    ‚Üí <span class="kr">‚àÄ</span> (<span class="nv">sf</span> : state) (<span class="nv">iom</span>
                      <span class="nv">oom</span> : 
                      option message) 
        (<span class="nv">l</span> : label),
        input_valid_transition l 
          (s, iom) (sf, oom)
        ‚Üí P si sf
            (tr ++
             [{|
                l := l;
                input := iom;
                destination := sf;
                output := oom
              |}])</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="kr">‚àÄ</span> (<span class="nv">si</span> <span class="nv">sf</span> : state) (<span class="nv">tr</span> : list transition_item),
  finite_valid_trace_from_to si sf tr ‚Üí P si sf tr</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">      </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="VLSM-v-chk22a" style="display: none" type="checkbox"><label class="alectryon-input" for="VLSM-v-chk22a"><span class="nb">intros</span> si sf tr Htr.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>message</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>X</var><span class="hyp-type"><b>: </b><span>VLSM message</span></span></span><br><span><var>TypeX</var><span><span class="hyp-body"><b>:= </b><span>type X</span></span><span class="hyp-type"><b>: </b><span>VLSMType message</span></span></span></span><br><span><var>MachineX</var><span><span class="hyp-body"><b>:= </b><span>machine X</span></span><span class="hyp-type"><b>: </b><span>VLSMMachine (vtype X)</span></span></span></span><br><span><var>P</var><span class="hyp-type"><b>: </b><span>state ‚Üí state ‚Üí list transition_item ‚Üí <span class="kt">Prop</span></span></span></span><br><span><var>Hempty</var><span class="hyp-type"><b>: </b><span><span class="kr">‚àÄ</span> <span class="nv">si</span> : state,
  valid_state_prop si ‚Üí P si si []</span></span></span><br><span><var>Hextend</var><span class="hyp-type"><b>: </b><span><span class="kr">‚àÄ</span> (<span class="nv">si</span> <span class="nv">s</span> : state) (<span class="nv">tr</span> : list transition_item),
  P si s tr
  ‚Üí finite_valid_trace_from_to si s tr
    ‚Üí <span class="kr">‚àÄ</span> (<span class="nv">sf</span> : state) (<span class="nv">iom</span>
                      <span class="nv">oom</span> : 
                      option message) 
        (<span class="nv">l</span> : label),
        input_valid_transition l 
          (s, iom) (sf, oom)
        ‚Üí P si sf
            (tr ++
             [{|
                l := l;
                input := iom;
                destination := sf;
                output := oom
              |}])</span></span></span><br><span><var>si, sf</var><span class="hyp-type"><b>: </b><span>state</span></span></span><br><span><var>tr</var><span class="hyp-type"><b>: </b><span>list transition_item</span></span></span><br><span><var>Htr</var><span class="hyp-type"><b>: </b><span>finite_valid_trace_from_to si sf tr</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">P si sf tr</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">      </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="VLSM-v-chk22b" style="display: none" type="checkbox"><label class="alectryon-input" for="VLSM-v-chk22b"><span class="nb">revert</span> sf Htr.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>message</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>X</var><span class="hyp-type"><b>: </b><span>VLSM message</span></span></span><br><span><var>TypeX</var><span><span class="hyp-body"><b>:= </b><span>type X</span></span><span class="hyp-type"><b>: </b><span>VLSMType message</span></span></span></span><br><span><var>MachineX</var><span><span class="hyp-body"><b>:= </b><span>machine X</span></span><span class="hyp-type"><b>: </b><span>VLSMMachine (vtype X)</span></span></span></span><br><span><var>P</var><span class="hyp-type"><b>: </b><span>state ‚Üí state ‚Üí list transition_item ‚Üí <span class="kt">Prop</span></span></span></span><br><span><var>Hempty</var><span class="hyp-type"><b>: </b><span><span class="kr">‚àÄ</span> <span class="nv">si</span> : state,
  valid_state_prop si ‚Üí P si si []</span></span></span><br><span><var>Hextend</var><span class="hyp-type"><b>: </b><span><span class="kr">‚àÄ</span> (<span class="nv">si</span> <span class="nv">s</span> : state) (<span class="nv">tr</span> : list transition_item),
  P si s tr
  ‚Üí finite_valid_trace_from_to si s tr
    ‚Üí <span class="kr">‚àÄ</span> (<span class="nv">sf</span> : state) (<span class="nv">iom</span>
                      <span class="nv">oom</span> : 
                      option message) 
        (<span class="nv">l</span> : label),
        input_valid_transition l 
          (s, iom) (sf, oom)
        ‚Üí P si sf
            (tr ++
             [{|
                l := l;
                input := iom;
                destination := sf;
                output := oom
              |}])</span></span></span><br><span><var>si</var><span class="hyp-type"><b>: </b><span>state</span></span></span><br><span><var>tr</var><span class="hyp-type"><b>: </b><span>list transition_item</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="kr">‚àÄ</span> <span class="nv">sf</span> : state,
  finite_valid_trace_from_to si sf tr ‚Üí P si sf tr</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">      </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="VLSM-v-chk22c" style="display: none" type="checkbox"><label class="alectryon-input" for="VLSM-v-chk22c"><span class="nb">induction</span> tr <span class="nb">using</span> rev_ind;
      <span class="nb">intros</span> sf Htr.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>message</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>X</var><span class="hyp-type"><b>: </b><span>VLSM message</span></span></span><br><span><var>TypeX</var><span><span class="hyp-body"><b>:= </b><span>type X</span></span><span class="hyp-type"><b>: </b><span>VLSMType message</span></span></span></span><br><span><var>MachineX</var><span><span class="hyp-body"><b>:= </b><span>machine X</span></span><span class="hyp-type"><b>: </b><span>VLSMMachine (vtype X)</span></span></span></span><br><span><var>P</var><span class="hyp-type"><b>: </b><span>state ‚Üí state ‚Üí list transition_item ‚Üí <span class="kt">Prop</span></span></span></span><br><span><var>Hempty</var><span class="hyp-type"><b>: </b><span><span class="kr">‚àÄ</span> <span class="nv">si</span> : state,
  valid_state_prop si ‚Üí P si si []</span></span></span><br><span><var>Hextend</var><span class="hyp-type"><b>: </b><span><span class="kr">‚àÄ</span> (<span class="nv">si</span> <span class="nv">s</span> : state) (<span class="nv">tr</span> : list transition_item),
  P si s tr
  ‚Üí finite_valid_trace_from_to si s tr
    ‚Üí <span class="kr">‚àÄ</span> (<span class="nv">sf</span> : state) (<span class="nv">iom</span>
                      <span class="nv">oom</span> : 
                      option message) 
        (<span class="nv">l</span> : label),
        input_valid_transition l 
          (s, iom) (sf, oom)
        ‚Üí P si sf
            (tr ++
             [{|
                l := l;
                input := iom;
                destination := sf;
                output := oom
              |}])</span></span></span><br><span><var>si, sf</var><span class="hyp-type"><b>: </b><span>state</span></span></span><br><span><var>Htr</var><span class="hyp-type"><b>: </b><span>finite_valid_trace_from_to si sf []</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">P si sf []</div></blockquote><div class="alectryon-extra-goals"><input class="alectryon-extra-goal-toggle" id="VLSM-v-chk22d" style="display: none" type="checkbox"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>message</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>X</var><span class="hyp-type"><b>: </b><span>VLSM message</span></span></span><br><span><var>TypeX</var><span><span class="hyp-body"><b>:= </b><span>type X</span></span><span class="hyp-type"><b>: </b><span>VLSMType message</span></span></span></span><br><span><var>MachineX</var><span><span class="hyp-body"><b>:= </b><span>machine X</span></span><span class="hyp-type"><b>: </b><span>VLSMMachine (vtype X)</span></span></span></span><br><span><var>P</var><span class="hyp-type"><b>: </b><span>state ‚Üí state ‚Üí list transition_item ‚Üí <span class="kt">Prop</span></span></span></span><br><span><var>Hempty</var><span class="hyp-type"><b>: </b><span><span class="kr">‚àÄ</span> <span class="nv">si</span> : state,
  valid_state_prop si ‚Üí P si si []</span></span></span><br><span><var>Hextend</var><span class="hyp-type"><b>: </b><span><span class="kr">‚àÄ</span> (<span class="nv">si</span> <span class="nv">s</span> : state) (<span class="nv">tr</span> : list transition_item),
  P si s tr
  ‚Üí finite_valid_trace_from_to si s tr
    ‚Üí <span class="kr">‚àÄ</span> (<span class="nv">sf</span> : state) (<span class="nv">iom</span>
                      <span class="nv">oom</span> : 
                      option message) 
        (<span class="nv">l</span> : label),
        input_valid_transition l 
          (s, iom) (sf, oom)
        ‚Üí P si sf
            (tr ++
             [{|
                l := l;
                input := iom;
                destination := sf;
                output := oom
              |}])</span></span></span><br><span><var>si</var><span class="hyp-type"><b>: </b><span>state</span></span></span><br><span><var>x</var><span class="hyp-type"><b>: </b><span>transition_item</span></span></span><br><span><var>tr</var><span class="hyp-type"><b>: </b><span>list transition_item</span></span></span><br><span><var>IHtr</var><span class="hyp-type"><b>: </b><span><span class="kr">‚àÄ</span> <span class="nv">sf</span> : state,
  finite_valid_trace_from_to si sf tr
  ‚Üí P si sf tr</span></span></span><br><span><var>sf</var><span class="hyp-type"><b>: </b><span>state</span></span></span><br><span><var>Htr</var><span class="hyp-type"><b>: </b><span>finite_valid_trace_from_to si sf (tr ++ [x])</span></span></span><br></div><label class="goal-separator" for="VLSM-v-chk22d"><hr></label><div class="goal-conclusion">P si sf (tr ++ [x])</div></blockquote></div></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">      </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="VLSM-v-chk22e" style="display: none" type="checkbox"><label class="alectryon-input" for="VLSM-v-chk22e">-</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>message</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>X</var><span class="hyp-type"><b>: </b><span>VLSM message</span></span></span><br><span><var>TypeX</var><span><span class="hyp-body"><b>:= </b><span>type X</span></span><span class="hyp-type"><b>: </b><span>VLSMType message</span></span></span></span><br><span><var>MachineX</var><span><span class="hyp-body"><b>:= </b><span>machine X</span></span><span class="hyp-type"><b>: </b><span>VLSMMachine (vtype X)</span></span></span></span><br><span><var>P</var><span class="hyp-type"><b>: </b><span>state ‚Üí state ‚Üí list transition_item ‚Üí <span class="kt">Prop</span></span></span></span><br><span><var>Hempty</var><span class="hyp-type"><b>: </b><span><span class="kr">‚àÄ</span> <span class="nv">si</span> : state,
  valid_state_prop si ‚Üí P si si []</span></span></span><br><span><var>Hextend</var><span class="hyp-type"><b>: </b><span><span class="kr">‚àÄ</span> (<span class="nv">si</span> <span class="nv">s</span> : state) (<span class="nv">tr</span> : list transition_item),
  P si s tr
  ‚Üí finite_valid_trace_from_to si s tr
    ‚Üí <span class="kr">‚àÄ</span> (<span class="nv">sf</span> : state) (<span class="nv">iom</span>
                      <span class="nv">oom</span> : 
                      option message) 
        (<span class="nv">l</span> : label),
        input_valid_transition l 
          (s, iom) (sf, oom)
        ‚Üí P si sf
            (tr ++
             [{|
                l := l;
                input := iom;
                destination := sf;
                output := oom
              |}])</span></span></span><br><span><var>si, sf</var><span class="hyp-type"><b>: </b><span>state</span></span></span><br><span><var>Htr</var><span class="hyp-type"><b>: </b><span>finite_valid_trace_from_to si sf []</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">P si sf []</div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="VLSM-v-chk22f" style="display: none" type="checkbox"><label class="alectryon-input" for="VLSM-v-chk22f"><span class="nb">inversion</span> Htr;<span class="nb">subst</span>.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>message</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>X</var><span class="hyp-type"><b>: </b><span>VLSM message</span></span></span><br><span><var>TypeX</var><span><span class="hyp-body"><b>:= </b><span>type X</span></span><span class="hyp-type"><b>: </b><span>VLSMType message</span></span></span></span><br><span><var>MachineX</var><span><span class="hyp-body"><b>:= </b><span>machine X</span></span><span class="hyp-type"><b>: </b><span>VLSMMachine (vtype X)</span></span></span></span><br><span><var>P</var><span class="hyp-type"><b>: </b><span>state ‚Üí state ‚Üí list transition_item ‚Üí <span class="kt">Prop</span></span></span></span><br><span><var>Hempty</var><span class="hyp-type"><b>: </b><span><span class="kr">‚àÄ</span> <span class="nv">si</span> : state,
  valid_state_prop si ‚Üí P si si []</span></span></span><br><span><var>Hextend</var><span class="hyp-type"><b>: </b><span><span class="kr">‚àÄ</span> (<span class="nv">si</span> <span class="nv">s</span> : state) (<span class="nv">tr</span> : list transition_item),
  P si s tr
  ‚Üí finite_valid_trace_from_to si s tr
    ‚Üí <span class="kr">‚àÄ</span> (<span class="nv">sf</span> : state) (<span class="nv">iom</span>
                      <span class="nv">oom</span> : 
                      option message) 
        (<span class="nv">l</span> : label),
        input_valid_transition l 
          (s, iom) (sf, oom)
        ‚Üí P si sf
            (tr ++
             [{|
                l := l;
                input := iom;
                destination := sf;
                output := oom
              |}])</span></span></span><br><span><var>sf</var><span class="hyp-type"><b>: </b><span>state</span></span></span><br><span><var>Htr</var><span class="hyp-type"><b>: </b><span>finite_valid_trace_from_to sf sf []</span></span></span><br><span><var>Hs</var><span class="hyp-type"><b>: </b><span>valid_state_prop sf</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">P sf sf []</div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="nb">apply</span> Hempty;<span class="bp">assumption</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">      </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="VLSM-v-chk230" style="display: none" type="checkbox"><label class="alectryon-input" for="VLSM-v-chk230">-</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>message</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>X</var><span class="hyp-type"><b>: </b><span>VLSM message</span></span></span><br><span><var>TypeX</var><span><span class="hyp-body"><b>:= </b><span>type X</span></span><span class="hyp-type"><b>: </b><span>VLSMType message</span></span></span></span><br><span><var>MachineX</var><span><span class="hyp-body"><b>:= </b><span>machine X</span></span><span class="hyp-type"><b>: </b><span>VLSMMachine (vtype X)</span></span></span></span><br><span><var>P</var><span class="hyp-type"><b>: </b><span>state ‚Üí state ‚Üí list transition_item ‚Üí <span class="kt">Prop</span></span></span></span><br><span><var>Hempty</var><span class="hyp-type"><b>: </b><span><span class="kr">‚àÄ</span> <span class="nv">si</span> : state,
  valid_state_prop si ‚Üí P si si []</span></span></span><br><span><var>Hextend</var><span class="hyp-type"><b>: </b><span><span class="kr">‚àÄ</span> (<span class="nv">si</span> <span class="nv">s</span> : state) (<span class="nv">tr</span> : list transition_item),
  P si s tr
  ‚Üí finite_valid_trace_from_to si s tr
    ‚Üí <span class="kr">‚àÄ</span> (<span class="nv">sf</span> : state) (<span class="nv">iom</span>
                      <span class="nv">oom</span> : 
                      option message) 
        (<span class="nv">l</span> : label),
        input_valid_transition l 
          (s, iom) (sf, oom)
        ‚Üí P si sf
            (tr ++
             [{|
                l := l;
                input := iom;
                destination := sf;
                output := oom
              |}])</span></span></span><br><span><var>si</var><span class="hyp-type"><b>: </b><span>state</span></span></span><br><span><var>x</var><span class="hyp-type"><b>: </b><span>transition_item</span></span></span><br><span><var>tr</var><span class="hyp-type"><b>: </b><span>list transition_item</span></span></span><br><span><var>IHtr</var><span class="hyp-type"><b>: </b><span><span class="kr">‚àÄ</span> <span class="nv">sf</span> : state,
  finite_valid_trace_from_to si sf tr
  ‚Üí P si sf tr</span></span></span><br><span><var>sf</var><span class="hyp-type"><b>: </b><span>state</span></span></span><br><span><var>Htr</var><span class="hyp-type"><b>: </b><span>finite_valid_trace_from_to si sf (tr ++ [x])</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">P si sf (tr ++ [x])</div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="VLSM-v-chk231" style="display: none" type="checkbox"><label class="alectryon-input" for="VLSM-v-chk231"><span class="nb">apply</span> finite_valid_trace_from_to_app_split <span class="kr">in</span> Htr.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>message</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>X</var><span class="hyp-type"><b>: </b><span>VLSM message</span></span></span><br><span><var>TypeX</var><span><span class="hyp-body"><b>:= </b><span>type X</span></span><span class="hyp-type"><b>: </b><span>VLSMType message</span></span></span></span><br><span><var>MachineX</var><span><span class="hyp-body"><b>:= </b><span>machine X</span></span><span class="hyp-type"><b>: </b><span>VLSMMachine (vtype X)</span></span></span></span><br><span><var>P</var><span class="hyp-type"><b>: </b><span>state ‚Üí state ‚Üí list transition_item ‚Üí <span class="kt">Prop</span></span></span></span><br><span><var>Hempty</var><span class="hyp-type"><b>: </b><span><span class="kr">‚àÄ</span> <span class="nv">si</span> : state,
  valid_state_prop si ‚Üí P si si []</span></span></span><br><span><var>Hextend</var><span class="hyp-type"><b>: </b><span><span class="kr">‚àÄ</span> (<span class="nv">si</span> <span class="nv">s</span> : state) (<span class="nv">tr</span> : list transition_item),
  P si s tr
  ‚Üí finite_valid_trace_from_to si s tr
    ‚Üí <span class="kr">‚àÄ</span> (<span class="nv">sf</span> : state) (<span class="nv">iom</span>
                      <span class="nv">oom</span> : 
                      option message) 
        (<span class="nv">l</span> : label),
        input_valid_transition l 
          (s, iom) (sf, oom)
        ‚Üí P si sf
            (tr ++
             [{|
                l := l;
                input := iom;
                destination := sf;
                output := oom
              |}])</span></span></span><br><span><var>si</var><span class="hyp-type"><b>: </b><span>state</span></span></span><br><span><var>x</var><span class="hyp-type"><b>: </b><span>transition_item</span></span></span><br><span><var>tr</var><span class="hyp-type"><b>: </b><span>list transition_item</span></span></span><br><span><var>IHtr</var><span class="hyp-type"><b>: </b><span><span class="kr">‚àÄ</span> <span class="nv">sf</span> : state,
  finite_valid_trace_from_to si sf tr
  ‚Üí P si sf tr</span></span></span><br><span><var>sf</var><span class="hyp-type"><b>: </b><span>state</span></span></span><br><span><var>Htr</var><span class="hyp-type"><b>: </b><span>finite_valid_trace_from_to si
  (finite_trace_last si tr) tr
‚àß finite_valid_trace_from_to
    (finite_trace_last si tr) sf [x]</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">P si sf (tr ++ [x])</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">        </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="VLSM-v-chk232" style="display: none" type="checkbox"><label class="alectryon-input" for="VLSM-v-chk232"><span class="nb">destruct</span> Htr <span class="kr">as</span> [Htr Hstep].</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>message</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>X</var><span class="hyp-type"><b>: </b><span>VLSM message</span></span></span><br><span><var>TypeX</var><span><span class="hyp-body"><b>:= </b><span>type X</span></span><span class="hyp-type"><b>: </b><span>VLSMType message</span></span></span></span><br><span><var>MachineX</var><span><span class="hyp-body"><b>:= </b><span>machine X</span></span><span class="hyp-type"><b>: </b><span>VLSMMachine (vtype X)</span></span></span></span><br><span><var>P</var><span class="hyp-type"><b>: </b><span>state ‚Üí state ‚Üí list transition_item ‚Üí <span class="kt">Prop</span></span></span></span><br><span><var>Hempty</var><span class="hyp-type"><b>: </b><span><span class="kr">‚àÄ</span> <span class="nv">si</span> : state,
  valid_state_prop si ‚Üí P si si []</span></span></span><br><span><var>Hextend</var><span class="hyp-type"><b>: </b><span><span class="kr">‚àÄ</span> (<span class="nv">si</span> <span class="nv">s</span> : state) (<span class="nv">tr</span> : list transition_item),
  P si s tr
  ‚Üí finite_valid_trace_from_to si s tr
    ‚Üí <span class="kr">‚àÄ</span> (<span class="nv">sf</span> : state) (<span class="nv">iom</span>
                      <span class="nv">oom</span> : 
                      option message) 
        (<span class="nv">l</span> : label),
        input_valid_transition l 
          (s, iom) (sf, oom)
        ‚Üí P si sf
            (tr ++
             [{|
                l := l;
                input := iom;
                destination := sf;
                output := oom
              |}])</span></span></span><br><span><var>si</var><span class="hyp-type"><b>: </b><span>state</span></span></span><br><span><var>x</var><span class="hyp-type"><b>: </b><span>transition_item</span></span></span><br><span><var>tr</var><span class="hyp-type"><b>: </b><span>list transition_item</span></span></span><br><span><var>IHtr</var><span class="hyp-type"><b>: </b><span><span class="kr">‚àÄ</span> <span class="nv">sf</span> : state,
  finite_valid_trace_from_to si sf tr
  ‚Üí P si sf tr</span></span></span><br><span><var>sf</var><span class="hyp-type"><b>: </b><span>state</span></span></span><br><span><var>Htr</var><span class="hyp-type"><b>: </b><span>finite_valid_trace_from_to si
  (finite_trace_last si tr) tr</span></span></span><br><span><var>Hstep</var><span class="hyp-type"><b>: </b><span>finite_valid_trace_from_to
  (finite_trace_last si tr) sf [x]</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">P si sf (tr ++ [x])</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">        </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="VLSM-v-chk233" style="display: none" type="checkbox"><label class="alectryon-input" for="VLSM-v-chk233"><span class="nb">inversion</span> Hstep;<span class="nb">subst</span>.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>message</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>X</var><span class="hyp-type"><b>: </b><span>VLSM message</span></span></span><br><span><var>TypeX</var><span><span class="hyp-body"><b>:= </b><span>type X</span></span><span class="hyp-type"><b>: </b><span>VLSMType message</span></span></span></span><br><span><var>MachineX</var><span><span class="hyp-body"><b>:= </b><span>machine X</span></span><span class="hyp-type"><b>: </b><span>VLSMMachine (vtype X)</span></span></span></span><br><span><var>P</var><span class="hyp-type"><b>: </b><span>state ‚Üí state ‚Üí list transition_item ‚Üí <span class="kt">Prop</span></span></span></span><br><span><var>Hempty</var><span class="hyp-type"><b>: </b><span><span class="kr">‚àÄ</span> <span class="nv">si</span> : state,
  valid_state_prop si ‚Üí P si si []</span></span></span><br><span><var>Hextend</var><span class="hyp-type"><b>: </b><span><span class="kr">‚àÄ</span> (<span class="nv">si</span> <span class="nv">s</span> : state) (<span class="nv">tr</span> : list transition_item),
  P si s tr
  ‚Üí finite_valid_trace_from_to si s tr
    ‚Üí <span class="kr">‚àÄ</span> (<span class="nv">sf</span> : state) (<span class="nv">iom</span>
                      <span class="nv">oom</span> : 
                      option message) 
        (<span class="nv">l</span> : label),
        input_valid_transition l 
          (s, iom) (sf, oom)
        ‚Üí P si sf
            (tr ++
             [{|
                l := l;
                input := iom;
                destination := sf;
                output := oom
              |}])</span></span></span><br><span><var>si</var><span class="hyp-type"><b>: </b><span>state</span></span></span><br><span><var>tr</var><span class="hyp-type"><b>: </b><span>list transition_item</span></span></span><br><span><var>IHtr</var><span class="hyp-type"><b>: </b><span><span class="kr">‚àÄ</span> <span class="nv">sf</span> : state,
  finite_valid_trace_from_to si sf tr
  ‚Üí P si sf tr</span></span></span><br><span><var>sf</var><span class="hyp-type"><b>: </b><span>state</span></span></span><br><span><var>Htr</var><span class="hyp-type"><b>: </b><span>finite_valid_trace_from_to si
  (finite_trace_last si tr) tr</span></span></span><br><span><var>s</var><span class="hyp-type"><b>: </b><span>state</span></span></span><br><span><var>iom, oom</var><span class="hyp-type"><b>: </b><span>option message</span></span></span><br><span><var>l0</var><span class="hyp-type"><b>: </b><span>label</span></span></span><br><span><var>Hstep</var><span class="hyp-type"><b>: </b><span>finite_valid_trace_from_to
  (finite_trace_last si tr) sf
  [{|
     l := l0;
     input := iom;
     destination := s;
     output := oom
   |}]</span></span></span><br><span><var>Htl</var><span class="hyp-type"><b>: </b><span>finite_valid_trace_from_to s sf []</span></span></span><br><span><var>Ht</var><span class="hyp-type"><b>: </b><span>input_valid_transition l0
  (finite_trace_last si tr, iom) 
  (s, oom)</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">P si sf
  (tr ++
   [{|
      l := l0;
      input := iom;
      destination := s;
      output := oom
    |}])</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">        </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="VLSM-v-chk234" style="display: none" type="checkbox"><label class="alectryon-input" for="VLSM-v-chk234"><span class="nb">inversion</span> Htl;<span class="nb">subst</span>.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>message</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>X</var><span class="hyp-type"><b>: </b><span>VLSM message</span></span></span><br><span><var>TypeX</var><span><span class="hyp-body"><b>:= </b><span>type X</span></span><span class="hyp-type"><b>: </b><span>VLSMType message</span></span></span></span><br><span><var>MachineX</var><span><span class="hyp-body"><b>:= </b><span>machine X</span></span><span class="hyp-type"><b>: </b><span>VLSMMachine (vtype X)</span></span></span></span><br><span><var>P</var><span class="hyp-type"><b>: </b><span>state ‚Üí state ‚Üí list transition_item ‚Üí <span class="kt">Prop</span></span></span></span><br><span><var>Hempty</var><span class="hyp-type"><b>: </b><span><span class="kr">‚àÄ</span> <span class="nv">si</span> : state,
  valid_state_prop si ‚Üí P si si []</span></span></span><br><span><var>Hextend</var><span class="hyp-type"><b>: </b><span><span class="kr">‚àÄ</span> (<span class="nv">si</span> <span class="nv">s</span> : state) (<span class="nv">tr</span> : list transition_item),
  P si s tr
  ‚Üí finite_valid_trace_from_to si s tr
    ‚Üí <span class="kr">‚àÄ</span> (<span class="nv">sf</span> : state) (<span class="nv">iom</span>
                      <span class="nv">oom</span> : 
                      option message) 
        (<span class="nv">l</span> : label),
        input_valid_transition l 
          (s, iom) (sf, oom)
        ‚Üí P si sf
            (tr ++
             [{|
                l := l;
                input := iom;
                destination := sf;
                output := oom
              |}])</span></span></span><br><span><var>si</var><span class="hyp-type"><b>: </b><span>state</span></span></span><br><span><var>tr</var><span class="hyp-type"><b>: </b><span>list transition_item</span></span></span><br><span><var>IHtr</var><span class="hyp-type"><b>: </b><span><span class="kr">‚àÄ</span> <span class="nv">sf</span> : state,
  finite_valid_trace_from_to si sf tr
  ‚Üí P si sf tr</span></span></span><br><span><var>sf</var><span class="hyp-type"><b>: </b><span>state</span></span></span><br><span><var>Htr</var><span class="hyp-type"><b>: </b><span>finite_valid_trace_from_to si
  (finite_trace_last si tr) tr</span></span></span><br><span><var>iom, oom</var><span class="hyp-type"><b>: </b><span>option message</span></span></span><br><span><var>l0</var><span class="hyp-type"><b>: </b><span>label</span></span></span><br><span><var>Ht</var><span class="hyp-type"><b>: </b><span>input_valid_transition l0
  (finite_trace_last si tr, iom) 
  (sf, oom)</span></span></span><br><span><var>Htl</var><span class="hyp-type"><b>: </b><span>finite_valid_trace_from_to sf sf []</span></span></span><br><span><var>Hstep</var><span class="hyp-type"><b>: </b><span>finite_valid_trace_from_to
  (finite_trace_last si tr) sf
  [{|
     l := l0;
     input := iom;
     destination := sf;
     output := oom
   |}]</span></span></span><br><span><var>Hs</var><span class="hyp-type"><b>: </b><span>valid_state_prop sf</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">P si sf
  (tr ++
   [{|
      l := l0;
      input := iom;
      destination := sf;
      output := oom
    |}])</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">        </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="VLSM-v-chk235" style="display: none" type="checkbox"><label class="alectryon-input" for="VLSM-v-chk235"><span class="nb">revert</span> Ht.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>message</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>X</var><span class="hyp-type"><b>: </b><span>VLSM message</span></span></span><br><span><var>TypeX</var><span><span class="hyp-body"><b>:= </b><span>type X</span></span><span class="hyp-type"><b>: </b><span>VLSMType message</span></span></span></span><br><span><var>MachineX</var><span><span class="hyp-body"><b>:= </b><span>machine X</span></span><span class="hyp-type"><b>: </b><span>VLSMMachine (vtype X)</span></span></span></span><br><span><var>P</var><span class="hyp-type"><b>: </b><span>state ‚Üí state ‚Üí list transition_item ‚Üí <span class="kt">Prop</span></span></span></span><br><span><var>Hempty</var><span class="hyp-type"><b>: </b><span><span class="kr">‚àÄ</span> <span class="nv">si</span> : state,
  valid_state_prop si ‚Üí P si si []</span></span></span><br><span><var>Hextend</var><span class="hyp-type"><b>: </b><span><span class="kr">‚àÄ</span> (<span class="nv">si</span> <span class="nv">s</span> : state) (<span class="nv">tr</span> : list transition_item),
  P si s tr
  ‚Üí finite_valid_trace_from_to si s tr
    ‚Üí <span class="kr">‚àÄ</span> (<span class="nv">sf</span> : state) (<span class="nv">iom</span>
                      <span class="nv">oom</span> : 
                      option message) 
        (<span class="nv">l</span> : label),
        input_valid_transition l 
          (s, iom) (sf, oom)
        ‚Üí P si sf
            (tr ++
             [{|
                l := l;
                input := iom;
                destination := sf;
                output := oom
              |}])</span></span></span><br><span><var>si</var><span class="hyp-type"><b>: </b><span>state</span></span></span><br><span><var>tr</var><span class="hyp-type"><b>: </b><span>list transition_item</span></span></span><br><span><var>IHtr</var><span class="hyp-type"><b>: </b><span><span class="kr">‚àÄ</span> <span class="nv">sf</span> : state,
  finite_valid_trace_from_to si sf tr
  ‚Üí P si sf tr</span></span></span><br><span><var>sf</var><span class="hyp-type"><b>: </b><span>state</span></span></span><br><span><var>Htr</var><span class="hyp-type"><b>: </b><span>finite_valid_trace_from_to si
  (finite_trace_last si tr) tr</span></span></span><br><span><var>iom, oom</var><span class="hyp-type"><b>: </b><span>option message</span></span></span><br><span><var>l0</var><span class="hyp-type"><b>: </b><span>label</span></span></span><br><span><var>Htl</var><span class="hyp-type"><b>: </b><span>finite_valid_trace_from_to sf sf []</span></span></span><br><span><var>Hstep</var><span class="hyp-type"><b>: </b><span>finite_valid_trace_from_to
  (finite_trace_last si tr) sf
  [{|
     l := l0;
     input := iom;
     destination := sf;
     output := oom
   |}]</span></span></span><br><span><var>Hs</var><span class="hyp-type"><b>: </b><span>valid_state_prop sf</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">input_valid_transition l0
  (finite_trace_last si tr, iom) (sf, oom)
‚Üí P si sf
    (tr ++
     [{|
        l := l0;
        input := iom;
        destination := sf;
        output := oom
      |}])</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">        </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="VLSM-v-chk236" style="display: none" type="checkbox"><label class="alectryon-input" for="VLSM-v-chk236"><span class="nb">apply</span> Hextend; [|<span class="bp">assumption</span>].</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>message</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>X</var><span class="hyp-type"><b>: </b><span>VLSM message</span></span></span><br><span><var>TypeX</var><span><span class="hyp-body"><b>:= </b><span>type X</span></span><span class="hyp-type"><b>: </b><span>VLSMType message</span></span></span></span><br><span><var>MachineX</var><span><span class="hyp-body"><b>:= </b><span>machine X</span></span><span class="hyp-type"><b>: </b><span>VLSMMachine (vtype X)</span></span></span></span><br><span><var>P</var><span class="hyp-type"><b>: </b><span>state ‚Üí state ‚Üí list transition_item ‚Üí <span class="kt">Prop</span></span></span></span><br><span><var>Hempty</var><span class="hyp-type"><b>: </b><span><span class="kr">‚àÄ</span> <span class="nv">si</span> : state,
  valid_state_prop si ‚Üí P si si []</span></span></span><br><span><var>Hextend</var><span class="hyp-type"><b>: </b><span><span class="kr">‚àÄ</span> (<span class="nv">si</span> <span class="nv">s</span> : state) (<span class="nv">tr</span> : list transition_item),
  P si s tr
  ‚Üí finite_valid_trace_from_to si s tr
    ‚Üí <span class="kr">‚àÄ</span> (<span class="nv">sf</span> : state) (<span class="nv">iom</span>
                      <span class="nv">oom</span> : 
                      option message) 
        (<span class="nv">l</span> : label),
        input_valid_transition l 
          (s, iom) (sf, oom)
        ‚Üí P si sf
            (tr ++
             [{|
                l := l;
                input := iom;
                destination := sf;
                output := oom
              |}])</span></span></span><br><span><var>si</var><span class="hyp-type"><b>: </b><span>state</span></span></span><br><span><var>tr</var><span class="hyp-type"><b>: </b><span>list transition_item</span></span></span><br><span><var>IHtr</var><span class="hyp-type"><b>: </b><span><span class="kr">‚àÄ</span> <span class="nv">sf</span> : state,
  finite_valid_trace_from_to si sf tr
  ‚Üí P si sf tr</span></span></span><br><span><var>sf</var><span class="hyp-type"><b>: </b><span>state</span></span></span><br><span><var>Htr</var><span class="hyp-type"><b>: </b><span>finite_valid_trace_from_to si
  (finite_trace_last si tr) tr</span></span></span><br><span><var>iom, oom</var><span class="hyp-type"><b>: </b><span>option message</span></span></span><br><span><var>l0</var><span class="hyp-type"><b>: </b><span>label</span></span></span><br><span><var>Htl</var><span class="hyp-type"><b>: </b><span>finite_valid_trace_from_to sf sf []</span></span></span><br><span><var>Hstep</var><span class="hyp-type"><b>: </b><span>finite_valid_trace_from_to
  (finite_trace_last si tr) sf
  [{|
     l := l0;
     input := iom;
     destination := sf;
     output := oom
   |}]</span></span></span><br><span><var>Hs</var><span class="hyp-type"><b>: </b><span>valid_state_prop sf</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">P si (finite_trace_last si tr) tr</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">        </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="VLSM-v-chk237" style="display: none" type="checkbox"><label class="alectryon-input" for="VLSM-v-chk237"><span class="nb">apply</span> IHtr.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>message</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>X</var><span class="hyp-type"><b>: </b><span>VLSM message</span></span></span><br><span><var>TypeX</var><span><span class="hyp-body"><b>:= </b><span>type X</span></span><span class="hyp-type"><b>: </b><span>VLSMType message</span></span></span></span><br><span><var>MachineX</var><span><span class="hyp-body"><b>:= </b><span>machine X</span></span><span class="hyp-type"><b>: </b><span>VLSMMachine (vtype X)</span></span></span></span><br><span><var>P</var><span class="hyp-type"><b>: </b><span>state ‚Üí state ‚Üí list transition_item ‚Üí <span class="kt">Prop</span></span></span></span><br><span><var>Hempty</var><span class="hyp-type"><b>: </b><span><span class="kr">‚àÄ</span> <span class="nv">si</span> : state,
  valid_state_prop si ‚Üí P si si []</span></span></span><br><span><var>Hextend</var><span class="hyp-type"><b>: </b><span><span class="kr">‚àÄ</span> (<span class="nv">si</span> <span class="nv">s</span> : state) (<span class="nv">tr</span> : list transition_item),
  P si s tr
  ‚Üí finite_valid_trace_from_to si s tr
    ‚Üí <span class="kr">‚àÄ</span> (<span class="nv">sf</span> : state) (<span class="nv">iom</span>
                      <span class="nv">oom</span> : 
                      option message) 
        (<span class="nv">l</span> : label),
        input_valid_transition l 
          (s, iom) (sf, oom)
        ‚Üí P si sf
            (tr ++
             [{|
                l := l;
                input := iom;
                destination := sf;
                output := oom
              |}])</span></span></span><br><span><var>si</var><span class="hyp-type"><b>: </b><span>state</span></span></span><br><span><var>tr</var><span class="hyp-type"><b>: </b><span>list transition_item</span></span></span><br><span><var>IHtr</var><span class="hyp-type"><b>: </b><span><span class="kr">‚àÄ</span> <span class="nv">sf</span> : state,
  finite_valid_trace_from_to si sf tr
  ‚Üí P si sf tr</span></span></span><br><span><var>sf</var><span class="hyp-type"><b>: </b><span>state</span></span></span><br><span><var>Htr</var><span class="hyp-type"><b>: </b><span>finite_valid_trace_from_to si
  (finite_trace_last si tr) tr</span></span></span><br><span><var>iom, oom</var><span class="hyp-type"><b>: </b><span>option message</span></span></span><br><span><var>l0</var><span class="hyp-type"><b>: </b><span>label</span></span></span><br><span><var>Htl</var><span class="hyp-type"><b>: </b><span>finite_valid_trace_from_to sf sf []</span></span></span><br><span><var>Hstep</var><span class="hyp-type"><b>: </b><span>finite_valid_trace_from_to
  (finite_trace_last si tr) sf
  [{|
     l := l0;
     input := iom;
     destination := sf;
     output := oom
   |}]</span></span></span><br><span><var>Hs</var><span class="hyp-type"><b>: </b><span>valid_state_prop sf</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">finite_valid_trace_from_to si
  (finite_trace_last si tr) tr</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">        </span><span class="alectryon-sentence"><span class="alectryon-input"><span class="bp">assumption</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Qed</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
</span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="VLSM-v-chk238" style="display: none" type="checkbox"><label class="alectryon-input" for="VLSM-v-chk238"><span class="kn">Lemma</span> <span class="nf">finite_valid_trace_init_to_rev_ind</span>
      (<span class="nv">P</span> : state -&gt; state -&gt; list transition_item -&gt; <span class="kt">Prop</span>)
      (<span class="nv">Hempty</span>: <span class="kr">forall</span> <span class="nv">si</span>
        (<span class="nv">Hsi</span> : initial_state_prop si),
        P si si nil)
      (<span class="nv">Hextend</span> : <span class="kr">forall</span> <span class="nv">si</span> <span class="nv">s</span> <span class="nv">tr</span>
        (<span class="nv">IHtr</span> : P si s tr)
        (<span class="nv">Htr</span> : finite_valid_trace_init_to si s tr)
        <span class="nv">sf</span> <span class="nv">iom</span> <span class="nv">oom</span> <span class="nv">l</span>
        (<span class="nv">Ht</span> : input_valid_transition l (s,iom) (sf,oom)),
        P si sf (tr++[{|l:=l; input:=iom; destination:=sf; output:=oom|}])):
      <span class="kr">forall</span> <span class="nv">si</span> <span class="nv">sf</span> <span class="nv">tr</span>,
        finite_valid_trace_init_to si sf tr -&gt;
        P si sf tr.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>message</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>X</var><span class="hyp-type"><b>: </b><span>VLSM message</span></span></span><br><span><var>TypeX</var><span><span class="hyp-body"><b>:= </b><span>type X</span></span><span class="hyp-type"><b>: </b><span>VLSMType message</span></span></span></span><br><span><var>MachineX</var><span><span class="hyp-body"><b>:= </b><span>machine X</span></span><span class="hyp-type"><b>: </b><span>VLSMMachine (vtype X)</span></span></span></span><br><span><var>P</var><span class="hyp-type"><b>: </b><span>state ‚Üí state ‚Üí list transition_item ‚Üí <span class="kt">Prop</span></span></span></span><br><span><var>Hempty</var><span class="hyp-type"><b>: </b><span><span class="kr">‚àÄ</span> <span class="nv">si</span> : state,
  initial_state_prop si ‚Üí P si si []</span></span></span><br><span><var>Hextend</var><span class="hyp-type"><b>: </b><span><span class="kr">‚àÄ</span> (<span class="nv">si</span> <span class="nv">s</span> : state) (<span class="nv">tr</span> : list transition_item),
  P si s tr
  ‚Üí finite_valid_trace_init_to si s tr
    ‚Üí <span class="kr">‚àÄ</span> (<span class="nv">sf</span> : state) (<span class="nv">iom</span>
                      <span class="nv">oom</span> : 
                      option message) 
        (<span class="nv">l</span> : label),
        input_valid_transition l 
          (s, iom) (sf, oom)
        ‚Üí P si sf
            (tr ++
             [{|
                l := l;
                input := iom;
                destination := sf;
                output := oom
              |}])</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="kr">‚àÄ</span> (<span class="nv">si</span> <span class="nv">sf</span> : state) (<span class="nv">tr</span> : list transition_item),
  finite_valid_trace_init_to si sf tr ‚Üí P si sf tr</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="VLSM-v-chk239" style="display: none" type="checkbox"><label class="alectryon-input" for="VLSM-v-chk239"><span class="kn">Proof</span>.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>message</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>X</var><span class="hyp-type"><b>: </b><span>VLSM message</span></span></span><br><span><var>TypeX</var><span><span class="hyp-body"><b>:= </b><span>type X</span></span><span class="hyp-type"><b>: </b><span>VLSMType message</span></span></span></span><br><span><var>MachineX</var><span><span class="hyp-body"><b>:= </b><span>machine X</span></span><span class="hyp-type"><b>: </b><span>VLSMMachine (vtype X)</span></span></span></span><br><span><var>P</var><span class="hyp-type"><b>: </b><span>state ‚Üí state ‚Üí list transition_item ‚Üí <span class="kt">Prop</span></span></span></span><br><span><var>Hempty</var><span class="hyp-type"><b>: </b><span><span class="kr">‚àÄ</span> <span class="nv">si</span> : state,
  initial_state_prop si ‚Üí P si si []</span></span></span><br><span><var>Hextend</var><span class="hyp-type"><b>: </b><span><span class="kr">‚àÄ</span> (<span class="nv">si</span> <span class="nv">s</span> : state) (<span class="nv">tr</span> : list transition_item),
  P si s tr
  ‚Üí finite_valid_trace_init_to si s tr
    ‚Üí <span class="kr">‚àÄ</span> (<span class="nv">sf</span> : state) (<span class="nv">iom</span>
                      <span class="nv">oom</span> : 
                      option message) 
        (<span class="nv">l</span> : label),
        input_valid_transition l 
          (s, iom) (sf, oom)
        ‚Üí P si sf
            (tr ++
             [{|
                l := l;
                input := iom;
                destination := sf;
                output := oom
              |}])</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="kr">‚àÄ</span> (<span class="nv">si</span> <span class="nv">sf</span> : state) (<span class="nv">tr</span> : list transition_item),
  finite_valid_trace_init_to si sf tr ‚Üí P si sf tr</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">      </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="VLSM-v-chk23a" style="display: none" type="checkbox"><label class="alectryon-input" for="VLSM-v-chk23a"><span class="nb">intros</span> si sf tr Htr.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>message</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>X</var><span class="hyp-type"><b>: </b><span>VLSM message</span></span></span><br><span><var>TypeX</var><span><span class="hyp-body"><b>:= </b><span>type X</span></span><span class="hyp-type"><b>: </b><span>VLSMType message</span></span></span></span><br><span><var>MachineX</var><span><span class="hyp-body"><b>:= </b><span>machine X</span></span><span class="hyp-type"><b>: </b><span>VLSMMachine (vtype X)</span></span></span></span><br><span><var>P</var><span class="hyp-type"><b>: </b><span>state ‚Üí state ‚Üí list transition_item ‚Üí <span class="kt">Prop</span></span></span></span><br><span><var>Hempty</var><span class="hyp-type"><b>: </b><span><span class="kr">‚àÄ</span> <span class="nv">si</span> : state,
  initial_state_prop si ‚Üí P si si []</span></span></span><br><span><var>Hextend</var><span class="hyp-type"><b>: </b><span><span class="kr">‚àÄ</span> (<span class="nv">si</span> <span class="nv">s</span> : state) (<span class="nv">tr</span> : list transition_item),
  P si s tr
  ‚Üí finite_valid_trace_init_to si s tr
    ‚Üí <span class="kr">‚àÄ</span> (<span class="nv">sf</span> : state) (<span class="nv">iom</span>
                      <span class="nv">oom</span> : 
                      option message) 
        (<span class="nv">l</span> : label),
        input_valid_transition l 
          (s, iom) (sf, oom)
        ‚Üí P si sf
            (tr ++
             [{|
                l := l;
                input := iom;
                destination := sf;
                output := oom
              |}])</span></span></span><br><span><var>si, sf</var><span class="hyp-type"><b>: </b><span>state</span></span></span><br><span><var>tr</var><span class="hyp-type"><b>: </b><span>list transition_item</span></span></span><br><span><var>Htr</var><span class="hyp-type"><b>: </b><span>finite_valid_trace_init_to si sf tr</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">P si sf tr</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">      </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="VLSM-v-chk23b" style="display: none" type="checkbox"><label class="alectryon-input" for="VLSM-v-chk23b"><span class="nb">destruct</span> Htr <span class="kr">as</span> [Htr Hinit].</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>message</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>X</var><span class="hyp-type"><b>: </b><span>VLSM message</span></span></span><br><span><var>TypeX</var><span><span class="hyp-body"><b>:= </b><span>type X</span></span><span class="hyp-type"><b>: </b><span>VLSMType message</span></span></span></span><br><span><var>MachineX</var><span><span class="hyp-body"><b>:= </b><span>machine X</span></span><span class="hyp-type"><b>: </b><span>VLSMMachine (vtype X)</span></span></span></span><br><span><var>P</var><span class="hyp-type"><b>: </b><span>state ‚Üí state ‚Üí list transition_item ‚Üí <span class="kt">Prop</span></span></span></span><br><span><var>Hempty</var><span class="hyp-type"><b>: </b><span><span class="kr">‚àÄ</span> <span class="nv">si</span> : state,
  initial_state_prop si ‚Üí P si si []</span></span></span><br><span><var>Hextend</var><span class="hyp-type"><b>: </b><span><span class="kr">‚àÄ</span> (<span class="nv">si</span> <span class="nv">s</span> : state) (<span class="nv">tr</span> : list transition_item),
  P si s tr
  ‚Üí finite_valid_trace_init_to si s tr
    ‚Üí <span class="kr">‚àÄ</span> (<span class="nv">sf</span> : state) (<span class="nv">iom</span>
                      <span class="nv">oom</span> : 
                      option message) 
        (<span class="nv">l</span> : label),
        input_valid_transition l 
          (s, iom) (sf, oom)
        ‚Üí P si sf
            (tr ++
             [{|
                l := l;
                input := iom;
                destination := sf;
                output := oom
              |}])</span></span></span><br><span><var>si, sf</var><span class="hyp-type"><b>: </b><span>state</span></span></span><br><span><var>tr</var><span class="hyp-type"><b>: </b><span>list transition_item</span></span></span><br><span><var>Htr</var><span class="hyp-type"><b>: </b><span>finite_valid_trace_from_to si sf tr</span></span></span><br><span><var>Hinit</var><span class="hyp-type"><b>: </b><span>initial_state_prop si</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">P si sf tr</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">      </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="VLSM-v-chk23c" style="display: none" type="checkbox"><label class="alectryon-input" for="VLSM-v-chk23c"><span class="nb">induction</span> Htr <span class="nb">using</span> finite_valid_trace_from_to_rev_ind.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>message</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>X</var><span class="hyp-type"><b>: </b><span>VLSM message</span></span></span><br><span><var>TypeX</var><span><span class="hyp-body"><b>:= </b><span>type X</span></span><span class="hyp-type"><b>: </b><span>VLSMType message</span></span></span></span><br><span><var>MachineX</var><span><span class="hyp-body"><b>:= </b><span>machine X</span></span><span class="hyp-type"><b>: </b><span>VLSMMachine (vtype X)</span></span></span></span><br><span><var>P</var><span class="hyp-type"><b>: </b><span>state ‚Üí state ‚Üí list transition_item ‚Üí <span class="kt">Prop</span></span></span></span><br><span><var>Hempty</var><span class="hyp-type"><b>: </b><span><span class="kr">‚àÄ</span> <span class="nv">si</span> : state,
  initial_state_prop si ‚Üí P si si []</span></span></span><br><span><var>Hextend</var><span class="hyp-type"><b>: </b><span><span class="kr">‚àÄ</span> (<span class="nv">si</span> <span class="nv">s</span> : state) (<span class="nv">tr</span> : list transition_item),
  P si s tr
  ‚Üí finite_valid_trace_init_to si s tr
    ‚Üí <span class="kr">‚àÄ</span> (<span class="nv">sf</span> : state) (<span class="nv">iom</span>
                      <span class="nv">oom</span> : 
                      option message) 
        (<span class="nv">l</span> : label),
        input_valid_transition l 
          (s, iom) (sf, oom)
        ‚Üí P si sf
            (tr ++
             [{|
                l := l;
                input := iom;
                destination := sf;
                output := oom
              |}])</span></span></span><br><span><var>si</var><span class="hyp-type"><b>: </b><span>state</span></span></span><br><span><var>Hsi</var><span class="hyp-type"><b>: </b><span>valid_state_prop si</span></span></span><br><span><var>Hinit</var><span class="hyp-type"><b>: </b><span>initial_state_prop si</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">P si si []</div></blockquote><div class="alectryon-extra-goals"><input class="alectryon-extra-goal-toggle" id="VLSM-v-chk23d" style="display: none" type="checkbox"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>message</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>X</var><span class="hyp-type"><b>: </b><span>VLSM message</span></span></span><br><span><var>TypeX</var><span><span class="hyp-body"><b>:= </b><span>type X</span></span><span class="hyp-type"><b>: </b><span>VLSMType message</span></span></span></span><br><span><var>MachineX</var><span><span class="hyp-body"><b>:= </b><span>machine X</span></span><span class="hyp-type"><b>: </b><span>VLSMMachine (vtype X)</span></span></span></span><br><span><var>P</var><span class="hyp-type"><b>: </b><span>state ‚Üí state ‚Üí list transition_item ‚Üí <span class="kt">Prop</span></span></span></span><br><span><var>Hempty</var><span class="hyp-type"><b>: </b><span><span class="kr">‚àÄ</span> <span class="nv">si</span> : state,
  initial_state_prop si ‚Üí P si si []</span></span></span><br><span><var>Hextend</var><span class="hyp-type"><b>: </b><span><span class="kr">‚àÄ</span> (<span class="nv">si</span> <span class="nv">s</span> : state) (<span class="nv">tr</span> : list transition_item),
  P si s tr
  ‚Üí finite_valid_trace_init_to si s tr
    ‚Üí <span class="kr">‚àÄ</span> (<span class="nv">sf</span> : state) (<span class="nv">iom</span>
                      <span class="nv">oom</span> : 
                      option message) 
        (<span class="nv">l</span> : label),
        input_valid_transition l 
          (s, iom) (sf, oom)
        ‚Üí P si sf
            (tr ++
             [{|
                l := l;
                input := iom;
                destination := sf;
                output := oom
              |}])</span></span></span><br><span><var>si, s</var><span class="hyp-type"><b>: </b><span>state</span></span></span><br><span><var>tr</var><span class="hyp-type"><b>: </b><span>list transition_item</span></span></span><br><span><var>Htr</var><span class="hyp-type"><b>: </b><span>finite_valid_trace_from_to si s tr</span></span></span><br><span><var>sf</var><span class="hyp-type"><b>: </b><span>state</span></span></span><br><span><var>iom, oom</var><span class="hyp-type"><b>: </b><span>option message</span></span></span><br><span><var>l0</var><span class="hyp-type"><b>: </b><span>label</span></span></span><br><span><var>Ht</var><span class="hyp-type"><b>: </b><span>input_valid_transition l0 (s, iom) (sf, oom)</span></span></span><br><span><var>Hinit</var><span class="hyp-type"><b>: </b><span>initial_state_prop si</span></span></span><br><span><var>IHHtr</var><span class="hyp-type"><b>: </b><span>initial_state_prop si ‚Üí P si s tr</span></span></span><br></div><label class="goal-separator" for="VLSM-v-chk23d"><hr></label><div class="goal-conclusion">P si sf
  (tr ++
   [{|
      l := l0;
      input := iom;
      destination := sf;
      output := oom
    |}])</div></blockquote></div></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">      </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="VLSM-v-chk23e" style="display: none" type="checkbox"><label class="alectryon-input" for="VLSM-v-chk23e">-</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>message</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>X</var><span class="hyp-type"><b>: </b><span>VLSM message</span></span></span><br><span><var>TypeX</var><span><span class="hyp-body"><b>:= </b><span>type X</span></span><span class="hyp-type"><b>: </b><span>VLSMType message</span></span></span></span><br><span><var>MachineX</var><span><span class="hyp-body"><b>:= </b><span>machine X</span></span><span class="hyp-type"><b>: </b><span>VLSMMachine (vtype X)</span></span></span></span><br><span><var>P</var><span class="hyp-type"><b>: </b><span>state ‚Üí state ‚Üí list transition_item ‚Üí <span class="kt">Prop</span></span></span></span><br><span><var>Hempty</var><span class="hyp-type"><b>: </b><span><span class="kr">‚àÄ</span> <span class="nv">si</span> : state,
  initial_state_prop si ‚Üí P si si []</span></span></span><br><span><var>Hextend</var><span class="hyp-type"><b>: </b><span><span class="kr">‚àÄ</span> (<span class="nv">si</span> <span class="nv">s</span> : state) (<span class="nv">tr</span> : list transition_item),
  P si s tr
  ‚Üí finite_valid_trace_init_to si s tr
    ‚Üí <span class="kr">‚àÄ</span> (<span class="nv">sf</span> : state) (<span class="nv">iom</span>
                      <span class="nv">oom</span> : 
                      option message) 
        (<span class="nv">l</span> : label),
        input_valid_transition l 
          (s, iom) (sf, oom)
        ‚Üí P si sf
            (tr ++
             [{|
                l := l;
                input := iom;
                destination := sf;
                output := oom
              |}])</span></span></span><br><span><var>si</var><span class="hyp-type"><b>: </b><span>state</span></span></span><br><span><var>Hsi</var><span class="hyp-type"><b>: </b><span>valid_state_prop si</span></span></span><br><span><var>Hinit</var><span class="hyp-type"><b>: </b><span>initial_state_prop si</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">P si si []</div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="VLSM-v-chk23f" style="display: none" type="checkbox"><label class="alectryon-input" for="VLSM-v-chk23f"><span class="nb">apply</span> Hempty.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>message</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>X</var><span class="hyp-type"><b>: </b><span>VLSM message</span></span></span><br><span><var>TypeX</var><span><span class="hyp-body"><b>:= </b><span>type X</span></span><span class="hyp-type"><b>: </b><span>VLSMType message</span></span></span></span><br><span><var>MachineX</var><span><span class="hyp-body"><b>:= </b><span>machine X</span></span><span class="hyp-type"><b>: </b><span>VLSMMachine (vtype X)</span></span></span></span><br><span><var>P</var><span class="hyp-type"><b>: </b><span>state ‚Üí state ‚Üí list transition_item ‚Üí <span class="kt">Prop</span></span></span></span><br><span><var>Hempty</var><span class="hyp-type"><b>: </b><span><span class="kr">‚àÄ</span> <span class="nv">si</span> : state,
  initial_state_prop si ‚Üí P si si []</span></span></span><br><span><var>Hextend</var><span class="hyp-type"><b>: </b><span><span class="kr">‚àÄ</span> (<span class="nv">si</span> <span class="nv">s</span> : state) (<span class="nv">tr</span> : list transition_item),
  P si s tr
  ‚Üí finite_valid_trace_init_to si s tr
    ‚Üí <span class="kr">‚àÄ</span> (<span class="nv">sf</span> : state) (<span class="nv">iom</span>
                      <span class="nv">oom</span> : 
                      option message) 
        (<span class="nv">l</span> : label),
        input_valid_transition l 
          (s, iom) (sf, oom)
        ‚Üí P si sf
            (tr ++
             [{|
                l := l;
                input := iom;
                destination := sf;
                output := oom
              |}])</span></span></span><br><span><var>si</var><span class="hyp-type"><b>: </b><span>state</span></span></span><br><span><var>Hsi</var><span class="hyp-type"><b>: </b><span>valid_state_prop si</span></span></span><br><span><var>Hinit</var><span class="hyp-type"><b>: </b><span>initial_state_prop si</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">initial_state_prop si</div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="bp">assumption</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">      </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="VLSM-v-chk240" style="display: none" type="checkbox"><label class="alectryon-input" for="VLSM-v-chk240">-</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>message</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>X</var><span class="hyp-type"><b>: </b><span>VLSM message</span></span></span><br><span><var>TypeX</var><span><span class="hyp-body"><b>:= </b><span>type X</span></span><span class="hyp-type"><b>: </b><span>VLSMType message</span></span></span></span><br><span><var>MachineX</var><span><span class="hyp-body"><b>:= </b><span>machine X</span></span><span class="hyp-type"><b>: </b><span>VLSMMachine (vtype X)</span></span></span></span><br><span><var>P</var><span class="hyp-type"><b>: </b><span>state ‚Üí state ‚Üí list transition_item ‚Üí <span class="kt">Prop</span></span></span></span><br><span><var>Hempty</var><span class="hyp-type"><b>: </b><span><span class="kr">‚àÄ</span> <span class="nv">si</span> : state,
  initial_state_prop si ‚Üí P si si []</span></span></span><br><span><var>Hextend</var><span class="hyp-type"><b>: </b><span><span class="kr">‚àÄ</span> (<span class="nv">si</span> <span class="nv">s</span> : state) (<span class="nv">tr</span> : list transition_item),
  P si s tr
  ‚Üí finite_valid_trace_init_to si s tr
    ‚Üí <span class="kr">‚àÄ</span> (<span class="nv">sf</span> : state) (<span class="nv">iom</span>
                      <span class="nv">oom</span> : 
                      option message) 
        (<span class="nv">l</span> : label),
        input_valid_transition l 
          (s, iom) (sf, oom)
        ‚Üí P si sf
            (tr ++
             [{|
                l := l;
                input := iom;
                destination := sf;
                output := oom
              |}])</span></span></span><br><span><var>si, s</var><span class="hyp-type"><b>: </b><span>state</span></span></span><br><span><var>tr</var><span class="hyp-type"><b>: </b><span>list transition_item</span></span></span><br><span><var>Htr</var><span class="hyp-type"><b>: </b><span>finite_valid_trace_from_to si s tr</span></span></span><br><span><var>sf</var><span class="hyp-type"><b>: </b><span>state</span></span></span><br><span><var>iom, oom</var><span class="hyp-type"><b>: </b><span>option message</span></span></span><br><span><var>l0</var><span class="hyp-type"><b>: </b><span>label</span></span></span><br><span><var>Ht</var><span class="hyp-type"><b>: </b><span>input_valid_transition l0 (s, iom) (sf, oom)</span></span></span><br><span><var>Hinit</var><span class="hyp-type"><b>: </b><span>initial_state_prop si</span></span></span><br><span><var>IHHtr</var><span class="hyp-type"><b>: </b><span>initial_state_prop si ‚Üí P si s tr</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">P si sf
  (tr ++
   [{|
      l := l0;
      input := iom;
      destination := sf;
      output := oom
    |}])</div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="VLSM-v-chk241" style="display: none" type="checkbox"><label class="alectryon-input" for="VLSM-v-chk241"><span class="nb">apply</span> Hextend <span class="kr">with</span> s.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>message</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>X</var><span class="hyp-type"><b>: </b><span>VLSM message</span></span></span><br><span><var>TypeX</var><span><span class="hyp-body"><b>:= </b><span>type X</span></span><span class="hyp-type"><b>: </b><span>VLSMType message</span></span></span></span><br><span><var>MachineX</var><span><span class="hyp-body"><b>:= </b><span>machine X</span></span><span class="hyp-type"><b>: </b><span>VLSMMachine (vtype X)</span></span></span></span><br><span><var>P</var><span class="hyp-type"><b>: </b><span>state ‚Üí state ‚Üí list transition_item ‚Üí <span class="kt">Prop</span></span></span></span><br><span><var>Hempty</var><span class="hyp-type"><b>: </b><span><span class="kr">‚àÄ</span> <span class="nv">si</span> : state,
  initial_state_prop si ‚Üí P si si []</span></span></span><br><span><var>Hextend</var><span class="hyp-type"><b>: </b><span><span class="kr">‚àÄ</span> (<span class="nv">si</span> <span class="nv">s</span> : state) (<span class="nv">tr</span> : list transition_item),
  P si s tr
  ‚Üí finite_valid_trace_init_to si s tr
    ‚Üí <span class="kr">‚àÄ</span> (<span class="nv">sf</span> : state) (<span class="nv">iom</span>
                      <span class="nv">oom</span> : 
                      option message) 
        (<span class="nv">l</span> : label),
        input_valid_transition l 
          (s, iom) (sf, oom)
        ‚Üí P si sf
            (tr ++
             [{|
                l := l;
                input := iom;
                destination := sf;
                output := oom
              |}])</span></span></span><br><span><var>si, s</var><span class="hyp-type"><b>: </b><span>state</span></span></span><br><span><var>tr</var><span class="hyp-type"><b>: </b><span>list transition_item</span></span></span><br><span><var>Htr</var><span class="hyp-type"><b>: </b><span>finite_valid_trace_from_to si s tr</span></span></span><br><span><var>sf</var><span class="hyp-type"><b>: </b><span>state</span></span></span><br><span><var>iom, oom</var><span class="hyp-type"><b>: </b><span>option message</span></span></span><br><span><var>l0</var><span class="hyp-type"><b>: </b><span>label</span></span></span><br><span><var>Ht</var><span class="hyp-type"><b>: </b><span>input_valid_transition l0 (s, iom) (sf, oom)</span></span></span><br><span><var>Hinit</var><span class="hyp-type"><b>: </b><span>initial_state_prop si</span></span></span><br><span><var>IHHtr</var><span class="hyp-type"><b>: </b><span>initial_state_prop si ‚Üí P si s tr</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">P si s tr</div></blockquote><div class="alectryon-extra-goals"><input class="alectryon-extra-goal-toggle" id="VLSM-v-chk242" style="display: none" type="checkbox"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>message</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>X</var><span class="hyp-type"><b>: </b><span>VLSM message</span></span></span><br><span><var>TypeX</var><span><span class="hyp-body"><b>:= </b><span>type X</span></span><span class="hyp-type"><b>: </b><span>VLSMType message</span></span></span></span><br><span><var>MachineX</var><span><span class="hyp-body"><b>:= </b><span>machine X</span></span><span class="hyp-type"><b>: </b><span>VLSMMachine (vtype X)</span></span></span></span><br><span><var>P</var><span class="hyp-type"><b>: </b><span>state ‚Üí state ‚Üí list transition_item ‚Üí <span class="kt">Prop</span></span></span></span><br><span><var>Hempty</var><span class="hyp-type"><b>: </b><span><span class="kr">‚àÄ</span> <span class="nv">si</span> : state,
  initial_state_prop si ‚Üí P si si []</span></span></span><br><span><var>Hextend</var><span class="hyp-type"><b>: </b><span><span class="kr">‚àÄ</span> (<span class="nv">si</span> <span class="nv">s</span> : state) (<span class="nv">tr</span> : list transition_item),
  P si s tr
  ‚Üí finite_valid_trace_init_to si s tr
    ‚Üí <span class="kr">‚àÄ</span> (<span class="nv">sf</span> : state) (<span class="nv">iom</span>
                      <span class="nv">oom</span> : 
                      option message) 
        (<span class="nv">l</span> : label),
        input_valid_transition l 
          (s, iom) (sf, oom)
        ‚Üí P si sf
            (tr ++
             [{|
                l := l;
                input := iom;
                destination := sf;
                output := oom
              |}])</span></span></span><br><span><var>si, s</var><span class="hyp-type"><b>: </b><span>state</span></span></span><br><span><var>tr</var><span class="hyp-type"><b>: </b><span>list transition_item</span></span></span><br><span><var>Htr</var><span class="hyp-type"><b>: </b><span>finite_valid_trace_from_to si s tr</span></span></span><br><span><var>sf</var><span class="hyp-type"><b>: </b><span>state</span></span></span><br><span><var>iom, oom</var><span class="hyp-type"><b>: </b><span>option message</span></span></span><br><span><var>l0</var><span class="hyp-type"><b>: </b><span>label</span></span></span><br><span><var>Ht</var><span class="hyp-type"><b>: </b><span>input_valid_transition l0 (s, iom) (sf, oom)</span></span></span><br><span><var>Hinit</var><span class="hyp-type"><b>: </b><span>initial_state_prop si</span></span></span><br><span><var>IHHtr</var><span class="hyp-type"><b>: </b><span>initial_state_prop si ‚Üí P si s tr</span></span></span><br></div><label class="goal-separator" for="VLSM-v-chk242"><hr></label><div class="goal-conclusion">finite_valid_trace_init_to si s tr</div></blockquote><input class="alectryon-extra-goal-toggle" id="VLSM-v-chk243" style="display: none" type="checkbox"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>message</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>X</var><span class="hyp-type"><b>: </b><span>VLSM message</span></span></span><br><span><var>TypeX</var><span><span class="hyp-body"><b>:= </b><span>type X</span></span><span class="hyp-type"><b>: </b><span>VLSMType message</span></span></span></span><br><span><var>MachineX</var><span><span class="hyp-body"><b>:= </b><span>machine X</span></span><span class="hyp-type"><b>: </b><span>VLSMMachine (vtype X)</span></span></span></span><br><span><var>P</var><span class="hyp-type"><b>: </b><span>state ‚Üí state ‚Üí list transition_item ‚Üí <span class="kt">Prop</span></span></span></span><br><span><var>Hempty</var><span class="hyp-type"><b>: </b><span><span class="kr">‚àÄ</span> <span class="nv">si</span> : state,
  initial_state_prop si ‚Üí P si si []</span></span></span><br><span><var>Hextend</var><span class="hyp-type"><b>: </b><span><span class="kr">‚àÄ</span> (<span class="nv">si</span> <span class="nv">s</span> : state) (<span class="nv">tr</span> : list transition_item),
  P si s tr
  ‚Üí finite_valid_trace_init_to si s tr
    ‚Üí <span class="kr">‚àÄ</span> (<span class="nv">sf</span> : state) (<span class="nv">iom</span>
                      <span class="nv">oom</span> : 
                      option message) 
        (<span class="nv">l</span> : label),
        input_valid_transition l 
          (s, iom) (sf, oom)
        ‚Üí P si sf
            (tr ++
             [{|
                l := l;
                input := iom;
                destination := sf;
                output := oom
              |}])</span></span></span><br><span><var>si, s</var><span class="hyp-type"><b>: </b><span>state</span></span></span><br><span><var>tr</var><span class="hyp-type"><b>: </b><span>list transition_item</span></span></span><br><span><var>Htr</var><span class="hyp-type"><b>: </b><span>finite_valid_trace_from_to si s tr</span></span></span><br><span><var>sf</var><span class="hyp-type"><b>: </b><span>state</span></span></span><br><span><var>iom, oom</var><span class="hyp-type"><b>: </b><span>option message</span></span></span><br><span><var>l0</var><span class="hyp-type"><b>: </b><span>label</span></span></span><br><span><var>Ht</var><span class="hyp-type"><b>: </b><span>input_valid_transition l0 (s, iom) (sf, oom)</span></span></span><br><span><var>Hinit</var><span class="hyp-type"><b>: </b><span>initial_state_prop si</span></span></span><br><span><var>IHHtr</var><span class="hyp-type"><b>: </b><span>initial_state_prop si ‚Üí P si s tr</span></span></span><br></div><label class="goal-separator" for="VLSM-v-chk243"><hr></label><div class="goal-conclusion">input_valid_transition l0 (s, iom) (sf, oom)</div></blockquote></div></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">        </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="VLSM-v-chk244" style="display: none" type="checkbox"><label class="alectryon-input" for="VLSM-v-chk244">+</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>message</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>X</var><span class="hyp-type"><b>: </b><span>VLSM message</span></span></span><br><span><var>TypeX</var><span><span class="hyp-body"><b>:= </b><span>type X</span></span><span class="hyp-type"><b>: </b><span>VLSMType message</span></span></span></span><br><span><var>MachineX</var><span><span class="hyp-body"><b>:= </b><span>machine X</span></span><span class="hyp-type"><b>: </b><span>VLSMMachine (vtype X)</span></span></span></span><br><span><var>P</var><span class="hyp-type"><b>: </b><span>state ‚Üí state ‚Üí list transition_item ‚Üí <span class="kt">Prop</span></span></span></span><br><span><var>Hempty</var><span class="hyp-type"><b>: </b><span><span class="kr">‚àÄ</span> <span class="nv">si</span> : state,
  initial_state_prop si ‚Üí P si si []</span></span></span><br><span><var>Hextend</var><span class="hyp-type"><b>: </b><span><span class="kr">‚àÄ</span> (<span class="nv">si</span> <span class="nv">s</span> : state) (<span class="nv">tr</span> : list transition_item),
  P si s tr
  ‚Üí finite_valid_trace_init_to si s tr
    ‚Üí <span class="kr">‚àÄ</span> (<span class="nv">sf</span> : state) (<span class="nv">iom</span>
                      <span class="nv">oom</span> : 
                      option message) 
        (<span class="nv">l</span> : label),
        input_valid_transition l 
          (s, iom) (sf, oom)
        ‚Üí P si sf
            (tr ++
             [{|
                l := l;
                input := iom;
                destination := sf;
                output := oom
              |}])</span></span></span><br><span><var>si, s</var><span class="hyp-type"><b>: </b><span>state</span></span></span><br><span><var>tr</var><span class="hyp-type"><b>: </b><span>list transition_item</span></span></span><br><span><var>Htr</var><span class="hyp-type"><b>: </b><span>finite_valid_trace_from_to si s tr</span></span></span><br><span><var>sf</var><span class="hyp-type"><b>: </b><span>state</span></span></span><br><span><var>iom, oom</var><span class="hyp-type"><b>: </b><span>option message</span></span></span><br><span><var>l0</var><span class="hyp-type"><b>: </b><span>label</span></span></span><br><span><var>Ht</var><span class="hyp-type"><b>: </b><span>input_valid_transition l0 (s, iom) (sf, oom)</span></span></span><br><span><var>Hinit</var><span class="hyp-type"><b>: </b><span>initial_state_prop si</span></span></span><br><span><var>IHHtr</var><span class="hyp-type"><b>: </b><span>initial_state_prop si ‚Üí P si s tr</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">P si s tr</div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="VLSM-v-chk245" style="display: none" type="checkbox"><label class="alectryon-input" for="VLSM-v-chk245"><span class="nb">apply</span> IHHtr.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>message</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>X</var><span class="hyp-type"><b>: </b><span>VLSM message</span></span></span><br><span><var>TypeX</var><span><span class="hyp-body"><b>:= </b><span>type X</span></span><span class="hyp-type"><b>: </b><span>VLSMType message</span></span></span></span><br><span><var>MachineX</var><span><span class="hyp-body"><b>:= </b><span>machine X</span></span><span class="hyp-type"><b>: </b><span>VLSMMachine (vtype X)</span></span></span></span><br><span><var>P</var><span class="hyp-type"><b>: </b><span>state ‚Üí state ‚Üí list transition_item ‚Üí <span class="kt">Prop</span></span></span></span><br><span><var>Hempty</var><span class="hyp-type"><b>: </b><span><span class="kr">‚àÄ</span> <span class="nv">si</span> : state,
  initial_state_prop si ‚Üí P si si []</span></span></span><br><span><var>Hextend</var><span class="hyp-type"><b>: </b><span><span class="kr">‚àÄ</span> (<span class="nv">si</span> <span class="nv">s</span> : state) (<span class="nv">tr</span> : list transition_item),
  P si s tr
  ‚Üí finite_valid_trace_init_to si s tr
    ‚Üí <span class="kr">‚àÄ</span> (<span class="nv">sf</span> : state) (<span class="nv">iom</span>
                      <span class="nv">oom</span> : 
                      option message) 
        (<span class="nv">l</span> : label),
        input_valid_transition l 
          (s, iom) (sf, oom)
        ‚Üí P si sf
            (tr ++
             [{|
                l := l;
                input := iom;
                destination := sf;
                output := oom
              |}])</span></span></span><br><span><var>si, s</var><span class="hyp-type"><b>: </b><span>state</span></span></span><br><span><var>tr</var><span class="hyp-type"><b>: </b><span>list transition_item</span></span></span><br><span><var>Htr</var><span class="hyp-type"><b>: </b><span>finite_valid_trace_from_to si s tr</span></span></span><br><span><var>sf</var><span class="hyp-type"><b>: </b><span>state</span></span></span><br><span><var>iom, oom</var><span class="hyp-type"><b>: </b><span>option message</span></span></span><br><span><var>l0</var><span class="hyp-type"><b>: </b><span>label</span></span></span><br><span><var>Ht</var><span class="hyp-type"><b>: </b><span>input_valid_transition l0 (s, iom) (sf, oom)</span></span></span><br><span><var>Hinit</var><span class="hyp-type"><b>: </b><span>initial_state_prop si</span></span></span><br><span><var>IHHtr</var><span class="hyp-type"><b>: </b><span>initial_state_prop si ‚Üí P si s tr</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">initial_state_prop si</div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="bp">assumption</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">        </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="VLSM-v-chk246" style="display: none" type="checkbox"><label class="alectryon-input" for="VLSM-v-chk246">+</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>message</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>X</var><span class="hyp-type"><b>: </b><span>VLSM message</span></span></span><br><span><var>TypeX</var><span><span class="hyp-body"><b>:= </b><span>type X</span></span><span class="hyp-type"><b>: </b><span>VLSMType message</span></span></span></span><br><span><var>MachineX</var><span><span class="hyp-body"><b>:= </b><span>machine X</span></span><span class="hyp-type"><b>: </b><span>VLSMMachine (vtype X)</span></span></span></span><br><span><var>P</var><span class="hyp-type"><b>: </b><span>state ‚Üí state ‚Üí list transition_item ‚Üí <span class="kt">Prop</span></span></span></span><br><span><var>Hempty</var><span class="hyp-type"><b>: </b><span><span class="kr">‚àÄ</span> <span class="nv">si</span> : state,
  initial_state_prop si ‚Üí P si si []</span></span></span><br><span><var>Hextend</var><span class="hyp-type"><b>: </b><span><span class="kr">‚àÄ</span> (<span class="nv">si</span> <span class="nv">s</span> : state) (<span class="nv">tr</span> : list transition_item),
  P si s tr
  ‚Üí finite_valid_trace_init_to si s tr
    ‚Üí <span class="kr">‚àÄ</span> (<span class="nv">sf</span> : state) (<span class="nv">iom</span>
                      <span class="nv">oom</span> : 
                      option message) 
        (<span class="nv">l</span> : label),
        input_valid_transition l 
          (s, iom) (sf, oom)
        ‚Üí P si sf
            (tr ++
             [{|
                l := l;
                input := iom;
                destination := sf;
                output := oom
              |}])</span></span></span><br><span><var>si, s</var><span class="hyp-type"><b>: </b><span>state</span></span></span><br><span><var>tr</var><span class="hyp-type"><b>: </b><span>list transition_item</span></span></span><br><span><var>Htr</var><span class="hyp-type"><b>: </b><span>finite_valid_trace_from_to si s tr</span></span></span><br><span><var>sf</var><span class="hyp-type"><b>: </b><span>state</span></span></span><br><span><var>iom, oom</var><span class="hyp-type"><b>: </b><span>option message</span></span></span><br><span><var>l0</var><span class="hyp-type"><b>: </b><span>label</span></span></span><br><span><var>Ht</var><span class="hyp-type"><b>: </b><span>input_valid_transition l0 (s, iom) (sf, oom)</span></span></span><br><span><var>Hinit</var><span class="hyp-type"><b>: </b><span>initial_state_prop si</span></span></span><br><span><var>IHHtr</var><span class="hyp-type"><b>: </b><span>initial_state_prop si ‚Üí P si s tr</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">finite_valid_trace_init_to si s tr</div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="nb">split</span>; <span class="bp">assumption</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">        </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="VLSM-v-chk247" style="display: none" type="checkbox"><label class="alectryon-input" for="VLSM-v-chk247">+</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>message</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>X</var><span class="hyp-type"><b>: </b><span>VLSM message</span></span></span><br><span><var>TypeX</var><span><span class="hyp-body"><b>:= </b><span>type X</span></span><span class="hyp-type"><b>: </b><span>VLSMType message</span></span></span></span><br><span><var>MachineX</var><span><span class="hyp-body"><b>:= </b><span>machine X</span></span><span class="hyp-type"><b>: </b><span>VLSMMachine (vtype X)</span></span></span></span><br><span><var>P</var><span class="hyp-type"><b>: </b><span>state ‚Üí state ‚Üí list transition_item ‚Üí <span class="kt">Prop</span></span></span></span><br><span><var>Hempty</var><span class="hyp-type"><b>: </b><span><span class="kr">‚àÄ</span> <span class="nv">si</span> : state,
  initial_state_prop si ‚Üí P si si []</span></span></span><br><span><var>Hextend</var><span class="hyp-type"><b>: </b><span><span class="kr">‚àÄ</span> (<span class="nv">si</span> <span class="nv">s</span> : state) (<span class="nv">tr</span> : list transition_item),
  P si s tr
  ‚Üí finite_valid_trace_init_to si s tr
    ‚Üí <span class="kr">‚àÄ</span> (<span class="nv">sf</span> : state) (<span class="nv">iom</span>
                      <span class="nv">oom</span> : 
                      option message) 
        (<span class="nv">l</span> : label),
        input_valid_transition l 
          (s, iom) (sf, oom)
        ‚Üí P si sf
            (tr ++
             [{|
                l := l;
                input := iom;
                destination := sf;
                output := oom
              |}])</span></span></span><br><span><var>si, s</var><span class="hyp-type"><b>: </b><span>state</span></span></span><br><span><var>tr</var><span class="hyp-type"><b>: </b><span>list transition_item</span></span></span><br><span><var>Htr</var><span class="hyp-type"><b>: </b><span>finite_valid_trace_from_to si s tr</span></span></span><br><span><var>sf</var><span class="hyp-type"><b>: </b><span>state</span></span></span><br><span><var>iom, oom</var><span class="hyp-type"><b>: </b><span>option message</span></span></span><br><span><var>l0</var><span class="hyp-type"><b>: </b><span>label</span></span></span><br><span><var>Ht</var><span class="hyp-type"><b>: </b><span>input_valid_transition l0 (s, iom) (sf, oom)</span></span></span><br><span><var>Hinit</var><span class="hyp-type"><b>: </b><span>initial_state_prop si</span></span></span><br><span><var>IHHtr</var><span class="hyp-type"><b>: </b><span>initial_state_prop si ‚Üí P si s tr</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">input_valid_transition l0 (s, iom) (sf, oom)</div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="bp">assumption</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Qed</span>.</span></span></pre><div class="doc">
An inductive valid trace property which also identifies the final message.

<div class="paragraph"> </div>

As shown by the <span class="inlinecode"><span class="id" title="var">finite_valid_trace_init_to_emit_valid_state_message</span></span>  and
<span class="inlinecode"><span class="id" title="var">finite_valid_trace_init_to_emit_valid_state_message_rev</span></span> lemmas below, this definition
is the trace-equivalent of the <span class="inlinecode"><span class="id" title="var">valid_state_message_prop</span></span>erty.

<div class="paragraph"> </div>

This inductive property is reflecting that fact that a that <code>valid_state_message_prop (s,om)</code>
holds only if <code>s</code> and <code>om</code> are the final state and output of an initial valid
trace, or a pair of an initial state and option-initial message.
It follows the inductive structure of <code>valid_state_message_prop</code>, but augments every node of
the tree with such an exhibiting trace.

<div class="paragraph"> </div>

Its main benefit is that when performing induction over it, one can also use the
induction hypothesis for the (trace generating the) message being received.

<div class="paragraph"> </div>

Although this definition could be used directly, we prefer to use it to derive
a stronger induction principle (<span class="inlinecode"><span class="id" title="var">finite_valid_trace_init_to_rev_strong_ind</span></span>)
over <span class="inlinecode"><span class="id" title="var">finite_valid_trace_init_to</span></span> traces.

</div><pre class="alectryon-io highlight"><!-- Generator: Alectryon --><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Inductive</span> <span class="nf">finite_valid_trace_init_to_emit</span> : state -&gt; state -&gt; option message -&gt; list transition_item -&gt; <span class="kt">Prop</span> :=
    | finite_valid_trace_init_to_emit_empty : <span class="kr">forall</span> (<span class="nv">is</span> : state) (<span class="nv">om</span> : option message)
        (<span class="nv">His</span> : initial_state_prop <span class="kr">is</span>)
        (<span class="nv">Him</span> : option_initial_message_prop om),
        finite_valid_trace_init_to_emit <span class="kr">is</span> <span class="kr">is</span> om []
    | finite_valid_trace_init_to_emit_extend
        : <span class="kr">forall</span>
          (<span class="nv">is</span> <span class="nv">s</span> : state) (<span class="nv">_om</span> : option message) (<span class="nv">tl</span> : list transition_item)
          (<span class="nv">Hs</span> : finite_valid_trace_init_to_emit <span class="kr">is</span> s _om tl)
          (<span class="nv">iom_is</span> <span class="nv">iom_s</span> : state) (<span class="nv">iom</span> : option message) (<span class="nv">iom_tl</span> : list transition_item)
          (<span class="nv">Hiom</span> : finite_valid_trace_init_to_emit iom_is iom_s iom iom_tl)
          (<span class="nv">l</span> : label)
          (<span class="nv">Hv</span> : valid l (s, iom))
          (<span class="nv">s&#39;</span> : state) (<span class="nv">oom</span> : option message)
          (<span class="nv">Ht</span> : transition l (s, iom) = (s&#39;, oom)),
          finite_valid_trace_init_to_emit <span class="kr">is</span> s&#39; oom (tl ++ [{| l := l; input := iom; destination := s&#39;; output := oom |}]).</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
</span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="VLSM-v-chk248" style="display: none" type="checkbox"><label class="alectryon-input" for="VLSM-v-chk248"><span class="kn">Lemma</span> <span class="nf">finite_valid_trace_init_to_emit_initial_state</span>
      (<span class="nv">is</span> <span class="nv">f</span> : state) (<span class="nv">om</span> : option message) (<span class="nv">tl</span> : list transition_item)
      (<span class="nv">Htl</span> : finite_valid_trace_init_to_emit <span class="kr">is</span> f om tl)
      : initial_state_prop <span class="kr">is</span>.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>message</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>X</var><span class="hyp-type"><b>: </b><span>VLSM message</span></span></span><br><span><var>TypeX</var><span><span class="hyp-body"><b>:= </b><span>type X</span></span><span class="hyp-type"><b>: </b><span>VLSMType message</span></span></span></span><br><span><var>MachineX</var><span><span class="hyp-body"><b>:= </b><span>machine X</span></span><span class="hyp-type"><b>: </b><span>VLSMMachine (vtype X)</span></span></span></span><br><span><var>is, f</var><span class="hyp-type"><b>: </b><span>state</span></span></span><br><span><var>om</var><span class="hyp-type"><b>: </b><span>option message</span></span></span><br><span><var>tl</var><span class="hyp-type"><b>: </b><span>list transition_item</span></span></span><br><span><var>Htl</var><span class="hyp-type"><b>: </b><span>finite_valid_trace_init_to_emit <span class="kr">is</span> f om tl</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">initial_state_prop <span class="kr">is</span></div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="VLSM-v-chk249" style="display: none" type="checkbox"><label class="alectryon-input" for="VLSM-v-chk249"><span class="kn">Proof</span>.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>message</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>X</var><span class="hyp-type"><b>: </b><span>VLSM message</span></span></span><br><span><var>TypeX</var><span><span class="hyp-body"><b>:= </b><span>type X</span></span><span class="hyp-type"><b>: </b><span>VLSMType message</span></span></span></span><br><span><var>MachineX</var><span><span class="hyp-body"><b>:= </b><span>machine X</span></span><span class="hyp-type"><b>: </b><span>VLSMMachine (vtype X)</span></span></span></span><br><span><var>is, f</var><span class="hyp-type"><b>: </b><span>state</span></span></span><br><span><var>om</var><span class="hyp-type"><b>: </b><span>option message</span></span></span><br><span><var>tl</var><span class="hyp-type"><b>: </b><span>list transition_item</span></span></span><br><span><var>Htl</var><span class="hyp-type"><b>: </b><span>finite_valid_trace_init_to_emit <span class="kr">is</span> f om tl</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">initial_state_prop <span class="kr">is</span></div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">      </span><span class="alectryon-sentence"><span class="alectryon-input"><span class="nb">induction</span> Htl; <span class="bp">assumption</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Qed</span>.</span></span></pre><div class="doc">
A property characterizing the "emit" message of <span class="inlinecode"><span class="id" title="var">finite_valid_trace_init_to_emit</span></span>.

<div class="paragraph"> </div>

There are two cases: (1) either the trace is empty, and then we require
the message to be initial; or (2) the trace is not empty, and the message
is the output of the last transition.

</div><pre class="alectryon-io highlight"><!-- Generator: Alectryon --><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="VLSM-v-chk24a" style="display: none" type="checkbox"><label class="alectryon-input" for="VLSM-v-chk24a"><span class="kn">Definition</span> <span class="nf">empty_initial_message_or_final_output</span> (<span class="nv">tl</span> : list transition_item) (<span class="nv">om</span> : option message) : <span class="kt">Prop</span>.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>message</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>X</var><span class="hyp-type"><b>: </b><span>VLSM message</span></span></span><br><span><var>TypeX</var><span><span class="hyp-body"><b>:= </b><span>type X</span></span><span class="hyp-type"><b>: </b><span>VLSMType message</span></span></span></span><br><span><var>MachineX</var><span><span class="hyp-body"><b>:= </b><span>machine X</span></span><span class="hyp-type"><b>: </b><span>VLSMMachine (vtype X)</span></span></span></span><br><span><var>tl</var><span class="hyp-type"><b>: </b><span>list transition_item</span></span></span><br><span><var>om</var><span class="hyp-type"><b>: </b><span>option message</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="kt">Prop</span></div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="VLSM-v-chk24b" style="display: none" type="checkbox"><label class="alectryon-input" for="VLSM-v-chk24b"><span class="kn">Proof</span>.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>message</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>X</var><span class="hyp-type"><b>: </b><span>VLSM message</span></span></span><br><span><var>TypeX</var><span><span class="hyp-body"><b>:= </b><span>type X</span></span><span class="hyp-type"><b>: </b><span>VLSMType message</span></span></span></span><br><span><var>MachineX</var><span><span class="hyp-body"><b>:= </b><span>machine X</span></span><span class="hyp-type"><b>: </b><span>VLSMMachine (vtype X)</span></span></span></span><br><span><var>tl</var><span class="hyp-type"><b>: </b><span>list transition_item</span></span></span><br><span><var>om</var><span class="hyp-type"><b>: </b><span>option message</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="kt">Prop</span></div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">      </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="VLSM-v-chk24c" style="display: none" type="checkbox"><label class="alectryon-input" for="VLSM-v-chk24c"><span class="nb">destruct</span> (has_last_or_null tl) <span class="kr">as</span> [[_ [item _]] | _].</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>message</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>X</var><span class="hyp-type"><b>: </b><span>VLSM message</span></span></span><br><span><var>TypeX</var><span><span class="hyp-body"><b>:= </b><span>type X</span></span><span class="hyp-type"><b>: </b><span>VLSMType message</span></span></span></span><br><span><var>MachineX</var><span><span class="hyp-body"><b>:= </b><span>machine X</span></span><span class="hyp-type"><b>: </b><span>VLSMMachine (vtype X)</span></span></span></span><br><span><var>tl</var><span class="hyp-type"><b>: </b><span>list transition_item</span></span></span><br><span><var>om</var><span class="hyp-type"><b>: </b><span>option message</span></span></span><br><span><var>item</var><span class="hyp-type"><b>: </b><span>transition_item</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="kt">Prop</span></div></blockquote><div class="alectryon-extra-goals"><input class="alectryon-extra-goal-toggle" id="VLSM-v-chk24d" style="display: none" type="checkbox"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>message</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>X</var><span class="hyp-type"><b>: </b><span>VLSM message</span></span></span><br><span><var>TypeX</var><span><span class="hyp-body"><b>:= </b><span>type X</span></span><span class="hyp-type"><b>: </b><span>VLSMType message</span></span></span></span><br><span><var>MachineX</var><span><span class="hyp-body"><b>:= </b><span>machine X</span></span><span class="hyp-type"><b>: </b><span>VLSMMachine (vtype X)</span></span></span></span><br><span><var>tl</var><span class="hyp-type"><b>: </b><span>list transition_item</span></span></span><br><span><var>om</var><span class="hyp-type"><b>: </b><span>option message</span></span></span><br></div><label class="goal-separator" for="VLSM-v-chk24d"><hr></label><div class="goal-conclusion"><span class="kt">Prop</span></div></blockquote></div></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">      </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="VLSM-v-chk24e" style="display: none" type="checkbox"><label class="alectryon-input" for="VLSM-v-chk24e">-</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>message</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>X</var><span class="hyp-type"><b>: </b><span>VLSM message</span></span></span><br><span><var>TypeX</var><span><span class="hyp-body"><b>:= </b><span>type X</span></span><span class="hyp-type"><b>: </b><span>VLSMType message</span></span></span></span><br><span><var>MachineX</var><span><span class="hyp-body"><b>:= </b><span>machine X</span></span><span class="hyp-type"><b>: </b><span>VLSMMachine (vtype X)</span></span></span></span><br><span><var>tl</var><span class="hyp-type"><b>: </b><span>list transition_item</span></span></span><br><span><var>om</var><span class="hyp-type"><b>: </b><span>option message</span></span></span><br><span><var>item</var><span class="hyp-type"><b>: </b><span>transition_item</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="kt">Prop</span></div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="bp">exact</span> (output item  = om).</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">      </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="VLSM-v-chk24f" style="display: none" type="checkbox"><label class="alectryon-input" for="VLSM-v-chk24f">-</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>message</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>X</var><span class="hyp-type"><b>: </b><span>VLSM message</span></span></span><br><span><var>TypeX</var><span><span class="hyp-body"><b>:= </b><span>type X</span></span><span class="hyp-type"><b>: </b><span>VLSMType message</span></span></span></span><br><span><var>MachineX</var><span><span class="hyp-body"><b>:= </b><span>machine X</span></span><span class="hyp-type"><b>: </b><span>VLSMMachine (vtype X)</span></span></span></span><br><span><var>tl</var><span class="hyp-type"><b>: </b><span>list transition_item</span></span></span><br><span><var>om</var><span class="hyp-type"><b>: </b><span>option message</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="kt">Prop</span></div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="bp">exact</span> (option_initial_message_prop om).</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Defined</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
</span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="VLSM-v-chk250" style="display: none" type="checkbox"><label class="alectryon-input" for="VLSM-v-chk250"><span class="kn">Lemma</span> <span class="nf">finite_valid_trace_init_to_emit_output</span>
      (<span class="nv">s</span> <span class="nv">f</span> : state) (<span class="nv">om</span> : option message) (<span class="nv">tl</span> : list transition_item)
      (<span class="nv">Htl</span> : finite_valid_trace_init_to_emit s f om tl)
      : empty_initial_message_or_final_output tl om.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>message</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>X</var><span class="hyp-type"><b>: </b><span>VLSM message</span></span></span><br><span><var>TypeX</var><span><span class="hyp-body"><b>:= </b><span>type X</span></span><span class="hyp-type"><b>: </b><span>VLSMType message</span></span></span></span><br><span><var>MachineX</var><span><span class="hyp-body"><b>:= </b><span>machine X</span></span><span class="hyp-type"><b>: </b><span>VLSMMachine (vtype X)</span></span></span></span><br><span><var>s, f</var><span class="hyp-type"><b>: </b><span>state</span></span></span><br><span><var>om</var><span class="hyp-type"><b>: </b><span>option message</span></span></span><br><span><var>tl</var><span class="hyp-type"><b>: </b><span>list transition_item</span></span></span><br><span><var>Htl</var><span class="hyp-type"><b>: </b><span>finite_valid_trace_init_to_emit s f om tl</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">empty_initial_message_or_final_output tl om</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="VLSM-v-chk251" style="display: none" type="checkbox"><label class="alectryon-input" for="VLSM-v-chk251"><span class="kn">Proof</span>.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>message</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>X</var><span class="hyp-type"><b>: </b><span>VLSM message</span></span></span><br><span><var>TypeX</var><span><span class="hyp-body"><b>:= </b><span>type X</span></span><span class="hyp-type"><b>: </b><span>VLSMType message</span></span></span></span><br><span><var>MachineX</var><span><span class="hyp-body"><b>:= </b><span>machine X</span></span><span class="hyp-type"><b>: </b><span>VLSMMachine (vtype X)</span></span></span></span><br><span><var>s, f</var><span class="hyp-type"><b>: </b><span>state</span></span></span><br><span><var>om</var><span class="hyp-type"><b>: </b><span>option message</span></span></span><br><span><var>tl</var><span class="hyp-type"><b>: </b><span>list transition_item</span></span></span><br><span><var>Htl</var><span class="hyp-type"><b>: </b><span>finite_valid_trace_init_to_emit s f om tl</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">empty_initial_message_or_final_output tl om</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">      </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="VLSM-v-chk252" style="display: none" type="checkbox"><label class="alectryon-input" for="VLSM-v-chk252"><span class="nb">unfold</span> empty_initial_message_or_final_output.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>message</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>X</var><span class="hyp-type"><b>: </b><span>VLSM message</span></span></span><br><span><var>TypeX</var><span><span class="hyp-body"><b>:= </b><span>type X</span></span><span class="hyp-type"><b>: </b><span>VLSMType message</span></span></span></span><br><span><var>MachineX</var><span><span class="hyp-body"><b>:= </b><span>machine X</span></span><span class="hyp-type"><b>: </b><span>VLSMMachine (vtype X)</span></span></span></span><br><span><var>s, f</var><span class="hyp-type"><b>: </b><span>state</span></span></span><br><span><var>om</var><span class="hyp-type"><b>: </b><span>option message</span></span></span><br><span><var>tl</var><span class="hyp-type"><b>: </b><span>list transition_item</span></span></span><br><span><var>Htl</var><span class="hyp-type"><b>: </b><span>finite_valid_trace_init_to_emit s f om tl</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="kr">match</span> has_last_or_null tl <span class="kr">with</span>
| inleft (existT _tmp (item ‚Üæ _)) =&gt; output item = om
| inright _ =&gt; option_initial_message_prop om
<span class="kr">end</span></div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">      </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="VLSM-v-chk253" style="display: none" type="checkbox"><label class="alectryon-input" for="VLSM-v-chk253">destruct_list_last tl tl&#39; item Heqtl.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>message</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>X</var><span class="hyp-type"><b>: </b><span>VLSM message</span></span></span><br><span><var>TypeX</var><span><span class="hyp-body"><b>:= </b><span>type X</span></span><span class="hyp-type"><b>: </b><span>VLSMType message</span></span></span></span><br><span><var>MachineX</var><span><span class="hyp-body"><b>:= </b><span>machine X</span></span><span class="hyp-type"><b>: </b><span>VLSMMachine (vtype X)</span></span></span></span><br><span><var>s, f</var><span class="hyp-type"><b>: </b><span>state</span></span></span><br><span><var>om</var><span class="hyp-type"><b>: </b><span>option message</span></span></span><br><span><var>tl</var><span class="hyp-type"><b>: </b><span>list transition_item</span></span></span><br><span><var>Htl</var><span class="hyp-type"><b>: </b><span>finite_valid_trace_init_to_emit s f om []</span></span></span><br><span><var>Heqtl</var><span class="hyp-type"><b>: </b><span>tl = []</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">option_initial_message_prop om</div></blockquote><div class="alectryon-extra-goals"><input class="alectryon-extra-goal-toggle" id="VLSM-v-chk254" style="display: none" type="checkbox"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>message</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>X</var><span class="hyp-type"><b>: </b><span>VLSM message</span></span></span><br><span><var>TypeX</var><span><span class="hyp-body"><b>:= </b><span>type X</span></span><span class="hyp-type"><b>: </b><span>VLSMType message</span></span></span></span><br><span><var>MachineX</var><span><span class="hyp-body"><b>:= </b><span>machine X</span></span><span class="hyp-type"><b>: </b><span>VLSMMachine (vtype X)</span></span></span></span><br><span><var>s, f</var><span class="hyp-type"><b>: </b><span>state</span></span></span><br><span><var>om</var><span class="hyp-type"><b>: </b><span>option message</span></span></span><br><span><var>tl, tl'</var><span class="hyp-type"><b>: </b><span>list transition_item</span></span></span><br><span><var>item</var><span class="hyp-type"><b>: </b><span>transition_item</span></span></span><br><span><var>Htl</var><span class="hyp-type"><b>: </b><span>finite_valid_trace_init_to_emit s f om
  (tl&#39; ++ [item])</span></span></span><br><span><var>Heqtl</var><span class="hyp-type"><b>: </b><span>tl = tl&#39; ++ [item]</span></span></span><br></div><label class="goal-separator" for="VLSM-v-chk254"><hr></label><div class="goal-conclusion">output item = om</div></blockquote></div></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">      </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="VLSM-v-chk255" style="display: none" type="checkbox"><label class="alectryon-input" for="VLSM-v-chk255">-</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>message</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>X</var><span class="hyp-type"><b>: </b><span>VLSM message</span></span></span><br><span><var>TypeX</var><span><span class="hyp-body"><b>:= </b><span>type X</span></span><span class="hyp-type"><b>: </b><span>VLSMType message</span></span></span></span><br><span><var>MachineX</var><span><span class="hyp-body"><b>:= </b><span>machine X</span></span><span class="hyp-type"><b>: </b><span>VLSMMachine (vtype X)</span></span></span></span><br><span><var>s, f</var><span class="hyp-type"><b>: </b><span>state</span></span></span><br><span><var>om</var><span class="hyp-type"><b>: </b><span>option message</span></span></span><br><span><var>tl</var><span class="hyp-type"><b>: </b><span>list transition_item</span></span></span><br><span><var>Htl</var><span class="hyp-type"><b>: </b><span>finite_valid_trace_init_to_emit s f om []</span></span></span><br><span><var>Heqtl</var><span class="hyp-type"><b>: </b><span>tl = []</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">option_initial_message_prop om</div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="VLSM-v-chk256" style="display: none" type="checkbox"><label class="alectryon-input" for="VLSM-v-chk256"><span class="nb">inversion</span> Htl; [<span class="bp">assumption</span>|].</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>message</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>X</var><span class="hyp-type"><b>: </b><span>VLSM message</span></span></span><br><span><var>TypeX</var><span><span class="hyp-body"><b>:= </b><span>type X</span></span><span class="hyp-type"><b>: </b><span>VLSMType message</span></span></span></span><br><span><var>MachineX</var><span><span class="hyp-body"><b>:= </b><span>machine X</span></span><span class="hyp-type"><b>: </b><span>VLSMMachine (vtype X)</span></span></span></span><br><span><var>s, f</var><span class="hyp-type"><b>: </b><span>state</span></span></span><br><span><var>om</var><span class="hyp-type"><b>: </b><span>option message</span></span></span><br><span><var>tl</var><span class="hyp-type"><b>: </b><span>list transition_item</span></span></span><br><span><var>Htl</var><span class="hyp-type"><b>: </b><span>finite_valid_trace_init_to_emit s f om []</span></span></span><br><span><var>Heqtl</var><span class="hyp-type"><b>: </b><span>tl = []</span></span></span><br><span><var>is, s1</var><span class="hyp-type"><b>: </b><span>state</span></span></span><br><span><var>_om</var><span class="hyp-type"><b>: </b><span>option message</span></span></span><br><span><var>tl0</var><span class="hyp-type"><b>: </b><span>list transition_item</span></span></span><br><span><var>iom_is, iom_s</var><span class="hyp-type"><b>: </b><span>state</span></span></span><br><span><var>iom</var><span class="hyp-type"><b>: </b><span>option message</span></span></span><br><span><var>iom_tl</var><span class="hyp-type"><b>: </b><span>list transition_item</span></span></span><br><span><var>l0</var><span class="hyp-type"><b>: </b><span>label</span></span></span><br><span><var>s'</var><span class="hyp-type"><b>: </b><span>state</span></span></span><br><span><var>oom</var><span class="hyp-type"><b>: </b><span>option message</span></span></span><br><span><var>Hs</var><span class="hyp-type"><b>: </b><span>finite_valid_trace_init_to_emit s s1 _om tl0</span></span></span><br><span><var>Hiom</var><span class="hyp-type"><b>: </b><span>finite_valid_trace_init_to_emit iom_is iom_s
  iom iom_tl</span></span></span><br><span><var>Hv</var><span class="hyp-type"><b>: </b><span>valid l0 (s1, iom)</span></span></span><br><span><var>Ht</var><span class="hyp-type"><b>: </b><span>transition l0 (s1, iom) = (f, om)</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span><span class="kr">is</span> = s</span></span></span><br><span><var>H0</var><span class="hyp-type"><b>: </b><span>s&#39; = f</span></span></span><br><span><var>H1</var><span class="hyp-type"><b>: </b><span>oom = om</span></span></span><br><span><var>H3</var><span class="hyp-type"><b>: </b><span>tl0 ++
[{|
   l := l0;
   input := iom;
   destination := f;
   output := om
 |}] = []</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">option_initial_message_prop om</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">        </span><span class="alectryon-sentence"><span class="alectryon-input"><span class="nb">destruct</span> tl0; <span class="nb">simpl</span> <span class="kr">in</span> *; <span class="bp">congruence</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">      </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="VLSM-v-chk257" style="display: none" type="checkbox"><label class="alectryon-input" for="VLSM-v-chk257">-</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>message</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>X</var><span class="hyp-type"><b>: </b><span>VLSM message</span></span></span><br><span><var>TypeX</var><span><span class="hyp-body"><b>:= </b><span>type X</span></span><span class="hyp-type"><b>: </b><span>VLSMType message</span></span></span></span><br><span><var>MachineX</var><span><span class="hyp-body"><b>:= </b><span>machine X</span></span><span class="hyp-type"><b>: </b><span>VLSMMachine (vtype X)</span></span></span></span><br><span><var>s, f</var><span class="hyp-type"><b>: </b><span>state</span></span></span><br><span><var>om</var><span class="hyp-type"><b>: </b><span>option message</span></span></span><br><span><var>tl, tl'</var><span class="hyp-type"><b>: </b><span>list transition_item</span></span></span><br><span><var>item</var><span class="hyp-type"><b>: </b><span>transition_item</span></span></span><br><span><var>Htl</var><span class="hyp-type"><b>: </b><span>finite_valid_trace_init_to_emit s f om
  (tl&#39; ++ [item])</span></span></span><br><span><var>Heqtl</var><span class="hyp-type"><b>: </b><span>tl = tl&#39; ++ [item]</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">output item = om</div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="VLSM-v-chk258" style="display: none" type="checkbox"><label class="alectryon-input" for="VLSM-v-chk258"><span class="nb">rewrite</span> &lt;- Heqtl <span class="kr">in</span> Htl.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>message</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>X</var><span class="hyp-type"><b>: </b><span>VLSM message</span></span></span><br><span><var>TypeX</var><span><span class="hyp-body"><b>:= </b><span>type X</span></span><span class="hyp-type"><b>: </b><span>VLSMType message</span></span></span></span><br><span><var>MachineX</var><span><span class="hyp-body"><b>:= </b><span>machine X</span></span><span class="hyp-type"><b>: </b><span>VLSMMachine (vtype X)</span></span></span></span><br><span><var>s, f</var><span class="hyp-type"><b>: </b><span>state</span></span></span><br><span><var>om</var><span class="hyp-type"><b>: </b><span>option message</span></span></span><br><span><var>tl, tl'</var><span class="hyp-type"><b>: </b><span>list transition_item</span></span></span><br><span><var>item</var><span class="hyp-type"><b>: </b><span>transition_item</span></span></span><br><span><var>Htl</var><span class="hyp-type"><b>: </b><span>finite_valid_trace_init_to_emit s f om tl</span></span></span><br><span><var>Heqtl</var><span class="hyp-type"><b>: </b><span>tl = tl&#39; ++ [item]</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">output item = om</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">        </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="VLSM-v-chk259" style="display: none" type="checkbox"><label class="alectryon-input" for="VLSM-v-chk259"><span class="nb">inversion</span> Htl; [<span class="nb">destruct</span> tl&#39;; <span class="nb">simpl</span> <span class="kr">in</span> *; <span class="bp">congruence</span>|].</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>message</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>X</var><span class="hyp-type"><b>: </b><span>VLSM message</span></span></span><br><span><var>TypeX</var><span><span class="hyp-body"><b>:= </b><span>type X</span></span><span class="hyp-type"><b>: </b><span>VLSMType message</span></span></span></span><br><span><var>MachineX</var><span><span class="hyp-body"><b>:= </b><span>machine X</span></span><span class="hyp-type"><b>: </b><span>VLSMMachine (vtype X)</span></span></span></span><br><span><var>s, f</var><span class="hyp-type"><b>: </b><span>state</span></span></span><br><span><var>om</var><span class="hyp-type"><b>: </b><span>option message</span></span></span><br><span><var>tl, tl'</var><span class="hyp-type"><b>: </b><span>list transition_item</span></span></span><br><span><var>item</var><span class="hyp-type"><b>: </b><span>transition_item</span></span></span><br><span><var>Htl</var><span class="hyp-type"><b>: </b><span>finite_valid_trace_init_to_emit s f om tl</span></span></span><br><span><var>Heqtl</var><span class="hyp-type"><b>: </b><span>tl = tl&#39; ++ [item]</span></span></span><br><span><var>is, s1</var><span class="hyp-type"><b>: </b><span>state</span></span></span><br><span><var>_om</var><span class="hyp-type"><b>: </b><span>option message</span></span></span><br><span><var>tl0</var><span class="hyp-type"><b>: </b><span>list transition_item</span></span></span><br><span><var>iom_is, iom_s</var><span class="hyp-type"><b>: </b><span>state</span></span></span><br><span><var>iom</var><span class="hyp-type"><b>: </b><span>option message</span></span></span><br><span><var>iom_tl</var><span class="hyp-type"><b>: </b><span>list transition_item</span></span></span><br><span><var>l0</var><span class="hyp-type"><b>: </b><span>label</span></span></span><br><span><var>s'</var><span class="hyp-type"><b>: </b><span>state</span></span></span><br><span><var>oom</var><span class="hyp-type"><b>: </b><span>option message</span></span></span><br><span><var>Hs</var><span class="hyp-type"><b>: </b><span>finite_valid_trace_init_to_emit s s1 _om tl0</span></span></span><br><span><var>Hiom</var><span class="hyp-type"><b>: </b><span>finite_valid_trace_init_to_emit iom_is iom_s
  iom iom_tl</span></span></span><br><span><var>Hv</var><span class="hyp-type"><b>: </b><span>valid l0 (s1, iom)</span></span></span><br><span><var>Ht</var><span class="hyp-type"><b>: </b><span>transition l0 (s1, iom) = (f, om)</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span><span class="kr">is</span> = s</span></span></span><br><span><var>H0</var><span class="hyp-type"><b>: </b><span>s&#39; = f</span></span></span><br><span><var>H1</var><span class="hyp-type"><b>: </b><span>oom = om</span></span></span><br><span><var>H2</var><span class="hyp-type"><b>: </b><span>tl0 ++
[{|
   l := l0;
   input := iom;
   destination := f;
   output := om
 |}] = tl</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">output item = om</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">        </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="VLSM-v-chk25a" style="display: none" type="checkbox"><label class="alectryon-input" for="VLSM-v-chk25a"><span class="nb">revert</span> Heqtl; <span class="nb">subst</span>; <span class="nb">intro</span> Heqtl.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>message</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>X</var><span class="hyp-type"><b>: </b><span>VLSM message</span></span></span><br><span><var>TypeX</var><span><span class="hyp-body"><b>:= </b><span>type X</span></span><span class="hyp-type"><b>: </b><span>VLSMType message</span></span></span></span><br><span><var>MachineX</var><span><span class="hyp-body"><b>:= </b><span>machine X</span></span><span class="hyp-type"><b>: </b><span>VLSMMachine (vtype X)</span></span></span></span><br><span><var>s, f</var><span class="hyp-type"><b>: </b><span>state</span></span></span><br><span><var>om</var><span class="hyp-type"><b>: </b><span>option message</span></span></span><br><span><var>tl'</var><span class="hyp-type"><b>: </b><span>list transition_item</span></span></span><br><span><var>item</var><span class="hyp-type"><b>: </b><span>transition_item</span></span></span><br><span><var>tl0</var><span class="hyp-type"><b>: </b><span>list transition_item</span></span></span><br><span><var>iom</var><span class="hyp-type"><b>: </b><span>option message</span></span></span><br><span><var>l0</var><span class="hyp-type"><b>: </b><span>label</span></span></span><br><span><var>Htl</var><span class="hyp-type"><b>: </b><span>finite_valid_trace_init_to_emit s f om
  (tl0 ++
   [{|
      l := l0;
      input := iom;
      destination := f;
      output := om
    |}])</span></span></span><br><span><var>s1</var><span class="hyp-type"><b>: </b><span>state</span></span></span><br><span><var>_om</var><span class="hyp-type"><b>: </b><span>option message</span></span></span><br><span><var>iom_is, iom_s</var><span class="hyp-type"><b>: </b><span>state</span></span></span><br><span><var>iom_tl</var><span class="hyp-type"><b>: </b><span>list transition_item</span></span></span><br><span><var>Hs</var><span class="hyp-type"><b>: </b><span>finite_valid_trace_init_to_emit s s1 _om tl0</span></span></span><br><span><var>Hiom</var><span class="hyp-type"><b>: </b><span>finite_valid_trace_init_to_emit iom_is iom_s
  iom iom_tl</span></span></span><br><span><var>Hv</var><span class="hyp-type"><b>: </b><span>valid l0 (s1, iom)</span></span></span><br><span><var>Ht</var><span class="hyp-type"><b>: </b><span>transition l0 (s1, iom) = (f, om)</span></span></span><br><span><var>Heqtl</var><span class="hyp-type"><b>: </b><span>tl0 ++
[{|
   l := l0;
   input := iom;
   destination := f;
   output := om
 |}] = tl&#39; ++ [item]</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">output item = om</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">        </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="VLSM-v-chk25b" style="display: none" type="checkbox"><label class="alectryon-input" for="VLSM-v-chk25b"><span class="nb">apply</span> app_inj_tail, proj2 <span class="kr">in</span> Heqtl.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>message</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>X</var><span class="hyp-type"><b>: </b><span>VLSM message</span></span></span><br><span><var>TypeX</var><span><span class="hyp-body"><b>:= </b><span>type X</span></span><span class="hyp-type"><b>: </b><span>VLSMType message</span></span></span></span><br><span><var>MachineX</var><span><span class="hyp-body"><b>:= </b><span>machine X</span></span><span class="hyp-type"><b>: </b><span>VLSMMachine (vtype X)</span></span></span></span><br><span><var>s, f</var><span class="hyp-type"><b>: </b><span>state</span></span></span><br><span><var>om</var><span class="hyp-type"><b>: </b><span>option message</span></span></span><br><span><var>tl'</var><span class="hyp-type"><b>: </b><span>list transition_item</span></span></span><br><span><var>item</var><span class="hyp-type"><b>: </b><span>transition_item</span></span></span><br><span><var>tl0</var><span class="hyp-type"><b>: </b><span>list transition_item</span></span></span><br><span><var>iom</var><span class="hyp-type"><b>: </b><span>option message</span></span></span><br><span><var>l0</var><span class="hyp-type"><b>: </b><span>label</span></span></span><br><span><var>Htl</var><span class="hyp-type"><b>: </b><span>finite_valid_trace_init_to_emit s f om
  (tl0 ++
   [{|
      l := l0;
      input := iom;
      destination := f;
      output := om
    |}])</span></span></span><br><span><var>s1</var><span class="hyp-type"><b>: </b><span>state</span></span></span><br><span><var>_om</var><span class="hyp-type"><b>: </b><span>option message</span></span></span><br><span><var>iom_is, iom_s</var><span class="hyp-type"><b>: </b><span>state</span></span></span><br><span><var>iom_tl</var><span class="hyp-type"><b>: </b><span>list transition_item</span></span></span><br><span><var>Hs</var><span class="hyp-type"><b>: </b><span>finite_valid_trace_init_to_emit s s1 _om tl0</span></span></span><br><span><var>Hiom</var><span class="hyp-type"><b>: </b><span>finite_valid_trace_init_to_emit iom_is iom_s
  iom iom_tl</span></span></span><br><span><var>Hv</var><span class="hyp-type"><b>: </b><span>valid l0 (s1, iom)</span></span></span><br><span><var>Ht</var><span class="hyp-type"><b>: </b><span>transition l0 (s1, iom) = (f, om)</span></span></span><br><span><var>Heqtl</var><span class="hyp-type"><b>: </b><span>{|
  l := l0;
  input := iom;
  destination := f;
  output := om
|} = item</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">output item = om</div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="VLSM-v-chk25c" style="display: none" type="checkbox"><label class="alectryon-input" for="VLSM-v-chk25c"><span class="nb">subst</span>.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>message</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>X</var><span class="hyp-type"><b>: </b><span>VLSM message</span></span></span><br><span><var>TypeX</var><span><span class="hyp-body"><b>:= </b><span>type X</span></span><span class="hyp-type"><b>: </b><span>VLSMType message</span></span></span></span><br><span><var>MachineX</var><span><span class="hyp-body"><b>:= </b><span>machine X</span></span><span class="hyp-type"><b>: </b><span>VLSMMachine (vtype X)</span></span></span></span><br><span><var>s, f</var><span class="hyp-type"><b>: </b><span>state</span></span></span><br><span><var>om</var><span class="hyp-type"><b>: </b><span>option message</span></span></span><br><span><var>tl', tl0</var><span class="hyp-type"><b>: </b><span>list transition_item</span></span></span><br><span><var>iom</var><span class="hyp-type"><b>: </b><span>option message</span></span></span><br><span><var>l0</var><span class="hyp-type"><b>: </b><span>label</span></span></span><br><span><var>Htl</var><span class="hyp-type"><b>: </b><span>finite_valid_trace_init_to_emit s f om
  (tl0 ++
   [{|
      l := l0;
      input := iom;
      destination := f;
      output := om
    |}])</span></span></span><br><span><var>s1</var><span class="hyp-type"><b>: </b><span>state</span></span></span><br><span><var>_om</var><span class="hyp-type"><b>: </b><span>option message</span></span></span><br><span><var>iom_is, iom_s</var><span class="hyp-type"><b>: </b><span>state</span></span></span><br><span><var>iom_tl</var><span class="hyp-type"><b>: </b><span>list transition_item</span></span></span><br><span><var>Hs</var><span class="hyp-type"><b>: </b><span>finite_valid_trace_init_to_emit s s1 _om tl0</span></span></span><br><span><var>Hiom</var><span class="hyp-type"><b>: </b><span>finite_valid_trace_init_to_emit iom_is iom_s
  iom iom_tl</span></span></span><br><span><var>Hv</var><span class="hyp-type"><b>: </b><span>valid l0 (s1, iom)</span></span></span><br><span><var>Ht</var><span class="hyp-type"><b>: </b><span>transition l0 (s1, iom) = (f, om)</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">output
  {|
    l := l0;
    input := iom;
    destination := f;
    output := om
  |} = om</div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="bp">reflexivity</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Qed</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
</span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="VLSM-v-chk25d" style="display: none" type="checkbox"><label class="alectryon-input" for="VLSM-v-chk25d"><span class="kn">Lemma</span> <span class="nf">finite_valid_trace_init_to_emit_valid_state_message</span>
      (<span class="nv">s</span> <span class="nv">f</span> : state) (<span class="nv">om</span> : option message) (<span class="nv">tl</span> : list transition_item)
      (<span class="nv">Htl</span> : finite_valid_trace_init_to_emit s f om tl)
      : valid_state_message_prop f om.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>message</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>X</var><span class="hyp-type"><b>: </b><span>VLSM message</span></span></span><br><span><var>TypeX</var><span><span class="hyp-body"><b>:= </b><span>type X</span></span><span class="hyp-type"><b>: </b><span>VLSMType message</span></span></span></span><br><span><var>MachineX</var><span><span class="hyp-body"><b>:= </b><span>machine X</span></span><span class="hyp-type"><b>: </b><span>VLSMMachine (vtype X)</span></span></span></span><br><span><var>s, f</var><span class="hyp-type"><b>: </b><span>state</span></span></span><br><span><var>om</var><span class="hyp-type"><b>: </b><span>option message</span></span></span><br><span><var>tl</var><span class="hyp-type"><b>: </b><span>list transition_item</span></span></span><br><span><var>Htl</var><span class="hyp-type"><b>: </b><span>finite_valid_trace_init_to_emit s f om tl</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">valid_state_message_prop f om</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="VLSM-v-chk25e" style="display: none" type="checkbox"><label class="alectryon-input" for="VLSM-v-chk25e"><span class="kn">Proof</span>.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>message</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>X</var><span class="hyp-type"><b>: </b><span>VLSM message</span></span></span><br><span><var>TypeX</var><span><span class="hyp-body"><b>:= </b><span>type X</span></span><span class="hyp-type"><b>: </b><span>VLSMType message</span></span></span></span><br><span><var>MachineX</var><span><span class="hyp-body"><b>:= </b><span>machine X</span></span><span class="hyp-type"><b>: </b><span>VLSMMachine (vtype X)</span></span></span></span><br><span><var>s, f</var><span class="hyp-type"><b>: </b><span>state</span></span></span><br><span><var>om</var><span class="hyp-type"><b>: </b><span>option message</span></span></span><br><span><var>tl</var><span class="hyp-type"><b>: </b><span>list transition_item</span></span></span><br><span><var>Htl</var><span class="hyp-type"><b>: </b><span>finite_valid_trace_init_to_emit s f om tl</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">valid_state_message_prop f om</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">      </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="VLSM-v-chk25f" style="display: none" type="checkbox"><label class="alectryon-input" for="VLSM-v-chk25f"><span class="nb">induction</span> Htl.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>message</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>X</var><span class="hyp-type"><b>: </b><span>VLSM message</span></span></span><br><span><var>TypeX</var><span><span class="hyp-body"><b>:= </b><span>type X</span></span><span class="hyp-type"><b>: </b><span>VLSMType message</span></span></span></span><br><span><var>MachineX</var><span><span class="hyp-body"><b>:= </b><span>machine X</span></span><span class="hyp-type"><b>: </b><span>VLSMMachine (vtype X)</span></span></span></span><br><span><var>is</var><span class="hyp-type"><b>: </b><span>state</span></span></span><br><span><var>om</var><span class="hyp-type"><b>: </b><span>option message</span></span></span><br><span><var>His</var><span class="hyp-type"><b>: </b><span>initial_state_prop <span class="kr">is</span></span></span></span><br><span><var>Him</var><span class="hyp-type"><b>: </b><span>option_initial_message_prop om</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">valid_state_message_prop <span class="kr">is</span> om</div></blockquote><div class="alectryon-extra-goals"><input class="alectryon-extra-goal-toggle" id="VLSM-v-chk260" style="display: none" type="checkbox"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>message</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>X</var><span class="hyp-type"><b>: </b><span>VLSM message</span></span></span><br><span><var>TypeX</var><span><span class="hyp-body"><b>:= </b><span>type X</span></span><span class="hyp-type"><b>: </b><span>VLSMType message</span></span></span></span><br><span><var>MachineX</var><span><span class="hyp-body"><b>:= </b><span>machine X</span></span><span class="hyp-type"><b>: </b><span>VLSMMachine (vtype X)</span></span></span></span><br><span><var>is, s</var><span class="hyp-type"><b>: </b><span>state</span></span></span><br><span><var>_om</var><span class="hyp-type"><b>: </b><span>option message</span></span></span><br><span><var>tl</var><span class="hyp-type"><b>: </b><span>list transition_item</span></span></span><br><span><var>Htl1</var><span class="hyp-type"><b>: </b><span>finite_valid_trace_init_to_emit <span class="kr">is</span> s _om tl</span></span></span><br><span><var>iom_is, iom_s</var><span class="hyp-type"><b>: </b><span>state</span></span></span><br><span><var>iom</var><span class="hyp-type"><b>: </b><span>option message</span></span></span><br><span><var>iom_tl</var><span class="hyp-type"><b>: </b><span>list transition_item</span></span></span><br><span><var>Htl2</var><span class="hyp-type"><b>: </b><span>finite_valid_trace_init_to_emit iom_is iom_s
  iom iom_tl</span></span></span><br><span><var>l0</var><span class="hyp-type"><b>: </b><span>label</span></span></span><br><span><var>Hv</var><span class="hyp-type"><b>: </b><span>valid l0 (s, iom)</span></span></span><br><span><var>s'</var><span class="hyp-type"><b>: </b><span>state</span></span></span><br><span><var>oom</var><span class="hyp-type"><b>: </b><span>option message</span></span></span><br><span><var>Ht</var><span class="hyp-type"><b>: </b><span>transition l0 (s, iom) = (s&#39;, oom)</span></span></span><br><span><var>IHHtl1</var><span class="hyp-type"><b>: </b><span>valid_state_message_prop s _om</span></span></span><br><span><var>IHHtl2</var><span class="hyp-type"><b>: </b><span>valid_state_message_prop iom_s iom</span></span></span><br></div><label class="goal-separator" for="VLSM-v-chk260"><hr></label><div class="goal-conclusion">valid_state_message_prop s&#39; oom</div></blockquote></div></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">      </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="VLSM-v-chk261" style="display: none" type="checkbox"><label class="alectryon-input" for="VLSM-v-chk261">-</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>message</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>X</var><span class="hyp-type"><b>: </b><span>VLSM message</span></span></span><br><span><var>TypeX</var><span><span class="hyp-body"><b>:= </b><span>type X</span></span><span class="hyp-type"><b>: </b><span>VLSMType message</span></span></span></span><br><span><var>MachineX</var><span><span class="hyp-body"><b>:= </b><span>machine X</span></span><span class="hyp-type"><b>: </b><span>VLSMMachine (vtype X)</span></span></span></span><br><span><var>is</var><span class="hyp-type"><b>: </b><span>state</span></span></span><br><span><var>om</var><span class="hyp-type"><b>: </b><span>option message</span></span></span><br><span><var>His</var><span class="hyp-type"><b>: </b><span>initial_state_prop <span class="kr">is</span></span></span></span><br><span><var>Him</var><span class="hyp-type"><b>: </b><span>option_initial_message_prop om</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">valid_state_message_prop <span class="kr">is</span> om</div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="nb">apply</span> valid_initial_state_message; <span class="bp">assumption</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">      </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="VLSM-v-chk262" style="display: none" type="checkbox"><label class="alectryon-input" for="VLSM-v-chk262">-</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>message</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>X</var><span class="hyp-type"><b>: </b><span>VLSM message</span></span></span><br><span><var>TypeX</var><span><span class="hyp-body"><b>:= </b><span>type X</span></span><span class="hyp-type"><b>: </b><span>VLSMType message</span></span></span></span><br><span><var>MachineX</var><span><span class="hyp-body"><b>:= </b><span>machine X</span></span><span class="hyp-type"><b>: </b><span>VLSMMachine (vtype X)</span></span></span></span><br><span><var>is, s</var><span class="hyp-type"><b>: </b><span>state</span></span></span><br><span><var>_om</var><span class="hyp-type"><b>: </b><span>option message</span></span></span><br><span><var>tl</var><span class="hyp-type"><b>: </b><span>list transition_item</span></span></span><br><span><var>Htl1</var><span class="hyp-type"><b>: </b><span>finite_valid_trace_init_to_emit <span class="kr">is</span> s _om tl</span></span></span><br><span><var>iom_is, iom_s</var><span class="hyp-type"><b>: </b><span>state</span></span></span><br><span><var>iom</var><span class="hyp-type"><b>: </b><span>option message</span></span></span><br><span><var>iom_tl</var><span class="hyp-type"><b>: </b><span>list transition_item</span></span></span><br><span><var>Htl2</var><span class="hyp-type"><b>: </b><span>finite_valid_trace_init_to_emit iom_is iom_s
  iom iom_tl</span></span></span><br><span><var>l0</var><span class="hyp-type"><b>: </b><span>label</span></span></span><br><span><var>Hv</var><span class="hyp-type"><b>: </b><span>valid l0 (s, iom)</span></span></span><br><span><var>s'</var><span class="hyp-type"><b>: </b><span>state</span></span></span><br><span><var>oom</var><span class="hyp-type"><b>: </b><span>option message</span></span></span><br><span><var>Ht</var><span class="hyp-type"><b>: </b><span>transition l0 (s, iom) = (s&#39;, oom)</span></span></span><br><span><var>IHHtl1</var><span class="hyp-type"><b>: </b><span>valid_state_message_prop s _om</span></span></span><br><span><var>IHHtl2</var><span class="hyp-type"><b>: </b><span>valid_state_message_prop iom_s iom</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">valid_state_message_prop s&#39; oom</div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="nb">apply</span> valid_generated_state_message <span class="kr">with</span> s _om iom_s iom l0; <span class="bp">assumption</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Qed</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
</span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="VLSM-v-chk263" style="display: none" type="checkbox"><label class="alectryon-input" for="VLSM-v-chk263"><span class="kn">Lemma</span> <span class="nf">finite_valid_trace_init_to_emit_valid_state_message_rev</span>
      <span class="nv">f</span> <span class="nv">om</span>
      (<span class="nv">Hp</span> : valid_state_message_prop f om)
      : <span class="kr">exists</span> (<span class="nv">s</span> : state) (<span class="nv">tl</span> : list transition_item),
        finite_valid_trace_init_to_emit s f om tl.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>message</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>X</var><span class="hyp-type"><b>: </b><span>VLSM message</span></span></span><br><span><var>TypeX</var><span><span class="hyp-body"><b>:= </b><span>type X</span></span><span class="hyp-type"><b>: </b><span>VLSMType message</span></span></span></span><br><span><var>MachineX</var><span><span class="hyp-body"><b>:= </b><span>machine X</span></span><span class="hyp-type"><b>: </b><span>VLSMMachine (vtype X)</span></span></span></span><br><span><var>f</var><span class="hyp-type"><b>: </b><span>state</span></span></span><br><span><var>om</var><span class="hyp-type"><b>: </b><span>option message</span></span></span><br><span><var>Hp</var><span class="hyp-type"><b>: </b><span>valid_state_message_prop f om</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="kr">‚àÉ</span> (<span class="nv">s</span> : state) (<span class="nv">tl</span> : list transition_item),
  finite_valid_trace_init_to_emit s f om tl</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="VLSM-v-chk264" style="display: none" type="checkbox"><label class="alectryon-input" for="VLSM-v-chk264"><span class="kn">Proof</span>.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>message</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>X</var><span class="hyp-type"><b>: </b><span>VLSM message</span></span></span><br><span><var>TypeX</var><span><span class="hyp-body"><b>:= </b><span>type X</span></span><span class="hyp-type"><b>: </b><span>VLSMType message</span></span></span></span><br><span><var>MachineX</var><span><span class="hyp-body"><b>:= </b><span>machine X</span></span><span class="hyp-type"><b>: </b><span>VLSMMachine (vtype X)</span></span></span></span><br><span><var>f</var><span class="hyp-type"><b>: </b><span>state</span></span></span><br><span><var>om</var><span class="hyp-type"><b>: </b><span>option message</span></span></span><br><span><var>Hp</var><span class="hyp-type"><b>: </b><span>valid_state_message_prop f om</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="kr">‚àÉ</span> (<span class="nv">s</span> : state) (<span class="nv">tl</span> : list transition_item),
  finite_valid_trace_init_to_emit s f om tl</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">      </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="VLSM-v-chk265" style="display: none" type="checkbox"><label class="alectryon-input" for="VLSM-v-chk265"><span class="nb">induction</span> Hp.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>message</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>X</var><span class="hyp-type"><b>: </b><span>VLSM message</span></span></span><br><span><var>TypeX</var><span><span class="hyp-body"><b>:= </b><span>type X</span></span><span class="hyp-type"><b>: </b><span>VLSMType message</span></span></span></span><br><span><var>MachineX</var><span><span class="hyp-body"><b>:= </b><span>machine X</span></span><span class="hyp-type"><b>: </b><span>VLSMMachine (vtype X)</span></span></span></span><br><span><var>s</var><span class="hyp-type"><b>: </b><span>state</span></span></span><br><span><var>Hs</var><span class="hyp-type"><b>: </b><span>initial_state_prop s</span></span></span><br><span><var>om</var><span class="hyp-type"><b>: </b><span>option message</span></span></span><br><span><var>Hom</var><span class="hyp-type"><b>: </b><span>option_initial_message_prop om</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="kr">‚àÉ</span> (<span class="nv">s0</span> : state) (<span class="nv">tl</span> : list transition_item),
  finite_valid_trace_init_to_emit s0 s om tl</div></blockquote><div class="alectryon-extra-goals"><input class="alectryon-extra-goal-toggle" id="VLSM-v-chk266" style="display: none" type="checkbox"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>message</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>X</var><span class="hyp-type"><b>: </b><span>VLSM message</span></span></span><br><span><var>TypeX</var><span><span class="hyp-body"><b>:= </b><span>type X</span></span><span class="hyp-type"><b>: </b><span>VLSMType message</span></span></span></span><br><span><var>MachineX</var><span><span class="hyp-body"><b>:= </b><span>machine X</span></span><span class="hyp-type"><b>: </b><span>VLSMMachine (vtype X)</span></span></span></span><br><span><var>s</var><span class="hyp-type"><b>: </b><span>state</span></span></span><br><span><var>_om</var><span class="hyp-type"><b>: </b><span>option message</span></span></span><br><span><var>Hp1</var><span class="hyp-type"><b>: </b><span>valid_state_message_prop s _om</span></span></span><br><span><var>_s</var><span class="hyp-type"><b>: </b><span>state</span></span></span><br><span><var>om</var><span class="hyp-type"><b>: </b><span>option message</span></span></span><br><span><var>Hp2</var><span class="hyp-type"><b>: </b><span>valid_state_message_prop _s om</span></span></span><br><span><var>l0</var><span class="hyp-type"><b>: </b><span>label</span></span></span><br><span><var>Hv</var><span class="hyp-type"><b>: </b><span>valid l0 (s, om)</span></span></span><br><span><var>s'</var><span class="hyp-type"><b>: </b><span>state</span></span></span><br><span><var>om'</var><span class="hyp-type"><b>: </b><span>option message</span></span></span><br><span><var>Ht</var><span class="hyp-type"><b>: </b><span>transition l0 (s, om) = (s&#39;, om&#39;)</span></span></span><br><span><var>IHHp1</var><span class="hyp-type"><b>: </b><span><span class="kr">‚àÉ</span> (<span class="nv">s0</span> : state) (<span class="nv">tl</span> : list transition_item),
  finite_valid_trace_init_to_emit s0 s _om tl</span></span></span><br><span><var>IHHp2</var><span class="hyp-type"><b>: </b><span><span class="kr">‚àÉ</span> (<span class="nv">s</span> : state) (<span class="nv">tl</span> : list transition_item),
  finite_valid_trace_init_to_emit s _s om tl</span></span></span><br></div><label class="goal-separator" for="VLSM-v-chk266"><hr></label><div class="goal-conclusion"><span class="kr">‚àÉ</span> (<span class="nv">s</span> : state) (<span class="nv">tl</span> : list transition_item),
  finite_valid_trace_init_to_emit s s&#39; om&#39; tl</div></blockquote></div></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">      </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="VLSM-v-chk267" style="display: none" type="checkbox"><label class="alectryon-input" for="VLSM-v-chk267">-</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>message</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>X</var><span class="hyp-type"><b>: </b><span>VLSM message</span></span></span><br><span><var>TypeX</var><span><span class="hyp-body"><b>:= </b><span>type X</span></span><span class="hyp-type"><b>: </b><span>VLSMType message</span></span></span></span><br><span><var>MachineX</var><span><span class="hyp-body"><b>:= </b><span>machine X</span></span><span class="hyp-type"><b>: </b><span>VLSMMachine (vtype X)</span></span></span></span><br><span><var>s</var><span class="hyp-type"><b>: </b><span>state</span></span></span><br><span><var>Hs</var><span class="hyp-type"><b>: </b><span>initial_state_prop s</span></span></span><br><span><var>om</var><span class="hyp-type"><b>: </b><span>option message</span></span></span><br><span><var>Hom</var><span class="hyp-type"><b>: </b><span>option_initial_message_prop om</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="kr">‚àÉ</span> (<span class="nv">s0</span> : state) (<span class="nv">tl</span> : list transition_item),
  finite_valid_trace_init_to_emit s0 s om tl</div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="VLSM-v-chk268" style="display: none" type="checkbox"><label class="alectryon-input" for="VLSM-v-chk268"><span class="kr">exists</span> <span class="nv">s</span>, [].</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>message</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>X</var><span class="hyp-type"><b>: </b><span>VLSM message</span></span></span><br><span><var>TypeX</var><span><span class="hyp-body"><b>:= </b><span>type X</span></span><span class="hyp-type"><b>: </b><span>VLSMType message</span></span></span></span><br><span><var>MachineX</var><span><span class="hyp-body"><b>:= </b><span>machine X</span></span><span class="hyp-type"><b>: </b><span>VLSMMachine (vtype X)</span></span></span></span><br><span><var>s</var><span class="hyp-type"><b>: </b><span>state</span></span></span><br><span><var>Hs</var><span class="hyp-type"><b>: </b><span>initial_state_prop s</span></span></span><br><span><var>om</var><span class="hyp-type"><b>: </b><span>option message</span></span></span><br><span><var>Hom</var><span class="hyp-type"><b>: </b><span>option_initial_message_prop om</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">finite_valid_trace_init_to_emit s s om []</div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="nb">constructor</span>; <span class="bp">assumption</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">      </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="VLSM-v-chk269" style="display: none" type="checkbox"><label class="alectryon-input" for="VLSM-v-chk269">-</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>message</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>X</var><span class="hyp-type"><b>: </b><span>VLSM message</span></span></span><br><span><var>TypeX</var><span><span class="hyp-body"><b>:= </b><span>type X</span></span><span class="hyp-type"><b>: </b><span>VLSMType message</span></span></span></span><br><span><var>MachineX</var><span><span class="hyp-body"><b>:= </b><span>machine X</span></span><span class="hyp-type"><b>: </b><span>VLSMMachine (vtype X)</span></span></span></span><br><span><var>s</var><span class="hyp-type"><b>: </b><span>state</span></span></span><br><span><var>_om</var><span class="hyp-type"><b>: </b><span>option message</span></span></span><br><span><var>Hp1</var><span class="hyp-type"><b>: </b><span>valid_state_message_prop s _om</span></span></span><br><span><var>_s</var><span class="hyp-type"><b>: </b><span>state</span></span></span><br><span><var>om</var><span class="hyp-type"><b>: </b><span>option message</span></span></span><br><span><var>Hp2</var><span class="hyp-type"><b>: </b><span>valid_state_message_prop _s om</span></span></span><br><span><var>l0</var><span class="hyp-type"><b>: </b><span>label</span></span></span><br><span><var>Hv</var><span class="hyp-type"><b>: </b><span>valid l0 (s, om)</span></span></span><br><span><var>s'</var><span class="hyp-type"><b>: </b><span>state</span></span></span><br><span><var>om'</var><span class="hyp-type"><b>: </b><span>option message</span></span></span><br><span><var>Ht</var><span class="hyp-type"><b>: </b><span>transition l0 (s, om) = (s&#39;, om&#39;)</span></span></span><br><span><var>IHHp1</var><span class="hyp-type"><b>: </b><span><span class="kr">‚àÉ</span> (<span class="nv">s0</span> : state) (<span class="nv">tl</span> : list transition_item),
  finite_valid_trace_init_to_emit s0 s _om tl</span></span></span><br><span><var>IHHp2</var><span class="hyp-type"><b>: </b><span><span class="kr">‚àÉ</span> (<span class="nv">s</span> : state) (<span class="nv">tl</span> : list transition_item),
  finite_valid_trace_init_to_emit s _s om tl</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="kr">‚àÉ</span> (<span class="nv">s</span> : state) (<span class="nv">tl</span> : list transition_item),
  finite_valid_trace_init_to_emit s s&#39; om&#39; tl</div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="VLSM-v-chk26a" style="display: none" type="checkbox"><label class="alectryon-input" for="VLSM-v-chk26a"><span class="nb">destruct</span> IHHp1 <span class="kr">as</span> [<span class="kr">is</span> [tl Hs]].</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>message</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>X</var><span class="hyp-type"><b>: </b><span>VLSM message</span></span></span><br><span><var>TypeX</var><span><span class="hyp-body"><b>:= </b><span>type X</span></span><span class="hyp-type"><b>: </b><span>VLSMType message</span></span></span></span><br><span><var>MachineX</var><span><span class="hyp-body"><b>:= </b><span>machine X</span></span><span class="hyp-type"><b>: </b><span>VLSMMachine (vtype X)</span></span></span></span><br><span><var>s</var><span class="hyp-type"><b>: </b><span>state</span></span></span><br><span><var>_om</var><span class="hyp-type"><b>: </b><span>option message</span></span></span><br><span><var>Hp1</var><span class="hyp-type"><b>: </b><span>valid_state_message_prop s _om</span></span></span><br><span><var>_s</var><span class="hyp-type"><b>: </b><span>state</span></span></span><br><span><var>om</var><span class="hyp-type"><b>: </b><span>option message</span></span></span><br><span><var>Hp2</var><span class="hyp-type"><b>: </b><span>valid_state_message_prop _s om</span></span></span><br><span><var>l0</var><span class="hyp-type"><b>: </b><span>label</span></span></span><br><span><var>Hv</var><span class="hyp-type"><b>: </b><span>valid l0 (s, om)</span></span></span><br><span><var>s'</var><span class="hyp-type"><b>: </b><span>state</span></span></span><br><span><var>om'</var><span class="hyp-type"><b>: </b><span>option message</span></span></span><br><span><var>Ht</var><span class="hyp-type"><b>: </b><span>transition l0 (s, om) = (s&#39;, om&#39;)</span></span></span><br><span><var>is</var><span class="hyp-type"><b>: </b><span>state</span></span></span><br><span><var>tl</var><span class="hyp-type"><b>: </b><span>list transition_item</span></span></span><br><span><var>Hs</var><span class="hyp-type"><b>: </b><span>finite_valid_trace_init_to_emit <span class="kr">is</span> s _om tl</span></span></span><br><span><var>IHHp2</var><span class="hyp-type"><b>: </b><span><span class="kr">‚àÉ</span> (<span class="nv">s</span> : state) (<span class="nv">tl</span> : list transition_item),
  finite_valid_trace_init_to_emit s _s om tl</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="kr">‚àÉ</span> (<span class="nv">s</span> : state) (<span class="nv">tl</span> : list transition_item),
  finite_valid_trace_init_to_emit s s&#39; om&#39; tl</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">        </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="VLSM-v-chk26b" style="display: none" type="checkbox"><label class="alectryon-input" for="VLSM-v-chk26b"><span class="nb">destruct</span> IHHp2 <span class="kr">as</span> [om_is [om_tl Hom]].</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>message</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>X</var><span class="hyp-type"><b>: </b><span>VLSM message</span></span></span><br><span><var>TypeX</var><span><span class="hyp-body"><b>:= </b><span>type X</span></span><span class="hyp-type"><b>: </b><span>VLSMType message</span></span></span></span><br><span><var>MachineX</var><span><span class="hyp-body"><b>:= </b><span>machine X</span></span><span class="hyp-type"><b>: </b><span>VLSMMachine (vtype X)</span></span></span></span><br><span><var>s</var><span class="hyp-type"><b>: </b><span>state</span></span></span><br><span><var>_om</var><span class="hyp-type"><b>: </b><span>option message</span></span></span><br><span><var>Hp1</var><span class="hyp-type"><b>: </b><span>valid_state_message_prop s _om</span></span></span><br><span><var>_s</var><span class="hyp-type"><b>: </b><span>state</span></span></span><br><span><var>om</var><span class="hyp-type"><b>: </b><span>option message</span></span></span><br><span><var>Hp2</var><span class="hyp-type"><b>: </b><span>valid_state_message_prop _s om</span></span></span><br><span><var>l0</var><span class="hyp-type"><b>: </b><span>label</span></span></span><br><span><var>Hv</var><span class="hyp-type"><b>: </b><span>valid l0 (s, om)</span></span></span><br><span><var>s'</var><span class="hyp-type"><b>: </b><span>state</span></span></span><br><span><var>om'</var><span class="hyp-type"><b>: </b><span>option message</span></span></span><br><span><var>Ht</var><span class="hyp-type"><b>: </b><span>transition l0 (s, om) = (s&#39;, om&#39;)</span></span></span><br><span><var>is</var><span class="hyp-type"><b>: </b><span>state</span></span></span><br><span><var>tl</var><span class="hyp-type"><b>: </b><span>list transition_item</span></span></span><br><span><var>Hs</var><span class="hyp-type"><b>: </b><span>finite_valid_trace_init_to_emit <span class="kr">is</span> s _om tl</span></span></span><br><span><var>om_is</var><span class="hyp-type"><b>: </b><span>state</span></span></span><br><span><var>om_tl</var><span class="hyp-type"><b>: </b><span>list transition_item</span></span></span><br><span><var>Hom</var><span class="hyp-type"><b>: </b><span>finite_valid_trace_init_to_emit om_is _s om
  om_tl</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="kr">‚àÉ</span> (<span class="nv">s</span> : state) (<span class="nv">tl</span> : list transition_item),
  finite_valid_trace_init_to_emit s s&#39; om&#39; tl</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">        </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="VLSM-v-chk26c" style="display: none" type="checkbox"><label class="alectryon-input" for="VLSM-v-chk26c"><span class="nb">eexists</span>; <span class="nb">eexists</span>.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>message</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>X</var><span class="hyp-type"><b>: </b><span>VLSM message</span></span></span><br><span><var>TypeX</var><span><span class="hyp-body"><b>:= </b><span>type X</span></span><span class="hyp-type"><b>: </b><span>VLSMType message</span></span></span></span><br><span><var>MachineX</var><span><span class="hyp-body"><b>:= </b><span>machine X</span></span><span class="hyp-type"><b>: </b><span>VLSMMachine (vtype X)</span></span></span></span><br><span><var>s</var><span class="hyp-type"><b>: </b><span>state</span></span></span><br><span><var>_om</var><span class="hyp-type"><b>: </b><span>option message</span></span></span><br><span><var>Hp1</var><span class="hyp-type"><b>: </b><span>valid_state_message_prop s _om</span></span></span><br><span><var>_s</var><span class="hyp-type"><b>: </b><span>state</span></span></span><br><span><var>om</var><span class="hyp-type"><b>: </b><span>option message</span></span></span><br><span><var>Hp2</var><span class="hyp-type"><b>: </b><span>valid_state_message_prop _s om</span></span></span><br><span><var>l0</var><span class="hyp-type"><b>: </b><span>label</span></span></span><br><span><var>Hv</var><span class="hyp-type"><b>: </b><span>valid l0 (s, om)</span></span></span><br><span><var>s'</var><span class="hyp-type"><b>: </b><span>state</span></span></span><br><span><var>om'</var><span class="hyp-type"><b>: </b><span>option message</span></span></span><br><span><var>Ht</var><span class="hyp-type"><b>: </b><span>transition l0 (s, om) = (s&#39;, om&#39;)</span></span></span><br><span><var>is</var><span class="hyp-type"><b>: </b><span>state</span></span></span><br><span><var>tl</var><span class="hyp-type"><b>: </b><span>list transition_item</span></span></span><br><span><var>Hs</var><span class="hyp-type"><b>: </b><span>finite_valid_trace_init_to_emit <span class="kr">is</span> s _om tl</span></span></span><br><span><var>om_is</var><span class="hyp-type"><b>: </b><span>state</span></span></span><br><span><var>om_tl</var><span class="hyp-type"><b>: </b><span>list transition_item</span></span></span><br><span><var>Hom</var><span class="hyp-type"><b>: </b><span>finite_valid_trace_init_to_emit om_is _s om
  om_tl</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">finite_valid_trace_init_to_emit <span class="nl">?s</span> s&#39; om&#39; <span class="nl">?tl</span></div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">        </span><span class="alectryon-sentence"><span class="alectryon-input"><span class="nb">apply</span>
          (finite_valid_trace_init_to_emit_extend _ _ _ _ Hs _ _ _ _ Hom _ Hv _ _ Ht).</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Qed</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
</span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="VLSM-v-chk26d" style="display: none" type="checkbox"><label class="alectryon-input" for="VLSM-v-chk26d"><span class="kn">Lemma</span> <span class="nf">finite_valid_trace_init_to_emit_forget_emit</span>
      (<span class="nv">s</span> <span class="nv">f</span> : state) (<span class="nv">_om</span> : option message) (<span class="nv">tl</span> : list transition_item)
      (<span class="nv">Htl</span> : finite_valid_trace_init_to_emit s f _om tl)
      : finite_valid_trace_init_to s f tl.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>message</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>X</var><span class="hyp-type"><b>: </b><span>VLSM message</span></span></span><br><span><var>TypeX</var><span><span class="hyp-body"><b>:= </b><span>type X</span></span><span class="hyp-type"><b>: </b><span>VLSMType message</span></span></span></span><br><span><var>MachineX</var><span><span class="hyp-body"><b>:= </b><span>machine X</span></span><span class="hyp-type"><b>: </b><span>VLSMMachine (vtype X)</span></span></span></span><br><span><var>s, f</var><span class="hyp-type"><b>: </b><span>state</span></span></span><br><span><var>_om</var><span class="hyp-type"><b>: </b><span>option message</span></span></span><br><span><var>tl</var><span class="hyp-type"><b>: </b><span>list transition_item</span></span></span><br><span><var>Htl</var><span class="hyp-type"><b>: </b><span>finite_valid_trace_init_to_emit s f _om tl</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">finite_valid_trace_init_to s f tl</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="VLSM-v-chk26e" style="display: none" type="checkbox"><label class="alectryon-input" for="VLSM-v-chk26e"><span class="kn">Proof</span>.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>message</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>X</var><span class="hyp-type"><b>: </b><span>VLSM message</span></span></span><br><span><var>TypeX</var><span><span class="hyp-body"><b>:= </b><span>type X</span></span><span class="hyp-type"><b>: </b><span>VLSMType message</span></span></span></span><br><span><var>MachineX</var><span><span class="hyp-body"><b>:= </b><span>machine X</span></span><span class="hyp-type"><b>: </b><span>VLSMMachine (vtype X)</span></span></span></span><br><span><var>s, f</var><span class="hyp-type"><b>: </b><span>state</span></span></span><br><span><var>_om</var><span class="hyp-type"><b>: </b><span>option message</span></span></span><br><span><var>tl</var><span class="hyp-type"><b>: </b><span>list transition_item</span></span></span><br><span><var>Htl</var><span class="hyp-type"><b>: </b><span>finite_valid_trace_init_to_emit s f _om tl</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">finite_valid_trace_init_to s f tl</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">      </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="VLSM-v-chk26f" style="display: none" type="checkbox"><label class="alectryon-input" for="VLSM-v-chk26f"><span class="nb">apply</span> finite_valid_trace_init_to_emit_initial_state <span class="kr">in</span> Htl <span class="kr">as</span> Hinit.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>message</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>X</var><span class="hyp-type"><b>: </b><span>VLSM message</span></span></span><br><span><var>TypeX</var><span><span class="hyp-body"><b>:= </b><span>type X</span></span><span class="hyp-type"><b>: </b><span>VLSMType message</span></span></span></span><br><span><var>MachineX</var><span><span class="hyp-body"><b>:= </b><span>machine X</span></span><span class="hyp-type"><b>: </b><span>VLSMMachine (vtype X)</span></span></span></span><br><span><var>s, f</var><span class="hyp-type"><b>: </b><span>state</span></span></span><br><span><var>_om</var><span class="hyp-type"><b>: </b><span>option message</span></span></span><br><span><var>tl</var><span class="hyp-type"><b>: </b><span>list transition_item</span></span></span><br><span><var>Htl</var><span class="hyp-type"><b>: </b><span>finite_valid_trace_init_to_emit s f _om tl</span></span></span><br><span><var>Hinit</var><span class="hyp-type"><b>: </b><span>initial_state_prop s</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">finite_valid_trace_init_to s f tl</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">      </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="VLSM-v-chk270" style="display: none" type="checkbox"><label class="alectryon-input" for="VLSM-v-chk270"><span class="nb">split</span>; [|<span class="bp">assumption</span>].</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>message</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>X</var><span class="hyp-type"><b>: </b><span>VLSM message</span></span></span><br><span><var>TypeX</var><span><span class="hyp-body"><b>:= </b><span>type X</span></span><span class="hyp-type"><b>: </b><span>VLSMType message</span></span></span></span><br><span><var>MachineX</var><span><span class="hyp-body"><b>:= </b><span>machine X</span></span><span class="hyp-type"><b>: </b><span>VLSMMachine (vtype X)</span></span></span></span><br><span><var>s, f</var><span class="hyp-type"><b>: </b><span>state</span></span></span><br><span><var>_om</var><span class="hyp-type"><b>: </b><span>option message</span></span></span><br><span><var>tl</var><span class="hyp-type"><b>: </b><span>list transition_item</span></span></span><br><span><var>Htl</var><span class="hyp-type"><b>: </b><span>finite_valid_trace_init_to_emit s f _om tl</span></span></span><br><span><var>Hinit</var><span class="hyp-type"><b>: </b><span>initial_state_prop s</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">finite_valid_trace_from_to s f tl</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">      </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="VLSM-v-chk271" style="display: none" type="checkbox"><label class="alectryon-input" for="VLSM-v-chk271"><span class="nb">clear</span> Hinit.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>message</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>X</var><span class="hyp-type"><b>: </b><span>VLSM message</span></span></span><br><span><var>TypeX</var><span><span class="hyp-body"><b>:= </b><span>type X</span></span><span class="hyp-type"><b>: </b><span>VLSMType message</span></span></span></span><br><span><var>MachineX</var><span><span class="hyp-body"><b>:= </b><span>machine X</span></span><span class="hyp-type"><b>: </b><span>VLSMMachine (vtype X)</span></span></span></span><br><span><var>s, f</var><span class="hyp-type"><b>: </b><span>state</span></span></span><br><span><var>_om</var><span class="hyp-type"><b>: </b><span>option message</span></span></span><br><span><var>tl</var><span class="hyp-type"><b>: </b><span>list transition_item</span></span></span><br><span><var>Htl</var><span class="hyp-type"><b>: </b><span>finite_valid_trace_init_to_emit s f _om tl</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">finite_valid_trace_from_to s f tl</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">      </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="VLSM-v-chk272" style="display: none" type="checkbox"><label class="alectryon-input" for="VLSM-v-chk272"><span class="nb">induction</span> Htl.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>message</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>X</var><span class="hyp-type"><b>: </b><span>VLSM message</span></span></span><br><span><var>TypeX</var><span><span class="hyp-body"><b>:= </b><span>type X</span></span><span class="hyp-type"><b>: </b><span>VLSMType message</span></span></span></span><br><span><var>MachineX</var><span><span class="hyp-body"><b>:= </b><span>machine X</span></span><span class="hyp-type"><b>: </b><span>VLSMMachine (vtype X)</span></span></span></span><br><span><var>is</var><span class="hyp-type"><b>: </b><span>state</span></span></span><br><span><var>om</var><span class="hyp-type"><b>: </b><span>option message</span></span></span><br><span><var>His</var><span class="hyp-type"><b>: </b><span>initial_state_prop <span class="kr">is</span></span></span></span><br><span><var>Him</var><span class="hyp-type"><b>: </b><span>option_initial_message_prop om</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">finite_valid_trace_from_to <span class="kr">is</span> <span class="kr">is</span> []</div></blockquote><div class="alectryon-extra-goals"><input class="alectryon-extra-goal-toggle" id="VLSM-v-chk273" style="display: none" type="checkbox"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>message</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>X</var><span class="hyp-type"><b>: </b><span>VLSM message</span></span></span><br><span><var>TypeX</var><span><span class="hyp-body"><b>:= </b><span>type X</span></span><span class="hyp-type"><b>: </b><span>VLSMType message</span></span></span></span><br><span><var>MachineX</var><span><span class="hyp-body"><b>:= </b><span>machine X</span></span><span class="hyp-type"><b>: </b><span>VLSMMachine (vtype X)</span></span></span></span><br><span><var>is, s</var><span class="hyp-type"><b>: </b><span>state</span></span></span><br><span><var>_om</var><span class="hyp-type"><b>: </b><span>option message</span></span></span><br><span><var>tl</var><span class="hyp-type"><b>: </b><span>list transition_item</span></span></span><br><span><var>Htl1</var><span class="hyp-type"><b>: </b><span>finite_valid_trace_init_to_emit <span class="kr">is</span> s _om tl</span></span></span><br><span><var>iom_is, iom_s</var><span class="hyp-type"><b>: </b><span>state</span></span></span><br><span><var>iom</var><span class="hyp-type"><b>: </b><span>option message</span></span></span><br><span><var>iom_tl</var><span class="hyp-type"><b>: </b><span>list transition_item</span></span></span><br><span><var>Htl2</var><span class="hyp-type"><b>: </b><span>finite_valid_trace_init_to_emit iom_is iom_s
  iom iom_tl</span></span></span><br><span><var>l0</var><span class="hyp-type"><b>: </b><span>label</span></span></span><br><span><var>Hv</var><span class="hyp-type"><b>: </b><span>valid l0 (s, iom)</span></span></span><br><span><var>s'</var><span class="hyp-type"><b>: </b><span>state</span></span></span><br><span><var>oom</var><span class="hyp-type"><b>: </b><span>option message</span></span></span><br><span><var>Ht</var><span class="hyp-type"><b>: </b><span>transition l0 (s, iom) = (s&#39;, oom)</span></span></span><br><span><var>IHHtl1</var><span class="hyp-type"><b>: </b><span>finite_valid_trace_from_to <span class="kr">is</span> s tl</span></span></span><br><span><var>IHHtl2</var><span class="hyp-type"><b>: </b><span>finite_valid_trace_from_to iom_is iom_s
  iom_tl</span></span></span><br></div><label class="goal-separator" for="VLSM-v-chk273"><hr></label><div class="goal-conclusion">finite_valid_trace_from_to <span class="kr">is</span> s&#39;
  (tl ++
   [{|
      l := l0;
      input := iom;
      destination := s&#39;;
      output := oom
    |}])</div></blockquote></div></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">      </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="VLSM-v-chk274" style="display: none" type="checkbox"><label class="alectryon-input" for="VLSM-v-chk274">-</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>message</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>X</var><span class="hyp-type"><b>: </b><span>VLSM message</span></span></span><br><span><var>TypeX</var><span><span class="hyp-body"><b>:= </b><span>type X</span></span><span class="hyp-type"><b>: </b><span>VLSMType message</span></span></span></span><br><span><var>MachineX</var><span><span class="hyp-body"><b>:= </b><span>machine X</span></span><span class="hyp-type"><b>: </b><span>VLSMMachine (vtype X)</span></span></span></span><br><span><var>is</var><span class="hyp-type"><b>: </b><span>state</span></span></span><br><span><var>om</var><span class="hyp-type"><b>: </b><span>option message</span></span></span><br><span><var>His</var><span class="hyp-type"><b>: </b><span>initial_state_prop <span class="kr">is</span></span></span></span><br><span><var>Him</var><span class="hyp-type"><b>: </b><span>option_initial_message_prop om</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">finite_valid_trace_from_to <span class="kr">is</span> <span class="kr">is</span> []</div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="VLSM-v-chk275" style="display: none" type="checkbox"><label class="alectryon-input" for="VLSM-v-chk275"><span class="nb">constructor</span>.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>message</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>X</var><span class="hyp-type"><b>: </b><span>VLSM message</span></span></span><br><span><var>TypeX</var><span><span class="hyp-body"><b>:= </b><span>type X</span></span><span class="hyp-type"><b>: </b><span>VLSMType message</span></span></span></span><br><span><var>MachineX</var><span><span class="hyp-body"><b>:= </b><span>machine X</span></span><span class="hyp-type"><b>: </b><span>VLSMMachine (vtype X)</span></span></span></span><br><span><var>is</var><span class="hyp-type"><b>: </b><span>state</span></span></span><br><span><var>om</var><span class="hyp-type"><b>: </b><span>option message</span></span></span><br><span><var>His</var><span class="hyp-type"><b>: </b><span>initial_state_prop <span class="kr">is</span></span></span></span><br><span><var>Him</var><span class="hyp-type"><b>: </b><span>option_initial_message_prop om</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">valid_state_prop <span class="kr">is</span></div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="VLSM-v-chk276" style="display: none" type="checkbox"><label class="alectryon-input" for="VLSM-v-chk276"><span class="nb">apply</span> initial_state_is_valid.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>message</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>X</var><span class="hyp-type"><b>: </b><span>VLSM message</span></span></span><br><span><var>TypeX</var><span><span class="hyp-body"><b>:= </b><span>type X</span></span><span class="hyp-type"><b>: </b><span>VLSMType message</span></span></span></span><br><span><var>MachineX</var><span><span class="hyp-body"><b>:= </b><span>machine X</span></span><span class="hyp-type"><b>: </b><span>VLSMMachine (vtype X)</span></span></span></span><br><span><var>is</var><span class="hyp-type"><b>: </b><span>state</span></span></span><br><span><var>om</var><span class="hyp-type"><b>: </b><span>option message</span></span></span><br><span><var>His</var><span class="hyp-type"><b>: </b><span>initial_state_prop <span class="kr">is</span></span></span></span><br><span><var>Him</var><span class="hyp-type"><b>: </b><span>option_initial_message_prop om</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">initial_state_prop <span class="kr">is</span></div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="bp">assumption</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">      </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="VLSM-v-chk277" style="display: none" type="checkbox"><label class="alectryon-input" for="VLSM-v-chk277">-</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>message</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>X</var><span class="hyp-type"><b>: </b><span>VLSM message</span></span></span><br><span><var>TypeX</var><span><span class="hyp-body"><b>:= </b><span>type X</span></span><span class="hyp-type"><b>: </b><span>VLSMType message</span></span></span></span><br><span><var>MachineX</var><span><span class="hyp-body"><b>:= </b><span>machine X</span></span><span class="hyp-type"><b>: </b><span>VLSMMachine (vtype X)</span></span></span></span><br><span><var>is, s</var><span class="hyp-type"><b>: </b><span>state</span></span></span><br><span><var>_om</var><span class="hyp-type"><b>: </b><span>option message</span></span></span><br><span><var>tl</var><span class="hyp-type"><b>: </b><span>list transition_item</span></span></span><br><span><var>Htl1</var><span class="hyp-type"><b>: </b><span>finite_valid_trace_init_to_emit <span class="kr">is</span> s _om tl</span></span></span><br><span><var>iom_is, iom_s</var><span class="hyp-type"><b>: </b><span>state</span></span></span><br><span><var>iom</var><span class="hyp-type"><b>: </b><span>option message</span></span></span><br><span><var>iom_tl</var><span class="hyp-type"><b>: </b><span>list transition_item</span></span></span><br><span><var>Htl2</var><span class="hyp-type"><b>: </b><span>finite_valid_trace_init_to_emit iom_is iom_s
  iom iom_tl</span></span></span><br><span><var>l0</var><span class="hyp-type"><b>: </b><span>label</span></span></span><br><span><var>Hv</var><span class="hyp-type"><b>: </b><span>valid l0 (s, iom)</span></span></span><br><span><var>s'</var><span class="hyp-type"><b>: </b><span>state</span></span></span><br><span><var>oom</var><span class="hyp-type"><b>: </b><span>option message</span></span></span><br><span><var>Ht</var><span class="hyp-type"><b>: </b><span>transition l0 (s, iom) = (s&#39;, oom)</span></span></span><br><span><var>IHHtl1</var><span class="hyp-type"><b>: </b><span>finite_valid_trace_from_to <span class="kr">is</span> s tl</span></span></span><br><span><var>IHHtl2</var><span class="hyp-type"><b>: </b><span>finite_valid_trace_from_to iom_is iom_s
  iom_tl</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">finite_valid_trace_from_to <span class="kr">is</span> s&#39;
  (tl ++
   [{|
      l := l0;
      input := iom;
      destination := s&#39;;
      output := oom
    |}])</div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="VLSM-v-chk278" style="display: none" type="checkbox"><label class="alectryon-input" for="VLSM-v-chk278"><span class="nb">apply</span> finite_valid_trace_from_to_app <span class="kr">with</span> s; [<span class="bp">assumption</span>|].</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>message</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>X</var><span class="hyp-type"><b>: </b><span>VLSM message</span></span></span><br><span><var>TypeX</var><span><span class="hyp-body"><b>:= </b><span>type X</span></span><span class="hyp-type"><b>: </b><span>VLSMType message</span></span></span></span><br><span><var>MachineX</var><span><span class="hyp-body"><b>:= </b><span>machine X</span></span><span class="hyp-type"><b>: </b><span>VLSMMachine (vtype X)</span></span></span></span><br><span><var>is, s</var><span class="hyp-type"><b>: </b><span>state</span></span></span><br><span><var>_om</var><span class="hyp-type"><b>: </b><span>option message</span></span></span><br><span><var>tl</var><span class="hyp-type"><b>: </b><span>list transition_item</span></span></span><br><span><var>Htl1</var><span class="hyp-type"><b>: </b><span>finite_valid_trace_init_to_emit <span class="kr">is</span> s _om tl</span></span></span><br><span><var>iom_is, iom_s</var><span class="hyp-type"><b>: </b><span>state</span></span></span><br><span><var>iom</var><span class="hyp-type"><b>: </b><span>option message</span></span></span><br><span><var>iom_tl</var><span class="hyp-type"><b>: </b><span>list transition_item</span></span></span><br><span><var>Htl2</var><span class="hyp-type"><b>: </b><span>finite_valid_trace_init_to_emit iom_is iom_s
  iom iom_tl</span></span></span><br><span><var>l0</var><span class="hyp-type"><b>: </b><span>label</span></span></span><br><span><var>Hv</var><span class="hyp-type"><b>: </b><span>valid l0 (s, iom)</span></span></span><br><span><var>s'</var><span class="hyp-type"><b>: </b><span>state</span></span></span><br><span><var>oom</var><span class="hyp-type"><b>: </b><span>option message</span></span></span><br><span><var>Ht</var><span class="hyp-type"><b>: </b><span>transition l0 (s, iom) = (s&#39;, oom)</span></span></span><br><span><var>IHHtl1</var><span class="hyp-type"><b>: </b><span>finite_valid_trace_from_to <span class="kr">is</span> s tl</span></span></span><br><span><var>IHHtl2</var><span class="hyp-type"><b>: </b><span>finite_valid_trace_from_to iom_is iom_s
  iom_tl</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">finite_valid_trace_from_to s s&#39;
  [{|
     l := l0;
     input := iom;
     destination := s&#39;;
     output := oom
   |}]</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">        </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="VLSM-v-chk279" style="display: none" type="checkbox"><label class="alectryon-input" for="VLSM-v-chk279"><span class="nb">apply</span> finite_valid_trace_from_to_singleton.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>message</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>X</var><span class="hyp-type"><b>: </b><span>VLSM message</span></span></span><br><span><var>TypeX</var><span><span class="hyp-body"><b>:= </b><span>type X</span></span><span class="hyp-type"><b>: </b><span>VLSMType message</span></span></span></span><br><span><var>MachineX</var><span><span class="hyp-body"><b>:= </b><span>machine X</span></span><span class="hyp-type"><b>: </b><span>VLSMMachine (vtype X)</span></span></span></span><br><span><var>is, s</var><span class="hyp-type"><b>: </b><span>state</span></span></span><br><span><var>_om</var><span class="hyp-type"><b>: </b><span>option message</span></span></span><br><span><var>tl</var><span class="hyp-type"><b>: </b><span>list transition_item</span></span></span><br><span><var>Htl1</var><span class="hyp-type"><b>: </b><span>finite_valid_trace_init_to_emit <span class="kr">is</span> s _om tl</span></span></span><br><span><var>iom_is, iom_s</var><span class="hyp-type"><b>: </b><span>state</span></span></span><br><span><var>iom</var><span class="hyp-type"><b>: </b><span>option message</span></span></span><br><span><var>iom_tl</var><span class="hyp-type"><b>: </b><span>list transition_item</span></span></span><br><span><var>Htl2</var><span class="hyp-type"><b>: </b><span>finite_valid_trace_init_to_emit iom_is iom_s
  iom iom_tl</span></span></span><br><span><var>l0</var><span class="hyp-type"><b>: </b><span>label</span></span></span><br><span><var>Hv</var><span class="hyp-type"><b>: </b><span>valid l0 (s, iom)</span></span></span><br><span><var>s'</var><span class="hyp-type"><b>: </b><span>state</span></span></span><br><span><var>oom</var><span class="hyp-type"><b>: </b><span>option message</span></span></span><br><span><var>Ht</var><span class="hyp-type"><b>: </b><span>transition l0 (s, iom) = (s&#39;, oom)</span></span></span><br><span><var>IHHtl1</var><span class="hyp-type"><b>: </b><span>finite_valid_trace_from_to <span class="kr">is</span> s tl</span></span></span><br><span><var>IHHtl2</var><span class="hyp-type"><b>: </b><span>finite_valid_trace_from_to iom_is iom_s
  iom_tl</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">input_valid_transition l0 (s, iom) (s&#39;, oom)</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">        </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="VLSM-v-chk27a" style="display: none" type="checkbox"><label class="alectryon-input" for="VLSM-v-chk27a"><span class="nb">apply</span> finite_valid_trace_init_to_emit_valid_state_message <span class="kr">in</span> Htl1.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>message</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>X</var><span class="hyp-type"><b>: </b><span>VLSM message</span></span></span><br><span><var>TypeX</var><span><span class="hyp-body"><b>:= </b><span>type X</span></span><span class="hyp-type"><b>: </b><span>VLSMType message</span></span></span></span><br><span><var>MachineX</var><span><span class="hyp-body"><b>:= </b><span>machine X</span></span><span class="hyp-type"><b>: </b><span>VLSMMachine (vtype X)</span></span></span></span><br><span><var>is, s</var><span class="hyp-type"><b>: </b><span>state</span></span></span><br><span><var>_om</var><span class="hyp-type"><b>: </b><span>option message</span></span></span><br><span><var>tl</var><span class="hyp-type"><b>: </b><span>list transition_item</span></span></span><br><span><var>Htl1</var><span class="hyp-type"><b>: </b><span>valid_state_message_prop s _om</span></span></span><br><span><var>iom_is, iom_s</var><span class="hyp-type"><b>: </b><span>state</span></span></span><br><span><var>iom</var><span class="hyp-type"><b>: </b><span>option message</span></span></span><br><span><var>iom_tl</var><span class="hyp-type"><b>: </b><span>list transition_item</span></span></span><br><span><var>Htl2</var><span class="hyp-type"><b>: </b><span>finite_valid_trace_init_to_emit iom_is iom_s
  iom iom_tl</span></span></span><br><span><var>l0</var><span class="hyp-type"><b>: </b><span>label</span></span></span><br><span><var>Hv</var><span class="hyp-type"><b>: </b><span>valid l0 (s, iom)</span></span></span><br><span><var>s'</var><span class="hyp-type"><b>: </b><span>state</span></span></span><br><span><var>oom</var><span class="hyp-type"><b>: </b><span>option message</span></span></span><br><span><var>Ht</var><span class="hyp-type"><b>: </b><span>transition l0 (s, iom) = (s&#39;, oom)</span></span></span><br><span><var>IHHtl1</var><span class="hyp-type"><b>: </b><span>finite_valid_trace_from_to <span class="kr">is</span> s tl</span></span></span><br><span><var>IHHtl2</var><span class="hyp-type"><b>: </b><span>finite_valid_trace_from_to iom_is iom_s
  iom_tl</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">input_valid_transition l0 (s, iom) (s&#39;, oom)</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">        </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="VLSM-v-chk27b" style="display: none" type="checkbox"><label class="alectryon-input" for="VLSM-v-chk27b"><span class="nb">apply</span> finite_valid_trace_init_to_emit_valid_state_message <span class="kr">in</span> Htl2.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>message</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>X</var><span class="hyp-type"><b>: </b><span>VLSM message</span></span></span><br><span><var>TypeX</var><span><span class="hyp-body"><b>:= </b><span>type X</span></span><span class="hyp-type"><b>: </b><span>VLSMType message</span></span></span></span><br><span><var>MachineX</var><span><span class="hyp-body"><b>:= </b><span>machine X</span></span><span class="hyp-type"><b>: </b><span>VLSMMachine (vtype X)</span></span></span></span><br><span><var>is, s</var><span class="hyp-type"><b>: </b><span>state</span></span></span><br><span><var>_om</var><span class="hyp-type"><b>: </b><span>option message</span></span></span><br><span><var>tl</var><span class="hyp-type"><b>: </b><span>list transition_item</span></span></span><br><span><var>Htl1</var><span class="hyp-type"><b>: </b><span>valid_state_message_prop s _om</span></span></span><br><span><var>iom_is, iom_s</var><span class="hyp-type"><b>: </b><span>state</span></span></span><br><span><var>iom</var><span class="hyp-type"><b>: </b><span>option message</span></span></span><br><span><var>iom_tl</var><span class="hyp-type"><b>: </b><span>list transition_item</span></span></span><br><span><var>Htl2</var><span class="hyp-type"><b>: </b><span>valid_state_message_prop iom_s iom</span></span></span><br><span><var>l0</var><span class="hyp-type"><b>: </b><span>label</span></span></span><br><span><var>Hv</var><span class="hyp-type"><b>: </b><span>valid l0 (s, iom)</span></span></span><br><span><var>s'</var><span class="hyp-type"><b>: </b><span>state</span></span></span><br><span><var>oom</var><span class="hyp-type"><b>: </b><span>option message</span></span></span><br><span><var>Ht</var><span class="hyp-type"><b>: </b><span>transition l0 (s, iom) = (s&#39;, oom)</span></span></span><br><span><var>IHHtl1</var><span class="hyp-type"><b>: </b><span>finite_valid_trace_from_to <span class="kr">is</span> s tl</span></span></span><br><span><var>IHHtl2</var><span class="hyp-type"><b>: </b><span>finite_valid_trace_from_to iom_is iom_s
  iom_tl</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">input_valid_transition l0 (s, iom) (s&#39;, oom)</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">        </span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kp">repeat</span> <span class="nb">split</span>; [..|<span class="bp">assumption</span>|<span class="bp">assumption</span>]; <span class="nb">eexists</span>; [<span class="bp">exact</span> Htl1 | <span class="bp">exact</span> Htl2].</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Qed</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
</span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="VLSM-v-chk27c" style="display: none" type="checkbox"><label class="alectryon-input" for="VLSM-v-chk27c"><span class="kn">Lemma</span> <span class="nf">finite_valid_trace_init_to_add_emit</span>
      (<span class="nv">s</span> <span class="nv">f</span> : state) (<span class="nv">tl</span> : list transition_item)
      (<span class="nv">Htl</span> : finite_valid_trace_init_to s f tl)
      : finite_valid_trace_init_to_emit s f (finite_trace_last_output tl) tl.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>message</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>X</var><span class="hyp-type"><b>: </b><span>VLSM message</span></span></span><br><span><var>TypeX</var><span><span class="hyp-body"><b>:= </b><span>type X</span></span><span class="hyp-type"><b>: </b><span>VLSMType message</span></span></span></span><br><span><var>MachineX</var><span><span class="hyp-body"><b>:= </b><span>machine X</span></span><span class="hyp-type"><b>: </b><span>VLSMMachine (vtype X)</span></span></span></span><br><span><var>s, f</var><span class="hyp-type"><b>: </b><span>state</span></span></span><br><span><var>tl</var><span class="hyp-type"><b>: </b><span>list transition_item</span></span></span><br><span><var>Htl</var><span class="hyp-type"><b>: </b><span>finite_valid_trace_init_to s f tl</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">finite_valid_trace_init_to_emit s f
  (finite_trace_last_output tl) tl</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="VLSM-v-chk27d" style="display: none" type="checkbox"><label class="alectryon-input" for="VLSM-v-chk27d"><span class="kn">Proof</span>.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>message</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>X</var><span class="hyp-type"><b>: </b><span>VLSM message</span></span></span><br><span><var>TypeX</var><span><span class="hyp-body"><b>:= </b><span>type X</span></span><span class="hyp-type"><b>: </b><span>VLSMType message</span></span></span></span><br><span><var>MachineX</var><span><span class="hyp-body"><b>:= </b><span>machine X</span></span><span class="hyp-type"><b>: </b><span>VLSMMachine (vtype X)</span></span></span></span><br><span><var>s, f</var><span class="hyp-type"><b>: </b><span>state</span></span></span><br><span><var>tl</var><span class="hyp-type"><b>: </b><span>list transition_item</span></span></span><br><span><var>Htl</var><span class="hyp-type"><b>: </b><span>finite_valid_trace_init_to s f tl</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">finite_valid_trace_init_to_emit s f
  (finite_trace_last_output tl) tl</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">      </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="VLSM-v-chk27e" style="display: none" type="checkbox"><label class="alectryon-input" for="VLSM-v-chk27e"><span class="nb">induction</span> Htl <span class="nb">using</span> finite_valid_trace_init_to_rev_ind.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>message</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>X</var><span class="hyp-type"><b>: </b><span>VLSM message</span></span></span><br><span><var>TypeX</var><span><span class="hyp-body"><b>:= </b><span>type X</span></span><span class="hyp-type"><b>: </b><span>VLSMType message</span></span></span></span><br><span><var>MachineX</var><span><span class="hyp-body"><b>:= </b><span>machine X</span></span><span class="hyp-type"><b>: </b><span>VLSMMachine (vtype X)</span></span></span></span><br><span><var>si</var><span class="hyp-type"><b>: </b><span>state</span></span></span><br><span><var>Hsi</var><span class="hyp-type"><b>: </b><span>initial_state_prop si</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">finite_valid_trace_init_to_emit si si
  (finite_trace_last_output []) []</div></blockquote><div class="alectryon-extra-goals"><input class="alectryon-extra-goal-toggle" id="VLSM-v-chk27f" style="display: none" type="checkbox"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>message</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>X</var><span class="hyp-type"><b>: </b><span>VLSM message</span></span></span><br><span><var>TypeX</var><span><span class="hyp-body"><b>:= </b><span>type X</span></span><span class="hyp-type"><b>: </b><span>VLSMType message</span></span></span></span><br><span><var>MachineX</var><span><span class="hyp-body"><b>:= </b><span>machine X</span></span><span class="hyp-type"><b>: </b><span>VLSMMachine (vtype X)</span></span></span></span><br><span><var>si, s</var><span class="hyp-type"><b>: </b><span>state</span></span></span><br><span><var>tr</var><span class="hyp-type"><b>: </b><span>list transition_item</span></span></span><br><span><var>Htl</var><span class="hyp-type"><b>: </b><span>finite_valid_trace_init_to si s tr</span></span></span><br><span><var>sf</var><span class="hyp-type"><b>: </b><span>state</span></span></span><br><span><var>iom, oom</var><span class="hyp-type"><b>: </b><span>option message</span></span></span><br><span><var>l0</var><span class="hyp-type"><b>: </b><span>label</span></span></span><br><span><var>Ht</var><span class="hyp-type"><b>: </b><span>input_valid_transition l0 (s, iom) (sf, oom)</span></span></span><br><span><var>IHHtl</var><span class="hyp-type"><b>: </b><span>finite_valid_trace_init_to_emit si s
  (finite_trace_last_output tr) tr</span></span></span><br></div><label class="goal-separator" for="VLSM-v-chk27f"><hr></label><div class="goal-conclusion">finite_valid_trace_init_to_emit si sf
  (finite_trace_last_output
     (tr ++
      [{|
         l := l0;
         input := iom;
         destination := sf;
         output := oom
       |}]))
  (tr ++
   [{|
      l := l0;
      input := iom;
      destination := sf;
      output := oom
    |}])</div></blockquote></div></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">      </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="VLSM-v-chk280" style="display: none" type="checkbox"><label class="alectryon-input" for="VLSM-v-chk280">-</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>message</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>X</var><span class="hyp-type"><b>: </b><span>VLSM message</span></span></span><br><span><var>TypeX</var><span><span class="hyp-body"><b>:= </b><span>type X</span></span><span class="hyp-type"><b>: </b><span>VLSMType message</span></span></span></span><br><span><var>MachineX</var><span><span class="hyp-body"><b>:= </b><span>machine X</span></span><span class="hyp-type"><b>: </b><span>VLSMMachine (vtype X)</span></span></span></span><br><span><var>si</var><span class="hyp-type"><b>: </b><span>state</span></span></span><br><span><var>Hsi</var><span class="hyp-type"><b>: </b><span>initial_state_prop si</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">finite_valid_trace_init_to_emit si si
  (finite_trace_last_output []) []</div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="nb">constructor</span>; [<span class="bp">assumption</span> | <span class="bp">exact</span> I].</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">      </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="VLSM-v-chk281" style="display: none" type="checkbox"><label class="alectryon-input" for="VLSM-v-chk281">-</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>message</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>X</var><span class="hyp-type"><b>: </b><span>VLSM message</span></span></span><br><span><var>TypeX</var><span><span class="hyp-body"><b>:= </b><span>type X</span></span><span class="hyp-type"><b>: </b><span>VLSMType message</span></span></span></span><br><span><var>MachineX</var><span><span class="hyp-body"><b>:= </b><span>machine X</span></span><span class="hyp-type"><b>: </b><span>VLSMMachine (vtype X)</span></span></span></span><br><span><var>si, s</var><span class="hyp-type"><b>: </b><span>state</span></span></span><br><span><var>tr</var><span class="hyp-type"><b>: </b><span>list transition_item</span></span></span><br><span><var>Htl</var><span class="hyp-type"><b>: </b><span>finite_valid_trace_init_to si s tr</span></span></span><br><span><var>sf</var><span class="hyp-type"><b>: </b><span>state</span></span></span><br><span><var>iom, oom</var><span class="hyp-type"><b>: </b><span>option message</span></span></span><br><span><var>l0</var><span class="hyp-type"><b>: </b><span>label</span></span></span><br><span><var>Ht</var><span class="hyp-type"><b>: </b><span>input_valid_transition l0 (s, iom) (sf, oom)</span></span></span><br><span><var>IHHtl</var><span class="hyp-type"><b>: </b><span>finite_valid_trace_init_to_emit si s
  (finite_trace_last_output tr) tr</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">finite_valid_trace_init_to_emit si sf
  (finite_trace_last_output
     (tr ++
      [{|
         l := l0;
         input := iom;
         destination := sf;
         output := oom
       |}]))
  (tr ++
   [{|
      l := l0;
      input := iom;
      destination := sf;
      output := oom
    |}])</div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="VLSM-v-chk282" style="display: none" type="checkbox"><label class="alectryon-input" for="VLSM-v-chk282"><span class="nb">rewrite</span> finite_trace_last_output_is_last.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>message</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>X</var><span class="hyp-type"><b>: </b><span>VLSM message</span></span></span><br><span><var>TypeX</var><span><span class="hyp-body"><b>:= </b><span>type X</span></span><span class="hyp-type"><b>: </b><span>VLSMType message</span></span></span></span><br><span><var>MachineX</var><span><span class="hyp-body"><b>:= </b><span>machine X</span></span><span class="hyp-type"><b>: </b><span>VLSMMachine (vtype X)</span></span></span></span><br><span><var>si, s</var><span class="hyp-type"><b>: </b><span>state</span></span></span><br><span><var>tr</var><span class="hyp-type"><b>: </b><span>list transition_item</span></span></span><br><span><var>Htl</var><span class="hyp-type"><b>: </b><span>finite_valid_trace_init_to si s tr</span></span></span><br><span><var>sf</var><span class="hyp-type"><b>: </b><span>state</span></span></span><br><span><var>iom, oom</var><span class="hyp-type"><b>: </b><span>option message</span></span></span><br><span><var>l0</var><span class="hyp-type"><b>: </b><span>label</span></span></span><br><span><var>Ht</var><span class="hyp-type"><b>: </b><span>input_valid_transition l0 (s, iom) (sf, oom)</span></span></span><br><span><var>IHHtl</var><span class="hyp-type"><b>: </b><span>finite_valid_trace_init_to_emit si s
  (finite_trace_last_output tr) tr</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">finite_valid_trace_init_to_emit si sf
  (output
     {|
       l := l0;
       input := iom;
       destination := sf;
       output := oom
     |})
  (tr ++
   [{|
      l := l0;
      input := iom;
      destination := sf;
      output := oom
    |}])</div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="VLSM-v-chk283" style="display: none" type="checkbox"><label class="alectryon-input" for="VLSM-v-chk283"><span class="nb">simpl</span>.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>message</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>X</var><span class="hyp-type"><b>: </b><span>VLSM message</span></span></span><br><span><var>TypeX</var><span><span class="hyp-body"><b>:= </b><span>type X</span></span><span class="hyp-type"><b>: </b><span>VLSMType message</span></span></span></span><br><span><var>MachineX</var><span><span class="hyp-body"><b>:= </b><span>machine X</span></span><span class="hyp-type"><b>: </b><span>VLSMMachine (vtype X)</span></span></span></span><br><span><var>si, s</var><span class="hyp-type"><b>: </b><span>state</span></span></span><br><span><var>tr</var><span class="hyp-type"><b>: </b><span>list transition_item</span></span></span><br><span><var>Htl</var><span class="hyp-type"><b>: </b><span>finite_valid_trace_init_to si s tr</span></span></span><br><span><var>sf</var><span class="hyp-type"><b>: </b><span>state</span></span></span><br><span><var>iom, oom</var><span class="hyp-type"><b>: </b><span>option message</span></span></span><br><span><var>l0</var><span class="hyp-type"><b>: </b><span>label</span></span></span><br><span><var>Ht</var><span class="hyp-type"><b>: </b><span>input_valid_transition l0 (s, iom) (sf, oom)</span></span></span><br><span><var>IHHtl</var><span class="hyp-type"><b>: </b><span>finite_valid_trace_init_to_emit si s
  (finite_trace_last_output tr) tr</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">finite_valid_trace_init_to_emit si sf oom
  (tr ++
   [{|
      l := l0;
      input := iom;
      destination := sf;
      output := oom
    |}])</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">        </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="VLSM-v-chk284" style="display: none" type="checkbox"><label class="alectryon-input" for="VLSM-v-chk284"><span class="nb">destruct</span> Ht <span class="kr">as</span> [[_ [[_s Hiom] Hv]] Ht].</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>message</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>X</var><span class="hyp-type"><b>: </b><span>VLSM message</span></span></span><br><span><var>TypeX</var><span><span class="hyp-body"><b>:= </b><span>type X</span></span><span class="hyp-type"><b>: </b><span>VLSMType message</span></span></span></span><br><span><var>MachineX</var><span><span class="hyp-body"><b>:= </b><span>machine X</span></span><span class="hyp-type"><b>: </b><span>VLSMMachine (vtype X)</span></span></span></span><br><span><var>si, s</var><span class="hyp-type"><b>: </b><span>state</span></span></span><br><span><var>tr</var><span class="hyp-type"><b>: </b><span>list transition_item</span></span></span><br><span><var>Htl</var><span class="hyp-type"><b>: </b><span>finite_valid_trace_init_to si s tr</span></span></span><br><span><var>sf</var><span class="hyp-type"><b>: </b><span>state</span></span></span><br><span><var>iom, oom</var><span class="hyp-type"><b>: </b><span>option message</span></span></span><br><span><var>l0</var><span class="hyp-type"><b>: </b><span>label</span></span></span><br><span><var>_s</var><span class="hyp-type"><b>: </b><span>state</span></span></span><br><span><var>Hiom</var><span class="hyp-type"><b>: </b><span>valid_state_message_prop _s iom</span></span></span><br><span><var>Hv</var><span class="hyp-type"><b>: </b><span>valid l0 (s, iom)</span></span></span><br><span><var>Ht</var><span class="hyp-type"><b>: </b><span>transition l0 (s, iom) = (sf, oom)</span></span></span><br><span><var>IHHtl</var><span class="hyp-type"><b>: </b><span>finite_valid_trace_init_to_emit si s
  (finite_trace_last_output tr) tr</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">finite_valid_trace_init_to_emit si sf oom
  (tr ++
   [{|
      l := l0;
      input := iom;
      destination := sf;
      output := oom
    |}])</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">        </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="VLSM-v-chk285" style="display: none" type="checkbox"><label class="alectryon-input" for="VLSM-v-chk285"><span class="nb">specialize</span> (finite_valid_trace_init_to_emit_valid_state_message_rev _ _ Hiom) <span class="kr">as</span> [iom_s [iom_tr Hiom_tr]].</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>message</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>X</var><span class="hyp-type"><b>: </b><span>VLSM message</span></span></span><br><span><var>TypeX</var><span><span class="hyp-body"><b>:= </b><span>type X</span></span><span class="hyp-type"><b>: </b><span>VLSMType message</span></span></span></span><br><span><var>MachineX</var><span><span class="hyp-body"><b>:= </b><span>machine X</span></span><span class="hyp-type"><b>: </b><span>VLSMMachine (vtype X)</span></span></span></span><br><span><var>si, s</var><span class="hyp-type"><b>: </b><span>state</span></span></span><br><span><var>tr</var><span class="hyp-type"><b>: </b><span>list transition_item</span></span></span><br><span><var>Htl</var><span class="hyp-type"><b>: </b><span>finite_valid_trace_init_to si s tr</span></span></span><br><span><var>sf</var><span class="hyp-type"><b>: </b><span>state</span></span></span><br><span><var>iom, oom</var><span class="hyp-type"><b>: </b><span>option message</span></span></span><br><span><var>l0</var><span class="hyp-type"><b>: </b><span>label</span></span></span><br><span><var>_s</var><span class="hyp-type"><b>: </b><span>state</span></span></span><br><span><var>Hiom</var><span class="hyp-type"><b>: </b><span>valid_state_message_prop _s iom</span></span></span><br><span><var>Hv</var><span class="hyp-type"><b>: </b><span>valid l0 (s, iom)</span></span></span><br><span><var>Ht</var><span class="hyp-type"><b>: </b><span>transition l0 (s, iom) = (sf, oom)</span></span></span><br><span><var>IHHtl</var><span class="hyp-type"><b>: </b><span>finite_valid_trace_init_to_emit si s
  (finite_trace_last_output tr) tr</span></span></span><br><span><var>iom_s</var><span class="hyp-type"><b>: </b><span>state</span></span></span><br><span><var>iom_tr</var><span class="hyp-type"><b>: </b><span>list transition_item</span></span></span><br><span><var>Hiom_tr</var><span class="hyp-type"><b>: </b><span>finite_valid_trace_init_to_emit iom_s _s iom
  iom_tr</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">finite_valid_trace_init_to_emit si sf oom
  (tr ++
   [{|
      l := l0;
      input := iom;
      destination := sf;
      output := oom
    |}])</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">        </span><span class="alectryon-sentence"><span class="alectryon-input"><span class="nb">apply</span> (finite_valid_trace_init_to_emit_extend _ _ _ _ IHHtl _ _ _ _ Hiom_tr _ Hv _ _ Ht).</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Qed</span>.</span></span></pre><div class="doc">
Inspired by <span class="inlinecode"><span class="id" title="var">finite_valid_trace_init_to_add_emit</span></span>, we can derive
an induction principle for <span class="inlinecode"><span class="id" title="var">finite_valid_trace_init_to</span></span> stronger than
<span class="inlinecode"><span class="id" title="var">finite_valid_trace_init_to_rev_ind</span></span>, which allows the induction hypothesis
to be used for the trace generating the message received in the last transition.

</div><pre class="alectryon-io highlight"><!-- Generator: Alectryon --><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="VLSM-v-chk286" style="display: none" type="checkbox"><label class="alectryon-input" for="VLSM-v-chk286"><span class="kn">Lemma</span> <span class="nf">finite_valid_trace_init_to_rev_strong_ind</span>
      (<span class="nv">P</span> : state -&gt; state -&gt; list transition_item -&gt; <span class="kt">Prop</span>)
      (<span class="nv">Hempty</span>: <span class="kr">forall</span> <span class="nv">is</span>
        (<span class="nv">His</span> : initial_state_prop <span class="kr">is</span>),
        P <span class="kr">is</span> <span class="kr">is</span> nil)
      (<span class="nv">Hextend</span> : <span class="kr">forall</span> <span class="nv">is</span> <span class="nv">s</span> <span class="nv">tr</span>
        (<span class="nv">IHs</span> : P <span class="kr">is</span> s tr)
        (<span class="nv">Hs</span> : finite_valid_trace_init_to <span class="kr">is</span> s tr)
        <span class="nv">iom</span> <span class="nv">iom_si</span> <span class="nv">iom_s</span> <span class="nv">iom_tr</span>
        (<span class="nv">Heqiom</span> : empty_initial_message_or_final_output iom_tr iom)
        (<span class="nv">IHiom</span> : P iom_si iom_s iom_tr)
        (<span class="nv">Hiom</span> : finite_valid_trace_init_to iom_si iom_s iom_tr)
        <span class="nv">sf</span> <span class="nv">oom</span> <span class="nv">l</span>
        (<span class="nv">Ht</span> : input_valid_transition l (s,iom) (sf,oom)),
        P <span class="kr">is</span> sf (tr++[{|l:=l; input:=iom; destination:=sf; output:=oom|}]))
      : <span class="kr">forall</span> <span class="nv">si</span> <span class="nv">sf</span> <span class="nv">tr</span>,
        finite_valid_trace_init_to si sf tr -&gt;
        P si sf tr.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>message</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>X</var><span class="hyp-type"><b>: </b><span>VLSM message</span></span></span><br><span><var>TypeX</var><span><span class="hyp-body"><b>:= </b><span>type X</span></span><span class="hyp-type"><b>: </b><span>VLSMType message</span></span></span></span><br><span><var>MachineX</var><span><span class="hyp-body"><b>:= </b><span>machine X</span></span><span class="hyp-type"><b>: </b><span>VLSMMachine (vtype X)</span></span></span></span><br><span><var>P</var><span class="hyp-type"><b>: </b><span>state ‚Üí state ‚Üí list transition_item ‚Üí <span class="kt">Prop</span></span></span></span><br><span><var>Hempty</var><span class="hyp-type"><b>: </b><span><span class="kr">‚àÄ</span> <span class="nv">is</span> : state,
  initial_state_prop <span class="kr">is</span> ‚Üí P <span class="kr">is</span> <span class="kr">is</span> []</span></span></span><br><span><var>Hextend</var><span class="hyp-type"><b>: </b><span><span class="kr">‚àÄ</span> (<span class="nv">is</span> <span class="nv">s</span> : state) (<span class="nv">tr</span> : list transition_item),
  P <span class="kr">is</span> s tr
  ‚Üí finite_valid_trace_init_to <span class="kr">is</span> s tr
    ‚Üí <span class="kr">‚àÄ</span> (<span class="nv">iom</span> : option message) 
        (<span class="nv">iom_si</span> <span class="nv">iom_s</span> : state) 
        (<span class="nv">iom_tr</span> : list transition_item),
        empty_initial_message_or_final_output
          iom_tr iom
        ‚Üí P iom_si iom_s iom_tr
          ‚Üí finite_valid_trace_init_to
              iom_si iom_s iom_tr
            ‚Üí <span class="kr">‚àÄ</span> (<span class="nv">sf</span> : state) 
                (<span class="nv">oom</span> : 
                 option message) 
                (<span class="nv">l</span> : label),
                input_valid_transition l
                  (s, iom) 
                  (sf, oom)
                ‚Üí P <span class="kr">is</span> sf
                    (tr ++
                     [{|
                      l := l;
                      input := iom;
                      destination := sf;
                      output := oom
                      |}])</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="kr">‚àÄ</span> (<span class="nv">si</span> <span class="nv">sf</span> : state) (<span class="nv">tr</span> : list transition_item),
  finite_valid_trace_init_to si sf tr ‚Üí P si sf tr</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="VLSM-v-chk287" style="display: none" type="checkbox"><label class="alectryon-input" for="VLSM-v-chk287"><span class="kn">Proof</span>.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>message</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>X</var><span class="hyp-type"><b>: </b><span>VLSM message</span></span></span><br><span><var>TypeX</var><span><span class="hyp-body"><b>:= </b><span>type X</span></span><span class="hyp-type"><b>: </b><span>VLSMType message</span></span></span></span><br><span><var>MachineX</var><span><span class="hyp-body"><b>:= </b><span>machine X</span></span><span class="hyp-type"><b>: </b><span>VLSMMachine (vtype X)</span></span></span></span><br><span><var>P</var><span class="hyp-type"><b>: </b><span>state ‚Üí state ‚Üí list transition_item ‚Üí <span class="kt">Prop</span></span></span></span><br><span><var>Hempty</var><span class="hyp-type"><b>: </b><span><span class="kr">‚àÄ</span> <span class="nv">is</span> : state,
  initial_state_prop <span class="kr">is</span> ‚Üí P <span class="kr">is</span> <span class="kr">is</span> []</span></span></span><br><span><var>Hextend</var><span class="hyp-type"><b>: </b><span><span class="kr">‚àÄ</span> (<span class="nv">is</span> <span class="nv">s</span> : state) (<span class="nv">tr</span> : list transition_item),
  P <span class="kr">is</span> s tr
  ‚Üí finite_valid_trace_init_to <span class="kr">is</span> s tr
    ‚Üí <span class="kr">‚àÄ</span> (<span class="nv">iom</span> : option message) 
        (<span class="nv">iom_si</span> <span class="nv">iom_s</span> : state) 
        (<span class="nv">iom_tr</span> : list transition_item),
        empty_initial_message_or_final_output
          iom_tr iom
        ‚Üí P iom_si iom_s iom_tr
          ‚Üí finite_valid_trace_init_to
              iom_si iom_s iom_tr
            ‚Üí <span class="kr">‚àÄ</span> (<span class="nv">sf</span> : state) 
                (<span class="nv">oom</span> : 
                 option message) 
                (<span class="nv">l</span> : label),
                input_valid_transition l
                  (s, iom) 
                  (sf, oom)
                ‚Üí P <span class="kr">is</span> sf
                    (tr ++
                     [{|
                      l := l;
                      input := iom;
                      destination := sf;
                      output := oom
                      |}])</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="kr">‚àÄ</span> (<span class="nv">si</span> <span class="nv">sf</span> : state) (<span class="nv">tr</span> : list transition_item),
  finite_valid_trace_init_to si sf tr ‚Üí P si sf tr</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">      </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="VLSM-v-chk288" style="display: none" type="checkbox"><label class="alectryon-input" for="VLSM-v-chk288"><span class="nb">intros</span> <span class="kr">is</span> sf tr Htr.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>message</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>X</var><span class="hyp-type"><b>: </b><span>VLSM message</span></span></span><br><span><var>TypeX</var><span><span class="hyp-body"><b>:= </b><span>type X</span></span><span class="hyp-type"><b>: </b><span>VLSMType message</span></span></span></span><br><span><var>MachineX</var><span><span class="hyp-body"><b>:= </b><span>machine X</span></span><span class="hyp-type"><b>: </b><span>VLSMMachine (vtype X)</span></span></span></span><br><span><var>P</var><span class="hyp-type"><b>: </b><span>state ‚Üí state ‚Üí list transition_item ‚Üí <span class="kt">Prop</span></span></span></span><br><span><var>Hempty</var><span class="hyp-type"><b>: </b><span><span class="kr">‚àÄ</span> <span class="nv">is</span> : state,
  initial_state_prop <span class="kr">is</span> ‚Üí P <span class="kr">is</span> <span class="kr">is</span> []</span></span></span><br><span><var>Hextend</var><span class="hyp-type"><b>: </b><span><span class="kr">‚àÄ</span> (<span class="nv">is</span> <span class="nv">s</span> : state) (<span class="nv">tr</span> : list transition_item),
  P <span class="kr">is</span> s tr
  ‚Üí finite_valid_trace_init_to <span class="kr">is</span> s tr
    ‚Üí <span class="kr">‚àÄ</span> (<span class="nv">iom</span> : option message) 
        (<span class="nv">iom_si</span> <span class="nv">iom_s</span> : state) 
        (<span class="nv">iom_tr</span> : list transition_item),
        empty_initial_message_or_final_output
          iom_tr iom
        ‚Üí P iom_si iom_s iom_tr
          ‚Üí finite_valid_trace_init_to
              iom_si iom_s iom_tr
            ‚Üí <span class="kr">‚àÄ</span> (<span class="nv">sf</span> : state) 
                (<span class="nv">oom</span> : 
                 option message) 
                (<span class="nv">l</span> : label),
                input_valid_transition l
                  (s, iom) 
                  (sf, oom)
                ‚Üí P <span class="kr">is</span> sf
                    (tr ++
                     [{|
                      l := l;
                      input := iom;
                      destination := sf;
                      output := oom
                      |}])</span></span></span><br><span><var>is, sf</var><span class="hyp-type"><b>: </b><span>state</span></span></span><br><span><var>tr</var><span class="hyp-type"><b>: </b><span>list transition_item</span></span></span><br><span><var>Htr</var><span class="hyp-type"><b>: </b><span>finite_valid_trace_init_to <span class="kr">is</span> sf tr</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">P <span class="kr">is</span> sf tr</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">      </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="VLSM-v-chk289" style="display: none" type="checkbox"><label class="alectryon-input" for="VLSM-v-chk289"><span class="nb">apply</span> finite_valid_trace_init_to_add_emit <span class="kr">in</span> Htr.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>message</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>X</var><span class="hyp-type"><b>: </b><span>VLSM message</span></span></span><br><span><var>TypeX</var><span><span class="hyp-body"><b>:= </b><span>type X</span></span><span class="hyp-type"><b>: </b><span>VLSMType message</span></span></span></span><br><span><var>MachineX</var><span><span class="hyp-body"><b>:= </b><span>machine X</span></span><span class="hyp-type"><b>: </b><span>VLSMMachine (vtype X)</span></span></span></span><br><span><var>P</var><span class="hyp-type"><b>: </b><span>state ‚Üí state ‚Üí list transition_item ‚Üí <span class="kt">Prop</span></span></span></span><br><span><var>Hempty</var><span class="hyp-type"><b>: </b><span><span class="kr">‚àÄ</span> <span class="nv">is</span> : state,
  initial_state_prop <span class="kr">is</span> ‚Üí P <span class="kr">is</span> <span class="kr">is</span> []</span></span></span><br><span><var>Hextend</var><span class="hyp-type"><b>: </b><span><span class="kr">‚àÄ</span> (<span class="nv">is</span> <span class="nv">s</span> : state) (<span class="nv">tr</span> : list transition_item),
  P <span class="kr">is</span> s tr
  ‚Üí finite_valid_trace_init_to <span class="kr">is</span> s tr
    ‚Üí <span class="kr">‚àÄ</span> (<span class="nv">iom</span> : option message) 
        (<span class="nv">iom_si</span> <span class="nv">iom_s</span> : state) 
        (<span class="nv">iom_tr</span> : list transition_item),
        empty_initial_message_or_final_output
          iom_tr iom
        ‚Üí P iom_si iom_s iom_tr
          ‚Üí finite_valid_trace_init_to
              iom_si iom_s iom_tr
            ‚Üí <span class="kr">‚àÄ</span> (<span class="nv">sf</span> : state) 
                (<span class="nv">oom</span> : 
                 option message) 
                (<span class="nv">l</span> : label),
                input_valid_transition l
                  (s, iom) 
                  (sf, oom)
                ‚Üí P <span class="kr">is</span> sf
                    (tr ++
                     [{|
                      l := l;
                      input := iom;
                      destination := sf;
                      output := oom
                      |}])</span></span></span><br><span><var>is, sf</var><span class="hyp-type"><b>: </b><span>state</span></span></span><br><span><var>tr</var><span class="hyp-type"><b>: </b><span>list transition_item</span></span></span><br><span><var>Htr</var><span class="hyp-type"><b>: </b><span>finite_valid_trace_init_to_emit <span class="kr">is</span> sf
  (finite_trace_last_output tr) tr</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">P <span class="kr">is</span> sf tr</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">      </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="VLSM-v-chk28a" style="display: none" type="checkbox"><label class="alectryon-input" for="VLSM-v-chk28a"><span class="nb">remember</span> (finite_trace_last_output tr) <span class="kr">as</span> om.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>message</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>X</var><span class="hyp-type"><b>: </b><span>VLSM message</span></span></span><br><span><var>TypeX</var><span><span class="hyp-body"><b>:= </b><span>type X</span></span><span class="hyp-type"><b>: </b><span>VLSMType message</span></span></span></span><br><span><var>MachineX</var><span><span class="hyp-body"><b>:= </b><span>machine X</span></span><span class="hyp-type"><b>: </b><span>VLSMMachine (vtype X)</span></span></span></span><br><span><var>P</var><span class="hyp-type"><b>: </b><span>state ‚Üí state ‚Üí list transition_item ‚Üí <span class="kt">Prop</span></span></span></span><br><span><var>Hempty</var><span class="hyp-type"><b>: </b><span><span class="kr">‚àÄ</span> <span class="nv">is</span> : state,
  initial_state_prop <span class="kr">is</span> ‚Üí P <span class="kr">is</span> <span class="kr">is</span> []</span></span></span><br><span><var>Hextend</var><span class="hyp-type"><b>: </b><span><span class="kr">‚àÄ</span> (<span class="nv">is</span> <span class="nv">s</span> : state) (<span class="nv">tr</span> : list transition_item),
  P <span class="kr">is</span> s tr
  ‚Üí finite_valid_trace_init_to <span class="kr">is</span> s tr
    ‚Üí <span class="kr">‚àÄ</span> (<span class="nv">iom</span> : option message) 
        (<span class="nv">iom_si</span> <span class="nv">iom_s</span> : state) 
        (<span class="nv">iom_tr</span> : list transition_item),
        empty_initial_message_or_final_output
          iom_tr iom
        ‚Üí P iom_si iom_s iom_tr
          ‚Üí finite_valid_trace_init_to
              iom_si iom_s iom_tr
            ‚Üí <span class="kr">‚àÄ</span> (<span class="nv">sf</span> : state) 
                (<span class="nv">oom</span> : 
                 option message) 
                (<span class="nv">l</span> : label),
                input_valid_transition l
                  (s, iom) 
                  (sf, oom)
                ‚Üí P <span class="kr">is</span> sf
                    (tr ++
                     [{|
                      l := l;
                      input := iom;
                      destination := sf;
                      output := oom
                      |}])</span></span></span><br><span><var>is, sf</var><span class="hyp-type"><b>: </b><span>state</span></span></span><br><span><var>tr</var><span class="hyp-type"><b>: </b><span>list transition_item</span></span></span><br><span><var>om</var><span class="hyp-type"><b>: </b><span>option message</span></span></span><br><span><var>Heqom</var><span class="hyp-type"><b>: </b><span>om = finite_trace_last_output tr</span></span></span><br><span><var>Htr</var><span class="hyp-type"><b>: </b><span>finite_valid_trace_init_to_emit <span class="kr">is</span> sf om tr</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">P <span class="kr">is</span> sf tr</div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="VLSM-v-chk28b" style="display: none" type="checkbox"><label class="alectryon-input" for="VLSM-v-chk28b"><span class="nb">clear</span> Heqom.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>message</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>X</var><span class="hyp-type"><b>: </b><span>VLSM message</span></span></span><br><span><var>TypeX</var><span><span class="hyp-body"><b>:= </b><span>type X</span></span><span class="hyp-type"><b>: </b><span>VLSMType message</span></span></span></span><br><span><var>MachineX</var><span><span class="hyp-body"><b>:= </b><span>machine X</span></span><span class="hyp-type"><b>: </b><span>VLSMMachine (vtype X)</span></span></span></span><br><span><var>P</var><span class="hyp-type"><b>: </b><span>state ‚Üí state ‚Üí list transition_item ‚Üí <span class="kt">Prop</span></span></span></span><br><span><var>Hempty</var><span class="hyp-type"><b>: </b><span><span class="kr">‚àÄ</span> <span class="nv">is</span> : state,
  initial_state_prop <span class="kr">is</span> ‚Üí P <span class="kr">is</span> <span class="kr">is</span> []</span></span></span><br><span><var>Hextend</var><span class="hyp-type"><b>: </b><span><span class="kr">‚àÄ</span> (<span class="nv">is</span> <span class="nv">s</span> : state) (<span class="nv">tr</span> : list transition_item),
  P <span class="kr">is</span> s tr
  ‚Üí finite_valid_trace_init_to <span class="kr">is</span> s tr
    ‚Üí <span class="kr">‚àÄ</span> (<span class="nv">iom</span> : option message) 
        (<span class="nv">iom_si</span> <span class="nv">iom_s</span> : state) 
        (<span class="nv">iom_tr</span> : list transition_item),
        empty_initial_message_or_final_output
          iom_tr iom
        ‚Üí P iom_si iom_s iom_tr
          ‚Üí finite_valid_trace_init_to
              iom_si iom_s iom_tr
            ‚Üí <span class="kr">‚àÄ</span> (<span class="nv">sf</span> : state) 
                (<span class="nv">oom</span> : 
                 option message) 
                (<span class="nv">l</span> : label),
                input_valid_transition l
                  (s, iom) 
                  (sf, oom)
                ‚Üí P <span class="kr">is</span> sf
                    (tr ++
                     [{|
                      l := l;
                      input := iom;
                      destination := sf;
                      output := oom
                      |}])</span></span></span><br><span><var>is, sf</var><span class="hyp-type"><b>: </b><span>state</span></span></span><br><span><var>tr</var><span class="hyp-type"><b>: </b><span>list transition_item</span></span></span><br><span><var>om</var><span class="hyp-type"><b>: </b><span>option message</span></span></span><br><span><var>Htr</var><span class="hyp-type"><b>: </b><span>finite_valid_trace_init_to_emit <span class="kr">is</span> sf om tr</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">P <span class="kr">is</span> sf tr</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">      </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="VLSM-v-chk28c" style="display: none" type="checkbox"><label class="alectryon-input" for="VLSM-v-chk28c"><span class="nb">induction</span> Htr.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>message</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>X</var><span class="hyp-type"><b>: </b><span>VLSM message</span></span></span><br><span><var>TypeX</var><span><span class="hyp-body"><b>:= </b><span>type X</span></span><span class="hyp-type"><b>: </b><span>VLSMType message</span></span></span></span><br><span><var>MachineX</var><span><span class="hyp-body"><b>:= </b><span>machine X</span></span><span class="hyp-type"><b>: </b><span>VLSMMachine (vtype X)</span></span></span></span><br><span><var>P</var><span class="hyp-type"><b>: </b><span>state ‚Üí state ‚Üí list transition_item ‚Üí <span class="kt">Prop</span></span></span></span><br><span><var>Hempty</var><span class="hyp-type"><b>: </b><span><span class="kr">‚àÄ</span> <span class="nv">is</span> : state,
  initial_state_prop <span class="kr">is</span> ‚Üí P <span class="kr">is</span> <span class="kr">is</span> []</span></span></span><br><span><var>Hextend</var><span class="hyp-type"><b>: </b><span><span class="kr">‚àÄ</span> (<span class="nv">is</span> <span class="nv">s</span> : state) (<span class="nv">tr</span> : list transition_item),
  P <span class="kr">is</span> s tr
  ‚Üí finite_valid_trace_init_to <span class="kr">is</span> s tr
    ‚Üí <span class="kr">‚àÄ</span> (<span class="nv">iom</span> : option message) 
        (<span class="nv">iom_si</span> <span class="nv">iom_s</span> : state) 
        (<span class="nv">iom_tr</span> : list transition_item),
        empty_initial_message_or_final_output
          iom_tr iom
        ‚Üí P iom_si iom_s iom_tr
          ‚Üí finite_valid_trace_init_to
              iom_si iom_s iom_tr
            ‚Üí <span class="kr">‚àÄ</span> (<span class="nv">sf</span> : state) 
                (<span class="nv">oom</span> : 
                 option message) 
                (<span class="nv">l</span> : label),
                input_valid_transition l
                  (s, iom) 
                  (sf, oom)
                ‚Üí P <span class="kr">is</span> sf
                    (tr ++
                     [{|
                      l := l;
                      input := iom;
                      destination := sf;
                      output := oom
                      |}])</span></span></span><br><span><var>is</var><span class="hyp-type"><b>: </b><span>state</span></span></span><br><span><var>om</var><span class="hyp-type"><b>: </b><span>option message</span></span></span><br><span><var>His</var><span class="hyp-type"><b>: </b><span>initial_state_prop <span class="kr">is</span></span></span></span><br><span><var>Him</var><span class="hyp-type"><b>: </b><span>option_initial_message_prop om</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">P <span class="kr">is</span> <span class="kr">is</span> []</div></blockquote><div class="alectryon-extra-goals"><input class="alectryon-extra-goal-toggle" id="VLSM-v-chk28d" style="display: none" type="checkbox"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>message</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>X</var><span class="hyp-type"><b>: </b><span>VLSM message</span></span></span><br><span><var>TypeX</var><span><span class="hyp-body"><b>:= </b><span>type X</span></span><span class="hyp-type"><b>: </b><span>VLSMType message</span></span></span></span><br><span><var>MachineX</var><span><span class="hyp-body"><b>:= </b><span>machine X</span></span><span class="hyp-type"><b>: </b><span>VLSMMachine (vtype X)</span></span></span></span><br><span><var>P</var><span class="hyp-type"><b>: </b><span>state ‚Üí state ‚Üí list transition_item ‚Üí <span class="kt">Prop</span></span></span></span><br><span><var>Hempty</var><span class="hyp-type"><b>: </b><span><span class="kr">‚àÄ</span> <span class="nv">is</span> : state,
  initial_state_prop <span class="kr">is</span> ‚Üí P <span class="kr">is</span> <span class="kr">is</span> []</span></span></span><br><span><var>Hextend</var><span class="hyp-type"><b>: </b><span><span class="kr">‚àÄ</span> (<span class="nv">is</span> <span class="nv">s</span> : state) (<span class="nv">tr</span> : list transition_item),
  P <span class="kr">is</span> s tr
  ‚Üí finite_valid_trace_init_to <span class="kr">is</span> s tr
    ‚Üí <span class="kr">‚àÄ</span> (<span class="nv">iom</span> : option message) 
        (<span class="nv">iom_si</span> <span class="nv">iom_s</span> : state) 
        (<span class="nv">iom_tr</span> : list transition_item),
        empty_initial_message_or_final_output
          iom_tr iom
        ‚Üí P iom_si iom_s iom_tr
          ‚Üí finite_valid_trace_init_to
              iom_si iom_s iom_tr
            ‚Üí <span class="kr">‚àÄ</span> (<span class="nv">sf</span> : state) 
                (<span class="nv">oom</span> : 
                 option message) 
                (<span class="nv">l</span> : label),
                input_valid_transition l
                  (s, iom) 
                  (sf, oom)
                ‚Üí P <span class="kr">is</span> sf
                    (tr ++
                     [{|
                      l := l;
                      input := iom;
                      destination := sf;
                      output := oom
                      |}])</span></span></span><br><span><var>is, s</var><span class="hyp-type"><b>: </b><span>state</span></span></span><br><span><var>_om</var><span class="hyp-type"><b>: </b><span>option message</span></span></span><br><span><var>tl</var><span class="hyp-type"><b>: </b><span>list transition_item</span></span></span><br><span><var>Htr1</var><span class="hyp-type"><b>: </b><span>finite_valid_trace_init_to_emit <span class="kr">is</span> s _om tl</span></span></span><br><span><var>iom_is, iom_s</var><span class="hyp-type"><b>: </b><span>state</span></span></span><br><span><var>iom</var><span class="hyp-type"><b>: </b><span>option message</span></span></span><br><span><var>iom_tl</var><span class="hyp-type"><b>: </b><span>list transition_item</span></span></span><br><span><var>Htr2</var><span class="hyp-type"><b>: </b><span>finite_valid_trace_init_to_emit iom_is iom_s
  iom iom_tl</span></span></span><br><span><var>l0</var><span class="hyp-type"><b>: </b><span>label</span></span></span><br><span><var>Hv</var><span class="hyp-type"><b>: </b><span>valid l0 (s, iom)</span></span></span><br><span><var>s'</var><span class="hyp-type"><b>: </b><span>state</span></span></span><br><span><var>oom</var><span class="hyp-type"><b>: </b><span>option message</span></span></span><br><span><var>Ht</var><span class="hyp-type"><b>: </b><span>transition l0 (s, iom) = (s&#39;, oom)</span></span></span><br><span><var>IHHtr1</var><span class="hyp-type"><b>: </b><span>P <span class="kr">is</span> s tl</span></span></span><br><span><var>IHHtr2</var><span class="hyp-type"><b>: </b><span>P iom_is iom_s iom_tl</span></span></span><br></div><label class="goal-separator" for="VLSM-v-chk28d"><hr></label><div class="goal-conclusion">P <span class="kr">is</span> s&#39;
  (tl ++
   [{|
      l := l0;
      input := iom;
      destination := s&#39;;
      output := oom
    |}])</div></blockquote></div></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">      </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="VLSM-v-chk28e" style="display: none" type="checkbox"><label class="alectryon-input" for="VLSM-v-chk28e">-</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>message</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>X</var><span class="hyp-type"><b>: </b><span>VLSM message</span></span></span><br><span><var>TypeX</var><span><span class="hyp-body"><b>:= </b><span>type X</span></span><span class="hyp-type"><b>: </b><span>VLSMType message</span></span></span></span><br><span><var>MachineX</var><span><span class="hyp-body"><b>:= </b><span>machine X</span></span><span class="hyp-type"><b>: </b><span>VLSMMachine (vtype X)</span></span></span></span><br><span><var>P</var><span class="hyp-type"><b>: </b><span>state ‚Üí state ‚Üí list transition_item ‚Üí <span class="kt">Prop</span></span></span></span><br><span><var>Hempty</var><span class="hyp-type"><b>: </b><span><span class="kr">‚àÄ</span> <span class="nv">is</span> : state,
  initial_state_prop <span class="kr">is</span> ‚Üí P <span class="kr">is</span> <span class="kr">is</span> []</span></span></span><br><span><var>Hextend</var><span class="hyp-type"><b>: </b><span><span class="kr">‚àÄ</span> (<span class="nv">is</span> <span class="nv">s</span> : state) (<span class="nv">tr</span> : list transition_item),
  P <span class="kr">is</span> s tr
  ‚Üí finite_valid_trace_init_to <span class="kr">is</span> s tr
    ‚Üí <span class="kr">‚àÄ</span> (<span class="nv">iom</span> : option message) 
        (<span class="nv">iom_si</span> <span class="nv">iom_s</span> : state) 
        (<span class="nv">iom_tr</span> : list transition_item),
        empty_initial_message_or_final_output
          iom_tr iom
        ‚Üí P iom_si iom_s iom_tr
          ‚Üí finite_valid_trace_init_to
              iom_si iom_s iom_tr
            ‚Üí <span class="kr">‚àÄ</span> (<span class="nv">sf</span> : state) 
                (<span class="nv">oom</span> : 
                 option message) 
                (<span class="nv">l</span> : label),
                input_valid_transition l
                  (s, iom) 
                  (sf, oom)
                ‚Üí P <span class="kr">is</span> sf
                    (tr ++
                     [{|
                      l := l;
                      input := iom;
                      destination := sf;
                      output := oom
                      |}])</span></span></span><br><span><var>is</var><span class="hyp-type"><b>: </b><span>state</span></span></span><br><span><var>om</var><span class="hyp-type"><b>: </b><span>option message</span></span></span><br><span><var>His</var><span class="hyp-type"><b>: </b><span>initial_state_prop <span class="kr">is</span></span></span></span><br><span><var>Him</var><span class="hyp-type"><b>: </b><span>option_initial_message_prop om</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">P <span class="kr">is</span> <span class="kr">is</span> []</div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="VLSM-v-chk28f" style="display: none" type="checkbox"><label class="alectryon-input" for="VLSM-v-chk28f"><span class="nb">apply</span> Hempty.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>message</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>X</var><span class="hyp-type"><b>: </b><span>VLSM message</span></span></span><br><span><var>TypeX</var><span><span class="hyp-body"><b>:= </b><span>type X</span></span><span class="hyp-type"><b>: </b><span>VLSMType message</span></span></span></span><br><span><var>MachineX</var><span><span class="hyp-body"><b>:= </b><span>machine X</span></span><span class="hyp-type"><b>: </b><span>VLSMMachine (vtype X)</span></span></span></span><br><span><var>P</var><span class="hyp-type"><b>: </b><span>state ‚Üí state ‚Üí list transition_item ‚Üí <span class="kt">Prop</span></span></span></span><br><span><var>Hempty</var><span class="hyp-type"><b>: </b><span><span class="kr">‚àÄ</span> <span class="nv">is</span> : state,
  initial_state_prop <span class="kr">is</span> ‚Üí P <span class="kr">is</span> <span class="kr">is</span> []</span></span></span><br><span><var>Hextend</var><span class="hyp-type"><b>: </b><span><span class="kr">‚àÄ</span> (<span class="nv">is</span> <span class="nv">s</span> : state) (<span class="nv">tr</span> : list transition_item),
  P <span class="kr">is</span> s tr
  ‚Üí finite_valid_trace_init_to <span class="kr">is</span> s tr
    ‚Üí <span class="kr">‚àÄ</span> (<span class="nv">iom</span> : option message) 
        (<span class="nv">iom_si</span> <span class="nv">iom_s</span> : state) 
        (<span class="nv">iom_tr</span> : list transition_item),
        empty_initial_message_or_final_output
          iom_tr iom
        ‚Üí P iom_si iom_s iom_tr
          ‚Üí finite_valid_trace_init_to
              iom_si iom_s iom_tr
            ‚Üí <span class="kr">‚àÄ</span> (<span class="nv">sf</span> : state) 
                (<span class="nv">oom</span> : 
                 option message) 
                (<span class="nv">l</span> : label),
                input_valid_transition l
                  (s, iom) 
                  (sf, oom)
                ‚Üí P <span class="kr">is</span> sf
                    (tr ++
                     [{|
                      l := l;
                      input := iom;
                      destination := sf;
                      output := oom
                      |}])</span></span></span><br><span><var>is</var><span class="hyp-type"><b>: </b><span>state</span></span></span><br><span><var>om</var><span class="hyp-type"><b>: </b><span>option message</span></span></span><br><span><var>His</var><span class="hyp-type"><b>: </b><span>initial_state_prop <span class="kr">is</span></span></span></span><br><span><var>Him</var><span class="hyp-type"><b>: </b><span>option_initial_message_prop om</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">initial_state_prop <span class="kr">is</span></div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="bp">assumption</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">      </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="VLSM-v-chk290" style="display: none" type="checkbox"><label class="alectryon-input" for="VLSM-v-chk290">-</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>message</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>X</var><span class="hyp-type"><b>: </b><span>VLSM message</span></span></span><br><span><var>TypeX</var><span><span class="hyp-body"><b>:= </b><span>type X</span></span><span class="hyp-type"><b>: </b><span>VLSMType message</span></span></span></span><br><span><var>MachineX</var><span><span class="hyp-body"><b>:= </b><span>machine X</span></span><span class="hyp-type"><b>: </b><span>VLSMMachine (vtype X)</span></span></span></span><br><span><var>P</var><span class="hyp-type"><b>: </b><span>state ‚Üí state ‚Üí list transition_item ‚Üí <span class="kt">Prop</span></span></span></span><br><span><var>Hempty</var><span class="hyp-type"><b>: </b><span><span class="kr">‚àÄ</span> <span class="nv">is</span> : state,
  initial_state_prop <span class="kr">is</span> ‚Üí P <span class="kr">is</span> <span class="kr">is</span> []</span></span></span><br><span><var>Hextend</var><span class="hyp-type"><b>: </b><span><span class="kr">‚àÄ</span> (<span class="nv">is</span> <span class="nv">s</span> : state) (<span class="nv">tr</span> : list transition_item),
  P <span class="kr">is</span> s tr
  ‚Üí finite_valid_trace_init_to <span class="kr">is</span> s tr
    ‚Üí <span class="kr">‚àÄ</span> (<span class="nv">iom</span> : option message) 
        (<span class="nv">iom_si</span> <span class="nv">iom_s</span> : state) 
        (<span class="nv">iom_tr</span> : list transition_item),
        empty_initial_message_or_final_output
          iom_tr iom
        ‚Üí P iom_si iom_s iom_tr
          ‚Üí finite_valid_trace_init_to
              iom_si iom_s iom_tr
            ‚Üí <span class="kr">‚àÄ</span> (<span class="nv">sf</span> : state) 
                (<span class="nv">oom</span> : 
                 option message) 
                (<span class="nv">l</span> : label),
                input_valid_transition l
                  (s, iom) 
                  (sf, oom)
                ‚Üí P <span class="kr">is</span> sf
                    (tr ++
                     [{|
                      l := l;
                      input := iom;
                      destination := sf;
                      output := oom
                      |}])</span></span></span><br><span><var>is, s</var><span class="hyp-type"><b>: </b><span>state</span></span></span><br><span><var>_om</var><span class="hyp-type"><b>: </b><span>option message</span></span></span><br><span><var>tl</var><span class="hyp-type"><b>: </b><span>list transition_item</span></span></span><br><span><var>Htr1</var><span class="hyp-type"><b>: </b><span>finite_valid_trace_init_to_emit <span class="kr">is</span> s _om tl</span></span></span><br><span><var>iom_is, iom_s</var><span class="hyp-type"><b>: </b><span>state</span></span></span><br><span><var>iom</var><span class="hyp-type"><b>: </b><span>option message</span></span></span><br><span><var>iom_tl</var><span class="hyp-type"><b>: </b><span>list transition_item</span></span></span><br><span><var>Htr2</var><span class="hyp-type"><b>: </b><span>finite_valid_trace_init_to_emit iom_is iom_s
  iom iom_tl</span></span></span><br><span><var>l0</var><span class="hyp-type"><b>: </b><span>label</span></span></span><br><span><var>Hv</var><span class="hyp-type"><b>: </b><span>valid l0 (s, iom)</span></span></span><br><span><var>s'</var><span class="hyp-type"><b>: </b><span>state</span></span></span><br><span><var>oom</var><span class="hyp-type"><b>: </b><span>option message</span></span></span><br><span><var>Ht</var><span class="hyp-type"><b>: </b><span>transition l0 (s, iom) = (s&#39;, oom)</span></span></span><br><span><var>IHHtr1</var><span class="hyp-type"><b>: </b><span>P <span class="kr">is</span> s tl</span></span></span><br><span><var>IHHtr2</var><span class="hyp-type"><b>: </b><span>P iom_is iom_s iom_tl</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">P <span class="kr">is</span> s&#39;
  (tl ++
   [{|
      l := l0;
      input := iom;
      destination := s&#39;;
      output := oom
    |}])</div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="VLSM-v-chk291" style="display: none" type="checkbox"><label class="alectryon-input" for="VLSM-v-chk291"><span class="nb">assert</span> (Hivt : input_valid_transition l0 (s, iom) (s&#39;, oom)).</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>message</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>X</var><span class="hyp-type"><b>: </b><span>VLSM message</span></span></span><br><span><var>TypeX</var><span><span class="hyp-body"><b>:= </b><span>type X</span></span><span class="hyp-type"><b>: </b><span>VLSMType message</span></span></span></span><br><span><var>MachineX</var><span><span class="hyp-body"><b>:= </b><span>machine X</span></span><span class="hyp-type"><b>: </b><span>VLSMMachine (vtype X)</span></span></span></span><br><span><var>P</var><span class="hyp-type"><b>: </b><span>state ‚Üí state ‚Üí list transition_item ‚Üí <span class="kt">Prop</span></span></span></span><br><span><var>Hempty</var><span class="hyp-type"><b>: </b><span><span class="kr">‚àÄ</span> <span class="nv">is</span> : state,
  initial_state_prop <span class="kr">is</span> ‚Üí P <span class="kr">is</span> <span class="kr">is</span> []</span></span></span><br><span><var>Hextend</var><span class="hyp-type"><b>: </b><span><span class="kr">‚àÄ</span> (<span class="nv">is</span> <span class="nv">s</span> : state) (<span class="nv">tr</span> : list transition_item),
  P <span class="kr">is</span> s tr
  ‚Üí finite_valid_trace_init_to <span class="kr">is</span> s tr
    ‚Üí <span class="kr">‚àÄ</span> (<span class="nv">iom</span> : option message) 
        (<span class="nv">iom_si</span> <span class="nv">iom_s</span> : state) 
        (<span class="nv">iom_tr</span> : list transition_item),
        empty_initial_message_or_final_output
          iom_tr iom
        ‚Üí P iom_si iom_s iom_tr
          ‚Üí finite_valid_trace_init_to
              iom_si iom_s iom_tr
            ‚Üí <span class="kr">‚àÄ</span> (<span class="nv">sf</span> : state) 
                (<span class="nv">oom</span> : 
                 option message) 
                (<span class="nv">l</span> : label),
                input_valid_transition l
                  (s, iom) 
                  (sf, oom)
                ‚Üí P <span class="kr">is</span> sf
                    (tr ++
                     [{|
                      l := l;
                      input := iom;
                      destination := sf;
                      output := oom
                      |}])</span></span></span><br><span><var>is, s</var><span class="hyp-type"><b>: </b><span>state</span></span></span><br><span><var>_om</var><span class="hyp-type"><b>: </b><span>option message</span></span></span><br><span><var>tl</var><span class="hyp-type"><b>: </b><span>list transition_item</span></span></span><br><span><var>Htr1</var><span class="hyp-type"><b>: </b><span>finite_valid_trace_init_to_emit <span class="kr">is</span> s _om tl</span></span></span><br><span><var>iom_is, iom_s</var><span class="hyp-type"><b>: </b><span>state</span></span></span><br><span><var>iom</var><span class="hyp-type"><b>: </b><span>option message</span></span></span><br><span><var>iom_tl</var><span class="hyp-type"><b>: </b><span>list transition_item</span></span></span><br><span><var>Htr2</var><span class="hyp-type"><b>: </b><span>finite_valid_trace_init_to_emit iom_is iom_s
  iom iom_tl</span></span></span><br><span><var>l0</var><span class="hyp-type"><b>: </b><span>label</span></span></span><br><span><var>Hv</var><span class="hyp-type"><b>: </b><span>valid l0 (s, iom)</span></span></span><br><span><var>s'</var><span class="hyp-type"><b>: </b><span>state</span></span></span><br><span><var>oom</var><span class="hyp-type"><b>: </b><span>option message</span></span></span><br><span><var>Ht</var><span class="hyp-type"><b>: </b><span>transition l0 (s, iom) = (s&#39;, oom)</span></span></span><br><span><var>IHHtr1</var><span class="hyp-type"><b>: </b><span>P <span class="kr">is</span> s tl</span></span></span><br><span><var>IHHtr2</var><span class="hyp-type"><b>: </b><span>P iom_is iom_s iom_tl</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">input_valid_transition l0 (s, iom) (s&#39;, oom)</div></blockquote><div class="alectryon-extra-goals"><input class="alectryon-extra-goal-toggle" id="VLSM-v-chk292" style="display: none" type="checkbox"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>message</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>X</var><span class="hyp-type"><b>: </b><span>VLSM message</span></span></span><br><span><var>TypeX</var><span><span class="hyp-body"><b>:= </b><span>type X</span></span><span class="hyp-type"><b>: </b><span>VLSMType message</span></span></span></span><br><span><var>MachineX</var><span><span class="hyp-body"><b>:= </b><span>machine X</span></span><span class="hyp-type"><b>: </b><span>VLSMMachine (vtype X)</span></span></span></span><br><span><var>P</var><span class="hyp-type"><b>: </b><span>state ‚Üí state ‚Üí list transition_item ‚Üí <span class="kt">Prop</span></span></span></span><br><span><var>Hempty</var><span class="hyp-type"><b>: </b><span><span class="kr">‚àÄ</span> <span class="nv">is</span> : state,
  initial_state_prop <span class="kr">is</span> ‚Üí P <span class="kr">is</span> <span class="kr">is</span> []</span></span></span><br><span><var>Hextend</var><span class="hyp-type"><b>: </b><span><span class="kr">‚àÄ</span> (<span class="nv">is</span> <span class="nv">s</span> : state) (<span class="nv">tr</span> : list transition_item),
  P <span class="kr">is</span> s tr
  ‚Üí finite_valid_trace_init_to <span class="kr">is</span> s tr
    ‚Üí <span class="kr">‚àÄ</span> (<span class="nv">iom</span> : option message) 
        (<span class="nv">iom_si</span> <span class="nv">iom_s</span> : state) 
        (<span class="nv">iom_tr</span> : list transition_item),
        empty_initial_message_or_final_output
          iom_tr iom
        ‚Üí P iom_si iom_s iom_tr
          ‚Üí finite_valid_trace_init_to
              iom_si iom_s iom_tr
            ‚Üí <span class="kr">‚àÄ</span> (<span class="nv">sf</span> : state) 
                (<span class="nv">oom</span> : 
                 option message) 
                (<span class="nv">l</span> : label),
                input_valid_transition l
                  (s, iom) 
                  (sf, oom)
                ‚Üí P <span class="kr">is</span> sf
                    (tr ++
                     [{|
                      l := l;
                      input := iom;
                      destination := sf;
                      output := oom
                      |}])</span></span></span><br><span><var>is, s</var><span class="hyp-type"><b>: </b><span>state</span></span></span><br><span><var>_om</var><span class="hyp-type"><b>: </b><span>option message</span></span></span><br><span><var>tl</var><span class="hyp-type"><b>: </b><span>list transition_item</span></span></span><br><span><var>Htr1</var><span class="hyp-type"><b>: </b><span>finite_valid_trace_init_to_emit <span class="kr">is</span> s _om tl</span></span></span><br><span><var>iom_is, iom_s</var><span class="hyp-type"><b>: </b><span>state</span></span></span><br><span><var>iom</var><span class="hyp-type"><b>: </b><span>option message</span></span></span><br><span><var>iom_tl</var><span class="hyp-type"><b>: </b><span>list transition_item</span></span></span><br><span><var>Htr2</var><span class="hyp-type"><b>: </b><span>finite_valid_trace_init_to_emit iom_is iom_s
  iom iom_tl</span></span></span><br><span><var>l0</var><span class="hyp-type"><b>: </b><span>label</span></span></span><br><span><var>Hv</var><span class="hyp-type"><b>: </b><span>valid l0 (s, iom)</span></span></span><br><span><var>s'</var><span class="hyp-type"><b>: </b><span>state</span></span></span><br><span><var>oom</var><span class="hyp-type"><b>: </b><span>option message</span></span></span><br><span><var>Ht</var><span class="hyp-type"><b>: </b><span>transition l0 (s, iom) = (s&#39;, oom)</span></span></span><br><span><var>IHHtr1</var><span class="hyp-type"><b>: </b><span>P <span class="kr">is</span> s tl</span></span></span><br><span><var>IHHtr2</var><span class="hyp-type"><b>: </b><span>P iom_is iom_s iom_tl</span></span></span><br><span><var>Hivt</var><span class="hyp-type"><b>: </b><span>input_valid_transition l0 (s, iom) (s&#39;, oom)</span></span></span><br></div><label class="goal-separator" for="VLSM-v-chk292"><hr></label><div class="goal-conclusion">P <span class="kr">is</span> s&#39;
  (tl ++
   [{|
      l := l0;
      input := iom;
      destination := s&#39;;
      output := oom
    |}])</div></blockquote></div></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">        </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="VLSM-v-chk293" style="display: none" type="checkbox"><label class="alectryon-input" for="VLSM-v-chk293">{</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>message</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>X</var><span class="hyp-type"><b>: </b><span>VLSM message</span></span></span><br><span><var>TypeX</var><span><span class="hyp-body"><b>:= </b><span>type X</span></span><span class="hyp-type"><b>: </b><span>VLSMType message</span></span></span></span><br><span><var>MachineX</var><span><span class="hyp-body"><b>:= </b><span>machine X</span></span><span class="hyp-type"><b>: </b><span>VLSMMachine (vtype X)</span></span></span></span><br><span><var>P</var><span class="hyp-type"><b>: </b><span>state ‚Üí state ‚Üí list transition_item ‚Üí <span class="kt">Prop</span></span></span></span><br><span><var>Hempty</var><span class="hyp-type"><b>: </b><span><span class="kr">‚àÄ</span> <span class="nv">is</span> : state,
  initial_state_prop <span class="kr">is</span> ‚Üí P <span class="kr">is</span> <span class="kr">is</span> []</span></span></span><br><span><var>Hextend</var><span class="hyp-type"><b>: </b><span><span class="kr">‚àÄ</span> (<span class="nv">is</span> <span class="nv">s</span> : state) (<span class="nv">tr</span> : list transition_item),
  P <span class="kr">is</span> s tr
  ‚Üí finite_valid_trace_init_to <span class="kr">is</span> s tr
    ‚Üí <span class="kr">‚àÄ</span> (<span class="nv">iom</span> : option message) 
        (<span class="nv">iom_si</span> <span class="nv">iom_s</span> : state) 
        (<span class="nv">iom_tr</span> : list transition_item),
        empty_initial_message_or_final_output
          iom_tr iom
        ‚Üí P iom_si iom_s iom_tr
          ‚Üí finite_valid_trace_init_to
              iom_si iom_s iom_tr
            ‚Üí <span class="kr">‚àÄ</span> (<span class="nv">sf</span> : state) 
                (<span class="nv">oom</span> : 
                 option message) 
                (<span class="nv">l</span> : label),
                input_valid_transition l
                  (s, iom) 
                  (sf, oom)
                ‚Üí P <span class="kr">is</span> sf
                    (tr ++
                     [{|
                      l := l;
                      input := iom;
                      destination := sf;
                      output := oom
                      |}])</span></span></span><br><span><var>is, s</var><span class="hyp-type"><b>: </b><span>state</span></span></span><br><span><var>_om</var><span class="hyp-type"><b>: </b><span>option message</span></span></span><br><span><var>tl</var><span class="hyp-type"><b>: </b><span>list transition_item</span></span></span><br><span><var>Htr1</var><span class="hyp-type"><b>: </b><span>finite_valid_trace_init_to_emit <span class="kr">is</span> s _om tl</span></span></span><br><span><var>iom_is, iom_s</var><span class="hyp-type"><b>: </b><span>state</span></span></span><br><span><var>iom</var><span class="hyp-type"><b>: </b><span>option message</span></span></span><br><span><var>iom_tl</var><span class="hyp-type"><b>: </b><span>list transition_item</span></span></span><br><span><var>Htr2</var><span class="hyp-type"><b>: </b><span>finite_valid_trace_init_to_emit iom_is iom_s
  iom iom_tl</span></span></span><br><span><var>l0</var><span class="hyp-type"><b>: </b><span>label</span></span></span><br><span><var>Hv</var><span class="hyp-type"><b>: </b><span>valid l0 (s, iom)</span></span></span><br><span><var>s'</var><span class="hyp-type"><b>: </b><span>state</span></span></span><br><span><var>oom</var><span class="hyp-type"><b>: </b><span>option message</span></span></span><br><span><var>Ht</var><span class="hyp-type"><b>: </b><span>transition l0 (s, iom) = (s&#39;, oom)</span></span></span><br><span><var>IHHtr1</var><span class="hyp-type"><b>: </b><span>P <span class="kr">is</span> s tl</span></span></span><br><span><var>IHHtr2</var><span class="hyp-type"><b>: </b><span>P iom_is iom_s iom_tl</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">input_valid_transition l0 (s, iom) (s&#39;, oom)</div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="VLSM-v-chk294" style="display: none" type="checkbox"><label class="alectryon-input" for="VLSM-v-chk294"><span class="nb">apply</span> finite_valid_trace_init_to_emit_valid_state_message <span class="kr">in</span> Htr1.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>message</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>X</var><span class="hyp-type"><b>: </b><span>VLSM message</span></span></span><br><span><var>TypeX</var><span><span class="hyp-body"><b>:= </b><span>type X</span></span><span class="hyp-type"><b>: </b><span>VLSMType message</span></span></span></span><br><span><var>MachineX</var><span><span class="hyp-body"><b>:= </b><span>machine X</span></span><span class="hyp-type"><b>: </b><span>VLSMMachine (vtype X)</span></span></span></span><br><span><var>P</var><span class="hyp-type"><b>: </b><span>state ‚Üí state ‚Üí list transition_item ‚Üí <span class="kt">Prop</span></span></span></span><br><span><var>Hempty</var><span class="hyp-type"><b>: </b><span><span class="kr">‚àÄ</span> <span class="nv">is</span> : state,
  initial_state_prop <span class="kr">is</span> ‚Üí P <span class="kr">is</span> <span class="kr">is</span> []</span></span></span><br><span><var>Hextend</var><span class="hyp-type"><b>: </b><span><span class="kr">‚àÄ</span> (<span class="nv">is</span> <span class="nv">s</span> : state) (<span class="nv">tr</span> : list transition_item),
  P <span class="kr">is</span> s tr
  ‚Üí finite_valid_trace_init_to <span class="kr">is</span> s tr
    ‚Üí <span class="kr">‚àÄ</span> (<span class="nv">iom</span> : option message) 
        (<span class="nv">iom_si</span> <span class="nv">iom_s</span> : state) 
        (<span class="nv">iom_tr</span> : list transition_item),
        empty_initial_message_or_final_output
          iom_tr iom
        ‚Üí P iom_si iom_s iom_tr
          ‚Üí finite_valid_trace_init_to
              iom_si iom_s iom_tr
            ‚Üí <span class="kr">‚àÄ</span> (<span class="nv">sf</span> : state) 
                (<span class="nv">oom</span> : 
                 option message) 
                (<span class="nv">l</span> : label),
                input_valid_transition l
                  (s, iom) 
                  (sf, oom)
                ‚Üí P <span class="kr">is</span> sf
                    (tr ++
                     [{|
                      l := l;
                      input := iom;
                      destination := sf;
                      output := oom
                      |}])</span></span></span><br><span><var>is, s</var><span class="hyp-type"><b>: </b><span>state</span></span></span><br><span><var>_om</var><span class="hyp-type"><b>: </b><span>option message</span></span></span><br><span><var>tl</var><span class="hyp-type"><b>: </b><span>list transition_item</span></span></span><br><span><var>Htr1</var><span class="hyp-type"><b>: </b><span>valid_state_message_prop s _om</span></span></span><br><span><var>iom_is, iom_s</var><span class="hyp-type"><b>: </b><span>state</span></span></span><br><span><var>iom</var><span class="hyp-type"><b>: </b><span>option message</span></span></span><br><span><var>iom_tl</var><span class="hyp-type"><b>: </b><span>list transition_item</span></span></span><br><span><var>Htr2</var><span class="hyp-type"><b>: </b><span>finite_valid_trace_init_to_emit iom_is iom_s
  iom iom_tl</span></span></span><br><span><var>l0</var><span class="hyp-type"><b>: </b><span>label</span></span></span><br><span><var>Hv</var><span class="hyp-type"><b>: </b><span>valid l0 (s, iom)</span></span></span><br><span><var>s'</var><span class="hyp-type"><b>: </b><span>state</span></span></span><br><span><var>oom</var><span class="hyp-type"><b>: </b><span>option message</span></span></span><br><span><var>Ht</var><span class="hyp-type"><b>: </b><span>transition l0 (s, iom) = (s&#39;, oom)</span></span></span><br><span><var>IHHtr1</var><span class="hyp-type"><b>: </b><span>P <span class="kr">is</span> s tl</span></span></span><br><span><var>IHHtr2</var><span class="hyp-type"><b>: </b><span>P iom_is iom_s iom_tl</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">input_valid_transition l0 (s, iom) (s&#39;, oom)</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">          </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="VLSM-v-chk295" style="display: none" type="checkbox"><label class="alectryon-input" for="VLSM-v-chk295"><span class="nb">apply</span> finite_valid_trace_init_to_emit_valid_state_message <span class="kr">in</span> Htr2.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>message</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>X</var><span class="hyp-type"><b>: </b><span>VLSM message</span></span></span><br><span><var>TypeX</var><span><span class="hyp-body"><b>:= </b><span>type X</span></span><span class="hyp-type"><b>: </b><span>VLSMType message</span></span></span></span><br><span><var>MachineX</var><span><span class="hyp-body"><b>:= </b><span>machine X</span></span><span class="hyp-type"><b>: </b><span>VLSMMachine (vtype X)</span></span></span></span><br><span><var>P</var><span class="hyp-type"><b>: </b><span>state ‚Üí state ‚Üí list transition_item ‚Üí <span class="kt">Prop</span></span></span></span><br><span><var>Hempty</var><span class="hyp-type"><b>: </b><span><span class="kr">‚àÄ</span> <span class="nv">is</span> : state,
  initial_state_prop <span class="kr">is</span> ‚Üí P <span class="kr">is</span> <span class="kr">is</span> []</span></span></span><br><span><var>Hextend</var><span class="hyp-type"><b>: </b><span><span class="kr">‚àÄ</span> (<span class="nv">is</span> <span class="nv">s</span> : state) (<span class="nv">tr</span> : list transition_item),
  P <span class="kr">is</span> s tr
  ‚Üí finite_valid_trace_init_to <span class="kr">is</span> s tr
    ‚Üí <span class="kr">‚àÄ</span> (<span class="nv">iom</span> : option message) 
        (<span class="nv">iom_si</span> <span class="nv">iom_s</span> : state) 
        (<span class="nv">iom_tr</span> : list transition_item),
        empty_initial_message_or_final_output
          iom_tr iom
        ‚Üí P iom_si iom_s iom_tr
          ‚Üí finite_valid_trace_init_to
              iom_si iom_s iom_tr
            ‚Üí <span class="kr">‚àÄ</span> (<span class="nv">sf</span> : state) 
                (<span class="nv">oom</span> : 
                 option message) 
                (<span class="nv">l</span> : label),
                input_valid_transition l
                  (s, iom) 
                  (sf, oom)
                ‚Üí P <span class="kr">is</span> sf
                    (tr ++
                     [{|
                      l := l;
                      input := iom;
                      destination := sf;
                      output := oom
                      |}])</span></span></span><br><span><var>is, s</var><span class="hyp-type"><b>: </b><span>state</span></span></span><br><span><var>_om</var><span class="hyp-type"><b>: </b><span>option message</span></span></span><br><span><var>tl</var><span class="hyp-type"><b>: </b><span>list transition_item</span></span></span><br><span><var>Htr1</var><span class="hyp-type"><b>: </b><span>valid_state_message_prop s _om</span></span></span><br><span><var>iom_is, iom_s</var><span class="hyp-type"><b>: </b><span>state</span></span></span><br><span><var>iom</var><span class="hyp-type"><b>: </b><span>option message</span></span></span><br><span><var>iom_tl</var><span class="hyp-type"><b>: </b><span>list transition_item</span></span></span><br><span><var>Htr2</var><span class="hyp-type"><b>: </b><span>valid_state_message_prop iom_s iom</span></span></span><br><span><var>l0</var><span class="hyp-type"><b>: </b><span>label</span></span></span><br><span><var>Hv</var><span class="hyp-type"><b>: </b><span>valid l0 (s, iom)</span></span></span><br><span><var>s'</var><span class="hyp-type"><b>: </b><span>state</span></span></span><br><span><var>oom</var><span class="hyp-type"><b>: </b><span>option message</span></span></span><br><span><var>Ht</var><span class="hyp-type"><b>: </b><span>transition l0 (s, iom) = (s&#39;, oom)</span></span></span><br><span><var>IHHtr1</var><span class="hyp-type"><b>: </b><span>P <span class="kr">is</span> s tl</span></span></span><br><span><var>IHHtr2</var><span class="hyp-type"><b>: </b><span>P iom_is iom_s iom_tl</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">input_valid_transition l0 (s, iom) (s&#39;, oom)</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">          </span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kp">repeat</span> <span class="nb">split</span>; [..|<span class="bp">assumption</span>|<span class="bp">assumption</span>]; <span class="nb">eexists</span>; [<span class="bp">exact</span> Htr1 | <span class="bp">exact</span> Htr2].</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">        </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="VLSM-v-chk296" style="display: none" type="checkbox"><label class="alectryon-input" for="VLSM-v-chk296">}</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>message</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>X</var><span class="hyp-type"><b>: </b><span>VLSM message</span></span></span><br><span><var>TypeX</var><span><span class="hyp-body"><b>:= </b><span>type X</span></span><span class="hyp-type"><b>: </b><span>VLSMType message</span></span></span></span><br><span><var>MachineX</var><span><span class="hyp-body"><b>:= </b><span>machine X</span></span><span class="hyp-type"><b>: </b><span>VLSMMachine (vtype X)</span></span></span></span><br><span><var>P</var><span class="hyp-type"><b>: </b><span>state ‚Üí state ‚Üí list transition_item ‚Üí <span class="kt">Prop</span></span></span></span><br><span><var>Hempty</var><span class="hyp-type"><b>: </b><span><span class="kr">‚àÄ</span> <span class="nv">is</span> : state,
  initial_state_prop <span class="kr">is</span> ‚Üí P <span class="kr">is</span> <span class="kr">is</span> []</span></span></span><br><span><var>Hextend</var><span class="hyp-type"><b>: </b><span><span class="kr">‚àÄ</span> (<span class="nv">is</span> <span class="nv">s</span> : state) (<span class="nv">tr</span> : list transition_item),
  P <span class="kr">is</span> s tr
  ‚Üí finite_valid_trace_init_to <span class="kr">is</span> s tr
    ‚Üí <span class="kr">‚àÄ</span> (<span class="nv">iom</span> : option message) 
        (<span class="nv">iom_si</span> <span class="nv">iom_s</span> : state) 
        (<span class="nv">iom_tr</span> : list transition_item),
        empty_initial_message_or_final_output
          iom_tr iom
        ‚Üí P iom_si iom_s iom_tr
          ‚Üí finite_valid_trace_init_to
              iom_si iom_s iom_tr
            ‚Üí <span class="kr">‚àÄ</span> (<span class="nv">sf</span> : state) 
                (<span class="nv">oom</span> : 
                 option message) 
                (<span class="nv">l</span> : label),
                input_valid_transition l
                  (s, iom) 
                  (sf, oom)
                ‚Üí P <span class="kr">is</span> sf
                    (tr ++
                     [{|
                      l := l;
                      input := iom;
                      destination := sf;
                      output := oom
                      |}])</span></span></span><br><span><var>is, s</var><span class="hyp-type"><b>: </b><span>state</span></span></span><br><span><var>_om</var><span class="hyp-type"><b>: </b><span>option message</span></span></span><br><span><var>tl</var><span class="hyp-type"><b>: </b><span>list transition_item</span></span></span><br><span><var>Htr1</var><span class="hyp-type"><b>: </b><span>finite_valid_trace_init_to_emit <span class="kr">is</span> s _om tl</span></span></span><br><span><var>iom_is, iom_s</var><span class="hyp-type"><b>: </b><span>state</span></span></span><br><span><var>iom</var><span class="hyp-type"><b>: </b><span>option message</span></span></span><br><span><var>iom_tl</var><span class="hyp-type"><b>: </b><span>list transition_item</span></span></span><br><span><var>Htr2</var><span class="hyp-type"><b>: </b><span>finite_valid_trace_init_to_emit iom_is iom_s
  iom iom_tl</span></span></span><br><span><var>l0</var><span class="hyp-type"><b>: </b><span>label</span></span></span><br><span><var>Hv</var><span class="hyp-type"><b>: </b><span>valid l0 (s, iom)</span></span></span><br><span><var>s'</var><span class="hyp-type"><b>: </b><span>state</span></span></span><br><span><var>oom</var><span class="hyp-type"><b>: </b><span>option message</span></span></span><br><span><var>Ht</var><span class="hyp-type"><b>: </b><span>transition l0 (s, iom) = (s&#39;, oom)</span></span></span><br><span><var>IHHtr1</var><span class="hyp-type"><b>: </b><span>P <span class="kr">is</span> s tl</span></span></span><br><span><var>IHHtr2</var><span class="hyp-type"><b>: </b><span>P iom_is iom_s iom_tl</span></span></span><br><span><var>Hivt</var><span class="hyp-type"><b>: </b><span>input_valid_transition l0 (s, iom) (s&#39;, oom)</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">P <span class="kr">is</span> s&#39;
  (tl ++
   [{|
      l := l0;
      input := iom;
      destination := s&#39;;
      output := oom
    |}])</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">        </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="VLSM-v-chk297" style="display: none" type="checkbox"><label class="alectryon-input" for="VLSM-v-chk297"><span class="nb">apply</span> finite_valid_trace_init_to_emit_output <span class="kr">in</span> Htr2 <span class="kr">as</span> Houtput.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>message</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>X</var><span class="hyp-type"><b>: </b><span>VLSM message</span></span></span><br><span><var>TypeX</var><span><span class="hyp-body"><b>:= </b><span>type X</span></span><span class="hyp-type"><b>: </b><span>VLSMType message</span></span></span></span><br><span><var>MachineX</var><span><span class="hyp-body"><b>:= </b><span>machine X</span></span><span class="hyp-type"><b>: </b><span>VLSMMachine (vtype X)</span></span></span></span><br><span><var>P</var><span class="hyp-type"><b>: </b><span>state ‚Üí state ‚Üí list transition_item ‚Üí <span class="kt">Prop</span></span></span></span><br><span><var>Hempty</var><span class="hyp-type"><b>: </b><span><span class="kr">‚àÄ</span> <span class="nv">is</span> : state,
  initial_state_prop <span class="kr">is</span> ‚Üí P <span class="kr">is</span> <span class="kr">is</span> []</span></span></span><br><span><var>Hextend</var><span class="hyp-type"><b>: </b><span><span class="kr">‚àÄ</span> (<span class="nv">is</span> <span class="nv">s</span> : state) (<span class="nv">tr</span> : list transition_item),
  P <span class="kr">is</span> s tr
  ‚Üí finite_valid_trace_init_to <span class="kr">is</span> s tr
    ‚Üí <span class="kr">‚àÄ</span> (<span class="nv">iom</span> : option message) 
        (<span class="nv">iom_si</span> <span class="nv">iom_s</span> : state) 
        (<span class="nv">iom_tr</span> : list transition_item),
        empty_initial_message_or_final_output
          iom_tr iom
        ‚Üí P iom_si iom_s iom_tr
          ‚Üí finite_valid_trace_init_to
              iom_si iom_s iom_tr
            ‚Üí <span class="kr">‚àÄ</span> (<span class="nv">sf</span> : state) 
                (<span class="nv">oom</span> : 
                 option message) 
                (<span class="nv">l</span> : label),
                input_valid_transition l
                  (s, iom) 
                  (sf, oom)
                ‚Üí P <span class="kr">is</span> sf
                    (tr ++
                     [{|
                      l := l;
                      input := iom;
                      destination := sf;
                      output := oom
                      |}])</span></span></span><br><span><var>is, s</var><span class="hyp-type"><b>: </b><span>state</span></span></span><br><span><var>_om</var><span class="hyp-type"><b>: </b><span>option message</span></span></span><br><span><var>tl</var><span class="hyp-type"><b>: </b><span>list transition_item</span></span></span><br><span><var>Htr1</var><span class="hyp-type"><b>: </b><span>finite_valid_trace_init_to_emit <span class="kr">is</span> s _om tl</span></span></span><br><span><var>iom_is, iom_s</var><span class="hyp-type"><b>: </b><span>state</span></span></span><br><span><var>iom</var><span class="hyp-type"><b>: </b><span>option message</span></span></span><br><span><var>iom_tl</var><span class="hyp-type"><b>: </b><span>list transition_item</span></span></span><br><span><var>Htr2</var><span class="hyp-type"><b>: </b><span>finite_valid_trace_init_to_emit iom_is iom_s
  iom iom_tl</span></span></span><br><span><var>Houtput</var><span class="hyp-type"><b>: </b><span>empty_initial_message_or_final_output iom_tl
  iom</span></span></span><br><span><var>l0</var><span class="hyp-type"><b>: </b><span>label</span></span></span><br><span><var>Hv</var><span class="hyp-type"><b>: </b><span>valid l0 (s, iom)</span></span></span><br><span><var>s'</var><span class="hyp-type"><b>: </b><span>state</span></span></span><br><span><var>oom</var><span class="hyp-type"><b>: </b><span>option message</span></span></span><br><span><var>Ht</var><span class="hyp-type"><b>: </b><span>transition l0 (s, iom) = (s&#39;, oom)</span></span></span><br><span><var>IHHtr1</var><span class="hyp-type"><b>: </b><span>P <span class="kr">is</span> s tl</span></span></span><br><span><var>IHHtr2</var><span class="hyp-type"><b>: </b><span>P iom_is iom_s iom_tl</span></span></span><br><span><var>Hivt</var><span class="hyp-type"><b>: </b><span>input_valid_transition l0 (s, iom) (s&#39;, oom)</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">P <span class="kr">is</span> s&#39;
  (tl ++
   [{|
      l := l0;
      input := iom;
      destination := s&#39;;
      output := oom
    |}])</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">        </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="VLSM-v-chk298" style="display: none" type="checkbox"><label class="alectryon-input" for="VLSM-v-chk298"><span class="nb">apply</span> finite_valid_trace_init_to_emit_forget_emit <span class="kr">in</span> Htr1.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>message</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>X</var><span class="hyp-type"><b>: </b><span>VLSM message</span></span></span><br><span><var>TypeX</var><span><span class="hyp-body"><b>:= </b><span>type X</span></span><span class="hyp-type"><b>: </b><span>VLSMType message</span></span></span></span><br><span><var>MachineX</var><span><span class="hyp-body"><b>:= </b><span>machine X</span></span><span class="hyp-type"><b>: </b><span>VLSMMachine (vtype X)</span></span></span></span><br><span><var>P</var><span class="hyp-type"><b>: </b><span>state ‚Üí state ‚Üí list transition_item ‚Üí <span class="kt">Prop</span></span></span></span><br><span><var>Hempty</var><span class="hyp-type"><b>: </b><span><span class="kr">‚àÄ</span> <span class="nv">is</span> : state,
  initial_state_prop <span class="kr">is</span> ‚Üí P <span class="kr">is</span> <span class="kr">is</span> []</span></span></span><br><span><var>Hextend</var><span class="hyp-type"><b>: </b><span><span class="kr">‚àÄ</span> (<span class="nv">is</span> <span class="nv">s</span> : state) (<span class="nv">tr</span> : list transition_item),
  P <span class="kr">is</span> s tr
  ‚Üí finite_valid_trace_init_to <span class="kr">is</span> s tr
    ‚Üí <span class="kr">‚àÄ</span> (<span class="nv">iom</span> : option message) 
        (<span class="nv">iom_si</span> <span class="nv">iom_s</span> : state) 
        (<span class="nv">iom_tr</span> : list transition_item),
        empty_initial_message_or_final_output
          iom_tr iom
        ‚Üí P iom_si iom_s iom_tr
          ‚Üí finite_valid_trace_init_to
              iom_si iom_s iom_tr
            ‚Üí <span class="kr">‚àÄ</span> (<span class="nv">sf</span> : state) 
                (<span class="nv">oom</span> : 
                 option message) 
                (<span class="nv">l</span> : label),
                input_valid_transition l
                  (s, iom) 
                  (sf, oom)
                ‚Üí P <span class="kr">is</span> sf
                    (tr ++
                     [{|
                      l := l;
                      input := iom;
                      destination := sf;
                      output := oom
                      |}])</span></span></span><br><span><var>is, s</var><span class="hyp-type"><b>: </b><span>state</span></span></span><br><span><var>_om</var><span class="hyp-type"><b>: </b><span>option message</span></span></span><br><span><var>tl</var><span class="hyp-type"><b>: </b><span>list transition_item</span></span></span><br><span><var>Htr1</var><span class="hyp-type"><b>: </b><span>finite_valid_trace_init_to <span class="kr">is</span> s tl</span></span></span><br><span><var>iom_is, iom_s</var><span class="hyp-type"><b>: </b><span>state</span></span></span><br><span><var>iom</var><span class="hyp-type"><b>: </b><span>option message</span></span></span><br><span><var>iom_tl</var><span class="hyp-type"><b>: </b><span>list transition_item</span></span></span><br><span><var>Htr2</var><span class="hyp-type"><b>: </b><span>finite_valid_trace_init_to_emit iom_is iom_s
  iom iom_tl</span></span></span><br><span><var>Houtput</var><span class="hyp-type"><b>: </b><span>empty_initial_message_or_final_output iom_tl
  iom</span></span></span><br><span><var>l0</var><span class="hyp-type"><b>: </b><span>label</span></span></span><br><span><var>Hv</var><span class="hyp-type"><b>: </b><span>valid l0 (s, iom)</span></span></span><br><span><var>s'</var><span class="hyp-type"><b>: </b><span>state</span></span></span><br><span><var>oom</var><span class="hyp-type"><b>: </b><span>option message</span></span></span><br><span><var>Ht</var><span class="hyp-type"><b>: </b><span>transition l0 (s, iom) = (s&#39;, oom)</span></span></span><br><span><var>IHHtr1</var><span class="hyp-type"><b>: </b><span>P <span class="kr">is</span> s tl</span></span></span><br><span><var>IHHtr2</var><span class="hyp-type"><b>: </b><span>P iom_is iom_s iom_tl</span></span></span><br><span><var>Hivt</var><span class="hyp-type"><b>: </b><span>input_valid_transition l0 (s, iom) (s&#39;, oom)</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">P <span class="kr">is</span> s&#39;
  (tl ++
   [{|
      l := l0;
      input := iom;
      destination := s&#39;;
      output := oom
    |}])</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">        </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="VLSM-v-chk299" style="display: none" type="checkbox"><label class="alectryon-input" for="VLSM-v-chk299"><span class="nb">apply</span> finite_valid_trace_init_to_emit_forget_emit <span class="kr">in</span> Htr2.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>message</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>X</var><span class="hyp-type"><b>: </b><span>VLSM message</span></span></span><br><span><var>TypeX</var><span><span class="hyp-body"><b>:= </b><span>type X</span></span><span class="hyp-type"><b>: </b><span>VLSMType message</span></span></span></span><br><span><var>MachineX</var><span><span class="hyp-body"><b>:= </b><span>machine X</span></span><span class="hyp-type"><b>: </b><span>VLSMMachine (vtype X)</span></span></span></span><br><span><var>P</var><span class="hyp-type"><b>: </b><span>state ‚Üí state ‚Üí list transition_item ‚Üí <span class="kt">Prop</span></span></span></span><br><span><var>Hempty</var><span class="hyp-type"><b>: </b><span><span class="kr">‚àÄ</span> <span class="nv">is</span> : state,
  initial_state_prop <span class="kr">is</span> ‚Üí P <span class="kr">is</span> <span class="kr">is</span> []</span></span></span><br><span><var>Hextend</var><span class="hyp-type"><b>: </b><span><span class="kr">‚àÄ</span> (<span class="nv">is</span> <span class="nv">s</span> : state) (<span class="nv">tr</span> : list transition_item),
  P <span class="kr">is</span> s tr
  ‚Üí finite_valid_trace_init_to <span class="kr">is</span> s tr
    ‚Üí <span class="kr">‚àÄ</span> (<span class="nv">iom</span> : option message) 
        (<span class="nv">iom_si</span> <span class="nv">iom_s</span> : state) 
        (<span class="nv">iom_tr</span> : list transition_item),
        empty_initial_message_or_final_output
          iom_tr iom
        ‚Üí P iom_si iom_s iom_tr
          ‚Üí finite_valid_trace_init_to
              iom_si iom_s iom_tr
            ‚Üí <span class="kr">‚àÄ</span> (<span class="nv">sf</span> : state) 
                (<span class="nv">oom</span> : 
                 option message) 
                (<span class="nv">l</span> : label),
                input_valid_transition l
                  (s, iom) 
                  (sf, oom)
                ‚Üí P <span class="kr">is</span> sf
                    (tr ++
                     [{|
                      l := l;
                      input := iom;
                      destination := sf;
                      output := oom
                      |}])</span></span></span><br><span><var>is, s</var><span class="hyp-type"><b>: </b><span>state</span></span></span><br><span><var>_om</var><span class="hyp-type"><b>: </b><span>option message</span></span></span><br><span><var>tl</var><span class="hyp-type"><b>: </b><span>list transition_item</span></span></span><br><span><var>Htr1</var><span class="hyp-type"><b>: </b><span>finite_valid_trace_init_to <span class="kr">is</span> s tl</span></span></span><br><span><var>iom_is, iom_s</var><span class="hyp-type"><b>: </b><span>state</span></span></span><br><span><var>iom</var><span class="hyp-type"><b>: </b><span>option message</span></span></span><br><span><var>iom_tl</var><span class="hyp-type"><b>: </b><span>list transition_item</span></span></span><br><span><var>Htr2</var><span class="hyp-type"><b>: </b><span>finite_valid_trace_init_to iom_is iom_s iom_tl</span></span></span><br><span><var>Houtput</var><span class="hyp-type"><b>: </b><span>empty_initial_message_or_final_output iom_tl
  iom</span></span></span><br><span><var>l0</var><span class="hyp-type"><b>: </b><span>label</span></span></span><br><span><var>Hv</var><span class="hyp-type"><b>: </b><span>valid l0 (s, iom)</span></span></span><br><span><var>s'</var><span class="hyp-type"><b>: </b><span>state</span></span></span><br><span><var>oom</var><span class="hyp-type"><b>: </b><span>option message</span></span></span><br><span><var>Ht</var><span class="hyp-type"><b>: </b><span>transition l0 (s, iom) = (s&#39;, oom)</span></span></span><br><span><var>IHHtr1</var><span class="hyp-type"><b>: </b><span>P <span class="kr">is</span> s tl</span></span></span><br><span><var>IHHtr2</var><span class="hyp-type"><b>: </b><span>P iom_is iom_s iom_tl</span></span></span><br><span><var>Hivt</var><span class="hyp-type"><b>: </b><span>input_valid_transition l0 (s, iom) (s&#39;, oom)</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">P <span class="kr">is</span> s&#39;
  (tl ++
   [{|
      l := l0;
      input := iom;
      destination := s&#39;;
      output := oom
    |}])</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">        </span><span class="alectryon-sentence"><span class="alectryon-input"><span class="nb">apply</span> (Hextend _ _ _ IHHtr1 Htr1 _ _ _ _ Houtput IHHtr2 Htr2 _ _ _ Hivt).</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Qed</span>.</span></span></pre><div class="doc">
<a id="lab13"></a><h3 class="section">Infinite <span class="inlinecode"><span class="id" title="var">protcol_trace</span></span>s</h3>
</div><pre class="alectryon-io highlight"><!-- Generator: Alectryon --></pre><div class="doc">
We now define <span class="inlinecode"><span class="id" title="var">infinite_valid_trace</span></span>s. The definitions
resemble their finite counterparts, adapted to the technical
necessities of defining infinite objects. Notably, <code>steps</code> is
stored as a stream, as opposed to a list.

</div><pre class="alectryon-io highlight"><!-- Generator: Alectryon --><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">CoInductive</span> <span class="nf">infinite_valid_trace_from</span> :
      state -&gt; Stream transition_item -&gt; <span class="kt">Prop</span> :=
    | infinite_valid_trace_from_extend : <span class="kr">forall</span>  (<span class="nv">s</span> : state) (<span class="nv">tl</span> : Stream transition_item)
        (<span class="nv">Htl</span> : infinite_valid_trace_from s tl)
        (<span class="nv">s&#39;</span> : state) (<span class="nv">iom</span> <span class="nv">oom</span> : option message) (<span class="nv">l</span> : label)
        (<span class="nv">Ht</span> : input_valid_transition l (s&#39;, iom) (s, oom)),
        infinite_valid_trace_from  s&#39; (Cons {| l := l; input := iom; destination := s; output := oom |}  tl).</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
</span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Definition</span> <span class="nf">infinite_valid_trace</span> (<span class="nv">s</span> : state) (<span class="nv">st</span> : Stream transition_item)
      := infinite_valid_trace_from s st /\ initial_state_prop s.</span></span></pre><div class="doc">
As for the finite case, the following lemmas help decompose teh above
definitions, mostly reducing them to properties about their finite segments.

</div><pre class="alectryon-io highlight"><!-- Generator: Alectryon --><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="VLSM-v-chk29a" style="display: none" type="checkbox"><label class="alectryon-input" for="VLSM-v-chk29a"><span class="kn">Lemma</span> <span class="nf">infinite_valid_trace_consecutive_valid_transition</span>
          (<span class="nv">is</span> : state)
          (<span class="nv">tr</span> <span class="nv">tr2</span> : Stream transition_item)
          (<span class="nv">tr1</span> : list transition_item)
          (<span class="nv">te1</span> <span class="nv">te2</span> : transition_item)
          (<span class="nv">Htr</span> : infinite_valid_trace_from <span class="kr">is</span> tr)
          (<span class="nv">Heq</span> : tr = stream_app (tr1 ++ [te1; te2]) tr2)
      : input_valid_transition (l te2) (destination te1, input te2) (destination te2, output te2).</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>message</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>X</var><span class="hyp-type"><b>: </b><span>VLSM message</span></span></span><br><span><var>TypeX</var><span><span class="hyp-body"><b>:= </b><span>type X</span></span><span class="hyp-type"><b>: </b><span>VLSMType message</span></span></span></span><br><span><var>MachineX</var><span><span class="hyp-body"><b>:= </b><span>machine X</span></span><span class="hyp-type"><b>: </b><span>VLSMMachine (vtype X)</span></span></span></span><br><span><var>is</var><span class="hyp-type"><b>: </b><span>state</span></span></span><br><span><var>tr, tr2</var><span class="hyp-type"><b>: </b><span>Stream transition_item</span></span></span><br><span><var>tr1</var><span class="hyp-type"><b>: </b><span>list transition_item</span></span></span><br><span><var>te1, te2</var><span class="hyp-type"><b>: </b><span>transition_item</span></span></span><br><span><var>Htr</var><span class="hyp-type"><b>: </b><span>infinite_valid_trace_from <span class="kr">is</span> tr</span></span></span><br><span><var>Heq</var><span class="hyp-type"><b>: </b><span>tr = stream_app (tr1 ++ [te1; te2]) tr2</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">input_valid_transition (l te2)
  (destination te1, input te2)
  (destination te2, output te2)</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="VLSM-v-chk29b" style="display: none" type="checkbox"><label class="alectryon-input" for="VLSM-v-chk29b"><span class="kn">Proof</span>.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>message</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>X</var><span class="hyp-type"><b>: </b><span>VLSM message</span></span></span><br><span><var>TypeX</var><span><span class="hyp-body"><b>:= </b><span>type X</span></span><span class="hyp-type"><b>: </b><span>VLSMType message</span></span></span></span><br><span><var>MachineX</var><span><span class="hyp-body"><b>:= </b><span>machine X</span></span><span class="hyp-type"><b>: </b><span>VLSMMachine (vtype X)</span></span></span></span><br><span><var>is</var><span class="hyp-type"><b>: </b><span>state</span></span></span><br><span><var>tr, tr2</var><span class="hyp-type"><b>: </b><span>Stream transition_item</span></span></span><br><span><var>tr1</var><span class="hyp-type"><b>: </b><span>list transition_item</span></span></span><br><span><var>te1, te2</var><span class="hyp-type"><b>: </b><span>transition_item</span></span></span><br><span><var>Htr</var><span class="hyp-type"><b>: </b><span>infinite_valid_trace_from <span class="kr">is</span> tr</span></span></span><br><span><var>Heq</var><span class="hyp-type"><b>: </b><span>tr = stream_app (tr1 ++ [te1; te2]) tr2</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">input_valid_transition (l te2)
  (destination te1, input te2)
  (destination te2, output te2)</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">      </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="VLSM-v-chk29c" style="display: none" type="checkbox"><label class="alectryon-input" for="VLSM-v-chk29c"><span class="nb">generalize dependent</span> <span class="kr">is</span>.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>message</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>X</var><span class="hyp-type"><b>: </b><span>VLSM message</span></span></span><br><span><var>TypeX</var><span><span class="hyp-body"><b>:= </b><span>type X</span></span><span class="hyp-type"><b>: </b><span>VLSMType message</span></span></span></span><br><span><var>MachineX</var><span><span class="hyp-body"><b>:= </b><span>machine X</span></span><span class="hyp-type"><b>: </b><span>VLSMMachine (vtype X)</span></span></span></span><br><span><var>tr, tr2</var><span class="hyp-type"><b>: </b><span>Stream transition_item</span></span></span><br><span><var>tr1</var><span class="hyp-type"><b>: </b><span>list transition_item</span></span></span><br><span><var>te1, te2</var><span class="hyp-type"><b>: </b><span>transition_item</span></span></span><br><span><var>Heq</var><span class="hyp-type"><b>: </b><span>tr = stream_app (tr1 ++ [te1; te2]) tr2</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="kr">‚àÄ</span> <span class="nv">is</span> : state,
  infinite_valid_trace_from <span class="kr">is</span> tr
  ‚Üí input_valid_transition (l te2)
      (destination te1, input te2)
      (destination te2, output te2)</div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="VLSM-v-chk29d" style="display: none" type="checkbox"><label class="alectryon-input" for="VLSM-v-chk29d"><span class="nb">generalize dependent</span> tr.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>message</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>X</var><span class="hyp-type"><b>: </b><span>VLSM message</span></span></span><br><span><var>TypeX</var><span><span class="hyp-body"><b>:= </b><span>type X</span></span><span class="hyp-type"><b>: </b><span>VLSMType message</span></span></span></span><br><span><var>MachineX</var><span><span class="hyp-body"><b>:= </b><span>machine X</span></span><span class="hyp-type"><b>: </b><span>VLSMMachine (vtype X)</span></span></span></span><br><span><var>tr2</var><span class="hyp-type"><b>: </b><span>Stream transition_item</span></span></span><br><span><var>tr1</var><span class="hyp-type"><b>: </b><span>list transition_item</span></span></span><br><span><var>te1, te2</var><span class="hyp-type"><b>: </b><span>transition_item</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="kr">‚àÄ</span> <span class="nv">tr</span> : Stream transition_item,
  tr = stream_app (tr1 ++ [te1; te2]) tr2
  ‚Üí <span class="kr">‚àÄ</span> <span class="nv">is</span> : state,
      infinite_valid_trace_from <span class="kr">is</span> tr
      ‚Üí input_valid_transition (l te2)
          (destination te1, input te2)
          (destination te2, output te2)</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">      </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="VLSM-v-chk29e" style="display: none" type="checkbox"><label class="alectryon-input" for="VLSM-v-chk29e"><span class="nb">induction</span> tr1.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>message</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>X</var><span class="hyp-type"><b>: </b><span>VLSM message</span></span></span><br><span><var>TypeX</var><span><span class="hyp-body"><b>:= </b><span>type X</span></span><span class="hyp-type"><b>: </b><span>VLSMType message</span></span></span></span><br><span><var>MachineX</var><span><span class="hyp-body"><b>:= </b><span>machine X</span></span><span class="hyp-type"><b>: </b><span>VLSMMachine (vtype X)</span></span></span></span><br><span><var>tr2</var><span class="hyp-type"><b>: </b><span>Stream transition_item</span></span></span><br><span><var>te1, te2</var><span class="hyp-type"><b>: </b><span>transition_item</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="kr">‚àÄ</span> <span class="nv">tr</span> : Stream transition_item,
  tr = stream_app ([] ++ [te1; te2]) tr2
  ‚Üí <span class="kr">‚àÄ</span> <span class="nv">is</span> : state,
      infinite_valid_trace_from <span class="kr">is</span> tr
      ‚Üí input_valid_transition (l te2)
          (destination te1, input te2)
          (destination te2, output te2)</div></blockquote><div class="alectryon-extra-goals"><input class="alectryon-extra-goal-toggle" id="VLSM-v-chk29f" style="display: none" type="checkbox"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>message</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>X</var><span class="hyp-type"><b>: </b><span>VLSM message</span></span></span><br><span><var>TypeX</var><span><span class="hyp-body"><b>:= </b><span>type X</span></span><span class="hyp-type"><b>: </b><span>VLSMType message</span></span></span></span><br><span><var>MachineX</var><span><span class="hyp-body"><b>:= </b><span>machine X</span></span><span class="hyp-type"><b>: </b><span>VLSMMachine (vtype X)</span></span></span></span><br><span><var>tr2</var><span class="hyp-type"><b>: </b><span>Stream transition_item</span></span></span><br><span><var>a</var><span class="hyp-type"><b>: </b><span>transition_item</span></span></span><br><span><var>tr1</var><span class="hyp-type"><b>: </b><span>list transition_item</span></span></span><br><span><var>te1, te2</var><span class="hyp-type"><b>: </b><span>transition_item</span></span></span><br><span><var>IHtr1</var><span class="hyp-type"><b>: </b><span><span class="kr">‚àÄ</span> <span class="nv">tr</span> : Stream transition_item,
  tr = stream_app (tr1 ++ [te1; te2]) tr2
  ‚Üí <span class="kr">‚àÄ</span> <span class="nv">is</span> : state,
      infinite_valid_trace_from <span class="kr">is</span> tr
      ‚Üí input_valid_transition 
          (l te2) (destination te1, input te2)
          (destination te2, output te2)</span></span></span><br></div><label class="goal-separator" for="VLSM-v-chk29f"><hr></label><div class="goal-conclusion"><span class="kr">‚àÄ</span> <span class="nv">tr</span> : Stream transition_item,
  tr = stream_app ((a :: tr1) ++ [te1; te2]) tr2
  ‚Üí <span class="kr">‚àÄ</span> <span class="nv">is</span> : state,
      infinite_valid_trace_from <span class="kr">is</span> tr
      ‚Üí input_valid_transition 
          (l te2) (destination te1, input te2)
          (destination te2, output te2)</div></blockquote></div></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">      </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="VLSM-v-chk2a0" style="display: none" type="checkbox"><label class="alectryon-input" for="VLSM-v-chk2a0">-</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>message</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>X</var><span class="hyp-type"><b>: </b><span>VLSM message</span></span></span><br><span><var>TypeX</var><span><span class="hyp-body"><b>:= </b><span>type X</span></span><span class="hyp-type"><b>: </b><span>VLSMType message</span></span></span></span><br><span><var>MachineX</var><span><span class="hyp-body"><b>:= </b><span>machine X</span></span><span class="hyp-type"><b>: </b><span>VLSMMachine (vtype X)</span></span></span></span><br><span><var>tr2</var><span class="hyp-type"><b>: </b><span>Stream transition_item</span></span></span><br><span><var>te1, te2</var><span class="hyp-type"><b>: </b><span>transition_item</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="kr">‚àÄ</span> <span class="nv">tr</span> : Stream transition_item,
  tr = stream_app ([] ++ [te1; te2]) tr2
  ‚Üí <span class="kr">‚àÄ</span> <span class="nv">is</span> : state,
      infinite_valid_trace_from <span class="kr">is</span> tr
      ‚Üí input_valid_transition (l te2)
          (destination te1, input te2)
          (destination te2, output te2)</div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="VLSM-v-chk2a1" style="display: none" type="checkbox"><label class="alectryon-input" for="VLSM-v-chk2a1"><span class="nb">intros</span> tr Heq <span class="kr">is</span> Htr.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>message</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>X</var><span class="hyp-type"><b>: </b><span>VLSM message</span></span></span><br><span><var>TypeX</var><span><span class="hyp-body"><b>:= </b><span>type X</span></span><span class="hyp-type"><b>: </b><span>VLSMType message</span></span></span></span><br><span><var>MachineX</var><span><span class="hyp-body"><b>:= </b><span>machine X</span></span><span class="hyp-type"><b>: </b><span>VLSMMachine (vtype X)</span></span></span></span><br><span><var>tr2</var><span class="hyp-type"><b>: </b><span>Stream transition_item</span></span></span><br><span><var>te1, te2</var><span class="hyp-type"><b>: </b><span>transition_item</span></span></span><br><span><var>tr</var><span class="hyp-type"><b>: </b><span>Stream transition_item</span></span></span><br><span><var>Heq</var><span class="hyp-type"><b>: </b><span>tr = stream_app ([] ++ [te1; te2]) tr2</span></span></span><br><span><var>is</var><span class="hyp-type"><b>: </b><span>state</span></span></span><br><span><var>Htr</var><span class="hyp-type"><b>: </b><span>infinite_valid_trace_from <span class="kr">is</span> tr</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">input_valid_transition (l te2)
  (destination te1, input te2)
  (destination te2, output te2)</div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="VLSM-v-chk2a2" style="display: none" type="checkbox"><label class="alectryon-input" for="VLSM-v-chk2a2"><span class="nb">simpl</span> <span class="kr">in</span> Heq; <span class="nb">subst</span>.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>message</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>X</var><span class="hyp-type"><b>: </b><span>VLSM message</span></span></span><br><span><var>TypeX</var><span><span class="hyp-body"><b>:= </b><span>type X</span></span><span class="hyp-type"><b>: </b><span>VLSMType message</span></span></span></span><br><span><var>MachineX</var><span><span class="hyp-body"><b>:= </b><span>machine X</span></span><span class="hyp-type"><b>: </b><span>VLSMMachine (vtype X)</span></span></span></span><br><span><var>tr2</var><span class="hyp-type"><b>: </b><span>Stream transition_item</span></span></span><br><span><var>te1, te2</var><span class="hyp-type"><b>: </b><span>transition_item</span></span></span><br><span><var>is</var><span class="hyp-type"><b>: </b><span>state</span></span></span><br><span><var>Htr</var><span class="hyp-type"><b>: </b><span>infinite_valid_trace_from <span class="kr">is</span>
  (Cons te1 (Cons te2 tr2))</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">input_valid_transition (l te2)
  (destination te1, input te2)
  (destination te2, output te2)</div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="VLSM-v-chk2a3" style="display: none" type="checkbox"><label class="alectryon-input" for="VLSM-v-chk2a3"><span class="nb">inversion</span> Htr; <span class="nb">subst</span>.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>message</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>X</var><span class="hyp-type"><b>: </b><span>VLSM message</span></span></span><br><span><var>TypeX</var><span><span class="hyp-body"><b>:= </b><span>type X</span></span><span class="hyp-type"><b>: </b><span>VLSMType message</span></span></span></span><br><span><var>MachineX</var><span><span class="hyp-body"><b>:= </b><span>machine X</span></span><span class="hyp-type"><b>: </b><span>VLSMMachine (vtype X)</span></span></span></span><br><span><var>tr2</var><span class="hyp-type"><b>: </b><span>Stream transition_item</span></span></span><br><span><var>te2</var><span class="hyp-type"><b>: </b><span>transition_item</span></span></span><br><span><var>is, s</var><span class="hyp-type"><b>: </b><span>state</span></span></span><br><span><var>iom, oom</var><span class="hyp-type"><b>: </b><span>option message</span></span></span><br><span><var>l0</var><span class="hyp-type"><b>: </b><span>label</span></span></span><br><span><var>Htr</var><span class="hyp-type"><b>: </b><span>infinite_valid_trace_from <span class="kr">is</span>
  (Cons
     {|
       l := l0;
       input := iom;
       destination := s;
       output := oom
     |} (Cons te2 tr2))</span></span></span><br><span><var>Htl</var><span class="hyp-type"><b>: </b><span>infinite_valid_trace_from s (Cons te2 tr2)</span></span></span><br><span><var>Ht</var><span class="hyp-type"><b>: </b><span>input_valid_transition l0 (<span class="kr">is</span>, iom) (s, oom)</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">input_valid_transition (l te2)
  (destination
     {|
       l := l0;
       input := iom;
       destination := s;
       output := oom
     |}, input te2) (destination te2, output te2)</div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="VLSM-v-chk2a4" style="display: none" type="checkbox"><label class="alectryon-input" for="VLSM-v-chk2a4"><span class="nb">inversion</span> Htl; <span class="nb">subst</span>.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>message</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>X</var><span class="hyp-type"><b>: </b><span>VLSM message</span></span></span><br><span><var>TypeX</var><span><span class="hyp-body"><b>:= </b><span>type X</span></span><span class="hyp-type"><b>: </b><span>VLSMType message</span></span></span></span><br><span><var>MachineX</var><span><span class="hyp-body"><b>:= </b><span>machine X</span></span><span class="hyp-type"><b>: </b><span>VLSMMachine (vtype X)</span></span></span></span><br><span><var>tr2</var><span class="hyp-type"><b>: </b><span>Stream transition_item</span></span></span><br><span><var>is, s</var><span class="hyp-type"><b>: </b><span>state</span></span></span><br><span><var>iom, oom</var><span class="hyp-type"><b>: </b><span>option message</span></span></span><br><span><var>l0</var><span class="hyp-type"><b>: </b><span>label</span></span></span><br><span><var>s1</var><span class="hyp-type"><b>: </b><span>state</span></span></span><br><span><var>iom0, oom0</var><span class="hyp-type"><b>: </b><span>option message</span></span></span><br><span><var>l1</var><span class="hyp-type"><b>: </b><span>label</span></span></span><br><span><var>Htl</var><span class="hyp-type"><b>: </b><span>infinite_valid_trace_from s
  (Cons
     {|
       l := l1;
       input := iom0;
       destination := s1;
       output := oom0
     |} tr2)</span></span></span><br><span><var>Htr</var><span class="hyp-type"><b>: </b><span>infinite_valid_trace_from <span class="kr">is</span>
  (Cons
     {|
       l := l0;
       input := iom;
       destination := s;
       output := oom
     |}
     (Cons
        {|
          l := l1;
          input := iom0;
          destination := s1;
          output := oom0
        |} tr2))</span></span></span><br><span><var>Ht</var><span class="hyp-type"><b>: </b><span>input_valid_transition l0 (<span class="kr">is</span>, iom) (s, oom)</span></span></span><br><span><var>Htl0</var><span class="hyp-type"><b>: </b><span>infinite_valid_trace_from s1 tr2</span></span></span><br><span><var>Ht0</var><span class="hyp-type"><b>: </b><span>input_valid_transition l1 (s, iom0) (s1, oom0)</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">input_valid_transition
  (l
     {|
       l := l1;
       input := iom0;
       destination := s1;
       output := oom0
     |})
  (destination
     {|
       l := l0;
       input := iom;
       destination := s;
       output := oom
     |},
  input
    {|
      l := l1;
      input := iom0;
      destination := s1;
      output := oom0
    |})
  (destination
     {|
       l := l1;
       input := iom0;
       destination := s1;
       output := oom0
     |},
  output
    {|
      l := l1;
      input := iom0;
      destination := s1;
      output := oom0
    |})</div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="bp">assumption</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">      </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="VLSM-v-chk2a5" style="display: none" type="checkbox"><label class="alectryon-input" for="VLSM-v-chk2a5">-</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>message</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>X</var><span class="hyp-type"><b>: </b><span>VLSM message</span></span></span><br><span><var>TypeX</var><span><span class="hyp-body"><b>:= </b><span>type X</span></span><span class="hyp-type"><b>: </b><span>VLSMType message</span></span></span></span><br><span><var>MachineX</var><span><span class="hyp-body"><b>:= </b><span>machine X</span></span><span class="hyp-type"><b>: </b><span>VLSMMachine (vtype X)</span></span></span></span><br><span><var>tr2</var><span class="hyp-type"><b>: </b><span>Stream transition_item</span></span></span><br><span><var>a</var><span class="hyp-type"><b>: </b><span>transition_item</span></span></span><br><span><var>tr1</var><span class="hyp-type"><b>: </b><span>list transition_item</span></span></span><br><span><var>te1, te2</var><span class="hyp-type"><b>: </b><span>transition_item</span></span></span><br><span><var>IHtr1</var><span class="hyp-type"><b>: </b><span><span class="kr">‚àÄ</span> <span class="nv">tr</span> : Stream transition_item,
  tr = stream_app (tr1 ++ [te1; te2]) tr2
  ‚Üí <span class="kr">‚àÄ</span> <span class="nv">is</span> : state,
      infinite_valid_trace_from <span class="kr">is</span> tr
      ‚Üí input_valid_transition 
          (l te2) (destination te1, input te2)
          (destination te2, output te2)</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="kr">‚àÄ</span> <span class="nv">tr</span> : Stream transition_item,
  tr = stream_app ((a :: tr1) ++ [te1; te2]) tr2
  ‚Üí <span class="kr">‚àÄ</span> <span class="nv">is</span> : state,
      infinite_valid_trace_from <span class="kr">is</span> tr
      ‚Üí input_valid_transition (l te2)
          (destination te1, input te2)
          (destination te2, output te2)</div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="VLSM-v-chk2a6" style="display: none" type="checkbox"><label class="alectryon-input" for="VLSM-v-chk2a6"><span class="nb">specialize</span> (IHtr1 (stream_app (tr1 ++ [te1; te2]) tr2) eq_refl).</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>message</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>X</var><span class="hyp-type"><b>: </b><span>VLSM message</span></span></span><br><span><var>TypeX</var><span><span class="hyp-body"><b>:= </b><span>type X</span></span><span class="hyp-type"><b>: </b><span>VLSMType message</span></span></span></span><br><span><var>MachineX</var><span><span class="hyp-body"><b>:= </b><span>machine X</span></span><span class="hyp-type"><b>: </b><span>VLSMMachine (vtype X)</span></span></span></span><br><span><var>tr2</var><span class="hyp-type"><b>: </b><span>Stream transition_item</span></span></span><br><span><var>a</var><span class="hyp-type"><b>: </b><span>transition_item</span></span></span><br><span><var>tr1</var><span class="hyp-type"><b>: </b><span>list transition_item</span></span></span><br><span><var>te1, te2</var><span class="hyp-type"><b>: </b><span>transition_item</span></span></span><br><span><var>IHtr1</var><span class="hyp-type"><b>: </b><span><span class="kr">‚àÄ</span> <span class="nv">is</span> : state,
  infinite_valid_trace_from <span class="kr">is</span>
    (stream_app (tr1 ++ [te1; te2]) tr2)
  ‚Üí input_valid_transition 
      (l te2) (destination te1, input te2)
      (destination te2, output te2)</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="kr">‚àÄ</span> <span class="nv">tr</span> : Stream transition_item,
  tr = stream_app ((a :: tr1) ++ [te1; te2]) tr2
  ‚Üí <span class="kr">‚àÄ</span> <span class="nv">is</span> : state,
      infinite_valid_trace_from <span class="kr">is</span> tr
      ‚Üí input_valid_transition (l te2)
          (destination te1, input te2)
          (destination te2, output te2)</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">        </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="VLSM-v-chk2a7" style="display: none" type="checkbox"><label class="alectryon-input" for="VLSM-v-chk2a7"><span class="nb">intros</span> tr Heq <span class="kr">is</span> Htr; <span class="nb">subst</span>.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>message</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>X</var><span class="hyp-type"><b>: </b><span>VLSM message</span></span></span><br><span><var>TypeX</var><span><span class="hyp-body"><b>:= </b><span>type X</span></span><span class="hyp-type"><b>: </b><span>VLSMType message</span></span></span></span><br><span><var>MachineX</var><span><span class="hyp-body"><b>:= </b><span>machine X</span></span><span class="hyp-type"><b>: </b><span>VLSMMachine (vtype X)</span></span></span></span><br><span><var>tr2</var><span class="hyp-type"><b>: </b><span>Stream transition_item</span></span></span><br><span><var>a</var><span class="hyp-type"><b>: </b><span>transition_item</span></span></span><br><span><var>tr1</var><span class="hyp-type"><b>: </b><span>list transition_item</span></span></span><br><span><var>te1, te2</var><span class="hyp-type"><b>: </b><span>transition_item</span></span></span><br><span><var>IHtr1</var><span class="hyp-type"><b>: </b><span><span class="kr">‚àÄ</span> <span class="nv">is</span> : state,
  infinite_valid_trace_from <span class="kr">is</span>
    (stream_app (tr1 ++ [te1; te2]) tr2)
  ‚Üí input_valid_transition 
      (l te2) (destination te1, input te2)
      (destination te2, output te2)</span></span></span><br><span><var>is</var><span class="hyp-type"><b>: </b><span>state</span></span></span><br><span><var>Htr</var><span class="hyp-type"><b>: </b><span>infinite_valid_trace_from <span class="kr">is</span>
  (stream_app ((a :: tr1) ++ [te1; te2]) tr2)</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">input_valid_transition (l te2)
  (destination te1, input te2)
  (destination te2, output te2)</div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="VLSM-v-chk2a8" style="display: none" type="checkbox"><label class="alectryon-input" for="VLSM-v-chk2a8"><span class="nb">inversion</span> Htr; <span class="nb">subst</span>.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>message</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>X</var><span class="hyp-type"><b>: </b><span>VLSM message</span></span></span><br><span><var>TypeX</var><span><span class="hyp-body"><b>:= </b><span>type X</span></span><span class="hyp-type"><b>: </b><span>VLSMType message</span></span></span></span><br><span><var>MachineX</var><span><span class="hyp-body"><b>:= </b><span>machine X</span></span><span class="hyp-type"><b>: </b><span>VLSMMachine (vtype X)</span></span></span></span><br><span><var>tr2</var><span class="hyp-type"><b>: </b><span>Stream transition_item</span></span></span><br><span><var>tr1</var><span class="hyp-type"><b>: </b><span>list transition_item</span></span></span><br><span><var>te1, te2</var><span class="hyp-type"><b>: </b><span>transition_item</span></span></span><br><span><var>IHtr1</var><span class="hyp-type"><b>: </b><span><span class="kr">‚àÄ</span> <span class="nv">is</span> : state,
  infinite_valid_trace_from <span class="kr">is</span>
    (stream_app (tr1 ++ [te1; te2]) tr2)
  ‚Üí input_valid_transition 
      (l te2) (destination te1, input te2)
      (destination te2, output te2)</span></span></span><br><span><var>is, s</var><span class="hyp-type"><b>: </b><span>state</span></span></span><br><span><var>iom, oom</var><span class="hyp-type"><b>: </b><span>option message</span></span></span><br><span><var>l0</var><span class="hyp-type"><b>: </b><span>label</span></span></span><br><span><var>Htr</var><span class="hyp-type"><b>: </b><span>infinite_valid_trace_from <span class="kr">is</span>
  (stream_app
     (({|
         l := l0;
         input := iom;
         destination := s;
         output := oom
       |} :: tr1) ++ [te1; te2]) tr2)</span></span></span><br><span><var>Htl</var><span class="hyp-type"><b>: </b><span>infinite_valid_trace_from s
  (stream_app (tr1 ++ [te1; te2]) tr2)</span></span></span><br><span><var>Ht</var><span class="hyp-type"><b>: </b><span>input_valid_transition l0 (<span class="kr">is</span>, iom) (s, oom)</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">input_valid_transition (l te2)
  (destination te1, input te2)
  (destination te2, output te2)</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">        </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="VLSM-v-chk2a9" style="display: none" type="checkbox"><label class="alectryon-input" for="VLSM-v-chk2a9"><span class="nb">specialize</span> (IHtr1 s Htl).</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>message</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>X</var><span class="hyp-type"><b>: </b><span>VLSM message</span></span></span><br><span><var>TypeX</var><span><span class="hyp-body"><b>:= </b><span>type X</span></span><span class="hyp-type"><b>: </b><span>VLSMType message</span></span></span></span><br><span><var>MachineX</var><span><span class="hyp-body"><b>:= </b><span>machine X</span></span><span class="hyp-type"><b>: </b><span>VLSMMachine (vtype X)</span></span></span></span><br><span><var>tr2</var><span class="hyp-type"><b>: </b><span>Stream transition_item</span></span></span><br><span><var>tr1</var><span class="hyp-type"><b>: </b><span>list transition_item</span></span></span><br><span><var>te1, te2</var><span class="hyp-type"><b>: </b><span>transition_item</span></span></span><br><span><var>IHtr1</var><span class="hyp-type"><b>: </b><span>input_valid_transition 
  (l te2) (destination te1, input te2)
  (destination te2, output te2)</span></span></span><br><span><var>is, s</var><span class="hyp-type"><b>: </b><span>state</span></span></span><br><span><var>iom, oom</var><span class="hyp-type"><b>: </b><span>option message</span></span></span><br><span><var>l0</var><span class="hyp-type"><b>: </b><span>label</span></span></span><br><span><var>Htr</var><span class="hyp-type"><b>: </b><span>infinite_valid_trace_from <span class="kr">is</span>
  (stream_app
     (({|
         l := l0;
         input := iom;
         destination := s;
         output := oom
       |} :: tr1) ++ [te1; te2]) tr2)</span></span></span><br><span><var>Htl</var><span class="hyp-type"><b>: </b><span>infinite_valid_trace_from s
  (stream_app (tr1 ++ [te1; te2]) tr2)</span></span></span><br><span><var>Ht</var><span class="hyp-type"><b>: </b><span>input_valid_transition l0 (<span class="kr">is</span>, iom) (s, oom)</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">input_valid_transition (l te2)
  (destination te1, input te2)
  (destination te2, output te2)</div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="bp">assumption</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Qed</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
</span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="VLSM-v-chk2aa" style="display: none" type="checkbox"><label class="alectryon-input" for="VLSM-v-chk2aa"><span class="kn">Lemma</span> <span class="nf">infinite_valid_trace_from_app_iff</span>
      (<span class="nv">s</span> : state)
      (<span class="nv">ls</span> : list transition_item)
      (<span class="nv">ls&#39;</span> : Stream transition_item)
      (<span class="nv">s&#39;</span> := finite_trace_last s ls)
      : finite_valid_trace_from s ls /\ infinite_valid_trace_from s&#39; ls&#39;
        &lt;-&gt;
        infinite_valid_trace_from s (stream_app ls ls&#39;).</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>message</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>X</var><span class="hyp-type"><b>: </b><span>VLSM message</span></span></span><br><span><var>TypeX</var><span><span class="hyp-body"><b>:= </b><span>type X</span></span><span class="hyp-type"><b>: </b><span>VLSMType message</span></span></span></span><br><span><var>MachineX</var><span><span class="hyp-body"><b>:= </b><span>machine X</span></span><span class="hyp-type"><b>: </b><span>VLSMMachine (vtype X)</span></span></span></span><br><span><var>s</var><span class="hyp-type"><b>: </b><span>state</span></span></span><br><span><var>ls</var><span class="hyp-type"><b>: </b><span>list transition_item</span></span></span><br><span><var>ls'</var><span class="hyp-type"><b>: </b><span>Stream transition_item</span></span></span><br><span><var>s'</var><span><span class="hyp-body"><b>:= </b><span>finite_trace_last s ls</span></span><span class="hyp-type"><b>: </b><span>state</span></span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">finite_valid_trace_from s ls
‚àß infinite_valid_trace_from s&#39; ls&#39;
‚Üî infinite_valid_trace_from s (stream_app ls ls&#39;)</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="VLSM-v-chk2ab" style="display: none" type="checkbox"><label class="alectryon-input" for="VLSM-v-chk2ab"><span class="kn">Proof</span>.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>message</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>X</var><span class="hyp-type"><b>: </b><span>VLSM message</span></span></span><br><span><var>TypeX</var><span><span class="hyp-body"><b>:= </b><span>type X</span></span><span class="hyp-type"><b>: </b><span>VLSMType message</span></span></span></span><br><span><var>MachineX</var><span><span class="hyp-body"><b>:= </b><span>machine X</span></span><span class="hyp-type"><b>: </b><span>VLSMMachine (vtype X)</span></span></span></span><br><span><var>s</var><span class="hyp-type"><b>: </b><span>state</span></span></span><br><span><var>ls</var><span class="hyp-type"><b>: </b><span>list transition_item</span></span></span><br><span><var>ls'</var><span class="hyp-type"><b>: </b><span>Stream transition_item</span></span></span><br><span><var>s'</var><span><span class="hyp-body"><b>:= </b><span>finite_trace_last s ls</span></span><span class="hyp-type"><b>: </b><span>state</span></span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">finite_valid_trace_from s ls
‚àß infinite_valid_trace_from s&#39; ls&#39;
‚Üî infinite_valid_trace_from s (stream_app ls ls&#39;)</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">      </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="VLSM-v-chk2ac" style="display: none" type="checkbox"><label class="alectryon-input" for="VLSM-v-chk2ac"><span class="nb">intros</span>.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>message</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>X</var><span class="hyp-type"><b>: </b><span>VLSM message</span></span></span><br><span><var>TypeX</var><span><span class="hyp-body"><b>:= </b><span>type X</span></span><span class="hyp-type"><b>: </b><span>VLSMType message</span></span></span></span><br><span><var>MachineX</var><span><span class="hyp-body"><b>:= </b><span>machine X</span></span><span class="hyp-type"><b>: </b><span>VLSMMachine (vtype X)</span></span></span></span><br><span><var>s</var><span class="hyp-type"><b>: </b><span>state</span></span></span><br><span><var>ls</var><span class="hyp-type"><b>: </b><span>list transition_item</span></span></span><br><span><var>ls'</var><span class="hyp-type"><b>: </b><span>Stream transition_item</span></span></span><br><span><var>s'</var><span><span class="hyp-body"><b>:= </b><span>finite_trace_last s ls</span></span><span class="hyp-type"><b>: </b><span>state</span></span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">finite_valid_trace_from s ls
‚àß infinite_valid_trace_from s&#39; ls&#39;
‚Üî infinite_valid_trace_from s (stream_app ls ls&#39;)</div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="VLSM-v-chk2ad" style="display: none" type="checkbox"><label class="alectryon-input" for="VLSM-v-chk2ad"><span class="nb">generalize dependent</span> ls&#39;.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>message</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>X</var><span class="hyp-type"><b>: </b><span>VLSM message</span></span></span><br><span><var>TypeX</var><span><span class="hyp-body"><b>:= </b><span>type X</span></span><span class="hyp-type"><b>: </b><span>VLSMType message</span></span></span></span><br><span><var>MachineX</var><span><span class="hyp-body"><b>:= </b><span>machine X</span></span><span class="hyp-type"><b>: </b><span>VLSMMachine (vtype X)</span></span></span></span><br><span><var>s</var><span class="hyp-type"><b>: </b><span>state</span></span></span><br><span><var>ls</var><span class="hyp-type"><b>: </b><span>list transition_item</span></span></span><br><span><var>s'</var><span><span class="hyp-body"><b>:= </b><span>finite_trace_last s ls</span></span><span class="hyp-type"><b>: </b><span>state</span></span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="kr">‚àÄ</span> <span class="nv">ls&#39;</span> : Stream transition_item,
  finite_valid_trace_from s ls
  ‚àß infinite_valid_trace_from s&#39; ls&#39;
  ‚Üî infinite_valid_trace_from s (stream_app ls ls&#39;)</div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="VLSM-v-chk2ae" style="display: none" type="checkbox"><label class="alectryon-input" for="VLSM-v-chk2ae"><span class="nb">generalize dependent</span> s.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>message</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>X</var><span class="hyp-type"><b>: </b><span>VLSM message</span></span></span><br><span><var>TypeX</var><span><span class="hyp-body"><b>:= </b><span>type X</span></span><span class="hyp-type"><b>: </b><span>VLSMType message</span></span></span></span><br><span><var>MachineX</var><span><span class="hyp-body"><b>:= </b><span>machine X</span></span><span class="hyp-type"><b>: </b><span>VLSMMachine (vtype X)</span></span></span></span><br><span><var>ls</var><span class="hyp-type"><b>: </b><span>list transition_item</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="kr">‚àÄ</span> (<span class="nv">s</span> : state) (<span class="nv">s&#39;</span> := finite_trace_last s ls) (<span class="nv">ls&#39;</span> : 
                                              Stream
                                                transition_item),
  finite_valid_trace_from s ls
  ‚àß infinite_valid_trace_from s&#39; ls&#39;
  ‚Üî infinite_valid_trace_from s (stream_app ls ls&#39;)</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">      </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="VLSM-v-chk2af" style="display: none" type="checkbox"><label class="alectryon-input" for="VLSM-v-chk2af"><span class="nb">induction</span> ls; <span class="nb">intros</span>; <span class="nb">split</span>.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>message</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>X</var><span class="hyp-type"><b>: </b><span>VLSM message</span></span></span><br><span><var>TypeX</var><span><span class="hyp-body"><b>:= </b><span>type X</span></span><span class="hyp-type"><b>: </b><span>VLSMType message</span></span></span></span><br><span><var>MachineX</var><span><span class="hyp-body"><b>:= </b><span>machine X</span></span><span class="hyp-type"><b>: </b><span>VLSMMachine (vtype X)</span></span></span></span><br><span><var>s</var><span class="hyp-type"><b>: </b><span>state</span></span></span><br><span><var>s'</var><span><span class="hyp-body"><b>:= </b><span>finite_trace_last s []</span></span><span class="hyp-type"><b>: </b><span>state</span></span></span></span><br><span><var>ls'</var><span class="hyp-type"><b>: </b><span>Stream transition_item</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">finite_valid_trace_from s []
‚àß infinite_valid_trace_from s&#39; ls&#39;
‚Üí infinite_valid_trace_from s (stream_app [] ls&#39;)</div></blockquote><div class="alectryon-extra-goals"><input class="alectryon-extra-goal-toggle" id="VLSM-v-chk2b0" style="display: none" type="checkbox"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>message</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>X</var><span class="hyp-type"><b>: </b><span>VLSM message</span></span></span><br><span><var>TypeX</var><span><span class="hyp-body"><b>:= </b><span>type X</span></span><span class="hyp-type"><b>: </b><span>VLSMType message</span></span></span></span><br><span><var>MachineX</var><span><span class="hyp-body"><b>:= </b><span>machine X</span></span><span class="hyp-type"><b>: </b><span>VLSMMachine (vtype X)</span></span></span></span><br><span><var>s</var><span class="hyp-type"><b>: </b><span>state</span></span></span><br><span><var>s'</var><span><span class="hyp-body"><b>:= </b><span>finite_trace_last s []</span></span><span class="hyp-type"><b>: </b><span>state</span></span></span></span><br><span><var>ls'</var><span class="hyp-type"><b>: </b><span>Stream transition_item</span></span></span><br></div><label class="goal-separator" for="VLSM-v-chk2b0"><hr></label><div class="goal-conclusion">infinite_valid_trace_from s (stream_app [] ls&#39;)
‚Üí finite_valid_trace_from s []
  ‚àß infinite_valid_trace_from s&#39; ls&#39;</div></blockquote><input class="alectryon-extra-goal-toggle" id="VLSM-v-chk2b1" style="display: none" type="checkbox"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>message</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>X</var><span class="hyp-type"><b>: </b><span>VLSM message</span></span></span><br><span><var>TypeX</var><span><span class="hyp-body"><b>:= </b><span>type X</span></span><span class="hyp-type"><b>: </b><span>VLSMType message</span></span></span></span><br><span><var>MachineX</var><span><span class="hyp-body"><b>:= </b><span>machine X</span></span><span class="hyp-type"><b>: </b><span>VLSMMachine (vtype X)</span></span></span></span><br><span><var>a</var><span class="hyp-type"><b>: </b><span>transition_item</span></span></span><br><span><var>ls</var><span class="hyp-type"><b>: </b><span>list transition_item</span></span></span><br><span><var>IHls</var><span class="hyp-type"><b>: </b><span><span class="kr">‚àÄ</span> (<span class="nv">s</span> : state) (<span class="nv">s&#39;</span> := finite_trace_last s ls) 
  (<span class="nv">ls&#39;</span> : Stream transition_item),
  finite_valid_trace_from s ls
  ‚àß infinite_valid_trace_from s&#39; ls&#39;
  ‚Üî infinite_valid_trace_from s
      (stream_app ls ls&#39;)</span></span></span><br><span><var>s</var><span class="hyp-type"><b>: </b><span>state</span></span></span><br><span><var>s'</var><span><span class="hyp-body"><b>:= </b><span>finite_trace_last s (a :: ls)</span></span><span class="hyp-type"><b>: </b><span>state</span></span></span></span><br><span><var>ls'</var><span class="hyp-type"><b>: </b><span>Stream transition_item</span></span></span><br></div><label class="goal-separator" for="VLSM-v-chk2b1"><hr></label><div class="goal-conclusion">finite_valid_trace_from s (a :: ls)
‚àß infinite_valid_trace_from s&#39; ls&#39;
‚Üí infinite_valid_trace_from s
    (stream_app (a :: ls) ls&#39;)</div></blockquote><input class="alectryon-extra-goal-toggle" id="VLSM-v-chk2b2" style="display: none" type="checkbox"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>message</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>X</var><span class="hyp-type"><b>: </b><span>VLSM message</span></span></span><br><span><var>TypeX</var><span><span class="hyp-body"><b>:= </b><span>type X</span></span><span class="hyp-type"><b>: </b><span>VLSMType message</span></span></span></span><br><span><var>MachineX</var><span><span class="hyp-body"><b>:= </b><span>machine X</span></span><span class="hyp-type"><b>: </b><span>VLSMMachine (vtype X)</span></span></span></span><br><span><var>a</var><span class="hyp-type"><b>: </b><span>transition_item</span></span></span><br><span><var>ls</var><span class="hyp-type"><b>: </b><span>list transition_item</span></span></span><br><span><var>IHls</var><span class="hyp-type"><b>: </b><span><span class="kr">‚àÄ</span> (<span class="nv">s</span> : state) (<span class="nv">s&#39;</span> := finite_trace_last s ls) 
  (<span class="nv">ls&#39;</span> : Stream transition_item),
  finite_valid_trace_from s ls
  ‚àß infinite_valid_trace_from s&#39; ls&#39;
  ‚Üî infinite_valid_trace_from s
      (stream_app ls ls&#39;)</span></span></span><br><span><var>s</var><span class="hyp-type"><b>: </b><span>state</span></span></span><br><span><var>s'</var><span><span class="hyp-body"><b>:= </b><span>finite_trace_last s (a :: ls)</span></span><span class="hyp-type"><b>: </b><span>state</span></span></span></span><br><span><var>ls'</var><span class="hyp-type"><b>: </b><span>Stream transition_item</span></span></span><br></div><label class="goal-separator" for="VLSM-v-chk2b2"><hr></label><div class="goal-conclusion">infinite_valid_trace_from s (stream_app (a :: ls) ls&#39;)
‚Üí finite_valid_trace_from s (a :: ls)
  ‚àß infinite_valid_trace_from s&#39; ls&#39;</div></blockquote></div></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">      </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="VLSM-v-chk2b3" style="display: none" type="checkbox"><label class="alectryon-input" for="VLSM-v-chk2b3">-</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>message</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>X</var><span class="hyp-type"><b>: </b><span>VLSM message</span></span></span><br><span><var>TypeX</var><span><span class="hyp-body"><b>:= </b><span>type X</span></span><span class="hyp-type"><b>: </b><span>VLSMType message</span></span></span></span><br><span><var>MachineX</var><span><span class="hyp-body"><b>:= </b><span>machine X</span></span><span class="hyp-type"><b>: </b><span>VLSMMachine (vtype X)</span></span></span></span><br><span><var>s</var><span class="hyp-type"><b>: </b><span>state</span></span></span><br><span><var>s'</var><span><span class="hyp-body"><b>:= </b><span>finite_trace_last s []</span></span><span class="hyp-type"><b>: </b><span>state</span></span></span></span><br><span><var>ls'</var><span class="hyp-type"><b>: </b><span>Stream transition_item</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">finite_valid_trace_from s []
‚àß infinite_valid_trace_from s&#39; ls&#39;
‚Üí infinite_valid_trace_from s (stream_app [] ls&#39;)</div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="VLSM-v-chk2b4" style="display: none" type="checkbox"><label class="alectryon-input" for="VLSM-v-chk2b4"><span class="nb">destruct</span> <span class="mi">1</span>.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>message</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>X</var><span class="hyp-type"><b>: </b><span>VLSM message</span></span></span><br><span><var>TypeX</var><span><span class="hyp-body"><b>:= </b><span>type X</span></span><span class="hyp-type"><b>: </b><span>VLSMType message</span></span></span></span><br><span><var>MachineX</var><span><span class="hyp-body"><b>:= </b><span>machine X</span></span><span class="hyp-type"><b>: </b><span>VLSMMachine (vtype X)</span></span></span></span><br><span><var>s</var><span class="hyp-type"><b>: </b><span>state</span></span></span><br><span><var>s'</var><span><span class="hyp-body"><b>:= </b><span>finite_trace_last s []</span></span><span class="hyp-type"><b>: </b><span>state</span></span></span></span><br><span><var>ls'</var><span class="hyp-type"><b>: </b><span>Stream transition_item</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>finite_valid_trace_from s []</span></span></span><br><span><var>H0</var><span class="hyp-type"><b>: </b><span>infinite_valid_trace_from s&#39; ls&#39;</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">infinite_valid_trace_from s (stream_app [] ls&#39;)</div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="bp">assumption</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">      </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="VLSM-v-chk2b5" style="display: none" type="checkbox"><label class="alectryon-input" for="VLSM-v-chk2b5">-</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>message</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>X</var><span class="hyp-type"><b>: </b><span>VLSM message</span></span></span><br><span><var>TypeX</var><span><span class="hyp-body"><b>:= </b><span>type X</span></span><span class="hyp-type"><b>: </b><span>VLSMType message</span></span></span></span><br><span><var>MachineX</var><span><span class="hyp-body"><b>:= </b><span>machine X</span></span><span class="hyp-type"><b>: </b><span>VLSMMachine (vtype X)</span></span></span></span><br><span><var>s</var><span class="hyp-type"><b>: </b><span>state</span></span></span><br><span><var>s'</var><span><span class="hyp-body"><b>:= </b><span>finite_trace_last s []</span></span><span class="hyp-type"><b>: </b><span>state</span></span></span></span><br><span><var>ls'</var><span class="hyp-type"><b>: </b><span>Stream transition_item</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">infinite_valid_trace_from s (stream_app [] ls&#39;)
‚Üí finite_valid_trace_from s []
  ‚àß infinite_valid_trace_from s&#39; ls&#39;</div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="VLSM-v-chk2b6" style="display: none" type="checkbox"><label class="alectryon-input" for="VLSM-v-chk2b6"><span class="nb">simpl</span>; <span class="nb">intros</span> Hls&#39;; <span class="nb">split</span>; <span class="kp">try</span> <span class="bp">assumption</span>.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>message</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>X</var><span class="hyp-type"><b>: </b><span>VLSM message</span></span></span><br><span><var>TypeX</var><span><span class="hyp-body"><b>:= </b><span>type X</span></span><span class="hyp-type"><b>: </b><span>VLSMType message</span></span></span></span><br><span><var>MachineX</var><span><span class="hyp-body"><b>:= </b><span>machine X</span></span><span class="hyp-type"><b>: </b><span>VLSMMachine (vtype X)</span></span></span></span><br><span><var>s</var><span class="hyp-type"><b>: </b><span>state</span></span></span><br><span><var>s'</var><span><span class="hyp-body"><b>:= </b><span>finite_trace_last s []</span></span><span class="hyp-type"><b>: </b><span>state</span></span></span></span><br><span><var>ls'</var><span class="hyp-type"><b>: </b><span>Stream transition_item</span></span></span><br><span><var>Hls'</var><span class="hyp-type"><b>: </b><span>infinite_valid_trace_from s ls&#39;</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">finite_valid_trace_from s []</div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="VLSM-v-chk2b7" style="display: none" type="checkbox"><label class="alectryon-input" for="VLSM-v-chk2b7"><span class="nb">constructor</span>.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>message</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>X</var><span class="hyp-type"><b>: </b><span>VLSM message</span></span></span><br><span><var>TypeX</var><span><span class="hyp-body"><b>:= </b><span>type X</span></span><span class="hyp-type"><b>: </b><span>VLSMType message</span></span></span></span><br><span><var>MachineX</var><span><span class="hyp-body"><b>:= </b><span>machine X</span></span><span class="hyp-type"><b>: </b><span>VLSMMachine (vtype X)</span></span></span></span><br><span><var>s</var><span class="hyp-type"><b>: </b><span>state</span></span></span><br><span><var>s'</var><span><span class="hyp-body"><b>:= </b><span>finite_trace_last s []</span></span><span class="hyp-type"><b>: </b><span>state</span></span></span></span><br><span><var>ls'</var><span class="hyp-type"><b>: </b><span>Stream transition_item</span></span></span><br><span><var>Hls'</var><span class="hyp-type"><b>: </b><span>infinite_valid_trace_from s ls&#39;</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">valid_state_prop s</div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="VLSM-v-chk2b8" style="display: none" type="checkbox"><label class="alectryon-input" for="VLSM-v-chk2b8"><span class="nb">inversion</span> Hls&#39;; <span class="kp">try</span> <span class="bp">assumption</span>.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>message</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>X</var><span class="hyp-type"><b>: </b><span>VLSM message</span></span></span><br><span><var>TypeX</var><span><span class="hyp-body"><b>:= </b><span>type X</span></span><span class="hyp-type"><b>: </b><span>VLSMType message</span></span></span></span><br><span><var>MachineX</var><span><span class="hyp-body"><b>:= </b><span>machine X</span></span><span class="hyp-type"><b>: </b><span>VLSMMachine (vtype X)</span></span></span></span><br><span><var>s</var><span class="hyp-type"><b>: </b><span>state</span></span></span><br><span><var>s'</var><span><span class="hyp-body"><b>:= </b><span>finite_trace_last s []</span></span><span class="hyp-type"><b>: </b><span>state</span></span></span></span><br><span><var>ls'</var><span class="hyp-type"><b>: </b><span>Stream transition_item</span></span></span><br><span><var>Hls'</var><span class="hyp-type"><b>: </b><span>infinite_valid_trace_from s ls&#39;</span></span></span><br><span><var>s1</var><span class="hyp-type"><b>: </b><span>state</span></span></span><br><span><var>tl</var><span class="hyp-type"><b>: </b><span>Stream transition_item</span></span></span><br><span><var>s'0</var><span class="hyp-type"><b>: </b><span>state</span></span></span><br><span><var>iom, oom</var><span class="hyp-type"><b>: </b><span>option message</span></span></span><br><span><var>l0</var><span class="hyp-type"><b>: </b><span>label</span></span></span><br><span><var>Htl</var><span class="hyp-type"><b>: </b><span>infinite_valid_trace_from s1 tl</span></span></span><br><span><var>Ht</var><span class="hyp-type"><b>: </b><span>input_valid_transition l0 (s, iom) (s1, oom)</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>s&#39;0 = s</span></span></span><br><span><var>H0</var><span class="hyp-type"><b>: </b><span>Cons
  {|
    l := l0;
    input := iom;
    destination := s1;
    output := oom
  |} tl = ls&#39;</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">valid_state_prop s</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">        </span><span class="alectryon-sentence"><span class="alectryon-input"><span class="nb">apply</span> (input_valid_transition_origin Ht).</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">      </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="VLSM-v-chk2b9" style="display: none" type="checkbox"><label class="alectryon-input" for="VLSM-v-chk2b9">-</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>message</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>X</var><span class="hyp-type"><b>: </b><span>VLSM message</span></span></span><br><span><var>TypeX</var><span><span class="hyp-body"><b>:= </b><span>type X</span></span><span class="hyp-type"><b>: </b><span>VLSMType message</span></span></span></span><br><span><var>MachineX</var><span><span class="hyp-body"><b>:= </b><span>machine X</span></span><span class="hyp-type"><b>: </b><span>VLSMMachine (vtype X)</span></span></span></span><br><span><var>a</var><span class="hyp-type"><b>: </b><span>transition_item</span></span></span><br><span><var>ls</var><span class="hyp-type"><b>: </b><span>list transition_item</span></span></span><br><span><var>IHls</var><span class="hyp-type"><b>: </b><span><span class="kr">‚àÄ</span> (<span class="nv">s</span> : state) (<span class="nv">s&#39;</span> := finite_trace_last s ls) 
  (<span class="nv">ls&#39;</span> : Stream transition_item),
  finite_valid_trace_from s ls
  ‚àß infinite_valid_trace_from s&#39; ls&#39;
  ‚Üî infinite_valid_trace_from s
      (stream_app ls ls&#39;)</span></span></span><br><span><var>s</var><span class="hyp-type"><b>: </b><span>state</span></span></span><br><span><var>s'</var><span><span class="hyp-body"><b>:= </b><span>finite_trace_last s (a :: ls)</span></span><span class="hyp-type"><b>: </b><span>state</span></span></span></span><br><span><var>ls'</var><span class="hyp-type"><b>: </b><span>Stream transition_item</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">finite_valid_trace_from s (a :: ls)
‚àß infinite_valid_trace_from s&#39; ls&#39;
‚Üí infinite_valid_trace_from s
    (stream_app (a :: ls) ls&#39;)</div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="VLSM-v-chk2ba" style="display: none" type="checkbox"><label class="alectryon-input" for="VLSM-v-chk2ba"><span class="nb">simpl</span>.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>message</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>X</var><span class="hyp-type"><b>: </b><span>VLSM message</span></span></span><br><span><var>TypeX</var><span><span class="hyp-body"><b>:= </b><span>type X</span></span><span class="hyp-type"><b>: </b><span>VLSMType message</span></span></span></span><br><span><var>MachineX</var><span><span class="hyp-body"><b>:= </b><span>machine X</span></span><span class="hyp-type"><b>: </b><span>VLSMMachine (vtype X)</span></span></span></span><br><span><var>a</var><span class="hyp-type"><b>: </b><span>transition_item</span></span></span><br><span><var>ls</var><span class="hyp-type"><b>: </b><span>list transition_item</span></span></span><br><span><var>IHls</var><span class="hyp-type"><b>: </b><span><span class="kr">‚àÄ</span> (<span class="nv">s</span> : state) (<span class="nv">s&#39;</span> := finite_trace_last s ls) 
  (<span class="nv">ls&#39;</span> : Stream transition_item),
  finite_valid_trace_from s ls
  ‚àß infinite_valid_trace_from s&#39; ls&#39;
  ‚Üî infinite_valid_trace_from s
      (stream_app ls ls&#39;)</span></span></span><br><span><var>s</var><span class="hyp-type"><b>: </b><span>state</span></span></span><br><span><var>s'</var><span><span class="hyp-body"><b>:= </b><span>finite_trace_last s (a :: ls)</span></span><span class="hyp-type"><b>: </b><span>state</span></span></span></span><br><span><var>ls'</var><span class="hyp-type"><b>: </b><span>Stream transition_item</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">finite_valid_trace_from s (a :: ls)
‚àß infinite_valid_trace_from s&#39; ls&#39;
‚Üí infinite_valid_trace_from s
    (Cons a (stream_app ls ls&#39;))</div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="VLSM-v-chk2bb" style="display: none" type="checkbox"><label class="alectryon-input" for="VLSM-v-chk2bb"><span class="nb">intros</span> [Htr Htr&#39;].</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>message</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>X</var><span class="hyp-type"><b>: </b><span>VLSM message</span></span></span><br><span><var>TypeX</var><span><span class="hyp-body"><b>:= </b><span>type X</span></span><span class="hyp-type"><b>: </b><span>VLSMType message</span></span></span></span><br><span><var>MachineX</var><span><span class="hyp-body"><b>:= </b><span>machine X</span></span><span class="hyp-type"><b>: </b><span>VLSMMachine (vtype X)</span></span></span></span><br><span><var>a</var><span class="hyp-type"><b>: </b><span>transition_item</span></span></span><br><span><var>ls</var><span class="hyp-type"><b>: </b><span>list transition_item</span></span></span><br><span><var>IHls</var><span class="hyp-type"><b>: </b><span><span class="kr">‚àÄ</span> (<span class="nv">s</span> : state) (<span class="nv">s&#39;</span> := finite_trace_last s ls) 
  (<span class="nv">ls&#39;</span> : Stream transition_item),
  finite_valid_trace_from s ls
  ‚àß infinite_valid_trace_from s&#39; ls&#39;
  ‚Üî infinite_valid_trace_from s
      (stream_app ls ls&#39;)</span></span></span><br><span><var>s</var><span class="hyp-type"><b>: </b><span>state</span></span></span><br><span><var>s'</var><span><span class="hyp-body"><b>:= </b><span>finite_trace_last s (a :: ls)</span></span><span class="hyp-type"><b>: </b><span>state</span></span></span></span><br><span><var>ls'</var><span class="hyp-type"><b>: </b><span>Stream transition_item</span></span></span><br><span><var>Htr</var><span class="hyp-type"><b>: </b><span>finite_valid_trace_from s (a :: ls)</span></span></span><br><span><var>Htr'</var><span class="hyp-type"><b>: </b><span>infinite_valid_trace_from s&#39; ls&#39;</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">infinite_valid_trace_from s
  (Cons a (stream_app ls ls&#39;))</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">        </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="VLSM-v-chk2bc" style="display: none" type="checkbox"><label class="alectryon-input" for="VLSM-v-chk2bc"><span class="nb">destruct</span> a.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>message</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>X</var><span class="hyp-type"><b>: </b><span>VLSM message</span></span></span><br><span><var>TypeX</var><span><span class="hyp-body"><b>:= </b><span>type X</span></span><span class="hyp-type"><b>: </b><span>VLSMType message</span></span></span></span><br><span><var>MachineX</var><span><span class="hyp-body"><b>:= </b><span>machine X</span></span><span class="hyp-type"><b>: </b><span>VLSMMachine (vtype X)</span></span></span></span><br><span><var>l0</var><span class="hyp-type"><b>: </b><span>label</span></span></span><br><span><var>input0</var><span class="hyp-type"><b>: </b><span>option message</span></span></span><br><span><var>destination0</var><span class="hyp-type"><b>: </b><span>state</span></span></span><br><span><var>output0</var><span class="hyp-type"><b>: </b><span>option message</span></span></span><br><span><var>ls</var><span class="hyp-type"><b>: </b><span>list transition_item</span></span></span><br><span><var>IHls</var><span class="hyp-type"><b>: </b><span><span class="kr">‚àÄ</span> (<span class="nv">s</span> : state) (<span class="nv">s&#39;</span> := finite_trace_last s ls) 
  (<span class="nv">ls&#39;</span> : Stream transition_item),
  finite_valid_trace_from s ls
  ‚àß infinite_valid_trace_from s&#39; ls&#39;
  ‚Üî infinite_valid_trace_from s
      (stream_app ls ls&#39;)</span></span></span><br><span><var>s</var><span class="hyp-type"><b>: </b><span>state</span></span></span><br><span><var>s'</var><span><span class="hyp-body"><b>:= </b><span>finite_trace_last s
  ({|
     l := l0;
     input := input0;
     destination := destination0;
     output := output0
   |} :: ls)</span></span><span class="hyp-type"><b>: </b><span>state</span></span></span></span><br><span><var>ls'</var><span class="hyp-type"><b>: </b><span>Stream transition_item</span></span></span><br><span><var>Htr</var><span class="hyp-type"><b>: </b><span>finite_valid_trace_from s
  ({|
     l := l0;
     input := input0;
     destination := destination0;
     output := output0
   |} :: ls)</span></span></span><br><span><var>Htr'</var><span class="hyp-type"><b>: </b><span>infinite_valid_trace_from s&#39; ls&#39;</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">infinite_valid_trace_from s
  (Cons
     {|
       l := l0;
       input := input0;
       destination := destination0;
       output := output0
     |} (stream_app ls ls&#39;))</div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="VLSM-v-chk2bd" style="display: none" type="checkbox"><label class="alectryon-input" for="VLSM-v-chk2bd"><span class="nb">apply</span> infinite_valid_trace_from_extend.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>message</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>X</var><span class="hyp-type"><b>: </b><span>VLSM message</span></span></span><br><span><var>TypeX</var><span><span class="hyp-body"><b>:= </b><span>type X</span></span><span class="hyp-type"><b>: </b><span>VLSMType message</span></span></span></span><br><span><var>MachineX</var><span><span class="hyp-body"><b>:= </b><span>machine X</span></span><span class="hyp-type"><b>: </b><span>VLSMMachine (vtype X)</span></span></span></span><br><span><var>l0</var><span class="hyp-type"><b>: </b><span>label</span></span></span><br><span><var>input0</var><span class="hyp-type"><b>: </b><span>option message</span></span></span><br><span><var>destination0</var><span class="hyp-type"><b>: </b><span>state</span></span></span><br><span><var>output0</var><span class="hyp-type"><b>: </b><span>option message</span></span></span><br><span><var>ls</var><span class="hyp-type"><b>: </b><span>list transition_item</span></span></span><br><span><var>IHls</var><span class="hyp-type"><b>: </b><span><span class="kr">‚àÄ</span> (<span class="nv">s</span> : state) (<span class="nv">s&#39;</span> := finite_trace_last s ls) 
  (<span class="nv">ls&#39;</span> : Stream transition_item),
  finite_valid_trace_from s ls
  ‚àß infinite_valid_trace_from s&#39; ls&#39;
  ‚Üî infinite_valid_trace_from s
      (stream_app ls ls&#39;)</span></span></span><br><span><var>s</var><span class="hyp-type"><b>: </b><span>state</span></span></span><br><span><var>s'</var><span><span class="hyp-body"><b>:= </b><span>finite_trace_last s
  ({|
     l := l0;
     input := input0;
     destination := destination0;
     output := output0
   |} :: ls)</span></span><span class="hyp-type"><b>: </b><span>state</span></span></span></span><br><span><var>ls'</var><span class="hyp-type"><b>: </b><span>Stream transition_item</span></span></span><br><span><var>Htr</var><span class="hyp-type"><b>: </b><span>finite_valid_trace_from s
  ({|
     l := l0;
     input := input0;
     destination := destination0;
     output := output0
   |} :: ls)</span></span></span><br><span><var>Htr'</var><span class="hyp-type"><b>: </b><span>infinite_valid_trace_from s&#39; ls&#39;</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">infinite_valid_trace_from destination0
  (stream_app ls ls&#39;)</div></blockquote><div class="alectryon-extra-goals"><input class="alectryon-extra-goal-toggle" id="VLSM-v-chk2be" style="display: none" type="checkbox"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>message</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>X</var><span class="hyp-type"><b>: </b><span>VLSM message</span></span></span><br><span><var>TypeX</var><span><span class="hyp-body"><b>:= </b><span>type X</span></span><span class="hyp-type"><b>: </b><span>VLSMType message</span></span></span></span><br><span><var>MachineX</var><span><span class="hyp-body"><b>:= </b><span>machine X</span></span><span class="hyp-type"><b>: </b><span>VLSMMachine (vtype X)</span></span></span></span><br><span><var>l0</var><span class="hyp-type"><b>: </b><span>label</span></span></span><br><span><var>input0</var><span class="hyp-type"><b>: </b><span>option message</span></span></span><br><span><var>destination0</var><span class="hyp-type"><b>: </b><span>state</span></span></span><br><span><var>output0</var><span class="hyp-type"><b>: </b><span>option message</span></span></span><br><span><var>ls</var><span class="hyp-type"><b>: </b><span>list transition_item</span></span></span><br><span><var>IHls</var><span class="hyp-type"><b>: </b><span><span class="kr">‚àÄ</span> (<span class="nv">s</span> : state) (<span class="nv">s&#39;</span> := finite_trace_last s ls) 
  (<span class="nv">ls&#39;</span> : Stream transition_item),
  finite_valid_trace_from s ls
  ‚àß infinite_valid_trace_from s&#39; ls&#39;
  ‚Üî infinite_valid_trace_from s
      (stream_app ls ls&#39;)</span></span></span><br><span><var>s</var><span class="hyp-type"><b>: </b><span>state</span></span></span><br><span><var>s'</var><span><span class="hyp-body"><b>:= </b><span>finite_trace_last s
  ({|
     l := l0;
     input := input0;
     destination := destination0;
     output := output0
   |} :: ls)</span></span><span class="hyp-type"><b>: </b><span>state</span></span></span></span><br><span><var>ls'</var><span class="hyp-type"><b>: </b><span>Stream transition_item</span></span></span><br><span><var>Htr</var><span class="hyp-type"><b>: </b><span>finite_valid_trace_from s
  ({|
     l := l0;
     input := input0;
     destination := destination0;
     output := output0
   |} :: ls)</span></span></span><br><span><var>Htr'</var><span class="hyp-type"><b>: </b><span>infinite_valid_trace_from s&#39; ls&#39;</span></span></span><br></div><label class="goal-separator" for="VLSM-v-chk2be"><hr></label><div class="goal-conclusion">input_valid_transition l0 
  (s, input0) (destination0, output0)</div></blockquote></div></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">        </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="VLSM-v-chk2bf" style="display: none" type="checkbox"><label class="alectryon-input" for="VLSM-v-chk2bf">+</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>message</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>X</var><span class="hyp-type"><b>: </b><span>VLSM message</span></span></span><br><span><var>TypeX</var><span><span class="hyp-body"><b>:= </b><span>type X</span></span><span class="hyp-type"><b>: </b><span>VLSMType message</span></span></span></span><br><span><var>MachineX</var><span><span class="hyp-body"><b>:= </b><span>machine X</span></span><span class="hyp-type"><b>: </b><span>VLSMMachine (vtype X)</span></span></span></span><br><span><var>l0</var><span class="hyp-type"><b>: </b><span>label</span></span></span><br><span><var>input0</var><span class="hyp-type"><b>: </b><span>option message</span></span></span><br><span><var>destination0</var><span class="hyp-type"><b>: </b><span>state</span></span></span><br><span><var>output0</var><span class="hyp-type"><b>: </b><span>option message</span></span></span><br><span><var>ls</var><span class="hyp-type"><b>: </b><span>list transition_item</span></span></span><br><span><var>IHls</var><span class="hyp-type"><b>: </b><span><span class="kr">‚àÄ</span> (<span class="nv">s</span> : state) (<span class="nv">s&#39;</span> := finite_trace_last s ls) 
  (<span class="nv">ls&#39;</span> : Stream transition_item),
  finite_valid_trace_from s ls
  ‚àß infinite_valid_trace_from s&#39; ls&#39;
  ‚Üî infinite_valid_trace_from s
      (stream_app ls ls&#39;)</span></span></span><br><span><var>s</var><span class="hyp-type"><b>: </b><span>state</span></span></span><br><span><var>s'</var><span><span class="hyp-body"><b>:= </b><span>finite_trace_last s
  ({|
     l := l0;
     input := input0;
     destination := destination0;
     output := output0
   |} :: ls)</span></span><span class="hyp-type"><b>: </b><span>state</span></span></span></span><br><span><var>ls'</var><span class="hyp-type"><b>: </b><span>Stream transition_item</span></span></span><br><span><var>Htr</var><span class="hyp-type"><b>: </b><span>finite_valid_trace_from s
  ({|
     l := l0;
     input := input0;
     destination := destination0;
     output := output0
   |} :: ls)</span></span></span><br><span><var>Htr'</var><span class="hyp-type"><b>: </b><span>infinite_valid_trace_from s&#39; ls&#39;</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">infinite_valid_trace_from destination0
  (stream_app ls ls&#39;)</div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="VLSM-v-chk2c0" style="display: none" type="checkbox"><label class="alectryon-input" for="VLSM-v-chk2c0"><span class="nb">apply</span> IHls.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>message</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>X</var><span class="hyp-type"><b>: </b><span>VLSM message</span></span></span><br><span><var>TypeX</var><span><span class="hyp-body"><b>:= </b><span>type X</span></span><span class="hyp-type"><b>: </b><span>VLSMType message</span></span></span></span><br><span><var>MachineX</var><span><span class="hyp-body"><b>:= </b><span>machine X</span></span><span class="hyp-type"><b>: </b><span>VLSMMachine (vtype X)</span></span></span></span><br><span><var>l0</var><span class="hyp-type"><b>: </b><span>label</span></span></span><br><span><var>input0</var><span class="hyp-type"><b>: </b><span>option message</span></span></span><br><span><var>destination0</var><span class="hyp-type"><b>: </b><span>state</span></span></span><br><span><var>output0</var><span class="hyp-type"><b>: </b><span>option message</span></span></span><br><span><var>ls</var><span class="hyp-type"><b>: </b><span>list transition_item</span></span></span><br><span><var>IHls</var><span class="hyp-type"><b>: </b><span><span class="kr">‚àÄ</span> (<span class="nv">s</span> : state) (<span class="nv">s&#39;</span> := finite_trace_last s ls) 
  (<span class="nv">ls&#39;</span> : Stream transition_item),
  finite_valid_trace_from s ls
  ‚àß infinite_valid_trace_from s&#39; ls&#39;
  ‚Üî infinite_valid_trace_from s
      (stream_app ls ls&#39;)</span></span></span><br><span><var>s</var><span class="hyp-type"><b>: </b><span>state</span></span></span><br><span><var>s'</var><span><span class="hyp-body"><b>:= </b><span>finite_trace_last s
  ({|
     l := l0;
     input := input0;
     destination := destination0;
     output := output0
   |} :: ls)</span></span><span class="hyp-type"><b>: </b><span>state</span></span></span></span><br><span><var>ls'</var><span class="hyp-type"><b>: </b><span>Stream transition_item</span></span></span><br><span><var>Htr</var><span class="hyp-type"><b>: </b><span>finite_valid_trace_from s
  ({|
     l := l0;
     input := input0;
     destination := destination0;
     output := output0
   |} :: ls)</span></span></span><br><span><var>Htr'</var><span class="hyp-type"><b>: </b><span>infinite_valid_trace_from s&#39; ls&#39;</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">finite_valid_trace_from destination0 ls
‚àß infinite_valid_trace_from
    (finite_trace_last destination0 ls) ls&#39;</div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="VLSM-v-chk2c1" style="display: none" type="checkbox"><label class="alectryon-input" for="VLSM-v-chk2c1"><span class="nb">inversion</span> Htr.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>message</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>X</var><span class="hyp-type"><b>: </b><span>VLSM message</span></span></span><br><span><var>TypeX</var><span><span class="hyp-body"><b>:= </b><span>type X</span></span><span class="hyp-type"><b>: </b><span>VLSMType message</span></span></span></span><br><span><var>MachineX</var><span><span class="hyp-body"><b>:= </b><span>machine X</span></span><span class="hyp-type"><b>: </b><span>VLSMMachine (vtype X)</span></span></span></span><br><span><var>l0</var><span class="hyp-type"><b>: </b><span>label</span></span></span><br><span><var>input0</var><span class="hyp-type"><b>: </b><span>option message</span></span></span><br><span><var>destination0</var><span class="hyp-type"><b>: </b><span>state</span></span></span><br><span><var>output0</var><span class="hyp-type"><b>: </b><span>option message</span></span></span><br><span><var>ls</var><span class="hyp-type"><b>: </b><span>list transition_item</span></span></span><br><span><var>IHls</var><span class="hyp-type"><b>: </b><span><span class="kr">‚àÄ</span> (<span class="nv">s</span> : state) (<span class="nv">s&#39;</span> := finite_trace_last s ls) 
  (<span class="nv">ls&#39;</span> : Stream transition_item),
  finite_valid_trace_from s ls
  ‚àß infinite_valid_trace_from s&#39; ls&#39;
  ‚Üî infinite_valid_trace_from s
      (stream_app ls ls&#39;)</span></span></span><br><span><var>s</var><span class="hyp-type"><b>: </b><span>state</span></span></span><br><span><var>s'</var><span><span class="hyp-body"><b>:= </b><span>finite_trace_last s
  ({|
     l := l0;
     input := input0;
     destination := destination0;
     output := output0
   |} :: ls)</span></span><span class="hyp-type"><b>: </b><span>state</span></span></span></span><br><span><var>ls'</var><span class="hyp-type"><b>: </b><span>Stream transition_item</span></span></span><br><span><var>Htr</var><span class="hyp-type"><b>: </b><span>finite_valid_trace_from s
  ({|
     l := l0;
     input := input0;
     destination := destination0;
     output := output0
   |} :: ls)</span></span></span><br><span><var>Htr'</var><span class="hyp-type"><b>: </b><span>infinite_valid_trace_from s&#39; ls&#39;</span></span></span><br><span><var>s1</var><span class="hyp-type"><b>: </b><span>state</span></span></span><br><span><var>tl</var><span class="hyp-type"><b>: </b><span>list transition_item</span></span></span><br><span><var>s'0</var><span class="hyp-type"><b>: </b><span>state</span></span></span><br><span><var>iom, oom</var><span class="hyp-type"><b>: </b><span>option message</span></span></span><br><span><var>l1</var><span class="hyp-type"><b>: </b><span>label</span></span></span><br><span><var>Htl</var><span class="hyp-type"><b>: </b><span>finite_valid_trace_from destination0 ls</span></span></span><br><span><var>Ht</var><span class="hyp-type"><b>: </b><span>input_valid_transition l0 
  (s, input0) (destination0, output0)</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>s&#39;0 = s</span></span></span><br><span><var>H1</var><span class="hyp-type"><b>: </b><span>l1 = l0</span></span></span><br><span><var>H2</var><span class="hyp-type"><b>: </b><span>iom = input0</span></span></span><br><span><var>H3</var><span class="hyp-type"><b>: </b><span>s1 = destination0</span></span></span><br><span><var>H4</var><span class="hyp-type"><b>: </b><span>oom = output0</span></span></span><br><span><var>H5</var><span class="hyp-type"><b>: </b><span>tl = ls</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">finite_valid_trace_from destination0 ls
‚àß infinite_valid_trace_from
    (finite_trace_last destination0 ls) ls&#39;</div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="VLSM-v-chk2c2" style="display: none" type="checkbox"><label class="alectryon-input" for="VLSM-v-chk2c2"><span class="nb">split</span>.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>message</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>X</var><span class="hyp-type"><b>: </b><span>VLSM message</span></span></span><br><span><var>TypeX</var><span><span class="hyp-body"><b>:= </b><span>type X</span></span><span class="hyp-type"><b>: </b><span>VLSMType message</span></span></span></span><br><span><var>MachineX</var><span><span class="hyp-body"><b>:= </b><span>machine X</span></span><span class="hyp-type"><b>: </b><span>VLSMMachine (vtype X)</span></span></span></span><br><span><var>l0</var><span class="hyp-type"><b>: </b><span>label</span></span></span><br><span><var>input0</var><span class="hyp-type"><b>: </b><span>option message</span></span></span><br><span><var>destination0</var><span class="hyp-type"><b>: </b><span>state</span></span></span><br><span><var>output0</var><span class="hyp-type"><b>: </b><span>option message</span></span></span><br><span><var>ls</var><span class="hyp-type"><b>: </b><span>list transition_item</span></span></span><br><span><var>IHls</var><span class="hyp-type"><b>: </b><span><span class="kr">‚àÄ</span> (<span class="nv">s</span> : state) (<span class="nv">s&#39;</span> := finite_trace_last s ls) 
  (<span class="nv">ls&#39;</span> : Stream transition_item),
  finite_valid_trace_from s ls
  ‚àß infinite_valid_trace_from s&#39; ls&#39;
  ‚Üî infinite_valid_trace_from s
      (stream_app ls ls&#39;)</span></span></span><br><span><var>s</var><span class="hyp-type"><b>: </b><span>state</span></span></span><br><span><var>s'</var><span><span class="hyp-body"><b>:= </b><span>finite_trace_last s
  ({|
     l := l0;
     input := input0;
     destination := destination0;
     output := output0
   |} :: ls)</span></span><span class="hyp-type"><b>: </b><span>state</span></span></span></span><br><span><var>ls'</var><span class="hyp-type"><b>: </b><span>Stream transition_item</span></span></span><br><span><var>Htr</var><span class="hyp-type"><b>: </b><span>finite_valid_trace_from s
  ({|
     l := l0;
     input := input0;
     destination := destination0;
     output := output0
   |} :: ls)</span></span></span><br><span><var>Htr'</var><span class="hyp-type"><b>: </b><span>infinite_valid_trace_from s&#39; ls&#39;</span></span></span><br><span><var>s1</var><span class="hyp-type"><b>: </b><span>state</span></span></span><br><span><var>tl</var><span class="hyp-type"><b>: </b><span>list transition_item</span></span></span><br><span><var>s'0</var><span class="hyp-type"><b>: </b><span>state</span></span></span><br><span><var>iom, oom</var><span class="hyp-type"><b>: </b><span>option message</span></span></span><br><span><var>l1</var><span class="hyp-type"><b>: </b><span>label</span></span></span><br><span><var>Htl</var><span class="hyp-type"><b>: </b><span>finite_valid_trace_from destination0 ls</span></span></span><br><span><var>Ht</var><span class="hyp-type"><b>: </b><span>input_valid_transition l0 
  (s, input0) (destination0, output0)</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>s&#39;0 = s</span></span></span><br><span><var>H1</var><span class="hyp-type"><b>: </b><span>l1 = l0</span></span></span><br><span><var>H2</var><span class="hyp-type"><b>: </b><span>iom = input0</span></span></span><br><span><var>H3</var><span class="hyp-type"><b>: </b><span>s1 = destination0</span></span></span><br><span><var>H4</var><span class="hyp-type"><b>: </b><span>oom = output0</span></span></span><br><span><var>H5</var><span class="hyp-type"><b>: </b><span>tl = ls</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">finite_valid_trace_from destination0 ls</div></blockquote><div class="alectryon-extra-goals"><input class="alectryon-extra-goal-toggle" id="VLSM-v-chk2c3" style="display: none" type="checkbox"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>message</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>X</var><span class="hyp-type"><b>: </b><span>VLSM message</span></span></span><br><span><var>TypeX</var><span><span class="hyp-body"><b>:= </b><span>type X</span></span><span class="hyp-type"><b>: </b><span>VLSMType message</span></span></span></span><br><span><var>MachineX</var><span><span class="hyp-body"><b>:= </b><span>machine X</span></span><span class="hyp-type"><b>: </b><span>VLSMMachine (vtype X)</span></span></span></span><br><span><var>l0</var><span class="hyp-type"><b>: </b><span>label</span></span></span><br><span><var>input0</var><span class="hyp-type"><b>: </b><span>option message</span></span></span><br><span><var>destination0</var><span class="hyp-type"><b>: </b><span>state</span></span></span><br><span><var>output0</var><span class="hyp-type"><b>: </b><span>option message</span></span></span><br><span><var>ls</var><span class="hyp-type"><b>: </b><span>list transition_item</span></span></span><br><span><var>IHls</var><span class="hyp-type"><b>: </b><span><span class="kr">‚àÄ</span> (<span class="nv">s</span> : state) (<span class="nv">s&#39;</span> := finite_trace_last s ls) 
  (<span class="nv">ls&#39;</span> : Stream transition_item),
  finite_valid_trace_from s ls
  ‚àß infinite_valid_trace_from s&#39; ls&#39;
  ‚Üî infinite_valid_trace_from s
      (stream_app ls ls&#39;)</span></span></span><br><span><var>s</var><span class="hyp-type"><b>: </b><span>state</span></span></span><br><span><var>s'</var><span><span class="hyp-body"><b>:= </b><span>finite_trace_last s
  ({|
     l := l0;
     input := input0;
     destination := destination0;
     output := output0
   |} :: ls)</span></span><span class="hyp-type"><b>: </b><span>state</span></span></span></span><br><span><var>ls'</var><span class="hyp-type"><b>: </b><span>Stream transition_item</span></span></span><br><span><var>Htr</var><span class="hyp-type"><b>: </b><span>finite_valid_trace_from s
  ({|
     l := l0;
     input := input0;
     destination := destination0;
     output := output0
   |} :: ls)</span></span></span><br><span><var>Htr'</var><span class="hyp-type"><b>: </b><span>infinite_valid_trace_from s&#39; ls&#39;</span></span></span><br><span><var>s1</var><span class="hyp-type"><b>: </b><span>state</span></span></span><br><span><var>tl</var><span class="hyp-type"><b>: </b><span>list transition_item</span></span></span><br><span><var>s'0</var><span class="hyp-type"><b>: </b><span>state</span></span></span><br><span><var>iom, oom</var><span class="hyp-type"><b>: </b><span>option message</span></span></span><br><span><var>l1</var><span class="hyp-type"><b>: </b><span>label</span></span></span><br><span><var>Htl</var><span class="hyp-type"><b>: </b><span>finite_valid_trace_from destination0 ls</span></span></span><br><span><var>Ht</var><span class="hyp-type"><b>: </b><span>input_valid_transition l0 
  (s, input0) (destination0, output0)</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>s&#39;0 = s</span></span></span><br><span><var>H1</var><span class="hyp-type"><b>: </b><span>l1 = l0</span></span></span><br><span><var>H2</var><span class="hyp-type"><b>: </b><span>iom = input0</span></span></span><br><span><var>H3</var><span class="hyp-type"><b>: </b><span>s1 = destination0</span></span></span><br><span><var>H4</var><span class="hyp-type"><b>: </b><span>oom = output0</span></span></span><br><span><var>H5</var><span class="hyp-type"><b>: </b><span>tl = ls</span></span></span><br></div><label class="goal-separator" for="VLSM-v-chk2c3"><hr></label><div class="goal-conclusion">infinite_valid_trace_from
  (finite_trace_last destination0 ls) ls&#39;</div></blockquote></div></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="VLSM-v-chk2c4" style="display: none" type="checkbox"><label class="alectryon-input" for="VLSM-v-chk2c4"><span class="nb">apply</span> Htl.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>message</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>X</var><span class="hyp-type"><b>: </b><span>VLSM message</span></span></span><br><span><var>TypeX</var><span><span class="hyp-body"><b>:= </b><span>type X</span></span><span class="hyp-type"><b>: </b><span>VLSMType message</span></span></span></span><br><span><var>MachineX</var><span><span class="hyp-body"><b>:= </b><span>machine X</span></span><span class="hyp-type"><b>: </b><span>VLSMMachine (vtype X)</span></span></span></span><br><span><var>l0</var><span class="hyp-type"><b>: </b><span>label</span></span></span><br><span><var>input0</var><span class="hyp-type"><b>: </b><span>option message</span></span></span><br><span><var>destination0</var><span class="hyp-type"><b>: </b><span>state</span></span></span><br><span><var>output0</var><span class="hyp-type"><b>: </b><span>option message</span></span></span><br><span><var>ls</var><span class="hyp-type"><b>: </b><span>list transition_item</span></span></span><br><span><var>IHls</var><span class="hyp-type"><b>: </b><span><span class="kr">‚àÄ</span> (<span class="nv">s</span> : state) (<span class="nv">s&#39;</span> := finite_trace_last s ls) 
  (<span class="nv">ls&#39;</span> : Stream transition_item),
  finite_valid_trace_from s ls
  ‚àß infinite_valid_trace_from s&#39; ls&#39;
  ‚Üî infinite_valid_trace_from s
      (stream_app ls ls&#39;)</span></span></span><br><span><var>s</var><span class="hyp-type"><b>: </b><span>state</span></span></span><br><span><var>s'</var><span><span class="hyp-body"><b>:= </b><span>finite_trace_last s
  ({|
     l := l0;
     input := input0;
     destination := destination0;
     output := output0
   |} :: ls)</span></span><span class="hyp-type"><b>: </b><span>state</span></span></span></span><br><span><var>ls'</var><span class="hyp-type"><b>: </b><span>Stream transition_item</span></span></span><br><span><var>Htr</var><span class="hyp-type"><b>: </b><span>finite_valid_trace_from s
  ({|
     l := l0;
     input := input0;
     destination := destination0;
     output := output0
   |} :: ls)</span></span></span><br><span><var>Htr'</var><span class="hyp-type"><b>: </b><span>infinite_valid_trace_from s&#39; ls&#39;</span></span></span><br><span><var>s1</var><span class="hyp-type"><b>: </b><span>state</span></span></span><br><span><var>tl</var><span class="hyp-type"><b>: </b><span>list transition_item</span></span></span><br><span><var>s'0</var><span class="hyp-type"><b>: </b><span>state</span></span></span><br><span><var>iom, oom</var><span class="hyp-type"><b>: </b><span>option message</span></span></span><br><span><var>l1</var><span class="hyp-type"><b>: </b><span>label</span></span></span><br><span><var>Htl</var><span class="hyp-type"><b>: </b><span>finite_valid_trace_from destination0 ls</span></span></span><br><span><var>Ht</var><span class="hyp-type"><b>: </b><span>input_valid_transition l0 
  (s, input0) (destination0, output0)</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>s&#39;0 = s</span></span></span><br><span><var>H1</var><span class="hyp-type"><b>: </b><span>l1 = l0</span></span></span><br><span><var>H2</var><span class="hyp-type"><b>: </b><span>iom = input0</span></span></span><br><span><var>H3</var><span class="hyp-type"><b>: </b><span>s1 = destination0</span></span></span><br><span><var>H4</var><span class="hyp-type"><b>: </b><span>oom = output0</span></span></span><br><span><var>H5</var><span class="hyp-type"><b>: </b><span>tl = ls</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">infinite_valid_trace_from
  (finite_trace_last destination0 ls) ls&#39;</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">          </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="VLSM-v-chk2c5" style="display: none" type="checkbox"><label class="alectryon-input" for="VLSM-v-chk2c5"><span class="nb">unfold</span> s&#39; <span class="kr">in</span> Htr&#39;.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>message</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>X</var><span class="hyp-type"><b>: </b><span>VLSM message</span></span></span><br><span><var>TypeX</var><span><span class="hyp-body"><b>:= </b><span>type X</span></span><span class="hyp-type"><b>: </b><span>VLSMType message</span></span></span></span><br><span><var>MachineX</var><span><span class="hyp-body"><b>:= </b><span>machine X</span></span><span class="hyp-type"><b>: </b><span>VLSMMachine (vtype X)</span></span></span></span><br><span><var>l0</var><span class="hyp-type"><b>: </b><span>label</span></span></span><br><span><var>input0</var><span class="hyp-type"><b>: </b><span>option message</span></span></span><br><span><var>destination0</var><span class="hyp-type"><b>: </b><span>state</span></span></span><br><span><var>output0</var><span class="hyp-type"><b>: </b><span>option message</span></span></span><br><span><var>ls</var><span class="hyp-type"><b>: </b><span>list transition_item</span></span></span><br><span><var>IHls</var><span class="hyp-type"><b>: </b><span><span class="kr">‚àÄ</span> (<span class="nv">s</span> : state) (<span class="nv">s&#39;</span> := finite_trace_last s ls) 
  (<span class="nv">ls&#39;</span> : Stream transition_item),
  finite_valid_trace_from s ls
  ‚àß infinite_valid_trace_from s&#39; ls&#39;
  ‚Üî infinite_valid_trace_from s
      (stream_app ls ls&#39;)</span></span></span><br><span><var>s</var><span class="hyp-type"><b>: </b><span>state</span></span></span><br><span><var>s'</var><span><span class="hyp-body"><b>:= </b><span>finite_trace_last s
  ({|
     l := l0;
     input := input0;
     destination := destination0;
     output := output0
   |} :: ls)</span></span><span class="hyp-type"><b>: </b><span>state</span></span></span></span><br><span><var>ls'</var><span class="hyp-type"><b>: </b><span>Stream transition_item</span></span></span><br><span><var>Htr</var><span class="hyp-type"><b>: </b><span>finite_valid_trace_from s
  ({|
     l := l0;
     input := input0;
     destination := destination0;
     output := output0
   |} :: ls)</span></span></span><br><span><var>Htr'</var><span class="hyp-type"><b>: </b><span>infinite_valid_trace_from
  (finite_trace_last s
     ({|
        l := l0;
        input := input0;
        destination := destination0;
        output := output0
      |} :: ls)) ls&#39;</span></span></span><br><span><var>s1</var><span class="hyp-type"><b>: </b><span>state</span></span></span><br><span><var>tl</var><span class="hyp-type"><b>: </b><span>list transition_item</span></span></span><br><span><var>s'0</var><span class="hyp-type"><b>: </b><span>state</span></span></span><br><span><var>iom, oom</var><span class="hyp-type"><b>: </b><span>option message</span></span></span><br><span><var>l1</var><span class="hyp-type"><b>: </b><span>label</span></span></span><br><span><var>Htl</var><span class="hyp-type"><b>: </b><span>finite_valid_trace_from destination0 ls</span></span></span><br><span><var>Ht</var><span class="hyp-type"><b>: </b><span>input_valid_transition l0 
  (s, input0) (destination0, output0)</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>s&#39;0 = s</span></span></span><br><span><var>H1</var><span class="hyp-type"><b>: </b><span>l1 = l0</span></span></span><br><span><var>H2</var><span class="hyp-type"><b>: </b><span>iom = input0</span></span></span><br><span><var>H3</var><span class="hyp-type"><b>: </b><span>s1 = destination0</span></span></span><br><span><var>H4</var><span class="hyp-type"><b>: </b><span>oom = output0</span></span></span><br><span><var>H5</var><span class="hyp-type"><b>: </b><span>tl = ls</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">infinite_valid_trace_from
  (finite_trace_last destination0 ls) ls&#39;</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">          </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="VLSM-v-chk2c6" style="display: none" type="checkbox"><label class="alectryon-input" for="VLSM-v-chk2c6"><span class="nb">rewrite</span> finite_trace_last_cons <span class="kr">in</span> Htr&#39;.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>message</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>X</var><span class="hyp-type"><b>: </b><span>VLSM message</span></span></span><br><span><var>TypeX</var><span><span class="hyp-body"><b>:= </b><span>type X</span></span><span class="hyp-type"><b>: </b><span>VLSMType message</span></span></span></span><br><span><var>MachineX</var><span><span class="hyp-body"><b>:= </b><span>machine X</span></span><span class="hyp-type"><b>: </b><span>VLSMMachine (vtype X)</span></span></span></span><br><span><var>l0</var><span class="hyp-type"><b>: </b><span>label</span></span></span><br><span><var>input0</var><span class="hyp-type"><b>: </b><span>option message</span></span></span><br><span><var>destination0</var><span class="hyp-type"><b>: </b><span>state</span></span></span><br><span><var>output0</var><span class="hyp-type"><b>: </b><span>option message</span></span></span><br><span><var>ls</var><span class="hyp-type"><b>: </b><span>list transition_item</span></span></span><br><span><var>IHls</var><span class="hyp-type"><b>: </b><span><span class="kr">‚àÄ</span> (<span class="nv">s</span> : state) (<span class="nv">s&#39;</span> := finite_trace_last s ls) 
  (<span class="nv">ls&#39;</span> : Stream transition_item),
  finite_valid_trace_from s ls
  ‚àß infinite_valid_trace_from s&#39; ls&#39;
  ‚Üî infinite_valid_trace_from s
      (stream_app ls ls&#39;)</span></span></span><br><span><var>s</var><span class="hyp-type"><b>: </b><span>state</span></span></span><br><span><var>s'</var><span><span class="hyp-body"><b>:= </b><span>finite_trace_last s
  ({|
     l := l0;
     input := input0;
     destination := destination0;
     output := output0
   |} :: ls)</span></span><span class="hyp-type"><b>: </b><span>state</span></span></span></span><br><span><var>ls'</var><span class="hyp-type"><b>: </b><span>Stream transition_item</span></span></span><br><span><var>Htr</var><span class="hyp-type"><b>: </b><span>finite_valid_trace_from s
  ({|
     l := l0;
     input := input0;
     destination := destination0;
     output := output0
   |} :: ls)</span></span></span><br><span><var>Htr'</var><span class="hyp-type"><b>: </b><span>infinite_valid_trace_from
  (finite_trace_last
     (destination
        {|
          l := l0;
          input := input0;
          destination := destination0;
          output := output0
        |}) ls) ls&#39;</span></span></span><br><span><var>s1</var><span class="hyp-type"><b>: </b><span>state</span></span></span><br><span><var>tl</var><span class="hyp-type"><b>: </b><span>list transition_item</span></span></span><br><span><var>s'0</var><span class="hyp-type"><b>: </b><span>state</span></span></span><br><span><var>iom, oom</var><span class="hyp-type"><b>: </b><span>option message</span></span></span><br><span><var>l1</var><span class="hyp-type"><b>: </b><span>label</span></span></span><br><span><var>Htl</var><span class="hyp-type"><b>: </b><span>finite_valid_trace_from destination0 ls</span></span></span><br><span><var>Ht</var><span class="hyp-type"><b>: </b><span>input_valid_transition l0 
  (s, input0) (destination0, output0)</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>s&#39;0 = s</span></span></span><br><span><var>H1</var><span class="hyp-type"><b>: </b><span>l1 = l0</span></span></span><br><span><var>H2</var><span class="hyp-type"><b>: </b><span>iom = input0</span></span></span><br><span><var>H3</var><span class="hyp-type"><b>: </b><span>s1 = destination0</span></span></span><br><span><var>H4</var><span class="hyp-type"><b>: </b><span>oom = output0</span></span></span><br><span><var>H5</var><span class="hyp-type"><b>: </b><span>tl = ls</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">infinite_valid_trace_from
  (finite_trace_last destination0 ls) ls&#39;</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">          </span><span class="alectryon-sentence"><span class="alectryon-input"><span class="bp">assumption</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">        </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="VLSM-v-chk2c7" style="display: none" type="checkbox"><label class="alectryon-input" for="VLSM-v-chk2c7">+</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>message</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>X</var><span class="hyp-type"><b>: </b><span>VLSM message</span></span></span><br><span><var>TypeX</var><span><span class="hyp-body"><b>:= </b><span>type X</span></span><span class="hyp-type"><b>: </b><span>VLSMType message</span></span></span></span><br><span><var>MachineX</var><span><span class="hyp-body"><b>:= </b><span>machine X</span></span><span class="hyp-type"><b>: </b><span>VLSMMachine (vtype X)</span></span></span></span><br><span><var>l0</var><span class="hyp-type"><b>: </b><span>label</span></span></span><br><span><var>input0</var><span class="hyp-type"><b>: </b><span>option message</span></span></span><br><span><var>destination0</var><span class="hyp-type"><b>: </b><span>state</span></span></span><br><span><var>output0</var><span class="hyp-type"><b>: </b><span>option message</span></span></span><br><span><var>ls</var><span class="hyp-type"><b>: </b><span>list transition_item</span></span></span><br><span><var>IHls</var><span class="hyp-type"><b>: </b><span><span class="kr">‚àÄ</span> (<span class="nv">s</span> : state) (<span class="nv">s&#39;</span> := finite_trace_last s ls) 
  (<span class="nv">ls&#39;</span> : Stream transition_item),
  finite_valid_trace_from s ls
  ‚àß infinite_valid_trace_from s&#39; ls&#39;
  ‚Üî infinite_valid_trace_from s
      (stream_app ls ls&#39;)</span></span></span><br><span><var>s</var><span class="hyp-type"><b>: </b><span>state</span></span></span><br><span><var>s'</var><span><span class="hyp-body"><b>:= </b><span>finite_trace_last s
  ({|
     l := l0;
     input := input0;
     destination := destination0;
     output := output0
   |} :: ls)</span></span><span class="hyp-type"><b>: </b><span>state</span></span></span></span><br><span><var>ls'</var><span class="hyp-type"><b>: </b><span>Stream transition_item</span></span></span><br><span><var>Htr</var><span class="hyp-type"><b>: </b><span>finite_valid_trace_from s
  ({|
     l := l0;
     input := input0;
     destination := destination0;
     output := output0
   |} :: ls)</span></span></span><br><span><var>Htr'</var><span class="hyp-type"><b>: </b><span>infinite_valid_trace_from s&#39; ls&#39;</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">input_valid_transition l0 (s, input0)
  (destination0, output0)</div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="VLSM-v-chk2c8" style="display: none" type="checkbox"><label class="alectryon-input" for="VLSM-v-chk2c8"><span class="nb">inversion</span> Htr.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>message</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>X</var><span class="hyp-type"><b>: </b><span>VLSM message</span></span></span><br><span><var>TypeX</var><span><span class="hyp-body"><b>:= </b><span>type X</span></span><span class="hyp-type"><b>: </b><span>VLSMType message</span></span></span></span><br><span><var>MachineX</var><span><span class="hyp-body"><b>:= </b><span>machine X</span></span><span class="hyp-type"><b>: </b><span>VLSMMachine (vtype X)</span></span></span></span><br><span><var>l0</var><span class="hyp-type"><b>: </b><span>label</span></span></span><br><span><var>input0</var><span class="hyp-type"><b>: </b><span>option message</span></span></span><br><span><var>destination0</var><span class="hyp-type"><b>: </b><span>state</span></span></span><br><span><var>output0</var><span class="hyp-type"><b>: </b><span>option message</span></span></span><br><span><var>ls</var><span class="hyp-type"><b>: </b><span>list transition_item</span></span></span><br><span><var>IHls</var><span class="hyp-type"><b>: </b><span><span class="kr">‚àÄ</span> (<span class="nv">s</span> : state) (<span class="nv">s&#39;</span> := finite_trace_last s ls) 
  (<span class="nv">ls&#39;</span> : Stream transition_item),
  finite_valid_trace_from s ls
  ‚àß infinite_valid_trace_from s&#39; ls&#39;
  ‚Üî infinite_valid_trace_from s
      (stream_app ls ls&#39;)</span></span></span><br><span><var>s</var><span class="hyp-type"><b>: </b><span>state</span></span></span><br><span><var>s'</var><span><span class="hyp-body"><b>:= </b><span>finite_trace_last s
  ({|
     l := l0;
     input := input0;
     destination := destination0;
     output := output0
   |} :: ls)</span></span><span class="hyp-type"><b>: </b><span>state</span></span></span></span><br><span><var>ls'</var><span class="hyp-type"><b>: </b><span>Stream transition_item</span></span></span><br><span><var>Htr</var><span class="hyp-type"><b>: </b><span>finite_valid_trace_from s
  ({|
     l := l0;
     input := input0;
     destination := destination0;
     output := output0
   |} :: ls)</span></span></span><br><span><var>Htr'</var><span class="hyp-type"><b>: </b><span>infinite_valid_trace_from s&#39; ls&#39;</span></span></span><br><span><var>s1</var><span class="hyp-type"><b>: </b><span>state</span></span></span><br><span><var>tl</var><span class="hyp-type"><b>: </b><span>list transition_item</span></span></span><br><span><var>s'0</var><span class="hyp-type"><b>: </b><span>state</span></span></span><br><span><var>iom, oom</var><span class="hyp-type"><b>: </b><span>option message</span></span></span><br><span><var>l1</var><span class="hyp-type"><b>: </b><span>label</span></span></span><br><span><var>Htl</var><span class="hyp-type"><b>: </b><span>finite_valid_trace_from destination0 ls</span></span></span><br><span><var>Ht</var><span class="hyp-type"><b>: </b><span>input_valid_transition l0 
  (s, input0) (destination0, output0)</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>s&#39;0 = s</span></span></span><br><span><var>H1</var><span class="hyp-type"><b>: </b><span>l1 = l0</span></span></span><br><span><var>H2</var><span class="hyp-type"><b>: </b><span>iom = input0</span></span></span><br><span><var>H3</var><span class="hyp-type"><b>: </b><span>s1 = destination0</span></span></span><br><span><var>H4</var><span class="hyp-type"><b>: </b><span>oom = output0</span></span></span><br><span><var>H5</var><span class="hyp-type"><b>: </b><span>tl = ls</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">input_valid_transition l0 (s, input0)
  (destination0, output0)</div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="nb">apply</span> Ht.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">       </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="VLSM-v-chk2c9" style="display: none" type="checkbox"><label class="alectryon-input" for="VLSM-v-chk2c9">-</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>message</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>X</var><span class="hyp-type"><b>: </b><span>VLSM message</span></span></span><br><span><var>TypeX</var><span><span class="hyp-body"><b>:= </b><span>type X</span></span><span class="hyp-type"><b>: </b><span>VLSMType message</span></span></span></span><br><span><var>MachineX</var><span><span class="hyp-body"><b>:= </b><span>machine X</span></span><span class="hyp-type"><b>: </b><span>VLSMMachine (vtype X)</span></span></span></span><br><span><var>a</var><span class="hyp-type"><b>: </b><span>transition_item</span></span></span><br><span><var>ls</var><span class="hyp-type"><b>: </b><span>list transition_item</span></span></span><br><span><var>IHls</var><span class="hyp-type"><b>: </b><span><span class="kr">‚àÄ</span> (<span class="nv">s</span> : state) (<span class="nv">s&#39;</span> := finite_trace_last s ls) 
  (<span class="nv">ls&#39;</span> : Stream transition_item),
  finite_valid_trace_from s ls
  ‚àß infinite_valid_trace_from s&#39; ls&#39;
  ‚Üî infinite_valid_trace_from s
      (stream_app ls ls&#39;)</span></span></span><br><span><var>s</var><span class="hyp-type"><b>: </b><span>state</span></span></span><br><span><var>s'</var><span><span class="hyp-body"><b>:= </b><span>finite_trace_last s (a :: ls)</span></span><span class="hyp-type"><b>: </b><span>state</span></span></span></span><br><span><var>ls'</var><span class="hyp-type"><b>: </b><span>Stream transition_item</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">infinite_valid_trace_from s (stream_app (a :: ls) ls&#39;)
‚Üí finite_valid_trace_from s (a :: ls)
  ‚àß infinite_valid_trace_from s&#39; ls&#39;</div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="VLSM-v-chk2ca" style="display: none" type="checkbox"><label class="alectryon-input" for="VLSM-v-chk2ca"><span class="nb">inversion</span> <span class="mi">1</span>.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>message</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>X</var><span class="hyp-type"><b>: </b><span>VLSM message</span></span></span><br><span><var>TypeX</var><span><span class="hyp-body"><b>:= </b><span>type X</span></span><span class="hyp-type"><b>: </b><span>VLSMType message</span></span></span></span><br><span><var>MachineX</var><span><span class="hyp-body"><b>:= </b><span>machine X</span></span><span class="hyp-type"><b>: </b><span>VLSMMachine (vtype X)</span></span></span></span><br><span><var>a</var><span class="hyp-type"><b>: </b><span>transition_item</span></span></span><br><span><var>ls</var><span class="hyp-type"><b>: </b><span>list transition_item</span></span></span><br><span><var>IHls</var><span class="hyp-type"><b>: </b><span><span class="kr">‚àÄ</span> (<span class="nv">s</span> : state) (<span class="nv">s&#39;</span> := finite_trace_last s ls) 
  (<span class="nv">ls&#39;</span> : Stream transition_item),
  finite_valid_trace_from s ls
  ‚àß infinite_valid_trace_from s&#39; ls&#39;
  ‚Üî infinite_valid_trace_from s
      (stream_app ls ls&#39;)</span></span></span><br><span><var>s</var><span class="hyp-type"><b>: </b><span>state</span></span></span><br><span><var>s'</var><span><span class="hyp-body"><b>:= </b><span>finite_trace_last s (a :: ls)</span></span><span class="hyp-type"><b>: </b><span>state</span></span></span></span><br><span><var>ls'</var><span class="hyp-type"><b>: </b><span>Stream transition_item</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>infinite_valid_trace_from s
  (stream_app (a :: ls) ls&#39;)</span></span></span><br><span><var>s1</var><span class="hyp-type"><b>: </b><span>state</span></span></span><br><span><var>tl</var><span class="hyp-type"><b>: </b><span>Stream transition_item</span></span></span><br><span><var>s'0</var><span class="hyp-type"><b>: </b><span>state</span></span></span><br><span><var>iom, oom</var><span class="hyp-type"><b>: </b><span>option message</span></span></span><br><span><var>l0</var><span class="hyp-type"><b>: </b><span>label</span></span></span><br><span><var>Htl</var><span class="hyp-type"><b>: </b><span>infinite_valid_trace_from s1 (stream_app ls ls&#39;)</span></span></span><br><span><var>Ht</var><span class="hyp-type"><b>: </b><span>input_valid_transition l0 (s, iom) (s1, oom)</span></span></span><br><span><var>H0</var><span class="hyp-type"><b>: </b><span>s&#39;0 = s</span></span></span><br><span><var>H2</var><span class="hyp-type"><b>: </b><span>{|
  l := l0;
  input := iom;
  destination := s1;
  output := oom
|} = a</span></span></span><br><span><var>H3</var><span class="hyp-type"><b>: </b><span>tl = stream_app ls ls&#39;</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">finite_valid_trace_from s
  ({|
     l := l0;
     input := iom;
     destination := s1;
     output := oom
   |} :: ls) ‚àß infinite_valid_trace_from s&#39; ls&#39;</div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="VLSM-v-chk2cb" style="display: none" type="checkbox"><label class="alectryon-input" for="VLSM-v-chk2cb"><span class="nb">subst</span>.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>message</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>X</var><span class="hyp-type"><b>: </b><span>VLSM message</span></span></span><br><span><var>TypeX</var><span><span class="hyp-body"><b>:= </b><span>type X</span></span><span class="hyp-type"><b>: </b><span>VLSMType message</span></span></span></span><br><span><var>MachineX</var><span><span class="hyp-body"><b>:= </b><span>machine X</span></span><span class="hyp-type"><b>: </b><span>VLSMMachine (vtype X)</span></span></span></span><br><span><var>ls</var><span class="hyp-type"><b>: </b><span>list transition_item</span></span></span><br><span><var>IHls</var><span class="hyp-type"><b>: </b><span><span class="kr">‚àÄ</span> (<span class="nv">s</span> : state) (<span class="nv">s&#39;</span> := finite_trace_last s ls) 
  (<span class="nv">ls&#39;</span> : Stream transition_item),
  finite_valid_trace_from s ls
  ‚àß infinite_valid_trace_from s&#39; ls&#39;
  ‚Üî infinite_valid_trace_from s
      (stream_app ls ls&#39;)</span></span></span><br><span><var>s, s1</var><span class="hyp-type"><b>: </b><span>state</span></span></span><br><span><var>iom, oom</var><span class="hyp-type"><b>: </b><span>option message</span></span></span><br><span><var>l0</var><span class="hyp-type"><b>: </b><span>label</span></span></span><br><span><var>s'</var><span><span class="hyp-body"><b>:= </b><span>finite_trace_last s
  ({|
     l := l0;
     input := iom;
     destination := s1;
     output := oom
   |} :: ls)</span></span><span class="hyp-type"><b>: </b><span>state</span></span></span></span><br><span><var>ls'</var><span class="hyp-type"><b>: </b><span>Stream transition_item</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>infinite_valid_trace_from s
  (stream_app
     ({|
        l := l0;
        input := iom;
        destination := s1;
        output := oom
      |} :: ls) ls&#39;)</span></span></span><br><span><var>Htl</var><span class="hyp-type"><b>: </b><span>infinite_valid_trace_from s1 (stream_app ls ls&#39;)</span></span></span><br><span><var>Ht</var><span class="hyp-type"><b>: </b><span>input_valid_transition l0 (s, iom) (s1, oom)</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">finite_valid_trace_from s
  ({|
     l := l0;
     input := iom;
     destination := s1;
     output := oom
   |} :: ls) ‚àß infinite_valid_trace_from s&#39; ls&#39;</div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="VLSM-v-chk2cc" style="display: none" type="checkbox"><label class="alectryon-input" for="VLSM-v-chk2cc"><span class="nb">specialize</span> (IHls s1).</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>message</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>X</var><span class="hyp-type"><b>: </b><span>VLSM message</span></span></span><br><span><var>TypeX</var><span><span class="hyp-body"><b>:= </b><span>type X</span></span><span class="hyp-type"><b>: </b><span>VLSMType message</span></span></span></span><br><span><var>MachineX</var><span><span class="hyp-body"><b>:= </b><span>machine X</span></span><span class="hyp-type"><b>: </b><span>VLSMMachine (vtype X)</span></span></span></span><br><span><var>ls</var><span class="hyp-type"><b>: </b><span>list transition_item</span></span></span><br><span><var>s1</var><span class="hyp-type"><b>: </b><span>state</span></span></span><br><span><var>IHls</var><span class="hyp-type"><b>: </b><span><span class="kr">‚àÄ</span> (<span class="nv">s&#39;</span> := finite_trace_last s1 ls) 
  (<span class="nv">ls&#39;</span> : Stream transition_item),
  finite_valid_trace_from s1 ls
  ‚àß infinite_valid_trace_from s&#39; ls&#39;
  ‚Üî infinite_valid_trace_from s1
      (stream_app ls ls&#39;)</span></span></span><br><span><var>s</var><span class="hyp-type"><b>: </b><span>state</span></span></span><br><span><var>iom, oom</var><span class="hyp-type"><b>: </b><span>option message</span></span></span><br><span><var>l0</var><span class="hyp-type"><b>: </b><span>label</span></span></span><br><span><var>s'</var><span><span class="hyp-body"><b>:= </b><span>finite_trace_last s
  ({|
     l := l0;
     input := iom;
     destination := s1;
     output := oom
   |} :: ls)</span></span><span class="hyp-type"><b>: </b><span>state</span></span></span></span><br><span><var>ls'</var><span class="hyp-type"><b>: </b><span>Stream transition_item</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>infinite_valid_trace_from s
  (stream_app
     ({|
        l := l0;
        input := iom;
        destination := s1;
        output := oom
      |} :: ls) ls&#39;)</span></span></span><br><span><var>Htl</var><span class="hyp-type"><b>: </b><span>infinite_valid_trace_from s1 (stream_app ls ls&#39;)</span></span></span><br><span><var>Ht</var><span class="hyp-type"><b>: </b><span>input_valid_transition l0 (s, iom) (s1, oom)</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">finite_valid_trace_from s
  ({|
     l := l0;
     input := iom;
     destination := s1;
     output := oom
   |} :: ls) ‚àß infinite_valid_trace_from s&#39; ls&#39;</div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="VLSM-v-chk2cd" style="display: none" type="checkbox"><label class="alectryon-input" for="VLSM-v-chk2cd"><span class="nb">simpl</span> <span class="kr">in</span> IHls.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>message</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>X</var><span class="hyp-type"><b>: </b><span>VLSM message</span></span></span><br><span><var>TypeX</var><span><span class="hyp-body"><b>:= </b><span>type X</span></span><span class="hyp-type"><b>: </b><span>VLSMType message</span></span></span></span><br><span><var>MachineX</var><span><span class="hyp-body"><b>:= </b><span>machine X</span></span><span class="hyp-type"><b>: </b><span>VLSMMachine (vtype X)</span></span></span></span><br><span><var>ls</var><span class="hyp-type"><b>: </b><span>list transition_item</span></span></span><br><span><var>s1</var><span class="hyp-type"><b>: </b><span>state</span></span></span><br><span><var>IHls</var><span class="hyp-type"><b>: </b><span><span class="kr">‚àÄ</span> <span class="nv">ls&#39;</span> : Stream transition_item,
  finite_valid_trace_from s1 ls
  ‚àß infinite_valid_trace_from
      (finite_trace_last s1 ls) ls&#39;
  ‚Üî infinite_valid_trace_from s1
      (stream_app ls ls&#39;)</span></span></span><br><span><var>s</var><span class="hyp-type"><b>: </b><span>state</span></span></span><br><span><var>iom, oom</var><span class="hyp-type"><b>: </b><span>option message</span></span></span><br><span><var>l0</var><span class="hyp-type"><b>: </b><span>label</span></span></span><br><span><var>s'</var><span><span class="hyp-body"><b>:= </b><span>finite_trace_last s
  ({|
     l := l0;
     input := iom;
     destination := s1;
     output := oom
   |} :: ls)</span></span><span class="hyp-type"><b>: </b><span>state</span></span></span></span><br><span><var>ls'</var><span class="hyp-type"><b>: </b><span>Stream transition_item</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>infinite_valid_trace_from s
  (stream_app
     ({|
        l := l0;
        input := iom;
        destination := s1;
        output := oom
      |} :: ls) ls&#39;)</span></span></span><br><span><var>Htl</var><span class="hyp-type"><b>: </b><span>infinite_valid_trace_from s1 (stream_app ls ls&#39;)</span></span></span><br><span><var>Ht</var><span class="hyp-type"><b>: </b><span>input_valid_transition l0 (s, iom) (s1, oom)</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">finite_valid_trace_from s
  ({|
     l := l0;
     input := iom;
     destination := s1;
     output := oom
   |} :: ls) ‚àß infinite_valid_trace_from s&#39; ls&#39;</div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="VLSM-v-chk2ce" style="display: none" type="checkbox"><label class="alectryon-input" for="VLSM-v-chk2ce"><span class="nb">specialize</span> (IHls ls&#39;).</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>message</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>X</var><span class="hyp-type"><b>: </b><span>VLSM message</span></span></span><br><span><var>TypeX</var><span><span class="hyp-body"><b>:= </b><span>type X</span></span><span class="hyp-type"><b>: </b><span>VLSMType message</span></span></span></span><br><span><var>MachineX</var><span><span class="hyp-body"><b>:= </b><span>machine X</span></span><span class="hyp-type"><b>: </b><span>VLSMMachine (vtype X)</span></span></span></span><br><span><var>ls</var><span class="hyp-type"><b>: </b><span>list transition_item</span></span></span><br><span><var>s1</var><span class="hyp-type"><b>: </b><span>state</span></span></span><br><span><var>ls'</var><span class="hyp-type"><b>: </b><span>Stream transition_item</span></span></span><br><span><var>IHls</var><span class="hyp-type"><b>: </b><span>finite_valid_trace_from s1 ls
‚àß infinite_valid_trace_from
    (finite_trace_last s1 ls) ls&#39;
‚Üî infinite_valid_trace_from s1
    (stream_app ls ls&#39;)</span></span></span><br><span><var>s</var><span class="hyp-type"><b>: </b><span>state</span></span></span><br><span><var>iom, oom</var><span class="hyp-type"><b>: </b><span>option message</span></span></span><br><span><var>l0</var><span class="hyp-type"><b>: </b><span>label</span></span></span><br><span><var>s'</var><span><span class="hyp-body"><b>:= </b><span>finite_trace_last s
  ({|
     l := l0;
     input := iom;
     destination := s1;
     output := oom
   |} :: ls)</span></span><span class="hyp-type"><b>: </b><span>state</span></span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>infinite_valid_trace_from s
  (stream_app
     ({|
        l := l0;
        input := iom;
        destination := s1;
        output := oom
      |} :: ls) ls&#39;)</span></span></span><br><span><var>Htl</var><span class="hyp-type"><b>: </b><span>infinite_valid_trace_from s1 (stream_app ls ls&#39;)</span></span></span><br><span><var>Ht</var><span class="hyp-type"><b>: </b><span>input_valid_transition l0 (s, iom) (s1, oom)</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">finite_valid_trace_from s
  ({|
     l := l0;
     input := iom;
     destination := s1;
     output := oom
   |} :: ls) ‚àß infinite_valid_trace_from s&#39; ls&#39;</div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="VLSM-v-chk2cf" style="display: none" type="checkbox"><label class="alectryon-input" for="VLSM-v-chk2cf"><span class="nb">apply</span> IHls <span class="kr">in</span> Htl.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>message</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>X</var><span class="hyp-type"><b>: </b><span>VLSM message</span></span></span><br><span><var>TypeX</var><span><span class="hyp-body"><b>:= </b><span>type X</span></span><span class="hyp-type"><b>: </b><span>VLSMType message</span></span></span></span><br><span><var>MachineX</var><span><span class="hyp-body"><b>:= </b><span>machine X</span></span><span class="hyp-type"><b>: </b><span>VLSMMachine (vtype X)</span></span></span></span><br><span><var>ls</var><span class="hyp-type"><b>: </b><span>list transition_item</span></span></span><br><span><var>s1</var><span class="hyp-type"><b>: </b><span>state</span></span></span><br><span><var>ls'</var><span class="hyp-type"><b>: </b><span>Stream transition_item</span></span></span><br><span><var>IHls</var><span class="hyp-type"><b>: </b><span>finite_valid_trace_from s1 ls
‚àß infinite_valid_trace_from
    (finite_trace_last s1 ls) ls&#39;
‚Üî infinite_valid_trace_from s1
    (stream_app ls ls&#39;)</span></span></span><br><span><var>s</var><span class="hyp-type"><b>: </b><span>state</span></span></span><br><span><var>iom, oom</var><span class="hyp-type"><b>: </b><span>option message</span></span></span><br><span><var>l0</var><span class="hyp-type"><b>: </b><span>label</span></span></span><br><span><var>s'</var><span><span class="hyp-body"><b>:= </b><span>finite_trace_last s
  ({|
     l := l0;
     input := iom;
     destination := s1;
     output := oom
   |} :: ls)</span></span><span class="hyp-type"><b>: </b><span>state</span></span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>infinite_valid_trace_from s
  (stream_app
     ({|
        l := l0;
        input := iom;
        destination := s1;
        output := oom
      |} :: ls) ls&#39;)</span></span></span><br><span><var>Htl</var><span class="hyp-type"><b>: </b><span>finite_valid_trace_from s1 ls
‚àß infinite_valid_trace_from
    (finite_trace_last s1 ls) ls&#39;</span></span></span><br><span><var>Ht</var><span class="hyp-type"><b>: </b><span>input_valid_transition l0 (s, iom) (s1, oom)</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">finite_valid_trace_from s
  ({|
     l := l0;
     input := iom;
     destination := s1;
     output := oom
   |} :: ls) ‚àß infinite_valid_trace_from s&#39; ls&#39;</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">         </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="VLSM-v-chk2d0" style="display: none" type="checkbox"><label class="alectryon-input" for="VLSM-v-chk2d0"><span class="nb">destruct</span> Htl.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>message</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>X</var><span class="hyp-type"><b>: </b><span>VLSM message</span></span></span><br><span><var>TypeX</var><span><span class="hyp-body"><b>:= </b><span>type X</span></span><span class="hyp-type"><b>: </b><span>VLSMType message</span></span></span></span><br><span><var>MachineX</var><span><span class="hyp-body"><b>:= </b><span>machine X</span></span><span class="hyp-type"><b>: </b><span>VLSMMachine (vtype X)</span></span></span></span><br><span><var>ls</var><span class="hyp-type"><b>: </b><span>list transition_item</span></span></span><br><span><var>s1</var><span class="hyp-type"><b>: </b><span>state</span></span></span><br><span><var>ls'</var><span class="hyp-type"><b>: </b><span>Stream transition_item</span></span></span><br><span><var>IHls</var><span class="hyp-type"><b>: </b><span>finite_valid_trace_from s1 ls
‚àß infinite_valid_trace_from
    (finite_trace_last s1 ls) ls&#39;
‚Üî infinite_valid_trace_from s1
    (stream_app ls ls&#39;)</span></span></span><br><span><var>s</var><span class="hyp-type"><b>: </b><span>state</span></span></span><br><span><var>iom, oom</var><span class="hyp-type"><b>: </b><span>option message</span></span></span><br><span><var>l0</var><span class="hyp-type"><b>: </b><span>label</span></span></span><br><span><var>s'</var><span><span class="hyp-body"><b>:= </b><span>finite_trace_last s
  ({|
     l := l0;
     input := iom;
     destination := s1;
     output := oom
   |} :: ls)</span></span><span class="hyp-type"><b>: </b><span>state</span></span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>infinite_valid_trace_from s
  (stream_app
     ({|
        l := l0;
        input := iom;
        destination := s1;
        output := oom
      |} :: ls) ls&#39;)</span></span></span><br><span><var>H0</var><span class="hyp-type"><b>: </b><span>finite_valid_trace_from s1 ls</span></span></span><br><span><var>H1</var><span class="hyp-type"><b>: </b><span>infinite_valid_trace_from
  (finite_trace_last s1 ls) ls&#39;</span></span></span><br><span><var>Ht</var><span class="hyp-type"><b>: </b><span>input_valid_transition l0 (s, iom) (s1, oom)</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">finite_valid_trace_from s
  ({|
     l := l0;
     input := iom;
     destination := s1;
     output := oom
   |} :: ls) ‚àß infinite_valid_trace_from s&#39; ls&#39;</div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="VLSM-v-chk2d1" style="display: none" type="checkbox"><label class="alectryon-input" for="VLSM-v-chk2d1"><span class="nb">split</span>.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>message</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>X</var><span class="hyp-type"><b>: </b><span>VLSM message</span></span></span><br><span><var>TypeX</var><span><span class="hyp-body"><b>:= </b><span>type X</span></span><span class="hyp-type"><b>: </b><span>VLSMType message</span></span></span></span><br><span><var>MachineX</var><span><span class="hyp-body"><b>:= </b><span>machine X</span></span><span class="hyp-type"><b>: </b><span>VLSMMachine (vtype X)</span></span></span></span><br><span><var>ls</var><span class="hyp-type"><b>: </b><span>list transition_item</span></span></span><br><span><var>s1</var><span class="hyp-type"><b>: </b><span>state</span></span></span><br><span><var>ls'</var><span class="hyp-type"><b>: </b><span>Stream transition_item</span></span></span><br><span><var>IHls</var><span class="hyp-type"><b>: </b><span>finite_valid_trace_from s1 ls
‚àß infinite_valid_trace_from
    (finite_trace_last s1 ls) ls&#39;
‚Üî infinite_valid_trace_from s1
    (stream_app ls ls&#39;)</span></span></span><br><span><var>s</var><span class="hyp-type"><b>: </b><span>state</span></span></span><br><span><var>iom, oom</var><span class="hyp-type"><b>: </b><span>option message</span></span></span><br><span><var>l0</var><span class="hyp-type"><b>: </b><span>label</span></span></span><br><span><var>s'</var><span><span class="hyp-body"><b>:= </b><span>finite_trace_last s
  ({|
     l := l0;
     input := iom;
     destination := s1;
     output := oom
   |} :: ls)</span></span><span class="hyp-type"><b>: </b><span>state</span></span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>infinite_valid_trace_from s
  (stream_app
     ({|
        l := l0;
        input := iom;
        destination := s1;
        output := oom
      |} :: ls) ls&#39;)</span></span></span><br><span><var>H0</var><span class="hyp-type"><b>: </b><span>finite_valid_trace_from s1 ls</span></span></span><br><span><var>H1</var><span class="hyp-type"><b>: </b><span>infinite_valid_trace_from
  (finite_trace_last s1 ls) ls&#39;</span></span></span><br><span><var>Ht</var><span class="hyp-type"><b>: </b><span>input_valid_transition l0 (s, iom) (s1, oom)</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">finite_valid_trace_from s
  ({|
     l := l0;
     input := iom;
     destination := s1;
     output := oom
   |} :: ls)</div></blockquote><div class="alectryon-extra-goals"><input class="alectryon-extra-goal-toggle" id="VLSM-v-chk2d2" style="display: none" type="checkbox"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>message</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>X</var><span class="hyp-type"><b>: </b><span>VLSM message</span></span></span><br><span><var>TypeX</var><span><span class="hyp-body"><b>:= </b><span>type X</span></span><span class="hyp-type"><b>: </b><span>VLSMType message</span></span></span></span><br><span><var>MachineX</var><span><span class="hyp-body"><b>:= </b><span>machine X</span></span><span class="hyp-type"><b>: </b><span>VLSMMachine (vtype X)</span></span></span></span><br><span><var>ls</var><span class="hyp-type"><b>: </b><span>list transition_item</span></span></span><br><span><var>s1</var><span class="hyp-type"><b>: </b><span>state</span></span></span><br><span><var>ls'</var><span class="hyp-type"><b>: </b><span>Stream transition_item</span></span></span><br><span><var>IHls</var><span class="hyp-type"><b>: </b><span>finite_valid_trace_from s1 ls
‚àß infinite_valid_trace_from
    (finite_trace_last s1 ls) ls&#39;
‚Üî infinite_valid_trace_from s1
    (stream_app ls ls&#39;)</span></span></span><br><span><var>s</var><span class="hyp-type"><b>: </b><span>state</span></span></span><br><span><var>iom, oom</var><span class="hyp-type"><b>: </b><span>option message</span></span></span><br><span><var>l0</var><span class="hyp-type"><b>: </b><span>label</span></span></span><br><span><var>s'</var><span><span class="hyp-body"><b>:= </b><span>finite_trace_last s
  ({|
     l := l0;
     input := iom;
     destination := s1;
     output := oom
   |} :: ls)</span></span><span class="hyp-type"><b>: </b><span>state</span></span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>infinite_valid_trace_from s
  (stream_app
     ({|
        l := l0;
        input := iom;
        destination := s1;
        output := oom
      |} :: ls) ls&#39;)</span></span></span><br><span><var>H0</var><span class="hyp-type"><b>: </b><span>finite_valid_trace_from s1 ls</span></span></span><br><span><var>H1</var><span class="hyp-type"><b>: </b><span>infinite_valid_trace_from
  (finite_trace_last s1 ls) ls&#39;</span></span></span><br><span><var>Ht</var><span class="hyp-type"><b>: </b><span>input_valid_transition l0 (s, iom) (s1, oom)</span></span></span><br></div><label class="goal-separator" for="VLSM-v-chk2d2"><hr></label><div class="goal-conclusion">infinite_valid_trace_from s&#39; ls&#39;</div></blockquote></div></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">         </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="VLSM-v-chk2d3" style="display: none" type="checkbox"><label class="alectryon-input" for="VLSM-v-chk2d3">+</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>message</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>X</var><span class="hyp-type"><b>: </b><span>VLSM message</span></span></span><br><span><var>TypeX</var><span><span class="hyp-body"><b>:= </b><span>type X</span></span><span class="hyp-type"><b>: </b><span>VLSMType message</span></span></span></span><br><span><var>MachineX</var><span><span class="hyp-body"><b>:= </b><span>machine X</span></span><span class="hyp-type"><b>: </b><span>VLSMMachine (vtype X)</span></span></span></span><br><span><var>ls</var><span class="hyp-type"><b>: </b><span>list transition_item</span></span></span><br><span><var>s1</var><span class="hyp-type"><b>: </b><span>state</span></span></span><br><span><var>ls'</var><span class="hyp-type"><b>: </b><span>Stream transition_item</span></span></span><br><span><var>IHls</var><span class="hyp-type"><b>: </b><span>finite_valid_trace_from s1 ls
‚àß infinite_valid_trace_from
    (finite_trace_last s1 ls) ls&#39;
‚Üî infinite_valid_trace_from s1
    (stream_app ls ls&#39;)</span></span></span><br><span><var>s</var><span class="hyp-type"><b>: </b><span>state</span></span></span><br><span><var>iom, oom</var><span class="hyp-type"><b>: </b><span>option message</span></span></span><br><span><var>l0</var><span class="hyp-type"><b>: </b><span>label</span></span></span><br><span><var>s'</var><span><span class="hyp-body"><b>:= </b><span>finite_trace_last s
  ({|
     l := l0;
     input := iom;
     destination := s1;
     output := oom
   |} :: ls)</span></span><span class="hyp-type"><b>: </b><span>state</span></span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>infinite_valid_trace_from s
  (stream_app
     ({|
        l := l0;
        input := iom;
        destination := s1;
        output := oom
      |} :: ls) ls&#39;)</span></span></span><br><span><var>H0</var><span class="hyp-type"><b>: </b><span>finite_valid_trace_from s1 ls</span></span></span><br><span><var>H1</var><span class="hyp-type"><b>: </b><span>infinite_valid_trace_from
  (finite_trace_last s1 ls) ls&#39;</span></span></span><br><span><var>Ht</var><span class="hyp-type"><b>: </b><span>input_valid_transition l0 (s, iom) (s1, oom)</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">finite_valid_trace_from s
  ({|
     l := l0;
     input := iom;
     destination := s1;
     output := oom
   |} :: ls)</div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="nb">constructor</span>; <span class="bp">assumption</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">         </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="VLSM-v-chk2d4" style="display: none" type="checkbox"><label class="alectryon-input" for="VLSM-v-chk2d4">+</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>message</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>X</var><span class="hyp-type"><b>: </b><span>VLSM message</span></span></span><br><span><var>TypeX</var><span><span class="hyp-body"><b>:= </b><span>type X</span></span><span class="hyp-type"><b>: </b><span>VLSMType message</span></span></span></span><br><span><var>MachineX</var><span><span class="hyp-body"><b>:= </b><span>machine X</span></span><span class="hyp-type"><b>: </b><span>VLSMMachine (vtype X)</span></span></span></span><br><span><var>ls</var><span class="hyp-type"><b>: </b><span>list transition_item</span></span></span><br><span><var>s1</var><span class="hyp-type"><b>: </b><span>state</span></span></span><br><span><var>ls'</var><span class="hyp-type"><b>: </b><span>Stream transition_item</span></span></span><br><span><var>IHls</var><span class="hyp-type"><b>: </b><span>finite_valid_trace_from s1 ls
‚àß infinite_valid_trace_from
    (finite_trace_last s1 ls) ls&#39;
‚Üî infinite_valid_trace_from s1
    (stream_app ls ls&#39;)</span></span></span><br><span><var>s</var><span class="hyp-type"><b>: </b><span>state</span></span></span><br><span><var>iom, oom</var><span class="hyp-type"><b>: </b><span>option message</span></span></span><br><span><var>l0</var><span class="hyp-type"><b>: </b><span>label</span></span></span><br><span><var>s'</var><span><span class="hyp-body"><b>:= </b><span>finite_trace_last s
  ({|
     l := l0;
     input := iom;
     destination := s1;
     output := oom
   |} :: ls)</span></span><span class="hyp-type"><b>: </b><span>state</span></span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>infinite_valid_trace_from s
  (stream_app
     ({|
        l := l0;
        input := iom;
        destination := s1;
        output := oom
      |} :: ls) ls&#39;)</span></span></span><br><span><var>H0</var><span class="hyp-type"><b>: </b><span>finite_valid_trace_from s1 ls</span></span></span><br><span><var>H1</var><span class="hyp-type"><b>: </b><span>infinite_valid_trace_from
  (finite_trace_last s1 ls) ls&#39;</span></span></span><br><span><var>Ht</var><span class="hyp-type"><b>: </b><span>input_valid_transition l0 (s, iom) (s1, oom)</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">infinite_valid_trace_from s&#39; ls&#39;</div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="VLSM-v-chk2d5" style="display: none" type="checkbox"><label class="alectryon-input" for="VLSM-v-chk2d5"><span class="nb">unfold</span> s&#39;.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>message</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>X</var><span class="hyp-type"><b>: </b><span>VLSM message</span></span></span><br><span><var>TypeX</var><span><span class="hyp-body"><b>:= </b><span>type X</span></span><span class="hyp-type"><b>: </b><span>VLSMType message</span></span></span></span><br><span><var>MachineX</var><span><span class="hyp-body"><b>:= </b><span>machine X</span></span><span class="hyp-type"><b>: </b><span>VLSMMachine (vtype X)</span></span></span></span><br><span><var>ls</var><span class="hyp-type"><b>: </b><span>list transition_item</span></span></span><br><span><var>s1</var><span class="hyp-type"><b>: </b><span>state</span></span></span><br><span><var>ls'</var><span class="hyp-type"><b>: </b><span>Stream transition_item</span></span></span><br><span><var>IHls</var><span class="hyp-type"><b>: </b><span>finite_valid_trace_from s1 ls
‚àß infinite_valid_trace_from
    (finite_trace_last s1 ls) ls&#39;
‚Üî infinite_valid_trace_from s1
    (stream_app ls ls&#39;)</span></span></span><br><span><var>s</var><span class="hyp-type"><b>: </b><span>state</span></span></span><br><span><var>iom, oom</var><span class="hyp-type"><b>: </b><span>option message</span></span></span><br><span><var>l0</var><span class="hyp-type"><b>: </b><span>label</span></span></span><br><span><var>s'</var><span><span class="hyp-body"><b>:= </b><span>finite_trace_last s
  ({|
     l := l0;
     input := iom;
     destination := s1;
     output := oom
   |} :: ls)</span></span><span class="hyp-type"><b>: </b><span>state</span></span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>infinite_valid_trace_from s
  (stream_app
     ({|
        l := l0;
        input := iom;
        destination := s1;
        output := oom
      |} :: ls) ls&#39;)</span></span></span><br><span><var>H0</var><span class="hyp-type"><b>: </b><span>finite_valid_trace_from s1 ls</span></span></span><br><span><var>H1</var><span class="hyp-type"><b>: </b><span>infinite_valid_trace_from
  (finite_trace_last s1 ls) ls&#39;</span></span></span><br><span><var>Ht</var><span class="hyp-type"><b>: </b><span>input_valid_transition l0 (s, iom) (s1, oom)</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">infinite_valid_trace_from
  (finite_trace_last s
     ({|
        l := l0;
        input := iom;
        destination := s1;
        output := oom
      |} :: ls)) ls&#39;</div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="VLSM-v-chk2d6" style="display: none" type="checkbox"><label class="alectryon-input" for="VLSM-v-chk2d6"><span class="nb">rewrite</span> finite_trace_last_cons.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>message</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>X</var><span class="hyp-type"><b>: </b><span>VLSM message</span></span></span><br><span><var>TypeX</var><span><span class="hyp-body"><b>:= </b><span>type X</span></span><span class="hyp-type"><b>: </b><span>VLSMType message</span></span></span></span><br><span><var>MachineX</var><span><span class="hyp-body"><b>:= </b><span>machine X</span></span><span class="hyp-type"><b>: </b><span>VLSMMachine (vtype X)</span></span></span></span><br><span><var>ls</var><span class="hyp-type"><b>: </b><span>list transition_item</span></span></span><br><span><var>s1</var><span class="hyp-type"><b>: </b><span>state</span></span></span><br><span><var>ls'</var><span class="hyp-type"><b>: </b><span>Stream transition_item</span></span></span><br><span><var>IHls</var><span class="hyp-type"><b>: </b><span>finite_valid_trace_from s1 ls
‚àß infinite_valid_trace_from
    (finite_trace_last s1 ls) ls&#39;
‚Üî infinite_valid_trace_from s1
    (stream_app ls ls&#39;)</span></span></span><br><span><var>s</var><span class="hyp-type"><b>: </b><span>state</span></span></span><br><span><var>iom, oom</var><span class="hyp-type"><b>: </b><span>option message</span></span></span><br><span><var>l0</var><span class="hyp-type"><b>: </b><span>label</span></span></span><br><span><var>s'</var><span><span class="hyp-body"><b>:= </b><span>finite_trace_last s
  ({|
     l := l0;
     input := iom;
     destination := s1;
     output := oom
   |} :: ls)</span></span><span class="hyp-type"><b>: </b><span>state</span></span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>infinite_valid_trace_from s
  (stream_app
     ({|
        l := l0;
        input := iom;
        destination := s1;
        output := oom
      |} :: ls) ls&#39;)</span></span></span><br><span><var>H0</var><span class="hyp-type"><b>: </b><span>finite_valid_trace_from s1 ls</span></span></span><br><span><var>H1</var><span class="hyp-type"><b>: </b><span>infinite_valid_trace_from
  (finite_trace_last s1 ls) ls&#39;</span></span></span><br><span><var>Ht</var><span class="hyp-type"><b>: </b><span>input_valid_transition l0 (s, iom) (s1, oom)</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">infinite_valid_trace_from
  (finite_trace_last
     (destination
        {|
          l := l0;
          input := iom;
          destination := s1;
          output := oom
        |}) ls) ls&#39;</div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="bp">assumption</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Qed</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
</span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="VLSM-v-chk2d7" style="display: none" type="checkbox"><label class="alectryon-input" for="VLSM-v-chk2d7"><span class="kn">Lemma</span> <span class="nf">infinite_valid_trace_from_prefix</span>
      (<span class="nv">s</span> : state)
      (<span class="nv">ls</span> : Stream transition_item)
      (<span class="nv">Htr</span> : infinite_valid_trace_from s ls)
      (<span class="nv">n</span> : nat)
      : finite_valid_trace_from s (stream_prefix ls n).</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>message</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>X</var><span class="hyp-type"><b>: </b><span>VLSM message</span></span></span><br><span><var>TypeX</var><span><span class="hyp-body"><b>:= </b><span>type X</span></span><span class="hyp-type"><b>: </b><span>VLSMType message</span></span></span></span><br><span><var>MachineX</var><span><span class="hyp-body"><b>:= </b><span>machine X</span></span><span class="hyp-type"><b>: </b><span>VLSMMachine (vtype X)</span></span></span></span><br><span><var>s</var><span class="hyp-type"><b>: </b><span>state</span></span></span><br><span><var>ls</var><span class="hyp-type"><b>: </b><span>Stream transition_item</span></span></span><br><span><var>Htr</var><span class="hyp-type"><b>: </b><span>infinite_valid_trace_from s ls</span></span></span><br><span><var>n</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">finite_valid_trace_from s (stream_prefix ls n)</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="VLSM-v-chk2d8" style="display: none" type="checkbox"><label class="alectryon-input" for="VLSM-v-chk2d8"><span class="kn">Proof</span>.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>message</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>X</var><span class="hyp-type"><b>: </b><span>VLSM message</span></span></span><br><span><var>TypeX</var><span><span class="hyp-body"><b>:= </b><span>type X</span></span><span class="hyp-type"><b>: </b><span>VLSMType message</span></span></span></span><br><span><var>MachineX</var><span><span class="hyp-body"><b>:= </b><span>machine X</span></span><span class="hyp-type"><b>: </b><span>VLSMMachine (vtype X)</span></span></span></span><br><span><var>s</var><span class="hyp-type"><b>: </b><span>state</span></span></span><br><span><var>ls</var><span class="hyp-type"><b>: </b><span>Stream transition_item</span></span></span><br><span><var>Htr</var><span class="hyp-type"><b>: </b><span>infinite_valid_trace_from s ls</span></span></span><br><span><var>n</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">finite_valid_trace_from s (stream_prefix ls n)</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">      </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="VLSM-v-chk2d9" style="display: none" type="checkbox"><label class="alectryon-input" for="VLSM-v-chk2d9"><span class="nb">specialize</span> (stream_prefix_suffix ls n); <span class="nb">intro</span> Hdecompose.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>message</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>X</var><span class="hyp-type"><b>: </b><span>VLSM message</span></span></span><br><span><var>TypeX</var><span><span class="hyp-body"><b>:= </b><span>type X</span></span><span class="hyp-type"><b>: </b><span>VLSMType message</span></span></span></span><br><span><var>MachineX</var><span><span class="hyp-body"><b>:= </b><span>machine X</span></span><span class="hyp-type"><b>: </b><span>VLSMMachine (vtype X)</span></span></span></span><br><span><var>s</var><span class="hyp-type"><b>: </b><span>state</span></span></span><br><span><var>ls</var><span class="hyp-type"><b>: </b><span>Stream transition_item</span></span></span><br><span><var>Htr</var><span class="hyp-type"><b>: </b><span>infinite_valid_trace_from s ls</span></span></span><br><span><var>n</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>Hdecompose</var><span class="hyp-type"><b>: </b><span>stream_app (stream_prefix ls n)
  (stream_suffix ls n) = ls</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">finite_valid_trace_from s (stream_prefix ls n)</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">      </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="VLSM-v-chk2da" style="display: none" type="checkbox"><label class="alectryon-input" for="VLSM-v-chk2da"><span class="nb">rewrite</span> &lt;- Hdecompose <span class="kr">in</span> Htr.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>message</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>X</var><span class="hyp-type"><b>: </b><span>VLSM message</span></span></span><br><span><var>TypeX</var><span><span class="hyp-body"><b>:= </b><span>type X</span></span><span class="hyp-type"><b>: </b><span>VLSMType message</span></span></span></span><br><span><var>MachineX</var><span><span class="hyp-body"><b>:= </b><span>machine X</span></span><span class="hyp-type"><b>: </b><span>VLSMMachine (vtype X)</span></span></span></span><br><span><var>s</var><span class="hyp-type"><b>: </b><span>state</span></span></span><br><span><var>ls</var><span class="hyp-type"><b>: </b><span>Stream transition_item</span></span></span><br><span><var>n</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>Htr</var><span class="hyp-type"><b>: </b><span>infinite_valid_trace_from s
  (stream_app (stream_prefix ls n)
     (stream_suffix ls n))</span></span></span><br><span><var>Hdecompose</var><span class="hyp-type"><b>: </b><span>stream_app (stream_prefix ls n)
  (stream_suffix ls n) = ls</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">finite_valid_trace_from s (stream_prefix ls n)</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">      </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="VLSM-v-chk2db" style="display: none" type="checkbox"><label class="alectryon-input" for="VLSM-v-chk2db"><span class="nb">apply</span> infinite_valid_trace_from_app_iff <span class="kr">in</span> Htr.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>message</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>X</var><span class="hyp-type"><b>: </b><span>VLSM message</span></span></span><br><span><var>TypeX</var><span><span class="hyp-body"><b>:= </b><span>type X</span></span><span class="hyp-type"><b>: </b><span>VLSMType message</span></span></span></span><br><span><var>MachineX</var><span><span class="hyp-body"><b>:= </b><span>machine X</span></span><span class="hyp-type"><b>: </b><span>VLSMMachine (vtype X)</span></span></span></span><br><span><var>s</var><span class="hyp-type"><b>: </b><span>state</span></span></span><br><span><var>ls</var><span class="hyp-type"><b>: </b><span>Stream transition_item</span></span></span><br><span><var>n</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>Htr</var><span class="hyp-type"><b>: </b><span>finite_valid_trace_from s (stream_prefix ls n)
‚àß infinite_valid_trace_from
    (finite_trace_last s (stream_prefix ls n))
    (stream_suffix ls n)</span></span></span><br><span><var>Hdecompose</var><span class="hyp-type"><b>: </b><span>stream_app (stream_prefix ls n)
  (stream_suffix ls n) = ls</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">finite_valid_trace_from s (stream_prefix ls n)</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">      </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="VLSM-v-chk2dc" style="display: none" type="checkbox"><label class="alectryon-input" for="VLSM-v-chk2dc"><span class="nb">destruct</span> Htr <span class="kr">as</span> [Hpr _].</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>message</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>X</var><span class="hyp-type"><b>: </b><span>VLSM message</span></span></span><br><span><var>TypeX</var><span><span class="hyp-body"><b>:= </b><span>type X</span></span><span class="hyp-type"><b>: </b><span>VLSMType message</span></span></span></span><br><span><var>MachineX</var><span><span class="hyp-body"><b>:= </b><span>machine X</span></span><span class="hyp-type"><b>: </b><span>VLSMMachine (vtype X)</span></span></span></span><br><span><var>s</var><span class="hyp-type"><b>: </b><span>state</span></span></span><br><span><var>ls</var><span class="hyp-type"><b>: </b><span>Stream transition_item</span></span></span><br><span><var>n</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>Hpr</var><span class="hyp-type"><b>: </b><span>finite_valid_trace_from s (stream_prefix ls n)</span></span></span><br><span><var>Hdecompose</var><span class="hyp-type"><b>: </b><span>stream_app (stream_prefix ls n)
  (stream_suffix ls n) = ls</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">finite_valid_trace_from s (stream_prefix ls n)</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">      </span><span class="alectryon-sentence"><span class="alectryon-input"><span class="bp">assumption</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Qed</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
</span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="VLSM-v-chk2dd" style="display: none" type="checkbox"><label class="alectryon-input" for="VLSM-v-chk2dd"><span class="kn">Lemma</span> <span class="nf">infinite_valid_trace_from_prefix_rev</span>
      (<span class="nv">s</span> : state)
      (<span class="nv">ls</span> : Stream transition_item)
      (<span class="nv">Hpref</span>: <span class="kr">forall</span> <span class="nv">n</span> : nat, finite_valid_trace_from s (stream_prefix ls n))
      : infinite_valid_trace_from s ls.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>message</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>X</var><span class="hyp-type"><b>: </b><span>VLSM message</span></span></span><br><span><var>TypeX</var><span><span class="hyp-body"><b>:= </b><span>type X</span></span><span class="hyp-type"><b>: </b><span>VLSMType message</span></span></span></span><br><span><var>MachineX</var><span><span class="hyp-body"><b>:= </b><span>machine X</span></span><span class="hyp-type"><b>: </b><span>VLSMMachine (vtype X)</span></span></span></span><br><span><var>s</var><span class="hyp-type"><b>: </b><span>state</span></span></span><br><span><var>ls</var><span class="hyp-type"><b>: </b><span>Stream transition_item</span></span></span><br><span><var>Hpref</var><span class="hyp-type"><b>: </b><span><span class="kr">‚àÄ</span> <span class="nv">n</span> : nat,
  finite_valid_trace_from s
    (stream_prefix ls n)</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">infinite_valid_trace_from s ls</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="VLSM-v-chk2de" style="display: none" type="checkbox"><label class="alectryon-input" for="VLSM-v-chk2de"><span class="kn">Proof</span>.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>message</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>X</var><span class="hyp-type"><b>: </b><span>VLSM message</span></span></span><br><span><var>TypeX</var><span><span class="hyp-body"><b>:= </b><span>type X</span></span><span class="hyp-type"><b>: </b><span>VLSMType message</span></span></span></span><br><span><var>MachineX</var><span><span class="hyp-body"><b>:= </b><span>machine X</span></span><span class="hyp-type"><b>: </b><span>VLSMMachine (vtype X)</span></span></span></span><br><span><var>s</var><span class="hyp-type"><b>: </b><span>state</span></span></span><br><span><var>ls</var><span class="hyp-type"><b>: </b><span>Stream transition_item</span></span></span><br><span><var>Hpref</var><span class="hyp-type"><b>: </b><span><span class="kr">‚àÄ</span> <span class="nv">n</span> : nat,
  finite_valid_trace_from s
    (stream_prefix ls n)</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">infinite_valid_trace_from s ls</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">      </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="VLSM-v-chk2df" style="display: none" type="checkbox"><label class="alectryon-input" for="VLSM-v-chk2df"><span class="nb">revert</span> s ls Hpref.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>message</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>X</var><span class="hyp-type"><b>: </b><span>VLSM message</span></span></span><br><span><var>TypeX</var><span><span class="hyp-body"><b>:= </b><span>type X</span></span><span class="hyp-type"><b>: </b><span>VLSMType message</span></span></span></span><br><span><var>MachineX</var><span><span class="hyp-body"><b>:= </b><span>machine X</span></span><span class="hyp-type"><b>: </b><span>VLSMMachine (vtype X)</span></span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="kr">‚àÄ</span> (<span class="nv">s</span> : state) (<span class="nv">ls</span> : Stream transition_item),
  (<span class="kr">‚àÄ</span> <span class="nv">n</span> : nat,
     finite_valid_trace_from s (stream_prefix ls n))
  ‚Üí infinite_valid_trace_from s ls</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">      </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="VLSM-v-chk2e0" style="display: none" type="checkbox"><label class="alectryon-input" for="VLSM-v-chk2e0"><span class="kr">cofix</span> Hls.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>message</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>X</var><span class="hyp-type"><b>: </b><span>VLSM message</span></span></span><br><span><var>TypeX</var><span><span class="hyp-body"><b>:= </b><span>type X</span></span><span class="hyp-type"><b>: </b><span>VLSMType message</span></span></span></span><br><span><var>MachineX</var><span><span class="hyp-body"><b>:= </b><span>machine X</span></span><span class="hyp-type"><b>: </b><span>VLSMMachine (vtype X)</span></span></span></span><br><span><var>Hls</var><span class="hyp-type"><b>: </b><span><span class="kr">‚àÄ</span> (<span class="nv">s</span> : state) (<span class="nv">ls</span> : Stream transition_item),
  (<span class="kr">‚àÄ</span> <span class="nv">n</span> : nat,
     finite_valid_trace_from s
       (stream_prefix ls n))
  ‚Üí infinite_valid_trace_from s ls</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="kr">‚àÄ</span> (<span class="nv">s</span> : state) (<span class="nv">ls</span> : Stream transition_item),
  (<span class="kr">‚àÄ</span> <span class="nv">n</span> : nat,
     finite_valid_trace_from s (stream_prefix ls n))
  ‚Üí infinite_valid_trace_from s ls</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">      </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="VLSM-v-chk2e1" style="display: none" type="checkbox"><label class="alectryon-input" for="VLSM-v-chk2e1"><span class="nb">intros</span> s (a, ls) Hpref.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>message</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>X</var><span class="hyp-type"><b>: </b><span>VLSM message</span></span></span><br><span><var>TypeX</var><span><span class="hyp-body"><b>:= </b><span>type X</span></span><span class="hyp-type"><b>: </b><span>VLSMType message</span></span></span></span><br><span><var>MachineX</var><span><span class="hyp-body"><b>:= </b><span>machine X</span></span><span class="hyp-type"><b>: </b><span>VLSMMachine (vtype X)</span></span></span></span><br><span><var>Hls</var><span class="hyp-type"><b>: </b><span><span class="kr">‚àÄ</span> (<span class="nv">s</span> : state) (<span class="nv">ls</span> : Stream transition_item),
  (<span class="kr">‚àÄ</span> <span class="nv">n</span> : nat,
     finite_valid_trace_from s
       (stream_prefix ls n))
  ‚Üí infinite_valid_trace_from s ls</span></span></span><br><span><var>s</var><span class="hyp-type"><b>: </b><span>state</span></span></span><br><span><var>a</var><span class="hyp-type"><b>: </b><span>transition_item</span></span></span><br><span><var>ls</var><span class="hyp-type"><b>: </b><span>Stream transition_item</span></span></span><br><span><var>Hpref</var><span class="hyp-type"><b>: </b><span><span class="kr">‚àÄ</span> <span class="nv">n</span> : nat,
  finite_valid_trace_from s
    (stream_prefix (Cons a ls) n)</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">infinite_valid_trace_from s (Cons a ls)</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">      </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="VLSM-v-chk2e2" style="display: none" type="checkbox"><label class="alectryon-input" for="VLSM-v-chk2e2"><span class="nb">assert</span> (Hpref0 := Hpref <span class="mi">1</span>).</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>message</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>X</var><span class="hyp-type"><b>: </b><span>VLSM message</span></span></span><br><span><var>TypeX</var><span><span class="hyp-body"><b>:= </b><span>type X</span></span><span class="hyp-type"><b>: </b><span>VLSMType message</span></span></span></span><br><span><var>MachineX</var><span><span class="hyp-body"><b>:= </b><span>machine X</span></span><span class="hyp-type"><b>: </b><span>VLSMMachine (vtype X)</span></span></span></span><br><span><var>Hls</var><span class="hyp-type"><b>: </b><span><span class="kr">‚àÄ</span> (<span class="nv">s</span> : state) (<span class="nv">ls</span> : Stream transition_item),
  (<span class="kr">‚àÄ</span> <span class="nv">n</span> : nat,
     finite_valid_trace_from s
       (stream_prefix ls n))
  ‚Üí infinite_valid_trace_from s ls</span></span></span><br><span><var>s</var><span class="hyp-type"><b>: </b><span>state</span></span></span><br><span><var>a</var><span class="hyp-type"><b>: </b><span>transition_item</span></span></span><br><span><var>ls</var><span class="hyp-type"><b>: </b><span>Stream transition_item</span></span></span><br><span><var>Hpref</var><span class="hyp-type"><b>: </b><span><span class="kr">‚àÄ</span> <span class="nv">n</span> : nat,
  finite_valid_trace_from s
    (stream_prefix (Cons a ls) n)</span></span></span><br><span><var>Hpref0</var><span class="hyp-type"><b>: </b><span>finite_valid_trace_from s
  (stream_prefix (Cons a ls) <span class="mi">1</span>)</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">infinite_valid_trace_from s (Cons a ls)</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">      </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="VLSM-v-chk2e3" style="display: none" type="checkbox"><label class="alectryon-input" for="VLSM-v-chk2e3"><span class="nb">inversion</span> Hpref0; <span class="nb">subst</span>.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>message</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>X</var><span class="hyp-type"><b>: </b><span>VLSM message</span></span></span><br><span><var>TypeX</var><span><span class="hyp-body"><b>:= </b><span>type X</span></span><span class="hyp-type"><b>: </b><span>VLSMType message</span></span></span></span><br><span><var>MachineX</var><span><span class="hyp-body"><b>:= </b><span>machine X</span></span><span class="hyp-type"><b>: </b><span>VLSMMachine (vtype X)</span></span></span></span><br><span><var>Hls</var><span class="hyp-type"><b>: </b><span><span class="kr">‚àÄ</span> (<span class="nv">s</span> : state) (<span class="nv">ls</span> : Stream transition_item),
  (<span class="kr">‚àÄ</span> <span class="nv">n</span> : nat,
     finite_valid_trace_from s
       (stream_prefix ls n))
  ‚Üí infinite_valid_trace_from s ls</span></span></span><br><span><var>s</var><span class="hyp-type"><b>: </b><span>state</span></span></span><br><span><var>ls</var><span class="hyp-type"><b>: </b><span>Stream transition_item</span></span></span><br><span><var>s1</var><span class="hyp-type"><b>: </b><span>state</span></span></span><br><span><var>iom, oom</var><span class="hyp-type"><b>: </b><span>option message</span></span></span><br><span><var>l0</var><span class="hyp-type"><b>: </b><span>label</span></span></span><br><span><var>Hpref0</var><span class="hyp-type"><b>: </b><span>finite_valid_trace_from s
  (stream_prefix
     (Cons
        {|
          l := l0;
          input := iom;
          destination := s1;
          output := oom
        |} ls) <span class="mi">1</span>)</span></span></span><br><span><var>Hpref</var><span class="hyp-type"><b>: </b><span><span class="kr">‚àÄ</span> <span class="nv">n</span> : nat,
  finite_valid_trace_from s
    (stream_prefix
       (Cons
          {|
            l := l0;
            input := iom;
            destination := s1;
            output := oom
          |} ls) n)</span></span></span><br><span><var>Htl</var><span class="hyp-type"><b>: </b><span>finite_valid_trace_from s1 []</span></span></span><br><span><var>Ht</var><span class="hyp-type"><b>: </b><span>input_valid_transition l0 (s, iom) (s1, oom)</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">infinite_valid_trace_from s
  (Cons
     {|
       l := l0;
       input := iom;
       destination := s1;
       output := oom
     |} ls)</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">      </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="VLSM-v-chk2e4" style="display: none" type="checkbox"><label class="alectryon-input" for="VLSM-v-chk2e4"><span class="nb">constructor</span>; <span class="kp">try</span> <span class="bp">assumption</span>.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>message</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>X</var><span class="hyp-type"><b>: </b><span>VLSM message</span></span></span><br><span><var>TypeX</var><span><span class="hyp-body"><b>:= </b><span>type X</span></span><span class="hyp-type"><b>: </b><span>VLSMType message</span></span></span></span><br><span><var>MachineX</var><span><span class="hyp-body"><b>:= </b><span>machine X</span></span><span class="hyp-type"><b>: </b><span>VLSMMachine (vtype X)</span></span></span></span><br><span><var>Hls</var><span class="hyp-type"><b>: </b><span><span class="kr">‚àÄ</span> (<span class="nv">s</span> : state) (<span class="nv">ls</span> : Stream transition_item),
  (<span class="kr">‚àÄ</span> <span class="nv">n</span> : nat,
     finite_valid_trace_from s
       (stream_prefix ls n))
  ‚Üí infinite_valid_trace_from s ls</span></span></span><br><span><var>s</var><span class="hyp-type"><b>: </b><span>state</span></span></span><br><span><var>ls</var><span class="hyp-type"><b>: </b><span>Stream transition_item</span></span></span><br><span><var>s1</var><span class="hyp-type"><b>: </b><span>state</span></span></span><br><span><var>iom, oom</var><span class="hyp-type"><b>: </b><span>option message</span></span></span><br><span><var>l0</var><span class="hyp-type"><b>: </b><span>label</span></span></span><br><span><var>Hpref0</var><span class="hyp-type"><b>: </b><span>finite_valid_trace_from s
  (stream_prefix
     (Cons
        {|
          l := l0;
          input := iom;
          destination := s1;
          output := oom
        |} ls) <span class="mi">1</span>)</span></span></span><br><span><var>Hpref</var><span class="hyp-type"><b>: </b><span><span class="kr">‚àÄ</span> <span class="nv">n</span> : nat,
  finite_valid_trace_from s
    (stream_prefix
       (Cons
          {|
            l := l0;
            input := iom;
            destination := s1;
            output := oom
          |} ls) n)</span></span></span><br><span><var>Htl</var><span class="hyp-type"><b>: </b><span>finite_valid_trace_from s1 []</span></span></span><br><span><var>Ht</var><span class="hyp-type"><b>: </b><span>input_valid_transition l0 (s, iom) (s1, oom)</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">infinite_valid_trace_from s1 ls</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">      </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="VLSM-v-chk2e5" style="display: none" type="checkbox"><label class="alectryon-input" for="VLSM-v-chk2e5"><span class="nb">apply</span> Hls.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>message</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>X</var><span class="hyp-type"><b>: </b><span>VLSM message</span></span></span><br><span><var>TypeX</var><span><span class="hyp-body"><b>:= </b><span>type X</span></span><span class="hyp-type"><b>: </b><span>VLSMType message</span></span></span></span><br><span><var>MachineX</var><span><span class="hyp-body"><b>:= </b><span>machine X</span></span><span class="hyp-type"><b>: </b><span>VLSMMachine (vtype X)</span></span></span></span><br><span><var>Hls</var><span class="hyp-type"><b>: </b><span><span class="kr">‚àÄ</span> (<span class="nv">s</span> : state) (<span class="nv">ls</span> : Stream transition_item),
  (<span class="kr">‚àÄ</span> <span class="nv">n</span> : nat,
     finite_valid_trace_from s
       (stream_prefix ls n))
  ‚Üí infinite_valid_trace_from s ls</span></span></span><br><span><var>s</var><span class="hyp-type"><b>: </b><span>state</span></span></span><br><span><var>ls</var><span class="hyp-type"><b>: </b><span>Stream transition_item</span></span></span><br><span><var>s1</var><span class="hyp-type"><b>: </b><span>state</span></span></span><br><span><var>iom, oom</var><span class="hyp-type"><b>: </b><span>option message</span></span></span><br><span><var>l0</var><span class="hyp-type"><b>: </b><span>label</span></span></span><br><span><var>Hpref0</var><span class="hyp-type"><b>: </b><span>finite_valid_trace_from s
  (stream_prefix
     (Cons
        {|
          l := l0;
          input := iom;
          destination := s1;
          output := oom
        |} ls) <span class="mi">1</span>)</span></span></span><br><span><var>Hpref</var><span class="hyp-type"><b>: </b><span><span class="kr">‚àÄ</span> <span class="nv">n</span> : nat,
  finite_valid_trace_from s
    (stream_prefix
       (Cons
          {|
            l := l0;
            input := iom;
            destination := s1;
            output := oom
          |} ls) n)</span></span></span><br><span><var>Htl</var><span class="hyp-type"><b>: </b><span>finite_valid_trace_from s1 []</span></span></span><br><span><var>Ht</var><span class="hyp-type"><b>: </b><span>input_valid_transition l0 (s, iom) (s1, oom)</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="kr">‚àÄ</span> <span class="nv">n</span> : nat,
  finite_valid_trace_from s1 (stream_prefix ls n)</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">      </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="VLSM-v-chk2e6" style="display: none" type="checkbox"><label class="alectryon-input" for="VLSM-v-chk2e6"><span class="nb">intro</span> n.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>message</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>X</var><span class="hyp-type"><b>: </b><span>VLSM message</span></span></span><br><span><var>TypeX</var><span><span class="hyp-body"><b>:= </b><span>type X</span></span><span class="hyp-type"><b>: </b><span>VLSMType message</span></span></span></span><br><span><var>MachineX</var><span><span class="hyp-body"><b>:= </b><span>machine X</span></span><span class="hyp-type"><b>: </b><span>VLSMMachine (vtype X)</span></span></span></span><br><span><var>Hls</var><span class="hyp-type"><b>: </b><span><span class="kr">‚àÄ</span> (<span class="nv">s</span> : state) (<span class="nv">ls</span> : Stream transition_item),
  (<span class="kr">‚àÄ</span> <span class="nv">n</span> : nat,
     finite_valid_trace_from s
       (stream_prefix ls n))
  ‚Üí infinite_valid_trace_from s ls</span></span></span><br><span><var>s</var><span class="hyp-type"><b>: </b><span>state</span></span></span><br><span><var>ls</var><span class="hyp-type"><b>: </b><span>Stream transition_item</span></span></span><br><span><var>s1</var><span class="hyp-type"><b>: </b><span>state</span></span></span><br><span><var>iom, oom</var><span class="hyp-type"><b>: </b><span>option message</span></span></span><br><span><var>l0</var><span class="hyp-type"><b>: </b><span>label</span></span></span><br><span><var>Hpref0</var><span class="hyp-type"><b>: </b><span>finite_valid_trace_from s
  (stream_prefix
     (Cons
        {|
          l := l0;
          input := iom;
          destination := s1;
          output := oom
        |} ls) <span class="mi">1</span>)</span></span></span><br><span><var>Hpref</var><span class="hyp-type"><b>: </b><span><span class="kr">‚àÄ</span> <span class="nv">n</span> : nat,
  finite_valid_trace_from s
    (stream_prefix
       (Cons
          {|
            l := l0;
            input := iom;
            destination := s1;
            output := oom
          |} ls) n)</span></span></span><br><span><var>Htl</var><span class="hyp-type"><b>: </b><span>finite_valid_trace_from s1 []</span></span></span><br><span><var>Ht</var><span class="hyp-type"><b>: </b><span>input_valid_transition l0 (s, iom) (s1, oom)</span></span></span><br><span><var>n</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">finite_valid_trace_from s1 (stream_prefix ls n)</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">      </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="VLSM-v-chk2e7" style="display: none" type="checkbox"><label class="alectryon-input" for="VLSM-v-chk2e7"><span class="nb">specialize</span> (Hpref (S n)).</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>message</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>X</var><span class="hyp-type"><b>: </b><span>VLSM message</span></span></span><br><span><var>TypeX</var><span><span class="hyp-body"><b>:= </b><span>type X</span></span><span class="hyp-type"><b>: </b><span>VLSMType message</span></span></span></span><br><span><var>MachineX</var><span><span class="hyp-body"><b>:= </b><span>machine X</span></span><span class="hyp-type"><b>: </b><span>VLSMMachine (vtype X)</span></span></span></span><br><span><var>Hls</var><span class="hyp-type"><b>: </b><span><span class="kr">‚àÄ</span> (<span class="nv">s</span> : state) (<span class="nv">ls</span> : Stream transition_item),
  (<span class="kr">‚àÄ</span> <span class="nv">n</span> : nat,
     finite_valid_trace_from s
       (stream_prefix ls n))
  ‚Üí infinite_valid_trace_from s ls</span></span></span><br><span><var>s</var><span class="hyp-type"><b>: </b><span>state</span></span></span><br><span><var>ls</var><span class="hyp-type"><b>: </b><span>Stream transition_item</span></span></span><br><span><var>s1</var><span class="hyp-type"><b>: </b><span>state</span></span></span><br><span><var>iom, oom</var><span class="hyp-type"><b>: </b><span>option message</span></span></span><br><span><var>l0</var><span class="hyp-type"><b>: </b><span>label</span></span></span><br><span><var>Hpref0</var><span class="hyp-type"><b>: </b><span>finite_valid_trace_from s
  (stream_prefix
     (Cons
        {|
          l := l0;
          input := iom;
          destination := s1;
          output := oom
        |} ls) <span class="mi">1</span>)</span></span></span><br><span><var>n</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>Hpref</var><span class="hyp-type"><b>: </b><span>finite_valid_trace_from s
  (stream_prefix
     (Cons
        {|
          l := l0;
          input := iom;
          destination := s1;
          output := oom
        |} ls) (S n))</span></span></span><br><span><var>Htl</var><span class="hyp-type"><b>: </b><span>finite_valid_trace_from s1 []</span></span></span><br><span><var>Ht</var><span class="hyp-type"><b>: </b><span>input_valid_transition l0 (s, iom) (s1, oom)</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">finite_valid_trace_from s1 (stream_prefix ls n)</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">      </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="VLSM-v-chk2e8" style="display: none" type="checkbox"><label class="alectryon-input" for="VLSM-v-chk2e8"><span class="nb">simpl</span> <span class="kr">in</span> Hpref.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>message</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>X</var><span class="hyp-type"><b>: </b><span>VLSM message</span></span></span><br><span><var>TypeX</var><span><span class="hyp-body"><b>:= </b><span>type X</span></span><span class="hyp-type"><b>: </b><span>VLSMType message</span></span></span></span><br><span><var>MachineX</var><span><span class="hyp-body"><b>:= </b><span>machine X</span></span><span class="hyp-type"><b>: </b><span>VLSMMachine (vtype X)</span></span></span></span><br><span><var>Hls</var><span class="hyp-type"><b>: </b><span><span class="kr">‚àÄ</span> (<span class="nv">s</span> : state) (<span class="nv">ls</span> : Stream transition_item),
  (<span class="kr">‚àÄ</span> <span class="nv">n</span> : nat,
     finite_valid_trace_from s
       (stream_prefix ls n))
  ‚Üí infinite_valid_trace_from s ls</span></span></span><br><span><var>s</var><span class="hyp-type"><b>: </b><span>state</span></span></span><br><span><var>ls</var><span class="hyp-type"><b>: </b><span>Stream transition_item</span></span></span><br><span><var>s1</var><span class="hyp-type"><b>: </b><span>state</span></span></span><br><span><var>iom, oom</var><span class="hyp-type"><b>: </b><span>option message</span></span></span><br><span><var>l0</var><span class="hyp-type"><b>: </b><span>label</span></span></span><br><span><var>Hpref0</var><span class="hyp-type"><b>: </b><span>finite_valid_trace_from s
  (stream_prefix
     (Cons
        {|
          l := l0;
          input := iom;
          destination := s1;
          output := oom
        |} ls) <span class="mi">1</span>)</span></span></span><br><span><var>n</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>Hpref</var><span class="hyp-type"><b>: </b><span>finite_valid_trace_from s
  ({|
     l := l0;
     input := iom;
     destination := s1;
     output := oom
   |} :: stream_prefix ls n)</span></span></span><br><span><var>Htl</var><span class="hyp-type"><b>: </b><span>finite_valid_trace_from s1 []</span></span></span><br><span><var>Ht</var><span class="hyp-type"><b>: </b><span>input_valid_transition l0 (s, iom) (s1, oom)</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">finite_valid_trace_from s1 (stream_prefix ls n)</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">      </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="VLSM-v-chk2e9" style="display: none" type="checkbox"><label class="alectryon-input" for="VLSM-v-chk2e9"><span class="nb">inversion</span> Hpref; <span class="nb">subst</span>.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>message</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>X</var><span class="hyp-type"><b>: </b><span>VLSM message</span></span></span><br><span><var>TypeX</var><span><span class="hyp-body"><b>:= </b><span>type X</span></span><span class="hyp-type"><b>: </b><span>VLSMType message</span></span></span></span><br><span><var>MachineX</var><span><span class="hyp-body"><b>:= </b><span>machine X</span></span><span class="hyp-type"><b>: </b><span>VLSMMachine (vtype X)</span></span></span></span><br><span><var>Hls</var><span class="hyp-type"><b>: </b><span><span class="kr">‚àÄ</span> (<span class="nv">s</span> : state) (<span class="nv">ls</span> : Stream transition_item),
  (<span class="kr">‚àÄ</span> <span class="nv">n</span> : nat,
     finite_valid_trace_from s
       (stream_prefix ls n))
  ‚Üí infinite_valid_trace_from s ls</span></span></span><br><span><var>s</var><span class="hyp-type"><b>: </b><span>state</span></span></span><br><span><var>ls</var><span class="hyp-type"><b>: </b><span>Stream transition_item</span></span></span><br><span><var>s1</var><span class="hyp-type"><b>: </b><span>state</span></span></span><br><span><var>iom, oom</var><span class="hyp-type"><b>: </b><span>option message</span></span></span><br><span><var>l0</var><span class="hyp-type"><b>: </b><span>label</span></span></span><br><span><var>Hpref0</var><span class="hyp-type"><b>: </b><span>finite_valid_trace_from s
  (stream_prefix
     (Cons
        {|
          l := l0;
          input := iom;
          destination := s1;
          output := oom
        |} ls) <span class="mi">1</span>)</span></span></span><br><span><var>n</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>Hpref</var><span class="hyp-type"><b>: </b><span>finite_valid_trace_from s
  ({|
     l := l0;
     input := iom;
     destination := s1;
     output := oom
   |} :: stream_prefix ls n)</span></span></span><br><span><var>Htl</var><span class="hyp-type"><b>: </b><span>finite_valid_trace_from s1 []</span></span></span><br><span><var>Ht</var><span class="hyp-type"><b>: </b><span>input_valid_transition l0 (s, iom) (s1, oom)</span></span></span><br><span><var>Htl0</var><span class="hyp-type"><b>: </b><span>finite_valid_trace_from s1 (stream_prefix ls n)</span></span></span><br><span><var>Ht0</var><span class="hyp-type"><b>: </b><span>input_valid_transition l0 (s, iom) (s1, oom)</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">finite_valid_trace_from s1 (stream_prefix ls n)</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">      </span><span class="alectryon-sentence"><span class="alectryon-input"><span class="bp">assumption</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Qed</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
</span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="VLSM-v-chk2ea" style="display: none" type="checkbox"><label class="alectryon-input" for="VLSM-v-chk2ea"><span class="kn">Lemma</span> <span class="nf">infinite_valid_trace_from_EqSt</span> :
      <span class="kr">forall</span> <span class="nv">s</span> <span class="nv">tl1</span> <span class="nv">tl2</span>, EqSt tl1 tl2 -&gt; infinite_valid_trace_from s tl1 -&gt; infinite_valid_trace_from s tl2.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>message</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>X</var><span class="hyp-type"><b>: </b><span>VLSM message</span></span></span><br><span><var>TypeX</var><span><span class="hyp-body"><b>:= </b><span>type X</span></span><span class="hyp-type"><b>: </b><span>VLSMType message</span></span></span></span><br><span><var>MachineX</var><span><span class="hyp-body"><b>:= </b><span>machine X</span></span><span class="hyp-type"><b>: </b><span>VLSMMachine (vtype X)</span></span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="kr">‚àÄ</span> (<span class="nv">s</span> : state) (<span class="nv">tl1</span> <span class="nv">tl2</span> : Stream transition_item),
  EqSt tl1 tl2
  ‚Üí infinite_valid_trace_from s tl1
    ‚Üí infinite_valid_trace_from s tl2</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="VLSM-v-chk2eb" style="display: none" type="checkbox"><label class="alectryon-input" for="VLSM-v-chk2eb"><span class="kn">Proof</span>.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>message</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>X</var><span class="hyp-type"><b>: </b><span>VLSM message</span></span></span><br><span><var>TypeX</var><span><span class="hyp-body"><b>:= </b><span>type X</span></span><span class="hyp-type"><b>: </b><span>VLSMType message</span></span></span></span><br><span><var>MachineX</var><span><span class="hyp-body"><b>:= </b><span>machine X</span></span><span class="hyp-type"><b>: </b><span>VLSMMachine (vtype X)</span></span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="kr">‚àÄ</span> (<span class="nv">s</span> : state) (<span class="nv">tl1</span> <span class="nv">tl2</span> : Stream transition_item),
  EqSt tl1 tl2
  ‚Üí infinite_valid_trace_from s tl1
    ‚Üí infinite_valid_trace_from s tl2</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">      </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="VLSM-v-chk2ec" style="display: none" type="checkbox"><label class="alectryon-input" for="VLSM-v-chk2ec"><span class="nb">intros</span> s tl1 tl2 Heq Htl1.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>message</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>X</var><span class="hyp-type"><b>: </b><span>VLSM message</span></span></span><br><span><var>TypeX</var><span><span class="hyp-body"><b>:= </b><span>type X</span></span><span class="hyp-type"><b>: </b><span>VLSMType message</span></span></span></span><br><span><var>MachineX</var><span><span class="hyp-body"><b>:= </b><span>machine X</span></span><span class="hyp-type"><b>: </b><span>VLSMMachine (vtype X)</span></span></span></span><br><span><var>s</var><span class="hyp-type"><b>: </b><span>state</span></span></span><br><span><var>tl1, tl2</var><span class="hyp-type"><b>: </b><span>Stream transition_item</span></span></span><br><span><var>Heq</var><span class="hyp-type"><b>: </b><span>EqSt tl1 tl2</span></span></span><br><span><var>Htl1</var><span class="hyp-type"><b>: </b><span>infinite_valid_trace_from s tl1</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">infinite_valid_trace_from s tl2</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">      </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="VLSM-v-chk2ed" style="display: none" type="checkbox"><label class="alectryon-input" for="VLSM-v-chk2ed"><span class="nb">apply</span> infinite_valid_trace_from_prefix_rev.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>message</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>X</var><span class="hyp-type"><b>: </b><span>VLSM message</span></span></span><br><span><var>TypeX</var><span><span class="hyp-body"><b>:= </b><span>type X</span></span><span class="hyp-type"><b>: </b><span>VLSMType message</span></span></span></span><br><span><var>MachineX</var><span><span class="hyp-body"><b>:= </b><span>machine X</span></span><span class="hyp-type"><b>: </b><span>VLSMMachine (vtype X)</span></span></span></span><br><span><var>s</var><span class="hyp-type"><b>: </b><span>state</span></span></span><br><span><var>tl1, tl2</var><span class="hyp-type"><b>: </b><span>Stream transition_item</span></span></span><br><span><var>Heq</var><span class="hyp-type"><b>: </b><span>EqSt tl1 tl2</span></span></span><br><span><var>Htl1</var><span class="hyp-type"><b>: </b><span>infinite_valid_trace_from s tl1</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="kr">‚àÄ</span> <span class="nv">n</span> : nat,
  finite_valid_trace_from s (stream_prefix tl2 n)</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">      </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="VLSM-v-chk2ee" style="display: none" type="checkbox"><label class="alectryon-input" for="VLSM-v-chk2ee"><span class="nb">intro</span> n.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>message</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>X</var><span class="hyp-type"><b>: </b><span>VLSM message</span></span></span><br><span><var>TypeX</var><span><span class="hyp-body"><b>:= </b><span>type X</span></span><span class="hyp-type"><b>: </b><span>VLSMType message</span></span></span></span><br><span><var>MachineX</var><span><span class="hyp-body"><b>:= </b><span>machine X</span></span><span class="hyp-type"><b>: </b><span>VLSMMachine (vtype X)</span></span></span></span><br><span><var>s</var><span class="hyp-type"><b>: </b><span>state</span></span></span><br><span><var>tl1, tl2</var><span class="hyp-type"><b>: </b><span>Stream transition_item</span></span></span><br><span><var>Heq</var><span class="hyp-type"><b>: </b><span>EqSt tl1 tl2</span></span></span><br><span><var>Htl1</var><span class="hyp-type"><b>: </b><span>infinite_valid_trace_from s tl1</span></span></span><br><span><var>n</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">finite_valid_trace_from s (stream_prefix tl2 n)</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">      </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="VLSM-v-chk2ef" style="display: none" type="checkbox"><label class="alectryon-input" for="VLSM-v-chk2ef"><span class="nb">apply</span> stream_prefix_EqSt <span class="kr">with</span> (n0 := n) <span class="kr">in</span> Heq.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>message</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>X</var><span class="hyp-type"><b>: </b><span>VLSM message</span></span></span><br><span><var>TypeX</var><span><span class="hyp-body"><b>:= </b><span>type X</span></span><span class="hyp-type"><b>: </b><span>VLSMType message</span></span></span></span><br><span><var>MachineX</var><span><span class="hyp-body"><b>:= </b><span>machine X</span></span><span class="hyp-type"><b>: </b><span>VLSMMachine (vtype X)</span></span></span></span><br><span><var>s</var><span class="hyp-type"><b>: </b><span>state</span></span></span><br><span><var>tl1, tl2</var><span class="hyp-type"><b>: </b><span>Stream transition_item</span></span></span><br><span><var>n</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>Heq</var><span class="hyp-type"><b>: </b><span>stream_prefix tl1 n = stream_prefix tl2 n</span></span></span><br><span><var>Htl1</var><span class="hyp-type"><b>: </b><span>infinite_valid_trace_from s tl1</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">finite_valid_trace_from s (stream_prefix tl2 n)</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">      </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="VLSM-v-chk2f0" style="display: none" type="checkbox"><label class="alectryon-input" for="VLSM-v-chk2f0"><span class="nb">apply</span> infinite_valid_trace_from_prefix <span class="kr">with</span> (n := n) <span class="kr">in</span> Htl1.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>message</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>X</var><span class="hyp-type"><b>: </b><span>VLSM message</span></span></span><br><span><var>TypeX</var><span><span class="hyp-body"><b>:= </b><span>type X</span></span><span class="hyp-type"><b>: </b><span>VLSMType message</span></span></span></span><br><span><var>MachineX</var><span><span class="hyp-body"><b>:= </b><span>machine X</span></span><span class="hyp-type"><b>: </b><span>VLSMMachine (vtype X)</span></span></span></span><br><span><var>s</var><span class="hyp-type"><b>: </b><span>state</span></span></span><br><span><var>tl1, tl2</var><span class="hyp-type"><b>: </b><span>Stream transition_item</span></span></span><br><span><var>n</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>Heq</var><span class="hyp-type"><b>: </b><span>stream_prefix tl1 n = stream_prefix tl2 n</span></span></span><br><span><var>Htl1</var><span class="hyp-type"><b>: </b><span>finite_valid_trace_from s (stream_prefix tl1 n)</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">finite_valid_trace_from s (stream_prefix tl2 n)</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">      </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="VLSM-v-chk2f1" style="display: none" type="checkbox"><label class="alectryon-input" for="VLSM-v-chk2f1"><span class="nb">rewrite</span> &lt;- Heq.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>message</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>X</var><span class="hyp-type"><b>: </b><span>VLSM message</span></span></span><br><span><var>TypeX</var><span><span class="hyp-body"><b>:= </b><span>type X</span></span><span class="hyp-type"><b>: </b><span>VLSMType message</span></span></span></span><br><span><var>MachineX</var><span><span class="hyp-body"><b>:= </b><span>machine X</span></span><span class="hyp-type"><b>: </b><span>VLSMMachine (vtype X)</span></span></span></span><br><span><var>s</var><span class="hyp-type"><b>: </b><span>state</span></span></span><br><span><var>tl1, tl2</var><span class="hyp-type"><b>: </b><span>Stream transition_item</span></span></span><br><span><var>n</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>Heq</var><span class="hyp-type"><b>: </b><span>stream_prefix tl1 n = stream_prefix tl2 n</span></span></span><br><span><var>Htl1</var><span class="hyp-type"><b>: </b><span>finite_valid_trace_from s (stream_prefix tl1 n)</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">finite_valid_trace_from s (stream_prefix tl1 n)</div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="bp">assumption</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Qed</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
</span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="VLSM-v-chk2f2" style="display: none" type="checkbox"><label class="alectryon-input" for="VLSM-v-chk2f2"><span class="kn">Lemma</span> <span class="nf">infinite_valid_trace_from_segment</span>
      (<span class="nv">s</span> : state)
      (<span class="nv">ls</span> : Stream transition_item)
      (<span class="nv">Htr</span> : infinite_valid_trace_from s ls)
      (<span class="nv">n1</span> <span class="nv">n2</span> : nat)
      (<span class="nv">Hle</span> : n1 &lt;= n2)
      (<span class="nv">n1th</span> := Str_nth n1 (Cons s (Streams.map destination ls)))
      : finite_valid_trace_from n1th (stream_segment ls n1 n2).</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>message</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>X</var><span class="hyp-type"><b>: </b><span>VLSM message</span></span></span><br><span><var>TypeX</var><span><span class="hyp-body"><b>:= </b><span>type X</span></span><span class="hyp-type"><b>: </b><span>VLSMType message</span></span></span></span><br><span><var>MachineX</var><span><span class="hyp-body"><b>:= </b><span>machine X</span></span><span class="hyp-type"><b>: </b><span>VLSMMachine (vtype X)</span></span></span></span><br><span><var>s</var><span class="hyp-type"><b>: </b><span>state</span></span></span><br><span><var>ls</var><span class="hyp-type"><b>: </b><span>Stream transition_item</span></span></span><br><span><var>Htr</var><span class="hyp-type"><b>: </b><span>infinite_valid_trace_from s ls</span></span></span><br><span><var>n1, n2</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>Hle</var><span class="hyp-type"><b>: </b><span>n1 ‚â§ n2</span></span></span><br><span><var>n1th</var><span><span class="hyp-body"><b>:= </b><span>Str_nth n1 (Cons s (map destination ls))</span></span><span class="hyp-type"><b>: </b><span>state</span></span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">finite_valid_trace_from n1th (stream_segment ls n1 n2)</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="VLSM-v-chk2f3" style="display: none" type="checkbox"><label class="alectryon-input" for="VLSM-v-chk2f3"><span class="kn">Proof</span>.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>message</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>X</var><span class="hyp-type"><b>: </b><span>VLSM message</span></span></span><br><span><var>TypeX</var><span><span class="hyp-body"><b>:= </b><span>type X</span></span><span class="hyp-type"><b>: </b><span>VLSMType message</span></span></span></span><br><span><var>MachineX</var><span><span class="hyp-body"><b>:= </b><span>machine X</span></span><span class="hyp-type"><b>: </b><span>VLSMMachine (vtype X)</span></span></span></span><br><span><var>s</var><span class="hyp-type"><b>: </b><span>state</span></span></span><br><span><var>ls</var><span class="hyp-type"><b>: </b><span>Stream transition_item</span></span></span><br><span><var>Htr</var><span class="hyp-type"><b>: </b><span>infinite_valid_trace_from s ls</span></span></span><br><span><var>n1, n2</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>Hle</var><span class="hyp-type"><b>: </b><span>n1 ‚â§ n2</span></span></span><br><span><var>n1th</var><span><span class="hyp-body"><b>:= </b><span>Str_nth n1 (Cons s (map destination ls))</span></span><span class="hyp-type"><b>: </b><span>state</span></span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">finite_valid_trace_from n1th (stream_segment ls n1 n2)</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">      </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="VLSM-v-chk2f4" style="display: none" type="checkbox"><label class="alectryon-input" for="VLSM-v-chk2f4"><span class="nb">apply</span> finite_valid_trace_from_suffix <span class="kr">with</span> s.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>message</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>X</var><span class="hyp-type"><b>: </b><span>VLSM message</span></span></span><br><span><var>TypeX</var><span><span class="hyp-body"><b>:= </b><span>type X</span></span><span class="hyp-type"><b>: </b><span>VLSMType message</span></span></span></span><br><span><var>MachineX</var><span><span class="hyp-body"><b>:= </b><span>machine X</span></span><span class="hyp-type"><b>: </b><span>VLSMMachine (vtype X)</span></span></span></span><br><span><var>s</var><span class="hyp-type"><b>: </b><span>state</span></span></span><br><span><var>ls</var><span class="hyp-type"><b>: </b><span>Stream transition_item</span></span></span><br><span><var>Htr</var><span class="hyp-type"><b>: </b><span>infinite_valid_trace_from s ls</span></span></span><br><span><var>n1, n2</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>Hle</var><span class="hyp-type"><b>: </b><span>n1 ‚â§ n2</span></span></span><br><span><var>n1th</var><span><span class="hyp-body"><b>:= </b><span>Str_nth n1 (Cons s (map destination ls))</span></span><span class="hyp-type"><b>: </b><span>state</span></span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">finite_valid_trace_from s (stream_prefix ls n2)</div></blockquote><div class="alectryon-extra-goals"><input class="alectryon-extra-goal-toggle" id="VLSM-v-chk2f5" style="display: none" type="checkbox"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>message</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>X</var><span class="hyp-type"><b>: </b><span>VLSM message</span></span></span><br><span><var>TypeX</var><span><span class="hyp-body"><b>:= </b><span>type X</span></span><span class="hyp-type"><b>: </b><span>VLSMType message</span></span></span></span><br><span><var>MachineX</var><span><span class="hyp-body"><b>:= </b><span>machine X</span></span><span class="hyp-type"><b>: </b><span>VLSMMachine (vtype X)</span></span></span></span><br><span><var>s</var><span class="hyp-type"><b>: </b><span>state</span></span></span><br><span><var>ls</var><span class="hyp-type"><b>: </b><span>Stream transition_item</span></span></span><br><span><var>Htr</var><span class="hyp-type"><b>: </b><span>infinite_valid_trace_from s ls</span></span></span><br><span><var>n1, n2</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>Hle</var><span class="hyp-type"><b>: </b><span>n1 ‚â§ n2</span></span></span><br><span><var>n1th</var><span><span class="hyp-body"><b>:= </b><span>Str_nth n1 (Cons s (map destination ls))</span></span><span class="hyp-type"><b>: </b><span>state</span></span></span></span><br></div><label class="goal-separator" for="VLSM-v-chk2f5"><hr></label><div class="goal-conclusion">finite_trace_nth s (stream_prefix ls n2) n1 =
Some n1th</div></blockquote></div></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">      </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="VLSM-v-chk2f6" style="display: none" type="checkbox"><label class="alectryon-input" for="VLSM-v-chk2f6">-</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>message</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>X</var><span class="hyp-type"><b>: </b><span>VLSM message</span></span></span><br><span><var>TypeX</var><span><span class="hyp-body"><b>:= </b><span>type X</span></span><span class="hyp-type"><b>: </b><span>VLSMType message</span></span></span></span><br><span><var>MachineX</var><span><span class="hyp-body"><b>:= </b><span>machine X</span></span><span class="hyp-type"><b>: </b><span>VLSMMachine (vtype X)</span></span></span></span><br><span><var>s</var><span class="hyp-type"><b>: </b><span>state</span></span></span><br><span><var>ls</var><span class="hyp-type"><b>: </b><span>Stream transition_item</span></span></span><br><span><var>Htr</var><span class="hyp-type"><b>: </b><span>infinite_valid_trace_from s ls</span></span></span><br><span><var>n1, n2</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>Hle</var><span class="hyp-type"><b>: </b><span>n1 ‚â§ n2</span></span></span><br><span><var>n1th</var><span><span class="hyp-body"><b>:= </b><span>Str_nth n1 (Cons s (map destination ls))</span></span><span class="hyp-type"><b>: </b><span>state</span></span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">finite_valid_trace_from s (stream_prefix ls n2)</div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="VLSM-v-chk2f7" style="display: none" type="checkbox"><label class="alectryon-input" for="VLSM-v-chk2f7"><span class="nb">apply</span> infinite_valid_trace_from_prefix.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>message</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>X</var><span class="hyp-type"><b>: </b><span>VLSM message</span></span></span><br><span><var>TypeX</var><span><span class="hyp-body"><b>:= </b><span>type X</span></span><span class="hyp-type"><b>: </b><span>VLSMType message</span></span></span></span><br><span><var>MachineX</var><span><span class="hyp-body"><b>:= </b><span>machine X</span></span><span class="hyp-type"><b>: </b><span>VLSMMachine (vtype X)</span></span></span></span><br><span><var>s</var><span class="hyp-type"><b>: </b><span>state</span></span></span><br><span><var>ls</var><span class="hyp-type"><b>: </b><span>Stream transition_item</span></span></span><br><span><var>Htr</var><span class="hyp-type"><b>: </b><span>infinite_valid_trace_from s ls</span></span></span><br><span><var>n1, n2</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>Hle</var><span class="hyp-type"><b>: </b><span>n1 ‚â§ n2</span></span></span><br><span><var>n1th</var><span><span class="hyp-body"><b>:= </b><span>Str_nth n1 (Cons s (map destination ls))</span></span><span class="hyp-type"><b>: </b><span>state</span></span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">infinite_valid_trace_from s ls</div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="bp">assumption</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">      </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="VLSM-v-chk2f8" style="display: none" type="checkbox"><label class="alectryon-input" for="VLSM-v-chk2f8">-</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>message</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>X</var><span class="hyp-type"><b>: </b><span>VLSM message</span></span></span><br><span><var>TypeX</var><span><span class="hyp-body"><b>:= </b><span>type X</span></span><span class="hyp-type"><b>: </b><span>VLSMType message</span></span></span></span><br><span><var>MachineX</var><span><span class="hyp-body"><b>:= </b><span>machine X</span></span><span class="hyp-type"><b>: </b><span>VLSMMachine (vtype X)</span></span></span></span><br><span><var>s</var><span class="hyp-type"><b>: </b><span>state</span></span></span><br><span><var>ls</var><span class="hyp-type"><b>: </b><span>Stream transition_item</span></span></span><br><span><var>Htr</var><span class="hyp-type"><b>: </b><span>infinite_valid_trace_from s ls</span></span></span><br><span><var>n1, n2</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>Hle</var><span class="hyp-type"><b>: </b><span>n1 ‚â§ n2</span></span></span><br><span><var>n1th</var><span><span class="hyp-body"><b>:= </b><span>Str_nth n1 (Cons s (map destination ls))</span></span><span class="hyp-type"><b>: </b><span>state</span></span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">finite_trace_nth s (stream_prefix ls n2) n1 =
Some n1th</div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="VLSM-v-chk2f9" style="display: none" type="checkbox"><label class="alectryon-input" for="VLSM-v-chk2f9"><span class="nb">destruct</span> n1; <span class="kp">try</span> <span class="bp">reflexivity</span>.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>message</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>X</var><span class="hyp-type"><b>: </b><span>VLSM message</span></span></span><br><span><var>TypeX</var><span><span class="hyp-body"><b>:= </b><span>type X</span></span><span class="hyp-type"><b>: </b><span>VLSMType message</span></span></span></span><br><span><var>MachineX</var><span><span class="hyp-body"><b>:= </b><span>machine X</span></span><span class="hyp-type"><b>: </b><span>VLSMMachine (vtype X)</span></span></span></span><br><span><var>s</var><span class="hyp-type"><b>: </b><span>state</span></span></span><br><span><var>ls</var><span class="hyp-type"><b>: </b><span>Stream transition_item</span></span></span><br><span><var>Htr</var><span class="hyp-type"><b>: </b><span>infinite_valid_trace_from s ls</span></span></span><br><span><var>n1, n2</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>Hle</var><span class="hyp-type"><b>: </b><span>S n1 ‚â§ n2</span></span></span><br><span><var>n1th</var><span><span class="hyp-body"><b>:= </b><span>Str_nth (S n1) (Cons s (map destination ls))</span></span><span class="hyp-type"><b>: </b><span>state</span></span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">finite_trace_nth s (stream_prefix ls n2) (S n1) =
Some n1th</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">        </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="VLSM-v-chk2fa" style="display: none" type="checkbox"><label class="alectryon-input" for="VLSM-v-chk2fa"><span class="nb">unfold</span> n1th.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>message</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>X</var><span class="hyp-type"><b>: </b><span>VLSM message</span></span></span><br><span><var>TypeX</var><span><span class="hyp-body"><b>:= </b><span>type X</span></span><span class="hyp-type"><b>: </b><span>VLSMType message</span></span></span></span><br><span><var>MachineX</var><span><span class="hyp-body"><b>:= </b><span>machine X</span></span><span class="hyp-type"><b>: </b><span>VLSMMachine (vtype X)</span></span></span></span><br><span><var>s</var><span class="hyp-type"><b>: </b><span>state</span></span></span><br><span><var>ls</var><span class="hyp-type"><b>: </b><span>Stream transition_item</span></span></span><br><span><var>Htr</var><span class="hyp-type"><b>: </b><span>infinite_valid_trace_from s ls</span></span></span><br><span><var>n1, n2</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>Hle</var><span class="hyp-type"><b>: </b><span>S n1 ‚â§ n2</span></span></span><br><span><var>n1th</var><span><span class="hyp-body"><b>:= </b><span>Str_nth (S n1) (Cons s (map destination ls))</span></span><span class="hyp-type"><b>: </b><span>state</span></span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">finite_trace_nth s (stream_prefix ls n2) (S n1) =
Some (Str_nth (S n1) (Cons s (map destination ls)))</div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="VLSM-v-chk2fb" style="display: none" type="checkbox"><label class="alectryon-input" for="VLSM-v-chk2fb"><span class="nb">clear</span> n1th.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>message</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>X</var><span class="hyp-type"><b>: </b><span>VLSM message</span></span></span><br><span><var>TypeX</var><span><span class="hyp-body"><b>:= </b><span>type X</span></span><span class="hyp-type"><b>: </b><span>VLSMType message</span></span></span></span><br><span><var>MachineX</var><span><span class="hyp-body"><b>:= </b><span>machine X</span></span><span class="hyp-type"><b>: </b><span>VLSMMachine (vtype X)</span></span></span></span><br><span><var>s</var><span class="hyp-type"><b>: </b><span>state</span></span></span><br><span><var>ls</var><span class="hyp-type"><b>: </b><span>Stream transition_item</span></span></span><br><span><var>Htr</var><span class="hyp-type"><b>: </b><span>infinite_valid_trace_from s ls</span></span></span><br><span><var>n1, n2</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>Hle</var><span class="hyp-type"><b>: </b><span>S n1 ‚â§ n2</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">finite_trace_nth s (stream_prefix ls n2) (S n1) =
Some (Str_nth (S n1) (Cons s (map destination ls)))</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">        </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="VLSM-v-chk2fc" style="display: none" type="checkbox"><label class="alectryon-input" for="VLSM-v-chk2fc"><span class="nb">unfold</span> finite_trace_nth.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>message</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>X</var><span class="hyp-type"><b>: </b><span>VLSM message</span></span></span><br><span><var>TypeX</var><span><span class="hyp-body"><b>:= </b><span>type X</span></span><span class="hyp-type"><b>: </b><span>VLSMType message</span></span></span></span><br><span><var>MachineX</var><span><span class="hyp-body"><b>:= </b><span>machine X</span></span><span class="hyp-type"><b>: </b><span>VLSMMachine (vtype X)</span></span></span></span><br><span><var>s</var><span class="hyp-type"><b>: </b><span>state</span></span></span><br><span><var>ls</var><span class="hyp-type"><b>: </b><span>Stream transition_item</span></span></span><br><span><var>Htr</var><span class="hyp-type"><b>: </b><span>infinite_valid_trace_from s ls</span></span></span><br><span><var>n1, n2</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>Hle</var><span class="hyp-type"><b>: </b><span>S n1 ‚â§ n2</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">nth_error
  (s :: List.map destination (stream_prefix ls n2))
  (S n1) =
Some (Str_nth (S n1) (Cons s (map destination ls)))</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">        </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="VLSM-v-chk2fd" style="display: none" type="checkbox"><label class="alectryon-input" for="VLSM-v-chk2fd"><span class="nb">simpl</span>.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>message</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>X</var><span class="hyp-type"><b>: </b><span>VLSM message</span></span></span><br><span><var>TypeX</var><span><span class="hyp-body"><b>:= </b><span>type X</span></span><span class="hyp-type"><b>: </b><span>VLSMType message</span></span></span></span><br><span><var>MachineX</var><span><span class="hyp-body"><b>:= </b><span>machine X</span></span><span class="hyp-type"><b>: </b><span>VLSMMachine (vtype X)</span></span></span></span><br><span><var>s</var><span class="hyp-type"><b>: </b><span>state</span></span></span><br><span><var>ls</var><span class="hyp-type"><b>: </b><span>Stream transition_item</span></span></span><br><span><var>Htr</var><span class="hyp-type"><b>: </b><span>infinite_valid_trace_from s ls</span></span></span><br><span><var>n1, n2</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>Hle</var><span class="hyp-type"><b>: </b><span>S n1 ‚â§ n2</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">nth_error (List.map destination (stream_prefix ls n2))
  n1 =
Some (Str_nth (S n1) (Cons s (map destination ls)))</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">        </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="VLSM-v-chk2fe" style="display: none" type="checkbox"><label class="alectryon-input" for="VLSM-v-chk2fe"><span class="nb">rewrite</span> stream_prefix_map.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>message</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>X</var><span class="hyp-type"><b>: </b><span>VLSM message</span></span></span><br><span><var>TypeX</var><span><span class="hyp-body"><b>:= </b><span>type X</span></span><span class="hyp-type"><b>: </b><span>VLSMType message</span></span></span></span><br><span><var>MachineX</var><span><span class="hyp-body"><b>:= </b><span>machine X</span></span><span class="hyp-type"><b>: </b><span>VLSMMachine (vtype X)</span></span></span></span><br><span><var>s</var><span class="hyp-type"><b>: </b><span>state</span></span></span><br><span><var>ls</var><span class="hyp-type"><b>: </b><span>Stream transition_item</span></span></span><br><span><var>Htr</var><span class="hyp-type"><b>: </b><span>infinite_valid_trace_from s ls</span></span></span><br><span><var>n1, n2</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>Hle</var><span class="hyp-type"><b>: </b><span>S n1 ‚â§ n2</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">nth_error (stream_prefix (map destination ls) n2) n1 =
Some (Str_nth (S n1) (Cons s (map destination ls)))</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">        </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="VLSM-v-chk2ff" style="display: none" type="checkbox"><label class="alectryon-input" for="VLSM-v-chk2ff"><span class="nb">rewrite</span> stream_prefix_nth; <span class="kp">try</span> <span class="bp">assumption</span>.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>message</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>X</var><span class="hyp-type"><b>: </b><span>VLSM message</span></span></span><br><span><var>TypeX</var><span><span class="hyp-body"><b>:= </b><span>type X</span></span><span class="hyp-type"><b>: </b><span>VLSMType message</span></span></span></span><br><span><var>MachineX</var><span><span class="hyp-body"><b>:= </b><span>machine X</span></span><span class="hyp-type"><b>: </b><span>VLSMMachine (vtype X)</span></span></span></span><br><span><var>s</var><span class="hyp-type"><b>: </b><span>state</span></span></span><br><span><var>ls</var><span class="hyp-type"><b>: </b><span>Stream transition_item</span></span></span><br><span><var>Htr</var><span class="hyp-type"><b>: </b><span>infinite_valid_trace_from s ls</span></span></span><br><span><var>n1, n2</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>Hle</var><span class="hyp-type"><b>: </b><span>S n1 ‚â§ n2</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">Some (Str_nth n1 (map destination ls)) =
Some (Str_nth (S n1) (Cons s (map destination ls)))</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">        </span><span class="alectryon-sentence"><span class="alectryon-input"><span class="bp">reflexivity</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Qed</span>.</span></span></pre><div class="doc">
<a id="lab14"></a><h3 class="section">valid traces</h3>
<div class="paragraph"> </div>

Finally, we define <span class="inlinecode"><span class="id" title="var">Trace</span></span> as a sum-type of its finite/infinite variants.
It inherits some previously introduced definitions, culminating with the
<span class="inlinecode"><span class="id" title="var">valid_trace</span></span>.

</div><pre class="alectryon-io highlight"><!-- Generator: Alectryon --><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Definition</span> <span class="nf">valid_trace_from_prop</span> (<span class="nv">tr</span> : Trace) : <span class="kt">Prop</span> :=
      <span class="kr">match</span> tr <span class="kr">with</span>
      | Finite s ls =&gt; finite_valid_trace_from s ls
      | Infinite s sm =&gt; infinite_valid_trace_from s sm
      <span class="kr">end</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
</span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Definition</span> <span class="nf">valid_trace_prop</span> (<span class="nv">tr</span> : Trace) : <span class="kt">Prop</span> :=
      <span class="kr">match</span> tr <span class="kr">with</span>
      | Finite s ls =&gt; finite_valid_trace s ls
      | Infinite s sm =&gt; infinite_valid_trace s sm
      <span class="kr">end</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
</span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Definition</span> <span class="nf">valid_trace</span> : <span class="kt">Type</span> :=
      { tr : Trace | valid_trace_prop tr}.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
</span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="VLSM-v-chk300" style="display: none" type="checkbox"><label class="alectryon-input" for="VLSM-v-chk300"><span class="kn">Lemma</span> <span class="nf">valid_trace_from</span>
      (<span class="nv">tr</span> : Trace)
      (<span class="nv">Htr</span> : valid_trace_prop tr)
      : valid_trace_from_prop tr.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>message</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>X</var><span class="hyp-type"><b>: </b><span>VLSM message</span></span></span><br><span><var>TypeX</var><span><span class="hyp-body"><b>:= </b><span>type X</span></span><span class="hyp-type"><b>: </b><span>VLSMType message</span></span></span></span><br><span><var>MachineX</var><span><span class="hyp-body"><b>:= </b><span>machine X</span></span><span class="hyp-type"><b>: </b><span>VLSMMachine (vtype X)</span></span></span></span><br><span><var>tr</var><span class="hyp-type"><b>: </b><span>Trace</span></span></span><br><span><var>Htr</var><span class="hyp-type"><b>: </b><span>valid_trace_prop tr</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">valid_trace_from_prop tr</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="VLSM-v-chk301" style="display: none" type="checkbox"><label class="alectryon-input" for="VLSM-v-chk301"><span class="kn">Proof</span>.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>message</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>X</var><span class="hyp-type"><b>: </b><span>VLSM message</span></span></span><br><span><var>TypeX</var><span><span class="hyp-body"><b>:= </b><span>type X</span></span><span class="hyp-type"><b>: </b><span>VLSMType message</span></span></span></span><br><span><var>MachineX</var><span><span class="hyp-body"><b>:= </b><span>machine X</span></span><span class="hyp-type"><b>: </b><span>VLSMMachine (vtype X)</span></span></span></span><br><span><var>tr</var><span class="hyp-type"><b>: </b><span>Trace</span></span></span><br><span><var>Htr</var><span class="hyp-type"><b>: </b><span>valid_trace_prop tr</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">valid_trace_from_prop tr</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">      </span><span class="alectryon-sentence"><span class="alectryon-input"><span class="nb">destruct</span> tr; <span class="nb">simpl</span>; <span class="nb">destruct</span> Htr <span class="kr">as</span> [Htr Hinit]; <span class="bp">assumption</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Qed</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
</span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="VLSM-v-chk302" style="display: none" type="checkbox"><label class="alectryon-input" for="VLSM-v-chk302"><span class="kn">Lemma</span> <span class="nf">valid_trace_initial</span>
      (<span class="nv">tr</span> : Trace)
      (<span class="nv">Htr</span> : valid_trace_prop tr)
      : initial_state_prop (trace_first tr).</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>message</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>X</var><span class="hyp-type"><b>: </b><span>VLSM message</span></span></span><br><span><var>TypeX</var><span><span class="hyp-body"><b>:= </b><span>type X</span></span><span class="hyp-type"><b>: </b><span>VLSMType message</span></span></span></span><br><span><var>MachineX</var><span><span class="hyp-body"><b>:= </b><span>machine X</span></span><span class="hyp-type"><b>: </b><span>VLSMMachine (vtype X)</span></span></span></span><br><span><var>tr</var><span class="hyp-type"><b>: </b><span>Trace</span></span></span><br><span><var>Htr</var><span class="hyp-type"><b>: </b><span>valid_trace_prop tr</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">initial_state_prop (trace_first tr)</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="VLSM-v-chk303" style="display: none" type="checkbox"><label class="alectryon-input" for="VLSM-v-chk303"><span class="kn">Proof</span>.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>message</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>X</var><span class="hyp-type"><b>: </b><span>VLSM message</span></span></span><br><span><var>TypeX</var><span><span class="hyp-body"><b>:= </b><span>type X</span></span><span class="hyp-type"><b>: </b><span>VLSMType message</span></span></span></span><br><span><var>MachineX</var><span><span class="hyp-body"><b>:= </b><span>machine X</span></span><span class="hyp-type"><b>: </b><span>VLSMMachine (vtype X)</span></span></span></span><br><span><var>tr</var><span class="hyp-type"><b>: </b><span>Trace</span></span></span><br><span><var>Htr</var><span class="hyp-type"><b>: </b><span>valid_trace_prop tr</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">initial_state_prop (trace_first tr)</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">      </span><span class="alectryon-sentence"><span class="alectryon-input"><span class="nb">destruct</span> tr; <span class="nb">simpl</span>; <span class="nb">destruct</span> Htr <span class="kr">as</span> [Htr Hinit]; <span class="bp">assumption</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Qed</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
</span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="VLSM-v-chk304" style="display: none" type="checkbox"><label class="alectryon-input" for="VLSM-v-chk304"><span class="kn">Lemma</span> <span class="nf">valid_trace_from_iff</span>
      (<span class="nv">tr</span> : Trace)
      : valid_trace_prop tr
      &lt;-&gt; valid_trace_from_prop tr /\ initial_state_prop (trace_first tr).</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>message</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>X</var><span class="hyp-type"><b>: </b><span>VLSM message</span></span></span><br><span><var>TypeX</var><span><span class="hyp-body"><b>:= </b><span>type X</span></span><span class="hyp-type"><b>: </b><span>VLSMType message</span></span></span></span><br><span><var>MachineX</var><span><span class="hyp-body"><b>:= </b><span>machine X</span></span><span class="hyp-type"><b>: </b><span>VLSMMachine (vtype X)</span></span></span></span><br><span><var>tr</var><span class="hyp-type"><b>: </b><span>Trace</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">valid_trace_prop tr
‚Üî valid_trace_from_prop tr
  ‚àß initial_state_prop (trace_first tr)</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="VLSM-v-chk305" style="display: none" type="checkbox"><label class="alectryon-input" for="VLSM-v-chk305"><span class="kn">Proof</span>.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>message</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>X</var><span class="hyp-type"><b>: </b><span>VLSM message</span></span></span><br><span><var>TypeX</var><span><span class="hyp-body"><b>:= </b><span>type X</span></span><span class="hyp-type"><b>: </b><span>VLSMType message</span></span></span></span><br><span><var>MachineX</var><span><span class="hyp-body"><b>:= </b><span>machine X</span></span><span class="hyp-type"><b>: </b><span>VLSMMachine (vtype X)</span></span></span></span><br><span><var>tr</var><span class="hyp-type"><b>: </b><span>Trace</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">valid_trace_prop tr
‚Üî valid_trace_from_prop tr
  ‚àß initial_state_prop (trace_first tr)</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">      </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="VLSM-v-chk306" style="display: none" type="checkbox"><label class="alectryon-input" for="VLSM-v-chk306"><span class="nb">split</span>.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>message</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>X</var><span class="hyp-type"><b>: </b><span>VLSM message</span></span></span><br><span><var>TypeX</var><span><span class="hyp-body"><b>:= </b><span>type X</span></span><span class="hyp-type"><b>: </b><span>VLSMType message</span></span></span></span><br><span><var>MachineX</var><span><span class="hyp-body"><b>:= </b><span>machine X</span></span><span class="hyp-type"><b>: </b><span>VLSMMachine (vtype X)</span></span></span></span><br><span><var>tr</var><span class="hyp-type"><b>: </b><span>Trace</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">valid_trace_prop tr
‚Üí valid_trace_from_prop tr
  ‚àß initial_state_prop (trace_first tr)</div></blockquote><div class="alectryon-extra-goals"><input class="alectryon-extra-goal-toggle" id="VLSM-v-chk307" style="display: none" type="checkbox"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>message</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>X</var><span class="hyp-type"><b>: </b><span>VLSM message</span></span></span><br><span><var>TypeX</var><span><span class="hyp-body"><b>:= </b><span>type X</span></span><span class="hyp-type"><b>: </b><span>VLSMType message</span></span></span></span><br><span><var>MachineX</var><span><span class="hyp-body"><b>:= </b><span>machine X</span></span><span class="hyp-type"><b>: </b><span>VLSMMachine (vtype X)</span></span></span></span><br><span><var>tr</var><span class="hyp-type"><b>: </b><span>Trace</span></span></span><br></div><label class="goal-separator" for="VLSM-v-chk307"><hr></label><div class="goal-conclusion">valid_trace_from_prop tr
‚àß initial_state_prop (trace_first tr)
‚Üí valid_trace_prop tr</div></blockquote></div></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">      </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="VLSM-v-chk308" style="display: none" type="checkbox"><label class="alectryon-input" for="VLSM-v-chk308">-</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>message</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>X</var><span class="hyp-type"><b>: </b><span>VLSM message</span></span></span><br><span><var>TypeX</var><span><span class="hyp-body"><b>:= </b><span>type X</span></span><span class="hyp-type"><b>: </b><span>VLSMType message</span></span></span></span><br><span><var>MachineX</var><span><span class="hyp-body"><b>:= </b><span>machine X</span></span><span class="hyp-type"><b>: </b><span>VLSMMachine (vtype X)</span></span></span></span><br><span><var>tr</var><span class="hyp-type"><b>: </b><span>Trace</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">valid_trace_prop tr
‚Üí valid_trace_from_prop tr
  ‚àß initial_state_prop (trace_first tr)</div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="VLSM-v-chk309" style="display: none" type="checkbox"><label class="alectryon-input" for="VLSM-v-chk309"><span class="nb">intro</span> Htr; <span class="nb">split</span>.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>message</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>X</var><span class="hyp-type"><b>: </b><span>VLSM message</span></span></span><br><span><var>TypeX</var><span><span class="hyp-body"><b>:= </b><span>type X</span></span><span class="hyp-type"><b>: </b><span>VLSMType message</span></span></span></span><br><span><var>MachineX</var><span><span class="hyp-body"><b>:= </b><span>machine X</span></span><span class="hyp-type"><b>: </b><span>VLSMMachine (vtype X)</span></span></span></span><br><span><var>tr</var><span class="hyp-type"><b>: </b><span>Trace</span></span></span><br><span><var>Htr</var><span class="hyp-type"><b>: </b><span>valid_trace_prop tr</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">valid_trace_from_prop tr</div></blockquote><div class="alectryon-extra-goals"><input class="alectryon-extra-goal-toggle" id="VLSM-v-chk30a" style="display: none" type="checkbox"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>message</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>X</var><span class="hyp-type"><b>: </b><span>VLSM message</span></span></span><br><span><var>TypeX</var><span><span class="hyp-body"><b>:= </b><span>type X</span></span><span class="hyp-type"><b>: </b><span>VLSMType message</span></span></span></span><br><span><var>MachineX</var><span><span class="hyp-body"><b>:= </b><span>machine X</span></span><span class="hyp-type"><b>: </b><span>VLSMMachine (vtype X)</span></span></span></span><br><span><var>tr</var><span class="hyp-type"><b>: </b><span>Trace</span></span></span><br><span><var>Htr</var><span class="hyp-type"><b>: </b><span>valid_trace_prop tr</span></span></span><br></div><label class="goal-separator" for="VLSM-v-chk30a"><hr></label><div class="goal-conclusion">initial_state_prop (trace_first tr)</div></blockquote></div></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">        </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="VLSM-v-chk30b" style="display: none" type="checkbox"><label class="alectryon-input" for="VLSM-v-chk30b">+</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>message</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>X</var><span class="hyp-type"><b>: </b><span>VLSM message</span></span></span><br><span><var>TypeX</var><span><span class="hyp-body"><b>:= </b><span>type X</span></span><span class="hyp-type"><b>: </b><span>VLSMType message</span></span></span></span><br><span><var>MachineX</var><span><span class="hyp-body"><b>:= </b><span>machine X</span></span><span class="hyp-type"><b>: </b><span>VLSMMachine (vtype X)</span></span></span></span><br><span><var>tr</var><span class="hyp-type"><b>: </b><span>Trace</span></span></span><br><span><var>Htr</var><span class="hyp-type"><b>: </b><span>valid_trace_prop tr</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">valid_trace_from_prop tr</div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="nb">apply</span> valid_trace_from; <span class="bp">assumption</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">        </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="VLSM-v-chk30c" style="display: none" type="checkbox"><label class="alectryon-input" for="VLSM-v-chk30c">+</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>message</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>X</var><span class="hyp-type"><b>: </b><span>VLSM message</span></span></span><br><span><var>TypeX</var><span><span class="hyp-body"><b>:= </b><span>type X</span></span><span class="hyp-type"><b>: </b><span>VLSMType message</span></span></span></span><br><span><var>MachineX</var><span><span class="hyp-body"><b>:= </b><span>machine X</span></span><span class="hyp-type"><b>: </b><span>VLSMMachine (vtype X)</span></span></span></span><br><span><var>tr</var><span class="hyp-type"><b>: </b><span>Trace</span></span></span><br><span><var>Htr</var><span class="hyp-type"><b>: </b><span>valid_trace_prop tr</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">initial_state_prop (trace_first tr)</div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="nb">apply</span> valid_trace_initial; <span class="bp">assumption</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">      </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="VLSM-v-chk30d" style="display: none" type="checkbox"><label class="alectryon-input" for="VLSM-v-chk30d">-</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>message</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>X</var><span class="hyp-type"><b>: </b><span>VLSM message</span></span></span><br><span><var>TypeX</var><span><span class="hyp-body"><b>:= </b><span>type X</span></span><span class="hyp-type"><b>: </b><span>VLSMType message</span></span></span></span><br><span><var>MachineX</var><span><span class="hyp-body"><b>:= </b><span>machine X</span></span><span class="hyp-type"><b>: </b><span>VLSMMachine (vtype X)</span></span></span></span><br><span><var>tr</var><span class="hyp-type"><b>: </b><span>Trace</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">valid_trace_from_prop tr
‚àß initial_state_prop (trace_first tr)
‚Üí valid_trace_prop tr</div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="nb">destruct</span> tr; <span class="nb">simpl</span>; <span class="nb">intros</span> [Htr Hinit]; <span class="nb">split</span>; <span class="bp">assumption</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Qed</span>.</span></span></pre><div class="doc">
Having defined <span class="inlinecode"><span class="id" title="var">valid_trace</span></span>s, we now connect them to valid states
and messages, in the following sense: for each state-message pair (<code>s</code>, <code>m</code>)
that has the <span class="inlinecode"><span class="id" title="var">valid_state_message_prop</span></span>erty, there exists a <span class="inlinecode"><span class="id" title="var">valid_trace</span></span> which ends
in <code>s</code> by outputting <code>m</code>
</div><pre class="alectryon-io highlight"><!-- Generator: Alectryon --><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="VLSM-v-chk30e" style="display: none" type="checkbox"><label class="alectryon-input" for="VLSM-v-chk30e"><span class="kn">Lemma</span> <span class="nf">valid_state_message_has_trace</span>
          (<span class="nv">s</span> : state)
          (<span class="nv">om</span> : option message)
          (<span class="nv">Hp</span> : valid_state_message_prop s om)
      : initial_state_prop s /\ option_initial_message_prop om
      \/ <span class="kr">exists</span> (<span class="nv">is</span> : state) (<span class="nv">tr</span> : list transition_item),
            finite_valid_trace_init_to <span class="kr">is</span> s tr
            /\ finite_trace_last_output tr = om.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>message</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>X</var><span class="hyp-type"><b>: </b><span>VLSM message</span></span></span><br><span><var>TypeX</var><span><span class="hyp-body"><b>:= </b><span>type X</span></span><span class="hyp-type"><b>: </b><span>VLSMType message</span></span></span></span><br><span><var>MachineX</var><span><span class="hyp-body"><b>:= </b><span>machine X</span></span><span class="hyp-type"><b>: </b><span>VLSMMachine (vtype X)</span></span></span></span><br><span><var>s</var><span class="hyp-type"><b>: </b><span>state</span></span></span><br><span><var>om</var><span class="hyp-type"><b>: </b><span>option message</span></span></span><br><span><var>Hp</var><span class="hyp-type"><b>: </b><span>valid_state_message_prop s om</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">initial_state_prop s ‚àß option_initial_message_prop om
‚à® (<span class="kr">‚àÉ</span> (<span class="nv">is</span> : state) (<span class="nv">tr</span> : list transition_item),
     finite_valid_trace_init_to <span class="kr">is</span> s tr
     ‚àß finite_trace_last_output tr = om)</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="VLSM-v-chk30f" style="display: none" type="checkbox"><label class="alectryon-input" for="VLSM-v-chk30f"><span class="kn">Proof</span>.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>message</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>X</var><span class="hyp-type"><b>: </b><span>VLSM message</span></span></span><br><span><var>TypeX</var><span><span class="hyp-body"><b>:= </b><span>type X</span></span><span class="hyp-type"><b>: </b><span>VLSMType message</span></span></span></span><br><span><var>MachineX</var><span><span class="hyp-body"><b>:= </b><span>machine X</span></span><span class="hyp-type"><b>: </b><span>VLSMMachine (vtype X)</span></span></span></span><br><span><var>s</var><span class="hyp-type"><b>: </b><span>state</span></span></span><br><span><var>om</var><span class="hyp-type"><b>: </b><span>option message</span></span></span><br><span><var>Hp</var><span class="hyp-type"><b>: </b><span>valid_state_message_prop s om</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">initial_state_prop s ‚àß option_initial_message_prop om
‚à® (<span class="kr">‚àÉ</span> (<span class="nv">is</span> : state) (<span class="nv">tr</span> : list transition_item),
     finite_valid_trace_init_to <span class="kr">is</span> s tr
     ‚àß finite_trace_last_output tr = om)</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">      </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="VLSM-v-chk310" style="display: none" type="checkbox"><label class="alectryon-input" for="VLSM-v-chk310"><span class="nb">apply</span> finite_valid_trace_init_to_emit_valid_state_message_rev <span class="kr">in</span> Hp <span class="kr">as</span> [<span class="kr">is</span> [tr Htr]].</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>message</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>X</var><span class="hyp-type"><b>: </b><span>VLSM message</span></span></span><br><span><var>TypeX</var><span><span class="hyp-body"><b>:= </b><span>type X</span></span><span class="hyp-type"><b>: </b><span>VLSMType message</span></span></span></span><br><span><var>MachineX</var><span><span class="hyp-body"><b>:= </b><span>machine X</span></span><span class="hyp-type"><b>: </b><span>VLSMMachine (vtype X)</span></span></span></span><br><span><var>s</var><span class="hyp-type"><b>: </b><span>state</span></span></span><br><span><var>om</var><span class="hyp-type"><b>: </b><span>option message</span></span></span><br><span><var>is</var><span class="hyp-type"><b>: </b><span>state</span></span></span><br><span><var>tr</var><span class="hyp-type"><b>: </b><span>list transition_item</span></span></span><br><span><var>Htr</var><span class="hyp-type"><b>: </b><span>finite_valid_trace_init_to_emit <span class="kr">is</span> s om tr</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">initial_state_prop s ‚àß option_initial_message_prop om
‚à® (<span class="kr">‚àÉ</span> (<span class="nv">is</span> : state) (<span class="nv">tr</span> : list transition_item),
     finite_valid_trace_init_to <span class="kr">is</span> s tr
     ‚àß finite_trace_last_output tr = om)</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">      </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="VLSM-v-chk311" style="display: none" type="checkbox"><label class="alectryon-input" for="VLSM-v-chk311"><span class="nb">apply</span> finite_valid_trace_init_to_emit_output <span class="kr">in</span> Htr <span class="kr">as</span> Houtput.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>message</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>X</var><span class="hyp-type"><b>: </b><span>VLSM message</span></span></span><br><span><var>TypeX</var><span><span class="hyp-body"><b>:= </b><span>type X</span></span><span class="hyp-type"><b>: </b><span>VLSMType message</span></span></span></span><br><span><var>MachineX</var><span><span class="hyp-body"><b>:= </b><span>machine X</span></span><span class="hyp-type"><b>: </b><span>VLSMMachine (vtype X)</span></span></span></span><br><span><var>s</var><span class="hyp-type"><b>: </b><span>state</span></span></span><br><span><var>om</var><span class="hyp-type"><b>: </b><span>option message</span></span></span><br><span><var>is</var><span class="hyp-type"><b>: </b><span>state</span></span></span><br><span><var>tr</var><span class="hyp-type"><b>: </b><span>list transition_item</span></span></span><br><span><var>Htr</var><span class="hyp-type"><b>: </b><span>finite_valid_trace_init_to_emit <span class="kr">is</span> s om tr</span></span></span><br><span><var>Houtput</var><span class="hyp-type"><b>: </b><span>empty_initial_message_or_final_output tr om</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">initial_state_prop s ‚àß option_initial_message_prop om
‚à® (<span class="kr">‚àÉ</span> (<span class="nv">is</span> : state) (<span class="nv">tr</span> : list transition_item),
     finite_valid_trace_init_to <span class="kr">is</span> s tr
     ‚àß finite_trace_last_output tr = om)</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">      </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="VLSM-v-chk312" style="display: none" type="checkbox"><label class="alectryon-input" for="VLSM-v-chk312"><span class="nb">unfold</span> empty_initial_message_or_final_output <span class="kr">in</span> Houtput.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>message</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>X</var><span class="hyp-type"><b>: </b><span>VLSM message</span></span></span><br><span><var>TypeX</var><span><span class="hyp-body"><b>:= </b><span>type X</span></span><span class="hyp-type"><b>: </b><span>VLSMType message</span></span></span></span><br><span><var>MachineX</var><span><span class="hyp-body"><b>:= </b><span>machine X</span></span><span class="hyp-type"><b>: </b><span>VLSMMachine (vtype X)</span></span></span></span><br><span><var>s</var><span class="hyp-type"><b>: </b><span>state</span></span></span><br><span><var>om</var><span class="hyp-type"><b>: </b><span>option message</span></span></span><br><span><var>is</var><span class="hyp-type"><b>: </b><span>state</span></span></span><br><span><var>tr</var><span class="hyp-type"><b>: </b><span>list transition_item</span></span></span><br><span><var>Htr</var><span class="hyp-type"><b>: </b><span>finite_valid_trace_init_to_emit <span class="kr">is</span> s om tr</span></span></span><br><span><var>Houtput</var><span class="hyp-type"><b>: </b><span><span class="kr">match</span> has_last_or_null tr <span class="kr">with</span>
| inleft (existT _tmp (item ‚Üæ _)) =&gt;
    output item = om
| inright _ =&gt;
    option_initial_message_prop om
<span class="kr">end</span></span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">initial_state_prop s ‚àß option_initial_message_prop om
‚à® (<span class="kr">‚àÉ</span> (<span class="nv">is</span> : state) (<span class="nv">tr</span> : list transition_item),
     finite_valid_trace_init_to <span class="kr">is</span> s tr
     ‚àß finite_trace_last_output tr = om)</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">      </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="VLSM-v-chk313" style="display: none" type="checkbox"><label class="alectryon-input" for="VLSM-v-chk313">destruct_list_last tr tr&#39; item Heqtr.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>message</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>X</var><span class="hyp-type"><b>: </b><span>VLSM message</span></span></span><br><span><var>TypeX</var><span><span class="hyp-body"><b>:= </b><span>type X</span></span><span class="hyp-type"><b>: </b><span>VLSMType message</span></span></span></span><br><span><var>MachineX</var><span><span class="hyp-body"><b>:= </b><span>machine X</span></span><span class="hyp-type"><b>: </b><span>VLSMMachine (vtype X)</span></span></span></span><br><span><var>s</var><span class="hyp-type"><b>: </b><span>state</span></span></span><br><span><var>om</var><span class="hyp-type"><b>: </b><span>option message</span></span></span><br><span><var>is</var><span class="hyp-type"><b>: </b><span>state</span></span></span><br><span><var>tr</var><span class="hyp-type"><b>: </b><span>list transition_item</span></span></span><br><span><var>Htr</var><span class="hyp-type"><b>: </b><span>finite_valid_trace_init_to_emit <span class="kr">is</span> s om []</span></span></span><br><span><var>Heqtr</var><span class="hyp-type"><b>: </b><span>tr = []</span></span></span><br><span><var>Houtput</var><span class="hyp-type"><b>: </b><span>option_initial_message_prop om</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">initial_state_prop s ‚àß option_initial_message_prop om
‚à® (<span class="kr">‚àÉ</span> (<span class="nv">is</span> : state) (<span class="nv">tr</span> : list transition_item),
     finite_valid_trace_init_to <span class="kr">is</span> s tr
     ‚àß finite_trace_last_output tr = om)</div></blockquote><div class="alectryon-extra-goals"><input class="alectryon-extra-goal-toggle" id="VLSM-v-chk314" style="display: none" type="checkbox"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>message</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>X</var><span class="hyp-type"><b>: </b><span>VLSM message</span></span></span><br><span><var>TypeX</var><span><span class="hyp-body"><b>:= </b><span>type X</span></span><span class="hyp-type"><b>: </b><span>VLSMType message</span></span></span></span><br><span><var>MachineX</var><span><span class="hyp-body"><b>:= </b><span>machine X</span></span><span class="hyp-type"><b>: </b><span>VLSMMachine (vtype X)</span></span></span></span><br><span><var>s</var><span class="hyp-type"><b>: </b><span>state</span></span></span><br><span><var>om</var><span class="hyp-type"><b>: </b><span>option message</span></span></span><br><span><var>is</var><span class="hyp-type"><b>: </b><span>state</span></span></span><br><span><var>tr, tr'</var><span class="hyp-type"><b>: </b><span>list transition_item</span></span></span><br><span><var>item</var><span class="hyp-type"><b>: </b><span>transition_item</span></span></span><br><span><var>Htr</var><span class="hyp-type"><b>: </b><span>finite_valid_trace_init_to_emit <span class="kr">is</span> s om
  (tr&#39; ++ [item])</span></span></span><br><span><var>Heqtr</var><span class="hyp-type"><b>: </b><span>tr = tr&#39; ++ [item]</span></span></span><br><span><var>Houtput</var><span class="hyp-type"><b>: </b><span>output item = om</span></span></span><br></div><label class="goal-separator" for="VLSM-v-chk314"><hr></label><div class="goal-conclusion">initial_state_prop s ‚àß option_initial_message_prop om
‚à® (<span class="kr">‚àÉ</span> (<span class="nv">is</span> : state) (<span class="nv">tr</span> : list transition_item),
     finite_valid_trace_init_to <span class="kr">is</span> s tr
     ‚àß finite_trace_last_output tr = om)</div></blockquote></div></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">      </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="VLSM-v-chk315" style="display: none" type="checkbox"><label class="alectryon-input" for="VLSM-v-chk315">-</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>message</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>X</var><span class="hyp-type"><b>: </b><span>VLSM message</span></span></span><br><span><var>TypeX</var><span><span class="hyp-body"><b>:= </b><span>type X</span></span><span class="hyp-type"><b>: </b><span>VLSMType message</span></span></span></span><br><span><var>MachineX</var><span><span class="hyp-body"><b>:= </b><span>machine X</span></span><span class="hyp-type"><b>: </b><span>VLSMMachine (vtype X)</span></span></span></span><br><span><var>s</var><span class="hyp-type"><b>: </b><span>state</span></span></span><br><span><var>om</var><span class="hyp-type"><b>: </b><span>option message</span></span></span><br><span><var>is</var><span class="hyp-type"><b>: </b><span>state</span></span></span><br><span><var>tr</var><span class="hyp-type"><b>: </b><span>list transition_item</span></span></span><br><span><var>Htr</var><span class="hyp-type"><b>: </b><span>finite_valid_trace_init_to_emit <span class="kr">is</span> s om []</span></span></span><br><span><var>Heqtr</var><span class="hyp-type"><b>: </b><span>tr = []</span></span></span><br><span><var>Houtput</var><span class="hyp-type"><b>: </b><span>option_initial_message_prop om</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">initial_state_prop s ‚àß option_initial_message_prop om
‚à® (<span class="kr">‚àÉ</span> (<span class="nv">is</span> : state) (<span class="nv">tr</span> : list transition_item),
     finite_valid_trace_init_to <span class="kr">is</span> s tr
     ‚àß finite_trace_last_output tr = om)</div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="VLSM-v-chk316" style="display: none" type="checkbox"><label class="alectryon-input" for="VLSM-v-chk316"><span class="nb">left</span>.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>message</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>X</var><span class="hyp-type"><b>: </b><span>VLSM message</span></span></span><br><span><var>TypeX</var><span><span class="hyp-body"><b>:= </b><span>type X</span></span><span class="hyp-type"><b>: </b><span>VLSMType message</span></span></span></span><br><span><var>MachineX</var><span><span class="hyp-body"><b>:= </b><span>machine X</span></span><span class="hyp-type"><b>: </b><span>VLSMMachine (vtype X)</span></span></span></span><br><span><var>s</var><span class="hyp-type"><b>: </b><span>state</span></span></span><br><span><var>om</var><span class="hyp-type"><b>: </b><span>option message</span></span></span><br><span><var>is</var><span class="hyp-type"><b>: </b><span>state</span></span></span><br><span><var>tr</var><span class="hyp-type"><b>: </b><span>list transition_item</span></span></span><br><span><var>Htr</var><span class="hyp-type"><b>: </b><span>finite_valid_trace_init_to_emit <span class="kr">is</span> s om []</span></span></span><br><span><var>Heqtr</var><span class="hyp-type"><b>: </b><span>tr = []</span></span></span><br><span><var>Houtput</var><span class="hyp-type"><b>: </b><span>option_initial_message_prop om</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">initial_state_prop s ‚àß option_initial_message_prop om</div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="VLSM-v-chk317" style="display: none" type="checkbox"><label class="alectryon-input" for="VLSM-v-chk317"><span class="nb">split</span>; [|<span class="bp">assumption</span>].</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>message</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>X</var><span class="hyp-type"><b>: </b><span>VLSM message</span></span></span><br><span><var>TypeX</var><span><span class="hyp-body"><b>:= </b><span>type X</span></span><span class="hyp-type"><b>: </b><span>VLSMType message</span></span></span></span><br><span><var>MachineX</var><span><span class="hyp-body"><b>:= </b><span>machine X</span></span><span class="hyp-type"><b>: </b><span>VLSMMachine (vtype X)</span></span></span></span><br><span><var>s</var><span class="hyp-type"><b>: </b><span>state</span></span></span><br><span><var>om</var><span class="hyp-type"><b>: </b><span>option message</span></span></span><br><span><var>is</var><span class="hyp-type"><b>: </b><span>state</span></span></span><br><span><var>tr</var><span class="hyp-type"><b>: </b><span>list transition_item</span></span></span><br><span><var>Htr</var><span class="hyp-type"><b>: </b><span>finite_valid_trace_init_to_emit <span class="kr">is</span> s om []</span></span></span><br><span><var>Heqtr</var><span class="hyp-type"><b>: </b><span>tr = []</span></span></span><br><span><var>Houtput</var><span class="hyp-type"><b>: </b><span>option_initial_message_prop om</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">initial_state_prop s</div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="VLSM-v-chk318" style="display: none" type="checkbox"><label class="alectryon-input" for="VLSM-v-chk318"><span class="nb">inversion</span> Htr; [<span class="bp">assumption</span>|].</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>message</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>X</var><span class="hyp-type"><b>: </b><span>VLSM message</span></span></span><br><span><var>TypeX</var><span><span class="hyp-body"><b>:= </b><span>type X</span></span><span class="hyp-type"><b>: </b><span>VLSMType message</span></span></span></span><br><span><var>MachineX</var><span><span class="hyp-body"><b>:= </b><span>machine X</span></span><span class="hyp-type"><b>: </b><span>VLSMMachine (vtype X)</span></span></span></span><br><span><var>s</var><span class="hyp-type"><b>: </b><span>state</span></span></span><br><span><var>om</var><span class="hyp-type"><b>: </b><span>option message</span></span></span><br><span><var>is</var><span class="hyp-type"><b>: </b><span>state</span></span></span><br><span><var>tr</var><span class="hyp-type"><b>: </b><span>list transition_item</span></span></span><br><span><var>Htr</var><span class="hyp-type"><b>: </b><span>finite_valid_trace_init_to_emit <span class="kr">is</span> s om []</span></span></span><br><span><var>Heqtr</var><span class="hyp-type"><b>: </b><span>tr = []</span></span></span><br><span><var>Houtput</var><span class="hyp-type"><b>: </b><span>option_initial_message_prop om</span></span></span><br><span><var>is0, s1</var><span class="hyp-type"><b>: </b><span>state</span></span></span><br><span><var>_om</var><span class="hyp-type"><b>: </b><span>option message</span></span></span><br><span><var>tl</var><span class="hyp-type"><b>: </b><span>list transition_item</span></span></span><br><span><var>iom_is, iom_s</var><span class="hyp-type"><b>: </b><span>state</span></span></span><br><span><var>iom</var><span class="hyp-type"><b>: </b><span>option message</span></span></span><br><span><var>iom_tl</var><span class="hyp-type"><b>: </b><span>list transition_item</span></span></span><br><span><var>l0</var><span class="hyp-type"><b>: </b><span>label</span></span></span><br><span><var>s'</var><span class="hyp-type"><b>: </b><span>state</span></span></span><br><span><var>oom</var><span class="hyp-type"><b>: </b><span>option message</span></span></span><br><span><var>Hs</var><span class="hyp-type"><b>: </b><span>finite_valid_trace_init_to_emit <span class="kr">is</span> s1 _om tl</span></span></span><br><span><var>Hiom</var><span class="hyp-type"><b>: </b><span>finite_valid_trace_init_to_emit iom_is iom_s
  iom iom_tl</span></span></span><br><span><var>Hv</var><span class="hyp-type"><b>: </b><span>valid l0 (s1, iom)</span></span></span><br><span><var>Ht</var><span class="hyp-type"><b>: </b><span>transition l0 (s1, iom) = (s, om)</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>is0 = <span class="kr">is</span></span></span></span><br><span><var>H0</var><span class="hyp-type"><b>: </b><span>s&#39; = s</span></span></span><br><span><var>H1</var><span class="hyp-type"><b>: </b><span>oom = om</span></span></span><br><span><var>H3</var><span class="hyp-type"><b>: </b><span>tl ++
[{|
   l := l0;
   input := iom;
   destination := s;
   output := om
 |}] = []</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">initial_state_prop s</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">        </span><span class="alectryon-sentence"><span class="alectryon-input"><span class="nb">destruct</span> tl; <span class="nb">simpl</span> <span class="kr">in</span> *; <span class="bp">congruence</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">      </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="VLSM-v-chk319" style="display: none" type="checkbox"><label class="alectryon-input" for="VLSM-v-chk319">-</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>message</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>X</var><span class="hyp-type"><b>: </b><span>VLSM message</span></span></span><br><span><var>TypeX</var><span><span class="hyp-body"><b>:= </b><span>type X</span></span><span class="hyp-type"><b>: </b><span>VLSMType message</span></span></span></span><br><span><var>MachineX</var><span><span class="hyp-body"><b>:= </b><span>machine X</span></span><span class="hyp-type"><b>: </b><span>VLSMMachine (vtype X)</span></span></span></span><br><span><var>s</var><span class="hyp-type"><b>: </b><span>state</span></span></span><br><span><var>om</var><span class="hyp-type"><b>: </b><span>option message</span></span></span><br><span><var>is</var><span class="hyp-type"><b>: </b><span>state</span></span></span><br><span><var>tr, tr'</var><span class="hyp-type"><b>: </b><span>list transition_item</span></span></span><br><span><var>item</var><span class="hyp-type"><b>: </b><span>transition_item</span></span></span><br><span><var>Htr</var><span class="hyp-type"><b>: </b><span>finite_valid_trace_init_to_emit <span class="kr">is</span> s om
  (tr&#39; ++ [item])</span></span></span><br><span><var>Heqtr</var><span class="hyp-type"><b>: </b><span>tr = tr&#39; ++ [item]</span></span></span><br><span><var>Houtput</var><span class="hyp-type"><b>: </b><span>output item = om</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">initial_state_prop s ‚àß option_initial_message_prop om
‚à® (<span class="kr">‚àÉ</span> (<span class="nv">is</span> : state) (<span class="nv">tr</span> : list transition_item),
     finite_valid_trace_init_to <span class="kr">is</span> s tr
     ‚àß finite_trace_last_output tr = om)</div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="VLSM-v-chk31a" style="display: none" type="checkbox"><label class="alectryon-input" for="VLSM-v-chk31a"><span class="nb">right</span>.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>message</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>X</var><span class="hyp-type"><b>: </b><span>VLSM message</span></span></span><br><span><var>TypeX</var><span><span class="hyp-body"><b>:= </b><span>type X</span></span><span class="hyp-type"><b>: </b><span>VLSMType message</span></span></span></span><br><span><var>MachineX</var><span><span class="hyp-body"><b>:= </b><span>machine X</span></span><span class="hyp-type"><b>: </b><span>VLSMMachine (vtype X)</span></span></span></span><br><span><var>s</var><span class="hyp-type"><b>: </b><span>state</span></span></span><br><span><var>om</var><span class="hyp-type"><b>: </b><span>option message</span></span></span><br><span><var>is</var><span class="hyp-type"><b>: </b><span>state</span></span></span><br><span><var>tr, tr'</var><span class="hyp-type"><b>: </b><span>list transition_item</span></span></span><br><span><var>item</var><span class="hyp-type"><b>: </b><span>transition_item</span></span></span><br><span><var>Htr</var><span class="hyp-type"><b>: </b><span>finite_valid_trace_init_to_emit <span class="kr">is</span> s om
  (tr&#39; ++ [item])</span></span></span><br><span><var>Heqtr</var><span class="hyp-type"><b>: </b><span>tr = tr&#39; ++ [item]</span></span></span><br><span><var>Houtput</var><span class="hyp-type"><b>: </b><span>output item = om</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="kr">‚àÉ</span> (<span class="nv">is</span> : state) (<span class="nv">tr</span> : list transition_item),
  finite_valid_trace_init_to <span class="kr">is</span> s tr
  ‚àß finite_trace_last_output tr = om</div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="VLSM-v-chk31b" style="display: none" type="checkbox"><label class="alectryon-input" for="VLSM-v-chk31b"><span class="nb">apply</span> finite_valid_trace_init_to_emit_forget_emit <span class="kr">in</span> Htr.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>message</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>X</var><span class="hyp-type"><b>: </b><span>VLSM message</span></span></span><br><span><var>TypeX</var><span><span class="hyp-body"><b>:= </b><span>type X</span></span><span class="hyp-type"><b>: </b><span>VLSMType message</span></span></span></span><br><span><var>MachineX</var><span><span class="hyp-body"><b>:= </b><span>machine X</span></span><span class="hyp-type"><b>: </b><span>VLSMMachine (vtype X)</span></span></span></span><br><span><var>s</var><span class="hyp-type"><b>: </b><span>state</span></span></span><br><span><var>om</var><span class="hyp-type"><b>: </b><span>option message</span></span></span><br><span><var>is</var><span class="hyp-type"><b>: </b><span>state</span></span></span><br><span><var>tr, tr'</var><span class="hyp-type"><b>: </b><span>list transition_item</span></span></span><br><span><var>item</var><span class="hyp-type"><b>: </b><span>transition_item</span></span></span><br><span><var>Htr</var><span class="hyp-type"><b>: </b><span>finite_valid_trace_init_to <span class="kr">is</span> s (tr&#39; ++ [item])</span></span></span><br><span><var>Heqtr</var><span class="hyp-type"><b>: </b><span>tr = tr&#39; ++ [item]</span></span></span><br><span><var>Houtput</var><span class="hyp-type"><b>: </b><span>output item = om</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="kr">‚àÉ</span> (<span class="nv">is</span> : state) (<span class="nv">tr</span> : list transition_item),
  finite_valid_trace_init_to <span class="kr">is</span> s tr
  ‚àß finite_trace_last_output tr = om</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">        </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="VLSM-v-chk31c" style="display: none" type="checkbox"><label class="alectryon-input" for="VLSM-v-chk31c"><span class="nb">eexists</span> _,_.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>message</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>X</var><span class="hyp-type"><b>: </b><span>VLSM message</span></span></span><br><span><var>TypeX</var><span><span class="hyp-body"><b>:= </b><span>type X</span></span><span class="hyp-type"><b>: </b><span>VLSMType message</span></span></span></span><br><span><var>MachineX</var><span><span class="hyp-body"><b>:= </b><span>machine X</span></span><span class="hyp-type"><b>: </b><span>VLSMMachine (vtype X)</span></span></span></span><br><span><var>s</var><span class="hyp-type"><b>: </b><span>state</span></span></span><br><span><var>om</var><span class="hyp-type"><b>: </b><span>option message</span></span></span><br><span><var>is</var><span class="hyp-type"><b>: </b><span>state</span></span></span><br><span><var>tr, tr'</var><span class="hyp-type"><b>: </b><span>list transition_item</span></span></span><br><span><var>item</var><span class="hyp-type"><b>: </b><span>transition_item</span></span></span><br><span><var>Htr</var><span class="hyp-type"><b>: </b><span>finite_valid_trace_init_to <span class="kr">is</span> s (tr&#39; ++ [item])</span></span></span><br><span><var>Heqtr</var><span class="hyp-type"><b>: </b><span>tr = tr&#39; ++ [item]</span></span></span><br><span><var>Houtput</var><span class="hyp-type"><b>: </b><span>output item = om</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">finite_valid_trace_init_to <span class="nl">?Goal</span> s <span class="nl">?Goal0</span>
‚àß finite_trace_last_output <span class="nl">?Goal0</span> = om</div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="VLSM-v-chk31d" style="display: none" type="checkbox"><label class="alectryon-input" for="VLSM-v-chk31d"><span class="nb">split</span>; [<span class="bp">exact</span> Htr|].</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>message</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>X</var><span class="hyp-type"><b>: </b><span>VLSM message</span></span></span><br><span><var>TypeX</var><span><span class="hyp-body"><b>:= </b><span>type X</span></span><span class="hyp-type"><b>: </b><span>VLSMType message</span></span></span></span><br><span><var>MachineX</var><span><span class="hyp-body"><b>:= </b><span>machine X</span></span><span class="hyp-type"><b>: </b><span>VLSMMachine (vtype X)</span></span></span></span><br><span><var>s</var><span class="hyp-type"><b>: </b><span>state</span></span></span><br><span><var>om</var><span class="hyp-type"><b>: </b><span>option message</span></span></span><br><span><var>is</var><span class="hyp-type"><b>: </b><span>state</span></span></span><br><span><var>tr, tr'</var><span class="hyp-type"><b>: </b><span>list transition_item</span></span></span><br><span><var>item</var><span class="hyp-type"><b>: </b><span>transition_item</span></span></span><br><span><var>Htr</var><span class="hyp-type"><b>: </b><span>finite_valid_trace_init_to <span class="kr">is</span> s (tr&#39; ++ [item])</span></span></span><br><span><var>Heqtr</var><span class="hyp-type"><b>: </b><span>tr = tr&#39; ++ [item]</span></span></span><br><span><var>Houtput</var><span class="hyp-type"><b>: </b><span>output item = om</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">finite_trace_last_output (tr&#39; ++ [item]) = om</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">        </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="VLSM-v-chk31e" style="display: none" type="checkbox"><label class="alectryon-input" for="VLSM-v-chk31e"><span class="nb">rewrite</span> finite_trace_last_output_is_last.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>message</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>X</var><span class="hyp-type"><b>: </b><span>VLSM message</span></span></span><br><span><var>TypeX</var><span><span class="hyp-body"><b>:= </b><span>type X</span></span><span class="hyp-type"><b>: </b><span>VLSMType message</span></span></span></span><br><span><var>MachineX</var><span><span class="hyp-body"><b>:= </b><span>machine X</span></span><span class="hyp-type"><b>: </b><span>VLSMMachine (vtype X)</span></span></span></span><br><span><var>s</var><span class="hyp-type"><b>: </b><span>state</span></span></span><br><span><var>om</var><span class="hyp-type"><b>: </b><span>option message</span></span></span><br><span><var>is</var><span class="hyp-type"><b>: </b><span>state</span></span></span><br><span><var>tr, tr'</var><span class="hyp-type"><b>: </b><span>list transition_item</span></span></span><br><span><var>item</var><span class="hyp-type"><b>: </b><span>transition_item</span></span></span><br><span><var>Htr</var><span class="hyp-type"><b>: </b><span>finite_valid_trace_init_to <span class="kr">is</span> s (tr&#39; ++ [item])</span></span></span><br><span><var>Heqtr</var><span class="hyp-type"><b>: </b><span>tr = tr&#39; ++ [item]</span></span></span><br><span><var>Houtput</var><span class="hyp-type"><b>: </b><span>output item = om</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">output item = om</div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="bp">assumption</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Qed</span>.</span></span></pre><div class="doc">
Giving a trace for <span class="inlinecode"><span class="id" title="var">valid_state_prop</span></span> can be stated more
        simply than <span class="inlinecode"><span class="id" title="var">valid_state_message_has_trace</span></span>, because we don't need a
        disjunction because we are not making claims about <span class="inlinecode"><span class="id" title="var">output</span></span>
        messages.
     
</div><pre class="alectryon-io highlight"><!-- Generator: Alectryon --><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="VLSM-v-chk31f" style="display: none" type="checkbox"><label class="alectryon-input" for="VLSM-v-chk31f"><span class="kn">Lemma</span> <span class="nf">valid_state_has_trace</span>
          (<span class="nv">s</span> : state)
          (<span class="nv">Hp</span> : valid_state_prop s):
      <span class="kr">exists</span> (<span class="nv">is</span> : state) (<span class="nv">tr</span> : list transition_item),
        finite_valid_trace_init_to <span class="kr">is</span> s tr.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>message</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>X</var><span class="hyp-type"><b>: </b><span>VLSM message</span></span></span><br><span><var>TypeX</var><span><span class="hyp-body"><b>:= </b><span>type X</span></span><span class="hyp-type"><b>: </b><span>VLSMType message</span></span></span></span><br><span><var>MachineX</var><span><span class="hyp-body"><b>:= </b><span>machine X</span></span><span class="hyp-type"><b>: </b><span>VLSMMachine (vtype X)</span></span></span></span><br><span><var>s</var><span class="hyp-type"><b>: </b><span>state</span></span></span><br><span><var>Hp</var><span class="hyp-type"><b>: </b><span>valid_state_prop s</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="kr">‚àÉ</span> (<span class="nv">is</span> : state) (<span class="nv">tr</span> : list transition_item),
  finite_valid_trace_init_to <span class="kr">is</span> s tr</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="VLSM-v-chk320" style="display: none" type="checkbox"><label class="alectryon-input" for="VLSM-v-chk320"><span class="kn">Proof using</span>.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>message</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>X</var><span class="hyp-type"><b>: </b><span>VLSM message</span></span></span><br><span><var>TypeX</var><span><span class="hyp-body"><b>:= </b><span>type X</span></span><span class="hyp-type"><b>: </b><span>VLSMType message</span></span></span></span><br><span><var>MachineX</var><span><span class="hyp-body"><b>:= </b><span>machine X</span></span><span class="hyp-type"><b>: </b><span>VLSMMachine (vtype X)</span></span></span></span><br><span><var>s</var><span class="hyp-type"><b>: </b><span>state</span></span></span><br><span><var>Hp</var><span class="hyp-type"><b>: </b><span>valid_state_prop s</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="kr">‚àÉ</span> (<span class="nv">is</span> : state) (<span class="nv">tr</span> : list transition_item),
  finite_valid_trace_init_to <span class="kr">is</span> s tr</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">      </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="VLSM-v-chk321" style="display: none" type="checkbox"><label class="alectryon-input" for="VLSM-v-chk321"><span class="nb">destruct</span> Hp <span class="kr">as</span> [_om Hp].</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>message</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>X</var><span class="hyp-type"><b>: </b><span>VLSM message</span></span></span><br><span><var>TypeX</var><span><span class="hyp-body"><b>:= </b><span>type X</span></span><span class="hyp-type"><b>: </b><span>VLSMType message</span></span></span></span><br><span><var>MachineX</var><span><span class="hyp-body"><b>:= </b><span>machine X</span></span><span class="hyp-type"><b>: </b><span>VLSMMachine (vtype X)</span></span></span></span><br><span><var>s</var><span class="hyp-type"><b>: </b><span>state</span></span></span><br><span><var>_om</var><span class="hyp-type"><b>: </b><span>option message</span></span></span><br><span><var>Hp</var><span class="hyp-type"><b>: </b><span>valid_state_message_prop s _om</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="kr">‚àÉ</span> (<span class="nv">is</span> : state) (<span class="nv">tr</span> : list transition_item),
  finite_valid_trace_init_to <span class="kr">is</span> s tr</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">      </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="VLSM-v-chk322" style="display: none" type="checkbox"><label class="alectryon-input" for="VLSM-v-chk322"><span class="nb">apply</span> valid_state_message_has_trace <span class="kr">in</span> Hp.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>message</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>X</var><span class="hyp-type"><b>: </b><span>VLSM message</span></span></span><br><span><var>TypeX</var><span><span class="hyp-body"><b>:= </b><span>type X</span></span><span class="hyp-type"><b>: </b><span>VLSMType message</span></span></span></span><br><span><var>MachineX</var><span><span class="hyp-body"><b>:= </b><span>machine X</span></span><span class="hyp-type"><b>: </b><span>VLSMMachine (vtype X)</span></span></span></span><br><span><var>s</var><span class="hyp-type"><b>: </b><span>state</span></span></span><br><span><var>_om</var><span class="hyp-type"><b>: </b><span>option message</span></span></span><br><span><var>Hp</var><span class="hyp-type"><b>: </b><span>initial_state_prop s
‚àß option_initial_message_prop _om
‚à® (<span class="kr">‚àÉ</span> (<span class="nv">is</span> : state) (<span class="nv">tr</span> : list transition_item),
     finite_valid_trace_init_to <span class="kr">is</span> s tr
     ‚àß finite_trace_last_output tr = _om)</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="kr">‚àÉ</span> (<span class="nv">is</span> : state) (<span class="nv">tr</span> : list transition_item),
  finite_valid_trace_init_to <span class="kr">is</span> s tr</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">      </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="VLSM-v-chk323" style="display: none" type="checkbox"><label class="alectryon-input" for="VLSM-v-chk323"><span class="nb">destruct</span> Hp <span class="kr">as</span> [[Hinit _]|Htrace].</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>message</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>X</var><span class="hyp-type"><b>: </b><span>VLSM message</span></span></span><br><span><var>TypeX</var><span><span class="hyp-body"><b>:= </b><span>type X</span></span><span class="hyp-type"><b>: </b><span>VLSMType message</span></span></span></span><br><span><var>MachineX</var><span><span class="hyp-body"><b>:= </b><span>machine X</span></span><span class="hyp-type"><b>: </b><span>VLSMMachine (vtype X)</span></span></span></span><br><span><var>s</var><span class="hyp-type"><b>: </b><span>state</span></span></span><br><span><var>_om</var><span class="hyp-type"><b>: </b><span>option message</span></span></span><br><span><var>Hinit</var><span class="hyp-type"><b>: </b><span>initial_state_prop s</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="kr">‚àÉ</span> (<span class="nv">is</span> : state) (<span class="nv">tr</span> : list transition_item),
  finite_valid_trace_init_to <span class="kr">is</span> s tr</div></blockquote><div class="alectryon-extra-goals"><input class="alectryon-extra-goal-toggle" id="VLSM-v-chk324" style="display: none" type="checkbox"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>message</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>X</var><span class="hyp-type"><b>: </b><span>VLSM message</span></span></span><br><span><var>TypeX</var><span><span class="hyp-body"><b>:= </b><span>type X</span></span><span class="hyp-type"><b>: </b><span>VLSMType message</span></span></span></span><br><span><var>MachineX</var><span><span class="hyp-body"><b>:= </b><span>machine X</span></span><span class="hyp-type"><b>: </b><span>VLSMMachine (vtype X)</span></span></span></span><br><span><var>s</var><span class="hyp-type"><b>: </b><span>state</span></span></span><br><span><var>_om</var><span class="hyp-type"><b>: </b><span>option message</span></span></span><br><span><var>Htrace</var><span class="hyp-type"><b>: </b><span><span class="kr">‚àÉ</span> (<span class="nv">is</span> : state) (<span class="nv">tr</span> : list transition_item),
  finite_valid_trace_init_to <span class="kr">is</span> s tr
  ‚àß finite_trace_last_output tr = _om</span></span></span><br></div><label class="goal-separator" for="VLSM-v-chk324"><hr></label><div class="goal-conclusion"><span class="kr">‚àÉ</span> (<span class="nv">is</span> : state) (<span class="nv">tr</span> : list transition_item),
  finite_valid_trace_init_to <span class="kr">is</span> s tr</div></blockquote></div></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">      </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="VLSM-v-chk325" style="display: none" type="checkbox"><label class="alectryon-input" for="VLSM-v-chk325">+</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>message</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>X</var><span class="hyp-type"><b>: </b><span>VLSM message</span></span></span><br><span><var>TypeX</var><span><span class="hyp-body"><b>:= </b><span>type X</span></span><span class="hyp-type"><b>: </b><span>VLSMType message</span></span></span></span><br><span><var>MachineX</var><span><span class="hyp-body"><b>:= </b><span>machine X</span></span><span class="hyp-type"><b>: </b><span>VLSMMachine (vtype X)</span></span></span></span><br><span><var>s</var><span class="hyp-type"><b>: </b><span>state</span></span></span><br><span><var>_om</var><span class="hyp-type"><b>: </b><span>option message</span></span></span><br><span><var>Hinit</var><span class="hyp-type"><b>: </b><span>initial_state_prop s</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="kr">‚àÉ</span> (<span class="nv">is</span> : state) (<span class="nv">tr</span> : list transition_item),
  finite_valid_trace_init_to <span class="kr">is</span> s tr</div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="VLSM-v-chk326" style="display: none" type="checkbox"><label class="alectryon-input" for="VLSM-v-chk326"><span class="kr">exists</span> <span class="nv">s</span>, [].</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>message</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>X</var><span class="hyp-type"><b>: </b><span>VLSM message</span></span></span><br><span><var>TypeX</var><span><span class="hyp-body"><b>:= </b><span>type X</span></span><span class="hyp-type"><b>: </b><span>VLSMType message</span></span></span></span><br><span><var>MachineX</var><span><span class="hyp-body"><b>:= </b><span>machine X</span></span><span class="hyp-type"><b>: </b><span>VLSMMachine (vtype X)</span></span></span></span><br><span><var>s</var><span class="hyp-type"><b>: </b><span>state</span></span></span><br><span><var>_om</var><span class="hyp-type"><b>: </b><span>option message</span></span></span><br><span><var>Hinit</var><span class="hyp-type"><b>: </b><span>initial_state_prop s</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">finite_valid_trace_init_to s s []</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">        </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="VLSM-v-chk327" style="display: none" type="checkbox"><label class="alectryon-input" for="VLSM-v-chk327"><span class="nb">split</span>;[|<span class="bp">assumption</span>].</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>message</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>X</var><span class="hyp-type"><b>: </b><span>VLSM message</span></span></span><br><span><var>TypeX</var><span><span class="hyp-body"><b>:= </b><span>type X</span></span><span class="hyp-type"><b>: </b><span>VLSMType message</span></span></span></span><br><span><var>MachineX</var><span><span class="hyp-body"><b>:= </b><span>machine X</span></span><span class="hyp-type"><b>: </b><span>VLSMMachine (vtype X)</span></span></span></span><br><span><var>s</var><span class="hyp-type"><b>: </b><span>state</span></span></span><br><span><var>_om</var><span class="hyp-type"><b>: </b><span>option message</span></span></span><br><span><var>Hinit</var><span class="hyp-type"><b>: </b><span>initial_state_prop s</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">finite_valid_trace_from_to s s []</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">        </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="VLSM-v-chk328" style="display: none" type="checkbox"><label class="alectryon-input" for="VLSM-v-chk328"><span class="nb">constructor</span>.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>message</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>X</var><span class="hyp-type"><b>: </b><span>VLSM message</span></span></span><br><span><var>TypeX</var><span><span class="hyp-body"><b>:= </b><span>type X</span></span><span class="hyp-type"><b>: </b><span>VLSMType message</span></span></span></span><br><span><var>MachineX</var><span><span class="hyp-body"><b>:= </b><span>machine X</span></span><span class="hyp-type"><b>: </b><span>VLSMMachine (vtype X)</span></span></span></span><br><span><var>s</var><span class="hyp-type"><b>: </b><span>state</span></span></span><br><span><var>_om</var><span class="hyp-type"><b>: </b><span>option message</span></span></span><br><span><var>Hinit</var><span class="hyp-type"><b>: </b><span>initial_state_prop s</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">valid_state_prop s</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">        </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="VLSM-v-chk329" style="display: none" type="checkbox"><label class="alectryon-input" for="VLSM-v-chk329"><span class="nb">apply</span> initial_state_is_valid.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>message</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>X</var><span class="hyp-type"><b>: </b><span>VLSM message</span></span></span><br><span><var>TypeX</var><span><span class="hyp-body"><b>:= </b><span>type X</span></span><span class="hyp-type"><b>: </b><span>VLSMType message</span></span></span></span><br><span><var>MachineX</var><span><span class="hyp-body"><b>:= </b><span>machine X</span></span><span class="hyp-type"><b>: </b><span>VLSMMachine (vtype X)</span></span></span></span><br><span><var>s</var><span class="hyp-type"><b>: </b><span>state</span></span></span><br><span><var>_om</var><span class="hyp-type"><b>: </b><span>option message</span></span></span><br><span><var>Hinit</var><span class="hyp-type"><b>: </b><span>initial_state_prop s</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">initial_state_prop s</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">        </span><span class="alectryon-sentence"><span class="alectryon-input"><span class="bp">assumption</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">      </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="VLSM-v-chk32a" style="display: none" type="checkbox"><label class="alectryon-input" for="VLSM-v-chk32a">+</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>message</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>X</var><span class="hyp-type"><b>: </b><span>VLSM message</span></span></span><br><span><var>TypeX</var><span><span class="hyp-body"><b>:= </b><span>type X</span></span><span class="hyp-type"><b>: </b><span>VLSMType message</span></span></span></span><br><span><var>MachineX</var><span><span class="hyp-body"><b>:= </b><span>machine X</span></span><span class="hyp-type"><b>: </b><span>VLSMMachine (vtype X)</span></span></span></span><br><span><var>s</var><span class="hyp-type"><b>: </b><span>state</span></span></span><br><span><var>_om</var><span class="hyp-type"><b>: </b><span>option message</span></span></span><br><span><var>Htrace</var><span class="hyp-type"><b>: </b><span><span class="kr">‚àÉ</span> (<span class="nv">is</span> : state) (<span class="nv">tr</span> : list transition_item),
  finite_valid_trace_init_to <span class="kr">is</span> s tr
  ‚àß finite_trace_last_output tr = _om</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="kr">‚àÉ</span> (<span class="nv">is</span> : state) (<span class="nv">tr</span> : list transition_item),
  finite_valid_trace_init_to <span class="kr">is</span> s tr</div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="VLSM-v-chk32b" style="display: none" type="checkbox"><label class="alectryon-input" for="VLSM-v-chk32b"><span class="nb">destruct</span> Htrace <span class="kr">as</span> [<span class="kr">is</span> [tr [Htr _]]].</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>message</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>X</var><span class="hyp-type"><b>: </b><span>VLSM message</span></span></span><br><span><var>TypeX</var><span><span class="hyp-body"><b>:= </b><span>type X</span></span><span class="hyp-type"><b>: </b><span>VLSMType message</span></span></span></span><br><span><var>MachineX</var><span><span class="hyp-body"><b>:= </b><span>machine X</span></span><span class="hyp-type"><b>: </b><span>VLSMMachine (vtype X)</span></span></span></span><br><span><var>s</var><span class="hyp-type"><b>: </b><span>state</span></span></span><br><span><var>_om</var><span class="hyp-type"><b>: </b><span>option message</span></span></span><br><span><var>is</var><span class="hyp-type"><b>: </b><span>state</span></span></span><br><span><var>tr</var><span class="hyp-type"><b>: </b><span>list transition_item</span></span></span><br><span><var>Htr</var><span class="hyp-type"><b>: </b><span>finite_valid_trace_init_to <span class="kr">is</span> s tr</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="kr">‚àÉ</span> (<span class="nv">is</span> : state) (<span class="nv">tr</span> : list transition_item),
  finite_valid_trace_init_to <span class="kr">is</span> s tr</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">        </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="VLSM-v-chk32c" style="display: none" type="checkbox"><label class="alectryon-input" for="VLSM-v-chk32c"><span class="kr">exists</span> <span class="nv">is</span>, tr.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>message</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>X</var><span class="hyp-type"><b>: </b><span>VLSM message</span></span></span><br><span><var>TypeX</var><span><span class="hyp-body"><b>:= </b><span>type X</span></span><span class="hyp-type"><b>: </b><span>VLSMType message</span></span></span></span><br><span><var>MachineX</var><span><span class="hyp-body"><b>:= </b><span>machine X</span></span><span class="hyp-type"><b>: </b><span>VLSMMachine (vtype X)</span></span></span></span><br><span><var>s</var><span class="hyp-type"><b>: </b><span>state</span></span></span><br><span><var>_om</var><span class="hyp-type"><b>: </b><span>option message</span></span></span><br><span><var>is</var><span class="hyp-type"><b>: </b><span>state</span></span></span><br><span><var>tr</var><span class="hyp-type"><b>: </b><span>list transition_item</span></span></span><br><span><var>Htr</var><span class="hyp-type"><b>: </b><span>finite_valid_trace_init_to <span class="kr">is</span> s tr</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">finite_valid_trace_init_to <span class="kr">is</span> s tr</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">        </span><span class="alectryon-sentence"><span class="alectryon-input"><span class="bp">assumption</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Qed</span>.</span></span></pre><div class="doc">
For any input valid transition there exists a valid trace ending in it. 
</div><pre class="alectryon-io highlight"><!-- Generator: Alectryon --><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="VLSM-v-chk32d" style="display: none" type="checkbox"><label class="alectryon-input" for="VLSM-v-chk32d"><span class="kn">Lemma</span> <span class="nf">exists_right_finite_trace_from</span>
      <span class="nv">l</span> <span class="nv">s1</span> <span class="nv">iom</span> <span class="nv">s2</span> <span class="nv">oom</span>
      (<span class="nv">Ht</span> : input_valid_transition l (s1, iom) (s2, oom))
      : <span class="kr">exists</span> <span class="nv">s0</span> <span class="nv">ts</span>, finite_valid_trace_init_to s0 s2 (ts ++ [{| l := l; destination := s2; input := iom; output := oom |}])
        /\ finite_trace_last s0 ts = s1.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>message</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>X</var><span class="hyp-type"><b>: </b><span>VLSM message</span></span></span><br><span><var>TypeX</var><span><span class="hyp-body"><b>:= </b><span>type X</span></span><span class="hyp-type"><b>: </b><span>VLSMType message</span></span></span></span><br><span><var>MachineX</var><span><span class="hyp-body"><b>:= </b><span>machine X</span></span><span class="hyp-type"><b>: </b><span>VLSMMachine (vtype X)</span></span></span></span><br><span><var>l</var><span class="hyp-type"><b>: </b><span>label</span></span></span><br><span><var>s1</var><span class="hyp-type"><b>: </b><span>state</span></span></span><br><span><var>iom</var><span class="hyp-type"><b>: </b><span>option message</span></span></span><br><span><var>s2</var><span class="hyp-type"><b>: </b><span>state</span></span></span><br><span><var>oom</var><span class="hyp-type"><b>: </b><span>option message</span></span></span><br><span><var>Ht</var><span class="hyp-type"><b>: </b><span>input_valid_transition l (s1, iom) (s2, oom)</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="kr">‚àÉ</span> (<span class="nv">s0</span> : state) (<span class="nv">ts</span> : list transition_item),
  finite_valid_trace_init_to s0 s2
    (ts ++
     [{|
        l := l;
        input := iom;
        destination := s2;
        output := oom
      |}]) ‚àß finite_trace_last s0 ts = s1</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="VLSM-v-chk32e" style="display: none" type="checkbox"><label class="alectryon-input" for="VLSM-v-chk32e"><span class="kn">Proof</span>.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>message</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>X</var><span class="hyp-type"><b>: </b><span>VLSM message</span></span></span><br><span><var>TypeX</var><span><span class="hyp-body"><b>:= </b><span>type X</span></span><span class="hyp-type"><b>: </b><span>VLSMType message</span></span></span></span><br><span><var>MachineX</var><span><span class="hyp-body"><b>:= </b><span>machine X</span></span><span class="hyp-type"><b>: </b><span>VLSMMachine (vtype X)</span></span></span></span><br><span><var>l</var><span class="hyp-type"><b>: </b><span>label</span></span></span><br><span><var>s1</var><span class="hyp-type"><b>: </b><span>state</span></span></span><br><span><var>iom</var><span class="hyp-type"><b>: </b><span>option message</span></span></span><br><span><var>s2</var><span class="hyp-type"><b>: </b><span>state</span></span></span><br><span><var>oom</var><span class="hyp-type"><b>: </b><span>option message</span></span></span><br><span><var>Ht</var><span class="hyp-type"><b>: </b><span>input_valid_transition l (s1, iom) (s2, oom)</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="kr">‚àÉ</span> (<span class="nv">s0</span> : state) (<span class="nv">ts</span> : list transition_item),
  finite_valid_trace_init_to s0 s2
    (ts ++
     [{|
        l := l;
        input := iom;
        destination := s2;
        output := oom
      |}]) ‚àß finite_trace_last s0 ts = s1</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">      </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="VLSM-v-chk32f" style="display: none" type="checkbox"><label class="alectryon-input" for="VLSM-v-chk32f"><span class="nb">apply</span> input_valid_transition_origin <span class="kr">in</span> Ht <span class="kr">as</span> Hs1.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>message</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>X</var><span class="hyp-type"><b>: </b><span>VLSM message</span></span></span><br><span><var>TypeX</var><span><span class="hyp-body"><b>:= </b><span>type X</span></span><span class="hyp-type"><b>: </b><span>VLSMType message</span></span></span></span><br><span><var>MachineX</var><span><span class="hyp-body"><b>:= </b><span>machine X</span></span><span class="hyp-type"><b>: </b><span>VLSMMachine (vtype X)</span></span></span></span><br><span><var>l</var><span class="hyp-type"><b>: </b><span>label</span></span></span><br><span><var>s1</var><span class="hyp-type"><b>: </b><span>state</span></span></span><br><span><var>iom</var><span class="hyp-type"><b>: </b><span>option message</span></span></span><br><span><var>s2</var><span class="hyp-type"><b>: </b><span>state</span></span></span><br><span><var>oom</var><span class="hyp-type"><b>: </b><span>option message</span></span></span><br><span><var>Ht</var><span class="hyp-type"><b>: </b><span>input_valid_transition l (s1, iom) (s2, oom)</span></span></span><br><span><var>Hs1</var><span class="hyp-type"><b>: </b><span>valid_state_prop s1</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="kr">‚àÉ</span> (<span class="nv">s0</span> : state) (<span class="nv">ts</span> : list transition_item),
  finite_valid_trace_init_to s0 s2
    (ts ++
     [{|
        l := l;
        input := iom;
        destination := s2;
        output := oom
      |}]) ‚àß finite_trace_last s0 ts = s1</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">      </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="VLSM-v-chk330" style="display: none" type="checkbox"><label class="alectryon-input" for="VLSM-v-chk330"><span class="nb">apply</span> valid_state_has_trace <span class="kr">in</span> Hs1.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>message</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>X</var><span class="hyp-type"><b>: </b><span>VLSM message</span></span></span><br><span><var>TypeX</var><span><span class="hyp-body"><b>:= </b><span>type X</span></span><span class="hyp-type"><b>: </b><span>VLSMType message</span></span></span></span><br><span><var>MachineX</var><span><span class="hyp-body"><b>:= </b><span>machine X</span></span><span class="hyp-type"><b>: </b><span>VLSMMachine (vtype X)</span></span></span></span><br><span><var>l</var><span class="hyp-type"><b>: </b><span>label</span></span></span><br><span><var>s1</var><span class="hyp-type"><b>: </b><span>state</span></span></span><br><span><var>iom</var><span class="hyp-type"><b>: </b><span>option message</span></span></span><br><span><var>s2</var><span class="hyp-type"><b>: </b><span>state</span></span></span><br><span><var>oom</var><span class="hyp-type"><b>: </b><span>option message</span></span></span><br><span><var>Ht</var><span class="hyp-type"><b>: </b><span>input_valid_transition l (s1, iom) (s2, oom)</span></span></span><br><span><var>Hs1</var><span class="hyp-type"><b>: </b><span><span class="kr">‚àÉ</span> (<span class="nv">is</span> : state) (<span class="nv">tr</span> : list transition_item),
  finite_valid_trace_init_to <span class="kr">is</span> s1 tr</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="kr">‚àÉ</span> (<span class="nv">s0</span> : state) (<span class="nv">ts</span> : list transition_item),
  finite_valid_trace_init_to s0 s2
    (ts ++
     [{|
        l := l;
        input := iom;
        destination := s2;
        output := oom
      |}]) ‚àß finite_trace_last s0 ts = s1</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">      </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="VLSM-v-chk331" style="display: none" type="checkbox"><label class="alectryon-input" for="VLSM-v-chk331"><span class="nb">destruct</span> Hs1 <span class="kr">as</span> [s0 [ts Hts]].</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>message</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>X</var><span class="hyp-type"><b>: </b><span>VLSM message</span></span></span><br><span><var>TypeX</var><span><span class="hyp-body"><b>:= </b><span>type X</span></span><span class="hyp-type"><b>: </b><span>VLSMType message</span></span></span></span><br><span><var>MachineX</var><span><span class="hyp-body"><b>:= </b><span>machine X</span></span><span class="hyp-type"><b>: </b><span>VLSMMachine (vtype X)</span></span></span></span><br><span><var>l</var><span class="hyp-type"><b>: </b><span>label</span></span></span><br><span><var>s1</var><span class="hyp-type"><b>: </b><span>state</span></span></span><br><span><var>iom</var><span class="hyp-type"><b>: </b><span>option message</span></span></span><br><span><var>s2</var><span class="hyp-type"><b>: </b><span>state</span></span></span><br><span><var>oom</var><span class="hyp-type"><b>: </b><span>option message</span></span></span><br><span><var>Ht</var><span class="hyp-type"><b>: </b><span>input_valid_transition l (s1, iom) (s2, oom)</span></span></span><br><span><var>s0</var><span class="hyp-type"><b>: </b><span>state</span></span></span><br><span><var>ts</var><span class="hyp-type"><b>: </b><span>list transition_item</span></span></span><br><span><var>Hts</var><span class="hyp-type"><b>: </b><span>finite_valid_trace_init_to s0 s1 ts</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="kr">‚àÉ</span> (<span class="nv">s0</span> : state) (<span class="nv">ts</span> : list transition_item),
  finite_valid_trace_init_to s0 s2
    (ts ++
     [{|
        l := l;
        input := iom;
        destination := s2;
        output := oom
      |}]) ‚àß finite_trace_last s0 ts = s1</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">      </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="VLSM-v-chk332" style="display: none" type="checkbox"><label class="alectryon-input" for="VLSM-v-chk332"><span class="kr">exists</span> <span class="nv">s0</span>, ts.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>message</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>X</var><span class="hyp-type"><b>: </b><span>VLSM message</span></span></span><br><span><var>TypeX</var><span><span class="hyp-body"><b>:= </b><span>type X</span></span><span class="hyp-type"><b>: </b><span>VLSMType message</span></span></span></span><br><span><var>MachineX</var><span><span class="hyp-body"><b>:= </b><span>machine X</span></span><span class="hyp-type"><b>: </b><span>VLSMMachine (vtype X)</span></span></span></span><br><span><var>l</var><span class="hyp-type"><b>: </b><span>label</span></span></span><br><span><var>s1</var><span class="hyp-type"><b>: </b><span>state</span></span></span><br><span><var>iom</var><span class="hyp-type"><b>: </b><span>option message</span></span></span><br><span><var>s2</var><span class="hyp-type"><b>: </b><span>state</span></span></span><br><span><var>oom</var><span class="hyp-type"><b>: </b><span>option message</span></span></span><br><span><var>Ht</var><span class="hyp-type"><b>: </b><span>input_valid_transition l (s1, iom) (s2, oom)</span></span></span><br><span><var>s0</var><span class="hyp-type"><b>: </b><span>state</span></span></span><br><span><var>ts</var><span class="hyp-type"><b>: </b><span>list transition_item</span></span></span><br><span><var>Hts</var><span class="hyp-type"><b>: </b><span>finite_valid_trace_init_to s0 s1 ts</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">finite_valid_trace_init_to s0 s2
  (ts ++
   [{|
      l := l;
      input := iom;
      destination := s2;
      output := oom
    |}]) ‚àß finite_trace_last s0 ts = s1</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">      </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="VLSM-v-chk333" style="display: none" type="checkbox"><label class="alectryon-input" for="VLSM-v-chk333"><span class="nb">destruct</span> Hts <span class="kr">as</span> [Hts Hinit].</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>message</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>X</var><span class="hyp-type"><b>: </b><span>VLSM message</span></span></span><br><span><var>TypeX</var><span><span class="hyp-body"><b>:= </b><span>type X</span></span><span class="hyp-type"><b>: </b><span>VLSMType message</span></span></span></span><br><span><var>MachineX</var><span><span class="hyp-body"><b>:= </b><span>machine X</span></span><span class="hyp-type"><b>: </b><span>VLSMMachine (vtype X)</span></span></span></span><br><span><var>l</var><span class="hyp-type"><b>: </b><span>label</span></span></span><br><span><var>s1</var><span class="hyp-type"><b>: </b><span>state</span></span></span><br><span><var>iom</var><span class="hyp-type"><b>: </b><span>option message</span></span></span><br><span><var>s2</var><span class="hyp-type"><b>: </b><span>state</span></span></span><br><span><var>oom</var><span class="hyp-type"><b>: </b><span>option message</span></span></span><br><span><var>Ht</var><span class="hyp-type"><b>: </b><span>input_valid_transition l (s1, iom) (s2, oom)</span></span></span><br><span><var>s0</var><span class="hyp-type"><b>: </b><span>state</span></span></span><br><span><var>ts</var><span class="hyp-type"><b>: </b><span>list transition_item</span></span></span><br><span><var>Hts</var><span class="hyp-type"><b>: </b><span>finite_valid_trace_from_to s0 s1 ts</span></span></span><br><span><var>Hinit</var><span class="hyp-type"><b>: </b><span>initial_state_prop s0</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">finite_valid_trace_init_to s0 s2
  (ts ++
   [{|
      l := l;
      input := iom;
      destination := s2;
      output := oom
    |}]) ‚àß finite_trace_last s0 ts = s1</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">      </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="VLSM-v-chk334" style="display: none" type="checkbox"><label class="alectryon-input" for="VLSM-v-chk334"><span class="kp">repeat</span> <span class="nb">split</span>; [|<span class="bp">assumption</span>|<span class="nb">revert</span> Hts; <span class="nb">apply</span> finite_valid_trace_from_to_last].</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>message</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>X</var><span class="hyp-type"><b>: </b><span>VLSM message</span></span></span><br><span><var>TypeX</var><span><span class="hyp-body"><b>:= </b><span>type X</span></span><span class="hyp-type"><b>: </b><span>VLSMType message</span></span></span></span><br><span><var>MachineX</var><span><span class="hyp-body"><b>:= </b><span>machine X</span></span><span class="hyp-type"><b>: </b><span>VLSMMachine (vtype X)</span></span></span></span><br><span><var>l</var><span class="hyp-type"><b>: </b><span>label</span></span></span><br><span><var>s1</var><span class="hyp-type"><b>: </b><span>state</span></span></span><br><span><var>iom</var><span class="hyp-type"><b>: </b><span>option message</span></span></span><br><span><var>s2</var><span class="hyp-type"><b>: </b><span>state</span></span></span><br><span><var>oom</var><span class="hyp-type"><b>: </b><span>option message</span></span></span><br><span><var>Ht</var><span class="hyp-type"><b>: </b><span>input_valid_transition l (s1, iom) (s2, oom)</span></span></span><br><span><var>s0</var><span class="hyp-type"><b>: </b><span>state</span></span></span><br><span><var>ts</var><span class="hyp-type"><b>: </b><span>list transition_item</span></span></span><br><span><var>Hts</var><span class="hyp-type"><b>: </b><span>finite_valid_trace_from_to s0 s1 ts</span></span></span><br><span><var>Hinit</var><span class="hyp-type"><b>: </b><span>initial_state_prop s0</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">finite_valid_trace_from_to s0 s2
  (ts ++
   [{|
      l := l;
      input := iom;
      destination := s2;
      output := oom
    |}])</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">      </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="VLSM-v-chk335" style="display: none" type="checkbox"><label class="alectryon-input" for="VLSM-v-chk335"><span class="nb">revert</span> Ht.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>message</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>X</var><span class="hyp-type"><b>: </b><span>VLSM message</span></span></span><br><span><var>TypeX</var><span><span class="hyp-body"><b>:= </b><span>type X</span></span><span class="hyp-type"><b>: </b><span>VLSMType message</span></span></span></span><br><span><var>MachineX</var><span><span class="hyp-body"><b>:= </b><span>machine X</span></span><span class="hyp-type"><b>: </b><span>VLSMMachine (vtype X)</span></span></span></span><br><span><var>l</var><span class="hyp-type"><b>: </b><span>label</span></span></span><br><span><var>s1</var><span class="hyp-type"><b>: </b><span>state</span></span></span><br><span><var>iom</var><span class="hyp-type"><b>: </b><span>option message</span></span></span><br><span><var>s2</var><span class="hyp-type"><b>: </b><span>state</span></span></span><br><span><var>oom</var><span class="hyp-type"><b>: </b><span>option message</span></span></span><br><span><var>s0</var><span class="hyp-type"><b>: </b><span>state</span></span></span><br><span><var>ts</var><span class="hyp-type"><b>: </b><span>list transition_item</span></span></span><br><span><var>Hts</var><span class="hyp-type"><b>: </b><span>finite_valid_trace_from_to s0 s1 ts</span></span></span><br><span><var>Hinit</var><span class="hyp-type"><b>: </b><span>initial_state_prop s0</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">input_valid_transition l (s1, iom) (s2, oom)
‚Üí finite_valid_trace_from_to s0 s2
    (ts ++
     [{|
        l := l;
        input := iom;
        destination := s2;
        output := oom
      |}])</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">      </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="VLSM-v-chk336" style="display: none" type="checkbox"><label class="alectryon-input" for="VLSM-v-chk336"><span class="nb">apply</span> extend_right_finite_trace_from_to.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>message</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>X</var><span class="hyp-type"><b>: </b><span>VLSM message</span></span></span><br><span><var>TypeX</var><span><span class="hyp-body"><b>:= </b><span>type X</span></span><span class="hyp-type"><b>: </b><span>VLSMType message</span></span></span></span><br><span><var>MachineX</var><span><span class="hyp-body"><b>:= </b><span>machine X</span></span><span class="hyp-type"><b>: </b><span>VLSMMachine (vtype X)</span></span></span></span><br><span><var>l</var><span class="hyp-type"><b>: </b><span>label</span></span></span><br><span><var>s1</var><span class="hyp-type"><b>: </b><span>state</span></span></span><br><span><var>iom</var><span class="hyp-type"><b>: </b><span>option message</span></span></span><br><span><var>s2</var><span class="hyp-type"><b>: </b><span>state</span></span></span><br><span><var>oom</var><span class="hyp-type"><b>: </b><span>option message</span></span></span><br><span><var>s0</var><span class="hyp-type"><b>: </b><span>state</span></span></span><br><span><var>ts</var><span class="hyp-type"><b>: </b><span>list transition_item</span></span></span><br><span><var>Hts</var><span class="hyp-type"><b>: </b><span>finite_valid_trace_from_to s0 s1 ts</span></span></span><br><span><var>Hinit</var><span class="hyp-type"><b>: </b><span>initial_state_prop s0</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">finite_valid_trace_from_to s0 s1 ts</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">      </span><span class="alectryon-sentence"><span class="alectryon-input"><span class="bp">assumption</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Qed</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
</span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="VLSM-v-chk337" style="display: none" type="checkbox"><label class="alectryon-input" for="VLSM-v-chk337"><span class="kn">Lemma</span> <span class="nf">can_emit_has_trace</span> <span class="nv">m</span> :
      can_emit m -&gt;
      <span class="kr">exists</span> <span class="nv">is</span> <span class="nv">tr</span> <span class="nv">item</span>,
      finite_valid_trace <span class="kr">is</span> (tr ++ [item]) /\
      output item = Some m.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>message</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>X</var><span class="hyp-type"><b>: </b><span>VLSM message</span></span></span><br><span><var>TypeX</var><span><span class="hyp-body"><b>:= </b><span>type X</span></span><span class="hyp-type"><b>: </b><span>VLSMType message</span></span></span></span><br><span><var>MachineX</var><span><span class="hyp-body"><b>:= </b><span>machine X</span></span><span class="hyp-type"><b>: </b><span>VLSMMachine (vtype X)</span></span></span></span><br><span><var>m</var><span class="hyp-type"><b>: </b><span>message</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">can_emit m
‚Üí <span class="kr">‚àÉ</span> (<span class="nv">is</span> : state) (<span class="nv">tr</span> : list transition_item) (<span class="nv">item</span> : transition_item),
    finite_valid_trace <span class="kr">is</span> (tr ++ [item])
    ‚àß output item = Some m</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="VLSM-v-chk338" style="display: none" type="checkbox"><label class="alectryon-input" for="VLSM-v-chk338"><span class="kn">Proof</span>.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>message</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>X</var><span class="hyp-type"><b>: </b><span>VLSM message</span></span></span><br><span><var>TypeX</var><span><span class="hyp-body"><b>:= </b><span>type X</span></span><span class="hyp-type"><b>: </b><span>VLSMType message</span></span></span></span><br><span><var>MachineX</var><span><span class="hyp-body"><b>:= </b><span>machine X</span></span><span class="hyp-type"><b>: </b><span>VLSMMachine (vtype X)</span></span></span></span><br><span><var>m</var><span class="hyp-type"><b>: </b><span>message</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">can_emit m
‚Üí <span class="kr">‚àÉ</span> (<span class="nv">is</span> : state) (<span class="nv">tr</span> : list transition_item) (<span class="nv">item</span> : transition_item),
    finite_valid_trace <span class="kr">is</span> (tr ++ [item])
    ‚àß output item = Some m</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">      </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="VLSM-v-chk339" style="display: none" type="checkbox"><label class="alectryon-input" for="VLSM-v-chk339"><span class="nb">intros</span> [(s, im) [l [s&#39; Hm]]].</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>message</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>X</var><span class="hyp-type"><b>: </b><span>VLSM message</span></span></span><br><span><var>TypeX</var><span><span class="hyp-body"><b>:= </b><span>type X</span></span><span class="hyp-type"><b>: </b><span>VLSMType message</span></span></span></span><br><span><var>MachineX</var><span><span class="hyp-body"><b>:= </b><span>machine X</span></span><span class="hyp-type"><b>: </b><span>VLSMMachine (vtype X)</span></span></span></span><br><span><var>m</var><span class="hyp-type"><b>: </b><span>message</span></span></span><br><span><var>s</var><span class="hyp-type"><b>: </b><span>state</span></span></span><br><span><var>im</var><span class="hyp-type"><b>: </b><span>option message</span></span></span><br><span><var>l</var><span class="hyp-type"><b>: </b><span>label</span></span></span><br><span><var>s'</var><span class="hyp-type"><b>: </b><span>state</span></span></span><br><span><var>Hm</var><span class="hyp-type"><b>: </b><span>input_valid_transition l (s, im) (s&#39;, Some m)</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="kr">‚àÉ</span> (<span class="nv">is</span> : state) (<span class="nv">tr</span> : list transition_item) (<span class="nv">item</span> : transition_item),
  finite_valid_trace <span class="kr">is</span> (tr ++ [item])
  ‚àß output item = Some m</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">      </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="VLSM-v-chk33a" style="display: none" type="checkbox"><label class="alectryon-input" for="VLSM-v-chk33a"><span class="nb">apply</span> exists_right_finite_trace_from <span class="kr">in</span> Hm <span class="kr">as</span> [<span class="kr">is</span> [tr [Htr _]]].</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>message</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>X</var><span class="hyp-type"><b>: </b><span>VLSM message</span></span></span><br><span><var>TypeX</var><span><span class="hyp-body"><b>:= </b><span>type X</span></span><span class="hyp-type"><b>: </b><span>VLSMType message</span></span></span></span><br><span><var>MachineX</var><span><span class="hyp-body"><b>:= </b><span>machine X</span></span><span class="hyp-type"><b>: </b><span>VLSMMachine (vtype X)</span></span></span></span><br><span><var>m</var><span class="hyp-type"><b>: </b><span>message</span></span></span><br><span><var>s</var><span class="hyp-type"><b>: </b><span>state</span></span></span><br><span><var>im</var><span class="hyp-type"><b>: </b><span>option message</span></span></span><br><span><var>l</var><span class="hyp-type"><b>: </b><span>label</span></span></span><br><span><var>s', is</var><span class="hyp-type"><b>: </b><span>state</span></span></span><br><span><var>tr</var><span class="hyp-type"><b>: </b><span>list transition_item</span></span></span><br><span><var>Htr</var><span class="hyp-type"><b>: </b><span>finite_valid_trace_init_to <span class="kr">is</span> s&#39;
  (tr ++
   [{|
      l := l;
      input := im;
      destination := s&#39;;
      output := Some m
    |}])</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="kr">‚àÉ</span> (<span class="nv">is</span> : state) (<span class="nv">tr</span> : list transition_item) (<span class="nv">item</span> : transition_item),
  finite_valid_trace <span class="kr">is</span> (tr ++ [item])
  ‚àß output item = Some m</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">      </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="VLSM-v-chk33b" style="display: none" type="checkbox"><label class="alectryon-input" for="VLSM-v-chk33b"><span class="nb">apply</span> finite_valid_trace_init_to_forget_last <span class="kr">in</span> Htr.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>message</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>X</var><span class="hyp-type"><b>: </b><span>VLSM message</span></span></span><br><span><var>TypeX</var><span><span class="hyp-body"><b>:= </b><span>type X</span></span><span class="hyp-type"><b>: </b><span>VLSMType message</span></span></span></span><br><span><var>MachineX</var><span><span class="hyp-body"><b>:= </b><span>machine X</span></span><span class="hyp-type"><b>: </b><span>VLSMMachine (vtype X)</span></span></span></span><br><span><var>m</var><span class="hyp-type"><b>: </b><span>message</span></span></span><br><span><var>s</var><span class="hyp-type"><b>: </b><span>state</span></span></span><br><span><var>im</var><span class="hyp-type"><b>: </b><span>option message</span></span></span><br><span><var>l</var><span class="hyp-type"><b>: </b><span>label</span></span></span><br><span><var>s', is</var><span class="hyp-type"><b>: </b><span>state</span></span></span><br><span><var>tr</var><span class="hyp-type"><b>: </b><span>list transition_item</span></span></span><br><span><var>Htr</var><span class="hyp-type"><b>: </b><span>finite_valid_trace <span class="kr">is</span>
  (tr ++
   [{|
      l := l;
      input := im;
      destination := s&#39;;
      output := Some m
    |}])</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="kr">‚àÉ</span> (<span class="nv">is</span> : state) (<span class="nv">tr</span> : list transition_item) (<span class="nv">item</span> : transition_item),
  finite_valid_trace <span class="kr">is</span> (tr ++ [item])
  ‚àß output item = Some m</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">      </span><span class="alectryon-sentence"><span class="alectryon-input"><span class="nb">eexists</span> <span class="kr">is</span>, tr, _; <span class="nb">split</span>; [<span class="bp">exact</span> Htr|<span class="bp">reflexivity</span>].</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Qed</span>.</span></span></pre><div class="doc">
Any trace with the 'finite_valid_trace_from' property can be completed
    (to the left) to start in an initial state
</div><pre class="alectryon-io highlight"><!-- Generator: Alectryon --><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="VLSM-v-chk33c" style="display: none" type="checkbox"><label class="alectryon-input" for="VLSM-v-chk33c"><span class="kn">Lemma</span> <span class="nf">finite_valid_trace_from_complete_left</span>
      (<span class="nv">s</span> : state)
      (<span class="nv">tr</span> : list transition_item)
      (<span class="nv">Htr</span> : finite_valid_trace_from s tr)
      : <span class="kr">exists</span> (<span class="nv">is</span> : state) (<span class="nv">trs</span> : list transition_item),
        finite_valid_trace <span class="kr">is</span> (trs ++ tr) /\
        finite_trace_last <span class="kr">is</span> trs = s.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>message</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>X</var><span class="hyp-type"><b>: </b><span>VLSM message</span></span></span><br><span><var>TypeX</var><span><span class="hyp-body"><b>:= </b><span>type X</span></span><span class="hyp-type"><b>: </b><span>VLSMType message</span></span></span></span><br><span><var>MachineX</var><span><span class="hyp-body"><b>:= </b><span>machine X</span></span><span class="hyp-type"><b>: </b><span>VLSMMachine (vtype X)</span></span></span></span><br><span><var>s</var><span class="hyp-type"><b>: </b><span>state</span></span></span><br><span><var>tr</var><span class="hyp-type"><b>: </b><span>list transition_item</span></span></span><br><span><var>Htr</var><span class="hyp-type"><b>: </b><span>finite_valid_trace_from s tr</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="kr">‚àÉ</span> (<span class="nv">is</span> : state) (<span class="nv">trs</span> : list transition_item),
  finite_valid_trace <span class="kr">is</span> (trs ++ tr)
  ‚àß finite_trace_last <span class="kr">is</span> trs = s</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="VLSM-v-chk33d" style="display: none" type="checkbox"><label class="alectryon-input" for="VLSM-v-chk33d"><span class="kn">Proof</span>.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>message</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>X</var><span class="hyp-type"><b>: </b><span>VLSM message</span></span></span><br><span><var>TypeX</var><span><span class="hyp-body"><b>:= </b><span>type X</span></span><span class="hyp-type"><b>: </b><span>VLSMType message</span></span></span></span><br><span><var>MachineX</var><span><span class="hyp-body"><b>:= </b><span>machine X</span></span><span class="hyp-type"><b>: </b><span>VLSMMachine (vtype X)</span></span></span></span><br><span><var>s</var><span class="hyp-type"><b>: </b><span>state</span></span></span><br><span><var>tr</var><span class="hyp-type"><b>: </b><span>list transition_item</span></span></span><br><span><var>Htr</var><span class="hyp-type"><b>: </b><span>finite_valid_trace_from s tr</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="kr">‚àÉ</span> (<span class="nv">is</span> : state) (<span class="nv">trs</span> : list transition_item),
  finite_valid_trace <span class="kr">is</span> (trs ++ tr)
  ‚àß finite_trace_last <span class="kr">is</span> trs = s</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">      </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="VLSM-v-chk33e" style="display: none" type="checkbox"><label class="alectryon-input" for="VLSM-v-chk33e"><span class="nb">apply</span> finite_valid_trace_first_pstate <span class="kr">in</span> Htr <span class="kr">as</span> Hs.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>message</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>X</var><span class="hyp-type"><b>: </b><span>VLSM message</span></span></span><br><span><var>TypeX</var><span><span class="hyp-body"><b>:= </b><span>type X</span></span><span class="hyp-type"><b>: </b><span>VLSMType message</span></span></span></span><br><span><var>MachineX</var><span><span class="hyp-body"><b>:= </b><span>machine X</span></span><span class="hyp-type"><b>: </b><span>VLSMMachine (vtype X)</span></span></span></span><br><span><var>s</var><span class="hyp-type"><b>: </b><span>state</span></span></span><br><span><var>tr</var><span class="hyp-type"><b>: </b><span>list transition_item</span></span></span><br><span><var>Htr</var><span class="hyp-type"><b>: </b><span>finite_valid_trace_from s tr</span></span></span><br><span><var>Hs</var><span class="hyp-type"><b>: </b><span>valid_state_prop s</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="kr">‚àÉ</span> (<span class="nv">is</span> : state) (<span class="nv">trs</span> : list transition_item),
  finite_valid_trace <span class="kr">is</span> (trs ++ tr)
  ‚àß finite_trace_last <span class="kr">is</span> trs = s</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">      </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="VLSM-v-chk33f" style="display: none" type="checkbox"><label class="alectryon-input" for="VLSM-v-chk33f"><span class="nb">apply</span> valid_state_has_trace <span class="kr">in</span> Hs.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>message</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>X</var><span class="hyp-type"><b>: </b><span>VLSM message</span></span></span><br><span><var>TypeX</var><span><span class="hyp-body"><b>:= </b><span>type X</span></span><span class="hyp-type"><b>: </b><span>VLSMType message</span></span></span></span><br><span><var>MachineX</var><span><span class="hyp-body"><b>:= </b><span>machine X</span></span><span class="hyp-type"><b>: </b><span>VLSMMachine (vtype X)</span></span></span></span><br><span><var>s</var><span class="hyp-type"><b>: </b><span>state</span></span></span><br><span><var>tr</var><span class="hyp-type"><b>: </b><span>list transition_item</span></span></span><br><span><var>Htr</var><span class="hyp-type"><b>: </b><span>finite_valid_trace_from s tr</span></span></span><br><span><var>Hs</var><span class="hyp-type"><b>: </b><span><span class="kr">‚àÉ</span> (<span class="nv">is</span> : state) (<span class="nv">tr</span> : list transition_item),
  finite_valid_trace_init_to <span class="kr">is</span> s tr</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="kr">‚àÉ</span> (<span class="nv">is</span> : state) (<span class="nv">trs</span> : list transition_item),
  finite_valid_trace <span class="kr">is</span> (trs ++ tr)
  ‚àß finite_trace_last <span class="kr">is</span> trs = s</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">      </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="VLSM-v-chk340" style="display: none" type="checkbox"><label class="alectryon-input" for="VLSM-v-chk340"><span class="nb">destruct</span> Hs <span class="kr">as</span> [<span class="kr">is</span> [trs [Htrs His]]].</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>message</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>X</var><span class="hyp-type"><b>: </b><span>VLSM message</span></span></span><br><span><var>TypeX</var><span><span class="hyp-body"><b>:= </b><span>type X</span></span><span class="hyp-type"><b>: </b><span>VLSMType message</span></span></span></span><br><span><var>MachineX</var><span><span class="hyp-body"><b>:= </b><span>machine X</span></span><span class="hyp-type"><b>: </b><span>VLSMMachine (vtype X)</span></span></span></span><br><span><var>s</var><span class="hyp-type"><b>: </b><span>state</span></span></span><br><span><var>tr</var><span class="hyp-type"><b>: </b><span>list transition_item</span></span></span><br><span><var>Htr</var><span class="hyp-type"><b>: </b><span>finite_valid_trace_from s tr</span></span></span><br><span><var>is</var><span class="hyp-type"><b>: </b><span>state</span></span></span><br><span><var>trs</var><span class="hyp-type"><b>: </b><span>list transition_item</span></span></span><br><span><var>Htrs</var><span class="hyp-type"><b>: </b><span>finite_valid_trace_from_to <span class="kr">is</span> s trs</span></span></span><br><span><var>His</var><span class="hyp-type"><b>: </b><span>initial_state_prop <span class="kr">is</span></span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="kr">‚àÉ</span> (<span class="nv">is</span> : state) (<span class="nv">trs</span> : list transition_item),
  finite_valid_trace <span class="kr">is</span> (trs ++ tr)
  ‚àß finite_trace_last <span class="kr">is</span> trs = s</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">      </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="VLSM-v-chk341" style="display: none" type="checkbox"><label class="alectryon-input" for="VLSM-v-chk341"><span class="kr">exists</span> <span class="nv">is</span>, trs.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>message</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>X</var><span class="hyp-type"><b>: </b><span>VLSM message</span></span></span><br><span><var>TypeX</var><span><span class="hyp-body"><b>:= </b><span>type X</span></span><span class="hyp-type"><b>: </b><span>VLSMType message</span></span></span></span><br><span><var>MachineX</var><span><span class="hyp-body"><b>:= </b><span>machine X</span></span><span class="hyp-type"><b>: </b><span>VLSMMachine (vtype X)</span></span></span></span><br><span><var>s</var><span class="hyp-type"><b>: </b><span>state</span></span></span><br><span><var>tr</var><span class="hyp-type"><b>: </b><span>list transition_item</span></span></span><br><span><var>Htr</var><span class="hyp-type"><b>: </b><span>finite_valid_trace_from s tr</span></span></span><br><span><var>is</var><span class="hyp-type"><b>: </b><span>state</span></span></span><br><span><var>trs</var><span class="hyp-type"><b>: </b><span>list transition_item</span></span></span><br><span><var>Htrs</var><span class="hyp-type"><b>: </b><span>finite_valid_trace_from_to <span class="kr">is</span> s trs</span></span></span><br><span><var>His</var><span class="hyp-type"><b>: </b><span>initial_state_prop <span class="kr">is</span></span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">finite_valid_trace <span class="kr">is</span> (trs ++ tr)
‚àß finite_trace_last <span class="kr">is</span> trs = s</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">      </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="VLSM-v-chk342" style="display: none" type="checkbox"><label class="alectryon-input" for="VLSM-v-chk342"><span class="nb">apply</span> finite_valid_trace_from_to_last <span class="kr">in</span> Htrs <span class="kr">as</span> Hlast.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>message</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>X</var><span class="hyp-type"><b>: </b><span>VLSM message</span></span></span><br><span><var>TypeX</var><span><span class="hyp-body"><b>:= </b><span>type X</span></span><span class="hyp-type"><b>: </b><span>VLSMType message</span></span></span></span><br><span><var>MachineX</var><span><span class="hyp-body"><b>:= </b><span>machine X</span></span><span class="hyp-type"><b>: </b><span>VLSMMachine (vtype X)</span></span></span></span><br><span><var>s</var><span class="hyp-type"><b>: </b><span>state</span></span></span><br><span><var>tr</var><span class="hyp-type"><b>: </b><span>list transition_item</span></span></span><br><span><var>Htr</var><span class="hyp-type"><b>: </b><span>finite_valid_trace_from s tr</span></span></span><br><span><var>is</var><span class="hyp-type"><b>: </b><span>state</span></span></span><br><span><var>trs</var><span class="hyp-type"><b>: </b><span>list transition_item</span></span></span><br><span><var>Htrs</var><span class="hyp-type"><b>: </b><span>finite_valid_trace_from_to <span class="kr">is</span> s trs</span></span></span><br><span><var>Hlast</var><span class="hyp-type"><b>: </b><span>finite_trace_last <span class="kr">is</span> trs = s</span></span></span><br><span><var>His</var><span class="hyp-type"><b>: </b><span>initial_state_prop <span class="kr">is</span></span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">finite_valid_trace <span class="kr">is</span> (trs ++ tr)
‚àß finite_trace_last <span class="kr">is</span> trs = s</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">      </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="VLSM-v-chk343" style="display: none" type="checkbox"><label class="alectryon-input" for="VLSM-v-chk343"><span class="nb">rewrite</span> &lt;- Hlast <span class="kr">in</span> Htr.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>message</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>X</var><span class="hyp-type"><b>: </b><span>VLSM message</span></span></span><br><span><var>TypeX</var><span><span class="hyp-body"><b>:= </b><span>type X</span></span><span class="hyp-type"><b>: </b><span>VLSMType message</span></span></span></span><br><span><var>MachineX</var><span><span class="hyp-body"><b>:= </b><span>machine X</span></span><span class="hyp-type"><b>: </b><span>VLSMMachine (vtype X)</span></span></span></span><br><span><var>s</var><span class="hyp-type"><b>: </b><span>state</span></span></span><br><span><var>tr</var><span class="hyp-type"><b>: </b><span>list transition_item</span></span></span><br><span><var>is</var><span class="hyp-type"><b>: </b><span>state</span></span></span><br><span><var>trs</var><span class="hyp-type"><b>: </b><span>list transition_item</span></span></span><br><span><var>Htr</var><span class="hyp-type"><b>: </b><span>finite_valid_trace_from
  (finite_trace_last <span class="kr">is</span> trs) tr</span></span></span><br><span><var>Htrs</var><span class="hyp-type"><b>: </b><span>finite_valid_trace_from_to <span class="kr">is</span> s trs</span></span></span><br><span><var>Hlast</var><span class="hyp-type"><b>: </b><span>finite_trace_last <span class="kr">is</span> trs = s</span></span></span><br><span><var>His</var><span class="hyp-type"><b>: </b><span>initial_state_prop <span class="kr">is</span></span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">finite_valid_trace <span class="kr">is</span> (trs ++ tr)
‚àß finite_trace_last <span class="kr">is</span> trs = s</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">      </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="VLSM-v-chk344" style="display: none" type="checkbox"><label class="alectryon-input" for="VLSM-v-chk344"><span class="nb">apply</span> finite_valid_trace_from_to_forget_last <span class="kr">in</span> Htrs.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>message</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>X</var><span class="hyp-type"><b>: </b><span>VLSM message</span></span></span><br><span><var>TypeX</var><span><span class="hyp-body"><b>:= </b><span>type X</span></span><span class="hyp-type"><b>: </b><span>VLSMType message</span></span></span></span><br><span><var>MachineX</var><span><span class="hyp-body"><b>:= </b><span>machine X</span></span><span class="hyp-type"><b>: </b><span>VLSMMachine (vtype X)</span></span></span></span><br><span><var>s</var><span class="hyp-type"><b>: </b><span>state</span></span></span><br><span><var>tr</var><span class="hyp-type"><b>: </b><span>list transition_item</span></span></span><br><span><var>is</var><span class="hyp-type"><b>: </b><span>state</span></span></span><br><span><var>trs</var><span class="hyp-type"><b>: </b><span>list transition_item</span></span></span><br><span><var>Htr</var><span class="hyp-type"><b>: </b><span>finite_valid_trace_from
  (finite_trace_last <span class="kr">is</span> trs) tr</span></span></span><br><span><var>Htrs</var><span class="hyp-type"><b>: </b><span>finite_valid_trace_from <span class="kr">is</span> trs</span></span></span><br><span><var>Hlast</var><span class="hyp-type"><b>: </b><span>finite_trace_last <span class="kr">is</span> trs = s</span></span></span><br><span><var>His</var><span class="hyp-type"><b>: </b><span>initial_state_prop <span class="kr">is</span></span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">finite_valid_trace <span class="kr">is</span> (trs ++ tr)
‚àß finite_trace_last <span class="kr">is</span> trs = s</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">      </span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kp">repeat</span> (<span class="nb">split</span> || <span class="bp">assumption</span> ||
      <span class="nb">apply</span> finite_valid_trace_from_app_iff).</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Qed</span>.</span></span></pre><div class="doc">
Any trace with the 'finite_valid_trace_from_to' property can be completed
    (to the left) to start in an initial state
</div><pre class="alectryon-io highlight"><!-- Generator: Alectryon --><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="VLSM-v-chk345" style="display: none" type="checkbox"><label class="alectryon-input" for="VLSM-v-chk345"><span class="kn">Lemma</span> <span class="nf">finite_valid_trace_from_to_complete_left</span>
      (<span class="nv">s</span> <span class="nv">f</span> : state)
      (<span class="nv">tr</span> : list transition_item)
      (<span class="nv">Htr</span> : finite_valid_trace_from_to s f tr)
      : <span class="kr">exists</span> (<span class="nv">is</span> : state) (<span class="nv">trs</span> : list transition_item),
        finite_valid_trace_init_to <span class="kr">is</span> f (trs ++ tr) /\
        finite_trace_last <span class="kr">is</span> trs = s.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>message</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>X</var><span class="hyp-type"><b>: </b><span>VLSM message</span></span></span><br><span><var>TypeX</var><span><span class="hyp-body"><b>:= </b><span>type X</span></span><span class="hyp-type"><b>: </b><span>VLSMType message</span></span></span></span><br><span><var>MachineX</var><span><span class="hyp-body"><b>:= </b><span>machine X</span></span><span class="hyp-type"><b>: </b><span>VLSMMachine (vtype X)</span></span></span></span><br><span><var>s, f</var><span class="hyp-type"><b>: </b><span>state</span></span></span><br><span><var>tr</var><span class="hyp-type"><b>: </b><span>list transition_item</span></span></span><br><span><var>Htr</var><span class="hyp-type"><b>: </b><span>finite_valid_trace_from_to s f tr</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="kr">‚àÉ</span> (<span class="nv">is</span> : state) (<span class="nv">trs</span> : list transition_item),
  finite_valid_trace_init_to <span class="kr">is</span> f (trs ++ tr)
  ‚àß finite_trace_last <span class="kr">is</span> trs = s</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="VLSM-v-chk346" style="display: none" type="checkbox"><label class="alectryon-input" for="VLSM-v-chk346"><span class="kn">Proof</span>.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>message</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>X</var><span class="hyp-type"><b>: </b><span>VLSM message</span></span></span><br><span><var>TypeX</var><span><span class="hyp-body"><b>:= </b><span>type X</span></span><span class="hyp-type"><b>: </b><span>VLSMType message</span></span></span></span><br><span><var>MachineX</var><span><span class="hyp-body"><b>:= </b><span>machine X</span></span><span class="hyp-type"><b>: </b><span>VLSMMachine (vtype X)</span></span></span></span><br><span><var>s, f</var><span class="hyp-type"><b>: </b><span>state</span></span></span><br><span><var>tr</var><span class="hyp-type"><b>: </b><span>list transition_item</span></span></span><br><span><var>Htr</var><span class="hyp-type"><b>: </b><span>finite_valid_trace_from_to s f tr</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="kr">‚àÉ</span> (<span class="nv">is</span> : state) (<span class="nv">trs</span> : list transition_item),
  finite_valid_trace_init_to <span class="kr">is</span> f (trs ++ tr)
  ‚àß finite_trace_last <span class="kr">is</span> trs = s</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">      </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="VLSM-v-chk347" style="display: none" type="checkbox"><label class="alectryon-input" for="VLSM-v-chk347"><span class="nb">assert</span> (valid_state_prop s) <span class="kr">as</span> Hs
        <span class="bp">by</span> (<span class="nb">apply</span> finite_valid_trace_from_to_forget_last,
            finite_valid_trace_first_pstate <span class="kr">in</span> Htr; <span class="bp">assumption</span>).</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>message</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>X</var><span class="hyp-type"><b>: </b><span>VLSM message</span></span></span><br><span><var>TypeX</var><span><span class="hyp-body"><b>:= </b><span>type X</span></span><span class="hyp-type"><b>: </b><span>VLSMType message</span></span></span></span><br><span><var>MachineX</var><span><span class="hyp-body"><b>:= </b><span>machine X</span></span><span class="hyp-type"><b>: </b><span>VLSMMachine (vtype X)</span></span></span></span><br><span><var>s, f</var><span class="hyp-type"><b>: </b><span>state</span></span></span><br><span><var>tr</var><span class="hyp-type"><b>: </b><span>list transition_item</span></span></span><br><span><var>Htr</var><span class="hyp-type"><b>: </b><span>finite_valid_trace_from_to s f tr</span></span></span><br><span><var>Hs</var><span class="hyp-type"><b>: </b><span>valid_state_prop s</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="kr">‚àÉ</span> (<span class="nv">is</span> : state) (<span class="nv">trs</span> : list transition_item),
  finite_valid_trace_init_to <span class="kr">is</span> f (trs ++ tr)
  ‚àß finite_trace_last <span class="kr">is</span> trs = s</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">      </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="VLSM-v-chk348" style="display: none" type="checkbox"><label class="alectryon-input" for="VLSM-v-chk348"><span class="nb">apply</span> valid_state_has_trace <span class="kr">in</span> Hs.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>message</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>X</var><span class="hyp-type"><b>: </b><span>VLSM message</span></span></span><br><span><var>TypeX</var><span><span class="hyp-body"><b>:= </b><span>type X</span></span><span class="hyp-type"><b>: </b><span>VLSMType message</span></span></span></span><br><span><var>MachineX</var><span><span class="hyp-body"><b>:= </b><span>machine X</span></span><span class="hyp-type"><b>: </b><span>VLSMMachine (vtype X)</span></span></span></span><br><span><var>s, f</var><span class="hyp-type"><b>: </b><span>state</span></span></span><br><span><var>tr</var><span class="hyp-type"><b>: </b><span>list transition_item</span></span></span><br><span><var>Htr</var><span class="hyp-type"><b>: </b><span>finite_valid_trace_from_to s f tr</span></span></span><br><span><var>Hs</var><span class="hyp-type"><b>: </b><span><span class="kr">‚àÉ</span> (<span class="nv">is</span> : state) (<span class="nv">tr</span> : list transition_item),
  finite_valid_trace_init_to <span class="kr">is</span> s tr</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="kr">‚àÉ</span> (<span class="nv">is</span> : state) (<span class="nv">trs</span> : list transition_item),
  finite_valid_trace_init_to <span class="kr">is</span> f (trs ++ tr)
  ‚àß finite_trace_last <span class="kr">is</span> trs = s</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">      </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="VLSM-v-chk349" style="display: none" type="checkbox"><label class="alectryon-input" for="VLSM-v-chk349"><span class="nb">destruct</span> Hs <span class="kr">as</span> [<span class="kr">is</span> [trs [Htrs His]]].</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>message</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>X</var><span class="hyp-type"><b>: </b><span>VLSM message</span></span></span><br><span><var>TypeX</var><span><span class="hyp-body"><b>:= </b><span>type X</span></span><span class="hyp-type"><b>: </b><span>VLSMType message</span></span></span></span><br><span><var>MachineX</var><span><span class="hyp-body"><b>:= </b><span>machine X</span></span><span class="hyp-type"><b>: </b><span>VLSMMachine (vtype X)</span></span></span></span><br><span><var>s, f</var><span class="hyp-type"><b>: </b><span>state</span></span></span><br><span><var>tr</var><span class="hyp-type"><b>: </b><span>list transition_item</span></span></span><br><span><var>Htr</var><span class="hyp-type"><b>: </b><span>finite_valid_trace_from_to s f tr</span></span></span><br><span><var>is</var><span class="hyp-type"><b>: </b><span>state</span></span></span><br><span><var>trs</var><span class="hyp-type"><b>: </b><span>list transition_item</span></span></span><br><span><var>Htrs</var><span class="hyp-type"><b>: </b><span>finite_valid_trace_from_to <span class="kr">is</span> s trs</span></span></span><br><span><var>His</var><span class="hyp-type"><b>: </b><span>initial_state_prop <span class="kr">is</span></span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="kr">‚àÉ</span> (<span class="nv">is</span> : state) (<span class="nv">trs</span> : list transition_item),
  finite_valid_trace_init_to <span class="kr">is</span> f (trs ++ tr)
  ‚àß finite_trace_last <span class="kr">is</span> trs = s</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">      </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="VLSM-v-chk34a" style="display: none" type="checkbox"><label class="alectryon-input" for="VLSM-v-chk34a"><span class="kr">exists</span> <span class="nv">is</span>, trs.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>message</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>X</var><span class="hyp-type"><b>: </b><span>VLSM message</span></span></span><br><span><var>TypeX</var><span><span class="hyp-body"><b>:= </b><span>type X</span></span><span class="hyp-type"><b>: </b><span>VLSMType message</span></span></span></span><br><span><var>MachineX</var><span><span class="hyp-body"><b>:= </b><span>machine X</span></span><span class="hyp-type"><b>: </b><span>VLSMMachine (vtype X)</span></span></span></span><br><span><var>s, f</var><span class="hyp-type"><b>: </b><span>state</span></span></span><br><span><var>tr</var><span class="hyp-type"><b>: </b><span>list transition_item</span></span></span><br><span><var>Htr</var><span class="hyp-type"><b>: </b><span>finite_valid_trace_from_to s f tr</span></span></span><br><span><var>is</var><span class="hyp-type"><b>: </b><span>state</span></span></span><br><span><var>trs</var><span class="hyp-type"><b>: </b><span>list transition_item</span></span></span><br><span><var>Htrs</var><span class="hyp-type"><b>: </b><span>finite_valid_trace_from_to <span class="kr">is</span> s trs</span></span></span><br><span><var>His</var><span class="hyp-type"><b>: </b><span>initial_state_prop <span class="kr">is</span></span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">finite_valid_trace_init_to <span class="kr">is</span> f (trs ++ tr)
‚àß finite_trace_last <span class="kr">is</span> trs = s</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">      </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="VLSM-v-chk34b" style="display: none" type="checkbox"><label class="alectryon-input" for="VLSM-v-chk34b"><span class="nb">split</span>.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>message</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>X</var><span class="hyp-type"><b>: </b><span>VLSM message</span></span></span><br><span><var>TypeX</var><span><span class="hyp-body"><b>:= </b><span>type X</span></span><span class="hyp-type"><b>: </b><span>VLSMType message</span></span></span></span><br><span><var>MachineX</var><span><span class="hyp-body"><b>:= </b><span>machine X</span></span><span class="hyp-type"><b>: </b><span>VLSMMachine (vtype X)</span></span></span></span><br><span><var>s, f</var><span class="hyp-type"><b>: </b><span>state</span></span></span><br><span><var>tr</var><span class="hyp-type"><b>: </b><span>list transition_item</span></span></span><br><span><var>Htr</var><span class="hyp-type"><b>: </b><span>finite_valid_trace_from_to s f tr</span></span></span><br><span><var>is</var><span class="hyp-type"><b>: </b><span>state</span></span></span><br><span><var>trs</var><span class="hyp-type"><b>: </b><span>list transition_item</span></span></span><br><span><var>Htrs</var><span class="hyp-type"><b>: </b><span>finite_valid_trace_from_to <span class="kr">is</span> s trs</span></span></span><br><span><var>His</var><span class="hyp-type"><b>: </b><span>initial_state_prop <span class="kr">is</span></span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">finite_valid_trace_init_to <span class="kr">is</span> f (trs ++ tr)</div></blockquote><div class="alectryon-extra-goals"><input class="alectryon-extra-goal-toggle" id="VLSM-v-chk34c" style="display: none" type="checkbox"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>message</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>X</var><span class="hyp-type"><b>: </b><span>VLSM message</span></span></span><br><span><var>TypeX</var><span><span class="hyp-body"><b>:= </b><span>type X</span></span><span class="hyp-type"><b>: </b><span>VLSMType message</span></span></span></span><br><span><var>MachineX</var><span><span class="hyp-body"><b>:= </b><span>machine X</span></span><span class="hyp-type"><b>: </b><span>VLSMMachine (vtype X)</span></span></span></span><br><span><var>s, f</var><span class="hyp-type"><b>: </b><span>state</span></span></span><br><span><var>tr</var><span class="hyp-type"><b>: </b><span>list transition_item</span></span></span><br><span><var>Htr</var><span class="hyp-type"><b>: </b><span>finite_valid_trace_from_to s f tr</span></span></span><br><span><var>is</var><span class="hyp-type"><b>: </b><span>state</span></span></span><br><span><var>trs</var><span class="hyp-type"><b>: </b><span>list transition_item</span></span></span><br><span><var>Htrs</var><span class="hyp-type"><b>: </b><span>finite_valid_trace_from_to <span class="kr">is</span> s trs</span></span></span><br><span><var>His</var><span class="hyp-type"><b>: </b><span>initial_state_prop <span class="kr">is</span></span></span></span><br></div><label class="goal-separator" for="VLSM-v-chk34c"><hr></label><div class="goal-conclusion">finite_trace_last <span class="kr">is</span> trs = s</div></blockquote></div></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">      </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="VLSM-v-chk34d" style="display: none" type="checkbox"><label class="alectryon-input" for="VLSM-v-chk34d">-</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>message</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>X</var><span class="hyp-type"><b>: </b><span>VLSM message</span></span></span><br><span><var>TypeX</var><span><span class="hyp-body"><b>:= </b><span>type X</span></span><span class="hyp-type"><b>: </b><span>VLSMType message</span></span></span></span><br><span><var>MachineX</var><span><span class="hyp-body"><b>:= </b><span>machine X</span></span><span class="hyp-type"><b>: </b><span>VLSMMachine (vtype X)</span></span></span></span><br><span><var>s, f</var><span class="hyp-type"><b>: </b><span>state</span></span></span><br><span><var>tr</var><span class="hyp-type"><b>: </b><span>list transition_item</span></span></span><br><span><var>Htr</var><span class="hyp-type"><b>: </b><span>finite_valid_trace_from_to s f tr</span></span></span><br><span><var>is</var><span class="hyp-type"><b>: </b><span>state</span></span></span><br><span><var>trs</var><span class="hyp-type"><b>: </b><span>list transition_item</span></span></span><br><span><var>Htrs</var><span class="hyp-type"><b>: </b><span>finite_valid_trace_from_to <span class="kr">is</span> s trs</span></span></span><br><span><var>His</var><span class="hyp-type"><b>: </b><span>initial_state_prop <span class="kr">is</span></span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">finite_valid_trace_init_to <span class="kr">is</span> f (trs ++ tr)</div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="VLSM-v-chk34e" style="display: none" type="checkbox"><label class="alectryon-input" for="VLSM-v-chk34e"><span class="nb">split</span>;[|<span class="bp">assumption</span>].</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>message</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>X</var><span class="hyp-type"><b>: </b><span>VLSM message</span></span></span><br><span><var>TypeX</var><span><span class="hyp-body"><b>:= </b><span>type X</span></span><span class="hyp-type"><b>: </b><span>VLSMType message</span></span></span></span><br><span><var>MachineX</var><span><span class="hyp-body"><b>:= </b><span>machine X</span></span><span class="hyp-type"><b>: </b><span>VLSMMachine (vtype X)</span></span></span></span><br><span><var>s, f</var><span class="hyp-type"><b>: </b><span>state</span></span></span><br><span><var>tr</var><span class="hyp-type"><b>: </b><span>list transition_item</span></span></span><br><span><var>Htr</var><span class="hyp-type"><b>: </b><span>finite_valid_trace_from_to s f tr</span></span></span><br><span><var>is</var><span class="hyp-type"><b>: </b><span>state</span></span></span><br><span><var>trs</var><span class="hyp-type"><b>: </b><span>list transition_item</span></span></span><br><span><var>Htrs</var><span class="hyp-type"><b>: </b><span>finite_valid_trace_from_to <span class="kr">is</span> s trs</span></span></span><br><span><var>His</var><span class="hyp-type"><b>: </b><span>initial_state_prop <span class="kr">is</span></span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">finite_valid_trace_from_to <span class="kr">is</span> f (trs ++ tr)</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">        </span><span class="alectryon-sentence"><span class="alectryon-input"><span class="nb">apply</span> finite_valid_trace_from_to_app <span class="kr">with</span> s;<span class="bp">assumption</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">      </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="VLSM-v-chk34f" style="display: none" type="checkbox"><label class="alectryon-input" for="VLSM-v-chk34f">-</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>message</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>X</var><span class="hyp-type"><b>: </b><span>VLSM message</span></span></span><br><span><var>TypeX</var><span><span class="hyp-body"><b>:= </b><span>type X</span></span><span class="hyp-type"><b>: </b><span>VLSMType message</span></span></span></span><br><span><var>MachineX</var><span><span class="hyp-body"><b>:= </b><span>machine X</span></span><span class="hyp-type"><b>: </b><span>VLSMMachine (vtype X)</span></span></span></span><br><span><var>s, f</var><span class="hyp-type"><b>: </b><span>state</span></span></span><br><span><var>tr</var><span class="hyp-type"><b>: </b><span>list transition_item</span></span></span><br><span><var>Htr</var><span class="hyp-type"><b>: </b><span>finite_valid_trace_from_to s f tr</span></span></span><br><span><var>is</var><span class="hyp-type"><b>: </b><span>state</span></span></span><br><span><var>trs</var><span class="hyp-type"><b>: </b><span>list transition_item</span></span></span><br><span><var>Htrs</var><span class="hyp-type"><b>: </b><span>finite_valid_trace_from_to <span class="kr">is</span> s trs</span></span></span><br><span><var>His</var><span class="hyp-type"><b>: </b><span>initial_state_prop <span class="kr">is</span></span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">finite_trace_last <span class="kr">is</span> trs = s</div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="nb">apply</span> finite_valid_trace_from_to_last <span class="kr">in</span> Htrs;<span class="bp">assumption</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Qed</span>.</span></span></pre><div class="doc">
Another benefit of defining traces is that we can succintly
describe indirect transitions between arbitrary pairs of states.

<div class="paragraph"> </div>

We say that state <code>second</code> is in state <code>first</code>'s futures if
there exists a finite (possibly empty) valid trace that begins
with <code>first</code> and ends in <code>second</code>.

<div class="paragraph"> </div>

This relation is often used in stating safety and liveness properties.
</div><pre class="alectryon-io highlight"><!-- Generator: Alectryon --><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Definition</span> <span class="nf">in_futures</span>
      (<span class="nv">first</span> <span class="nv">second</span> : state)
      : <span class="kt">Prop</span> :=
      <span class="kr">exists</span> (<span class="nv">tr</span> : list transition_item),
        finite_valid_trace_from_to <span class="kp">first</span> second tr.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
</span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="VLSM-v-chk350" style="display: none" type="checkbox"><label class="alectryon-input" for="VLSM-v-chk350"><span class="kn">Lemma</span> <span class="nf">in_futures_preserving</span>
      (<span class="nv">R</span> : state -&gt; state -&gt; <span class="kt">Prop</span>)
      (<span class="nv">Hpre</span> : PreOrder R)
      (<span class="nv">Ht</span> : input_valid_transition_preserving R)
      (<span class="nv">s1</span> <span class="nv">s2</span> : state)
      (<span class="nv">Hin</span> : in_futures s1 s2)
      : R s1 s2.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>message</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>X</var><span class="hyp-type"><b>: </b><span>VLSM message</span></span></span><br><span><var>TypeX</var><span><span class="hyp-body"><b>:= </b><span>type X</span></span><span class="hyp-type"><b>: </b><span>VLSMType message</span></span></span></span><br><span><var>MachineX</var><span><span class="hyp-body"><b>:= </b><span>machine X</span></span><span class="hyp-type"><b>: </b><span>VLSMMachine (vtype X)</span></span></span></span><br><span><var>R</var><span class="hyp-type"><b>: </b><span>state ‚Üí state ‚Üí <span class="kt">Prop</span></span></span></span><br><span><var>Hpre</var><span class="hyp-type"><b>: </b><span>PreOrder R</span></span></span><br><span><var>Ht</var><span class="hyp-type"><b>: </b><span>input_valid_transition_preserving R</span></span></span><br><span><var>s1, s2</var><span class="hyp-type"><b>: </b><span>state</span></span></span><br><span><var>Hin</var><span class="hyp-type"><b>: </b><span>in_futures s1 s2</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">R s1 s2</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="VLSM-v-chk351" style="display: none" type="checkbox"><label class="alectryon-input" for="VLSM-v-chk351"><span class="kn">Proof</span>.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>message</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>X</var><span class="hyp-type"><b>: </b><span>VLSM message</span></span></span><br><span><var>TypeX</var><span><span class="hyp-body"><b>:= </b><span>type X</span></span><span class="hyp-type"><b>: </b><span>VLSMType message</span></span></span></span><br><span><var>MachineX</var><span><span class="hyp-body"><b>:= </b><span>machine X</span></span><span class="hyp-type"><b>: </b><span>VLSMMachine (vtype X)</span></span></span></span><br><span><var>R</var><span class="hyp-type"><b>: </b><span>state ‚Üí state ‚Üí <span class="kt">Prop</span></span></span></span><br><span><var>Hpre</var><span class="hyp-type"><b>: </b><span>PreOrder R</span></span></span><br><span><var>Ht</var><span class="hyp-type"><b>: </b><span>input_valid_transition_preserving R</span></span></span><br><span><var>s1, s2</var><span class="hyp-type"><b>: </b><span>state</span></span></span><br><span><var>Hin</var><span class="hyp-type"><b>: </b><span>in_futures s1 s2</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">R s1 s2</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">      </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="VLSM-v-chk352" style="display: none" type="checkbox"><label class="alectryon-input" for="VLSM-v-chk352"><span class="nb">unfold</span> in_futures <span class="kr">in</span> Hin.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>message</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>X</var><span class="hyp-type"><b>: </b><span>VLSM message</span></span></span><br><span><var>TypeX</var><span><span class="hyp-body"><b>:= </b><span>type X</span></span><span class="hyp-type"><b>: </b><span>VLSMType message</span></span></span></span><br><span><var>MachineX</var><span><span class="hyp-body"><b>:= </b><span>machine X</span></span><span class="hyp-type"><b>: </b><span>VLSMMachine (vtype X)</span></span></span></span><br><span><var>R</var><span class="hyp-type"><b>: </b><span>state ‚Üí state ‚Üí <span class="kt">Prop</span></span></span></span><br><span><var>Hpre</var><span class="hyp-type"><b>: </b><span>PreOrder R</span></span></span><br><span><var>Ht</var><span class="hyp-type"><b>: </b><span>input_valid_transition_preserving R</span></span></span><br><span><var>s1, s2</var><span class="hyp-type"><b>: </b><span>state</span></span></span><br><span><var>Hin</var><span class="hyp-type"><b>: </b><span><span class="kr">‚àÉ</span> <span class="nv">tr</span> : list transition_item,
  finite_valid_trace_from_to s1 s2 tr</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">R s1 s2</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">      </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="VLSM-v-chk353" style="display: none" type="checkbox"><label class="alectryon-input" for="VLSM-v-chk353"><span class="nb">destruct</span> Hin <span class="kr">as</span> [tr Htr].</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>message</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>X</var><span class="hyp-type"><b>: </b><span>VLSM message</span></span></span><br><span><var>TypeX</var><span><span class="hyp-body"><b>:= </b><span>type X</span></span><span class="hyp-type"><b>: </b><span>VLSMType message</span></span></span></span><br><span><var>MachineX</var><span><span class="hyp-body"><b>:= </b><span>machine X</span></span><span class="hyp-type"><b>: </b><span>VLSMMachine (vtype X)</span></span></span></span><br><span><var>R</var><span class="hyp-type"><b>: </b><span>state ‚Üí state ‚Üí <span class="kt">Prop</span></span></span></span><br><span><var>Hpre</var><span class="hyp-type"><b>: </b><span>PreOrder R</span></span></span><br><span><var>Ht</var><span class="hyp-type"><b>: </b><span>input_valid_transition_preserving R</span></span></span><br><span><var>s1, s2</var><span class="hyp-type"><b>: </b><span>state</span></span></span><br><span><var>tr</var><span class="hyp-type"><b>: </b><span>list transition_item</span></span></span><br><span><var>Htr</var><span class="hyp-type"><b>: </b><span>finite_valid_trace_from_to s1 s2 tr</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">R s1 s2</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">      </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="VLSM-v-chk354" style="display: none" type="checkbox"><label class="alectryon-input" for="VLSM-v-chk354"><span class="nb">induction</span> Htr.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>message</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>X</var><span class="hyp-type"><b>: </b><span>VLSM message</span></span></span><br><span><var>TypeX</var><span><span class="hyp-body"><b>:= </b><span>type X</span></span><span class="hyp-type"><b>: </b><span>VLSMType message</span></span></span></span><br><span><var>MachineX</var><span><span class="hyp-body"><b>:= </b><span>machine X</span></span><span class="hyp-type"><b>: </b><span>VLSMMachine (vtype X)</span></span></span></span><br><span><var>R</var><span class="hyp-type"><b>: </b><span>state ‚Üí state ‚Üí <span class="kt">Prop</span></span></span></span><br><span><var>Hpre</var><span class="hyp-type"><b>: </b><span>PreOrder R</span></span></span><br><span><var>Ht</var><span class="hyp-type"><b>: </b><span>input_valid_transition_preserving R</span></span></span><br><span><var>s</var><span class="hyp-type"><b>: </b><span>state</span></span></span><br><span><var>Hs</var><span class="hyp-type"><b>: </b><span>valid_state_prop s</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">R s s</div></blockquote><div class="alectryon-extra-goals"><input class="alectryon-extra-goal-toggle" id="VLSM-v-chk355" style="display: none" type="checkbox"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>message</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>X</var><span class="hyp-type"><b>: </b><span>VLSM message</span></span></span><br><span><var>TypeX</var><span><span class="hyp-body"><b>:= </b><span>type X</span></span><span class="hyp-type"><b>: </b><span>VLSMType message</span></span></span></span><br><span><var>MachineX</var><span><span class="hyp-body"><b>:= </b><span>machine X</span></span><span class="hyp-type"><b>: </b><span>VLSMMachine (vtype X)</span></span></span></span><br><span><var>R</var><span class="hyp-type"><b>: </b><span>state ‚Üí state ‚Üí <span class="kt">Prop</span></span></span></span><br><span><var>Hpre</var><span class="hyp-type"><b>: </b><span>PreOrder R</span></span></span><br><span><var>Ht</var><span class="hyp-type"><b>: </b><span>input_valid_transition_preserving R</span></span></span><br><span><var>s, f</var><span class="hyp-type"><b>: </b><span>state</span></span></span><br><span><var>tl</var><span class="hyp-type"><b>: </b><span>list transition_item</span></span></span><br><span><var>Htr</var><span class="hyp-type"><b>: </b><span>finite_valid_trace_from_to s f tl</span></span></span><br><span><var>s'</var><span class="hyp-type"><b>: </b><span>state</span></span></span><br><span><var>iom, oom</var><span class="hyp-type"><b>: </b><span>option message</span></span></span><br><span><var>l0</var><span class="hyp-type"><b>: </b><span>label</span></span></span><br><span><var>Ht0</var><span class="hyp-type"><b>: </b><span>input_valid_transition l0 (s&#39;, iom) (s, oom)</span></span></span><br><span><var>IHHtr</var><span class="hyp-type"><b>: </b><span>R s f</span></span></span><br></div><label class="goal-separator" for="VLSM-v-chk355"><hr></label><div class="goal-conclusion">R s&#39; f</div></blockquote></div></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">      </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="VLSM-v-chk356" style="display: none" type="checkbox"><label class="alectryon-input" for="VLSM-v-chk356">-</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>message</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>X</var><span class="hyp-type"><b>: </b><span>VLSM message</span></span></span><br><span><var>TypeX</var><span><span class="hyp-body"><b>:= </b><span>type X</span></span><span class="hyp-type"><b>: </b><span>VLSMType message</span></span></span></span><br><span><var>MachineX</var><span><span class="hyp-body"><b>:= </b><span>machine X</span></span><span class="hyp-type"><b>: </b><span>VLSMMachine (vtype X)</span></span></span></span><br><span><var>R</var><span class="hyp-type"><b>: </b><span>state ‚Üí state ‚Üí <span class="kt">Prop</span></span></span></span><br><span><var>Hpre</var><span class="hyp-type"><b>: </b><span>PreOrder R</span></span></span><br><span><var>Ht</var><span class="hyp-type"><b>: </b><span>input_valid_transition_preserving R</span></span></span><br><span><var>s</var><span class="hyp-type"><b>: </b><span>state</span></span></span><br><span><var>Hs</var><span class="hyp-type"><b>: </b><span>valid_state_prop s</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">R s s</div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="bp">reflexivity</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">      </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="VLSM-v-chk357" style="display: none" type="checkbox"><label class="alectryon-input" for="VLSM-v-chk357">-</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>message</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>X</var><span class="hyp-type"><b>: </b><span>VLSM message</span></span></span><br><span><var>TypeX</var><span><span class="hyp-body"><b>:= </b><span>type X</span></span><span class="hyp-type"><b>: </b><span>VLSMType message</span></span></span></span><br><span><var>MachineX</var><span><span class="hyp-body"><b>:= </b><span>machine X</span></span><span class="hyp-type"><b>: </b><span>VLSMMachine (vtype X)</span></span></span></span><br><span><var>R</var><span class="hyp-type"><b>: </b><span>state ‚Üí state ‚Üí <span class="kt">Prop</span></span></span></span><br><span><var>Hpre</var><span class="hyp-type"><b>: </b><span>PreOrder R</span></span></span><br><span><var>Ht</var><span class="hyp-type"><b>: </b><span>input_valid_transition_preserving R</span></span></span><br><span><var>s, f</var><span class="hyp-type"><b>: </b><span>state</span></span></span><br><span><var>tl</var><span class="hyp-type"><b>: </b><span>list transition_item</span></span></span><br><span><var>Htr</var><span class="hyp-type"><b>: </b><span>finite_valid_trace_from_to s f tl</span></span></span><br><span><var>s'</var><span class="hyp-type"><b>: </b><span>state</span></span></span><br><span><var>iom, oom</var><span class="hyp-type"><b>: </b><span>option message</span></span></span><br><span><var>l0</var><span class="hyp-type"><b>: </b><span>label</span></span></span><br><span><var>Ht0</var><span class="hyp-type"><b>: </b><span>input_valid_transition l0 (s&#39;, iom) (s, oom)</span></span></span><br><span><var>IHHtr</var><span class="hyp-type"><b>: </b><span>R s f</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">R s&#39; f</div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="VLSM-v-chk358" style="display: none" type="checkbox"><label class="alectryon-input" for="VLSM-v-chk358"><span class="nb">apply</span> Ht <span class="kr">in</span> Ht0.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>message</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>X</var><span class="hyp-type"><b>: </b><span>VLSM message</span></span></span><br><span><var>TypeX</var><span><span class="hyp-body"><b>:= </b><span>type X</span></span><span class="hyp-type"><b>: </b><span>VLSMType message</span></span></span></span><br><span><var>MachineX</var><span><span class="hyp-body"><b>:= </b><span>machine X</span></span><span class="hyp-type"><b>: </b><span>VLSMMachine (vtype X)</span></span></span></span><br><span><var>R</var><span class="hyp-type"><b>: </b><span>state ‚Üí state ‚Üí <span class="kt">Prop</span></span></span></span><br><span><var>Hpre</var><span class="hyp-type"><b>: </b><span>PreOrder R</span></span></span><br><span><var>Ht</var><span class="hyp-type"><b>: </b><span>input_valid_transition_preserving R</span></span></span><br><span><var>s, f</var><span class="hyp-type"><b>: </b><span>state</span></span></span><br><span><var>tl</var><span class="hyp-type"><b>: </b><span>list transition_item</span></span></span><br><span><var>Htr</var><span class="hyp-type"><b>: </b><span>finite_valid_trace_from_to s f tl</span></span></span><br><span><var>s'</var><span class="hyp-type"><b>: </b><span>state</span></span></span><br><span><var>iom, oom</var><span class="hyp-type"><b>: </b><span>option message</span></span></span><br><span><var>l0</var><span class="hyp-type"><b>: </b><span>label</span></span></span><br><span><var>Ht0</var><span class="hyp-type"><b>: </b><span>R s&#39; s</span></span></span><br><span><var>IHHtr</var><span class="hyp-type"><b>: </b><span>R s f</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">R s&#39; f</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">        </span><span class="alectryon-sentence"><span class="alectryon-input"><span class="nb">transitivity</span> s;<span class="bp">assumption</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Qed</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
</span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Instance</span> <span class="nf">eq_equiv</span> : @Equivalence state eq := _.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
</span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="VLSM-v-chk359" style="display: none" type="checkbox"><label class="alectryon-input" for="VLSM-v-chk359"><span class="kn">Lemma</span> <span class="nf">in_futures_strict_preserving</span>
      (<span class="nv">R</span> : state -&gt; state -&gt; <span class="kt">Prop</span>)
      (<span class="nv">Hpre</span> : StrictOrder R)
      (<span class="nv">Ht</span> : input_valid_transition_preserving R)
      (<span class="nv">s1</span> <span class="nv">s2</span> : state)
      (<span class="nv">Hin</span> : in_futures s1 s2)
      (<span class="nv">Hneq</span> : s1 &lt;&gt; s2)
      : R s1 s2.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>message</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>X</var><span class="hyp-type"><b>: </b><span>VLSM message</span></span></span><br><span><var>TypeX</var><span><span class="hyp-body"><b>:= </b><span>type X</span></span><span class="hyp-type"><b>: </b><span>VLSMType message</span></span></span></span><br><span><var>MachineX</var><span><span class="hyp-body"><b>:= </b><span>machine X</span></span><span class="hyp-type"><b>: </b><span>VLSMMachine (vtype X)</span></span></span></span><br><span><var>R</var><span class="hyp-type"><b>: </b><span>state ‚Üí state ‚Üí <span class="kt">Prop</span></span></span></span><br><span><var>Hpre</var><span class="hyp-type"><b>: </b><span>StrictOrder R</span></span></span><br><span><var>Ht</var><span class="hyp-type"><b>: </b><span>input_valid_transition_preserving R</span></span></span><br><span><var>s1, s2</var><span class="hyp-type"><b>: </b><span>state</span></span></span><br><span><var>Hin</var><span class="hyp-type"><b>: </b><span>in_futures s1 s2</span></span></span><br><span><var>Hneq</var><span class="hyp-type"><b>: </b><span>s1 ‚â† s2</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">R s1 s2</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="VLSM-v-chk35a" style="display: none" type="checkbox"><label class="alectryon-input" for="VLSM-v-chk35a"><span class="kn">Proof</span>.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>message</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>X</var><span class="hyp-type"><b>: </b><span>VLSM message</span></span></span><br><span><var>TypeX</var><span><span class="hyp-body"><b>:= </b><span>type X</span></span><span class="hyp-type"><b>: </b><span>VLSMType message</span></span></span></span><br><span><var>MachineX</var><span><span class="hyp-body"><b>:= </b><span>machine X</span></span><span class="hyp-type"><b>: </b><span>VLSMMachine (vtype X)</span></span></span></span><br><span><var>R</var><span class="hyp-type"><b>: </b><span>state ‚Üí state ‚Üí <span class="kt">Prop</span></span></span></span><br><span><var>Hpre</var><span class="hyp-type"><b>: </b><span>StrictOrder R</span></span></span><br><span><var>Ht</var><span class="hyp-type"><b>: </b><span>input_valid_transition_preserving R</span></span></span><br><span><var>s1, s2</var><span class="hyp-type"><b>: </b><span>state</span></span></span><br><span><var>Hin</var><span class="hyp-type"><b>: </b><span>in_futures s1 s2</span></span></span><br><span><var>Hneq</var><span class="hyp-type"><b>: </b><span>s1 ‚â† s2</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">R s1 s2</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">      </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="VLSM-v-chk35b" style="display: none" type="checkbox"><label class="alectryon-input" for="VLSM-v-chk35b"><span class="nb">apply</span> (StrictOrder_PreOrder eq_equiv) <span class="kr">in</span> Hpre.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>message</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>X</var><span class="hyp-type"><b>: </b><span>VLSM message</span></span></span><br><span><var>TypeX</var><span><span class="hyp-body"><b>:= </b><span>type X</span></span><span class="hyp-type"><b>: </b><span>VLSMType message</span></span></span></span><br><span><var>MachineX</var><span><span class="hyp-body"><b>:= </b><span>machine X</span></span><span class="hyp-type"><b>: </b><span>VLSMMachine (vtype X)</span></span></span></span><br><span><var>R</var><span class="hyp-type"><b>: </b><span>state ‚Üí state ‚Üí <span class="kt">Prop</span></span></span></span><br><span><var>Hpre</var><span class="hyp-type"><b>: </b><span>PreOrder (relation_disjunction R eq)</span></span></span><br><span><var>Ht</var><span class="hyp-type"><b>: </b><span>input_valid_transition_preserving R</span></span></span><br><span><var>s1, s2</var><span class="hyp-type"><b>: </b><span>state</span></span></span><br><span><var>Hin</var><span class="hyp-type"><b>: </b><span>in_futures s1 s2</span></span></span><br><span><var>Hneq</var><span class="hyp-type"><b>: </b><span>s1 ‚â† s2</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">R s1 s2</div></blockquote><div class="alectryon-extra-goals"><input class="alectryon-extra-goal-toggle" id="VLSM-v-chk35c" style="display: none" type="checkbox"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>message</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>X</var><span class="hyp-type"><b>: </b><span>VLSM message</span></span></span><br><span><var>TypeX</var><span><span class="hyp-body"><b>:= </b><span>type X</span></span><span class="hyp-type"><b>: </b><span>VLSMType message</span></span></span></span><br><span><var>MachineX</var><span><span class="hyp-body"><b>:= </b><span>machine X</span></span><span class="hyp-type"><b>: </b><span>VLSMMachine (vtype X)</span></span></span></span><br><span><var>R</var><span class="hyp-type"><b>: </b><span>state ‚Üí state ‚Üí <span class="kt">Prop</span></span></span></span><br><span><var>Hpre</var><span class="hyp-type"><b>: </b><span>StrictOrder R</span></span></span><br><span><var>Ht</var><span class="hyp-type"><b>: </b><span>input_valid_transition_preserving R</span></span></span><br><span><var>s1, s2</var><span class="hyp-type"><b>: </b><span>state</span></span></span><br><span><var>Hin</var><span class="hyp-type"><b>: </b><span>in_futures s1 s2</span></span></span><br><span><var>Hneq</var><span class="hyp-type"><b>: </b><span>s1 ‚â† s2</span></span></span><br></div><label class="goal-separator" for="VLSM-v-chk35c"><hr></label><div class="goal-conclusion">Proper (eq ==&gt; eq ==&gt; iff) R</div></blockquote></div></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">      </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="VLSM-v-chk35d" style="display: none" type="checkbox"><label class="alectryon-input" for="VLSM-v-chk35d">-</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>message</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>X</var><span class="hyp-type"><b>: </b><span>VLSM message</span></span></span><br><span><var>TypeX</var><span><span class="hyp-body"><b>:= </b><span>type X</span></span><span class="hyp-type"><b>: </b><span>VLSMType message</span></span></span></span><br><span><var>MachineX</var><span><span class="hyp-body"><b>:= </b><span>machine X</span></span><span class="hyp-type"><b>: </b><span>VLSMMachine (vtype X)</span></span></span></span><br><span><var>R</var><span class="hyp-type"><b>: </b><span>state ‚Üí state ‚Üí <span class="kt">Prop</span></span></span></span><br><span><var>Hpre</var><span class="hyp-type"><b>: </b><span>PreOrder (relation_disjunction R eq)</span></span></span><br><span><var>Ht</var><span class="hyp-type"><b>: </b><span>input_valid_transition_preserving R</span></span></span><br><span><var>s1, s2</var><span class="hyp-type"><b>: </b><span>state</span></span></span><br><span><var>Hin</var><span class="hyp-type"><b>: </b><span>in_futures s1 s2</span></span></span><br><span><var>Hneq</var><span class="hyp-type"><b>: </b><span>s1 ‚â† s2</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">R s1 s2</div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="VLSM-v-chk35e" style="display: none" type="checkbox"><label class="alectryon-input" for="VLSM-v-chk35e"><span class="nb">specialize</span> (in_futures_preserving (relation_disjunction R eq) Hpre) <span class="kr">as</span> Hpreserve.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>message</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>X</var><span class="hyp-type"><b>: </b><span>VLSM message</span></span></span><br><span><var>TypeX</var><span><span class="hyp-body"><b>:= </b><span>type X</span></span><span class="hyp-type"><b>: </b><span>VLSMType message</span></span></span></span><br><span><var>MachineX</var><span><span class="hyp-body"><b>:= </b><span>machine X</span></span><span class="hyp-type"><b>: </b><span>VLSMMachine (vtype X)</span></span></span></span><br><span><var>R</var><span class="hyp-type"><b>: </b><span>state ‚Üí state ‚Üí <span class="kt">Prop</span></span></span></span><br><span><var>Hpre</var><span class="hyp-type"><b>: </b><span>PreOrder (relation_disjunction R eq)</span></span></span><br><span><var>Ht</var><span class="hyp-type"><b>: </b><span>input_valid_transition_preserving R</span></span></span><br><span><var>s1, s2</var><span class="hyp-type"><b>: </b><span>state</span></span></span><br><span><var>Hin</var><span class="hyp-type"><b>: </b><span>in_futures s1 s2</span></span></span><br><span><var>Hneq</var><span class="hyp-type"><b>: </b><span>s1 ‚â† s2</span></span></span><br><span><var>Hpreserve</var><span class="hyp-type"><b>: </b><span>input_valid_transition_preserving
  (relation_disjunction R eq)
‚Üí <span class="kr">‚àÄ</span> <span class="nv">s1</span> <span class="nv">s2</span> : state,
    in_futures s1 s2
    ‚Üí relation_disjunction R eq s1 s2</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">R s1 s2</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">        </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="VLSM-v-chk35f" style="display: none" type="checkbox"><label class="alectryon-input" for="VLSM-v-chk35f">spec Hpreserve.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>message</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>X</var><span class="hyp-type"><b>: </b><span>VLSM message</span></span></span><br><span><var>TypeX</var><span><span class="hyp-body"><b>:= </b><span>type X</span></span><span class="hyp-type"><b>: </b><span>VLSMType message</span></span></span></span><br><span><var>MachineX</var><span><span class="hyp-body"><b>:= </b><span>machine X</span></span><span class="hyp-type"><b>: </b><span>VLSMMachine (vtype X)</span></span></span></span><br><span><var>R</var><span class="hyp-type"><b>: </b><span>state ‚Üí state ‚Üí <span class="kt">Prop</span></span></span></span><br><span><var>Hpre</var><span class="hyp-type"><b>: </b><span>PreOrder (relation_disjunction R eq)</span></span></span><br><span><var>Ht</var><span class="hyp-type"><b>: </b><span>input_valid_transition_preserving R</span></span></span><br><span><var>s1, s2</var><span class="hyp-type"><b>: </b><span>state</span></span></span><br><span><var>Hin</var><span class="hyp-type"><b>: </b><span>in_futures s1 s2</span></span></span><br><span><var>Hneq</var><span class="hyp-type"><b>: </b><span>s1 ‚â† s2</span></span></span><br><span><var>Hpreserve</var><span class="hyp-type"><b>: </b><span>input_valid_transition_preserving
  (relation_disjunction R eq)
‚Üí <span class="kr">‚àÄ</span> <span class="nv">s1</span> <span class="nv">s2</span> : state,
    in_futures s1 s2
    ‚Üí relation_disjunction R eq s1 s2</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">input_valid_transition_preserving
  (relation_disjunction R eq)</div></blockquote><div class="alectryon-extra-goals"><input class="alectryon-extra-goal-toggle" id="VLSM-v-chk360" style="display: none" type="checkbox"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>message</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>X</var><span class="hyp-type"><b>: </b><span>VLSM message</span></span></span><br><span><var>TypeX</var><span><span class="hyp-body"><b>:= </b><span>type X</span></span><span class="hyp-type"><b>: </b><span>VLSMType message</span></span></span></span><br><span><var>MachineX</var><span><span class="hyp-body"><b>:= </b><span>machine X</span></span><span class="hyp-type"><b>: </b><span>VLSMMachine (vtype X)</span></span></span></span><br><span><var>R</var><span class="hyp-type"><b>: </b><span>state ‚Üí state ‚Üí <span class="kt">Prop</span></span></span></span><br><span><var>Hpre</var><span class="hyp-type"><b>: </b><span>PreOrder (relation_disjunction R eq)</span></span></span><br><span><var>Ht</var><span class="hyp-type"><b>: </b><span>input_valid_transition_preserving R</span></span></span><br><span><var>s1, s2</var><span class="hyp-type"><b>: </b><span>state</span></span></span><br><span><var>Hin</var><span class="hyp-type"><b>: </b><span>in_futures s1 s2</span></span></span><br><span><var>Hneq</var><span class="hyp-type"><b>: </b><span>s1 ‚â† s2</span></span></span><br><span><var>Hpreserve</var><span class="hyp-type"><b>: </b><span><span class="kr">‚àÄ</span> <span class="nv">s1</span> <span class="nv">s2</span> : state,
  in_futures s1 s2
  ‚Üí relation_disjunction R eq s1 s2</span></span></span><br></div><label class="goal-separator" for="VLSM-v-chk360"><hr></label><div class="goal-conclusion">R s1 s2</div></blockquote></div></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">        </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="VLSM-v-chk361" style="display: none" type="checkbox"><label class="alectryon-input" for="VLSM-v-chk361">+</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>message</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>X</var><span class="hyp-type"><b>: </b><span>VLSM message</span></span></span><br><span><var>TypeX</var><span><span class="hyp-body"><b>:= </b><span>type X</span></span><span class="hyp-type"><b>: </b><span>VLSMType message</span></span></span></span><br><span><var>MachineX</var><span><span class="hyp-body"><b>:= </b><span>machine X</span></span><span class="hyp-type"><b>: </b><span>VLSMMachine (vtype X)</span></span></span></span><br><span><var>R</var><span class="hyp-type"><b>: </b><span>state ‚Üí state ‚Üí <span class="kt">Prop</span></span></span></span><br><span><var>Hpre</var><span class="hyp-type"><b>: </b><span>PreOrder (relation_disjunction R eq)</span></span></span><br><span><var>Ht</var><span class="hyp-type"><b>: </b><span>input_valid_transition_preserving R</span></span></span><br><span><var>s1, s2</var><span class="hyp-type"><b>: </b><span>state</span></span></span><br><span><var>Hin</var><span class="hyp-type"><b>: </b><span>in_futures s1 s2</span></span></span><br><span><var>Hneq</var><span class="hyp-type"><b>: </b><span>s1 ‚â† s2</span></span></span><br><span><var>Hpreserve</var><span class="hyp-type"><b>: </b><span>input_valid_transition_preserving
  (relation_disjunction R eq)
‚Üí <span class="kr">‚àÄ</span> <span class="nv">s1</span> <span class="nv">s2</span> : state,
    in_futures s1 s2
    ‚Üí relation_disjunction R eq s1 s2</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">input_valid_transition_preserving
  (relation_disjunction R eq)</div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="VLSM-v-chk362" style="display: none" type="checkbox"><label class="alectryon-input" for="VLSM-v-chk362"><span class="nb">intro</span>; <span class="nb">intros</span>.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>message</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>X</var><span class="hyp-type"><b>: </b><span>VLSM message</span></span></span><br><span><var>TypeX</var><span><span class="hyp-body"><b>:= </b><span>type X</span></span><span class="hyp-type"><b>: </b><span>VLSMType message</span></span></span></span><br><span><var>MachineX</var><span><span class="hyp-body"><b>:= </b><span>machine X</span></span><span class="hyp-type"><b>: </b><span>VLSMMachine (vtype X)</span></span></span></span><br><span><var>R</var><span class="hyp-type"><b>: </b><span>state ‚Üí state ‚Üí <span class="kt">Prop</span></span></span></span><br><span><var>Hpre</var><span class="hyp-type"><b>: </b><span>PreOrder (relation_disjunction R eq)</span></span></span><br><span><var>Ht</var><span class="hyp-type"><b>: </b><span>input_valid_transition_preserving R</span></span></span><br><span><var>s1, s2</var><span class="hyp-type"><b>: </b><span>state</span></span></span><br><span><var>Hin</var><span class="hyp-type"><b>: </b><span>in_futures s1 s2</span></span></span><br><span><var>Hneq</var><span class="hyp-type"><b>: </b><span>s1 ‚â† s2</span></span></span><br><span><var>Hpreserve</var><span class="hyp-type"><b>: </b><span>input_valid_transition_preserving
  (relation_disjunction R eq)
‚Üí <span class="kr">‚àÄ</span> <span class="nv">s1</span> <span class="nv">s2</span> : state,
    in_futures s1 s2
    ‚Üí relation_disjunction R eq s1 s2</span></span></span><br><span><var>s3, s4</var><span class="hyp-type"><b>: </b><span>state</span></span></span><br><span><var>l0</var><span class="hyp-type"><b>: </b><span>label</span></span></span><br><span><var>om1, om2</var><span class="hyp-type"><b>: </b><span>option message</span></span></span><br><span><var>Hvalid_transition</var><span class="hyp-type"><b>: </b><span>input_valid_transition l0
  (s3, om1) (s4, om2)</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">relation_disjunction R eq s3 s4</div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="VLSM-v-chk363" style="display: none" type="checkbox"><label class="alectryon-input" for="VLSM-v-chk363"><span class="nb">left</span>.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>message</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>X</var><span class="hyp-type"><b>: </b><span>VLSM message</span></span></span><br><span><var>TypeX</var><span><span class="hyp-body"><b>:= </b><span>type X</span></span><span class="hyp-type"><b>: </b><span>VLSMType message</span></span></span></span><br><span><var>MachineX</var><span><span class="hyp-body"><b>:= </b><span>machine X</span></span><span class="hyp-type"><b>: </b><span>VLSMMachine (vtype X)</span></span></span></span><br><span><var>R</var><span class="hyp-type"><b>: </b><span>state ‚Üí state ‚Üí <span class="kt">Prop</span></span></span></span><br><span><var>Hpre</var><span class="hyp-type"><b>: </b><span>PreOrder (relation_disjunction R eq)</span></span></span><br><span><var>Ht</var><span class="hyp-type"><b>: </b><span>input_valid_transition_preserving R</span></span></span><br><span><var>s1, s2</var><span class="hyp-type"><b>: </b><span>state</span></span></span><br><span><var>Hin</var><span class="hyp-type"><b>: </b><span>in_futures s1 s2</span></span></span><br><span><var>Hneq</var><span class="hyp-type"><b>: </b><span>s1 ‚â† s2</span></span></span><br><span><var>Hpreserve</var><span class="hyp-type"><b>: </b><span>input_valid_transition_preserving
  (relation_disjunction R eq)
‚Üí <span class="kr">‚àÄ</span> <span class="nv">s1</span> <span class="nv">s2</span> : state,
    in_futures s1 s2
    ‚Üí relation_disjunction R eq s1 s2</span></span></span><br><span><var>s3, s4</var><span class="hyp-type"><b>: </b><span>state</span></span></span><br><span><var>l0</var><span class="hyp-type"><b>: </b><span>label</span></span></span><br><span><var>om1, om2</var><span class="hyp-type"><b>: </b><span>option message</span></span></span><br><span><var>Hvalid_transition</var><span class="hyp-type"><b>: </b><span>input_valid_transition l0
  (s3, om1) (s4, om2)</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">R s3 s4</div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="nb">apply</span> (Ht s3 s4 l0 om1 om2 Hvalid_transition).</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">        </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="VLSM-v-chk364" style="display: none" type="checkbox"><label class="alectryon-input" for="VLSM-v-chk364">+</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>message</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>X</var><span class="hyp-type"><b>: </b><span>VLSM message</span></span></span><br><span><var>TypeX</var><span><span class="hyp-body"><b>:= </b><span>type X</span></span><span class="hyp-type"><b>: </b><span>VLSMType message</span></span></span></span><br><span><var>MachineX</var><span><span class="hyp-body"><b>:= </b><span>machine X</span></span><span class="hyp-type"><b>: </b><span>VLSMMachine (vtype X)</span></span></span></span><br><span><var>R</var><span class="hyp-type"><b>: </b><span>state ‚Üí state ‚Üí <span class="kt">Prop</span></span></span></span><br><span><var>Hpre</var><span class="hyp-type"><b>: </b><span>PreOrder (relation_disjunction R eq)</span></span></span><br><span><var>Ht</var><span class="hyp-type"><b>: </b><span>input_valid_transition_preserving R</span></span></span><br><span><var>s1, s2</var><span class="hyp-type"><b>: </b><span>state</span></span></span><br><span><var>Hin</var><span class="hyp-type"><b>: </b><span>in_futures s1 s2</span></span></span><br><span><var>Hneq</var><span class="hyp-type"><b>: </b><span>s1 ‚â† s2</span></span></span><br><span><var>Hpreserve</var><span class="hyp-type"><b>: </b><span><span class="kr">‚àÄ</span> <span class="nv">s1</span> <span class="nv">s2</span> : state,
  in_futures s1 s2
  ‚Üí relation_disjunction R eq s1 s2</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">R s1 s2</div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="VLSM-v-chk365" style="display: none" type="checkbox"><label class="alectryon-input" for="VLSM-v-chk365">spec Hpreserve s1 s2 Hin.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>message</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>X</var><span class="hyp-type"><b>: </b><span>VLSM message</span></span></span><br><span><var>TypeX</var><span><span class="hyp-body"><b>:= </b><span>type X</span></span><span class="hyp-type"><b>: </b><span>VLSMType message</span></span></span></span><br><span><var>MachineX</var><span><span class="hyp-body"><b>:= </b><span>machine X</span></span><span class="hyp-type"><b>: </b><span>VLSMMachine (vtype X)</span></span></span></span><br><span><var>R</var><span class="hyp-type"><b>: </b><span>state ‚Üí state ‚Üí <span class="kt">Prop</span></span></span></span><br><span><var>Hpre</var><span class="hyp-type"><b>: </b><span>PreOrder (relation_disjunction R eq)</span></span></span><br><span><var>Ht</var><span class="hyp-type"><b>: </b><span>input_valid_transition_preserving R</span></span></span><br><span><var>s1, s2</var><span class="hyp-type"><b>: </b><span>state</span></span></span><br><span><var>Hin</var><span class="hyp-type"><b>: </b><span>in_futures s1 s2</span></span></span><br><span><var>Hneq</var><span class="hyp-type"><b>: </b><span>s1 ‚â† s2</span></span></span><br><span><var>Hpreserve</var><span class="hyp-type"><b>: </b><span>relation_disjunction R eq s1 s2</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">R s1 s2</div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="VLSM-v-chk366" style="display: none" type="checkbox"><label class="alectryon-input" for="VLSM-v-chk366"><span class="nb">destruct</span> Hpreserve; <span class="kp">try</span> <span class="bp">assumption</span>.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>message</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>X</var><span class="hyp-type"><b>: </b><span>VLSM message</span></span></span><br><span><var>TypeX</var><span><span class="hyp-body"><b>:= </b><span>type X</span></span><span class="hyp-type"><b>: </b><span>VLSMType message</span></span></span></span><br><span><var>MachineX</var><span><span class="hyp-body"><b>:= </b><span>machine X</span></span><span class="hyp-type"><b>: </b><span>VLSMMachine (vtype X)</span></span></span></span><br><span><var>R</var><span class="hyp-type"><b>: </b><span>state ‚Üí state ‚Üí <span class="kt">Prop</span></span></span></span><br><span><var>Hpre</var><span class="hyp-type"><b>: </b><span>PreOrder (relation_disjunction R eq)</span></span></span><br><span><var>Ht</var><span class="hyp-type"><b>: </b><span>input_valid_transition_preserving R</span></span></span><br><span><var>s1, s2</var><span class="hyp-type"><b>: </b><span>state</span></span></span><br><span><var>Hin</var><span class="hyp-type"><b>: </b><span>in_futures s1 s2</span></span></span><br><span><var>Hneq</var><span class="hyp-type"><b>: </b><span>s1 ‚â† s2</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>s1 = s2</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">R s1 s2</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">          </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="VLSM-v-chk367" style="display: none" type="checkbox"><label class="alectryon-input" for="VLSM-v-chk367"><span class="nb">elim</span> Hneq.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>message</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>X</var><span class="hyp-type"><b>: </b><span>VLSM message</span></span></span><br><span><var>TypeX</var><span><span class="hyp-body"><b>:= </b><span>type X</span></span><span class="hyp-type"><b>: </b><span>VLSMType message</span></span></span></span><br><span><var>MachineX</var><span><span class="hyp-body"><b>:= </b><span>machine X</span></span><span class="hyp-type"><b>: </b><span>VLSMMachine (vtype X)</span></span></span></span><br><span><var>R</var><span class="hyp-type"><b>: </b><span>state ‚Üí state ‚Üí <span class="kt">Prop</span></span></span></span><br><span><var>Hpre</var><span class="hyp-type"><b>: </b><span>PreOrder (relation_disjunction R eq)</span></span></span><br><span><var>Ht</var><span class="hyp-type"><b>: </b><span>input_valid_transition_preserving R</span></span></span><br><span><var>s1, s2</var><span class="hyp-type"><b>: </b><span>state</span></span></span><br><span><var>Hin</var><span class="hyp-type"><b>: </b><span>in_futures s1 s2</span></span></span><br><span><var>Hneq</var><span class="hyp-type"><b>: </b><span>s1 ‚â† s2</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>s1 = s2</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">s1 = s2</div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="bp">assumption</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">      </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="VLSM-v-chk368" style="display: none" type="checkbox"><label class="alectryon-input" for="VLSM-v-chk368">-</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>message</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>X</var><span class="hyp-type"><b>: </b><span>VLSM message</span></span></span><br><span><var>TypeX</var><span><span class="hyp-body"><b>:= </b><span>type X</span></span><span class="hyp-type"><b>: </b><span>VLSMType message</span></span></span></span><br><span><var>MachineX</var><span><span class="hyp-body"><b>:= </b><span>machine X</span></span><span class="hyp-type"><b>: </b><span>VLSMMachine (vtype X)</span></span></span></span><br><span><var>R</var><span class="hyp-type"><b>: </b><span>state ‚Üí state ‚Üí <span class="kt">Prop</span></span></span></span><br><span><var>Hpre</var><span class="hyp-type"><b>: </b><span>StrictOrder R</span></span></span><br><span><var>Ht</var><span class="hyp-type"><b>: </b><span>input_valid_transition_preserving R</span></span></span><br><span><var>s1, s2</var><span class="hyp-type"><b>: </b><span>state</span></span></span><br><span><var>Hin</var><span class="hyp-type"><b>: </b><span>in_futures s1 s2</span></span></span><br><span><var>Hneq</var><span class="hyp-type"><b>: </b><span>s1 ‚â† s2</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">Proper (eq ==&gt; eq ==&gt; iff) R</div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="VLSM-v-chk369" style="display: none" type="checkbox"><label class="alectryon-input" for="VLSM-v-chk369"><span class="nb">intros</span> x1 x2 Heq.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>message</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>X</var><span class="hyp-type"><b>: </b><span>VLSM message</span></span></span><br><span><var>TypeX</var><span><span class="hyp-body"><b>:= </b><span>type X</span></span><span class="hyp-type"><b>: </b><span>VLSMType message</span></span></span></span><br><span><var>MachineX</var><span><span class="hyp-body"><b>:= </b><span>machine X</span></span><span class="hyp-type"><b>: </b><span>VLSMMachine (vtype X)</span></span></span></span><br><span><var>R</var><span class="hyp-type"><b>: </b><span>state ‚Üí state ‚Üí <span class="kt">Prop</span></span></span></span><br><span><var>Hpre</var><span class="hyp-type"><b>: </b><span>StrictOrder R</span></span></span><br><span><var>Ht</var><span class="hyp-type"><b>: </b><span>input_valid_transition_preserving R</span></span></span><br><span><var>s1, s2</var><span class="hyp-type"><b>: </b><span>state</span></span></span><br><span><var>Hin</var><span class="hyp-type"><b>: </b><span>in_futures s1 s2</span></span></span><br><span><var>Hneq</var><span class="hyp-type"><b>: </b><span>s1 ‚â† s2</span></span></span><br><span><var>x1, x2</var><span class="hyp-type"><b>: </b><span>state</span></span></span><br><span><var>Heq</var><span class="hyp-type"><b>: </b><span>x1 = x2</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">(eq ==&gt; iff)%signature (R x1) (R x2)</div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="VLSM-v-chk36a" style="display: none" type="checkbox"><label class="alectryon-input" for="VLSM-v-chk36a"><span class="nb">subst</span>.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>message</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>X</var><span class="hyp-type"><b>: </b><span>VLSM message</span></span></span><br><span><var>TypeX</var><span><span class="hyp-body"><b>:= </b><span>type X</span></span><span class="hyp-type"><b>: </b><span>VLSMType message</span></span></span></span><br><span><var>MachineX</var><span><span class="hyp-body"><b>:= </b><span>machine X</span></span><span class="hyp-type"><b>: </b><span>VLSMMachine (vtype X)</span></span></span></span><br><span><var>R</var><span class="hyp-type"><b>: </b><span>state ‚Üí state ‚Üí <span class="kt">Prop</span></span></span></span><br><span><var>Hpre</var><span class="hyp-type"><b>: </b><span>StrictOrder R</span></span></span><br><span><var>Ht</var><span class="hyp-type"><b>: </b><span>input_valid_transition_preserving R</span></span></span><br><span><var>s1, s2</var><span class="hyp-type"><b>: </b><span>state</span></span></span><br><span><var>Hin</var><span class="hyp-type"><b>: </b><span>in_futures s1 s2</span></span></span><br><span><var>Hneq</var><span class="hyp-type"><b>: </b><span>s1 ‚â† s2</span></span></span><br><span><var>x2</var><span class="hyp-type"><b>: </b><span>state</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">(eq ==&gt; iff)%signature (R x2) (R x2)</div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="VLSM-v-chk36b" style="display: none" type="checkbox"><label class="alectryon-input" for="VLSM-v-chk36b"><span class="nb">intros</span> y1 y2 Heq.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>message</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>X</var><span class="hyp-type"><b>: </b><span>VLSM message</span></span></span><br><span><var>TypeX</var><span><span class="hyp-body"><b>:= </b><span>type X</span></span><span class="hyp-type"><b>: </b><span>VLSMType message</span></span></span></span><br><span><var>MachineX</var><span><span class="hyp-body"><b>:= </b><span>machine X</span></span><span class="hyp-type"><b>: </b><span>VLSMMachine (vtype X)</span></span></span></span><br><span><var>R</var><span class="hyp-type"><b>: </b><span>state ‚Üí state ‚Üí <span class="kt">Prop</span></span></span></span><br><span><var>Hpre</var><span class="hyp-type"><b>: </b><span>StrictOrder R</span></span></span><br><span><var>Ht</var><span class="hyp-type"><b>: </b><span>input_valid_transition_preserving R</span></span></span><br><span><var>s1, s2</var><span class="hyp-type"><b>: </b><span>state</span></span></span><br><span><var>Hin</var><span class="hyp-type"><b>: </b><span>in_futures s1 s2</span></span></span><br><span><var>Hneq</var><span class="hyp-type"><b>: </b><span>s1 ‚â† s2</span></span></span><br><span><var>x2, y1, y2</var><span class="hyp-type"><b>: </b><span>state</span></span></span><br><span><var>Heq</var><span class="hyp-type"><b>: </b><span>y1 = y2</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">R x2 y1 ‚Üî R x2 y2</div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="VLSM-v-chk36c" style="display: none" type="checkbox"><label class="alectryon-input" for="VLSM-v-chk36c"><span class="nb">subst</span>.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>message</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>X</var><span class="hyp-type"><b>: </b><span>VLSM message</span></span></span><br><span><var>TypeX</var><span><span class="hyp-body"><b>:= </b><span>type X</span></span><span class="hyp-type"><b>: </b><span>VLSMType message</span></span></span></span><br><span><var>MachineX</var><span><span class="hyp-body"><b>:= </b><span>machine X</span></span><span class="hyp-type"><b>: </b><span>VLSMMachine (vtype X)</span></span></span></span><br><span><var>R</var><span class="hyp-type"><b>: </b><span>state ‚Üí state ‚Üí <span class="kt">Prop</span></span></span></span><br><span><var>Hpre</var><span class="hyp-type"><b>: </b><span>StrictOrder R</span></span></span><br><span><var>Ht</var><span class="hyp-type"><b>: </b><span>input_valid_transition_preserving R</span></span></span><br><span><var>s1, s2</var><span class="hyp-type"><b>: </b><span>state</span></span></span><br><span><var>Hin</var><span class="hyp-type"><b>: </b><span>in_futures s1 s2</span></span></span><br><span><var>Hneq</var><span class="hyp-type"><b>: </b><span>s1 ‚â† s2</span></span></span><br><span><var>x2, y2</var><span class="hyp-type"><b>: </b><span>state</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">R x2 y2 ‚Üî R x2 y2</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">        </span><span class="alectryon-sentence"><span class="alectryon-input"><span class="nb">split</span>; <span class="nb">intro</span>; <span class="bp">assumption</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Qed</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
</span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="VLSM-v-chk36d" style="display: none" type="checkbox"><label class="alectryon-input" for="VLSM-v-chk36d"><span class="kn">Lemma</span> <span class="nf">in_futures_valid_fst</span>
      (<span class="nv">first</span> <span class="nv">second</span> : state)
      (<span class="nv">Hfuture</span>: in_futures <span class="kp">first</span> second)
      : valid_state_prop <span class="kp">first</span>.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>message</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>X</var><span class="hyp-type"><b>: </b><span>VLSM message</span></span></span><br><span><var>TypeX</var><span><span class="hyp-body"><b>:= </b><span>type X</span></span><span class="hyp-type"><b>: </b><span>VLSMType message</span></span></span></span><br><span><var>MachineX</var><span><span class="hyp-body"><b>:= </b><span>machine X</span></span><span class="hyp-type"><b>: </b><span>VLSMMachine (vtype X)</span></span></span></span><br><span><var>first, second</var><span class="hyp-type"><b>: </b><span>state</span></span></span><br><span><var>Hfuture</var><span class="hyp-type"><b>: </b><span>in_futures <span class="kp">first</span> second</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">valid_state_prop <span class="kp">first</span></div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="VLSM-v-chk36e" style="display: none" type="checkbox"><label class="alectryon-input" for="VLSM-v-chk36e"><span class="kn">Proof</span>.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>message</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>X</var><span class="hyp-type"><b>: </b><span>VLSM message</span></span></span><br><span><var>TypeX</var><span><span class="hyp-body"><b>:= </b><span>type X</span></span><span class="hyp-type"><b>: </b><span>VLSMType message</span></span></span></span><br><span><var>MachineX</var><span><span class="hyp-body"><b>:= </b><span>machine X</span></span><span class="hyp-type"><b>: </b><span>VLSMMachine (vtype X)</span></span></span></span><br><span><var>first, second</var><span class="hyp-type"><b>: </b><span>state</span></span></span><br><span><var>Hfuture</var><span class="hyp-type"><b>: </b><span>in_futures <span class="kp">first</span> second</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">valid_state_prop <span class="kp">first</span></div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">      </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="VLSM-v-chk36f" style="display: none" type="checkbox"><label class="alectryon-input" for="VLSM-v-chk36f"><span class="nb">destruct</span> Hfuture <span class="kr">as</span> [tr Htr].</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>message</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>X</var><span class="hyp-type"><b>: </b><span>VLSM message</span></span></span><br><span><var>TypeX</var><span><span class="hyp-body"><b>:= </b><span>type X</span></span><span class="hyp-type"><b>: </b><span>VLSMType message</span></span></span></span><br><span><var>MachineX</var><span><span class="hyp-body"><b>:= </b><span>machine X</span></span><span class="hyp-type"><b>: </b><span>VLSMMachine (vtype X)</span></span></span></span><br><span><var>first, second</var><span class="hyp-type"><b>: </b><span>state</span></span></span><br><span><var>tr</var><span class="hyp-type"><b>: </b><span>list transition_item</span></span></span><br><span><var>Htr</var><span class="hyp-type"><b>: </b><span>finite_valid_trace_from_to <span class="kp">first</span> second tr</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">valid_state_prop <span class="kp">first</span></div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">      </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="VLSM-v-chk370" style="display: none" type="checkbox"><label class="alectryon-input" for="VLSM-v-chk370"><span class="nb">apply</span> finite_valid_trace_from_to_forget_last <span class="kr">in</span> Htr.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>message</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>X</var><span class="hyp-type"><b>: </b><span>VLSM message</span></span></span><br><span><var>TypeX</var><span><span class="hyp-body"><b>:= </b><span>type X</span></span><span class="hyp-type"><b>: </b><span>VLSMType message</span></span></span></span><br><span><var>MachineX</var><span><span class="hyp-body"><b>:= </b><span>machine X</span></span><span class="hyp-type"><b>: </b><span>VLSMMachine (vtype X)</span></span></span></span><br><span><var>first, second</var><span class="hyp-type"><b>: </b><span>state</span></span></span><br><span><var>tr</var><span class="hyp-type"><b>: </b><span>list transition_item</span></span></span><br><span><var>Htr</var><span class="hyp-type"><b>: </b><span>finite_valid_trace_from <span class="kp">first</span> tr</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">valid_state_prop <span class="kp">first</span></div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">      </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="VLSM-v-chk371" style="display: none" type="checkbox"><label class="alectryon-input" for="VLSM-v-chk371"><span class="nb">apply</span> finite_valid_trace_first_pstate <span class="kr">in</span> Htr.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>message</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>X</var><span class="hyp-type"><b>: </b><span>VLSM message</span></span></span><br><span><var>TypeX</var><span><span class="hyp-body"><b>:= </b><span>type X</span></span><span class="hyp-type"><b>: </b><span>VLSMType message</span></span></span></span><br><span><var>MachineX</var><span><span class="hyp-body"><b>:= </b><span>machine X</span></span><span class="hyp-type"><b>: </b><span>VLSMMachine (vtype X)</span></span></span></span><br><span><var>first, second</var><span class="hyp-type"><b>: </b><span>state</span></span></span><br><span><var>tr</var><span class="hyp-type"><b>: </b><span>list transition_item</span></span></span><br><span><var>Htr</var><span class="hyp-type"><b>: </b><span>valid_state_prop <span class="kp">first</span></span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">valid_state_prop <span class="kp">first</span></div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">      </span><span class="alectryon-sentence"><span class="alectryon-input"><span class="bp">assumption</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Qed</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
    <span class="c">(* begin hide *)</span>

</span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="VLSM-v-chk372" style="display: none" type="checkbox"><label class="alectryon-input" for="VLSM-v-chk372"><span class="kn">Lemma</span> <span class="nf">in_futures_refl</span>
      (<span class="nv">first</span>: state)
      (<span class="nv">Hps</span> : valid_state_prop <span class="kp">first</span>)
      : in_futures <span class="kp">first</span> <span class="kp">first</span>.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>message</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>X</var><span class="hyp-type"><b>: </b><span>VLSM message</span></span></span><br><span><var>TypeX</var><span><span class="hyp-body"><b>:= </b><span>type X</span></span><span class="hyp-type"><b>: </b><span>VLSMType message</span></span></span></span><br><span><var>MachineX</var><span><span class="hyp-body"><b>:= </b><span>machine X</span></span><span class="hyp-type"><b>: </b><span>VLSMMachine (vtype X)</span></span></span></span><br><span><var>first</var><span class="hyp-type"><b>: </b><span>state</span></span></span><br><span><var>Hps</var><span class="hyp-type"><b>: </b><span>valid_state_prop <span class="kp">first</span></span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">in_futures <span class="kp">first</span> <span class="kp">first</span></div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
</span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="VLSM-v-chk373" style="display: none" type="checkbox"><label class="alectryon-input" for="VLSM-v-chk373"><span class="kn">Proof</span>.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>message</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>X</var><span class="hyp-type"><b>: </b><span>VLSM message</span></span></span><br><span><var>TypeX</var><span><span class="hyp-body"><b>:= </b><span>type X</span></span><span class="hyp-type"><b>: </b><span>VLSMType message</span></span></span></span><br><span><var>MachineX</var><span><span class="hyp-body"><b>:= </b><span>machine X</span></span><span class="hyp-type"><b>: </b><span>VLSMMachine (vtype X)</span></span></span></span><br><span><var>first</var><span class="hyp-type"><b>: </b><span>state</span></span></span><br><span><var>Hps</var><span class="hyp-type"><b>: </b><span>valid_state_prop <span class="kp">first</span></span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">in_futures <span class="kp">first</span> <span class="kp">first</span></div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">      </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="VLSM-v-chk374" style="display: none" type="checkbox"><label class="alectryon-input" for="VLSM-v-chk374"><span class="kr">exists</span> [].</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>message</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>X</var><span class="hyp-type"><b>: </b><span>VLSM message</span></span></span><br><span><var>TypeX</var><span><span class="hyp-body"><b>:= </b><span>type X</span></span><span class="hyp-type"><b>: </b><span>VLSMType message</span></span></span></span><br><span><var>MachineX</var><span><span class="hyp-body"><b>:= </b><span>machine X</span></span><span class="hyp-type"><b>: </b><span>VLSMMachine (vtype X)</span></span></span></span><br><span><var>first</var><span class="hyp-type"><b>: </b><span>state</span></span></span><br><span><var>Hps</var><span class="hyp-type"><b>: </b><span>valid_state_prop <span class="kp">first</span></span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">finite_valid_trace_from_to <span class="kp">first</span> <span class="kp">first</span> []</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">      </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="VLSM-v-chk375" style="display: none" type="checkbox"><label class="alectryon-input" for="VLSM-v-chk375"><span class="nb">constructor</span>.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>message</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>X</var><span class="hyp-type"><b>: </b><span>VLSM message</span></span></span><br><span><var>TypeX</var><span><span class="hyp-body"><b>:= </b><span>type X</span></span><span class="hyp-type"><b>: </b><span>VLSMType message</span></span></span></span><br><span><var>MachineX</var><span><span class="hyp-body"><b>:= </b><span>machine X</span></span><span class="hyp-type"><b>: </b><span>VLSMMachine (vtype X)</span></span></span></span><br><span><var>first</var><span class="hyp-type"><b>: </b><span>state</span></span></span><br><span><var>Hps</var><span class="hyp-type"><b>: </b><span>valid_state_prop <span class="kp">first</span></span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">valid_state_prop <span class="kp">first</span></div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">      </span><span class="alectryon-sentence"><span class="alectryon-input"><span class="bp">assumption</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Qed</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
</span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="VLSM-v-chk376" style="display: none" type="checkbox"><label class="alectryon-input" for="VLSM-v-chk376"><span class="kn">Lemma</span> <span class="nf">in_futures_trans</span>
      (<span class="nv">first</span> <span class="nv">second</span> <span class="nv">third</span> : state)
      (<span class="nv">H12</span>: in_futures <span class="kp">first</span> second)
      (<span class="nv">H23</span> : in_futures second third)
      : in_futures <span class="kp">first</span> third.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>message</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>X</var><span class="hyp-type"><b>: </b><span>VLSM message</span></span></span><br><span><var>TypeX</var><span><span class="hyp-body"><b>:= </b><span>type X</span></span><span class="hyp-type"><b>: </b><span>VLSMType message</span></span></span></span><br><span><var>MachineX</var><span><span class="hyp-body"><b>:= </b><span>machine X</span></span><span class="hyp-type"><b>: </b><span>VLSMMachine (vtype X)</span></span></span></span><br><span><var>first, second, third</var><span class="hyp-type"><b>: </b><span>state</span></span></span><br><span><var>H12</var><span class="hyp-type"><b>: </b><span>in_futures <span class="kp">first</span> second</span></span></span><br><span><var>H23</var><span class="hyp-type"><b>: </b><span>in_futures second third</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">in_futures <span class="kp">first</span> third</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="VLSM-v-chk377" style="display: none" type="checkbox"><label class="alectryon-input" for="VLSM-v-chk377"><span class="kn">Proof</span>.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>message</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>X</var><span class="hyp-type"><b>: </b><span>VLSM message</span></span></span><br><span><var>TypeX</var><span><span class="hyp-body"><b>:= </b><span>type X</span></span><span class="hyp-type"><b>: </b><span>VLSMType message</span></span></span></span><br><span><var>MachineX</var><span><span class="hyp-body"><b>:= </b><span>machine X</span></span><span class="hyp-type"><b>: </b><span>VLSMMachine (vtype X)</span></span></span></span><br><span><var>first, second, third</var><span class="hyp-type"><b>: </b><span>state</span></span></span><br><span><var>H12</var><span class="hyp-type"><b>: </b><span>in_futures <span class="kp">first</span> second</span></span></span><br><span><var>H23</var><span class="hyp-type"><b>: </b><span>in_futures second third</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">in_futures <span class="kp">first</span> third</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">      </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="VLSM-v-chk378" style="display: none" type="checkbox"><label class="alectryon-input" for="VLSM-v-chk378"><span class="nb">destruct</span> H12 <span class="kr">as</span> [tr12 Htr12].</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>message</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>X</var><span class="hyp-type"><b>: </b><span>VLSM message</span></span></span><br><span><var>TypeX</var><span><span class="hyp-body"><b>:= </b><span>type X</span></span><span class="hyp-type"><b>: </b><span>VLSMType message</span></span></span></span><br><span><var>MachineX</var><span><span class="hyp-body"><b>:= </b><span>machine X</span></span><span class="hyp-type"><b>: </b><span>VLSMMachine (vtype X)</span></span></span></span><br><span><var>first, second, third</var><span class="hyp-type"><b>: </b><span>state</span></span></span><br><span><var>tr12</var><span class="hyp-type"><b>: </b><span>list transition_item</span></span></span><br><span><var>Htr12</var><span class="hyp-type"><b>: </b><span>finite_valid_trace_from_to <span class="kp">first</span> second tr12</span></span></span><br><span><var>H23</var><span class="hyp-type"><b>: </b><span>in_futures second third</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">in_futures <span class="kp">first</span> third</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">      </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="VLSM-v-chk379" style="display: none" type="checkbox"><label class="alectryon-input" for="VLSM-v-chk379"><span class="nb">destruct</span> H23 <span class="kr">as</span> [tr23 Htr23].</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>message</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>X</var><span class="hyp-type"><b>: </b><span>VLSM message</span></span></span><br><span><var>TypeX</var><span><span class="hyp-body"><b>:= </b><span>type X</span></span><span class="hyp-type"><b>: </b><span>VLSMType message</span></span></span></span><br><span><var>MachineX</var><span><span class="hyp-body"><b>:= </b><span>machine X</span></span><span class="hyp-type"><b>: </b><span>VLSMMachine (vtype X)</span></span></span></span><br><span><var>first, second, third</var><span class="hyp-type"><b>: </b><span>state</span></span></span><br><span><var>tr12</var><span class="hyp-type"><b>: </b><span>list transition_item</span></span></span><br><span><var>Htr12</var><span class="hyp-type"><b>: </b><span>finite_valid_trace_from_to <span class="kp">first</span> second tr12</span></span></span><br><span><var>tr23</var><span class="hyp-type"><b>: </b><span>list transition_item</span></span></span><br><span><var>Htr23</var><span class="hyp-type"><b>: </b><span>finite_valid_trace_from_to second third tr23</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">in_futures <span class="kp">first</span> third</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">      </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="VLSM-v-chk37a" style="display: none" type="checkbox"><label class="alectryon-input" for="VLSM-v-chk37a"><span class="kr">exists</span> (<span class="nv">tr12</span> ++ tr23).</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>message</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>X</var><span class="hyp-type"><b>: </b><span>VLSM message</span></span></span><br><span><var>TypeX</var><span><span class="hyp-body"><b>:= </b><span>type X</span></span><span class="hyp-type"><b>: </b><span>VLSMType message</span></span></span></span><br><span><var>MachineX</var><span><span class="hyp-body"><b>:= </b><span>machine X</span></span><span class="hyp-type"><b>: </b><span>VLSMMachine (vtype X)</span></span></span></span><br><span><var>first, second, third</var><span class="hyp-type"><b>: </b><span>state</span></span></span><br><span><var>tr12</var><span class="hyp-type"><b>: </b><span>list transition_item</span></span></span><br><span><var>Htr12</var><span class="hyp-type"><b>: </b><span>finite_valid_trace_from_to <span class="kp">first</span> second tr12</span></span></span><br><span><var>tr23</var><span class="hyp-type"><b>: </b><span>list transition_item</span></span></span><br><span><var>Htr23</var><span class="hyp-type"><b>: </b><span>finite_valid_trace_from_to second third tr23</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">finite_valid_trace_from_to <span class="kp">first</span> third (tr12 ++ tr23)</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">      </span><span class="alectryon-sentence"><span class="alectryon-input"><span class="nb">apply</span> finite_valid_trace_from_to_app <span class="kr">with</span> second;<span class="bp">assumption</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Qed</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
</span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="VLSM-v-chk37b" style="display: none" type="checkbox"><label class="alectryon-input" for="VLSM-v-chk37b"><span class="kn">Lemma</span> <span class="nf">input_valid_transition_in_futures</span> {<span class="nv">l</span> <span class="nv">s</span> <span class="nv">im</span> <span class="nv">s&#39;</span> <span class="nv">om</span>}
      (<span class="nv">Ht</span> : input_valid_transition l (s, im) (s&#39;, om))
      : in_futures s s&#39;.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>message</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>X</var><span class="hyp-type"><b>: </b><span>VLSM message</span></span></span><br><span><var>TypeX</var><span><span class="hyp-body"><b>:= </b><span>type X</span></span><span class="hyp-type"><b>: </b><span>VLSMType message</span></span></span></span><br><span><var>MachineX</var><span><span class="hyp-body"><b>:= </b><span>machine X</span></span><span class="hyp-type"><b>: </b><span>VLSMMachine (vtype X)</span></span></span></span><br><span><var>l</var><span class="hyp-type"><b>: </b><span>label</span></span></span><br><span><var>s</var><span class="hyp-type"><b>: </b><span>state</span></span></span><br><span><var>im</var><span class="hyp-type"><b>: </b><span>option message</span></span></span><br><span><var>s'</var><span class="hyp-type"><b>: </b><span>state</span></span></span><br><span><var>om</var><span class="hyp-type"><b>: </b><span>option message</span></span></span><br><span><var>Ht</var><span class="hyp-type"><b>: </b><span>input_valid_transition l (s, im) (s&#39;, om)</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">in_futures s s&#39;</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="VLSM-v-chk37c" style="display: none" type="checkbox"><label class="alectryon-input" for="VLSM-v-chk37c"><span class="kn">Proof</span>.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>message</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>X</var><span class="hyp-type"><b>: </b><span>VLSM message</span></span></span><br><span><var>TypeX</var><span><span class="hyp-body"><b>:= </b><span>type X</span></span><span class="hyp-type"><b>: </b><span>VLSMType message</span></span></span></span><br><span><var>MachineX</var><span><span class="hyp-body"><b>:= </b><span>machine X</span></span><span class="hyp-type"><b>: </b><span>VLSMMachine (vtype X)</span></span></span></span><br><span><var>l</var><span class="hyp-type"><b>: </b><span>label</span></span></span><br><span><var>s</var><span class="hyp-type"><b>: </b><span>state</span></span></span><br><span><var>im</var><span class="hyp-type"><b>: </b><span>option message</span></span></span><br><span><var>s'</var><span class="hyp-type"><b>: </b><span>state</span></span></span><br><span><var>om</var><span class="hyp-type"><b>: </b><span>option message</span></span></span><br><span><var>Ht</var><span class="hyp-type"><b>: </b><span>input_valid_transition l (s, im) (s&#39;, om)</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">in_futures s s&#39;</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">      </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="VLSM-v-chk37d" style="display: none" type="checkbox"><label class="alectryon-input" for="VLSM-v-chk37d"><span class="nb">apply</span> finite_valid_trace_singleton <span class="kr">in</span> Ht.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>message</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>X</var><span class="hyp-type"><b>: </b><span>VLSM message</span></span></span><br><span><var>TypeX</var><span><span class="hyp-body"><b>:= </b><span>type X</span></span><span class="hyp-type"><b>: </b><span>VLSMType message</span></span></span></span><br><span><var>MachineX</var><span><span class="hyp-body"><b>:= </b><span>machine X</span></span><span class="hyp-type"><b>: </b><span>VLSMMachine (vtype X)</span></span></span></span><br><span><var>l</var><span class="hyp-type"><b>: </b><span>label</span></span></span><br><span><var>s</var><span class="hyp-type"><b>: </b><span>state</span></span></span><br><span><var>im</var><span class="hyp-type"><b>: </b><span>option message</span></span></span><br><span><var>s'</var><span class="hyp-type"><b>: </b><span>state</span></span></span><br><span><var>om</var><span class="hyp-type"><b>: </b><span>option message</span></span></span><br><span><var>Ht</var><span class="hyp-type"><b>: </b><span>finite_valid_trace_from s
  [{|
     l := l;
     input := im;
     destination := s&#39;;
     output := om
   |}]</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">in_futures s s&#39;</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">      </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="VLSM-v-chk37e" style="display: none" type="checkbox"><label class="alectryon-input" for="VLSM-v-chk37e"><span class="nb">apply</span> finite_valid_trace_from_add_last <span class="kr">with</span> (f := s&#39;) <span class="kr">in</span> Ht; [|<span class="bp">reflexivity</span>].</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>message</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>X</var><span class="hyp-type"><b>: </b><span>VLSM message</span></span></span><br><span><var>TypeX</var><span><span class="hyp-body"><b>:= </b><span>type X</span></span><span class="hyp-type"><b>: </b><span>VLSMType message</span></span></span></span><br><span><var>MachineX</var><span><span class="hyp-body"><b>:= </b><span>machine X</span></span><span class="hyp-type"><b>: </b><span>VLSMMachine (vtype X)</span></span></span></span><br><span><var>l</var><span class="hyp-type"><b>: </b><span>label</span></span></span><br><span><var>s</var><span class="hyp-type"><b>: </b><span>state</span></span></span><br><span><var>im</var><span class="hyp-type"><b>: </b><span>option message</span></span></span><br><span><var>s'</var><span class="hyp-type"><b>: </b><span>state</span></span></span><br><span><var>om</var><span class="hyp-type"><b>: </b><span>option message</span></span></span><br><span><var>Ht</var><span class="hyp-type"><b>: </b><span>finite_valid_trace_from_to s s&#39;
  [{|
     l := l;
     input := im;
     destination := s&#39;;
     output := om
   |}]</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">in_futures s s&#39;</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">      </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="VLSM-v-chk37f" style="display: none" type="checkbox"><label class="alectryon-input" for="VLSM-v-chk37f"><span class="nb">eexists</span>.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>message</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>X</var><span class="hyp-type"><b>: </b><span>VLSM message</span></span></span><br><span><var>TypeX</var><span><span class="hyp-body"><b>:= </b><span>type X</span></span><span class="hyp-type"><b>: </b><span>VLSMType message</span></span></span></span><br><span><var>MachineX</var><span><span class="hyp-body"><b>:= </b><span>machine X</span></span><span class="hyp-type"><b>: </b><span>VLSMMachine (vtype X)</span></span></span></span><br><span><var>l</var><span class="hyp-type"><b>: </b><span>label</span></span></span><br><span><var>s</var><span class="hyp-type"><b>: </b><span>state</span></span></span><br><span><var>im</var><span class="hyp-type"><b>: </b><span>option message</span></span></span><br><span><var>s'</var><span class="hyp-type"><b>: </b><span>state</span></span></span><br><span><var>om</var><span class="hyp-type"><b>: </b><span>option message</span></span></span><br><span><var>Ht</var><span class="hyp-type"><b>: </b><span>finite_valid_trace_from_to s s&#39;
  [{|
     l := l;
     input := im;
     destination := s&#39;;
     output := om
   |}]</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">finite_valid_trace_from_to s s&#39; <span class="nl">?tr</span></div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="bp">exact</span> Ht.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Qed</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
</span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="VLSM-v-chk380" style="display: none" type="checkbox"><label class="alectryon-input" for="VLSM-v-chk380"><span class="kn">Lemma</span> <span class="nf">elem_of_trace_in_futures_left</span> <span class="nv">is</span> <span class="nv">s</span> <span class="nv">tr</span>
      (<span class="nv">Htr</span> : finite_valid_trace_from_to <span class="kr">is</span> s tr)
      : <span class="kr">forall</span> <span class="nv">item</span>, item ‚àà tr -&gt; in_futures (destination item) s.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>message</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>X</var><span class="hyp-type"><b>: </b><span>VLSM message</span></span></span><br><span><var>TypeX</var><span><span class="hyp-body"><b>:= </b><span>type X</span></span><span class="hyp-type"><b>: </b><span>VLSMType message</span></span></span></span><br><span><var>MachineX</var><span><span class="hyp-body"><b>:= </b><span>machine X</span></span><span class="hyp-type"><b>: </b><span>VLSMMachine (vtype X)</span></span></span></span><br><span><var>is, s</var><span class="hyp-type"><b>: </b><span>state</span></span></span><br><span><var>tr</var><span class="hyp-type"><b>: </b><span>list transition_item</span></span></span><br><span><var>Htr</var><span class="hyp-type"><b>: </b><span>finite_valid_trace_from_to <span class="kr">is</span> s tr</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="kr">‚àÄ</span> <span class="nv">item</span> : transition_item,
  item ‚àà tr ‚Üí in_futures (destination item) s</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="VLSM-v-chk381" style="display: none" type="checkbox"><label class="alectryon-input" for="VLSM-v-chk381"><span class="kn">Proof</span>.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>message</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>X</var><span class="hyp-type"><b>: </b><span>VLSM message</span></span></span><br><span><var>TypeX</var><span><span class="hyp-body"><b>:= </b><span>type X</span></span><span class="hyp-type"><b>: </b><span>VLSMType message</span></span></span></span><br><span><var>MachineX</var><span><span class="hyp-body"><b>:= </b><span>machine X</span></span><span class="hyp-type"><b>: </b><span>VLSMMachine (vtype X)</span></span></span></span><br><span><var>is, s</var><span class="hyp-type"><b>: </b><span>state</span></span></span><br><span><var>tr</var><span class="hyp-type"><b>: </b><span>list transition_item</span></span></span><br><span><var>Htr</var><span class="hyp-type"><b>: </b><span>finite_valid_trace_from_to <span class="kr">is</span> s tr</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="kr">‚àÄ</span> <span class="nv">item</span> : transition_item,
  item ‚àà tr ‚Üí in_futures (destination item) s</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">      </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="VLSM-v-chk382" style="display: none" type="checkbox"><label class="alectryon-input" for="VLSM-v-chk382"><span class="nb">intros</span> item Hitem.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>message</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>X</var><span class="hyp-type"><b>: </b><span>VLSM message</span></span></span><br><span><var>TypeX</var><span><span class="hyp-body"><b>:= </b><span>type X</span></span><span class="hyp-type"><b>: </b><span>VLSMType message</span></span></span></span><br><span><var>MachineX</var><span><span class="hyp-body"><b>:= </b><span>machine X</span></span><span class="hyp-type"><b>: </b><span>VLSMMachine (vtype X)</span></span></span></span><br><span><var>is, s</var><span class="hyp-type"><b>: </b><span>state</span></span></span><br><span><var>tr</var><span class="hyp-type"><b>: </b><span>list transition_item</span></span></span><br><span><var>Htr</var><span class="hyp-type"><b>: </b><span>finite_valid_trace_from_to <span class="kr">is</span> s tr</span></span></span><br><span><var>item</var><span class="hyp-type"><b>: </b><span>transition_item</span></span></span><br><span><var>Hitem</var><span class="hyp-type"><b>: </b><span>item ‚àà tr</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">in_futures (destination item) s</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">      </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="VLSM-v-chk383" style="display: none" type="checkbox"><label class="alectryon-input" for="VLSM-v-chk383"><span class="nb">apply</span> elem_of_list_split <span class="kr">in</span> Hitem <span class="kr">as</span> (pre &amp; suf &amp; Heqtr).</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>message</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>X</var><span class="hyp-type"><b>: </b><span>VLSM message</span></span></span><br><span><var>TypeX</var><span><span class="hyp-body"><b>:= </b><span>type X</span></span><span class="hyp-type"><b>: </b><span>VLSMType message</span></span></span></span><br><span><var>MachineX</var><span><span class="hyp-body"><b>:= </b><span>machine X</span></span><span class="hyp-type"><b>: </b><span>VLSMMachine (vtype X)</span></span></span></span><br><span><var>is, s</var><span class="hyp-type"><b>: </b><span>state</span></span></span><br><span><var>tr</var><span class="hyp-type"><b>: </b><span>list transition_item</span></span></span><br><span><var>Htr</var><span class="hyp-type"><b>: </b><span>finite_valid_trace_from_to <span class="kr">is</span> s tr</span></span></span><br><span><var>item</var><span class="hyp-type"><b>: </b><span>transition_item</span></span></span><br><span><var>pre, suf</var><span class="hyp-type"><b>: </b><span>list transition_item</span></span></span><br><span><var>Heqtr</var><span class="hyp-type"><b>: </b><span>tr = pre ++ item :: suf</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">in_futures (destination item) s</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">      </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="VLSM-v-chk384" style="display: none" type="checkbox"><label class="alectryon-input" for="VLSM-v-chk384"><span class="kr">exists</span> <span class="nv">suf</span>.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>message</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>X</var><span class="hyp-type"><b>: </b><span>VLSM message</span></span></span><br><span><var>TypeX</var><span><span class="hyp-body"><b>:= </b><span>type X</span></span><span class="hyp-type"><b>: </b><span>VLSMType message</span></span></span></span><br><span><var>MachineX</var><span><span class="hyp-body"><b>:= </b><span>machine X</span></span><span class="hyp-type"><b>: </b><span>VLSMMachine (vtype X)</span></span></span></span><br><span><var>is, s</var><span class="hyp-type"><b>: </b><span>state</span></span></span><br><span><var>tr</var><span class="hyp-type"><b>: </b><span>list transition_item</span></span></span><br><span><var>Htr</var><span class="hyp-type"><b>: </b><span>finite_valid_trace_from_to <span class="kr">is</span> s tr</span></span></span><br><span><var>item</var><span class="hyp-type"><b>: </b><span>transition_item</span></span></span><br><span><var>pre, suf</var><span class="hyp-type"><b>: </b><span>list transition_item</span></span></span><br><span><var>Heqtr</var><span class="hyp-type"><b>: </b><span>tr = pre ++ item :: suf</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">finite_valid_trace_from_to (destination item) s suf</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">      </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="VLSM-v-chk385" style="display: none" type="checkbox"><label class="alectryon-input" for="VLSM-v-chk385"><span class="nb">erewrite</span> &lt;- finite_trace_last_is_last.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>message</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>X</var><span class="hyp-type"><b>: </b><span>VLSM message</span></span></span><br><span><var>TypeX</var><span><span class="hyp-body"><b>:= </b><span>type X</span></span><span class="hyp-type"><b>: </b><span>VLSMType message</span></span></span></span><br><span><var>MachineX</var><span><span class="hyp-body"><b>:= </b><span>machine X</span></span><span class="hyp-type"><b>: </b><span>VLSMMachine (vtype X)</span></span></span></span><br><span><var>is, s</var><span class="hyp-type"><b>: </b><span>state</span></span></span><br><span><var>tr</var><span class="hyp-type"><b>: </b><span>list transition_item</span></span></span><br><span><var>Htr</var><span class="hyp-type"><b>: </b><span>finite_valid_trace_from_to <span class="kr">is</span> s tr</span></span></span><br><span><var>item</var><span class="hyp-type"><b>: </b><span>transition_item</span></span></span><br><span><var>pre, suf</var><span class="hyp-type"><b>: </b><span>list transition_item</span></span></span><br><span><var>Heqtr</var><span class="hyp-type"><b>: </b><span>tr = pre ++ item :: suf</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">finite_valid_trace_from_to
  (finite_trace_last <span class="nl">?s</span> (<span class="nl">?tl</span> ++ [item])) s suf</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">      </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="VLSM-v-chk386" style="display: none" type="checkbox"><label class="alectryon-input" for="VLSM-v-chk386"><span class="nb">eapply</span> finite_valid_trace_from_to_app_split.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>message</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>X</var><span class="hyp-type"><b>: </b><span>VLSM message</span></span></span><br><span><var>TypeX</var><span><span class="hyp-body"><b>:= </b><span>type X</span></span><span class="hyp-type"><b>: </b><span>VLSMType message</span></span></span></span><br><span><var>MachineX</var><span><span class="hyp-body"><b>:= </b><span>machine X</span></span><span class="hyp-type"><b>: </b><span>VLSMMachine (vtype X)</span></span></span></span><br><span><var>is, s</var><span class="hyp-type"><b>: </b><span>state</span></span></span><br><span><var>tr</var><span class="hyp-type"><b>: </b><span>list transition_item</span></span></span><br><span><var>Htr</var><span class="hyp-type"><b>: </b><span>finite_valid_trace_from_to <span class="kr">is</span> s tr</span></span></span><br><span><var>item</var><span class="hyp-type"><b>: </b><span>transition_item</span></span></span><br><span><var>pre, suf</var><span class="hyp-type"><b>: </b><span>list transition_item</span></span></span><br><span><var>Heqtr</var><span class="hyp-type"><b>: </b><span>tr = pre ++ item :: suf</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">finite_valid_trace_from_to <span class="nl">?s</span> s
  ((<span class="nl">?tl</span> ++ [item]) ++ suf)</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">      </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="VLSM-v-chk387" style="display: none" type="checkbox"><label class="alectryon-input" for="VLSM-v-chk387"><span class="nb">rewrite</span> &lt;- app_assoc; <span class="nb">cbn</span>; <span class="nb">rewrite</span> &lt;- Heqtr.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>message</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>X</var><span class="hyp-type"><b>: </b><span>VLSM message</span></span></span><br><span><var>TypeX</var><span><span class="hyp-body"><b>:= </b><span>type X</span></span><span class="hyp-type"><b>: </b><span>VLSMType message</span></span></span></span><br><span><var>MachineX</var><span><span class="hyp-body"><b>:= </b><span>machine X</span></span><span class="hyp-type"><b>: </b><span>VLSMMachine (vtype X)</span></span></span></span><br><span><var>is, s</var><span class="hyp-type"><b>: </b><span>state</span></span></span><br><span><var>tr</var><span class="hyp-type"><b>: </b><span>list transition_item</span></span></span><br><span><var>Htr</var><span class="hyp-type"><b>: </b><span>finite_valid_trace_from_to <span class="kr">is</span> s tr</span></span></span><br><span><var>item</var><span class="hyp-type"><b>: </b><span>transition_item</span></span></span><br><span><var>pre, suf</var><span class="hyp-type"><b>: </b><span>list transition_item</span></span></span><br><span><var>Heqtr</var><span class="hyp-type"><b>: </b><span>tr = pre ++ item :: suf</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">finite_valid_trace_from_to <span class="nl">?s</span> s tr</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">      </span><span class="alectryon-sentence"><span class="alectryon-input"><span class="bp">eassumption</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Qed</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
</span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="VLSM-v-chk388" style="display: none" type="checkbox"><label class="alectryon-input" for="VLSM-v-chk388"><span class="kn">Lemma</span> <span class="nf">elem_of_trace_in_futures_right</span> <span class="nv">is</span> <span class="nv">s</span> <span class="nv">tr</span>
      (<span class="nv">Htr</span> : finite_valid_trace_from_to <span class="kr">is</span> s tr)
      : <span class="kr">forall</span> <span class="nv">item</span>, item ‚àà tr -&gt; in_futures <span class="kr">is</span> (destination item).</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>message</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>X</var><span class="hyp-type"><b>: </b><span>VLSM message</span></span></span><br><span><var>TypeX</var><span><span class="hyp-body"><b>:= </b><span>type X</span></span><span class="hyp-type"><b>: </b><span>VLSMType message</span></span></span></span><br><span><var>MachineX</var><span><span class="hyp-body"><b>:= </b><span>machine X</span></span><span class="hyp-type"><b>: </b><span>VLSMMachine (vtype X)</span></span></span></span><br><span><var>is, s</var><span class="hyp-type"><b>: </b><span>state</span></span></span><br><span><var>tr</var><span class="hyp-type"><b>: </b><span>list transition_item</span></span></span><br><span><var>Htr</var><span class="hyp-type"><b>: </b><span>finite_valid_trace_from_to <span class="kr">is</span> s tr</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="kr">‚àÄ</span> <span class="nv">item</span> : transition_item,
  item ‚àà tr ‚Üí in_futures <span class="kr">is</span> (destination item)</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="VLSM-v-chk389" style="display: none" type="checkbox"><label class="alectryon-input" for="VLSM-v-chk389"><span class="kn">Proof</span>.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>message</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>X</var><span class="hyp-type"><b>: </b><span>VLSM message</span></span></span><br><span><var>TypeX</var><span><span class="hyp-body"><b>:= </b><span>type X</span></span><span class="hyp-type"><b>: </b><span>VLSMType message</span></span></span></span><br><span><var>MachineX</var><span><span class="hyp-body"><b>:= </b><span>machine X</span></span><span class="hyp-type"><b>: </b><span>VLSMMachine (vtype X)</span></span></span></span><br><span><var>is, s</var><span class="hyp-type"><b>: </b><span>state</span></span></span><br><span><var>tr</var><span class="hyp-type"><b>: </b><span>list transition_item</span></span></span><br><span><var>Htr</var><span class="hyp-type"><b>: </b><span>finite_valid_trace_from_to <span class="kr">is</span> s tr</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="kr">‚àÄ</span> <span class="nv">item</span> : transition_item,
  item ‚àà tr ‚Üí in_futures <span class="kr">is</span> (destination item)</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">      </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="VLSM-v-chk38a" style="display: none" type="checkbox"><label class="alectryon-input" for="VLSM-v-chk38a"><span class="nb">intros</span> item Hitem.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>message</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>X</var><span class="hyp-type"><b>: </b><span>VLSM message</span></span></span><br><span><var>TypeX</var><span><span class="hyp-body"><b>:= </b><span>type X</span></span><span class="hyp-type"><b>: </b><span>VLSMType message</span></span></span></span><br><span><var>MachineX</var><span><span class="hyp-body"><b>:= </b><span>machine X</span></span><span class="hyp-type"><b>: </b><span>VLSMMachine (vtype X)</span></span></span></span><br><span><var>is, s</var><span class="hyp-type"><b>: </b><span>state</span></span></span><br><span><var>tr</var><span class="hyp-type"><b>: </b><span>list transition_item</span></span></span><br><span><var>Htr</var><span class="hyp-type"><b>: </b><span>finite_valid_trace_from_to <span class="kr">is</span> s tr</span></span></span><br><span><var>item</var><span class="hyp-type"><b>: </b><span>transition_item</span></span></span><br><span><var>Hitem</var><span class="hyp-type"><b>: </b><span>item ‚àà tr</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">in_futures <span class="kr">is</span> (destination item)</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">      </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="VLSM-v-chk38b" style="display: none" type="checkbox"><label class="alectryon-input" for="VLSM-v-chk38b"><span class="nb">apply</span> elem_of_list_split <span class="kr">in</span> Hitem <span class="kr">as</span> (pre &amp; suf &amp; Heqtr).</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>message</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>X</var><span class="hyp-type"><b>: </b><span>VLSM message</span></span></span><br><span><var>TypeX</var><span><span class="hyp-body"><b>:= </b><span>type X</span></span><span class="hyp-type"><b>: </b><span>VLSMType message</span></span></span></span><br><span><var>MachineX</var><span><span class="hyp-body"><b>:= </b><span>machine X</span></span><span class="hyp-type"><b>: </b><span>VLSMMachine (vtype X)</span></span></span></span><br><span><var>is, s</var><span class="hyp-type"><b>: </b><span>state</span></span></span><br><span><var>tr</var><span class="hyp-type"><b>: </b><span>list transition_item</span></span></span><br><span><var>Htr</var><span class="hyp-type"><b>: </b><span>finite_valid_trace_from_to <span class="kr">is</span> s tr</span></span></span><br><span><var>item</var><span class="hyp-type"><b>: </b><span>transition_item</span></span></span><br><span><var>pre, suf</var><span class="hyp-type"><b>: </b><span>list transition_item</span></span></span><br><span><var>Heqtr</var><span class="hyp-type"><b>: </b><span>tr = pre ++ item :: suf</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">in_futures <span class="kr">is</span> (destination item)</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">      </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="VLSM-v-chk38c" style="display: none" type="checkbox"><label class="alectryon-input" for="VLSM-v-chk38c"><span class="kr">exists</span> (<span class="nv">pre</span> ++ [item]).</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>message</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>X</var><span class="hyp-type"><b>: </b><span>VLSM message</span></span></span><br><span><var>TypeX</var><span><span class="hyp-body"><b>:= </b><span>type X</span></span><span class="hyp-type"><b>: </b><span>VLSMType message</span></span></span></span><br><span><var>MachineX</var><span><span class="hyp-body"><b>:= </b><span>machine X</span></span><span class="hyp-type"><b>: </b><span>VLSMMachine (vtype X)</span></span></span></span><br><span><var>is, s</var><span class="hyp-type"><b>: </b><span>state</span></span></span><br><span><var>tr</var><span class="hyp-type"><b>: </b><span>list transition_item</span></span></span><br><span><var>Htr</var><span class="hyp-type"><b>: </b><span>finite_valid_trace_from_to <span class="kr">is</span> s tr</span></span></span><br><span><var>item</var><span class="hyp-type"><b>: </b><span>transition_item</span></span></span><br><span><var>pre, suf</var><span class="hyp-type"><b>: </b><span>list transition_item</span></span></span><br><span><var>Heqtr</var><span class="hyp-type"><b>: </b><span>tr = pre ++ item :: suf</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">finite_valid_trace_from_to <span class="kr">is</span> (destination item)
  (pre ++ [item])</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">      </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="VLSM-v-chk38d" style="display: none" type="checkbox"><label class="alectryon-input" for="VLSM-v-chk38d"><span class="nb">erewrite</span> &lt;- finite_trace_last_is_last.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>message</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>X</var><span class="hyp-type"><b>: </b><span>VLSM message</span></span></span><br><span><var>TypeX</var><span><span class="hyp-body"><b>:= </b><span>type X</span></span><span class="hyp-type"><b>: </b><span>VLSMType message</span></span></span></span><br><span><var>MachineX</var><span><span class="hyp-body"><b>:= </b><span>machine X</span></span><span class="hyp-type"><b>: </b><span>VLSMMachine (vtype X)</span></span></span></span><br><span><var>is, s</var><span class="hyp-type"><b>: </b><span>state</span></span></span><br><span><var>tr</var><span class="hyp-type"><b>: </b><span>list transition_item</span></span></span><br><span><var>Htr</var><span class="hyp-type"><b>: </b><span>finite_valid_trace_from_to <span class="kr">is</span> s tr</span></span></span><br><span><var>item</var><span class="hyp-type"><b>: </b><span>transition_item</span></span></span><br><span><var>pre, suf</var><span class="hyp-type"><b>: </b><span>list transition_item</span></span></span><br><span><var>Heqtr</var><span class="hyp-type"><b>: </b><span>tr = pre ++ item :: suf</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">finite_valid_trace_from_to <span class="kr">is</span>
  (finite_trace_last <span class="nl">?s</span> (<span class="nl">?tl</span> ++ [item]))
  (pre ++ [item])</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">      </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="VLSM-v-chk38e" style="display: none" type="checkbox"><label class="alectryon-input" for="VLSM-v-chk38e"><span class="nb">eapply</span> finite_valid_trace_from_to_app_split.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>message</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>X</var><span class="hyp-type"><b>: </b><span>VLSM message</span></span></span><br><span><var>TypeX</var><span><span class="hyp-body"><b>:= </b><span>type X</span></span><span class="hyp-type"><b>: </b><span>VLSMType message</span></span></span></span><br><span><var>MachineX</var><span><span class="hyp-body"><b>:= </b><span>machine X</span></span><span class="hyp-type"><b>: </b><span>VLSMMachine (vtype X)</span></span></span></span><br><span><var>is, s</var><span class="hyp-type"><b>: </b><span>state</span></span></span><br><span><var>tr</var><span class="hyp-type"><b>: </b><span>list transition_item</span></span></span><br><span><var>Htr</var><span class="hyp-type"><b>: </b><span>finite_valid_trace_from_to <span class="kr">is</span> s tr</span></span></span><br><span><var>item</var><span class="hyp-type"><b>: </b><span>transition_item</span></span></span><br><span><var>pre, suf</var><span class="hyp-type"><b>: </b><span>list transition_item</span></span></span><br><span><var>Heqtr</var><span class="hyp-type"><b>: </b><span>tr = pre ++ item :: suf</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">finite_valid_trace_from_to <span class="kr">is</span> <span class="nl">?f</span>
  ((pre ++ [item]) ++ <span class="nl">?ls&#39;</span>)</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">      </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="VLSM-v-chk38f" style="display: none" type="checkbox"><label class="alectryon-input" for="VLSM-v-chk38f"><span class="nb">rewrite</span> &lt;- app_assoc; <span class="nb">cbn</span>; <span class="nb">rewrite</span> &lt;- Heqtr.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>message</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>X</var><span class="hyp-type"><b>: </b><span>VLSM message</span></span></span><br><span><var>TypeX</var><span><span class="hyp-body"><b>:= </b><span>type X</span></span><span class="hyp-type"><b>: </b><span>VLSMType message</span></span></span></span><br><span><var>MachineX</var><span><span class="hyp-body"><b>:= </b><span>machine X</span></span><span class="hyp-type"><b>: </b><span>VLSMMachine (vtype X)</span></span></span></span><br><span><var>is, s</var><span class="hyp-type"><b>: </b><span>state</span></span></span><br><span><var>tr</var><span class="hyp-type"><b>: </b><span>list transition_item</span></span></span><br><span><var>Htr</var><span class="hyp-type"><b>: </b><span>finite_valid_trace_from_to <span class="kr">is</span> s tr</span></span></span><br><span><var>item</var><span class="hyp-type"><b>: </b><span>transition_item</span></span></span><br><span><var>pre, suf</var><span class="hyp-type"><b>: </b><span>list transition_item</span></span></span><br><span><var>Heqtr</var><span class="hyp-type"><b>: </b><span>tr = pre ++ item :: suf</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">finite_valid_trace_from_to <span class="kr">is</span> <span class="nl">?f</span> tr</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">      </span><span class="alectryon-sentence"><span class="alectryon-input"><span class="bp">eassumption</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Qed</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
</span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="VLSM-v-chk390" style="display: none" type="checkbox"><label class="alectryon-input" for="VLSM-v-chk390"><span class="kn">Lemma</span> <span class="nf">in_futures_witness</span>
      (<span class="nv">first</span> <span class="nv">second</span> : state)
      (<span class="nv">Hfutures</span> : in_futures <span class="kp">first</span> second)
      : <span class="kr">exists</span> (<span class="nv">tr</span> : valid_trace) (<span class="nv">n1</span> <span class="nv">n2</span> : nat),
        n1 &lt;= n2
        /\ trace_nth (proj1_sig tr) n1 = Some <span class="kp">first</span>
        /\ trace_nth (proj1_sig tr) n2 = Some second.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>message</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>X</var><span class="hyp-type"><b>: </b><span>VLSM message</span></span></span><br><span><var>TypeX</var><span><span class="hyp-body"><b>:= </b><span>type X</span></span><span class="hyp-type"><b>: </b><span>VLSMType message</span></span></span></span><br><span><var>MachineX</var><span><span class="hyp-body"><b>:= </b><span>machine X</span></span><span class="hyp-type"><b>: </b><span>VLSMMachine (vtype X)</span></span></span></span><br><span><var>first, second</var><span class="hyp-type"><b>: </b><span>state</span></span></span><br><span><var>Hfutures</var><span class="hyp-type"><b>: </b><span>in_futures <span class="kp">first</span> second</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="kr">‚àÉ</span> (<span class="nv">tr</span> : valid_trace) (<span class="nv">n1</span> <span class="nv">n2</span> : nat),
  n1 ‚â§ n2
  ‚àß trace_nth (`tr) n1 = Some <span class="kp">first</span>
    ‚àß trace_nth (`tr) n2 = Some second</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="VLSM-v-chk391" style="display: none" type="checkbox"><label class="alectryon-input" for="VLSM-v-chk391"><span class="kn">Proof</span>.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>message</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>X</var><span class="hyp-type"><b>: </b><span>VLSM message</span></span></span><br><span><var>TypeX</var><span><span class="hyp-body"><b>:= </b><span>type X</span></span><span class="hyp-type"><b>: </b><span>VLSMType message</span></span></span></span><br><span><var>MachineX</var><span><span class="hyp-body"><b>:= </b><span>machine X</span></span><span class="hyp-type"><b>: </b><span>VLSMMachine (vtype X)</span></span></span></span><br><span><var>first, second</var><span class="hyp-type"><b>: </b><span>state</span></span></span><br><span><var>Hfutures</var><span class="hyp-type"><b>: </b><span>in_futures <span class="kp">first</span> second</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="kr">‚àÉ</span> (<span class="nv">tr</span> : valid_trace) (<span class="nv">n1</span> <span class="nv">n2</span> : nat),
  n1 ‚â§ n2
  ‚àß trace_nth (`tr) n1 = Some <span class="kp">first</span>
    ‚àß trace_nth (`tr) n2 = Some second</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">      </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="VLSM-v-chk392" style="display: none" type="checkbox"><label class="alectryon-input" for="VLSM-v-chk392"><span class="nb">specialize</span> (in_futures_valid_fst <span class="kp">first</span> second Hfutures); <span class="nb">intro</span> Hps.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>message</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>X</var><span class="hyp-type"><b>: </b><span>VLSM message</span></span></span><br><span><var>TypeX</var><span><span class="hyp-body"><b>:= </b><span>type X</span></span><span class="hyp-type"><b>: </b><span>VLSMType message</span></span></span></span><br><span><var>MachineX</var><span><span class="hyp-body"><b>:= </b><span>machine X</span></span><span class="hyp-type"><b>: </b><span>VLSMMachine (vtype X)</span></span></span></span><br><span><var>first, second</var><span class="hyp-type"><b>: </b><span>state</span></span></span><br><span><var>Hfutures</var><span class="hyp-type"><b>: </b><span>in_futures <span class="kp">first</span> second</span></span></span><br><span><var>Hps</var><span class="hyp-type"><b>: </b><span>valid_state_prop <span class="kp">first</span></span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="kr">‚àÉ</span> (<span class="nv">tr</span> : valid_trace) (<span class="nv">n1</span> <span class="nv">n2</span> : nat),
  n1 ‚â§ n2
  ‚àß trace_nth (`tr) n1 = Some <span class="kp">first</span>
    ‚àß trace_nth (`tr) n2 = Some second</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">      </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="VLSM-v-chk393" style="display: none" type="checkbox"><label class="alectryon-input" for="VLSM-v-chk393"><span class="nb">apply</span> valid_state_has_trace <span class="kr">in</span> Hps.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>message</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>X</var><span class="hyp-type"><b>: </b><span>VLSM message</span></span></span><br><span><var>TypeX</var><span><span class="hyp-body"><b>:= </b><span>type X</span></span><span class="hyp-type"><b>: </b><span>VLSMType message</span></span></span></span><br><span><var>MachineX</var><span><span class="hyp-body"><b>:= </b><span>machine X</span></span><span class="hyp-type"><b>: </b><span>VLSMMachine (vtype X)</span></span></span></span><br><span><var>first, second</var><span class="hyp-type"><b>: </b><span>state</span></span></span><br><span><var>Hfutures</var><span class="hyp-type"><b>: </b><span>in_futures <span class="kp">first</span> second</span></span></span><br><span><var>Hps</var><span class="hyp-type"><b>: </b><span><span class="kr">‚àÉ</span> (<span class="nv">is</span> : state) (<span class="nv">tr</span> : list transition_item),
  finite_valid_trace_init_to <span class="kr">is</span> <span class="kp">first</span> tr</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="kr">‚àÉ</span> (<span class="nv">tr</span> : valid_trace) (<span class="nv">n1</span> <span class="nv">n2</span> : nat),
  n1 ‚â§ n2
  ‚àß trace_nth (`tr) n1 = Some <span class="kp">first</span>
    ‚àß trace_nth (`tr) n2 = Some second</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">      </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="VLSM-v-chk394" style="display: none" type="checkbox"><label class="alectryon-input" for="VLSM-v-chk394"><span class="nb">destruct</span> Hps <span class="kr">as</span> [prefix_start [prefix_tr [Hprefix_tr Hinit]]].</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>message</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>X</var><span class="hyp-type"><b>: </b><span>VLSM message</span></span></span><br><span><var>TypeX</var><span><span class="hyp-body"><b>:= </b><span>type X</span></span><span class="hyp-type"><b>: </b><span>VLSMType message</span></span></span></span><br><span><var>MachineX</var><span><span class="hyp-body"><b>:= </b><span>machine X</span></span><span class="hyp-type"><b>: </b><span>VLSMMachine (vtype X)</span></span></span></span><br><span><var>first, second</var><span class="hyp-type"><b>: </b><span>state</span></span></span><br><span><var>Hfutures</var><span class="hyp-type"><b>: </b><span>in_futures <span class="kp">first</span> second</span></span></span><br><span><var>prefix_start</var><span class="hyp-type"><b>: </b><span>state</span></span></span><br><span><var>prefix_tr</var><span class="hyp-type"><b>: </b><span>list transition_item</span></span></span><br><span><var>Hprefix_tr</var><span class="hyp-type"><b>: </b><span>finite_valid_trace_from_to prefix_start
  <span class="kp">first</span> prefix_tr</span></span></span><br><span><var>Hinit</var><span class="hyp-type"><b>: </b><span>initial_state_prop prefix_start</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="kr">‚àÉ</span> (<span class="nv">tr</span> : valid_trace) (<span class="nv">n1</span> <span class="nv">n2</span> : nat),
  n1 ‚â§ n2
  ‚àß trace_nth (`tr) n1 = Some <span class="kp">first</span>
    ‚àß trace_nth (`tr) n2 = Some second</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">      </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="VLSM-v-chk395" style="display: none" type="checkbox"><label class="alectryon-input" for="VLSM-v-chk395"><span class="nb">destruct</span> Hfutures <span class="kr">as</span> [suffix_tr Hsuffix_tr].</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>message</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>X</var><span class="hyp-type"><b>: </b><span>VLSM message</span></span></span><br><span><var>TypeX</var><span><span class="hyp-body"><b>:= </b><span>type X</span></span><span class="hyp-type"><b>: </b><span>VLSMType message</span></span></span></span><br><span><var>MachineX</var><span><span class="hyp-body"><b>:= </b><span>machine X</span></span><span class="hyp-type"><b>: </b><span>VLSMMachine (vtype X)</span></span></span></span><br><span><var>first, second</var><span class="hyp-type"><b>: </b><span>state</span></span></span><br><span><var>suffix_tr</var><span class="hyp-type"><b>: </b><span>list transition_item</span></span></span><br><span><var>Hsuffix_tr</var><span class="hyp-type"><b>: </b><span>finite_valid_trace_from_to <span class="kp">first</span> second
  suffix_tr</span></span></span><br><span><var>prefix_start</var><span class="hyp-type"><b>: </b><span>state</span></span></span><br><span><var>prefix_tr</var><span class="hyp-type"><b>: </b><span>list transition_item</span></span></span><br><span><var>Hprefix_tr</var><span class="hyp-type"><b>: </b><span>finite_valid_trace_from_to prefix_start
  <span class="kp">first</span> prefix_tr</span></span></span><br><span><var>Hinit</var><span class="hyp-type"><b>: </b><span>initial_state_prop prefix_start</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="kr">‚àÉ</span> (<span class="nv">tr</span> : valid_trace) (<span class="nv">n1</span> <span class="nv">n2</span> : nat),
  n1 ‚â§ n2
  ‚àß trace_nth (`tr) n1 = Some <span class="kp">first</span>
    ‚àß trace_nth (`tr) n2 = Some second</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">      </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="VLSM-v-chk396" style="display: none" type="checkbox"><label class="alectryon-input" for="VLSM-v-chk396"><span class="nb">specialize</span> (finite_valid_trace_from_to_app _ _ _ _ _ Hprefix_tr Hsuffix_tr) <span class="kr">as</span> Happ.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>message</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>X</var><span class="hyp-type"><b>: </b><span>VLSM message</span></span></span><br><span><var>TypeX</var><span><span class="hyp-body"><b>:= </b><span>type X</span></span><span class="hyp-type"><b>: </b><span>VLSMType message</span></span></span></span><br><span><var>MachineX</var><span><span class="hyp-body"><b>:= </b><span>machine X</span></span><span class="hyp-type"><b>: </b><span>VLSMMachine (vtype X)</span></span></span></span><br><span><var>first, second</var><span class="hyp-type"><b>: </b><span>state</span></span></span><br><span><var>suffix_tr</var><span class="hyp-type"><b>: </b><span>list transition_item</span></span></span><br><span><var>Hsuffix_tr</var><span class="hyp-type"><b>: </b><span>finite_valid_trace_from_to <span class="kp">first</span> second
  suffix_tr</span></span></span><br><span><var>prefix_start</var><span class="hyp-type"><b>: </b><span>state</span></span></span><br><span><var>prefix_tr</var><span class="hyp-type"><b>: </b><span>list transition_item</span></span></span><br><span><var>Hprefix_tr</var><span class="hyp-type"><b>: </b><span>finite_valid_trace_from_to prefix_start
  <span class="kp">first</span> prefix_tr</span></span></span><br><span><var>Hinit</var><span class="hyp-type"><b>: </b><span>initial_state_prop prefix_start</span></span></span><br><span><var>Happ</var><span class="hyp-type"><b>: </b><span>finite_valid_trace_from_to prefix_start second
  (prefix_tr ++ suffix_tr)</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="kr">‚àÉ</span> (<span class="nv">tr</span> : valid_trace) (<span class="nv">n1</span> <span class="nv">n2</span> : nat),
  n1 ‚â§ n2
  ‚àß trace_nth (`tr) n1 = Some <span class="kp">first</span>
    ‚àß trace_nth (`tr) n2 = Some second</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">      </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="VLSM-v-chk397" style="display: none" type="checkbox"><label class="alectryon-input" for="VLSM-v-chk397"><span class="nb">apply</span> finite_valid_trace_from_to_forget_last <span class="kr">in</span> Happ.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>message</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>X</var><span class="hyp-type"><b>: </b><span>VLSM message</span></span></span><br><span><var>TypeX</var><span><span class="hyp-body"><b>:= </b><span>type X</span></span><span class="hyp-type"><b>: </b><span>VLSMType message</span></span></span></span><br><span><var>MachineX</var><span><span class="hyp-body"><b>:= </b><span>machine X</span></span><span class="hyp-type"><b>: </b><span>VLSMMachine (vtype X)</span></span></span></span><br><span><var>first, second</var><span class="hyp-type"><b>: </b><span>state</span></span></span><br><span><var>suffix_tr</var><span class="hyp-type"><b>: </b><span>list transition_item</span></span></span><br><span><var>Hsuffix_tr</var><span class="hyp-type"><b>: </b><span>finite_valid_trace_from_to <span class="kp">first</span> second
  suffix_tr</span></span></span><br><span><var>prefix_start</var><span class="hyp-type"><b>: </b><span>state</span></span></span><br><span><var>prefix_tr</var><span class="hyp-type"><b>: </b><span>list transition_item</span></span></span><br><span><var>Hprefix_tr</var><span class="hyp-type"><b>: </b><span>finite_valid_trace_from_to prefix_start
  <span class="kp">first</span> prefix_tr</span></span></span><br><span><var>Hinit</var><span class="hyp-type"><b>: </b><span>initial_state_prop prefix_start</span></span></span><br><span><var>Happ</var><span class="hyp-type"><b>: </b><span>finite_valid_trace_from prefix_start
  (prefix_tr ++ suffix_tr)</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="kr">‚àÉ</span> (<span class="nv">tr</span> : valid_trace) (<span class="nv">n1</span> <span class="nv">n2</span> : nat),
  n1 ‚â§ n2
  ‚àß trace_nth (`tr) n1 = Some <span class="kp">first</span>
    ‚àß trace_nth (`tr) n2 = Some second</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">      </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="VLSM-v-chk398" style="display: none" type="checkbox"><label class="alectryon-input" for="VLSM-v-chk398"><span class="nb">assert</span> (Htr : valid_trace_prop (Finite prefix_start (prefix_tr ++ suffix_tr)))
        <span class="bp">by</span> (<span class="nb">split</span>;<span class="bp">assumption</span>).</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>message</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>X</var><span class="hyp-type"><b>: </b><span>VLSM message</span></span></span><br><span><var>TypeX</var><span><span class="hyp-body"><b>:= </b><span>type X</span></span><span class="hyp-type"><b>: </b><span>VLSMType message</span></span></span></span><br><span><var>MachineX</var><span><span class="hyp-body"><b>:= </b><span>machine X</span></span><span class="hyp-type"><b>: </b><span>VLSMMachine (vtype X)</span></span></span></span><br><span><var>first, second</var><span class="hyp-type"><b>: </b><span>state</span></span></span><br><span><var>suffix_tr</var><span class="hyp-type"><b>: </b><span>list transition_item</span></span></span><br><span><var>Hsuffix_tr</var><span class="hyp-type"><b>: </b><span>finite_valid_trace_from_to <span class="kp">first</span> second
  suffix_tr</span></span></span><br><span><var>prefix_start</var><span class="hyp-type"><b>: </b><span>state</span></span></span><br><span><var>prefix_tr</var><span class="hyp-type"><b>: </b><span>list transition_item</span></span></span><br><span><var>Hprefix_tr</var><span class="hyp-type"><b>: </b><span>finite_valid_trace_from_to prefix_start
  <span class="kp">first</span> prefix_tr</span></span></span><br><span><var>Hinit</var><span class="hyp-type"><b>: </b><span>initial_state_prop prefix_start</span></span></span><br><span><var>Happ</var><span class="hyp-type"><b>: </b><span>finite_valid_trace_from prefix_start
  (prefix_tr ++ suffix_tr)</span></span></span><br><span><var>Htr</var><span class="hyp-type"><b>: </b><span>valid_trace_prop
  (Finite prefix_start (prefix_tr ++ suffix_tr))</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="kr">‚àÉ</span> (<span class="nv">tr</span> : valid_trace) (<span class="nv">n1</span> <span class="nv">n2</span> : nat),
  n1 ‚â§ n2
  ‚àß trace_nth (`tr) n1 = Some <span class="kp">first</span>
    ‚àß trace_nth (`tr) n2 = Some second</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">      </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="VLSM-v-chk399" style="display: none" type="checkbox"><label class="alectryon-input" for="VLSM-v-chk399"><span class="kr">exists</span> (<span class="nv">exist</span> <span class="nv">_</span> <span class="nv">_</span> <span class="nv">Htr</span>).</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>message</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>X</var><span class="hyp-type"><b>: </b><span>VLSM message</span></span></span><br><span><var>TypeX</var><span><span class="hyp-body"><b>:= </b><span>type X</span></span><span class="hyp-type"><b>: </b><span>VLSMType message</span></span></span></span><br><span><var>MachineX</var><span><span class="hyp-body"><b>:= </b><span>machine X</span></span><span class="hyp-type"><b>: </b><span>VLSMMachine (vtype X)</span></span></span></span><br><span><var>first, second</var><span class="hyp-type"><b>: </b><span>state</span></span></span><br><span><var>suffix_tr</var><span class="hyp-type"><b>: </b><span>list transition_item</span></span></span><br><span><var>Hsuffix_tr</var><span class="hyp-type"><b>: </b><span>finite_valid_trace_from_to <span class="kp">first</span> second
  suffix_tr</span></span></span><br><span><var>prefix_start</var><span class="hyp-type"><b>: </b><span>state</span></span></span><br><span><var>prefix_tr</var><span class="hyp-type"><b>: </b><span>list transition_item</span></span></span><br><span><var>Hprefix_tr</var><span class="hyp-type"><b>: </b><span>finite_valid_trace_from_to prefix_start
  <span class="kp">first</span> prefix_tr</span></span></span><br><span><var>Hinit</var><span class="hyp-type"><b>: </b><span>initial_state_prop prefix_start</span></span></span><br><span><var>Happ</var><span class="hyp-type"><b>: </b><span>finite_valid_trace_from prefix_start
  (prefix_tr ++ suffix_tr)</span></span></span><br><span><var>Htr</var><span class="hyp-type"><b>: </b><span>valid_trace_prop
  (Finite prefix_start (prefix_tr ++ suffix_tr))</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="kr">‚àÉ</span> <span class="nv">n1</span> <span class="nv">n2</span> : nat,
  n1 ‚â§ n2
  ‚àß trace_nth
      (`(Finite prefix_start (prefix_tr ++ suffix_tr)
         ‚Üæ Htr)) n1 = Some <span class="kp">first</span>
    ‚àß trace_nth
        (`(Finite prefix_start
             (prefix_tr ++ suffix_tr) ‚Üæ Htr)) n2 =
      Some second</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">      </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="VLSM-v-chk39a" style="display: none" type="checkbox"><label class="alectryon-input" for="VLSM-v-chk39a"><span class="nb">simpl</span>.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>message</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>X</var><span class="hyp-type"><b>: </b><span>VLSM message</span></span></span><br><span><var>TypeX</var><span><span class="hyp-body"><b>:= </b><span>type X</span></span><span class="hyp-type"><b>: </b><span>VLSMType message</span></span></span></span><br><span><var>MachineX</var><span><span class="hyp-body"><b>:= </b><span>machine X</span></span><span class="hyp-type"><b>: </b><span>VLSMMachine (vtype X)</span></span></span></span><br><span><var>first, second</var><span class="hyp-type"><b>: </b><span>state</span></span></span><br><span><var>suffix_tr</var><span class="hyp-type"><b>: </b><span>list transition_item</span></span></span><br><span><var>Hsuffix_tr</var><span class="hyp-type"><b>: </b><span>finite_valid_trace_from_to <span class="kp">first</span> second
  suffix_tr</span></span></span><br><span><var>prefix_start</var><span class="hyp-type"><b>: </b><span>state</span></span></span><br><span><var>prefix_tr</var><span class="hyp-type"><b>: </b><span>list transition_item</span></span></span><br><span><var>Hprefix_tr</var><span class="hyp-type"><b>: </b><span>finite_valid_trace_from_to prefix_start
  <span class="kp">first</span> prefix_tr</span></span></span><br><span><var>Hinit</var><span class="hyp-type"><b>: </b><span>initial_state_prop prefix_start</span></span></span><br><span><var>Happ</var><span class="hyp-type"><b>: </b><span>finite_valid_trace_from prefix_start
  (prefix_tr ++ suffix_tr)</span></span></span><br><span><var>Htr</var><span class="hyp-type"><b>: </b><span>valid_trace_prop
  (Finite prefix_start (prefix_tr ++ suffix_tr))</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="kr">‚àÉ</span> <span class="nv">n1</span> <span class="nv">n2</span> : nat,
  n1 ‚â§ n2
  ‚àß finite_trace_nth prefix_start
      (prefix_tr ++ suffix_tr) n1 = Some <span class="kp">first</span>
    ‚àß finite_trace_nth prefix_start
        (prefix_tr ++ suffix_tr) n2 = Some second</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">      </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="VLSM-v-chk39b" style="display: none" type="checkbox"><label class="alectryon-input" for="VLSM-v-chk39b"><span class="kr">exists</span> (<span class="nv">length</span> <span class="nv">prefix_tr</span>), (length prefix_tr + length suffix_tr).</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>message</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>X</var><span class="hyp-type"><b>: </b><span>VLSM message</span></span></span><br><span><var>TypeX</var><span><span class="hyp-body"><b>:= </b><span>type X</span></span><span class="hyp-type"><b>: </b><span>VLSMType message</span></span></span></span><br><span><var>MachineX</var><span><span class="hyp-body"><b>:= </b><span>machine X</span></span><span class="hyp-type"><b>: </b><span>VLSMMachine (vtype X)</span></span></span></span><br><span><var>first, second</var><span class="hyp-type"><b>: </b><span>state</span></span></span><br><span><var>suffix_tr</var><span class="hyp-type"><b>: </b><span>list transition_item</span></span></span><br><span><var>Hsuffix_tr</var><span class="hyp-type"><b>: </b><span>finite_valid_trace_from_to <span class="kp">first</span> second
  suffix_tr</span></span></span><br><span><var>prefix_start</var><span class="hyp-type"><b>: </b><span>state</span></span></span><br><span><var>prefix_tr</var><span class="hyp-type"><b>: </b><span>list transition_item</span></span></span><br><span><var>Hprefix_tr</var><span class="hyp-type"><b>: </b><span>finite_valid_trace_from_to prefix_start
  <span class="kp">first</span> prefix_tr</span></span></span><br><span><var>Hinit</var><span class="hyp-type"><b>: </b><span>initial_state_prop prefix_start</span></span></span><br><span><var>Happ</var><span class="hyp-type"><b>: </b><span>finite_valid_trace_from prefix_start
  (prefix_tr ++ suffix_tr)</span></span></span><br><span><var>Htr</var><span class="hyp-type"><b>: </b><span>valid_trace_prop
  (Finite prefix_start (prefix_tr ++ suffix_tr))</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">length prefix_tr ‚â§ length prefix_tr + length suffix_tr
‚àß finite_trace_nth prefix_start
    (prefix_tr ++ suffix_tr) (length prefix_tr) =
  Some <span class="kp">first</span>
  ‚àß finite_trace_nth prefix_start
      (prefix_tr ++ suffix_tr)
      (length prefix_tr + length suffix_tr) =
    Some second</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">      </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="VLSM-v-chk39c" style="display: none" type="checkbox"><label class="alectryon-input" for="VLSM-v-chk39c"><span class="nb">split</span>;[<span class="bp">lia</span>|].</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>message</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>X</var><span class="hyp-type"><b>: </b><span>VLSM message</span></span></span><br><span><var>TypeX</var><span><span class="hyp-body"><b>:= </b><span>type X</span></span><span class="hyp-type"><b>: </b><span>VLSMType message</span></span></span></span><br><span><var>MachineX</var><span><span class="hyp-body"><b>:= </b><span>machine X</span></span><span class="hyp-type"><b>: </b><span>VLSMMachine (vtype X)</span></span></span></span><br><span><var>first, second</var><span class="hyp-type"><b>: </b><span>state</span></span></span><br><span><var>suffix_tr</var><span class="hyp-type"><b>: </b><span>list transition_item</span></span></span><br><span><var>Hsuffix_tr</var><span class="hyp-type"><b>: </b><span>finite_valid_trace_from_to <span class="kp">first</span> second
  suffix_tr</span></span></span><br><span><var>prefix_start</var><span class="hyp-type"><b>: </b><span>state</span></span></span><br><span><var>prefix_tr</var><span class="hyp-type"><b>: </b><span>list transition_item</span></span></span><br><span><var>Hprefix_tr</var><span class="hyp-type"><b>: </b><span>finite_valid_trace_from_to prefix_start
  <span class="kp">first</span> prefix_tr</span></span></span><br><span><var>Hinit</var><span class="hyp-type"><b>: </b><span>initial_state_prop prefix_start</span></span></span><br><span><var>Happ</var><span class="hyp-type"><b>: </b><span>finite_valid_trace_from prefix_start
  (prefix_tr ++ suffix_tr)</span></span></span><br><span><var>Htr</var><span class="hyp-type"><b>: </b><span>valid_trace_prop
  (Finite prefix_start (prefix_tr ++ suffix_tr))</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">finite_trace_nth prefix_start (prefix_tr ++ suffix_tr)
  (length prefix_tr) = Some <span class="kp">first</span>
‚àß finite_trace_nth prefix_start
    (prefix_tr ++ suffix_tr)
    (length prefix_tr + length suffix_tr) =
  Some second</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">      </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="VLSM-v-chk39d" style="display: none" type="checkbox"><label class="alectryon-input" for="VLSM-v-chk39d"><span class="nb">apply</span> finite_valid_trace_from_to_last <span class="kr">in</span> Hprefix_tr.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>message</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>X</var><span class="hyp-type"><b>: </b><span>VLSM message</span></span></span><br><span><var>TypeX</var><span><span class="hyp-body"><b>:= </b><span>type X</span></span><span class="hyp-type"><b>: </b><span>VLSMType message</span></span></span></span><br><span><var>MachineX</var><span><span class="hyp-body"><b>:= </b><span>machine X</span></span><span class="hyp-type"><b>: </b><span>VLSMMachine (vtype X)</span></span></span></span><br><span><var>first, second</var><span class="hyp-type"><b>: </b><span>state</span></span></span><br><span><var>suffix_tr</var><span class="hyp-type"><b>: </b><span>list transition_item</span></span></span><br><span><var>Hsuffix_tr</var><span class="hyp-type"><b>: </b><span>finite_valid_trace_from_to <span class="kp">first</span> second
  suffix_tr</span></span></span><br><span><var>prefix_start</var><span class="hyp-type"><b>: </b><span>state</span></span></span><br><span><var>prefix_tr</var><span class="hyp-type"><b>: </b><span>list transition_item</span></span></span><br><span><var>Hprefix_tr</var><span class="hyp-type"><b>: </b><span>finite_trace_last prefix_start prefix_tr =
<span class="kp">first</span></span></span></span><br><span><var>Hinit</var><span class="hyp-type"><b>: </b><span>initial_state_prop prefix_start</span></span></span><br><span><var>Happ</var><span class="hyp-type"><b>: </b><span>finite_valid_trace_from prefix_start
  (prefix_tr ++ suffix_tr)</span></span></span><br><span><var>Htr</var><span class="hyp-type"><b>: </b><span>valid_trace_prop
  (Finite prefix_start (prefix_tr ++ suffix_tr))</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">finite_trace_nth prefix_start (prefix_tr ++ suffix_tr)
  (length prefix_tr) = Some <span class="kp">first</span>
‚àß finite_trace_nth prefix_start
    (prefix_tr ++ suffix_tr)
    (length prefix_tr + length suffix_tr) =
  Some second</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">      </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="VLSM-v-chk39e" style="display: none" type="checkbox"><label class="alectryon-input" for="VLSM-v-chk39e"><span class="nb">apply</span> finite_valid_trace_from_to_last <span class="kr">in</span> Hsuffix_tr.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>message</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>X</var><span class="hyp-type"><b>: </b><span>VLSM message</span></span></span><br><span><var>TypeX</var><span><span class="hyp-body"><b>:= </b><span>type X</span></span><span class="hyp-type"><b>: </b><span>VLSMType message</span></span></span></span><br><span><var>MachineX</var><span><span class="hyp-body"><b>:= </b><span>machine X</span></span><span class="hyp-type"><b>: </b><span>VLSMMachine (vtype X)</span></span></span></span><br><span><var>first, second</var><span class="hyp-type"><b>: </b><span>state</span></span></span><br><span><var>suffix_tr</var><span class="hyp-type"><b>: </b><span>list transition_item</span></span></span><br><span><var>Hsuffix_tr</var><span class="hyp-type"><b>: </b><span>finite_trace_last <span class="kp">first</span> suffix_tr =
second</span></span></span><br><span><var>prefix_start</var><span class="hyp-type"><b>: </b><span>state</span></span></span><br><span><var>prefix_tr</var><span class="hyp-type"><b>: </b><span>list transition_item</span></span></span><br><span><var>Hprefix_tr</var><span class="hyp-type"><b>: </b><span>finite_trace_last prefix_start prefix_tr =
<span class="kp">first</span></span></span></span><br><span><var>Hinit</var><span class="hyp-type"><b>: </b><span>initial_state_prop prefix_start</span></span></span><br><span><var>Happ</var><span class="hyp-type"><b>: </b><span>finite_valid_trace_from prefix_start
  (prefix_tr ++ suffix_tr)</span></span></span><br><span><var>Htr</var><span class="hyp-type"><b>: </b><span>valid_trace_prop
  (Finite prefix_start (prefix_tr ++ suffix_tr))</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">finite_trace_nth prefix_start (prefix_tr ++ suffix_tr)
  (length prefix_tr) = Some <span class="kp">first</span>
‚àß finite_trace_nth prefix_start
    (prefix_tr ++ suffix_tr)
    (length prefix_tr + length suffix_tr) =
  Some second</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">      </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="VLSM-v-chk39f" style="display: none" type="checkbox"><label class="alectryon-input" for="VLSM-v-chk39f"><span class="nb">split</span>.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>message</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>X</var><span class="hyp-type"><b>: </b><span>VLSM message</span></span></span><br><span><var>TypeX</var><span><span class="hyp-body"><b>:= </b><span>type X</span></span><span class="hyp-type"><b>: </b><span>VLSMType message</span></span></span></span><br><span><var>MachineX</var><span><span class="hyp-body"><b>:= </b><span>machine X</span></span><span class="hyp-type"><b>: </b><span>VLSMMachine (vtype X)</span></span></span></span><br><span><var>first, second</var><span class="hyp-type"><b>: </b><span>state</span></span></span><br><span><var>suffix_tr</var><span class="hyp-type"><b>: </b><span>list transition_item</span></span></span><br><span><var>Hsuffix_tr</var><span class="hyp-type"><b>: </b><span>finite_trace_last <span class="kp">first</span> suffix_tr =
second</span></span></span><br><span><var>prefix_start</var><span class="hyp-type"><b>: </b><span>state</span></span></span><br><span><var>prefix_tr</var><span class="hyp-type"><b>: </b><span>list transition_item</span></span></span><br><span><var>Hprefix_tr</var><span class="hyp-type"><b>: </b><span>finite_trace_last prefix_start prefix_tr =
<span class="kp">first</span></span></span></span><br><span><var>Hinit</var><span class="hyp-type"><b>: </b><span>initial_state_prop prefix_start</span></span></span><br><span><var>Happ</var><span class="hyp-type"><b>: </b><span>finite_valid_trace_from prefix_start
  (prefix_tr ++ suffix_tr)</span></span></span><br><span><var>Htr</var><span class="hyp-type"><b>: </b><span>valid_trace_prop
  (Finite prefix_start (prefix_tr ++ suffix_tr))</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">finite_trace_nth prefix_start (prefix_tr ++ suffix_tr)
  (length prefix_tr) = Some <span class="kp">first</span></div></blockquote><div class="alectryon-extra-goals"><input class="alectryon-extra-goal-toggle" id="VLSM-v-chk3a0" style="display: none" type="checkbox"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>message</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>X</var><span class="hyp-type"><b>: </b><span>VLSM message</span></span></span><br><span><var>TypeX</var><span><span class="hyp-body"><b>:= </b><span>type X</span></span><span class="hyp-type"><b>: </b><span>VLSMType message</span></span></span></span><br><span><var>MachineX</var><span><span class="hyp-body"><b>:= </b><span>machine X</span></span><span class="hyp-type"><b>: </b><span>VLSMMachine (vtype X)</span></span></span></span><br><span><var>first, second</var><span class="hyp-type"><b>: </b><span>state</span></span></span><br><span><var>suffix_tr</var><span class="hyp-type"><b>: </b><span>list transition_item</span></span></span><br><span><var>Hsuffix_tr</var><span class="hyp-type"><b>: </b><span>finite_trace_last <span class="kp">first</span> suffix_tr =
second</span></span></span><br><span><var>prefix_start</var><span class="hyp-type"><b>: </b><span>state</span></span></span><br><span><var>prefix_tr</var><span class="hyp-type"><b>: </b><span>list transition_item</span></span></span><br><span><var>Hprefix_tr</var><span class="hyp-type"><b>: </b><span>finite_trace_last prefix_start prefix_tr =
<span class="kp">first</span></span></span></span><br><span><var>Hinit</var><span class="hyp-type"><b>: </b><span>initial_state_prop prefix_start</span></span></span><br><span><var>Happ</var><span class="hyp-type"><b>: </b><span>finite_valid_trace_from prefix_start
  (prefix_tr ++ suffix_tr)</span></span></span><br><span><var>Htr</var><span class="hyp-type"><b>: </b><span>valid_trace_prop
  (Finite prefix_start (prefix_tr ++ suffix_tr))</span></span></span><br></div><label class="goal-separator" for="VLSM-v-chk3a0"><hr></label><div class="goal-conclusion">finite_trace_nth prefix_start 
  (prefix_tr ++ suffix_tr)
  (length prefix_tr + length suffix_tr) = 
Some second</div></blockquote></div></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">      </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="VLSM-v-chk3a1" style="display: none" type="checkbox"><label class="alectryon-input" for="VLSM-v-chk3a1">-</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>message</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>X</var><span class="hyp-type"><b>: </b><span>VLSM message</span></span></span><br><span><var>TypeX</var><span><span class="hyp-body"><b>:= </b><span>type X</span></span><span class="hyp-type"><b>: </b><span>VLSMType message</span></span></span></span><br><span><var>MachineX</var><span><span class="hyp-body"><b>:= </b><span>machine X</span></span><span class="hyp-type"><b>: </b><span>VLSMMachine (vtype X)</span></span></span></span><br><span><var>first, second</var><span class="hyp-type"><b>: </b><span>state</span></span></span><br><span><var>suffix_tr</var><span class="hyp-type"><b>: </b><span>list transition_item</span></span></span><br><span><var>Hsuffix_tr</var><span class="hyp-type"><b>: </b><span>finite_trace_last <span class="kp">first</span> suffix_tr =
second</span></span></span><br><span><var>prefix_start</var><span class="hyp-type"><b>: </b><span>state</span></span></span><br><span><var>prefix_tr</var><span class="hyp-type"><b>: </b><span>list transition_item</span></span></span><br><span><var>Hprefix_tr</var><span class="hyp-type"><b>: </b><span>finite_trace_last prefix_start prefix_tr =
<span class="kp">first</span></span></span></span><br><span><var>Hinit</var><span class="hyp-type"><b>: </b><span>initial_state_prop prefix_start</span></span></span><br><span><var>Happ</var><span class="hyp-type"><b>: </b><span>finite_valid_trace_from prefix_start
  (prefix_tr ++ suffix_tr)</span></span></span><br><span><var>Htr</var><span class="hyp-type"><b>: </b><span>valid_trace_prop
  (Finite prefix_start (prefix_tr ++ suffix_tr))</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">finite_trace_nth prefix_start (prefix_tr ++ suffix_tr)
  (length prefix_tr) = Some <span class="kp">first</span></div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="VLSM-v-chk3a2" style="display: none" type="checkbox"><label class="alectryon-input" for="VLSM-v-chk3a2"><span class="nb">rewrite</span> finite_trace_nth_app1;[|<span class="bp">lia</span>].</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>message</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>X</var><span class="hyp-type"><b>: </b><span>VLSM message</span></span></span><br><span><var>TypeX</var><span><span class="hyp-body"><b>:= </b><span>type X</span></span><span class="hyp-type"><b>: </b><span>VLSMType message</span></span></span></span><br><span><var>MachineX</var><span><span class="hyp-body"><b>:= </b><span>machine X</span></span><span class="hyp-type"><b>: </b><span>VLSMMachine (vtype X)</span></span></span></span><br><span><var>first, second</var><span class="hyp-type"><b>: </b><span>state</span></span></span><br><span><var>suffix_tr</var><span class="hyp-type"><b>: </b><span>list transition_item</span></span></span><br><span><var>Hsuffix_tr</var><span class="hyp-type"><b>: </b><span>finite_trace_last <span class="kp">first</span> suffix_tr =
second</span></span></span><br><span><var>prefix_start</var><span class="hyp-type"><b>: </b><span>state</span></span></span><br><span><var>prefix_tr</var><span class="hyp-type"><b>: </b><span>list transition_item</span></span></span><br><span><var>Hprefix_tr</var><span class="hyp-type"><b>: </b><span>finite_trace_last prefix_start prefix_tr =
<span class="kp">first</span></span></span></span><br><span><var>Hinit</var><span class="hyp-type"><b>: </b><span>initial_state_prop prefix_start</span></span></span><br><span><var>Happ</var><span class="hyp-type"><b>: </b><span>finite_valid_trace_from prefix_start
  (prefix_tr ++ suffix_tr)</span></span></span><br><span><var>Htr</var><span class="hyp-type"><b>: </b><span>valid_trace_prop
  (Finite prefix_start (prefix_tr ++ suffix_tr))</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">finite_trace_nth prefix_start prefix_tr
  (length prefix_tr) = Some <span class="kp">first</span></div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">        </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="VLSM-v-chk3a3" style="display: none" type="checkbox"><label class="alectryon-input" for="VLSM-v-chk3a3"><span class="nb">rewrite</span> finite_trace_nth_last.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>message</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>X</var><span class="hyp-type"><b>: </b><span>VLSM message</span></span></span><br><span><var>TypeX</var><span><span class="hyp-body"><b>:= </b><span>type X</span></span><span class="hyp-type"><b>: </b><span>VLSMType message</span></span></span></span><br><span><var>MachineX</var><span><span class="hyp-body"><b>:= </b><span>machine X</span></span><span class="hyp-type"><b>: </b><span>VLSMMachine (vtype X)</span></span></span></span><br><span><var>first, second</var><span class="hyp-type"><b>: </b><span>state</span></span></span><br><span><var>suffix_tr</var><span class="hyp-type"><b>: </b><span>list transition_item</span></span></span><br><span><var>Hsuffix_tr</var><span class="hyp-type"><b>: </b><span>finite_trace_last <span class="kp">first</span> suffix_tr =
second</span></span></span><br><span><var>prefix_start</var><span class="hyp-type"><b>: </b><span>state</span></span></span><br><span><var>prefix_tr</var><span class="hyp-type"><b>: </b><span>list transition_item</span></span></span><br><span><var>Hprefix_tr</var><span class="hyp-type"><b>: </b><span>finite_trace_last prefix_start prefix_tr =
<span class="kp">first</span></span></span></span><br><span><var>Hinit</var><span class="hyp-type"><b>: </b><span>initial_state_prop prefix_start</span></span></span><br><span><var>Happ</var><span class="hyp-type"><b>: </b><span>finite_valid_trace_from prefix_start
  (prefix_tr ++ suffix_tr)</span></span></span><br><span><var>Htr</var><span class="hyp-type"><b>: </b><span>valid_trace_prop
  (Finite prefix_start (prefix_tr ++ suffix_tr))</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">Some (finite_trace_last prefix_start prefix_tr) =
Some <span class="kp">first</span></div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">        </span><span class="alectryon-sentence"><span class="alectryon-input"><span class="bp">congruence</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">      </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="VLSM-v-chk3a4" style="display: none" type="checkbox"><label class="alectryon-input" for="VLSM-v-chk3a4">-</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>message</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>X</var><span class="hyp-type"><b>: </b><span>VLSM message</span></span></span><br><span><var>TypeX</var><span><span class="hyp-body"><b>:= </b><span>type X</span></span><span class="hyp-type"><b>: </b><span>VLSMType message</span></span></span></span><br><span><var>MachineX</var><span><span class="hyp-body"><b>:= </b><span>machine X</span></span><span class="hyp-type"><b>: </b><span>VLSMMachine (vtype X)</span></span></span></span><br><span><var>first, second</var><span class="hyp-type"><b>: </b><span>state</span></span></span><br><span><var>suffix_tr</var><span class="hyp-type"><b>: </b><span>list transition_item</span></span></span><br><span><var>Hsuffix_tr</var><span class="hyp-type"><b>: </b><span>finite_trace_last <span class="kp">first</span> suffix_tr =
second</span></span></span><br><span><var>prefix_start</var><span class="hyp-type"><b>: </b><span>state</span></span></span><br><span><var>prefix_tr</var><span class="hyp-type"><b>: </b><span>list transition_item</span></span></span><br><span><var>Hprefix_tr</var><span class="hyp-type"><b>: </b><span>finite_trace_last prefix_start prefix_tr =
<span class="kp">first</span></span></span></span><br><span><var>Hinit</var><span class="hyp-type"><b>: </b><span>initial_state_prop prefix_start</span></span></span><br><span><var>Happ</var><span class="hyp-type"><b>: </b><span>finite_valid_trace_from prefix_start
  (prefix_tr ++ suffix_tr)</span></span></span><br><span><var>Htr</var><span class="hyp-type"><b>: </b><span>valid_trace_prop
  (Finite prefix_start (prefix_tr ++ suffix_tr))</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">finite_trace_nth prefix_start (prefix_tr ++ suffix_tr)
  (length prefix_tr + length suffix_tr) = Some second</div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="VLSM-v-chk3a5" style="display: none" type="checkbox"><label class="alectryon-input" for="VLSM-v-chk3a5"><span class="nb">rewrite</span> finite_trace_nth_app2;[|<span class="bp">lia</span>].</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>message</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>X</var><span class="hyp-type"><b>: </b><span>VLSM message</span></span></span><br><span><var>TypeX</var><span><span class="hyp-body"><b>:= </b><span>type X</span></span><span class="hyp-type"><b>: </b><span>VLSMType message</span></span></span></span><br><span><var>MachineX</var><span><span class="hyp-body"><b>:= </b><span>machine X</span></span><span class="hyp-type"><b>: </b><span>VLSMMachine (vtype X)</span></span></span></span><br><span><var>first, second</var><span class="hyp-type"><b>: </b><span>state</span></span></span><br><span><var>suffix_tr</var><span class="hyp-type"><b>: </b><span>list transition_item</span></span></span><br><span><var>Hsuffix_tr</var><span class="hyp-type"><b>: </b><span>finite_trace_last <span class="kp">first</span> suffix_tr =
second</span></span></span><br><span><var>prefix_start</var><span class="hyp-type"><b>: </b><span>state</span></span></span><br><span><var>prefix_tr</var><span class="hyp-type"><b>: </b><span>list transition_item</span></span></span><br><span><var>Hprefix_tr</var><span class="hyp-type"><b>: </b><span>finite_trace_last prefix_start prefix_tr =
<span class="kp">first</span></span></span></span><br><span><var>Hinit</var><span class="hyp-type"><b>: </b><span>initial_state_prop prefix_start</span></span></span><br><span><var>Happ</var><span class="hyp-type"><b>: </b><span>finite_valid_trace_from prefix_start
  (prefix_tr ++ suffix_tr)</span></span></span><br><span><var>Htr</var><span class="hyp-type"><b>: </b><span>valid_trace_prop
  (Finite prefix_start (prefix_tr ++ suffix_tr))</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">finite_trace_nth
  (finite_trace_last prefix_start prefix_tr) suffix_tr
  (length prefix_tr + length suffix_tr -
   length prefix_tr) = Some second</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">        </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="VLSM-v-chk3a6" style="display: none" type="checkbox"><label class="alectryon-input" for="VLSM-v-chk3a6"><span class="nb">rewrite</span> Minus.minus_plus.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>message</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>X</var><span class="hyp-type"><b>: </b><span>VLSM message</span></span></span><br><span><var>TypeX</var><span><span class="hyp-body"><b>:= </b><span>type X</span></span><span class="hyp-type"><b>: </b><span>VLSMType message</span></span></span></span><br><span><var>MachineX</var><span><span class="hyp-body"><b>:= </b><span>machine X</span></span><span class="hyp-type"><b>: </b><span>VLSMMachine (vtype X)</span></span></span></span><br><span><var>first, second</var><span class="hyp-type"><b>: </b><span>state</span></span></span><br><span><var>suffix_tr</var><span class="hyp-type"><b>: </b><span>list transition_item</span></span></span><br><span><var>Hsuffix_tr</var><span class="hyp-type"><b>: </b><span>finite_trace_last <span class="kp">first</span> suffix_tr =
second</span></span></span><br><span><var>prefix_start</var><span class="hyp-type"><b>: </b><span>state</span></span></span><br><span><var>prefix_tr</var><span class="hyp-type"><b>: </b><span>list transition_item</span></span></span><br><span><var>Hprefix_tr</var><span class="hyp-type"><b>: </b><span>finite_trace_last prefix_start prefix_tr =
<span class="kp">first</span></span></span></span><br><span><var>Hinit</var><span class="hyp-type"><b>: </b><span>initial_state_prop prefix_start</span></span></span><br><span><var>Happ</var><span class="hyp-type"><b>: </b><span>finite_valid_trace_from prefix_start
  (prefix_tr ++ suffix_tr)</span></span></span><br><span><var>Htr</var><span class="hyp-type"><b>: </b><span>valid_trace_prop
  (Finite prefix_start (prefix_tr ++ suffix_tr))</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">finite_trace_nth
  (finite_trace_last prefix_start prefix_tr) suffix_tr
  (length suffix_tr) = Some second</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">        </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="VLSM-v-chk3a7" style="display: none" type="checkbox"><label class="alectryon-input" for="VLSM-v-chk3a7"><span class="nb">rewrite</span> finite_trace_nth_last.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>message</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>X</var><span class="hyp-type"><b>: </b><span>VLSM message</span></span></span><br><span><var>TypeX</var><span><span class="hyp-body"><b>:= </b><span>type X</span></span><span class="hyp-type"><b>: </b><span>VLSMType message</span></span></span></span><br><span><var>MachineX</var><span><span class="hyp-body"><b>:= </b><span>machine X</span></span><span class="hyp-type"><b>: </b><span>VLSMMachine (vtype X)</span></span></span></span><br><span><var>first, second</var><span class="hyp-type"><b>: </b><span>state</span></span></span><br><span><var>suffix_tr</var><span class="hyp-type"><b>: </b><span>list transition_item</span></span></span><br><span><var>Hsuffix_tr</var><span class="hyp-type"><b>: </b><span>finite_trace_last <span class="kp">first</span> suffix_tr =
second</span></span></span><br><span><var>prefix_start</var><span class="hyp-type"><b>: </b><span>state</span></span></span><br><span><var>prefix_tr</var><span class="hyp-type"><b>: </b><span>list transition_item</span></span></span><br><span><var>Hprefix_tr</var><span class="hyp-type"><b>: </b><span>finite_trace_last prefix_start prefix_tr =
<span class="kp">first</span></span></span></span><br><span><var>Hinit</var><span class="hyp-type"><b>: </b><span>initial_state_prop prefix_start</span></span></span><br><span><var>Happ</var><span class="hyp-type"><b>: </b><span>finite_valid_trace_from prefix_start
  (prefix_tr ++ suffix_tr)</span></span></span><br><span><var>Htr</var><span class="hyp-type"><b>: </b><span>valid_trace_prop
  (Finite prefix_start (prefix_tr ++ suffix_tr))</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">Some
  (finite_trace_last
     (finite_trace_last prefix_start prefix_tr)
     suffix_tr) = Some second</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">        </span><span class="alectryon-sentence"><span class="alectryon-input"><span class="bp">congruence</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Qed</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
</span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Definition</span> <span class="nf">trace_segment</span>
      (<span class="nv">tr</span> : Trace)
      (<span class="nv">n1</span> <span class="nv">n2</span> : nat)
      : list transition_item
      := <span class="kr">match</span> tr <span class="kr">with</span>
      | Finite s l =&gt; list_segment l n1 n2
      | Infinite s l =&gt; stream_segment l n1 n2
      <span class="kr">end</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
</span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="VLSM-v-chk3a8" style="display: none" type="checkbox"><label class="alectryon-input" for="VLSM-v-chk3a8"><span class="kn">Lemma</span> <span class="nf">valid_trace_segment</span>
      (<span class="nv">tr</span> : Trace)
      (<span class="nv">Htr</span> : valid_trace_prop tr)
      (<span class="nv">n1</span> <span class="nv">n2</span> : nat)
      (<span class="nv">Hle</span> : n1 &lt;= n2)
      (<span class="nv">first</span> : state)
      (<span class="nv">Hfirst</span> : trace_nth tr n1 = Some <span class="kp">first</span>)
      : finite_valid_trace_from <span class="kp">first</span> (trace_segment tr n1 n2).</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>message</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>X</var><span class="hyp-type"><b>: </b><span>VLSM message</span></span></span><br><span><var>TypeX</var><span><span class="hyp-body"><b>:= </b><span>type X</span></span><span class="hyp-type"><b>: </b><span>VLSMType message</span></span></span></span><br><span><var>MachineX</var><span><span class="hyp-body"><b>:= </b><span>machine X</span></span><span class="hyp-type"><b>: </b><span>VLSMMachine (vtype X)</span></span></span></span><br><span><var>tr</var><span class="hyp-type"><b>: </b><span>Trace</span></span></span><br><span><var>Htr</var><span class="hyp-type"><b>: </b><span>valid_trace_prop tr</span></span></span><br><span><var>n1, n2</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>Hle</var><span class="hyp-type"><b>: </b><span>n1 ‚â§ n2</span></span></span><br><span><var>first</var><span class="hyp-type"><b>: </b><span>state</span></span></span><br><span><var>Hfirst</var><span class="hyp-type"><b>: </b><span>trace_nth tr n1 = Some <span class="kp">first</span></span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">finite_valid_trace_from <span class="kp">first</span> (trace_segment tr n1 n2)</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="VLSM-v-chk3a9" style="display: none" type="checkbox"><label class="alectryon-input" for="VLSM-v-chk3a9"><span class="kn">Proof</span>.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>message</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>X</var><span class="hyp-type"><b>: </b><span>VLSM message</span></span></span><br><span><var>TypeX</var><span><span class="hyp-body"><b>:= </b><span>type X</span></span><span class="hyp-type"><b>: </b><span>VLSMType message</span></span></span></span><br><span><var>MachineX</var><span><span class="hyp-body"><b>:= </b><span>machine X</span></span><span class="hyp-type"><b>: </b><span>VLSMMachine (vtype X)</span></span></span></span><br><span><var>tr</var><span class="hyp-type"><b>: </b><span>Trace</span></span></span><br><span><var>Htr</var><span class="hyp-type"><b>: </b><span>valid_trace_prop tr</span></span></span><br><span><var>n1, n2</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>Hle</var><span class="hyp-type"><b>: </b><span>n1 ‚â§ n2</span></span></span><br><span><var>first</var><span class="hyp-type"><b>: </b><span>state</span></span></span><br><span><var>Hfirst</var><span class="hyp-type"><b>: </b><span>trace_nth tr n1 = Some <span class="kp">first</span></span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">finite_valid_trace_from <span class="kp">first</span> (trace_segment tr n1 n2)</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">      </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="VLSM-v-chk3aa" style="display: none" type="checkbox"><label class="alectryon-input" for="VLSM-v-chk3aa"><span class="nb">destruct</span> tr <span class="kr">as</span> [s tr | s tr]; <span class="nb">simpl</span> <span class="kr">in</span> *; <span class="nb">destruct</span> Htr <span class="kr">as</span> [Htr Hinit].</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>message</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>X</var><span class="hyp-type"><b>: </b><span>VLSM message</span></span></span><br><span><var>TypeX</var><span><span class="hyp-body"><b>:= </b><span>type X</span></span><span class="hyp-type"><b>: </b><span>VLSMType message</span></span></span></span><br><span><var>MachineX</var><span><span class="hyp-body"><b>:= </b><span>machine X</span></span><span class="hyp-type"><b>: </b><span>VLSMMachine (vtype X)</span></span></span></span><br><span><var>s</var><span class="hyp-type"><b>: </b><span>state</span></span></span><br><span><var>tr</var><span class="hyp-type"><b>: </b><span>list transition_item</span></span></span><br><span><var>Htr</var><span class="hyp-type"><b>: </b><span>finite_valid_trace_from s tr</span></span></span><br><span><var>Hinit</var><span class="hyp-type"><b>: </b><span>initial_state_prop s</span></span></span><br><span><var>n1, n2</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>Hle</var><span class="hyp-type"><b>: </b><span>n1 ‚â§ n2</span></span></span><br><span><var>first</var><span class="hyp-type"><b>: </b><span>state</span></span></span><br><span><var>Hfirst</var><span class="hyp-type"><b>: </b><span>finite_trace_nth s tr n1 = Some <span class="kp">first</span></span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">finite_valid_trace_from <span class="kp">first</span> (list_segment tr n1 n2)</div></blockquote><div class="alectryon-extra-goals"><input class="alectryon-extra-goal-toggle" id="VLSM-v-chk3ab" style="display: none" type="checkbox"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>message</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>X</var><span class="hyp-type"><b>: </b><span>VLSM message</span></span></span><br><span><var>TypeX</var><span><span class="hyp-body"><b>:= </b><span>type X</span></span><span class="hyp-type"><b>: </b><span>VLSMType message</span></span></span></span><br><span><var>MachineX</var><span><span class="hyp-body"><b>:= </b><span>machine X</span></span><span class="hyp-type"><b>: </b><span>VLSMMachine (vtype X)</span></span></span></span><br><span><var>s</var><span class="hyp-type"><b>: </b><span>state</span></span></span><br><span><var>tr</var><span class="hyp-type"><b>: </b><span>Stream transition_item</span></span></span><br><span><var>Htr</var><span class="hyp-type"><b>: </b><span>infinite_valid_trace_from s tr</span></span></span><br><span><var>Hinit</var><span class="hyp-type"><b>: </b><span>initial_state_prop s</span></span></span><br><span><var>n1, n2</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>Hle</var><span class="hyp-type"><b>: </b><span>n1 ‚â§ n2</span></span></span><br><span><var>first</var><span class="hyp-type"><b>: </b><span>state</span></span></span><br><span><var>Hfirst</var><span class="hyp-type"><b>: </b><span>Some
  (Str_nth n1 (Cons s (map destination tr))) =
Some <span class="kp">first</span></span></span></span><br></div><label class="goal-separator" for="VLSM-v-chk3ab"><hr></label><div class="goal-conclusion">finite_valid_trace_from <span class="kp">first</span>
  (stream_segment tr n1 n2)</div></blockquote></div></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">      </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="VLSM-v-chk3ac" style="display: none" type="checkbox"><label class="alectryon-input" for="VLSM-v-chk3ac">-</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>message</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>X</var><span class="hyp-type"><b>: </b><span>VLSM message</span></span></span><br><span><var>TypeX</var><span><span class="hyp-body"><b>:= </b><span>type X</span></span><span class="hyp-type"><b>: </b><span>VLSMType message</span></span></span></span><br><span><var>MachineX</var><span><span class="hyp-body"><b>:= </b><span>machine X</span></span><span class="hyp-type"><b>: </b><span>VLSMMachine (vtype X)</span></span></span></span><br><span><var>s</var><span class="hyp-type"><b>: </b><span>state</span></span></span><br><span><var>tr</var><span class="hyp-type"><b>: </b><span>list transition_item</span></span></span><br><span><var>Htr</var><span class="hyp-type"><b>: </b><span>finite_valid_trace_from s tr</span></span></span><br><span><var>Hinit</var><span class="hyp-type"><b>: </b><span>initial_state_prop s</span></span></span><br><span><var>n1, n2</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>Hle</var><span class="hyp-type"><b>: </b><span>n1 ‚â§ n2</span></span></span><br><span><var>first</var><span class="hyp-type"><b>: </b><span>state</span></span></span><br><span><var>Hfirst</var><span class="hyp-type"><b>: </b><span>finite_trace_nth s tr n1 = Some <span class="kp">first</span></span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">finite_valid_trace_from <span class="kp">first</span> (list_segment tr n1 n2)</div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="nb">apply</span> finite_valid_trace_from_segment <span class="kr">with</span> s; <span class="kp">try</span> <span class="bp">assumption</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">      </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="VLSM-v-chk3ad" style="display: none" type="checkbox"><label class="alectryon-input" for="VLSM-v-chk3ad">-</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>message</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>X</var><span class="hyp-type"><b>: </b><span>VLSM message</span></span></span><br><span><var>TypeX</var><span><span class="hyp-body"><b>:= </b><span>type X</span></span><span class="hyp-type"><b>: </b><span>VLSMType message</span></span></span></span><br><span><var>MachineX</var><span><span class="hyp-body"><b>:= </b><span>machine X</span></span><span class="hyp-type"><b>: </b><span>VLSMMachine (vtype X)</span></span></span></span><br><span><var>s</var><span class="hyp-type"><b>: </b><span>state</span></span></span><br><span><var>tr</var><span class="hyp-type"><b>: </b><span>Stream transition_item</span></span></span><br><span><var>Htr</var><span class="hyp-type"><b>: </b><span>infinite_valid_trace_from s tr</span></span></span><br><span><var>Hinit</var><span class="hyp-type"><b>: </b><span>initial_state_prop s</span></span></span><br><span><var>n1, n2</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>Hle</var><span class="hyp-type"><b>: </b><span>n1 ‚â§ n2</span></span></span><br><span><var>first</var><span class="hyp-type"><b>: </b><span>state</span></span></span><br><span><var>Hfirst</var><span class="hyp-type"><b>: </b><span>Some
  (Str_nth n1 (Cons s (map destination tr))) =
Some <span class="kp">first</span></span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">finite_valid_trace_from <span class="kp">first</span>
  (stream_segment tr n1 n2)</div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="VLSM-v-chk3ae" style="display: none" type="checkbox"><label class="alectryon-input" for="VLSM-v-chk3ae"><span class="nb">inversion</span> Hfirst; <span class="nb">subst</span>; <span class="nb">clear</span> Hfirst.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>message</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>X</var><span class="hyp-type"><b>: </b><span>VLSM message</span></span></span><br><span><var>TypeX</var><span><span class="hyp-body"><b>:= </b><span>type X</span></span><span class="hyp-type"><b>: </b><span>VLSMType message</span></span></span></span><br><span><var>MachineX</var><span><span class="hyp-body"><b>:= </b><span>machine X</span></span><span class="hyp-type"><b>: </b><span>VLSMMachine (vtype X)</span></span></span></span><br><span><var>s</var><span class="hyp-type"><b>: </b><span>state</span></span></span><br><span><var>tr</var><span class="hyp-type"><b>: </b><span>Stream transition_item</span></span></span><br><span><var>Htr</var><span class="hyp-type"><b>: </b><span>infinite_valid_trace_from s tr</span></span></span><br><span><var>Hinit</var><span class="hyp-type"><b>: </b><span>initial_state_prop s</span></span></span><br><span><var>n1, n2</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>Hle</var><span class="hyp-type"><b>: </b><span>n1 ‚â§ n2</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">finite_valid_trace_from
  (Str_nth n1 (Cons s (map destination tr)))
  (stream_segment tr n1 n2)</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">        </span><span class="alectryon-sentence"><span class="alectryon-input"><span class="nb">apply</span> (infinite_valid_trace_from_segment s tr Htr n1 n2 Hle).</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Qed</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
</span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Inductive</span> <span class="nf">Trace_messages</span> : <span class="kt">Type</span> :=
    | Finite_messages : list (option message) -&gt; Trace_messages
    | Infinite_messages : Stream (option message) -&gt; Trace_messages.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
</span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Definition</span> <span class="nf">protocol_output_messages_trace</span> (<span class="nv">tr</span> : valid_trace) : Trace_messages :=
      <span class="kr">match</span> proj1_sig tr <span class="kr">with</span>
      | Finite _ ls =&gt; Finite_messages (List.map output ls)
      | Infinite _ st =&gt; Infinite_messages (map output st) <span class="kr">end</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
</span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Definition</span> <span class="nf">protocol_input_messages_trace</span> (<span class="nv">tr</span> : valid_trace) : Trace_messages :=
      <span class="kr">match</span> proj1_sig tr <span class="kr">with</span>
      | Finite _ ls =&gt; Finite_messages (List.map input ls)
      | Infinite _ st =&gt; Infinite_messages (map input st) <span class="kr">end</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
</span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Definition</span> <span class="nf">trace_prefix</span>
               (<span class="nv">tr</span> : Trace)
               (<span class="nv">last</span> : transition_item)
               (<span class="nv">prefix</span> : list transition_item)
      :=
        <span class="kr">match</span> tr <span class="kr">with</span>
        | Finite s ls =&gt; <span class="kr">exists</span> <span class="nv">suffix</span>, ls = prefix ++ (<span class="nb">last</span> :: suffix)
        | Infinite s st =&gt; <span class="kr">exists</span> <span class="nv">suffix</span>, st = stream_app prefix (Cons <span class="nb">last</span> suffix)
        <span class="kr">end</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
</span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Definition</span> <span class="nf">trace_prefix_fn</span>
      (<span class="nv">tr</span> : Trace)
      (<span class="nv">n</span> : nat)
      : Trace
      :=
      <span class="kr">match</span> tr <span class="kr">with</span>
      | Finite s ls =&gt; Finite s (list_prefix ls n)
      | Infinite s st =&gt; Finite s (stream_prefix st n)
      <span class="kr">end</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
</span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="VLSM-v-chk3af" style="display: none" type="checkbox"><label class="alectryon-input" for="VLSM-v-chk3af"><span class="kn">Lemma</span> <span class="nf">trace_prefix_valid</span>
          (<span class="nv">tr</span> : valid_trace)
          (<span class="nv">last</span> : transition_item)
          (<span class="nv">prefix</span> : list transition_item)
          (<span class="nv">Hprefix</span> : trace_prefix (proj1_sig tr) <span class="nb">last</span> prefix)
      : valid_trace_prop (Finite (trace_first (proj1_sig tr)) (prefix ++ [<span class="nb">last</span>])).</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>message</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>X</var><span class="hyp-type"><b>: </b><span>VLSM message</span></span></span><br><span><var>TypeX</var><span><span class="hyp-body"><b>:= </b><span>type X</span></span><span class="hyp-type"><b>: </b><span>VLSMType message</span></span></span></span><br><span><var>MachineX</var><span><span class="hyp-body"><b>:= </b><span>machine X</span></span><span class="hyp-type"><b>: </b><span>VLSMMachine (vtype X)</span></span></span></span><br><span><var>tr</var><span class="hyp-type"><b>: </b><span>valid_trace</span></span></span><br><span><var>last</var><span class="hyp-type"><b>: </b><span>transition_item</span></span></span><br><span><var>prefix</var><span class="hyp-type"><b>: </b><span>list transition_item</span></span></span><br><span><var>Hprefix</var><span class="hyp-type"><b>: </b><span>trace_prefix (`tr) <span class="nb">last</span> prefix</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">valid_trace_prop
  (Finite (trace_first (`tr)) (prefix ++ [<span class="nb">last</span>]))</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="VLSM-v-chk3b0" style="display: none" type="checkbox"><label class="alectryon-input" for="VLSM-v-chk3b0"><span class="kn">Proof</span>.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>message</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>X</var><span class="hyp-type"><b>: </b><span>VLSM message</span></span></span><br><span><var>TypeX</var><span><span class="hyp-body"><b>:= </b><span>type X</span></span><span class="hyp-type"><b>: </b><span>VLSMType message</span></span></span></span><br><span><var>MachineX</var><span><span class="hyp-body"><b>:= </b><span>machine X</span></span><span class="hyp-type"><b>: </b><span>VLSMMachine (vtype X)</span></span></span></span><br><span><var>tr</var><span class="hyp-type"><b>: </b><span>valid_trace</span></span></span><br><span><var>last</var><span class="hyp-type"><b>: </b><span>transition_item</span></span></span><br><span><var>prefix</var><span class="hyp-type"><b>: </b><span>list transition_item</span></span></span><br><span><var>Hprefix</var><span class="hyp-type"><b>: </b><span>trace_prefix (`tr) <span class="nb">last</span> prefix</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">valid_trace_prop
  (Finite (trace_first (`tr)) (prefix ++ [<span class="nb">last</span>]))</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">      </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="VLSM-v-chk3b1" style="display: none" type="checkbox"><label class="alectryon-input" for="VLSM-v-chk3b1"><span class="nb">destruct</span> tr <span class="kr">as</span> [tr Htr].</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>message</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>X</var><span class="hyp-type"><b>: </b><span>VLSM message</span></span></span><br><span><var>TypeX</var><span><span class="hyp-body"><b>:= </b><span>type X</span></span><span class="hyp-type"><b>: </b><span>VLSMType message</span></span></span></span><br><span><var>MachineX</var><span><span class="hyp-body"><b>:= </b><span>machine X</span></span><span class="hyp-type"><b>: </b><span>VLSMMachine (vtype X)</span></span></span></span><br><span><var>tr</var><span class="hyp-type"><b>: </b><span>Trace</span></span></span><br><span><var>Htr</var><span class="hyp-type"><b>: </b><span>valid_trace_prop tr</span></span></span><br><span><var>last</var><span class="hyp-type"><b>: </b><span>transition_item</span></span></span><br><span><var>prefix</var><span class="hyp-type"><b>: </b><span>list transition_item</span></span></span><br><span><var>Hprefix</var><span class="hyp-type"><b>: </b><span>trace_prefix (`(tr ‚Üæ Htr)) <span class="nb">last</span> prefix</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">valid_trace_prop
  (Finite (trace_first (`(tr ‚Üæ Htr)))
     (prefix ++ [<span class="nb">last</span>]))</div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="VLSM-v-chk3b2" style="display: none" type="checkbox"><label class="alectryon-input" for="VLSM-v-chk3b2"><span class="nb">simpl</span> <span class="kr">in</span> *.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>message</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>X</var><span class="hyp-type"><b>: </b><span>VLSM message</span></span></span><br><span><var>TypeX</var><span><span class="hyp-body"><b>:= </b><span>type X</span></span><span class="hyp-type"><b>: </b><span>VLSMType message</span></span></span></span><br><span><var>MachineX</var><span><span class="hyp-body"><b>:= </b><span>machine X</span></span><span class="hyp-type"><b>: </b><span>VLSMMachine (vtype X)</span></span></span></span><br><span><var>tr</var><span class="hyp-type"><b>: </b><span>Trace</span></span></span><br><span><var>Htr</var><span class="hyp-type"><b>: </b><span>valid_trace_prop tr</span></span></span><br><span><var>last</var><span class="hyp-type"><b>: </b><span>transition_item</span></span></span><br><span><var>prefix</var><span class="hyp-type"><b>: </b><span>list transition_item</span></span></span><br><span><var>Hprefix</var><span class="hyp-type"><b>: </b><span>trace_prefix tr <span class="nb">last</span> prefix</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">finite_valid_trace (trace_first tr) (prefix ++ [<span class="nb">last</span>])</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">      </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="VLSM-v-chk3b3" style="display: none" type="checkbox"><label class="alectryon-input" for="VLSM-v-chk3b3"><span class="nb">generalize dependent</span> tr.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>message</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>X</var><span class="hyp-type"><b>: </b><span>VLSM message</span></span></span><br><span><var>TypeX</var><span><span class="hyp-body"><b>:= </b><span>type X</span></span><span class="hyp-type"><b>: </b><span>VLSMType message</span></span></span></span><br><span><var>MachineX</var><span><span class="hyp-body"><b>:= </b><span>machine X</span></span><span class="hyp-type"><b>: </b><span>VLSMMachine (vtype X)</span></span></span></span><br><span><var>last</var><span class="hyp-type"><b>: </b><span>transition_item</span></span></span><br><span><var>prefix</var><span class="hyp-type"><b>: </b><span>list transition_item</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="kr">‚àÄ</span> <span class="nv">tr</span> : Trace,
  valid_trace_prop tr
  ‚Üí trace_prefix tr <span class="nb">last</span> prefix
    ‚Üí finite_valid_trace (trace_first tr)
        (prefix ++ [<span class="nb">last</span>])</div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="VLSM-v-chk3b4" style="display: none" type="checkbox"><label class="alectryon-input" for="VLSM-v-chk3b4"><span class="nb">generalize dependent</span> <span class="nb">last</span>.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>message</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>X</var><span class="hyp-type"><b>: </b><span>VLSM message</span></span></span><br><span><var>TypeX</var><span><span class="hyp-body"><b>:= </b><span>type X</span></span><span class="hyp-type"><b>: </b><span>VLSMType message</span></span></span></span><br><span><var>MachineX</var><span><span class="hyp-body"><b>:= </b><span>machine X</span></span><span class="hyp-type"><b>: </b><span>VLSMMachine (vtype X)</span></span></span></span><br><span><var>prefix</var><span class="hyp-type"><b>: </b><span>list transition_item</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="kr">‚àÄ</span> (<span class="nv">last</span> : transition_item) (<span class="nv">tr</span> : Trace),
  valid_trace_prop tr
  ‚Üí trace_prefix tr <span class="nb">last</span> prefix
    ‚Üí finite_valid_trace (trace_first tr)
        (prefix ++ [<span class="nb">last</span>])</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">      </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="VLSM-v-chk3b5" style="display: none" type="checkbox"><label class="alectryon-input" for="VLSM-v-chk3b5"><span class="nb">apply</span> (rev_ind (<span class="kr">fun</span> <span class="nv">prefix</span> =&gt; <span class="kr">forall</span> (<span class="nv">last</span> : transition_item) (<span class="nv">tr</span> : Trace), valid_trace_prop tr -&gt; trace_prefix tr <span class="nb">last</span> prefix -&gt; finite_valid_trace (trace_first tr) (prefix ++ [<span class="nb">last</span>]))).</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>message</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>X</var><span class="hyp-type"><b>: </b><span>VLSM message</span></span></span><br><span><var>TypeX</var><span><span class="hyp-body"><b>:= </b><span>type X</span></span><span class="hyp-type"><b>: </b><span>VLSMType message</span></span></span></span><br><span><var>MachineX</var><span><span class="hyp-body"><b>:= </b><span>machine X</span></span><span class="hyp-type"><b>: </b><span>VLSMMachine (vtype X)</span></span></span></span><br><span><var>prefix</var><span class="hyp-type"><b>: </b><span>list transition_item</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="kr">‚àÄ</span> (<span class="nv">last</span> : transition_item) (<span class="nv">tr</span> : Trace),
  valid_trace_prop tr
  ‚Üí trace_prefix tr <span class="nb">last</span> []
    ‚Üí finite_valid_trace (trace_first tr)
        ([] ++ [<span class="nb">last</span>])</div></blockquote><div class="alectryon-extra-goals"><input class="alectryon-extra-goal-toggle" id="VLSM-v-chk3b6" style="display: none" type="checkbox"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>message</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>X</var><span class="hyp-type"><b>: </b><span>VLSM message</span></span></span><br><span><var>TypeX</var><span><span class="hyp-body"><b>:= </b><span>type X</span></span><span class="hyp-type"><b>: </b><span>VLSMType message</span></span></span></span><br><span><var>MachineX</var><span><span class="hyp-body"><b>:= </b><span>machine X</span></span><span class="hyp-type"><b>: </b><span>VLSMMachine (vtype X)</span></span></span></span><br><span><var>prefix</var><span class="hyp-type"><b>: </b><span>list transition_item</span></span></span><br></div><label class="goal-separator" for="VLSM-v-chk3b6"><hr></label><div class="goal-conclusion"><span class="kr">‚àÄ</span> (<span class="nv">x</span> : transition_item) (<span class="nv">l</span> : list transition_item),
  (<span class="kr">‚àÄ</span> (<span class="nv">last</span> : transition_item) (<span class="nv">tr</span> : Trace),
     valid_trace_prop tr
     ‚Üí trace_prefix tr <span class="nb">last</span> l
       ‚Üí finite_valid_trace 
           (trace_first tr) 
           (l ++ [<span class="nb">last</span>]))
  ‚Üí <span class="kr">‚àÄ</span> (<span class="nv">last</span> : transition_item) (<span class="nv">tr</span> : Trace),
      valid_trace_prop tr
      ‚Üí trace_prefix tr <span class="nb">last</span> (l ++ [x])
        ‚Üí finite_valid_trace 
            (trace_first tr) 
            ((l ++ [x]) ++ [<span class="nb">last</span>])</div></blockquote></div></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">      </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="VLSM-v-chk3b7" style="display: none" type="checkbox"><label class="alectryon-input" for="VLSM-v-chk3b7">-</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>message</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>X</var><span class="hyp-type"><b>: </b><span>VLSM message</span></span></span><br><span><var>TypeX</var><span><span class="hyp-body"><b>:= </b><span>type X</span></span><span class="hyp-type"><b>: </b><span>VLSMType message</span></span></span></span><br><span><var>MachineX</var><span><span class="hyp-body"><b>:= </b><span>machine X</span></span><span class="hyp-type"><b>: </b><span>VLSMMachine (vtype X)</span></span></span></span><br><span><var>prefix</var><span class="hyp-type"><b>: </b><span>list transition_item</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="kr">‚àÄ</span> (<span class="nv">last</span> : transition_item) (<span class="nv">tr</span> : Trace),
  valid_trace_prop tr
  ‚Üí trace_prefix tr <span class="nb">last</span> []
    ‚Üí finite_valid_trace (trace_first tr)
        ([] ++ [<span class="nb">last</span>])</div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="nb">intros</span> <span class="nb">last</span> tr Htr Hprefix; <span class="nb">destruct</span> tr <span class="kr">as</span> [ | ]; <span class="nb">unfold</span> trace_prefix <span class="kr">in</span> Hprefix;   <span class="nb">simpl</span> <span class="kr">in</span> Hprefix
        ; <span class="nb">destruct</span> Hprefix <span class="kr">as</span> [suffix Heq]; <span class="nb">subst</span>; <span class="nb">destruct</span> Htr <span class="kr">as</span> [Htr Hinit]
        ; <span class="nb">unfold</span> trace_first; <span class="nb">simpl</span>; <span class="nb">constructor</span>; <span class="kp">try</span> <span class="bp">assumption</span>
        ; <span class="nb">inversion</span> Htr; <span class="nb">subst</span>; <span class="nb">clear</span> Htr
        ; <span class="nb">apply</span> finite_valid_trace_singleton; <span class="bp">assumption</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">      </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="VLSM-v-chk3b8" style="display: none" type="checkbox"><label class="alectryon-input" for="VLSM-v-chk3b8">-</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>message</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>X</var><span class="hyp-type"><b>: </b><span>VLSM message</span></span></span><br><span><var>TypeX</var><span><span class="hyp-body"><b>:= </b><span>type X</span></span><span class="hyp-type"><b>: </b><span>VLSMType message</span></span></span></span><br><span><var>MachineX</var><span><span class="hyp-body"><b>:= </b><span>machine X</span></span><span class="hyp-type"><b>: </b><span>VLSMMachine (vtype X)</span></span></span></span><br><span><var>prefix</var><span class="hyp-type"><b>: </b><span>list transition_item</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="kr">‚àÄ</span> (<span class="nv">x</span> : transition_item) (<span class="nv">l</span> : list transition_item),
  (<span class="kr">‚àÄ</span> (<span class="nv">last</span> : transition_item) (<span class="nv">tr</span> : Trace),
     valid_trace_prop tr
     ‚Üí trace_prefix tr <span class="nb">last</span> l
       ‚Üí finite_valid_trace (trace_first tr)
           (l ++ [<span class="nb">last</span>]))
  ‚Üí <span class="kr">‚àÄ</span> (<span class="nv">last</span> : transition_item) (<span class="nv">tr</span> : Trace),
      valid_trace_prop tr
      ‚Üí trace_prefix tr <span class="nb">last</span> (l ++ [x])
        ‚Üí finite_valid_trace (trace_first tr)
            ((l ++ [x]) ++ [<span class="nb">last</span>])</div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="VLSM-v-chk3b9" style="display: none" type="checkbox"><label class="alectryon-input" for="VLSM-v-chk3b9"><span class="nb">intros</span> last_p p Hind <span class="nb">last</span> tr Htr Hprefix.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>message</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>X</var><span class="hyp-type"><b>: </b><span>VLSM message</span></span></span><br><span><var>TypeX</var><span><span class="hyp-body"><b>:= </b><span>type X</span></span><span class="hyp-type"><b>: </b><span>VLSMType message</span></span></span></span><br><span><var>MachineX</var><span><span class="hyp-body"><b>:= </b><span>machine X</span></span><span class="hyp-type"><b>: </b><span>VLSMMachine (vtype X)</span></span></span></span><br><span><var>prefix</var><span class="hyp-type"><b>: </b><span>list transition_item</span></span></span><br><span><var>last_p</var><span class="hyp-type"><b>: </b><span>transition_item</span></span></span><br><span><var>p</var><span class="hyp-type"><b>: </b><span>list transition_item</span></span></span><br><span><var>Hind</var><span class="hyp-type"><b>: </b><span><span class="kr">‚àÄ</span> (<span class="nv">last</span> : transition_item) (<span class="nv">tr</span> : Trace),
  valid_trace_prop tr
  ‚Üí trace_prefix tr <span class="nb">last</span> p
    ‚Üí finite_valid_trace 
        (trace_first tr) 
        (p ++ [<span class="nb">last</span>])</span></span></span><br><span><var>last</var><span class="hyp-type"><b>: </b><span>transition_item</span></span></span><br><span><var>tr</var><span class="hyp-type"><b>: </b><span>Trace</span></span></span><br><span><var>Htr</var><span class="hyp-type"><b>: </b><span>valid_trace_prop tr</span></span></span><br><span><var>Hprefix</var><span class="hyp-type"><b>: </b><span>trace_prefix tr <span class="nb">last</span> (p ++ [last_p])</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">finite_valid_trace (trace_first tr)
  ((p ++ [last_p]) ++ [<span class="nb">last</span>])</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">        </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="VLSM-v-chk3ba" style="display: none" type="checkbox"><label class="alectryon-input" for="VLSM-v-chk3ba"><span class="nb">specialize</span> (Hind last_p tr Htr).</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>message</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>X</var><span class="hyp-type"><b>: </b><span>VLSM message</span></span></span><br><span><var>TypeX</var><span><span class="hyp-body"><b>:= </b><span>type X</span></span><span class="hyp-type"><b>: </b><span>VLSMType message</span></span></span></span><br><span><var>MachineX</var><span><span class="hyp-body"><b>:= </b><span>machine X</span></span><span class="hyp-type"><b>: </b><span>VLSMMachine (vtype X)</span></span></span></span><br><span><var>prefix</var><span class="hyp-type"><b>: </b><span>list transition_item</span></span></span><br><span><var>last_p</var><span class="hyp-type"><b>: </b><span>transition_item</span></span></span><br><span><var>p</var><span class="hyp-type"><b>: </b><span>list transition_item</span></span></span><br><span><var>tr</var><span class="hyp-type"><b>: </b><span>Trace</span></span></span><br><span><var>Hind</var><span class="hyp-type"><b>: </b><span>trace_prefix tr last_p p
‚Üí finite_valid_trace (trace_first tr)
    (p ++ [last_p])</span></span></span><br><span><var>last</var><span class="hyp-type"><b>: </b><span>transition_item</span></span></span><br><span><var>Htr</var><span class="hyp-type"><b>: </b><span>valid_trace_prop tr</span></span></span><br><span><var>Hprefix</var><span class="hyp-type"><b>: </b><span>trace_prefix tr <span class="nb">last</span> (p ++ [last_p])</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">finite_valid_trace (trace_first tr)
  ((p ++ [last_p]) ++ [<span class="nb">last</span>])</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">        </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="VLSM-v-chk3bb" style="display: none" type="checkbox"><label class="alectryon-input" for="VLSM-v-chk3bb"><span class="nb">destruct</span> tr <span class="kr">as</span> [ | ]; <span class="nb">unfold</span> trace_prefix <span class="kr">in</span> Hprefix;   <span class="nb">simpl</span> <span class="kr">in</span> Hprefix
        ; <span class="nb">destruct</span> Hprefix <span class="kr">as</span> [suffix Heq]; <span class="nb">subst</span>; <span class="nb">destruct</span> Htr <span class="kr">as</span> [Htr Hinit]; <span class="nb">simpl</span>; <span class="nb">simpl</span> <span class="kr">in</span> Hind
        ; <span class="nb">split</span>; <span class="kp">try</span> <span class="bp">assumption</span>
        .</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>message</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>X</var><span class="hyp-type"><b>: </b><span>VLSM message</span></span></span><br><span><var>TypeX</var><span><span class="hyp-body"><b>:= </b><span>type X</span></span><span class="hyp-type"><b>: </b><span>VLSMType message</span></span></span></span><br><span><var>MachineX</var><span><span class="hyp-body"><b>:= </b><span>machine X</span></span><span class="hyp-type"><b>: </b><span>VLSMMachine (vtype X)</span></span></span></span><br><span><var>prefix</var><span class="hyp-type"><b>: </b><span>list transition_item</span></span></span><br><span><var>last_p</var><span class="hyp-type"><b>: </b><span>transition_item</span></span></span><br><span><var>p</var><span class="hyp-type"><b>: </b><span>list transition_item</span></span></span><br><span><var>s</var><span class="hyp-type"><b>: </b><span>state</span></span></span><br><span><var>last</var><span class="hyp-type"><b>: </b><span>transition_item</span></span></span><br><span><var>suffix</var><span class="hyp-type"><b>: </b><span>list transition_item</span></span></span><br><span><var>Htr</var><span class="hyp-type"><b>: </b><span>finite_valid_trace_from s
  ((p ++ [last_p]) ++ <span class="nb">last</span> :: suffix)</span></span></span><br><span><var>Hinit</var><span class="hyp-type"><b>: </b><span>initial_state_prop s</span></span></span><br><span><var>Hind</var><span class="hyp-type"><b>: </b><span>(<span class="kr">‚àÉ</span> <span class="nv">suffix0</span> : list transition_item,
   (p ++ [last_p]) ++ <span class="nb">last</span> :: suffix =
   p ++ last_p :: suffix0)
‚Üí finite_valid_trace s (p ++ [last_p])</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">finite_valid_trace_from s ((p ++ [last_p]) ++ [<span class="nb">last</span>])</div></blockquote><div class="alectryon-extra-goals"><input class="alectryon-extra-goal-toggle" id="VLSM-v-chk3bc" style="display: none" type="checkbox"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>message</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>X</var><span class="hyp-type"><b>: </b><span>VLSM message</span></span></span><br><span><var>TypeX</var><span><span class="hyp-body"><b>:= </b><span>type X</span></span><span class="hyp-type"><b>: </b><span>VLSMType message</span></span></span></span><br><span><var>MachineX</var><span><span class="hyp-body"><b>:= </b><span>machine X</span></span><span class="hyp-type"><b>: </b><span>VLSMMachine (vtype X)</span></span></span></span><br><span><var>prefix</var><span class="hyp-type"><b>: </b><span>list transition_item</span></span></span><br><span><var>last_p</var><span class="hyp-type"><b>: </b><span>transition_item</span></span></span><br><span><var>p</var><span class="hyp-type"><b>: </b><span>list transition_item</span></span></span><br><span><var>s</var><span class="hyp-type"><b>: </b><span>state</span></span></span><br><span><var>last</var><span class="hyp-type"><b>: </b><span>transition_item</span></span></span><br><span><var>suffix</var><span class="hyp-type"><b>: </b><span>Stream transition_item</span></span></span><br><span><var>Htr</var><span class="hyp-type"><b>: </b><span>infinite_valid_trace_from s
  (stream_app (p ++ [last_p]) (Cons <span class="nb">last</span> suffix))</span></span></span><br><span><var>Hinit</var><span class="hyp-type"><b>: </b><span>initial_state_prop s</span></span></span><br><span><var>Hind</var><span class="hyp-type"><b>: </b><span>(<span class="kr">‚àÉ</span> <span class="nv">suffix0</span> : Stream transition_item,
   stream_app (p ++ [last_p])
     (Cons <span class="nb">last</span> suffix) =
   stream_app p (Cons last_p suffix0))
‚Üí finite_valid_trace s (p ++ [last_p])</span></span></span><br></div><label class="goal-separator" for="VLSM-v-chk3bc"><hr></label><div class="goal-conclusion">finite_valid_trace_from s ((p ++ [last_p]) ++ [<span class="nb">last</span>])</div></blockquote></div></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">        </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="VLSM-v-chk3bd" style="display: none" type="checkbox"><label class="alectryon-input" for="VLSM-v-chk3bd">+</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>message</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>X</var><span class="hyp-type"><b>: </b><span>VLSM message</span></span></span><br><span><var>TypeX</var><span><span class="hyp-body"><b>:= </b><span>type X</span></span><span class="hyp-type"><b>: </b><span>VLSMType message</span></span></span></span><br><span><var>MachineX</var><span><span class="hyp-body"><b>:= </b><span>machine X</span></span><span class="hyp-type"><b>: </b><span>VLSMMachine (vtype X)</span></span></span></span><br><span><var>prefix</var><span class="hyp-type"><b>: </b><span>list transition_item</span></span></span><br><span><var>last_p</var><span class="hyp-type"><b>: </b><span>transition_item</span></span></span><br><span><var>p</var><span class="hyp-type"><b>: </b><span>list transition_item</span></span></span><br><span><var>s</var><span class="hyp-type"><b>: </b><span>state</span></span></span><br><span><var>last</var><span class="hyp-type"><b>: </b><span>transition_item</span></span></span><br><span><var>suffix</var><span class="hyp-type"><b>: </b><span>list transition_item</span></span></span><br><span><var>Htr</var><span class="hyp-type"><b>: </b><span>finite_valid_trace_from s
  ((p ++ [last_p]) ++ <span class="nb">last</span> :: suffix)</span></span></span><br><span><var>Hinit</var><span class="hyp-type"><b>: </b><span>initial_state_prop s</span></span></span><br><span><var>Hind</var><span class="hyp-type"><b>: </b><span>(<span class="kr">‚àÉ</span> <span class="nv">suffix0</span> : list transition_item,
   (p ++ [last_p]) ++ <span class="nb">last</span> :: suffix =
   p ++ last_p :: suffix0)
‚Üí finite_valid_trace s (p ++ [last_p])</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">finite_valid_trace_from s ((p ++ [last_p]) ++ [<span class="nb">last</span>])</div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="VLSM-v-chk3be" style="display: none" type="checkbox"><label class="alectryon-input" for="VLSM-v-chk3be"><span class="nb">assert</span>
            (Hex : <span class="kr">exists</span> <span class="nv">suffix0</span> : list transition_item,
                (p ++ [last_p]) ++ <span class="nb">last</span> :: suffix = p ++ last_p :: suffix0
            ) <span class="bp">by</span> (<span class="kr">exists</span> (<span class="nv">last</span> :: suffix); <span class="nb">rewrite</span> &lt;- app_assoc; <span class="bp">reflexivity</span>)
          ; <span class="nb">specialize</span> (Hind Hex); <span class="nb">clear</span> Hex
          ; <span class="nb">destruct</span> Hind <span class="kr">as</span> [Hptr _]
          ; <span class="nb">destruct</span> <span class="nb">last</span>
          ; <span class="nb">apply</span> extend_right_finite_trace_from
          ; <span class="kp">try</span> <span class="bp">assumption</span>
          .</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>message</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>X</var><span class="hyp-type"><b>: </b><span>VLSM message</span></span></span><br><span><var>TypeX</var><span><span class="hyp-body"><b>:= </b><span>type X</span></span><span class="hyp-type"><b>: </b><span>VLSMType message</span></span></span></span><br><span><var>MachineX</var><span><span class="hyp-body"><b>:= </b><span>machine X</span></span><span class="hyp-type"><b>: </b><span>VLSMMachine (vtype X)</span></span></span></span><br><span><var>prefix</var><span class="hyp-type"><b>: </b><span>list transition_item</span></span></span><br><span><var>last_p</var><span class="hyp-type"><b>: </b><span>transition_item</span></span></span><br><span><var>p</var><span class="hyp-type"><b>: </b><span>list transition_item</span></span></span><br><span><var>s</var><span class="hyp-type"><b>: </b><span>state</span></span></span><br><span><var>l0</var><span class="hyp-type"><b>: </b><span>label</span></span></span><br><span><var>input0</var><span class="hyp-type"><b>: </b><span>option message</span></span></span><br><span><var>destination0</var><span class="hyp-type"><b>: </b><span>state</span></span></span><br><span><var>output0</var><span class="hyp-type"><b>: </b><span>option message</span></span></span><br><span><var>suffix</var><span class="hyp-type"><b>: </b><span>list transition_item</span></span></span><br><span><var>Htr</var><span class="hyp-type"><b>: </b><span>finite_valid_trace_from s
  ((p ++ [last_p]) ++
   {|
     l := l0;
     input := input0;
     destination := destination0;
     output := output0
   |} :: suffix)</span></span></span><br><span><var>Hinit</var><span class="hyp-type"><b>: </b><span>initial_state_prop s</span></span></span><br><span><var>Hptr</var><span class="hyp-type"><b>: </b><span>finite_valid_trace_from s (p ++ [last_p])</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">input_valid_transition l0
  (finite_trace_last s (p ++ [last_p]), input0)
  (destination0, output0)</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">          </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="VLSM-v-chk3bf" style="display: none" type="checkbox"><label class="alectryon-input" for="VLSM-v-chk3bf"><span class="nb">rewrite</span> &lt;- (app_cons {| l := l0; input := input0; destination := destination0; output := output0 |} suffix) <span class="kr">in</span> Htr.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>message</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>X</var><span class="hyp-type"><b>: </b><span>VLSM message</span></span></span><br><span><var>TypeX</var><span><span class="hyp-body"><b>:= </b><span>type X</span></span><span class="hyp-type"><b>: </b><span>VLSMType message</span></span></span></span><br><span><var>MachineX</var><span><span class="hyp-body"><b>:= </b><span>machine X</span></span><span class="hyp-type"><b>: </b><span>VLSMMachine (vtype X)</span></span></span></span><br><span><var>prefix</var><span class="hyp-type"><b>: </b><span>list transition_item</span></span></span><br><span><var>last_p</var><span class="hyp-type"><b>: </b><span>transition_item</span></span></span><br><span><var>p</var><span class="hyp-type"><b>: </b><span>list transition_item</span></span></span><br><span><var>s</var><span class="hyp-type"><b>: </b><span>state</span></span></span><br><span><var>l0</var><span class="hyp-type"><b>: </b><span>label</span></span></span><br><span><var>input0</var><span class="hyp-type"><b>: </b><span>option message</span></span></span><br><span><var>destination0</var><span class="hyp-type"><b>: </b><span>state</span></span></span><br><span><var>output0</var><span class="hyp-type"><b>: </b><span>option message</span></span></span><br><span><var>suffix</var><span class="hyp-type"><b>: </b><span>list transition_item</span></span></span><br><span><var>Htr</var><span class="hyp-type"><b>: </b><span>finite_valid_trace_from s
  ((p ++ [last_p]) ++
   [{|
      l := l0;
      input := input0;
      destination := destination0;
      output := output0
    |}] ++ suffix)</span></span></span><br><span><var>Hinit</var><span class="hyp-type"><b>: </b><span>initial_state_prop s</span></span></span><br><span><var>Hptr</var><span class="hyp-type"><b>: </b><span>finite_valid_trace_from s (p ++ [last_p])</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">input_valid_transition l0
  (finite_trace_last s (p ++ [last_p]), input0)
  (destination0, output0)</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">          </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="VLSM-v-chk3c0" style="display: none" type="checkbox"><label class="alectryon-input" for="VLSM-v-chk3c0"><span class="nb">rewrite</span> app_assoc <span class="kr">in</span> Htr.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>message</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>X</var><span class="hyp-type"><b>: </b><span>VLSM message</span></span></span><br><span><var>TypeX</var><span><span class="hyp-body"><b>:= </b><span>type X</span></span><span class="hyp-type"><b>: </b><span>VLSMType message</span></span></span></span><br><span><var>MachineX</var><span><span class="hyp-body"><b>:= </b><span>machine X</span></span><span class="hyp-type"><b>: </b><span>VLSMMachine (vtype X)</span></span></span></span><br><span><var>prefix</var><span class="hyp-type"><b>: </b><span>list transition_item</span></span></span><br><span><var>last_p</var><span class="hyp-type"><b>: </b><span>transition_item</span></span></span><br><span><var>p</var><span class="hyp-type"><b>: </b><span>list transition_item</span></span></span><br><span><var>s</var><span class="hyp-type"><b>: </b><span>state</span></span></span><br><span><var>l0</var><span class="hyp-type"><b>: </b><span>label</span></span></span><br><span><var>input0</var><span class="hyp-type"><b>: </b><span>option message</span></span></span><br><span><var>destination0</var><span class="hyp-type"><b>: </b><span>state</span></span></span><br><span><var>output0</var><span class="hyp-type"><b>: </b><span>option message</span></span></span><br><span><var>suffix</var><span class="hyp-type"><b>: </b><span>list transition_item</span></span></span><br><span><var>Htr</var><span class="hyp-type"><b>: </b><span>finite_valid_trace_from s
  (((p ++ [last_p]) ++
    [{|
       l := l0;
       input := input0;
       destination := destination0;
       output := output0
     |}]) ++ suffix)</span></span></span><br><span><var>Hinit</var><span class="hyp-type"><b>: </b><span>initial_state_prop s</span></span></span><br><span><var>Hptr</var><span class="hyp-type"><b>: </b><span>finite_valid_trace_from s (p ++ [last_p])</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">input_valid_transition l0
  (finite_trace_last s (p ++ [last_p]), input0)
  (destination0, output0)</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">          </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="VLSM-v-chk3c1" style="display: none" type="checkbox"><label class="alectryon-input" for="VLSM-v-chk3c1"><span class="nb">rewrite</span> &lt;- (app_assoc p _ _) <span class="kr">in</span> Htr.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>message</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>X</var><span class="hyp-type"><b>: </b><span>VLSM message</span></span></span><br><span><var>TypeX</var><span><span class="hyp-body"><b>:= </b><span>type X</span></span><span class="hyp-type"><b>: </b><span>VLSMType message</span></span></span></span><br><span><var>MachineX</var><span><span class="hyp-body"><b>:= </b><span>machine X</span></span><span class="hyp-type"><b>: </b><span>VLSMMachine (vtype X)</span></span></span></span><br><span><var>prefix</var><span class="hyp-type"><b>: </b><span>list transition_item</span></span></span><br><span><var>last_p</var><span class="hyp-type"><b>: </b><span>transition_item</span></span></span><br><span><var>p</var><span class="hyp-type"><b>: </b><span>list transition_item</span></span></span><br><span><var>s</var><span class="hyp-type"><b>: </b><span>state</span></span></span><br><span><var>l0</var><span class="hyp-type"><b>: </b><span>label</span></span></span><br><span><var>input0</var><span class="hyp-type"><b>: </b><span>option message</span></span></span><br><span><var>destination0</var><span class="hyp-type"><b>: </b><span>state</span></span></span><br><span><var>output0</var><span class="hyp-type"><b>: </b><span>option message</span></span></span><br><span><var>suffix</var><span class="hyp-type"><b>: </b><span>list transition_item</span></span></span><br><span><var>Htr</var><span class="hyp-type"><b>: </b><span>finite_valid_trace_from s
  ((p ++
    [last_p] ++
    [{|
       l := l0;
       input := input0;
       destination := destination0;
       output := output0
     |}]) ++ suffix)</span></span></span><br><span><var>Hinit</var><span class="hyp-type"><b>: </b><span>initial_state_prop s</span></span></span><br><span><var>Hptr</var><span class="hyp-type"><b>: </b><span>finite_valid_trace_from s (p ++ [last_p])</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">input_valid_transition l0
  (finite_trace_last s (p ++ [last_p]), input0)
  (destination0, output0)</div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="VLSM-v-chk3c2" style="display: none" type="checkbox"><label class="alectryon-input" for="VLSM-v-chk3c2"><span class="nb">simpl</span> <span class="kr">in</span> Htr.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>message</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>X</var><span class="hyp-type"><b>: </b><span>VLSM message</span></span></span><br><span><var>TypeX</var><span><span class="hyp-body"><b>:= </b><span>type X</span></span><span class="hyp-type"><b>: </b><span>VLSMType message</span></span></span></span><br><span><var>MachineX</var><span><span class="hyp-body"><b>:= </b><span>machine X</span></span><span class="hyp-type"><b>: </b><span>VLSMMachine (vtype X)</span></span></span></span><br><span><var>prefix</var><span class="hyp-type"><b>: </b><span>list transition_item</span></span></span><br><span><var>last_p</var><span class="hyp-type"><b>: </b><span>transition_item</span></span></span><br><span><var>p</var><span class="hyp-type"><b>: </b><span>list transition_item</span></span></span><br><span><var>s</var><span class="hyp-type"><b>: </b><span>state</span></span></span><br><span><var>l0</var><span class="hyp-type"><b>: </b><span>label</span></span></span><br><span><var>input0</var><span class="hyp-type"><b>: </b><span>option message</span></span></span><br><span><var>destination0</var><span class="hyp-type"><b>: </b><span>state</span></span></span><br><span><var>output0</var><span class="hyp-type"><b>: </b><span>option message</span></span></span><br><span><var>suffix</var><span class="hyp-type"><b>: </b><span>list transition_item</span></span></span><br><span><var>Htr</var><span class="hyp-type"><b>: </b><span>finite_valid_trace_from s
  ((p ++
    [last_p;
    {|
      l := l0;
      input := input0;
      destination := destination0;
      output := output0
    |}]) ++ suffix)</span></span></span><br><span><var>Hinit</var><span class="hyp-type"><b>: </b><span>initial_state_prop s</span></span></span><br><span><var>Hptr</var><span class="hyp-type"><b>: </b><span>finite_valid_trace_from s (p ++ [last_p])</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">input_valid_transition l0
  (finite_trace_last s (p ++ [last_p]), input0)
  (destination0, output0)</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">          </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="VLSM-v-chk3c3" style="display: none" type="checkbox"><label class="alectryon-input" for="VLSM-v-chk3c3"><span class="nb">rewrite</span> &lt;- app_assoc <span class="kr">in</span> Htr.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>message</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>X</var><span class="hyp-type"><b>: </b><span>VLSM message</span></span></span><br><span><var>TypeX</var><span><span class="hyp-body"><b>:= </b><span>type X</span></span><span class="hyp-type"><b>: </b><span>VLSMType message</span></span></span></span><br><span><var>MachineX</var><span><span class="hyp-body"><b>:= </b><span>machine X</span></span><span class="hyp-type"><b>: </b><span>VLSMMachine (vtype X)</span></span></span></span><br><span><var>prefix</var><span class="hyp-type"><b>: </b><span>list transition_item</span></span></span><br><span><var>last_p</var><span class="hyp-type"><b>: </b><span>transition_item</span></span></span><br><span><var>p</var><span class="hyp-type"><b>: </b><span>list transition_item</span></span></span><br><span><var>s</var><span class="hyp-type"><b>: </b><span>state</span></span></span><br><span><var>l0</var><span class="hyp-type"><b>: </b><span>label</span></span></span><br><span><var>input0</var><span class="hyp-type"><b>: </b><span>option message</span></span></span><br><span><var>destination0</var><span class="hyp-type"><b>: </b><span>state</span></span></span><br><span><var>output0</var><span class="hyp-type"><b>: </b><span>option message</span></span></span><br><span><var>suffix</var><span class="hyp-type"><b>: </b><span>list transition_item</span></span></span><br><span><var>Htr</var><span class="hyp-type"><b>: </b><span>finite_valid_trace_from s
  (p ++
   [last_p;
   {|
     l := l0;
     input := input0;
     destination := destination0;
     output := output0
   |}] ++ suffix)</span></span></span><br><span><var>Hinit</var><span class="hyp-type"><b>: </b><span>initial_state_prop s</span></span></span><br><span><var>Hptr</var><span class="hyp-type"><b>: </b><span>finite_valid_trace_from s (p ++ [last_p])</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">input_valid_transition l0
  (finite_trace_last s (p ++ [last_p]), input0)
  (destination0, output0)</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">          </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="VLSM-v-chk3c4" style="display: none" type="checkbox"><label class="alectryon-input" for="VLSM-v-chk3c4"><span class="nb">specialize</span>
            (finite_valid_trace_consecutive_valid_transition _ _ _ _ _ _ Htr eq_refl).</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>message</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>X</var><span class="hyp-type"><b>: </b><span>VLSM message</span></span></span><br><span><var>TypeX</var><span><span class="hyp-body"><b>:= </b><span>type X</span></span><span class="hyp-type"><b>: </b><span>VLSMType message</span></span></span></span><br><span><var>MachineX</var><span><span class="hyp-body"><b>:= </b><span>machine X</span></span><span class="hyp-type"><b>: </b><span>VLSMMachine (vtype X)</span></span></span></span><br><span><var>prefix</var><span class="hyp-type"><b>: </b><span>list transition_item</span></span></span><br><span><var>last_p</var><span class="hyp-type"><b>: </b><span>transition_item</span></span></span><br><span><var>p</var><span class="hyp-type"><b>: </b><span>list transition_item</span></span></span><br><span><var>s</var><span class="hyp-type"><b>: </b><span>state</span></span></span><br><span><var>l0</var><span class="hyp-type"><b>: </b><span>label</span></span></span><br><span><var>input0</var><span class="hyp-type"><b>: </b><span>option message</span></span></span><br><span><var>destination0</var><span class="hyp-type"><b>: </b><span>state</span></span></span><br><span><var>output0</var><span class="hyp-type"><b>: </b><span>option message</span></span></span><br><span><var>suffix</var><span class="hyp-type"><b>: </b><span>list transition_item</span></span></span><br><span><var>Htr</var><span class="hyp-type"><b>: </b><span>finite_valid_trace_from s
  (p ++
   [last_p;
   {|
     l := l0;
     input := input0;
     destination := destination0;
     output := output0
   |}] ++ suffix)</span></span></span><br><span><var>Hinit</var><span class="hyp-type"><b>: </b><span>initial_state_prop s</span></span></span><br><span><var>Hptr</var><span class="hyp-type"><b>: </b><span>finite_valid_trace_from s (p ++ [last_p])</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">input_valid_transition
  (l
     {|
       l := l0;
       input := input0;
       destination := destination0;
       output := output0
     |})
  (destination last_p,
  input
    {|
      l := l0;
      input := input0;
      destination := destination0;
      output := output0
    |})
  (destination
     {|
       l := l0;
       input := input0;
       destination := destination0;
       output := output0
     |},
  output
    {|
      l := l0;
      input := input0;
      destination := destination0;
      output := output0
    |})
‚Üí input_valid_transition l0
    (finite_trace_last s (p ++ [last_p]), input0)
    (destination0, output0)</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">          </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="VLSM-v-chk3c5" style="display: none" type="checkbox"><label class="alectryon-input" for="VLSM-v-chk3c5"><span class="nb">simpl</span>.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>message</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>X</var><span class="hyp-type"><b>: </b><span>VLSM message</span></span></span><br><span><var>TypeX</var><span><span class="hyp-body"><b>:= </b><span>type X</span></span><span class="hyp-type"><b>: </b><span>VLSMType message</span></span></span></span><br><span><var>MachineX</var><span><span class="hyp-body"><b>:= </b><span>machine X</span></span><span class="hyp-type"><b>: </b><span>VLSMMachine (vtype X)</span></span></span></span><br><span><var>prefix</var><span class="hyp-type"><b>: </b><span>list transition_item</span></span></span><br><span><var>last_p</var><span class="hyp-type"><b>: </b><span>transition_item</span></span></span><br><span><var>p</var><span class="hyp-type"><b>: </b><span>list transition_item</span></span></span><br><span><var>s</var><span class="hyp-type"><b>: </b><span>state</span></span></span><br><span><var>l0</var><span class="hyp-type"><b>: </b><span>label</span></span></span><br><span><var>input0</var><span class="hyp-type"><b>: </b><span>option message</span></span></span><br><span><var>destination0</var><span class="hyp-type"><b>: </b><span>state</span></span></span><br><span><var>output0</var><span class="hyp-type"><b>: </b><span>option message</span></span></span><br><span><var>suffix</var><span class="hyp-type"><b>: </b><span>list transition_item</span></span></span><br><span><var>Htr</var><span class="hyp-type"><b>: </b><span>finite_valid_trace_from s
  (p ++
   [last_p;
   {|
     l := l0;
     input := input0;
     destination := destination0;
     output := output0
   |}] ++ suffix)</span></span></span><br><span><var>Hinit</var><span class="hyp-type"><b>: </b><span>initial_state_prop s</span></span></span><br><span><var>Hptr</var><span class="hyp-type"><b>: </b><span>finite_valid_trace_from s (p ++ [last_p])</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">input_valid_transition l0 (destination last_p, input0)
  (destination0, output0)
‚Üí input_valid_transition l0
    (finite_trace_last s (p ++ [last_p]), input0)
    (destination0, output0)</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">          </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="VLSM-v-chk3c6" style="display: none" type="checkbox"><label class="alectryon-input" for="VLSM-v-chk3c6"><span class="nb">rewrite</span> finite_trace_last_is_last.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>message</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>X</var><span class="hyp-type"><b>: </b><span>VLSM message</span></span></span><br><span><var>TypeX</var><span><span class="hyp-body"><b>:= </b><span>type X</span></span><span class="hyp-type"><b>: </b><span>VLSMType message</span></span></span></span><br><span><var>MachineX</var><span><span class="hyp-body"><b>:= </b><span>machine X</span></span><span class="hyp-type"><b>: </b><span>VLSMMachine (vtype X)</span></span></span></span><br><span><var>prefix</var><span class="hyp-type"><b>: </b><span>list transition_item</span></span></span><br><span><var>last_p</var><span class="hyp-type"><b>: </b><span>transition_item</span></span></span><br><span><var>p</var><span class="hyp-type"><b>: </b><span>list transition_item</span></span></span><br><span><var>s</var><span class="hyp-type"><b>: </b><span>state</span></span></span><br><span><var>l0</var><span class="hyp-type"><b>: </b><span>label</span></span></span><br><span><var>input0</var><span class="hyp-type"><b>: </b><span>option message</span></span></span><br><span><var>destination0</var><span class="hyp-type"><b>: </b><span>state</span></span></span><br><span><var>output0</var><span class="hyp-type"><b>: </b><span>option message</span></span></span><br><span><var>suffix</var><span class="hyp-type"><b>: </b><span>list transition_item</span></span></span><br><span><var>Htr</var><span class="hyp-type"><b>: </b><span>finite_valid_trace_from s
  (p ++
   [last_p;
   {|
     l := l0;
     input := input0;
     destination := destination0;
     output := output0
   |}] ++ suffix)</span></span></span><br><span><var>Hinit</var><span class="hyp-type"><b>: </b><span>initial_state_prop s</span></span></span><br><span><var>Hptr</var><span class="hyp-type"><b>: </b><span>finite_valid_trace_from s (p ++ [last_p])</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">input_valid_transition l0 (destination last_p, input0)
  (destination0, output0)
‚Üí input_valid_transition l0
    (destination last_p, input0)
    (destination0, output0)</div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="nb">trivial</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">        </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="VLSM-v-chk3c7" style="display: none" type="checkbox"><label class="alectryon-input" for="VLSM-v-chk3c7">+</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>message</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>X</var><span class="hyp-type"><b>: </b><span>VLSM message</span></span></span><br><span><var>TypeX</var><span><span class="hyp-body"><b>:= </b><span>type X</span></span><span class="hyp-type"><b>: </b><span>VLSMType message</span></span></span></span><br><span><var>MachineX</var><span><span class="hyp-body"><b>:= </b><span>machine X</span></span><span class="hyp-type"><b>: </b><span>VLSMMachine (vtype X)</span></span></span></span><br><span><var>prefix</var><span class="hyp-type"><b>: </b><span>list transition_item</span></span></span><br><span><var>last_p</var><span class="hyp-type"><b>: </b><span>transition_item</span></span></span><br><span><var>p</var><span class="hyp-type"><b>: </b><span>list transition_item</span></span></span><br><span><var>s</var><span class="hyp-type"><b>: </b><span>state</span></span></span><br><span><var>last</var><span class="hyp-type"><b>: </b><span>transition_item</span></span></span><br><span><var>suffix</var><span class="hyp-type"><b>: </b><span>Stream transition_item</span></span></span><br><span><var>Htr</var><span class="hyp-type"><b>: </b><span>infinite_valid_trace_from s
  (stream_app (p ++ [last_p]) (Cons <span class="nb">last</span> suffix))</span></span></span><br><span><var>Hinit</var><span class="hyp-type"><b>: </b><span>initial_state_prop s</span></span></span><br><span><var>Hind</var><span class="hyp-type"><b>: </b><span>(<span class="kr">‚àÉ</span> <span class="nv">suffix0</span> : Stream transition_item,
   stream_app (p ++ [last_p])
     (Cons <span class="nb">last</span> suffix) =
   stream_app p (Cons last_p suffix0))
‚Üí finite_valid_trace s (p ++ [last_p])</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">finite_valid_trace_from s ((p ++ [last_p]) ++ [<span class="nb">last</span>])</div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="VLSM-v-chk3c8" style="display: none" type="checkbox"><label class="alectryon-input" for="VLSM-v-chk3c8"><span class="nb">assert</span>
            (Hex : <span class="kr">exists</span> <span class="nv">suffix0</span> : Stream transition_item,
                stream_app (p ++ [last_p])  (Cons <span class="nb">last</span> suffix) = stream_app p (Cons last_p suffix0)
            ) <span class="bp">by</span> (<span class="kr">exists</span> (<span class="nv">Cons</span> <span class="nv">last</span> <span class="nv">suffix</span>); <span class="nb">rewrite</span> &lt;- stream_app_assoc; <span class="bp">reflexivity</span>)
          ; <span class="nb">specialize</span> (Hind Hex); <span class="nb">clear</span> Hex
          ; <span class="nb">destruct</span> Hind <span class="kr">as</span> [Hptr _]
          ; <span class="nb">destruct</span> <span class="nb">last</span>
          ; <span class="nb">apply</span> extend_right_finite_trace_from
          ; <span class="kp">try</span> <span class="bp">assumption</span>
          .</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>message</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>X</var><span class="hyp-type"><b>: </b><span>VLSM message</span></span></span><br><span><var>TypeX</var><span><span class="hyp-body"><b>:= </b><span>type X</span></span><span class="hyp-type"><b>: </b><span>VLSMType message</span></span></span></span><br><span><var>MachineX</var><span><span class="hyp-body"><b>:= </b><span>machine X</span></span><span class="hyp-type"><b>: </b><span>VLSMMachine (vtype X)</span></span></span></span><br><span><var>prefix</var><span class="hyp-type"><b>: </b><span>list transition_item</span></span></span><br><span><var>last_p</var><span class="hyp-type"><b>: </b><span>transition_item</span></span></span><br><span><var>p</var><span class="hyp-type"><b>: </b><span>list transition_item</span></span></span><br><span><var>s</var><span class="hyp-type"><b>: </b><span>state</span></span></span><br><span><var>l0</var><span class="hyp-type"><b>: </b><span>label</span></span></span><br><span><var>input0</var><span class="hyp-type"><b>: </b><span>option message</span></span></span><br><span><var>destination0</var><span class="hyp-type"><b>: </b><span>state</span></span></span><br><span><var>output0</var><span class="hyp-type"><b>: </b><span>option message</span></span></span><br><span><var>suffix</var><span class="hyp-type"><b>: </b><span>Stream transition_item</span></span></span><br><span><var>Htr</var><span class="hyp-type"><b>: </b><span>infinite_valid_trace_from s
  (stream_app (p ++ [last_p])
     (Cons
        {|
          l := l0;
          input := input0;
          destination := destination0;
          output := output0
        |} suffix))</span></span></span><br><span><var>Hinit</var><span class="hyp-type"><b>: </b><span>initial_state_prop s</span></span></span><br><span><var>Hptr</var><span class="hyp-type"><b>: </b><span>finite_valid_trace_from s (p ++ [last_p])</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">input_valid_transition l0
  (finite_trace_last s (p ++ [last_p]), input0)
  (destination0, output0)</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">          </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="VLSM-v-chk3c9" style="display: none" type="checkbox"><label class="alectryon-input" for="VLSM-v-chk3c9"><span class="nb">rewrite</span> &lt;- stream_app_cons <span class="kr">in</span> Htr.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>message</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>X</var><span class="hyp-type"><b>: </b><span>VLSM message</span></span></span><br><span><var>TypeX</var><span><span class="hyp-body"><b>:= </b><span>type X</span></span><span class="hyp-type"><b>: </b><span>VLSMType message</span></span></span></span><br><span><var>MachineX</var><span><span class="hyp-body"><b>:= </b><span>machine X</span></span><span class="hyp-type"><b>: </b><span>VLSMMachine (vtype X)</span></span></span></span><br><span><var>prefix</var><span class="hyp-type"><b>: </b><span>list transition_item</span></span></span><br><span><var>last_p</var><span class="hyp-type"><b>: </b><span>transition_item</span></span></span><br><span><var>p</var><span class="hyp-type"><b>: </b><span>list transition_item</span></span></span><br><span><var>s</var><span class="hyp-type"><b>: </b><span>state</span></span></span><br><span><var>l0</var><span class="hyp-type"><b>: </b><span>label</span></span></span><br><span><var>input0</var><span class="hyp-type"><b>: </b><span>option message</span></span></span><br><span><var>destination0</var><span class="hyp-type"><b>: </b><span>state</span></span></span><br><span><var>output0</var><span class="hyp-type"><b>: </b><span>option message</span></span></span><br><span><var>suffix</var><span class="hyp-type"><b>: </b><span>Stream transition_item</span></span></span><br><span><var>Htr</var><span class="hyp-type"><b>: </b><span>infinite_valid_trace_from s
  (stream_app (p ++ [last_p])
     (stream_app
        [{|
           l := l0;
           input := input0;
           destination := destination0;
           output := output0
         |}] suffix))</span></span></span><br><span><var>Hinit</var><span class="hyp-type"><b>: </b><span>initial_state_prop s</span></span></span><br><span><var>Hptr</var><span class="hyp-type"><b>: </b><span>finite_valid_trace_from s (p ++ [last_p])</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">input_valid_transition l0
  (finite_trace_last s (p ++ [last_p]), input0)
  (destination0, output0)</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">          </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="VLSM-v-chk3ca" style="display: none" type="checkbox"><label class="alectryon-input" for="VLSM-v-chk3ca"><span class="nb">rewrite</span> stream_app_assoc <span class="kr">in</span> Htr.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>message</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>X</var><span class="hyp-type"><b>: </b><span>VLSM message</span></span></span><br><span><var>TypeX</var><span><span class="hyp-body"><b>:= </b><span>type X</span></span><span class="hyp-type"><b>: </b><span>VLSMType message</span></span></span></span><br><span><var>MachineX</var><span><span class="hyp-body"><b>:= </b><span>machine X</span></span><span class="hyp-type"><b>: </b><span>VLSMMachine (vtype X)</span></span></span></span><br><span><var>prefix</var><span class="hyp-type"><b>: </b><span>list transition_item</span></span></span><br><span><var>last_p</var><span class="hyp-type"><b>: </b><span>transition_item</span></span></span><br><span><var>p</var><span class="hyp-type"><b>: </b><span>list transition_item</span></span></span><br><span><var>s</var><span class="hyp-type"><b>: </b><span>state</span></span></span><br><span><var>l0</var><span class="hyp-type"><b>: </b><span>label</span></span></span><br><span><var>input0</var><span class="hyp-type"><b>: </b><span>option message</span></span></span><br><span><var>destination0</var><span class="hyp-type"><b>: </b><span>state</span></span></span><br><span><var>output0</var><span class="hyp-type"><b>: </b><span>option message</span></span></span><br><span><var>suffix</var><span class="hyp-type"><b>: </b><span>Stream transition_item</span></span></span><br><span><var>Htr</var><span class="hyp-type"><b>: </b><span>infinite_valid_trace_from s
  (stream_app
     ((p ++ [last_p]) ++
      [{|
         l := l0;
         input := input0;
         destination := destination0;
         output := output0
       |}]) suffix)</span></span></span><br><span><var>Hinit</var><span class="hyp-type"><b>: </b><span>initial_state_prop s</span></span></span><br><span><var>Hptr</var><span class="hyp-type"><b>: </b><span>finite_valid_trace_from s (p ++ [last_p])</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">input_valid_transition l0
  (finite_trace_last s (p ++ [last_p]), input0)
  (destination0, output0)</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">          </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="VLSM-v-chk3cb" style="display: none" type="checkbox"><label class="alectryon-input" for="VLSM-v-chk3cb"><span class="nb">rewrite</span> &lt;- (app_assoc p _ _) <span class="kr">in</span> Htr.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>message</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>X</var><span class="hyp-type"><b>: </b><span>VLSM message</span></span></span><br><span><var>TypeX</var><span><span class="hyp-body"><b>:= </b><span>type X</span></span><span class="hyp-type"><b>: </b><span>VLSMType message</span></span></span></span><br><span><var>MachineX</var><span><span class="hyp-body"><b>:= </b><span>machine X</span></span><span class="hyp-type"><b>: </b><span>VLSMMachine (vtype X)</span></span></span></span><br><span><var>prefix</var><span class="hyp-type"><b>: </b><span>list transition_item</span></span></span><br><span><var>last_p</var><span class="hyp-type"><b>: </b><span>transition_item</span></span></span><br><span><var>p</var><span class="hyp-type"><b>: </b><span>list transition_item</span></span></span><br><span><var>s</var><span class="hyp-type"><b>: </b><span>state</span></span></span><br><span><var>l0</var><span class="hyp-type"><b>: </b><span>label</span></span></span><br><span><var>input0</var><span class="hyp-type"><b>: </b><span>option message</span></span></span><br><span><var>destination0</var><span class="hyp-type"><b>: </b><span>state</span></span></span><br><span><var>output0</var><span class="hyp-type"><b>: </b><span>option message</span></span></span><br><span><var>suffix</var><span class="hyp-type"><b>: </b><span>Stream transition_item</span></span></span><br><span><var>Htr</var><span class="hyp-type"><b>: </b><span>infinite_valid_trace_from s
  (stream_app
     (p ++
      [last_p] ++
      [{|
         l := l0;
         input := input0;
         destination := destination0;
         output := output0
       |}]) suffix)</span></span></span><br><span><var>Hinit</var><span class="hyp-type"><b>: </b><span>initial_state_prop s</span></span></span><br><span><var>Hptr</var><span class="hyp-type"><b>: </b><span>finite_valid_trace_from s (p ++ [last_p])</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">input_valid_transition l0
  (finite_trace_last s (p ++ [last_p]), input0)
  (destination0, output0)</div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="VLSM-v-chk3cc" style="display: none" type="checkbox"><label class="alectryon-input" for="VLSM-v-chk3cc"><span class="nb">simpl</span> <span class="kr">in</span> Htr.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>message</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>X</var><span class="hyp-type"><b>: </b><span>VLSM message</span></span></span><br><span><var>TypeX</var><span><span class="hyp-body"><b>:= </b><span>type X</span></span><span class="hyp-type"><b>: </b><span>VLSMType message</span></span></span></span><br><span><var>MachineX</var><span><span class="hyp-body"><b>:= </b><span>machine X</span></span><span class="hyp-type"><b>: </b><span>VLSMMachine (vtype X)</span></span></span></span><br><span><var>prefix</var><span class="hyp-type"><b>: </b><span>list transition_item</span></span></span><br><span><var>last_p</var><span class="hyp-type"><b>: </b><span>transition_item</span></span></span><br><span><var>p</var><span class="hyp-type"><b>: </b><span>list transition_item</span></span></span><br><span><var>s</var><span class="hyp-type"><b>: </b><span>state</span></span></span><br><span><var>l0</var><span class="hyp-type"><b>: </b><span>label</span></span></span><br><span><var>input0</var><span class="hyp-type"><b>: </b><span>option message</span></span></span><br><span><var>destination0</var><span class="hyp-type"><b>: </b><span>state</span></span></span><br><span><var>output0</var><span class="hyp-type"><b>: </b><span>option message</span></span></span><br><span><var>suffix</var><span class="hyp-type"><b>: </b><span>Stream transition_item</span></span></span><br><span><var>Htr</var><span class="hyp-type"><b>: </b><span>infinite_valid_trace_from s
  (stream_app
     (p ++
      [last_p;
      {|
        l := l0;
        input := input0;
        destination := destination0;
        output := output0
      |}]) suffix)</span></span></span><br><span><var>Hinit</var><span class="hyp-type"><b>: </b><span>initial_state_prop s</span></span></span><br><span><var>Hptr</var><span class="hyp-type"><b>: </b><span>finite_valid_trace_from s (p ++ [last_p])</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">input_valid_transition l0
  (finite_trace_last s (p ++ [last_p]), input0)
  (destination0, output0)</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">          </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="VLSM-v-chk3cd" style="display: none" type="checkbox"><label class="alectryon-input" for="VLSM-v-chk3cd"><span class="nb">specialize</span>
            (infinite_valid_trace_consecutive_valid_transition
               s
               (stream_app (p ++ [last_p; {| l := l0; input := input0; destination := destination0; output := output0 |}]) suffix)
               suffix
               p
               last_p
               {| l := l0; input := input0; destination := destination0; output := output0 |}
               Htr
               eq_refl
            ).</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>message</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>X</var><span class="hyp-type"><b>: </b><span>VLSM message</span></span></span><br><span><var>TypeX</var><span><span class="hyp-body"><b>:= </b><span>type X</span></span><span class="hyp-type"><b>: </b><span>VLSMType message</span></span></span></span><br><span><var>MachineX</var><span><span class="hyp-body"><b>:= </b><span>machine X</span></span><span class="hyp-type"><b>: </b><span>VLSMMachine (vtype X)</span></span></span></span><br><span><var>prefix</var><span class="hyp-type"><b>: </b><span>list transition_item</span></span></span><br><span><var>last_p</var><span class="hyp-type"><b>: </b><span>transition_item</span></span></span><br><span><var>p</var><span class="hyp-type"><b>: </b><span>list transition_item</span></span></span><br><span><var>s</var><span class="hyp-type"><b>: </b><span>state</span></span></span><br><span><var>l0</var><span class="hyp-type"><b>: </b><span>label</span></span></span><br><span><var>input0</var><span class="hyp-type"><b>: </b><span>option message</span></span></span><br><span><var>destination0</var><span class="hyp-type"><b>: </b><span>state</span></span></span><br><span><var>output0</var><span class="hyp-type"><b>: </b><span>option message</span></span></span><br><span><var>suffix</var><span class="hyp-type"><b>: </b><span>Stream transition_item</span></span></span><br><span><var>Htr</var><span class="hyp-type"><b>: </b><span>infinite_valid_trace_from s
  (stream_app
     (p ++
      [last_p;
      {|
        l := l0;
        input := input0;
        destination := destination0;
        output := output0
      |}]) suffix)</span></span></span><br><span><var>Hinit</var><span class="hyp-type"><b>: </b><span>initial_state_prop s</span></span></span><br><span><var>Hptr</var><span class="hyp-type"><b>: </b><span>finite_valid_trace_from s (p ++ [last_p])</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">input_valid_transition
  (l
     {|
       l := l0;
       input := input0;
       destination := destination0;
       output := output0
     |})
  (destination last_p,
  input
    {|
      l := l0;
      input := input0;
      destination := destination0;
      output := output0
    |})
  (destination
     {|
       l := l0;
       input := input0;
       destination := destination0;
       output := output0
     |},
  output
    {|
      l := l0;
      input := input0;
      destination := destination0;
      output := output0
    |})
‚Üí input_valid_transition l0
    (finite_trace_last s (p ++ [last_p]), input0)
    (destination0, output0)</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">          </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="VLSM-v-chk3ce" style="display: none" type="checkbox"><label class="alectryon-input" for="VLSM-v-chk3ce"><span class="nb">simpl</span>.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>message</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>X</var><span class="hyp-type"><b>: </b><span>VLSM message</span></span></span><br><span><var>TypeX</var><span><span class="hyp-body"><b>:= </b><span>type X</span></span><span class="hyp-type"><b>: </b><span>VLSMType message</span></span></span></span><br><span><var>MachineX</var><span><span class="hyp-body"><b>:= </b><span>machine X</span></span><span class="hyp-type"><b>: </b><span>VLSMMachine (vtype X)</span></span></span></span><br><span><var>prefix</var><span class="hyp-type"><b>: </b><span>list transition_item</span></span></span><br><span><var>last_p</var><span class="hyp-type"><b>: </b><span>transition_item</span></span></span><br><span><var>p</var><span class="hyp-type"><b>: </b><span>list transition_item</span></span></span><br><span><var>s</var><span class="hyp-type"><b>: </b><span>state</span></span></span><br><span><var>l0</var><span class="hyp-type"><b>: </b><span>label</span></span></span><br><span><var>input0</var><span class="hyp-type"><b>: </b><span>option message</span></span></span><br><span><var>destination0</var><span class="hyp-type"><b>: </b><span>state</span></span></span><br><span><var>output0</var><span class="hyp-type"><b>: </b><span>option message</span></span></span><br><span><var>suffix</var><span class="hyp-type"><b>: </b><span>Stream transition_item</span></span></span><br><span><var>Htr</var><span class="hyp-type"><b>: </b><span>infinite_valid_trace_from s
  (stream_app
     (p ++
      [last_p;
      {|
        l := l0;
        input := input0;
        destination := destination0;
        output := output0
      |}]) suffix)</span></span></span><br><span><var>Hinit</var><span class="hyp-type"><b>: </b><span>initial_state_prop s</span></span></span><br><span><var>Hptr</var><span class="hyp-type"><b>: </b><span>finite_valid_trace_from s (p ++ [last_p])</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">input_valid_transition l0 (destination last_p, input0)
  (destination0, output0)
‚Üí input_valid_transition l0
    (finite_trace_last s (p ++ [last_p]), input0)
    (destination0, output0)</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">          </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="VLSM-v-chk3cf" style="display: none" type="checkbox"><label class="alectryon-input" for="VLSM-v-chk3cf"><span class="nb">rewrite</span> finite_trace_last_is_last.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>message</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>X</var><span class="hyp-type"><b>: </b><span>VLSM message</span></span></span><br><span><var>TypeX</var><span><span class="hyp-body"><b>:= </b><span>type X</span></span><span class="hyp-type"><b>: </b><span>VLSMType message</span></span></span></span><br><span><var>MachineX</var><span><span class="hyp-body"><b>:= </b><span>machine X</span></span><span class="hyp-type"><b>: </b><span>VLSMMachine (vtype X)</span></span></span></span><br><span><var>prefix</var><span class="hyp-type"><b>: </b><span>list transition_item</span></span></span><br><span><var>last_p</var><span class="hyp-type"><b>: </b><span>transition_item</span></span></span><br><span><var>p</var><span class="hyp-type"><b>: </b><span>list transition_item</span></span></span><br><span><var>s</var><span class="hyp-type"><b>: </b><span>state</span></span></span><br><span><var>l0</var><span class="hyp-type"><b>: </b><span>label</span></span></span><br><span><var>input0</var><span class="hyp-type"><b>: </b><span>option message</span></span></span><br><span><var>destination0</var><span class="hyp-type"><b>: </b><span>state</span></span></span><br><span><var>output0</var><span class="hyp-type"><b>: </b><span>option message</span></span></span><br><span><var>suffix</var><span class="hyp-type"><b>: </b><span>Stream transition_item</span></span></span><br><span><var>Htr</var><span class="hyp-type"><b>: </b><span>infinite_valid_trace_from s
  (stream_app
     (p ++
      [last_p;
      {|
        l := l0;
        input := input0;
        destination := destination0;
        output := output0
      |}]) suffix)</span></span></span><br><span><var>Hinit</var><span class="hyp-type"><b>: </b><span>initial_state_prop s</span></span></span><br><span><var>Hptr</var><span class="hyp-type"><b>: </b><span>finite_valid_trace_from s (p ++ [last_p])</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">input_valid_transition l0 (destination last_p, input0)
  (destination0, output0)
‚Üí input_valid_transition l0
    (destination last_p, input0)
    (destination0, output0)</div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="nb">trivial</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Qed</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">

</span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Definition</span> <span class="nf">build_trace_prefix_valid</span>
          {<span class="nv">tr</span> : valid_trace}
          {<span class="nv">last</span> : transition_item}
          {<span class="nv">prefix</span> : list transition_item}
          (<span class="nv">Hprefix</span> : trace_prefix (proj1_sig tr) <span class="nb">last</span> prefix)
          : valid_trace
      := exist _ (Finite (trace_first (proj1_sig tr)) (prefix ++ [<span class="nb">last</span>]))
               (trace_prefix_valid tr <span class="nb">last</span> prefix Hprefix).</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
</span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="VLSM-v-chk3d0" style="display: none" type="checkbox"><label class="alectryon-input" for="VLSM-v-chk3d0"><span class="kn">Lemma</span> <span class="nf">trace_prefix_fn_valid</span>
          (<span class="nv">tr</span> : Trace)
          (<span class="nv">Htr</span> : valid_trace_prop tr)
          (<span class="nv">n</span> : nat)
      : valid_trace_prop (trace_prefix_fn tr n).</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>message</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>X</var><span class="hyp-type"><b>: </b><span>VLSM message</span></span></span><br><span><var>TypeX</var><span><span class="hyp-body"><b>:= </b><span>type X</span></span><span class="hyp-type"><b>: </b><span>VLSMType message</span></span></span></span><br><span><var>MachineX</var><span><span class="hyp-body"><b>:= </b><span>machine X</span></span><span class="hyp-type"><b>: </b><span>VLSMMachine (vtype X)</span></span></span></span><br><span><var>tr</var><span class="hyp-type"><b>: </b><span>Trace</span></span></span><br><span><var>Htr</var><span class="hyp-type"><b>: </b><span>valid_trace_prop tr</span></span></span><br><span><var>n</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">valid_trace_prop (trace_prefix_fn tr n)</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="VLSM-v-chk3d1" style="display: none" type="checkbox"><label class="alectryon-input" for="VLSM-v-chk3d1"><span class="kn">Proof</span>.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>message</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>X</var><span class="hyp-type"><b>: </b><span>VLSM message</span></span></span><br><span><var>TypeX</var><span><span class="hyp-body"><b>:= </b><span>type X</span></span><span class="hyp-type"><b>: </b><span>VLSMType message</span></span></span></span><br><span><var>MachineX</var><span><span class="hyp-body"><b>:= </b><span>machine X</span></span><span class="hyp-type"><b>: </b><span>VLSMMachine (vtype X)</span></span></span></span><br><span><var>tr</var><span class="hyp-type"><b>: </b><span>Trace</span></span></span><br><span><var>Htr</var><span class="hyp-type"><b>: </b><span>valid_trace_prop tr</span></span></span><br><span><var>n</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">valid_trace_prop (trace_prefix_fn tr n)</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">      </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="VLSM-v-chk3d2" style="display: none" type="checkbox"><label class="alectryon-input" for="VLSM-v-chk3d2"><span class="nb">specialize</span> (trace_prefix_valid (exist _ tr Htr)); <span class="nb">simpl</span>; <span class="nb">intro</span> Hpref.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>message</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>X</var><span class="hyp-type"><b>: </b><span>VLSM message</span></span></span><br><span><var>TypeX</var><span><span class="hyp-body"><b>:= </b><span>type X</span></span><span class="hyp-type"><b>: </b><span>VLSMType message</span></span></span></span><br><span><var>MachineX</var><span><span class="hyp-body"><b>:= </b><span>machine X</span></span><span class="hyp-type"><b>: </b><span>VLSMMachine (vtype X)</span></span></span></span><br><span><var>tr</var><span class="hyp-type"><b>: </b><span>Trace</span></span></span><br><span><var>Htr</var><span class="hyp-type"><b>: </b><span>valid_trace_prop tr</span></span></span><br><span><var>n</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>Hpref</var><span class="hyp-type"><b>: </b><span><span class="kr">‚àÄ</span> (<span class="nv">last</span> : transition_item) 
  (<span class="nv">prefix</span> : list transition_item),
  trace_prefix tr <span class="nb">last</span> prefix
  ‚Üí finite_valid_trace 
      (trace_first tr) 
      (prefix ++ [<span class="nb">last</span>])</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">valid_trace_prop (trace_prefix_fn tr n)</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">      </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="VLSM-v-chk3d3" style="display: none" type="checkbox"><label class="alectryon-input" for="VLSM-v-chk3d3"><span class="nb">remember</span> (trace_prefix_fn tr n) <span class="kr">as</span> pref_tr.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>message</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>X</var><span class="hyp-type"><b>: </b><span>VLSM message</span></span></span><br><span><var>TypeX</var><span><span class="hyp-body"><b>:= </b><span>type X</span></span><span class="hyp-type"><b>: </b><span>VLSMType message</span></span></span></span><br><span><var>MachineX</var><span><span class="hyp-body"><b>:= </b><span>machine X</span></span><span class="hyp-type"><b>: </b><span>VLSMMachine (vtype X)</span></span></span></span><br><span><var>tr</var><span class="hyp-type"><b>: </b><span>Trace</span></span></span><br><span><var>Htr</var><span class="hyp-type"><b>: </b><span>valid_trace_prop tr</span></span></span><br><span><var>n</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>Hpref</var><span class="hyp-type"><b>: </b><span><span class="kr">‚àÄ</span> (<span class="nv">last</span> : transition_item) 
  (<span class="nv">prefix</span> : list transition_item),
  trace_prefix tr <span class="nb">last</span> prefix
  ‚Üí finite_valid_trace 
      (trace_first tr) 
      (prefix ++ [<span class="nb">last</span>])</span></span></span><br><span><var>pref_tr</var><span class="hyp-type"><b>: </b><span>Trace</span></span></span><br><span><var>Heqpref_tr</var><span class="hyp-type"><b>: </b><span>pref_tr = trace_prefix_fn tr n</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">valid_trace_prop pref_tr</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">      </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="VLSM-v-chk3d4" style="display: none" type="checkbox"><label class="alectryon-input" for="VLSM-v-chk3d4"><span class="nb">destruct</span> pref_tr <span class="kr">as</span> [s l | s l].</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>message</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>X</var><span class="hyp-type"><b>: </b><span>VLSM message</span></span></span><br><span><var>TypeX</var><span><span class="hyp-body"><b>:= </b><span>type X</span></span><span class="hyp-type"><b>: </b><span>VLSMType message</span></span></span></span><br><span><var>MachineX</var><span><span class="hyp-body"><b>:= </b><span>machine X</span></span><span class="hyp-type"><b>: </b><span>VLSMMachine (vtype X)</span></span></span></span><br><span><var>tr</var><span class="hyp-type"><b>: </b><span>Trace</span></span></span><br><span><var>Htr</var><span class="hyp-type"><b>: </b><span>valid_trace_prop tr</span></span></span><br><span><var>n</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>Hpref</var><span class="hyp-type"><b>: </b><span><span class="kr">‚àÄ</span> (<span class="nv">last</span> : transition_item) 
  (<span class="nv">prefix</span> : list transition_item),
  trace_prefix tr <span class="nb">last</span> prefix
  ‚Üí finite_valid_trace 
      (trace_first tr) 
      (prefix ++ [<span class="nb">last</span>])</span></span></span><br><span><var>s</var><span class="hyp-type"><b>: </b><span>state</span></span></span><br><span><var>l</var><span class="hyp-type"><b>: </b><span>list transition_item</span></span></span><br><span><var>Heqpref_tr</var><span class="hyp-type"><b>: </b><span>Finite s l = trace_prefix_fn tr n</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">valid_trace_prop (Finite s l)</div></blockquote><div class="alectryon-extra-goals"><input class="alectryon-extra-goal-toggle" id="VLSM-v-chk3d5" style="display: none" type="checkbox"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>message</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>X</var><span class="hyp-type"><b>: </b><span>VLSM message</span></span></span><br><span><var>TypeX</var><span><span class="hyp-body"><b>:= </b><span>type X</span></span><span class="hyp-type"><b>: </b><span>VLSMType message</span></span></span></span><br><span><var>MachineX</var><span><span class="hyp-body"><b>:= </b><span>machine X</span></span><span class="hyp-type"><b>: </b><span>VLSMMachine (vtype X)</span></span></span></span><br><span><var>tr</var><span class="hyp-type"><b>: </b><span>Trace</span></span></span><br><span><var>Htr</var><span class="hyp-type"><b>: </b><span>valid_trace_prop tr</span></span></span><br><span><var>n</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>Hpref</var><span class="hyp-type"><b>: </b><span><span class="kr">‚àÄ</span> (<span class="nv">last</span> : transition_item) 
  (<span class="nv">prefix</span> : list transition_item),
  trace_prefix tr <span class="nb">last</span> prefix
  ‚Üí finite_valid_trace 
      (trace_first tr) 
      (prefix ++ [<span class="nb">last</span>])</span></span></span><br><span><var>s</var><span class="hyp-type"><b>: </b><span>state</span></span></span><br><span><var>l</var><span class="hyp-type"><b>: </b><span>Stream transition_item</span></span></span><br><span><var>Heqpref_tr</var><span class="hyp-type"><b>: </b><span>Infinite s l = trace_prefix_fn tr n</span></span></span><br></div><label class="goal-separator" for="VLSM-v-chk3d5"><hr></label><div class="goal-conclusion">valid_trace_prop (Infinite s l)</div></blockquote></div></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">      </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="VLSM-v-chk3d6" style="display: none" type="checkbox"><label class="alectryon-input" for="VLSM-v-chk3d6">-</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>message</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>X</var><span class="hyp-type"><b>: </b><span>VLSM message</span></span></span><br><span><var>TypeX</var><span><span class="hyp-body"><b>:= </b><span>type X</span></span><span class="hyp-type"><b>: </b><span>VLSMType message</span></span></span></span><br><span><var>MachineX</var><span><span class="hyp-body"><b>:= </b><span>machine X</span></span><span class="hyp-type"><b>: </b><span>VLSMMachine (vtype X)</span></span></span></span><br><span><var>tr</var><span class="hyp-type"><b>: </b><span>Trace</span></span></span><br><span><var>Htr</var><span class="hyp-type"><b>: </b><span>valid_trace_prop tr</span></span></span><br><span><var>n</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>Hpref</var><span class="hyp-type"><b>: </b><span><span class="kr">‚àÄ</span> (<span class="nv">last</span> : transition_item) 
  (<span class="nv">prefix</span> : list transition_item),
  trace_prefix tr <span class="nb">last</span> prefix
  ‚Üí finite_valid_trace 
      (trace_first tr) 
      (prefix ++ [<span class="nb">last</span>])</span></span></span><br><span><var>s</var><span class="hyp-type"><b>: </b><span>state</span></span></span><br><span><var>l</var><span class="hyp-type"><b>: </b><span>list transition_item</span></span></span><br><span><var>Heqpref_tr</var><span class="hyp-type"><b>: </b><span>Finite s l = trace_prefix_fn tr n</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">valid_trace_prop (Finite s l)</div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="VLSM-v-chk3d7" style="display: none" type="checkbox"><label class="alectryon-input" for="VLSM-v-chk3d7"><span class="nb">destruct</span> l <span class="kr">as</span> [| item l].</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>message</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>X</var><span class="hyp-type"><b>: </b><span>VLSM message</span></span></span><br><span><var>TypeX</var><span><span class="hyp-body"><b>:= </b><span>type X</span></span><span class="hyp-type"><b>: </b><span>VLSMType message</span></span></span></span><br><span><var>MachineX</var><span><span class="hyp-body"><b>:= </b><span>machine X</span></span><span class="hyp-type"><b>: </b><span>VLSMMachine (vtype X)</span></span></span></span><br><span><var>tr</var><span class="hyp-type"><b>: </b><span>Trace</span></span></span><br><span><var>Htr</var><span class="hyp-type"><b>: </b><span>valid_trace_prop tr</span></span></span><br><span><var>n</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>Hpref</var><span class="hyp-type"><b>: </b><span><span class="kr">‚àÄ</span> (<span class="nv">last</span> : transition_item) 
  (<span class="nv">prefix</span> : list transition_item),
  trace_prefix tr <span class="nb">last</span> prefix
  ‚Üí finite_valid_trace 
      (trace_first tr) 
      (prefix ++ [<span class="nb">last</span>])</span></span></span><br><span><var>s</var><span class="hyp-type"><b>: </b><span>state</span></span></span><br><span><var>Heqpref_tr</var><span class="hyp-type"><b>: </b><span>Finite s [] = trace_prefix_fn tr n</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">valid_trace_prop (Finite s [])</div></blockquote><div class="alectryon-extra-goals"><input class="alectryon-extra-goal-toggle" id="VLSM-v-chk3d8" style="display: none" type="checkbox"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>message</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>X</var><span class="hyp-type"><b>: </b><span>VLSM message</span></span></span><br><span><var>TypeX</var><span><span class="hyp-body"><b>:= </b><span>type X</span></span><span class="hyp-type"><b>: </b><span>VLSMType message</span></span></span></span><br><span><var>MachineX</var><span><span class="hyp-body"><b>:= </b><span>machine X</span></span><span class="hyp-type"><b>: </b><span>VLSMMachine (vtype X)</span></span></span></span><br><span><var>tr</var><span class="hyp-type"><b>: </b><span>Trace</span></span></span><br><span><var>Htr</var><span class="hyp-type"><b>: </b><span>valid_trace_prop tr</span></span></span><br><span><var>n</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>Hpref</var><span class="hyp-type"><b>: </b><span><span class="kr">‚àÄ</span> (<span class="nv">last</span> : transition_item) 
  (<span class="nv">prefix</span> : list transition_item),
  trace_prefix tr <span class="nb">last</span> prefix
  ‚Üí finite_valid_trace 
      (trace_first tr) 
      (prefix ++ [<span class="nb">last</span>])</span></span></span><br><span><var>s</var><span class="hyp-type"><b>: </b><span>state</span></span></span><br><span><var>item</var><span class="hyp-type"><b>: </b><span>transition_item</span></span></span><br><span><var>l</var><span class="hyp-type"><b>: </b><span>list transition_item</span></span></span><br><span><var>Heqpref_tr</var><span class="hyp-type"><b>: </b><span>Finite s (item :: l) =
trace_prefix_fn tr n</span></span></span><br></div><label class="goal-separator" for="VLSM-v-chk3d8"><hr></label><div class="goal-conclusion">valid_trace_prop (Finite s (item :: l))</div></blockquote></div></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">        </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="VLSM-v-chk3d9" style="display: none" type="checkbox"><label class="alectryon-input" for="VLSM-v-chk3d9">+</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>message</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>X</var><span class="hyp-type"><b>: </b><span>VLSM message</span></span></span><br><span><var>TypeX</var><span><span class="hyp-body"><b>:= </b><span>type X</span></span><span class="hyp-type"><b>: </b><span>VLSMType message</span></span></span></span><br><span><var>MachineX</var><span><span class="hyp-body"><b>:= </b><span>machine X</span></span><span class="hyp-type"><b>: </b><span>VLSMMachine (vtype X)</span></span></span></span><br><span><var>tr</var><span class="hyp-type"><b>: </b><span>Trace</span></span></span><br><span><var>Htr</var><span class="hyp-type"><b>: </b><span>valid_trace_prop tr</span></span></span><br><span><var>n</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>Hpref</var><span class="hyp-type"><b>: </b><span><span class="kr">‚àÄ</span> (<span class="nv">last</span> : transition_item) 
  (<span class="nv">prefix</span> : list transition_item),
  trace_prefix tr <span class="nb">last</span> prefix
  ‚Üí finite_valid_trace 
      (trace_first tr) 
      (prefix ++ [<span class="nb">last</span>])</span></span></span><br><span><var>s</var><span class="hyp-type"><b>: </b><span>state</span></span></span><br><span><var>Heqpref_tr</var><span class="hyp-type"><b>: </b><span>Finite s [] = trace_prefix_fn tr n</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">valid_trace_prop (Finite s [])</div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="nb">destruct</span> tr <span class="kr">as</span> [s&#39; l&#39; | s&#39; l&#39;]
          ; <span class="nb">destruct</span> Htr <span class="kr">as</span> [Htr Hinit]
          ; <span class="nb">inversion</span> Heqpref_tr; <span class="nb">subst</span>
          ; (<span class="nb">split</span>;[|<span class="bp">assumption</span>])
          ; <span class="nb">constructor</span>
          ;  <span class="nb">apply</span> initial_state_is_valid;<span class="bp">assumption</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">        </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="VLSM-v-chk3da" style="display: none" type="checkbox"><label class="alectryon-input" for="VLSM-v-chk3da">+</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>message</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>X</var><span class="hyp-type"><b>: </b><span>VLSM message</span></span></span><br><span><var>TypeX</var><span><span class="hyp-body"><b>:= </b><span>type X</span></span><span class="hyp-type"><b>: </b><span>VLSMType message</span></span></span></span><br><span><var>MachineX</var><span><span class="hyp-body"><b>:= </b><span>machine X</span></span><span class="hyp-type"><b>: </b><span>VLSMMachine (vtype X)</span></span></span></span><br><span><var>tr</var><span class="hyp-type"><b>: </b><span>Trace</span></span></span><br><span><var>Htr</var><span class="hyp-type"><b>: </b><span>valid_trace_prop tr</span></span></span><br><span><var>n</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>Hpref</var><span class="hyp-type"><b>: </b><span><span class="kr">‚àÄ</span> (<span class="nv">last</span> : transition_item) 
  (<span class="nv">prefix</span> : list transition_item),
  trace_prefix tr <span class="nb">last</span> prefix
  ‚Üí finite_valid_trace 
      (trace_first tr) 
      (prefix ++ [<span class="nb">last</span>])</span></span></span><br><span><var>s</var><span class="hyp-type"><b>: </b><span>state</span></span></span><br><span><var>item</var><span class="hyp-type"><b>: </b><span>transition_item</span></span></span><br><span><var>l</var><span class="hyp-type"><b>: </b><span>list transition_item</span></span></span><br><span><var>Heqpref_tr</var><span class="hyp-type"><b>: </b><span>Finite s (item :: l) =
trace_prefix_fn tr n</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">valid_trace_prop (Finite s (item :: l))</div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="VLSM-v-chk3db" style="display: none" type="checkbox"><label class="alectryon-input" for="VLSM-v-chk3db"><span class="nb">assert</span> (Hnnil : item ::l &lt;&gt; [])
            <span class="bp">by</span> (<span class="nb">intro</span> Hnil; <span class="nb">inversion</span> Hnil).</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>message</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>X</var><span class="hyp-type"><b>: </b><span>VLSM message</span></span></span><br><span><var>TypeX</var><span><span class="hyp-body"><b>:= </b><span>type X</span></span><span class="hyp-type"><b>: </b><span>VLSMType message</span></span></span></span><br><span><var>MachineX</var><span><span class="hyp-body"><b>:= </b><span>machine X</span></span><span class="hyp-type"><b>: </b><span>VLSMMachine (vtype X)</span></span></span></span><br><span><var>tr</var><span class="hyp-type"><b>: </b><span>Trace</span></span></span><br><span><var>Htr</var><span class="hyp-type"><b>: </b><span>valid_trace_prop tr</span></span></span><br><span><var>n</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>Hpref</var><span class="hyp-type"><b>: </b><span><span class="kr">‚àÄ</span> (<span class="nv">last</span> : transition_item) 
  (<span class="nv">prefix</span> : list transition_item),
  trace_prefix tr <span class="nb">last</span> prefix
  ‚Üí finite_valid_trace 
      (trace_first tr) 
      (prefix ++ [<span class="nb">last</span>])</span></span></span><br><span><var>s</var><span class="hyp-type"><b>: </b><span>state</span></span></span><br><span><var>item</var><span class="hyp-type"><b>: </b><span>transition_item</span></span></span><br><span><var>l</var><span class="hyp-type"><b>: </b><span>list transition_item</span></span></span><br><span><var>Heqpref_tr</var><span class="hyp-type"><b>: </b><span>Finite s (item :: l) =
trace_prefix_fn tr n</span></span></span><br><span><var>Hnnil</var><span class="hyp-type"><b>: </b><span>item :: l ‚â† []</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">valid_trace_prop (Finite s (item :: l))</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">          </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="VLSM-v-chk3dc" style="display: none" type="checkbox"><label class="alectryon-input" for="VLSM-v-chk3dc"><span class="nb">specialize</span> (exists_last Hnnil); <span class="nb">intros</span> [prefix [<span class="nb">last</span> Heq]].</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>message</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>X</var><span class="hyp-type"><b>: </b><span>VLSM message</span></span></span><br><span><var>TypeX</var><span><span class="hyp-body"><b>:= </b><span>type X</span></span><span class="hyp-type"><b>: </b><span>VLSMType message</span></span></span></span><br><span><var>MachineX</var><span><span class="hyp-body"><b>:= </b><span>machine X</span></span><span class="hyp-type"><b>: </b><span>VLSMMachine (vtype X)</span></span></span></span><br><span><var>tr</var><span class="hyp-type"><b>: </b><span>Trace</span></span></span><br><span><var>Htr</var><span class="hyp-type"><b>: </b><span>valid_trace_prop tr</span></span></span><br><span><var>n</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>Hpref</var><span class="hyp-type"><b>: </b><span><span class="kr">‚àÄ</span> (<span class="nv">last</span> : transition_item) 
  (<span class="nv">prefix</span> : list transition_item),
  trace_prefix tr <span class="nb">last</span> prefix
  ‚Üí finite_valid_trace 
      (trace_first tr) 
      (prefix ++ [<span class="nb">last</span>])</span></span></span><br><span><var>s</var><span class="hyp-type"><b>: </b><span>state</span></span></span><br><span><var>item</var><span class="hyp-type"><b>: </b><span>transition_item</span></span></span><br><span><var>l</var><span class="hyp-type"><b>: </b><span>list transition_item</span></span></span><br><span><var>Heqpref_tr</var><span class="hyp-type"><b>: </b><span>Finite s (item :: l) =
trace_prefix_fn tr n</span></span></span><br><span><var>Hnnil</var><span class="hyp-type"><b>: </b><span>item :: l ‚â† []</span></span></span><br><span><var>prefix</var><span class="hyp-type"><b>: </b><span>list transition_item</span></span></span><br><span><var>last</var><span class="hyp-type"><b>: </b><span>transition_item</span></span></span><br><span><var>Heq</var><span class="hyp-type"><b>: </b><span>item :: l = prefix ++ [<span class="nb">last</span>]</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">valid_trace_prop (Finite s (item :: l))</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">          </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="VLSM-v-chk3dd" style="display: none" type="checkbox"><label class="alectryon-input" for="VLSM-v-chk3dd"><span class="nb">rewrite</span> Heq <span class="kr">in</span> *; <span class="nb">clear</span> Hnnil Heq l item.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>message</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>X</var><span class="hyp-type"><b>: </b><span>VLSM message</span></span></span><br><span><var>TypeX</var><span><span class="hyp-body"><b>:= </b><span>type X</span></span><span class="hyp-type"><b>: </b><span>VLSMType message</span></span></span></span><br><span><var>MachineX</var><span><span class="hyp-body"><b>:= </b><span>machine X</span></span><span class="hyp-type"><b>: </b><span>VLSMMachine (vtype X)</span></span></span></span><br><span><var>tr</var><span class="hyp-type"><b>: </b><span>Trace</span></span></span><br><span><var>Htr</var><span class="hyp-type"><b>: </b><span>valid_trace_prop tr</span></span></span><br><span><var>n</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>Hpref</var><span class="hyp-type"><b>: </b><span><span class="kr">‚àÄ</span> (<span class="nv">last</span> : transition_item) 
  (<span class="nv">prefix</span> : list transition_item),
  trace_prefix tr <span class="nb">last</span> prefix
  ‚Üí finite_valid_trace 
      (trace_first tr) 
      (prefix ++ [<span class="nb">last</span>])</span></span></span><br><span><var>s</var><span class="hyp-type"><b>: </b><span>state</span></span></span><br><span><var>prefix</var><span class="hyp-type"><b>: </b><span>list transition_item</span></span></span><br><span><var>last</var><span class="hyp-type"><b>: </b><span>transition_item</span></span></span><br><span><var>Heqpref_tr</var><span class="hyp-type"><b>: </b><span>Finite s (prefix ++ [<span class="nb">last</span>]) =
trace_prefix_fn tr n</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">valid_trace_prop (Finite s (prefix ++ [<span class="nb">last</span>]))</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">          </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="VLSM-v-chk3de" style="display: none" type="checkbox"><label class="alectryon-input" for="VLSM-v-chk3de"><span class="nb">replace</span> s <span class="kr">with</span> (trace_first (proj1_sig (exist _ tr Htr)))
          ; <span class="kp">try</span> (<span class="nb">destruct</span> tr; <span class="nb">inversion</span> Heqpref_tr; <span class="nb">subst</span>; <span class="bp">reflexivity</span>).</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>message</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>X</var><span class="hyp-type"><b>: </b><span>VLSM message</span></span></span><br><span><var>TypeX</var><span><span class="hyp-body"><b>:= </b><span>type X</span></span><span class="hyp-type"><b>: </b><span>VLSMType message</span></span></span></span><br><span><var>MachineX</var><span><span class="hyp-body"><b>:= </b><span>machine X</span></span><span class="hyp-type"><b>: </b><span>VLSMMachine (vtype X)</span></span></span></span><br><span><var>tr</var><span class="hyp-type"><b>: </b><span>Trace</span></span></span><br><span><var>Htr</var><span class="hyp-type"><b>: </b><span>valid_trace_prop tr</span></span></span><br><span><var>n</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>Hpref</var><span class="hyp-type"><b>: </b><span><span class="kr">‚àÄ</span> (<span class="nv">last</span> : transition_item) 
  (<span class="nv">prefix</span> : list transition_item),
  trace_prefix tr <span class="nb">last</span> prefix
  ‚Üí finite_valid_trace 
      (trace_first tr) 
      (prefix ++ [<span class="nb">last</span>])</span></span></span><br><span><var>s</var><span class="hyp-type"><b>: </b><span>state</span></span></span><br><span><var>prefix</var><span class="hyp-type"><b>: </b><span>list transition_item</span></span></span><br><span><var>last</var><span class="hyp-type"><b>: </b><span>transition_item</span></span></span><br><span><var>Heqpref_tr</var><span class="hyp-type"><b>: </b><span>Finite s (prefix ++ [<span class="nb">last</span>]) =
trace_prefix_fn tr n</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">valid_trace_prop
  (Finite (trace_first (`(tr ‚Üæ Htr)))
     (prefix ++ [<span class="nb">last</span>]))</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">          </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="VLSM-v-chk3df" style="display: none" type="checkbox"><label class="alectryon-input" for="VLSM-v-chk3df"><span class="nb">apply</span> trace_prefix_valid.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>message</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>X</var><span class="hyp-type"><b>: </b><span>VLSM message</span></span></span><br><span><var>TypeX</var><span><span class="hyp-body"><b>:= </b><span>type X</span></span><span class="hyp-type"><b>: </b><span>VLSMType message</span></span></span></span><br><span><var>MachineX</var><span><span class="hyp-body"><b>:= </b><span>machine X</span></span><span class="hyp-type"><b>: </b><span>VLSMMachine (vtype X)</span></span></span></span><br><span><var>tr</var><span class="hyp-type"><b>: </b><span>Trace</span></span></span><br><span><var>Htr</var><span class="hyp-type"><b>: </b><span>valid_trace_prop tr</span></span></span><br><span><var>n</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>Hpref</var><span class="hyp-type"><b>: </b><span><span class="kr">‚àÄ</span> (<span class="nv">last</span> : transition_item) 
  (<span class="nv">prefix</span> : list transition_item),
  trace_prefix tr <span class="nb">last</span> prefix
  ‚Üí finite_valid_trace 
      (trace_first tr) 
      (prefix ++ [<span class="nb">last</span>])</span></span></span><br><span><var>s</var><span class="hyp-type"><b>: </b><span>state</span></span></span><br><span><var>prefix</var><span class="hyp-type"><b>: </b><span>list transition_item</span></span></span><br><span><var>last</var><span class="hyp-type"><b>: </b><span>transition_item</span></span></span><br><span><var>Heqpref_tr</var><span class="hyp-type"><b>: </b><span>Finite s (prefix ++ [<span class="nb">last</span>]) =
trace_prefix_fn tr n</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">trace_prefix (`(tr ‚Üæ Htr)) <span class="nb">last</span> prefix</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">          </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="VLSM-v-chk3e0" style="display: none" type="checkbox"><label class="alectryon-input" for="VLSM-v-chk3e0"><span class="nb">remember</span> (prefix ++ [<span class="nb">last</span>]) <span class="kr">as</span> prefix_last.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>message</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>X</var><span class="hyp-type"><b>: </b><span>VLSM message</span></span></span><br><span><var>TypeX</var><span><span class="hyp-body"><b>:= </b><span>type X</span></span><span class="hyp-type"><b>: </b><span>VLSMType message</span></span></span></span><br><span><var>MachineX</var><span><span class="hyp-body"><b>:= </b><span>machine X</span></span><span class="hyp-type"><b>: </b><span>VLSMMachine (vtype X)</span></span></span></span><br><span><var>tr</var><span class="hyp-type"><b>: </b><span>Trace</span></span></span><br><span><var>Htr</var><span class="hyp-type"><b>: </b><span>valid_trace_prop tr</span></span></span><br><span><var>n</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>Hpref</var><span class="hyp-type"><b>: </b><span><span class="kr">‚àÄ</span> (<span class="nv">last</span> : transition_item) 
  (<span class="nv">prefix</span> : list transition_item),
  trace_prefix tr <span class="nb">last</span> prefix
  ‚Üí finite_valid_trace 
      (trace_first tr) 
      (prefix ++ [<span class="nb">last</span>])</span></span></span><br><span><var>s</var><span class="hyp-type"><b>: </b><span>state</span></span></span><br><span><var>prefix</var><span class="hyp-type"><b>: </b><span>list transition_item</span></span></span><br><span><var>last</var><span class="hyp-type"><b>: </b><span>transition_item</span></span></span><br><span><var>prefix_last</var><span class="hyp-type"><b>: </b><span>list transition_item</span></span></span><br><span><var>Heqprefix_last</var><span class="hyp-type"><b>: </b><span>prefix_last = prefix ++ [<span class="nb">last</span>]</span></span></span><br><span><var>Heqpref_tr</var><span class="hyp-type"><b>: </b><span>Finite s prefix_last =
trace_prefix_fn tr n</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">trace_prefix (`(tr ‚Üæ Htr)) <span class="nb">last</span> prefix</div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="VLSM-v-chk3e1" style="display: none" type="checkbox"><label class="alectryon-input" for="VLSM-v-chk3e1"><span class="nb">revert</span> Heqprefix_last.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>message</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>X</var><span class="hyp-type"><b>: </b><span>VLSM message</span></span></span><br><span><var>TypeX</var><span><span class="hyp-body"><b>:= </b><span>type X</span></span><span class="hyp-type"><b>: </b><span>VLSMType message</span></span></span></span><br><span><var>MachineX</var><span><span class="hyp-body"><b>:= </b><span>machine X</span></span><span class="hyp-type"><b>: </b><span>VLSMMachine (vtype X)</span></span></span></span><br><span><var>tr</var><span class="hyp-type"><b>: </b><span>Trace</span></span></span><br><span><var>Htr</var><span class="hyp-type"><b>: </b><span>valid_trace_prop tr</span></span></span><br><span><var>n</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>Hpref</var><span class="hyp-type"><b>: </b><span><span class="kr">‚àÄ</span> (<span class="nv">last</span> : transition_item) 
  (<span class="nv">prefix</span> : list transition_item),
  trace_prefix tr <span class="nb">last</span> prefix
  ‚Üí finite_valid_trace 
      (trace_first tr) 
      (prefix ++ [<span class="nb">last</span>])</span></span></span><br><span><var>s</var><span class="hyp-type"><b>: </b><span>state</span></span></span><br><span><var>prefix</var><span class="hyp-type"><b>: </b><span>list transition_item</span></span></span><br><span><var>last</var><span class="hyp-type"><b>: </b><span>transition_item</span></span></span><br><span><var>prefix_last</var><span class="hyp-type"><b>: </b><span>list transition_item</span></span></span><br><span><var>Heqpref_tr</var><span class="hyp-type"><b>: </b><span>Finite s prefix_last =
trace_prefix_fn tr n</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">prefix_last = prefix ++ [<span class="nb">last</span>]
‚Üí trace_prefix (`(tr ‚Üæ Htr)) <span class="nb">last</span> prefix</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">          </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="VLSM-v-chk3e2" style="display: none" type="checkbox"><label class="alectryon-input" for="VLSM-v-chk3e2"><span class="nb">destruct</span> tr <span class="kr">as</span> [s&#39; l&#39; | s&#39; l&#39;]
          ; <span class="nb">inversion</span> Heqpref_tr
          ; <span class="nb">subst</span>
          ; <span class="nb">clear</span> Heqpref_tr
          ; <span class="nb">simpl</span>
          ; <span class="nb">intro</span> Heqprefix.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>message</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>X</var><span class="hyp-type"><b>: </b><span>VLSM message</span></span></span><br><span><var>TypeX</var><span><span class="hyp-body"><b>:= </b><span>type X</span></span><span class="hyp-type"><b>: </b><span>VLSMType message</span></span></span></span><br><span><var>MachineX</var><span><span class="hyp-body"><b>:= </b><span>machine X</span></span><span class="hyp-type"><b>: </b><span>VLSMMachine (vtype X)</span></span></span></span><br><span><var>s'</var><span class="hyp-type"><b>: </b><span>state</span></span></span><br><span><var>l'</var><span class="hyp-type"><b>: </b><span>list transition_item</span></span></span><br><span><var>Htr</var><span class="hyp-type"><b>: </b><span>valid_trace_prop (Finite s&#39; l&#39;)</span></span></span><br><span><var>n</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>Hpref</var><span class="hyp-type"><b>: </b><span><span class="kr">‚àÄ</span> (<span class="nv">last</span> : transition_item) 
  (<span class="nv">prefix</span> : list transition_item),
  trace_prefix (Finite s&#39; l&#39;) <span class="nb">last</span> prefix
  ‚Üí finite_valid_trace
      (trace_first (Finite s&#39; l&#39;))
      (prefix ++ [<span class="nb">last</span>])</span></span></span><br><span><var>prefix</var><span class="hyp-type"><b>: </b><span>list transition_item</span></span></span><br><span><var>last</var><span class="hyp-type"><b>: </b><span>transition_item</span></span></span><br><span><var>Heqprefix</var><span class="hyp-type"><b>: </b><span>list_prefix l&#39; n = prefix ++ [<span class="nb">last</span>]</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="kr">‚àÉ</span> <span class="nv">suffix</span> : list transition_item,
  l&#39; = prefix ++ <span class="nb">last</span> :: suffix</div></blockquote><div class="alectryon-extra-goals"><input class="alectryon-extra-goal-toggle" id="VLSM-v-chk3e3" style="display: none" type="checkbox"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>message</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>X</var><span class="hyp-type"><b>: </b><span>VLSM message</span></span></span><br><span><var>TypeX</var><span><span class="hyp-body"><b>:= </b><span>type X</span></span><span class="hyp-type"><b>: </b><span>VLSMType message</span></span></span></span><br><span><var>MachineX</var><span><span class="hyp-body"><b>:= </b><span>machine X</span></span><span class="hyp-type"><b>: </b><span>VLSMMachine (vtype X)</span></span></span></span><br><span><var>s'</var><span class="hyp-type"><b>: </b><span>state</span></span></span><br><span><var>l'</var><span class="hyp-type"><b>: </b><span>Stream transition_item</span></span></span><br><span><var>Htr</var><span class="hyp-type"><b>: </b><span>valid_trace_prop (Infinite s&#39; l&#39;)</span></span></span><br><span><var>n</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>Hpref</var><span class="hyp-type"><b>: </b><span><span class="kr">‚àÄ</span> (<span class="nv">last</span> : transition_item) 
  (<span class="nv">prefix</span> : list transition_item),
  trace_prefix (Infinite s&#39; l&#39;) <span class="nb">last</span> prefix
  ‚Üí finite_valid_trace
      (trace_first (Infinite s&#39; l&#39;))
      (prefix ++ [<span class="nb">last</span>])</span></span></span><br><span><var>prefix</var><span class="hyp-type"><b>: </b><span>list transition_item</span></span></span><br><span><var>last</var><span class="hyp-type"><b>: </b><span>transition_item</span></span></span><br><span><var>Heqprefix</var><span class="hyp-type"><b>: </b><span>stream_prefix l&#39; n = prefix ++ [<span class="nb">last</span>]</span></span></span><br></div><label class="goal-separator" for="VLSM-v-chk3e3"><hr></label><div class="goal-conclusion"><span class="kr">‚àÉ</span> <span class="nv">suffix</span> : Stream transition_item,
  l&#39; = stream_app prefix (Cons <span class="nb">last</span> suffix)</div></blockquote></div></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">          </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="VLSM-v-chk3e4" style="display: none" type="checkbox"><label class="alectryon-input" for="VLSM-v-chk3e4">*</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>message</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>X</var><span class="hyp-type"><b>: </b><span>VLSM message</span></span></span><br><span><var>TypeX</var><span><span class="hyp-body"><b>:= </b><span>type X</span></span><span class="hyp-type"><b>: </b><span>VLSMType message</span></span></span></span><br><span><var>MachineX</var><span><span class="hyp-body"><b>:= </b><span>machine X</span></span><span class="hyp-type"><b>: </b><span>VLSMMachine (vtype X)</span></span></span></span><br><span><var>s'</var><span class="hyp-type"><b>: </b><span>state</span></span></span><br><span><var>l'</var><span class="hyp-type"><b>: </b><span>list transition_item</span></span></span><br><span><var>Htr</var><span class="hyp-type"><b>: </b><span>valid_trace_prop (Finite s&#39; l&#39;)</span></span></span><br><span><var>n</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>Hpref</var><span class="hyp-type"><b>: </b><span><span class="kr">‚àÄ</span> (<span class="nv">last</span> : transition_item) 
  (<span class="nv">prefix</span> : list transition_item),
  trace_prefix (Finite s&#39; l&#39;) <span class="nb">last</span> prefix
  ‚Üí finite_valid_trace
      (trace_first (Finite s&#39; l&#39;))
      (prefix ++ [<span class="nb">last</span>])</span></span></span><br><span><var>prefix</var><span class="hyp-type"><b>: </b><span>list transition_item</span></span></span><br><span><var>last</var><span class="hyp-type"><b>: </b><span>transition_item</span></span></span><br><span><var>Heqprefix</var><span class="hyp-type"><b>: </b><span>list_prefix l&#39; n = prefix ++ [<span class="nb">last</span>]</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="kr">‚àÉ</span> <span class="nv">suffix</span> : list transition_item,
  l&#39; = prefix ++ <span class="nb">last</span> :: suffix</div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="VLSM-v-chk3e5" style="display: none" type="checkbox"><label class="alectryon-input" for="VLSM-v-chk3e5"><span class="nb">specialize</span> (list_prefix_suffix l&#39; n); <span class="nb">intro</span> Hl&#39;.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>message</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>X</var><span class="hyp-type"><b>: </b><span>VLSM message</span></span></span><br><span><var>TypeX</var><span><span class="hyp-body"><b>:= </b><span>type X</span></span><span class="hyp-type"><b>: </b><span>VLSMType message</span></span></span></span><br><span><var>MachineX</var><span><span class="hyp-body"><b>:= </b><span>machine X</span></span><span class="hyp-type"><b>: </b><span>VLSMMachine (vtype X)</span></span></span></span><br><span><var>s'</var><span class="hyp-type"><b>: </b><span>state</span></span></span><br><span><var>l'</var><span class="hyp-type"><b>: </b><span>list transition_item</span></span></span><br><span><var>Htr</var><span class="hyp-type"><b>: </b><span>valid_trace_prop (Finite s&#39; l&#39;)</span></span></span><br><span><var>n</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>Hpref</var><span class="hyp-type"><b>: </b><span><span class="kr">‚àÄ</span> (<span class="nv">last</span> : transition_item) 
  (<span class="nv">prefix</span> : list transition_item),
  trace_prefix (Finite s&#39; l&#39;) <span class="nb">last</span> prefix
  ‚Üí finite_valid_trace
      (trace_first (Finite s&#39; l&#39;))
      (prefix ++ [<span class="nb">last</span>])</span></span></span><br><span><var>prefix</var><span class="hyp-type"><b>: </b><span>list transition_item</span></span></span><br><span><var>last</var><span class="hyp-type"><b>: </b><span>transition_item</span></span></span><br><span><var>Heqprefix</var><span class="hyp-type"><b>: </b><span>list_prefix l&#39; n = prefix ++ [<span class="nb">last</span>]</span></span></span><br><span><var>Hl'</var><span class="hyp-type"><b>: </b><span>list_prefix l&#39; n ++ list_suffix l&#39; n = l&#39;</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="kr">‚àÉ</span> <span class="nv">suffix</span> : list transition_item,
  l&#39; = prefix ++ <span class="nb">last</span> :: suffix</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">            </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="VLSM-v-chk3e6" style="display: none" type="checkbox"><label class="alectryon-input" for="VLSM-v-chk3e6"><span class="nb">rewrite</span> &lt;- Hl&#39;.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>message</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>X</var><span class="hyp-type"><b>: </b><span>VLSM message</span></span></span><br><span><var>TypeX</var><span><span class="hyp-body"><b>:= </b><span>type X</span></span><span class="hyp-type"><b>: </b><span>VLSMType message</span></span></span></span><br><span><var>MachineX</var><span><span class="hyp-body"><b>:= </b><span>machine X</span></span><span class="hyp-type"><b>: </b><span>VLSMMachine (vtype X)</span></span></span></span><br><span><var>s'</var><span class="hyp-type"><b>: </b><span>state</span></span></span><br><span><var>l'</var><span class="hyp-type"><b>: </b><span>list transition_item</span></span></span><br><span><var>Htr</var><span class="hyp-type"><b>: </b><span>valid_trace_prop (Finite s&#39; l&#39;)</span></span></span><br><span><var>n</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>Hpref</var><span class="hyp-type"><b>: </b><span><span class="kr">‚àÄ</span> (<span class="nv">last</span> : transition_item) 
  (<span class="nv">prefix</span> : list transition_item),
  trace_prefix (Finite s&#39; l&#39;) <span class="nb">last</span> prefix
  ‚Üí finite_valid_trace
      (trace_first (Finite s&#39; l&#39;))
      (prefix ++ [<span class="nb">last</span>])</span></span></span><br><span><var>prefix</var><span class="hyp-type"><b>: </b><span>list transition_item</span></span></span><br><span><var>last</var><span class="hyp-type"><b>: </b><span>transition_item</span></span></span><br><span><var>Heqprefix</var><span class="hyp-type"><b>: </b><span>list_prefix l&#39; n = prefix ++ [<span class="nb">last</span>]</span></span></span><br><span><var>Hl'</var><span class="hyp-type"><b>: </b><span>list_prefix l&#39; n ++ list_suffix l&#39; n = l&#39;</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="kr">‚àÉ</span> <span class="nv">suffix</span> : list transition_item,
  list_prefix l&#39; n ++ list_suffix l&#39; n =
  prefix ++ <span class="nb">last</span> :: suffix</div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="VLSM-v-chk3e7" style="display: none" type="checkbox"><label class="alectryon-input" for="VLSM-v-chk3e7"><span class="nb">rewrite</span> Heqprefix.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>message</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>X</var><span class="hyp-type"><b>: </b><span>VLSM message</span></span></span><br><span><var>TypeX</var><span><span class="hyp-body"><b>:= </b><span>type X</span></span><span class="hyp-type"><b>: </b><span>VLSMType message</span></span></span></span><br><span><var>MachineX</var><span><span class="hyp-body"><b>:= </b><span>machine X</span></span><span class="hyp-type"><b>: </b><span>VLSMMachine (vtype X)</span></span></span></span><br><span><var>s'</var><span class="hyp-type"><b>: </b><span>state</span></span></span><br><span><var>l'</var><span class="hyp-type"><b>: </b><span>list transition_item</span></span></span><br><span><var>Htr</var><span class="hyp-type"><b>: </b><span>valid_trace_prop (Finite s&#39; l&#39;)</span></span></span><br><span><var>n</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>Hpref</var><span class="hyp-type"><b>: </b><span><span class="kr">‚àÄ</span> (<span class="nv">last</span> : transition_item) 
  (<span class="nv">prefix</span> : list transition_item),
  trace_prefix (Finite s&#39; l&#39;) <span class="nb">last</span> prefix
  ‚Üí finite_valid_trace
      (trace_first (Finite s&#39; l&#39;))
      (prefix ++ [<span class="nb">last</span>])</span></span></span><br><span><var>prefix</var><span class="hyp-type"><b>: </b><span>list transition_item</span></span></span><br><span><var>last</var><span class="hyp-type"><b>: </b><span>transition_item</span></span></span><br><span><var>Heqprefix</var><span class="hyp-type"><b>: </b><span>list_prefix l&#39; n = prefix ++ [<span class="nb">last</span>]</span></span></span><br><span><var>Hl'</var><span class="hyp-type"><b>: </b><span>list_prefix l&#39; n ++ list_suffix l&#39; n = l&#39;</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="kr">‚àÉ</span> <span class="nv">suffix</span> : list transition_item,
  (prefix ++ [<span class="nb">last</span>]) ++ list_suffix l&#39; n =
  prefix ++ <span class="nb">last</span> :: suffix</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">            </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="VLSM-v-chk3e8" style="display: none" type="checkbox"><label class="alectryon-input" for="VLSM-v-chk3e8"><span class="kr">exists</span> (<span class="nv">list_suffix</span> <span class="nv">l&#39;</span> <span class="nv">n</span>).</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>message</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>X</var><span class="hyp-type"><b>: </b><span>VLSM message</span></span></span><br><span><var>TypeX</var><span><span class="hyp-body"><b>:= </b><span>type X</span></span><span class="hyp-type"><b>: </b><span>VLSMType message</span></span></span></span><br><span><var>MachineX</var><span><span class="hyp-body"><b>:= </b><span>machine X</span></span><span class="hyp-type"><b>: </b><span>VLSMMachine (vtype X)</span></span></span></span><br><span><var>s'</var><span class="hyp-type"><b>: </b><span>state</span></span></span><br><span><var>l'</var><span class="hyp-type"><b>: </b><span>list transition_item</span></span></span><br><span><var>Htr</var><span class="hyp-type"><b>: </b><span>valid_trace_prop (Finite s&#39; l&#39;)</span></span></span><br><span><var>n</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>Hpref</var><span class="hyp-type"><b>: </b><span><span class="kr">‚àÄ</span> (<span class="nv">last</span> : transition_item) 
  (<span class="nv">prefix</span> : list transition_item),
  trace_prefix (Finite s&#39; l&#39;) <span class="nb">last</span> prefix
  ‚Üí finite_valid_trace
      (trace_first (Finite s&#39; l&#39;))
      (prefix ++ [<span class="nb">last</span>])</span></span></span><br><span><var>prefix</var><span class="hyp-type"><b>: </b><span>list transition_item</span></span></span><br><span><var>last</var><span class="hyp-type"><b>: </b><span>transition_item</span></span></span><br><span><var>Heqprefix</var><span class="hyp-type"><b>: </b><span>list_prefix l&#39; n = prefix ++ [<span class="nb">last</span>]</span></span></span><br><span><var>Hl'</var><span class="hyp-type"><b>: </b><span>list_prefix l&#39; n ++ list_suffix l&#39; n = l&#39;</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">(prefix ++ [<span class="nb">last</span>]) ++ list_suffix l&#39; n =
prefix ++ <span class="nb">last</span> :: list_suffix l&#39; n</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">            </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="VLSM-v-chk3e9" style="display: none" type="checkbox"><label class="alectryon-input" for="VLSM-v-chk3e9"><span class="nb">rewrite</span> &lt;- app_assoc.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>message</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>X</var><span class="hyp-type"><b>: </b><span>VLSM message</span></span></span><br><span><var>TypeX</var><span><span class="hyp-body"><b>:= </b><span>type X</span></span><span class="hyp-type"><b>: </b><span>VLSMType message</span></span></span></span><br><span><var>MachineX</var><span><span class="hyp-body"><b>:= </b><span>machine X</span></span><span class="hyp-type"><b>: </b><span>VLSMMachine (vtype X)</span></span></span></span><br><span><var>s'</var><span class="hyp-type"><b>: </b><span>state</span></span></span><br><span><var>l'</var><span class="hyp-type"><b>: </b><span>list transition_item</span></span></span><br><span><var>Htr</var><span class="hyp-type"><b>: </b><span>valid_trace_prop (Finite s&#39; l&#39;)</span></span></span><br><span><var>n</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>Hpref</var><span class="hyp-type"><b>: </b><span><span class="kr">‚àÄ</span> (<span class="nv">last</span> : transition_item) 
  (<span class="nv">prefix</span> : list transition_item),
  trace_prefix (Finite s&#39; l&#39;) <span class="nb">last</span> prefix
  ‚Üí finite_valid_trace
      (trace_first (Finite s&#39; l&#39;))
      (prefix ++ [<span class="nb">last</span>])</span></span></span><br><span><var>prefix</var><span class="hyp-type"><b>: </b><span>list transition_item</span></span></span><br><span><var>last</var><span class="hyp-type"><b>: </b><span>transition_item</span></span></span><br><span><var>Heqprefix</var><span class="hyp-type"><b>: </b><span>list_prefix l&#39; n = prefix ++ [<span class="nb">last</span>]</span></span></span><br><span><var>Hl'</var><span class="hyp-type"><b>: </b><span>list_prefix l&#39; n ++ list_suffix l&#39; n = l&#39;</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">prefix ++ [<span class="nb">last</span>] ++ list_suffix l&#39; n =
prefix ++ <span class="nb">last</span> :: list_suffix l&#39; n</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">            </span><span class="alectryon-sentence"><span class="alectryon-input"><span class="bp">reflexivity</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">          </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="VLSM-v-chk3ea" style="display: none" type="checkbox"><label class="alectryon-input" for="VLSM-v-chk3ea">*</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>message</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>X</var><span class="hyp-type"><b>: </b><span>VLSM message</span></span></span><br><span><var>TypeX</var><span><span class="hyp-body"><b>:= </b><span>type X</span></span><span class="hyp-type"><b>: </b><span>VLSMType message</span></span></span></span><br><span><var>MachineX</var><span><span class="hyp-body"><b>:= </b><span>machine X</span></span><span class="hyp-type"><b>: </b><span>VLSMMachine (vtype X)</span></span></span></span><br><span><var>s'</var><span class="hyp-type"><b>: </b><span>state</span></span></span><br><span><var>l'</var><span class="hyp-type"><b>: </b><span>Stream transition_item</span></span></span><br><span><var>Htr</var><span class="hyp-type"><b>: </b><span>valid_trace_prop (Infinite s&#39; l&#39;)</span></span></span><br><span><var>n</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>Hpref</var><span class="hyp-type"><b>: </b><span><span class="kr">‚àÄ</span> (<span class="nv">last</span> : transition_item) 
  (<span class="nv">prefix</span> : list transition_item),
  trace_prefix (Infinite s&#39; l&#39;) <span class="nb">last</span> prefix
  ‚Üí finite_valid_trace
      (trace_first (Infinite s&#39; l&#39;))
      (prefix ++ [<span class="nb">last</span>])</span></span></span><br><span><var>prefix</var><span class="hyp-type"><b>: </b><span>list transition_item</span></span></span><br><span><var>last</var><span class="hyp-type"><b>: </b><span>transition_item</span></span></span><br><span><var>Heqprefix</var><span class="hyp-type"><b>: </b><span>stream_prefix l&#39; n = prefix ++ [<span class="nb">last</span>]</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="kr">‚àÉ</span> <span class="nv">suffix</span> : Stream transition_item,
  l&#39; = stream_app prefix (Cons <span class="nb">last</span> suffix)</div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="VLSM-v-chk3eb" style="display: none" type="checkbox"><label class="alectryon-input" for="VLSM-v-chk3eb"><span class="nb">specialize</span> (stream_prefix_suffix l&#39; n); <span class="nb">intro</span> Hl&#39;.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>message</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>X</var><span class="hyp-type"><b>: </b><span>VLSM message</span></span></span><br><span><var>TypeX</var><span><span class="hyp-body"><b>:= </b><span>type X</span></span><span class="hyp-type"><b>: </b><span>VLSMType message</span></span></span></span><br><span><var>MachineX</var><span><span class="hyp-body"><b>:= </b><span>machine X</span></span><span class="hyp-type"><b>: </b><span>VLSMMachine (vtype X)</span></span></span></span><br><span><var>s'</var><span class="hyp-type"><b>: </b><span>state</span></span></span><br><span><var>l'</var><span class="hyp-type"><b>: </b><span>Stream transition_item</span></span></span><br><span><var>Htr</var><span class="hyp-type"><b>: </b><span>valid_trace_prop (Infinite s&#39; l&#39;)</span></span></span><br><span><var>n</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>Hpref</var><span class="hyp-type"><b>: </b><span><span class="kr">‚àÄ</span> (<span class="nv">last</span> : transition_item) 
  (<span class="nv">prefix</span> : list transition_item),
  trace_prefix (Infinite s&#39; l&#39;) <span class="nb">last</span> prefix
  ‚Üí finite_valid_trace
      (trace_first (Infinite s&#39; l&#39;))
      (prefix ++ [<span class="nb">last</span>])</span></span></span><br><span><var>prefix</var><span class="hyp-type"><b>: </b><span>list transition_item</span></span></span><br><span><var>last</var><span class="hyp-type"><b>: </b><span>transition_item</span></span></span><br><span><var>Heqprefix</var><span class="hyp-type"><b>: </b><span>stream_prefix l&#39; n = prefix ++ [<span class="nb">last</span>]</span></span></span><br><span><var>Hl'</var><span class="hyp-type"><b>: </b><span>stream_app (stream_prefix l&#39; n)
  (stream_suffix l&#39; n) = l&#39;</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="kr">‚àÉ</span> <span class="nv">suffix</span> : Stream transition_item,
  l&#39; = stream_app prefix (Cons <span class="nb">last</span> suffix)</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">            </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="VLSM-v-chk3ec" style="display: none" type="checkbox"><label class="alectryon-input" for="VLSM-v-chk3ec"><span class="nb">rewrite</span> &lt;- Hl&#39;.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>message</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>X</var><span class="hyp-type"><b>: </b><span>VLSM message</span></span></span><br><span><var>TypeX</var><span><span class="hyp-body"><b>:= </b><span>type X</span></span><span class="hyp-type"><b>: </b><span>VLSMType message</span></span></span></span><br><span><var>MachineX</var><span><span class="hyp-body"><b>:= </b><span>machine X</span></span><span class="hyp-type"><b>: </b><span>VLSMMachine (vtype X)</span></span></span></span><br><span><var>s'</var><span class="hyp-type"><b>: </b><span>state</span></span></span><br><span><var>l'</var><span class="hyp-type"><b>: </b><span>Stream transition_item</span></span></span><br><span><var>Htr</var><span class="hyp-type"><b>: </b><span>valid_trace_prop (Infinite s&#39; l&#39;)</span></span></span><br><span><var>n</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>Hpref</var><span class="hyp-type"><b>: </b><span><span class="kr">‚àÄ</span> (<span class="nv">last</span> : transition_item) 
  (<span class="nv">prefix</span> : list transition_item),
  trace_prefix (Infinite s&#39; l&#39;) <span class="nb">last</span> prefix
  ‚Üí finite_valid_trace
      (trace_first (Infinite s&#39; l&#39;))
      (prefix ++ [<span class="nb">last</span>])</span></span></span><br><span><var>prefix</var><span class="hyp-type"><b>: </b><span>list transition_item</span></span></span><br><span><var>last</var><span class="hyp-type"><b>: </b><span>transition_item</span></span></span><br><span><var>Heqprefix</var><span class="hyp-type"><b>: </b><span>stream_prefix l&#39; n = prefix ++ [<span class="nb">last</span>]</span></span></span><br><span><var>Hl'</var><span class="hyp-type"><b>: </b><span>stream_app (stream_prefix l&#39; n)
  (stream_suffix l&#39; n) = l&#39;</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="kr">‚àÉ</span> <span class="nv">suffix</span> : Stream transition_item,
  stream_app (stream_prefix l&#39; n) (stream_suffix l&#39; n) =
  stream_app prefix (Cons <span class="nb">last</span> suffix)</div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="VLSM-v-chk3ed" style="display: none" type="checkbox"><label class="alectryon-input" for="VLSM-v-chk3ed"><span class="nb">rewrite</span> Heqprefix.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>message</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>X</var><span class="hyp-type"><b>: </b><span>VLSM message</span></span></span><br><span><var>TypeX</var><span><span class="hyp-body"><b>:= </b><span>type X</span></span><span class="hyp-type"><b>: </b><span>VLSMType message</span></span></span></span><br><span><var>MachineX</var><span><span class="hyp-body"><b>:= </b><span>machine X</span></span><span class="hyp-type"><b>: </b><span>VLSMMachine (vtype X)</span></span></span></span><br><span><var>s'</var><span class="hyp-type"><b>: </b><span>state</span></span></span><br><span><var>l'</var><span class="hyp-type"><b>: </b><span>Stream transition_item</span></span></span><br><span><var>Htr</var><span class="hyp-type"><b>: </b><span>valid_trace_prop (Infinite s&#39; l&#39;)</span></span></span><br><span><var>n</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>Hpref</var><span class="hyp-type"><b>: </b><span><span class="kr">‚àÄ</span> (<span class="nv">last</span> : transition_item) 
  (<span class="nv">prefix</span> : list transition_item),
  trace_prefix (Infinite s&#39; l&#39;) <span class="nb">last</span> prefix
  ‚Üí finite_valid_trace
      (trace_first (Infinite s&#39; l&#39;))
      (prefix ++ [<span class="nb">last</span>])</span></span></span><br><span><var>prefix</var><span class="hyp-type"><b>: </b><span>list transition_item</span></span></span><br><span><var>last</var><span class="hyp-type"><b>: </b><span>transition_item</span></span></span><br><span><var>Heqprefix</var><span class="hyp-type"><b>: </b><span>stream_prefix l&#39; n = prefix ++ [<span class="nb">last</span>]</span></span></span><br><span><var>Hl'</var><span class="hyp-type"><b>: </b><span>stream_app (stream_prefix l&#39; n)
  (stream_suffix l&#39; n) = l&#39;</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="kr">‚àÉ</span> <span class="nv">suffix</span> : Stream transition_item,
  stream_app (prefix ++ [<span class="nb">last</span>]) (stream_suffix l&#39; n) =
  stream_app prefix (Cons <span class="nb">last</span> suffix)</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">            </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="VLSM-v-chk3ee" style="display: none" type="checkbox"><label class="alectryon-input" for="VLSM-v-chk3ee"><span class="kr">exists</span> (<span class="nv">stream_suffix</span> <span class="nv">l&#39;</span> <span class="nv">n</span>).</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>message</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>X</var><span class="hyp-type"><b>: </b><span>VLSM message</span></span></span><br><span><var>TypeX</var><span><span class="hyp-body"><b>:= </b><span>type X</span></span><span class="hyp-type"><b>: </b><span>VLSMType message</span></span></span></span><br><span><var>MachineX</var><span><span class="hyp-body"><b>:= </b><span>machine X</span></span><span class="hyp-type"><b>: </b><span>VLSMMachine (vtype X)</span></span></span></span><br><span><var>s'</var><span class="hyp-type"><b>: </b><span>state</span></span></span><br><span><var>l'</var><span class="hyp-type"><b>: </b><span>Stream transition_item</span></span></span><br><span><var>Htr</var><span class="hyp-type"><b>: </b><span>valid_trace_prop (Infinite s&#39; l&#39;)</span></span></span><br><span><var>n</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>Hpref</var><span class="hyp-type"><b>: </b><span><span class="kr">‚àÄ</span> (<span class="nv">last</span> : transition_item) 
  (<span class="nv">prefix</span> : list transition_item),
  trace_prefix (Infinite s&#39; l&#39;) <span class="nb">last</span> prefix
  ‚Üí finite_valid_trace
      (trace_first (Infinite s&#39; l&#39;))
      (prefix ++ [<span class="nb">last</span>])</span></span></span><br><span><var>prefix</var><span class="hyp-type"><b>: </b><span>list transition_item</span></span></span><br><span><var>last</var><span class="hyp-type"><b>: </b><span>transition_item</span></span></span><br><span><var>Heqprefix</var><span class="hyp-type"><b>: </b><span>stream_prefix l&#39; n = prefix ++ [<span class="nb">last</span>]</span></span></span><br><span><var>Hl'</var><span class="hyp-type"><b>: </b><span>stream_app (stream_prefix l&#39; n)
  (stream_suffix l&#39; n) = l&#39;</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">stream_app (prefix ++ [<span class="nb">last</span>]) (stream_suffix l&#39; n) =
stream_app prefix (Cons <span class="nb">last</span> (stream_suffix l&#39; n))</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">            </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="VLSM-v-chk3ef" style="display: none" type="checkbox"><label class="alectryon-input" for="VLSM-v-chk3ef"><span class="nb">rewrite</span> &lt;- stream_app_assoc.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>message</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>X</var><span class="hyp-type"><b>: </b><span>VLSM message</span></span></span><br><span><var>TypeX</var><span><span class="hyp-body"><b>:= </b><span>type X</span></span><span class="hyp-type"><b>: </b><span>VLSMType message</span></span></span></span><br><span><var>MachineX</var><span><span class="hyp-body"><b>:= </b><span>machine X</span></span><span class="hyp-type"><b>: </b><span>VLSMMachine (vtype X)</span></span></span></span><br><span><var>s'</var><span class="hyp-type"><b>: </b><span>state</span></span></span><br><span><var>l'</var><span class="hyp-type"><b>: </b><span>Stream transition_item</span></span></span><br><span><var>Htr</var><span class="hyp-type"><b>: </b><span>valid_trace_prop (Infinite s&#39; l&#39;)</span></span></span><br><span><var>n</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>Hpref</var><span class="hyp-type"><b>: </b><span><span class="kr">‚àÄ</span> (<span class="nv">last</span> : transition_item) 
  (<span class="nv">prefix</span> : list transition_item),
  trace_prefix (Infinite s&#39; l&#39;) <span class="nb">last</span> prefix
  ‚Üí finite_valid_trace
      (trace_first (Infinite s&#39; l&#39;))
      (prefix ++ [<span class="nb">last</span>])</span></span></span><br><span><var>prefix</var><span class="hyp-type"><b>: </b><span>list transition_item</span></span></span><br><span><var>last</var><span class="hyp-type"><b>: </b><span>transition_item</span></span></span><br><span><var>Heqprefix</var><span class="hyp-type"><b>: </b><span>stream_prefix l&#39; n = prefix ++ [<span class="nb">last</span>]</span></span></span><br><span><var>Hl'</var><span class="hyp-type"><b>: </b><span>stream_app (stream_prefix l&#39; n)
  (stream_suffix l&#39; n) = l&#39;</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">stream_app prefix
  (stream_app [<span class="nb">last</span>] (stream_suffix l&#39; n)) =
stream_app prefix (Cons <span class="nb">last</span> (stream_suffix l&#39; n))</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">            </span><span class="alectryon-sentence"><span class="alectryon-input"><span class="bp">reflexivity</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">      </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="VLSM-v-chk3f0" style="display: none" type="checkbox"><label class="alectryon-input" for="VLSM-v-chk3f0">-</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>message</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>X</var><span class="hyp-type"><b>: </b><span>VLSM message</span></span></span><br><span><var>TypeX</var><span><span class="hyp-body"><b>:= </b><span>type X</span></span><span class="hyp-type"><b>: </b><span>VLSMType message</span></span></span></span><br><span><var>MachineX</var><span><span class="hyp-body"><b>:= </b><span>machine X</span></span><span class="hyp-type"><b>: </b><span>VLSMMachine (vtype X)</span></span></span></span><br><span><var>tr</var><span class="hyp-type"><b>: </b><span>Trace</span></span></span><br><span><var>Htr</var><span class="hyp-type"><b>: </b><span>valid_trace_prop tr</span></span></span><br><span><var>n</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>Hpref</var><span class="hyp-type"><b>: </b><span><span class="kr">‚àÄ</span> (<span class="nv">last</span> : transition_item) 
  (<span class="nv">prefix</span> : list transition_item),
  trace_prefix tr <span class="nb">last</span> prefix
  ‚Üí finite_valid_trace 
      (trace_first tr) 
      (prefix ++ [<span class="nb">last</span>])</span></span></span><br><span><var>s</var><span class="hyp-type"><b>: </b><span>state</span></span></span><br><span><var>l</var><span class="hyp-type"><b>: </b><span>Stream transition_item</span></span></span><br><span><var>Heqpref_tr</var><span class="hyp-type"><b>: </b><span>Infinite s l = trace_prefix_fn tr n</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">valid_trace_prop (Infinite s l)</div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="nb">destruct</span> tr <span class="kr">as</span> [s&#39; l&#39; | s&#39; l&#39;]; <span class="nb">inversion</span> Heqpref_tr.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Qed</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
</span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="VLSM-v-chk3f1" style="display: none" type="checkbox"><label class="alectryon-input" for="VLSM-v-chk3f1"><span class="kn">Lemma</span> <span class="nf">valid_trace_nth</span>
      (<span class="nv">tr</span> : Trace)
      (<span class="nv">Htr</span> : valid_trace_prop tr)
      (<span class="nv">n</span> : nat)
      (<span class="nv">s</span> : state)
      (<span class="nv">Hnth</span> : trace_nth tr n = Some s)
      : valid_state_prop s.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>message</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>X</var><span class="hyp-type"><b>: </b><span>VLSM message</span></span></span><br><span><var>TypeX</var><span><span class="hyp-body"><b>:= </b><span>type X</span></span><span class="hyp-type"><b>: </b><span>VLSMType message</span></span></span></span><br><span><var>MachineX</var><span><span class="hyp-body"><b>:= </b><span>machine X</span></span><span class="hyp-type"><b>: </b><span>VLSMMachine (vtype X)</span></span></span></span><br><span><var>tr</var><span class="hyp-type"><b>: </b><span>Trace</span></span></span><br><span><var>Htr</var><span class="hyp-type"><b>: </b><span>valid_trace_prop tr</span></span></span><br><span><var>n</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>s</var><span class="hyp-type"><b>: </b><span>state</span></span></span><br><span><var>Hnth</var><span class="hyp-type"><b>: </b><span>trace_nth tr n = Some s</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">valid_state_prop s</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="VLSM-v-chk3f2" style="display: none" type="checkbox"><label class="alectryon-input" for="VLSM-v-chk3f2"><span class="kn">Proof</span>.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>message</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>X</var><span class="hyp-type"><b>: </b><span>VLSM message</span></span></span><br><span><var>TypeX</var><span><span class="hyp-body"><b>:= </b><span>type X</span></span><span class="hyp-type"><b>: </b><span>VLSMType message</span></span></span></span><br><span><var>MachineX</var><span><span class="hyp-body"><b>:= </b><span>machine X</span></span><span class="hyp-type"><b>: </b><span>VLSMMachine (vtype X)</span></span></span></span><br><span><var>tr</var><span class="hyp-type"><b>: </b><span>Trace</span></span></span><br><span><var>Htr</var><span class="hyp-type"><b>: </b><span>valid_trace_prop tr</span></span></span><br><span><var>n</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>s</var><span class="hyp-type"><b>: </b><span>state</span></span></span><br><span><var>Hnth</var><span class="hyp-type"><b>: </b><span>trace_nth tr n = Some s</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">valid_state_prop s</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">      </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="VLSM-v-chk3f3" style="display: none" type="checkbox"><label class="alectryon-input" for="VLSM-v-chk3f3"><span class="nb">destruct</span> tr <span class="kr">as</span> [s0 l | s0 l]; <span class="nb">destruct</span> Htr <span class="kr">as</span> [Htr Hinit].</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>message</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>X</var><span class="hyp-type"><b>: </b><span>VLSM message</span></span></span><br><span><var>TypeX</var><span><span class="hyp-body"><b>:= </b><span>type X</span></span><span class="hyp-type"><b>: </b><span>VLSMType message</span></span></span></span><br><span><var>MachineX</var><span><span class="hyp-body"><b>:= </b><span>machine X</span></span><span class="hyp-type"><b>: </b><span>VLSMMachine (vtype X)</span></span></span></span><br><span><var>s0</var><span class="hyp-type"><b>: </b><span>state</span></span></span><br><span><var>l</var><span class="hyp-type"><b>: </b><span>list transition_item</span></span></span><br><span><var>Htr</var><span class="hyp-type"><b>: </b><span>finite_valid_trace_from s0 l</span></span></span><br><span><var>Hinit</var><span class="hyp-type"><b>: </b><span>initial_state_prop s0</span></span></span><br><span><var>n</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>s</var><span class="hyp-type"><b>: </b><span>state</span></span></span><br><span><var>Hnth</var><span class="hyp-type"><b>: </b><span>trace_nth (Finite s0 l) n = Some s</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">valid_state_prop s</div></blockquote><div class="alectryon-extra-goals"><input class="alectryon-extra-goal-toggle" id="VLSM-v-chk3f4" style="display: none" type="checkbox"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>message</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>X</var><span class="hyp-type"><b>: </b><span>VLSM message</span></span></span><br><span><var>TypeX</var><span><span class="hyp-body"><b>:= </b><span>type X</span></span><span class="hyp-type"><b>: </b><span>VLSMType message</span></span></span></span><br><span><var>MachineX</var><span><span class="hyp-body"><b>:= </b><span>machine X</span></span><span class="hyp-type"><b>: </b><span>VLSMMachine (vtype X)</span></span></span></span><br><span><var>s0</var><span class="hyp-type"><b>: </b><span>state</span></span></span><br><span><var>l</var><span class="hyp-type"><b>: </b><span>Stream transition_item</span></span></span><br><span><var>Htr</var><span class="hyp-type"><b>: </b><span>infinite_valid_trace_from s0 l</span></span></span><br><span><var>Hinit</var><span class="hyp-type"><b>: </b><span>initial_state_prop s0</span></span></span><br><span><var>n</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>s</var><span class="hyp-type"><b>: </b><span>state</span></span></span><br><span><var>Hnth</var><span class="hyp-type"><b>: </b><span>trace_nth (Infinite s0 l) n = Some s</span></span></span><br></div><label class="goal-separator" for="VLSM-v-chk3f4"><hr></label><div class="goal-conclusion">valid_state_prop s</div></blockquote></div></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">      </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="VLSM-v-chk3f5" style="display: none" type="checkbox"><label class="alectryon-input" for="VLSM-v-chk3f5">-</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>message</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>X</var><span class="hyp-type"><b>: </b><span>VLSM message</span></span></span><br><span><var>TypeX</var><span><span class="hyp-body"><b>:= </b><span>type X</span></span><span class="hyp-type"><b>: </b><span>VLSMType message</span></span></span></span><br><span><var>MachineX</var><span><span class="hyp-body"><b>:= </b><span>machine X</span></span><span class="hyp-type"><b>: </b><span>VLSMMachine (vtype X)</span></span></span></span><br><span><var>s0</var><span class="hyp-type"><b>: </b><span>state</span></span></span><br><span><var>l</var><span class="hyp-type"><b>: </b><span>list transition_item</span></span></span><br><span><var>Htr</var><span class="hyp-type"><b>: </b><span>finite_valid_trace_from s0 l</span></span></span><br><span><var>Hinit</var><span class="hyp-type"><b>: </b><span>initial_state_prop s0</span></span></span><br><span><var>n</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>s</var><span class="hyp-type"><b>: </b><span>state</span></span></span><br><span><var>Hnth</var><span class="hyp-type"><b>: </b><span>trace_nth (Finite s0 l) n = Some s</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">valid_state_prop s</div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="VLSM-v-chk3f6" style="display: none" type="checkbox"><label class="alectryon-input" for="VLSM-v-chk3f6"><span class="nb">specialize</span> (finite_valid_trace_from_suffix s0 l Htr n s Hnth).</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>message</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>X</var><span class="hyp-type"><b>: </b><span>VLSM message</span></span></span><br><span><var>TypeX</var><span><span class="hyp-body"><b>:= </b><span>type X</span></span><span class="hyp-type"><b>: </b><span>VLSMType message</span></span></span></span><br><span><var>MachineX</var><span><span class="hyp-body"><b>:= </b><span>machine X</span></span><span class="hyp-type"><b>: </b><span>VLSMMachine (vtype X)</span></span></span></span><br><span><var>s0</var><span class="hyp-type"><b>: </b><span>state</span></span></span><br><span><var>l</var><span class="hyp-type"><b>: </b><span>list transition_item</span></span></span><br><span><var>Htr</var><span class="hyp-type"><b>: </b><span>finite_valid_trace_from s0 l</span></span></span><br><span><var>Hinit</var><span class="hyp-type"><b>: </b><span>initial_state_prop s0</span></span></span><br><span><var>n</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>s</var><span class="hyp-type"><b>: </b><span>state</span></span></span><br><span><var>Hnth</var><span class="hyp-type"><b>: </b><span>trace_nth (Finite s0 l) n = Some s</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">finite_valid_trace_from s (list_suffix l n)
‚Üí valid_state_prop s</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">        </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="VLSM-v-chk3f7" style="display: none" type="checkbox"><label class="alectryon-input" for="VLSM-v-chk3f7"><span class="nb">intro</span> Hsuf.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>message</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>X</var><span class="hyp-type"><b>: </b><span>VLSM message</span></span></span><br><span><var>TypeX</var><span><span class="hyp-body"><b>:= </b><span>type X</span></span><span class="hyp-type"><b>: </b><span>VLSMType message</span></span></span></span><br><span><var>MachineX</var><span><span class="hyp-body"><b>:= </b><span>machine X</span></span><span class="hyp-type"><b>: </b><span>VLSMMachine (vtype X)</span></span></span></span><br><span><var>s0</var><span class="hyp-type"><b>: </b><span>state</span></span></span><br><span><var>l</var><span class="hyp-type"><b>: </b><span>list transition_item</span></span></span><br><span><var>Htr</var><span class="hyp-type"><b>: </b><span>finite_valid_trace_from s0 l</span></span></span><br><span><var>Hinit</var><span class="hyp-type"><b>: </b><span>initial_state_prop s0</span></span></span><br><span><var>n</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>s</var><span class="hyp-type"><b>: </b><span>state</span></span></span><br><span><var>Hnth</var><span class="hyp-type"><b>: </b><span>trace_nth (Finite s0 l) n = Some s</span></span></span><br><span><var>Hsuf</var><span class="hyp-type"><b>: </b><span>finite_valid_trace_from s (list_suffix l n)</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">valid_state_prop s</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">        </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="VLSM-v-chk3f8" style="display: none" type="checkbox"><label class="alectryon-input" for="VLSM-v-chk3f8"><span class="nb">apply</span> finite_valid_trace_first_pstate <span class="kr">in</span> Hsuf.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>message</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>X</var><span class="hyp-type"><b>: </b><span>VLSM message</span></span></span><br><span><var>TypeX</var><span><span class="hyp-body"><b>:= </b><span>type X</span></span><span class="hyp-type"><b>: </b><span>VLSMType message</span></span></span></span><br><span><var>MachineX</var><span><span class="hyp-body"><b>:= </b><span>machine X</span></span><span class="hyp-type"><b>: </b><span>VLSMMachine (vtype X)</span></span></span></span><br><span><var>s0</var><span class="hyp-type"><b>: </b><span>state</span></span></span><br><span><var>l</var><span class="hyp-type"><b>: </b><span>list transition_item</span></span></span><br><span><var>Htr</var><span class="hyp-type"><b>: </b><span>finite_valid_trace_from s0 l</span></span></span><br><span><var>Hinit</var><span class="hyp-type"><b>: </b><span>initial_state_prop s0</span></span></span><br><span><var>n</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>s</var><span class="hyp-type"><b>: </b><span>state</span></span></span><br><span><var>Hnth</var><span class="hyp-type"><b>: </b><span>trace_nth (Finite s0 l) n = Some s</span></span></span><br><span><var>Hsuf</var><span class="hyp-type"><b>: </b><span>valid_state_prop s</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">valid_state_prop s</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">        </span><span class="alectryon-sentence"><span class="alectryon-input"><span class="bp">assumption</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">      </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="VLSM-v-chk3f9" style="display: none" type="checkbox"><label class="alectryon-input" for="VLSM-v-chk3f9">-</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>message</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>X</var><span class="hyp-type"><b>: </b><span>VLSM message</span></span></span><br><span><var>TypeX</var><span><span class="hyp-body"><b>:= </b><span>type X</span></span><span class="hyp-type"><b>: </b><span>VLSMType message</span></span></span></span><br><span><var>MachineX</var><span><span class="hyp-body"><b>:= </b><span>machine X</span></span><span class="hyp-type"><b>: </b><span>VLSMMachine (vtype X)</span></span></span></span><br><span><var>s0</var><span class="hyp-type"><b>: </b><span>state</span></span></span><br><span><var>l</var><span class="hyp-type"><b>: </b><span>Stream transition_item</span></span></span><br><span><var>Htr</var><span class="hyp-type"><b>: </b><span>infinite_valid_trace_from s0 l</span></span></span><br><span><var>Hinit</var><span class="hyp-type"><b>: </b><span>initial_state_prop s0</span></span></span><br><span><var>n</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>s</var><span class="hyp-type"><b>: </b><span>state</span></span></span><br><span><var>Hnth</var><span class="hyp-type"><b>: </b><span>trace_nth (Infinite s0 l) n = Some s</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">valid_state_prop s</div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="VLSM-v-chk3fa" style="display: none" type="checkbox"><label class="alectryon-input" for="VLSM-v-chk3fa"><span class="nb">assert</span> (Hle : n &lt;= n) <span class="bp">by</span> <span class="bp">lia</span>.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>message</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>X</var><span class="hyp-type"><b>: </b><span>VLSM message</span></span></span><br><span><var>TypeX</var><span><span class="hyp-body"><b>:= </b><span>type X</span></span><span class="hyp-type"><b>: </b><span>VLSMType message</span></span></span></span><br><span><var>MachineX</var><span><span class="hyp-body"><b>:= </b><span>machine X</span></span><span class="hyp-type"><b>: </b><span>VLSMMachine (vtype X)</span></span></span></span><br><span><var>s0</var><span class="hyp-type"><b>: </b><span>state</span></span></span><br><span><var>l</var><span class="hyp-type"><b>: </b><span>Stream transition_item</span></span></span><br><span><var>Htr</var><span class="hyp-type"><b>: </b><span>infinite_valid_trace_from s0 l</span></span></span><br><span><var>Hinit</var><span class="hyp-type"><b>: </b><span>initial_state_prop s0</span></span></span><br><span><var>n</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>s</var><span class="hyp-type"><b>: </b><span>state</span></span></span><br><span><var>Hnth</var><span class="hyp-type"><b>: </b><span>trace_nth (Infinite s0 l) n = Some s</span></span></span><br><span><var>Hle</var><span class="hyp-type"><b>: </b><span>n ‚â§ n</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">valid_state_prop s</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">        </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="VLSM-v-chk3fb" style="display: none" type="checkbox"><label class="alectryon-input" for="VLSM-v-chk3fb"><span class="nb">specialize</span> (infinite_valid_trace_from_segment s0 l Htr n n Hle)
        ; <span class="nb">simpl</span>; <span class="nb">intros</span> Hseg.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>message</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>X</var><span class="hyp-type"><b>: </b><span>VLSM message</span></span></span><br><span><var>TypeX</var><span><span class="hyp-body"><b>:= </b><span>type X</span></span><span class="hyp-type"><b>: </b><span>VLSMType message</span></span></span></span><br><span><var>MachineX</var><span><span class="hyp-body"><b>:= </b><span>machine X</span></span><span class="hyp-type"><b>: </b><span>VLSMMachine (vtype X)</span></span></span></span><br><span><var>s0</var><span class="hyp-type"><b>: </b><span>state</span></span></span><br><span><var>l</var><span class="hyp-type"><b>: </b><span>Stream transition_item</span></span></span><br><span><var>Htr</var><span class="hyp-type"><b>: </b><span>infinite_valid_trace_from s0 l</span></span></span><br><span><var>Hinit</var><span class="hyp-type"><b>: </b><span>initial_state_prop s0</span></span></span><br><span><var>n</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>s</var><span class="hyp-type"><b>: </b><span>state</span></span></span><br><span><var>Hnth</var><span class="hyp-type"><b>: </b><span>trace_nth (Infinite s0 l) n = Some s</span></span></span><br><span><var>Hle</var><span class="hyp-type"><b>: </b><span>n ‚â§ n</span></span></span><br><span><var>Hseg</var><span class="hyp-type"><b>: </b><span>finite_valid_trace_from
  (Str_nth n (Cons s0 (map destination l)))
  (stream_segment l n n)</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">valid_state_prop s</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">        </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="VLSM-v-chk3fc" style="display: none" type="checkbox"><label class="alectryon-input" for="VLSM-v-chk3fc"><span class="nb">inversion</span> Hnth.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>message</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>X</var><span class="hyp-type"><b>: </b><span>VLSM message</span></span></span><br><span><var>TypeX</var><span><span class="hyp-body"><b>:= </b><span>type X</span></span><span class="hyp-type"><b>: </b><span>VLSMType message</span></span></span></span><br><span><var>MachineX</var><span><span class="hyp-body"><b>:= </b><span>machine X</span></span><span class="hyp-type"><b>: </b><span>VLSMMachine (vtype X)</span></span></span></span><br><span><var>s0</var><span class="hyp-type"><b>: </b><span>state</span></span></span><br><span><var>l</var><span class="hyp-type"><b>: </b><span>Stream transition_item</span></span></span><br><span><var>Htr</var><span class="hyp-type"><b>: </b><span>infinite_valid_trace_from s0 l</span></span></span><br><span><var>Hinit</var><span class="hyp-type"><b>: </b><span>initial_state_prop s0</span></span></span><br><span><var>n</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>s</var><span class="hyp-type"><b>: </b><span>state</span></span></span><br><span><var>Hnth</var><span class="hyp-type"><b>: </b><span>trace_nth (Infinite s0 l) n = Some s</span></span></span><br><span><var>Hle</var><span class="hyp-type"><b>: </b><span>n ‚â§ n</span></span></span><br><span><var>Hseg</var><span class="hyp-type"><b>: </b><span>finite_valid_trace_from
  (Str_nth n (Cons s0 (map destination l)))
  (stream_segment l n n)</span></span></span><br><span><var>H0</var><span class="hyp-type"><b>: </b><span>Str_nth n (Cons s0 (map destination l)) = s</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">valid_state_prop
  (Str_nth n (Cons s0 (map destination l)))</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">        </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="VLSM-v-chk3fd" style="display: none" type="checkbox"><label class="alectryon-input" for="VLSM-v-chk3fd"><span class="nb">apply</span> finite_valid_trace_first_pstate <span class="kr">in</span> Hseg.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>message</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>X</var><span class="hyp-type"><b>: </b><span>VLSM message</span></span></span><br><span><var>TypeX</var><span><span class="hyp-body"><b>:= </b><span>type X</span></span><span class="hyp-type"><b>: </b><span>VLSMType message</span></span></span></span><br><span><var>MachineX</var><span><span class="hyp-body"><b>:= </b><span>machine X</span></span><span class="hyp-type"><b>: </b><span>VLSMMachine (vtype X)</span></span></span></span><br><span><var>s0</var><span class="hyp-type"><b>: </b><span>state</span></span></span><br><span><var>l</var><span class="hyp-type"><b>: </b><span>Stream transition_item</span></span></span><br><span><var>Htr</var><span class="hyp-type"><b>: </b><span>infinite_valid_trace_from s0 l</span></span></span><br><span><var>Hinit</var><span class="hyp-type"><b>: </b><span>initial_state_prop s0</span></span></span><br><span><var>n</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>s</var><span class="hyp-type"><b>: </b><span>state</span></span></span><br><span><var>Hnth</var><span class="hyp-type"><b>: </b><span>trace_nth (Infinite s0 l) n = Some s</span></span></span><br><span><var>Hle</var><span class="hyp-type"><b>: </b><span>n ‚â§ n</span></span></span><br><span><var>Hseg</var><span class="hyp-type"><b>: </b><span>valid_state_prop
  (Str_nth n (Cons s0 (map destination l)))</span></span></span><br><span><var>H0</var><span class="hyp-type"><b>: </b><span>Str_nth n (Cons s0 (map destination l)) = s</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">valid_state_prop
  (Str_nth n (Cons s0 (map destination l)))</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">        </span><span class="alectryon-sentence"><span class="alectryon-input"><span class="bp">assumption</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Qed</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
</span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="VLSM-v-chk3fe" style="display: none" type="checkbox"><label class="alectryon-input" for="VLSM-v-chk3fe"><span class="kn">Lemma</span> <span class="nf">in_futures_valid_snd</span>
      (<span class="nv">first</span> <span class="nv">second</span> : state)
      (<span class="nv">Hfutures</span>: in_futures <span class="kp">first</span> second)
      : valid_state_prop second.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>message</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>X</var><span class="hyp-type"><b>: </b><span>VLSM message</span></span></span><br><span><var>TypeX</var><span><span class="hyp-body"><b>:= </b><span>type X</span></span><span class="hyp-type"><b>: </b><span>VLSMType message</span></span></span></span><br><span><var>MachineX</var><span><span class="hyp-body"><b>:= </b><span>machine X</span></span><span class="hyp-type"><b>: </b><span>VLSMMachine (vtype X)</span></span></span></span><br><span><var>first, second</var><span class="hyp-type"><b>: </b><span>state</span></span></span><br><span><var>Hfutures</var><span class="hyp-type"><b>: </b><span>in_futures <span class="kp">first</span> second</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">valid_state_prop second</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="VLSM-v-chk3ff" style="display: none" type="checkbox"><label class="alectryon-input" for="VLSM-v-chk3ff"><span class="kn">Proof</span>.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>message</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>X</var><span class="hyp-type"><b>: </b><span>VLSM message</span></span></span><br><span><var>TypeX</var><span><span class="hyp-body"><b>:= </b><span>type X</span></span><span class="hyp-type"><b>: </b><span>VLSMType message</span></span></span></span><br><span><var>MachineX</var><span><span class="hyp-body"><b>:= </b><span>machine X</span></span><span class="hyp-type"><b>: </b><span>VLSMMachine (vtype X)</span></span></span></span><br><span><var>first, second</var><span class="hyp-type"><b>: </b><span>state</span></span></span><br><span><var>Hfutures</var><span class="hyp-type"><b>: </b><span>in_futures <span class="kp">first</span> second</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">valid_state_prop second</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">      </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="VLSM-v-chk400" style="display: none" type="checkbox"><label class="alectryon-input" for="VLSM-v-chk400"><span class="nb">specialize</span> (in_futures_witness <span class="kp">first</span> second Hfutures)
      ; <span class="nb">intros</span> [tr [n1 [n2 [Hle [Hn1 Hn2]]]]].</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>message</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>X</var><span class="hyp-type"><b>: </b><span>VLSM message</span></span></span><br><span><var>TypeX</var><span><span class="hyp-body"><b>:= </b><span>type X</span></span><span class="hyp-type"><b>: </b><span>VLSMType message</span></span></span></span><br><span><var>MachineX</var><span><span class="hyp-body"><b>:= </b><span>machine X</span></span><span class="hyp-type"><b>: </b><span>VLSMMachine (vtype X)</span></span></span></span><br><span><var>first, second</var><span class="hyp-type"><b>: </b><span>state</span></span></span><br><span><var>Hfutures</var><span class="hyp-type"><b>: </b><span>in_futures <span class="kp">first</span> second</span></span></span><br><span><var>tr</var><span class="hyp-type"><b>: </b><span>valid_trace</span></span></span><br><span><var>n1, n2</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>Hle</var><span class="hyp-type"><b>: </b><span>n1 ‚â§ n2</span></span></span><br><span><var>Hn1</var><span class="hyp-type"><b>: </b><span>trace_nth (`tr) n1 = Some <span class="kp">first</span></span></span></span><br><span><var>Hn2</var><span class="hyp-type"><b>: </b><span>trace_nth (`tr) n2 = Some second</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">valid_state_prop second</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">      </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="VLSM-v-chk401" style="display: none" type="checkbox"><label class="alectryon-input" for="VLSM-v-chk401"><span class="nb">destruct</span> tr <span class="kr">as</span> [tr Htr]; <span class="nb">simpl</span> <span class="kr">in</span> Hn2.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>message</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>X</var><span class="hyp-type"><b>: </b><span>VLSM message</span></span></span><br><span><var>TypeX</var><span><span class="hyp-body"><b>:= </b><span>type X</span></span><span class="hyp-type"><b>: </b><span>VLSMType message</span></span></span></span><br><span><var>MachineX</var><span><span class="hyp-body"><b>:= </b><span>machine X</span></span><span class="hyp-type"><b>: </b><span>VLSMMachine (vtype X)</span></span></span></span><br><span><var>first, second</var><span class="hyp-type"><b>: </b><span>state</span></span></span><br><span><var>Hfutures</var><span class="hyp-type"><b>: </b><span>in_futures <span class="kp">first</span> second</span></span></span><br><span><var>tr</var><span class="hyp-type"><b>: </b><span>Trace</span></span></span><br><span><var>Htr</var><span class="hyp-type"><b>: </b><span>valid_trace_prop tr</span></span></span><br><span><var>n1, n2</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>Hle</var><span class="hyp-type"><b>: </b><span>n1 ‚â§ n2</span></span></span><br><span><var>Hn1</var><span class="hyp-type"><b>: </b><span>trace_nth (`(tr ‚Üæ Htr)) n1 = Some <span class="kp">first</span></span></span></span><br><span><var>Hn2</var><span class="hyp-type"><b>: </b><span>trace_nth tr n2 = Some second</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">valid_state_prop second</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">      </span><span class="alectryon-sentence"><span class="alectryon-input"><span class="nb">apply</span> valid_trace_nth <span class="kr">with</span> tr n2; <span class="bp">assumption</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Qed</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
</span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="VLSM-v-chk402" style="display: none" type="checkbox"><label class="alectryon-input" for="VLSM-v-chk402"><span class="kn">Lemma</span> <span class="nf">in_futures_witness_reverse</span>
      (<span class="nv">first</span> <span class="nv">second</span> : state)
      (<span class="nv">tr</span> : valid_trace)
      (<span class="nv">n1</span> <span class="nv">n2</span> : nat)
      (<span class="nv">Hle</span> : n1 &lt;= n2)
      (<span class="nv">Hs1</span> : trace_nth (proj1_sig tr) n1 = Some <span class="kp">first</span>)
      (<span class="nv">Hs2</span> : trace_nth (proj1_sig tr) n2 = Some second)
      : in_futures <span class="kp">first</span> second.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>message</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>X</var><span class="hyp-type"><b>: </b><span>VLSM message</span></span></span><br><span><var>TypeX</var><span><span class="hyp-body"><b>:= </b><span>type X</span></span><span class="hyp-type"><b>: </b><span>VLSMType message</span></span></span></span><br><span><var>MachineX</var><span><span class="hyp-body"><b>:= </b><span>machine X</span></span><span class="hyp-type"><b>: </b><span>VLSMMachine (vtype X)</span></span></span></span><br><span><var>first, second</var><span class="hyp-type"><b>: </b><span>state</span></span></span><br><span><var>tr</var><span class="hyp-type"><b>: </b><span>valid_trace</span></span></span><br><span><var>n1, n2</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>Hle</var><span class="hyp-type"><b>: </b><span>n1 ‚â§ n2</span></span></span><br><span><var>Hs1</var><span class="hyp-type"><b>: </b><span>trace_nth (`tr) n1 = Some <span class="kp">first</span></span></span></span><br><span><var>Hs2</var><span class="hyp-type"><b>: </b><span>trace_nth (`tr) n2 = Some second</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">in_futures <span class="kp">first</span> second</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="VLSM-v-chk403" style="display: none" type="checkbox"><label class="alectryon-input" for="VLSM-v-chk403"><span class="kn">Proof</span>.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>message</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>X</var><span class="hyp-type"><b>: </b><span>VLSM message</span></span></span><br><span><var>TypeX</var><span><span class="hyp-body"><b>:= </b><span>type X</span></span><span class="hyp-type"><b>: </b><span>VLSMType message</span></span></span></span><br><span><var>MachineX</var><span><span class="hyp-body"><b>:= </b><span>machine X</span></span><span class="hyp-type"><b>: </b><span>VLSMMachine (vtype X)</span></span></span></span><br><span><var>first, second</var><span class="hyp-type"><b>: </b><span>state</span></span></span><br><span><var>tr</var><span class="hyp-type"><b>: </b><span>valid_trace</span></span></span><br><span><var>n1, n2</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>Hle</var><span class="hyp-type"><b>: </b><span>n1 ‚â§ n2</span></span></span><br><span><var>Hs1</var><span class="hyp-type"><b>: </b><span>trace_nth (`tr) n1 = Some <span class="kp">first</span></span></span></span><br><span><var>Hs2</var><span class="hyp-type"><b>: </b><span>trace_nth (`tr) n2 = Some second</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">in_futures <span class="kp">first</span> second</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">      </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="VLSM-v-chk404" style="display: none" type="checkbox"><label class="alectryon-input" for="VLSM-v-chk404"><span class="nb">destruct</span> tr <span class="kr">as</span> [tr Htr].</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>message</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>X</var><span class="hyp-type"><b>: </b><span>VLSM message</span></span></span><br><span><var>TypeX</var><span><span class="hyp-body"><b>:= </b><span>type X</span></span><span class="hyp-type"><b>: </b><span>VLSMType message</span></span></span></span><br><span><var>MachineX</var><span><span class="hyp-body"><b>:= </b><span>machine X</span></span><span class="hyp-type"><b>: </b><span>VLSMMachine (vtype X)</span></span></span></span><br><span><var>first, second</var><span class="hyp-type"><b>: </b><span>state</span></span></span><br><span><var>tr</var><span class="hyp-type"><b>: </b><span>Trace</span></span></span><br><span><var>Htr</var><span class="hyp-type"><b>: </b><span>valid_trace_prop tr</span></span></span><br><span><var>n1, n2</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>Hle</var><span class="hyp-type"><b>: </b><span>n1 ‚â§ n2</span></span></span><br><span><var>Hs1</var><span class="hyp-type"><b>: </b><span>trace_nth (`(tr ‚Üæ Htr)) n1 = Some <span class="kp">first</span></span></span></span><br><span><var>Hs2</var><span class="hyp-type"><b>: </b><span>trace_nth (`(tr ‚Üæ Htr)) n2 = Some second</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">in_futures <span class="kp">first</span> second</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">      </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="VLSM-v-chk405" style="display: none" type="checkbox"><label class="alectryon-input" for="VLSM-v-chk405"><span class="nb">simpl</span> <span class="kr">in</span> *.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>message</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>X</var><span class="hyp-type"><b>: </b><span>VLSM message</span></span></span><br><span><var>TypeX</var><span><span class="hyp-body"><b>:= </b><span>type X</span></span><span class="hyp-type"><b>: </b><span>VLSMType message</span></span></span></span><br><span><var>MachineX</var><span><span class="hyp-body"><b>:= </b><span>machine X</span></span><span class="hyp-type"><b>: </b><span>VLSMMachine (vtype X)</span></span></span></span><br><span><var>first, second</var><span class="hyp-type"><b>: </b><span>state</span></span></span><br><span><var>tr</var><span class="hyp-type"><b>: </b><span>Trace</span></span></span><br><span><var>Htr</var><span class="hyp-type"><b>: </b><span>valid_trace_prop tr</span></span></span><br><span><var>n1, n2</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>Hle</var><span class="hyp-type"><b>: </b><span>n1 ‚â§ n2</span></span></span><br><span><var>Hs1</var><span class="hyp-type"><b>: </b><span>trace_nth tr n1 = Some <span class="kp">first</span></span></span></span><br><span><var>Hs2</var><span class="hyp-type"><b>: </b><span>trace_nth tr n2 = Some second</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">in_futures <span class="kp">first</span> second</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">      </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="VLSM-v-chk406" style="display: none" type="checkbox"><label class="alectryon-input" for="VLSM-v-chk406"><span class="nb">inversion</span> Hle; <span class="nb">subst</span>; <span class="nb">clear</span> Hle.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>message</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>X</var><span class="hyp-type"><b>: </b><span>VLSM message</span></span></span><br><span><var>TypeX</var><span><span class="hyp-body"><b>:= </b><span>type X</span></span><span class="hyp-type"><b>: </b><span>VLSMType message</span></span></span></span><br><span><var>MachineX</var><span><span class="hyp-body"><b>:= </b><span>machine X</span></span><span class="hyp-type"><b>: </b><span>VLSMMachine (vtype X)</span></span></span></span><br><span><var>first, second</var><span class="hyp-type"><b>: </b><span>state</span></span></span><br><span><var>tr</var><span class="hyp-type"><b>: </b><span>Trace</span></span></span><br><span><var>Htr</var><span class="hyp-type"><b>: </b><span>valid_trace_prop tr</span></span></span><br><span><var>n2</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>Hs1</var><span class="hyp-type"><b>: </b><span>trace_nth tr n2 = Some <span class="kp">first</span></span></span></span><br><span><var>Hs2</var><span class="hyp-type"><b>: </b><span>trace_nth tr n2 = Some second</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">in_futures <span class="kp">first</span> second</div></blockquote><div class="alectryon-extra-goals"><input class="alectryon-extra-goal-toggle" id="VLSM-v-chk407" style="display: none" type="checkbox"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>message</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>X</var><span class="hyp-type"><b>: </b><span>VLSM message</span></span></span><br><span><var>TypeX</var><span><span class="hyp-body"><b>:= </b><span>type X</span></span><span class="hyp-type"><b>: </b><span>VLSMType message</span></span></span></span><br><span><var>MachineX</var><span><span class="hyp-body"><b>:= </b><span>machine X</span></span><span class="hyp-type"><b>: </b><span>VLSMMachine (vtype X)</span></span></span></span><br><span><var>first, second</var><span class="hyp-type"><b>: </b><span>state</span></span></span><br><span><var>tr</var><span class="hyp-type"><b>: </b><span>Trace</span></span></span><br><span><var>Htr</var><span class="hyp-type"><b>: </b><span>valid_trace_prop tr</span></span></span><br><span><var>n1, m</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>Hs1</var><span class="hyp-type"><b>: </b><span>trace_nth tr n1 = Some <span class="kp">first</span></span></span></span><br><span><var>Hs2</var><span class="hyp-type"><b>: </b><span>trace_nth tr (S m) = Some second</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>n1 ‚â§ m</span></span></span><br></div><label class="goal-separator" for="VLSM-v-chk407"><hr></label><div class="goal-conclusion">in_futures <span class="kp">first</span> second</div></blockquote></div></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">      </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="VLSM-v-chk408" style="display: none" type="checkbox"><label class="alectryon-input" for="VLSM-v-chk408">-</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>message</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>X</var><span class="hyp-type"><b>: </b><span>VLSM message</span></span></span><br><span><var>TypeX</var><span><span class="hyp-body"><b>:= </b><span>type X</span></span><span class="hyp-type"><b>: </b><span>VLSMType message</span></span></span></span><br><span><var>MachineX</var><span><span class="hyp-body"><b>:= </b><span>machine X</span></span><span class="hyp-type"><b>: </b><span>VLSMMachine (vtype X)</span></span></span></span><br><span><var>first, second</var><span class="hyp-type"><b>: </b><span>state</span></span></span><br><span><var>tr</var><span class="hyp-type"><b>: </b><span>Trace</span></span></span><br><span><var>Htr</var><span class="hyp-type"><b>: </b><span>valid_trace_prop tr</span></span></span><br><span><var>n2</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>Hs1</var><span class="hyp-type"><b>: </b><span>trace_nth tr n2 = Some <span class="kp">first</span></span></span></span><br><span><var>Hs2</var><span class="hyp-type"><b>: </b><span>trace_nth tr n2 = Some second</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">in_futures <span class="kp">first</span> second</div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="VLSM-v-chk409" style="display: none" type="checkbox"><label class="alectryon-input" for="VLSM-v-chk409"><span class="nb">rewrite</span> Hs1 <span class="kr">in</span> Hs2.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>message</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>X</var><span class="hyp-type"><b>: </b><span>VLSM message</span></span></span><br><span><var>TypeX</var><span><span class="hyp-body"><b>:= </b><span>type X</span></span><span class="hyp-type"><b>: </b><span>VLSMType message</span></span></span></span><br><span><var>MachineX</var><span><span class="hyp-body"><b>:= </b><span>machine X</span></span><span class="hyp-type"><b>: </b><span>VLSMMachine (vtype X)</span></span></span></span><br><span><var>first, second</var><span class="hyp-type"><b>: </b><span>state</span></span></span><br><span><var>tr</var><span class="hyp-type"><b>: </b><span>Trace</span></span></span><br><span><var>Htr</var><span class="hyp-type"><b>: </b><span>valid_trace_prop tr</span></span></span><br><span><var>n2</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>Hs1</var><span class="hyp-type"><b>: </b><span>trace_nth tr n2 = Some <span class="kp">first</span></span></span></span><br><span><var>Hs2</var><span class="hyp-type"><b>: </b><span>Some <span class="kp">first</span> = Some second</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">in_futures <span class="kp">first</span> second</div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="VLSM-v-chk40a" style="display: none" type="checkbox"><label class="alectryon-input" for="VLSM-v-chk40a"><span class="nb">inversion</span> Hs2; <span class="nb">subst</span>; <span class="nb">clear</span> Hs2.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>message</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>X</var><span class="hyp-type"><b>: </b><span>VLSM message</span></span></span><br><span><var>TypeX</var><span><span class="hyp-body"><b>:= </b><span>type X</span></span><span class="hyp-type"><b>: </b><span>VLSMType message</span></span></span></span><br><span><var>MachineX</var><span><span class="hyp-body"><b>:= </b><span>machine X</span></span><span class="hyp-type"><b>: </b><span>VLSMMachine (vtype X)</span></span></span></span><br><span><var>second</var><span class="hyp-type"><b>: </b><span>state</span></span></span><br><span><var>tr</var><span class="hyp-type"><b>: </b><span>Trace</span></span></span><br><span><var>Htr</var><span class="hyp-type"><b>: </b><span>valid_trace_prop tr</span></span></span><br><span><var>n2</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>Hs1</var><span class="hyp-type"><b>: </b><span>trace_nth tr n2 = Some second</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">in_futures second second</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">        </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="VLSM-v-chk40b" style="display: none" type="checkbox"><label class="alectryon-input" for="VLSM-v-chk40b"><span class="kr">exists</span> [].</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>message</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>X</var><span class="hyp-type"><b>: </b><span>VLSM message</span></span></span><br><span><var>TypeX</var><span><span class="hyp-body"><b>:= </b><span>type X</span></span><span class="hyp-type"><b>: </b><span>VLSMType message</span></span></span></span><br><span><var>MachineX</var><span><span class="hyp-body"><b>:= </b><span>machine X</span></span><span class="hyp-type"><b>: </b><span>VLSMMachine (vtype X)</span></span></span></span><br><span><var>second</var><span class="hyp-type"><b>: </b><span>state</span></span></span><br><span><var>tr</var><span class="hyp-type"><b>: </b><span>Trace</span></span></span><br><span><var>Htr</var><span class="hyp-type"><b>: </b><span>valid_trace_prop tr</span></span></span><br><span><var>n2</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>Hs1</var><span class="hyp-type"><b>: </b><span>trace_nth tr n2 = Some second</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">finite_valid_trace_from_to second second []</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">        </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="VLSM-v-chk40c" style="display: none" type="checkbox"><label class="alectryon-input" for="VLSM-v-chk40c"><span class="nb">constructor</span>.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>message</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>X</var><span class="hyp-type"><b>: </b><span>VLSM message</span></span></span><br><span><var>TypeX</var><span><span class="hyp-body"><b>:= </b><span>type X</span></span><span class="hyp-type"><b>: </b><span>VLSMType message</span></span></span></span><br><span><var>MachineX</var><span><span class="hyp-body"><b>:= </b><span>machine X</span></span><span class="hyp-type"><b>: </b><span>VLSMMachine (vtype X)</span></span></span></span><br><span><var>second</var><span class="hyp-type"><b>: </b><span>state</span></span></span><br><span><var>tr</var><span class="hyp-type"><b>: </b><span>Trace</span></span></span><br><span><var>Htr</var><span class="hyp-type"><b>: </b><span>valid_trace_prop tr</span></span></span><br><span><var>n2</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>Hs1</var><span class="hyp-type"><b>: </b><span>trace_nth tr n2 = Some second</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">valid_state_prop second</div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="nb">apply</span> valid_trace_nth <span class="kr">with</span> tr n2; <span class="bp">assumption</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">      </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="VLSM-v-chk40d" style="display: none" type="checkbox"><label class="alectryon-input" for="VLSM-v-chk40d">-</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>message</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>X</var><span class="hyp-type"><b>: </b><span>VLSM message</span></span></span><br><span><var>TypeX</var><span><span class="hyp-body"><b>:= </b><span>type X</span></span><span class="hyp-type"><b>: </b><span>VLSMType message</span></span></span></span><br><span><var>MachineX</var><span><span class="hyp-body"><b>:= </b><span>machine X</span></span><span class="hyp-type"><b>: </b><span>VLSMMachine (vtype X)</span></span></span></span><br><span><var>first, second</var><span class="hyp-type"><b>: </b><span>state</span></span></span><br><span><var>tr</var><span class="hyp-type"><b>: </b><span>Trace</span></span></span><br><span><var>Htr</var><span class="hyp-type"><b>: </b><span>valid_trace_prop tr</span></span></span><br><span><var>n1, m</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>Hs1</var><span class="hyp-type"><b>: </b><span>trace_nth tr n1 = Some <span class="kp">first</span></span></span></span><br><span><var>Hs2</var><span class="hyp-type"><b>: </b><span>trace_nth tr (S m) = Some second</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>n1 ‚â§ m</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">in_futures <span class="kp">first</span> second</div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="VLSM-v-chk40e" style="display: none" type="checkbox"><label class="alectryon-input" for="VLSM-v-chk40e"><span class="kr">exists</span> (<span class="nv">trace_segment</span> <span class="nv">tr</span> <span class="nv">n1</span> (S m)).</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>message</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>X</var><span class="hyp-type"><b>: </b><span>VLSM message</span></span></span><br><span><var>TypeX</var><span><span class="hyp-body"><b>:= </b><span>type X</span></span><span class="hyp-type"><b>: </b><span>VLSMType message</span></span></span></span><br><span><var>MachineX</var><span><span class="hyp-body"><b>:= </b><span>machine X</span></span><span class="hyp-type"><b>: </b><span>VLSMMachine (vtype X)</span></span></span></span><br><span><var>first, second</var><span class="hyp-type"><b>: </b><span>state</span></span></span><br><span><var>tr</var><span class="hyp-type"><b>: </b><span>Trace</span></span></span><br><span><var>Htr</var><span class="hyp-type"><b>: </b><span>valid_trace_prop tr</span></span></span><br><span><var>n1, m</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>Hs1</var><span class="hyp-type"><b>: </b><span>trace_nth tr n1 = Some <span class="kp">first</span></span></span></span><br><span><var>Hs2</var><span class="hyp-type"><b>: </b><span>trace_nth tr (S m) = Some second</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>n1 ‚â§ m</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">finite_valid_trace_from_to <span class="kp">first</span> second
  (trace_segment tr n1 (S m))</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">        </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="VLSM-v-chk40f" style="display: none" type="checkbox"><label class="alectryon-input" for="VLSM-v-chk40f"><span class="nb">apply</span> finite_valid_trace_from_add_last.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>message</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>X</var><span class="hyp-type"><b>: </b><span>VLSM message</span></span></span><br><span><var>TypeX</var><span><span class="hyp-body"><b>:= </b><span>type X</span></span><span class="hyp-type"><b>: </b><span>VLSMType message</span></span></span></span><br><span><var>MachineX</var><span><span class="hyp-body"><b>:= </b><span>machine X</span></span><span class="hyp-type"><b>: </b><span>VLSMMachine (vtype X)</span></span></span></span><br><span><var>first, second</var><span class="hyp-type"><b>: </b><span>state</span></span></span><br><span><var>tr</var><span class="hyp-type"><b>: </b><span>Trace</span></span></span><br><span><var>Htr</var><span class="hyp-type"><b>: </b><span>valid_trace_prop tr</span></span></span><br><span><var>n1, m</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>Hs1</var><span class="hyp-type"><b>: </b><span>trace_nth tr n1 = Some <span class="kp">first</span></span></span></span><br><span><var>Hs2</var><span class="hyp-type"><b>: </b><span>trace_nth tr (S m) = Some second</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>n1 ‚â§ m</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">finite_valid_trace_from <span class="kp">first</span>
  (trace_segment tr n1 (S m))</div></blockquote><div class="alectryon-extra-goals"><input class="alectryon-extra-goal-toggle" id="VLSM-v-chk410" style="display: none" type="checkbox"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>message</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>X</var><span class="hyp-type"><b>: </b><span>VLSM message</span></span></span><br><span><var>TypeX</var><span><span class="hyp-body"><b>:= </b><span>type X</span></span><span class="hyp-type"><b>: </b><span>VLSMType message</span></span></span></span><br><span><var>MachineX</var><span><span class="hyp-body"><b>:= </b><span>machine X</span></span><span class="hyp-type"><b>: </b><span>VLSMMachine (vtype X)</span></span></span></span><br><span><var>first, second</var><span class="hyp-type"><b>: </b><span>state</span></span></span><br><span><var>tr</var><span class="hyp-type"><b>: </b><span>Trace</span></span></span><br><span><var>Htr</var><span class="hyp-type"><b>: </b><span>valid_trace_prop tr</span></span></span><br><span><var>n1, m</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>Hs1</var><span class="hyp-type"><b>: </b><span>trace_nth tr n1 = Some <span class="kp">first</span></span></span></span><br><span><var>Hs2</var><span class="hyp-type"><b>: </b><span>trace_nth tr (S m) = Some second</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>n1 ‚â§ m</span></span></span><br></div><label class="goal-separator" for="VLSM-v-chk410"><hr></label><div class="goal-conclusion">finite_trace_last <span class="kp">first</span> (trace_segment tr n1 (S m)) =
second</div></blockquote></div></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">        </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="VLSM-v-chk411" style="display: none" type="checkbox"><label class="alectryon-input" for="VLSM-v-chk411">+</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>message</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>X</var><span class="hyp-type"><b>: </b><span>VLSM message</span></span></span><br><span><var>TypeX</var><span><span class="hyp-body"><b>:= </b><span>type X</span></span><span class="hyp-type"><b>: </b><span>VLSMType message</span></span></span></span><br><span><var>MachineX</var><span><span class="hyp-body"><b>:= </b><span>machine X</span></span><span class="hyp-type"><b>: </b><span>VLSMMachine (vtype X)</span></span></span></span><br><span><var>first, second</var><span class="hyp-type"><b>: </b><span>state</span></span></span><br><span><var>tr</var><span class="hyp-type"><b>: </b><span>Trace</span></span></span><br><span><var>Htr</var><span class="hyp-type"><b>: </b><span>valid_trace_prop tr</span></span></span><br><span><var>n1, m</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>Hs1</var><span class="hyp-type"><b>: </b><span>trace_nth tr n1 = Some <span class="kp">first</span></span></span></span><br><span><var>Hs2</var><span class="hyp-type"><b>: </b><span>trace_nth tr (S m) = Some second</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>n1 ‚â§ m</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">finite_valid_trace_from <span class="kp">first</span>
  (trace_segment tr n1 (S m))</div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="VLSM-v-chk412" style="display: none" type="checkbox"><label class="alectryon-input" for="VLSM-v-chk412"><span class="nb">apply</span> valid_trace_segment; <span class="kp">try</span> <span class="bp">assumption</span>.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>message</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>X</var><span class="hyp-type"><b>: </b><span>VLSM message</span></span></span><br><span><var>TypeX</var><span><span class="hyp-body"><b>:= </b><span>type X</span></span><span class="hyp-type"><b>: </b><span>VLSMType message</span></span></span></span><br><span><var>MachineX</var><span><span class="hyp-body"><b>:= </b><span>machine X</span></span><span class="hyp-type"><b>: </b><span>VLSMMachine (vtype X)</span></span></span></span><br><span><var>first, second</var><span class="hyp-type"><b>: </b><span>state</span></span></span><br><span><var>tr</var><span class="hyp-type"><b>: </b><span>Trace</span></span></span><br><span><var>Htr</var><span class="hyp-type"><b>: </b><span>valid_trace_prop tr</span></span></span><br><span><var>n1, m</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>Hs1</var><span class="hyp-type"><b>: </b><span>trace_nth tr n1 = Some <span class="kp">first</span></span></span></span><br><span><var>Hs2</var><span class="hyp-type"><b>: </b><span>trace_nth tr (S m) = Some second</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>n1 ‚â§ m</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">n1 ‚â§ S m</div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="bp">lia</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">        </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="VLSM-v-chk413" style="display: none" type="checkbox"><label class="alectryon-input" for="VLSM-v-chk413">+</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>message</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>X</var><span class="hyp-type"><b>: </b><span>VLSM message</span></span></span><br><span><var>TypeX</var><span><span class="hyp-body"><b>:= </b><span>type X</span></span><span class="hyp-type"><b>: </b><span>VLSMType message</span></span></span></span><br><span><var>MachineX</var><span><span class="hyp-body"><b>:= </b><span>machine X</span></span><span class="hyp-type"><b>: </b><span>VLSMMachine (vtype X)</span></span></span></span><br><span><var>first, second</var><span class="hyp-type"><b>: </b><span>state</span></span></span><br><span><var>tr</var><span class="hyp-type"><b>: </b><span>Trace</span></span></span><br><span><var>Htr</var><span class="hyp-type"><b>: </b><span>valid_trace_prop tr</span></span></span><br><span><var>n1, m</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>Hs1</var><span class="hyp-type"><b>: </b><span>trace_nth tr n1 = Some <span class="kp">first</span></span></span></span><br><span><var>Hs2</var><span class="hyp-type"><b>: </b><span>trace_nth tr (S m) = Some second</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>n1 ‚â§ m</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">finite_trace_last <span class="kp">first</span> (trace_segment tr n1 (S m)) =
second</div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="VLSM-v-chk414" style="display: none" type="checkbox"><label class="alectryon-input" for="VLSM-v-chk414">{</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>message</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>X</var><span class="hyp-type"><b>: </b><span>VLSM message</span></span></span><br><span><var>TypeX</var><span><span class="hyp-body"><b>:= </b><span>type X</span></span><span class="hyp-type"><b>: </b><span>VLSMType message</span></span></span></span><br><span><var>MachineX</var><span><span class="hyp-body"><b>:= </b><span>machine X</span></span><span class="hyp-type"><b>: </b><span>VLSMMachine (vtype X)</span></span></span></span><br><span><var>first, second</var><span class="hyp-type"><b>: </b><span>state</span></span></span><br><span><var>tr</var><span class="hyp-type"><b>: </b><span>Trace</span></span></span><br><span><var>Htr</var><span class="hyp-type"><b>: </b><span>valid_trace_prop tr</span></span></span><br><span><var>n1, m</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>Hs1</var><span class="hyp-type"><b>: </b><span>trace_nth tr n1 = Some <span class="kp">first</span></span></span></span><br><span><var>Hs2</var><span class="hyp-type"><b>: </b><span>trace_nth tr (S m) = Some second</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>n1 ‚â§ m</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">finite_trace_last <span class="kp">first</span> (trace_segment tr n1 (S m)) =
second</div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="VLSM-v-chk415" style="display: none" type="checkbox"><label class="alectryon-input" for="VLSM-v-chk415"><span class="nb">destruct</span> tr <span class="kr">as</span> [s tr | s tr]; <span class="nb">simpl</span>.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>message</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>X</var><span class="hyp-type"><b>: </b><span>VLSM message</span></span></span><br><span><var>TypeX</var><span><span class="hyp-body"><b>:= </b><span>type X</span></span><span class="hyp-type"><b>: </b><span>VLSMType message</span></span></span></span><br><span><var>MachineX</var><span><span class="hyp-body"><b>:= </b><span>machine X</span></span><span class="hyp-type"><b>: </b><span>VLSMMachine (vtype X)</span></span></span></span><br><span><var>first, second, s</var><span class="hyp-type"><b>: </b><span>state</span></span></span><br><span><var>tr</var><span class="hyp-type"><b>: </b><span>list transition_item</span></span></span><br><span><var>Htr</var><span class="hyp-type"><b>: </b><span>valid_trace_prop (Finite s tr)</span></span></span><br><span><var>n1, m</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>Hs1</var><span class="hyp-type"><b>: </b><span>trace_nth (Finite s tr) n1 = Some <span class="kp">first</span></span></span></span><br><span><var>Hs2</var><span class="hyp-type"><b>: </b><span>trace_nth (Finite s tr) (S m) = Some second</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>n1 ‚â§ m</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">finite_trace_last <span class="kp">first</span> (list_segment tr n1 (S m)) =
second</div></blockquote><div class="alectryon-extra-goals"><input class="alectryon-extra-goal-toggle" id="VLSM-v-chk416" style="display: none" type="checkbox"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>message</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>X</var><span class="hyp-type"><b>: </b><span>VLSM message</span></span></span><br><span><var>TypeX</var><span><span class="hyp-body"><b>:= </b><span>type X</span></span><span class="hyp-type"><b>: </b><span>VLSMType message</span></span></span></span><br><span><var>MachineX</var><span><span class="hyp-body"><b>:= </b><span>machine X</span></span><span class="hyp-type"><b>: </b><span>VLSMMachine (vtype X)</span></span></span></span><br><span><var>first, second, s</var><span class="hyp-type"><b>: </b><span>state</span></span></span><br><span><var>tr</var><span class="hyp-type"><b>: </b><span>Stream transition_item</span></span></span><br><span><var>Htr</var><span class="hyp-type"><b>: </b><span>valid_trace_prop (Infinite s tr)</span></span></span><br><span><var>n1, m</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>Hs1</var><span class="hyp-type"><b>: </b><span>trace_nth (Infinite s tr) n1 = Some <span class="kp">first</span></span></span></span><br><span><var>Hs2</var><span class="hyp-type"><b>: </b><span>trace_nth (Infinite s tr) (S m) = Some second</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>n1 ‚â§ m</span></span></span><br></div><label class="goal-separator" for="VLSM-v-chk416"><hr></label><div class="goal-conclusion">finite_trace_last <span class="kp">first</span> (stream_segment tr n1 (S m)) =
second</div></blockquote></div></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">          </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="VLSM-v-chk417" style="display: none" type="checkbox"><label class="alectryon-input" for="VLSM-v-chk417">-</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>message</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>X</var><span class="hyp-type"><b>: </b><span>VLSM message</span></span></span><br><span><var>TypeX</var><span><span class="hyp-body"><b>:= </b><span>type X</span></span><span class="hyp-type"><b>: </b><span>VLSMType message</span></span></span></span><br><span><var>MachineX</var><span><span class="hyp-body"><b>:= </b><span>machine X</span></span><span class="hyp-type"><b>: </b><span>VLSMMachine (vtype X)</span></span></span></span><br><span><var>first, second, s</var><span class="hyp-type"><b>: </b><span>state</span></span></span><br><span><var>tr</var><span class="hyp-type"><b>: </b><span>list transition_item</span></span></span><br><span><var>Htr</var><span class="hyp-type"><b>: </b><span>valid_trace_prop (Finite s tr)</span></span></span><br><span><var>n1, m</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>Hs1</var><span class="hyp-type"><b>: </b><span>trace_nth (Finite s tr) n1 = Some <span class="kp">first</span></span></span></span><br><span><var>Hs2</var><span class="hyp-type"><b>: </b><span>trace_nth (Finite s tr) (S m) = Some second</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>n1 ‚â§ m</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">finite_trace_last <span class="kp">first</span> (list_segment tr n1 (S m)) =
second</div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="VLSM-v-chk418" style="display: none" type="checkbox"><label class="alectryon-input" for="VLSM-v-chk418"><span class="nb">simpl</span> <span class="kr">in</span> Hs1, Hs2.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>message</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>X</var><span class="hyp-type"><b>: </b><span>VLSM message</span></span></span><br><span><var>TypeX</var><span><span class="hyp-body"><b>:= </b><span>type X</span></span><span class="hyp-type"><b>: </b><span>VLSMType message</span></span></span></span><br><span><var>MachineX</var><span><span class="hyp-body"><b>:= </b><span>machine X</span></span><span class="hyp-type"><b>: </b><span>VLSMMachine (vtype X)</span></span></span></span><br><span><var>first, second, s</var><span class="hyp-type"><b>: </b><span>state</span></span></span><br><span><var>tr</var><span class="hyp-type"><b>: </b><span>list transition_item</span></span></span><br><span><var>Htr</var><span class="hyp-type"><b>: </b><span>valid_trace_prop (Finite s tr)</span></span></span><br><span><var>n1, m</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>Hs1</var><span class="hyp-type"><b>: </b><span>finite_trace_nth s tr n1 = Some <span class="kp">first</span></span></span></span><br><span><var>Hs2</var><span class="hyp-type"><b>: </b><span>finite_trace_nth s tr (S m) = Some second</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>n1 ‚â§ m</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">finite_trace_last <span class="kp">first</span> (list_segment tr n1 (S m)) =
second</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">            </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="VLSM-v-chk419" style="display: none" type="checkbox"><label class="alectryon-input" for="VLSM-v-chk419"><span class="nb">unfold</span> list_segment.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>message</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>X</var><span class="hyp-type"><b>: </b><span>VLSM message</span></span></span><br><span><var>TypeX</var><span><span class="hyp-body"><b>:= </b><span>type X</span></span><span class="hyp-type"><b>: </b><span>VLSMType message</span></span></span></span><br><span><var>MachineX</var><span><span class="hyp-body"><b>:= </b><span>machine X</span></span><span class="hyp-type"><b>: </b><span>VLSMMachine (vtype X)</span></span></span></span><br><span><var>first, second, s</var><span class="hyp-type"><b>: </b><span>state</span></span></span><br><span><var>tr</var><span class="hyp-type"><b>: </b><span>list transition_item</span></span></span><br><span><var>Htr</var><span class="hyp-type"><b>: </b><span>valid_trace_prop (Finite s tr)</span></span></span><br><span><var>n1, m</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>Hs1</var><span class="hyp-type"><b>: </b><span>finite_trace_nth s tr n1 = Some <span class="kp">first</span></span></span></span><br><span><var>Hs2</var><span class="hyp-type"><b>: </b><span>finite_trace_nth s tr (S m) = Some second</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>n1 ‚â§ m</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">finite_trace_last <span class="kp">first</span>
  (list_suffix (list_prefix tr (S m)) n1) = second</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">            </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="VLSM-v-chk41a" style="display: none" type="checkbox"><label class="alectryon-input" for="VLSM-v-chk41a"><span class="nb">rewrite</span> finite_trace_last_suffix.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>message</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>X</var><span class="hyp-type"><b>: </b><span>VLSM message</span></span></span><br><span><var>TypeX</var><span><span class="hyp-body"><b>:= </b><span>type X</span></span><span class="hyp-type"><b>: </b><span>VLSMType message</span></span></span></span><br><span><var>MachineX</var><span><span class="hyp-body"><b>:= </b><span>machine X</span></span><span class="hyp-type"><b>: </b><span>VLSMMachine (vtype X)</span></span></span></span><br><span><var>first, second, s</var><span class="hyp-type"><b>: </b><span>state</span></span></span><br><span><var>tr</var><span class="hyp-type"><b>: </b><span>list transition_item</span></span></span><br><span><var>Htr</var><span class="hyp-type"><b>: </b><span>valid_trace_prop (Finite s tr)</span></span></span><br><span><var>n1, m</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>Hs1</var><span class="hyp-type"><b>: </b><span>finite_trace_nth s tr n1 = Some <span class="kp">first</span></span></span></span><br><span><var>Hs2</var><span class="hyp-type"><b>: </b><span>finite_trace_nth s tr (S m) = Some second</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>n1 ‚â§ m</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">finite_trace_last <span class="kp">first</span> (list_prefix tr (S m)) =
second</div></blockquote><div class="alectryon-extra-goals"><input class="alectryon-extra-goal-toggle" id="VLSM-v-chk41b" style="display: none" type="checkbox"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>message</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>X</var><span class="hyp-type"><b>: </b><span>VLSM message</span></span></span><br><span><var>TypeX</var><span><span class="hyp-body"><b>:= </b><span>type X</span></span><span class="hyp-type"><b>: </b><span>VLSMType message</span></span></span></span><br><span><var>MachineX</var><span><span class="hyp-body"><b>:= </b><span>machine X</span></span><span class="hyp-type"><b>: </b><span>VLSMMachine (vtype X)</span></span></span></span><br><span><var>first, second, s</var><span class="hyp-type"><b>: </b><span>state</span></span></span><br><span><var>tr</var><span class="hyp-type"><b>: </b><span>list transition_item</span></span></span><br><span><var>Htr</var><span class="hyp-type"><b>: </b><span>valid_trace_prop (Finite s tr)</span></span></span><br><span><var>n1, m</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>Hs1</var><span class="hyp-type"><b>: </b><span>finite_trace_nth s tr n1 = Some <span class="kp">first</span></span></span></span><br><span><var>Hs2</var><span class="hyp-type"><b>: </b><span>finite_trace_nth s tr (S m) = Some second</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>n1 ‚â§ m</span></span></span><br></div><label class="goal-separator" for="VLSM-v-chk41b"><hr></label><div class="goal-conclusion">n1 &lt; length (list_prefix tr (S m))</div></blockquote></div></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">            </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="VLSM-v-chk41c" style="display: none" type="checkbox"><label class="alectryon-input" for="VLSM-v-chk41c"><span class="nb">apply</span> finite_trace_last_prefix.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>message</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>X</var><span class="hyp-type"><b>: </b><span>VLSM message</span></span></span><br><span><var>TypeX</var><span><span class="hyp-body"><b>:= </b><span>type X</span></span><span class="hyp-type"><b>: </b><span>VLSMType message</span></span></span></span><br><span><var>MachineX</var><span><span class="hyp-body"><b>:= </b><span>machine X</span></span><span class="hyp-type"><b>: </b><span>VLSMMachine (vtype X)</span></span></span></span><br><span><var>first, second, s</var><span class="hyp-type"><b>: </b><span>state</span></span></span><br><span><var>tr</var><span class="hyp-type"><b>: </b><span>list transition_item</span></span></span><br><span><var>Htr</var><span class="hyp-type"><b>: </b><span>valid_trace_prop (Finite s tr)</span></span></span><br><span><var>n1, m</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>Hs1</var><span class="hyp-type"><b>: </b><span>finite_trace_nth s tr n1 = Some <span class="kp">first</span></span></span></span><br><span><var>Hs2</var><span class="hyp-type"><b>: </b><span>finite_trace_nth s tr (S m) = Some second</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>n1 ‚â§ m</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">finite_trace_nth <span class="kp">first</span> tr (S m) = Some second</div></blockquote><div class="alectryon-extra-goals"><input class="alectryon-extra-goal-toggle" id="VLSM-v-chk41d" style="display: none" type="checkbox"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>message</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>X</var><span class="hyp-type"><b>: </b><span>VLSM message</span></span></span><br><span><var>TypeX</var><span><span class="hyp-body"><b>:= </b><span>type X</span></span><span class="hyp-type"><b>: </b><span>VLSMType message</span></span></span></span><br><span><var>MachineX</var><span><span class="hyp-body"><b>:= </b><span>machine X</span></span><span class="hyp-type"><b>: </b><span>VLSMMachine (vtype X)</span></span></span></span><br><span><var>first, second, s</var><span class="hyp-type"><b>: </b><span>state</span></span></span><br><span><var>tr</var><span class="hyp-type"><b>: </b><span>list transition_item</span></span></span><br><span><var>Htr</var><span class="hyp-type"><b>: </b><span>valid_trace_prop (Finite s tr)</span></span></span><br><span><var>n1, m</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>Hs1</var><span class="hyp-type"><b>: </b><span>finite_trace_nth s tr n1 = Some <span class="kp">first</span></span></span></span><br><span><var>Hs2</var><span class="hyp-type"><b>: </b><span>finite_trace_nth s tr (S m) = Some second</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>n1 ‚â§ m</span></span></span><br></div><label class="goal-separator" for="VLSM-v-chk41d"><hr></label><div class="goal-conclusion">n1 &lt; length (list_prefix tr (S m))</div></blockquote></div></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="VLSM-v-chk41e" style="display: none" type="checkbox"><label class="alectryon-input" for="VLSM-v-chk41e"><span class="bp">assumption</span>.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>message</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>X</var><span class="hyp-type"><b>: </b><span>VLSM message</span></span></span><br><span><var>TypeX</var><span><span class="hyp-body"><b>:= </b><span>type X</span></span><span class="hyp-type"><b>: </b><span>VLSMType message</span></span></span></span><br><span><var>MachineX</var><span><span class="hyp-body"><b>:= </b><span>machine X</span></span><span class="hyp-type"><b>: </b><span>VLSMMachine (vtype X)</span></span></span></span><br><span><var>first, second, s</var><span class="hyp-type"><b>: </b><span>state</span></span></span><br><span><var>tr</var><span class="hyp-type"><b>: </b><span>list transition_item</span></span></span><br><span><var>Htr</var><span class="hyp-type"><b>: </b><span>valid_trace_prop (Finite s tr)</span></span></span><br><span><var>n1, m</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>Hs1</var><span class="hyp-type"><b>: </b><span>finite_trace_nth s tr n1 = Some <span class="kp">first</span></span></span></span><br><span><var>Hs2</var><span class="hyp-type"><b>: </b><span>finite_trace_nth s tr (S m) = Some second</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>n1 ‚â§ m</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">n1 &lt; length (list_prefix tr (S m))</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">            </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="VLSM-v-chk41f" style="display: none" type="checkbox"><label class="alectryon-input" for="VLSM-v-chk41f"><span class="nb">rewrite</span> list_prefix_length.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>message</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>X</var><span class="hyp-type"><b>: </b><span>VLSM message</span></span></span><br><span><var>TypeX</var><span><span class="hyp-body"><b>:= </b><span>type X</span></span><span class="hyp-type"><b>: </b><span>VLSMType message</span></span></span></span><br><span><var>MachineX</var><span><span class="hyp-body"><b>:= </b><span>machine X</span></span><span class="hyp-type"><b>: </b><span>VLSMMachine (vtype X)</span></span></span></span><br><span><var>first, second, s</var><span class="hyp-type"><b>: </b><span>state</span></span></span><br><span><var>tr</var><span class="hyp-type"><b>: </b><span>list transition_item</span></span></span><br><span><var>Htr</var><span class="hyp-type"><b>: </b><span>valid_trace_prop (Finite s tr)</span></span></span><br><span><var>n1, m</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>Hs1</var><span class="hyp-type"><b>: </b><span>finite_trace_nth s tr n1 = Some <span class="kp">first</span></span></span></span><br><span><var>Hs2</var><span class="hyp-type"><b>: </b><span>finite_trace_nth s tr (S m) = Some second</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>n1 ‚â§ m</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">n1 &lt; S m</div></blockquote><div class="alectryon-extra-goals"><input class="alectryon-extra-goal-toggle" id="VLSM-v-chk420" style="display: none" type="checkbox"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>message</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>X</var><span class="hyp-type"><b>: </b><span>VLSM message</span></span></span><br><span><var>TypeX</var><span><span class="hyp-body"><b>:= </b><span>type X</span></span><span class="hyp-type"><b>: </b><span>VLSMType message</span></span></span></span><br><span><var>MachineX</var><span><span class="hyp-body"><b>:= </b><span>machine X</span></span><span class="hyp-type"><b>: </b><span>VLSMMachine (vtype X)</span></span></span></span><br><span><var>first, second, s</var><span class="hyp-type"><b>: </b><span>state</span></span></span><br><span><var>tr</var><span class="hyp-type"><b>: </b><span>list transition_item</span></span></span><br><span><var>Htr</var><span class="hyp-type"><b>: </b><span>valid_trace_prop (Finite s tr)</span></span></span><br><span><var>n1, m</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>Hs1</var><span class="hyp-type"><b>: </b><span>finite_trace_nth s tr n1 = Some <span class="kp">first</span></span></span></span><br><span><var>Hs2</var><span class="hyp-type"><b>: </b><span>finite_trace_nth s tr (S m) = Some second</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>n1 ‚â§ m</span></span></span><br></div><label class="goal-separator" for="VLSM-v-chk420"><hr></label><div class="goal-conclusion">S m ‚â§ length tr</div></blockquote></div></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="VLSM-v-chk421" style="display: none" type="checkbox"><label class="alectryon-input" for="VLSM-v-chk421"><span class="bp">lia</span>.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>message</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>X</var><span class="hyp-type"><b>: </b><span>VLSM message</span></span></span><br><span><var>TypeX</var><span><span class="hyp-body"><b>:= </b><span>type X</span></span><span class="hyp-type"><b>: </b><span>VLSMType message</span></span></span></span><br><span><var>MachineX</var><span><span class="hyp-body"><b>:= </b><span>machine X</span></span><span class="hyp-type"><b>: </b><span>VLSMMachine (vtype X)</span></span></span></span><br><span><var>first, second, s</var><span class="hyp-type"><b>: </b><span>state</span></span></span><br><span><var>tr</var><span class="hyp-type"><b>: </b><span>list transition_item</span></span></span><br><span><var>Htr</var><span class="hyp-type"><b>: </b><span>valid_trace_prop (Finite s tr)</span></span></span><br><span><var>n1, m</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>Hs1</var><span class="hyp-type"><b>: </b><span>finite_trace_nth s tr n1 = Some <span class="kp">first</span></span></span></span><br><span><var>Hs2</var><span class="hyp-type"><b>: </b><span>finite_trace_nth s tr (S m) = Some second</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>n1 ‚â§ m</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">S m ‚â§ length tr</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">            </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="VLSM-v-chk422" style="display: none" type="checkbox"><label class="alectryon-input" for="VLSM-v-chk422"><span class="nb">apply</span> finite_trace_nth_length <span class="kr">in</span> Hs2.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>message</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>X</var><span class="hyp-type"><b>: </b><span>VLSM message</span></span></span><br><span><var>TypeX</var><span><span class="hyp-body"><b>:= </b><span>type X</span></span><span class="hyp-type"><b>: </b><span>VLSMType message</span></span></span></span><br><span><var>MachineX</var><span><span class="hyp-body"><b>:= </b><span>machine X</span></span><span class="hyp-type"><b>: </b><span>VLSMMachine (vtype X)</span></span></span></span><br><span><var>first, second, s</var><span class="hyp-type"><b>: </b><span>state</span></span></span><br><span><var>tr</var><span class="hyp-type"><b>: </b><span>list transition_item</span></span></span><br><span><var>Htr</var><span class="hyp-type"><b>: </b><span>valid_trace_prop (Finite s tr)</span></span></span><br><span><var>n1, m</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>Hs1</var><span class="hyp-type"><b>: </b><span>finite_trace_nth s tr n1 = Some <span class="kp">first</span></span></span></span><br><span><var>Hs2</var><span class="hyp-type"><b>: </b><span>S m ‚â§ length tr</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>n1 ‚â§ m</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">S m ‚â§ length tr</div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="bp">lia</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">          </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="VLSM-v-chk423" style="display: none" type="checkbox"><label class="alectryon-input" for="VLSM-v-chk423">-</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>message</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>X</var><span class="hyp-type"><b>: </b><span>VLSM message</span></span></span><br><span><var>TypeX</var><span><span class="hyp-body"><b>:= </b><span>type X</span></span><span class="hyp-type"><b>: </b><span>VLSMType message</span></span></span></span><br><span><var>MachineX</var><span><span class="hyp-body"><b>:= </b><span>machine X</span></span><span class="hyp-type"><b>: </b><span>VLSMMachine (vtype X)</span></span></span></span><br><span><var>first, second, s</var><span class="hyp-type"><b>: </b><span>state</span></span></span><br><span><var>tr</var><span class="hyp-type"><b>: </b><span>Stream transition_item</span></span></span><br><span><var>Htr</var><span class="hyp-type"><b>: </b><span>valid_trace_prop (Infinite s tr)</span></span></span><br><span><var>n1, m</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>Hs1</var><span class="hyp-type"><b>: </b><span>trace_nth (Infinite s tr) n1 = Some <span class="kp">first</span></span></span></span><br><span><var>Hs2</var><span class="hyp-type"><b>: </b><span>trace_nth (Infinite s tr) (S m) = Some second</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>n1 ‚â§ m</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">finite_trace_last <span class="kp">first</span> (stream_segment tr n1 (S m)) =
second</div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="VLSM-v-chk424" style="display: none" type="checkbox"><label class="alectryon-input" for="VLSM-v-chk424"><span class="nb">unfold</span> stream_segment.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>message</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>X</var><span class="hyp-type"><b>: </b><span>VLSM message</span></span></span><br><span><var>TypeX</var><span><span class="hyp-body"><b>:= </b><span>type X</span></span><span class="hyp-type"><b>: </b><span>VLSMType message</span></span></span></span><br><span><var>MachineX</var><span><span class="hyp-body"><b>:= </b><span>machine X</span></span><span class="hyp-type"><b>: </b><span>VLSMMachine (vtype X)</span></span></span></span><br><span><var>first, second, s</var><span class="hyp-type"><b>: </b><span>state</span></span></span><br><span><var>tr</var><span class="hyp-type"><b>: </b><span>Stream transition_item</span></span></span><br><span><var>Htr</var><span class="hyp-type"><b>: </b><span>valid_trace_prop (Infinite s tr)</span></span></span><br><span><var>n1, m</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>Hs1</var><span class="hyp-type"><b>: </b><span>trace_nth (Infinite s tr) n1 = Some <span class="kp">first</span></span></span></span><br><span><var>Hs2</var><span class="hyp-type"><b>: </b><span>trace_nth (Infinite s tr) (S m) = Some second</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>n1 ‚â§ m</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">finite_trace_last <span class="kp">first</span>
  (list_suffix (stream_prefix tr (S m)) n1) = second</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">            </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="VLSM-v-chk425" style="display: none" type="checkbox"><label class="alectryon-input" for="VLSM-v-chk425"><span class="nb">rewrite</span> unlock_finite_trace_last.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>message</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>X</var><span class="hyp-type"><b>: </b><span>VLSM message</span></span></span><br><span><var>TypeX</var><span><span class="hyp-body"><b>:= </b><span>type X</span></span><span class="hyp-type"><b>: </b><span>VLSMType message</span></span></span></span><br><span><var>MachineX</var><span><span class="hyp-body"><b>:= </b><span>machine X</span></span><span class="hyp-type"><b>: </b><span>VLSMMachine (vtype X)</span></span></span></span><br><span><var>first, second, s</var><span class="hyp-type"><b>: </b><span>state</span></span></span><br><span><var>tr</var><span class="hyp-type"><b>: </b><span>Stream transition_item</span></span></span><br><span><var>Htr</var><span class="hyp-type"><b>: </b><span>valid_trace_prop (Infinite s tr)</span></span></span><br><span><var>n1, m</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>Hs1</var><span class="hyp-type"><b>: </b><span>trace_nth (Infinite s tr) n1 = Some <span class="kp">first</span></span></span></span><br><span><var>Hs2</var><span class="hyp-type"><b>: </b><span>trace_nth (Infinite s tr) (S m) = Some second</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>n1 ‚â§ m</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">List.<span class="nb">last</span>
  (List.map destination
     (list_suffix (stream_prefix tr (S m)) n1)) <span class="kp">first</span> =
second</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">            </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="VLSM-v-chk426" style="display: none" type="checkbox"><label class="alectryon-input" for="VLSM-v-chk426"><span class="nb">rewrite</span> list_suffix_map, stream_prefix_map.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>message</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>X</var><span class="hyp-type"><b>: </b><span>VLSM message</span></span></span><br><span><var>TypeX</var><span><span class="hyp-body"><b>:= </b><span>type X</span></span><span class="hyp-type"><b>: </b><span>VLSMType message</span></span></span></span><br><span><var>MachineX</var><span><span class="hyp-body"><b>:= </b><span>machine X</span></span><span class="hyp-type"><b>: </b><span>VLSMMachine (vtype X)</span></span></span></span><br><span><var>first, second, s</var><span class="hyp-type"><b>: </b><span>state</span></span></span><br><span><var>tr</var><span class="hyp-type"><b>: </b><span>Stream transition_item</span></span></span><br><span><var>Htr</var><span class="hyp-type"><b>: </b><span>valid_trace_prop (Infinite s tr)</span></span></span><br><span><var>n1, m</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>Hs1</var><span class="hyp-type"><b>: </b><span>trace_nth (Infinite s tr) n1 = Some <span class="kp">first</span></span></span></span><br><span><var>Hs2</var><span class="hyp-type"><b>: </b><span>trace_nth (Infinite s tr) (S m) = Some second</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>n1 ‚â§ m</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">List.<span class="nb">last</span>
  (list_suffix
     (stream_prefix (map destination tr) (S m)) n1)
  <span class="kp">first</span> = second</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">            </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="VLSM-v-chk427" style="display: none" type="checkbox"><label class="alectryon-input" for="VLSM-v-chk427"><span class="nb">simpl</span> <span class="kr">in</span> Hs2.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>message</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>X</var><span class="hyp-type"><b>: </b><span>VLSM message</span></span></span><br><span><var>TypeX</var><span><span class="hyp-body"><b>:= </b><span>type X</span></span><span class="hyp-type"><b>: </b><span>VLSMType message</span></span></span></span><br><span><var>MachineX</var><span><span class="hyp-body"><b>:= </b><span>machine X</span></span><span class="hyp-type"><b>: </b><span>VLSMMachine (vtype X)</span></span></span></span><br><span><var>first, second, s</var><span class="hyp-type"><b>: </b><span>state</span></span></span><br><span><var>tr</var><span class="hyp-type"><b>: </b><span>Stream transition_item</span></span></span><br><span><var>Htr</var><span class="hyp-type"><b>: </b><span>valid_trace_prop (Infinite s tr)</span></span></span><br><span><var>n1, m</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>Hs1</var><span class="hyp-type"><b>: </b><span>trace_nth (Infinite s tr) n1 = Some <span class="kp">first</span></span></span></span><br><span><var>Hs2</var><span class="hyp-type"><b>: </b><span>Some
  (Str_nth (S m) (Cons s (map destination tr))) =
Some second</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>n1 ‚â§ m</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">List.<span class="nb">last</span>
  (list_suffix
     (stream_prefix (map destination tr) (S m)) n1)
  <span class="kp">first</span> = second</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">            </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="VLSM-v-chk428" style="display: none" type="checkbox"><label class="alectryon-input" for="VLSM-v-chk428"><span class="nb">rewrite</span> list_suffix_last.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>message</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>X</var><span class="hyp-type"><b>: </b><span>VLSM message</span></span></span><br><span><var>TypeX</var><span><span class="hyp-body"><b>:= </b><span>type X</span></span><span class="hyp-type"><b>: </b><span>VLSMType message</span></span></span></span><br><span><var>MachineX</var><span><span class="hyp-body"><b>:= </b><span>machine X</span></span><span class="hyp-type"><b>: </b><span>VLSMMachine (vtype X)</span></span></span></span><br><span><var>first, second, s</var><span class="hyp-type"><b>: </b><span>state</span></span></span><br><span><var>tr</var><span class="hyp-type"><b>: </b><span>Stream transition_item</span></span></span><br><span><var>Htr</var><span class="hyp-type"><b>: </b><span>valid_trace_prop (Infinite s tr)</span></span></span><br><span><var>n1, m</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>Hs1</var><span class="hyp-type"><b>: </b><span>trace_nth (Infinite s tr) n1 = Some <span class="kp">first</span></span></span></span><br><span><var>Hs2</var><span class="hyp-type"><b>: </b><span>Some
  (Str_nth (S m) (Cons s (map destination tr))) =
Some second</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>n1 ‚â§ m</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">List.<span class="nb">last</span> (stream_prefix (map destination tr) (S m))
  <span class="kp">first</span> = second</div></blockquote><div class="alectryon-extra-goals"><input class="alectryon-extra-goal-toggle" id="VLSM-v-chk429" style="display: none" type="checkbox"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>message</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>X</var><span class="hyp-type"><b>: </b><span>VLSM message</span></span></span><br><span><var>TypeX</var><span><span class="hyp-body"><b>:= </b><span>type X</span></span><span class="hyp-type"><b>: </b><span>VLSMType message</span></span></span></span><br><span><var>MachineX</var><span><span class="hyp-body"><b>:= </b><span>machine X</span></span><span class="hyp-type"><b>: </b><span>VLSMMachine (vtype X)</span></span></span></span><br><span><var>first, second, s</var><span class="hyp-type"><b>: </b><span>state</span></span></span><br><span><var>tr</var><span class="hyp-type"><b>: </b><span>Stream transition_item</span></span></span><br><span><var>Htr</var><span class="hyp-type"><b>: </b><span>valid_trace_prop (Infinite s tr)</span></span></span><br><span><var>n1, m</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>Hs1</var><span class="hyp-type"><b>: </b><span>trace_nth (Infinite s tr) n1 = Some <span class="kp">first</span></span></span></span><br><span><var>Hs2</var><span class="hyp-type"><b>: </b><span>Some
  (Str_nth (S m) (Cons s (map destination tr))) =
Some second</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>n1 ‚â§ m</span></span></span><br></div><label class="goal-separator" for="VLSM-v-chk429"><hr></label><div class="goal-conclusion">n1 &lt; length (stream_prefix (map destination tr) (S m))</div></blockquote></div></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">            </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="VLSM-v-chk42a" style="display: none" type="checkbox"><label class="alectryon-input" for="VLSM-v-chk42a">+</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>message</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>X</var><span class="hyp-type"><b>: </b><span>VLSM message</span></span></span><br><span><var>TypeX</var><span><span class="hyp-body"><b>:= </b><span>type X</span></span><span class="hyp-type"><b>: </b><span>VLSMType message</span></span></span></span><br><span><var>MachineX</var><span><span class="hyp-body"><b>:= </b><span>machine X</span></span><span class="hyp-type"><b>: </b><span>VLSMMachine (vtype X)</span></span></span></span><br><span><var>first, second, s</var><span class="hyp-type"><b>: </b><span>state</span></span></span><br><span><var>tr</var><span class="hyp-type"><b>: </b><span>Stream transition_item</span></span></span><br><span><var>Htr</var><span class="hyp-type"><b>: </b><span>valid_trace_prop (Infinite s tr)</span></span></span><br><span><var>n1, m</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>Hs1</var><span class="hyp-type"><b>: </b><span>trace_nth (Infinite s tr) n1 = Some <span class="kp">first</span></span></span></span><br><span><var>Hs2</var><span class="hyp-type"><b>: </b><span>Some
  (Str_nth (S m) (Cons s (map destination tr))) =
Some second</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>n1 ‚â§ m</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">List.<span class="nb">last</span> (stream_prefix (map destination tr) (S m))
  <span class="kp">first</span> = second</div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="VLSM-v-chk42b" style="display: none" type="checkbox"><label class="alectryon-input" for="VLSM-v-chk42b"><span class="nb">symmetry</span>.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>message</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>X</var><span class="hyp-type"><b>: </b><span>VLSM message</span></span></span><br><span><var>TypeX</var><span><span class="hyp-body"><b>:= </b><span>type X</span></span><span class="hyp-type"><b>: </b><span>VLSMType message</span></span></span></span><br><span><var>MachineX</var><span><span class="hyp-body"><b>:= </b><span>machine X</span></span><span class="hyp-type"><b>: </b><span>VLSMMachine (vtype X)</span></span></span></span><br><span><var>first, second, s</var><span class="hyp-type"><b>: </b><span>state</span></span></span><br><span><var>tr</var><span class="hyp-type"><b>: </b><span>Stream transition_item</span></span></span><br><span><var>Htr</var><span class="hyp-type"><b>: </b><span>valid_trace_prop (Infinite s tr)</span></span></span><br><span><var>n1, m</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>Hs1</var><span class="hyp-type"><b>: </b><span>trace_nth (Infinite s tr) n1 = Some <span class="kp">first</span></span></span></span><br><span><var>Hs2</var><span class="hyp-type"><b>: </b><span>Some
  (Str_nth (S m) (Cons s (map destination tr))) =
Some second</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>n1 ‚â§ m</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">second =
List.<span class="nb">last</span> (stream_prefix (map destination tr) (S m))
  <span class="kp">first</span></div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="VLSM-v-chk42c" style="display: none" type="checkbox"><label class="alectryon-input" for="VLSM-v-chk42c"><span class="nb">rewrite</span> stream_prefix_nth_last.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>message</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>X</var><span class="hyp-type"><b>: </b><span>VLSM message</span></span></span><br><span><var>TypeX</var><span><span class="hyp-body"><b>:= </b><span>type X</span></span><span class="hyp-type"><b>: </b><span>VLSMType message</span></span></span></span><br><span><var>MachineX</var><span><span class="hyp-body"><b>:= </b><span>machine X</span></span><span class="hyp-type"><b>: </b><span>VLSMMachine (vtype X)</span></span></span></span><br><span><var>first, second, s</var><span class="hyp-type"><b>: </b><span>state</span></span></span><br><span><var>tr</var><span class="hyp-type"><b>: </b><span>Stream transition_item</span></span></span><br><span><var>Htr</var><span class="hyp-type"><b>: </b><span>valid_trace_prop (Infinite s tr)</span></span></span><br><span><var>n1, m</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>Hs1</var><span class="hyp-type"><b>: </b><span>trace_nth (Infinite s tr) n1 = Some <span class="kp">first</span></span></span></span><br><span><var>Hs2</var><span class="hyp-type"><b>: </b><span>Some
  (Str_nth (S m) (Cons s (map destination tr))) =
Some second</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>n1 ‚â§ m</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">second = Str_nth m (map destination tr)</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">              </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="VLSM-v-chk42d" style="display: none" type="checkbox"><label class="alectryon-input" for="VLSM-v-chk42d"><span class="nb">unfold</span> Str_nth <span class="kr">in</span> Hs2.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>message</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>X</var><span class="hyp-type"><b>: </b><span>VLSM message</span></span></span><br><span><var>TypeX</var><span><span class="hyp-body"><b>:= </b><span>type X</span></span><span class="hyp-type"><b>: </b><span>VLSMType message</span></span></span></span><br><span><var>MachineX</var><span><span class="hyp-body"><b>:= </b><span>machine X</span></span><span class="hyp-type"><b>: </b><span>VLSMMachine (vtype X)</span></span></span></span><br><span><var>first, second, s</var><span class="hyp-type"><b>: </b><span>state</span></span></span><br><span><var>tr</var><span class="hyp-type"><b>: </b><span>Stream transition_item</span></span></span><br><span><var>Htr</var><span class="hyp-type"><b>: </b><span>valid_trace_prop (Infinite s tr)</span></span></span><br><span><var>n1, m</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>Hs1</var><span class="hyp-type"><b>: </b><span>trace_nth (Infinite s tr) n1 = Some <span class="kp">first</span></span></span></span><br><span><var>Hs2</var><span class="hyp-type"><b>: </b><span>Some
  (hd
     (Str_nth_tl (S m)
        (Cons s (map destination tr)))) =
Some second</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>n1 ‚â§ m</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">second = Str_nth m (map destination tr)</div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="VLSM-v-chk42e" style="display: none" type="checkbox"><label class="alectryon-input" for="VLSM-v-chk42e"><span class="nb">simpl</span> <span class="kr">in</span> Hs2.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>message</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>X</var><span class="hyp-type"><b>: </b><span>VLSM message</span></span></span><br><span><var>TypeX</var><span><span class="hyp-body"><b>:= </b><span>type X</span></span><span class="hyp-type"><b>: </b><span>VLSMType message</span></span></span></span><br><span><var>MachineX</var><span><span class="hyp-body"><b>:= </b><span>machine X</span></span><span class="hyp-type"><b>: </b><span>VLSMMachine (vtype X)</span></span></span></span><br><span><var>first, second, s</var><span class="hyp-type"><b>: </b><span>state</span></span></span><br><span><var>tr</var><span class="hyp-type"><b>: </b><span>Stream transition_item</span></span></span><br><span><var>Htr</var><span class="hyp-type"><b>: </b><span>valid_trace_prop (Infinite s tr)</span></span></span><br><span><var>n1, m</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>Hs1</var><span class="hyp-type"><b>: </b><span>trace_nth (Infinite s tr) n1 = Some <span class="kp">first</span></span></span></span><br><span><var>Hs2</var><span class="hyp-type"><b>: </b><span>Some (hd (Str_nth_tl m (map destination tr))) =
Some second</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>n1 ‚â§ m</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">second = Str_nth m (map destination tr)</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">              </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="VLSM-v-chk42f" style="display: none" type="checkbox"><label class="alectryon-input" for="VLSM-v-chk42f"><span class="nb">inversion</span> Hs2; <span class="nb">subst</span>.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>message</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>X</var><span class="hyp-type"><b>: </b><span>VLSM message</span></span></span><br><span><var>TypeX</var><span><span class="hyp-body"><b>:= </b><span>type X</span></span><span class="hyp-type"><b>: </b><span>VLSMType message</span></span></span></span><br><span><var>MachineX</var><span><span class="hyp-body"><b>:= </b><span>machine X</span></span><span class="hyp-type"><b>: </b><span>VLSMMachine (vtype X)</span></span></span></span><br><span><var>first, s</var><span class="hyp-type"><b>: </b><span>state</span></span></span><br><span><var>tr</var><span class="hyp-type"><b>: </b><span>Stream transition_item</span></span></span><br><span><var>Htr</var><span class="hyp-type"><b>: </b><span>valid_trace_prop (Infinite s tr)</span></span></span><br><span><var>n1, m</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>Hs1</var><span class="hyp-type"><b>: </b><span>trace_nth (Infinite s tr) n1 = Some <span class="kp">first</span></span></span></span><br><span><var>Hs2</var><span class="hyp-type"><b>: </b><span>Some (hd (Str_nth_tl m (map destination tr))) =
Some (hd (Str_nth_tl m (map destination tr)))</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>n1 ‚â§ m</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">hd (Str_nth_tl m (map destination tr)) =
Str_nth m (map destination tr)</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">              </span><span class="alectryon-sentence"><span class="alectryon-input"><span class="bp">reflexivity</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">            </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="VLSM-v-chk430" style="display: none" type="checkbox"><label class="alectryon-input" for="VLSM-v-chk430">+</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>message</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>X</var><span class="hyp-type"><b>: </b><span>VLSM message</span></span></span><br><span><var>TypeX</var><span><span class="hyp-body"><b>:= </b><span>type X</span></span><span class="hyp-type"><b>: </b><span>VLSMType message</span></span></span></span><br><span><var>MachineX</var><span><span class="hyp-body"><b>:= </b><span>machine X</span></span><span class="hyp-type"><b>: </b><span>VLSMMachine (vtype X)</span></span></span></span><br><span><var>first, second, s</var><span class="hyp-type"><b>: </b><span>state</span></span></span><br><span><var>tr</var><span class="hyp-type"><b>: </b><span>Stream transition_item</span></span></span><br><span><var>Htr</var><span class="hyp-type"><b>: </b><span>valid_trace_prop (Infinite s tr)</span></span></span><br><span><var>n1, m</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>Hs1</var><span class="hyp-type"><b>: </b><span>trace_nth (Infinite s tr) n1 = Some <span class="kp">first</span></span></span></span><br><span><var>Hs2</var><span class="hyp-type"><b>: </b><span>Some
  (Str_nth (S m) (Cons s (map destination tr))) =
Some second</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>n1 ‚â§ m</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">n1 &lt; length (stream_prefix (map destination tr) (S m))</div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="VLSM-v-chk431" style="display: none" type="checkbox"><label class="alectryon-input" for="VLSM-v-chk431"><span class="nb">specialize</span> (stream_prefix_length (Streams.map destination tr) (S m)); <span class="nb">intro</span> Hpref_len.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>message</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>X</var><span class="hyp-type"><b>: </b><span>VLSM message</span></span></span><br><span><var>TypeX</var><span><span class="hyp-body"><b>:= </b><span>type X</span></span><span class="hyp-type"><b>: </b><span>VLSMType message</span></span></span></span><br><span><var>MachineX</var><span><span class="hyp-body"><b>:= </b><span>machine X</span></span><span class="hyp-type"><b>: </b><span>VLSMMachine (vtype X)</span></span></span></span><br><span><var>first, second, s</var><span class="hyp-type"><b>: </b><span>state</span></span></span><br><span><var>tr</var><span class="hyp-type"><b>: </b><span>Stream transition_item</span></span></span><br><span><var>Htr</var><span class="hyp-type"><b>: </b><span>valid_trace_prop (Infinite s tr)</span></span></span><br><span><var>n1, m</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>Hs1</var><span class="hyp-type"><b>: </b><span>trace_nth (Infinite s tr) n1 = Some <span class="kp">first</span></span></span></span><br><span><var>Hs2</var><span class="hyp-type"><b>: </b><span>Some
  (Str_nth (S m) (Cons s (map destination tr))) =
Some second</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>n1 ‚â§ m</span></span></span><br><span><var>Hpref_len</var><span class="hyp-type"><b>: </b><span>length
  (stream_prefix (map destination tr)
     (S m)) = S m</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">n1 &lt; length (stream_prefix (map destination tr) (S m))</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">              </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="VLSM-v-chk432" style="display: none" type="checkbox"><label class="alectryon-input" for="VLSM-v-chk432"><span class="nb">rewrite</span> Hpref_len.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>message</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>X</var><span class="hyp-type"><b>: </b><span>VLSM message</span></span></span><br><span><var>TypeX</var><span><span class="hyp-body"><b>:= </b><span>type X</span></span><span class="hyp-type"><b>: </b><span>VLSMType message</span></span></span></span><br><span><var>MachineX</var><span><span class="hyp-body"><b>:= </b><span>machine X</span></span><span class="hyp-type"><b>: </b><span>VLSMMachine (vtype X)</span></span></span></span><br><span><var>first, second, s</var><span class="hyp-type"><b>: </b><span>state</span></span></span><br><span><var>tr</var><span class="hyp-type"><b>: </b><span>Stream transition_item</span></span></span><br><span><var>Htr</var><span class="hyp-type"><b>: </b><span>valid_trace_prop (Infinite s tr)</span></span></span><br><span><var>n1, m</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>Hs1</var><span class="hyp-type"><b>: </b><span>trace_nth (Infinite s tr) n1 = Some <span class="kp">first</span></span></span></span><br><span><var>Hs2</var><span class="hyp-type"><b>: </b><span>Some
  (Str_nth (S m) (Cons s (map destination tr))) =
Some second</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>n1 ‚â§ m</span></span></span><br><span><var>Hpref_len</var><span class="hyp-type"><b>: </b><span>length
  (stream_prefix (map destination tr)
     (S m)) = S m</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">n1 &lt; S m</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">              </span><span class="alectryon-sentence"><span class="alectryon-input"><span class="bp">lia</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">          </span><span class="alectryon-sentence"><span class="alectryon-input">}</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Qed</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">    <span class="c">(* end hide *)</span></span></pre><div class="doc">
Stating livness properties will require quantifying over complete
executions of the protocol. To make this possible, we will now define
<i>complete</i> <span class="inlinecode"><span class="id" title="var">valid_trace</span></span>s.

<div class="paragraph"> </div>

A <span class="inlinecode"><span class="id" title="var">valid_trace</span></span> is <i>terminating</i> if there's no other <span class="inlinecode"><span class="id" title="var">valid_trace</span></span>
that contains it as a prefix.

</div><pre class="alectryon-io highlight"><!-- Generator: Alectryon --><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Definition</span> <span class="nf">terminating_trace_prop</span> (<span class="nv">tr</span> : Trace) : <span class="kt">Prop</span>
       :=
         <span class="kr">match</span> tr <span class="kr">with</span>
         | Finite s ls =&gt;
             (<span class="kr">exists</span> (<span class="nv">tr</span> : valid_trace)
             (<span class="nv">last</span> : transition_item),
             trace_prefix (proj1_sig tr) <span class="nb">last</span> ls) -&gt; <span class="kt">False</span>
         | Infinite s ls =&gt; <span class="kt">False</span>
         <span class="kr">end</span>.</span></span></pre><div class="doc">
A <span class="inlinecode"><span class="id" title="var">valid_trace</span></span> is <i>complete</i>, if it is either <i>terminating</i> or infinite.

</div><pre class="alectryon-io highlight"><!-- Generator: Alectryon --><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Definition</span> <span class="nf">complete_trace_prop</span> (<span class="nv">tr</span> : Trace) : <span class="kt">Prop</span>
       := valid_trace_prop tr
          /\
          <span class="kr">match</span> tr <span class="kr">with</span>
          | Finite _ _ =&gt; terminating_trace_prop tr
          | Infinite _ _ =&gt; <span class="kt">True</span>
          <span class="kr">end</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
    <span class="c">(* begin hide *)</span>

    <span class="c">(* Implicitly, the state itself must be in the trace, and minimally the last element of the trace *)</span>
    <span class="c">(* Also implicitly, the trace leading up to the state is finite *)</span>
    <span class="c">(* Defining equivocation on these trace definitions *)</span>

    <span class="c">(* Section 7 :</span>
<span class="c">       A message m received by a valid state s with a transition label l in a</span>
<span class="c">       valid execution trace is called &quot;an equivocation&quot; if it wasn&#39;t produced</span>
<span class="c">       in that trace</span>
<span class="c">    *)</span>

    <span class="c">(* 6.2.2 Equivocation-free as a composition constraint *)</span>
</span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Definition</span> <span class="nf">composition_constraint</span> : <span class="kt">Type</span> :=
      label -&gt; state * option message -&gt; <span class="kt">Prop</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
    <span class="c">(* Decidable VLSMs *)</span>

</span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Class</span> <span class="nf">VLSM_vdecidable</span> :=
      { valid_decidable : <span class="kr">forall</span> <span class="nv">l</span> <span class="nv">som</span>, {valid l som} + {~valid l som}
      }.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp"><span class="c">(* end hide *)</span>
</span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">End</span> <span class="nf">VLSM</span>.</span></span></pre><div class="doc">
Make all arguments of <span class="inlinecode"><span class="id" title="var">valid_state_prop_ind</span></span> explicit
    so it will work with the <code>induction using</code> tactic.
    (closing the section added <code>{message}</code> as an implicit argument)
 
</div><pre class="alectryon-io highlight"><!-- Generator: Alectryon --><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Arguments</span> valid_state_message_prop_ind : <span class="kn">clear implicits</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Arguments</span> valid_state_prop_ind : <span class="kn">clear implicits</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Arguments</span> finite_valid_trace_from_to_ind : <span class="kn">clear implicits</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
</span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Arguments</span> finite_valid_trace_rev_ind : <span class="kn">clear implicits</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Arguments</span> finite_valid_trace_from_rev_ind : <span class="kn">clear implicits</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Arguments</span> finite_valid_trace_from_to_rev_ind : <span class="kn">clear implicits</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Arguments</span> finite_valid_trace_init_to_rev_ind : <span class="kn">clear implicits</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Arguments</span> finite_valid_trace_init_to_rev_strong_ind : <span class="kn">clear implicits</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
</span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Arguments</span> extend_right_finite_trace_from [message] (X) [s1] [ts] (Ht12) [l3] [iom3] [s3] [oom3] (Hv23).</span><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Arguments</span> extend_right_finite_trace_from_to [message] (X) [s1] [s2] [ts] (Ht12) [l3] [iom3] [s3] [oom3] (Hv23).</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
</span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Class</span> <span class="nf">TraceWithLast</span>
      (<span class="nv">base_prop</span> : <span class="kr">forall</span> {<span class="nv">message</span>} (<span class="nv">X</span>: VLSM message),
      @state _ (@type _ X) -&gt; list transition_item -&gt; <span class="kt">Prop</span>)
      (<span class="nv">trace_prop</span> : <span class="kr">forall</span> {<span class="nv">message</span>} (<span class="nv">X</span>: VLSM message),
        state -&gt; state -&gt; list transition_item -&gt; <span class="kt">Prop</span>) :=
  {valid_trace_add_last: <span class="kr">forall</span> [msg] [X: VLSM msg] [s f tr],
     base_prop X s tr -&gt; finite_trace_last s tr = f -&gt; trace_prop X s f tr;
   valid_trace_get_last: <span class="kr">forall</span> [msg] [X: VLSM msg] [s f tr],
     trace_prop X s f tr -&gt; finite_trace_last s tr = f;
   valid_trace_last_pstate: <span class="kr">forall</span> [msg] [X: VLSM msg] [s f tr],
     trace_prop X s f tr -&gt; valid_state_prop X f;
   valid_trace_forget_last: <span class="kr">forall</span> [msg] [X: VLSM msg] [s f tr],
     trace_prop X s f tr -&gt; base_prop X s tr
  }.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Global</span> <span class="kn">Hint Mode</span> TraceWithLast - ! : typeclass_instances.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Global</span> <span class="kn">Hint Mode</span> TraceWithLast ! - : typeclass_instances.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
</span><span class="alectryon-sentence"><input class="alectryon-toggle" id="VLSM-v-chk433" style="display: none" type="checkbox"><label class="alectryon-input" for="VLSM-v-chk433"><span class="kn">Definition</span> <span class="nf">valid_trace_add_default_last</span>
  `{TraceWithLast base_prop trace_prop}
  [msg] [X:VLSM msg] [s tr] (Htr: base_prop msg X s tr):
    trace_prop msg X s (finite_trace_last s tr) tr.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>base_prop</var><span class="hyp-type"><b>: </b><span><span class="kr">‚àÄ</span> (<span class="nv">message</span> : <span class="kt">Type</span>) (<span class="nv">X</span> : VLSM message),
  state ‚Üí list transition_item ‚Üí <span class="kt">Prop</span></span></span></span><br><span><var>trace_prop</var><span class="hyp-type"><b>: </b><span><span class="kr">‚àÄ</span> (<span class="nv">message</span> : <span class="kt">Type</span>) (<span class="nv">X</span> : VLSM message),
  state
  ‚Üí state ‚Üí list transition_item ‚Üí <span class="kt">Prop</span></span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>TraceWithLast base_prop trace_prop</span></span></span><br><span><var>msg</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>X</var><span class="hyp-type"><b>: </b><span>VLSM msg</span></span></span><br><span><var>s</var><span class="hyp-type"><b>: </b><span>state</span></span></span><br><span><var>tr</var><span class="hyp-type"><b>: </b><span>list transition_item</span></span></span><br><span><var>Htr</var><span class="hyp-type"><b>: </b><span>base_prop msg X s tr</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">trace_prop msg X s (finite_trace_last s tr) tr</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="VLSM-v-chk434" style="display: none" type="checkbox"><label class="alectryon-input" for="VLSM-v-chk434"><span class="kn">Proof</span>.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>base_prop</var><span class="hyp-type"><b>: </b><span><span class="kr">‚àÄ</span> (<span class="nv">message</span> : <span class="kt">Type</span>) (<span class="nv">X</span> : VLSM message),
  state ‚Üí list transition_item ‚Üí <span class="kt">Prop</span></span></span></span><br><span><var>trace_prop</var><span class="hyp-type"><b>: </b><span><span class="kr">‚àÄ</span> (<span class="nv">message</span> : <span class="kt">Type</span>) (<span class="nv">X</span> : VLSM message),
  state
  ‚Üí state ‚Üí list transition_item ‚Üí <span class="kt">Prop</span></span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>TraceWithLast base_prop trace_prop</span></span></span><br><span><var>msg</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>X</var><span class="hyp-type"><b>: </b><span>VLSM msg</span></span></span><br><span><var>s</var><span class="hyp-type"><b>: </b><span>state</span></span></span><br><span><var>tr</var><span class="hyp-type"><b>: </b><span>list transition_item</span></span></span><br><span><var>Htr</var><span class="hyp-type"><b>: </b><span>base_prop msg X s tr</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">trace_prop msg X s (finite_trace_last s tr) tr</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="VLSM-v-chk435" style="display: none" type="checkbox"><label class="alectryon-input" for="VLSM-v-chk435"><span class="nb">apply</span> valid_trace_add_last.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>base_prop</var><span class="hyp-type"><b>: </b><span><span class="kr">‚àÄ</span> (<span class="nv">message</span> : <span class="kt">Type</span>) (<span class="nv">X</span> : VLSM message),
  state ‚Üí list transition_item ‚Üí <span class="kt">Prop</span></span></span></span><br><span><var>trace_prop</var><span class="hyp-type"><b>: </b><span><span class="kr">‚àÄ</span> (<span class="nv">message</span> : <span class="kt">Type</span>) (<span class="nv">X</span> : VLSM message),
  state
  ‚Üí state ‚Üí list transition_item ‚Üí <span class="kt">Prop</span></span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>TraceWithLast base_prop trace_prop</span></span></span><br><span><var>msg</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>X</var><span class="hyp-type"><b>: </b><span>VLSM msg</span></span></span><br><span><var>s</var><span class="hyp-type"><b>: </b><span>state</span></span></span><br><span><var>tr</var><span class="hyp-type"><b>: </b><span>list transition_item</span></span></span><br><span><var>Htr</var><span class="hyp-type"><b>: </b><span>base_prop msg X s tr</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">base_prop msg X s tr</div></blockquote><div class="alectryon-extra-goals"><input class="alectryon-extra-goal-toggle" id="VLSM-v-chk436" style="display: none" type="checkbox"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>base_prop</var><span class="hyp-type"><b>: </b><span><span class="kr">‚àÄ</span> (<span class="nv">message</span> : <span class="kt">Type</span>) (<span class="nv">X</span> : VLSM message),
  state ‚Üí list transition_item ‚Üí <span class="kt">Prop</span></span></span></span><br><span><var>trace_prop</var><span class="hyp-type"><b>: </b><span><span class="kr">‚àÄ</span> (<span class="nv">message</span> : <span class="kt">Type</span>) (<span class="nv">X</span> : VLSM message),
  state
  ‚Üí state ‚Üí list transition_item ‚Üí <span class="kt">Prop</span></span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>TraceWithLast base_prop trace_prop</span></span></span><br><span><var>msg</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>X</var><span class="hyp-type"><b>: </b><span>VLSM msg</span></span></span><br><span><var>s</var><span class="hyp-type"><b>: </b><span>state</span></span></span><br><span><var>tr</var><span class="hyp-type"><b>: </b><span>list transition_item</span></span></span><br><span><var>Htr</var><span class="hyp-type"><b>: </b><span>base_prop msg X s tr</span></span></span><br></div><label class="goal-separator" for="VLSM-v-chk436"><hr></label><div class="goal-conclusion">finite_trace_last s tr = finite_trace_last s tr</div></blockquote></div></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="VLSM-v-chk437" style="display: none" type="checkbox"><label class="alectryon-input" for="VLSM-v-chk437"><span class="bp">assumption</span>.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>base_prop</var><span class="hyp-type"><b>: </b><span><span class="kr">‚àÄ</span> (<span class="nv">message</span> : <span class="kt">Type</span>) (<span class="nv">X</span> : VLSM message),
  state ‚Üí list transition_item ‚Üí <span class="kt">Prop</span></span></span></span><br><span><var>trace_prop</var><span class="hyp-type"><b>: </b><span><span class="kr">‚àÄ</span> (<span class="nv">message</span> : <span class="kt">Type</span>) (<span class="nv">X</span> : VLSM message),
  state
  ‚Üí state ‚Üí list transition_item ‚Üí <span class="kt">Prop</span></span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>TraceWithLast base_prop trace_prop</span></span></span><br><span><var>msg</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>X</var><span class="hyp-type"><b>: </b><span>VLSM msg</span></span></span><br><span><var>s</var><span class="hyp-type"><b>: </b><span>state</span></span></span><br><span><var>tr</var><span class="hyp-type"><b>: </b><span>list transition_item</span></span></span><br><span><var>Htr</var><span class="hyp-type"><b>: </b><span>base_prop msg X s tr</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">finite_trace_last s tr = finite_trace_last s tr</div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="bp">reflexivity</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Defined</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
</span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Instance</span> <span class="nf">trace_with_last_valid_trace_from</span>:
  TraceWithLast (@finite_valid_trace_from) (@finite_valid_trace_from_to)
  := {valid_trace_add_last := @finite_valid_trace_from_add_last;
      valid_trace_get_last := @finite_valid_trace_from_to_last;
      valid_trace_last_pstate := @finite_valid_trace_from_to_last_pstate;
      valid_trace_forget_last := @finite_valid_trace_from_to_forget_last;
     }.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
</span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Instance</span> <span class="nf">trace_with_last_valid_trace_init</span>:
  TraceWithLast (@finite_valid_trace) (@finite_valid_trace_init_to)
  := {valid_trace_add_last := @finite_valid_trace_init_add_last;
      valid_trace_get_last := @finite_valid_trace_init_to_last;
      valid_trace_last_pstate _ _ _ _ _ H := valid_trace_last_pstate (proj1 H);
      valid_trace_forget_last := @finite_valid_trace_init_to_forget_last;
     }.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
</span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Class</span> <span class="nf">TraceWithStart</span>
     {<span class="nv">message</span>} {<span class="nv">X</span> : VLSM message}
     (<span class="nv">start</span> : @state message (type X))
     (<span class="nv">trace_prop</span> : list (transition_item (type X)) -&gt; <span class="kt">Prop</span>) :=
 {valid_trace_first_pstate:
    <span class="kr">forall</span> [tr], trace_prop tr -&gt; valid_state_prop X start
 }.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Global</span> <span class="kn">Hint Mode</span> TraceWithStart - - - ! : typeclass_instances.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
</span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Instance</span> <span class="nf">trace_with_start_valid_trace_from</span> <span class="nv">message</span> (<span class="nv">X</span>: VLSM message) <span class="nv">s</span>:
  TraceWithStart s (finite_valid_trace_from X s)
  := {valid_trace_first_pstate := finite_valid_trace_first_pstate X s}.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Instance</span> <span class="nf">trace_with_start_valid_trace</span> <span class="nv">message</span> (<span class="nv">X</span>: VLSM message) <span class="nv">s</span>:
  TraceWithStart s (finite_valid_trace X s)
  := {valid_trace_first_pstate tr H := valid_trace_first_pstate (proj1 H)}.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Instance</span> <span class="nf">trace_with_start_valid_trace_from_to</span> <span class="nv">message</span> (<span class="nv">X</span>: VLSM message) <span class="nv">s</span> <span class="nv">f</span>:
  TraceWithStart s (finite_valid_trace_from_to X s f)
  := {valid_trace_first_pstate tr H := valid_trace_first_pstate (valid_trace_forget_last H)}.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Instance</span> <span class="nf">trace_with_start_valid_trace_init_to</span> <span class="nv">message</span> (<span class="nv">X</span>: VLSM message) <span class="nv">s</span> <span class="nv">f</span>:
  TraceWithStart s (finite_valid_trace_init_to X s f)
  := {valid_trace_first_pstate tr H := valid_trace_first_pstate (valid_trace_forget_last H)}.</span></span></pre><div class="doc">
<a id="lab15"></a><h3 class="section">Pre-loaded VLSMs</h3>
<div class="paragraph"> </div>

Given a VLSM <code>X</code>, we introduce the <i>pre-loaded</i> version of it,
which is identical to <code>X</code>, except that it is endowed with the
whole message universe as its initial messages. The high degree
of freedom allowed to the <i>pre-loaded</i> version lets it experience
everything experienced by <code>X</code> but also other types of behaviour,
including <i>Byzantine</i> behaviour, which makes it a useful concept in
Byzantine fault tolerance analysis.

</div><pre class="alectryon-io highlight"><!-- Generator: Alectryon --><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Section</span> <span class="nf">pre_loaded_with_all_messages_vlsm</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Context</span>
      {<span class="nv">message</span> : <span class="kt">Type</span>}
      (<span class="nv">X</span> : VLSM message)
      .</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
</span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Definition</span> <span class="nf">pre_loaded_with_all_messages_vlsm_machine</span>
    : VLSMMachine (type X)
    :=
    {| initial_state_prop := vinitial_state_prop X
     ; initial_message_prop := <span class="kr">fun</span> <span class="nv">message</span> =&gt; <span class="kt">True</span>
     ; s0 := @s0 _ _ (machine X)
     ; transition := vtransition X
     ; valid := vvalid X
    |}.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
</span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Definition</span> <span class="nf">pre_loaded_with_all_messages_vlsm</span>
    : VLSM message
    := mk_vlsm pre_loaded_with_all_messages_vlsm_machine.</span></span></pre><div class="doc">
    A message which can be emitted during a protocol run of
    the <span class="inlinecode"><span class="id" title="var">pre_loaded_with_all_messages_vlsm</span></span> is called a <span class="inlinecode"><span class="id" title="var">byzantine_message</span></span>, because
    as shown by Lemmas <span class="inlinecode"><span class="id" title="var">byzantine_pre_loaded_with_all_messages</span></span> and <span class="inlinecode"><span class="id" title="var">pre_loaded_with_all_messages_alt_eq</span></span>,
    byzantine traces for a <span class="inlinecode"><span class="id" title="var">VLSM</span></span> are precisely the valid traces
    of the <span class="inlinecode"><span class="id" title="var">pre_loaded_with_all_messages_vlsm</span></span>, hence a byzantine message is any message
    which a byzantine trace <span class="inlinecode"><span class="id" title="var">can_emit</span></span>.
  
</div><pre class="alectryon-io highlight"><!-- Generator: Alectryon --><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Definition</span> <span class="nf">byzantine_message_prop</span>
    (<span class="nv">m</span> : message)
    : <span class="kt">Prop</span>
    := can_emit pre_loaded_with_all_messages_vlsm m.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
</span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Definition</span> <span class="nf">byzantine_message</span> : <span class="kt">Type</span>
    := sig byzantine_message_prop.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
  <span class="c">(* begin hide *)</span>
</span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="VLSM-v-chk438" style="display: none" type="checkbox"><label class="alectryon-input" for="VLSM-v-chk438"><span class="kn">Lemma</span> <span class="nf">pre_loaded_with_all_messages_message_valid_initial_state_message</span>
    (<span class="nv">om</span> : option message)
    : valid_state_message_prop pre_loaded_with_all_messages_vlsm (proj1_sig (vs0 X)) om.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>message</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>X</var><span class="hyp-type"><b>: </b><span>VLSM message</span></span></span><br><span><var>om</var><span class="hyp-type"><b>: </b><span>option message</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">valid_state_message_prop
  pre_loaded_with_all_messages_vlsm (`(vs0 X)) om</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="VLSM-v-chk439" style="display: none" type="checkbox"><label class="alectryon-input" for="VLSM-v-chk439"><span class="kn">Proof</span>.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>message</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>X</var><span class="hyp-type"><b>: </b><span>VLSM message</span></span></span><br><span><var>om</var><span class="hyp-type"><b>: </b><span>option message</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">valid_state_message_prop
  pre_loaded_with_all_messages_vlsm (`(vs0 X)) om</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="VLSM-v-chk43a" style="display: none" type="checkbox"><label class="alectryon-input" for="VLSM-v-chk43a"><span class="nb">apply</span> valid_initial_state_message;[<span class="nb">apply</span> proj2_sig|].</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>message</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>X</var><span class="hyp-type"><b>: </b><span>VLSM message</span></span></span><br><span><var>om</var><span class="hyp-type"><b>: </b><span>option message</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">option_initial_message_prop om</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><span class="alectryon-input"><span class="nb">destruct</span> om;<span class="bp">exact</span> I.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Qed</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
</span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="VLSM-v-chk43b" style="display: none" type="checkbox"><label class="alectryon-input" for="VLSM-v-chk43b"><span class="kn">Lemma</span> <span class="nf">pre_loaded_with_all_messages_valid_state_message_preservation</span>
    (<span class="nv">s</span> : state)
    (<span class="nv">om</span> : option message)
    (<span class="nv">Hps</span> : valid_state_message_prop X s om)
    : valid_state_message_prop pre_loaded_with_all_messages_vlsm s om.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>message</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>X</var><span class="hyp-type"><b>: </b><span>VLSM message</span></span></span><br><span><var>s</var><span class="hyp-type"><b>: </b><span>state</span></span></span><br><span><var>om</var><span class="hyp-type"><b>: </b><span>option message</span></span></span><br><span><var>Hps</var><span class="hyp-type"><b>: </b><span>valid_state_message_prop X s om</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">valid_state_message_prop
  pre_loaded_with_all_messages_vlsm s om</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="VLSM-v-chk43c" style="display: none" type="checkbox"><label class="alectryon-input" for="VLSM-v-chk43c"><span class="kn">Proof</span>.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>message</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>X</var><span class="hyp-type"><b>: </b><span>VLSM message</span></span></span><br><span><var>s</var><span class="hyp-type"><b>: </b><span>state</span></span></span><br><span><var>om</var><span class="hyp-type"><b>: </b><span>option message</span></span></span><br><span><var>Hps</var><span class="hyp-type"><b>: </b><span>valid_state_message_prop X s om</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">valid_state_message_prop
  pre_loaded_with_all_messages_vlsm s om</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="VLSM-v-chk43d" style="display: none" type="checkbox"><label class="alectryon-input" for="VLSM-v-chk43d"><span class="nb">induction</span> Hps.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>message</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>X</var><span class="hyp-type"><b>: </b><span>VLSM message</span></span></span><br><span><var>s</var><span class="hyp-type"><b>: </b><span>state</span></span></span><br><span><var>Hs</var><span class="hyp-type"><b>: </b><span>initial_state_prop s</span></span></span><br><span><var>om</var><span class="hyp-type"><b>: </b><span>option message</span></span></span><br><span><var>Hom</var><span class="hyp-type"><b>: </b><span>option_initial_message_prop om</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">valid_state_message_prop
  pre_loaded_with_all_messages_vlsm s om</div></blockquote><div class="alectryon-extra-goals"><input class="alectryon-extra-goal-toggle" id="VLSM-v-chk43e" style="display: none" type="checkbox"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>message</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>X</var><span class="hyp-type"><b>: </b><span>VLSM message</span></span></span><br><span><var>s</var><span class="hyp-type"><b>: </b><span>state</span></span></span><br><span><var>_om</var><span class="hyp-type"><b>: </b><span>option message</span></span></span><br><span><var>Hps1</var><span class="hyp-type"><b>: </b><span>valid_state_message_prop X s _om</span></span></span><br><span><var>_s</var><span class="hyp-type"><b>: </b><span>state</span></span></span><br><span><var>om</var><span class="hyp-type"><b>: </b><span>option message</span></span></span><br><span><var>Hps2</var><span class="hyp-type"><b>: </b><span>valid_state_message_prop X _s om</span></span></span><br><span><var>l0</var><span class="hyp-type"><b>: </b><span>label</span></span></span><br><span><var>Hv</var><span class="hyp-type"><b>: </b><span>valid l0 (s, om)</span></span></span><br><span><var>s'</var><span class="hyp-type"><b>: </b><span>state</span></span></span><br><span><var>om'</var><span class="hyp-type"><b>: </b><span>option message</span></span></span><br><span><var>Ht</var><span class="hyp-type"><b>: </b><span>transition l0 (s, om) = (s&#39;, om&#39;)</span></span></span><br><span><var>IHHps1</var><span class="hyp-type"><b>: </b><span>valid_state_message_prop
  pre_loaded_with_all_messages_vlsm s _om</span></span></span><br><span><var>IHHps2</var><span class="hyp-type"><b>: </b><span>valid_state_message_prop
  pre_loaded_with_all_messages_vlsm _s om</span></span></span><br></div><label class="goal-separator" for="VLSM-v-chk43e"><hr></label><div class="goal-conclusion">valid_state_message_prop
  pre_loaded_with_all_messages_vlsm s&#39; om&#39;</div></blockquote></div></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="VLSM-v-chk43f" style="display: none" type="checkbox"><label class="alectryon-input" for="VLSM-v-chk43f">-</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>message</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>X</var><span class="hyp-type"><b>: </b><span>VLSM message</span></span></span><br><span><var>s</var><span class="hyp-type"><b>: </b><span>state</span></span></span><br><span><var>Hs</var><span class="hyp-type"><b>: </b><span>initial_state_prop s</span></span></span><br><span><var>om</var><span class="hyp-type"><b>: </b><span>option message</span></span></span><br><span><var>Hom</var><span class="hyp-type"><b>: </b><span>option_initial_message_prop om</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">valid_state_message_prop
  pre_loaded_with_all_messages_vlsm s om</div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="VLSM-v-chk440" style="display: none" type="checkbox"><label class="alectryon-input" for="VLSM-v-chk440"><span class="nb">apply</span> (valid_initial_state_message pre_loaded_with_all_messages_vlsm).</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>message</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>X</var><span class="hyp-type"><b>: </b><span>VLSM message</span></span></span><br><span><var>s</var><span class="hyp-type"><b>: </b><span>state</span></span></span><br><span><var>Hs</var><span class="hyp-type"><b>: </b><span>initial_state_prop s</span></span></span><br><span><var>om</var><span class="hyp-type"><b>: </b><span>option message</span></span></span><br><span><var>Hom</var><span class="hyp-type"><b>: </b><span>option_initial_message_prop om</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">initial_state_prop s</div></blockquote><div class="alectryon-extra-goals"><input class="alectryon-extra-goal-toggle" id="VLSM-v-chk441" style="display: none" type="checkbox"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>message</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>X</var><span class="hyp-type"><b>: </b><span>VLSM message</span></span></span><br><span><var>s</var><span class="hyp-type"><b>: </b><span>state</span></span></span><br><span><var>Hs</var><span class="hyp-type"><b>: </b><span>initial_state_prop s</span></span></span><br><span><var>om</var><span class="hyp-type"><b>: </b><span>option message</span></span></span><br><span><var>Hom</var><span class="hyp-type"><b>: </b><span>option_initial_message_prop om</span></span></span><br></div><label class="goal-separator" for="VLSM-v-chk441"><hr></label><div class="goal-conclusion">option_initial_message_prop om</div></blockquote></div></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">      </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="VLSM-v-chk442" style="display: none" type="checkbox"><label class="alectryon-input" for="VLSM-v-chk442"><span class="bp">assumption</span>.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>message</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>X</var><span class="hyp-type"><b>: </b><span>VLSM message</span></span></span><br><span><var>s</var><span class="hyp-type"><b>: </b><span>state</span></span></span><br><span><var>Hs</var><span class="hyp-type"><b>: </b><span>initial_state_prop s</span></span></span><br><span><var>om</var><span class="hyp-type"><b>: </b><span>option message</span></span></span><br><span><var>Hom</var><span class="hyp-type"><b>: </b><span>option_initial_message_prop om</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">option_initial_message_prop om</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">      </span><span class="alectryon-sentence"><span class="alectryon-input"><span class="nb">destruct</span> om;<span class="bp">exact</span> I.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="VLSM-v-chk443" style="display: none" type="checkbox"><label class="alectryon-input" for="VLSM-v-chk443">-</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>message</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>X</var><span class="hyp-type"><b>: </b><span>VLSM message</span></span></span><br><span><var>s</var><span class="hyp-type"><b>: </b><span>state</span></span></span><br><span><var>_om</var><span class="hyp-type"><b>: </b><span>option message</span></span></span><br><span><var>Hps1</var><span class="hyp-type"><b>: </b><span>valid_state_message_prop X s _om</span></span></span><br><span><var>_s</var><span class="hyp-type"><b>: </b><span>state</span></span></span><br><span><var>om</var><span class="hyp-type"><b>: </b><span>option message</span></span></span><br><span><var>Hps2</var><span class="hyp-type"><b>: </b><span>valid_state_message_prop X _s om</span></span></span><br><span><var>l0</var><span class="hyp-type"><b>: </b><span>label</span></span></span><br><span><var>Hv</var><span class="hyp-type"><b>: </b><span>valid l0 (s, om)</span></span></span><br><span><var>s'</var><span class="hyp-type"><b>: </b><span>state</span></span></span><br><span><var>om'</var><span class="hyp-type"><b>: </b><span>option message</span></span></span><br><span><var>Ht</var><span class="hyp-type"><b>: </b><span>transition l0 (s, om) = (s&#39;, om&#39;)</span></span></span><br><span><var>IHHps1</var><span class="hyp-type"><b>: </b><span>valid_state_message_prop
  pre_loaded_with_all_messages_vlsm s _om</span></span></span><br><span><var>IHHps2</var><span class="hyp-type"><b>: </b><span>valid_state_message_prop
  pre_loaded_with_all_messages_vlsm _s om</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">valid_state_message_prop
  pre_loaded_with_all_messages_vlsm s&#39; om&#39;</div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="nb">apply</span> (valid_generated_state_message pre_loaded_with_all_messages_vlsm) <span class="kr">with</span> s _om _s om l0; <span class="bp">assumption</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Qed</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
</span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="VLSM-v-chk444" style="display: none" type="checkbox"><label class="alectryon-input" for="VLSM-v-chk444"><span class="kn">Lemma</span> <span class="nf">pre_loaded_with_all_messages_valid_state_prop</span>
    (<span class="nv">s</span> : state)
    (<span class="nv">Hps</span> : valid_state_prop X s)
    : valid_state_prop pre_loaded_with_all_messages_vlsm s.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>message</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>X</var><span class="hyp-type"><b>: </b><span>VLSM message</span></span></span><br><span><var>s</var><span class="hyp-type"><b>: </b><span>state</span></span></span><br><span><var>Hps</var><span class="hyp-type"><b>: </b><span>valid_state_prop X s</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">valid_state_prop pre_loaded_with_all_messages_vlsm s</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="VLSM-v-chk445" style="display: none" type="checkbox"><label class="alectryon-input" for="VLSM-v-chk445"><span class="kn">Proof</span>.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>message</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>X</var><span class="hyp-type"><b>: </b><span>VLSM message</span></span></span><br><span><var>s</var><span class="hyp-type"><b>: </b><span>state</span></span></span><br><span><var>Hps</var><span class="hyp-type"><b>: </b><span>valid_state_prop X s</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">valid_state_prop pre_loaded_with_all_messages_vlsm s</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="VLSM-v-chk446" style="display: none" type="checkbox"><label class="alectryon-input" for="VLSM-v-chk446"><span class="nb">unfold</span> valid_state_prop <span class="kr">in</span> *.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>message</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>X</var><span class="hyp-type"><b>: </b><span>VLSM message</span></span></span><br><span><var>s</var><span class="hyp-type"><b>: </b><span>state</span></span></span><br><span><var>Hps</var><span class="hyp-type"><b>: </b><span><span class="kr">‚àÉ</span> <span class="nv">om</span> : option message,
  valid_state_message_prop X s om</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="kr">‚àÉ</span> <span class="nv">om</span> : option message,
  valid_state_message_prop
    pre_loaded_with_all_messages_vlsm s om</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="VLSM-v-chk447" style="display: none" type="checkbox"><label class="alectryon-input" for="VLSM-v-chk447"><span class="nb">destruct</span> Hps <span class="kr">as</span> [om Hprs].</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>message</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>X</var><span class="hyp-type"><b>: </b><span>VLSM message</span></span></span><br><span><var>s</var><span class="hyp-type"><b>: </b><span>state</span></span></span><br><span><var>om</var><span class="hyp-type"><b>: </b><span>option message</span></span></span><br><span><var>Hprs</var><span class="hyp-type"><b>: </b><span>valid_state_message_prop X s om</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="kr">‚àÉ</span> <span class="nv">om</span> : option message,
  valid_state_message_prop
    pre_loaded_with_all_messages_vlsm s om</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="VLSM-v-chk448" style="display: none" type="checkbox"><label class="alectryon-input" for="VLSM-v-chk448"><span class="kr">exists</span> <span class="nv">om</span>.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>message</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>X</var><span class="hyp-type"><b>: </b><span>VLSM message</span></span></span><br><span><var>s</var><span class="hyp-type"><b>: </b><span>state</span></span></span><br><span><var>om</var><span class="hyp-type"><b>: </b><span>option message</span></span></span><br><span><var>Hprs</var><span class="hyp-type"><b>: </b><span>valid_state_message_prop X s om</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">valid_state_message_prop
  pre_loaded_with_all_messages_vlsm s om</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="VLSM-v-chk449" style="display: none" type="checkbox"><label class="alectryon-input" for="VLSM-v-chk449"><span class="nb">apply</span> pre_loaded_with_all_messages_valid_state_message_preservation.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>message</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>X</var><span class="hyp-type"><b>: </b><span>VLSM message</span></span></span><br><span><var>s</var><span class="hyp-type"><b>: </b><span>state</span></span></span><br><span><var>om</var><span class="hyp-type"><b>: </b><span>option message</span></span></span><br><span><var>Hprs</var><span class="hyp-type"><b>: </b><span>valid_state_message_prop X s om</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">valid_state_message_prop X s om</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><span class="alectryon-input"><span class="nb">intuition</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Qed</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  <span class="c">(* end hide *)</span>

</span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="VLSM-v-chk44a" style="display: none" type="checkbox"><label class="alectryon-input" for="VLSM-v-chk44a"><span class="kn">Lemma</span> <span class="nf">any_message_is_valid_in_preloaded</span> (<span class="nv">om</span>: option message):
    option_valid_message_prop pre_loaded_with_all_messages_vlsm om.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>message</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>X</var><span class="hyp-type"><b>: </b><span>VLSM message</span></span></span><br><span><var>om</var><span class="hyp-type"><b>: </b><span>option message</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">option_valid_message_prop
  pre_loaded_with_all_messages_vlsm om</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="VLSM-v-chk44b" style="display: none" type="checkbox"><label class="alectryon-input" for="VLSM-v-chk44b"><span class="kn">Proof</span>.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>message</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>X</var><span class="hyp-type"><b>: </b><span>VLSM message</span></span></span><br><span><var>om</var><span class="hyp-type"><b>: </b><span>option message</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">option_valid_message_prop
  pre_loaded_with_all_messages_vlsm om</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="VLSM-v-chk44c" style="display: none" type="checkbox"><label class="alectryon-input" for="VLSM-v-chk44c"><span class="nb">eexists</span>.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>message</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>X</var><span class="hyp-type"><b>: </b><span>VLSM message</span></span></span><br><span><var>om</var><span class="hyp-type"><b>: </b><span>option message</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">valid_state_message_prop
  pre_loaded_with_all_messages_vlsm <span class="nl">?s</span> om</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><span class="alectryon-input"><span class="nb">apply</span> pre_loaded_with_all_messages_message_valid_initial_state_message.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Qed</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
</span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Inductive</span> <span class="nf">preloaded_valid_state_prop</span> : state -&gt; <span class="kt">Prop</span> :=
  | preloaded_valid_initial_state
      (s:state)
      (Hs: initial_state_prop (VLSMMachine:=pre_loaded_with_all_messages_vlsm_machine) s):
         preloaded_valid_state_prop s
  | preloaded_protocol_generated
      (l : label)
      (s : state)
      (Hps : preloaded_valid_state_prop s)
      (om : option message)
      (Hv : valid (VLSMMachine:=pre_loaded_with_all_messages_vlsm_machine) l (s, om))
      s&#39; om&#39;
      (Ht : transition (VLSMMachine:=pre_loaded_with_all_messages_vlsm_machine) l (s, om) = (s&#39;, om&#39;))
    : preloaded_valid_state_prop s&#39;.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
</span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="VLSM-v-chk44d" style="display: none" type="checkbox"><label class="alectryon-input" for="VLSM-v-chk44d"><span class="kn">Lemma</span> <span class="nf">preloaded_valid_state_prop_iff</span> <span class="nv">s</span>:
    valid_state_prop pre_loaded_with_all_messages_vlsm s
    &lt;-&gt; preloaded_valid_state_prop s.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>message</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>X</var><span class="hyp-type"><b>: </b><span>VLSM message</span></span></span><br><span><var>s</var><span class="hyp-type"><b>: </b><span>state</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">valid_state_prop pre_loaded_with_all_messages_vlsm s
‚Üî preloaded_valid_state_prop s</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="VLSM-v-chk44e" style="display: none" type="checkbox"><label class="alectryon-input" for="VLSM-v-chk44e"><span class="kn">Proof</span>.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>message</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>X</var><span class="hyp-type"><b>: </b><span>VLSM message</span></span></span><br><span><var>s</var><span class="hyp-type"><b>: </b><span>state</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">valid_state_prop pre_loaded_with_all_messages_vlsm s
‚Üî preloaded_valid_state_prop s</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="VLSM-v-chk44f" style="display: none" type="checkbox"><label class="alectryon-input" for="VLSM-v-chk44f"><span class="nb">split</span>.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>message</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>X</var><span class="hyp-type"><b>: </b><span>VLSM message</span></span></span><br><span><var>s</var><span class="hyp-type"><b>: </b><span>state</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">valid_state_prop pre_loaded_with_all_messages_vlsm s
‚Üí preloaded_valid_state_prop s</div></blockquote><div class="alectryon-extra-goals"><input class="alectryon-extra-goal-toggle" id="VLSM-v-chk450" style="display: none" type="checkbox"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>message</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>X</var><span class="hyp-type"><b>: </b><span>VLSM message</span></span></span><br><span><var>s</var><span class="hyp-type"><b>: </b><span>state</span></span></span><br></div><label class="goal-separator" for="VLSM-v-chk450"><hr></label><div class="goal-conclusion">preloaded_valid_state_prop s
‚Üí valid_state_prop pre_loaded_with_all_messages_vlsm s</div></blockquote></div></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="VLSM-v-chk451" style="display: none" type="checkbox"><label class="alectryon-input" for="VLSM-v-chk451">-</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>message</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>X</var><span class="hyp-type"><b>: </b><span>VLSM message</span></span></span><br><span><var>s</var><span class="hyp-type"><b>: </b><span>state</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">valid_state_prop pre_loaded_with_all_messages_vlsm s
‚Üí preloaded_valid_state_prop s</div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="VLSM-v-chk452" style="display: none" type="checkbox"><label class="alectryon-input" for="VLSM-v-chk452"><span class="nb">intros</span> [om Hvalid].</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>message</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>X</var><span class="hyp-type"><b>: </b><span>VLSM message</span></span></span><br><span><var>s</var><span class="hyp-type"><b>: </b><span>state</span></span></span><br><span><var>om</var><span class="hyp-type"><b>: </b><span>option message</span></span></span><br><span><var>Hvalid</var><span class="hyp-type"><b>: </b><span>valid_state_message_prop
  pre_loaded_with_all_messages_vlsm s om</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">preloaded_valid_state_prop s</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">      </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="VLSM-v-chk453" style="display: none" type="checkbox"><label class="alectryon-input" for="VLSM-v-chk453"><span class="nb">induction</span> Hvalid.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>message</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>X</var><span class="hyp-type"><b>: </b><span>VLSM message</span></span></span><br><span><var>s</var><span class="hyp-type"><b>: </b><span>state</span></span></span><br><span><var>Hs</var><span class="hyp-type"><b>: </b><span>initial_state_prop s</span></span></span><br><span><var>om</var><span class="hyp-type"><b>: </b><span>option message</span></span></span><br><span><var>Hom</var><span class="hyp-type"><b>: </b><span>option_initial_message_prop om</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">preloaded_valid_state_prop s</div></blockquote><div class="alectryon-extra-goals"><input class="alectryon-extra-goal-toggle" id="VLSM-v-chk454" style="display: none" type="checkbox"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>message</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>X</var><span class="hyp-type"><b>: </b><span>VLSM message</span></span></span><br><span><var>s</var><span class="hyp-type"><b>: </b><span>state</span></span></span><br><span><var>_om</var><span class="hyp-type"><b>: </b><span>option message</span></span></span><br><span><var>Hvalid1</var><span class="hyp-type"><b>: </b><span>valid_state_message_prop
  pre_loaded_with_all_messages_vlsm s _om</span></span></span><br><span><var>_s</var><span class="hyp-type"><b>: </b><span>state</span></span></span><br><span><var>om</var><span class="hyp-type"><b>: </b><span>option message</span></span></span><br><span><var>Hvalid2</var><span class="hyp-type"><b>: </b><span>valid_state_message_prop
  pre_loaded_with_all_messages_vlsm _s om</span></span></span><br><span><var>l0</var><span class="hyp-type"><b>: </b><span>label</span></span></span><br><span><var>Hv</var><span class="hyp-type"><b>: </b><span>valid l0 (s, om)</span></span></span><br><span><var>s'</var><span class="hyp-type"><b>: </b><span>state</span></span></span><br><span><var>om'</var><span class="hyp-type"><b>: </b><span>option message</span></span></span><br><span><var>Ht</var><span class="hyp-type"><b>: </b><span>transition l0 (s, om) = (s&#39;, om&#39;)</span></span></span><br><span><var>IHHvalid1</var><span class="hyp-type"><b>: </b><span>preloaded_valid_state_prop s</span></span></span><br><span><var>IHHvalid2</var><span class="hyp-type"><b>: </b><span>preloaded_valid_state_prop _s</span></span></span><br></div><label class="goal-separator" for="VLSM-v-chk454"><hr></label><div class="goal-conclusion">preloaded_valid_state_prop s&#39;</div></blockquote></div></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">      </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="VLSM-v-chk455" style="display: none" type="checkbox"><label class="alectryon-input" for="VLSM-v-chk455">+</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>message</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>X</var><span class="hyp-type"><b>: </b><span>VLSM message</span></span></span><br><span><var>s</var><span class="hyp-type"><b>: </b><span>state</span></span></span><br><span><var>Hs</var><span class="hyp-type"><b>: </b><span>initial_state_prop s</span></span></span><br><span><var>om</var><span class="hyp-type"><b>: </b><span>option message</span></span></span><br><span><var>Hom</var><span class="hyp-type"><b>: </b><span>option_initial_message_prop om</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">preloaded_valid_state_prop s</div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="VLSM-v-chk456" style="display: none" type="checkbox"><label class="alectryon-input" for="VLSM-v-chk456"><span class="nb">apply</span> preloaded_valid_initial_state.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>message</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>X</var><span class="hyp-type"><b>: </b><span>VLSM message</span></span></span><br><span><var>s</var><span class="hyp-type"><b>: </b><span>state</span></span></span><br><span><var>Hs</var><span class="hyp-type"><b>: </b><span>initial_state_prop s</span></span></span><br><span><var>om</var><span class="hyp-type"><b>: </b><span>option message</span></span></span><br><span><var>Hom</var><span class="hyp-type"><b>: </b><span>option_initial_message_prop om</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">initial_state_prop s</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">        </span><span class="alectryon-sentence"><span class="alectryon-input"><span class="bp">assumption</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">      </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="VLSM-v-chk457" style="display: none" type="checkbox"><label class="alectryon-input" for="VLSM-v-chk457">+</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>message</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>X</var><span class="hyp-type"><b>: </b><span>VLSM message</span></span></span><br><span><var>s</var><span class="hyp-type"><b>: </b><span>state</span></span></span><br><span><var>_om</var><span class="hyp-type"><b>: </b><span>option message</span></span></span><br><span><var>Hvalid1</var><span class="hyp-type"><b>: </b><span>valid_state_message_prop
  pre_loaded_with_all_messages_vlsm s _om</span></span></span><br><span><var>_s</var><span class="hyp-type"><b>: </b><span>state</span></span></span><br><span><var>om</var><span class="hyp-type"><b>: </b><span>option message</span></span></span><br><span><var>Hvalid2</var><span class="hyp-type"><b>: </b><span>valid_state_message_prop
  pre_loaded_with_all_messages_vlsm _s om</span></span></span><br><span><var>l0</var><span class="hyp-type"><b>: </b><span>label</span></span></span><br><span><var>Hv</var><span class="hyp-type"><b>: </b><span>valid l0 (s, om)</span></span></span><br><span><var>s'</var><span class="hyp-type"><b>: </b><span>state</span></span></span><br><span><var>om'</var><span class="hyp-type"><b>: </b><span>option message</span></span></span><br><span><var>Ht</var><span class="hyp-type"><b>: </b><span>transition l0 (s, om) = (s&#39;, om&#39;)</span></span></span><br><span><var>IHHvalid1</var><span class="hyp-type"><b>: </b><span>preloaded_valid_state_prop s</span></span></span><br><span><var>IHHvalid2</var><span class="hyp-type"><b>: </b><span>preloaded_valid_state_prop _s</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">preloaded_valid_state_prop s&#39;</div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="nb">apply</span> preloaded_protocol_generated <span class="kr">with</span> l0 s om om&#39;;<span class="bp">assumption</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="VLSM-v-chk458" style="display: none" type="checkbox"><label class="alectryon-input" for="VLSM-v-chk458">-</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>message</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>X</var><span class="hyp-type"><b>: </b><span>VLSM message</span></span></span><br><span><var>s</var><span class="hyp-type"><b>: </b><span>state</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">preloaded_valid_state_prop s
‚Üí valid_state_prop pre_loaded_with_all_messages_vlsm s</div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="VLSM-v-chk459" style="display: none" type="checkbox"><label class="alectryon-input" for="VLSM-v-chk459"><span class="nb">induction</span> <span class="mi">1</span>.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>message</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>X</var><span class="hyp-type"><b>: </b><span>VLSM message</span></span></span><br><span><var>s</var><span class="hyp-type"><b>: </b><span>state</span></span></span><br><span><var>Hs</var><span class="hyp-type"><b>: </b><span>initial_state_prop s</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">valid_state_prop pre_loaded_with_all_messages_vlsm s</div></blockquote><div class="alectryon-extra-goals"><input class="alectryon-extra-goal-toggle" id="VLSM-v-chk45a" style="display: none" type="checkbox"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>message</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>X</var><span class="hyp-type"><b>: </b><span>VLSM message</span></span></span><br><span><var>l0</var><span class="hyp-type"><b>: </b><span>label</span></span></span><br><span><var>s</var><span class="hyp-type"><b>: </b><span>state</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>preloaded_valid_state_prop s</span></span></span><br><span><var>om</var><span class="hyp-type"><b>: </b><span>option message</span></span></span><br><span><var>Hv</var><span class="hyp-type"><b>: </b><span>valid l0 (s, om)</span></span></span><br><span><var>s'</var><span class="hyp-type"><b>: </b><span>state</span></span></span><br><span><var>om'</var><span class="hyp-type"><b>: </b><span>option message</span></span></span><br><span><var>Ht</var><span class="hyp-type"><b>: </b><span>transition l0 (s, om) = (s&#39;, om&#39;)</span></span></span><br><span><var>IHpreloaded_valid_state_prop</var><span class="hyp-type"><b>: </b><span>valid_state_prop
  pre_loaded_with_all_messages_vlsm
  s</span></span></span><br></div><label class="goal-separator" for="VLSM-v-chk45a"><hr></label><div class="goal-conclusion">valid_state_prop pre_loaded_with_all_messages_vlsm s&#39;</div></blockquote></div></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">      </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="VLSM-v-chk45b" style="display: none" type="checkbox"><label class="alectryon-input" for="VLSM-v-chk45b">+</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>message</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>X</var><span class="hyp-type"><b>: </b><span>VLSM message</span></span></span><br><span><var>s</var><span class="hyp-type"><b>: </b><span>state</span></span></span><br><span><var>Hs</var><span class="hyp-type"><b>: </b><span>initial_state_prop s</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">valid_state_prop pre_loaded_with_all_messages_vlsm s</div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="VLSM-v-chk45c" style="display: none" type="checkbox"><label class="alectryon-input" for="VLSM-v-chk45c"><span class="kr">exists</span> <span class="nv">None</span>.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>message</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>X</var><span class="hyp-type"><b>: </b><span>VLSM message</span></span></span><br><span><var>s</var><span class="hyp-type"><b>: </b><span>state</span></span></span><br><span><var>Hs</var><span class="hyp-type"><b>: </b><span>initial_state_prop s</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">valid_state_message_prop
  pre_loaded_with_all_messages_vlsm s None</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">        </span><span class="alectryon-sentence"><span class="alectryon-input"><span class="nb">apply</span> valid_initial_state_message;[<span class="bp">assumption</span>|<span class="bp">exact</span> I].</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">      </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="VLSM-v-chk45d" style="display: none" type="checkbox"><label class="alectryon-input" for="VLSM-v-chk45d">+</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>message</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>X</var><span class="hyp-type"><b>: </b><span>VLSM message</span></span></span><br><span><var>l0</var><span class="hyp-type"><b>: </b><span>label</span></span></span><br><span><var>s</var><span class="hyp-type"><b>: </b><span>state</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>preloaded_valid_state_prop s</span></span></span><br><span><var>om</var><span class="hyp-type"><b>: </b><span>option message</span></span></span><br><span><var>Hv</var><span class="hyp-type"><b>: </b><span>valid l0 (s, om)</span></span></span><br><span><var>s'</var><span class="hyp-type"><b>: </b><span>state</span></span></span><br><span><var>om'</var><span class="hyp-type"><b>: </b><span>option message</span></span></span><br><span><var>Ht</var><span class="hyp-type"><b>: </b><span>transition l0 (s, om) = (s&#39;, om&#39;)</span></span></span><br><span><var>IHpreloaded_valid_state_prop</var><span class="hyp-type"><b>: </b><span>valid_state_prop
  pre_loaded_with_all_messages_vlsm
  s</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">valid_state_prop pre_loaded_with_all_messages_vlsm s&#39;</div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="VLSM-v-chk45e" style="display: none" type="checkbox"><label class="alectryon-input" for="VLSM-v-chk45e"><span class="kr">exists</span> <span class="nv">om&#39;</span>.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>message</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>X</var><span class="hyp-type"><b>: </b><span>VLSM message</span></span></span><br><span><var>l0</var><span class="hyp-type"><b>: </b><span>label</span></span></span><br><span><var>s</var><span class="hyp-type"><b>: </b><span>state</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>preloaded_valid_state_prop s</span></span></span><br><span><var>om</var><span class="hyp-type"><b>: </b><span>option message</span></span></span><br><span><var>Hv</var><span class="hyp-type"><b>: </b><span>valid l0 (s, om)</span></span></span><br><span><var>s'</var><span class="hyp-type"><b>: </b><span>state</span></span></span><br><span><var>om'</var><span class="hyp-type"><b>: </b><span>option message</span></span></span><br><span><var>Ht</var><span class="hyp-type"><b>: </b><span>transition l0 (s, om) = (s&#39;, om&#39;)</span></span></span><br><span><var>IHpreloaded_valid_state_prop</var><span class="hyp-type"><b>: </b><span>valid_state_prop
  pre_loaded_with_all_messages_vlsm
  s</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">valid_state_message_prop
  pre_loaded_with_all_messages_vlsm s&#39; om&#39;</div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="VLSM-v-chk45f" style="display: none" type="checkbox"><label class="alectryon-input" for="VLSM-v-chk45f"><span class="nb">destruct</span> IHpreloaded_valid_state_prop <span class="kr">as</span> [_om Hs].</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>message</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>X</var><span class="hyp-type"><b>: </b><span>VLSM message</span></span></span><br><span><var>l0</var><span class="hyp-type"><b>: </b><span>label</span></span></span><br><span><var>s</var><span class="hyp-type"><b>: </b><span>state</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>preloaded_valid_state_prop s</span></span></span><br><span><var>om</var><span class="hyp-type"><b>: </b><span>option message</span></span></span><br><span><var>Hv</var><span class="hyp-type"><b>: </b><span>valid l0 (s, om)</span></span></span><br><span><var>s'</var><span class="hyp-type"><b>: </b><span>state</span></span></span><br><span><var>om'</var><span class="hyp-type"><b>: </b><span>option message</span></span></span><br><span><var>Ht</var><span class="hyp-type"><b>: </b><span>transition l0 (s, om) = (s&#39;, om&#39;)</span></span></span><br><span><var>_om</var><span class="hyp-type"><b>: </b><span>option message</span></span></span><br><span><var>Hs</var><span class="hyp-type"><b>: </b><span>valid_state_message_prop
  pre_loaded_with_all_messages_vlsm s _om</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">valid_state_message_prop
  pre_loaded_with_all_messages_vlsm s&#39; om&#39;</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">        </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="VLSM-v-chk460" style="display: none" type="checkbox"><label class="alectryon-input" for="VLSM-v-chk460"><span class="nb">specialize</span> (any_message_is_valid_in_preloaded om) <span class="kr">as</span> [_s Hom].</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>message</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>X</var><span class="hyp-type"><b>: </b><span>VLSM message</span></span></span><br><span><var>l0</var><span class="hyp-type"><b>: </b><span>label</span></span></span><br><span><var>s</var><span class="hyp-type"><b>: </b><span>state</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>preloaded_valid_state_prop s</span></span></span><br><span><var>om</var><span class="hyp-type"><b>: </b><span>option message</span></span></span><br><span><var>Hv</var><span class="hyp-type"><b>: </b><span>valid l0 (s, om)</span></span></span><br><span><var>s'</var><span class="hyp-type"><b>: </b><span>state</span></span></span><br><span><var>om'</var><span class="hyp-type"><b>: </b><span>option message</span></span></span><br><span><var>Ht</var><span class="hyp-type"><b>: </b><span>transition l0 (s, om) = (s&#39;, om&#39;)</span></span></span><br><span><var>_om</var><span class="hyp-type"><b>: </b><span>option message</span></span></span><br><span><var>Hs</var><span class="hyp-type"><b>: </b><span>valid_state_message_prop
  pre_loaded_with_all_messages_vlsm s _om</span></span></span><br><span><var>_s</var><span class="hyp-type"><b>: </b><span>state</span></span></span><br><span><var>Hom</var><span class="hyp-type"><b>: </b><span>valid_state_message_prop
  pre_loaded_with_all_messages_vlsm _s om</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">valid_state_message_prop
  pre_loaded_with_all_messages_vlsm s&#39; om&#39;</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">        </span><span class="alectryon-sentence"><span class="alectryon-input"><span class="nb">apply</span> (valid_generated_state_message pre_loaded_with_all_messages_vlsm) <span class="kr">with</span> s _om _s om l0;<span class="bp">assumption</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Qed</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
</span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="VLSM-v-chk461" style="display: none" type="checkbox"><label class="alectryon-input" for="VLSM-v-chk461"><span class="kn">Lemma</span> <span class="nf">preloaded_weaken_valid_state_message_prop</span> <span class="nv">s</span> <span class="nv">om</span>:
    valid_state_message_prop X s om -&gt;
    valid_state_message_prop pre_loaded_with_all_messages_vlsm s om.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>message</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>X</var><span class="hyp-type"><b>: </b><span>VLSM message</span></span></span><br><span><var>s</var><span class="hyp-type"><b>: </b><span>state</span></span></span><br><span><var>om</var><span class="hyp-type"><b>: </b><span>option message</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">valid_state_message_prop X s om
‚Üí valid_state_message_prop
    pre_loaded_with_all_messages_vlsm s om</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="VLSM-v-chk462" style="display: none" type="checkbox"><label class="alectryon-input" for="VLSM-v-chk462"><span class="kn">Proof</span>.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>message</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>X</var><span class="hyp-type"><b>: </b><span>VLSM message</span></span></span><br><span><var>s</var><span class="hyp-type"><b>: </b><span>state</span></span></span><br><span><var>om</var><span class="hyp-type"><b>: </b><span>option message</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">valid_state_message_prop X s om
‚Üí valid_state_message_prop
    pre_loaded_with_all_messages_vlsm s om</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="VLSM-v-chk463" style="display: none" type="checkbox"><label class="alectryon-input" for="VLSM-v-chk463"><span class="nb">induction</span> <span class="mi">1</span>.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>message</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>X</var><span class="hyp-type"><b>: </b><span>VLSM message</span></span></span><br><span><var>s</var><span class="hyp-type"><b>: </b><span>state</span></span></span><br><span><var>Hs</var><span class="hyp-type"><b>: </b><span>initial_state_prop s</span></span></span><br><span><var>om</var><span class="hyp-type"><b>: </b><span>option message</span></span></span><br><span><var>Hom</var><span class="hyp-type"><b>: </b><span>option_initial_message_prop om</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">valid_state_message_prop
  pre_loaded_with_all_messages_vlsm s om</div></blockquote><div class="alectryon-extra-goals"><input class="alectryon-extra-goal-toggle" id="VLSM-v-chk464" style="display: none" type="checkbox"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>message</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>X</var><span class="hyp-type"><b>: </b><span>VLSM message</span></span></span><br><span><var>s</var><span class="hyp-type"><b>: </b><span>state</span></span></span><br><span><var>_om</var><span class="hyp-type"><b>: </b><span>option message</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>valid_state_message_prop X s _om</span></span></span><br><span><var>_s</var><span class="hyp-type"><b>: </b><span>state</span></span></span><br><span><var>om</var><span class="hyp-type"><b>: </b><span>option message</span></span></span><br><span><var>H0</var><span class="hyp-type"><b>: </b><span>valid_state_message_prop X _s om</span></span></span><br><span><var>l0</var><span class="hyp-type"><b>: </b><span>label</span></span></span><br><span><var>Hv</var><span class="hyp-type"><b>: </b><span>valid l0 (s, om)</span></span></span><br><span><var>s'</var><span class="hyp-type"><b>: </b><span>state</span></span></span><br><span><var>om'</var><span class="hyp-type"><b>: </b><span>option message</span></span></span><br><span><var>Ht</var><span class="hyp-type"><b>: </b><span>transition l0 (s, om) = (s&#39;, om&#39;)</span></span></span><br><span><var>IHvalid_state_message_prop1</var><span class="hyp-type"><b>: </b><span>valid_state_message_prop
  pre_loaded_with_all_messages_vlsm
  s _om</span></span></span><br><span><var>IHvalid_state_message_prop2</var><span class="hyp-type"><b>: </b><span>valid_state_message_prop
  pre_loaded_with_all_messages_vlsm
  _s om</span></span></span><br></div><label class="goal-separator" for="VLSM-v-chk464"><hr></label><div class="goal-conclusion">valid_state_message_prop
  pre_loaded_with_all_messages_vlsm s&#39; om&#39;</div></blockquote></div></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="VLSM-v-chk465" style="display: none" type="checkbox"><label class="alectryon-input" for="VLSM-v-chk465">-</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>message</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>X</var><span class="hyp-type"><b>: </b><span>VLSM message</span></span></span><br><span><var>s</var><span class="hyp-type"><b>: </b><span>state</span></span></span><br><span><var>Hs</var><span class="hyp-type"><b>: </b><span>initial_state_prop s</span></span></span><br><span><var>om</var><span class="hyp-type"><b>: </b><span>option message</span></span></span><br><span><var>Hom</var><span class="hyp-type"><b>: </b><span>option_initial_message_prop om</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">valid_state_message_prop
  pre_loaded_with_all_messages_vlsm s om</div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="VLSM-v-chk466" style="display: none" type="checkbox"><label class="alectryon-input" for="VLSM-v-chk466"><span class="nb">refine</span> (valid_initial_state_message pre_loaded_with_all_messages_vlsm s Hs om _).</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>message</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>X</var><span class="hyp-type"><b>: </b><span>VLSM message</span></span></span><br><span><var>s</var><span class="hyp-type"><b>: </b><span>state</span></span></span><br><span><var>Hs</var><span class="hyp-type"><b>: </b><span>initial_state_prop s</span></span></span><br><span><var>om</var><span class="hyp-type"><b>: </b><span>option message</span></span></span><br><span><var>Hom</var><span class="hyp-type"><b>: </b><span>option_initial_message_prop om</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">option_initial_message_prop om</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">      </span><span class="alectryon-sentence"><span class="alectryon-input"><span class="nb">destruct</span> om;<span class="bp">exact</span> I.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="VLSM-v-chk467" style="display: none" type="checkbox"><label class="alectryon-input" for="VLSM-v-chk467">-</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>message</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>X</var><span class="hyp-type"><b>: </b><span>VLSM message</span></span></span><br><span><var>s</var><span class="hyp-type"><b>: </b><span>state</span></span></span><br><span><var>_om</var><span class="hyp-type"><b>: </b><span>option message</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>valid_state_message_prop X s _om</span></span></span><br><span><var>_s</var><span class="hyp-type"><b>: </b><span>state</span></span></span><br><span><var>om</var><span class="hyp-type"><b>: </b><span>option message</span></span></span><br><span><var>H0</var><span class="hyp-type"><b>: </b><span>valid_state_message_prop X _s om</span></span></span><br><span><var>l0</var><span class="hyp-type"><b>: </b><span>label</span></span></span><br><span><var>Hv</var><span class="hyp-type"><b>: </b><span>valid l0 (s, om)</span></span></span><br><span><var>s'</var><span class="hyp-type"><b>: </b><span>state</span></span></span><br><span><var>om'</var><span class="hyp-type"><b>: </b><span>option message</span></span></span><br><span><var>Ht</var><span class="hyp-type"><b>: </b><span>transition l0 (s, om) = (s&#39;, om&#39;)</span></span></span><br><span><var>IHvalid_state_message_prop1</var><span class="hyp-type"><b>: </b><span>valid_state_message_prop
  pre_loaded_with_all_messages_vlsm
  s _om</span></span></span><br><span><var>IHvalid_state_message_prop2</var><span class="hyp-type"><b>: </b><span>valid_state_message_prop
  pre_loaded_with_all_messages_vlsm
  _s om</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">valid_state_message_prop
  pre_loaded_with_all_messages_vlsm s&#39; om&#39;</div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="bp">exact</span> (valid_generated_state_message pre_loaded_with_all_messages_vlsm
                                _ _ IHvalid_state_message_prop1
                                _ _ IHvalid_state_message_prop2 l0 Hv _ _ Ht).</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Qed</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
</span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="VLSM-v-chk468" style="display: none" type="checkbox"><label class="alectryon-input" for="VLSM-v-chk468"><span class="kn">Lemma</span> <span class="nf">preloaded_weaken_input_valid_transition</span>
        <span class="nv">l</span> <span class="nv">s</span> <span class="nv">om</span> <span class="nv">s&#39;</span> <span class="nv">om&#39;</span>:
    input_valid_transition X l (s,om) (s&#39;,om&#39;) -&gt;
    input_valid_transition pre_loaded_with_all_messages_vlsm l (s,om) (s&#39;,om&#39;).</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>message</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>X</var><span class="hyp-type"><b>: </b><span>VLSM message</span></span></span><br><span><var>l</var><span class="hyp-type"><b>: </b><span>label</span></span></span><br><span><var>s</var><span class="hyp-type"><b>: </b><span>state</span></span></span><br><span><var>om</var><span class="hyp-type"><b>: </b><span>option message</span></span></span><br><span><var>s'</var><span class="hyp-type"><b>: </b><span>state</span></span></span><br><span><var>om'</var><span class="hyp-type"><b>: </b><span>option message</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">input_valid_transition X l (s, om) (s&#39;, om&#39;)
‚Üí input_valid_transition
    pre_loaded_with_all_messages_vlsm l (s, om)
    (s&#39;, om&#39;)</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="VLSM-v-chk469" style="display: none" type="checkbox"><label class="alectryon-input" for="VLSM-v-chk469"><span class="kn">Proof</span>.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>message</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>X</var><span class="hyp-type"><b>: </b><span>VLSM message</span></span></span><br><span><var>l</var><span class="hyp-type"><b>: </b><span>label</span></span></span><br><span><var>s</var><span class="hyp-type"><b>: </b><span>state</span></span></span><br><span><var>om</var><span class="hyp-type"><b>: </b><span>option message</span></span></span><br><span><var>s'</var><span class="hyp-type"><b>: </b><span>state</span></span></span><br><span><var>om'</var><span class="hyp-type"><b>: </b><span>option message</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">input_valid_transition X l (s, om) (s&#39;, om&#39;)
‚Üí input_valid_transition
    pre_loaded_with_all_messages_vlsm l (s, om)
    (s&#39;, om&#39;)</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="VLSM-v-chk46a" style="display: none" type="checkbox"><label class="alectryon-input" for="VLSM-v-chk46a"><span class="nb">unfold</span> input_valid_transition.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>message</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>X</var><span class="hyp-type"><b>: </b><span>VLSM message</span></span></span><br><span><var>l</var><span class="hyp-type"><b>: </b><span>label</span></span></span><br><span><var>s</var><span class="hyp-type"><b>: </b><span>state</span></span></span><br><span><var>om</var><span class="hyp-type"><b>: </b><span>option message</span></span></span><br><span><var>s'</var><span class="hyp-type"><b>: </b><span>state</span></span></span><br><span><var>om'</var><span class="hyp-type"><b>: </b><span>option message</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">input_valid X l (s, om)
‚àß transition l (s, om) = (s&#39;, om&#39;)
‚Üí input_valid pre_loaded_with_all_messages_vlsm l
    (s, om) ‚àß transition l (s, om) = (s&#39;, om&#39;)</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="VLSM-v-chk46b" style="display: none" type="checkbox"><label class="alectryon-input" for="VLSM-v-chk46b"><span class="nb">intros</span> [[[_om valid_s] [_ Hvalid]] Htrans].</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>message</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>X</var><span class="hyp-type"><b>: </b><span>VLSM message</span></span></span><br><span><var>l</var><span class="hyp-type"><b>: </b><span>label</span></span></span><br><span><var>s</var><span class="hyp-type"><b>: </b><span>state</span></span></span><br><span><var>om</var><span class="hyp-type"><b>: </b><span>option message</span></span></span><br><span><var>s'</var><span class="hyp-type"><b>: </b><span>state</span></span></span><br><span><var>om', _om</var><span class="hyp-type"><b>: </b><span>option message</span></span></span><br><span><var>valid_s</var><span class="hyp-type"><b>: </b><span>valid_state_message_prop X s _om</span></span></span><br><span><var>Hvalid</var><span class="hyp-type"><b>: </b><span>valid l (s, om)</span></span></span><br><span><var>Htrans</var><span class="hyp-type"><b>: </b><span>transition l (s, om) = (s&#39;, om&#39;)</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">input_valid pre_loaded_with_all_messages_vlsm l
  (s, om) ‚àß transition l (s, om) = (s&#39;, om&#39;)</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="VLSM-v-chk46c" style="display: none" type="checkbox"><label class="alectryon-input" for="VLSM-v-chk46c"><span class="nb">split</span>;[<span class="nb">clear</span> Htrans|<span class="bp">assumption</span>].</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>message</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>X</var><span class="hyp-type"><b>: </b><span>VLSM message</span></span></span><br><span><var>l</var><span class="hyp-type"><b>: </b><span>label</span></span></span><br><span><var>s</var><span class="hyp-type"><b>: </b><span>state</span></span></span><br><span><var>om</var><span class="hyp-type"><b>: </b><span>option message</span></span></span><br><span><var>s'</var><span class="hyp-type"><b>: </b><span>state</span></span></span><br><span><var>om', _om</var><span class="hyp-type"><b>: </b><span>option message</span></span></span><br><span><var>valid_s</var><span class="hyp-type"><b>: </b><span>valid_state_message_prop X s _om</span></span></span><br><span><var>Hvalid</var><span class="hyp-type"><b>: </b><span>valid l (s, om)</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">input_valid pre_loaded_with_all_messages_vlsm l
  (s, om)</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="VLSM-v-chk46d" style="display: none" type="checkbox"><label class="alectryon-input" for="VLSM-v-chk46d"><span class="nb">split</span>.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>message</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>X</var><span class="hyp-type"><b>: </b><span>VLSM message</span></span></span><br><span><var>l</var><span class="hyp-type"><b>: </b><span>label</span></span></span><br><span><var>s</var><span class="hyp-type"><b>: </b><span>state</span></span></span><br><span><var>om</var><span class="hyp-type"><b>: </b><span>option message</span></span></span><br><span><var>s'</var><span class="hyp-type"><b>: </b><span>state</span></span></span><br><span><var>om', _om</var><span class="hyp-type"><b>: </b><span>option message</span></span></span><br><span><var>valid_s</var><span class="hyp-type"><b>: </b><span>valid_state_message_prop X s _om</span></span></span><br><span><var>Hvalid</var><span class="hyp-type"><b>: </b><span>valid l (s, om)</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">valid_state_prop pre_loaded_with_all_messages_vlsm s</div></blockquote><div class="alectryon-extra-goals"><input class="alectryon-extra-goal-toggle" id="VLSM-v-chk46e" style="display: none" type="checkbox"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>message</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>X</var><span class="hyp-type"><b>: </b><span>VLSM message</span></span></span><br><span><var>l</var><span class="hyp-type"><b>: </b><span>label</span></span></span><br><span><var>s</var><span class="hyp-type"><b>: </b><span>state</span></span></span><br><span><var>om</var><span class="hyp-type"><b>: </b><span>option message</span></span></span><br><span><var>s'</var><span class="hyp-type"><b>: </b><span>state</span></span></span><br><span><var>om', _om</var><span class="hyp-type"><b>: </b><span>option message</span></span></span><br><span><var>valid_s</var><span class="hyp-type"><b>: </b><span>valid_state_message_prop X s _om</span></span></span><br><span><var>Hvalid</var><span class="hyp-type"><b>: </b><span>valid l (s, om)</span></span></span><br></div><label class="goal-separator" for="VLSM-v-chk46e"><hr></label><div class="goal-conclusion">option_valid_message_prop
  pre_loaded_with_all_messages_vlsm om
‚àß valid l (s, om)</div></blockquote></div></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="VLSM-v-chk46f" style="display: none" type="checkbox"><label class="alectryon-input" for="VLSM-v-chk46f">-</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>message</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>X</var><span class="hyp-type"><b>: </b><span>VLSM message</span></span></span><br><span><var>l</var><span class="hyp-type"><b>: </b><span>label</span></span></span><br><span><var>s</var><span class="hyp-type"><b>: </b><span>state</span></span></span><br><span><var>om</var><span class="hyp-type"><b>: </b><span>option message</span></span></span><br><span><var>s'</var><span class="hyp-type"><b>: </b><span>state</span></span></span><br><span><var>om', _om</var><span class="hyp-type"><b>: </b><span>option message</span></span></span><br><span><var>valid_s</var><span class="hyp-type"><b>: </b><span>valid_state_message_prop X s _om</span></span></span><br><span><var>Hvalid</var><span class="hyp-type"><b>: </b><span>valid l (s, om)</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">valid_state_prop pre_loaded_with_all_messages_vlsm s</div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="VLSM-v-chk470" style="display: none" type="checkbox"><label class="alectryon-input" for="VLSM-v-chk470"><span class="kr">exists</span> <span class="nv">_om</span>.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>message</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>X</var><span class="hyp-type"><b>: </b><span>VLSM message</span></span></span><br><span><var>l</var><span class="hyp-type"><b>: </b><span>label</span></span></span><br><span><var>s</var><span class="hyp-type"><b>: </b><span>state</span></span></span><br><span><var>om</var><span class="hyp-type"><b>: </b><span>option message</span></span></span><br><span><var>s'</var><span class="hyp-type"><b>: </b><span>state</span></span></span><br><span><var>om', _om</var><span class="hyp-type"><b>: </b><span>option message</span></span></span><br><span><var>valid_s</var><span class="hyp-type"><b>: </b><span>valid_state_message_prop X s _om</span></span></span><br><span><var>Hvalid</var><span class="hyp-type"><b>: </b><span>valid l (s, om)</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">valid_state_message_prop
  pre_loaded_with_all_messages_vlsm s _om</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">      </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="VLSM-v-chk471" style="display: none" type="checkbox"><label class="alectryon-input" for="VLSM-v-chk471"><span class="nb">apply</span> preloaded_weaken_valid_state_message_prop.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>message</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>X</var><span class="hyp-type"><b>: </b><span>VLSM message</span></span></span><br><span><var>l</var><span class="hyp-type"><b>: </b><span>label</span></span></span><br><span><var>s</var><span class="hyp-type"><b>: </b><span>state</span></span></span><br><span><var>om</var><span class="hyp-type"><b>: </b><span>option message</span></span></span><br><span><var>s'</var><span class="hyp-type"><b>: </b><span>state</span></span></span><br><span><var>om', _om</var><span class="hyp-type"><b>: </b><span>option message</span></span></span><br><span><var>valid_s</var><span class="hyp-type"><b>: </b><span>valid_state_message_prop X s _om</span></span></span><br><span><var>Hvalid</var><span class="hyp-type"><b>: </b><span>valid l (s, om)</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">valid_state_message_prop X s _om</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">      </span><span class="alectryon-sentence"><span class="alectryon-input"><span class="bp">assumption</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="VLSM-v-chk472" style="display: none" type="checkbox"><label class="alectryon-input" for="VLSM-v-chk472">-</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>message</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>X</var><span class="hyp-type"><b>: </b><span>VLSM message</span></span></span><br><span><var>l</var><span class="hyp-type"><b>: </b><span>label</span></span></span><br><span><var>s</var><span class="hyp-type"><b>: </b><span>state</span></span></span><br><span><var>om</var><span class="hyp-type"><b>: </b><span>option message</span></span></span><br><span><var>s'</var><span class="hyp-type"><b>: </b><span>state</span></span></span><br><span><var>om', _om</var><span class="hyp-type"><b>: </b><span>option message</span></span></span><br><span><var>valid_s</var><span class="hyp-type"><b>: </b><span>valid_state_message_prop X s _om</span></span></span><br><span><var>Hvalid</var><span class="hyp-type"><b>: </b><span>valid l (s, om)</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">option_valid_message_prop
  pre_loaded_with_all_messages_vlsm om
‚àß valid l (s, om)</div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="VLSM-v-chk473" style="display: none" type="checkbox"><label class="alectryon-input" for="VLSM-v-chk473"><span class="nb">clear</span> _om valid_s.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>message</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>X</var><span class="hyp-type"><b>: </b><span>VLSM message</span></span></span><br><span><var>l</var><span class="hyp-type"><b>: </b><span>label</span></span></span><br><span><var>s</var><span class="hyp-type"><b>: </b><span>state</span></span></span><br><span><var>om</var><span class="hyp-type"><b>: </b><span>option message</span></span></span><br><span><var>s'</var><span class="hyp-type"><b>: </b><span>state</span></span></span><br><span><var>om'</var><span class="hyp-type"><b>: </b><span>option message</span></span></span><br><span><var>Hvalid</var><span class="hyp-type"><b>: </b><span>valid l (s, om)</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">option_valid_message_prop
  pre_loaded_with_all_messages_vlsm om
‚àß valid l (s, om)</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">      </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="VLSM-v-chk474" style="display: none" type="checkbox"><label class="alectryon-input" for="VLSM-v-chk474"><span class="nb">split</span>.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>message</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>X</var><span class="hyp-type"><b>: </b><span>VLSM message</span></span></span><br><span><var>l</var><span class="hyp-type"><b>: </b><span>label</span></span></span><br><span><var>s</var><span class="hyp-type"><b>: </b><span>state</span></span></span><br><span><var>om</var><span class="hyp-type"><b>: </b><span>option message</span></span></span><br><span><var>s'</var><span class="hyp-type"><b>: </b><span>state</span></span></span><br><span><var>om'</var><span class="hyp-type"><b>: </b><span>option message</span></span></span><br><span><var>Hvalid</var><span class="hyp-type"><b>: </b><span>valid l (s, om)</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">option_valid_message_prop
  pre_loaded_with_all_messages_vlsm om</div></blockquote><div class="alectryon-extra-goals"><input class="alectryon-extra-goal-toggle" id="VLSM-v-chk475" style="display: none" type="checkbox"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>message</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>X</var><span class="hyp-type"><b>: </b><span>VLSM message</span></span></span><br><span><var>l</var><span class="hyp-type"><b>: </b><span>label</span></span></span><br><span><var>s</var><span class="hyp-type"><b>: </b><span>state</span></span></span><br><span><var>om</var><span class="hyp-type"><b>: </b><span>option message</span></span></span><br><span><var>s'</var><span class="hyp-type"><b>: </b><span>state</span></span></span><br><span><var>om'</var><span class="hyp-type"><b>: </b><span>option message</span></span></span><br><span><var>Hvalid</var><span class="hyp-type"><b>: </b><span>valid l (s, om)</span></span></span><br></div><label class="goal-separator" for="VLSM-v-chk475"><hr></label><div class="goal-conclusion">valid l (s, om)</div></blockquote></div></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">      </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="VLSM-v-chk476" style="display: none" type="checkbox"><label class="alectryon-input" for="VLSM-v-chk476">+</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>message</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>X</var><span class="hyp-type"><b>: </b><span>VLSM message</span></span></span><br><span><var>l</var><span class="hyp-type"><b>: </b><span>label</span></span></span><br><span><var>s</var><span class="hyp-type"><b>: </b><span>state</span></span></span><br><span><var>om</var><span class="hyp-type"><b>: </b><span>option message</span></span></span><br><span><var>s'</var><span class="hyp-type"><b>: </b><span>state</span></span></span><br><span><var>om'</var><span class="hyp-type"><b>: </b><span>option message</span></span></span><br><span><var>Hvalid</var><span class="hyp-type"><b>: </b><span>valid l (s, om)</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">option_valid_message_prop
  pre_loaded_with_all_messages_vlsm om</div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="nb">apply</span> any_message_is_valid_in_preloaded.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">      </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="VLSM-v-chk477" style="display: none" type="checkbox"><label class="alectryon-input" for="VLSM-v-chk477">+</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>message</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>X</var><span class="hyp-type"><b>: </b><span>VLSM message</span></span></span><br><span><var>l</var><span class="hyp-type"><b>: </b><span>label</span></span></span><br><span><var>s</var><span class="hyp-type"><b>: </b><span>state</span></span></span><br><span><var>om</var><span class="hyp-type"><b>: </b><span>option message</span></span></span><br><span><var>s'</var><span class="hyp-type"><b>: </b><span>state</span></span></span><br><span><var>om'</var><span class="hyp-type"><b>: </b><span>option message</span></span></span><br><span><var>Hvalid</var><span class="hyp-type"><b>: </b><span>valid l (s, om)</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">valid l (s, om)</div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="bp">assumption</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Qed</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
</span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="VLSM-v-chk478" style="display: none" type="checkbox"><label class="alectryon-input" for="VLSM-v-chk478"><span class="kn">Lemma</span> <span class="nf">preloaded_weaken_valid_trace_from</span> <span class="nv">s</span> <span class="nv">tr</span>
    : finite_valid_trace_from X s tr -&gt;
      finite_valid_trace_from pre_loaded_with_all_messages_vlsm s tr.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>message</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>X</var><span class="hyp-type"><b>: </b><span>VLSM message</span></span></span><br><span><var>s</var><span class="hyp-type"><b>: </b><span>state</span></span></span><br><span><var>tr</var><span class="hyp-type"><b>: </b><span>list transition_item</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">finite_valid_trace_from X s tr
‚Üí finite_valid_trace_from
    pre_loaded_with_all_messages_vlsm s tr</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="VLSM-v-chk479" style="display: none" type="checkbox"><label class="alectryon-input" for="VLSM-v-chk479"><span class="kn">Proof</span>.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>message</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>X</var><span class="hyp-type"><b>: </b><span>VLSM message</span></span></span><br><span><var>s</var><span class="hyp-type"><b>: </b><span>state</span></span></span><br><span><var>tr</var><span class="hyp-type"><b>: </b><span>list transition_item</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">finite_valid_trace_from X s tr
‚Üí finite_valid_trace_from
    pre_loaded_with_all_messages_vlsm s tr</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="VLSM-v-chk47a" style="display: none" type="checkbox"><label class="alectryon-input" for="VLSM-v-chk47a"><span class="nb">intros</span> H.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>message</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>X</var><span class="hyp-type"><b>: </b><span>VLSM message</span></span></span><br><span><var>s</var><span class="hyp-type"><b>: </b><span>state</span></span></span><br><span><var>tr</var><span class="hyp-type"><b>: </b><span>list transition_item</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>finite_valid_trace_from X s tr</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">finite_valid_trace_from
  pre_loaded_with_all_messages_vlsm s tr</div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="VLSM-v-chk47b" style="display: none" type="checkbox"><label class="alectryon-input" for="VLSM-v-chk47b"><span class="nb">induction</span> H <span class="nb">using</span> finite_valid_trace_from_rev_ind.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>message</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>X</var><span class="hyp-type"><b>: </b><span>VLSM message</span></span></span><br><span><var>s</var><span class="hyp-type"><b>: </b><span>state</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>valid_state_prop X s</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">finite_valid_trace_from
  pre_loaded_with_all_messages_vlsm s []</div></blockquote><div class="alectryon-extra-goals"><input class="alectryon-extra-goal-toggle" id="VLSM-v-chk47c" style="display: none" type="checkbox"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>message</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>X</var><span class="hyp-type"><b>: </b><span>VLSM message</span></span></span><br><span><var>s</var><span class="hyp-type"><b>: </b><span>state</span></span></span><br><span><var>tr</var><span class="hyp-type"><b>: </b><span>list transition_item</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>finite_valid_trace_from X s tr</span></span></span><br><span><var>sf</var><span class="hyp-type"><b>: </b><span>state</span></span></span><br><span><var>iom, oom</var><span class="hyp-type"><b>: </b><span>option message</span></span></span><br><span><var>l0</var><span class="hyp-type"><b>: </b><span>label</span></span></span><br><span><var>Hx</var><span class="hyp-type"><b>: </b><span>input_valid_transition X l0
  (finite_trace_last s tr, iom) 
  (sf, oom)</span></span></span><br><span><var>x</var><span><span class="hyp-body"><b>:= </b><span>{|
  l := l0;
  input := iom;
  destination := sf;
  output := oom
|}</span></span><span class="hyp-type"><b>: </b><span>transition_item</span></span></span></span><br><span><var>IHfinite_valid_trace_from</var><span class="hyp-type"><b>: </b><span>finite_valid_trace_from
  pre_loaded_with_all_messages_vlsm
  s tr</span></span></span><br></div><label class="goal-separator" for="VLSM-v-chk47c"><hr></label><div class="goal-conclusion">finite_valid_trace_from
  pre_loaded_with_all_messages_vlsm s 
  (tr ++ [x])</div></blockquote></div></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="VLSM-v-chk47d" style="display: none" type="checkbox"><label class="alectryon-input" for="VLSM-v-chk47d">-</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>message</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>X</var><span class="hyp-type"><b>: </b><span>VLSM message</span></span></span><br><span><var>s</var><span class="hyp-type"><b>: </b><span>state</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>valid_state_prop X s</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">finite_valid_trace_from
  pre_loaded_with_all_messages_vlsm s []</div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="VLSM-v-chk47e" style="display: none" type="checkbox"><label class="alectryon-input" for="VLSM-v-chk47e"><span class="nb">apply</span> (finite_valid_trace_from_empty pre_loaded_with_all_messages_vlsm).</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>message</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>X</var><span class="hyp-type"><b>: </b><span>VLSM message</span></span></span><br><span><var>s</var><span class="hyp-type"><b>: </b><span>state</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>valid_state_prop X s</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">valid_state_prop pre_loaded_with_all_messages_vlsm s</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">      </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="VLSM-v-chk47f" style="display: none" type="checkbox"><label class="alectryon-input" for="VLSM-v-chk47f"><span class="nb">destruct</span> H <span class="kr">as</span> [om H].</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>message</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>X</var><span class="hyp-type"><b>: </b><span>VLSM message</span></span></span><br><span><var>s</var><span class="hyp-type"><b>: </b><span>state</span></span></span><br><span><var>om</var><span class="hyp-type"><b>: </b><span>option message</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>valid_state_message_prop X s om</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">valid_state_prop pre_loaded_with_all_messages_vlsm s</div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="VLSM-v-chk480" style="display: none" type="checkbox"><label class="alectryon-input" for="VLSM-v-chk480"><span class="kr">exists</span> <span class="nv">om</span>.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>message</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>X</var><span class="hyp-type"><b>: </b><span>VLSM message</span></span></span><br><span><var>s</var><span class="hyp-type"><b>: </b><span>state</span></span></span><br><span><var>om</var><span class="hyp-type"><b>: </b><span>option message</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>valid_state_message_prop X s om</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">valid_state_message_prop
  pre_loaded_with_all_messages_vlsm s om</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">      </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="VLSM-v-chk481" style="display: none" type="checkbox"><label class="alectryon-input" for="VLSM-v-chk481"><span class="nb">revert</span> H.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>message</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>X</var><span class="hyp-type"><b>: </b><span>VLSM message</span></span></span><br><span><var>s</var><span class="hyp-type"><b>: </b><span>state</span></span></span><br><span><var>om</var><span class="hyp-type"><b>: </b><span>option message</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">valid_state_message_prop X s om
‚Üí valid_state_message_prop
    pre_loaded_with_all_messages_vlsm s om</div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="nb">apply</span> preloaded_weaken_valid_state_message_prop.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="VLSM-v-chk482" style="display: none" type="checkbox"><label class="alectryon-input" for="VLSM-v-chk482">-</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>message</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>X</var><span class="hyp-type"><b>: </b><span>VLSM message</span></span></span><br><span><var>s</var><span class="hyp-type"><b>: </b><span>state</span></span></span><br><span><var>tr</var><span class="hyp-type"><b>: </b><span>list transition_item</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>finite_valid_trace_from X s tr</span></span></span><br><span><var>sf</var><span class="hyp-type"><b>: </b><span>state</span></span></span><br><span><var>iom, oom</var><span class="hyp-type"><b>: </b><span>option message</span></span></span><br><span><var>l0</var><span class="hyp-type"><b>: </b><span>label</span></span></span><br><span><var>Hx</var><span class="hyp-type"><b>: </b><span>input_valid_transition X l0
  (finite_trace_last s tr, iom) 
  (sf, oom)</span></span></span><br><span><var>x</var><span><span class="hyp-body"><b>:= </b><span>{|
  l := l0;
  input := iom;
  destination := sf;
  output := oom
|}</span></span><span class="hyp-type"><b>: </b><span>transition_item</span></span></span></span><br><span><var>IHfinite_valid_trace_from</var><span class="hyp-type"><b>: </b><span>finite_valid_trace_from
  pre_loaded_with_all_messages_vlsm
  s tr</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">finite_valid_trace_from
  pre_loaded_with_all_messages_vlsm s (tr ++ [x])</div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="VLSM-v-chk483" style="display: none" type="checkbox"><label class="alectryon-input" for="VLSM-v-chk483"><span class="nb">apply</span> (finite_valid_trace_from_app_iff pre_loaded_with_all_messages_vlsm).</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>message</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>X</var><span class="hyp-type"><b>: </b><span>VLSM message</span></span></span><br><span><var>s</var><span class="hyp-type"><b>: </b><span>state</span></span></span><br><span><var>tr</var><span class="hyp-type"><b>: </b><span>list transition_item</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>finite_valid_trace_from X s tr</span></span></span><br><span><var>sf</var><span class="hyp-type"><b>: </b><span>state</span></span></span><br><span><var>iom, oom</var><span class="hyp-type"><b>: </b><span>option message</span></span></span><br><span><var>l0</var><span class="hyp-type"><b>: </b><span>label</span></span></span><br><span><var>Hx</var><span class="hyp-type"><b>: </b><span>input_valid_transition X l0
  (finite_trace_last s tr, iom) 
  (sf, oom)</span></span></span><br><span><var>x</var><span><span class="hyp-body"><b>:= </b><span>{|
  l := l0;
  input := iom;
  destination := sf;
  output := oom
|}</span></span><span class="hyp-type"><b>: </b><span>transition_item</span></span></span></span><br><span><var>IHfinite_valid_trace_from</var><span class="hyp-type"><b>: </b><span>finite_valid_trace_from
  pre_loaded_with_all_messages_vlsm
  s tr</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">finite_valid_trace_from
  pre_loaded_with_all_messages_vlsm s tr
‚àß finite_valid_trace_from
    pre_loaded_with_all_messages_vlsm
    (finite_trace_last s tr) [x]</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">      </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="VLSM-v-chk484" style="display: none" type="checkbox"><label class="alectryon-input" for="VLSM-v-chk484"><span class="nb">split</span>; [<span class="bp">assumption</span>|].</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>message</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>X</var><span class="hyp-type"><b>: </b><span>VLSM message</span></span></span><br><span><var>s</var><span class="hyp-type"><b>: </b><span>state</span></span></span><br><span><var>tr</var><span class="hyp-type"><b>: </b><span>list transition_item</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>finite_valid_trace_from X s tr</span></span></span><br><span><var>sf</var><span class="hyp-type"><b>: </b><span>state</span></span></span><br><span><var>iom, oom</var><span class="hyp-type"><b>: </b><span>option message</span></span></span><br><span><var>l0</var><span class="hyp-type"><b>: </b><span>label</span></span></span><br><span><var>Hx</var><span class="hyp-type"><b>: </b><span>input_valid_transition X l0
  (finite_trace_last s tr, iom) 
  (sf, oom)</span></span></span><br><span><var>x</var><span><span class="hyp-body"><b>:= </b><span>{|
  l := l0;
  input := iom;
  destination := sf;
  output := oom
|}</span></span><span class="hyp-type"><b>: </b><span>transition_item</span></span></span></span><br><span><var>IHfinite_valid_trace_from</var><span class="hyp-type"><b>: </b><span>finite_valid_trace_from
  pre_loaded_with_all_messages_vlsm
  s tr</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">finite_valid_trace_from
  pre_loaded_with_all_messages_vlsm
  (finite_trace_last s tr) [x]</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">      </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="VLSM-v-chk485" style="display: none" type="checkbox"><label class="alectryon-input" for="VLSM-v-chk485"><span class="nb">apply</span> (finite_valid_trace_singleton pre_loaded_with_all_messages_vlsm).</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>message</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>X</var><span class="hyp-type"><b>: </b><span>VLSM message</span></span></span><br><span><var>s</var><span class="hyp-type"><b>: </b><span>state</span></span></span><br><span><var>tr</var><span class="hyp-type"><b>: </b><span>list transition_item</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>finite_valid_trace_from X s tr</span></span></span><br><span><var>sf</var><span class="hyp-type"><b>: </b><span>state</span></span></span><br><span><var>iom, oom</var><span class="hyp-type"><b>: </b><span>option message</span></span></span><br><span><var>l0</var><span class="hyp-type"><b>: </b><span>label</span></span></span><br><span><var>Hx</var><span class="hyp-type"><b>: </b><span>input_valid_transition X l0
  (finite_trace_last s tr, iom) 
  (sf, oom)</span></span></span><br><span><var>x</var><span><span class="hyp-body"><b>:= </b><span>{|
  l := l0;
  input := iom;
  destination := sf;
  output := oom
|}</span></span><span class="hyp-type"><b>: </b><span>transition_item</span></span></span></span><br><span><var>IHfinite_valid_trace_from</var><span class="hyp-type"><b>: </b><span>finite_valid_trace_from
  pre_loaded_with_all_messages_vlsm
  s tr</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">input_valid_transition
  pre_loaded_with_all_messages_vlsm l0
  (finite_trace_last s tr, iom) (sf, oom)</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">      </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="VLSM-v-chk486" style="display: none" type="checkbox"><label class="alectryon-input" for="VLSM-v-chk486"><span class="nb">revert</span> Hx.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>message</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>X</var><span class="hyp-type"><b>: </b><span>VLSM message</span></span></span><br><span><var>s</var><span class="hyp-type"><b>: </b><span>state</span></span></span><br><span><var>tr</var><span class="hyp-type"><b>: </b><span>list transition_item</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>finite_valid_trace_from X s tr</span></span></span><br><span><var>sf</var><span class="hyp-type"><b>: </b><span>state</span></span></span><br><span><var>iom, oom</var><span class="hyp-type"><b>: </b><span>option message</span></span></span><br><span><var>l0</var><span class="hyp-type"><b>: </b><span>label</span></span></span><br><span><var>x</var><span><span class="hyp-body"><b>:= </b><span>{|
  l := l0;
  input := iom;
  destination := sf;
  output := oom
|}</span></span><span class="hyp-type"><b>: </b><span>transition_item</span></span></span></span><br><span><var>IHfinite_valid_trace_from</var><span class="hyp-type"><b>: </b><span>finite_valid_trace_from
  pre_loaded_with_all_messages_vlsm
  s tr</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">input_valid_transition X l0
  (finite_trace_last s tr, iom) (sf, oom)
‚Üí input_valid_transition
    pre_loaded_with_all_messages_vlsm l0
    (finite_trace_last s tr, iom) (sf, oom)</div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="nb">apply</span> preloaded_weaken_input_valid_transition.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Qed</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
</span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="VLSM-v-chk487" style="display: none" type="checkbox"><label class="alectryon-input" for="VLSM-v-chk487"><span class="kn">Lemma</span> <span class="nf">pre_traces_with_valid_inputs_are_valid</span> <span class="nv">is</span> <span class="nv">s</span> <span class="nv">tr</span>
    (<span class="nv">Htr</span> : finite_valid_trace_init_to pre_loaded_with_all_messages_vlsm <span class="kr">is</span> s tr)
    (<span class="nv">Hobs</span> : <span class="kr">forall</span> <span class="nv">m</span>,
      trace_has_message (field_selector input) m tr -&gt;
      valid_message_prop X m
    )
    : finite_valid_trace_init_to X <span class="kr">is</span> s tr.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>message</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>X</var><span class="hyp-type"><b>: </b><span>VLSM message</span></span></span><br><span><var>is, s</var><span class="hyp-type"><b>: </b><span>state</span></span></span><br><span><var>tr</var><span class="hyp-type"><b>: </b><span>list transition_item</span></span></span><br><span><var>Htr</var><span class="hyp-type"><b>: </b><span>finite_valid_trace_init_to
  pre_loaded_with_all_messages_vlsm <span class="kr">is</span> s tr</span></span></span><br><span><var>Hobs</var><span class="hyp-type"><b>: </b><span><span class="kr">‚àÄ</span> <span class="nv">m</span> : message,
  trace_has_message (field_selector input) m tr
  ‚Üí valid_message_prop X m</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">finite_valid_trace_init_to X <span class="kr">is</span> s tr</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="VLSM-v-chk488" style="display: none" type="checkbox"><label class="alectryon-input" for="VLSM-v-chk488"><span class="kn">Proof</span>.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>message</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>X</var><span class="hyp-type"><b>: </b><span>VLSM message</span></span></span><br><span><var>is, s</var><span class="hyp-type"><b>: </b><span>state</span></span></span><br><span><var>tr</var><span class="hyp-type"><b>: </b><span>list transition_item</span></span></span><br><span><var>Htr</var><span class="hyp-type"><b>: </b><span>finite_valid_trace_init_to
  pre_loaded_with_all_messages_vlsm <span class="kr">is</span> s tr</span></span></span><br><span><var>Hobs</var><span class="hyp-type"><b>: </b><span><span class="kr">‚àÄ</span> <span class="nv">m</span> : message,
  trace_has_message (field_selector input) m tr
  ‚Üí valid_message_prop X m</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">finite_valid_trace_init_to X <span class="kr">is</span> s tr</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="VLSM-v-chk489" style="display: none" type="checkbox"><label class="alectryon-input" for="VLSM-v-chk489"><span class="nb">revert</span> s Htr Hobs.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>message</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>X</var><span class="hyp-type"><b>: </b><span>VLSM message</span></span></span><br><span><var>is</var><span class="hyp-type"><b>: </b><span>state</span></span></span><br><span><var>tr</var><span class="hyp-type"><b>: </b><span>list transition_item</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="kr">‚àÄ</span> <span class="nv">s</span> : state,
  finite_valid_trace_init_to
    pre_loaded_with_all_messages_vlsm <span class="kr">is</span> s tr
  ‚Üí (<span class="kr">‚àÄ</span> <span class="nv">m</span> : message,
       trace_has_message (field_selector input) m tr
       ‚Üí valid_message_prop X m)
    ‚Üí finite_valid_trace_init_to X <span class="kr">is</span> s tr</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="VLSM-v-chk48a" style="display: none" type="checkbox"><label class="alectryon-input" for="VLSM-v-chk48a"><span class="nb">induction</span> tr <span class="nb">using</span> rev_ind; <span class="nb">intros</span>; <span class="nb">split</span>
    ; [|<span class="nb">apply</span> Htr | | <span class="nb">apply</span> Htr]
    ; <span class="nb">destruct</span> Htr <span class="kr">as</span> [Htr Hinit].</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>message</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>X</var><span class="hyp-type"><b>: </b><span>VLSM message</span></span></span><br><span><var>is, s</var><span class="hyp-type"><b>: </b><span>state</span></span></span><br><span><var>Htr</var><span class="hyp-type"><b>: </b><span>finite_valid_trace_from_to
  pre_loaded_with_all_messages_vlsm <span class="kr">is</span> s []</span></span></span><br><span><var>Hinit</var><span class="hyp-type"><b>: </b><span>initial_state_prop <span class="kr">is</span></span></span></span><br><span><var>Hobs</var><span class="hyp-type"><b>: </b><span><span class="kr">‚àÄ</span> <span class="nv">m</span> : message,
  trace_has_message (field_selector input) m []
  ‚Üí valid_message_prop X m</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">finite_valid_trace_from_to X <span class="kr">is</span> s []</div></blockquote><div class="alectryon-extra-goals"><input class="alectryon-extra-goal-toggle" id="VLSM-v-chk48b" style="display: none" type="checkbox"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>message</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>X</var><span class="hyp-type"><b>: </b><span>VLSM message</span></span></span><br><span><var>is</var><span class="hyp-type"><b>: </b><span>state</span></span></span><br><span><var>x</var><span class="hyp-type"><b>: </b><span>transition_item</span></span></span><br><span><var>tr</var><span class="hyp-type"><b>: </b><span>list transition_item</span></span></span><br><span><var>IHtr</var><span class="hyp-type"><b>: </b><span><span class="kr">‚àÄ</span> <span class="nv">s</span> : state,
  finite_valid_trace_init_to
    pre_loaded_with_all_messages_vlsm <span class="kr">is</span> s tr
  ‚Üí (<span class="kr">‚àÄ</span> <span class="nv">m</span> : message,
       trace_has_message 
         (field_selector input) m tr
       ‚Üí valid_message_prop X m)
    ‚Üí finite_valid_trace_init_to X <span class="kr">is</span> s tr</span></span></span><br><span><var>s</var><span class="hyp-type"><b>: </b><span>state</span></span></span><br><span><var>Htr</var><span class="hyp-type"><b>: </b><span>finite_valid_trace_from_to
  pre_loaded_with_all_messages_vlsm <span class="kr">is</span> s
  (tr ++ [x])</span></span></span><br><span><var>Hinit</var><span class="hyp-type"><b>: </b><span>initial_state_prop <span class="kr">is</span></span></span></span><br><span><var>Hobs</var><span class="hyp-type"><b>: </b><span><span class="kr">‚àÄ</span> <span class="nv">m</span> : message,
  trace_has_message (field_selector input) m
    (tr ++ [x]) ‚Üí valid_message_prop X m</span></span></span><br></div><label class="goal-separator" for="VLSM-v-chk48b"><hr></label><div class="goal-conclusion">finite_valid_trace_from_to X <span class="kr">is</span> s (tr ++ [x])</div></blockquote></div></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="VLSM-v-chk48c" style="display: none" type="checkbox"><label class="alectryon-input" for="VLSM-v-chk48c">-</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>message</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>X</var><span class="hyp-type"><b>: </b><span>VLSM message</span></span></span><br><span><var>is, s</var><span class="hyp-type"><b>: </b><span>state</span></span></span><br><span><var>Htr</var><span class="hyp-type"><b>: </b><span>finite_valid_trace_from_to
  pre_loaded_with_all_messages_vlsm <span class="kr">is</span> s []</span></span></span><br><span><var>Hinit</var><span class="hyp-type"><b>: </b><span>initial_state_prop <span class="kr">is</span></span></span></span><br><span><var>Hobs</var><span class="hyp-type"><b>: </b><span><span class="kr">‚àÄ</span> <span class="nv">m</span> : message,
  trace_has_message (field_selector input) m []
  ‚Üí valid_message_prop X m</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">finite_valid_trace_from_to X <span class="kr">is</span> s []</div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="VLSM-v-chk48d" style="display: none" type="checkbox"><label class="alectryon-input" for="VLSM-v-chk48d"><span class="nb">inversion</span> Htr; <span class="nb">subst</span>.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>message</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>X</var><span class="hyp-type"><b>: </b><span>VLSM message</span></span></span><br><span><var>s</var><span class="hyp-type"><b>: </b><span>state</span></span></span><br><span><var>Hinit</var><span class="hyp-type"><b>: </b><span>initial_state_prop s</span></span></span><br><span><var>Htr</var><span class="hyp-type"><b>: </b><span>finite_valid_trace_from_to
  pre_loaded_with_all_messages_vlsm s s []</span></span></span><br><span><var>Hobs</var><span class="hyp-type"><b>: </b><span><span class="kr">‚àÄ</span> <span class="nv">m</span> : message,
  trace_has_message (field_selector input) m []
  ‚Üí valid_message_prop X m</span></span></span><br><span><var>Hs</var><span class="hyp-type"><b>: </b><span>valid_state_prop
  pre_loaded_with_all_messages_vlsm s</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">finite_valid_trace_from_to X s s []</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">      </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="VLSM-v-chk48e" style="display: none" type="checkbox"><label class="alectryon-input" for="VLSM-v-chk48e"><span class="nb">apply</span> (finite_valid_trace_from_to_empty X).</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>message</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>X</var><span class="hyp-type"><b>: </b><span>VLSM message</span></span></span><br><span><var>s</var><span class="hyp-type"><b>: </b><span>state</span></span></span><br><span><var>Hinit</var><span class="hyp-type"><b>: </b><span>initial_state_prop s</span></span></span><br><span><var>Htr</var><span class="hyp-type"><b>: </b><span>finite_valid_trace_from_to
  pre_loaded_with_all_messages_vlsm s s []</span></span></span><br><span><var>Hobs</var><span class="hyp-type"><b>: </b><span><span class="kr">‚àÄ</span> <span class="nv">m</span> : message,
  trace_has_message (field_selector input) m []
  ‚Üí valid_message_prop X m</span></span></span><br><span><var>Hs</var><span class="hyp-type"><b>: </b><span>valid_state_prop
  pre_loaded_with_all_messages_vlsm s</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">valid_state_prop X s</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">      </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="VLSM-v-chk48f" style="display: none" type="checkbox"><label class="alectryon-input" for="VLSM-v-chk48f"><span class="nb">apply</span> initial_state_is_valid.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>message</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>X</var><span class="hyp-type"><b>: </b><span>VLSM message</span></span></span><br><span><var>s</var><span class="hyp-type"><b>: </b><span>state</span></span></span><br><span><var>Hinit</var><span class="hyp-type"><b>: </b><span>initial_state_prop s</span></span></span><br><span><var>Htr</var><span class="hyp-type"><b>: </b><span>finite_valid_trace_from_to
  pre_loaded_with_all_messages_vlsm s s []</span></span></span><br><span><var>Hobs</var><span class="hyp-type"><b>: </b><span><span class="kr">‚àÄ</span> <span class="nv">m</span> : message,
  trace_has_message (field_selector input) m []
  ‚Üí valid_message_prop X m</span></span></span><br><span><var>Hs</var><span class="hyp-type"><b>: </b><span>valid_state_prop
  pre_loaded_with_all_messages_vlsm s</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">initial_state_prop s</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">      </span><span class="alectryon-sentence"><span class="alectryon-input"><span class="bp">assumption</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="VLSM-v-chk490" style="display: none" type="checkbox"><label class="alectryon-input" for="VLSM-v-chk490">-</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>message</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>X</var><span class="hyp-type"><b>: </b><span>VLSM message</span></span></span><br><span><var>is</var><span class="hyp-type"><b>: </b><span>state</span></span></span><br><span><var>x</var><span class="hyp-type"><b>: </b><span>transition_item</span></span></span><br><span><var>tr</var><span class="hyp-type"><b>: </b><span>list transition_item</span></span></span><br><span><var>IHtr</var><span class="hyp-type"><b>: </b><span><span class="kr">‚àÄ</span> <span class="nv">s</span> : state,
  finite_valid_trace_init_to
    pre_loaded_with_all_messages_vlsm <span class="kr">is</span> s tr
  ‚Üí (<span class="kr">‚àÄ</span> <span class="nv">m</span> : message,
       trace_has_message 
         (field_selector input) m tr
       ‚Üí valid_message_prop X m)
    ‚Üí finite_valid_trace_init_to X <span class="kr">is</span> s tr</span></span></span><br><span><var>s</var><span class="hyp-type"><b>: </b><span>state</span></span></span><br><span><var>Htr</var><span class="hyp-type"><b>: </b><span>finite_valid_trace_from_to
  pre_loaded_with_all_messages_vlsm <span class="kr">is</span> s
  (tr ++ [x])</span></span></span><br><span><var>Hinit</var><span class="hyp-type"><b>: </b><span>initial_state_prop <span class="kr">is</span></span></span></span><br><span><var>Hobs</var><span class="hyp-type"><b>: </b><span><span class="kr">‚àÄ</span> <span class="nv">m</span> : message,
  trace_has_message (field_selector input) m
    (tr ++ [x]) ‚Üí valid_message_prop X m</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">finite_valid_trace_from_to X <span class="kr">is</span> s (tr ++ [x])</div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="VLSM-v-chk491" style="display: none" type="checkbox"><label class="alectryon-input" for="VLSM-v-chk491"><span class="nb">apply</span> finite_valid_trace_from_to_last <span class="kr">in</span> Htr <span class="kr">as</span> Hlst.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>message</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>X</var><span class="hyp-type"><b>: </b><span>VLSM message</span></span></span><br><span><var>is</var><span class="hyp-type"><b>: </b><span>state</span></span></span><br><span><var>x</var><span class="hyp-type"><b>: </b><span>transition_item</span></span></span><br><span><var>tr</var><span class="hyp-type"><b>: </b><span>list transition_item</span></span></span><br><span><var>IHtr</var><span class="hyp-type"><b>: </b><span><span class="kr">‚àÄ</span> <span class="nv">s</span> : state,
  finite_valid_trace_init_to
    pre_loaded_with_all_messages_vlsm <span class="kr">is</span> s tr
  ‚Üí (<span class="kr">‚àÄ</span> <span class="nv">m</span> : message,
       trace_has_message 
         (field_selector input) m tr
       ‚Üí valid_message_prop X m)
    ‚Üí finite_valid_trace_init_to X <span class="kr">is</span> s tr</span></span></span><br><span><var>s</var><span class="hyp-type"><b>: </b><span>state</span></span></span><br><span><var>Htr</var><span class="hyp-type"><b>: </b><span>finite_valid_trace_from_to
  pre_loaded_with_all_messages_vlsm <span class="kr">is</span> s
  (tr ++ [x])</span></span></span><br><span><var>Hlst</var><span class="hyp-type"><b>: </b><span>finite_trace_last <span class="kr">is</span> (tr ++ [x]) = s</span></span></span><br><span><var>Hinit</var><span class="hyp-type"><b>: </b><span>initial_state_prop <span class="kr">is</span></span></span></span><br><span><var>Hobs</var><span class="hyp-type"><b>: </b><span><span class="kr">‚àÄ</span> <span class="nv">m</span> : message,
  trace_has_message (field_selector input) m
    (tr ++ [x]) ‚Üí valid_message_prop X m</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">finite_valid_trace_from_to X <span class="kr">is</span> s (tr ++ [x])</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">      </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="VLSM-v-chk492" style="display: none" type="checkbox"><label class="alectryon-input" for="VLSM-v-chk492"><span class="nb">apply</span> finite_valid_trace_from_to_app_split <span class="kr">in</span> Htr.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>message</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>X</var><span class="hyp-type"><b>: </b><span>VLSM message</span></span></span><br><span><var>is</var><span class="hyp-type"><b>: </b><span>state</span></span></span><br><span><var>x</var><span class="hyp-type"><b>: </b><span>transition_item</span></span></span><br><span><var>tr</var><span class="hyp-type"><b>: </b><span>list transition_item</span></span></span><br><span><var>IHtr</var><span class="hyp-type"><b>: </b><span><span class="kr">‚àÄ</span> <span class="nv">s</span> : state,
  finite_valid_trace_init_to
    pre_loaded_with_all_messages_vlsm <span class="kr">is</span> s tr
  ‚Üí (<span class="kr">‚àÄ</span> <span class="nv">m</span> : message,
       trace_has_message 
         (field_selector input) m tr
       ‚Üí valid_message_prop X m)
    ‚Üí finite_valid_trace_init_to X <span class="kr">is</span> s tr</span></span></span><br><span><var>s</var><span class="hyp-type"><b>: </b><span>state</span></span></span><br><span><var>Htr</var><span class="hyp-type"><b>: </b><span>finite_valid_trace_from_to
  pre_loaded_with_all_messages_vlsm <span class="kr">is</span>
  (finite_trace_last <span class="kr">is</span> tr) tr
‚àß finite_valid_trace_from_to
    pre_loaded_with_all_messages_vlsm
    (finite_trace_last <span class="kr">is</span> tr) s [x]</span></span></span><br><span><var>Hlst</var><span class="hyp-type"><b>: </b><span>finite_trace_last <span class="kr">is</span> (tr ++ [x]) = s</span></span></span><br><span><var>Hinit</var><span class="hyp-type"><b>: </b><span>initial_state_prop <span class="kr">is</span></span></span></span><br><span><var>Hobs</var><span class="hyp-type"><b>: </b><span><span class="kr">‚àÄ</span> <span class="nv">m</span> : message,
  trace_has_message (field_selector input) m
    (tr ++ [x]) ‚Üí valid_message_prop X m</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">finite_valid_trace_from_to X <span class="kr">is</span> s (tr ++ [x])</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">      </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="VLSM-v-chk493" style="display: none" type="checkbox"><label class="alectryon-input" for="VLSM-v-chk493"><span class="nb">destruct</span> Htr <span class="kr">as</span> [Htr Hx].</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>message</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>X</var><span class="hyp-type"><b>: </b><span>VLSM message</span></span></span><br><span><var>is</var><span class="hyp-type"><b>: </b><span>state</span></span></span><br><span><var>x</var><span class="hyp-type"><b>: </b><span>transition_item</span></span></span><br><span><var>tr</var><span class="hyp-type"><b>: </b><span>list transition_item</span></span></span><br><span><var>IHtr</var><span class="hyp-type"><b>: </b><span><span class="kr">‚àÄ</span> <span class="nv">s</span> : state,
  finite_valid_trace_init_to
    pre_loaded_with_all_messages_vlsm <span class="kr">is</span> s tr
  ‚Üí (<span class="kr">‚àÄ</span> <span class="nv">m</span> : message,
       trace_has_message 
         (field_selector input) m tr
       ‚Üí valid_message_prop X m)
    ‚Üí finite_valid_trace_init_to X <span class="kr">is</span> s tr</span></span></span><br><span><var>s</var><span class="hyp-type"><b>: </b><span>state</span></span></span><br><span><var>Htr</var><span class="hyp-type"><b>: </b><span>finite_valid_trace_from_to
  pre_loaded_with_all_messages_vlsm <span class="kr">is</span>
  (finite_trace_last <span class="kr">is</span> tr) tr</span></span></span><br><span><var>Hx</var><span class="hyp-type"><b>: </b><span>finite_valid_trace_from_to
  pre_loaded_with_all_messages_vlsm
  (finite_trace_last <span class="kr">is</span> tr) s [x]</span></span></span><br><span><var>Hlst</var><span class="hyp-type"><b>: </b><span>finite_trace_last <span class="kr">is</span> (tr ++ [x]) = s</span></span></span><br><span><var>Hinit</var><span class="hyp-type"><b>: </b><span>initial_state_prop <span class="kr">is</span></span></span></span><br><span><var>Hobs</var><span class="hyp-type"><b>: </b><span><span class="kr">‚àÄ</span> <span class="nv">m</span> : message,
  trace_has_message (field_selector input) m
    (tr ++ [x]) ‚Üí valid_message_prop X m</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">finite_valid_trace_from_to X <span class="kr">is</span> s (tr ++ [x])</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">      </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="VLSM-v-chk494" style="display: none" type="checkbox"><label class="alectryon-input" for="VLSM-v-chk494"><span class="nb">specialize</span> (IHtr _ (conj Htr Hinit)).</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>message</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>X</var><span class="hyp-type"><b>: </b><span>VLSM message</span></span></span><br><span><var>is</var><span class="hyp-type"><b>: </b><span>state</span></span></span><br><span><var>x</var><span class="hyp-type"><b>: </b><span>transition_item</span></span></span><br><span><var>tr</var><span class="hyp-type"><b>: </b><span>list transition_item</span></span></span><br><span><var>IHtr</var><span class="hyp-type"><b>: </b><span>(<span class="kr">‚àÄ</span> <span class="nv">m</span> : message,
   trace_has_message (field_selector input) m
     tr ‚Üí valid_message_prop X m)
‚Üí finite_valid_trace_init_to X <span class="kr">is</span>
    (finite_trace_last <span class="kr">is</span> tr) tr</span></span></span><br><span><var>s</var><span class="hyp-type"><b>: </b><span>state</span></span></span><br><span><var>Htr</var><span class="hyp-type"><b>: </b><span>finite_valid_trace_from_to
  pre_loaded_with_all_messages_vlsm <span class="kr">is</span>
  (finite_trace_last <span class="kr">is</span> tr) tr</span></span></span><br><span><var>Hx</var><span class="hyp-type"><b>: </b><span>finite_valid_trace_from_to
  pre_loaded_with_all_messages_vlsm
  (finite_trace_last <span class="kr">is</span> tr) s [x]</span></span></span><br><span><var>Hlst</var><span class="hyp-type"><b>: </b><span>finite_trace_last <span class="kr">is</span> (tr ++ [x]) = s</span></span></span><br><span><var>Hinit</var><span class="hyp-type"><b>: </b><span>initial_state_prop <span class="kr">is</span></span></span></span><br><span><var>Hobs</var><span class="hyp-type"><b>: </b><span><span class="kr">‚àÄ</span> <span class="nv">m</span> : message,
  trace_has_message (field_selector input) m
    (tr ++ [x]) ‚Üí valid_message_prop X m</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">finite_valid_trace_from_to X <span class="kr">is</span> s (tr ++ [x])</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">      </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="VLSM-v-chk495" style="display: none" type="checkbox"><label class="alectryon-input" for="VLSM-v-chk495">spec IHtr.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>message</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>X</var><span class="hyp-type"><b>: </b><span>VLSM message</span></span></span><br><span><var>is</var><span class="hyp-type"><b>: </b><span>state</span></span></span><br><span><var>x</var><span class="hyp-type"><b>: </b><span>transition_item</span></span></span><br><span><var>tr</var><span class="hyp-type"><b>: </b><span>list transition_item</span></span></span><br><span><var>IHtr</var><span class="hyp-type"><b>: </b><span>(<span class="kr">‚àÄ</span> <span class="nv">m</span> : message,
   trace_has_message (field_selector input) m
     tr ‚Üí valid_message_prop X m)
‚Üí finite_valid_trace_init_to X <span class="kr">is</span>
    (finite_trace_last <span class="kr">is</span> tr) tr</span></span></span><br><span><var>s</var><span class="hyp-type"><b>: </b><span>state</span></span></span><br><span><var>Htr</var><span class="hyp-type"><b>: </b><span>finite_valid_trace_from_to
  pre_loaded_with_all_messages_vlsm <span class="kr">is</span>
  (finite_trace_last <span class="kr">is</span> tr) tr</span></span></span><br><span><var>Hx</var><span class="hyp-type"><b>: </b><span>finite_valid_trace_from_to
  pre_loaded_with_all_messages_vlsm
  (finite_trace_last <span class="kr">is</span> tr) s [x]</span></span></span><br><span><var>Hlst</var><span class="hyp-type"><b>: </b><span>finite_trace_last <span class="kr">is</span> (tr ++ [x]) = s</span></span></span><br><span><var>Hinit</var><span class="hyp-type"><b>: </b><span>initial_state_prop <span class="kr">is</span></span></span></span><br><span><var>Hobs</var><span class="hyp-type"><b>: </b><span><span class="kr">‚àÄ</span> <span class="nv">m</span> : message,
  trace_has_message (field_selector input) m
    (tr ++ [x]) ‚Üí valid_message_prop X m</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="kr">‚àÄ</span> <span class="nv">m</span> : message,
  trace_has_message (field_selector input) m tr
  ‚Üí valid_message_prop X m</div></blockquote><div class="alectryon-extra-goals"><input class="alectryon-extra-goal-toggle" id="VLSM-v-chk496" style="display: none" type="checkbox"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>message</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>X</var><span class="hyp-type"><b>: </b><span>VLSM message</span></span></span><br><span><var>is</var><span class="hyp-type"><b>: </b><span>state</span></span></span><br><span><var>x</var><span class="hyp-type"><b>: </b><span>transition_item</span></span></span><br><span><var>tr</var><span class="hyp-type"><b>: </b><span>list transition_item</span></span></span><br><span><var>s</var><span class="hyp-type"><b>: </b><span>state</span></span></span><br><span><var>Htr</var><span class="hyp-type"><b>: </b><span>finite_valid_trace_from_to
  pre_loaded_with_all_messages_vlsm <span class="kr">is</span>
  (finite_trace_last <span class="kr">is</span> tr) tr</span></span></span><br><span><var>Hx</var><span class="hyp-type"><b>: </b><span>finite_valid_trace_from_to
  pre_loaded_with_all_messages_vlsm
  (finite_trace_last <span class="kr">is</span> tr) s [x]</span></span></span><br><span><var>Hlst</var><span class="hyp-type"><b>: </b><span>finite_trace_last <span class="kr">is</span> (tr ++ [x]) = s</span></span></span><br><span><var>Hinit</var><span class="hyp-type"><b>: </b><span>initial_state_prop <span class="kr">is</span></span></span></span><br><span><var>Hobs</var><span class="hyp-type"><b>: </b><span><span class="kr">‚àÄ</span> <span class="nv">m</span> : message,
  trace_has_message (field_selector input) m
    (tr ++ [x]) ‚Üí valid_message_prop X m</span></span></span><br><span><var>IHtr</var><span class="hyp-type"><b>: </b><span>finite_valid_trace_init_to X <span class="kr">is</span>
  (finite_trace_last <span class="kr">is</span> tr) tr</span></span></span><br></div><label class="goal-separator" for="VLSM-v-chk496"><hr></label><div class="goal-conclusion">finite_valid_trace_from_to X <span class="kr">is</span> s (tr ++ [x])</div></blockquote></div></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">      </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="VLSM-v-chk497" style="display: none" type="checkbox"><label class="alectryon-input" for="VLSM-v-chk497">{</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>message</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>X</var><span class="hyp-type"><b>: </b><span>VLSM message</span></span></span><br><span><var>is</var><span class="hyp-type"><b>: </b><span>state</span></span></span><br><span><var>x</var><span class="hyp-type"><b>: </b><span>transition_item</span></span></span><br><span><var>tr</var><span class="hyp-type"><b>: </b><span>list transition_item</span></span></span><br><span><var>IHtr</var><span class="hyp-type"><b>: </b><span>(<span class="kr">‚àÄ</span> <span class="nv">m</span> : message,
   trace_has_message (field_selector input) m
     tr ‚Üí valid_message_prop X m)
‚Üí finite_valid_trace_init_to X <span class="kr">is</span>
    (finite_trace_last <span class="kr">is</span> tr) tr</span></span></span><br><span><var>s</var><span class="hyp-type"><b>: </b><span>state</span></span></span><br><span><var>Htr</var><span class="hyp-type"><b>: </b><span>finite_valid_trace_from_to
  pre_loaded_with_all_messages_vlsm <span class="kr">is</span>
  (finite_trace_last <span class="kr">is</span> tr) tr</span></span></span><br><span><var>Hx</var><span class="hyp-type"><b>: </b><span>finite_valid_trace_from_to
  pre_loaded_with_all_messages_vlsm
  (finite_trace_last <span class="kr">is</span> tr) s [x]</span></span></span><br><span><var>Hlst</var><span class="hyp-type"><b>: </b><span>finite_trace_last <span class="kr">is</span> (tr ++ [x]) = s</span></span></span><br><span><var>Hinit</var><span class="hyp-type"><b>: </b><span>initial_state_prop <span class="kr">is</span></span></span></span><br><span><var>Hobs</var><span class="hyp-type"><b>: </b><span><span class="kr">‚àÄ</span> <span class="nv">m</span> : message,
  trace_has_message (field_selector input) m
    (tr ++ [x]) ‚Üí valid_message_prop X m</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="kr">‚àÄ</span> <span class="nv">m</span> : message,
  trace_has_message (field_selector input) m tr
  ‚Üí valid_message_prop X m</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">        </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="VLSM-v-chk498" style="display: none" type="checkbox"><label class="alectryon-input" for="VLSM-v-chk498"><span class="nb">intros</span>.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>message</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>X</var><span class="hyp-type"><b>: </b><span>VLSM message</span></span></span><br><span><var>is</var><span class="hyp-type"><b>: </b><span>state</span></span></span><br><span><var>x</var><span class="hyp-type"><b>: </b><span>transition_item</span></span></span><br><span><var>tr</var><span class="hyp-type"><b>: </b><span>list transition_item</span></span></span><br><span><var>IHtr</var><span class="hyp-type"><b>: </b><span>(<span class="kr">‚àÄ</span> <span class="nv">m</span> : message,
   trace_has_message (field_selector input) m
     tr ‚Üí valid_message_prop X m)
‚Üí finite_valid_trace_init_to X <span class="kr">is</span>
    (finite_trace_last <span class="kr">is</span> tr) tr</span></span></span><br><span><var>s</var><span class="hyp-type"><b>: </b><span>state</span></span></span><br><span><var>Htr</var><span class="hyp-type"><b>: </b><span>finite_valid_trace_from_to
  pre_loaded_with_all_messages_vlsm <span class="kr">is</span>
  (finite_trace_last <span class="kr">is</span> tr) tr</span></span></span><br><span><var>Hx</var><span class="hyp-type"><b>: </b><span>finite_valid_trace_from_to
  pre_loaded_with_all_messages_vlsm
  (finite_trace_last <span class="kr">is</span> tr) s [x]</span></span></span><br><span><var>Hlst</var><span class="hyp-type"><b>: </b><span>finite_trace_last <span class="kr">is</span> (tr ++ [x]) = s</span></span></span><br><span><var>Hinit</var><span class="hyp-type"><b>: </b><span>initial_state_prop <span class="kr">is</span></span></span></span><br><span><var>Hobs</var><span class="hyp-type"><b>: </b><span><span class="kr">‚àÄ</span> <span class="nv">m</span> : message,
  trace_has_message (field_selector input) m
    (tr ++ [x]) ‚Üí valid_message_prop X m</span></span></span><br><span><var>m</var><span class="hyp-type"><b>: </b><span>message</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>trace_has_message (field_selector input) m tr</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">valid_message_prop X m</div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="VLSM-v-chk499" style="display: none" type="checkbox"><label class="alectryon-input" for="VLSM-v-chk499"><span class="nb">apply</span> Hobs.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>message</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>X</var><span class="hyp-type"><b>: </b><span>VLSM message</span></span></span><br><span><var>is</var><span class="hyp-type"><b>: </b><span>state</span></span></span><br><span><var>x</var><span class="hyp-type"><b>: </b><span>transition_item</span></span></span><br><span><var>tr</var><span class="hyp-type"><b>: </b><span>list transition_item</span></span></span><br><span><var>IHtr</var><span class="hyp-type"><b>: </b><span>(<span class="kr">‚àÄ</span> <span class="nv">m</span> : message,
   trace_has_message (field_selector input) m
     tr ‚Üí valid_message_prop X m)
‚Üí finite_valid_trace_init_to X <span class="kr">is</span>
    (finite_trace_last <span class="kr">is</span> tr) tr</span></span></span><br><span><var>s</var><span class="hyp-type"><b>: </b><span>state</span></span></span><br><span><var>Htr</var><span class="hyp-type"><b>: </b><span>finite_valid_trace_from_to
  pre_loaded_with_all_messages_vlsm <span class="kr">is</span>
  (finite_trace_last <span class="kr">is</span> tr) tr</span></span></span><br><span><var>Hx</var><span class="hyp-type"><b>: </b><span>finite_valid_trace_from_to
  pre_loaded_with_all_messages_vlsm
  (finite_trace_last <span class="kr">is</span> tr) s [x]</span></span></span><br><span><var>Hlst</var><span class="hyp-type"><b>: </b><span>finite_trace_last <span class="kr">is</span> (tr ++ [x]) = s</span></span></span><br><span><var>Hinit</var><span class="hyp-type"><b>: </b><span>initial_state_prop <span class="kr">is</span></span></span></span><br><span><var>Hobs</var><span class="hyp-type"><b>: </b><span><span class="kr">‚àÄ</span> <span class="nv">m</span> : message,
  trace_has_message (field_selector input) m
    (tr ++ [x]) ‚Üí valid_message_prop X m</span></span></span><br><span><var>m</var><span class="hyp-type"><b>: </b><span>message</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>trace_has_message (field_selector input) m tr</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">trace_has_message (field_selector input) m (tr ++ [x])</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">        </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="VLSM-v-chk49a" style="display: none" type="checkbox"><label class="alectryon-input" for="VLSM-v-chk49a"><span class="nb">apply</span> trace_has_message_prefix.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>message</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>X</var><span class="hyp-type"><b>: </b><span>VLSM message</span></span></span><br><span><var>is</var><span class="hyp-type"><b>: </b><span>state</span></span></span><br><span><var>x</var><span class="hyp-type"><b>: </b><span>transition_item</span></span></span><br><span><var>tr</var><span class="hyp-type"><b>: </b><span>list transition_item</span></span></span><br><span><var>IHtr</var><span class="hyp-type"><b>: </b><span>(<span class="kr">‚àÄ</span> <span class="nv">m</span> : message,
   trace_has_message (field_selector input) m
     tr ‚Üí valid_message_prop X m)
‚Üí finite_valid_trace_init_to X <span class="kr">is</span>
    (finite_trace_last <span class="kr">is</span> tr) tr</span></span></span><br><span><var>s</var><span class="hyp-type"><b>: </b><span>state</span></span></span><br><span><var>Htr</var><span class="hyp-type"><b>: </b><span>finite_valid_trace_from_to
  pre_loaded_with_all_messages_vlsm <span class="kr">is</span>
  (finite_trace_last <span class="kr">is</span> tr) tr</span></span></span><br><span><var>Hx</var><span class="hyp-type"><b>: </b><span>finite_valid_trace_from_to
  pre_loaded_with_all_messages_vlsm
  (finite_trace_last <span class="kr">is</span> tr) s [x]</span></span></span><br><span><var>Hlst</var><span class="hyp-type"><b>: </b><span>finite_trace_last <span class="kr">is</span> (tr ++ [x]) = s</span></span></span><br><span><var>Hinit</var><span class="hyp-type"><b>: </b><span>initial_state_prop <span class="kr">is</span></span></span></span><br><span><var>Hobs</var><span class="hyp-type"><b>: </b><span><span class="kr">‚àÄ</span> <span class="nv">m</span> : message,
  trace_has_message (field_selector input) m
    (tr ++ [x]) ‚Üí valid_message_prop X m</span></span></span><br><span><var>m</var><span class="hyp-type"><b>: </b><span>message</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>trace_has_message (field_selector input) m tr</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">trace_has_message (field_selector input) m tr</div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="bp">assumption</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">      </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="VLSM-v-chk49b" style="display: none" type="checkbox"><label class="alectryon-input" for="VLSM-v-chk49b">}</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>message</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>X</var><span class="hyp-type"><b>: </b><span>VLSM message</span></span></span><br><span><var>is</var><span class="hyp-type"><b>: </b><span>state</span></span></span><br><span><var>x</var><span class="hyp-type"><b>: </b><span>transition_item</span></span></span><br><span><var>tr</var><span class="hyp-type"><b>: </b><span>list transition_item</span></span></span><br><span><var>s</var><span class="hyp-type"><b>: </b><span>state</span></span></span><br><span><var>Htr</var><span class="hyp-type"><b>: </b><span>finite_valid_trace_from_to
  pre_loaded_with_all_messages_vlsm <span class="kr">is</span>
  (finite_trace_last <span class="kr">is</span> tr) tr</span></span></span><br><span><var>Hx</var><span class="hyp-type"><b>: </b><span>finite_valid_trace_from_to
  pre_loaded_with_all_messages_vlsm
  (finite_trace_last <span class="kr">is</span> tr) s [x]</span></span></span><br><span><var>Hlst</var><span class="hyp-type"><b>: </b><span>finite_trace_last <span class="kr">is</span> (tr ++ [x]) = s</span></span></span><br><span><var>Hinit</var><span class="hyp-type"><b>: </b><span>initial_state_prop <span class="kr">is</span></span></span></span><br><span><var>Hobs</var><span class="hyp-type"><b>: </b><span><span class="kr">‚àÄ</span> <span class="nv">m</span> : message,
  trace_has_message (field_selector input) m
    (tr ++ [x]) ‚Üí valid_message_prop X m</span></span></span><br><span><var>IHtr</var><span class="hyp-type"><b>: </b><span>finite_valid_trace_init_to X <span class="kr">is</span>
  (finite_trace_last <span class="kr">is</span> tr) tr</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">finite_valid_trace_from_to X <span class="kr">is</span> s (tr ++ [x])</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">      </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="VLSM-v-chk49c" style="display: none" type="checkbox"><label class="alectryon-input" for="VLSM-v-chk49c"><span class="nb">destruct</span> IHtr <span class="kr">as</span> [IHtr _];
      <span class="nb">apply</span> finite_valid_trace_from_to_forget_last <span class="kr">in</span> IHtr.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>message</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>X</var><span class="hyp-type"><b>: </b><span>VLSM message</span></span></span><br><span><var>is</var><span class="hyp-type"><b>: </b><span>state</span></span></span><br><span><var>x</var><span class="hyp-type"><b>: </b><span>transition_item</span></span></span><br><span><var>tr</var><span class="hyp-type"><b>: </b><span>list transition_item</span></span></span><br><span><var>s</var><span class="hyp-type"><b>: </b><span>state</span></span></span><br><span><var>Htr</var><span class="hyp-type"><b>: </b><span>finite_valid_trace_from_to
  pre_loaded_with_all_messages_vlsm <span class="kr">is</span>
  (finite_trace_last <span class="kr">is</span> tr) tr</span></span></span><br><span><var>Hx</var><span class="hyp-type"><b>: </b><span>finite_valid_trace_from_to
  pre_loaded_with_all_messages_vlsm
  (finite_trace_last <span class="kr">is</span> tr) s [x]</span></span></span><br><span><var>Hlst</var><span class="hyp-type"><b>: </b><span>finite_trace_last <span class="kr">is</span> (tr ++ [x]) = s</span></span></span><br><span><var>Hinit</var><span class="hyp-type"><b>: </b><span>initial_state_prop <span class="kr">is</span></span></span></span><br><span><var>Hobs</var><span class="hyp-type"><b>: </b><span><span class="kr">‚àÄ</span> <span class="nv">m</span> : message,
  trace_has_message (field_selector input) m
    (tr ++ [x]) ‚Üí valid_message_prop X m</span></span></span><br><span><var>IHtr</var><span class="hyp-type"><b>: </b><span>finite_valid_trace_from X <span class="kr">is</span> tr</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">finite_valid_trace_from_to X <span class="kr">is</span> s (tr ++ [x])</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">      </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="VLSM-v-chk49d" style="display: none" type="checkbox"><label class="alectryon-input" for="VLSM-v-chk49d"><span class="nb">apply</span> finite_valid_trace_from_add_last; [| <span class="bp">assumption</span>].</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>message</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>X</var><span class="hyp-type"><b>: </b><span>VLSM message</span></span></span><br><span><var>is</var><span class="hyp-type"><b>: </b><span>state</span></span></span><br><span><var>x</var><span class="hyp-type"><b>: </b><span>transition_item</span></span></span><br><span><var>tr</var><span class="hyp-type"><b>: </b><span>list transition_item</span></span></span><br><span><var>s</var><span class="hyp-type"><b>: </b><span>state</span></span></span><br><span><var>Htr</var><span class="hyp-type"><b>: </b><span>finite_valid_trace_from_to
  pre_loaded_with_all_messages_vlsm <span class="kr">is</span>
  (finite_trace_last <span class="kr">is</span> tr) tr</span></span></span><br><span><var>Hx</var><span class="hyp-type"><b>: </b><span>finite_valid_trace_from_to
  pre_loaded_with_all_messages_vlsm
  (finite_trace_last <span class="kr">is</span> tr) s [x]</span></span></span><br><span><var>Hlst</var><span class="hyp-type"><b>: </b><span>finite_trace_last <span class="kr">is</span> (tr ++ [x]) = s</span></span></span><br><span><var>Hinit</var><span class="hyp-type"><b>: </b><span>initial_state_prop <span class="kr">is</span></span></span></span><br><span><var>Hobs</var><span class="hyp-type"><b>: </b><span><span class="kr">‚àÄ</span> <span class="nv">m</span> : message,
  trace_has_message (field_selector input) m
    (tr ++ [x]) ‚Üí valid_message_prop X m</span></span></span><br><span><var>IHtr</var><span class="hyp-type"><b>: </b><span>finite_valid_trace_from X <span class="kr">is</span> tr</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">finite_valid_trace_from X <span class="kr">is</span> (tr ++ [x])</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">      </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="VLSM-v-chk49e" style="display: none" type="checkbox"><label class="alectryon-input" for="VLSM-v-chk49e"><span class="nb">inversion</span> Hx; <span class="nb">subst</span> f tl s&#39;.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>message</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>X</var><span class="hyp-type"><b>: </b><span>VLSM message</span></span></span><br><span><var>is</var><span class="hyp-type"><b>: </b><span>state</span></span></span><br><span><var>x</var><span class="hyp-type"><b>: </b><span>transition_item</span></span></span><br><span><var>tr</var><span class="hyp-type"><b>: </b><span>list transition_item</span></span></span><br><span><var>s</var><span class="hyp-type"><b>: </b><span>state</span></span></span><br><span><var>Htr</var><span class="hyp-type"><b>: </b><span>finite_valid_trace_from_to
  pre_loaded_with_all_messages_vlsm <span class="kr">is</span>
  (finite_trace_last <span class="kr">is</span> tr) tr</span></span></span><br><span><var>Hx</var><span class="hyp-type"><b>: </b><span>finite_valid_trace_from_to
  pre_loaded_with_all_messages_vlsm
  (finite_trace_last <span class="kr">is</span> tr) s [x]</span></span></span><br><span><var>Hlst</var><span class="hyp-type"><b>: </b><span>finite_trace_last <span class="kr">is</span> (tr ++ [x]) = s</span></span></span><br><span><var>Hinit</var><span class="hyp-type"><b>: </b><span>initial_state_prop <span class="kr">is</span></span></span></span><br><span><var>Hobs</var><span class="hyp-type"><b>: </b><span><span class="kr">‚àÄ</span> <span class="nv">m</span> : message,
  trace_has_message (field_selector input) m
    (tr ++ [x]) ‚Üí valid_message_prop X m</span></span></span><br><span><var>IHtr</var><span class="hyp-type"><b>: </b><span>finite_valid_trace_from X <span class="kr">is</span> tr</span></span></span><br><span><var>s1</var><span class="hyp-type"><b>: </b><span>state</span></span></span><br><span><var>iom, oom</var><span class="hyp-type"><b>: </b><span>option message</span></span></span><br><span><var>l0</var><span class="hyp-type"><b>: </b><span>label</span></span></span><br><span><var>Htl</var><span class="hyp-type"><b>: </b><span>finite_valid_trace_from_to
  pre_loaded_with_all_messages_vlsm s1 s []</span></span></span><br><span><var>Ht</var><span class="hyp-type"><b>: </b><span>input_valid_transition
  pre_loaded_with_all_messages_vlsm l0
  (finite_trace_last <span class="kr">is</span> tr, iom) 
  (s1, oom)</span></span></span><br><span><var>H2</var><span class="hyp-type"><b>: </b><span>{|
  l := l0;
  input := iom;
  destination := s1;
  output := oom
|} = x</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">finite_valid_trace_from X <span class="kr">is</span>
  (tr ++
   [{|
      l := l0;
      input := iom;
      destination := s1;
      output := oom
    |}])</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">      </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="VLSM-v-chk49f" style="display: none" type="checkbox"><label class="alectryon-input" for="VLSM-v-chk49f"><span class="nb">apply</span> (extend_right_finite_trace_from X); [<span class="bp">assumption</span> |].</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>message</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>X</var><span class="hyp-type"><b>: </b><span>VLSM message</span></span></span><br><span><var>is</var><span class="hyp-type"><b>: </b><span>state</span></span></span><br><span><var>x</var><span class="hyp-type"><b>: </b><span>transition_item</span></span></span><br><span><var>tr</var><span class="hyp-type"><b>: </b><span>list transition_item</span></span></span><br><span><var>s</var><span class="hyp-type"><b>: </b><span>state</span></span></span><br><span><var>Htr</var><span class="hyp-type"><b>: </b><span>finite_valid_trace_from_to
  pre_loaded_with_all_messages_vlsm <span class="kr">is</span>
  (finite_trace_last <span class="kr">is</span> tr) tr</span></span></span><br><span><var>Hx</var><span class="hyp-type"><b>: </b><span>finite_valid_trace_from_to
  pre_loaded_with_all_messages_vlsm
  (finite_trace_last <span class="kr">is</span> tr) s [x]</span></span></span><br><span><var>Hlst</var><span class="hyp-type"><b>: </b><span>finite_trace_last <span class="kr">is</span> (tr ++ [x]) = s</span></span></span><br><span><var>Hinit</var><span class="hyp-type"><b>: </b><span>initial_state_prop <span class="kr">is</span></span></span></span><br><span><var>Hobs</var><span class="hyp-type"><b>: </b><span><span class="kr">‚àÄ</span> <span class="nv">m</span> : message,
  trace_has_message (field_selector input) m
    (tr ++ [x]) ‚Üí valid_message_prop X m</span></span></span><br><span><var>IHtr</var><span class="hyp-type"><b>: </b><span>finite_valid_trace_from X <span class="kr">is</span> tr</span></span></span><br><span><var>s1</var><span class="hyp-type"><b>: </b><span>state</span></span></span><br><span><var>iom, oom</var><span class="hyp-type"><b>: </b><span>option message</span></span></span><br><span><var>l0</var><span class="hyp-type"><b>: </b><span>label</span></span></span><br><span><var>Htl</var><span class="hyp-type"><b>: </b><span>finite_valid_trace_from_to
  pre_loaded_with_all_messages_vlsm s1 s []</span></span></span><br><span><var>Ht</var><span class="hyp-type"><b>: </b><span>input_valid_transition
  pre_loaded_with_all_messages_vlsm l0
  (finite_trace_last <span class="kr">is</span> tr, iom) 
  (s1, oom)</span></span></span><br><span><var>H2</var><span class="hyp-type"><b>: </b><span>{|
  l := l0;
  input := iom;
  destination := s1;
  output := oom
|} = x</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">input_valid_transition X l0
  (finite_trace_last <span class="kr">is</span> tr, iom) (s1, oom)</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">      </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="VLSM-v-chk4a0" style="display: none" type="checkbox"><label class="alectryon-input" for="VLSM-v-chk4a0"><span class="nb">destruct</span> Ht <span class="kr">as</span> [[_ [_ Hv]] Ht].</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>message</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>X</var><span class="hyp-type"><b>: </b><span>VLSM message</span></span></span><br><span><var>is</var><span class="hyp-type"><b>: </b><span>state</span></span></span><br><span><var>x</var><span class="hyp-type"><b>: </b><span>transition_item</span></span></span><br><span><var>tr</var><span class="hyp-type"><b>: </b><span>list transition_item</span></span></span><br><span><var>s</var><span class="hyp-type"><b>: </b><span>state</span></span></span><br><span><var>Htr</var><span class="hyp-type"><b>: </b><span>finite_valid_trace_from_to
  pre_loaded_with_all_messages_vlsm <span class="kr">is</span>
  (finite_trace_last <span class="kr">is</span> tr) tr</span></span></span><br><span><var>Hx</var><span class="hyp-type"><b>: </b><span>finite_valid_trace_from_to
  pre_loaded_with_all_messages_vlsm
  (finite_trace_last <span class="kr">is</span> tr) s [x]</span></span></span><br><span><var>Hlst</var><span class="hyp-type"><b>: </b><span>finite_trace_last <span class="kr">is</span> (tr ++ [x]) = s</span></span></span><br><span><var>Hinit</var><span class="hyp-type"><b>: </b><span>initial_state_prop <span class="kr">is</span></span></span></span><br><span><var>Hobs</var><span class="hyp-type"><b>: </b><span><span class="kr">‚àÄ</span> <span class="nv">m</span> : message,
  trace_has_message (field_selector input) m
    (tr ++ [x]) ‚Üí valid_message_prop X m</span></span></span><br><span><var>IHtr</var><span class="hyp-type"><b>: </b><span>finite_valid_trace_from X <span class="kr">is</span> tr</span></span></span><br><span><var>s1</var><span class="hyp-type"><b>: </b><span>state</span></span></span><br><span><var>iom, oom</var><span class="hyp-type"><b>: </b><span>option message</span></span></span><br><span><var>l0</var><span class="hyp-type"><b>: </b><span>label</span></span></span><br><span><var>Htl</var><span class="hyp-type"><b>: </b><span>finite_valid_trace_from_to
  pre_loaded_with_all_messages_vlsm s1 s []</span></span></span><br><span><var>Hv</var><span class="hyp-type"><b>: </b><span>valid l0 (finite_trace_last <span class="kr">is</span> tr, iom)</span></span></span><br><span><var>Ht</var><span class="hyp-type"><b>: </b><span>transition l0 (finite_trace_last <span class="kr">is</span> tr, iom) =
(s1, oom)</span></span></span><br><span><var>H2</var><span class="hyp-type"><b>: </b><span>{|
  l := l0;
  input := iom;
  destination := s1;
  output := oom
|} = x</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">input_valid_transition X l0
  (finite_trace_last <span class="kr">is</span> tr, iom) (s1, oom)</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">      </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="VLSM-v-chk4a1" style="display: none" type="checkbox"><label class="alectryon-input" for="VLSM-v-chk4a1"><span class="nb">apply</span> finite_valid_trace_last_pstate <span class="kr">in</span> IHtr <span class="kr">as</span> Hplst.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>message</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>X</var><span class="hyp-type"><b>: </b><span>VLSM message</span></span></span><br><span><var>is</var><span class="hyp-type"><b>: </b><span>state</span></span></span><br><span><var>x</var><span class="hyp-type"><b>: </b><span>transition_item</span></span></span><br><span><var>tr</var><span class="hyp-type"><b>: </b><span>list transition_item</span></span></span><br><span><var>s</var><span class="hyp-type"><b>: </b><span>state</span></span></span><br><span><var>Htr</var><span class="hyp-type"><b>: </b><span>finite_valid_trace_from_to
  pre_loaded_with_all_messages_vlsm <span class="kr">is</span>
  (finite_trace_last <span class="kr">is</span> tr) tr</span></span></span><br><span><var>Hx</var><span class="hyp-type"><b>: </b><span>finite_valid_trace_from_to
  pre_loaded_with_all_messages_vlsm
  (finite_trace_last <span class="kr">is</span> tr) s [x]</span></span></span><br><span><var>Hlst</var><span class="hyp-type"><b>: </b><span>finite_trace_last <span class="kr">is</span> (tr ++ [x]) = s</span></span></span><br><span><var>Hinit</var><span class="hyp-type"><b>: </b><span>initial_state_prop <span class="kr">is</span></span></span></span><br><span><var>Hobs</var><span class="hyp-type"><b>: </b><span><span class="kr">‚àÄ</span> <span class="nv">m</span> : message,
  trace_has_message (field_selector input) m
    (tr ++ [x]) ‚Üí valid_message_prop X m</span></span></span><br><span><var>IHtr</var><span class="hyp-type"><b>: </b><span>finite_valid_trace_from X <span class="kr">is</span> tr</span></span></span><br><span><var>Hplst</var><span class="hyp-type"><b>: </b><span>valid_state_prop X (finite_trace_last <span class="kr">is</span> tr)</span></span></span><br><span><var>s1</var><span class="hyp-type"><b>: </b><span>state</span></span></span><br><span><var>iom, oom</var><span class="hyp-type"><b>: </b><span>option message</span></span></span><br><span><var>l0</var><span class="hyp-type"><b>: </b><span>label</span></span></span><br><span><var>Htl</var><span class="hyp-type"><b>: </b><span>finite_valid_trace_from_to
  pre_loaded_with_all_messages_vlsm s1 s []</span></span></span><br><span><var>Hv</var><span class="hyp-type"><b>: </b><span>valid l0 (finite_trace_last <span class="kr">is</span> tr, iom)</span></span></span><br><span><var>Ht</var><span class="hyp-type"><b>: </b><span>transition l0 (finite_trace_last <span class="kr">is</span> tr, iom) =
(s1, oom)</span></span></span><br><span><var>H2</var><span class="hyp-type"><b>: </b><span>{|
  l := l0;
  input := iom;
  destination := s1;
  output := oom
|} = x</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">input_valid_transition X l0
  (finite_trace_last <span class="kr">is</span> tr, iom) (s1, oom)</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">      </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="VLSM-v-chk4a2" style="display: none" type="checkbox"><label class="alectryon-input" for="VLSM-v-chk4a2"><span class="kp">repeat</span> <span class="nb">split</span>.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>message</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>X</var><span class="hyp-type"><b>: </b><span>VLSM message</span></span></span><br><span><var>is</var><span class="hyp-type"><b>: </b><span>state</span></span></span><br><span><var>x</var><span class="hyp-type"><b>: </b><span>transition_item</span></span></span><br><span><var>tr</var><span class="hyp-type"><b>: </b><span>list transition_item</span></span></span><br><span><var>s</var><span class="hyp-type"><b>: </b><span>state</span></span></span><br><span><var>Htr</var><span class="hyp-type"><b>: </b><span>finite_valid_trace_from_to
  pre_loaded_with_all_messages_vlsm <span class="kr">is</span>
  (finite_trace_last <span class="kr">is</span> tr) tr</span></span></span><br><span><var>Hx</var><span class="hyp-type"><b>: </b><span>finite_valid_trace_from_to
  pre_loaded_with_all_messages_vlsm
  (finite_trace_last <span class="kr">is</span> tr) s [x]</span></span></span><br><span><var>Hlst</var><span class="hyp-type"><b>: </b><span>finite_trace_last <span class="kr">is</span> (tr ++ [x]) = s</span></span></span><br><span><var>Hinit</var><span class="hyp-type"><b>: </b><span>initial_state_prop <span class="kr">is</span></span></span></span><br><span><var>Hobs</var><span class="hyp-type"><b>: </b><span><span class="kr">‚àÄ</span> <span class="nv">m</span> : message,
  trace_has_message (field_selector input) m
    (tr ++ [x]) ‚Üí valid_message_prop X m</span></span></span><br><span><var>IHtr</var><span class="hyp-type"><b>: </b><span>finite_valid_trace_from X <span class="kr">is</span> tr</span></span></span><br><span><var>Hplst</var><span class="hyp-type"><b>: </b><span>valid_state_prop X (finite_trace_last <span class="kr">is</span> tr)</span></span></span><br><span><var>s1</var><span class="hyp-type"><b>: </b><span>state</span></span></span><br><span><var>iom, oom</var><span class="hyp-type"><b>: </b><span>option message</span></span></span><br><span><var>l0</var><span class="hyp-type"><b>: </b><span>label</span></span></span><br><span><var>Htl</var><span class="hyp-type"><b>: </b><span>finite_valid_trace_from_to
  pre_loaded_with_all_messages_vlsm s1 s []</span></span></span><br><span><var>Hv</var><span class="hyp-type"><b>: </b><span>valid l0 (finite_trace_last <span class="kr">is</span> tr, iom)</span></span></span><br><span><var>Ht</var><span class="hyp-type"><b>: </b><span>transition l0 (finite_trace_last <span class="kr">is</span> tr, iom) =
(s1, oom)</span></span></span><br><span><var>H2</var><span class="hyp-type"><b>: </b><span>{|
  l := l0;
  input := iom;
  destination := s1;
  output := oom
|} = x</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">valid_state_prop X (finite_trace_last <span class="kr">is</span> tr)</div></blockquote><div class="alectryon-extra-goals"><input class="alectryon-extra-goal-toggle" id="VLSM-v-chk4a3" style="display: none" type="checkbox"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>message</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>X</var><span class="hyp-type"><b>: </b><span>VLSM message</span></span></span><br><span><var>is</var><span class="hyp-type"><b>: </b><span>state</span></span></span><br><span><var>x</var><span class="hyp-type"><b>: </b><span>transition_item</span></span></span><br><span><var>tr</var><span class="hyp-type"><b>: </b><span>list transition_item</span></span></span><br><span><var>s</var><span class="hyp-type"><b>: </b><span>state</span></span></span><br><span><var>Htr</var><span class="hyp-type"><b>: </b><span>finite_valid_trace_from_to
  pre_loaded_with_all_messages_vlsm <span class="kr">is</span>
  (finite_trace_last <span class="kr">is</span> tr) tr</span></span></span><br><span><var>Hx</var><span class="hyp-type"><b>: </b><span>finite_valid_trace_from_to
  pre_loaded_with_all_messages_vlsm
  (finite_trace_last <span class="kr">is</span> tr) s [x]</span></span></span><br><span><var>Hlst</var><span class="hyp-type"><b>: </b><span>finite_trace_last <span class="kr">is</span> (tr ++ [x]) = s</span></span></span><br><span><var>Hinit</var><span class="hyp-type"><b>: </b><span>initial_state_prop <span class="kr">is</span></span></span></span><br><span><var>Hobs</var><span class="hyp-type"><b>: </b><span><span class="kr">‚àÄ</span> <span class="nv">m</span> : message,
  trace_has_message (field_selector input) m
    (tr ++ [x]) ‚Üí valid_message_prop X m</span></span></span><br><span><var>IHtr</var><span class="hyp-type"><b>: </b><span>finite_valid_trace_from X <span class="kr">is</span> tr</span></span></span><br><span><var>Hplst</var><span class="hyp-type"><b>: </b><span>valid_state_prop X (finite_trace_last <span class="kr">is</span> tr)</span></span></span><br><span><var>s1</var><span class="hyp-type"><b>: </b><span>state</span></span></span><br><span><var>iom, oom</var><span class="hyp-type"><b>: </b><span>option message</span></span></span><br><span><var>l0</var><span class="hyp-type"><b>: </b><span>label</span></span></span><br><span><var>Htl</var><span class="hyp-type"><b>: </b><span>finite_valid_trace_from_to
  pre_loaded_with_all_messages_vlsm s1 s []</span></span></span><br><span><var>Hv</var><span class="hyp-type"><b>: </b><span>valid l0 (finite_trace_last <span class="kr">is</span> tr, iom)</span></span></span><br><span><var>Ht</var><span class="hyp-type"><b>: </b><span>transition l0 (finite_trace_last <span class="kr">is</span> tr, iom) =
(s1, oom)</span></span></span><br><span><var>H2</var><span class="hyp-type"><b>: </b><span>{|
  l := l0;
  input := iom;
  destination := s1;
  output := oom
|} = x</span></span></span><br></div><label class="goal-separator" for="VLSM-v-chk4a3"><hr></label><div class="goal-conclusion">option_valid_message_prop X iom</div></blockquote><input class="alectryon-extra-goal-toggle" id="VLSM-v-chk4a4" style="display: none" type="checkbox"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>message</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>X</var><span class="hyp-type"><b>: </b><span>VLSM message</span></span></span><br><span><var>is</var><span class="hyp-type"><b>: </b><span>state</span></span></span><br><span><var>x</var><span class="hyp-type"><b>: </b><span>transition_item</span></span></span><br><span><var>tr</var><span class="hyp-type"><b>: </b><span>list transition_item</span></span></span><br><span><var>s</var><span class="hyp-type"><b>: </b><span>state</span></span></span><br><span><var>Htr</var><span class="hyp-type"><b>: </b><span>finite_valid_trace_from_to
  pre_loaded_with_all_messages_vlsm <span class="kr">is</span>
  (finite_trace_last <span class="kr">is</span> tr) tr</span></span></span><br><span><var>Hx</var><span class="hyp-type"><b>: </b><span>finite_valid_trace_from_to
  pre_loaded_with_all_messages_vlsm
  (finite_trace_last <span class="kr">is</span> tr) s [x]</span></span></span><br><span><var>Hlst</var><span class="hyp-type"><b>: </b><span>finite_trace_last <span class="kr">is</span> (tr ++ [x]) = s</span></span></span><br><span><var>Hinit</var><span class="hyp-type"><b>: </b><span>initial_state_prop <span class="kr">is</span></span></span></span><br><span><var>Hobs</var><span class="hyp-type"><b>: </b><span><span class="kr">‚àÄ</span> <span class="nv">m</span> : message,
  trace_has_message (field_selector input) m
    (tr ++ [x]) ‚Üí valid_message_prop X m</span></span></span><br><span><var>IHtr</var><span class="hyp-type"><b>: </b><span>finite_valid_trace_from X <span class="kr">is</span> tr</span></span></span><br><span><var>Hplst</var><span class="hyp-type"><b>: </b><span>valid_state_prop X (finite_trace_last <span class="kr">is</span> tr)</span></span></span><br><span><var>s1</var><span class="hyp-type"><b>: </b><span>state</span></span></span><br><span><var>iom, oom</var><span class="hyp-type"><b>: </b><span>option message</span></span></span><br><span><var>l0</var><span class="hyp-type"><b>: </b><span>label</span></span></span><br><span><var>Htl</var><span class="hyp-type"><b>: </b><span>finite_valid_trace_from_to
  pre_loaded_with_all_messages_vlsm s1 s []</span></span></span><br><span><var>Hv</var><span class="hyp-type"><b>: </b><span>valid l0 (finite_trace_last <span class="kr">is</span> tr, iom)</span></span></span><br><span><var>Ht</var><span class="hyp-type"><b>: </b><span>transition l0 (finite_trace_last <span class="kr">is</span> tr, iom) =
(s1, oom)</span></span></span><br><span><var>H2</var><span class="hyp-type"><b>: </b><span>{|
  l := l0;
  input := iom;
  destination := s1;
  output := oom
|} = x</span></span></span><br></div><label class="goal-separator" for="VLSM-v-chk4a4"><hr></label><div class="goal-conclusion">valid l0 (finite_trace_last <span class="kr">is</span> tr, iom)</div></blockquote><input class="alectryon-extra-goal-toggle" id="VLSM-v-chk4a5" style="display: none" type="checkbox"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>message</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>X</var><span class="hyp-type"><b>: </b><span>VLSM message</span></span></span><br><span><var>is</var><span class="hyp-type"><b>: </b><span>state</span></span></span><br><span><var>x</var><span class="hyp-type"><b>: </b><span>transition_item</span></span></span><br><span><var>tr</var><span class="hyp-type"><b>: </b><span>list transition_item</span></span></span><br><span><var>s</var><span class="hyp-type"><b>: </b><span>state</span></span></span><br><span><var>Htr</var><span class="hyp-type"><b>: </b><span>finite_valid_trace_from_to
  pre_loaded_with_all_messages_vlsm <span class="kr">is</span>
  (finite_trace_last <span class="kr">is</span> tr) tr</span></span></span><br><span><var>Hx</var><span class="hyp-type"><b>: </b><span>finite_valid_trace_from_to
  pre_loaded_with_all_messages_vlsm
  (finite_trace_last <span class="kr">is</span> tr) s [x]</span></span></span><br><span><var>Hlst</var><span class="hyp-type"><b>: </b><span>finite_trace_last <span class="kr">is</span> (tr ++ [x]) = s</span></span></span><br><span><var>Hinit</var><span class="hyp-type"><b>: </b><span>initial_state_prop <span class="kr">is</span></span></span></span><br><span><var>Hobs</var><span class="hyp-type"><b>: </b><span><span class="kr">‚àÄ</span> <span class="nv">m</span> : message,
  trace_has_message (field_selector input) m
    (tr ++ [x]) ‚Üí valid_message_prop X m</span></span></span><br><span><var>IHtr</var><span class="hyp-type"><b>: </b><span>finite_valid_trace_from X <span class="kr">is</span> tr</span></span></span><br><span><var>Hplst</var><span class="hyp-type"><b>: </b><span>valid_state_prop X (finite_trace_last <span class="kr">is</span> tr)</span></span></span><br><span><var>s1</var><span class="hyp-type"><b>: </b><span>state</span></span></span><br><span><var>iom, oom</var><span class="hyp-type"><b>: </b><span>option message</span></span></span><br><span><var>l0</var><span class="hyp-type"><b>: </b><span>label</span></span></span><br><span><var>Htl</var><span class="hyp-type"><b>: </b><span>finite_valid_trace_from_to
  pre_loaded_with_all_messages_vlsm s1 s []</span></span></span><br><span><var>Hv</var><span class="hyp-type"><b>: </b><span>valid l0 (finite_trace_last <span class="kr">is</span> tr, iom)</span></span></span><br><span><var>Ht</var><span class="hyp-type"><b>: </b><span>transition l0 (finite_trace_last <span class="kr">is</span> tr, iom) =
(s1, oom)</span></span></span><br><span><var>H2</var><span class="hyp-type"><b>: </b><span>{|
  l := l0;
  input := iom;
  destination := s1;
  output := oom
|} = x</span></span></span><br></div><label class="goal-separator" for="VLSM-v-chk4a5"><hr></label><div class="goal-conclusion">transition l0 (finite_trace_last <span class="kr">is</span> tr, iom) =
(s1, oom)</div></blockquote></div></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="VLSM-v-chk4a6" style="display: none" type="checkbox"><label class="alectryon-input" for="VLSM-v-chk4a6"><span class="mi">1</span>, <span class="mi">3</span>-<span class="mi">4</span>: <span class="bp">assumption</span>.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>message</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>X</var><span class="hyp-type"><b>: </b><span>VLSM message</span></span></span><br><span><var>is</var><span class="hyp-type"><b>: </b><span>state</span></span></span><br><span><var>x</var><span class="hyp-type"><b>: </b><span>transition_item</span></span></span><br><span><var>tr</var><span class="hyp-type"><b>: </b><span>list transition_item</span></span></span><br><span><var>s</var><span class="hyp-type"><b>: </b><span>state</span></span></span><br><span><var>Htr</var><span class="hyp-type"><b>: </b><span>finite_valid_trace_from_to
  pre_loaded_with_all_messages_vlsm <span class="kr">is</span>
  (finite_trace_last <span class="kr">is</span> tr) tr</span></span></span><br><span><var>Hx</var><span class="hyp-type"><b>: </b><span>finite_valid_trace_from_to
  pre_loaded_with_all_messages_vlsm
  (finite_trace_last <span class="kr">is</span> tr) s [x]</span></span></span><br><span><var>Hlst</var><span class="hyp-type"><b>: </b><span>finite_trace_last <span class="kr">is</span> (tr ++ [x]) = s</span></span></span><br><span><var>Hinit</var><span class="hyp-type"><b>: </b><span>initial_state_prop <span class="kr">is</span></span></span></span><br><span><var>Hobs</var><span class="hyp-type"><b>: </b><span><span class="kr">‚àÄ</span> <span class="nv">m</span> : message,
  trace_has_message (field_selector input) m
    (tr ++ [x]) ‚Üí valid_message_prop X m</span></span></span><br><span><var>IHtr</var><span class="hyp-type"><b>: </b><span>finite_valid_trace_from X <span class="kr">is</span> tr</span></span></span><br><span><var>Hplst</var><span class="hyp-type"><b>: </b><span>valid_state_prop X (finite_trace_last <span class="kr">is</span> tr)</span></span></span><br><span><var>s1</var><span class="hyp-type"><b>: </b><span>state</span></span></span><br><span><var>iom, oom</var><span class="hyp-type"><b>: </b><span>option message</span></span></span><br><span><var>l0</var><span class="hyp-type"><b>: </b><span>label</span></span></span><br><span><var>Htl</var><span class="hyp-type"><b>: </b><span>finite_valid_trace_from_to
  pre_loaded_with_all_messages_vlsm s1 s []</span></span></span><br><span><var>Hv</var><span class="hyp-type"><b>: </b><span>valid l0 (finite_trace_last <span class="kr">is</span> tr, iom)</span></span></span><br><span><var>Ht</var><span class="hyp-type"><b>: </b><span>transition l0 (finite_trace_last <span class="kr">is</span> tr, iom) =
(s1, oom)</span></span></span><br><span><var>H2</var><span class="hyp-type"><b>: </b><span>{|
  l := l0;
  input := iom;
  destination := s1;
  output := oom
|} = x</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">option_valid_message_prop X iom</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">      </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="VLSM-v-chk4a7" style="display: none" type="checkbox"><label class="alectryon-input" for="VLSM-v-chk4a7"><span class="nb">destruct</span> iom <span class="kr">as</span> [m |]; [| <span class="nb">apply</span> option_valid_message_None].</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>message</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>X</var><span class="hyp-type"><b>: </b><span>VLSM message</span></span></span><br><span><var>is</var><span class="hyp-type"><b>: </b><span>state</span></span></span><br><span><var>x</var><span class="hyp-type"><b>: </b><span>transition_item</span></span></span><br><span><var>tr</var><span class="hyp-type"><b>: </b><span>list transition_item</span></span></span><br><span><var>s</var><span class="hyp-type"><b>: </b><span>state</span></span></span><br><span><var>Htr</var><span class="hyp-type"><b>: </b><span>finite_valid_trace_from_to
  pre_loaded_with_all_messages_vlsm <span class="kr">is</span>
  (finite_trace_last <span class="kr">is</span> tr) tr</span></span></span><br><span><var>Hx</var><span class="hyp-type"><b>: </b><span>finite_valid_trace_from_to
  pre_loaded_with_all_messages_vlsm
  (finite_trace_last <span class="kr">is</span> tr) s [x]</span></span></span><br><span><var>Hlst</var><span class="hyp-type"><b>: </b><span>finite_trace_last <span class="kr">is</span> (tr ++ [x]) = s</span></span></span><br><span><var>Hinit</var><span class="hyp-type"><b>: </b><span>initial_state_prop <span class="kr">is</span></span></span></span><br><span><var>Hobs</var><span class="hyp-type"><b>: </b><span><span class="kr">‚àÄ</span> <span class="nv">m</span> : message,
  trace_has_message (field_selector input) m
    (tr ++ [x]) ‚Üí valid_message_prop X m</span></span></span><br><span><var>IHtr</var><span class="hyp-type"><b>: </b><span>finite_valid_trace_from X <span class="kr">is</span> tr</span></span></span><br><span><var>Hplst</var><span class="hyp-type"><b>: </b><span>valid_state_prop X (finite_trace_last <span class="kr">is</span> tr)</span></span></span><br><span><var>s1</var><span class="hyp-type"><b>: </b><span>state</span></span></span><br><span><var>m</var><span class="hyp-type"><b>: </b><span>message</span></span></span><br><span><var>oom</var><span class="hyp-type"><b>: </b><span>option message</span></span></span><br><span><var>l0</var><span class="hyp-type"><b>: </b><span>label</span></span></span><br><span><var>Htl</var><span class="hyp-type"><b>: </b><span>finite_valid_trace_from_to
  pre_loaded_with_all_messages_vlsm s1 s []</span></span></span><br><span><var>Hv</var><span class="hyp-type"><b>: </b><span>valid l0 (finite_trace_last <span class="kr">is</span> tr, Some m)</span></span></span><br><span><var>Ht</var><span class="hyp-type"><b>: </b><span>transition l0 (finite_trace_last <span class="kr">is</span> tr, Some m) =
(s1, oom)</span></span></span><br><span><var>H2</var><span class="hyp-type"><b>: </b><span>{|
  l := l0;
  input := Some m;
  destination := s1;
  output := oom
|} = x</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">option_valid_message_prop X (Some m)</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">      </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="VLSM-v-chk4a8" style="display: none" type="checkbox"><label class="alectryon-input" for="VLSM-v-chk4a8"><span class="nb">apply</span> option_valid_message_Some, Hobs.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>message</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>X</var><span class="hyp-type"><b>: </b><span>VLSM message</span></span></span><br><span><var>is</var><span class="hyp-type"><b>: </b><span>state</span></span></span><br><span><var>x</var><span class="hyp-type"><b>: </b><span>transition_item</span></span></span><br><span><var>tr</var><span class="hyp-type"><b>: </b><span>list transition_item</span></span></span><br><span><var>s</var><span class="hyp-type"><b>: </b><span>state</span></span></span><br><span><var>Htr</var><span class="hyp-type"><b>: </b><span>finite_valid_trace_from_to
  pre_loaded_with_all_messages_vlsm <span class="kr">is</span>
  (finite_trace_last <span class="kr">is</span> tr) tr</span></span></span><br><span><var>Hx</var><span class="hyp-type"><b>: </b><span>finite_valid_trace_from_to
  pre_loaded_with_all_messages_vlsm
  (finite_trace_last <span class="kr">is</span> tr) s [x]</span></span></span><br><span><var>Hlst</var><span class="hyp-type"><b>: </b><span>finite_trace_last <span class="kr">is</span> (tr ++ [x]) = s</span></span></span><br><span><var>Hinit</var><span class="hyp-type"><b>: </b><span>initial_state_prop <span class="kr">is</span></span></span></span><br><span><var>Hobs</var><span class="hyp-type"><b>: </b><span><span class="kr">‚àÄ</span> <span class="nv">m</span> : message,
  trace_has_message (field_selector input) m
    (tr ++ [x]) ‚Üí valid_message_prop X m</span></span></span><br><span><var>IHtr</var><span class="hyp-type"><b>: </b><span>finite_valid_trace_from X <span class="kr">is</span> tr</span></span></span><br><span><var>Hplst</var><span class="hyp-type"><b>: </b><span>valid_state_prop X (finite_trace_last <span class="kr">is</span> tr)</span></span></span><br><span><var>s1</var><span class="hyp-type"><b>: </b><span>state</span></span></span><br><span><var>m</var><span class="hyp-type"><b>: </b><span>message</span></span></span><br><span><var>oom</var><span class="hyp-type"><b>: </b><span>option message</span></span></span><br><span><var>l0</var><span class="hyp-type"><b>: </b><span>label</span></span></span><br><span><var>Htl</var><span class="hyp-type"><b>: </b><span>finite_valid_trace_from_to
  pre_loaded_with_all_messages_vlsm s1 s []</span></span></span><br><span><var>Hv</var><span class="hyp-type"><b>: </b><span>valid l0 (finite_trace_last <span class="kr">is</span> tr, Some m)</span></span></span><br><span><var>Ht</var><span class="hyp-type"><b>: </b><span>transition l0 (finite_trace_last <span class="kr">is</span> tr, Some m) =
(s1, oom)</span></span></span><br><span><var>H2</var><span class="hyp-type"><b>: </b><span>{|
  l := l0;
  input := Some m;
  destination := s1;
  output := oom
|} = x</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">trace_has_message (field_selector input) m (tr ++ [x])</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">      </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="VLSM-v-chk4a9" style="display: none" type="checkbox"><label class="alectryon-input" for="VLSM-v-chk4a9"><span class="nb">red</span>; <span class="nb">rewrite</span> Exists_app, Exists_cons.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>message</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>X</var><span class="hyp-type"><b>: </b><span>VLSM message</span></span></span><br><span><var>is</var><span class="hyp-type"><b>: </b><span>state</span></span></span><br><span><var>x</var><span class="hyp-type"><b>: </b><span>transition_item</span></span></span><br><span><var>tr</var><span class="hyp-type"><b>: </b><span>list transition_item</span></span></span><br><span><var>s</var><span class="hyp-type"><b>: </b><span>state</span></span></span><br><span><var>Htr</var><span class="hyp-type"><b>: </b><span>finite_valid_trace_from_to
  pre_loaded_with_all_messages_vlsm <span class="kr">is</span>
  (finite_trace_last <span class="kr">is</span> tr) tr</span></span></span><br><span><var>Hx</var><span class="hyp-type"><b>: </b><span>finite_valid_trace_from_to
  pre_loaded_with_all_messages_vlsm
  (finite_trace_last <span class="kr">is</span> tr) s [x]</span></span></span><br><span><var>Hlst</var><span class="hyp-type"><b>: </b><span>finite_trace_last <span class="kr">is</span> (tr ++ [x]) = s</span></span></span><br><span><var>Hinit</var><span class="hyp-type"><b>: </b><span>initial_state_prop <span class="kr">is</span></span></span></span><br><span><var>Hobs</var><span class="hyp-type"><b>: </b><span><span class="kr">‚àÄ</span> <span class="nv">m</span> : message,
  trace_has_message (field_selector input) m
    (tr ++ [x]) ‚Üí valid_message_prop X m</span></span></span><br><span><var>IHtr</var><span class="hyp-type"><b>: </b><span>finite_valid_trace_from X <span class="kr">is</span> tr</span></span></span><br><span><var>Hplst</var><span class="hyp-type"><b>: </b><span>valid_state_prop X (finite_trace_last <span class="kr">is</span> tr)</span></span></span><br><span><var>s1</var><span class="hyp-type"><b>: </b><span>state</span></span></span><br><span><var>m</var><span class="hyp-type"><b>: </b><span>message</span></span></span><br><span><var>oom</var><span class="hyp-type"><b>: </b><span>option message</span></span></span><br><span><var>l0</var><span class="hyp-type"><b>: </b><span>label</span></span></span><br><span><var>Htl</var><span class="hyp-type"><b>: </b><span>finite_valid_trace_from_to
  pre_loaded_with_all_messages_vlsm s1 s []</span></span></span><br><span><var>Hv</var><span class="hyp-type"><b>: </b><span>valid l0 (finite_trace_last <span class="kr">is</span> tr, Some m)</span></span></span><br><span><var>Ht</var><span class="hyp-type"><b>: </b><span>transition l0 (finite_trace_last <span class="kr">is</span> tr, Some m) =
(s1, oom)</span></span></span><br><span><var>H2</var><span class="hyp-type"><b>: </b><span>{|
  l := l0;
  input := Some m;
  destination := s1;
  output := oom
|} = x</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">List.Exists (field_selector input m) tr
‚à® field_selector input m x
  ‚à® List.Exists (field_selector input m) []</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">      </span><span class="alectryon-sentence"><span class="alectryon-input"><span class="nb">subst</span>; <span class="nb">cbn</span>; <span class="nb">intuition</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Qed</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
</span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">End</span> <span class="nf">pre_loaded_with_all_messages_vlsm</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
</span><span class="alectryon-sentence"><input class="alectryon-toggle" id="VLSM-v-chk4aa" style="display: none" type="checkbox"><label class="alectryon-input" for="VLSM-v-chk4aa"><span class="kn">Lemma</span> <span class="nf">non_empty_valid_trace_from_can_produce</span>
  `(X : VLSM message)
  (s : state)
  (m : message)
  : can_produce X s m
  &lt;-&gt; <span class="kr">exists</span> (<span class="nv">is</span> : state) (<span class="nv">tr</span> : list transition_item) (<span class="nv">item</span> : transition_item),
    finite_valid_trace X <span class="kr">is</span> tr /\
    last_error tr = Some item /\
    destination item = s /\ output item = Some m.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>message</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>X</var><span class="hyp-type"><b>: </b><span>VLSM message</span></span></span><br><span><var>s</var><span class="hyp-type"><b>: </b><span>state</span></span></span><br><span><var>m</var><span class="hyp-type"><b>: </b><span>message</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">can_produce X s m
‚Üî (<span class="kr">‚àÉ</span> (<span class="nv">is</span> : state) (<span class="nv">tr</span> : list transition_item) (<span class="nv">item</span> : transition_item),
     finite_valid_trace X <span class="kr">is</span> tr
     ‚àß last_error tr = Some item
       ‚àß destination item = s ‚àß output item = Some m)</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="VLSM-v-chk4ab" style="display: none" type="checkbox"><label class="alectryon-input" for="VLSM-v-chk4ab"><span class="kn">Proof</span>.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>message</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>X</var><span class="hyp-type"><b>: </b><span>VLSM message</span></span></span><br><span><var>s</var><span class="hyp-type"><b>: </b><span>state</span></span></span><br><span><var>m</var><span class="hyp-type"><b>: </b><span>message</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">can_produce X s m
‚Üî (<span class="kr">‚àÉ</span> (<span class="nv">is</span> : state) (<span class="nv">tr</span> : list transition_item) (<span class="nv">item</span> : transition_item),
     finite_valid_trace X <span class="kr">is</span> tr
     ‚àß last_error tr = Some item
       ‚àß destination item = s ‚àß output item = Some m)</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="VLSM-v-chk4ac" style="display: none" type="checkbox"><label class="alectryon-input" for="VLSM-v-chk4ac"><span class="nb">split</span>.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>message</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>X</var><span class="hyp-type"><b>: </b><span>VLSM message</span></span></span><br><span><var>s</var><span class="hyp-type"><b>: </b><span>state</span></span></span><br><span><var>m</var><span class="hyp-type"><b>: </b><span>message</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">can_produce X s m
‚Üí <span class="kr">‚àÉ</span> (<span class="nv">is</span> : state) (<span class="nv">tr</span> : list transition_item) (<span class="nv">item</span> : transition_item),
    finite_valid_trace X <span class="kr">is</span> tr
    ‚àß last_error tr = Some item
      ‚àß destination item = s ‚àß output item = Some m</div></blockquote><div class="alectryon-extra-goals"><input class="alectryon-extra-goal-toggle" id="VLSM-v-chk4ad" style="display: none" type="checkbox"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>message</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>X</var><span class="hyp-type"><b>: </b><span>VLSM message</span></span></span><br><span><var>s</var><span class="hyp-type"><b>: </b><span>state</span></span></span><br><span><var>m</var><span class="hyp-type"><b>: </b><span>message</span></span></span><br></div><label class="goal-separator" for="VLSM-v-chk4ad"><hr></label><div class="goal-conclusion">(<span class="kr">‚àÉ</span> (<span class="nv">is</span> : state) (<span class="nv">tr</span> : list transition_item) 
   (<span class="nv">item</span> : transition_item),
   finite_valid_trace X <span class="kr">is</span> tr
   ‚àß last_error tr = Some item
     ‚àß destination item = s ‚àß output item = Some m)
‚Üí can_produce X s m</div></blockquote></div></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="VLSM-v-chk4ae" style="display: none" type="checkbox"><label class="alectryon-input" for="VLSM-v-chk4ae">-</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>message</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>X</var><span class="hyp-type"><b>: </b><span>VLSM message</span></span></span><br><span><var>s</var><span class="hyp-type"><b>: </b><span>state</span></span></span><br><span><var>m</var><span class="hyp-type"><b>: </b><span>message</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">can_produce X s m
‚Üí <span class="kr">‚àÉ</span> (<span class="nv">is</span> : state) (<span class="nv">tr</span> : list transition_item) (<span class="nv">item</span> : transition_item),
    finite_valid_trace X <span class="kr">is</span> tr
    ‚àß last_error tr = Some item
      ‚àß destination item = s ‚àß output item = Some m</div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="VLSM-v-chk4af" style="display: none" type="checkbox"><label class="alectryon-input" for="VLSM-v-chk4af"><span class="nb">intros</span> [(s&#39;, om&#39;) [l Hsm]].</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>message</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>X</var><span class="hyp-type"><b>: </b><span>VLSM message</span></span></span><br><span><var>s</var><span class="hyp-type"><b>: </b><span>state</span></span></span><br><span><var>m</var><span class="hyp-type"><b>: </b><span>message</span></span></span><br><span><var>s'</var><span class="hyp-type"><b>: </b><span>state</span></span></span><br><span><var>om'</var><span class="hyp-type"><b>: </b><span>option message</span></span></span><br><span><var>l</var><span class="hyp-type"><b>: </b><span>label</span></span></span><br><span><var>Hsm</var><span class="hyp-type"><b>: </b><span>input_valid_transition X l (s&#39;, om&#39;) (s, Some m)</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="kr">‚àÉ</span> (<span class="nv">is</span> : state) (<span class="nv">tr</span> : list transition_item) (<span class="nv">item</span> : transition_item),
  finite_valid_trace X <span class="kr">is</span> tr
  ‚àß last_error tr = Some item
    ‚àß destination item = s ‚àß output item = Some m</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="VLSM-v-chk4b0" style="display: none" type="checkbox"><label class="alectryon-input" for="VLSM-v-chk4b0"><span class="nb">destruct</span> (id Hsm) <span class="kr">as</span> [[Hp _] _].</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>message</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>X</var><span class="hyp-type"><b>: </b><span>VLSM message</span></span></span><br><span><var>s</var><span class="hyp-type"><b>: </b><span>state</span></span></span><br><span><var>m</var><span class="hyp-type"><b>: </b><span>message</span></span></span><br><span><var>s'</var><span class="hyp-type"><b>: </b><span>state</span></span></span><br><span><var>om'</var><span class="hyp-type"><b>: </b><span>option message</span></span></span><br><span><var>l</var><span class="hyp-type"><b>: </b><span>label</span></span></span><br><span><var>Hsm</var><span class="hyp-type"><b>: </b><span>input_valid_transition X l (s&#39;, om&#39;) (s, Some m)</span></span></span><br><span><var>Hp</var><span class="hyp-type"><b>: </b><span>valid_state_prop X s&#39;</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="kr">‚àÉ</span> (<span class="nv">is</span> : state) (<span class="nv">tr</span> : list transition_item) (<span class="nv">item</span> : transition_item),
  finite_valid_trace X <span class="kr">is</span> tr
  ‚àß last_error tr = Some item
    ‚àß destination item = s ‚àß output item = Some m</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="VLSM-v-chk4b1" style="display: none" type="checkbox"><label class="alectryon-input" for="VLSM-v-chk4b1"><span class="nb">pose proof</span> (finite_valid_trace_singleton _ Hsm) <span class="kr">as</span> Htr.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>message</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>X</var><span class="hyp-type"><b>: </b><span>VLSM message</span></span></span><br><span><var>s</var><span class="hyp-type"><b>: </b><span>state</span></span></span><br><span><var>m</var><span class="hyp-type"><b>: </b><span>message</span></span></span><br><span><var>s'</var><span class="hyp-type"><b>: </b><span>state</span></span></span><br><span><var>om'</var><span class="hyp-type"><b>: </b><span>option message</span></span></span><br><span><var>l</var><span class="hyp-type"><b>: </b><span>label</span></span></span><br><span><var>Hsm</var><span class="hyp-type"><b>: </b><span>input_valid_transition X l (s&#39;, om&#39;) (s, Some m)</span></span></span><br><span><var>Hp</var><span class="hyp-type"><b>: </b><span>valid_state_prop X s&#39;</span></span></span><br><span><var>Htr</var><span class="hyp-type"><b>: </b><span>finite_valid_trace_from X s&#39;
  [{|
     l := l;
     input := om&#39;;
     destination := s;
     output := Some m
   |}]</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="kr">‚àÉ</span> (<span class="nv">is</span> : state) (<span class="nv">tr</span> : list transition_item) (<span class="nv">item</span> : transition_item),
  finite_valid_trace X <span class="kr">is</span> tr
  ‚àß last_error tr = Some item
    ‚àß destination item = s ‚àß output item = Some m</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="VLSM-v-chk4b2" style="display: none" type="checkbox"><label class="alectryon-input" for="VLSM-v-chk4b2"><span class="nb">apply</span> finite_valid_trace_from_complete_left <span class="kr">in</span> Htr.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>message</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>X</var><span class="hyp-type"><b>: </b><span>VLSM message</span></span></span><br><span><var>s</var><span class="hyp-type"><b>: </b><span>state</span></span></span><br><span><var>m</var><span class="hyp-type"><b>: </b><span>message</span></span></span><br><span><var>s'</var><span class="hyp-type"><b>: </b><span>state</span></span></span><br><span><var>om'</var><span class="hyp-type"><b>: </b><span>option message</span></span></span><br><span><var>l</var><span class="hyp-type"><b>: </b><span>label</span></span></span><br><span><var>Hsm</var><span class="hyp-type"><b>: </b><span>input_valid_transition X l (s&#39;, om&#39;) (s, Some m)</span></span></span><br><span><var>Hp</var><span class="hyp-type"><b>: </b><span>valid_state_prop X s&#39;</span></span></span><br><span><var>Htr</var><span class="hyp-type"><b>: </b><span><span class="kr">‚àÉ</span> (<span class="nv">is</span> : state) (<span class="nv">trs</span> : list transition_item),
  finite_valid_trace X <span class="kr">is</span>
    (trs ++
     [{|
        l := l;
        input := om&#39;;
        destination := s;
        output := Some m
      |}]) ‚àß finite_trace_last <span class="kr">is</span> trs = s&#39;</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="kr">‚àÉ</span> (<span class="nv">is</span> : state) (<span class="nv">tr</span> : list transition_item) (<span class="nv">item</span> : transition_item),
  finite_valid_trace X <span class="kr">is</span> tr
  ‚àß last_error tr = Some item
    ‚àß destination item = s ‚àß output item = Some m</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="VLSM-v-chk4b3" style="display: none" type="checkbox"><label class="alectryon-input" for="VLSM-v-chk4b3"><span class="nb">destruct</span>  Htr <span class="kr">as</span> [<span class="kr">is</span> [trs [Htrs _]]].</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>message</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>X</var><span class="hyp-type"><b>: </b><span>VLSM message</span></span></span><br><span><var>s</var><span class="hyp-type"><b>: </b><span>state</span></span></span><br><span><var>m</var><span class="hyp-type"><b>: </b><span>message</span></span></span><br><span><var>s'</var><span class="hyp-type"><b>: </b><span>state</span></span></span><br><span><var>om'</var><span class="hyp-type"><b>: </b><span>option message</span></span></span><br><span><var>l</var><span class="hyp-type"><b>: </b><span>label</span></span></span><br><span><var>Hsm</var><span class="hyp-type"><b>: </b><span>input_valid_transition X l (s&#39;, om&#39;) (s, Some m)</span></span></span><br><span><var>Hp</var><span class="hyp-type"><b>: </b><span>valid_state_prop X s&#39;</span></span></span><br><span><var>is</var><span class="hyp-type"><b>: </b><span>state</span></span></span><br><span><var>trs</var><span class="hyp-type"><b>: </b><span>list transition_item</span></span></span><br><span><var>Htrs</var><span class="hyp-type"><b>: </b><span>finite_valid_trace X <span class="kr">is</span>
  (trs ++
   [{|
      l := l;
      input := om&#39;;
      destination := s;
      output := Some m
    |}])</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="kr">‚àÉ</span> (<span class="nv">is</span> : state) (<span class="nv">tr</span> : list transition_item) (<span class="nv">item</span> : transition_item),
  finite_valid_trace X <span class="kr">is</span> tr
  ‚àß last_error tr = Some item
    ‚àß destination item = s ‚àß output item = Some m</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="VLSM-v-chk4b4" style="display: none" type="checkbox"><label class="alectryon-input" for="VLSM-v-chk4b4"><span class="kr">exists</span> <span class="nv">is</span>.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>message</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>X</var><span class="hyp-type"><b>: </b><span>VLSM message</span></span></span><br><span><var>s</var><span class="hyp-type"><b>: </b><span>state</span></span></span><br><span><var>m</var><span class="hyp-type"><b>: </b><span>message</span></span></span><br><span><var>s'</var><span class="hyp-type"><b>: </b><span>state</span></span></span><br><span><var>om'</var><span class="hyp-type"><b>: </b><span>option message</span></span></span><br><span><var>l</var><span class="hyp-type"><b>: </b><span>label</span></span></span><br><span><var>Hsm</var><span class="hyp-type"><b>: </b><span>input_valid_transition X l (s&#39;, om&#39;) (s, Some m)</span></span></span><br><span><var>Hp</var><span class="hyp-type"><b>: </b><span>valid_state_prop X s&#39;</span></span></span><br><span><var>is</var><span class="hyp-type"><b>: </b><span>state</span></span></span><br><span><var>trs</var><span class="hyp-type"><b>: </b><span>list transition_item</span></span></span><br><span><var>Htrs</var><span class="hyp-type"><b>: </b><span>finite_valid_trace X <span class="kr">is</span>
  (trs ++
   [{|
      l := l;
      input := om&#39;;
      destination := s;
      output := Some m
    |}])</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="kr">‚àÉ</span> (<span class="nv">tr</span> : list transition_item) (<span class="nv">item</span> : transition_item),
  finite_valid_trace X <span class="kr">is</span> tr
  ‚àß last_error tr = Some item
    ‚àß destination item = s ‚àß output item = Some m</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="VLSM-v-chk4b5" style="display: none" type="checkbox"><label class="alectryon-input" for="VLSM-v-chk4b5"><span class="kr">match</span> <span class="kp">type of</span> Htrs <span class="kr">with</span>
    | <span class="kp">context</span> [_ ++ [<span class="nl">?item</span>]] =&gt; <span class="nb">remember</span> item <span class="kr">as</span> lstitem
    <span class="kr">end</span>.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>message</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>X</var><span class="hyp-type"><b>: </b><span>VLSM message</span></span></span><br><span><var>s</var><span class="hyp-type"><b>: </b><span>state</span></span></span><br><span><var>m</var><span class="hyp-type"><b>: </b><span>message</span></span></span><br><span><var>s'</var><span class="hyp-type"><b>: </b><span>state</span></span></span><br><span><var>om'</var><span class="hyp-type"><b>: </b><span>option message</span></span></span><br><span><var>l</var><span class="hyp-type"><b>: </b><span>label</span></span></span><br><span><var>Hsm</var><span class="hyp-type"><b>: </b><span>input_valid_transition X l (s&#39;, om&#39;) (s, Some m)</span></span></span><br><span><var>Hp</var><span class="hyp-type"><b>: </b><span>valid_state_prop X s&#39;</span></span></span><br><span><var>is</var><span class="hyp-type"><b>: </b><span>state</span></span></span><br><span><var>trs</var><span class="hyp-type"><b>: </b><span>list transition_item</span></span></span><br><span><var>lstitem</var><span class="hyp-type"><b>: </b><span>transition_item</span></span></span><br><span><var>Heqlstitem</var><span class="hyp-type"><b>: </b><span>lstitem =
{|
  l := l;
  input := om&#39;;
  destination := s;
  output := Some m
|}</span></span></span><br><span><var>Htrs</var><span class="hyp-type"><b>: </b><span>finite_valid_trace X <span class="kr">is</span> (trs ++ [lstitem])</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="kr">‚àÉ</span> (<span class="nv">tr</span> : list transition_item) (<span class="nv">item</span> : transition_item),
  finite_valid_trace X <span class="kr">is</span> tr
  ‚àß last_error tr = Some item
    ‚àß destination item = s ‚àß output item = Some m</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="VLSM-v-chk4b6" style="display: none" type="checkbox"><label class="alectryon-input" for="VLSM-v-chk4b6"><span class="kr">exists</span> (<span class="nv">trs</span> ++ [lstitem]).</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>message</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>X</var><span class="hyp-type"><b>: </b><span>VLSM message</span></span></span><br><span><var>s</var><span class="hyp-type"><b>: </b><span>state</span></span></span><br><span><var>m</var><span class="hyp-type"><b>: </b><span>message</span></span></span><br><span><var>s'</var><span class="hyp-type"><b>: </b><span>state</span></span></span><br><span><var>om'</var><span class="hyp-type"><b>: </b><span>option message</span></span></span><br><span><var>l</var><span class="hyp-type"><b>: </b><span>label</span></span></span><br><span><var>Hsm</var><span class="hyp-type"><b>: </b><span>input_valid_transition X l (s&#39;, om&#39;) (s, Some m)</span></span></span><br><span><var>Hp</var><span class="hyp-type"><b>: </b><span>valid_state_prop X s&#39;</span></span></span><br><span><var>is</var><span class="hyp-type"><b>: </b><span>state</span></span></span><br><span><var>trs</var><span class="hyp-type"><b>: </b><span>list transition_item</span></span></span><br><span><var>lstitem</var><span class="hyp-type"><b>: </b><span>transition_item</span></span></span><br><span><var>Heqlstitem</var><span class="hyp-type"><b>: </b><span>lstitem =
{|
  l := l;
  input := om&#39;;
  destination := s;
  output := Some m
|}</span></span></span><br><span><var>Htrs</var><span class="hyp-type"><b>: </b><span>finite_valid_trace X <span class="kr">is</span> (trs ++ [lstitem])</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="kr">‚àÉ</span> <span class="nv">item</span> : transition_item,
  finite_valid_trace X <span class="kr">is</span> (trs ++ [lstitem])
  ‚àß last_error (trs ++ [lstitem]) = Some item
    ‚àß destination item = s ‚àß output item = Some m</div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="VLSM-v-chk4b7" style="display: none" type="checkbox"><label class="alectryon-input" for="VLSM-v-chk4b7"><span class="kr">exists</span> <span class="nv">lstitem</span>.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>message</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>X</var><span class="hyp-type"><b>: </b><span>VLSM message</span></span></span><br><span><var>s</var><span class="hyp-type"><b>: </b><span>state</span></span></span><br><span><var>m</var><span class="hyp-type"><b>: </b><span>message</span></span></span><br><span><var>s'</var><span class="hyp-type"><b>: </b><span>state</span></span></span><br><span><var>om'</var><span class="hyp-type"><b>: </b><span>option message</span></span></span><br><span><var>l</var><span class="hyp-type"><b>: </b><span>label</span></span></span><br><span><var>Hsm</var><span class="hyp-type"><b>: </b><span>input_valid_transition X l (s&#39;, om&#39;) (s, Some m)</span></span></span><br><span><var>Hp</var><span class="hyp-type"><b>: </b><span>valid_state_prop X s&#39;</span></span></span><br><span><var>is</var><span class="hyp-type"><b>: </b><span>state</span></span></span><br><span><var>trs</var><span class="hyp-type"><b>: </b><span>list transition_item</span></span></span><br><span><var>lstitem</var><span class="hyp-type"><b>: </b><span>transition_item</span></span></span><br><span><var>Heqlstitem</var><span class="hyp-type"><b>: </b><span>lstitem =
{|
  l := l;
  input := om&#39;;
  destination := s;
  output := Some m
|}</span></span></span><br><span><var>Htrs</var><span class="hyp-type"><b>: </b><span>finite_valid_trace X <span class="kr">is</span> (trs ++ [lstitem])</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">finite_valid_trace X <span class="kr">is</span> (trs ++ [lstitem])
‚àß last_error (trs ++ [lstitem]) = Some lstitem
  ‚àß destination lstitem = s ‚àß output lstitem = Some m</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="VLSM-v-chk4b8" style="display: none" type="checkbox"><label class="alectryon-input" for="VLSM-v-chk4b8"><span class="nb">split</span>; [<span class="bp">assumption</span>|].</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>message</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>X</var><span class="hyp-type"><b>: </b><span>VLSM message</span></span></span><br><span><var>s</var><span class="hyp-type"><b>: </b><span>state</span></span></span><br><span><var>m</var><span class="hyp-type"><b>: </b><span>message</span></span></span><br><span><var>s'</var><span class="hyp-type"><b>: </b><span>state</span></span></span><br><span><var>om'</var><span class="hyp-type"><b>: </b><span>option message</span></span></span><br><span><var>l</var><span class="hyp-type"><b>: </b><span>label</span></span></span><br><span><var>Hsm</var><span class="hyp-type"><b>: </b><span>input_valid_transition X l (s&#39;, om&#39;) (s, Some m)</span></span></span><br><span><var>Hp</var><span class="hyp-type"><b>: </b><span>valid_state_prop X s&#39;</span></span></span><br><span><var>is</var><span class="hyp-type"><b>: </b><span>state</span></span></span><br><span><var>trs</var><span class="hyp-type"><b>: </b><span>list transition_item</span></span></span><br><span><var>lstitem</var><span class="hyp-type"><b>: </b><span>transition_item</span></span></span><br><span><var>Heqlstitem</var><span class="hyp-type"><b>: </b><span>lstitem =
{|
  l := l;
  input := om&#39;;
  destination := s;
  output := Some m
|}</span></span></span><br><span><var>Htrs</var><span class="hyp-type"><b>: </b><span>finite_valid_trace X <span class="kr">is</span> (trs ++ [lstitem])</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">last_error (trs ++ [lstitem]) = Some lstitem
‚àß destination lstitem = s ‚àß output lstitem = Some m</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="VLSM-v-chk4b9" style="display: none" type="checkbox"><label class="alectryon-input" for="VLSM-v-chk4b9"><span class="nb">split</span>; [<span class="nb">apply</span> last_error_is_last|].</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>message</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>X</var><span class="hyp-type"><b>: </b><span>VLSM message</span></span></span><br><span><var>s</var><span class="hyp-type"><b>: </b><span>state</span></span></span><br><span><var>m</var><span class="hyp-type"><b>: </b><span>message</span></span></span><br><span><var>s'</var><span class="hyp-type"><b>: </b><span>state</span></span></span><br><span><var>om'</var><span class="hyp-type"><b>: </b><span>option message</span></span></span><br><span><var>l</var><span class="hyp-type"><b>: </b><span>label</span></span></span><br><span><var>Hsm</var><span class="hyp-type"><b>: </b><span>input_valid_transition X l (s&#39;, om&#39;) (s, Some m)</span></span></span><br><span><var>Hp</var><span class="hyp-type"><b>: </b><span>valid_state_prop X s&#39;</span></span></span><br><span><var>is</var><span class="hyp-type"><b>: </b><span>state</span></span></span><br><span><var>trs</var><span class="hyp-type"><b>: </b><span>list transition_item</span></span></span><br><span><var>lstitem</var><span class="hyp-type"><b>: </b><span>transition_item</span></span></span><br><span><var>Heqlstitem</var><span class="hyp-type"><b>: </b><span>lstitem =
{|
  l := l;
  input := om&#39;;
  destination := s;
  output := Some m
|}</span></span></span><br><span><var>Htrs</var><span class="hyp-type"><b>: </b><span>finite_valid_trace X <span class="kr">is</span> (trs ++ [lstitem])</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">destination lstitem = s ‚àß output lstitem = Some m</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="VLSM-v-chk4ba" style="display: none" type="checkbox"><label class="alectryon-input" for="VLSM-v-chk4ba"><span class="nb">subst</span> lstitem.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>message</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>X</var><span class="hyp-type"><b>: </b><span>VLSM message</span></span></span><br><span><var>s</var><span class="hyp-type"><b>: </b><span>state</span></span></span><br><span><var>m</var><span class="hyp-type"><b>: </b><span>message</span></span></span><br><span><var>s'</var><span class="hyp-type"><b>: </b><span>state</span></span></span><br><span><var>om'</var><span class="hyp-type"><b>: </b><span>option message</span></span></span><br><span><var>l</var><span class="hyp-type"><b>: </b><span>label</span></span></span><br><span><var>Hsm</var><span class="hyp-type"><b>: </b><span>input_valid_transition X l (s&#39;, om&#39;) (s, Some m)</span></span></span><br><span><var>Hp</var><span class="hyp-type"><b>: </b><span>valid_state_prop X s&#39;</span></span></span><br><span><var>is</var><span class="hyp-type"><b>: </b><span>state</span></span></span><br><span><var>trs</var><span class="hyp-type"><b>: </b><span>list transition_item</span></span></span><br><span><var>Htrs</var><span class="hyp-type"><b>: </b><span>finite_valid_trace X <span class="kr">is</span>
  (trs ++
   [{|
      l := l;
      input := om&#39;;
      destination := s;
      output := Some m
    |}])</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">destination
  {|
    l := l;
    input := om&#39;;
    destination := s;
    output := Some m
  |} = s
‚àß output
    {|
      l := l;
      input := om&#39;;
      destination := s;
      output := Some m
    |} = Some m</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><span class="alectryon-input"><span class="nb">split</span>; <span class="bp">reflexivity</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="VLSM-v-chk4bb" style="display: none" type="checkbox"><label class="alectryon-input" for="VLSM-v-chk4bb">-</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>message</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>X</var><span class="hyp-type"><b>: </b><span>VLSM message</span></span></span><br><span><var>s</var><span class="hyp-type"><b>: </b><span>state</span></span></span><br><span><var>m</var><span class="hyp-type"><b>: </b><span>message</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">(<span class="kr">‚àÉ</span> (<span class="nv">is</span> : state) (<span class="nv">tr</span> : list transition_item) (<span class="nv">item</span> : transition_item),
   finite_valid_trace X <span class="kr">is</span> tr
   ‚àß last_error tr = Some item
     ‚àß destination item = s ‚àß output item = Some m)
‚Üí can_produce X s m</div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="VLSM-v-chk4bc" style="display: none" type="checkbox"><label class="alectryon-input" for="VLSM-v-chk4bc"><span class="nb">intros</span> [<span class="kr">is</span> [tr [item [Htr [Hitem [Hs Hm]]]]]].</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>message</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>X</var><span class="hyp-type"><b>: </b><span>VLSM message</span></span></span><br><span><var>s</var><span class="hyp-type"><b>: </b><span>state</span></span></span><br><span><var>m</var><span class="hyp-type"><b>: </b><span>message</span></span></span><br><span><var>is</var><span class="hyp-type"><b>: </b><span>state</span></span></span><br><span><var>tr</var><span class="hyp-type"><b>: </b><span>list transition_item</span></span></span><br><span><var>item</var><span class="hyp-type"><b>: </b><span>transition_item</span></span></span><br><span><var>Htr</var><span class="hyp-type"><b>: </b><span>finite_valid_trace X <span class="kr">is</span> tr</span></span></span><br><span><var>Hitem</var><span class="hyp-type"><b>: </b><span>last_error tr = Some item</span></span></span><br><span><var>Hs</var><span class="hyp-type"><b>: </b><span>destination item = s</span></span></span><br><span><var>Hm</var><span class="hyp-type"><b>: </b><span>output item = Some m</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">can_produce X s m</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="VLSM-v-chk4bd" style="display: none" type="checkbox"><label class="alectryon-input" for="VLSM-v-chk4bd">destruct_list_last tr tr&#39; item&#39; Heq; [<span class="nb">inversion</span> Hitem|].</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>message</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>X</var><span class="hyp-type"><b>: </b><span>VLSM message</span></span></span><br><span><var>s</var><span class="hyp-type"><b>: </b><span>state</span></span></span><br><span><var>m</var><span class="hyp-type"><b>: </b><span>message</span></span></span><br><span><var>is</var><span class="hyp-type"><b>: </b><span>state</span></span></span><br><span><var>tr</var><span class="hyp-type"><b>: </b><span>list transition_item</span></span></span><br><span><var>item</var><span class="hyp-type"><b>: </b><span>transition_item</span></span></span><br><span><var>tr'</var><span class="hyp-type"><b>: </b><span>list transition_item</span></span></span><br><span><var>item'</var><span class="hyp-type"><b>: </b><span>transition_item</span></span></span><br><span><var>Htr</var><span class="hyp-type"><b>: </b><span>finite_valid_trace X <span class="kr">is</span> (tr&#39; ++ [item&#39;])</span></span></span><br><span><var>Hitem</var><span class="hyp-type"><b>: </b><span>last_error (tr&#39; ++ [item&#39;]) = Some item</span></span></span><br><span><var>Hs</var><span class="hyp-type"><b>: </b><span>destination item = s</span></span></span><br><span><var>Hm</var><span class="hyp-type"><b>: </b><span>output item = Some m</span></span></span><br><span><var>Heq</var><span class="hyp-type"><b>: </b><span>tr = tr&#39; ++ [item&#39;]</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">can_produce X s m</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="VLSM-v-chk4be" style="display: none" type="checkbox"><label class="alectryon-input" for="VLSM-v-chk4be"><span class="nb">clear</span> Heq.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>message</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>X</var><span class="hyp-type"><b>: </b><span>VLSM message</span></span></span><br><span><var>s</var><span class="hyp-type"><b>: </b><span>state</span></span></span><br><span><var>m</var><span class="hyp-type"><b>: </b><span>message</span></span></span><br><span><var>is</var><span class="hyp-type"><b>: </b><span>state</span></span></span><br><span><var>tr</var><span class="hyp-type"><b>: </b><span>list transition_item</span></span></span><br><span><var>item</var><span class="hyp-type"><b>: </b><span>transition_item</span></span></span><br><span><var>tr'</var><span class="hyp-type"><b>: </b><span>list transition_item</span></span></span><br><span><var>item'</var><span class="hyp-type"><b>: </b><span>transition_item</span></span></span><br><span><var>Htr</var><span class="hyp-type"><b>: </b><span>finite_valid_trace X <span class="kr">is</span> (tr&#39; ++ [item&#39;])</span></span></span><br><span><var>Hitem</var><span class="hyp-type"><b>: </b><span>last_error (tr&#39; ++ [item&#39;]) = Some item</span></span></span><br><span><var>Hs</var><span class="hyp-type"><b>: </b><span>destination item = s</span></span></span><br><span><var>Hm</var><span class="hyp-type"><b>: </b><span>output item = Some m</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">can_produce X s m</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="VLSM-v-chk4bf" style="display: none" type="checkbox"><label class="alectryon-input" for="VLSM-v-chk4bf"><span class="nb">rewrite</span> last_error_is_last <span class="kr">in</span> Hitem.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>message</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>X</var><span class="hyp-type"><b>: </b><span>VLSM message</span></span></span><br><span><var>s</var><span class="hyp-type"><b>: </b><span>state</span></span></span><br><span><var>m</var><span class="hyp-type"><b>: </b><span>message</span></span></span><br><span><var>is</var><span class="hyp-type"><b>: </b><span>state</span></span></span><br><span><var>tr</var><span class="hyp-type"><b>: </b><span>list transition_item</span></span></span><br><span><var>item</var><span class="hyp-type"><b>: </b><span>transition_item</span></span></span><br><span><var>tr'</var><span class="hyp-type"><b>: </b><span>list transition_item</span></span></span><br><span><var>item'</var><span class="hyp-type"><b>: </b><span>transition_item</span></span></span><br><span><var>Htr</var><span class="hyp-type"><b>: </b><span>finite_valid_trace X <span class="kr">is</span> (tr&#39; ++ [item&#39;])</span></span></span><br><span><var>Hitem</var><span class="hyp-type"><b>: </b><span>Some item&#39; = Some item</span></span></span><br><span><var>Hs</var><span class="hyp-type"><b>: </b><span>destination item = s</span></span></span><br><span><var>Hm</var><span class="hyp-type"><b>: </b><span>output item = Some m</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">can_produce X s m</div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="VLSM-v-chk4c0" style="display: none" type="checkbox"><label class="alectryon-input" for="VLSM-v-chk4c0"><span class="nb">inversion</span> Hitem.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>message</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>X</var><span class="hyp-type"><b>: </b><span>VLSM message</span></span></span><br><span><var>s</var><span class="hyp-type"><b>: </b><span>state</span></span></span><br><span><var>m</var><span class="hyp-type"><b>: </b><span>message</span></span></span><br><span><var>is</var><span class="hyp-type"><b>: </b><span>state</span></span></span><br><span><var>tr</var><span class="hyp-type"><b>: </b><span>list transition_item</span></span></span><br><span><var>item</var><span class="hyp-type"><b>: </b><span>transition_item</span></span></span><br><span><var>tr'</var><span class="hyp-type"><b>: </b><span>list transition_item</span></span></span><br><span><var>item'</var><span class="hyp-type"><b>: </b><span>transition_item</span></span></span><br><span><var>Htr</var><span class="hyp-type"><b>: </b><span>finite_valid_trace X <span class="kr">is</span> (tr&#39; ++ [item&#39;])</span></span></span><br><span><var>Hitem</var><span class="hyp-type"><b>: </b><span>Some item&#39; = Some item</span></span></span><br><span><var>Hs</var><span class="hyp-type"><b>: </b><span>destination item = s</span></span></span><br><span><var>Hm</var><span class="hyp-type"><b>: </b><span>output item = Some m</span></span></span><br><span><var>H0</var><span class="hyp-type"><b>: </b><span>item&#39; = item</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">can_produce X s m</div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="VLSM-v-chk4c1" style="display: none" type="checkbox"><label class="alectryon-input" for="VLSM-v-chk4c1"><span class="nb">clear</span> Hitem.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>message</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>X</var><span class="hyp-type"><b>: </b><span>VLSM message</span></span></span><br><span><var>s</var><span class="hyp-type"><b>: </b><span>state</span></span></span><br><span><var>m</var><span class="hyp-type"><b>: </b><span>message</span></span></span><br><span><var>is</var><span class="hyp-type"><b>: </b><span>state</span></span></span><br><span><var>tr</var><span class="hyp-type"><b>: </b><span>list transition_item</span></span></span><br><span><var>item</var><span class="hyp-type"><b>: </b><span>transition_item</span></span></span><br><span><var>tr'</var><span class="hyp-type"><b>: </b><span>list transition_item</span></span></span><br><span><var>item'</var><span class="hyp-type"><b>: </b><span>transition_item</span></span></span><br><span><var>Htr</var><span class="hyp-type"><b>: </b><span>finite_valid_trace X <span class="kr">is</span> (tr&#39; ++ [item&#39;])</span></span></span><br><span><var>Hs</var><span class="hyp-type"><b>: </b><span>destination item = s</span></span></span><br><span><var>Hm</var><span class="hyp-type"><b>: </b><span>output item = Some m</span></span></span><br><span><var>H0</var><span class="hyp-type"><b>: </b><span>item&#39; = item</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">can_produce X s m</div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="VLSM-v-chk4c2" style="display: none" type="checkbox"><label class="alectryon-input" for="VLSM-v-chk4c2"><span class="nb">subst</span> item&#39;.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>message</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>X</var><span class="hyp-type"><b>: </b><span>VLSM message</span></span></span><br><span><var>s</var><span class="hyp-type"><b>: </b><span>state</span></span></span><br><span><var>m</var><span class="hyp-type"><b>: </b><span>message</span></span></span><br><span><var>is</var><span class="hyp-type"><b>: </b><span>state</span></span></span><br><span><var>tr</var><span class="hyp-type"><b>: </b><span>list transition_item</span></span></span><br><span><var>item</var><span class="hyp-type"><b>: </b><span>transition_item</span></span></span><br><span><var>tr'</var><span class="hyp-type"><b>: </b><span>list transition_item</span></span></span><br><span><var>Htr</var><span class="hyp-type"><b>: </b><span>finite_valid_trace X <span class="kr">is</span> (tr&#39; ++ [item])</span></span></span><br><span><var>Hs</var><span class="hyp-type"><b>: </b><span>destination item = s</span></span></span><br><span><var>Hm</var><span class="hyp-type"><b>: </b><span>output item = Some m</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">can_produce X s m</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="VLSM-v-chk4c3" style="display: none" type="checkbox"><label class="alectryon-input" for="VLSM-v-chk4c3"><span class="nb">destruct</span> Htr <span class="kr">as</span> [Htr _].</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>message</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>X</var><span class="hyp-type"><b>: </b><span>VLSM message</span></span></span><br><span><var>s</var><span class="hyp-type"><b>: </b><span>state</span></span></span><br><span><var>m</var><span class="hyp-type"><b>: </b><span>message</span></span></span><br><span><var>is</var><span class="hyp-type"><b>: </b><span>state</span></span></span><br><span><var>tr</var><span class="hyp-type"><b>: </b><span>list transition_item</span></span></span><br><span><var>item</var><span class="hyp-type"><b>: </b><span>transition_item</span></span></span><br><span><var>tr'</var><span class="hyp-type"><b>: </b><span>list transition_item</span></span></span><br><span><var>Htr</var><span class="hyp-type"><b>: </b><span>finite_valid_trace_from X <span class="kr">is</span> (tr&#39; ++ [item])</span></span></span><br><span><var>Hs</var><span class="hyp-type"><b>: </b><span>destination item = s</span></span></span><br><span><var>Hm</var><span class="hyp-type"><b>: </b><span>output item = Some m</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">can_produce X s m</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="VLSM-v-chk4c4" style="display: none" type="checkbox"><label class="alectryon-input" for="VLSM-v-chk4c4"><span class="nb">apply</span> finite_valid_trace_from_app_iff <span class="kr">in</span> Htr.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>message</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>X</var><span class="hyp-type"><b>: </b><span>VLSM message</span></span></span><br><span><var>s</var><span class="hyp-type"><b>: </b><span>state</span></span></span><br><span><var>m</var><span class="hyp-type"><b>: </b><span>message</span></span></span><br><span><var>is</var><span class="hyp-type"><b>: </b><span>state</span></span></span><br><span><var>tr</var><span class="hyp-type"><b>: </b><span>list transition_item</span></span></span><br><span><var>item</var><span class="hyp-type"><b>: </b><span>transition_item</span></span></span><br><span><var>tr'</var><span class="hyp-type"><b>: </b><span>list transition_item</span></span></span><br><span><var>Htr</var><span class="hyp-type"><b>: </b><span>finite_valid_trace_from X <span class="kr">is</span> tr&#39;
‚àß finite_valid_trace_from X
    (finite_trace_last <span class="kr">is</span> tr&#39;) [item]</span></span></span><br><span><var>Hs</var><span class="hyp-type"><b>: </b><span>destination item = s</span></span></span><br><span><var>Hm</var><span class="hyp-type"><b>: </b><span>output item = Some m</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">can_produce X s m</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="VLSM-v-chk4c5" style="display: none" type="checkbox"><label class="alectryon-input" for="VLSM-v-chk4c5"><span class="nb">destruct</span> Htr <span class="kr">as</span> [_ Htr].</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>message</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>X</var><span class="hyp-type"><b>: </b><span>VLSM message</span></span></span><br><span><var>s</var><span class="hyp-type"><b>: </b><span>state</span></span></span><br><span><var>m</var><span class="hyp-type"><b>: </b><span>message</span></span></span><br><span><var>is</var><span class="hyp-type"><b>: </b><span>state</span></span></span><br><span><var>tr</var><span class="hyp-type"><b>: </b><span>list transition_item</span></span></span><br><span><var>item</var><span class="hyp-type"><b>: </b><span>transition_item</span></span></span><br><span><var>tr'</var><span class="hyp-type"><b>: </b><span>list transition_item</span></span></span><br><span><var>Htr</var><span class="hyp-type"><b>: </b><span>finite_valid_trace_from X
  (finite_trace_last <span class="kr">is</span> tr&#39;) [item]</span></span></span><br><span><var>Hs</var><span class="hyp-type"><b>: </b><span>destination item = s</span></span></span><br><span><var>Hm</var><span class="hyp-type"><b>: </b><span>output item = Some m</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">can_produce X s m</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="VLSM-v-chk4c6" style="display: none" type="checkbox"><label class="alectryon-input" for="VLSM-v-chk4c6"><span class="nb">inversion</span> Htr.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>message</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>X</var><span class="hyp-type"><b>: </b><span>VLSM message</span></span></span><br><span><var>s</var><span class="hyp-type"><b>: </b><span>state</span></span></span><br><span><var>m</var><span class="hyp-type"><b>: </b><span>message</span></span></span><br><span><var>is</var><span class="hyp-type"><b>: </b><span>state</span></span></span><br><span><var>tr</var><span class="hyp-type"><b>: </b><span>list transition_item</span></span></span><br><span><var>item</var><span class="hyp-type"><b>: </b><span>transition_item</span></span></span><br><span><var>tr'</var><span class="hyp-type"><b>: </b><span>list transition_item</span></span></span><br><span><var>Htr</var><span class="hyp-type"><b>: </b><span>finite_valid_trace_from X
  (finite_trace_last <span class="kr">is</span> tr&#39;) [item]</span></span></span><br><span><var>Hs</var><span class="hyp-type"><b>: </b><span>destination item = s</span></span></span><br><span><var>Hm</var><span class="hyp-type"><b>: </b><span>output item = Some m</span></span></span><br><span><var>s1</var><span class="hyp-type"><b>: </b><span>state</span></span></span><br><span><var>tl</var><span class="hyp-type"><b>: </b><span>list transition_item</span></span></span><br><span><var>s'</var><span class="hyp-type"><b>: </b><span>state</span></span></span><br><span><var>iom, oom</var><span class="hyp-type"><b>: </b><span>option message</span></span></span><br><span><var>l0</var><span class="hyp-type"><b>: </b><span>label</span></span></span><br><span><var>Htl</var><span class="hyp-type"><b>: </b><span>finite_valid_trace_from X s1 []</span></span></span><br><span><var>Ht</var><span class="hyp-type"><b>: </b><span>input_valid_transition X l0
  (finite_trace_last <span class="kr">is</span> tr&#39;, iom) 
  (s1, oom)</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>s&#39; = finite_trace_last <span class="kr">is</span> tr&#39;</span></span></span><br><span><var>H1</var><span class="hyp-type"><b>: </b><span>{|
  l := l0;
  input := iom;
  destination := s1;
  output := oom
|} = item</span></span></span><br><span><var>H2</var><span class="hyp-type"><b>: </b><span>tl = []</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">can_produce X s m</div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="VLSM-v-chk4c7" style="display: none" type="checkbox"><label class="alectryon-input" for="VLSM-v-chk4c7"><span class="nb">clear</span> Htr.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>message</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>X</var><span class="hyp-type"><b>: </b><span>VLSM message</span></span></span><br><span><var>s</var><span class="hyp-type"><b>: </b><span>state</span></span></span><br><span><var>m</var><span class="hyp-type"><b>: </b><span>message</span></span></span><br><span><var>is</var><span class="hyp-type"><b>: </b><span>state</span></span></span><br><span><var>tr</var><span class="hyp-type"><b>: </b><span>list transition_item</span></span></span><br><span><var>item</var><span class="hyp-type"><b>: </b><span>transition_item</span></span></span><br><span><var>tr'</var><span class="hyp-type"><b>: </b><span>list transition_item</span></span></span><br><span><var>Hs</var><span class="hyp-type"><b>: </b><span>destination item = s</span></span></span><br><span><var>Hm</var><span class="hyp-type"><b>: </b><span>output item = Some m</span></span></span><br><span><var>s1</var><span class="hyp-type"><b>: </b><span>state</span></span></span><br><span><var>tl</var><span class="hyp-type"><b>: </b><span>list transition_item</span></span></span><br><span><var>s'</var><span class="hyp-type"><b>: </b><span>state</span></span></span><br><span><var>iom, oom</var><span class="hyp-type"><b>: </b><span>option message</span></span></span><br><span><var>l0</var><span class="hyp-type"><b>: </b><span>label</span></span></span><br><span><var>Htl</var><span class="hyp-type"><b>: </b><span>finite_valid_trace_from X s1 []</span></span></span><br><span><var>Ht</var><span class="hyp-type"><b>: </b><span>input_valid_transition X l0
  (finite_trace_last <span class="kr">is</span> tr&#39;, iom) 
  (s1, oom)</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>s&#39; = finite_trace_last <span class="kr">is</span> tr&#39;</span></span></span><br><span><var>H1</var><span class="hyp-type"><b>: </b><span>{|
  l := l0;
  input := iom;
  destination := s1;
  output := oom
|} = item</span></span></span><br><span><var>H2</var><span class="hyp-type"><b>: </b><span>tl = []</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">can_produce X s m</div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="VLSM-v-chk4c8" style="display: none" type="checkbox"><label class="alectryon-input" for="VLSM-v-chk4c8"><span class="nb">subst</span>.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>message</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>X</var><span class="hyp-type"><b>: </b><span>VLSM message</span></span></span><br><span><var>m</var><span class="hyp-type"><b>: </b><span>message</span></span></span><br><span><var>is</var><span class="hyp-type"><b>: </b><span>state</span></span></span><br><span><var>tr, tr'</var><span class="hyp-type"><b>: </b><span>list transition_item</span></span></span><br><span><var>s1</var><span class="hyp-type"><b>: </b><span>state</span></span></span><br><span><var>iom, oom</var><span class="hyp-type"><b>: </b><span>option message</span></span></span><br><span><var>l0</var><span class="hyp-type"><b>: </b><span>label</span></span></span><br><span><var>Hm</var><span class="hyp-type"><b>: </b><span>output
  {|
    l := l0;
    input := iom;
    destination := s1;
    output := oom
  |} = Some m</span></span></span><br><span><var>Htl</var><span class="hyp-type"><b>: </b><span>finite_valid_trace_from X s1 []</span></span></span><br><span><var>Ht</var><span class="hyp-type"><b>: </b><span>input_valid_transition X l0
  (finite_trace_last <span class="kr">is</span> tr&#39;, iom) 
  (s1, oom)</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">can_produce X
  (destination
     {|
       l := l0;
       input := iom;
       destination := s1;
       output := oom
     |}) m</div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="VLSM-v-chk4c9" style="display: none" type="checkbox"><label class="alectryon-input" for="VLSM-v-chk4c9"><span class="nb">simpl</span> <span class="kr">in</span> Hm.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>message</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>X</var><span class="hyp-type"><b>: </b><span>VLSM message</span></span></span><br><span><var>m</var><span class="hyp-type"><b>: </b><span>message</span></span></span><br><span><var>is</var><span class="hyp-type"><b>: </b><span>state</span></span></span><br><span><var>tr, tr'</var><span class="hyp-type"><b>: </b><span>list transition_item</span></span></span><br><span><var>s1</var><span class="hyp-type"><b>: </b><span>state</span></span></span><br><span><var>iom, oom</var><span class="hyp-type"><b>: </b><span>option message</span></span></span><br><span><var>l0</var><span class="hyp-type"><b>: </b><span>label</span></span></span><br><span><var>Hm</var><span class="hyp-type"><b>: </b><span>oom = Some m</span></span></span><br><span><var>Htl</var><span class="hyp-type"><b>: </b><span>finite_valid_trace_from X s1 []</span></span></span><br><span><var>Ht</var><span class="hyp-type"><b>: </b><span>input_valid_transition X l0
  (finite_trace_last <span class="kr">is</span> tr&#39;, iom) 
  (s1, oom)</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">can_produce X
  (destination
     {|
       l := l0;
       input := iom;
       destination := s1;
       output := oom
     |}) m</div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="VLSM-v-chk4ca" style="display: none" type="checkbox"><label class="alectryon-input" for="VLSM-v-chk4ca"><span class="nb">subst</span>.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>message</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>X</var><span class="hyp-type"><b>: </b><span>VLSM message</span></span></span><br><span><var>m</var><span class="hyp-type"><b>: </b><span>message</span></span></span><br><span><var>is</var><span class="hyp-type"><b>: </b><span>state</span></span></span><br><span><var>tr, tr'</var><span class="hyp-type"><b>: </b><span>list transition_item</span></span></span><br><span><var>s1</var><span class="hyp-type"><b>: </b><span>state</span></span></span><br><span><var>iom</var><span class="hyp-type"><b>: </b><span>option message</span></span></span><br><span><var>l0</var><span class="hyp-type"><b>: </b><span>label</span></span></span><br><span><var>Htl</var><span class="hyp-type"><b>: </b><span>finite_valid_trace_from X s1 []</span></span></span><br><span><var>Ht</var><span class="hyp-type"><b>: </b><span>input_valid_transition X l0
  (finite_trace_last <span class="kr">is</span> tr&#39;, iom) 
  (s1, Some m)</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">can_produce X
  (destination
     {|
       l := l0;
       input := iom;
       destination := s1;
       output := Some m
     |}) m</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="VLSM-v-chk4cb" style="display: none" type="checkbox"><label class="alectryon-input" for="VLSM-v-chk4cb"><span class="nb">eexists</span> _, l0.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>message</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>X</var><span class="hyp-type"><b>: </b><span>VLSM message</span></span></span><br><span><var>m</var><span class="hyp-type"><b>: </b><span>message</span></span></span><br><span><var>is</var><span class="hyp-type"><b>: </b><span>state</span></span></span><br><span><var>tr, tr'</var><span class="hyp-type"><b>: </b><span>list transition_item</span></span></span><br><span><var>s1</var><span class="hyp-type"><b>: </b><span>state</span></span></span><br><span><var>iom</var><span class="hyp-type"><b>: </b><span>option message</span></span></span><br><span><var>l0</var><span class="hyp-type"><b>: </b><span>label</span></span></span><br><span><var>Htl</var><span class="hyp-type"><b>: </b><span>finite_valid_trace_from X s1 []</span></span></span><br><span><var>Ht</var><span class="hyp-type"><b>: </b><span>input_valid_transition X l0
  (finite_trace_last <span class="kr">is</span> tr&#39;, iom) 
  (s1, Some m)</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">input_valid_transition X l0 <span class="nl">?Goal</span>
  (destination
     {|
       l := l0;
       input := iom;
       destination := s1;
       output := Some m
     |}, Some m)</div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="nb">apply</span> Ht.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Qed</span>.</span></span></pre><div class="doc">
<a id="lab16"></a><h3 class="section">Properties of provably-equal VLSMs</h3>
<div class="paragraph"> </div>

If we know that two VLSMs are provably equal, we could try rewriting by them.
However, that gets usually quite technical. To go around that, we will prove
that there is a <span class="inlinecode"><span class="id" title="var">VLSMProjections.VLSM_full_projection</span></span> between them which will
allow trace-based results to be easily moved betweent the two VLSMs.

<div class="paragraph"> </div>

Below are some preliminary results; the actual projection is given in
<span class="inlinecode"><span class="id" title="var">VLSMProjections.same_VLSM_full_projection</span></span>.

</div><pre class="alectryon-io highlight"><!-- Generator: Alectryon --><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Section</span> <span class="nf">same_VLSM</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
</span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Context</span>
  {<span class="nv">message</span> : <span class="kt">Type</span>}
  .</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
</span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Section</span> <span class="nf">definitions</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
</span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Context</span>
  [X1 X2 : VLSM message]
  (Heq : X1 = X2)
  .</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
</span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Definition</span> <span class="nf">same_VLSM_label_rew</span> (<span class="nv">l1</span> : vlabel X1) : vlabel X2 :=
  eq_rect X1 _ l1 _ Heq.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
</span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Definition</span> <span class="nf">same_VLSM_state_rew</span> (<span class="nv">s1</span> : vstate X1) : vstate X2 :=
  eq_rect X1 _ s1 _ Heq.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
</span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">End</span> <span class="nf">definitions</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
</span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Context</span>
  (<span class="nv">X1</span> <span class="nv">X2</span> : VLSM message)
  (<span class="nv">Heq</span> : X1 = X2)
  .</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
</span><span class="alectryon-sentence"><input class="alectryon-toggle" id="VLSM-v-chk4cc" style="display: none" type="checkbox"><label class="alectryon-input" for="VLSM-v-chk4cc"><span class="kn">Lemma</span> <span class="nf">same_VLSM_valid_preservation</span> <span class="nv">l1</span> <span class="nv">s1</span> <span class="nv">om</span>
  : vvalid X1 l1 (s1, om) -&gt;
    vvalid X2 (same_VLSM_label_rew Heq l1) (same_VLSM_state_rew Heq s1, om).</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>message</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>X1, X2</var><span class="hyp-type"><b>: </b><span>VLSM message</span></span></span><br><span><var>Heq</var><span class="hyp-type"><b>: </b><span>X1 = X2</span></span></span><br><span><var>l1</var><span class="hyp-type"><b>: </b><span>label</span></span></span><br><span><var>s1</var><span class="hyp-type"><b>: </b><span>state</span></span></span><br><span><var>om</var><span class="hyp-type"><b>: </b><span>option message</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">vvalid X1 l1 (s1, om)
‚Üí vvalid X2 (same_VLSM_label_rew Heq l1)
    (same_VLSM_state_rew Heq s1, om)</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="VLSM-v-chk4cd" style="display: none" type="checkbox"><label class="alectryon-input" for="VLSM-v-chk4cd"><span class="kn">Proof</span>.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>message</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>X1, X2</var><span class="hyp-type"><b>: </b><span>VLSM message</span></span></span><br><span><var>Heq</var><span class="hyp-type"><b>: </b><span>X1 = X2</span></span></span><br><span><var>l1</var><span class="hyp-type"><b>: </b><span>label</span></span></span><br><span><var>s1</var><span class="hyp-type"><b>: </b><span>state</span></span></span><br><span><var>om</var><span class="hyp-type"><b>: </b><span>option message</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">vvalid X1 l1 (s1, om)
‚Üí vvalid X2 (same_VLSM_label_rew Heq l1)
    (same_VLSM_state_rew Heq s1, om)</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="VLSM-v-chk4ce" style="display: none" type="checkbox"><label class="alectryon-input" for="VLSM-v-chk4ce"><span class="nb">unfold</span> same_VLSM_label_rew, same_VLSM_state_rew.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>message</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>X1, X2</var><span class="hyp-type"><b>: </b><span>VLSM message</span></span></span><br><span><var>Heq</var><span class="hyp-type"><b>: </b><span>X1 = X2</span></span></span><br><span><var>l1</var><span class="hyp-type"><b>: </b><span>label</span></span></span><br><span><var>s1</var><span class="hyp-type"><b>: </b><span>state</span></span></span><br><span><var>om</var><span class="hyp-type"><b>: </b><span>option message</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">vvalid X1 l1 (s1, om)
‚Üí vvalid X2 (eq_rect X1 vlabel l1 X2 Heq)
    (eq_rect X1 vstate s1 X2 Heq, om)</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="VLSM-v-chk4cf" style="display: none" type="checkbox"><label class="alectryon-input" for="VLSM-v-chk4cf"><span class="nb">revert</span> l1 s1.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>message</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>X1, X2</var><span class="hyp-type"><b>: </b><span>VLSM message</span></span></span><br><span><var>Heq</var><span class="hyp-type"><b>: </b><span>X1 = X2</span></span></span><br><span><var>om</var><span class="hyp-type"><b>: </b><span>option message</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="kr">‚àÄ</span> (<span class="nv">l1</span> : label) (<span class="nv">s1</span> : state),
  vvalid X1 l1 (s1, om)
  ‚Üí vvalid X2 (eq_rect X1 vlabel l1 X2 Heq)
      (eq_rect X1 vstate s1 X2 Heq, om)</div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="VLSM-v-chk4d0" style="display: none" type="checkbox"><label class="alectryon-input" for="VLSM-v-chk4d0"><span class="nb">rewrite</span> Heq.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>message</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>X1, X2</var><span class="hyp-type"><b>: </b><span>VLSM message</span></span></span><br><span><var>Heq</var><span class="hyp-type"><b>: </b><span>X1 = X2</span></span></span><br><span><var>om</var><span class="hyp-type"><b>: </b><span>option message</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="kr">‚àÄ</span> (<span class="nv">l1</span> : label) (<span class="nv">s1</span> : state),
  vvalid X2 l1 (s1, om)
  ‚Üí vvalid X2 (eq_rect X2 vlabel l1 X2 eq_refl)
      (eq_rect X2 vstate s1 X2 eq_refl, om)</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="VLSM-v-chk4d1" style="display: none" type="checkbox"><label class="alectryon-input" for="VLSM-v-chk4d1"><span class="nb">intros</span>.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>message</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>X1, X2</var><span class="hyp-type"><b>: </b><span>VLSM message</span></span></span><br><span><var>Heq</var><span class="hyp-type"><b>: </b><span>X1 = X2</span></span></span><br><span><var>om</var><span class="hyp-type"><b>: </b><span>option message</span></span></span><br><span><var>l1</var><span class="hyp-type"><b>: </b><span>label</span></span></span><br><span><var>s1</var><span class="hyp-type"><b>: </b><span>state</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>vvalid X2 l1 (s1, om)</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">vvalid X2 (eq_rect X2 vlabel l1 X2 eq_refl)
  (eq_rect X2 vstate s1 X2 eq_refl, om)</div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="bp">assumption</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Qed</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
</span><span class="alectryon-sentence"><input class="alectryon-toggle" id="VLSM-v-chk4d2" style="display: none" type="checkbox"><label class="alectryon-input" for="VLSM-v-chk4d2"><span class="kn">Lemma</span> <span class="nf">same_VLSM_transition_preservation</span> <span class="nv">l1</span> <span class="nv">s1</span> <span class="nv">om</span> <span class="nv">s1&#39;</span> <span class="nv">om&#39;</span>
  : vtransition X1 l1 (s1, om) = (s1&#39;, om&#39;) -&gt;
    vtransition X2 (same_VLSM_label_rew Heq l1) (same_VLSM_state_rew Heq s1, om) =
      (same_VLSM_state_rew Heq s1&#39;, om&#39;).</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>message</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>X1, X2</var><span class="hyp-type"><b>: </b><span>VLSM message</span></span></span><br><span><var>Heq</var><span class="hyp-type"><b>: </b><span>X1 = X2</span></span></span><br><span><var>l1</var><span class="hyp-type"><b>: </b><span>label</span></span></span><br><span><var>s1</var><span class="hyp-type"><b>: </b><span>state</span></span></span><br><span><var>om</var><span class="hyp-type"><b>: </b><span>option message</span></span></span><br><span><var>s1'</var><span class="hyp-type"><b>: </b><span>state</span></span></span><br><span><var>om'</var><span class="hyp-type"><b>: </b><span>option message</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">vtransition X1 l1 (s1, om) = (s1&#39;, om&#39;)
‚Üí vtransition X2 (same_VLSM_label_rew Heq l1)
    (same_VLSM_state_rew Heq s1, om) =
  (same_VLSM_state_rew Heq s1&#39;, om&#39;)</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="VLSM-v-chk4d3" style="display: none" type="checkbox"><label class="alectryon-input" for="VLSM-v-chk4d3"><span class="kn">Proof</span>.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>message</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>X1, X2</var><span class="hyp-type"><b>: </b><span>VLSM message</span></span></span><br><span><var>Heq</var><span class="hyp-type"><b>: </b><span>X1 = X2</span></span></span><br><span><var>l1</var><span class="hyp-type"><b>: </b><span>label</span></span></span><br><span><var>s1</var><span class="hyp-type"><b>: </b><span>state</span></span></span><br><span><var>om</var><span class="hyp-type"><b>: </b><span>option message</span></span></span><br><span><var>s1'</var><span class="hyp-type"><b>: </b><span>state</span></span></span><br><span><var>om'</var><span class="hyp-type"><b>: </b><span>option message</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">vtransition X1 l1 (s1, om) = (s1&#39;, om&#39;)
‚Üí vtransition X2 (same_VLSM_label_rew Heq l1)
    (same_VLSM_state_rew Heq s1, om) =
  (same_VLSM_state_rew Heq s1&#39;, om&#39;)</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="VLSM-v-chk4d4" style="display: none" type="checkbox"><label class="alectryon-input" for="VLSM-v-chk4d4"><span class="nb">unfold</span> same_VLSM_label_rew, same_VLSM_state_rew.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>message</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>X1, X2</var><span class="hyp-type"><b>: </b><span>VLSM message</span></span></span><br><span><var>Heq</var><span class="hyp-type"><b>: </b><span>X1 = X2</span></span></span><br><span><var>l1</var><span class="hyp-type"><b>: </b><span>label</span></span></span><br><span><var>s1</var><span class="hyp-type"><b>: </b><span>state</span></span></span><br><span><var>om</var><span class="hyp-type"><b>: </b><span>option message</span></span></span><br><span><var>s1'</var><span class="hyp-type"><b>: </b><span>state</span></span></span><br><span><var>om'</var><span class="hyp-type"><b>: </b><span>option message</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">vtransition X1 l1 (s1, om) = (s1&#39;, om&#39;)
‚Üí vtransition X2 (eq_rect X1 vlabel l1 X2 Heq)
    (eq_rect X1 vstate s1 X2 Heq, om) =
  (eq_rect X1 vstate s1&#39; X2 Heq, om&#39;)</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="VLSM-v-chk4d5" style="display: none" type="checkbox"><label class="alectryon-input" for="VLSM-v-chk4d5"><span class="nb">revert</span> l1 s1 s1&#39;.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>message</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>X1, X2</var><span class="hyp-type"><b>: </b><span>VLSM message</span></span></span><br><span><var>Heq</var><span class="hyp-type"><b>: </b><span>X1 = X2</span></span></span><br><span><var>om, om'</var><span class="hyp-type"><b>: </b><span>option message</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="kr">‚àÄ</span> (<span class="nv">l1</span> : label) (<span class="nv">s1</span> <span class="nv">s1&#39;</span> : state),
  vtransition X1 l1 (s1, om) = (s1&#39;, om&#39;)
  ‚Üí vtransition X2 (eq_rect X1 vlabel l1 X2 Heq)
      (eq_rect X1 vstate s1 X2 Heq, om) =
    (eq_rect X1 vstate s1&#39; X2 Heq, om&#39;)</div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="VLSM-v-chk4d6" style="display: none" type="checkbox"><label class="alectryon-input" for="VLSM-v-chk4d6"><span class="nb">rewrite</span> Heq.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>message</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>X1, X2</var><span class="hyp-type"><b>: </b><span>VLSM message</span></span></span><br><span><var>Heq</var><span class="hyp-type"><b>: </b><span>X1 = X2</span></span></span><br><span><var>om, om'</var><span class="hyp-type"><b>: </b><span>option message</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="kr">‚àÄ</span> (<span class="nv">l1</span> : label) (<span class="nv">s1</span> <span class="nv">s1&#39;</span> : state),
  vtransition X2 l1 (s1, om) = (s1&#39;, om&#39;)
  ‚Üí vtransition X2 (eq_rect X2 vlabel l1 X2 eq_refl)
      (eq_rect X2 vstate s1 X2 eq_refl, om) =
    (eq_rect X2 vstate s1&#39; X2 eq_refl, om&#39;)</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="VLSM-v-chk4d7" style="display: none" type="checkbox"><label class="alectryon-input" for="VLSM-v-chk4d7"><span class="nb">intros</span>.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>message</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>X1, X2</var><span class="hyp-type"><b>: </b><span>VLSM message</span></span></span><br><span><var>Heq</var><span class="hyp-type"><b>: </b><span>X1 = X2</span></span></span><br><span><var>om, om'</var><span class="hyp-type"><b>: </b><span>option message</span></span></span><br><span><var>l1</var><span class="hyp-type"><b>: </b><span>label</span></span></span><br><span><var>s1, s1'</var><span class="hyp-type"><b>: </b><span>state</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>vtransition X2 l1 (s1, om) = (s1&#39;, om&#39;)</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">vtransition X2 (eq_rect X2 vlabel l1 X2 eq_refl)
  (eq_rect X2 vstate s1 X2 eq_refl, om) =
(eq_rect X2 vstate s1&#39; X2 eq_refl, om&#39;)</div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="bp">assumption</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Qed</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
</span><span class="alectryon-sentence"><input class="alectryon-toggle" id="VLSM-v-chk4d8" style="display: none" type="checkbox"><label class="alectryon-input" for="VLSM-v-chk4d8"><span class="kn">Lemma</span> <span class="nf">same_VLSM_initial_state_preservation</span> <span class="nv">s1</span>
  : vinitial_state_prop X1 s1 -&gt; vinitial_state_prop X2 (same_VLSM_state_rew Heq s1).</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>message</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>X1, X2</var><span class="hyp-type"><b>: </b><span>VLSM message</span></span></span><br><span><var>Heq</var><span class="hyp-type"><b>: </b><span>X1 = X2</span></span></span><br><span><var>s1</var><span class="hyp-type"><b>: </b><span>state</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">vinitial_state_prop X1 s1
‚Üí vinitial_state_prop X2 (same_VLSM_state_rew Heq s1)</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="VLSM-v-chk4d9" style="display: none" type="checkbox"><label class="alectryon-input" for="VLSM-v-chk4d9"><span class="kn">Proof</span>.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>message</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>X1, X2</var><span class="hyp-type"><b>: </b><span>VLSM message</span></span></span><br><span><var>Heq</var><span class="hyp-type"><b>: </b><span>X1 = X2</span></span></span><br><span><var>s1</var><span class="hyp-type"><b>: </b><span>state</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">vinitial_state_prop X1 s1
‚Üí vinitial_state_prop X2 (same_VLSM_state_rew Heq s1)</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="VLSM-v-chk4da" style="display: none" type="checkbox"><label class="alectryon-input" for="VLSM-v-chk4da"><span class="nb">revert</span> s1.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>message</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>X1, X2</var><span class="hyp-type"><b>: </b><span>VLSM message</span></span></span><br><span><var>Heq</var><span class="hyp-type"><b>: </b><span>X1 = X2</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="kr">‚àÄ</span> <span class="nv">s1</span> : state,
  vinitial_state_prop X1 s1
  ‚Üí vinitial_state_prop X2
      (same_VLSM_state_rew Heq s1)</div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="VLSM-v-chk4db" style="display: none" type="checkbox"><label class="alectryon-input" for="VLSM-v-chk4db"><span class="nb">unfold</span> same_VLSM_state_rew.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>message</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>X1, X2</var><span class="hyp-type"><b>: </b><span>VLSM message</span></span></span><br><span><var>Heq</var><span class="hyp-type"><b>: </b><span>X1 = X2</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="kr">‚àÄ</span> <span class="nv">s1</span> : state,
  vinitial_state_prop X1 s1
  ‚Üí vinitial_state_prop X2
      (eq_rect X1 vstate s1 X2 Heq)</div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="VLSM-v-chk4dc" style="display: none" type="checkbox"><label class="alectryon-input" for="VLSM-v-chk4dc"><span class="nb">rewrite</span> Heq.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>message</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>X1, X2</var><span class="hyp-type"><b>: </b><span>VLSM message</span></span></span><br><span><var>Heq</var><span class="hyp-type"><b>: </b><span>X1 = X2</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="kr">‚àÄ</span> <span class="nv">s1</span> : state,
  vinitial_state_prop X2 s1
  ‚Üí vinitial_state_prop X2
      (eq_rect X2 vstate s1 X2 eq_refl)</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="VLSM-v-chk4dd" style="display: none" type="checkbox"><label class="alectryon-input" for="VLSM-v-chk4dd"><span class="nb">intros</span>.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>message</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>X1, X2</var><span class="hyp-type"><b>: </b><span>VLSM message</span></span></span><br><span><var>Heq</var><span class="hyp-type"><b>: </b><span>X1 = X2</span></span></span><br><span><var>s1</var><span class="hyp-type"><b>: </b><span>state</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>vinitial_state_prop X2 s1</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">vinitial_state_prop X2
  (eq_rect X2 vstate s1 X2 eq_refl)</div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="bp">assumption</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Qed</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
</span><span class="alectryon-sentence"><input class="alectryon-toggle" id="VLSM-v-chk4de" style="display: none" type="checkbox"><label class="alectryon-input" for="VLSM-v-chk4de"><span class="kn">Lemma</span> <span class="nf">same_VLSM_initial_message_preservation</span> <span class="nv">m</span>
  : vinitial_message_prop X1 m -&gt; vinitial_message_prop X2 m.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>message</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>X1, X2</var><span class="hyp-type"><b>: </b><span>VLSM message</span></span></span><br><span><var>Heq</var><span class="hyp-type"><b>: </b><span>X1 = X2</span></span></span><br><span><var>m</var><span class="hyp-type"><b>: </b><span>message</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">vinitial_message_prop X1 m
‚Üí vinitial_message_prop X2 m</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="VLSM-v-chk4df" style="display: none" type="checkbox"><label class="alectryon-input" for="VLSM-v-chk4df"><span class="kn">Proof</span>.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>message</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>X1, X2</var><span class="hyp-type"><b>: </b><span>VLSM message</span></span></span><br><span><var>Heq</var><span class="hyp-type"><b>: </b><span>X1 = X2</span></span></span><br><span><var>m</var><span class="hyp-type"><b>: </b><span>message</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">vinitial_message_prop X1 m
‚Üí vinitial_message_prop X2 m</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="VLSM-v-chk4e0" style="display: none" type="checkbox"><label class="alectryon-input" for="VLSM-v-chk4e0"><span class="nb">rewrite</span> Heq.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>message</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>X1, X2</var><span class="hyp-type"><b>: </b><span>VLSM message</span></span></span><br><span><var>Heq</var><span class="hyp-type"><b>: </b><span>X1 = X2</span></span></span><br><span><var>m</var><span class="hyp-type"><b>: </b><span>message</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">vinitial_message_prop X2 m
‚Üí vinitial_message_prop X2 m</div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="bp">exact</span> id.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Qed</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
</span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">End</span> <span class="nf">same_VLSM</span>.</span></span></pre></article></body></html>